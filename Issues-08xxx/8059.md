# Issue 8059: Update Singular spkg to release 3-1-1-4

archive/issues_008059.json:
```json
{
    "assignees": [],
    "body": "The Singular team accepted most of our patches upstream. They are in the 3-1-0-9 release, which also is a first step to make things easier for library developers.\n\nHow to apply the patches to [sage-4.5.3.alpha0](http://sage.math.washington.edu/home/release/sage-4.5.3.alpha0/sage-4.5.3.alpha0.tar):\n\n* Install the new Singular spkg: [http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg](http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg)\n* Apply [singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz) to `devel/sage`\n\nCC:  @sagetrac-PolyBoRi @sagetrac-drkirkby @aghitza @jaapspies @kiwifb @alexanderdreyer\n\nComponent: **packages: standard**\n\nAuthor: **Martin Albrecht**\n\nReviewer: **David Kirkby, Simon King, William Stein, John Palmieri**\n\nUpstream: **Reported upstream. Little or no feedback.**\n\nMerged: **sage-4.5.3.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/8059_\n\n",
    "closed_at": "2010-08-15T08:02:32Z",
    "created_at": "2010-01-25T19:05:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.5.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update Singular spkg to release 3-1-1-4",
    "type": "issue",
    "updated_at": "2010-08-16T22:42:12Z",
    "url": "https://github.com/sagemath/sage/issues/8059",
    "user": "https://github.com/malb"
}
```
The Singular team accepted most of our patches upstream. They are in the 3-1-0-9 release, which also is a first step to make things easier for library developers.

How to apply the patches to [sage-4.5.3.alpha0](http://sage.math.washington.edu/home/release/sage-4.5.3.alpha0/sage-4.5.3.alpha0.tar):

* Install the new Singular spkg: [http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg](http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg)
* Apply [singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz) to `devel/sage`

CC:  @sagetrac-PolyBoRi @sagetrac-drkirkby @aghitza @jaapspies @kiwifb @alexanderdreyer

Component: **packages: standard**

Author: **Martin Albrecht**

Reviewer: **David Kirkby, Simon King, William Stein, John Palmieri**

Upstream: **Reported upstream. Little or no feedback.**

Merged: **sage-4.5.3.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/8059_





---

archive/issue_events_100187.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-01-25T19:05:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "milestone_number": null,
    "milestone_title": "sage-4.5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100187"
}
```



---

archive/issue_events_100188.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-01-25T19:05:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100188"
}
```



---

archive/issue_events_100189.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-01-25T19:05:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100189"
}
```



---

archive/issue_events_100190.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-01-25T19:05:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100190"
}
```



---

archive/issue_comments_061890.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHere's the new SPKG:\n\n   http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-0-9-20100125.spkg\n\nYou also need to apply the patch I am going to upload in a second.\n\n* CCing Dave so we can make sure there is no regression w.r.t. Solaris etc. \n* CCing PolyBoRi so Michael can take a look at my changes (he knows the code base)\n* CCing Alex since he reviewed Singular SPKGs before :)",
    "created_at": "2010-01-25T19:07:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61890",
    "user": "https://github.com/malb"
}
```

<div id="comment:1" align="right">comment:1</div>

Here's the new SPKG:

   http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-0-9-20100125.spkg

You also need to apply the patch I am going to upload in a second.

* CCing Dave so we can make sure there is no regression w.r.t. Solaris etc. 
* CCing PolyBoRi so Michael can take a look at my changes (he knows the code base)
* CCing Alex since he reviewed Singular SPKGs before :)



---

archive/issue_comments_061891.json:
```json
{
    "body": "Attachment: **[singular_3-0-1-9.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular_3-0-1-9.patch.gz)**",
    "created_at": "2010-01-25T19:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61891",
    "user": "https://github.com/malb"
}
```

Attachment: **[singular_3-0-1-9.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular_3-0-1-9.patch.gz)**



---

archive/issue_events_100191.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-01-25T19:07:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100191"
}
```



---

archive/issue_comments_061892.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n**Doctests on sage.math**:\n\nThe only failure is in gen.pyx. I don't see how this can be caused by my changes.\n\n```\n**********************************************************************\nFile \"/mnt/usb1/scratch/malb/sage-4.3.1/devel/sage/sage/libs/pari/gen.pyx\", line 2950:\n    sage: pari(sqrt(2)).frac()\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_77[3]>\", line 1, in <module>\n        pari(sqrt(Integer(2))).frac()###line 2950:\n    sage: pari(sqrt(2)).frac()\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py\", line 812, in sqrt\n        return x.sqrt(*args, **kwds)\n      File \"integer.pyx\", line 4440, in sage.rings.integer.Integer.sqrt (sage/rings/integer.c:25864)\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py\", line 755, in _do_sqrt\n        z = SR(x) ** one_half\n      File \"expression.pyx\", line 2218, in sage.symbolic.expression.Expression.__pow__ (sage/symbolic/expression.cpp:11255)\n      File \"integer.pyx\", line 1603, in sage.rings.integer.Integer.__pow__ (sage/rings/integer.c:11625)\n      File \"rational.pyx\", line 2082, in sage.rings.rational.Rational.__pow__ (sage/rings/rational.c:15560)\n    ImportError: /mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/symbolic/power_helper.so: failed to map segment from shared object: Cannot allocate memory\n\n**********************************************************************\nFile \"/mnt/usb1/scratch/malb/sage-4.3.1/devel/sage/sage/libs/pari/gen.pyx\", line 2977:\n    sage: pari(sqrt(-2)).imag()\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_78[3]>\", line 1, in <module>\n        pari(sqrt(-Integer(2))).imag()###line 2977:\n    sage: pari(sqrt(-2)).imag()\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py\", line 812, in sqrt\n        return x.sqrt(*args, **kwds)\n      File \"integer.pyx\", line 4424, in sage.rings.integer.Integer.sqrt (sage/rings/integer.c:25709)\n      File \"/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py\", line 755, in _do_sqrt\n        z = SR(x) ** one_half\n      File \"expression.pyx\", line 2218, in sage.symbolic.expression.Expression.__pow__ (sage/symbolic/expression.cpp:11255)\n      File \"integer.pyx\", line 1603, in sage.rings.integer.Integer.__pow__ (sage/rings/integer.c:11625)\n      File \"rational.pyx\", line 2082, in sage.rings.rational.Rational.__pow__ (sage/rings/rational.c:15560)\n    ImportError: /mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/symbolic/power_helper.so: failed to map segment from shared object: Cannot allocate memory\n```",
    "created_at": "2010-01-25T19:36:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61892",
    "user": "https://github.com/malb"
}
```

<div id="comment:3" align="right">comment:3</div>

**Doctests on sage.math**:

The only failure is in gen.pyx. I don't see how this can be caused by my changes.

```
**********************************************************************
File "/mnt/usb1/scratch/malb/sage-4.3.1/devel/sage/sage/libs/pari/gen.pyx", line 2950:
    sage: pari(sqrt(2)).frac()
Exception raised:
    Traceback (most recent call last):
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_77[3]>", line 1, in <module>
        pari(sqrt(Integer(2))).frac()###line 2950:
    sage: pari(sqrt(2)).frac()
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py", line 812, in sqrt
        return x.sqrt(*args, **kwds)
      File "integer.pyx", line 4440, in sage.rings.integer.Integer.sqrt (sage/rings/integer.c:25864)
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py", line 755, in _do_sqrt
        z = SR(x) ** one_half
      File "expression.pyx", line 2218, in sage.symbolic.expression.Expression.__pow__ (sage/symbolic/expression.cpp:11255)
      File "integer.pyx", line 1603, in sage.rings.integer.Integer.__pow__ (sage/rings/integer.c:11625)
      File "rational.pyx", line 2082, in sage.rings.rational.Rational.__pow__ (sage/rings/rational.c:15560)
    ImportError: /mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/symbolic/power_helper.so: failed to map segment from shared object: Cannot allocate memory

**********************************************************************
File "/mnt/usb1/scratch/malb/sage-4.3.1/devel/sage/sage/libs/pari/gen.pyx", line 2977:
    sage: pari(sqrt(-2)).imag()
Exception raised:
    Traceback (most recent call last):
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_78[3]>", line 1, in <module>
        pari(sqrt(-Integer(2))).imag()###line 2977:
    sage: pari(sqrt(-2)).imag()
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py", line 812, in sqrt
        return x.sqrt(*args, **kwds)
      File "integer.pyx", line 4424, in sage.rings.integer.Integer.sqrt (sage/rings/integer.c:25709)
      File "/mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/functions/other.py", line 755, in _do_sqrt
        z = SR(x) ** one_half
      File "expression.pyx", line 2218, in sage.symbolic.expression.Expression.__pow__ (sage/symbolic/expression.cpp:11255)
      File "integer.pyx", line 1603, in sage.rings.integer.Integer.__pow__ (sage/rings/integer.c:11625)
      File "rational.pyx", line 2082, in sage.rings.rational.Rational.__pow__ (sage/rings/rational.c:15560)
    ImportError: /mnt/usb1/scratch/malb/sage-4.3.1/local/lib/python/site-packages/sage/symbolic/power_helper.so: failed to map segment from shared object: Cannot allocate memory
```



---

archive/issue_comments_061893.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAlso, the same doctest passes for me locally, so I will assume for now that this has nothing to do with my patch (famous last words, I know).",
    "created_at": "2010-01-25T19:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61893",
    "user": "https://github.com/malb"
}
```

<div id="comment:4" align="right">comment:4</div>

Also, the same doctest passes for me locally, so I will assume for now that this has nothing to do with my patch (famous last words, I know).



---

archive/issue_comments_061894.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI'm testing this on a couple of machines and will report.\n\nI have two questions about the spkg:\n\n1. Should we remove dist/, see #5903 ?\n2. In src/, should we remove doc/ and emacs/ ?  It's really just a question of making the spkg smaller by about 10%, since AFAIK these won't get used from Sage.  We routinely do this with other spkgs.\n\nI'm happy to do this and post a new spkg, but I wanted to see what Martin thought about it.",
    "created_at": "2010-01-26T00:34:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61894",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:6" align="right">comment:6</div>

I'm testing this on a couple of machines and will report.

I have two questions about the spkg:

1. Should we remove dist/, see #5903 ?
2. In src/, should we remove doc/ and emacs/ ?  It's really just a question of making the spkg smaller by about 10%, since AFAIK these won't get used from Sage.  We routinely do this with other spkgs.

I'm happy to do this and post a new spkg, but I wanted to see what Martin thought about it.



---

archive/issue_comments_061895.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@aghitza](#comment:6):\n> I have two questions about the spkg:\n> \n> 1. Should we remove dist/, see #5903 ?\n\nYes, that sounds reasonable.\n\n> 2. In src/, should we remove doc/ and emacs/ ?  It's really just a question of making the spkg smaller by about 10%, since AFAIK these won't get used from Sage.  We routinely do this with other spkgs.\n\nI just checked and it still builds with these two directories removed. \n\nThus, I've updated the SPKG accordingly. Same place, same name.",
    "created_at": "2010-01-26T00:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61895",
    "user": "https://github.com/malb"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@aghitza](#comment:6):
> I have two questions about the spkg:
> 
> 1. Should we remove dist/, see #5903 ?

Yes, that sounds reasonable.

> 2. In src/, should we remove doc/ and emacs/ ?  It's really just a question of making the spkg smaller by about 10%, since AFAIK these won't get used from Sage.  We routinely do this with other spkgs.

I just checked and it still builds with these two directories removed. 

Thus, I've updated the SPKG accordingly. Same place, same name.



---

archive/issue_comments_061896.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI did not have any time to test it.\nBut most changes introduce passing the ring explicitly to Singular.\nThis avoid current ring problems (which can be quite annoying and hard to debug).\n\nnlGetNumerator seems a new addition in Singular (maybe, a special wish of Martin?).\n\nCheers,\nMichael",
    "created_at": "2010-01-26T08:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61896",
    "user": "https://github.com/sagetrac-PolyBoRi"
}
```

<div id="comment:8" align="right">comment:8</div>

I did not have any time to test it.
But most changes introduce passing the ring explicitly to Singular.
This avoid current ring problems (which can be quite annoying and hard to debug).

nlGetNumerator seems a new addition in Singular (maybe, a special wish of Martin?).

Cheers,
Michael



---

archive/issue_comments_061897.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@sagetrac-PolyBoRi](#comment:8):\n> I did not have any time to test it.\n> But most changes introduce passing the ring explicitly to Singular.\n> This avoid current ring problems (which can be quite annoying and hard to debug).\n\nYep, that's a great direction things are developing.\n \n> nlGetNumerator seems a new addition in Singular (maybe, a special wish of Martin?).\n\nIt's just `nlGetNom` renamed",
    "created_at": "2010-01-26T08:27:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61897",
    "user": "https://github.com/malb"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@sagetrac-PolyBoRi](#comment:8):
> I did not have any time to test it.
> But most changes introduce passing the ring explicitly to Singular.
> This avoid current ring problems (which can be quite annoying and hard to debug).

Yep, that's a great direction things are developing.
 
> nlGetNumerator seems a new addition in Singular (maybe, a special wish of Martin?).

It's just `nlGetNom` renamed



---

archive/issue_comments_061898.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nThen, what I can still comment are wild casts like\n\n```\n<napoly*>pNext(<poly*>z)\n```\nBut they are also okay as napoly is just a typedef for polyrec*.\nSo, from reading Malbs code, it looks good.\nStill someone needs to test it and check it for Sages formal criteria",
    "created_at": "2010-01-26T08:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61898",
    "user": "https://github.com/sagetrac-PolyBoRi"
}
```

<div id="comment:10" align="right">comment:10</div>

Then, what I can still comment are wild casts like

```
<napoly*>pNext(<poly*>z)
```
But they are also okay as napoly is just a typedef for polyrec*.
So, from reading Malbs code, it looks good.
Still someone needs to test it and check it for Sages formal criteria



---

archive/issue_comments_061899.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@malb](#comment:7):\n> I just checked and it still builds with these two directories removed. \n> \n> Thus, I've updated the SPKG accordingly. Same place, same name.\n\nUnless I am looking at the wrong SPKG, you forgot to take `dist/` out of version control:\n\n```\n[ghitza@cartan singular-3-1-0-9-20100125]$ hg status\n! dist/debian/changelog\n! dist/debian/compat\n! dist/debian/control\n! dist/debian/control.in\n! dist/debian/copyright\n! dist/debian/libsingular-dev.install\n! dist/debian/libsingular0.install\n! dist/debian/patches/change-library-search-path.patch\n! dist/debian/patches/sage-bugfixes.patch\n! dist/debian/patches/series\n! dist/debian/rules\n! dist/debian/singular.install\n```\n\nApart from this, I'm happy.",
    "created_at": "2010-01-26T10:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61899",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@malb](#comment:7):
> I just checked and it still builds with these two directories removed. 
> 
> Thus, I've updated the SPKG accordingly. Same place, same name.

Unless I am looking at the wrong SPKG, you forgot to take `dist/` out of version control:

```
[ghitza@cartan singular-3-1-0-9-20100125]$ hg status
! dist/debian/changelog
! dist/debian/compat
! dist/debian/control
! dist/debian/control.in
! dist/debian/copyright
! dist/debian/libsingular-dev.install
! dist/debian/libsingular0.install
! dist/debian/patches/change-library-search-path.patch
! dist/debian/patches/sage-bugfixes.patch
! dist/debian/patches/series
! dist/debian/rules
! dist/debian/singular.install
```

Apart from this, I'm happy.



---

archive/issue_comments_061900.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@sagetrac-PolyBoRi](#comment:10):\n> Then, what I can still comment are wild casts like\n> But they are also okay as napoly is just a typedef for polyrec*.\n\nThere used to be a `naIter` function which is gone in 3-1-0-9 and Singular internally uses `pNext()` as well. Thus I feel my casting is justified :)",
    "created_at": "2010-01-26T15:05:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61900",
    "user": "https://github.com/malb"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@sagetrac-PolyBoRi](#comment:10):
> Then, what I can still comment are wild casts like
> But they are also okay as napoly is just a typedef for polyrec*.

There used to be a `naIter` function which is gone in 3-1-0-9 and Singular internally uses `pNext()` as well. Thus I feel my casting is justified :)



---

archive/issue_comments_061901.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n> Unless I am looking at the wrong SPKG, you forgot to take `dist/` out of version control:\n\nfixed. Is that a positive review then?",
    "created_at": "2010-01-26T15:09:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61901",
    "user": "https://github.com/malb"
}
```

<div id="comment:13" align="right">comment:13</div>

> Unless I am looking at the wrong SPKG, you forgot to take `dist/` out of version control:

fixed. Is that a positive review then?



---

archive/issue_events_100192.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-26T20:59:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100192"
}
```



---

archive/issue_events_100193.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-01-26T20:59:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100193"
}
```



---

archive/issue_comments_061902.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nYes.",
    "created_at": "2010-01-26T20:59:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61902",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:14" align="right">comment:14</div>

Yes.



---

archive/issue_comments_061903.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAs is the spkg failed to build on Open Solaris x64 with SAGE64=yes.\n\n\n```\ng++ -c cf_factor.cc -w -fno-implicit-templates -I. -I. -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -DHAVE_CONFIG_H -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include  -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -O3 -g -fPIC -o cf_factor.o\nIn file included from /export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/vec_ZZ.h:5,\n                 from /export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZX.h:5,\n                 from /export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZXFactoring.h:5,\n                 from NTLconvert.h:23,\n                 from cf_factor.cc:33:\n/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZ.h: In function \u2018long int NTL::MulModPrecon(long int, long int, long int, long unsigned int)\u2019:\n/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZ.h:1795: error: \u2018MulHiUL\u2019 was not declared in this scope\nmake[2]: *** [cf_factor.o] Error 1\nmake[2]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src/factory'\nmake[1]: *** [install] Error 1\nmake[1]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src'\nmake: *** [/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/bin/Singular-3-1-0] Error 2\nUnable to build Singular.\n\nreal\t0m24.240s\nuser\t0m12.235s\nsys\t0m9.934s\nsage: An error occurred while installing singular-3-1-0-9-20100125\n\n```\n\n\nMaybe it will install a some FLAGS are set globally (-m64) in this case).\n\nAs Open Solaris is not a supported platform I'll not interfere with the positive review.\n\nJaap",
    "created_at": "2010-01-28T22:40:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61903",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:15" align="right">comment:15</div>

As is the spkg failed to build on Open Solaris x64 with SAGE64=yes.


```
g++ -c cf_factor.cc -w -fno-implicit-templates -I. -I. -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -DHAVE_CONFIG_H -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include  -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -O3 -g -fPIC -o cf_factor.o
In file included from /export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/vec_ZZ.h:5,
                 from /export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZX.h:5,
                 from /export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZXFactoring.h:5,
                 from NTLconvert.h:23,
                 from cf_factor.cc:33:
/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZ.h: In function ‘long int NTL::MulModPrecon(long int, long int, long int, long unsigned int)’:
/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include/NTL/ZZ.h:1795: error: ‘MulHiUL’ was not declared in this scope
make[2]: *** [cf_factor.o] Error 1
make[2]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src/factory'
make[1]: *** [install] Error 1
make[1]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src'
make: *** [/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/bin/Singular-3-1-0] Error 2
Unable to build Singular.

real	0m24.240s
user	0m12.235s
sys	0m9.934s
sage: An error occurred while installing singular-3-1-0-9-20100125

```


Maybe it will install a some FLAGS are set globally (-m64) in this case).

As Open Solaris is not a supported platform I'll not interfere with the positive review.

Jaap



---

archive/issue_comments_061904.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nJaap,\n\nDid the previous Singular spkg build properly on Open Solaris?  If so, I wonder if it's just a problem in spkg-install, or a more serious issue with Singular itself.",
    "created_at": "2010-01-28T23:41:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61904",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:16" align="right">comment:16</div>

Jaap,

Did the previous Singular spkg build properly on Open Solaris?  If so, I wonder if it's just a problem in spkg-install, or a more serious issue with Singular itself.



---

archive/issue_comments_061905.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nIf CFLAGS and friends are set tight. Building on Open Solaris fails on\n\n\n```\ngcc -g -pg -O3 -I. -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -O2 -g -m64 -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -DHAVE_CONFIG_H -c omBinPage.c -o omBinPage.op\n/var/tmp//ccciayz2.s: Assembler messages:\n/var/tmp//ccciayz2.s:31: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:110: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:183: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:270: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:477: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:805: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:1240: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:1718: Error: junk `@' after expression\n/var/tmp//ccciayz2.s:2041: Error: junk `@' after expression\nmake[2]: *** [omBinPage.op] Error 1\nmake[2]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src/omalloc'\nmake[1]: *** [install] Error 1\nmake[1]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src'\nmake: *** [/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/bin/Singular-3-1-0] Error 2\nUnable to build Singular.\n\n```\n\nActually this is the same failure I had before.\n\nWhat is the use of -gp in building singular for sage?\n\nIf I remove -gp in Makefile and Makefile.in all, over singular builds on\nOpen Solaris x64 64 bit\n\nJaap",
    "created_at": "2010-01-28T23:45:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61905",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:17" align="right">comment:17</div>

If CFLAGS and friends are set tight. Building on Open Solaris fails on


```
gcc -g -pg -O3 -I. -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -O2 -g -m64 -I/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/include -DHAVE_CONFIG_H -c omBinPage.c -o omBinPage.op
/var/tmp//ccciayz2.s: Assembler messages:
/var/tmp//ccciayz2.s:31: Error: junk `@' after expression
/var/tmp//ccciayz2.s:110: Error: junk `@' after expression
/var/tmp//ccciayz2.s:183: Error: junk `@' after expression
/var/tmp//ccciayz2.s:270: Error: junk `@' after expression
/var/tmp//ccciayz2.s:477: Error: junk `@' after expression
/var/tmp//ccciayz2.s:805: Error: junk `@' after expression
/var/tmp//ccciayz2.s:1240: Error: junk `@' after expression
/var/tmp//ccciayz2.s:1718: Error: junk `@' after expression
/var/tmp//ccciayz2.s:2041: Error: junk `@' after expression
make[2]: *** [omBinPage.op] Error 1
make[2]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src/omalloc'
make[1]: *** [install] Error 1
make[1]: Leaving directory `/export/home/jaap/Downloads/sage-4.3.2.alpha0/spkg/build/singular-3-1-0-9-20100125/src'
make: *** [/export/home/jaap/Downloads/sage-4.3.2.alpha0/local/bin/Singular-3-1-0] Error 2
Unable to build Singular.

```

Actually this is the same failure I had before.

What is the use of -gp in building singular for sage?

If I remove -gp in Makefile and Makefile.in all, over singular builds on
Open Solaris x64 64 bit

Jaap



---

archive/issue_comments_061906.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@aghitza](#comment:16):\n> Jaap,\n> \n> Did the previous Singular spkg build properly on Open Solaris?  If so, I wonder if it's just a problem in spkg-install, or a more serious issue with Singular itself.\n> \n\nThe -gp flag leads to problems on Open Solaris.\n\nJaap",
    "created_at": "2010-01-28T23:47:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61906",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@aghitza](#comment:16):
> Jaap,
> 
> Did the previous Singular spkg build properly on Open Solaris?  If so, I wonder if it's just a problem in spkg-install, or a more serious issue with Singular itself.
> 

The -gp flag leads to problems on Open Solaris.

Jaap



---

archive/issue_comments_061907.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n`man gcc` says:\n\n```\n-pg Generate extra code to write profile information suitable for the analysis program gprof.  You must use this option when compiling the source files you want data about, and you must also use it when linking.\n```\n\nso this shouldn't be used by default anyway.",
    "created_at": "2010-01-28T23:56:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61907",
    "user": "https://github.com/malb"
}
```

<div id="comment:19" align="right">comment:19</div>

`man gcc` says:

```
-pg Generate extra code to write profile information suitable for the analysis program gprof.  You must use this option when compiling the source files you want data about, and you must also use it when linking.
```

so this shouldn't be used by default anyway.



---

archive/issue_comments_061908.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@malb](#comment:19):\n> `man gcc` says:\n> \n> ```\n> -pg Generate extra code to write profile information suitable for the analysis program gprof.  You must use this option when compiling the source files you want data about, and you must also use it when linking.\n> ```\n> \n> so this shouldn't be used by default anyway.\n\n+1\n\nThanks.\n\nJaap",
    "created_at": "2010-01-28T23:59:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61908",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@malb](#comment:19):
> `man gcc` says:
> 
> ```
> -pg Generate extra code to write profile information suitable for the analysis program gprof.  You must use this option when compiling the source files you want data about, and you must also use it when linking.
> ```
> 
> so this shouldn't be used by default anyway.

+1

Thanks.

Jaap



---

archive/issue_comments_061909.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nMartin, do you want to remove this option in the spkg?  I'd be happy to do some test builds to make sure that it doesn't break anything on other architectures.  But if the fix is this simple to make it build on Open Solaris, we might as well do it now.",
    "created_at": "2010-01-29T00:18:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61909",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:21" align="right">comment:21</div>

Martin, do you want to remove this option in the spkg?  I'd be happy to do some test builds to make sure that it doesn't break anything on other architectures.  But if the fix is this simple to make it build on Open Solaris, we might as well do it now.



---

archive/issue_comments_061910.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@aghitza](#comment:21):\n> Martin, do you want to remove this option in the spkg?  I'd be happy to do some test builds to make sure that it doesn't break anything on other architectures.  But if the fix is this simple to make it build on Open Solaris, we might as well do it now.\n\nI think it need upstream work. In the former release it was in patches.\nNow it is in source :(\n\nRemoving -gp will not break anything in sage. We do no profiling!\n\nJaap",
    "created_at": "2010-01-29T00:23:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61910",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@aghitza](#comment:21):
> Martin, do you want to remove this option in the spkg?  I'd be happy to do some test builds to make sure that it doesn't break anything on other architectures.  But if the fix is this simple to make it build on Open Solaris, we might as well do it now.

I think it need upstream work. In the former release it was in patches.
Now it is in source :(

Removing -gp will not break anything in sage. We do no profiling!

Jaap



---

archive/issue_comments_061911.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nLooking at Jaap's error again it comes from omalloc. For omalloc all targets are built which are\n* libomalloc (normal)\n* libomalloc_ndebug (no debugging symbols)\n* libomalloc_p (for profiling)\n\nWe shouldn't mess with the `-pg` switch but should convince omalloc's autotools not to build the profiling version on top of the other two.",
    "created_at": "2010-01-29T00:28:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61911",
    "user": "https://github.com/malb"
}
```

<div id="comment:23" align="right">comment:23</div>

Looking at Jaap's error again it comes from omalloc. For omalloc all targets are built which are
* libomalloc (normal)
* libomalloc_ndebug (no debugging symbols)
* libomalloc_p (for profiling)

We shouldn't mess with the `-pg` switch but should convince omalloc's autotools not to build the profiling version on top of the other two.



---

archive/issue_comments_061912.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOne more comment. Only developers of a program or other software can put interest in\nprofiling there product.\n\nSo once more: let's ask upstream to remove this option.\n\nFor now it is an option to introduce some patches again in the spkg-install :(\n\n\nShall we set status to needs work?\n\nJaap",
    "created_at": "2010-01-29T00:33:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61912",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:24" align="right">comment:24</div>

One more comment. Only developers of a program or other software can put interest in
profiling there product.

So once more: let's ask upstream to remove this option.

For now it is an option to introduce some patches again in the spkg-install :(


Shall we set status to needs work?

Jaap



---

archive/issue_comments_061913.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI would also add I think adding profiling information by default is a bad idea. \n \n* Adding profiling information will slow the code quite considerably.\n* The -pg option is not portable, so it would hamper efforts to build with a non-GNU compiler.\n* The purposely add an option which is breaking a build on Open Solaris, when an Open Solaris port is in progress, seems a bad idea. \n* As Jaap points out, only developers want this information - not end users. \n\nI would be tempted to set it to 'needs work', but feel I can't really do so, since Open Solaris is not supported on Sage. So the fact an option breaks on an unsupported operating system is not a sufficiently good reason for rejecting it. But I would urge the person that created the ticket, or the reviewer to do so. (BTW, the Reviewer field is not filled in). \n\nDave",
    "created_at": "2010-01-29T06:43:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61913",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:25" align="right">comment:25</div>

I would also add I think adding profiling information by default is a bad idea. 
 
* Adding profiling information will slow the code quite considerably.
* The -pg option is not portable, so it would hamper efforts to build with a non-GNU compiler.
* The purposely add an option which is breaking a build on Open Solaris, when an Open Solaris port is in progress, seems a bad idea. 
* As Jaap points out, only developers want this information - not end users. 

I would be tempted to set it to 'needs work', but feel I can't really do so, since Open Solaris is not supported on Sage. So the fact an option breaks on an unsupported operating system is not a sufficiently good reason for rejecting it. But I would urge the person that created the ticket, or the reviewer to do so. (BTW, the Reviewer field is not filled in). 

Dave



---

archive/issue_events_100194.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-01-29T09:47:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100194"
}
```



---

archive/issue_events_100195.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-01-29T09:47:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100195"
}
```



---

archive/issue_comments_061914.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nGuys,\n\nno one wants to add -pg to the default options for Singular and no one did! Most Singular libraries are built in several flavours as explained above but not all of them are used of course. It's the build of an unused library that is going wrong.\n\nThere is a discussion on this issue on [libsingular-devel]:\n\n  http://groups.google.com/group/libsingular-devel/browse_thread/thread/43d157fe730e8798\n\nwhere Hans Sch\u00f6nemann suggested to patch omalloc. It is still puzzling why the build breaks now since IIRC nothing changed in that area.",
    "created_at": "2010-01-29T09:47:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61914",
    "user": "https://github.com/malb"
}
```

<div id="comment:26" align="right">comment:26</div>

Guys,

no one wants to add -pg to the default options for Singular and no one did! Most Singular libraries are built in several flavours as explained above but not all of them are used of course. It's the build of an unused library that is going wrong.

There is a discussion on this issue on [libsingular-devel]:

  http://groups.google.com/group/libsingular-devel/browse_thread/thread/43d157fe730e8798

where Hans Schönemann suggested to patch omalloc. It is still puzzling why the build breaks now since IIRC nothing changed in that area.



---

archive/issue_comments_061915.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nIs anybody working on patching the Makefiles? It might take a few days before I'll get around to do it.",
    "created_at": "2010-02-01T01:01:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61915",
    "user": "https://github.com/malb"
}
```

<div id="comment:27" align="right">comment:27</div>

Is anybody working on patching the Makefiles? It might take a few days before I'll get around to do it.



---

archive/issue_comments_061916.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@malb](#comment:27):\n> Is anybody working on patching the Makefiles? It might take a few days before I'll get around to do it.\n\nAre you getting around to do it?\n\nJaap",
    "created_at": "2010-02-05T14:51:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61916",
    "user": "https://github.com/jaapspies"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@malb](#comment:27):
> Is anybody working on patching the Makefiles? It might take a few days before I'll get around to do it.

Are you getting around to do it?

Jaap



---

archive/issue_comments_061917.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nNot yet, feel free to go ahead ;)",
    "created_at": "2010-02-05T14:54:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61917",
    "user": "https://github.com/malb"
}
```

<div id="comment:29" align="right">comment:29</div>

Not yet, feel free to go ahead ;)



---

archive/issue_comments_061918.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI thought about this patch-all-Makefiles approach some more. I came to the conclusion that it would be a bad idea. Jaap's GCC or the Singular's configuration script is broken. GCC accepts `-pg` and that GCC what is called. That it fails hints at either a bug in the OpenSolaris GCC or at a problem choosing the right assembler or linker. \n\nPatching all Makefiles would have serious repercussions: this patch would never be accepted upstream and thus we would have to go through a very tedious and error-prone process of patching every Makefile with every SPKG update. Since I am right now the only person who does these updates at the moment, I think I refuse to increase my workload like this based on one faulty setup. \n\nNote that I am happy to investigate and push upstream any fix which triggers this error in the configuration script. I want Sage to build and work on OpenSolaris and Solaris. It's just this approach which I deem incorrect.",
    "created_at": "2010-02-09T17:21:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61918",
    "user": "https://github.com/malb"
}
```

<div id="comment:30" align="right">comment:30</div>

I thought about this patch-all-Makefiles approach some more. I came to the conclusion that it would be a bad idea. Jaap's GCC or the Singular's configuration script is broken. GCC accepts `-pg` and that GCC what is called. That it fails hints at either a bug in the OpenSolaris GCC or at a problem choosing the right assembler or linker. 

Patching all Makefiles would have serious repercussions: this patch would never be accepted upstream and thus we would have to go through a very tedious and error-prone process of patching every Makefile with every SPKG update. Since I am right now the only person who does these updates at the moment, I think I refuse to increase my workload like this based on one faulty setup. 

Note that I am happy to investigate and push upstream any fix which triggers this error in the configuration script. I want Sage to build and work on OpenSolaris and Solaris. It's just this approach which I deem incorrect.



---

archive/issue_comments_061919.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nIf there are a lot of Makefiles, then patching would be tedious and require more work with upgrades. However, it should not be too hard to create a small script which patches the Makefiles and call that script from spkg-install. \n\nI've not checked this on the Singular sources, but this sed script, which I called 'nopg' could be used to replace ' -pg ' with nothing\n\n```\n#!/bin/sh \nsed 's/ -pg //g' $1 > /tmp/Makefile-without-pg-option.$$\nmv /tmp/Makefile-without-pg-option.$$  $1\n```\n\nthen in spkg-install have:\n\n```\nfind src -name Makefile -exec /path/to/nopg {} \\;\n```\n\nI tried it on a gcc source distribution, which has loads of 'configure' scripts, replacing 'echo' with 'zzzzzzzzzzzzzzzzz' and sure enough, all the configure script have strings of zzzzz's in them. \n\n\nIt would be necessary to check the files have the required changes, and no other changes, but that should be a simple solution. \n\nDave \n\nDave",
    "created_at": "2010-02-09T23:44:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61919",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:31" align="right">comment:31</div>

If there are a lot of Makefiles, then patching would be tedious and require more work with upgrades. However, it should not be too hard to create a small script which patches the Makefiles and call that script from spkg-install. 

I've not checked this on the Singular sources, but this sed script, which I called 'nopg' could be used to replace ' -pg ' with nothing

```
#!/bin/sh 
sed 's/ -pg //g' $1 > /tmp/Makefile-without-pg-option.$$
mv /tmp/Makefile-without-pg-option.$$  $1
```

then in spkg-install have:

```
find src -name Makefile -exec /path/to/nopg {} \;
```

I tried it on a gcc source distribution, which has loads of 'configure' scripts, replacing 'echo' with 'zzzzzzzzzzzzzzzzz' and sure enough, all the configure script have strings of zzzzz's in them. 


It would be necessary to check the files have the required changes, and no other changes, but that should be a simple solution. 

Dave 

Dave



---

archive/issue_comments_061920.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nPS, the substitution would be from ' -pg ' to nothing at all, so it would not break if files in the makefile have -pg in their names.",
    "created_at": "2010-02-09T23:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61920",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:32" align="right">comment:32</div>

PS, the substitution would be from ' -pg ' to nothing at all, so it would not break if files in the makefile have -pg in their names.



---

archive/issue_comments_061921.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThat indeed might be a viable solution. However, we should still investigate what exactly breaks Jaap's setup instead of working around the issue which we don't understand.",
    "created_at": "2010-02-10T00:35:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61921",
    "user": "https://github.com/malb"
}
```

<div id="comment:33" align="right">comment:33</div>

That indeed might be a viable solution. However, we should still investigate what exactly breaks Jaap's setup instead of working around the issue which we don't understand.



---

archive/issue_comments_061922.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nA new SPKG is available at #8228, you will need the attached patch for this ticket to make it work.",
    "created_at": "2010-02-10T13:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61922",
    "user": "https://github.com/malb"
}
```

<div id="comment:34" align="right">comment:34</div>

A new SPKG is available at #8228, you will need the attached patch for this ticket to make it work.



---

archive/issue_comments_061923.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI vote to review 3-1-0-9 without considering Jaap's bug and then opening a new ticket where Jaap gives more details so that we can address the bug. Right now, Sage crashes in a fairly basic situation and we thus should upgrade.",
    "created_at": "2010-03-03T12:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61923",
    "user": "https://github.com/malb"
}
```

<div id="comment:35" align="right">comment:35</div>

I vote to review 3-1-0-9 without considering Jaap's bug and then opening a new ticket where Jaap gives more details so that we can address the bug. Right now, Sage crashes in a fairly basic situation and we thus should upgrade.



---

archive/issue_comments_061924.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nMartin, this is probably not the question you want to hear, but: would it be worth it to go straight to 3-1-1, since it was just released?",
    "created_at": "2010-03-03T13:21:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61924",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:36" align="right">comment:36</div>

Martin, this is probably not the question you want to hear, but: would it be worth it to go straight to 3-1-1, since it was just released?



---

archive/issue_comments_061925.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@aghitza](#comment:36):\n> Martin, this is probably not the question you want to hear, but: would it be worth it to go straight to 3-1-1, since it was just released?\n\nI'll make you a deal: if you review it I'll make a Singular-3-1-1 SPKG :)",
    "created_at": "2010-03-03T13:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61925",
    "user": "https://github.com/malb"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@aghitza](#comment:36):
> Martin, this is probably not the question you want to hear, but: would it be worth it to go straight to 3-1-1, since it was just released?

I'll make you a deal: if you review it I'll make a Singular-3-1-1 SPKG :)



---

archive/issue_comments_061926.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nFine, I'll take that.  I should be able to do it this weekend.",
    "created_at": "2010-03-03T22:31:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61926",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:38" align="right">comment:38</div>

Fine, I'll take that.  I should be able to do it this weekend.



---

archive/issue_comments_061927.json:
```json
{
    "body": "Attachment: **[singular-3-1-1-0.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-0.patch.gz)**",
    "created_at": "2010-03-05T13:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61927",
    "user": "https://github.com/malb"
}
```

Attachment: **[singular-3-1-1-0.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-0.patch.gz)**



---

archive/issue_comments_061928.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nA new SPKG is available at\n\nhttp://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-0-20100305.spkg",
    "created_at": "2010-03-05T13:25:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61928",
    "user": "https://github.com/malb"
}
```

<div id="comment:39" align="right">comment:39</div>

A new SPKG is available at

http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-0-20100305.spkg



---

archive/issue_comments_061929.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThere are doctest failures in the scheme subdirectory. I reported one bug upstream already.",
    "created_at": "2010-03-05T13:26:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61929",
    "user": "https://github.com/malb"
}
```

<div id="comment:40" align="right">comment:40</div>

There are doctest failures in the scheme subdirectory. I reported one bug upstream already.



---

archive/issue_comments_061930.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nDoctest failures:\n\n```\nThe following tests failed:\n\n        sage -t  devel/sage/sage/schemes/plane_curves/projective_curve.py # 14 doctests failed\n        sage -t  devel/sage/sage/schemes/plane_curves/curve.py # 6 doctests failed\n        sage -t  devel/sage/sage/schemes/plane_curves/constructor.py # 6 doctests failed\n```",
    "created_at": "2010-03-05T14:31:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61930",
    "user": "https://github.com/malb"
}
```

<div id="comment:41" align="right">comment:41</div>

Doctest failures:

```
The following tests failed:

        sage -t  devel/sage/sage/schemes/plane_curves/projective_curve.py # 14 doctests failed
        sage -t  devel/sage/sage/schemes/plane_curves/curve.py # 6 doctests failed
        sage -t  devel/sage/sage/schemes/plane_curves/constructor.py # 6 doctests failed
```



---

archive/issue_comments_061931.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nAfter fixing a typo in a Singular routine\n\n  http://groups.google.com/group/libsingular-devel/browse_frm/thread/de4c7123c71f2150\n\nI get a bit further, but I need some help now:\n\nI assume '32' is wrong in the failure below?\n\n```python\nsage -t  \"devel/sage/sage/schemes/plane_curves/constructor.py\"\n**********************************************************************\nFile \"/mnt/usb1/scratch/malb/sage-4.3.3/devel/sage/sage/schemes/plane_curves/constructor.py\", line 72:\n    sage: C.genus()\nExpected:\n    0\nGot:\n    32\n```\n\n\nAm I correct that the following is also wrong?\n\n```python\nsage -t  \"devel/sage/sage/schemes/plane_curves/curve.py\"\n   ? ideal defines not a curve\n   ? leaving normal.lib::genus\n**********************************************************************\nFile \"/mnt/usb1/scratch/malb/sage-4.3.3/devel/sage/sage/schemes/plane_curves/curve.py\", line 79:\n    sage: C.geometric_genus()\n```",
    "created_at": "2010-03-05T14:40:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61931",
    "user": "https://github.com/malb"
}
```

<div id="comment:42" align="right">comment:42</div>

After fixing a typo in a Singular routine

  http://groups.google.com/group/libsingular-devel/browse_frm/thread/de4c7123c71f2150

I get a bit further, but I need some help now:

I assume '32' is wrong in the failure below?

```python
sage -t  "devel/sage/sage/schemes/plane_curves/constructor.py"
**********************************************************************
File "/mnt/usb1/scratch/malb/sage-4.3.3/devel/sage/sage/schemes/plane_curves/constructor.py", line 72:
    sage: C.genus()
Expected:
    0
Got:
    32
```


Am I correct that the following is also wrong?

```python
sage -t  "devel/sage/sage/schemes/plane_curves/curve.py"
   ? ideal defines not a curve
   ? leaving normal.lib::genus
**********************************************************************
File "/mnt/usb1/scratch/malb/sage-4.3.3/devel/sage/sage/schemes/plane_curves/curve.py", line 79:
    sage: C.geometric_genus()
```



---

archive/issue_comments_061932.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nThe different behaviour in pure Singular:\n\n```c\n> ring r = 7,(x,y),dp;\n> LIB(\"normal.lib\");\n> ideal i = x^10 + x^3 + y^2;\n> genus(i);\n32\n```",
    "created_at": "2010-03-05T14:48:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61932",
    "user": "https://github.com/malb"
}
```

<div id="comment:43" align="right">comment:43</div>

The different behaviour in pure Singular:

```c
> ring r = 7,(x,y),dp;
> LIB("normal.lib");
> ideal i = x^10 + x^3 + y^2;
> genus(i);
32
```



---

archive/issue_comments_061933.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nMartin, I just tried the new spkg but I'm running into trouble very quickly: after doing `sage -f ...`, I'm getting errors when doing `sage -b`\n\nThis is under sage-4.3.4.alpha0, and I got it now on two machines (including sage.math)",
    "created_at": "2010-03-07T01:14:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61933",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:44" align="right">comment:44</div>

Martin, I just tried the new spkg but I'm running into trouble very quickly: after doing `sage -f ...`, I'm getting errors when doing `sage -b`

This is under sage-4.3.4.alpha0, and I got it now on two machines (including sage.math)



---

archive/issue_comments_061934.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nDid you apply `singular-3-1-1-0.patch`?",
    "created_at": "2010-03-07T12:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61934",
    "user": "https://github.com/malb"
}
```

<div id="comment:45" align="right">comment:45</div>

Did you apply `singular-3-1-1-0.patch`?



---

archive/issue_comments_061935.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nHmmm  that's pretty embarrassing.\n\nSo it builds fine now.  Note that applying the patch to either 4.3.3 or 4.3.4.alpha0 results in one rejection.  It is actually harmless, but it might be good to rebase anyway.\n\nI'm pretty sure that the (geometric) genus should be 0 in the doctest that fails claiming it's 32.  (In particular, both Macaulay2 and Magma say 0.)\n\nI guess this should be reported upstream, since they know better what they've changed since 3-1-0-9 in normal.lib.",
    "created_at": "2010-03-08T02:49:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61935",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:46" align="right">comment:46</div>

Hmmm  that's pretty embarrassing.

So it builds fine now.  Note that applying the patch to either 4.3.3 or 4.3.4.alpha0 results in one rejection.  It is actually harmless, but it might be good to rebase anyway.

I'm pretty sure that the (geometric) genus should be 0 in the doctest that fails claiming it's 32.  (In particular, both Macaulay2 and Magma say 0.)

I guess this should be reported upstream, since they know better what they've changed since 3-1-0-9 in normal.lib.



---

archive/issue_comments_061936.json:
```json
{
    "body": "Upstream: **Fixed upstream, in a later stable release.**",
    "created_at": "2010-03-08T23:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61936",
    "user": "https://github.com/malb"
}
```

Upstream: **Fixed upstream, in a later stable release.**



---

archive/issue_comments_061937.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nThe bug I isolated above will be fixed in the next release:\n\n```\nHi Martin,\n\nThank you for reporting this bug.\nIt will be corrected in the next release.\n\nGert-Martin\n\n\n2010/3/8 Martin Albrecht <malb@informatik.uni-bremen.de>:\n> Hi,\n>\n> the following output is wrong in 3-1-1-0 and was correct in the previous\n> version:\n>\n>> ring r = 7,(x,y),dp;\n>> LIB(\"normal.lib\");\n>> ideal i = x^10 + x^3 + y^2;\n>> genus(i);\n> 32 //should be 0\n```\n\nWe should try to make sure that we report all bugs (I think there is another one were curves are considered not to be curves) before they cut the new release.",
    "created_at": "2010-03-08T23:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61937",
    "user": "https://github.com/malb"
}
```

<div id="comment:47" align="right">comment:47</div>

The bug I isolated above will be fixed in the next release:

```
Hi Martin,

Thank you for reporting this bug.
It will be corrected in the next release.

Gert-Martin


2010/3/8 Martin Albrecht <malb@informatik.uni-bremen.de>:
> Hi,
>
> the following output is wrong in 3-1-1-0 and was correct in the previous
> version:
>
>> ring r = 7,(x,y),dp;
>> LIB("normal.lib");
>> ideal i = x^10 + x^3 + y^2;
>> genus(i);
> 32 //should be 0
```

We should try to make sure that we report all bugs (I think there is another one were curves are considered not to be curves) before they cut the new release.



---

archive/issue_comments_061938.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\n> We should try to make sure that we report all bugs (I think there is another one were curves are considered not to be curves) before they cut the new release.\n\nYep.  If I have some time (cross fingers) I'll try to test 3-1-1-0 with a few more examples and see if I catch anything else.  Any idea what the timeline is for the new release?",
    "created_at": "2010-03-09T11:32:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61938",
    "user": "https://github.com/aghitza"
}
```

<div id="comment:48" align="right">comment:48</div>

> We should try to make sure that we report all bugs (I think there is another one were curves are considered not to be curves) before they cut the new release.

Yep.  If I have some time (cross fingers) I'll try to test 3-1-1-0 with a few more examples and see if I catch anything else.  Any idea what the timeline is for the new release?



---

archive/issue_comments_061939.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nNo idea, but I just reported another bug upstream:\n\n```c\n> ring r = 5,(x,y,z),dp;\n> ideal i = -x^3 + y^2*z - 2*x*z^2 + y*z^2;\n> LIB(\"normal.lib\");\n> genus(i);\n   ? ideal defines not a curve\n   ? leaving normal.lib::genus\n```\n\nAnother thing we might want to tackle is that it seems that our libsingular interface isn't very good at recovering from errors. I'm not sure how to address this; I guess I'll ask upstream some time.",
    "created_at": "2010-03-09T11:35:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61939",
    "user": "https://github.com/malb"
}
```

<div id="comment:49" align="right">comment:49</div>

No idea, but I just reported another bug upstream:

```c
> ring r = 5,(x,y,z),dp;
> ideal i = -x^3 + y^2*z - 2*x*z^2 + y*z^2;
> LIB("normal.lib");
> genus(i);
   ? ideal defines not a curve
   ? leaving normal.lib::genus
```

Another thing we might want to tackle is that it seems that our libsingular interface isn't very good at recovering from errors. I'm not sure how to address this; I guess I'll ask upstream some time.



---

archive/issue_comments_061940.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReply from upstream:\n\n```\nThis is not a bug, Singular computes only the genus\nof a curve, as is said in the manual:\n\ngenus(i) or genus(i,1); I a 1-dimensional ideal\n\nIn the example the ideal defines a surface.\nGert-Martin\n\n2010/3/9  <owner-singular-team@mathematik.uni-kl.de>:\n> #212: wrong computation of genus / error when calling genus\n> --------------------------------------------------------------+-------------\n>  Reporter:  Martin Albrecht <malb@\u2026                           |       Owner:  somebody\n>     Type:  defect                                            |      Status:  new\n>  Priority:  minor                                             |   Milestone:  Releases 3-1-1 and higher\n> Component:  singular-libs                                     |     Version:  3-1-1\n>  Keywords:  genus                                             |\n> --------------------------------------------------------------+-------------\n>\n> Comment(by seelisch):\n>\n>  Here's another bug related to genus:\n>\n>  > ring r = 5,(x,y,z),dp;\n>  > > ideal i = -x3 + y2*z - 2*x*z2 + y*z2;\n>  > > LIB(\"normal.lib\");\n>  > > genus(i);\n>    ? ideal defines not a curve\n>    ? leaving normal.lib::genus\n```\n\n\nAlex, can you look into this?",
    "created_at": "2010-03-09T14:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61940",
    "user": "https://github.com/malb"
}
```

<div id="comment:50" align="right">comment:50</div>

Reply from upstream:

```
This is not a bug, Singular computes only the genus
of a curve, as is said in the manual:

genus(i) or genus(i,1); I a 1-dimensional ideal

In the example the ideal defines a surface.
Gert-Martin

2010/3/9  <owner-singular-team@mathematik.uni-kl.de>:
> #212: wrong computation of genus / error when calling genus
> --------------------------------------------------------------+-------------
>  Reporter:  Martin Albrecht <malb@…                           |       Owner:  somebody
>     Type:  defect                                            |      Status:  new
>  Priority:  minor                                             |   Milestone:  Releases 3-1-1 and higher
> Component:  singular-libs                                     |     Version:  3-1-1
>  Keywords:  genus                                             |
> --------------------------------------------------------------+-------------
>
> Comment(by seelisch):
>
>  Here's another bug related to genus:
>
>  > ring r = 5,(x,y,z),dp;
>  > > ideal i = -x3 + y2*z - 2*x*z2 + y*z2;
>  > > LIB("normal.lib");
>  > > genus(i);
>    ? ideal defines not a curve
>    ? leaving normal.lib::genus
```


Alex, can you look into this?



---

archive/issue_comments_061941.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\n\n```\nDear Martin,\n\nI realize that the example was a homogeneous\npolynomial in 3 variables. So, this can be interpreted\nas an affine surface but also as a homogeneous curve.\n\nProbably the second was meant. In this case it makes\nsense to compute the genus. We shall take care\nabout this in the next release.\n\nBest,\nGert-Martin\n```",
    "created_at": "2010-03-09T22:12:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61941",
    "user": "https://github.com/malb"
}
```

<div id="comment:51" align="right">comment:51</div>


```
Dear Martin,

I realize that the example was a homogeneous
polynomial in 3 variables. So, this can be interpreted
as an affine surface but also as a homogeneous curve.

Probably the second was meant. In this case it makes
sense to compute the genus. We shall take care
about this in the next release.

Best,
Gert-Martin
```



---

archive/issue_comments_061942.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nThere's a new Singular version at\n\n   http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/3-1-1/\n\nwhich might or might not fix the bug",
    "created_at": "2010-06-02T18:44:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61942",
    "user": "https://github.com/malb"
}
```

<div id="comment:52" align="right">comment:52</div>

There's a new Singular version at

   http://www.mathematik.uni-kl.de/ftp/pub/Math/Singular/SOURCES/3-1-1/

which might or might not fix the bug



---

archive/issue_comments_061943.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nI've updated the Singular SPKG to 3-1-1-3 which fixes the genus issue. However, this release segfaults a lot! I'm in the process of resolving this (cf. [libsingular-devel])\n\nhttp://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-3.p0.spkg",
    "created_at": "2010-07-10T14:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61943",
    "user": "https://github.com/malb"
}
```

<div id="comment:53" align="right">comment:53</div>

I've updated the Singular SPKG to 3-1-1-3 which fixes the genus issue. However, this release segfaults a lot! I'm in the process of resolving this (cf. [libsingular-devel])

http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-3.p0.spkg



---

archive/issue_comments_061944.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@malb](#comment:53):\n> I've updated the Singular SPKG to 3-1-1-3 which fixes the genus issue. However, this release segfaults a lot! I'm in the process of resolving this (cf. [libsingular-devel])\n> \n> http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-3.p0.spkg\n\nHi Martin Albrecht , \nA few comments. \n\n* Is it possible you could request the upstream developers distribute the source code so the files generated by tools like autoconf, flex, actually have later modification times of the generated file newer than the file they are generated from? \n\nCurrently libparse.cc, which is the output from 'flex' has exactly the same modification time (to the ns) as the file it was supposedly generated from (libparse.l). I doubt 'flex' actually run in < 1 ns!\n\n```\n-rw-r-----   1 drkirkby staff     109422 2010-02-03 13:58:03.000000000 +0000 src/Singular/libparse.cc\n-rw-r-----   1 drkirkby staff      30875 2010-02-03 13:58:03.000000000 +0000 src/Singular/libparse.l\n```\nLikewise for these files. Clearly autoconf did not run in under a ns. \n\n```\n-rwxr-x---   1 drkirkby staff      85614 2010-03-03 11:36:23.000000000 +0000 src/factory/configure\n-rw-r-----   1 drkirkby staff      13992 2010-03-03 11:36:23.000000000 +0000 src/factory/configure.in\n```\n\nThis will save us having to 'touch' the files. \n\n* There's a problem with the `build()` part of spkg-install. \n\nThe script author probably assumes that if any one of the items in `build()` fail, then `build()` will fail and so the error will be reported. However, that is not the case. As long as the last item in `build()`, which is (`install_docs`), does not fail, the return code from `build()` will be 0. So if for example I modify the `build()` section to:\n\n```\nbuild()\n{\n    clean_headers\n    # This SHOULD break the build\n    rm /non-existant-file\n\n    patch\n\n    distclean\n\n    config \n\n    build_singular\n\n    build_libsingular\n \n    build_factory\n\n    build_libfac\n\n    create_singular_script\n\n    install_docs\n}\n\nbuild\n\nif [ $? -ne 0 ]; then\n    echo \"Error somewhere building Singular.\"\n    exit 1\nfi\n\n```\n\nthen when I build Singular, I see:\n\n```\nBuilding a 64-bit version of Singular\nrm: /non-existant-file: No such file or directory\nmake: *** No rule to make target `distclean'.  Stop.\ncreating cache ./config.cache\nchecking uname for singular... ix86-SunOS\nchecking for gcc... gcc -m64\n...\nSuccessfully installed singular-3-1-1-3.p1\n```\n\nIn other words, the error of trying to delete  /non-existant-file does not cause the build to fail, as it should do. That means if the library fails to build, but the docuemtation installs ok, then the script will not show the error. Each part should be checked individually. \n\nI've not checked this, but believe the following would work:\n\n```\nbuild()\n{\n   for i in clean_headers patch distclean config build_singular build_libsingular build_factory build_libfac create_singular_script install_docs ; do\n   $i\n   if [ $? -ne 0 ]; then\n     echo \"Error building Singular when running '$i'.\"\n     exit 1\n   fi\n   done\n}\n```\n\n* There are in fact a lot of parts in spkg-install which are not checked for errors. \n\n* Fran\u00e7ois Bissey has said the previous version of Singular built some unnecessary targets, which adds to the build time of Singular. Given this is the longest package to build (taking almost 6 minutes on my PC), it would be worth reducing them if you have not already done so. I've cc'ed Fran\u00e7ois on the ticket, as he knows a lot more about this package than me. \n\n* It does built on OpenSolaris, though I've not checked it on anything else. I'll wait until you have sorted out the segfaults first!\n\nPS, The first 3-1-1-3 to go into Sage should be called singular-3-1-1-3.spkg and not have a '.p0' in the name. \n\nDave",
    "created_at": "2010-07-10T20:44:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61944",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@malb](#comment:53):
> I've updated the Singular SPKG to 3-1-1-3 which fixes the genus issue. However, this release segfaults a lot! I'm in the process of resolving this (cf. [libsingular-devel])
> 
> http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-3.p0.spkg

Hi Martin Albrecht , 
A few comments. 

* Is it possible you could request the upstream developers distribute the source code so the files generated by tools like autoconf, flex, actually have later modification times of the generated file newer than the file they are generated from? 

Currently libparse.cc, which is the output from 'flex' has exactly the same modification time (to the ns) as the file it was supposedly generated from (libparse.l). I doubt 'flex' actually run in < 1 ns!

```
-rw-r-----   1 drkirkby staff     109422 2010-02-03 13:58:03.000000000 +0000 src/Singular/libparse.cc
-rw-r-----   1 drkirkby staff      30875 2010-02-03 13:58:03.000000000 +0000 src/Singular/libparse.l
```
Likewise for these files. Clearly autoconf did not run in under a ns. 

```
-rwxr-x---   1 drkirkby staff      85614 2010-03-03 11:36:23.000000000 +0000 src/factory/configure
-rw-r-----   1 drkirkby staff      13992 2010-03-03 11:36:23.000000000 +0000 src/factory/configure.in
```

This will save us having to 'touch' the files. 

* There's a problem with the `build()` part of spkg-install. 

The script author probably assumes that if any one of the items in `build()` fail, then `build()` will fail and so the error will be reported. However, that is not the case. As long as the last item in `build()`, which is (`install_docs`), does not fail, the return code from `build()` will be 0. So if for example I modify the `build()` section to:

```
build()
{
    clean_headers
    # This SHOULD break the build
    rm /non-existant-file

    patch

    distclean

    config 

    build_singular

    build_libsingular
 
    build_factory

    build_libfac

    create_singular_script

    install_docs
}

build

if [ $? -ne 0 ]; then
    echo "Error somewhere building Singular."
    exit 1
fi

```

then when I build Singular, I see:

```
Building a 64-bit version of Singular
rm: /non-existant-file: No such file or directory
make: *** No rule to make target `distclean'.  Stop.
creating cache ./config.cache
checking uname for singular... ix86-SunOS
checking for gcc... gcc -m64
...
Successfully installed singular-3-1-1-3.p1
```

In other words, the error of trying to delete  /non-existant-file does not cause the build to fail, as it should do. That means if the library fails to build, but the docuemtation installs ok, then the script will not show the error. Each part should be checked individually. 

I've not checked this, but believe the following would work:

```
build()
{
   for i in clean_headers patch distclean config build_singular build_libsingular build_factory build_libfac create_singular_script install_docs ; do
   $i
   if [ $? -ne 0 ]; then
     echo "Error building Singular when running '$i'."
     exit 1
   fi
   done
}
```

* There are in fact a lot of parts in spkg-install which are not checked for errors. 

* François Bissey has said the previous version of Singular built some unnecessary targets, which adds to the build time of Singular. Given this is the longest package to build (taking almost 6 minutes on my PC), it would be worth reducing them if you have not already done so. I've cc'ed François on the ticket, as he knows a lot more about this package than me. 

* It does built on OpenSolaris, though I've not checked it on anything else. I'll wait until you have sorted out the segfaults first!

PS, The first 3-1-1-3 to go into Sage should be called singular-3-1-1-3.spkg and not have a '.p0' in the name. 

Dave



---

archive/issue_comments_061945.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n The Singular team accepted most of our patches upstream. They are in the 3-1-0-9 release, which also is a first step to make things easier for library developers.\n+\n+\n``````\n",
    "created_at": "2010-07-10T20:44:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61945",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 The Singular team accepted most of our patches upstream. They are in the 3-1-0-9 release, which also is a first step to make things easier for library developers.
+
+
``````




---

archive/issue_comments_061946.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nThanks for adding me Dave I will update my patch to simplify slightly\nthe build to this version of singular. I know from experience in sage-on-gentoo\nthat sage will build and the tests will be ok if you remove the build_factory\nand build_libfac targets. \nAs a bonus the creation of the link LIB to lib is 1) bogus 2) useless.\nIn a build of singular LIB usually contains the the *.lib files. Those files\nare installed in share/singular thanks to some of the instructions in the build.\nBefore being removed and recreated the link actually points to share/singular.\nRemoving the link didn't harm any tests.\n\nThe only issue with removing these 2 targets may be the optional Macaulay2\nspkg. We have some discussions atm in gentoo about singular - the components\nit provides - and Macaulay2. So while sage builds ok, Macaulay2 should be checked.",
    "created_at": "2010-07-10T22:54:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61946",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:55" align="right">comment:55</div>

Thanks for adding me Dave I will update my patch to simplify slightly
the build to this version of singular. I know from experience in sage-on-gentoo
that sage will build and the tests will be ok if you remove the build_factory
and build_libfac targets. 
As a bonus the creation of the link LIB to lib is 1) bogus 2) useless.
In a build of singular LIB usually contains the the *.lib files. Those files
are installed in share/singular thanks to some of the instructions in the build.
Before being removed and recreated the link actually points to share/singular.
Removing the link didn't harm any tests.

The only issue with removing these 2 targets may be the optional Macaulay2
spkg. We have some discussions atm in gentoo about singular - the components
it provides - and Macaulay2. So while sage builds ok, Macaulay2 should be checked.



---

archive/issue_comments_061947.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@malb](#comment:53):\n> I've updated the Singular SPKG to 3-1-1-3 which fixes the genus issue. However, this release segfaults a lot! \n\nHi Martin, \n\ndo you see this warning message about `warning: returning reference to temporary`? I got that warnings when building on OpenSolaris - see below. \n\n```\ng++ -m64 -O2 -g -m64 -fPIC -pipe -fno-implicit-templates -I. -I../kernel -I/export/home/drkirkby/sage-4.5.alpha4/local/include -I/export/home/drkirkby/sage-4.5.alpha4/local/include -I/export/home/drkirkby/sage-4.5.alpha4/local/include -O2 -g -m64 -DNDEBUG -DOM_NDEBUG -Dix86_SunOS -DHAVE_CONFIG_H -c iparith.cc\nIn file included from ../kernel/ring.h:13,\n                 from subexpr.h:16,\n                 from ipid.h:13,\n                 from iparith.cc:20:\n../kernel/polys-impl.h:177:1: warning: \"pPolyAssumeReturn\" redefined\n../kernel/polys-impl.h:176:1: warning: this is the location of the previous definition\nIn file included from ../kernel/walkMain.h:5,\n                 from ../kernel/walkProc.h:3,\n                 from iparith.cc:56:\n../kernel/int64vec.h: In member function 'const int& int64vec::operator[](int) const':\n../kernel/int64vec.h:51: warning: returning reference to temporary\n```\n\nThat sounds the sort of error which could result in segfaults. \n\nI'm attaching a patch which gives much improved error checking.\n\nDave",
    "created_at": "2010-07-11T08:56:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61947",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@malb](#comment:53):
> I've updated the Singular SPKG to 3-1-1-3 which fixes the genus issue. However, this release segfaults a lot! 

Hi Martin, 

do you see this warning message about `warning: returning reference to temporary`? I got that warnings when building on OpenSolaris - see below. 

```
g++ -m64 -O2 -g -m64 -fPIC -pipe -fno-implicit-templates -I. -I../kernel -I/export/home/drkirkby/sage-4.5.alpha4/local/include -I/export/home/drkirkby/sage-4.5.alpha4/local/include -I/export/home/drkirkby/sage-4.5.alpha4/local/include -O2 -g -m64 -DNDEBUG -DOM_NDEBUG -Dix86_SunOS -DHAVE_CONFIG_H -c iparith.cc
In file included from ../kernel/ring.h:13,
                 from subexpr.h:16,
                 from ipid.h:13,
                 from iparith.cc:20:
../kernel/polys-impl.h:177:1: warning: "pPolyAssumeReturn" redefined
../kernel/polys-impl.h:176:1: warning: this is the location of the previous definition
In file included from ../kernel/walkMain.h:5,
                 from ../kernel/walkProc.h:3,
                 from iparith.cc:56:
../kernel/int64vec.h: In member function 'const int& int64vec::operator[](int) const':
../kernel/int64vec.h:51: warning: returning reference to temporary
```

That sounds the sort of error which could result in segfaults. 

I'm attaching a patch which gives much improved error checking.

Dave



---

archive/issue_comments_061948.json:
```json
{
    "body": "Based on Martin's singular-3-1-1-3 package, but with improved error checking.",
    "created_at": "2010-07-11T09:08:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61948",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Based on Martin's singular-3-1-1-3 package, but with improved error checking.



---

archive/issue_comments_061949.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nAttachment: **[8059-improved-error-checking.patch.gz](https://github.com/sagemath/sage/files/ticket8059/8059-improved-error-checking.patch.gz)**\n\nI just realised I copied a bit too little of that warning message. The message is about returning reference to temporary memory:\n\n```\n../kernel/int64vec.h:51: warning: returning reference to temporary memory\n```\n\nThat looks like it could result in segfaults to me. \n\nDave",
    "created_at": "2010-07-11T09:12:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61949",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:57" align="right">comment:57</div>

Attachment: **[8059-improved-error-checking.patch.gz](https://github.com/sagemath/sage/files/ticket8059/8059-improved-error-checking.patch.gz)**

I just realised I copied a bit too little of that warning message. The message is about returning reference to temporary memory:

```
../kernel/int64vec.h:51: warning: returning reference to temporary memory
```

That looks like it could result in segfaults to me. 

Dave



---

archive/issue_comments_061950.json:
```json
{
    "body": "Attachment: **[simplify-singular.patch.gz](https://github.com/sagemath/sage/files/ticket8059/simplify-singular.patch.gz)**\n\nSimplify the building of singular",
    "created_at": "2010-07-11T09:53:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61950",
    "user": "https://github.com/kiwifb"
}
```

Attachment: **[simplify-singular.patch.gz](https://github.com/sagemath/sage/files/ticket8059/simplify-singular.patch.gz)**

Simplify the building of singular



---

archive/issue_comments_061951.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\n> The only issue with removing these 2 targets may be the optional Macaulay2 spkg. We > have some discussions atm in gentoo about singular - the components it provides - \n> and Macaulay2. So while sage builds ok, Macaulay2 should be checked.\n\nI'm pretty sure Macaulay2 will fail if we drop libfac and libcf. Thus I'm not applying the second patch for now.",
    "created_at": "2010-07-11T12:51:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61951",
    "user": "https://github.com/malb"
}
```

<div id="comment:58" align="right">comment:58</div>

> The only issue with removing these 2 targets may be the optional Macaulay2 spkg. We > have some discussions atm in gentoo about singular - the components it provides - 
> and Macaulay2. So while sage builds ok, Macaulay2 should be checked.

I'm pretty sure Macaulay2 will fail if we drop libfac and libcf. Thus I'm not applying the second patch for now.



---

archive/issue_comments_061952.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nI've applied David's patch to \n\n   http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-3.spkg\n\nand also changed the name in accordance with his comments. I've also forwarded David's comments to the Singular team at:\n\nhttp://groups.google.com/group/libsingular-devel/browse_thread/thread/e67e6b2afe1d8314",
    "created_at": "2010-07-11T12:58:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61952",
    "user": "https://github.com/malb"
}
```

<div id="comment:59" align="right">comment:59</div>

I've applied David's patch to 

   http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-3.spkg

and also changed the name in accordance with his comments. I've also forwarded David's comments to the Singular team at:

http://groups.google.com/group/libsingular-devel/browse_thread/thread/e67e6b2afe1d8314



---

archive/issue_comments_061953.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nReplying to [@malb](#comment:58):\n> > The only issue with removing these 2 targets may be the optional Macaulay2 spkg. We > have some discussions atm in gentoo about singular - the components it provides - \n> > and Macaulay2. So while sage builds ok, Macaulay2 should be checked.\n\n> \n> I'm pretty sure Macaulay2 will fail if we drop libfac and libcf. Thus I'm not applying the second patch for now.\n\nIt would be good if this Macaulay2 could be made to rebuild Singular in this case. Perhaps have an environment variable that determines if those two targets are built or not. \n\n```\nbuild() \n{\n    patch\n    distclean\n    config \n    build_singular\n    build_libsingular\n    if [ \"x$SAGE_USING_Macaulay2\" = xyes  ] ; then  \n       build_factory\n       build_libfac\n    fi\n    create_singular_script\n    install_docs\n} \n```\nThen ensure Macaulay2 \n\n* exports SAGE_USING_Macaulay2 = \"yes\"\n* Rebuilds Singular. This time build_factory & build_libfac would built, due to the environment variable being set to \"yes\"\n\nI guess this depends on the popularity of Macaulay2. If 20% of people install it, then we might as well build all targets. If however only 1% of people install Macaulay2, then I doubt it warrants slowing the build process for everyone. \n\nCurrently I believe Singular is the slowest package to build in Sage (at least on my OpenSolaris machine), though neither R or Maxima are building, so I can't say for sure. But Singular definately takes a long time to build, so if that could be improved, it would be nice. Of course, it depends on how long those targets take to build. If the savings from not building them are only small, we might as well build them. \n\nAnother option might be to let an environment variable be used to stop those two targets building, but by default build them all. \n\nDave",
    "created_at": "2010-07-11T21:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61953",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:60" align="right">comment:60</div>

Replying to [@malb](#comment:58):
> > The only issue with removing these 2 targets may be the optional Macaulay2 spkg. We > have some discussions atm in gentoo about singular - the components it provides - 
> > and Macaulay2. So while sage builds ok, Macaulay2 should be checked.

> 
> I'm pretty sure Macaulay2 will fail if we drop libfac and libcf. Thus I'm not applying the second patch for now.

It would be good if this Macaulay2 could be made to rebuild Singular in this case. Perhaps have an environment variable that determines if those two targets are built or not. 

```
build() 
{
    patch
    distclean
    config 
    build_singular
    build_libsingular
    if [ "x$SAGE_USING_Macaulay2" = xyes  ] ; then  
       build_factory
       build_libfac
    fi
    create_singular_script
    install_docs
} 
```
Then ensure Macaulay2 

* exports SAGE_USING_Macaulay2 = "yes"
* Rebuilds Singular. This time build_factory & build_libfac would built, due to the environment variable being set to "yes"

I guess this depends on the popularity of Macaulay2. If 20% of people install it, then we might as well build all targets. If however only 1% of people install Macaulay2, then I doubt it warrants slowing the build process for everyone. 

Currently I believe Singular is the slowest package to build in Sage (at least on my OpenSolaris machine), though neither R or Maxima are building, so I can't say for sure. But Singular definately takes a long time to build, so if that could be improved, it would be nice. Of course, it depends on how long those targets take to build. If the savings from not building them are only small, we might as well build them. 

Another option might be to let an environment variable be used to stop those two targets building, but by default build them all. 

Dave



---

archive/issue_comments_061954.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nTo build both singular and Macaulay2 our current approach\nis too try to build omalloc factory and libfac first, and then move on to the \nrest of singular/Macaulay2. That approach makes sense in the context of Gentoo.\nIf it works I may try to adapt the singular spkg build process to match it.\n\nIt is not a done deal that this approach will work however.\n\nFrancois",
    "created_at": "2010-07-11T21:59:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61954",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:61" align="right">comment:61</div>

To build both singular and Macaulay2 our current approach
is too try to build omalloc factory and libfac first, and then move on to the 
rest of singular/Macaulay2. That approach makes sense in the context of Gentoo.
If it works I may try to adapt the singular spkg build process to match it.

It is not a done deal that this approach will work however.

Francois



---

archive/issue_comments_061955.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nIf you don't mind I'd suggest to open a new ticket to address the libfac issue (by including libfac in the Macaulay SPKG for example). Right now, we have crashes in Sage because of bugs in older versions of Singular and I'd like to focus on fixing those for now. With the updated patch I'll attach in a minute, I'm down to two doctest failures with the most recent Singular version:\n\n```\nsage -t  devel/sage/sage/rings/polynomial/toy_d_basis.py # 3 doctests failed\nsage -t  devel/sage/sage/rings/polynomial/multi_polynomial_element.py # 4 doctests failed\n```",
    "created_at": "2010-07-12T15:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61955",
    "user": "https://github.com/malb"
}
```

<div id="comment:62" align="right">comment:62</div>

If you don't mind I'd suggest to open a new ticket to address the libfac issue (by including libfac in the Macaulay SPKG for example). Right now, we have crashes in Sage because of bugs in older versions of Singular and I'd like to focus on fixing those for now. With the updated patch I'll attach in a minute, I'm down to two doctest failures with the most recent Singular version:

```
sage -t  devel/sage/sage/rings/polynomial/toy_d_basis.py # 3 doctests failed
sage -t  devel/sage/sage/rings/polynomial/multi_polynomial_element.py # 4 doctests failed
```



---

archive/issue_comments_061956.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, in a later stable release.** to **Reported upstream. Little or no feedback.**",
    "created_at": "2010-07-12T15:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61956",
    "user": "https://github.com/malb"
}
```

Changed upstream from **Fixed upstream, in a later stable release.** to **Reported upstream. Little or no feedback.**



---

archive/issue_comments_061957.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@malb](#comment:62):\n> If you don't mind I'd suggest to open a new ticket to address the libfac issue (by including libfac in the Macaulay SPKG for example). \n\nNo problem. That makes sence. \n\nDave",
    "created_at": "2010-07-12T16:06:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61957",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@malb](#comment:62):
> If you don't mind I'd suggest to open a new ticket to address the libfac issue (by including libfac in the Macaulay SPKG for example). 

No problem. That makes sence. 

Dave



---

archive/issue_comments_061958.json:
```json
{
    "body": "Attachment: **[singular-3-1-1-3.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-3.patch.gz)**\n\nfixed many SIGSEGVs",
    "created_at": "2010-07-12T22:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61958",
    "user": "https://github.com/malb"
}
```

Attachment: **[singular-3-1-1-3.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-3.patch.gz)**

fixed many SIGSEGVs



---

archive/issue_comments_061959.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nI've updated the singular-3-1-1-3.spkg according to Hans' comments on [libsingular-devel] and reverted some overly aggressive changes to singuler-3-1-1-3.patch. With this I'm down to one problem:\n\n```\nsage -t  \"devel/sage/sage/rings/polynomial/toy_d_basis.py\"  \n\n**********************************************************************\n\nFile \"/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/rings/polynomial/toy_d_basis.py\", line 38:\n\nsage: gb = d_basis(I); gb\n\nExpected:\n\n[x - 2020, y - 11313, 22627]\n\nGot:\n\n[1]\n\n**********************************************************************\n\nFile \"/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/rings/polynomial/toy_d_basis.py\", line 41:\n\nsage: gb[-1].factor()\n\nExpected:\n\n11^3 * 17\n\nGot:\n\n1\n\n**********************************************************************\n\nFile \"/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/rings/polynomial/toy_d_basis.py\", line 208:\n\nsage: gb = d_basis(I); gb\n\nExpected:\n\n[x - 2020, y - 11313, 22627]\n\nGot:\n\n\u00a0   [1]\n```",
    "created_at": "2010-07-12T22:57:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61959",
    "user": "https://github.com/malb"
}
```

<div id="comment:64" align="right">comment:64</div>

I've updated the singular-3-1-1-3.spkg according to Hans' comments on [libsingular-devel] and reverted some overly aggressive changes to singuler-3-1-1-3.patch. With this I'm down to one problem:

```
sage -t  "devel/sage/sage/rings/polynomial/toy_d_basis.py"  

**********************************************************************

File "/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/rings/polynomial/toy_d_basis.py", line 38:

sage: gb = d_basis(I); gb

Expected:

[x - 2020, y - 11313, 22627]

Got:

[1]

**********************************************************************

File "/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/rings/polynomial/toy_d_basis.py", line 41:

sage: gb[-1].factor()

Expected:

11^3 * 17

Got:

1

**********************************************************************

File "/mnt/usb1/scratch/malb/sage-4.4/devel/sage/sage/rings/polynomial/toy_d_basis.py", line 208:

sage: gb = d_basis(I); gb

Expected:

[x - 2020, y - 11313, 22627]

Got:

    [1]
```



---

archive/issue_events_100196.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-07-15T17:12:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100196"
}
```



---

archive/issue_events_100197.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-07-15T17:12:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100197"
}
```



---

archive/issue_comments_061960.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nAttachment: **[singular-3-1-1-4.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.patch.gz)**\n\nThe Singular team cut us a new release which\n\n* passes all doctests on sage.math\n* supports parallel make\n\nThe SPKG is at\n\nhttp://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg",
    "created_at": "2010-07-15T17:12:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61960",
    "user": "https://github.com/malb"
}
```

<div id="comment:65" align="right">comment:65</div>

Attachment: **[singular-3-1-1-4.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.patch.gz)**

The Singular team cut us a new release which

* passes all doctests on sage.math
* supports parallel make

The SPKG is at

http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg



---

archive/issue_comments_061961.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\n**On sage.math:**\n\n**make -j 20**\n\n```\nreal    3m55.543\nuser    8m10.720\nsys     0m49.920s\n```\n\n\n**make**\n\n```\nreal    8m12.656s\nuser    7m39.400s\nsys     0m43.580s\n```",
    "created_at": "2010-07-15T17:19:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61961",
    "user": "https://github.com/malb"
}
```

<div id="comment:66" align="right">comment:66</div>

**On sage.math:**

**make -j 20**

```
real    3m55.543
user    8m10.720
sys     0m49.920s
```


**make**

```
real    8m12.656s
user    7m39.400s
sys     0m43.580s
```



---

archive/issue_comments_061962.json:
```json
{
    "body": "Reviewer: **David Kirkby**",
    "created_at": "2010-07-15T17:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61962",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Reviewer: **David Kirkby**



---

archive/issue_events_100198.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-07-15T17:29:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100198"
}
```



---

archive/issue_events_100199.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-07-15T17:29:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100199"
}
```



---

archive/issue_comments_061963.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nOn a Sun Ultra 27 (3.33 GHz, quad core, 8 threads), running OpenSolaris:\n\n```\ndrkirkby@hawk:~/sage-4.5.rc0$ echo $MAKE\nmake -j12\n```\nthe build fails with:\n\n```\ng++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/csutil.cc -o OPTOBJ/csutil.o\ng++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/charset.cc -o OPTOBJ/charset.o\nAssembler messages:\nFatal error: can't create OPTOBJ/version.o: No such file or directory\ng++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/reorder.cc -o OPTOBJ/reorder.o\ng++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/alg_factor.cc -o OPTOBJ/alg_factor.o\nmake[2]: *** [OPTOBJ/version.o] Error 1\nmake[2]: *** Waiting for unfinished jobs....\nmkdir OPTOBJ\nmake[2]: Leaving directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/singular-3-1-1-4/src/libfac'\nmake[1]: *** [install] Error 1\nmake[1]: Leaving directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/singular-3-1-1-4/src'\nmake: *** [/export/home/drkirkby/sage-4.5.rc0/local/bin/Singular-3-1-1] Error 2\nUnable to build Singular.\n\nreal    0m18.232s\nuser    1m18.531s\nsys     0m8.304s\nsage: An error occurred while installing singular-3-1-1-4\n\n```\n\nThe previous version did build on this machine. It looks to me like the parallel building is not working correctly, as it is trying to use \nHave you checked on 't2.amth' and/or 'bsd.math'? \n\nI simply don't have time to check everyone's packages on Solaris. I alway try to check that mind at least build on Solaris, Linux and OS X. \n\nDave",
    "created_at": "2010-07-15T17:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61963",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:67" align="right">comment:67</div>

On a Sun Ultra 27 (3.33 GHz, quad core, 8 threads), running OpenSolaris:

```
drkirkby@hawk:~/sage-4.5.rc0$ echo $MAKE
make -j12
```
the build fails with:

```
g++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/csutil.cc -o OPTOBJ/csutil.o
g++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/charset.cc -o OPTOBJ/charset.o
Assembler messages:
Fatal error: can't create OPTOBJ/version.o: No such file or directory
g++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/reorder.cc -o OPTOBJ/reorder.o
g++ -m64 -O2 -g -m64 -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -I/export/home/drkirkby/sage-4.5.rc0/local/include -O2 -g -m64  -DHAVE_CONFIG_H  -c charset/alg_factor.cc -o OPTOBJ/alg_factor.o
make[2]: *** [OPTOBJ/version.o] Error 1
make[2]: *** Waiting for unfinished jobs....
mkdir OPTOBJ
make[2]: Leaving directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/singular-3-1-1-4/src/libfac'
make[1]: *** [install] Error 1
make[1]: Leaving directory `/export/home/drkirkby/sage-4.5.rc0/spkg/build/singular-3-1-1-4/src'
make: *** [/export/home/drkirkby/sage-4.5.rc0/local/bin/Singular-3-1-1] Error 2
Unable to build Singular.

real    0m18.232s
user    1m18.531s
sys     0m8.304s
sage: An error occurred while installing singular-3-1-1-4

```

The previous version did build on this machine. It looks to me like the parallel building is not working correctly, as it is trying to use 
Have you checked on 't2.amth' and/or 'bsd.math'? 

I simply don't have time to check everyone's packages on Solaris. I alway try to check that mind at least build on Solaris, Linux and OS X. 

Dave



---

archive/issue_comments_061964.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nI've replaced the SPKG with one where the dependencies are fixed. As soon as I have a working Sage installation on t2 I'll try to build it there in parallel.\n\nPS: Please allow me a bit more than **20 minutes** to test a package on Solaris next time before you complain that I didn't test it yet.",
    "created_at": "2010-07-15T18:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61964",
    "user": "https://github.com/malb"
}
```

<div id="comment:68" align="right">comment:68</div>

I've replaced the SPKG with one where the dependencies are fixed. As soon as I have a working Sage installation on t2 I'll try to build it there in parallel.

PS: Please allow me a bit more than **20 minutes** to test a package on Solaris next time before you complain that I didn't test it yet.



---

archive/issue_comments_061965.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\non **t2.math.washington.edu** with **MAKE=\"make -j32\"**\n\n```\nreal    36m43.246s\nuser    61m52.416s\nsys     4m55.036s\nSuccessfully installed singular-3-1-1-4\nNow cleaning up tmp files.\nrm: Cannot remove any directory in the path of the current working directory\n/home/malb/t2/sage-4.3.0.1-Solaris-10-SPARC-sun4u-or-sun4v/spkg/build/singular-3-1-1-4\nMaking Sage/Python scripts relocatable...\nMaking script relocatable\nFinished installing singular-3-1-1-4.spkg\n```\n\n\nDavid, is that faster or slower than without the parallel build option?",
    "created_at": "2010-07-15T18:55:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61965",
    "user": "https://github.com/malb"
}
```

<div id="comment:69" align="right">comment:69</div>

on **t2.math.washington.edu** with **MAKE="make -j32"**

```
real    36m43.246s
user    61m52.416s
sys     4m55.036s
Successfully installed singular-3-1-1-4
Now cleaning up tmp files.
rm: Cannot remove any directory in the path of the current working directory
/home/malb/t2/sage-4.3.0.1-Solaris-10-SPARC-sun4u-or-sun4v/spkg/build/singular-3-1-1-4
Making Sage/Python scripts relocatable...
Making script relocatable
Finished installing singular-3-1-1-4.spkg
```


David, is that faster or slower than without the parallel build option?



---

archive/issue_comments_061966.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nReplying to [@malb](#comment:68):\n> I've replaced the SPKG with one where the dependencies are fixed. As soon as I have a working Sage installation on t2 I'll try to build it there in parallel.\n\nThank you. \n\n> PS: Please allow me a bit more than **20 minutes** to test a package on Solaris next time before you complain that I didn't test it yet.\n\nWell it was marked for review. I think if you want a reviewer to look at it, you should have checked it on the support platforms - Linux, OS X and Solaris. I know 't2' is not the fastest machine in the world, but with parallel builds, it is pretty decent. Basically the T5240 is designed for a very different task to what we use it for. \n\nDave",
    "created_at": "2010-07-15T19:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61966",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:70" align="right">comment:70</div>

Replying to [@malb](#comment:68):
> I've replaced the SPKG with one where the dependencies are fixed. As soon as I have a working Sage installation on t2 I'll try to build it there in parallel.

Thank you. 

> PS: Please allow me a bit more than **20 minutes** to test a package on Solaris next time before you complain that I didn't test it yet.

Well it was marked for review. I think if you want a reviewer to look at it, you should have checked it on the support platforms - Linux, OS X and Solaris. I know 't2' is not the fastest machine in the world, but with parallel builds, it is pretty decent. Basically the T5240 is designed for a very different task to what we use it for. 

Dave



---

archive/issue_comments_061967.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@malb](#comment:69):\n> on **t2.math.washington.edu** with **MAKE=\"make -j32\"**\n> \n> ```\n> real    36m43.246s\n> user    61m52.416s\n> sys     4m55.036s\n> Successfully installed singular-3-1-1-4\n> Now cleaning up tmp files.\n> rm: Cannot remove any directory in the path of the current working directory\n> /home/malb/t2/sage-4.3.0.1-Solaris-10-SPARC-sun4u-or-sun4v/spkg/build/singular-3-1-1-4\n> Making Sage/Python scripts relocatable...\n> Making script relocatable\n> Finished installing singular-3-1-1-4.spkg\n> ```\n> \n> \n> David, is that faster or slower than without the parallel build option?\n\nI can't tell you that for sure - you would need to test it. However, the fact it has used 67 minutes of CPU time, but took 37 minutes to build, suggests the parallel build is working. I doubt any overhead could explain that difference. \n\nThat should be quite useful, as Singular is probably in the top 3 of packages taking the longest to build. In fact, it might have the !#1 spot. So it's worth making Singular work in parallel, whereas for some packages, it's hardly worth the bother. \n\nDave",
    "created_at": "2010-07-15T19:23:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61967",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@malb](#comment:69):
> on **t2.math.washington.edu** with **MAKE="make -j32"**
> 
> ```
> real    36m43.246s
> user    61m52.416s
> sys     4m55.036s
> Successfully installed singular-3-1-1-4
> Now cleaning up tmp files.
> rm: Cannot remove any directory in the path of the current working directory
> /home/malb/t2/sage-4.3.0.1-Solaris-10-SPARC-sun4u-or-sun4v/spkg/build/singular-3-1-1-4
> Making Sage/Python scripts relocatable...
> Making script relocatable
> Finished installing singular-3-1-1-4.spkg
> ```
> 
> 
> David, is that faster or slower than without the parallel build option?

I can't tell you that for sure - you would need to test it. However, the fact it has used 67 minutes of CPU time, but took 37 minutes to build, suggests the parallel build is working. I doubt any overhead could explain that difference. 

That should be quite useful, as Singular is probably in the top 3 of packages taking the longest to build. In fact, it might have the !#1 spot. So it's worth making Singular work in parallel, whereas for some packages, it's hardly worth the bother. 

Dave



---

archive/issue_comments_061968.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\non **bsd.math.washington.edu** with **MAKE=make -j8**\n\n```\nreal    6m12.144s\nuser    8m16.609s\nsys     1m5.636s\n```",
    "created_at": "2010-07-15T20:11:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61968",
    "user": "https://github.com/malb"
}
```

<div id="comment:72" align="right">comment:72</div>

on **bsd.math.washington.edu** with **MAKE=make -j8**

```
real    6m12.144s
user    8m16.609s
sys     1m5.636s
```



---

archive/issue_comments_061969.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nREFEREE REPORT:\n\n* builds and passes all tests with sage-4.5 on sage.math\n* everything in spkg-install looks fine to me.\n \nThere are a bunch of .cvsignore files all over:\n\n```\nwstein@sage:~/build/sage-4.5.alphastein1/singular-3-1-1-4/src$ hg status|grep \"\\!\"|grep cvsignore\n! IntegerProgramming/.cvsignore\n! Singular/.cvsignore\n! doc/.cvsignore\n! factory/.cvsignore\n! factory/ftest/.cvsignore\n! kernel/.cvsignore\n! libfac/.cvsignore\n! omalloc/.cvsignore\n```\n\n\nI will give this a positive review if:\n\n- the cvsignore's are removed\n- build testing passes on everything",
    "created_at": "2010-07-15T20:39:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61969",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:73" align="right">comment:73</div>

REFEREE REPORT:

* builds and passes all tests with sage-4.5 on sage.math
* everything in spkg-install looks fine to me.
 
There are a bunch of .cvsignore files all over:

```
wstein@sage:~/build/sage-4.5.alphastein1/singular-3-1-1-4/src$ hg status|grep "\!"|grep cvsignore
! IntegerProgramming/.cvsignore
! Singular/.cvsignore
! doc/.cvsignore
! factory/.cvsignore
! factory/ftest/.cvsignore
! kernel/.cvsignore
! libfac/.cvsignore
! omalloc/.cvsignore
```


I will give this a positive review if:

- the cvsignore's are removed
- build testing passes on everything



---

archive/issue_comments_061970.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nHey, I'm wrong -- you got *rid* of the .cvsignores!\n\nThis gets a positive so long as it builds on stuff.",
    "created_at": "2010-07-15T20:51:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61970",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:74" align="right">comment:74</div>

Hey, I'm wrong -- you got *rid* of the .cvsignores!

This gets a positive so long as it builds on stuff.



---

archive/issue_comments_061971.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nHey, I'm wrong -- you got *rid* of the .cvsignores!\n\nThis gets a positive so long as it builds on stuff.",
    "created_at": "2010-07-15T20:51:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61971",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:75" align="right">comment:75</div>

Hey, I'm wrong -- you got *rid* of the .cvsignores!

This gets a positive so long as it builds on stuff.



---

archive/issue_comments_061972.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nAll tests pass on bsd.math",
    "created_at": "2010-07-15T20:52:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61972",
    "user": "https://github.com/malb"
}
```

<div id="comment:76" align="right">comment:76</div>

All tests pass on bsd.math



---

archive/issue_comments_061973.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nWilliam just finished compiling this SPKG on Cygwin.",
    "created_at": "2010-07-15T21:08:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61973",
    "user": "https://github.com/malb"
}
```

<div id="comment:77" align="right">comment:77</div>

William just finished compiling this SPKG on Cygwin.



---

archive/issue_comments_061974.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nAmazingly, this fully works on Cygwin!!",
    "created_at": "2010-07-15T22:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61974",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:78" align="right">comment:78</div>

Amazingly, this fully works on Cygwin!!



---

archive/issue_comments_061975.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nAlso builds on Itanium Linux (iras)",
    "created_at": "2010-07-16T13:17:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61975",
    "user": "https://github.com/malb"
}
```

<div id="comment:79" align="right">comment:79</div>

Also builds on Itanium Linux (iras)



---

archive/issue_comments_061976.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nI didn't manage to build R on Itaninum, thus I do get some doctest failures. The genus failure is also unrelated to this ticket, thus I claim it tests successfully on Itanium Linux\n\n```\nsage -t  \"devel/sage/sage/interfaces/r.py\"\nsage -t  \"devel/sage/sage/interfaces/expect.py\"\nsage -t  \"devel/sage/sage/stats/test.py\"\nsage -t  \"devel/sage/sage/stats/r.py\"\nsage -t  \"devel/sage/sage/graphs/genus.pyx\"\n```",
    "created_at": "2010-07-18T08:16:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61976",
    "user": "https://github.com/malb"
}
```

<div id="comment:80" align="right">comment:80</div>

I didn't manage to build R on Itaninum, thus I do get some doctest failures. The genus failure is also unrelated to this ticket, thus I claim it tests successfully on Itanium Linux

```
sage -t  "devel/sage/sage/interfaces/r.py"
sage -t  "devel/sage/sage/interfaces/expect.py"
sage -t  "devel/sage/sage/stats/test.py"
sage -t  "devel/sage/sage/stats/r.py"
sage -t  "devel/sage/sage/graphs/genus.pyx"
```



---

archive/issue_comments_061977.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nAre there any Singular self-tests? There is no `spkg-check` file, so these are not run if SAGE_CHECK is set to yes.",
    "created_at": "2010-07-18T09:06:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61977",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:81" align="right">comment:81</div>

Are there any Singular self-tests? There is no `spkg-check` file, so these are not run if SAGE_CHECK is set to yes.



---

archive/issue_events_100200.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-07-21T16:47:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100200"
}
```



---

archive/issue_events_100201.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-07-21T16:47:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100201"
}
```



---

archive/issue_events_100202.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-07-21T16:48:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100202"
}
```



---

archive/issue_events_100203.json:
```json
{
    "actor": "https://github.com/malb",
    "created_at": "2010-07-21T16:48:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100203"
}
```



---

archive/issue_events_100204.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-07-25T20:53:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100204"
}
```



---

archive/issue_events_100205.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-07-25T20:53:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100205"
}
```



---

archive/issue_comments_061978.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nThis currently has positive review, and I'm listed as the reviewer, though I have not given it positive review.\n\nFrom what I see above, the only evidence of this working on Solaris is that the package builds. It's not clear Sage can even build on Solaris with this. \n\n\nDave",
    "created_at": "2010-07-25T20:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61978",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:84" align="right">comment:84</div>

This currently has positive review, and I'm listed as the reviewer, though I have not given it positive review.

From what I see above, the only evidence of this working on Solaris is that the package builds. It's not clear Sage can even build on Solaris with this. 


Dave



---

archive/issue_comments_061979.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nPlease see #9583",
    "created_at": "2010-07-26T01:04:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61979",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:85" align="right">comment:85</div>

Please see #9583



---

archive/issue_comments_061980.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nShould this be called \"singular....p0.spkg\", since there is some patching involved?  Rather than 3-1-1-4, should the version number be 3.1.1.4?  That seems to be the current style for singular in sage, but I've seen it both ways.\n\nI'm going to try building this on t2 later tonight.  I'll restore the positive review if it works.",
    "created_at": "2010-07-26T02:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61980",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:86" align="right">comment:86</div>

Should this be called "singular....p0.spkg", since there is some patching involved?  Rather than 3-1-1-4, should the version number be 3.1.1.4?  That seems to be the current style for singular in sage, but I've seen it both ways.

I'm going to try building this on t2 later tonight.  I'll restore the positive review if it works.



---

archive/issue_comments_061981.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nReplying to [@jhpalmieri](#comment:86):\n> Should this be called \"singular....p0.spkg\", since there is some patching involved?  Rather than 3-1-1-4, should the version number be 3.1.1.4?  That seems to be the current style for singular in sage, but I've seen it both ways.\n\nI do not believe it should have a .p0, since its never actually gone into Sage at this point. So if further changes are made, it can still remain 3.1.1.4. That's my understanding of the situation. \n\nDave",
    "created_at": "2010-07-26T02:19:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61981",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:87" align="right">comment:87</div>

Replying to [@jhpalmieri](#comment:86):
> Should this be called "singular....p0.spkg", since there is some patching involved?  Rather than 3-1-1-4, should the version number be 3.1.1.4?  That seems to be the current style for singular in sage, but I've seen it both ways.

I do not believe it should have a .p0, since its never actually gone into Sage at this point. So if further changes are made, it can still remain 3.1.1.4. That's my understanding of the situation. 

Dave



---

archive/issue_comments_061982.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nAt least with Sage 4.5.2.alpha0, while this builds on several platforms (I haven't tried on Solaris yet), the Sage library fails to build.  I get an error like this:\n\n```\nsage/libs/singular/function.cpp: In function \u2018void initfunction()\u2019:\nsage/libs/singular/function.cpp:14355: error: \u2018__pyx_f_4sage_5rings_10polynomial_34multi_polynomial_ideal_libsingular_sage_ideal_to_singular_ideal\u2019 was not declared in this scope\nmake[1]: *** [installed/sage-4.5.2.alpha0] Error 1\n```\n(This is with sage-4.5.2.alpha0 plus the singular spkg here, attempting to build from scratch.)",
    "created_at": "2010-07-26T03:00:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61982",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:88" align="right">comment:88</div>

At least with Sage 4.5.2.alpha0, while this builds on several platforms (I haven't tried on Solaris yet), the Sage library fails to build.  I get an error like this:

```
sage/libs/singular/function.cpp: In function ‘void initfunction()’:
sage/libs/singular/function.cpp:14355: error: ‘__pyx_f_4sage_5rings_10polynomial_34multi_polynomial_ideal_libsingular_sage_ideal_to_singular_ideal’ was not declared in this scope
make[1]: *** [installed/sage-4.5.2.alpha0] Error 1
```
(This is with sage-4.5.2.alpha0 plus the singular spkg here, attempting to build from scratch.)



---

archive/issue_events_100206.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-07-26T03:00:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100206"
}
```



---

archive/issue_events_100207.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-07-26T03:00:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100207"
}
```



---

archive/issue_comments_061983.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nMore specifically, I have failures on \n\n- sage.math\n- skynet machine taurus (x86_64-Linux-nehalem-fc) -- built from scratch twice, failed the same way both times\n- skynet machine eno (x86_64-Linux-core2-fc) -- on an existing sage 4.5.2.alpha0 install, tried just \"sage -i ...\" then \"sage -ba\"  fails\n- an OS X 10.6 box -- tried \"sage -i ...\" then \"sage -ba\" fails\n\nMaybe it's not compatible with #1396?",
    "created_at": "2010-07-26T03:42:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61983",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:89" align="right">comment:89</div>

More specifically, I have failures on 

- sage.math
- skynet machine taurus (x86_64-Linux-nehalem-fc) -- built from scratch twice, failed the same way both times
- skynet machine eno (x86_64-Linux-core2-fc) -- on an existing sage 4.5.2.alpha0 install, tried just "sage -i ..." then "sage -ba"  fails
- an OS X 10.6 box -- tried "sage -i ..." then "sage -ba" fails

Maybe it's not compatible with #1396?



---

archive/issue_comments_061984.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nHi jhpalmieri, can you give me instructions how to reproduce this problem, i.e. what patches you've merged etc.?",
    "created_at": "2010-07-26T08:27:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61984",
    "user": "https://github.com/malb"
}
```

<div id="comment:90" align="right">comment:90</div>

Hi jhpalmieri, can you give me instructions how to reproduce this problem, i.e. what patches you've merged etc.?



---

archive/issue_comments_061985.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nRelated ticket: #9599. That ticket will require a Singular spkg update, and the spkg here fixes that problem. If the spkg here is merged, make a note of that on #9599.",
    "created_at": "2010-07-26T13:47:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61985",
    "user": "https://github.com/dandrake"
}
```

<div id="comment:91" align="right">comment:91</div>

Related ticket: #9599. That ticket will require a Singular spkg update, and the spkg here fixes that problem. If the spkg here is merged, make a note of that on #9599.



---

archive/issue_comments_061986.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\n@jhpalmieri The spkg does need\u00a0 [singular-3-1-1-4.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.patch.gz) to be applied to the Sage library.",
    "created_at": "2010-07-26T14:34:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61986",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:92" align="right">comment:92</div>

@jhpalmieri The spkg does need  [singular-3-1-1-4.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.patch.gz) to be applied to the Sage library.



---

archive/issue_comments_061987.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nReplying to [@malb](#comment:90):\n> Hi jhpalmieri, can you give me instructions how to reproduce this problem, i.e. what patches you've merged etc.?\n\nI took a tarball for Sage 4.5.2.alpha0, dropped in the new singular spkg (singular-3-1-1-4.spkg), and ran \"make\".  I'll try again now with an already built version of Sage, running \"sage -i singular-3-1-1-4.spkg\" and then installing the 3-1-1-4 patch -- I hadn't done that before.",
    "created_at": "2010-07-26T14:52:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61987",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:93" align="right">comment:93</div>

Replying to [@malb](#comment:90):
> Hi jhpalmieri, can you give me instructions how to reproduce this problem, i.e. what patches you've merged etc.?

I took a tarball for Sage 4.5.2.alpha0, dropped in the new singular spkg (singular-3-1-1-4.spkg), and ran "make".  I'll try again now with an already built version of Sage, running "sage -i singular-3-1-1-4.spkg" and then installing the 3-1-1-4 patch -- I hadn't done that before.



---

archive/issue_comments_061988.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nOh, the patch doesn't apply cleanly to Sage 4.5.2.alpha0: \n\n```\napplying /home/palmieri/singular-3-1-1-4.patch\npatching file sage/libs/singular/option.pyx\nHunk #1 succeeded at 108 with fuzz 1 (offset 14 lines).\nHunk #2 FAILED at 313\nHunk #3 FAILED at 349\n2 out of 3 hunks FAILED -- saving rejects to file sage/libs/singular/option.pyx.rej\npatching file sage/libs/singular/singular-cdefs.pxi\nHunk #9 succeeded at 790 with fuzz 1 (offset -10 lines).\npatching file sage/libs/singular/singular.pyx\nHunk #1 succeeded at 30 with fuzz 1 (offset 0 lines).\n```\nSage does start after this, though.  There are a few doctest failures, but they look like random unrelated ones.\n\nNote that #1396 may be backed out of Sage 4.5.2, so you might want to coordinate with that patch rather than just rebasing against some version of 4.5.2.  Also, please test on t2.math or another solaris box: the patch at #1396 caused a segfault on t2.math but not on any other platform...",
    "created_at": "2010-07-26T15:14:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61988",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:94" align="right">comment:94</div>

Oh, the patch doesn't apply cleanly to Sage 4.5.2.alpha0: 

```
applying /home/palmieri/singular-3-1-1-4.patch
patching file sage/libs/singular/option.pyx
Hunk #1 succeeded at 108 with fuzz 1 (offset 14 lines).
Hunk #2 FAILED at 313
Hunk #3 FAILED at 349
2 out of 3 hunks FAILED -- saving rejects to file sage/libs/singular/option.pyx.rej
patching file sage/libs/singular/singular-cdefs.pxi
Hunk #9 succeeded at 790 with fuzz 1 (offset -10 lines).
patching file sage/libs/singular/singular.pyx
Hunk #1 succeeded at 30 with fuzz 1 (offset 0 lines).
```
Sage does start after this, though.  There are a few doctest failures, but they look like random unrelated ones.

Note that #1396 may be backed out of Sage 4.5.2, so you might want to coordinate with that patch rather than just rebasing against some version of 4.5.2.  Also, please test on t2.math or another solaris box: the patch at #1396 caused a segfault on t2.math but not on any other platform...



---

archive/issue_comments_061989.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nAs a note, #1396 was backed out, despite the fact it is still shows as fixed. I've suggested to the release manager that he changes it to \"need work\" which would avoid the confusion. \n\nIs there any progress on this ticket? I created #9397 with the aim of making a small change to the current version of Singular in Sage, so it would build 64-bit on Solaris. I then set it from 'needs review' to 'needs info' thinking there was no point in getting that reviewed if this ticket gets merged. (It had at the time got positive review).\n\nBut this has been open 6 months now, and no comments added for 7 days. I'm tempted to try to get #9397 reviewed. \n\nDave",
    "created_at": "2010-08-02T16:25:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61989",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:95" align="right">comment:95</div>

As a note, #1396 was backed out, despite the fact it is still shows as fixed. I've suggested to the release manager that he changes it to "need work" which would avoid the confusion. 

Is there any progress on this ticket? I created #9397 with the aim of making a small change to the current version of Singular in Sage, so it would build 64-bit on Solaris. I then set it from 'needs review' to 'needs info' thinking there was no point in getting that reviewed if this ticket gets merged. (It had at the time got positive review).

But this has been open 6 months now, and no comments added for 7 days. I'm tempted to try to get #9397 reviewed. 

Dave



---

archive/issue_comments_061990.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nReplying to [@sagetrac-drkirkby](#comment:95):\n> But this has been open 6 months now, and no comments added for 7 days. I'm tempted to try to get #9397 reviewed. \n\nSorry, I had been working on different things. \n\nOn t2, I have applied the patch to sage 4.5.1 and installed the singular-3-1-1-4.spkg. Then, I did `make ptestlong`. Result:\n\n```\nThe following tests failed:\n\n        sage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_rational_fiel\nd.py # File not found\n        sage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_curve_isogeny\n.py # File not found\n        sage -t  -long devel/sage/sage/modular/ssmod/ssmod.py # File not found\n```\n\nThis seems a bit strange to me.\n\nFirst, why can the files not be found?\n\nSecond, why is it not mentioned in the summary that some tests in fact timed out? Namely:\n\n```\nsage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py\n*** *** Error: TIMED OUT! PROCESS KILLED! *** ***\n*** *** Error: TIMED OUT! *** ***\n         [1801.8 s]\nsage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_curve_isogeny.py\n*** *** Error: TIMED OUT! PROCESS KILLED! *** ***\n*** *** Error: TIMED OUT! *** ***\nsage -t  -long devel/sage/sage/modular/ssmod/ssmod.py\n*** *** Error: TIMED OUT! PROCESS KILLED! *** ***\n*** *** Error: TIMED OUT! *** ***\n         [1800.9 s]\n```\n\nSince I am not experienced with t2, I don't know if this doctest result is good or bad.",
    "created_at": "2010-08-03T16:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61990",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:96" align="right">comment:96</div>

Replying to [@sagetrac-drkirkby](#comment:95):
> But this has been open 6 months now, and no comments added for 7 days. I'm tempted to try to get #9397 reviewed. 

Sorry, I had been working on different things. 

On t2, I have applied the patch to sage 4.5.1 and installed the singular-3-1-1-4.spkg. Then, I did `make ptestlong`. Result:

```
The following tests failed:

        sage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_rational_fiel
d.py # File not found
        sage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_curve_isogeny
.py # File not found
        sage -t  -long devel/sage/sage/modular/ssmod/ssmod.py # File not found
```

This seems a bit strange to me.

First, why can the files not be found?

Second, why is it not mentioned in the summary that some tests in fact timed out? Namely:

```
sage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_rational_field.py
*** *** Error: TIMED OUT! PROCESS KILLED! *** ***
*** *** Error: TIMED OUT! *** ***
         [1801.8 s]
sage -t  -long devel/sage/sage/schemes/elliptic_curves/ell_curve_isogeny.py
*** *** Error: TIMED OUT! PROCESS KILLED! *** ***
*** *** Error: TIMED OUT! *** ***
sage -t  -long devel/sage/sage/modular/ssmod/ssmod.py
*** *** Error: TIMED OUT! PROCESS KILLED! *** ***
*** *** Error: TIMED OUT! *** ***
         [1800.9 s]
```

Since I am not experienced with t2, I don't know if this doctest result is good or bad.



---

archive/issue_comments_061991.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nHi Simon,\n\nThese messages (\"File not found\") are more or less typical when the doctests time out.  I think people are working on improving that part of doctest reporting.  Since t2 can be pretty slow, some timeouts are not unusual.  I wouldn't worry about the ones you saw.  If you really want to try again, try `export SAGE_TIMEOUT_LONG=6000` to change the time out for long tests from 1800 seconds to 6000 seconds; then you shouldn't see these.  (6000 seconds is a lot more than you should need, even on t2.)",
    "created_at": "2010-08-03T17:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61991",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:97" align="right">comment:97</div>

Hi Simon,

These messages ("File not found") are more or less typical when the doctests time out.  I think people are working on improving that part of doctest reporting.  Since t2 can be pretty slow, some timeouts are not unusual.  I wouldn't worry about the ones you saw.  If you really want to try again, try `export SAGE_TIMEOUT_LONG=6000` to change the time out for long tests from 1800 seconds to 6000 seconds; then you shouldn't see these.  (6000 seconds is a lot more than you should need, even on t2.)



---

archive/issue_comments_061992.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nReplying to [@jhpalmieri](#comment:97):\n> These messages (\"File not found\") are more or less typical when the doctests time out.  ... If you really want to try again, try `export SAGE_TIMEOUT_LONG=6000`\n\nOK, doing it now.\n\nThanks,\nSimon",
    "created_at": "2010-08-03T18:42:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61992",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:98" align="right">comment:98</div>

Replying to [@jhpalmieri](#comment:97):
> These messages ("File not found") are more or less typical when the doctests time out.  ... If you really want to try again, try `export SAGE_TIMEOUT_LONG=6000`

OK, doing it now.

Thanks,
Simon



---

archive/issue_comments_061993.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nI'v'e just edited \n\n```\n/usr/local/gcc-4.4.1-sun-linker/gcc441sun\n```\n\nthe file I recommend people source, and added to it:\n\n```\nSAGE_TIMEOUT=1000 \nexport SAGE_TIMEOUT\nSAGE_TIMEOUT_LONG=6000\nexport SAGE_TIMEOUT_LONG\n```\n\nI've found on my own 900 MHz SPARC that the default SAGE_TIMEOUT_LONG (1800 s) is **just** about long enough, but the SAGE_TIMEOUT (360 s) is too far too short. I'm not even sure if 1000 seconds for SAGE_TIMEOUT is enough on t2, but it probably is. \n\nObviously one can unset those variables if one wants, but it would seem sensible to have the defaults so tests should pass. \n\n\nDave",
    "created_at": "2010-08-03T21:15:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61993",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:99" align="right">comment:99</div>

I'v'e just edited 

```
/usr/local/gcc-4.4.1-sun-linker/gcc441sun
```

the file I recommend people source, and added to it:

```
SAGE_TIMEOUT=1000 
export SAGE_TIMEOUT
SAGE_TIMEOUT_LONG=6000
export SAGE_TIMEOUT_LONG
```

I've found on my own 900 MHz SPARC that the default SAGE_TIMEOUT_LONG (1800 s) is **just** about long enough, but the SAGE_TIMEOUT (360 s) is too far too short. I'm not even sure if 1000 seconds for SAGE_TIMEOUT is enough on t2, but it probably is. 

Obviously one can unset those variables if one wants, but it would seem sensible to have the defaults so tests should pass. 


Dave



---

archive/issue_comments_061994.json:
```json
{
    "body": "<div id=\"comment:100\" align=\"right\">comment:100</div>\n\nReplying to [@simon-king-jena](#comment:98):\n> Replying to [@jhpalmieri](#comment:97):\n> > These messages (\"File not found\") are more or less typical when the doctests time out.  ... If you really want to try again, try `export SAGE_TIMEOUT_LONG=6000`\n\n> \n> OK, doing it now.\n\nAgain, the setting is: Sage 4.5.1 plus singular-3-1-1-4.patch plus singular-3-1-1-4.spkg. `sage -ptestlong` on t2 with `export SAGE_TIMEOUT_LONG=6000` results in exactly one doctest failure:\n\n```\nsage -t  -long devel/sage/sage/parallel/decorate.py\n**********************************************************************\nFile \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/devel/sage-main/sag\ne/parallel/decorate.py\", line 152:\n    sage: v = list(f([1,2,4])); v.sort(); v\nException raised:\n    Traceback (most recent call last):\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/bin/nca\ndoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/bin/sag\nedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compile\nflags)\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/bin/nca\ndoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_4[9]>\", line 1, in <module>\n        v = list(f([Integer(1),Integer(2),Integer(4)])); v.sort(); v###line 152:\n    sage: v = list(f([1,2,4])); v.sort(); v\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt\nhon/site-packages/sage/parallel/multiprocessing_sage.py\", line 64, in parallel_i\nter\n        p = Pool(processes)\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt\nhon2.6/multiprocessing/__init__.py\", line 227, in Pool\n        return Pool(processes, initializer, initargs)\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt\nhon2.6/multiprocessing/pool.py\", line 104, in __init__\n        w.start()\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt\nhon2.6/multiprocessing/process.py\", line 104, in start\n        self._popen = Popen(self)\n      File \"/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt\nhon2.6/multiprocessing/forking.py\", line 94, in __init__\n        self.pid = os.fork()\n    OSError: [Errno 12] Not enough space\n**********************************************************************\n1 items had failures:\n   1 of  12 in __main__.example_4\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /home/SimonKing/.sage//tmp/.doctest_decorate\n.py\n         [46.5 s]\n```\n\nSo, not enough space. Does that mean the hard disc (or at least `/scratch` or my home directory) is too full?\n\nAnyway, I repeated the failing test separately, and then it succeeded:\n\n```\nsage subshell$ sage -t  -long devel/sage/sage/parallel/decorate.py\nsage -t -long \"devel/sage/sage/parallel/decorate.py\"\n         [48.8 s]\n\n----------------------------------------------------------------------\nAll tests passed!\nTotal time for all tests: 48.8 seconds\n```\n\nSo, can one say that all tests pass on t2?\n\n\nLooking at the previous posts, it seems that the status is:\n\n- \"builds and passes all tests with sage-4.5\" on sage.math (William)\n- \"All tests pass on bsd.math\" (Martin)\n- \"Amazingly, this fully works on Cygwin!!\" (William)\n- With a little effort (extending timeout and running one test separately) all tests of sage-4.5.1+patch+spkg pass on t2.\n- \"the patch doesn't apply cleanly to Sage 4.5.2.alpha0\" (John).\n\nDo you agree that this is a positive review **once the patch is rebased**, and that William, John and myself should be added to the list of referees?\n\nCheers,\n\nSimon",
    "created_at": "2010-08-03T23:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61994",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:100" align="right">comment:100</div>

Replying to [@simon-king-jena](#comment:98):
> Replying to [@jhpalmieri](#comment:97):
> > These messages ("File not found") are more or less typical when the doctests time out.  ... If you really want to try again, try `export SAGE_TIMEOUT_LONG=6000`

> 
> OK, doing it now.

Again, the setting is: Sage 4.5.1 plus singular-3-1-1-4.patch plus singular-3-1-1-4.spkg. `sage -ptestlong` on t2 with `export SAGE_TIMEOUT_LONG=6000` results in exactly one doctest failure:

```
sage -t  -long devel/sage/sage/parallel/decorate.py
**********************************************************************
File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/devel/sage-main/sag
e/parallel/decorate.py", line 152:
    sage: v = list(f([1,2,4])); v.sort(); v
Exception raised:
    Traceback (most recent call last):
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/bin/nca
doctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/bin/sag
edoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compile
flags)
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/bin/nca
doctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_4[9]>", line 1, in <module>
        v = list(f([Integer(1),Integer(2),Integer(4)])); v.sort(); v###line 152:
    sage: v = list(f([1,2,4])); v.sort(); v
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt
hon/site-packages/sage/parallel/multiprocessing_sage.py", line 64, in parallel_i
ter
        p = Pool(processes)
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt
hon2.6/multiprocessing/__init__.py", line 227, in Pool
        return Pool(processes, initializer, initargs)
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt
hon2.6/multiprocessing/pool.py", line 104, in __init__
        w.start()
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt
hon2.6/multiprocessing/process.py", line 104, in start
        self._popen = Popen(self)
      File "/scratch/sking/sage-4.5.1-Solaris_10_SPARC-sun4u-SunOS/local/lib/pyt
hon2.6/multiprocessing/forking.py", line 94, in __init__
        self.pid = os.fork()
    OSError: [Errno 12] Not enough space
**********************************************************************
1 items had failures:
   1 of  12 in __main__.example_4
***Test Failed*** 1 failures.
For whitespace errors, see the file /home/SimonKing/.sage//tmp/.doctest_decorate
.py
         [46.5 s]
```

So, not enough space. Does that mean the hard disc (or at least `/scratch` or my home directory) is too full?

Anyway, I repeated the failing test separately, and then it succeeded:

```
sage subshell$ sage -t  -long devel/sage/sage/parallel/decorate.py
sage -t -long "devel/sage/sage/parallel/decorate.py"
         [48.8 s]

----------------------------------------------------------------------
All tests passed!
Total time for all tests: 48.8 seconds
```

So, can one say that all tests pass on t2?


Looking at the previous posts, it seems that the status is:

- "builds and passes all tests with sage-4.5" on sage.math (William)
- "All tests pass on bsd.math" (Martin)
- "Amazingly, this fully works on Cygwin!!" (William)
- With a little effort (extending timeout and running one test separately) all tests of sage-4.5.1+patch+spkg pass on t2.
- "the patch doesn't apply cleanly to Sage 4.5.2.alpha0" (John).

Do you agree that this is a positive review **once the patch is rebased**, and that William, John and myself should be added to the list of referees?

Cheers,

Simon



---

archive/issue_comments_061995.json:
```json
{
    "body": "Changed reviewer from **David Kirkby** to **David Kirkby, Simon King, William Stein, John Palmieri**",
    "created_at": "2010-08-03T23:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61995",
    "user": "https://github.com/simon-king-jena"
}
```

Changed reviewer from **David Kirkby** to **David Kirkby, Simon King, William Stein, John Palmieri**



---

archive/issue_comments_061996.json:
```json
{
    "body": "Work Issues: **rebase patch**",
    "created_at": "2010-08-03T23:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61996",
    "user": "https://github.com/simon-king-jena"
}
```

Work Issues: **rebase patch**



---

archive/issue_comments_061997.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\n> Do you agree that this is a positive review once the patch is rebased, and that William, John and myself should be added to the list of referees?\n\nThat sounds okay to me.  The rebasing should perhaps be coordinated with #9599 (the re-merging of #1396).",
    "created_at": "2010-08-03T23:58:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61997",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:1" align="right">comment:1</div>

> Do you agree that this is a positive review once the patch is rebased, and that William, John and myself should be added to the list of referees?

That sounds okay to me.  The rebasing should perhaps be coordinated with #9599 (the re-merging of #1396).



---

archive/issue_comments_061998.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nReplying to [@jhpalmieri](#comment:101):\n> > Do you agree that this is a positive review once the patch is rebased, and that William, John and myself should be added to the list of referees?\n\n> \n> That sounds okay to me.  The rebasing should perhaps be coordinated with #9599 (the re-merging of #1396).\n\nI don't think that much co-ordination is needed here. Apparently this ticket is more important than #9599, and #9599 will certainly not happen without the patch from  here. \n\nSo, I'll simply wait until a rebased version of singular-3-1-1-4.patch is available, and will then base on it a new version of my patch from #1396 for re-merging -- which then needs to be tested for segfault on t2, of course.",
    "created_at": "2010-08-04T00:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61998",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:102" align="right">comment:102</div>

Replying to [@jhpalmieri](#comment:101):
> > Do you agree that this is a positive review once the patch is rebased, and that William, John and myself should be added to the list of referees?

> 
> That sounds okay to me.  The rebasing should perhaps be coordinated with #9599 (the re-merging of #1396).

I don't think that much co-ordination is needed here. Apparently this ticket is more important than #9599, and #9599 will certainly not happen without the patch from  here. 

So, I'll simply wait until a rebased version of singular-3-1-1-4.patch is available, and will then base on it a new version of my patch from #1396 for re-merging -- which then needs to be tested for segfault on t2, of course.



---

archive/issue_comments_061999.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWith #1396 backed out, this applies, so it doesn't need to be rebased.  (One hunk applies \"with fuzz\".)  The commit message doesn't include the trac number, but that's the only problem.\n\nSo should it get a positive review now?",
    "created_at": "2010-08-04T00:50:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-61999",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

With #1396 backed out, this applies, so it doesn't need to be rebased.  (One hunk applies "with fuzz".)  The commit message doesn't include the trac number, but that's the only problem.

So should it get a positive review now?



---

archive/issue_comments_062000.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nReplying to [@jhpalmieri](#comment:103):\n> With #1396 backed out, this applies, so it doesn't need to be rebased.  (One hunk applies \"with fuzz\".)\n\nGood!\n\n>  The commit message doesn't include the trac number, but that's the only problem.\n\nWell, I recently got a \"needs work\" for the same reason...\n\n> So should it get a positive review now?\n\nI wouldn't oppose. Any veto?",
    "created_at": "2010-08-04T16:38:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62000",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:104" align="right">comment:104</div>

Replying to [@jhpalmieri](#comment:103):
> With #1396 backed out, this applies, so it doesn't need to be rebased.  (One hunk applies "with fuzz".)

Good!

>  The commit message doesn't include the trac number, but that's the only problem.

Well, I recently got a "needs work" for the same reason...

> So should it get a positive review now?

I wouldn't oppose. Any veto?



---

archive/issue_events_100208.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-08-04T17:22:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100208"
}
```



---

archive/issue_events_100209.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-08-04T17:22:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100209"
}
```



---

archive/issue_comments_062001.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nReplying to [@simon-king-jena](#comment:104):\n> Replying to [@jhpalmieri](#comment:103):\n> > With #1396 backed out, this applies, so it doesn't need to be rebased.  (One hunk applies \"with fuzz\".)\n\n> \n> Good!\n> \n> >  The commit message doesn't include the trac number, but that's the only problem.\n\n> \n> Well, I recently got a \"needs work\" for the same reason...\n> \n> > So should it get a positive review now?\n\n> \n> I wouldn't oppose. Any veto?\n\nMe neither. I'm going to set it to positive review. \n\nDave",
    "created_at": "2010-08-04T17:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62001",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:105" align="right">comment:105</div>

Replying to [@simon-king-jena](#comment:104):
> Replying to [@jhpalmieri](#comment:103):
> > With #1396 backed out, this applies, so it doesn't need to be rebased.  (One hunk applies "with fuzz".)

> 
> Good!
> 
> >  The commit message doesn't include the trac number, but that's the only problem.

> 
> Well, I recently got a "needs work" for the same reason...
> 
> > So should it get a positive review now?

> 
> I wouldn't oppose. Any veto?

Me neither. I'm going to set it to positive review. 

Dave



---

archive/issue_comments_062002.json:
```json
{
    "body": "Changed work issues from **rebase patch** to none",
    "created_at": "2010-08-07T03:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62002",
    "user": "https://github.com/qed777"
}
```

Changed work issues from **rebase patch** to none



---

archive/issue_comments_062003.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI'm working on 4.5.3.alpha0, which will contain a mix of spkg updates and repository patches from report {32}.  Should I attempt to merge this ticket into 4.5.3 or wait for a dedicated Sage release?  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!",
    "created_at": "2010-08-07T03:08:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62003",
    "user": "https://github.com/qed777"
}
```

<div id="comment:6" align="right">comment:6</div>

I'm working on 4.5.3.alpha0, which will contain a mix of spkg updates and repository patches from report {32}.  Should I attempt to merge this ticket into 4.5.3 or wait for a dedicated Sage release?  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!



---

archive/issue_comments_062004.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nAlso also: Please ensure that any patches to merge include the ticket number in the first lines of their commit strings.",
    "created_at": "2010-08-07T03:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62004",
    "user": "https://github.com/qed777"
}
```

<div id="comment:7" align="right">comment:7</div>

Also also: Please ensure that any patches to merge include the ticket number in the first lines of their commit strings.



---

archive/issue_comments_062005.json:
```json
{
    "body": "<div id=\"comment:108\" align=\"right\">comment:108</div>\n\nReplying to [@qed777](#comment:106):\n> I'm working on 4.5.3.alpha0, which will contain a mix of spkg updates and repository patches from report {32}.  Should I attempt to merge this ticket into 4.5.3 or wait for a dedicated Sage release?  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!\n\nDoes this have to be called 4.5.3? I'd feel a lot happier calling it 4.6.0 if there's a major upgrade like Singular. But I think you should try to upgrade Singular. \n\nI don't see the need of a dedicated release - there are lots of updates that have almost no chance of conflicting with this. \n\nI guess I'm one of the people that believes increments in the last digit are just minor changes (bug fixes) and not major new components. It's just the release number I don't like - I think its right to merge this, and some .spkg updates. Pari seems to have stalled again, so I'd go for Singular. \n\nThat said, I seem to be in a minority who feel version numbers should reflect the sort of updates that take place. Almost everyone seems happy with random numbers!\n\nDave",
    "created_at": "2010-08-07T12:13:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62005",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:108" align="right">comment:108</div>

Replying to [@qed777](#comment:106):
> I'm working on 4.5.3.alpha0, which will contain a mix of spkg updates and repository patches from report {32}.  Should I attempt to merge this ticket into 4.5.3 or wait for a dedicated Sage release?  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!

Does this have to be called 4.5.3? I'd feel a lot happier calling it 4.6.0 if there's a major upgrade like Singular. But I think you should try to upgrade Singular. 

I don't see the need of a dedicated release - there are lots of updates that have almost no chance of conflicting with this. 

I guess I'm one of the people that believes increments in the last digit are just minor changes (bug fixes) and not major new components. It's just the release number I don't like - I think its right to merge this, and some .spkg updates. Pari seems to have stalled again, so I'd go for Singular. 

That said, I seem to be in a minority who feel version numbers should reflect the sort of updates that take place. Almost everyone seems happy with random numbers!

Dave



---

archive/issue_comments_062006.json:
```json
{
    "body": "<div id=\"comment:109\" align=\"right\">comment:109</div>\n\nHi!\n\nReplying to [@qed777](#comment:106):\n>  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!\n\nI think it is singular-3-1-1-4.patch (but this needs to be rebased) and http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg \n\nBest regards,\nSimon",
    "created_at": "2010-08-08T19:49:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62006",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:109" align="right">comment:109</div>

Hi!

Replying to [@qed777](#comment:106):
>  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!

I think it is singular-3-1-1-4.patch (but this needs to be rebased) and http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg 

Best regards,
Simon



---

archive/issue_comments_062007.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">comment:110</div>\n\nReplying to [@simon-king-jena](#comment:109):\n> Hi!\n> \n> Replying to [@qed777](#comment:106):\n> >  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!\n\n> \n> I think it is singular-3-1-1-4.patch (but this needs to be rebased) and http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg \n\nI think that's right, and I don't think it needs to be rebased.  At least, I've built on a few machines using this combination, and the patch applied cleanly (albeit with some fuzz), and tests passed.",
    "created_at": "2010-08-08T20:58:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62007",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:110" align="right">comment:110</div>

Replying to [@simon-king-jena](#comment:109):
> Hi!
> 
> Replying to [@qed777](#comment:106):
> >  Also, can someone indicate exactly which spkg and patch to apply?  Thanks!

> 
> I think it is singular-3-1-1-4.patch (but this needs to be rebased) and http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg 

I think that's right, and I don't think it needs to be rebased.  At least, I've built on a few machines using this combination, and the patch applied cleanly (albeit with some fuzz), and tests passed.



---

archive/issue_comments_062008.json:
```json
{
    "body": "Attachment: **[singular-3-1-1-4.2.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz)**\n\nUpdated commit string.  Use with `singular-3-1-1-4.spkg`.",
    "created_at": "2010-08-08T21:57:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62008",
    "user": "https://github.com/qed777"
}
```

Attachment: **[singular-3-1-1-4.2.patch.gz](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz)**

Updated commit string.  Use with `singular-3-1-1-4.spkg`.



---

archive/issue_comments_062009.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThanks.  I'll use\n\n   * [attachment: singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz) (updated commit string)\n   * http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg",
    "created_at": "2010-08-08T21:59:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62009",
    "user": "https://github.com/qed777"
}
```

<div id="comment:1" align="right">comment:1</div>

Thanks.  I'll use

   * [attachment: singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz) (updated commit string)
   * http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg



---

archive/issue_comments_062010.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nThere might still be a problem with parallel builds.  With 4.5.2 on sage.math, I applied [attachment: singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz), copied [singular-3-1-1-4.spkg](http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg) to `SAGE_ROOT`, and ran\n\n```sh\n#!/bin/bash\n\nset -o pipefail\n\nJOBS=20\nRUNS=50\nfor I in `seq $RUNS`;\ndo\n    LOG=\"singular-3-1-1-4-j$JOBS.log.$I\"\n    if [ ! -f \"$LOG\" ]; then\n        env MAKE=\"make -j$JOBS\" ./sage -f singular-3-1-1-4.spkg 2>&1 | tee \"$LOG\"\n        CODE=$?\n        echo $0 run $I of $RUNS: code= $CODE\n    fi\ndone\n```\nAll runs ended with exit code 0 (maybe I didn't retrieve the code correctly?), but\n\n```sh\ngrep \"An error occurred\" singular-3-1-1-4*log* | sort -n\n```\nshows that 21 of the 50 runs failed.\n\nI've put the logs [here](http://sage.math.washington.edu/home/mpatel/trac/8059/).\n\nAccording to\n\n```sh\n$ grep \"No such file or dir\" sing*log* | grep -v \"cannot remove\" | cut -d ':' -f 2- | sort | uniq -c\n      1 abs_fac.cc:2:21: error: factory.h: No such file or directory\n      1 bifac.cc:1:21: error: factory.h: No such file or directory\n      1 cntrlc.o: No such file or directory\n     11 g++: cntrlc.o: No such file or directory\n     28 g++: extra.o: No such file or directory\n      4 g++: feOpt.o: No such file or directory\n      1 g++: g++: cntrlc.o: No such file or directory\n      4 g++: g++: extra.o: No such file or directoryextra.o: No such file or directory\n      2 g++: misc_ip.o: No such file or directory\n      1 lgs.h:13:21: error: factory.h: No such file or directory\n```\nand some digging, the `gcc -o gentable` and `gcc -o gentable2` commands, at least, sometimes don't have all of their dependencies already built.  For example, `singular-3-1-1-4-j20.log.14` contains\n\n```\ng++ -O3 -g -fPIC -pipe -I. -I../kernel -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2\n-singular/local/include  -fno-implicit-templates -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H -DGENTABLE \\\n             -o gentable1 claptmpl.o iparith.cc tesths.cc mpsr_Tok.cc \\\n             grammar.o scanner.o attrib.o eigenval_ip.o extra.o fehelp.o feOpt.o ipassign.o ipconv.o ipid.o iplib.o ipprint.o ipshell.o lists.o sdb.o fglm.o interpolation.o silink.o subexpr.o janet.o wrapper.o \nlibparse.o sing_win.o gms.o pcv.o maps_ip.o walk.o walk_ip.o cntrlc.o misc_ip.o calcSVD.o Minor.o MinorProcessor.o MinorInterface.o  slInit_Dynamic.o -ldl -rdynamic -L../kernel -lkernel -L/mnt/usb1/scratch/mpat\nel/tmp/sage-4.5.2-singular/local/lib -L/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/lib  -lm -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lm  -lomalloc ../kernel/mmalloc.o\ng++ -O3 -g -fPIC -pipe -I. -I../kernel -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2\n-singular/local/include  -fno-implicit-templates -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H -DGENTABLE \\\n             -o gentable2 claptmpl.o iparith.cc tesths.cc mpsr_Tok.cc \\\n             grammar.o scanner.o attrib.o eigenval_ip.o extra.o fehelp.o feOpt.o ipassign.o ipconv.o ipid.o iplib.o ipprint.o ipshell.o lists.o sdb.o fglm.o interpolation.o silink.o subexpr.o janet.o wrapper.o \nlibparse.o sing_win.o gms.o pcv.o maps_ip.o walk.o walk_ip.o cntrlc.o misc_ip.o calcSVD.o Minor.o MinorProcessor.o MinorInterface.o  slInit_Dynamic.o -ldl -rdynamic -L../kernel -lkernel -L/mnt/usb1/scratch/mpat\nel/tmp/sage-4.5.2-singular/local/lib -L/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/lib  -lm -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lm  -lomalloc ../kernel/mmalloc.o\ng++: extra.o: No such file or directory\ng++: extra.o: No such file or directory\n```\nPlease see `singular-3-1-1-4-j20.log.47` for the `factory.h` errors.\n\nIf I didn't make a mistake:  What if we return to serial builds for this ticket but open a new one for building Singular in parallel?",
    "created_at": "2010-08-09T08:07:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62010",
    "user": "https://github.com/qed777"
}
```

<div id="comment:2" align="right">comment:2</div>

There might still be a problem with parallel builds.  With 4.5.2 on sage.math, I applied [attachment: singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz), copied [singular-3-1-1-4.spkg](http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg) to `SAGE_ROOT`, and ran

```sh
#!/bin/bash

set -o pipefail

JOBS=20
RUNS=50
for I in `seq $RUNS`;
do
    LOG="singular-3-1-1-4-j$JOBS.log.$I"
    if [ ! -f "$LOG" ]; then
        env MAKE="make -j$JOBS" ./sage -f singular-3-1-1-4.spkg 2>&1 | tee "$LOG"
        CODE=$?
        echo $0 run $I of $RUNS: code= $CODE
    fi
done
```
All runs ended with exit code 0 (maybe I didn't retrieve the code correctly?), but

```sh
grep "An error occurred" singular-3-1-1-4*log* | sort -n
```
shows that 21 of the 50 runs failed.

I've put the logs [here](http://sage.math.washington.edu/home/mpatel/trac/8059/).

According to

```sh
$ grep "No such file or dir" sing*log* | grep -v "cannot remove" | cut -d ':' -f 2- | sort | uniq -c
      1 abs_fac.cc:2:21: error: factory.h: No such file or directory
      1 bifac.cc:1:21: error: factory.h: No such file or directory
      1 cntrlc.o: No such file or directory
     11 g++: cntrlc.o: No such file or directory
     28 g++: extra.o: No such file or directory
      4 g++: feOpt.o: No such file or directory
      1 g++: g++: cntrlc.o: No such file or directory
      4 g++: g++: extra.o: No such file or directoryextra.o: No such file or directory
      2 g++: misc_ip.o: No such file or directory
      1 lgs.h:13:21: error: factory.h: No such file or directory
```
and some digging, the `gcc -o gentable` and `gcc -o gentable2` commands, at least, sometimes don't have all of their dependencies already built.  For example, `singular-3-1-1-4-j20.log.14` contains

```
g++ -O3 -g -fPIC -pipe -I. -I../kernel -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2
-singular/local/include  -fno-implicit-templates -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H -DGENTABLE \
             -o gentable1 claptmpl.o iparith.cc tesths.cc mpsr_Tok.cc \
             grammar.o scanner.o attrib.o eigenval_ip.o extra.o fehelp.o feOpt.o ipassign.o ipconv.o ipid.o iplib.o ipprint.o ipshell.o lists.o sdb.o fglm.o interpolation.o silink.o subexpr.o janet.o wrapper.o 
libparse.o sing_win.o gms.o pcv.o maps_ip.o walk.o walk_ip.o cntrlc.o misc_ip.o calcSVD.o Minor.o MinorProcessor.o MinorInterface.o  slInit_Dynamic.o -ldl -rdynamic -L../kernel -lkernel -L/mnt/usb1/scratch/mpat
el/tmp/sage-4.5.2-singular/local/lib -L/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/lib  -lm -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lm  -lomalloc ../kernel/mmalloc.o
g++ -O3 -g -fPIC -pipe -I. -I../kernel -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/include -I/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2
-singular/local/include  -fno-implicit-templates -DNDEBUG -DOM_NDEBUG -Dx86_64_Linux -DHAVE_CONFIG_H -DGENTABLE \
             -o gentable2 claptmpl.o iparith.cc tesths.cc mpsr_Tok.cc \
             grammar.o scanner.o attrib.o eigenval_ip.o extra.o fehelp.o feOpt.o ipassign.o ipconv.o ipid.o iplib.o ipprint.o ipshell.o lists.o sdb.o fglm.o interpolation.o silink.o subexpr.o janet.o wrapper.o 
libparse.o sing_win.o gms.o pcv.o maps_ip.o walk.o walk_ip.o cntrlc.o misc_ip.o calcSVD.o Minor.o MinorProcessor.o MinorInterface.o  slInit_Dynamic.o -ldl -rdynamic -L../kernel -lkernel -L/mnt/usb1/scratch/mpat
el/tmp/sage-4.5.2-singular/local/lib -L/mnt/usb1/scratch/mpatel/tmp/sage-4.5.2-singular/local/lib  -lm -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lm  -lomalloc ../kernel/mmalloc.o
g++: extra.o: No such file or directory
g++: extra.o: No such file or directory
```
Please see `singular-3-1-1-4-j20.log.47` for the `factory.h` errors.

If I didn't make a mistake:  What if we return to serial builds for this ticket but open a new one for building Singular in parallel?



---

archive/issue_events_100210.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-09T08:07:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100210"
}
```



---

archive/issue_events_100211.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-09T08:07:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100211"
}
```



---

archive/issue_comments_062011.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI hope this ticket does finally get merged. It solves all my Solaris issues, and has less patches. \n\nHowever, I would appreciate if someone could review #9397, which does not update Singular, but has a couple of changes needed to get 64-bit builds of Singular on Solaris. \n\nAll the changes are in this ticket, so if this ticket gets merged, then there's no need for #9397. But clearly there is a possibility this ticket will cause problems and not get merged, so it would be nice if #9397 could be merged in that case. But it needs review. \n\nDave",
    "created_at": "2010-08-09T08:21:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62011",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:3" align="right">comment:3</div>

I hope this ticket does finally get merged. It solves all my Solaris issues, and has less patches. 

However, I would appreciate if someone could review #9397, which does not update Singular, but has a couple of changes needed to get 64-bit builds of Singular on Solaris. 

All the changes are in this ticket, so if this ticket gets merged, then there's no need for #9397. But clearly there is a possibility this ticket will cause problems and not get merged, so it would be nice if #9397 could be merged in that case. But it needs review. 

Dave



---

archive/issue_comments_062012.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI would like to mention at this stage that we have adopted this patch\nin sage-on-gentoo and use it with singular-3.1.1.4 from the system\n(we had to fix the path for dlopen in singular.pyx - the only place\nin the whole sage spkg where there is a dlopen call). \nWe are quite happy with it on x86 and amd64, I should fully test on \nppc as well, probably over the next week end (it takes that much time).",
    "created_at": "2010-08-09T09:19:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62012",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">comment:4</div>

I would like to mention at this stage that we have adopted this patch
in sage-on-gentoo and use it with singular-3.1.1.4 from the system
(we had to fix the path for dlopen in singular.pyx - the only place
in the whole sage spkg where there is a dlopen call). 
We are quite happy with it on x86 and amd64, I should fully test on 
ppc as well, probably over the next week end (it takes that much time).



---

archive/issue_comments_062013.json:
```json
{
    "body": "Attachment: **[trac_8059_spkg-restore_serial_build.patch.gz](https://github.com/sagemath/sage/files/ticket8059/trac_8059_spkg-restore_serial_build.patch.gz)**\n\nRestore serial builds.  SPKG repo patch.",
    "created_at": "2010-08-11T00:22:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62013",
    "user": "https://github.com/qed777"
}
```

Attachment: **[trac_8059_spkg-restore_serial_build.patch.gz](https://github.com/sagemath/sage/files/ticket8059/trac_8059_spkg-restore_serial_build.patch.gz)**

Restore serial builds.  SPKG repo patch.



---

archive/issue_comments_062014.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI've made\n\n http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg\n\nwhich restores building the package in serial, for now.  The changes are in [attachment: trac_8059_spkg-restore_serial_build.patch](https://github.com/sagemath/sage/files/ticket8059/trac_8059_spkg-restore_serial_build.patch.gz).  The p0 package installs consistently for me on sage.math (47 good runs out of 47, so far).\n\nThoughts?",
    "created_at": "2010-08-11T00:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62014",
    "user": "https://github.com/qed777"
}
```

<div id="comment:5" align="right">comment:5</div>

I've made

 http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg

which restores building the package in serial, for now.  The changes are in [attachment: trac_8059_spkg-restore_serial_build.patch](https://github.com/sagemath/sage/files/ticket8059/trac_8059_spkg-restore_serial_build.patch.gz).  The p0 package installs consistently for me on sage.math (47 good runs out of 47, so far).

Thoughts?



---

archive/issue_comments_062015.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI think that changing to serial is fine for now.  I just re-ran some of your tests, but with `JOBS=4` instead of `JOBS=20`.  It worked fine.  I've seen this before with some other packages, especially on t2: if you build with too many threads, it doesn't work, but it's fine with not as many.  (For example, mpir pretty consistently doesn't seem to work for me on t2 with MAKE='make -j12', but MAKE='make -j4' is fine.)\n\nIs this ready for review?",
    "created_at": "2010-08-11T21:36:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62015",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:6" align="right">comment:6</div>

I think that changing to serial is fine for now.  I just re-ran some of your tests, but with `JOBS=4` instead of `JOBS=20`.  It worked fine.  I've seen this before with some other packages, especially on t2: if you build with too many threads, it doesn't work, but it's fine with not as many.  (For example, mpir pretty consistently doesn't seem to work for me on t2 with MAKE='make -j12', but MAKE='make -j4' is fine.)

Is this ready for review?



---

archive/issue_comments_062016.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nFor what it's worth, with 4.5.3.alpha0 + [singular-3-1-1-4.p0.spkg](http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg) + [attachment: singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz), the long doctests pass for me on bsd and sage.math.",
    "created_at": "2010-08-11T21:58:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62016",
    "user": "https://github.com/qed777"
}
```

<div id="comment:7" align="right">comment:7</div>

For what it's worth, with 4.5.3.alpha0 + [singular-3-1-1-4.p0.spkg](http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg) + [attachment: singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz), the long doctests pass for me on bsd and sage.math.



---

archive/issue_events_100212.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-11T21:58:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100212"
}
```



---

archive/issue_events_100213.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-11T21:58:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100213"
}
```



---

archive/issue_comments_062017.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSince the only change is to disable parallel building, I think we can restore the positive review.",
    "created_at": "2010-08-11T22:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62017",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:8" align="right">comment:8</div>

Since the only change is to disable parallel building, I think we can restore the positive review.



---

archive/issue_events_100214.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-08-11T22:13:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100214"
}
```



---

archive/issue_events_100215.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-08-11T22:13:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100215"
}
```



---

archive/issue_comments_062018.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nI this this issue occurs only if you have a lot of CPU cores, but slow hard disks. Anyway, the patch at think !http://www.singular.uni-kl.de:8002/trac/ticket/250 should cure it.",
    "created_at": "2010-08-12T11:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62018",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:119" align="right">comment:119</div>

I this this issue occurs only if you have a lot of CPU cores, but slow hard disks. Anyway, the patch at think !http://www.singular.uni-kl.de:8002/trac/ticket/250 should cure it.



---

archive/issue_comments_062019.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nReplying to [@alexanderdreyer](#comment:119):\n> I this this issue occurs only if you have a lot of CPU cores, but slow hard disks. Anyway, the patch at think !http://www.singular.uni-kl.de:8002/trac/ticket/250 should cure it.\n\nThat looks a very trivial change. If I understand correctly, just one line\n\n```\n$(basefactorysrc:.cc=.o):      factory.h\n```\n\nis added. But it might be better to put it on another ticket, otherwise this could drag on for ages - the ticket is already 7-months old. \n\nSingular is one of the slowest packages build for me on my Ultra 27, taking about 8 minutes if I recall correctly. But I'm concerned that delaying this much longer will cause more problems than a few minutes of wall time will make. \n\nBTW, I've run with 1000 threads on systems with only 4 cores. It's not optimal, but does allow a reasonable simulation of larger parallel builds to be made. \n\nA big problem in my opinion, is that the server disk.math, which serves all the home directories has been mis-configured to increase the speed of NFS. So failures on home directories might not be code errors, but simply mis-configuration of the server. \n\n\nDave",
    "created_at": "2010-08-12T11:59:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62019",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:120" align="right">comment:120</div>

Replying to [@alexanderdreyer](#comment:119):
> I this this issue occurs only if you have a lot of CPU cores, but slow hard disks. Anyway, the patch at think !http://www.singular.uni-kl.de:8002/trac/ticket/250 should cure it.

That looks a very trivial change. If I understand correctly, just one line

```
$(basefactorysrc:.cc=.o):      factory.h
```

is added. But it might be better to put it on another ticket, otherwise this could drag on for ages - the ticket is already 7-months old. 

Singular is one of the slowest packages build for me on my Ultra 27, taking about 8 minutes if I recall correctly. But I'm concerned that delaying this much longer will cause more problems than a few minutes of wall time will make. 

BTW, I've run with 1000 threads on systems with only 4 cores. It's not optimal, but does allow a reasonable simulation of larger parallel builds to be made. 

A big problem in my opinion, is that the server disk.math, which serves all the home directories has been mis-configured to increase the speed of NFS. So failures on home directories might not be code errors, but simply mis-configuration of the server. 


Dave



---

archive/issue_comments_062020.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nYeah, this should be another ticket. BTW, I also hat to a another trivial fix to fix the gentable issue during parallel build.",
    "created_at": "2010-08-12T12:08:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62020",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:1" align="right">comment:1</div>

Yeah, this should be another ticket. BTW, I also hat to a another trivial fix to fix the gentable issue during parallel build.



---

archive/issue_comments_062021.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nTHe parallel build issue is now #9733.",
    "created_at": "2010-08-12T12:23:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62021",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:2" align="right">comment:2</div>

THe parallel build issue is now #9733.



---

archive/issue_comments_062022.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n The Singular team accepted most of our patches upstream. They are in the 3-1-0-9 release, which also is a first step to make things easier for library developers.\n \n+How to apply the patches to [sage-4.5.3.alpha0](http://sage.math.washington.edu/home/release/sage-4.5.3.alpha0/sage-4.5.3.alpha0.tar):\n \n+* Install the new Singular spkg: [http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg](http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg)\n+* Apply [singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz) to `devel/sage`\n``````\n",
    "created_at": "2010-08-14T20:50:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62022",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
 The Singular team accepted most of our patches upstream. They are in the 3-1-0-9 release, which also is a first step to make things easier for library developers.
 
+How to apply the patches to [sage-4.5.3.alpha0](http://sage.math.washington.edu/home/release/sage-4.5.3.alpha0/sage-4.5.3.alpha0.tar):
 
+* Install the new Singular spkg: [http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg](http://sage.math.washington.edu/home/mpatel/trac/8059/singular-3-1-1-4.p0.spkg)
+* Apply [singular-3-1-1-4.2.patch](https://github.com/sagemath/sage/files/ticket8059/singular-3-1-1-4.2.patch.gz) to `devel/sage`
``````




---

archive/issue_events_100216.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-08-14T20:58:45Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "title_is": "Update Singular spkg to release 3-1-1-4",
    "title_was": "update Singular SPKG to newest upstream release",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100216"
}
```



---

archive/issue_events_100217.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-15T08:02:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100217"
}
```



---

archive/issue_events_100218.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-15T08:02:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/8059#event-100218"
}
```



---

archive/issue_comments_062023.json:
```json
{
    "body": "Merged: **sage-4.5.3.alpha0**",
    "created_at": "2010-08-15T08:02:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62023",
    "user": "https://github.com/qed777"
}
```

Merged: **sage-4.5.3.alpha0**



---

archive/issue_comments_062024.json:
```json
{
    "body": "Changed merged from **sage-4.5.3.alpha0** to **sage-4.5.3.alpha1**",
    "created_at": "2010-08-15T08:27:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62024",
    "user": "https://github.com/qed777"
}
```

Changed merged from **sage-4.5.3.alpha0** to **sage-4.5.3.alpha1**



---

archive/issue_comments_062025.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n*Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(\n\nI wonder if we should touch *all of them* in `spkg-install`, not just two.\n\n<flame>\nI thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...\n</flame>",
    "created_at": "2010-08-15T20:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62025",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:7" align="right">comment:7</div>

*Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(

I wonder if we should touch *all of them* in `spkg-install`, not just two.

<flame>
I thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...
</flame>



---

archive/issue_comments_062026.json:
```json
{
    "body": "<div id=\"comment:128\" align=\"right\">comment:128</div>\n\nReplying to [@nexttime](#comment:127):\n> *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(\n\nI don't know what method they use to create the tarball, but its hard to see how this can happen. Unless they touch all files before releasing, it's hard to understand how they can created a configure script with the same timestamp as the file it is generated from. \n\nPerhaps they copy them with `cp` at one point, and don't preserve modification times (`cp -p`). Whatever it is they are doing, it is wrong. \n\n\n> I wonder if we should touch *all of them* in `spkg-install`, not just two.\n\nAnything that should be touched should be. \n \n> <flame>\n> I thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...\n> </flame>\n\nNo comment. \n\n\nBTW, is this really 3-1-1-4, or is it a snapshot? If the latter, then it's quite possible someone in the Sage community created the configure script and did not preserve modification times. In which case, the upstream developers are not to blame. \n\n\nDave",
    "created_at": "2010-08-15T21:28:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62026",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:128" align="right">comment:128</div>

Replying to [@nexttime](#comment:127):
> *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(

I don't know what method they use to create the tarball, but its hard to see how this can happen. Unless they touch all files before releasing, it's hard to understand how they can created a configure script with the same timestamp as the file it is generated from. 

Perhaps they copy them with `cp` at one point, and don't preserve modification times (`cp -p`). Whatever it is they are doing, it is wrong. 


> I wonder if we should touch *all of them* in `spkg-install`, not just two.

Anything that should be touched should be. 
 
> <flame>
> I thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...
> </flame>

No comment. 


BTW, is this really 3-1-1-4, or is it a snapshot? If the latter, then it's quite possible someone in the Sage community created the configure script and did not preserve modification times. In which case, the upstream developers are not to blame. 


Dave



---

archive/issue_comments_062027.json:
```json
{
    "body": "<div id=\"comment:129\" align=\"right\">comment:129</div>\n\n> *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(\n\nThese files **can** be generated, but there is no need to do so (if you are not a Singular-kernel developer). In fact they are pre-generated in the repo:\nhttp://www.singular.uni-kl.de/svn/trunk/\n(That's why the time stamps are equal.)\n\nThe reason for this is that the generators for these files (e.g. **specific** version of autotools and lex) are not available on all supported platforms.\n\nOf course, there are attempts to change this, but this cannot be done within 2,5 days. If (and only if) the tools of Sage distribution are capable of generating these files, then the correct solution would be to to remove them complete during patching.\n\n> <flame>\n> I thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...\n> </flame>\n\nThis wasn't at topic at SD23.5.",
    "created_at": "2010-08-16T06:58:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62027",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:129" align="right">comment:129</div>

> *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(

These files **can** be generated, but there is no need to do so (if you are not a Singular-kernel developer). In fact they are pre-generated in the repo:
http://www.singular.uni-kl.de/svn/trunk/
(That's why the time stamps are equal.)

The reason for this is that the generators for these files (e.g. **specific** version of autotools and lex) are not available on all supported platforms.

Of course, there are attempts to change this, but this cannot be done within 2,5 days. If (and only if) the tools of Sage distribution are capable of generating these files, then the correct solution would be to to remove them complete during patching.

> <flame>
> I thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...
> </flame>

This wasn't at topic at SD23.5.



---

archive/issue_comments_062028.json:
```json
{
    "body": "<div id=\"comment:130\" align=\"right\">comment:130</div>\n\nReplying to [@alexanderdreyer](#comment:129):\n> > *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(\n\n> \n> These files **can** be generated, but there is no need to do so (if you are not a Singular-kernel developer). In fact they are pre-generated in the repo:\n> http://www.singular.uni-kl.de/svn/trunk/\n> (That's why the time stamps are equal.)\n> \n> The reason for this is that the generators for these files (e.g. **specific** version of autotools and lex) are not available on all supported platforms.\n> \n> Of course, there are attempts to change this, but this cannot be done within 2,5 days. If (and only if) the tools of Sage distribution are capable of generating these files, then the correct solution would be to to remove them complete during patching.\n\nIIRC, I got a message that it would try to generate the files using my autoconf, which is an older version, but it might not work. That's very dangerous. \n\nAlso, this means if the tools exist, the file get generated needlessly, slowing the build. \n\nBut it will not take 2.5 days to touch them in the spkg-install file. \n\nDave",
    "created_at": "2010-08-16T09:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62028",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:130" align="right">comment:130</div>

Replying to [@alexanderdreyer](#comment:129):
> > *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(

> 
> These files **can** be generated, but there is no need to do so (if you are not a Singular-kernel developer). In fact they are pre-generated in the repo:
> http://www.singular.uni-kl.de/svn/trunk/
> (That's why the time stamps are equal.)
> 
> The reason for this is that the generators for these files (e.g. **specific** version of autotools and lex) are not available on all supported platforms.
> 
> Of course, there are attempts to change this, but this cannot be done within 2,5 days. If (and only if) the tools of Sage distribution are capable of generating these files, then the correct solution would be to to remove them complete during patching.

IIRC, I got a message that it would try to generate the files using my autoconf, which is an older version, but it might not work. That's very dangerous. 

Also, this means if the tools exist, the file get generated needlessly, slowing the build. 

But it will not take 2.5 days to touch them in the spkg-install file. 

Dave



---

archive/issue_comments_062029.json:
```json
{
    "body": "<div id=\"comment:131\" align=\"right\">comment:131</div>\n\nReplying to [@alexanderdreyer](#comment:129):\n> > *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(\n\n> \n> These files **can** be generated, but there is no need to do so (if you are not a Singular-kernel developer). In fact they are pre-generated in the repo:\n> http://www.singular.uni-kl.de/svn/trunk/\n> (That's why the time stamps are equal.)\n\nAnd exactly **that** can (and did) cause problems; the distributed generated files should be\n* **newer** than their sources,\n* up-to-date.\n\nSee https://github.com/sagemath/sage/issues/9160#comment:22 (and https://github.com/sagemath/sage/issues/9160#comment:20 for the latter issue, or the whole ticket...) and also [this thread on sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/fbf5b7f781c3f523#).\n\nUnfortunately we hadn't had the time to add more comments on this to `SPKG.txt`, but I expected the people further working on the Singular spkg to be aware of these issues, or take a look at previous tickets related to the spkg. (And I didn't edit the SD 23.5 wiki page, because at that time it didn't seem appropriate, but asked for other people propagating these things.)\n\n> The reason for this is that the generators for these files (e.g. **specific** version of autotools and lex) are not available on all supported platforms.\n> \n> Of course, there are attempts to change this, but this cannot be done within 2,5 days. If (and only if) the tools of Sage distribution are capable of generating these files, then the correct solution would be to to remove them complete during patching.\n> \n> > <flame>\n> > I thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...\n> > </flame>\n\n> This wasn't at topic at SD23.5.\n\nObviously unfortunately not, see above. I expected it to be one.",
    "created_at": "2010-08-16T21:39:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62029",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:131" align="right">comment:131</div>

Replying to [@alexanderdreyer](#comment:129):
> > *Almost all* generated files (`configure`, `grammar.cc` etc.) **again** carry the same time stamp as their sources... :(

> 
> These files **can** be generated, but there is no need to do so (if you are not a Singular-kernel developer). In fact they are pre-generated in the repo:
> http://www.singular.uni-kl.de/svn/trunk/
> (That's why the time stamps are equal.)

And exactly **that** can (and did) cause problems; the distributed generated files should be
* **newer** than their sources,
* up-to-date.

See https://github.com/sagemath/sage/issues/9160#comment:22 (and https://github.com/sagemath/sage/issues/9160#comment:20 for the latter issue, or the whole ticket...) and also [this thread on sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/fbf5b7f781c3f523#).

Unfortunately we hadn't had the time to add more comments on this to `SPKG.txt`, but I expected the people further working on the Singular spkg to be aware of these issues, or take a look at previous tickets related to the spkg. (And I didn't edit the SD 23.5 wiki page, because at that time it didn't seem appropriate, but asked for other people propagating these things.)

> The reason for this is that the generators for these files (e.g. **specific** version of autotools and lex) are not available on all supported platforms.
> 
> Of course, there are attempts to change this, but this cannot be done within 2,5 days. If (and only if) the tools of Sage distribution are capable of generating these files, then the correct solution would be to to remove them complete during patching.
> 
> > <flame>
> > I thought the upstream developers had learned at Sage Days 23.5, but perhaps 3.1.1.4 was just prepared too early...
> > </flame>

> This wasn't at topic at SD23.5.

Obviously unfortunately not, see above. I expected it to be one.



---

archive/issue_comments_062030.json:
```json
{
    "body": "<div id=\"comment:132\" align=\"right\">comment:132</div>\n\n> Obviously unfortunately not, see above. I expected it to be one.\n\nNeither #9160 wasn't reported upstream, nor the spkg-maintainers were CCed.",
    "created_at": "2010-08-16T21:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62030",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:132" align="right">comment:132</div>

> Obviously unfortunately not, see above. I expected it to be one.

Neither #9160 wasn't reported upstream, nor the spkg-maintainers were CCed.



---

archive/issue_comments_062031.json:
```json
{
    "body": "<div id=\"comment:133\" align=\"right\">comment:133</div>\n\nReplying to [@alexanderdreyer](#comment:132):\n> > Obviously unfortunately not, see above. I expected it to be one.\n\n> Neither #9160 wasn't reported upstream, nor the spkg-maintainers were CCed.\n\nWell, the spkg maintainer (and some of the people involved in this ticket here) actually participated the discussion on sage-devel (which referred to #9160).\n\n(And I remember the spkg maintainer telling me *\"You don't need to cc anybody, we'll look through the tickets anyway...\"* ;-) )\n\nThat's why I had been a bit annoyed or disappointed, and the reason for the flame.",
    "created_at": "2010-08-16T22:07:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62031",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:133" align="right">comment:133</div>

Replying to [@alexanderdreyer](#comment:132):
> > Obviously unfortunately not, see above. I expected it to be one.

> Neither #9160 wasn't reported upstream, nor the spkg-maintainers were CCed.

Well, the spkg maintainer (and some of the people involved in this ticket here) actually participated the discussion on sage-devel (which referred to #9160).

(And I remember the spkg maintainer telling me *"You don't need to cc anybody, we'll look through the tickets anyway..."* ;-) )

That's why I had been a bit annoyed or disappointed, and the reason for the flame.



---

archive/issue_comments_062032.json:
```json
{
    "body": "<div id=\"comment:134\" align=\"right\">comment:134</div>\n\n> (And I remember the spkg maintainer telling me *\"You don't need to cc anybody, we'll look through the tickets anyway...\"* ;-) )\n\nI guess it was not clear, that this is to be fixed upstream. (It's merely a packaging problem.)\n\n> That's why I had been a bit annoyed or disappointed, and the reason for the flame.\n\nNo reason to flam the upstream developers. In particular, as the ticket stated, that it had not been reported to them.",
    "created_at": "2010-08-16T22:42:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/8059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/8059#issuecomment-62032",
    "user": "https://github.com/alexanderdreyer"
}
```

<div id="comment:134" align="right">comment:134</div>

> (And I remember the spkg maintainer telling me *"You don't need to cc anybody, we'll look through the tickets anyway..."* ;-) )

I guess it was not clear, that this is to be fixed upstream. (It's merely a packaging problem.)

> That's why I had been a bit annoyed or disappointed, and the reason for the flame.

No reason to flam the upstream developers. In particular, as the ticket stated, that it had not been reported to them.
