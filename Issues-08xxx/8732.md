# Issue 8732: bug in new HMM code

archive/issues_008732.json:
```json
{
    "body": "Crap, there is a bug in the new HMM code (#8547) that just went into sage-4.4.alpha0:\n\nTry this:\n\n```\nsage: m = hmm.DiscreteHiddenMarkovModel([[1/3]*3]*3, [ [5]*5 ]*3, [1/3]*3, 'abcde'); m\nsage: v = list('a'*100); v\nsage: m.baum_welch(v)\nsage: m.sample(10)\n['e', 'a', 'e', 'e', 'a', 'c', 'c', 'c', 'c', 'a']\nsage: m\nDiscrete Hidden Markov Model with 3 States and 5 Emissions\nTransition matrix:\n[0.333333333333 0.333333333333 0.333333333333]\n[0.333333333333 0.333333333333 0.333333333333]\n[0.333333333333 0.333333333333 0.333333333333]\nEmission matrix:\n[1.0 0.0 0.0 0.0 0.0]\n[1.0 0.0 0.0 0.0 0.0]\n[1.0 0.0 0.0 0.0 0.0]\nInitial probabilities: [0.3333, 0.3333, 0.3333]\n```\n\nNotice above that it is impossible for the model to emit anything except 'a'.  Yet in the sample it does!  \n\nThis bug wasn't in the previous HMM code, of course.  I'll fix this ASAP for sage-4.4. \n\n\nWilliam\n\nAssignee: amhou\n\nCC:  mhampton boothby @jasongrout\n\nResolution: fixed\n\nAuthor: William Stein\n\nReviewer: Marshall Hampton\n\nMerged: sage-4.4.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/8732\n\n",
    "closed_at": "2010-04-23T17:09:04Z",
    "created_at": "2010-04-20T20:48:47Z",
    "labels": [
        "component: statistics",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.4",
    "title": "bug in new HMM code",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8732",
    "user": "https://github.com/williamstein"
}
```
Crap, there is a bug in the new HMM code (#8547) that just went into sage-4.4.alpha0:

Try this:

```
sage: m = hmm.DiscreteHiddenMarkovModel([[1/3]*3]*3, [ [5]*5 ]*3, [1/3]*3, 'abcde'); m
sage: v = list('a'*100); v
sage: m.baum_welch(v)
sage: m.sample(10)
['e', 'a', 'e', 'e', 'a', 'c', 'c', 'c', 'c', 'a']
sage: m
Discrete Hidden Markov Model with 3 States and 5 Emissions
Transition matrix:
[0.333333333333 0.333333333333 0.333333333333]
[0.333333333333 0.333333333333 0.333333333333]
[0.333333333333 0.333333333333 0.333333333333]
Emission matrix:
[1.0 0.0 0.0 0.0 0.0]
[1.0 0.0 0.0 0.0 0.0]
[1.0 0.0 0.0 0.0 0.0]
Initial probabilities: [0.3333, 0.3333, 0.3333]
```

Notice above that it is impossible for the model to emit anything except 'a'.  Yet in the sample it does!  

This bug wasn't in the previous HMM code, of course.  I'll fix this ASAP for sage-4.4. 


William

Assignee: amhou

CC:  mhampton boothby @jasongrout

Resolution: fixed

Author: William Stein

Reviewer: Marshall Hampton

Merged: sage-4.4.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/8732





---

archive/issue_comments_092691.json:
```json
{
    "body": "Attachment [trac_8732.patch](tarball://root/attachments/some-uuid/ticket8732/trac_8732.patch) by @williamstein created at 2010-04-20 21:46:04",
    "created_at": "2010-04-20T21:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92691",
    "user": "https://github.com/williamstein"
}
```

Attachment [trac_8732.patch](tarball://root/attachments/some-uuid/ticket8732/trac_8732.patch) by @williamstein created at 2010-04-20 21:46:04



---

archive/issue_comments_092692.json:
```json
{
    "body": "<a id='comment:1'></a>\nI had a C array index backwards.",
    "created_at": "2010-04-20T21:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92692",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'></a>
I had a C array index backwards.



---

archive/issue_comments_092693.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-04-20T21:46:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92693",
    "user": "https://github.com/williamstein"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_092694.json:
```json
{
    "body": "<a id='comment:2'></a>\nI'm cc'ing some possible reviewers...",
    "created_at": "2010-04-20T23:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92694",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>
I'm cc'ing some possible reviewers...



---

archive/issue_comments_092695.json:
```json
{
    "body": "<a id='comment:3'></a>\nOK, patch looks good.  Passes tests and coverage, change makes sense, and I did some random testing so I am giving this a positive review.",
    "created_at": "2010-04-21T03:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92695",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

<a id='comment:3'></a>
OK, patch looks good.  Passes tests and coverage, change makes sense, and I did some random testing so I am giving this a positive review.



---

archive/issue_comments_092696.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-04-21T03:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92696",
    "user": "https://trac.sagemath.org/admin/accounts/users/mhampton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_092697.json:
```json
{
    "body": "Changing author from \"\" to \"William Stein\"",
    "created_at": "2010-04-23T17:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92697",
    "user": "https://github.com/jhpalmieri"
}
```

Changing author from "" to "William Stein"



---

archive/issue_comments_092698.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Marshall Hampton\"",
    "created_at": "2010-04-23T17:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92698",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "" to "Marshall Hampton"



---

archive/issue_comments_092699.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.4.alpha2\"",
    "created_at": "2010-04-23T17:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92699",
    "user": "https://github.com/jhpalmieri"
}
```

Changing merged from "" to "sage-4.4.alpha2"



---

archive/issue_comments_092700.json:
```json
{
    "body": "<a id='comment:4'></a>\nMerged into 4.4.alpha2.",
    "created_at": "2010-04-23T17:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92700",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
Merged into 4.4.alpha2.



---

archive/issue_comments_092701.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-04-23T17:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8732#issuecomment-92701",
    "user": "https://github.com/jhpalmieri"
}
```

Resolution: fixed



---

archive/issue_events_033766.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2010-04-23T17:09:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8732",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8732#event-33766"
}
```
