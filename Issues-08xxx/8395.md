# Issue 8395: degree() reports the degree of a self-loop vertex as contributing 1 to total degree

archive/issues_008395.json:
```json
{
    "body": "**Note:** When this ticket is closed, make sure to also close ticket #9809.\n\nFrom [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):\n\n```\n[mvngu@sage mvngu]$ sage\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: G = Graph({1:[1]}); G\nLooped graph on 1 vertex\nsage: sum(G.degree())\n1\nsage: G.size()\n0\nsage: G = Graph({1:[1]}, loops=True); G\nLooped graph on 1 vertex\nsage: sum(G.degree())\n1\nsage: G.size()\n0\nsage: G = Graph({1:[1]}, loops=True, multiedges=True); G\nLooped multi-graph on 1 vertex\nsage: sum(G.degree())\n1\nsage: G.size()\n0\n| Sage Version 4.3.3, Release Date: 2010-02-21                       |\n| Type notebook() for the GUI, and license() for information.        |\nThe size of G is 1 because there is one edge, i.e. the single\nself-loop. As shown by the above session, Sage reports the size of G\nas 0. I believe this is a bug. \n```\n\nSee also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:\n\n```\n[mvngu@sage ~]$ sage\n----------------------------------------------------------------------\n----------------------------------------------------------------------\nsage: from sage.graphs.base.sparse_graph import SparseGraphBackend\nsage: S = SparseGraphBackend(7)\nsage: S.loops(True)\nsage: S.add_edge(1, 1, None, directed=False)\nsage: S.has_edge(1, 1, None)\nTrue\nsage: list(S.iterator_edges(range(7), None))\n[(1, 1)]\nsage: S.degree(1, directed=False)\n1\nsage: \nsage: reset()\nsage: \nsage: \nsage: from sage.graphs.base.dense_graph import DenseGraphBackend\nsage: D = DenseGraphBackend(78)\nsage: D = DenseGraphBackend(7)\nsage: D.loops(True)\nsage: D.add_edge(1, 1, None, directed=False)\nsage: D.has_edge(1, 1, None)\nTrue\nsage: list(D.iterator_edges(range(7), None))\n[(1, 1)]\nsage: D.degree(1, directed=False)\n1\n```\n| Sage Version 4.3.5, Release Date: 2010-03-28                       |\n| Type notebook() for the GUI, and license() for information.        |\nNotice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.\n\nAssignee: @rlmill\n\nCC:  @jasongrout @nathanncohen\n\nResolution: fixed\n\nAuthor: Minh Van Nguyen\n\nReviewer: Robert Miller, Minh Van Nguyen\n\nMerged: sage-4.6.2.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/8395\n\n",
    "closed_at": "2011-01-12T06:31:26Z",
    "created_at": "2010-02-28T14:52:11Z",
    "labels": [
        "component: graph theory",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.2",
    "title": "degree() reports the degree of a self-loop vertex as contributing 1 to total degree",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8395",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```
**Note:** When this ticket is closed, make sure to also close ticket #9809.

From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):

```
[mvngu@sage mvngu]$ sage
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: G = Graph({1:[1]}); G
Looped graph on 1 vertex
sage: sum(G.degree())
1
sage: G.size()
0
sage: G = Graph({1:[1]}, loops=True); G
Looped graph on 1 vertex
sage: sum(G.degree())
1
sage: G.size()
0
sage: G = Graph({1:[1]}, loops=True, multiedges=True); G
Looped multi-graph on 1 vertex
sage: sum(G.degree())
1
sage: G.size()
0
| Sage Version 4.3.3, Release Date: 2010-02-21                       |
| Type notebook() for the GUI, and license() for information.        |
The size of G is 1 because there is one edge, i.e. the single
self-loop. As shown by the above session, Sage reports the size of G
as 0. I believe this is a bug. 
```

See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:

```
[mvngu@sage ~]$ sage
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: from sage.graphs.base.sparse_graph import SparseGraphBackend
sage: S = SparseGraphBackend(7)
sage: S.loops(True)
sage: S.add_edge(1, 1, None, directed=False)
sage: S.has_edge(1, 1, None)
True
sage: list(S.iterator_edges(range(7), None))
[(1, 1)]
sage: S.degree(1, directed=False)
1
sage: 
sage: reset()
sage: 
sage: 
sage: from sage.graphs.base.dense_graph import DenseGraphBackend
sage: D = DenseGraphBackend(78)
sage: D = DenseGraphBackend(7)
sage: D.loops(True)
sage: D.add_edge(1, 1, None, directed=False)
sage: D.has_edge(1, 1, None)
True
sage: list(D.iterator_edges(range(7), None))
[(1, 1)]
sage: D.degree(1, directed=False)
1
```
| Sage Version 4.3.5, Release Date: 2010-03-28                       |
| Type notebook() for the GUI, and license() for information.        |
Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.

Assignee: @rlmill

CC:  @jasongrout @nathanncohen

Resolution: fixed

Author: Minh Van Nguyen

Reviewer: Robert Miller, Minh Van Nguyen

Merged: sage-4.6.2.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/8395





---

archive/issue_comments_077872.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -29,6 +29,42 @@\n as 0. I believe this is a bug. \n ```\n \n+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:\n+\n+```\n+[mvngu@sage ~]$ sage\n+----------------------------------------------------------------------\n+----------------------------------------------------------------------\n+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend\n+sage: S = SparseGraphBackend(7)\n+sage: S.loops(True)\n+sage: S.add_edge(1, 1, None, directed=False)\n+sage: S.has_edge(1, 1, None)\n+True\n+sage: list(S.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: S.degree(1, directed=False)\n+1\n+sage: \n+sage: reset()\n+sage: \n+sage: \n+sage: from sage.graphs.base.dense_graph import DenseGraphBackend\n+sage: D = DenseGraphBackend(78)\n+sage: D = DenseGraphBackend(7)\n+sage: D.loops(True)\n+sage: D.add_edge(1, 1, None, directed=False)\n+sage: D.has_edge(1, 1, None)\n+True\n+sage: list(D.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: D.degree(1, directed=False)\n+1\n+```\n+| Sage Version 4.3.5, Release Date: 2010-03-28                       |\n+| Type notebook() for the GUI, and license() for information.        |\n+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.\n+\n Comment: 1\n \n Issue created by migration from https://trac.sagemath.org/ticket/8395\n```\n",
    "created_at": "2010-04-23T02:15:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77872",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -29,6 +29,42 @@
 as 0. I believe this is a bug. 
 ```
 
+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:
+
+```
+[mvngu@sage ~]$ sage
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend
+sage: S = SparseGraphBackend(7)
+sage: S.loops(True)
+sage: S.add_edge(1, 1, None, directed=False)
+sage: S.has_edge(1, 1, None)
+True
+sage: list(S.iterator_edges(range(7), None))
+[(1, 1)]
+sage: S.degree(1, directed=False)
+1
+sage: 
+sage: reset()
+sage: 
+sage: 
+sage: from sage.graphs.base.dense_graph import DenseGraphBackend
+sage: D = DenseGraphBackend(78)
+sage: D = DenseGraphBackend(7)
+sage: D.loops(True)
+sage: D.add_edge(1, 1, None, directed=False)
+sage: D.has_edge(1, 1, None)
+True
+sage: list(D.iterator_edges(range(7), None))
+[(1, 1)]
+sage: D.degree(1, directed=False)
+1
+```
+| Sage Version 4.3.5, Release Date: 2010-03-28                       |
+| Type notebook() for the GUI, and license() for information.        |
+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.
+
 Comment: 1
 
 Issue created by migration from https://trac.sagemath.org/ticket/8395
```




---

archive/issue_comments_077873.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,73 @@\n+From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):\n \n+```\n+[mvngu@sage mvngu]$ sage\n+----------------------------------------------------------------------\n+----------------------------------------------------------------------\n+sage: G = Graph({1:[1]}); G\n+Looped graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+sage: G = Graph({1:[1]}, loops=True); G\n+Looped graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+sage: G = Graph({1:[1]}, loops=True, multiedges=True); G\n+Looped multi-graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+| Sage Version 4.3.3, Release Date: 2010-02-21                       |\n+| Type notebook() for the GUI, and license() for information.        |\n+The size of G is 1 because there is one edge, i.e. the single\n+self-loop. As shown by the above session, Sage reports the size of G\n+as 0. I believe this is a bug. \n+```\n+\n+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:\n+\n+```\n+[mvngu@sage ~]$ sage\n+----------------------------------------------------------------------\n+----------------------------------------------------------------------\n+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend\n+sage: S = SparseGraphBackend(7)\n+sage: S.loops(True)\n+sage: S.add_edge(1, 1, None, directed=False)\n+sage: S.has_edge(1, 1, None)\n+True\n+sage: list(S.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: S.degree(1, directed=False)\n+1\n+sage: \n+sage: reset()\n+sage: \n+sage: \n+sage: from sage.graphs.base.dense_graph import DenseGraphBackend\n+sage: D = DenseGraphBackend(78)\n+sage: D = DenseGraphBackend(7)\n+sage: D.loops(True)\n+sage: D.add_edge(1, 1, None, directed=False)\n+sage: D.has_edge(1, 1, None)\n+True\n+sage: list(D.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: D.degree(1, directed=False)\n+1\n+```\n+| Sage Version 4.3.5, Release Date: 2010-03-28                       |\n+| Type notebook() for the GUI, and license() for information.        |\n+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.\n+\n+Preliminary patches up at\n+\n+https://github.com/mvngu/8395\n \n Comment: 1\n \n```\n",
    "created_at": "2010-12-03T12:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77873",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,73 @@
+From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):
 
+```
+[mvngu@sage mvngu]$ sage
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+sage: G = Graph({1:[1]}); G
+Looped graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+sage: G = Graph({1:[1]}, loops=True); G
+Looped graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+sage: G = Graph({1:[1]}, loops=True, multiedges=True); G
+Looped multi-graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+| Sage Version 4.3.3, Release Date: 2010-02-21                       |
+| Type notebook() for the GUI, and license() for information.        |
+The size of G is 1 because there is one edge, i.e. the single
+self-loop. As shown by the above session, Sage reports the size of G
+as 0. I believe this is a bug. 
+```
+
+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:
+
+```
+[mvngu@sage ~]$ sage
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend
+sage: S = SparseGraphBackend(7)
+sage: S.loops(True)
+sage: S.add_edge(1, 1, None, directed=False)
+sage: S.has_edge(1, 1, None)
+True
+sage: list(S.iterator_edges(range(7), None))
+[(1, 1)]
+sage: S.degree(1, directed=False)
+1
+sage: 
+sage: reset()
+sage: 
+sage: 
+sage: from sage.graphs.base.dense_graph import DenseGraphBackend
+sage: D = DenseGraphBackend(78)
+sage: D = DenseGraphBackend(7)
+sage: D.loops(True)
+sage: D.add_edge(1, 1, None, directed=False)
+sage: D.has_edge(1, 1, None)
+True
+sage: list(D.iterator_edges(range(7), None))
+[(1, 1)]
+sage: D.degree(1, directed=False)
+1
+```
+| Sage Version 4.3.5, Release Date: 2010-03-28                       |
+| Type notebook() for the GUI, and license() for information.        |
+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.
+
+Preliminary patches up at
+
+https://github.com/mvngu/8395
 
 Comment: 1
 
```




---

archive/issue_comments_077874.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,69 @@\n+From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):\n \n+```\n+[mvngu@sage mvngu]$ sage\n+----------------------------------------------------------------------\n+----------------------------------------------------------------------\n+sage: G = Graph({1:[1]}); G\n+Looped graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+sage: G = Graph({1:[1]}, loops=True); G\n+Looped graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+sage: G = Graph({1:[1]}, loops=True, multiedges=True); G\n+Looped multi-graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+| Sage Version 4.3.3, Release Date: 2010-02-21                       |\n+| Type notebook() for the GUI, and license() for information.        |\n+The size of G is 1 because there is one edge, i.e. the single\n+self-loop. As shown by the above session, Sage reports the size of G\n+as 0. I believe this is a bug. \n+```\n+\n+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:\n+\n+```\n+[mvngu@sage ~]$ sage\n+----------------------------------------------------------------------\n+----------------------------------------------------------------------\n+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend\n+sage: S = SparseGraphBackend(7)\n+sage: S.loops(True)\n+sage: S.add_edge(1, 1, None, directed=False)\n+sage: S.has_edge(1, 1, None)\n+True\n+sage: list(S.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: S.degree(1, directed=False)\n+1\n+sage: \n+sage: reset()\n+sage: \n+sage: \n+sage: from sage.graphs.base.dense_graph import DenseGraphBackend\n+sage: D = DenseGraphBackend(78)\n+sage: D = DenseGraphBackend(7)\n+sage: D.loops(True)\n+sage: D.add_edge(1, 1, None, directed=False)\n+sage: D.has_edge(1, 1, None)\n+True\n+sage: list(D.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: D.degree(1, directed=False)\n+1\n+```\n+| Sage Version 4.3.5, Release Date: 2010-03-28                       |\n+| Type notebook() for the GUI, and license() for information.        |\n+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.\n \n Comment: 1\n \n```\n",
    "created_at": "2010-12-03T13:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77874",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,69 @@
+From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):
 
+```
+[mvngu@sage mvngu]$ sage
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+sage: G = Graph({1:[1]}); G
+Looped graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+sage: G = Graph({1:[1]}, loops=True); G
+Looped graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+sage: G = Graph({1:[1]}, loops=True, multiedges=True); G
+Looped multi-graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+| Sage Version 4.3.3, Release Date: 2010-02-21                       |
+| Type notebook() for the GUI, and license() for information.        |
+The size of G is 1 because there is one edge, i.e. the single
+self-loop. As shown by the above session, Sage reports the size of G
+as 0. I believe this is a bug. 
+```
+
+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:
+
+```
+[mvngu@sage ~]$ sage
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend
+sage: S = SparseGraphBackend(7)
+sage: S.loops(True)
+sage: S.add_edge(1, 1, None, directed=False)
+sage: S.has_edge(1, 1, None)
+True
+sage: list(S.iterator_edges(range(7), None))
+[(1, 1)]
+sage: S.degree(1, directed=False)
+1
+sage: 
+sage: reset()
+sage: 
+sage: 
+sage: from sage.graphs.base.dense_graph import DenseGraphBackend
+sage: D = DenseGraphBackend(78)
+sage: D = DenseGraphBackend(7)
+sage: D.loops(True)
+sage: D.add_edge(1, 1, None, directed=False)
+sage: D.has_edge(1, 1, None)
+True
+sage: list(D.iterator_edges(range(7), None))
+[(1, 1)]
+sage: D.degree(1, directed=False)
+1
+```
+| Sage Version 4.3.5, Release Date: 2010-03-28                       |
+| Type notebook() for the GUI, and license() for information.        |
+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.
 
 Comment: 1
 
```




---

archive/issue_comments_077875.json:
```json
{
    "body": "<a id='comment:3'></a>Attachment [trac-8395_degree.patch](tarball://root/attachments/some-uuid/ticket8395/trac-8395_degree.patch) by mvngu created at 2010-12-03 13:59:16",
    "created_at": "2010-12-03T13:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77875",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:3'></a>Attachment [trac-8395_degree.patch](tarball://root/attachments/some-uuid/ticket8395/trac-8395_degree.patch) by mvngu created at 2010-12-03 13:59:16



---

archive/issue_comments_077876.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-12-03T13:59:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77876",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_077877.json:
```json
{
    "body": "Attachment [trac_8395-part2.patch](tarball://root/attachments/some-uuid/ticket8395/trac_8395-part2.patch) by @rlmill created at 2010-12-03 16:26:30\n\napply after previous patch",
    "created_at": "2010-12-03T16:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77877",
    "user": "https://github.com/rlmill"
}
```

Attachment [trac_8395-part2.patch](tarball://root/attachments/some-uuid/ticket8395/trac_8395-part2.patch) by @rlmill created at 2010-12-03 16:26:30

apply after previous patch



---

archive/issue_comments_077878.json:
```json
{
    "body": "<a id='comment:4'></a>Minh,\n\nYour patch looks good to me. If you approve of mine, please set this to positive review.\n\nThanks!",
    "created_at": "2010-12-03T16:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77878",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:4'></a>Minh,

Your patch looks good to me. If you approve of mine, please set this to positive review.

Thanks!



---

archive/issue_comments_077879.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-12-04T02:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77879",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_077880.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,71 @@\n+**Note:** When this ticket is closed, make sure to also close ticket #9809.\n \n+From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):\n+\n+```\n+[mvngu@sage mvngu]$ sage\n+----------------------------------------------------------------------\n+----------------------------------------------------------------------\n+sage: G = Graph({1:[1]}); G\n+Looped graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+sage: G = Graph({1:[1]}, loops=True); G\n+Looped graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+sage: G = Graph({1:[1]}, loops=True, multiedges=True); G\n+Looped multi-graph on 1 vertex\n+sage: sum(G.degree())\n+1\n+sage: G.size()\n+0\n+| Sage Version 4.3.3, Release Date: 2010-02-21                       |\n+| Type notebook() for the GUI, and license() for information.        |\n+The size of G is 1 because there is one edge, i.e. the single\n+self-loop. As shown by the above session, Sage reports the size of G\n+as 0. I believe this is a bug. \n+```\n+\n+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:\n+\n+```\n+[mvngu@sage ~]$ sage\n+----------------------------------------------------------------------\n+----------------------------------------------------------------------\n+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend\n+sage: S = SparseGraphBackend(7)\n+sage: S.loops(True)\n+sage: S.add_edge(1, 1, None, directed=False)\n+sage: S.has_edge(1, 1, None)\n+True\n+sage: list(S.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: S.degree(1, directed=False)\n+1\n+sage: \n+sage: reset()\n+sage: \n+sage: \n+sage: from sage.graphs.base.dense_graph import DenseGraphBackend\n+sage: D = DenseGraphBackend(78)\n+sage: D = DenseGraphBackend(7)\n+sage: D.loops(True)\n+sage: D.add_edge(1, 1, None, directed=False)\n+sage: D.has_edge(1, 1, None)\n+True\n+sage: list(D.iterator_edges(range(7), None))\n+[(1, 1)]\n+sage: D.degree(1, directed=False)\n+1\n+```\n+| Sage Version 4.3.5, Release Date: 2010-03-28                       |\n+| Type notebook() for the GUI, and license() for information.        |\n+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.\n \n Comment: 1\n \n```\n",
    "created_at": "2010-12-04T13:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77880",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,71 @@
+**Note:** When this ticket is closed, make sure to also close ticket #9809.
 
+From [sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/42110dbb598d11d2):
+
+```
+[mvngu@sage mvngu]$ sage
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+sage: G = Graph({1:[1]}); G
+Looped graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+sage: G = Graph({1:[1]}, loops=True); G
+Looped graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+sage: G = Graph({1:[1]}, loops=True, multiedges=True); G
+Looped multi-graph on 1 vertex
+sage: sum(G.degree())
+1
+sage: G.size()
+0
+| Sage Version 4.3.3, Release Date: 2010-02-21                       |
+| Type notebook() for the GUI, and license() for information.        |
+The size of G is 1 because there is one edge, i.e. the single
+self-loop. As shown by the above session, Sage reports the size of G
+as 0. I believe this is a bug. 
+```
+
+See also the discussion at this [other sage-devel](http://groups.google.com/group/sage-devel/browse_thread/thread/63b3c775da0421a8) thread. This also happens in the C graph backends for sparse and dense graphs:
+
+```
+[mvngu@sage ~]$ sage
+----------------------------------------------------------------------
+----------------------------------------------------------------------
+sage: from sage.graphs.base.sparse_graph import SparseGraphBackend
+sage: S = SparseGraphBackend(7)
+sage: S.loops(True)
+sage: S.add_edge(1, 1, None, directed=False)
+sage: S.has_edge(1, 1, None)
+True
+sage: list(S.iterator_edges(range(7), None))
+[(1, 1)]
+sage: S.degree(1, directed=False)
+1
+sage: 
+sage: reset()
+sage: 
+sage: 
+sage: from sage.graphs.base.dense_graph import DenseGraphBackend
+sage: D = DenseGraphBackend(78)
+sage: D = DenseGraphBackend(7)
+sage: D.loops(True)
+sage: D.add_edge(1, 1, None, directed=False)
+sage: D.has_edge(1, 1, None)
+True
+sage: list(D.iterator_edges(range(7), None))
+[(1, 1)]
+sage: D.degree(1, directed=False)
+1
+```
+| Sage Version 4.3.5, Release Date: 2010-03-28                       |
+| Type notebook() for the GUI, and license() for information.        |
+Notice that `degree()` reports the degree of a self-loop as one, when in fact it should be 2. That's because both `SparseGraphBackend` and `DenseGraphBackend` inherit the same `degree()` function from `CGraphBackend`. I think the implementation of `degree()` in `CGraphBackend` needs to take into account the existence of self-loops.
 
 Comment: 1
 
```




---

archive/issue_events_020131.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-05T09:56:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8395#event-20131"
}
```



---

archive/issue_events_020132.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-12T06:31:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8395#event-20132"
}
```



---

archive/issue_comments_077881.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-01-12T06:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8395#issuecomment-77881",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
