# Issue 8318: overlap_partion of a word should return an instance disjoint set data structure

archive/issues_008318.json:
```json
{
    "body": "When I coded the `overlap_partition` function in 2007, the purpose was to study equations on words. But, when the sage-words code was merged into sage in december 2008, the disjoint set data structure was not ready so that sage-words got merged without it. That is why `overlap_partition` returns a set of sets (and also why I don't use the function ever since then).\n\nThe disjoint set data structure got merged into sage recently : #6775. So this patch changes the behavior of `overlap_partition` to its initial goal.\n\nBEFORE (sage-4.3.2):\n\n```\nsage: w = Words(range(10))(range(10))\nsage: w.overlap_partition(w,3)\n{{0, 9, 3, 6}, {1, 4, 7}, {8, 2, 5}}\nsage: \nsage: type(_)\n<class 'sage.sets.set.Set_object_enumerated'>\n```\n\nWITH THE PATCH:\n\nThe following example illustrates that a word that overlaps with itself has a period :\n\n```\nsage: w = Words(range(10))(range(10))\nsage: p = w.overlap_partition(w, 3)\nsage: type(p)\n<type 'sage.sets.disjoint_set.DisjointSet_of_hashables'>\nsage: d = p.element_to_root_dict()\nsage: m = WordMorphism(d)\nsage: print m\nWordMorphism: 0->3, 1->4, 2->5, 3->3, 4->4, 5->5, 6->3, 7->4, 8->5, 9->3\nsage: m(w)\nword: 3453453453\n```\n\nThe following example shows that if the image of a word under an involution f overlaps its square, then it is f-symmetric i.e. the product of two f-palindromes :\n\n```\nsage: W = Words([-11,-9,..,11])\nsage: w = W([1,3,..,11])\nsage: w\nword: 1,3,5,7,9,11\nsage: inv = lambda x:-x\nsage: f = WordMorphism(dict( (a, inv(a)) for a in W.alphabet()))\nsage: print f\nWordMorphism: -1->1, -11->11, -3->3, -5->5, -7->7, -9->9, 1->-1, 11->-11, 3->-3, 5->-5, 7->-7, 9->-9\nsage: p = (w*w).overlap_partition(f(w).reversal(), 2, involution=inv)\nsage: m = WordMorphism(p.element_to_root_dict())\nsage: m(w)\nword: 1,-1,5,7,-7,-5\nsage: m(w).is_symmetric(f)\nTrue\n```\n\n\n\nAssignee: sage-combinat\n\nCC:  abmasse\n\nKeywords: equation, words, partition\n\nResolution: fixed\n\nAuthor: S\u00e9bastien Labb\u00e9\n\nReviewer: Alexandre Blondin Mass\u00e9\n\nMerged: sage-4.3.4.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/8318\n\n",
    "closed_at": "2010-03-02T21:35:05Z",
    "created_at": "2010-02-21T02:27:56Z",
    "labels": [
        "component: combinatorics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.3.4",
    "title": "overlap_partion of a word should return an instance disjoint set data structure",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/8318",
    "user": "https://github.com/seblabbe"
}
```
When I coded the `overlap_partition` function in 2007, the purpose was to study equations on words. But, when the sage-words code was merged into sage in december 2008, the disjoint set data structure was not ready so that sage-words got merged without it. That is why `overlap_partition` returns a set of sets (and also why I don't use the function ever since then).

The disjoint set data structure got merged into sage recently : #6775. So this patch changes the behavior of `overlap_partition` to its initial goal.

BEFORE (sage-4.3.2):

```
sage: w = Words(range(10))(range(10))
sage: w.overlap_partition(w,3)
{{0, 9, 3, 6}, {1, 4, 7}, {8, 2, 5}}
sage: 
sage: type(_)
<class 'sage.sets.set.Set_object_enumerated'>
```

WITH THE PATCH:

The following example illustrates that a word that overlaps with itself has a period :

```
sage: w = Words(range(10))(range(10))
sage: p = w.overlap_partition(w, 3)
sage: type(p)
<type 'sage.sets.disjoint_set.DisjointSet_of_hashables'>
sage: d = p.element_to_root_dict()
sage: m = WordMorphism(d)
sage: print m
WordMorphism: 0->3, 1->4, 2->5, 3->3, 4->4, 5->5, 6->3, 7->4, 8->5, 9->3
sage: m(w)
word: 3453453453
```

The following example shows that if the image of a word under an involution f overlaps its square, then it is f-symmetric i.e. the product of two f-palindromes :

```
sage: W = Words([-11,-9,..,11])
sage: w = W([1,3,..,11])
sage: w
word: 1,3,5,7,9,11
sage: inv = lambda x:-x
sage: f = WordMorphism(dict( (a, inv(a)) for a in W.alphabet()))
sage: print f
WordMorphism: -1->1, -11->11, -3->3, -5->5, -7->7, -9->9, 1->-1, 11->-11, 3->-3, 5->-5, 7->-7, 9->-9
sage: p = (w*w).overlap_partition(f(w).reversal(), 2, involution=inv)
sage: m = WordMorphism(p.element_to_root_dict())
sage: m(w)
word: 1,-1,5,7,-7,-5
sage: m(w).is_symmetric(f)
True
```



Assignee: sage-combinat

CC:  abmasse

Keywords: equation, words, partition

Resolution: fixed

Author: Sébastien Labbé

Reviewer: Alexandre Blondin Massé

Merged: sage-4.3.4.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/8318





---

archive/issue_comments_086660.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-02-21T02:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86660",
    "user": "https://github.com/seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_086661.json:
```json
{
    "body": "<a id='comment:2'></a>Hello, S\u00e9bastien !\n\nI tested your patch and generated the documentation. I have some comments on the latter:\n\n1. The first sentence appears kind of complicated.\n\n   Returns the partition of the alphabet induced by the equivalence relation obtained\n   from the symmetric, reflexive and transitive closure of the set of pairs of letters\n   R_{self,other,delay}\\cup p defined below.\n\nI suggest something like:\n\n  Returns the partition over the alphabet induced by overlapping the words self\n  and other with given delay.\n\nThen you give the formal definition and the example.\n\n2. In the example, it is not clear how the words `cheval` and `abcdef` overlap. It could be better to use a constant width character font if possible.\n\n3. You should give more details about what the involution is there for.\n\n4. Same comment about parameter `p`. I prefer more significant name (in that case, maybe `partition` ?) and it would be nice to know what `p` is used for (I guess it's a partition corresponding to already equivalent letters ?)\n\nThat's all for now. The rest seems fine. As soon as you fix the documentation according to my comments, I'll resume the review.",
    "created_at": "2010-02-23T22:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86661",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

<a id='comment:2'></a>Hello, Sébastien !

I tested your patch and generated the documentation. I have some comments on the latter:

1. The first sentence appears kind of complicated.

   Returns the partition of the alphabet induced by the equivalence relation obtained
   from the symmetric, reflexive and transitive closure of the set of pairs of letters
   R_{self,other,delay}\cup p defined below.

I suggest something like:

  Returns the partition over the alphabet induced by overlapping the words self
  and other with given delay.

Then you give the formal definition and the example.

2. In the example, it is not clear how the words `cheval` and `abcdef` overlap. It could be better to use a constant width character font if possible.

3. You should give more details about what the involution is there for.

4. Same comment about parameter `p`. I prefer more significant name (in that case, maybe `partition` ?) and it would be nice to know what `p` is used for (I guess it's a partition corresponding to already equivalent letters ?)

That's all for now. The rest seems fine. As soon as you fix the documentation according to my comments, I'll resume the review.



---

archive/issue_comments_086662.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-02-23T22:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86662",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_086663.json:
```json
{
    "body": "Changing keywords from \"\" to \"equation, words, partition\".",
    "created_at": "2010-02-23T22:16:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86663",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

Changing keywords from "" to "equation, words, partition".



---

archive/issue_comments_086664.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-02-28T18:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86664",
    "user": "https://github.com/seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_086665.json:
```json
{
    "body": "<a id='comment:3'></a>Attachment [trac_8318_overlap_partition-sl.patch](tarball://root/attachments/some-uuid/ticket8318/trac_8318_overlap_partition-sl.patch) by @seblabbe created at 2010-02-28 18:13:55\n\nI fixed the documentation. Needs review!",
    "created_at": "2010-02-28T18:13:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86665",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:3'></a>Attachment [trac_8318_overlap_partition-sl.patch](tarball://root/attachments/some-uuid/ticket8318/trac_8318_overlap_partition-sl.patch) by @seblabbe created at 2010-02-28 18:13:55

I fixed the documentation. Needs review!



---

archive/issue_comments_086666.json:
```json
{
    "body": "<a id='comment:4'></a>I'm done with the review. All tests passed, I corrected a minor error in the documentation. The code makes sense. Positive review.",
    "created_at": "2010-03-01T13:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86666",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

<a id='comment:4'></a>I'm done with the review. All tests passed, I corrected a minor error in the documentation. The code makes sense. Positive review.



---

archive/issue_comments_086667.json:
```json
{
    "body": "Attachment [trac_8313_review-abm.patch](tarball://root/attachments/some-uuid/ticket8318/trac_8313_review-abm.patch) by abmasse created at 2010-03-01 13:24:50\n\none-character review -- apply on top of the first patch",
    "created_at": "2010-03-01T13:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86667",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

Attachment [trac_8313_review-abm.patch](tarball://root/attachments/some-uuid/ticket8318/trac_8313_review-abm.patch) by abmasse created at 2010-03-01 13:24:50

one-character review -- apply on top of the first patch



---

archive/issue_comments_086668.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Alexandre Blondin Mass\u00e9\"",
    "created_at": "2010-03-01T13:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86668",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

Changing reviewer from "" to "Alexandre Blondin Massé"



---

archive/issue_comments_086669.json:
```json
{
    "body": "Changing author from \"\" to \"S\u00e9bastien Labb\u00e9\"",
    "created_at": "2010-03-01T13:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86669",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

Changing author from "" to "Sébastien Labbé"



---

archive/issue_comments_086670.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-03-01T13:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86670",
    "user": "https://trac.sagemath.org/admin/accounts/users/abmasse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_019906.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/mvngu",
    "created_at": "2010-03-02T21:35:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/8318#event-19906"
}
```



---

archive/issue_comments_086671.json:
```json
{
    "body": "<a id='comment:6'></a>Merged in this order:\n\n1. [trac_8318_overlap_partition-sl.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/8318/trac_8318_overlap_partition-sl.patch)\n2. [trac_8313_review-abm.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/8318/trac_8313_review-abm.patch)",
    "created_at": "2010-03-02T21:35:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86671",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

<a id='comment:6'></a>Merged in this order:

1. [trac_8318_overlap_partition-sl.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/8318/trac_8318_overlap_partition-sl.patch)
2. [trac_8313_review-abm.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/8318/trac_8313_review-abm.patch)



---

archive/issue_comments_086672.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-03-02T21:35:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86672",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Resolution: fixed



---

archive/issue_comments_086673.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.3.4.alpha0\"",
    "created_at": "2010-03-02T21:35:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/8318",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/8318#issuecomment-86673",
    "user": "https://trac.sagemath.org/admin/accounts/users/mvngu"
}
```

Changing merged from "" to "sage-4.3.4.alpha0"
