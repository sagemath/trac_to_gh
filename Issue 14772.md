# Issue 14772: formatting of references

Issue created by migration from Trac.

Original creator: eisermbi

Original creation time: 2013-08-06 10:49:04

CC:  ncohen

There seems to be some bug in the HTML generation... The docstring of the function `RandomGNP` in the file "sage/graphs/generators/random.py"
contains


```
    REFERENCES:

    .. [1] P. Erdos and A. Renyi. On Random Graphs, Publ. Math. 6, 290 (1959).

    .. [2] E. N. Gilbert. Random Graphs, Ann. Math. Stat., 30, 1141 (1959).

    .. [3] V. Batagelj and U. Brandes. Efficient generation of large
           random networks. Phys. Rev. E, 71, 036113, 2005.

```


Calling `./sage --docbuild reference html` creates the following output
with *unequal and wide* spacing (file: "doc/output/html/en/reference/graphs/sage/graphs/graph_generators.html"):


```
<p>REFERENCES:</p>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[1]</td><td><ol class="first last upperalpha simple" start="16">
<li>Erdos and A. Renyi. On Random Graphs, Publ. Math. 6, 290 (1959).</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><ol class="first last upperalpha simple" start="5">
<li><ol class="first upperalpha" start="14">
<li>Gilbert. Random Graphs, Ann. Math. Stat., 30, 1141 (1959).</li>
</ol>
</li>
</ol>
</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[3]</a></td><td>V. Batagelj and U. Brandes. Efficient generation of large
random networks. Phys. Rev. E, 71, 036113, 2005.</td></tr>
</tbody>
</table>
```



Replacing ".." with "-" (e.g. ` .. [1] P. Erdos ` by ` - [1] P. Erdos `; as it is used in the docstring of the method `LCFGraph` in "sage/graphs/generators/families.py") will yield the following compiler error:


```
docstring of sage.graphs.graph_generators.GraphGenerators.RandomGNP:12: ERROR: Unknown target name: "3".
```


Nevertheless the output _looks_ alright in the browser (but item 3 has different HTML code):


```
<p>REFERENCES:</p>
<ul>
<li><p class="first">[1] P. Erdos and A. Renyi. On Random Graphs, Publ. Math. 6, 290 (1959).</p>
</li>
<li><p class="first">[2] E. N. Gilbert. Random Graphs, Ann. Math. Stat., 30, 1141 (1959).</p>
</li>
<li><dl class="first docutils">
<dt>[3] V. Batagelj and U. Brandes. Efficient generation of large</dt>
<dd><p class="first last">random networks. Phys. Rev. E, 71, 036113, 2005.</p>
</dd>
</dl>
</li>
</ul>
```


----

Furthermore, if only a docstring of a file in "sage/graphs/generators/" is changed and `./sage -b` is run, then `./sage --docbuild reference html` does *not* recognize the docstring change. My workaround is to make a modification to "sage/graphs/graph_generators.py" each time to trigger the necessity of a rebuild of the html reference.


---

Comment by vbraun created at 2013-08-06 13:41:52

The thing in square brackets is the reference link (and will be a hyperlink in the docs):

```
See page 89 of [Nat2000]_.

REFERENCES:

.. [Nat2000] M.B. Nathanson. Elementary Methods in Number Theory.
   Springer, 2000.
}}} 
Using numbers as keys is extremely uncool since the reference name must be unique throughout the reference manual. This is probably why `LCFGraph` doesn't do references correctly.


---

Comment by eisermbi created at 2013-08-07 16:44:38

I see. Hence, the proper way to state a reference is by using ".." and a proper reference name in square brackets. I am attaching a patch that corrects all reference sections under `sage/graphs` that have reference links to them.

Just noted that for
`RandomGNP` of `sage/graphs/graph_generators_pyx.pyx`,
`RandomGNP` of `sage/graphs/generators/random.py`,
`RandomDirectedGNP` of `sage/graphs/digraph_generators.py`,
the first two references are the same. I will leave it like that...

The usage of "-" seems to create a list with bullets. Hence, it might be only acceptable if none of the entries in the reference section are used by a reference link... I will also leave such lists as they are (though the numbers with square brackets seem to be of not much benefit).


---

Comment by ncohen created at 2013-08-08 13:01:40

Helloooooooooooo !!

Well, it all seems right. Could I ask you to do a couple of modifications though ? I'm sorry to ask that but I now have a Git version of Sage, and I don't think I could easily produce a diff patch to be applied on top of your mercurial patch, considering that some folders have been renamed in the git version of Sage `^^;`

There are two things, actually :

* `c_i = triangles_i / (k_i\*(k_i-1)/2)` appears three times in `generic_graph.py`, and it would be much prettied if it were `c_i = \text{triangles}_i / \binom {k_i} 2` instead

* `T = 3\*triangles/triads` should be LaTeX code, i.e. ``T = 3\times \text{triangles}/\text{triads}``

Sorry for that ! Looks like it is my fault, by the way `^^;`

Nathann


---

Comment by eisermbi created at 2013-08-11 14:10:25

Changing status from new to needs_review.


---

Comment by eisermbi created at 2013-08-11 14:10:48

I have rewritten the docstrings of `cluster_triangles, clustering_average, cluster_transitivity, clustering_coeff`. Hope that listing a reference (here: NetworkX documentation) only once for 4 methods is okay. Otherwise one needs to change each instance of the reference... What do you think?


---

Attachment

References should be defined once and referenced as often as necessary. If the reference is not specific to the method but referred to in other methods as well then it should probably be defined in the module docstring and not in one of the methods.


---

Comment by vbraun created at 2013-08-11 17:16:55

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2013-08-13 08:30:00

(thank you for having fixed those docstrings !! `:-)`)


---

Comment by jdemeyer created at 2013-08-20 13:00:20

Resolution: fixed
