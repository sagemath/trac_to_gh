# Issue 31691: Failure when testing sage_conf version

Issue created by migration from https://trac.sagemath.org/ticket/31928

Original creator: vbraun

Original creation time: 2021-06-07 21:36:21

CC:  jhpalmieri dimpase slelievre mkoeppe

Incremental builds fail when crossing a Sage version

```
**********************************************************************
File "src/sage/misc/package.py", line 359, in sage.misc.package.installed_packages
Failed example:
    installed_packages()['sage_conf'] == sage.env.SAGE_VERSION # optional - build
Expected:
    True
Got:
    False
**********************************************************************
1 item had failures:
   1 of   4 in sage.misc.package.installed_packages
    [52 tests, 1 failure, 4.40 s]
----------------------------------------------------------------------
```



---

Comment by tmonteil created at 2021-06-10 16:06:36

I set this ticket to critical as it breaks all patchbots, see https://patchbot.sagemath.org/ticket/0/


---

Comment by tmonteil created at 2021-06-10 16:06:36

Changing priority from major to critical.


---

Comment by jhpalmieri created at 2021-06-10 16:10:52

We can use the fix originally proposed in #31577:

```
installed_packages()['sage_conf']  # optional - build, random
```

Other ideas?


---

Comment by tmonteil created at 2021-06-10 16:42:54

What is the initial goal of this doctest ? If it is useless why not simply remove it ?


---

Comment by mkoeppe created at 2021-06-11 18:52:37

I think the original intention of the doctest was to show a package without a version. But there is no longer such a package that is guaranteed to be installed.

So I have just removed it.
----
New commits:


---

Comment by mkoeppe created at 2021-06-11 18:52:47

Changing status from new to needs_review.


---

Comment by tmonteil created at 2021-06-11 19:11:29

Changing status from needs_review to positive_review.


---

Comment by tmonteil created at 2021-06-11 19:11:29

Good move.


---

Comment by mkoeppe created at 2021-06-11 21:51:43

Thanks!


---

Comment by vbraun created at 2021-06-19 20:57:18

Resolution: fixed
