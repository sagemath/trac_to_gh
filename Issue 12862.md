# Issue 12862: Fix index in saturation of zero matrices

Issue created by migration from Trac.

Original creator: novoselt

Original creation time: 2012-05-27 17:15:42

Assignee: jason, was

CC:  rbeezer was

Keywords: sd40.5

Now:

```
sage: m = matrix(ZZ, 3)
sage: m.index_in_saturation()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)

/home/novoselt/sage-5.1.beta0/devel/sage-main/<ipython console> in <module>()

/home/novoselt/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/matrix/matrix_integer_dense.so in sage.matrix.matrix_integer_dense.Matrix_integer_dense.index_in_saturation (sage/matrix/matrix_integer_dense.c:17074)()

/home/novoselt/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/matrix/matrix_integer_dense_saturation.pyc in index_in_saturation(A, proof)
    308     A = A.transpose()
    309     A = A.hermite_form(proof=proof,include_zero_rows=False)
--> 310     return abs(A.determinant(proof=proof))
    311     
    312 

/home/novoselt/sage-5.1.beta0/local/lib/python2.7/site-packages/sage/matrix/matrix_integer_dense.so in sage.matrix.matrix_integer_dense.Matrix_integer_dense.determinant (sage/matrix/matrix_integer_dense.c:25359)()

ValueError: self must be a square matrix
```

while it should be 1.


---

Comment by novoselt created at 2012-05-27 17:25:55

Changing status from new to needs_review.


---

Comment by was created at 2012-05-27 17:35:59

1. Can you change `return 1` to something like `return Integer(1)`?

2. Can you rebase this against sage-5.0?  For me, I get

```
adding trac_13034_fix_index_in_saturation.patch to series file
applying trac_13034_fix_index_in_saturation.patch
patching file sage/matrix/matrix_integer_dense_saturation.py
Hunk #1 FAILED at 290
Hunk #2 FAILED at 298
2 out of 2 hunks FAILED -- saving rejects to file sage/matrix/matrix_integer_dense_saturation.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_13034_fix_index_in_saturation.patch
```



---

Comment by was created at 2012-05-27 17:35:59

Changing status from needs_review to needs_work.


---

Attachment

I've changed 1 to ZZ(1), but didn't rebase - it applies smoothly to sage-5.1.beta0 with Python-2.7.3 from #13013 (I can't pop Python upgrade patch)


---

Comment by novoselt created at 2012-05-27 17:52:23

Changing status from needs_work to needs_review.


---

Comment by was created at 2012-05-27 18:06:38

Changing status from needs_review to positive_review.


---

Comment by was created at 2012-05-27 18:06:38

I didn't actually apply the patch (can't), but it looks good to me.


---

Comment by jdemeyer created at 2012-06-09 19:23:02

Please fill in your real name in the Author / Reviewer fields.


---

Comment by jdemeyer created at 2012-06-23 21:44:32

Resolution: fixed
