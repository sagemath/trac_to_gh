# Issue 33190: numerical noise in effective_resistance involving RDF

Issue created by migration from https://trac.sagemath.org/ticket/33427

Original creator: tmonteil

Original creation time: 2022-02-28 11:14:40

CC:  mkoeppe dcoudert

Many patchbots can not pass the `9.6.beta3` release because of some new doctest introduced in #33388, see https://patchbot.sagemath.org/ticket/0/

The failing doctest is:


```
File "src/sage/graphs/graph.py", line 8586, in sage.graphs.graph.Graph.effective_resistance
Failed example:
    H.effective_resistance(1, 5, base_ring=RDF)
Expected:
    1.20000...
Got:
    1.1999999999999997
```




---

Comment by tmonteil created at 2022-02-28 11:29:16

Changing status from new to needs_review.


---

Comment by tmonteil created at 2022-02-28 11:29:16

New commits:


---

Comment by dcoudert created at 2022-02-28 11:34:51

Sorry for that. Isn't 1e-14 too small for 32bits computers ?


---

Comment by tmonteil created at 2022-02-28 11:46:21

Replying to [comment:4 dcoudert]:
> Sorry for that. Isn't 1e-14 too small for 32bits computers ?

It shouldn't, RDF numbers are coded on 64 bits and have 53bits of precision on both 32-bit and 64-bit architectures.


---

Comment by tmonteil created at 2022-02-28 12:02:50

Replying to [comment:5 tmonteil]:
> Replying to [comment:4 dcoudert]:
> > Sorry for that. Isn't 1e-14 too small for 32bits computers ?
> 
> It shouldn't, RDF numbers are coded on 64 bits and have 53bits of precision on both 32-bit and 64-bit architectures.

The error reported on the patchbots is `3e-16`, so `1e-14` is actually quite conservative (i could have put `1e-15`)


---

Comment by dcoudert created at 2022-02-28 12:06:34

I was not aware of the precision of RDF. Thanks.

LGTM.


---

Comment by dcoudert created at 2022-02-28 12:06:34

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2022-03-01 11:23:14

Should we increase priority to ensure inclusion in next beta ?


---

Comment by tmonteil created at 2022-03-01 11:41:47

Why not.


---

Comment by tmonteil created at 2022-03-01 11:41:47

Changing priority from major to critical.


---

Comment by vbraun created at 2022-03-01 21:31:16

Resolution: fixed
