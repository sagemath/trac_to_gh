# Issue 25601: sagemath does not translate function('F') to F := operator "F" for fricas interface

archive/issues_025601.json:
```json
{
    "body": "CC:  @rwst\n\nKeywords: integrate, fricas\n\nWhen using algorithm=\"fricas\" in integrate, I defined F as function in sagemath. BUt when the call is made to integrate using fricas, it did  not seem to be translated correctly to fricas syntax, which is \n   \n\n```\nF := operator \"F\"\n```\n\n\nSo fricas was not happy. \n\n\n\n```\n>sage\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 SageMath version 8.3.rc0, Release Date: 2018-07-08                 \u2502\n\u2502 Type \"notebook()\" for the browser-based notebook interface.        \u2502\n\u2502 Type \"help()\" for help.                                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\u250f\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2513\n\u2503 Warning: this is a prerelease version, and it may be unstable.     \u2503\n\u2517\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u2501\u251b\nsage: var('x')\nx\nsage: F=function('F')\nsage: integrate(F(x),x,algorithm=\"fricas\")\n\n.....\nTypeError: An error occurred when FriCAS evaluated 'F(x)':\n\n```\n\n\nThe Fricas syntax using Fricas directly is\n\n\n\n\n```\n>fricas\nChecking for foreign routines\nAXIOM=\"/usr/lib/fricas/target/x86_64-linux-gnu\"\nspad-lib=\"/usr/lib/fricas/target/x86_64-linux-gnu/lib/libspad.so\"\n                       FriCAS Computer Algebra System \n                            Version: FriCAS 1.3.4\n                   Timestamp: Thu Jun 28 08:31:47 CDT 2018\n------------------------------------------------------------------- \n\n(1) -> F := operator \"F\"\n\n   (1)  F\n                                                          Type: BasicOperator\n(2) -> integrate(F(x),x)\n\n           x\n         ++\n   (2)   |   F(%A)d%A\n        ++\n                                         Type: Union(Expression(Integer),...)\n\n```\n\n\n\nSo many such integrals that use generic function such as the above now fail in sagemath when using FriCAS algorithm because it is not translated correctly.\n\nThank you\n\n--Nasser\n\nIssue created by migration from https://trac.sagemath.org/ticket/25838\n\n",
    "created_at": "2018-07-12T01:46:26Z",
    "labels": [
        "component: interfaces",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "sagemath does not translate function('F') to F := operator \"F\" for fricas interface",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25601",
    "user": "https://github.com/nasser1"
}
```
CC:  @rwst

Keywords: integrate, fricas

When using algorithm="fricas" in integrate, I defined F as function in sagemath. BUt when the call is made to integrate using fricas, it did  not seem to be translated correctly to fricas syntax, which is 
   

```
F := operator "F"
```


So fricas was not happy. 



```
>sage
┌────────────────────────────────────────────────────────────────────┐
│ SageMath version 8.3.rc0, Release Date: 2018-07-08                 │
│ Type "notebook()" for the browser-based notebook interface.        │
│ Type "help()" for help.                                            │
└────────────────────────────────────────────────────────────────────┘
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Warning: this is a prerelease version, and it may be unstable.     ┃
┗━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┛
sage: var('x')
x
sage: F=function('F')
sage: integrate(F(x),x,algorithm="fricas")

.....
TypeError: An error occurred when FriCAS evaluated 'F(x)':

```


The Fricas syntax using Fricas directly is




```
>fricas
Checking for foreign routines
AXIOM="/usr/lib/fricas/target/x86_64-linux-gnu"
spad-lib="/usr/lib/fricas/target/x86_64-linux-gnu/lib/libspad.so"
                       FriCAS Computer Algebra System 
                            Version: FriCAS 1.3.4
                   Timestamp: Thu Jun 28 08:31:47 CDT 2018
------------------------------------------------------------------- 

(1) -> F := operator "F"

   (1)  F
                                                          Type: BasicOperator
(2) -> integrate(F(x),x)

           x
         ++
   (2)   |   F(%A)d%A
        ++
                                         Type: Union(Expression(Integer),...)

```



So many such integrals that use generic function such as the above now fail in sagemath when using FriCAS algorithm because it is not translated correctly.

Thank you

--Nasser

Issue created by migration from https://trac.sagemath.org/ticket/25838





---

archive/issue_comments_360655.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2018-07-12T01:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360655",
    "user": "https://github.com/nasser1"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_360656.json:
```json
{
    "body": "I will work on this once #25602 is reviewed.  It is not hard.",
    "created_at": "2018-07-12T09:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360656",
    "user": "https://github.com/mantepse"
}
```

I will work on this once #25602 is reviewed.  It is not hard.



---

archive/issue_comments_360657.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-13T08:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360657",
    "user": "https://github.com/mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_360658.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-07-13T08:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360658",
    "user": "https://github.com/mantepse"
}
```

New commits:



---

archive/issue_comments_360659.json:
```json
{
    "body": "Changing keywords from \"integrate, fricas\" to \"integrate, fricas, sagedays@icerm\".",
    "created_at": "2018-07-23T11:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360659",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "integrate, fricas" to "integrate, fricas, sagedays@icerm".



---

archive/issue_comments_360660.json:
```json
{
    "body": "One (trivial, looks like a bad copy/paste) doctest failure here:\n\n```\n    def derivative(self, ex, operator):\n        \"\"\"\n        Convert the derivative of ``self`` in FriCAS.\n\n        INPUT:\n\n        - ``ex`` -- a symbolic expression\n\n        - ``operator`` -- operator\n\n        EXAMPLES::\n\n            sage: var('x,y,z')\n            (x, y)\n```\n\nShould be `(x, y, z)`.\n\nOtherwise LGTM.",
    "created_at": "2018-07-23T11:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360660",
    "user": "https://github.com/tscrim"
}
```

One (trivial, looks like a bad copy/paste) doctest failure here:

```
    def derivative(self, ex, operator):
        """
        Convert the derivative of ``self`` in FriCAS.

        INPUT:

        - ``ex`` -- a symbolic expression

        - ``operator`` -- operator

        EXAMPLES::

            sage: var('x,y,z')
            (x, y)
```

Should be `(x, y, z)`.

Otherwise LGTM.



---

archive/issue_events_064634.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2018-07-23T11:24:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "milestone": "sage-8.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25601#event-64634"
}
```



---

archive/issue_comments_360661.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-23T11:41:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360661",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_360662.json:
```json
{
    "body": "Edge case for naming functions vs. variables:\n\n```\nsage: F=function('f')\nsage: f=SR.var('f')\nsage: F(f).diff(f).integrate(f)\nf(f)\n```\n\namazingly this actually works with the maxima interface because:\n\n```\nsage: maxima_calculus(F(f))\n'f(_SAGE_VAR_f)\n```\n",
    "created_at": "2018-07-23T12:14:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360662",
    "user": "https://github.com/nbruin"
}
```

Edge case for naming functions vs. variables:

```
sage: F=function('f')
sage: f=SR.var('f')
sage: F(f).diff(f).integrate(f)
f(f)
```

amazingly this actually works with the maxima interface because:

```
sage: maxima_calculus(F(f))
'f(_SAGE_VAR_f)
```




---

archive/issue_comments_360663.json:
```json
{
    "body": "I'm not sure what I'm supposed to do.  This \"works\" with FriCAS, too:\n\n```\nsage: F=function('f')\nsage: f=SR.var('f')\nsage: fricas(F(f)).D(f).integrate(f)\nf(f)\n```\n\nAm I missing something?  Oh yes, a missing import, fixed.",
    "created_at": "2018-07-23T12:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360663",
    "user": "https://github.com/mantepse"
}
```

I'm not sure what I'm supposed to do.  This "works" with FriCAS, too:

```
sage: F=function('f')
sage: f=SR.var('f')
sage: fricas(F(f)).D(f).integrate(f)
f(f)
```

Am I missing something?  Oh yes, a missing import, fixed.



---

archive/issue_comments_360664.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-23T12:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360664",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_360665.json:
```json
{
    "body": "Replying to [comment:8 mantepse]:\n> I'm not sure what I'm supposed to do.  This \"works\" with FriCAS, too:\n> Am I missing something?  Oh yes, a missing import, fixed.\nOK, then it's fine. I don't have FriCAS installed, so I couldn't check. When I saw `F:= operator F` I figured some care should be taken to avoid name clashes, but apparently this is taken care of already.",
    "created_at": "2018-07-24T04:34:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360665",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:8 mantepse]:
> I'm not sure what I'm supposed to do.  This "works" with FriCAS, too:
> Am I missing something?  Oh yes, a missing import, fixed.
OK, then it's fine. I don't have FriCAS installed, so I couldn't check. When I saw `F:= operator F` I figured some care should be taken to avoid name clashes, but apparently this is taken care of already.



---

archive/issue_comments_360666.json:
```json
{
    "body": "review?",
    "created_at": "2018-07-24T10:43:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360666",
    "user": "https://github.com/mantepse"
}
```

review?



---

archive/issue_comments_360667.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-27T14:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360667",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_360668.json:
```json
{
    "body": "LGTM now, thanks.",
    "created_at": "2018-07-27T14:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360668",
    "user": "https://github.com/tscrim"
}
```

LGTM now, thanks.



---

archive/issue_comments_360669.json:
```json
{
    "body": "Great, many thanks!  Once #25602 is reviewed, integration via FriCAS should be useful for quite a variety of integrands!",
    "created_at": "2018-07-27T16:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360669",
    "user": "https://github.com/mantepse"
}
```

Great, many thanks!  Once #25602 is reviewed, integration via FriCAS should be useful for quite a variety of integrands!



---

archive/issue_comments_360670.json:
```json
{
    "body": "Merge conflict",
    "created_at": "2018-08-26T09:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360670",
    "user": "https://github.com/vbraun"
}
```

Merge conflict



---

archive/issue_comments_360671.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2018-08-26T09:45:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360671",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_360672.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-26T17:52:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360672",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_360673.json:
```json
{
    "body": "trivial rebase",
    "created_at": "2018-08-26T17:52:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360673",
    "user": "https://github.com/mantepse"
}
```

trivial rebase



---

archive/issue_comments_360674.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-08-26T17:54:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360674",
    "user": "https://github.com/mantepse"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_360675.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-26T22:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360675",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_064635.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2018-09-01T09:10:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/25601#event-64635"
}
```



---

archive/issue_comments_360676.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-01T09:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25601",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25601#issuecomment-360676",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
