# Issue 33220: Meta-ticket: migrate from patchbot to github actions

archive/issues_033220.json:
```json
{
    "body": "CC:  @mkoeppe @fchapoton\n\nMost of the CI infrastructure runs already on Github actions. For a full migration from the patchbot to github actions, the following checks need to be migrated:\n- Build and run doctests: Done\n- commit_messages: Still needed? Git doesn't allow empty messages (except if explicitly overwritten with the flag allow-empty-message)\n- coverage\n- deprecation_number\n- python3: Done (via relint, right?)\n- python3_pyx: Done (via relint, right?)\n- pyflakes: replaced by pyright #33456, refs #30415\n- pycodestyle: Done\n- blocks: Done (via relint, right?)\n- triple_colon: Done (via relint, right?)\n- trac_links: Done (via relint, right?)\n- startup_time\n- startup_modules\n- docbuild: Done\n- git_rev_list: Still needed?\n\nIssue created by migration from https://trac.sagemath.org/ticket/33457\n\n",
    "created_at": "2022-03-03T18:59:21Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Meta-ticket: migrate from patchbot to github actions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33220",
    "user": "https://github.com/tobiasdiez"
}
```
CC:  @mkoeppe @fchapoton

Most of the CI infrastructure runs already on Github actions. For a full migration from the patchbot to github actions, the following checks need to be migrated:
- Build and run doctests: Done
- commit_messages: Still needed? Git doesn't allow empty messages (except if explicitly overwritten with the flag allow-empty-message)
- coverage
- deprecation_number
- python3: Done (via relint, right?)
- python3_pyx: Done (via relint, right?)
- pyflakes: replaced by pyright #33456, refs #30415
- pycodestyle: Done
- blocks: Done (via relint, right?)
- triple_colon: Done (via relint, right?)
- trac_links: Done (via relint, right?)
- startup_time
- startup_modules
- docbuild: Done
- git_rev_list: Still needed?

Issue created by migration from https://trac.sagemath.org/ticket/33457





---

archive/issue_comments_472529.json:
```json
{
    "body": "Let me bump up what I requested on another ticket: Next to the \"Build documentation\" badge, there should be a badge with the link to the build log.",
    "created_at": "2022-03-20T19:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472529",
    "user": "https://github.com/mkoeppe"
}
```

Let me bump up what I requested on another ticket: Next to the "Build documentation" badge, there should be a badge with the link to the build log.



---

archive/issue_comments_472530.json:
```json
{
    "body": "Are we going to force sage developers to have a github account ? Otherwise, they cannot see the logs.",
    "created_at": "2022-03-20T19:15:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472530",
    "user": "https://github.com/fchapoton"
}
```

Are we going to force sage developers to have a github account ? Otherwise, they cannot see the logs.



---

archive/issue_comments_472531.json:
```json
{
    "body": "Replying to [comment:4 chapoton]:\n> Are we going to force sage developers to have a github account ? Otherwise, they cannot see the logs.\n\n\nI guess that you have to login to see the logs is a security feature. So yes, sadly you have to have a github account; but that's already the case for the existing test and integration runs (integration = what is run after each push to `develop` in the main repo).",
    "created_at": "2022-03-20T19:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472531",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:4 chapoton]:
> Are we going to force sage developers to have a github account ? Otherwise, they cannot see the logs.


I guess that you have to login to see the logs is a security feature. So yes, sadly you have to have a github account; but that's already the case for the existing test and integration runs (integration = what is run after each push to `develop` in the main repo).



---

archive/issue_comments_472532.json:
```json
{
    "body": "It would of course be possible to reuse some of the sage-patchbot code to post the logs to the patchbot server. If someone wants to work on this, I'll be happy to help.",
    "created_at": "2022-03-21T06:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472532",
    "user": "https://github.com/mkoeppe"
}
```

It would of course be possible to reuse some of the sage-patchbot code to post the logs to the patchbot server. If someone wants to work on this, I'll be happy to help.



---

archive/issue_events_088177.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-11T17:19:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33220#event-88177"
}
```



---

archive/issue_comments_472533.json:
```json
{
    "body": "Let's migrate https://wiki.sagemath.org/patchbot and https://wiki.sagemath.org/patchbot/plugins from the old Sage wiki to a better location - either the Trac Wiki (https://trac.sagemath.org/wiki/TitleIndex) or [GitHub](GitHub) (https://github.com/sagemath/sage-patchbot).\n\nThe info in https://wiki.sagemath.org/patchbot/plugins can then be consolidated with the info that you put in the ticket description.",
    "created_at": "2022-04-16T20:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472533",
    "user": "https://github.com/mkoeppe"
}
```

Let's migrate https://wiki.sagemath.org/patchbot and https://wiki.sagemath.org/patchbot/plugins from the old Sage wiki to a better location - either the Trac Wiki (https://trac.sagemath.org/wiki/TitleIndex) or [GitHub](GitHub) (https://github.com/sagemath/sage-patchbot).

The info in https://wiki.sagemath.org/patchbot/plugins can then be consolidated with the info that you put in the ticket description.



---

archive/issue_comments_472534.json:
```json
{
    "body": "Patchbot plugins that are already converted can simply removed, or not?",
    "created_at": "2022-04-17T21:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472534",
    "user": "https://github.com/tobiasdiez"
}
```

Patchbot plugins that are already converted can simply removed, or not?



---

archive/issue_comments_472535.json:
```json
{
    "body": "People look at the patchbot reports. Not sure if they look at the new linter reports",
    "created_at": "2022-04-17T21:32:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472535",
    "user": "https://github.com/mkoeppe"
}
```

People look at the patchbot reports. Not sure if they look at the new linter reports



---

archive/issue_comments_472536.json:
```json
{
    "body": "Replying to [comment:8 mkoeppe]:\n> Let's migrate https://wiki.sagemath.org/patchbot and https://wiki.sagemath.org/patchbot/plugins from the old Sage wiki to a better location\n\n\nIt is now at https://trac.sagemath.org/wiki/patchbot/plugins",
    "created_at": "2022-04-18T02:41:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472536",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:8 mkoeppe]:
> Let's migrate https://wiki.sagemath.org/patchbot and https://wiki.sagemath.org/patchbot/plugins from the old Sage wiki to a better location


It is now at https://trac.sagemath.org/wiki/patchbot/plugins



---

archive/issue_comments_472537.json:
```json
{
    "body": "I've cross-referenced the \"relint\" checks there.",
    "created_at": "2022-04-18T02:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472537",
    "user": "https://github.com/mkoeppe"
}
```

I've cross-referenced the "relint" checks there.



---

archive/issue_events_088178.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T20:41:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33220#event-88178"
}
```



---

archive/issue_events_088179.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-01T20:41:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/33220#event-88179"
}
```



---

archive/issue_comments_472538.json:
```json
{
    "body": "Is there anything that the patchbot does that is not covered yet by our GH Actions?\n\nIf not, then we should close this ticket as completed.",
    "created_at": "2022-09-10T19:08:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472538",
    "user": "https://github.com/mkoeppe"
}
```

Is there anything that the patchbot does that is not covered yet by our GH Actions?

If not, then we should close this ticket as completed.



---

archive/issue_comments_472539.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2022-09-10T19:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472539",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_472540.json:
```json
{
    "body": "Some of the patchbot checks are not well documented, so I don't know if they are fully replaced by the (corresponding) github action. Feel free to update the issue description.",
    "created_at": "2022-09-11T07:11:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472540",
    "user": "https://github.com/tobiasdiez"
}
```

Some of the patchbot checks are not well documented, so I don't know if they are fully replaced by the (corresponding) github action. Feel free to update the issue description.



---

archive/issue_comments_472541.json:
```json
{
    "body": "This \n\nhttps://patchbot.sagemath.org/\n\nis not accessible. What is the status? Is it already shutdown?",
    "created_at": "2022-09-12T01:55:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472541",
    "user": "https://github.com/kwankyu"
}
```

This 

https://patchbot.sagemath.org/

is not accessible. What is the status? Is it already shutdown?



---

archive/issue_comments_472542.json:
```json
{
    "body": "works for me",
    "created_at": "2022-09-12T01:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472542",
    "user": "https://github.com/mkoeppe"
}
```

works for me



---

archive/issue_comments_472543.json:
```json
{
    "body": "```\n$ ping patchbot.sagemath.org\nPING patchbot.sagemath.org (130.79.210.80): 56 data bytes\nRequest timeout for icmp_seq 0\nRequest timeout for icmp_seq 1\nRequest timeout for icmp_seq 2\nRequest timeout for icmp_seq 3\n...\n```\n\nThen perhaps just from Asia...",
    "created_at": "2022-09-12T02:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472543",
    "user": "https://github.com/kwankyu"
}
```

```
$ ping patchbot.sagemath.org
PING patchbot.sagemath.org (130.79.210.80): 56 data bytes
Request timeout for icmp_seq 0
Request timeout for icmp_seq 1
Request timeout for icmp_seq 2
Request timeout for icmp_seq 3
...
```

Then perhaps just from Asia...



---

archive/issue_comments_472544.json:
```json
{
    "body": "Replying to [comment:20 Kwankyu Lee]:\n> {{{\n\nThe server does not seem to respond to ping. (The web page is working for me, but ping  gives me timeouts, with no packets received, like for you.) I was able to access the web page even if I used a vpn to locate myself in South Korea, Japan, or China. I hope it is just some temporary glitch for you.\n\n>{{{\n> $ ping patchbot.sagemath.org\n> PING patchbot.sagemath.org (130.79.210.80): 56 data bytes\n> Request timeout for icmp_seq 0\n> Request timeout for icmp_seq 1\n> Request timeout for icmp_seq 2\n> Request timeout for icmp_seq 3\n> ...\n> }}}\n> \n> Then perhaps just from Asia...",
    "created_at": "2022-09-12T03:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472544",
    "user": "https://github.com/DaveWitteMorris"
}
```

Replying to [comment:20 Kwankyu Lee]:
> {{{

The server does not seem to respond to ping. (The web page is working for me, but ping  gives me timeouts, with no packets received, like for you.) I was able to access the web page even if I used a vpn to locate myself in South Korea, Japan, or China. I hope it is just some temporary glitch for you.

>{{{
> $ ping patchbot.sagemath.org
> PING patchbot.sagemath.org (130.79.210.80): 56 data bytes
> Request timeout for icmp_seq 0
> Request timeout for icmp_seq 1
> Request timeout for icmp_seq 2
> Request timeout for icmp_seq 3
> ...
> }}}
> 
> Then perhaps just from Asia...



---

archive/issue_comments_472545.json:
```json
{
    "body": "Replying to [comment:22 Dave Morris]:\n> Replying to [comment:20 Kwankyu Lee]:\n> > {{{\n\n> The server does not seem to respond to ping. (The web page is working for me, but ping  gives me timeouts, with no packets received, like for you.) I was able to access the web page even if I used a vpn to locate myself in South Korea, Japan, or China. I hope it is just some temporary glitch for you.\n\nYes. The website works for me now. Thank you.",
    "created_at": "2022-09-12T04:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472545",
    "user": "https://github.com/kwankyu"
}
```

Replying to [comment:22 Dave Morris]:
> Replying to [comment:20 Kwankyu Lee]:
> > {{{

> The server does not seem to respond to ping. (The web page is working for me, but ping  gives me timeouts, with no packets received, like for you.) I was able to access the web page even if I used a vpn to locate myself in South Korea, Japan, or China. I hope it is just some temporary glitch for you.

Yes. The website works for me now. Thank you.



---

archive/issue_comments_472546.json:
```json
{
    "body": "According to the original code in \n\ncommit `601bd024373caa9f67abfbbf1305a1fdec9005c5`, \n\nthe `commit_messages` is to check the format of the commit messages of patches for patch-based Mercurial SCM. So this is a remnant from the archaic pre-git era. Not needed anymore.",
    "created_at": "2022-09-12T04:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472546",
    "user": "https://github.com/kwankyu"
}
```

According to the original code in 

commit `601bd024373caa9f67abfbbf1305a1fdec9005c5`, 

the `commit_messages` is to check the format of the commit messages of patches for patch-based Mercurial SCM. So this is a remnant from the archaic pre-git era. Not needed anymore.



---

archive/issue_comments_472547.json:
```json
{
    "body": "A typical example of `git_rev_list`:\n\nhttps://patchbot.sagemath.org/log/31892/Darwin/Darwin%20Kernel%20Version%2021.2.0:%20Sun%20Nov%2028%2020:28:54%20PST%202021;%20root:xnu-8019.61.5~1/RELEASE_X86_64/x86_64/21.2.0/steenrod/2022-08-08%2005:08:06?plugin=git_rev_list&diff=/log/0/Darwin/Darwin%20Kernel%20Version%2021.2.0%3A%20Sun%20Nov%2028%2020%3A28%3A54%20PST%202021%3B%20root%3Axnu-8019.61.5~1/RELEASE_X86_64/x86_64/21.2.0/steenrod/2022-08-16%2020%3A34%3A40&ticket=31892&base=9.7.beta8\n\nIt just shows the information about the changed files and new commits that you can get from git by comparing the base tree and the ticket tree. Not very useful.",
    "created_at": "2022-09-12T05:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33220",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33220#issuecomment-472547",
    "user": "https://github.com/kwankyu"
}
```

A typical example of `git_rev_list`:

https://patchbot.sagemath.org/log/31892/Darwin/Darwin%20Kernel%20Version%2021.2.0:%20Sun%20Nov%2028%2020:28:54%20PST%202021;%20root:xnu-8019.61.5~1/RELEASE_X86_64/x86_64/21.2.0/steenrod/2022-08-08%2005:08:06?plugin=git_rev_list&diff=/log/0/Darwin/Darwin%20Kernel%20Version%2021.2.0%3A%20Sun%20Nov%2028%2020%3A28%3A54%20PST%202021%3B%20root%3Axnu-8019.61.5~1/RELEASE_X86_64/x86_64/21.2.0/steenrod/2022-08-16%2020%3A34%3A40&ticket=31892&base=9.7.beta8

It just shows the information about the changed files and new commits that you can get from git by comparing the base tree and the ticket tree. Not very useful.
