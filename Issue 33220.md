# Issue 33220: Meta-ticket: migrate from patchbot to github actions

Issue created by migration from https://trac.sagemath.org/ticket/33457

Original creator: @tobiasdiez

Original creation time: 2022-03-03 18:59:21

CC:  mkoeppe chapoton

Most of the CI infrastructure runs already on Github actions. For a full migration from the patchbot to github actions, the following checks need to be migrated:
- Build and run doctests: Done
- commit_messages: Still needed? Git doesn't allow empty messages (except if explicitly overwritten with the flag allow-empty-message)
- coverage
- deprecation_number
- python3: Done (via relint, right?)
- python3_pyx: Done (via relint, right?)
- pyflakes: replaced by pyright #33456, refs #30415
- pycodestyle: Done
- blocks: Done (via relint, right?)
- triple_colon: Done (via relint, right?)
- trac_links: Done (via relint, right?)
- startup_time
- startup_modules
- docbuild: Done
- git_rev_list: Still needed?


---

Comment by mkoeppe created at 2022-03-20 19:09:37

Let me bump up what I requested on another ticket: Next to the "Build documentation" badge, there should be a badge with the link to the build log.


---

Comment by chapoton created at 2022-03-20 19:15:42

Are we going to force sage developers to have a github account ? Otherwise, they cannot see the logs.


---

Comment by @tobiasdiez created at 2022-03-20 19:52:16

Replying to [comment:4 chapoton]:
> Are we going to force sage developers to have a github account ? Otherwise, they cannot see the logs.

I guess that you have to login to see the logs is a security feature. So yes, sadly you have to have a github account; but that's already the case for the existing test and integration runs (integration = what is run after each push to `develop` in the main repo).


---

Comment by mkoeppe created at 2022-03-21 06:36:51

It would of course be possible to reuse some of the sage-patchbot code to post the logs to the patchbot server. If someone wants to work on this, I'll be happy to help.


---

Comment by mkoeppe created at 2022-04-16 20:23:21

Let's migrate https://wiki.sagemath.org/patchbot and https://wiki.sagemath.org/patchbot/plugins from the old Sage wiki to a better location - either the Trac Wiki (https://trac.sagemath.org/wiki/TitleIndex) or [GitHub](GitHub) (https://github.com/sagemath/sage-patchbot).

The info in https://wiki.sagemath.org/patchbot/plugins can then be consolidated with the info that you put in the ticket description.


---

Comment by @tobiasdiez created at 2022-04-17 21:22:14

Patchbot plugins that are already converted can simply removed, or not?


---

Comment by mkoeppe created at 2022-04-17 21:32:22

People look at the patchbot reports. Not sure if they look at the new linter reports


---

Comment by mkoeppe created at 2022-04-18 02:41:38

Replying to [comment:8 mkoeppe]:
> Let's migrate https://wiki.sagemath.org/patchbot and https://wiki.sagemath.org/patchbot/plugins from the old Sage wiki to a better location

It is now at https://trac.sagemath.org/wiki/patchbot/plugins


---

Comment by mkoeppe created at 2022-04-18 02:54:03

I've cross-referenced the "relint" checks there.


---

Comment by mkoeppe created at 2022-09-10 19:08:10

Is there anything that the patchbot does that is not covered yet by our GH Actions?

If not, then we should close this ticket as completed.


---

Comment by mkoeppe created at 2022-09-10 19:14:11

Changing status from new to needs_info.


---

Comment by @tobiasdiez created at 2022-09-11 07:11:39

Some of the patchbot checks are not well documented, so I don't know if they are fully replaced by the (corresponding) github action. Feel free to update the issue description.


---

Comment by klee created at 2022-09-12 01:55:56

This 

https://patchbot.sagemath.org/

is not accessible. What is the status? Is it already shutdown?


---

Comment by mkoeppe created at 2022-09-12 01:58:29

works for me


---

Comment by klee created at 2022-09-12 02:07:44


```
$ ping patchbot.sagemath.org
PING patchbot.sagemath.org (130.79.210.80): 56 data bytes
Request timeout for icmp_seq 0
Request timeout for icmp_seq 1
Request timeout for icmp_seq 2
Request timeout for icmp_seq 3
...
```


Then perhaps just from Asia...


---

Comment by @DaveWitteMorris created at 2022-09-12 03:46:52

Replying to [comment:20 Kwankyu Lee]:
> {{{
The server does not seem to respond to ping. (The web page is working for me, but ping  gives me timeouts, with no packets received, like for you.) I was able to access the web page even if I used a vpn to locate myself in South Korea, Japan, or China. I hope it is just some temporary glitch for you.

>{{{
> $ ping patchbot.sagemath.org
> PING patchbot.sagemath.org (130.79.210.80): 56 data bytes
> Request timeout for icmp_seq 0
> Request timeout for icmp_seq 1
> Request timeout for icmp_seq 2
> Request timeout for icmp_seq 3
> ...
> }}}
> 
> Then perhaps just from Asia...


---

Comment by klee created at 2022-09-12 04:10:14

Replying to [comment:22 Dave Morris]:
> Replying to [comment:20 Kwankyu Lee]:
> > {{{
> The server does not seem to respond to ping. (The web page is working for me, but ping  gives me timeouts, with no packets received, like for you.) I was able to access the web page even if I used a vpn to locate myself in South Korea, Japan, or China. I hope it is just some temporary glitch for you.

Yes. The website works for me now. Thank you.


---

Comment by klee created at 2022-09-12 04:44:30

According to the original code in 

commit `601bd024373caa9f67abfbbf1305a1fdec9005c5`, 

the `commit_messages` is to check the format of the commit messages of patches for patch-based Mercurial SCM. So this is a remnant from the archaic pre-git era. Not needed anymore.


---

Comment by klee created at 2022-09-12 05:12:43

A typical example of `git_rev_list`:

https://patchbot.sagemath.org/log/31892/Darwin/Darwin%20Kernel%20Version%2021.2.0:%20Sun%20Nov%2028%2020:28:54%20PST%202021;%20root:xnu-8019.61.5~1/RELEASE_X86_64/x86_64/21.2.0/steenrod/2022-08-08%2005:08:06?plugin=git_rev_list&diff=/log/0/Darwin/Darwin%20Kernel%20Version%2021.2.0%3A%20Sun%20Nov%2028%2020%3A28%3A54%20PST%202021%3B%20root%3Axnu-8019.61.5~1/RELEASE_X86_64/x86_64/21.2.0/steenrod/2022-08-16%2020%3A34%3A40&ticket=31892&base=9.7.beta8

It just shows the information about the changed files and new commits that you can get from git by comparing the base tree and the ticket tree. Not very useful.
