# Issue 34354: Multivariate polynomial variable substition has a bug

Issue created by migration from https://trac.sagemath.org/ticket/34591

Original creator: klee

Original creation time: 2022-09-27 14:00:55

CC:  vdelecroix lorenz




---

Comment by klee created at 2022-09-27 14:01:32

Changing component from PLEASE CHANGE to basic arithmetic.


---

Comment by klee created at 2022-09-27 14:01:32

Changing type from PLEASE CHANGE to defect.


---

Comment by klee created at 2022-09-27 14:10:32

This bug is related with these lines

```diff
diff --git a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
index 2109c516a1..35a011174a 100644
--- a/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
+++ b/src/sage/rings/polynomial/multi_polynomial_libsingular.pyx
@@ -3556,7 +3556,7 @@ cdef class MPolynomial_libsingular(MPolynomial):
 
                 if _p == NULL:
                     # polynomial becomes 0 after some substitution
-                    try_symbolic = 1
+                    try_symbolic = 1  # Why?
                     break
 
         cdef dict gd
```


At line 3557, the substituted polynomial becomes 0 correctly. But then it goes on "try_symbolic". Why?

These lines were introduced in #17785.


---

Comment by @DaveWitteMorris created at 2022-09-27 23:06:29

I think this is a duplicate of #34417.


---

Comment by klee created at 2022-09-27 23:17:12

Replying to [comment:6 Dave Morris]:
> I think this is a duplicate of #34417.

Yes. But as I analyzed the bug, there is no problem with Singular. So I suggest to close #34417 as a duplicate, and let us focus on fixing the problem in comment:3.


---

Comment by @DaveWitteMorris created at 2022-09-27 23:41:08

I don't know why you say there is no problem with singular. As pointed out in ticket:34417#comment:1, the problem seems to arise in `singular_polynomial_call`.  

I don't think the line in comment:3 is actually the bug (but I may be wrong). My understanding is that it is just setting a flag to say that something has gone wrong, so singular should be used to do the substitution. But it seems that singular gives the wrong answer (or the interface makes a mistake). It may be possible to solve this particular bug report by avoiding the call to singular, but it does seem to have uncovered a problem with singular (or its interface).


---

Comment by klee created at 2022-09-28 22:13:37

Replying to [comment:8 Dave Morris]:
> I don't know why you say there is no problem with singular. As pointed out in ticket:34417#comment:1, the problem seems to arise in `singular_polynomial_call`.  

You are right.

But there still seems to be a different issue with `.subs()`. I am investigating.


---

Comment by klee created at 2022-09-29 07:24:39

Changing priority from major to minor.


---

Comment by klee created at 2022-09-29 07:24:39

New commits:


---

Comment by klee created at 2022-09-29 07:24:39

Changing type from defect to enhancement.


---

Comment by klee created at 2022-09-29 07:43:32

Changing status from new to needs_review.
