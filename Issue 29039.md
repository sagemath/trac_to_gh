# Issue 29039: DiGraph constructor should be able to handle incidence matrix with all zero entries in column

Issue created by migration from https://trac.sagemath.org/ticket/29276

Original creator: @vipul79321

Original creation time: 2020-03-03 19:11:45

CC:  dcoudert

Currently DiGraph constructor works in following manner

```
sage: m=Matrix([[0,1],[0,-1],[0,0]])
sage: G = DiGraph(m,format='incidence_matrix')
Traceback (most recent call last)
...
ValueError: there must be two nonzero entries (-1 & 1) per column
```


It should be able to handle incidence matrix containing column with all zero entries by dropping that column and returning a Digraph which will be loop less version of that incidence matrix



---

Comment by @vipul79321 created at 2020-03-03 19:16:45

Changing status from new to needs_review.


---

Comment by @vipul79321 created at 2020-03-03 19:16:45

New commits:


---

Comment by dcoudert created at 2020-03-04 07:47:35

- the test should be `if not NZ:`

- add a `TESTS:` block like

```
TESTS:

Handle incidence matrix containing a column with only zeros (:trac:`29276`)::

    sage: m = Matrix([[0,1],[0,-1],[0,0]])
    sage: m
    [ 0  1]
    [ 0 -1]
    [ 0  0]
    sage: G = DiGraph(m,format='incidence_matrix')
    sage: list(G.edges(labels=False))
    [(1, 0)]
```



---

Comment by git created at 2020-03-04 08:36:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-03-04 08:37:05

Replying to [comment:2 dcoudert]:
> - the test should be `if not NZ:`
> 
> - add a `TESTS:` block like
> {{{
> TESTS:
> 
> Handle incidence matrix containing a column with only zeros (:trac:`29276`)::
> 
>     sage: m = Matrix([[0,1],[0,-1],[0,0]])
>     sage: m
>     [ 0  1]
>     [ 0 -1]
>     [ 0  0]
>     sage: G = DiGraph(m,format='incidence_matrix')
>     sage: list(G.edges(labels=False))
>     [(1, 0)]
> }}}
Done


---

Comment by dcoudert created at 2020-03-04 08:46:55

the changes done for #29275 also apply here to slightly speed up the code.


---

Comment by git created at 2020-03-04 09:17:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-03-04 09:19:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-03-04 09:30:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @vipul79321 created at 2020-03-04 09:31:40

Replying to [comment:5 dcoudert]:
> the changes done for #29275 also apply here to slightly speed up the code.
Done


---

Comment by dcoudert created at 2020-03-04 10:07:23

If I'm not mistaken, this ticket do exactly the same as #29275. If so, we can set this one as duplicate of #29275.

Don't forget to add your name in Authors field.


---

Comment by dcoudert created at 2020-03-04 16:54:02

all issues fixed in #29275.


---

Comment by dcoudert created at 2020-03-04 16:54:02

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-03-15 08:56:50

Resolution: duplicate
