# Issue 29821: refrehs the tachyon.py file

Issue created by migration from https://trac.sagemath.org/ticket/30058

Original creator: chapoton

Original creation time: 2020-07-03 20:22:33

CC:  tscrim mwageringel

mainly pep8 changes

also remove a "known bug" that is working

and some little code details, such as using iterators in .join


---

Comment by chapoton created at 2020-07-03 20:23:31

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-07-03 20:23:31

New commits:


---

Comment by git created at 2020-07-04 07:08:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-07-04 11:53:26

bot is morally green, please review


---

Comment by tscrim created at 2020-07-04 21:50:25

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2020-07-04 21:50:25

LGTM.


---

Comment by vbraun created at 2020-07-09 21:51:35

Merge conflict


---

Comment by vbraun created at 2020-07-09 21:51:35

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2020-07-09 23:41:06

Trivial rebase.
----
New commits:


---

Comment by tscrim created at 2020-07-09 23:41:06

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2020-07-11 23:24:23

Merge conflict


---

Comment by vbraun created at 2020-07-11 23:24:23

Changing status from positive_review to needs_work.


---

Comment by chapoton created at 2020-07-13 06:49:25

Trivial rebase. I am setting back to positive.
----
New commits:


---

Comment by chapoton created at 2020-07-13 06:49:25

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2020-07-23 22:35:45

On Debian 8 (32 + 64) this makes tachyon segfault:

```
File "src/sage/plot/plot3d/tachyon.py", line 751, in sage.plot.plot3d.tachyon.Tachyon.?
Failed example:
    show(t)
Expected nothing
Got:
    doctest:warning
      File "/home/buildbot/slave/sage_git/build/src/bin/sage-runtests", line 179, in <module>
        err = DC.run()
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/control.py", line 1230, in run
        self.run_doctests()
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/control.py", line 931, in run_doctests
        self.dispatcher.dispatch()
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2046, in dispatch
        self.parallel_dispatch()
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1941, in parallel_dispatch
        w.start()  # This might take some time
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2213, in start
        super(DocTestWorker, self).start()
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/multiprocessing/process.py", line 112, in start
        self._popen = self._Popen(self)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/multiprocessing/context.py", line 223, in _Popen
        return _default_context.get_context().Process._Popen(process_obj)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/multiprocessing/context.py", line 277, in _Popen
        return Popen(process_obj)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/multiprocessing/popen_fork.py", line 20, in __init__
        self._launch(process_obj)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/multiprocessing/popen_fork.py", line 74, in _launch
        code = process_obj._bootstrap()
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
        self.run()
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2185, in run
        task(self.options, self.outtmpfile, msgpipe, self.result_queue)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2514, in __call__
        doctests, extras = self._run(runner, options, results)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2561, in _run
        result = runner.run(test)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 913, in run
        return self._run(test, compileflags, out)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 715, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1139, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.plot.plot3d.tachyon.Tachyon.?[9]>", line 1, in <module>
        show(t)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/repl/rich_output/pretty_print.py", line 252, in show
        pretty_print(*args, **kwds)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/repl/rich_output/pretty_print.py", line 223, in pretty_print
        dm.display_immediately(*args, **kwds)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/repl/rich_output/display_manager.py", line 838, in display_immediately
        plain_text, rich_output = self._rich_output_formatter(obj, rich_repr_kwds)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/repl/rich_output/display_manager.py", line 626, in _rich_output_formatter
        rich_output = self._call_rich_repr(obj, rich_repr_kwds)
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/site-packages/sage/repl/rich_output/display_manager.py", line 593, in _call_rich_repr
        RichReprWarning,
      File "/home/buildbot/slave/sage_git/build/local/lib/python3.7/warnings.py", line 110, in _showwarnmsg
        msg.file, msg.line)
    :
    sage.repl.rich_output.display_manager.RichReprWarning: Exception in _rich_repr_ while displaying object: Command '['tachyon', '/home/buildbot/slave/sage_git/dot_sage/temp/sagebd08_64s02/1869/tmp_2lz6zbgs.dat', '-format', 'PNG', '-o', '/home/buildbot/slave/sage_git/dot_sage/temp/sagebd08_64s02/1869/tmp_b9ozbjwb.png']' died with <Signals.SIGSEGV: 11>.
    <html><script type="math/tex">\newcommand{\Bold}[1]{\mathbf{#1}}\verb|<sage.plot.plot3d.tachyon.Tachyon|\phantom{\verb!x!}\verb|object|\phantom{\verb!x!}\verb|at|\phantom{\verb!x!}\verb|0x7f39ebe2bda0>|</script></html>
**********************************************************************
1 item had failures:
   1 of  43 in sage.plot.plot3d.tachyon.Tachyon.?
    [396 tests, 1 failure, 7.43 s]
```



---

Comment by tscrim created at 2020-07-24 01:05:48

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2020-07-24 01:05:48

So it seems like #7232 was not actually fixed...


---

Comment by git created at 2020-08-19 07:37:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2020-08-19 07:38:46

I have just added back the "known bug" tag. I allow myself to set the ticket back to positive.


---

Comment by chapoton created at 2020-08-19 07:38:46

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2020-08-20 22:22:52

Resolution: fixed
