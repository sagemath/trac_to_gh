# Issue 16901: cythonized function in combinatorial designs must be interruptible

archive/issues_016664.json:
```json
{
    "body": "Right now, we can not interrupt `MOLS_table`... this is a consequence of the intensive cythonization.\n\n```\nsage: \nsage: from sage.combinat.designs.latin_squares import MOLS_table\nsage: MOLS_table(10000)\n       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19\n    ________________________________________________________________________________ \n  0| +oo +oo   1   2   3   4   1   6   7   8   2  10   5  12   4   4  15  16   5  18 \n 20|   4   5   3  22   7  24   4  26   5  28   4  30  31   5   4   5   8  36   4   5 \n 40|   7  40   5  42   5   6   4  46   8  48   6   5   5  52   5   6   7   7   5  58 \n^CException KeyboardInterrupt: KeyboardInterrupt() in 'sage.combinat.designs.orthogonal_arrays_find_recursive.is_available' ignored\n360|   7 360   6   7   7   7   6 366  15  15   7  15   7 372   7  15   7  13   7 378 \n380|   7  12   7 382  15  15   7  15   7 388   7  16   7   7   7   7   8 396   7   7 \n400|  15 400   7  15  11   8   7  15   8 408   7  13   8  12  10   9  18  15   7 418 \n^CException KeyboardInterrupt: KeyboardInterrupt() in 'sage.combinat.designs.orthogonal_arrays_find_recursive.is_available' ignored\n...\n```\n\nWe need more `sig_on()`, `sig_off()`.\n\nCC:  @nathanncohen\n\nBranch/Commit: 6097260461d3d20653d3406db362b4e9c9a8b40c\n\nReviewer: Nathann Cohen\n\nAuthor: Vincent Delecroix\n\nDependencies: #16879\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16901\n\n",
    "closed_at": "2014-09-08T08:48:47Z",
    "created_at": "2014-08-29T09:31:24Z",
    "labels": [
        "component: combinatorial designs",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "cythonized function in combinatorial designs must be interruptible",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16901",
    "user": "https://github.com/videlec"
}
```
Right now, we can not interrupt `MOLS_table`... this is a consequence of the intensive cythonization.

```
sage: 
sage: from sage.combinat.designs.latin_squares import MOLS_table
sage: MOLS_table(10000)
       0   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  19
    ________________________________________________________________________________ 
  0| +oo +oo   1   2   3   4   1   6   7   8   2  10   5  12   4   4  15  16   5  18 
 20|   4   5   3  22   7  24   4  26   5  28   4  30  31   5   4   5   8  36   4   5 
 40|   7  40   5  42   5   6   4  46   8  48   6   5   5  52   5   6   7   7   5  58 
^CException KeyboardInterrupt: KeyboardInterrupt() in 'sage.combinat.designs.orthogonal_arrays_find_recursive.is_available' ignored
360|   7 360   6   7   7   7   6 366  15  15   7  15   7 372   7  15   7  13   7 378 
380|   7  12   7 382  15  15   7  15   7 388   7  16   7   7   7   7   8 396   7   7 
400|  15 400   7  15  11   8   7  15   8 408   7  13   8  12  10   9  18  15   7 418 
^CException KeyboardInterrupt: KeyboardInterrupt() in 'sage.combinat.designs.orthogonal_arrays_find_recursive.is_available' ignored
...
```

We need more `sig_on()`, `sig_off()`.

CC:  @nathanncohen

Branch/Commit: 6097260461d3d20653d3406db362b4e9c9a8b40c

Reviewer: Nathann Cohen

Author: Vincent Delecroix

Dependencies: #16879

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16901





---

archive/issue_comments_283083.json:
```json
{
    "body": "Changing commit from \"\" to \"00f4fdb067d61ec76b87efb0f250a4937bda9046\"",
    "created_at": "2014-08-29T09:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283083",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "00f4fdb067d61ec76b87efb0f250a4937bda9046"



---

archive/issue_comments_283084.json:
```json
{
    "body": "<a id='comment:1'></a>It is better with the branch applied as it becomes interruptible. Nevertheless it is not ideal since it may happen that after an interruption you are not able to call `MOLS_table` anymore... got strange error like\n\n```\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-3880577162c6> in <module>()\n----> 1 MOLS_table(Integer(10000))\n\n/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/latin_squares.pyc in MOLS_table(number_of_lines, compare)\n    513         if i%20==0:\n    514             print \"\\n%3d|\"%i,\n--> 515         k = mutually_orthogonal_latin_squares(None,i,existence=True)\n    516         if compare:\n    517             if i < 2 or hb[i] == k:\n\n/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/latin_squares.pyc in mutually_orthogonal_latin_squares(k, n, partitions, check, existence)\n    359             raise ValueError(\"there are no bound on k when 0<=n<=1\")\n    360 \n--> 361         k = orthogonal_array(None,n,existence=True) - 2\n    362         if existence:\n    363             return k\n\n/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays.pyc in orthogonal_array(k, n, t, resolvable, check, existence)\n    811         else:\n    812             for k in range(t-1,n+2):\n--> 813                 if not orthogonal_array(k+1,n,t=t,existence=True):\n    814                     break\n    815         if existence:\n\n/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays.pyc in orthogonal_array(k, n, t, resolvable, check, existence)\n    909         OA = OA_from_quasi_difference_matrix(M,G,add_col=True)\n    910 \n--> 911     elif may_be_available and find_recursive_construction(k,n):\n    912         _OA_cache_set(k,n,True)\n    913         if existence:\n\n/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/misc/cachefunc.so in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:4678)()\n\n/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays_find_recursive.so in sage.combinat.designs.orthogonal_arrays_find_recursive.find_recursive_construction (build/cythonized/sage/combinat/designs/orthogonal_arrays_find_recursive.c:2565)()\n\nTypeError: function takes exactly 3 arguments (2 given)\n```\n\nVincent\n\n---\nLast 10 new commits:",
    "created_at": "2014-08-29T09:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283084",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'></a>It is better with the branch applied as it becomes interruptible. Nevertheless it is not ideal since it may happen that after an interruption you are not able to call `MOLS_table` anymore... got strange error like

```
TypeError                                 Traceback (most recent call last)
<ipython-input-4-3880577162c6> in <module>()
----> 1 MOLS_table(Integer(10000))

/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/latin_squares.pyc in MOLS_table(number_of_lines, compare)
    513         if i%20==0:
    514             print "\n%3d|"%i,
--> 515         k = mutually_orthogonal_latin_squares(None,i,existence=True)
    516         if compare:
    517             if i < 2 or hb[i] == k:

/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/latin_squares.pyc in mutually_orthogonal_latin_squares(k, n, partitions, check, existence)
    359             raise ValueError("there are no bound on k when 0<=n<=1")
    360 
--> 361         k = orthogonal_array(None,n,existence=True) - 2
    362         if existence:
    363             return k

/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays.pyc in orthogonal_array(k, n, t, resolvable, check, existence)
    811         else:
    812             for k in range(t-1,n+2):
--> 813                 if not orthogonal_array(k+1,n,t=t,existence=True):
    814                     break
    815         if existence:

/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays.pyc in orthogonal_array(k, n, t, resolvable, check, existence)
    909         OA = OA_from_quasi_difference_matrix(M,G,add_col=True)
    910 
--> 911     elif may_be_available and find_recursive_construction(k,n):
    912         _OA_cache_set(k,n,True)
    913         if existence:

/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/misc/cachefunc.so in sage.misc.cachefunc.CachedFunction.__call__ (build/cythonized/sage/misc/cachefunc.c:4678)()

/opt/sage_flatsurf/local/lib/python2.7/site-packages/sage/combinat/designs/orthogonal_arrays_find_recursive.so in sage.combinat.designs.orthogonal_arrays_find_recursive.find_recursive_construction (build/cythonized/sage/combinat/designs/orthogonal_arrays_find_recursive.c:2565)()

TypeError: function takes exactly 3 arguments (2 given)
```

Vincent

---
Last 10 new commits:



---

archive/issue_comments_283085.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/16901\"",
    "created_at": "2014-08-29T09:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283085",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/16901"



---

archive/issue_comments_283086.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#16879\"",
    "created_at": "2014-08-29T09:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283086",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "" to "#16879"



---

archive/issue_comments_283087.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-29T11:14:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283087",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_283088.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nathann Cohen\"",
    "created_at": "2014-08-29T11:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283088",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Nathann Cohen"



---

archive/issue_comments_283089.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-29T11:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283089",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_283090.json:
```json
{
    "body": "<a id='comment:4'></a>Yo !\n\nSeems to do the job, thanks !\n\n```\n-        return orthogonal_array(k,n,existence=True)\n+        ans = orthogonal_array(k,n,existence=True)\n+        return ans\n```\n\nIs `return orthogonal_array(k,n,existence=True)` declared politically incorrect now ? `:-P`\n\nNathann\n\nP.S. : the commit's ticket contains the wrong number but we probably won't base anything on this branch so it is not a problem.",
    "created_at": "2014-08-29T11:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283090",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>Yo !

Seems to do the job, thanks !

```
-        return orthogonal_array(k,n,existence=True)
+        ans = orthogonal_array(k,n,existence=True)
+        return ans
```

Is `return orthogonal_array(k,n,existence=True)` declared politically incorrect now ? `:-P`

Nathann

P.S. : the commit's ticket contains the wrong number but we probably won't base anything on this branch so it is not a problem.



---

archive/issue_comments_283091.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-08-29T11:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283091",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_283092.json:
```json
{
    "body": "<a id='comment:5'></a>The messages in the ticket description\n\n```\n^CException KeyboardInterrupt: KeyboardInterrupt() in 'sage.combinat.designs.orthogonal_arrays_find_recursive.is_available' ignored\n```\nshow that the issue is not just `sig_on()`/`sig_off()` but also missing `except` clauses in `cdef` functions, see also #16233 for how to fix this.\n\nAlso, your codes mixes Cython and Python, so I would go with [sig_check()](http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-check) in the inner loops which is much safer than `sig_on()` and `sig_off()`.",
    "created_at": "2014-08-29T11:43:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283092",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>The messages in the ticket description

```
^CException KeyboardInterrupt: KeyboardInterrupt() in 'sage.combinat.designs.orthogonal_arrays_find_recursive.is_available' ignored
```
show that the issue is not just `sig_on()`/`sig_off()` but also missing `except` clauses in `cdef` functions, see also #16233 for how to fix this.

Also, your codes mixes Cython and Python, so I would go with [sig_check()](http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-check) in the inner loops which is much safer than `sig_on()` and `sig_off()`.



---

archive/issue_comments_283093.json:
```json
{
    "body": "<a id='comment:6'></a>Perhaps the warning at [http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off](http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off) is not clear enough, but really **the code inside sig_on() should be pure C or Cython code**.",
    "created_at": "2014-08-29T11:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283093",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:6'></a>Perhaps the warning at [http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off](http://www.sagemath.org/doc/developer/coding_in_cython.html#using-sig-on-and-sig-off) is not clear enough, but really **the code inside sig_on() should be pure C or Cython code**.



---

archive/issue_comments_283094.json:
```json
{
    "body": "<a id='comment:7'></a>This ticket inspired me to create #16902.",
    "created_at": "2014-08-29T11:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283094",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>This ticket inspired me to create #16902.



---

archive/issue_comments_283095.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [jdemeyer](#comment%3A7):\n> This ticket inspired me to create #16902.\n\n\nThanks, I am carefully reading it!\n\nBy the way, I got something very strange here. `find_recursive_construction` is a cached function (with the decorator in `sage.misc.cachefunc`). It appears that after some of the interruption, the `CachedFunction` class suddenly decided that the function now takes 3 arguments instead of 2... and trying to call it with 3 values instead of 2 I just got an unhandled  SIGSEGV.\n\nMight be something subtle going on with exception and cache but I do not know why. I can describe the case in more details.\n\nVincent",
    "created_at": "2014-08-29T16:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283095",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>Replying to [jdemeyer](#comment%3A7):
> This ticket inspired me to create #16902.


Thanks, I am carefully reading it!

By the way, I got something very strange here. `find_recursive_construction` is a cached function (with the decorator in `sage.misc.cachefunc`). It appears that after some of the interruption, the `CachedFunction` class suddenly decided that the function now takes 3 arguments instead of 2... and trying to call it with 3 values instead of 2 I just got an unhandled  SIGSEGV.

Might be something subtle going on with exception and cache but I do not know why. I can describe the case in more details.

Vincent



---

archive/issue_comments_283096.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [vdelecroix](#comment%3A8):\n> By the way, I got something very strange here. `find_recursive_construction` is a cached function (with the decorator in `sage.misc.cachefunc`). It appears that after some of the interruption, the `CachedFunction` class suddenly decided that the function now takes 3 arguments instead of 2... and trying to call it with 3 values instead of 2 I just got an unhandled  SIGSEGV.\n> \n> Might be something subtle going on with exception and cache but I do not know why. I can describe the case in more details.\n\nPersonally, I would not bother too much with this. Interrupting Python (as opposed to Cython) code can give all kinds of undefined behaviour...",
    "created_at": "2014-08-29T16:57:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283096",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>Replying to [vdelecroix](#comment%3A8):
> By the way, I got something very strange here. `find_recursive_construction` is a cached function (with the decorator in `sage.misc.cachefunc`). It appears that after some of the interruption, the `CachedFunction` class suddenly decided that the function now takes 3 arguments instead of 2... and trying to call it with 3 values instead of 2 I just got an unhandled  SIGSEGV.
> 
> Might be something subtle going on with exception and cache but I do not know why. I can describe the case in more details.

Personally, I would not bother too much with this. Interrupting Python (as opposed to Cython) code can give all kinds of undefined behaviour...



---

archive/issue_comments_283097.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-08-29T17:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283097",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_283098.json:
```json
{
    "body": "Changing commit from \"00f4fdb067d61ec76b87efb0f250a4937bda9046\" to \"a54ef1458ec570aa3680507aa25963c0e8471468\"",
    "created_at": "2014-08-29T17:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283098",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "00f4fdb067d61ec76b87efb0f250a4937bda9046" to "a54ef1458ec570aa3680507aa25963c0e8471468"



---

archive/issue_comments_283099.json:
```json
{
    "body": "Changing commit from \"a54ef1458ec570aa3680507aa25963c0e8471468\" to \"4917f8563795f8976910c7d798ae7909b3a0396d\"",
    "created_at": "2014-08-29T17:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283099",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a54ef1458ec570aa3680507aa25963c0e8471468" to "4917f8563795f8976910c7d798ae7909b3a0396d"



---

archive/issue_comments_283100.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-08-29T17:06:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283100",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_283101.json:
```json
{
    "body": "<a id='comment:12'></a>All right, very simple one line change which makes us loose only 0.02 secs for the generation of the 1800 first MOLS.\n\nVincent",
    "created_at": "2014-08-29T17:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283101",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>All right, very simple one line change which makes us loose only 0.02 secs for the generation of the 1800 first MOLS.

Vincent



---

archive/issue_comments_283102.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-29T17:07:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283102",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_283103.json:
```json
{
    "body": "<a id='comment:13'></a>Okayyyyyyyy.. This being said, why did you change the bint to int ?\n\nNathann",
    "created_at": "2014-08-29T17:11:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283103",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:13'></a>Okayyyyyyyy.. This being said, why did you change the bint to int ?

Nathann



---

archive/issue_comments_283104.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [ncohen](#comment%3A13):\n> Okayyyyyyyy.. This being said, why did you change the bint to int ?\n\n\nThe exception is propagated with the return value `-1`, I think it is cleaner to make it an int.\n\nAnyway, the choice `int/bint` is just a compiler instruction for Cython. There is no gain of having it a `bint` type here since it is always used in C code. The purpose of the bint type is to mix well Python booleans with C ints. One difference (that I learn few seconds ago) is in\n\n```\ndef f(b):\n   int x = b\n   bint y = b\n```\nThe first conversion will involves `b.__int__` while the second `b.__nonzero__`.\n\nVincent",
    "created_at": "2014-08-29T17:26:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283104",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>Replying to [ncohen](#comment%3A13):
> Okayyyyyyyy.. This being said, why did you change the bint to int ?


The exception is propagated with the return value `-1`, I think it is cleaner to make it an int.

Anyway, the choice `int/bint` is just a compiler instruction for Cython. There is no gain of having it a `bint` type here since it is always used in C code. The purpose of the bint type is to mix well Python booleans with C ints. One difference (that I learn few seconds ago) is in

```
def f(b):
   int x = b
   bint y = b
```
The first conversion will involves `b.__int__` while the second `b.__nonzero__`.

Vincent



---

archive/issue_comments_283105.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-29T17:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283105",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_283106.json:
```json
{
    "body": "<a id='comment:15'></a>Yo !\n\n> The exception is propagated with the return value `-1`, I think it is cleaner to make it an int.\n\n\nOh right, right.\n\n> Anyway, the choice `int/bint` is just a compiler instruction for Cython. There is no gain of having it a `bint` type here since it is always used in C code.\n\n\nOf course, but there if there is no reason to change that into an 'int' it was better to keep it. And that's a good reason to change it. Good to go !\n\n> The purpose of the bint type is to mix well Python booleans with C ints. One difference (that I learn few seconds ago) is in\n> \n> ```\n> def f(b):\n>    int x = b\n>    bint y = b\n> ```\n> The first conversion will involves `b.__int__` while the second `b.__nonzero__`.\n\n\nI hate Python.\n\nNathann",
    "created_at": "2014-08-29T17:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283106",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>Yo !

> The exception is propagated with the return value `-1`, I think it is cleaner to make it an int.


Oh right, right.

> Anyway, the choice `int/bint` is just a compiler instruction for Cython. There is no gain of having it a `bint` type here since it is always used in C code.


Of course, but there if there is no reason to change that into an 'int' it was better to keep it. And that's a good reason to change it. Good to go !

> The purpose of the bint type is to mix well Python booleans with C ints. One difference (that I learn few seconds ago) is in
> 
> ```
> def f(b):
>    int x = b
>    bint y = b
> ```
> The first conversion will involves `b.__int__` while the second `b.__nonzero__`.


I hate Python.

Nathann



---

archive/issue_comments_283107.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [ncohen](#comment%3A15):\n> > The purpose of the bint type is to mix well Python booleans with C ints. One difference (that I learn few seconds ago) is in\n> > \n> > ```\n> > def f(b):\n> >    int x = b\n> >    bint y = b\n> > ```\n> > The first conversion will involves `b.__int__` while the second `b.__nonzero__`.\n\n> \n> I hate Python.\n\n\nLet me see. You want strongly typed, checked at compilation code... hum, use Haskell!\n\nVincent",
    "created_at": "2014-08-29T17:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283107",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>Replying to [ncohen](#comment%3A15):
> > The purpose of the bint type is to mix well Python booleans with C ints. One difference (that I learn few seconds ago) is in
> > 
> > ```
> > def f(b):
> >    int x = b
> >    bint y = b
> > ```
> > The first conversion will involves `b.__int__` while the second `b.__nonzero__`.

> 
> I hate Python.


Let me see. You want strongly typed, checked at compilation code... hum, use Haskell!

Vincent



---

archive/issue_comments_283108.json:
```json
{
    "body": "<a id='comment:17'></a>Why is everybody trying to use logic to prove that I must like this or that thing ?\n\nI hate Python AND I hate Haskell. Though I never used Haskell, of course.\n\nNathann",
    "created_at": "2014-08-29T20:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283108",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>Why is everybody trying to use logic to prove that I must like this or that thing ?

I hate Python AND I hate Haskell. Though I never used Haskell, of course.

Nathann



---

archive/issue_comments_283109.json:
```json
{
    "body": "<a id='comment:18'></a>Doesn't work. Also, use bint for what would be a boolean in Python and int for integers. E.g. simplifies debugging if you can just switch the method to cpdef and you get a Python boolean instead of some integer.\n\n```\nsage -t --long --warn-long 43.5 src/sage/combinat/designs/orthogonal_arrays_find_recursive.pyx  # 13 doctests failed\nsage -t --long --warn-long 43.5 src/sage/combinat/designs/orthogonal_arrays_build_recursive.py  # 3 doctests failed\nsage -t --long --warn-long 43.5 src/sage/combinat/designs/orthogonal_arrays.py  # 11 doctests failed\n```",
    "created_at": "2014-09-05T17:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283109",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>Doesn't work. Also, use bint for what would be a boolean in Python and int for integers. E.g. simplifies debugging if you can just switch the method to cpdef and you get a Python boolean instead of some integer.

```
sage -t --long --warn-long 43.5 src/sage/combinat/designs/orthogonal_arrays_find_recursive.pyx  # 13 doctests failed
sage -t --long --warn-long 43.5 src/sage/combinat/designs/orthogonal_arrays_build_recursive.py  # 3 doctests failed
sage -t --long --warn-long 43.5 src/sage/combinat/designs/orthogonal_arrays.py  # 11 doctests failed
```



---

archive/issue_comments_283110.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-09-05T17:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283110",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_283111.json:
```json
{
    "body": "Changing commit from \"4917f8563795f8976910c7d798ae7909b3a0396d\" to \"e5343b297f02c90ad2100e9563b8fc9d372d6b3a\"",
    "created_at": "2014-09-05T19:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283111",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4917f8563795f8976910c7d798ae7909b3a0396d" to "e5343b297f02c90ad2100e9563b8fc9d372d6b3a"



---

archive/issue_comments_283112.json:
```json
{
    "body": "<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-05T19:26:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283112",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_283113.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-05T19:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283113",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_283114.json:
```json
{
    "body": "<a id='comment:21'></a>Hum.. I wonder what happened!\n\nVincent",
    "created_at": "2014-09-05T19:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283114",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>Hum.. I wonder what happened!

Vincent



---

archive/issue_comments_283115.json:
```json
{
    "body": "<a id='comment:22'></a>I don't get what you did in your latest commit: you change the first \"return\" to give a boolean, yet in the second one you change a 'True' into a '1' `O_o`\n\nNathann",
    "created_at": "2014-09-06T07:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283115",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>I don't get what you did in your latest commit: you change the first "return" to give a boolean, yet in the second one you change a 'True' into a '1' `O_o`

Nathann



---

archive/issue_comments_283116.json:
```json
{
    "body": "<a id='comment:23'></a>The function is returned an `int`. So anyway Cython will convert `True` to 1. If you prefer `1 -> True` and `0 -> False` fell free to do it.\n\nVincent",
    "created_at": "2014-09-06T07:44:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283116",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>The function is returned an `int`. So anyway Cython will convert `True` to 1. If you prefer `1 -> True` and `0 -> False` fell free to do it.

Vincent



---

archive/issue_comments_283117.json:
```json
{
    "body": "<a id='comment:24'></a>Why did you change it in the first place ? `O_o`",
    "created_at": "2014-09-06T07:45:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283117",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:24'></a>Why did you change it in the first place ? `O_o`



---

archive/issue_comments_283118.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [ncohen](#comment%3A24):\n> Why did you change it in the first place ? `O_o`\n\n\nTo make cython happier ;=)",
    "created_at": "2014-09-06T07:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283118",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>Replying to [ncohen](#comment%3A24):
> Why did you change it in the first place ? `O_o`


To make cython happier ;=)



---

archive/issue_comments_283119.json:
```json
{
    "body": "<a id='comment:26'></a>With different types of output ? `O_o`\n\nNathann",
    "created_at": "2014-09-06T07:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283119",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:26'></a>With different types of output ? `O_o`

Nathann



---

archive/issue_comments_283120.json:
```json
{
    "body": "Changing commit from \"e5343b297f02c90ad2100e9563b8fc9d372d6b3a\" to \"6097260461d3d20653d3406db362b4e9c9a8b40c\"",
    "created_at": "2014-09-06T08:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283120",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e5343b297f02c90ad2100e9563b8fc9d372d6b3a" to "6097260461d3d20653d3406db362b4e9c9a8b40c"



---

archive/issue_comments_283121.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-09-06T08:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283121",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_283122.json:
```json
{
    "body": "<a id='comment:28'></a>done.\n\nVincent",
    "created_at": "2014-09-06T08:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283122",
    "user": "https://github.com/videlec"
}
```

<a id='comment:28'></a>done.

Vincent



---

archive/issue_comments_283123.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-06T15:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283123",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049372.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-08T08:48:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16901#event-49372"
}
```



---

archive/issue_comments_283124.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-08T08:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283124",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_283125.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/16901\" to \"6097260461d3d20653d3406db362b4e9c9a8b40c\"",
    "created_at": "2014-09-08T08:48:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16901#issuecomment-283125",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/16901" to "6097260461d3d20653d3406db362b4e9c9a8b40c"
