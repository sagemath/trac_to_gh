# Issue 16577: Make matrix.permute_rows and friends accept permutations of 0..n-1 now that we have them + misc improvements

archive/issues_016340.json:
```json
{
    "body": "Permutation groups used to only handle permutations of `1,..n`, and the methods permute_rows and friends of matrices coped with this with an ugly and potentially confusing shift by 1. After this ticket, permutation of `0,...,n-1` are accepted and handled as can be expected. For permutations of `1..n` and subsets the behavior is unchanged for backward compatibility.\n\nThis ticket also includes the following changes:\n- A rewrite of the documentation\n- New documentation on a related method\n- Code refactorization to avoid some duplication\n- The implementation of M.permute_rows_and_columns(sigma)\n\n\nCC:  @rbeezer\n\nReviewer: Karl-Dieter Crisman\n\nAuthor: Nicolas M. Thi\u00e9ry\n\nBranch: u/nthiery/make_matrix_permute_rows_and_friends_accept_permutations_of_0__n_1_now_that_we_have_them___misc_improvements\n\nCommit: 34081e2c31b3b9e015adc48f74c24ed932c1a242\n\nIssue created by migration from https://trac.sagemath.org/ticket/16577\n\n",
    "created_at": "2014-06-28T00:46:36Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Make matrix.permute_rows and friends accept permutations of 0..n-1 now that we have them + misc improvements",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16577",
    "user": "https://github.com/nthiery"
}
```
Permutation groups used to only handle permutations of `1,..n`, and the methods permute_rows and friends of matrices coped with this with an ugly and potentially confusing shift by 1. After this ticket, permutation of `0,...,n-1` are accepted and handled as can be expected. For permutations of `1..n` and subsets the behavior is unchanged for backward compatibility.

This ticket also includes the following changes:
- A rewrite of the documentation
- New documentation on a related method
- Code refactorization to avoid some duplication
- The implementation of M.permute_rows_and_columns(sigma)


CC:  @rbeezer

Reviewer: Karl-Dieter Crisman

Author: Nicolas M. Thi√©ry

Branch: u/nthiery/make_matrix_permute_rows_and_friends_accept_permutations_of_0__n_1_now_that_we_have_them___misc_improvements

Commit: 34081e2c31b3b9e015adc48f74c24ed932c1a242

Issue created by migration from https://trac.sagemath.org/ticket/16577





---

archive/issue_comments_214006.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-06-28T01:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214006",
    "user": "https://github.com/nthiery"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_214007.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to linear algebra.",
    "created_at": "2014-06-28T01:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214007",
    "user": "https://github.com/nthiery"
}
```

Changing component from PLEASE CHANGE to linear algebra.



---

archive/issue_comments_214008.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2014-06-28T01:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214008",
    "user": "https://github.com/nthiery"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_214009.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2014-06-28T01:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214009",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_events_048650.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16577#event-48650"
}
```



---

archive/issue_comments_214010.json:
```json
{
    "body": "<a id='comment:4'></a>* As we discussed in person, there may be a few missing colons.\n* Why gone?\n\n```\n-            sage: sigma\n-            (1,2,3)(4,5)\n```\n  I mean, it will be different, but this is helpful to the user to learn how it works.  Right now it's only in the warning which of course some people will ignore ... because it's a warning.  Actually, it looks like you only do that once.\n* I think this will probably break.\n\n```\nsage: G = PermutationGroup(['(1,2,3)', '(-1,0,1,2,3)'])\n```\n  GAP doesn't complain when I ask for this group's order!\n* Also, probably there is no point to SEEALSO the actual function in each case.  E.g. `permute_columns` should not SEEALSO itself.\n* `swap_columns_c` test, if it's new, should probably be in the wrapper `swap_columns`.\n\nBut actually this looks pretty good and straightforward.",
    "created_at": "2014-08-15T11:54:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214010",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>* As we discussed in person, there may be a few missing colons.
* Why gone?

```
-            sage: sigma
-            (1,2,3)(4,5)
```
  I mean, it will be different, but this is helpful to the user to learn how it works.  Right now it's only in the warning which of course some people will ignore ... because it's a warning.  Actually, it looks like you only do that once.
* I think this will probably break.

```
sage: G = PermutationGroup(['(1,2,3)', '(-1,0,1,2,3)'])
```
  GAP doesn't complain when I ask for this group's order!
* Also, probably there is no point to SEEALSO the actual function in each case.  E.g. `permute_columns` should not SEEALSO itself.
* `swap_columns_c` test, if it's new, should probably be in the wrapper `swap_columns`.

But actually this looks pretty good and straightforward.



---

archive/issue_comments_214011.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-15T11:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214011",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214012.json:
```json
{
    "body": "<a id='comment:6'></a>The missing colons are in the warning sections.  Also, you don't have a warning in the `with` methods though they have examples of that.",
    "created_at": "2014-08-15T11:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214012",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>The missing colons are in the warning sections.  Also, you don't have a warning in the `with` methods though they have examples of that.



---

archive/issue_comments_214013.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-15T12:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214013",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214014.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:4 kcrisman]:\n> * Why gone?\n> \n> ```\n> -            sage: sigma\n> -            (1,2,3)(4,5)\n> ```\n\n\nOops, right; fixed, and made consistent over all tests.\n\n> * I think this will probably break.\n> \n> ```\n> sage: G = PermutationGroup(['(1,2,3)', '(-1,0,1,2,3)'])\n> ```\n>   GAP doesn't complain when I ask for this group's order!\n\n\nThe sanity checks are not changed by ticket, and it keeps on failing\ncleanly as before.\n\n> * Also, probably there is no point to SEEALSO the actual function in each case.  E.g. `permute_columns` should not SEEALSO itself.\n> * `swap_columns_c` test, if it's new, should probably be in the wrapper `swap_columns`.\n\n\nOops, right!",
    "created_at": "2014-08-15T12:30:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214014",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:8'></a>Replying to [comment:4 kcrisman]:
> * Why gone?
> 
> ```
> -            sage: sigma
> -            (1,2,3)(4,5)
> ```


Oops, right; fixed, and made consistent over all tests.

> * I think this will probably break.
> 
> ```
> sage: G = PermutationGroup(['(1,2,3)', '(-1,0,1,2,3)'])
> ```
>   GAP doesn't complain when I ask for this group's order!


The sanity checks are not changed by ticket, and it keeps on failing
cleanly as before.

> * Also, probably there is no point to SEEALSO the actual function in each case.  E.g. `permute_columns` should not SEEALSO itself.
> * `swap_columns_c` test, if it's new, should probably be in the wrapper `swap_columns`.


Oops, right!



---

archive/issue_comments_214015.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-15T12:41:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214015",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214016.json:
```json
{
    "body": "<a id='comment:10'></a>Hi Karl!\n\nJust a ping for finishing the review of the hopefully final commit?\n\nThanks!",
    "created_at": "2014-08-22T12:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214016",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:10'></a>Hi Karl!

Just a ping for finishing the review of the hopefully final commit?

Thanks!



---

archive/issue_comments_214017.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-22T12:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214017",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214018.json:
```json
{
    "body": "<a id='comment:11'></a>I should almost make you wait longer just for the length of your branch name!\n\nYou need to change `\\hdots` to `\\ldots` for it to work properly in the documentation.  Otherwise this is fine.\n\nOf course, there is the meta-question of whether one should really change this behavior.  Have you talked to anyone else about that?  It is indeed backward-compatible but still one might ask whether matrix rows are numbered at 0 or 1... though with Python probably the previous behavior was more wrong than the current one...",
    "created_at": "2014-08-22T19:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214018",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>I should almost make you wait longer just for the length of your branch name!

You need to change `\hdots` to `\ldots` for it to work properly in the documentation.  Otherwise this is fine.

Of course, there is the meta-question of whether one should really change this behavior.  Have you talked to anyone else about that?  It is indeed backward-compatible but still one might ask whether matrix rows are numbered at 0 or 1... though with Python probably the previous behavior was more wrong than the current one...



---

archive/issue_comments_214019.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-27T18:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214019",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214020.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-29T03:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214020",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214021.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:11 kcrisman]:\n> I should almost make you wait longer just for the length of your branch name!\n\n\n:-)\n\nMost of the name was built by git trac from the summary; I'd been too lazy to type this in myself :-)\n\n> You need to change `\\hdots` to `\\ldots` for it to work properly in the documentation.  Otherwise this is fine.\n\n\nDone.\n\n> Of course, there is the meta-question of whether one should really\n> change this behavior.  Have you talked to anyone else about that?\n> It is indeed backward-compatible but still one might ask whether\n> matrix rows are numbered at 0 or 1... though with Python probably\n> the previous behavior was more wrong than the current one...\n\n\nSage matrices/vectors/... (under the influence of Python) are\nunambiguously indexed by 0..n-1, aren't they? After all that's the\nconvention used systematically in all other methods (row, set_row,\ncol, __getitem__, ...).\n\nIn this sense, permute_rows and friends were the exceptions. That's\nwhy I did not bother yet advertising this ticket specifically (beside\nyou, Anne, and whoever is following it). We could make a call on\nsage-devel if you think this is really needed.\n\nCheers,\n                                    Nicolas",
    "created_at": "2014-08-29T03:26:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214021",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:14'></a>Replying to [comment:11 kcrisman]:
> I should almost make you wait longer just for the length of your branch name!


:-)

Most of the name was built by git trac from the summary; I'd been too lazy to type this in myself :-)

> You need to change `\hdots` to `\ldots` for it to work properly in the documentation.  Otherwise this is fine.


Done.

> Of course, there is the meta-question of whether one should really
> change this behavior.  Have you talked to anyone else about that?
> It is indeed backward-compatible but still one might ask whether
> matrix rows are numbered at 0 or 1... though with Python probably
> the previous behavior was more wrong than the current one...


Sage matrices/vectors/... (under the influence of Python) are
unambiguously indexed by 0..n-1, aren't they? After all that's the
convention used systematically in all other methods (row, set_row,
col, __getitem__, ...).

In this sense, permute_rows and friends were the exceptions. That's
why I did not bother yet advertising this ticket specifically (beside
you, Anne, and whoever is following it). We could make a call on
sage-devel if you think this is really needed.

Cheers,
                                    Nicolas



---

archive/issue_comments_214022.json:
```json
{
    "body": "<a id='comment:15'></a>> > You need to change `\\hdots` to `\\ldots` for it to work properly in the documentation.  Otherwise this is fine.\n\n> \n> Done.\n\n\nBut perhaps not pushed?  It's not in your commit list.\n\n> In this sense, permute_rows and friends were the exceptions. That's\n> why I did not bother yet advertising this ticket specifically (beside\n> you, Anne, and whoever is following it). We could make a call on\n> sage-devel if you think this is really needed.\n\n\n\nYou know, I'd feel better if you just put a little blurb there saying, \"we want to make this change because it seemed more in line with 0-based counting, but in case anyone cares say something on the ticket.\"  If we don't hear back, switch it to positive review.",
    "created_at": "2014-08-29T11:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214022",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>> > You need to change `\hdots` to `\ldots` for it to work properly in the documentation.  Otherwise this is fine.

> 
> Done.


But perhaps not pushed?  It's not in your commit list.

> In this sense, permute_rows and friends were the exceptions. That's
> why I did not bother yet advertising this ticket specifically (beside
> you, Anne, and whoever is following it). We could make a call on
> sage-devel if you think this is really needed.



You know, I'd feel better if you just put a little blurb there saying, "we want to make this change because it seemed more in line with 0-based counting, but in case anyone cares say something on the ticket."  If we don't hear back, switch it to positive review.



---

archive/issue_comments_214023.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-29T13:25:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214023",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214024.json:
```json
{
    "body": "<a id='comment:17'></a>Oops, sorry, I had actually pushed from the wrong copy of Sage. Fixed!",
    "created_at": "2014-08-29T13:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214024",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:17'></a>Oops, sorry, I had actually pushed from the wrong copy of Sage. Fixed!



---

archive/issue_comments_214025.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-09-08T15:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214025",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_214026.json:
```json
{
    "body": "<a id='comment:18'></a>Just for reference: turns out there was [quite a discussion](https://groups.google.com/forum/#!topic/sage-devel/r38j4epfogs) on 0-based permutations and some probably poor design decisions early in Sage's life (i.e. `Permutation([1,2,3])` and `Permutation((1,2,3))` not being the same thing, where probably the latter should have been required to be `Permutation([(1,2,3)])` so the cycle notation didn't get confused with other notation.  Anyway, for now I'm putting this on \"needs info\" since I didn't see a lot of consensus on sage-devel.",
    "created_at": "2014-09-08T15:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16577",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16577#issuecomment-214026",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>Just for reference: turns out there was [quite a discussion](https://groups.google.com/forum/#!topic/sage-devel/r38j4epfogs) on 0-based permutations and some probably poor design decisions early in Sage's life (i.e. `Permutation([1,2,3])` and `Permutation((1,2,3))` not being the same thing, where probably the latter should have been required to be `Permutation([(1,2,3)])` so the cycle notation didn't get confused with other notation.  Anyway, for now I'm putting this on "needs info" since I didn't see a lot of consensus on sage-devel.
