# Issue 16846: a difference_matrices module

archive/issues_016609.json:
```json
{
    "body": "This commit creates a `difference_matrices` module which does not do much at the moment: it can creates DM for prime powers, and return DM from the database.\n\nIn the database, however, a lot changes as many OA were actually difference matrices. The constructors are turned into difference matrices constructors, and `orthogonal_array` now calls `difference_matrix` to get them.\n\nAll in all what this patch does is mostly code administration, but well, that's the way to go ...\n\nQuasi-difference matrices will be handled later as there are some problems with them, in particular in the way `orthogonal_array` will query the future `quasi_difference_matrix` constructor.\n\nNathann\n\nCC:  @videlec\n\nBranch/Commit: c66c19b305799452765ccf53d3380ee670700f85\n\nReviewer: Vincent Delecroix\n\nAuthor: Nathann Cohen\n\nDependencies: #16817\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16846\n\n",
    "closed_at": "2014-08-24T17:36:44Z",
    "created_at": "2014-08-17T14:59:25Z",
    "labels": [
        "component: combinatorial designs"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "a difference_matrices module",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16846",
    "user": "https://github.com/nathanncohen"
}
```
This commit creates a `difference_matrices` module which does not do much at the moment: it can creates DM for prime powers, and return DM from the database.

In the database, however, a lot changes as many OA were actually difference matrices. The constructors are turned into difference matrices constructors, and `orthogonal_array` now calls `difference_matrix` to get them.

All in all what this patch does is mostly code administration, but well, that's the way to go ...

Quasi-difference matrices will be handled later as there are some problems with them, in particular in the way `orthogonal_array` will query the future `quasi_difference_matrix` constructor.

Nathann

CC:  @videlec

Branch/Commit: c66c19b305799452765ccf53d3380ee670700f85

Reviewer: Vincent Delecroix

Author: Nathann Cohen

Dependencies: #16817

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16846





---

archive/issue_comments_281564.json:
```json
{
    "body": "Changing branch from \"\" to \"u/ncohen/16846\"",
    "created_at": "2014-08-17T14:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281564",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "" to "u/ncohen/16846"



---

archive/issue_comments_281565.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-17T14:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281565",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_281566.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-17T15:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281566",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_281567.json:
```json
{
    "body": "Changing commit from \"\" to \"2649805f41094602cfbd2787f75028d806cf2d05\"",
    "created_at": "2014-08-17T15:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281567",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "2649805f41094602cfbd2787f75028d806cf2d05"



---

archive/issue_comments_281568.json:
```json
{
    "body": "<a id='comment:3'></a>Sorry for the diff in the database file, it's a bit hard to review with everything being mixed up by the diff algorithm... `:-/`\n\nWhat happens there is simple: some `DM_*` functions are removed and replaced by their `DM_*` counterpart. No new constructor is added, it's only a rephrase of that code.\n\nNathann",
    "created_at": "2014-08-17T15:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281568",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>Sorry for the diff in the database file, it's a bit hard to review with everything being mixed up by the diff algorithm... `:-/`

What happens there is simple: some `DM_*` functions are removed and replaced by their `DM_*` counterpart. No new constructor is added, it's only a rephrase of that code.

Nathann



---

archive/issue_comments_281569.json:
```json
{
    "body": "<a id='comment:4'></a>Hi Nathann,\n\nVery nice that you did that!\n\nI guess that difference matrices are interesting only over Abelian groups. Is that true? It would be nice to coordinate with difference families for input/output. For example, in #16802, in the database, you can ask a difference family with a given group and not only a fixed cardinality. It is not perfect, but I tried to start involving the group...\n\nVincent",
    "created_at": "2014-08-17T18:34:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281569",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Hi Nathann,

Very nice that you did that!

I guess that difference matrices are interesting only over Abelian groups. Is that true? It would be nice to coordinate with difference families for input/output. For example, in #16802, in the database, you can ask a difference family with a given group and not only a fixed cardinality. It is not perfect, but I tried to start involving the group...

Vincent



---

archive/issue_comments_281570.json:
```json
{
    "body": "<a id='comment:5'></a>Yo !\n\n> I guess that difference matrices are interesting only over Abelian groups. Is that true?\n\n\nI have no idea about that, but all examples I saw were on abelian groups indeed.\n\n> It would be nice to coordinate with difference families for input/output. For example, in #16802, in the database, you can ask a difference family with a given group and not only a fixed cardinality. It is not perfect, but I tried to start involving the group...\n\n\nHmmmmm... So a structure like that ?\n\n```\nDM_constructions = {\n   order_of_the_group : {\n     signature_of_the_abelian_group: [\n         (k1,matrix_constructor1),\n         (k2,matrix_constructor2)\n         ]\n     }\n}\n```\n\nHaving several difference families/matrices or OA and stuff is a hobby of yours, you know ? To me it's just not the interesting direction `:-P`\n\nIt can be done anyway but we have to do that later, this heap of patches is really getting dangerous. Plus Travis wrote a patch that is totally incompatible with this one, and there are like 10 tickets in linear order an `needs_review` at the moment `:-P`\n\nNathann",
    "created_at": "2014-08-17T18:46:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281570",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>Yo !

> I guess that difference matrices are interesting only over Abelian groups. Is that true?


I have no idea about that, but all examples I saw were on abelian groups indeed.

> It would be nice to coordinate with difference families for input/output. For example, in #16802, in the database, you can ask a difference family with a given group and not only a fixed cardinality. It is not perfect, but I tried to start involving the group...


Hmmmmm... So a structure like that ?

```
DM_constructions = {
   order_of_the_group : {
     signature_of_the_abelian_group: [
         (k1,matrix_constructor1),
         (k2,matrix_constructor2)
         ]
     }
}
```

Having several difference families/matrices or OA and stuff is a hobby of yours, you know ? To me it's just not the interesting direction `:-P`

It can be done anyway but we have to do that later, this heap of patches is really getting dangerous. Plus Travis wrote a patch that is totally incompatible with this one, and there are like 10 tickets in linear order an `needs_review` at the moment `:-P`

Nathann



---

archive/issue_comments_281571.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 ncohen]:\n> Yo !\n> \n> > I guess that difference matrices are interesting only over Abelian groups. Is that true?\n\n> \n> I have no idea about that, but all examples I saw were on abelian groups indeed.\n\n\nBecause you can not develop a difference matrix to get an OA if the group is non Abelian. But perhaps, difference matrices can be used for other purposes.\n\n> > It would be nice to coordinate with difference families for input/output. For example, in #16802, in the database, you can ask a difference family with a given group and not only a fixed cardinality. It is not perfect, but I tried to start involving the group...\n\n> \n> Hmmmmm... So a structure like that ?\n> \n> ```\n> DM_constructions = {\n>    order_of_the_group : {\n>      signature_of_the_abelian_group: [\n>          (k1,matrix_constructor1),\n>          (k2,matrix_constructor2)\n>          ]\n>      }\n> }\n> ```\n\n\nMight be better than what I did... I used ` {signature: DF} `\n\n> Having several difference families/matrices or OA and stuff is a hobby of yours, you know ? To me it's just not the interesting direction `:-P`\n\n\nSometimes it is very important that your group is cyclic (for difference families or difference matrix)... so you want to be able to ask a given difference X over a cyclic group only.\n\n> It can be done anyway but we have to do that later, this heap of patches is really getting dangerous. Plus Travis wrote a patch that is totally incompatible with this one, and there are like 10 tickets in linear order an `needs_review` at the moment `:-P`\n\n\n+1\n\nVincent",
    "created_at": "2014-08-17T19:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281571",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>Replying to [comment:5 ncohen]:
> Yo !
> 
> > I guess that difference matrices are interesting only over Abelian groups. Is that true?

> 
> I have no idea about that, but all examples I saw were on abelian groups indeed.


Because you can not develop a difference matrix to get an OA if the group is non Abelian. But perhaps, difference matrices can be used for other purposes.

> > It would be nice to coordinate with difference families for input/output. For example, in #16802, in the database, you can ask a difference family with a given group and not only a fixed cardinality. It is not perfect, but I tried to start involving the group...

> 
> Hmmmmm... So a structure like that ?
> 
> ```
> DM_constructions = {
>    order_of_the_group : {
>      signature_of_the_abelian_group: [
>          (k1,matrix_constructor1),
>          (k2,matrix_constructor2)
>          ]
>      }
> }
> ```


Might be better than what I did... I used ` {signature: DF} `

> Having several difference families/matrices or OA and stuff is a hobby of yours, you know ? To me it's just not the interesting direction `:-P`


Sometimes it is very important that your group is cyclic (for difference families or difference matrix)... so you want to be able to ask a given difference X over a cyclic group only.

> It can be done anyway but we have to do that later, this heap of patches is really getting dangerous. Plus Travis wrote a patch that is totally incompatible with this one, and there are like 10 tickets in linear order an `needs_review` at the moment `:-P`


+1

Vincent



---

archive/issue_comments_281572.json:
```json
{
    "body": "<a id='comment:7'></a>> Might be better than what I did... I used ` {signature: DF} `\n\n\nIf you just want a difference family to exist in order to build a BIBD but don't know the exact decomposition you need to list everything `:-/` \n\nNathann",
    "created_at": "2014-08-17T19:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281572",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>> Might be better than what I did... I used ` {signature: DF} `


If you just want a difference family to exist in order to build a BIBD but don't know the exact decomposition you need to list everything `:-/` 

Nathann



---

archive/issue_comments_281573.json:
```json
{
    "body": "Changing commit from \"2649805f41094602cfbd2787f75028d806cf2d05\" to \"3e0a79ba3154c1e2c9591c60cc9092361f77dfd7\"",
    "created_at": "2014-08-22T11:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281573",
    "user": "https://github.com/nathanncohen"
}
```

Changing commit from "2649805f41094602cfbd2787f75028d806cf2d05" to "3e0a79ba3154c1e2c9591c60cc9092361f77dfd7"



---

archive/issue_comments_281574.json:
```json
{
    "body": "<a id='comment:8'></a>Last 10 new commits:",
    "created_at": "2014-08-22T11:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281574",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>Last 10 new commits:



---

archive/issue_comments_281575.json:
```json
{
    "body": "Changing branch from \"u/ncohen/16846\" to \"public/16846\"",
    "created_at": "2014-08-22T11:57:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281575",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "u/ncohen/16846" to "public/16846"



---

archive/issue_events_049292.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-22T12:01:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16846#event-49292"
}
```



---

archive/issue_comments_281576.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-08-22T12:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281576",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_281577.json:
```json
{
    "body": "Changing commit from \"3e0a79ba3154c1e2c9591c60cc9092361f77dfd7\" to \"f7afe6f10d690f12c568401e8850a713f6874d51\"",
    "created_at": "2014-08-22T12:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281577",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3e0a79ba3154c1e2c9591c60cc9092361f77dfd7" to "f7afe6f10d690f12c568401e8850a713f6874d51"



---

archive/issue_comments_281578.json:
```json
{
    "body": "Changing commit from \"f7afe6f10d690f12c568401e8850a713f6874d51\" to \"fd1bbc6686b99e38d200fecd32def5574d4ca806\"",
    "created_at": "2014-08-22T14:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281578",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f7afe6f10d690f12c568401e8850a713f6874d51" to "fd1bbc6686b99e38d200fecd32def5574d4ca806"



---

archive/issue_comments_281579.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-22T14:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281579",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_281580.json:
```json
{
    "body": "Changing commit from \"fd1bbc6686b99e38d200fecd32def5574d4ca806\" to \"c66c19b305799452765ccf53d3380ee670700f85\"",
    "created_at": "2014-08-22T15:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281580",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "fd1bbc6686b99e38d200fecd32def5574d4ca806" to "c66c19b305799452765ccf53d3380ee670700f85"



---

archive/issue_comments_281581.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-22T15:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281581",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_281582.json:
```json
{
    "body": "<a id='comment:13'></a>I did\n- removed `TD_6_12`\n- `OA_7_39` -> `DM_39_6_1`\n\nAs a consequence, doc builds... and test still pass.\n\nIf you like it, set to positive review.\n\nVincent",
    "created_at": "2014-08-22T15:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281582",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>I did
- removed `TD_6_12`
- `OA_7_39` -> `DM_39_6_1`

As a consequence, doc builds... and test still pass.

If you like it, set to positive review.

Vincent



---

archive/issue_comments_281583.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2014-08-22T15:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281583",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_comments_281584.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-22T15:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281584",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_281585.json:
```json
{
    "body": "<a id='comment:14'></a>The doc builds, and doctests pass. Thank you very much for this last review ! `:-D`\n\nNathann",
    "created_at": "2014-08-22T15:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281585",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>The doc builds, and doctests pass. Thank you very much for this last review ! `:-D`

Nathann



---

archive/issue_events_049293.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-24T17:36:44Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16846#event-49293"
}
```



---

archive/issue_comments_281586.json:
```json
{
    "body": "Changing branch from \"public/16846\" to \"c66c19b305799452765ccf53d3380ee670700f85\"",
    "created_at": "2014-08-24T17:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281586",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/16846" to "c66c19b305799452765ccf53d3380ee670700f85"



---

archive/issue_comments_281587.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-24T17:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16846",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16846#issuecomment-281587",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
