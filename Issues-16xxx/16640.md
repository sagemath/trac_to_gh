# Issue 16640: Graphics3d.show abuses graphics_filename

archive/issues_016403.json:
```json
{
    "assignees": [],
    "body": "Code in [sage/plot/plot3d/base.pyx](https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/plot/plot3d/base.pyx?id=6.3.beta1#n1131) in the method `Graphics3d.show()` makes invalid use of `graphics_filename`: it generates a name (like `sage0.png`), then strips the extension and appends various other extensions during the course of the method. But `graphics_filename` makes no guarantees that these other file names will be unused. In fact chances are pretty good that these files already exist from a different run of that method inside the same cell. So we get clashes there. Perhaps if things change in other places we might even get a security issue due to a race condition here.\n\nI can think of two possible approaches: either call `graphics_filename` in several places, once for every file name we need to generate. Or create a temporary directory and write all files inside that with fixed names. The former will likely be easier to handle for notebook, but may make the code harder to read. Particularly those cases where some tool will use one file name to derive another file name might be a real pain, like when the applet size is encoded in the file name, or the magic aroud the `archive_name` for jmol. Will need some good interactive testing to make sure that everything still works after these changes.\n\nBranch/Commit: **[`034fa58`](https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b)**\n\nReviewer: **Jeroen Demeyer, Karl-Dieter Crisman**\n\nAuthor: **Martin von Gagern, Jeroen Demeyer**\n\nComponent: **graphics**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16640_\n\n",
    "closed_at": "2014-11-17T21:21:52Z",
    "created_at": "2014-07-10T06:59:14Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graphics",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Graphics3d.show abuses graphics_filename",
    "type": "issue",
    "updated_at": "2014-11-17T21:21:52Z",
    "url": "https://github.com/sagemath/sage/issues/16640",
    "user": "https://github.com/gagern"
}
```
Code in [sage/plot/plot3d/base.pyx](https://github.com/sagemath/sagetrac-mirror/blob/develop/src/sage/plot/plot3d/base.pyx?id=6.3.beta1#n1131) in the method `Graphics3d.show()` makes invalid use of `graphics_filename`: it generates a name (like `sage0.png`), then strips the extension and appends various other extensions during the course of the method. But `graphics_filename` makes no guarantees that these other file names will be unused. In fact chances are pretty good that these files already exist from a different run of that method inside the same cell. So we get clashes there. Perhaps if things change in other places we might even get a security issue due to a race condition here.

I can think of two possible approaches: either call `graphics_filename` in several places, once for every file name we need to generate. Or create a temporary directory and write all files inside that with fixed names. The former will likely be easier to handle for notebook, but may make the code harder to read. Particularly those cases where some tool will use one file name to derive another file name might be a real pain, like when the applet size is encoded in the file name, or the magic aroud the `archive_name` for jmol. Will need some good interactive testing to make sure that everything still works after these changes.

Branch/Commit: **[`034fa58`](https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b)**

Reviewer: **Jeroen Demeyer, Karl-Dieter Crisman**

Author: **Martin von Gagern, Jeroen Demeyer**

Component: **graphics**

_Issue created by migration from https://trac.sagemath.org/ticket/16640_





---

archive/issue_events_237905.json:
```json
{
    "actor": "https://github.com/gagern",
    "created_at": "2014-07-10T06:59:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237905"
}
```



---

archive/issue_events_237906.json:
```json
{
    "actor": "https://github.com/gagern",
    "created_at": "2014-07-10T06:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graphics",
    "label_color": "0000ff",
    "label_name": "c: graphics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237906"
}
```



---

archive/issue_events_237907.json:
```json
{
    "actor": "https://github.com/gagern",
    "created_at": "2014-07-10T06:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237907"
}
```



---

archive/issue_events_237908.json:
```json
{
    "actor": "https://github.com/gagern",
    "created_at": "2014-07-10T06:59:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237908"
}
```



---

archive/issue_comments_217016.json:
```json
{
    "body": "Branch: **[u/gagern/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/gagern/ticket/16640)**",
    "created_at": "2014-07-11T21:11:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217016",
    "user": "https://github.com/gagern"
}
```

Branch: **[u/gagern/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/gagern/ticket/16640)**



---

archive/issue_events_237909.json:
```json
{
    "actor": "https://github.com/gagern",
    "created_at": "2014-07-11T21:15:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237909"
}
```



---

archive/issue_comments_217017.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNote that only the last two commits are new for this ticket; the rest comes from #16645 and its dependencies.\n\nI tested things both in notebook and interactively. java3d failed in both cases, for which I just filed #16647. Apart from that, everything looks fine. In particular it seems as if I got all the file name interdependencies for jmol right.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/58b9c46c732978aa1b82ba4f15f31919d8f3f3c3\">58b9c46</a></td><td><code>minimal fix to restore functionality</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/16cbd2d59b4b5bbb330668255345fc2d53f3afee\">16cbd2d</a></td><td><code>Merge branch 'develop' into ticket/16533-stopgap</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3e656b4507d9f6544e87641614836dc6275e929\">b3e656b</a></td><td><code>graphics_filename: return a tmp_filename() if not in EMBEDDED_MODE</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/69b285d7fb1ebf189aea0b7cde311880ec884d6d\">69b285d</a></td><td><code>Restore possibly positional arguments.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e3c55428aeb70ded8dc9e66742c2cf68eae57350\">e3c5542</a></td><td><code>Merge branch ticket/15515 into ticket/16608 to create ticket/16645.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9f30e9400f6fda042bf579e720ffee772c751f1e\">9f30e94</a></td><td><code>Always use graphics_filename instead of tmp_filename.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb7307f0649cfa90916f74c102d1d09a424b759a\">bb7307f</a></td><td><code>Prevent doctest from leaking file into current working directory.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0dffab6fdd4f7bb0a1e8dddfa02962ed8f7e6ab3\">0dffab6</a></td><td><code>Include dot in extension for graphics_filename().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9dfe1337683a6d99118b658fad39d55a0110692a\">9dfe133</a></td><td><code>Generate names for 3d graphics files independently.</code></td></tr></table>\n",
    "created_at": "2014-07-11T21:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217017",
    "user": "https://github.com/gagern"
}
```

<div id="comment:2" align="right">comment:2</div>

Note that only the last two commits are new for this ticket; the rest comes from #16645 and its dependencies.

I tested things both in notebook and interactively. java3d failed in both cases, for which I just filed #16647. Apart from that, everything looks fine. In particular it seems as if I got all the file name interdependencies for jmol right.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/58b9c46c732978aa1b82ba4f15f31919d8f3f3c3">58b9c46</a></td><td><code>minimal fix to restore functionality</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/16cbd2d59b4b5bbb330668255345fc2d53f3afee">16cbd2d</a></td><td><code>Merge branch 'develop' into ticket/16533-stopgap</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3e656b4507d9f6544e87641614836dc6275e929">b3e656b</a></td><td><code>graphics_filename: return a tmp_filename() if not in EMBEDDED_MODE</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/69b285d7fb1ebf189aea0b7cde311880ec884d6d">69b285d</a></td><td><code>Restore possibly positional arguments.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e3c55428aeb70ded8dc9e66742c2cf68eae57350">e3c5542</a></td><td><code>Merge branch ticket/15515 into ticket/16608 to create ticket/16645.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9f30e9400f6fda042bf579e720ffee772c751f1e">9f30e94</a></td><td><code>Always use graphics_filename instead of tmp_filename.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb7307f0649cfa90916f74c102d1d09a424b759a">bb7307f</a></td><td><code>Prevent doctest from leaking file into current working directory.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0dffab6fdd4f7bb0a1e8dddfa02962ed8f7e6ab3">0dffab6</a></td><td><code>Include dot in extension for graphics_filename().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9dfe1337683a6d99118b658fad39d55a0110692a">9dfe133</a></td><td><code>Generate names for 3d graphics files independently.</code></td></tr></table>




---

archive/issue_comments_217018.json:
```json
{
    "body": "Author: **Martin von Gagern**",
    "created_at": "2014-07-11T21:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217018",
    "user": "https://github.com/gagern"
}
```

Author: **Martin von Gagern**



---

archive/issue_comments_217019.json:
```json
{
    "body": "Dependencies: **#16645**",
    "created_at": "2014-07-11T21:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217019",
    "user": "https://github.com/gagern"
}
```

Dependencies: **#16645**



---

archive/issue_comments_217020.json:
```json
{
    "body": "Commit: **[`9dfe133`](https://github.com/sagemath/sagetrac-mirror/commit/9dfe1337683a6d99118b658fad39d55a0110692a)**",
    "created_at": "2014-07-11T21:15:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217020",
    "user": "https://github.com/gagern"
}
```

Commit: **[`9dfe133`](https://github.com/sagemath/sagetrac-mirror/commit/9dfe1337683a6d99118b658fad39d55a0110692a)**



---

archive/issue_comments_217021.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n[These are the changes](https://github.com/sagemath/sagetrac-mirror/compare/bb7307f0649cfa90916f74c102d1d09a424b759a...u/gagern/ticket/16640) that need reviewing in this ticket here.",
    "created_at": "2014-07-11T21:21:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217021",
    "user": "https://github.com/gagern"
}
```

<div id="comment:3" align="right">comment:3</div>

[These are the changes](https://github.com/sagemath/sagetrac-mirror/compare/bb7307f0649cfa90916f74c102d1d09a424b759a...u/gagern/ticket/16640) that need reviewing in this ticket here.



---

archive/issue_events_237910.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237910"
}
```



---

archive/issue_events_237911.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237911"
}
```



---

archive/issue_comments_217022.json:
```json
{
    "body": "Changed commit from **[`9dfe133`](https://github.com/sagemath/sagetrac-mirror/commit/9dfe1337683a6d99118b658fad39d55a0110692a)** to **[`cf63c2d`](https://github.com/sagemath/sagetrac-mirror/commit/cf63c2dd372caa602e67397e871ac65c164a2cba)**",
    "created_at": "2014-09-05T07:19:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217022",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9dfe133`](https://github.com/sagemath/sagetrac-mirror/commit/9dfe1337683a6d99118b658fad39d55a0110692a)** to **[`cf63c2d`](https://github.com/sagemath/sagetrac-mirror/commit/cf63c2dd372caa602e67397e871ac65c164a2cba)**



---

archive/issue_comments_217023.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/301185bb184f744bfd4f3f158f974f193096b069\">301185b</a></td><td><code>Include dot in extension for graphics_filename().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf63c2dd372caa602e67397e871ac65c164a2cba\">cf63c2d</a></td><td><code>Generate names for 3d graphics files independently.</code></td></tr></table>\n",
    "created_at": "2014-09-05T07:19:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217023",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/301185bb184f744bfd4f3f158f974f193096b069">301185b</a></td><td><code>Include dot in extension for graphics_filename().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf63c2dd372caa602e67397e871ac65c164a2cba">cf63c2d</a></td><td><code>Generate names for 3d graphics files independently.</code></td></tr></table>




---

archive/issue_comments_217024.json:
```json
{
    "body": "Changed dependencies from **#16645** to none",
    "created_at": "2014-09-05T07:20:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217024",
    "user": "https://github.com/gagern"
}
```

Changed dependencies from **#16645** to none



---

archive/issue_comments_217025.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61809d63e687d8809cddcdbec8ecbb8e093cfba6\">61809d6</a></td><td><code>Include dot in extension for graphics_filename().</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/84a2f30d7d494ece9772605a86b85d3b90742fab\">84a2f30</a></td><td><code>Generate names for 3d graphics files independently.</code></td></tr></table>\n",
    "created_at": "2014-09-05T07:26:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217025",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61809d63e687d8809cddcdbec8ecbb8e093cfba6">61809d6</a></td><td><code>Include dot in extension for graphics_filename().</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/84a2f30d7d494ece9772605a86b85d3b90742fab">84a2f30</a></td><td><code>Generate names for 3d graphics files independently.</code></td></tr></table>




---

archive/issue_comments_217026.json:
```json
{
    "body": "Changed commit from **[`cf63c2d`](https://github.com/sagemath/sagetrac-mirror/commit/cf63c2dd372caa602e67397e871ac65c164a2cba)** to **[`84a2f30`](https://github.com/sagemath/sagetrac-mirror/commit/84a2f30d7d494ece9772605a86b85d3b90742fab)**",
    "created_at": "2014-09-05T07:26:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217026",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cf63c2d`](https://github.com/sagemath/sagetrac-mirror/commit/cf63c2dd372caa602e67397e871ac65c164a2cba)** to **[`84a2f30`](https://github.com/sagemath/sagetrac-mirror/commit/84a2f30d7d494ece9772605a86b85d3b90742fab)**



---

archive/issue_comments_217027.json:
```json
{
    "body": "Changed branch from **[u/gagern/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/gagern/ticket/16640)** to **[u/jdemeyer/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/16640)**",
    "created_at": "2014-10-11T18:49:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217027",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/gagern/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/gagern/ticket/16640)** to **[u/jdemeyer/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/16640)**



---

archive/issue_comments_217028.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a48c6bf21a4048c035799af58e7a8688a9e0245\">1a48c6b</a></td><td><code>Use \"with open() as f\" syntax</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/49ce20b63e2dc39d611f453f76077620f4faccfb\">49ce20b</a></td><td><code>Set fg to figsize[0] like before</code></td></tr></table>\n",
    "created_at": "2014-10-11T20:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217028",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a48c6bf21a4048c035799af58e7a8688a9e0245">1a48c6b</a></td><td><code>Use "with open() as f" syntax</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/49ce20b63e2dc39d611f453f76077620f4faccfb">49ce20b</a></td><td><code>Set fg to figsize[0] like before</code></td></tr></table>




---

archive/issue_comments_217029.json:
```json
{
    "body": "Changed commit from **[`84a2f30`](https://github.com/sagemath/sagetrac-mirror/commit/84a2f30d7d494ece9772605a86b85d3b90742fab)** to **[`49ce20b`](https://github.com/sagemath/sagetrac-mirror/commit/49ce20b63e2dc39d611f453f76077620f4faccfb)**",
    "created_at": "2014-10-11T20:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217029",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`84a2f30`](https://github.com/sagemath/sagetrac-mirror/commit/84a2f30d7d494ece9772605a86b85d3b90742fab)** to **[`49ce20b`](https://github.com/sagemath/sagetrac-mirror/commit/49ce20b63e2dc39d611f453f76077620f4faccfb)**



---

archive/issue_comments_217030.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2014-10-11T20:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217030",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_217031.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nMerged with 6.4.beta4 and added some fixes. Please review.",
    "created_at": "2014-10-11T20:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217031",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Merged with 6.4.beta4 and added some fixes. Please review.



---

archive/issue_comments_217032.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/463eb63585d45e209938fcd8b8dd91d1a488d2e4\">463eb63</a></td><td><code>Rendering canvas3d in all doctests is too slow</code></td></tr></table>\n",
    "created_at": "2014-10-11T21:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217032",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/463eb63585d45e209938fcd8b8dd91d1a488d2e4">463eb63</a></td><td><code>Rendering canvas3d in all doctests is too slow</code></td></tr></table>




---

archive/issue_comments_217033.json:
```json
{
    "body": "Changed commit from **[`49ce20b`](https://github.com/sagemath/sagetrac-mirror/commit/49ce20b63e2dc39d611f453f76077620f4faccfb)** to **[`463eb63`](https://github.com/sagemath/sagetrac-mirror/commit/463eb63585d45e209938fcd8b8dd91d1a488d2e4)**",
    "created_at": "2014-10-11T21:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217033",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`49ce20b`](https://github.com/sagemath/sagetrac-mirror/commit/49ce20b63e2dc39d611f453f76077620f4faccfb)** to **[`463eb63`](https://github.com/sagemath/sagetrac-mirror/commit/463eb63585d45e209938fcd8b8dd91d1a488d2e4)**



---

archive/issue_comments_217034.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/711127f7cf89f6e75d7f2e970c4a58ec51ec03c5\">711127f</a></td><td><code>Merge remote-tracking branch 'origin/develop' into ticket/16640</code></td></tr></table>\n",
    "created_at": "2014-10-30T16:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217034",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/711127f7cf89f6e75d7f2e970c4a58ec51ec03c5">711127f</a></td><td><code>Merge remote-tracking branch 'origin/develop' into ticket/16640</code></td></tr></table>




---

archive/issue_comments_217035.json:
```json
{
    "body": "Changed commit from **[`463eb63`](https://github.com/sagemath/sagetrac-mirror/commit/463eb63585d45e209938fcd8b8dd91d1a488d2e4)** to **[`711127f`](https://github.com/sagemath/sagetrac-mirror/commit/711127f7cf89f6e75d7f2e970c4a58ec51ec03c5)**",
    "created_at": "2014-10-30T16:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217035",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`463eb63`](https://github.com/sagemath/sagetrac-mirror/commit/463eb63585d45e209938fcd8b8dd91d1a488d2e4)** to **[`711127f`](https://github.com/sagemath/sagetrac-mirror/commit/711127f7cf89f6e75d7f2e970c4a58ec51ec03c5)**



---

archive/issue_comments_217036.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHi Jeroen: Your first two commits are fine, as is the first commit of Martin's.  (Currently looking at his main, second one.)  How much slower did the doctests become without your last commit?  (Martin, if you see this, what was your thinking on changing the doctest mode?)",
    "created_at": "2014-10-31T01:58:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217036",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:13" align="right">comment:13</div>

Hi Jeroen: Your first two commits are fine, as is the first commit of Martin's.  (Currently looking at his main, second one.)  How much slower did the doctests become without your last commit?  (Martin, if you see this, what was your thinking on changing the doctest mode?)



---

archive/issue_comments_217037.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nHi, sorry I didn't respond to the commits by Jeroen any sooner.\n\nReplying to [@kcrisman](#comment:13):\n> Hi Jeroen: Your first two commits are fine,\n\nI agree. Thanks a lot!\n\n> (Martin, if you see this, what was your thinking on changing the doctest mode?)\n\nMy main reason for modifying that line at all was the fact that canvas3d only works in embedded mode, so having it available otherwise might confuse users. My reson for including it in doctests is simply because all the other possible viewers are active in doctest mode as well. There is a doctest specifically for the canvas3d case, but if I restrict canvas3d to embedded mode only, that one would fail. So staying in line with all the other tests seemed the reasonable thing to do.\n\nIf things really are too slow, I'd change that to\n`if viewer == 'canvas3d' and (DOCTEST_MODE or EMBEDDED_MODE):`\nso we can have that one explicit doctest nevertheless. But first I'd like to quantify that effect on test execution time, and right now I have a build problem.",
    "created_at": "2014-10-31T07:07:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217037",
    "user": "https://github.com/gagern"
}
```

<div id="comment:14" align="right">comment:14</div>

Hi, sorry I didn't respond to the commits by Jeroen any sooner.

Replying to [@kcrisman](#comment:13):
> Hi Jeroen: Your first two commits are fine,

I agree. Thanks a lot!

> (Martin, if you see this, what was your thinking on changing the doctest mode?)

My main reason for modifying that line at all was the fact that canvas3d only works in embedded mode, so having it available otherwise might confuse users. My reson for including it in doctests is simply because all the other possible viewers are active in doctest mode as well. There is a doctest specifically for the canvas3d case, but if I restrict canvas3d to embedded mode only, that one would fail. So staying in line with all the other tests seemed the reasonable thing to do.

If things really are too slow, I'd change that to
`if viewer == 'canvas3d' and (DOCTEST_MODE or EMBEDDED_MODE):`
so we can have that one explicit doctest nevertheless. But first I'd like to quantify that effect on test execution time, and right now I have a build problem.



---

archive/issue_comments_217038.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAlways doing `canvas3d` is really too slow, I remember one file(!) taking over 1000s to doctest.",
    "created_at": "2014-10-31T08:28:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217038",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Always doing `canvas3d` is really too slow, I remember one file(!) taking over 1000s to doctest.



---

archive/issue_comments_217039.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d\">bd1479d</a></td><td><code>Make viewer=\"canvas3d\" an error outside the Notebook</code></td></tr></table>\n",
    "created_at": "2014-10-31T08:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217039",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d">bd1479d</a></td><td><code>Make viewer="canvas3d" an error outside the Notebook</code></td></tr></table>




---

archive/issue_comments_217040.json:
```json
{
    "body": "Changed commit from **[`711127f`](https://github.com/sagemath/sagetrac-mirror/commit/711127f7cf89f6e75d7f2e970c4a58ec51ec03c5)** to **[`bd1479d`](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d)**",
    "created_at": "2014-10-31T08:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217040",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`711127f`](https://github.com/sagemath/sagetrac-mirror/commit/711127f7cf89f6e75d7f2e970c4a58ec51ec03c5)** to **[`bd1479d`](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d)**



---

archive/issue_comments_217041.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@gagern](#comment:14):\n> My main reason for modifying that line at all was the fact that canvas3d only works in embedded mode, so having it available otherwise might confuse users.\n\nFixed by raising a suitable exception.",
    "created_at": "2014-10-31T08:35:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217041",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@gagern](#comment:14):
> My main reason for modifying that line at all was the fact that canvas3d only works in embedded mode, so having it available otherwise might confuse users.

Fixed by raising a suitable exception.



---

archive/issue_comments_217042.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\n> > My main reason for modifying that line at all was the fact that canvas3d only works in embedded mode, so having it available otherwise might confuse users.\n\n> Fixed by raising a suitable exception.\n\nThat was something we needed a while ago anyway!  Thanks.",
    "created_at": "2014-10-31T12:00:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217042",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:18" align="right">comment:18</div>

> > My main reason for modifying that line at all was the fact that canvas3d only works in embedded mode, so having it available otherwise might confuse users.

> Fixed by raising a suitable exception.

That was something we needed a while ago anyway!  Thanks.



---

archive/issue_comments_217043.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nHere is something minor but still needing attention. The documentation says\n\n```\n        -  ``filename`` -- string (default: a temp file); file\n           to save the image to\n```\nbut of course this is now only going to be true in the command line.  Which probably makes sense.  But this should be noted.  Similarly,\n\n```\n        # Tachyon resolution options\n```\nshould probably just add a quick note that \"mode defaults\" also are being set in the next few lines.\n\nInterestingly,\n\n```\n            # Temporary hack: encode the desired applet size in the end of the filename:\n            # (This will be removed once we have dynamic resizing of applets in the browser.)\n```\nand the following code could in principle be removed, as the update does indeed have dynamic resizing!  But I think let's leave that be for somewhere else; I don't want to mess with the already messy naming of jmol stuff...\n\nFinally, I don't understand this comment - I'm sorry if I am just thinking inside the box:\n\n```\n                # when testing this, modify graphics_filename so that it\n                # returns files which don't automatically share a base name,\n                # e.g.: \"import random; i = random.randint(0, 10000)\"\n```\nWas this just a \"note to self\" or do you mean that, as a tester, I should actually change `graphics_filename` instead of letting it just keep adding one to base names, or ... ?  I figured the whole point of this change was to test where they *did* share a base name, but again I may be thinking too conventionally.",
    "created_at": "2014-10-31T12:43:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217043",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:19" align="right">comment:19</div>

Here is something minor but still needing attention. The documentation says

```
        -  ``filename`` -- string (default: a temp file); file
           to save the image to
```
but of course this is now only going to be true in the command line.  Which probably makes sense.  But this should be noted.  Similarly,

```
        # Tachyon resolution options
```
should probably just add a quick note that "mode defaults" also are being set in the next few lines.

Interestingly,

```
            # Temporary hack: encode the desired applet size in the end of the filename:
            # (This will be removed once we have dynamic resizing of applets in the browser.)
```
and the following code could in principle be removed, as the update does indeed have dynamic resizing!  But I think let's leave that be for somewhere else; I don't want to mess with the already messy naming of jmol stuff...

Finally, I don't understand this comment - I'm sorry if I am just thinking inside the box:

```
                # when testing this, modify graphics_filename so that it
                # returns files which don't automatically share a base name,
                # e.g.: "import random; i = random.randint(0, 10000)"
```
Was this just a "note to self" or do you mean that, as a tester, I should actually change `graphics_filename` instead of letting it just keep adding one to base names, or ... ?  I figured the whole point of this change was to test where they *did* share a base name, but again I may be thinking too conventionally.



---

archive/issue_comments_217044.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSo far it seems fine, though I rediscovered and diagnosed #11275 along the way.",
    "created_at": "2014-10-31T14:32:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217044",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:20" align="right">comment:20</div>

So far it seems fine, though I rediscovered and diagnosed #11275 along the way.



---

archive/issue_events_237912.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-10-31T14:47:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237912"
}
```



---

archive/issue_events_237913.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-10-31T14:47:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237913"
}
```



---

archive/issue_comments_217045.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThe following in the *command line* don't seem to create any files (I mean visible ones in my directory).  Maybe they aren't supposed to?\n\n```\nsage: var('y')\ny\nsage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')\nsage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')\n```\nNote that the second thing pops up a jmol viewer.  I can't figure out if this ticket introduced it, though it seems to predate that, based on my experimentation.\n\nAlso, with the current documentation, there is no example of how to *properly* use the `filename` keyword here, and that should be added.\n\nAnyway, \"needs work\" to clarify/fix these `filename` use issues.",
    "created_at": "2014-10-31T14:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217045",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:21" align="right">comment:21</div>

The following in the *command line* don't seem to create any files (I mean visible ones in my directory).  Maybe they aren't supposed to?

```
sage: var('y')
y
sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')
sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')
```
Note that the second thing pops up a jmol viewer.  I can't figure out if this ticket introduced it, though it seems to predate that, based on my experimentation.

Also, with the current documentation, there is no example of how to *properly* use the `filename` keyword here, and that should be added.

Anyway, "needs work" to clarify/fix these `filename` use issues.



---

archive/issue_comments_217046.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@kcrisman](#comment:21):\n> \n> ```\n> sage: var('y')\n> y\n> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')\n> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')\n> ```\n\nThe correct syntax is\n\n```\nsage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1)).show(filename='foo')\n```",
    "created_at": "2014-10-31T16:43:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217046",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@kcrisman](#comment:21):
> 
> ```
> sage: var('y')
> y
> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')
> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')
> ```

The correct syntax is

```
sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1)).show(filename='foo')
```



---

archive/issue_comments_217047.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@kcrisman](#comment:19):\n> Here is something minor but still needing attention. The documentation says\n> \n> ```\n>         -  ``filename`` -- string (default: a temp file); file\n>            to save the image to\n> ```\n> but of course this is now only going to be true in the command line.  Which probably makes sense.\n\nNo, it doesn't make sense. An explicit `filename` should override the default, even in the notebook.",
    "created_at": "2014-10-31T16:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217047",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@kcrisman](#comment:19):
> Here is something minor but still needing attention. The documentation says
> 
> ```
>         -  ``filename`` -- string (default: a temp file); file
>            to save the image to
> ```
> but of course this is now only going to be true in the command line.  Which probably makes sense.

No, it doesn't make sense. An explicit `filename` should override the default, even in the notebook.



---

archive/issue_comments_217048.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n> > \n> > ```\n> > sage: var('y')\n> > y\n> > sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')\n> > sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')\n> > ```\n\n> \n> The correct syntax is\n> \n> ```\n> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1)).show(filename='foo')\n> ```\n\nGood to know.  But that sort of proves my point, then, that the documentation (old and new) doesn't tell me that - in this case, because so  many keywords can be passed to the plot and then show up in `show()`.  Such as what worked in Sage 6.2 and possibly broken by the new display hook\n\n```\nsage: var('y')\ny\nsage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),viewer='jmol')  # jmol applet pops up\nsage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),viewer='tachyon') # tachyon-generated png pops up in a viewer\n```\nIf you confirm that this does work properly to generate the filenames in the command line then I'm okay with making sure there are explicit examples that say it doesn't work from the plot command - preferably in the plot command docs!",
    "created_at": "2014-10-31T16:52:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217048",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:24" align="right">comment:24</div>

> > 
> > ```
> > sage: var('y')
> > y
> > sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')
> > sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')
> > ```

> 
> The correct syntax is
> 
> ```
> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1)).show(filename='foo')
> ```

Good to know.  But that sort of proves my point, then, that the documentation (old and new) doesn't tell me that - in this case, because so  many keywords can be passed to the plot and then show up in `show()`.  Such as what worked in Sage 6.2 and possibly broken by the new display hook

```
sage: var('y')
y
sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),viewer='jmol')  # jmol applet pops up
sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),viewer='tachyon') # tachyon-generated png pops up in a viewer
```
If you confirm that this does work properly to generate the filenames in the command line then I'm okay with making sure there are explicit examples that say it doesn't work from the plot command - preferably in the plot command docs!



---

archive/issue_comments_217049.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\n> > Here is something minor but still needing attention. The documentation says\n> > \n> > ```\n> >         -  ``filename`` -- string (default: a temp file); file\n> >            to save the image to\n> > ```\n> > but of course this is now only going to be true in the command line.  Which probably makes sense.\n\n> No, it doesn't make sense. An explicit `filename` should override the default, even in the notebook.\n\nHmm, I guess.  But I don't know that there is any easy way to find files in a cell directory in the notebook - though I guess a good use case is to save it in the `DATA` directory, where it of course shouldn't show up in the cell output.",
    "created_at": "2014-10-31T16:52:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217049",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:25" align="right">comment:25</div>

> > Here is something minor but still needing attention. The documentation says
> > 
> > ```
> >         -  ``filename`` -- string (default: a temp file); file
> >            to save the image to
> > ```
> > but of course this is now only going to be true in the command line.  Which probably makes sense.

> No, it doesn't make sense. An explicit `filename` should override the default, even in the notebook.

Hmm, I guess.  But I don't know that there is any easy way to find files in a cell directory in the notebook - though I guess a good use case is to save it in the `DATA` directory, where it of course shouldn't show up in the cell output.



---

archive/issue_comments_217050.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAny files created in the current directory are picked up by the notebook, so it would actually work!",
    "created_at": "2014-10-31T17:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217050",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

Any files created in the current directory are picked up by the notebook, so it would actually work!



---

archive/issue_comments_217051.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\n> Any files created in the current directory are picked up by the notebook, so it would actually work!\n\nSorry, I wasn't clear.  I meant that the current code in this ticket doesn't allow the filenames, and if one enabled it, it would be kind of useless since there is no access to the cell directory.  My counterexample to that is that one might want to use `filename=DATA+'foo'` or something to put a graphic file in the data directory, though I haven't tested whether this actually works.",
    "created_at": "2014-10-31T17:14:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217051",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:27" align="right">comment:27</div>

> Any files created in the current directory are picked up by the notebook, so it would actually work!

Sorry, I wasn't clear.  I meant that the current code in this ticket doesn't allow the filenames, and if one enabled it, it would be kind of useless since there is no access to the cell directory.  My counterexample to that is that one might want to use `filename=DATA+'foo'` or something to put a graphic file in the data directory, though I haven't tested whether this actually works.



---

archive/issue_comments_217052.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n(never mind)",
    "created_at": "2014-10-31T17:24:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217052",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

(never mind)



---

archive/issue_comments_217053.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@kcrisman](#comment:19):\n> Finally, I don't understand this comment - I'm sorry if I am just thinking inside the box:\n> \n> ```\n>                 # when testing this, modify graphics_filename so that it\n>                 # returns files which don't automatically share a base name,\n>                 # e.g.: \"import random; i = random.randint(0, 10000)\"\n> ```\n> Was this just a \"note to self\" or do you mean that, as a tester, I should actually change `graphics_filename` instead of letting it just keep adding one to base names, or ... ?\n\nDoctests mostly check whether a given file can be created, but to check whether that file displays as intended, you'd use an interactive setup not a doctest. So I envision testers using the notebook to run tests, with no way to programmatically tell whether he is doing tests or something else.\n\nAnd the notebook numbers files by incrementing some counter until they are unique. I.e. starting by `sage0.png` then `sage1.png`. But the critical point here is that the collision detection takes file extensions into account. So if I were to request e.g. a `.foo` file and a `.bar` file, I'd get `sage0.foo` and `sage0.bar` not `sage1.bar`. Usually. Unless `sage0.bar` already exists at the time the graphics file name is requested, in which case I'd get `sage0.foo` but `sage1.bar`.\n\nThe problematic case I had in mind was one where some viewer uses one file name to derive some other file name. So if a viewer were to open `sage0.foo` and *from that name* infer that it also has to open `sage0.bar`, then this would work during test cases, but might fail unexpectedly if a user creates `sage0.bar` in some other code inside the same cell.\n\nI'd like to detect such situations. I'd like to make sure that if there is more than one file required for some viewer, then all file names are stated explicitly somewhere, and not inferred by some extension replacement. And that's the point of the comment. I'd like to break the sequential numbering and replace it by random numbers to ensure that inferred file names would break.\n\nSo yes, anyone who tests a patch that might be affected by the scenario outlined above should, in my opinion, temporarily modify the code of `graphics_filename` to ensure that no file name inference is used. If you can think of a better wording to convey this idea, please let me know. I guess we could also add a link to this comment here, since the whole explanation is too long to put into such a comment, imho.",
    "created_at": "2014-10-31T17:35:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217053",
    "user": "https://github.com/gagern"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@kcrisman](#comment:19):
> Finally, I don't understand this comment - I'm sorry if I am just thinking inside the box:
> 
> ```
>                 # when testing this, modify graphics_filename so that it
>                 # returns files which don't automatically share a base name,
>                 # e.g.: "import random; i = random.randint(0, 10000)"
> ```
> Was this just a "note to self" or do you mean that, as a tester, I should actually change `graphics_filename` instead of letting it just keep adding one to base names, or ... ?

Doctests mostly check whether a given file can be created, but to check whether that file displays as intended, you'd use an interactive setup not a doctest. So I envision testers using the notebook to run tests, with no way to programmatically tell whether he is doing tests or something else.

And the notebook numbers files by incrementing some counter until they are unique. I.e. starting by `sage0.png` then `sage1.png`. But the critical point here is that the collision detection takes file extensions into account. So if I were to request e.g. a `.foo` file and a `.bar` file, I'd get `sage0.foo` and `sage0.bar` not `sage1.bar`. Usually. Unless `sage0.bar` already exists at the time the graphics file name is requested, in which case I'd get `sage0.foo` but `sage1.bar`.

The problematic case I had in mind was one where some viewer uses one file name to derive some other file name. So if a viewer were to open `sage0.foo` and *from that name* infer that it also has to open `sage0.bar`, then this would work during test cases, but might fail unexpectedly if a user creates `sage0.bar` in some other code inside the same cell.

I'd like to detect such situations. I'd like to make sure that if there is more than one file required for some viewer, then all file names are stated explicitly somewhere, and not inferred by some extension replacement. And that's the point of the comment. I'd like to break the sequential numbering and replace it by random numbers to ensure that inferred file names would break.

So yes, anyone who tests a patch that might be affected by the scenario outlined above should, in my opinion, temporarily modify the code of `graphics_filename` to ensure that no file name inference is used. If you can think of a better wording to convey this idea, please let me know. I guess we could also add a link to this comment here, since the whole explanation is too long to put into such a comment, imho.



---

archive/issue_comments_217054.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nIn vanilla (i.e. without this patch) sage-6.4.rc0 in the notebook, when doing\n\n```\ncube(viewer=\"jmol\")\n```\nI get\n\n```\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/cor\\\ne/formatters.py:239: FormatterWarning: Exception in text/plain\nformatter: Jmol failed to create file\n'/tmp/tmpE8eQHg/.jmol_images/sage0-size500.jmol.png', see\n'/home/jdemeyer/.sage/temp/tamiyo/24593/tmp_rBkFiX.txt' for details\n  FormatterWarning,\nNone\n```\n(not the clearest error message) followed by a blank red square.\n\nLooking at the file mentioned for details gives\n\n```\nException in thread \"main\" java.lang.UnsupportedClassVersionError: org/jmol/translation/Jmol/en_GB/Messages_en_GB : Unsupported major.minor version 51.0\n        at java.lang.ClassLoader.defineClass1(Native Method)\n        at java.lang.ClassLoader.defineClass(ClassLoader.java:634)\n        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)\n        at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)\n        at java.net.URLClassLoader.access$000(URLClassLoader.java:73)\n        at java.net.URLClassLoader$1.run(URLClassLoader.java:212)\n        at java.security.AccessController.doPrivileged(Native Method)\n        at java.net.URLClassLoader.findClass(URLClassLoader.java:205)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:321)\n        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)\n        at java.lang.ClassLoader.loadClass(ClassLoader.java:266)\n        at java.lang.Class.forName0(Native Method)\n        at java.lang.Class.forName(Class.java:188)\n        at org.jmol.api.Interface.getInterface(Unknown Source)\n        at org.jmol.i18n.Resource.getResource(Unknown Source)\n        at org.jmol.i18n.GT.addBundle(Unknown Source)\n        at org.jmol.i18n.GT.addBundles(Unknown Source)\n        at org.jmol.i18n.GT.<init>(Unknown Source)\n        at org.jmol.i18n.GT.getTextWrapper(Unknown Source)\n        at org.jmol.i18n.GT._(Unknown Source)\n        at org.openscience.jmol.app.JmolApp.getOptions(Unknown Source)\n        at org.openscience.jmol.app.JmolApp.parseCommandLine(Unknown Source)\n        at org.openscience.jmol.app.JmolData.main(Unknown Source)\n```\nDoes this mean my Java version is too old?",
    "created_at": "2014-10-31T17:42:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217054",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

In vanilla (i.e. without this patch) sage-6.4.rc0 in the notebook, when doing

```
cube(viewer="jmol")
```
I get

```
/usr/local/src/sage-config/local/lib/python2.7/site-packages/IPython/cor\
e/formatters.py:239: FormatterWarning: Exception in text/plain
formatter: Jmol failed to create file
'/tmp/tmpE8eQHg/.jmol_images/sage0-size500.jmol.png', see
'/home/jdemeyer/.sage/temp/tamiyo/24593/tmp_rBkFiX.txt' for details
  FormatterWarning,
None
```
(not the clearest error message) followed by a blank red square.

Looking at the file mentioned for details gives

```
Exception in thread "main" java.lang.UnsupportedClassVersionError: org/jmol/translation/Jmol/en_GB/Messages_en_GB : Unsupported major.minor version 51.0
        at java.lang.ClassLoader.defineClass1(Native Method)
        at java.lang.ClassLoader.defineClass(ClassLoader.java:634)
        at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)
        at java.net.URLClassLoader.defineClass(URLClassLoader.java:277)
        at java.net.URLClassLoader.access$000(URLClassLoader.java:73)
        at java.net.URLClassLoader$1.run(URLClassLoader.java:212)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.net.URLClassLoader.findClass(URLClassLoader.java:205)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:321)
        at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:294)
        at java.lang.ClassLoader.loadClass(ClassLoader.java:266)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Class.java:188)
        at org.jmol.api.Interface.getInterface(Unknown Source)
        at org.jmol.i18n.Resource.getResource(Unknown Source)
        at org.jmol.i18n.GT.addBundle(Unknown Source)
        at org.jmol.i18n.GT.addBundles(Unknown Source)
        at org.jmol.i18n.GT.<init>(Unknown Source)
        at org.jmol.i18n.GT.getTextWrapper(Unknown Source)
        at org.jmol.i18n.GT._(Unknown Source)
        at org.openscience.jmol.app.JmolApp.getOptions(Unknown Source)
        at org.openscience.jmol.app.JmolApp.parseCommandLine(Unknown Source)
        at org.openscience.jmol.app.JmolData.main(Unknown Source)
```
Does this mean my Java version is too old?



---

archive/issue_comments_217055.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3852a0a23966400e02a14512e97e8ae46e45ec2a\">3852a0a</a></td><td><code>Further improve 3d graphics file handling</code></td></tr></table>\n",
    "created_at": "2014-10-31T17:59:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217055",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3852a0a23966400e02a14512e97e8ae46e45ec2a">3852a0a</a></td><td><code>Further improve 3d graphics file handling</code></td></tr></table>




---

archive/issue_comments_217056.json:
```json
{
    "body": "Changed commit from **[`bd1479d`](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d)** to **[`3852a0a`](https://github.com/sagemath/sagetrac-mirror/commit/3852a0a23966400e02a14512e97e8ae46e45ec2a)**",
    "created_at": "2014-10-31T17:59:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217056",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bd1479d`](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d)** to **[`3852a0a`](https://github.com/sagemath/sagetrac-mirror/commit/3852a0a23966400e02a14512e97e8ae46e45ec2a)**



---

archive/issue_comments_217057.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI think this patch should fix the issues mentioned above (apart from Martin's comment which I decided to simply remove, note that doctests also generate random filenames).",
    "created_at": "2014-10-31T17:59:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217057",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">comment:32</div>

I think this patch should fix the issues mentioned above (apart from Martin's comment which I decided to simply remove, note that doctests also generate random filenames).



---

archive/issue_comments_217058.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nThe error in [comment:30] occurs with or without this patch, but I would still like to know what is wrong.",
    "created_at": "2014-10-31T18:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217058",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

The error in [comment:30] occurs with or without this patch, but I would still like to know what is wrong.



---

archive/issue_comments_217059.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nWith this patch, the `filename=` option does work in the notebook.",
    "created_at": "2014-10-31T18:04:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217059",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

With this patch, the `filename=` option does work in the notebook.



---

archive/issue_comments_217060.json:
```json
{
    "body": "Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Karl-Dieter Crisman**",
    "created_at": "2014-10-31T18:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217060",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Jeroen Demeyer** to **Jeroen Demeyer, Karl-Dieter Crisman**



---

archive/issue_events_237914.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-31T18:09:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237914"
}
```



---

archive/issue_events_237915.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-10-31T18:09:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237915"
}
```



---

archive/issue_comments_217061.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\n> The error in [comment:30] occurs with or without this patch, but I would still like to know what is wrong.\n\nThat indicates to me that your notebook instantiation is somehow corrupted and/or the display hook stuff didn't even come through.   Earlier today I had it all working, for example, and now it doesn't even have the extra click boxes in the template, mysteriously.  I'm baffled.   But that shouldn't happen.  Though you may be right about the old java.",
    "created_at": "2014-10-31T19:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217061",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:36" align="right">comment:36</div>

> The error in [comment:30] occurs with or without this patch, but I would still like to know what is wrong.

That indicates to me that your notebook instantiation is somehow corrupted and/or the display hook stuff didn't even come through.   Earlier today I had it all working, for example, and now it doesn't even have the extra click boxes in the template, mysteriously.  I'm baffled.   But that shouldn't happen.  Though you may be right about the old java.



---

archive/issue_comments_217062.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\n\n```\ncube(viewer=\"jmol\")\n```\n> > The error in [comment:30] occurs with or without this patch, but I would still like to know what is wrong.\n\n> That indicates to me that your notebook instantiation is somehow corrupted and/or the display hook stuff didn't even come through.   Earlier today I had it all working, for example, and now it doesn't even have the extra click boxes in the template, mysteriously.  I'm baffled.   But that shouldn't happen.  Though you may be right about the old java.\n\nYeah, I can't replicate this here, though the old java could possible contribute.  What happens if you click on the \"live 3d\" box and then evaluate?  That would bypass java creating the static image.",
    "created_at": "2014-10-31T20:35:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217062",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:37" align="right">comment:37</div>


```
cube(viewer="jmol")
```
> > The error in [comment:30] occurs with or without this patch, but I would still like to know what is wrong.

> That indicates to me that your notebook instantiation is somehow corrupted and/or the display hook stuff didn't even come through.   Earlier today I had it all working, for example, and now it doesn't even have the extra click boxes in the template, mysteriously.  I'm baffled.   But that shouldn't happen.  Though you may be right about the old java.

Yeah, I can't replicate this here, though the old java could possible contribute.  What happens if you click on the "live 3d" box and then evaluate?  That would bypass java creating the static image.



---

archive/issue_comments_217063.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@kcrisman](#comment:37):\n> What happens if you click on the \"live 3d\" box and then evaluate?\n\nWhen enabling \"Load 3-D Live\" I get the horrifying error message (it's Halloween, right?)\n\n```\n/usr/local/src/sage-git/local/lib/python2.7/site-packages/IPython/core/f\\\normatters.py:239: FormatterWarning: Exception in text/plain formatter:\nJmol failed to create file\n'/tmp/tmpJEIc27/.jmol_images/sage0-size500.jmol.png', see\n'/home/jdemeyer/.sage/temp/tamiyo/2874/tmp_IABUbj.txt' for details\n  FormatterWarning,\nNone\n```\nthen some 3d figure which does work nicely, then the sentence \"Right-click to get options menu.\"",
    "created_at": "2014-10-31T21:22:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217063",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@kcrisman](#comment:37):
> What happens if you click on the "live 3d" box and then evaluate?

When enabling "Load 3-D Live" I get the horrifying error message (it's Halloween, right?)

```
/usr/local/src/sage-git/local/lib/python2.7/site-packages/IPython/core/f\
ormatters.py:239: FormatterWarning: Exception in text/plain formatter:
Jmol failed to create file
'/tmp/tmpJEIc27/.jmol_images/sage0-size500.jmol.png', see
'/home/jdemeyer/.sage/temp/tamiyo/2874/tmp_IABUbj.txt' for details
  FormatterWarning,
None
```
then some 3d figure which does work nicely, then the sentence "Right-click to get options menu."



---

archive/issue_comments_217064.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nWhen enabling \"Use java for 3-D\" and not \"Load 3-D Live\" I get a very similar result (with one interesting difference: the right-click menu uses a different font and is in English, with \"Load 3-D Live\" the menu was in Dutch).\n\n(edit: cannot reproduce this anymore, getting a light grey square like in [comment:40])\n(edit2: restarting the browser fixed this again)",
    "created_at": "2014-10-31T21:24:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217064",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

When enabling "Use java for 3-D" and not "Load 3-D Live" I get a very similar result (with one interesting difference: the right-click menu uses a different font and is in English, with "Load 3-D Live" the menu was in Dutch).

(edit: cannot reproduce this anymore, getting a light grey square like in [comment:40])
(edit2: restarting the browser fixed this again)



---

archive/issue_comments_217065.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nWhen enabling both \"Use java for 3-D\" and \"Load 3-D Live\" I get a result similar to [comment:30] except that the blank square is light grey instead of red.",
    "created_at": "2014-10-31T21:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217065",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

When enabling both "Use java for 3-D" and "Load 3-D Live" I get a result similar to [comment:30] except that the blank square is light grey instead of red.



---

archive/issue_comments_217066.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nFor the record, I am using\n\n```\njava version \"1.6.0_31\"\nOpenJDK Runtime Environment (IcedTea6 1.13.3) (Gentoo build 1.6.0_31-b31)\nOpenJDK 64-Bit Server VM (build 23.25-b01, mixed mode)\n```\nand\n\n```\nFirefox ESR 24.8.0\n```",
    "created_at": "2014-10-31T22:00:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217066",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:41" align="right">comment:41</div>

For the record, I am using

```
java version "1.6.0_31"
OpenJDK Runtime Environment (IcedTea6 1.13.3) (Gentoo build 1.6.0_31-b31)
OpenJDK 64-Bit Server VM (build 23.25-b01, mixed mode)
```
and

```
Firefox ESR 24.8.0
```



---

archive/issue_comments_217067.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nI won't have time to look at this over the weekend, nor do I have the jmol/jsmol expertise to diagnose it, but I would recommend putting something about it on the 6.4.rc0 release thread so that Jonathan Gutow sees it.",
    "created_at": "2014-11-01T02:06:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217067",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:42" align="right">comment:42</div>

I won't have time to look at this over the weekend, nor do I have the jmol/jsmol expertise to diagnose it, but I would recommend putting something about it on the 6.4.rc0 release thread so that Jonathan Gutow sees it.



---

archive/issue_comments_217068.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI don't know if anyone has tried it but I removed the patches associated with #17170 from 6.4.r0 and I still have the issue with `viewer='tachyon'` opening a jmol window instead of creating a png. So perhaps someother displayhook-related ticket?",
    "created_at": "2014-11-01T18:48:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217068",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:43" align="right">comment:43</div>

I don't know if anyone has tried it but I removed the patches associated with #17170 from 6.4.r0 and I still have the issue with `viewer='tachyon'` opening a jmol window instead of creating a png. So perhaps someother displayhook-related ticket?



---

archive/issue_comments_217069.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\n> I don't know if anyone has tried it but I removed the patches associated with #17170 from 6.4.r0 and I still have the issue with `viewer='tachyon'` opening a jmol window instead of creating a png. So perhaps someother displayhook-related ticket?\n\nHmm.  Do you know where you first saw this?  (I'm not suggesting you do a full bisection!  Just wondering.)",
    "created_at": "2014-11-03T13:28:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217069",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:44" align="right">comment:44</div>

> I don't know if anyone has tried it but I removed the patches associated with #17170 from 6.4.r0 and I still have the issue with `viewer='tachyon'` opening a jmol window instead of creating a png. So perhaps someother displayhook-related ticket?

Hmm.  Do you know where you first saw this?  (I'm not suggesting you do a full bisection!  Just wondering.)



---

archive/issue_comments_217070.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI've tried to report the things on this ticket not actually related to this ticket to sage-release.  However, now I've forgotten where we were in the review!",
    "created_at": "2014-11-03T13:54:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217070",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:45" align="right">comment:45</div>

I've tried to report the things on this ticket not actually related to this ticket to sage-release.  However, now I've forgotten where we were in the review!



---

archive/issue_comments_217071.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@kcrisman](#comment:45):\n> I've forgotten where we were in the review!\n\nThe commit from [comment:31](#comment:31) seems to deal with all outstanding issues from [comment:19](#comment:19), so if you review that, I believe we should be fine. I guess Jeroen contributed enough that he should be an author as well. Do you want to file a ticket for the dynamic resizing of applets you mentioned in [comment:19](#comment:19)?",
    "created_at": "2014-11-03T14:47:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217071",
    "user": "https://github.com/gagern"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@kcrisman](#comment:45):
> I've forgotten where we were in the review!

The commit from [comment:31](#comment:31) seems to deal with all outstanding issues from [comment:19](#comment:19), so if you review that, I believe we should be fine. I guess Jeroen contributed enough that he should be an author as well. Do you want to file a ticket for the dynamic resizing of applets you mentioned in [comment:19](#comment:19)?



---

archive/issue_comments_217072.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nReplying to [@kcrisman](#comment:44):\n> > I don't know if anyone has tried it but I removed the patches associated with #17170 from 6.4.r0 and I still have the issue with `viewer='tachyon'` opening a jmol window instead of creating a png. So perhaps someother displayhook-related ticket?\n\n> \n> Hmm.  Do you know where you first saw this?  (I'm not suggesting you do a full bisection!  Just wondering.)\n\nI believe on sage-release. But this is not related to this ticket. I only saw your [comment:21](#comment:21) above. It should be addressed somewhere.",
    "created_at": "2014-11-03T16:15:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217072",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:47" align="right">comment:47</div>

Replying to [@kcrisman](#comment:44):
> > I don't know if anyone has tried it but I removed the patches associated with #17170 from 6.4.r0 and I still have the issue with `viewer='tachyon'` opening a jmol window instead of creating a png. So perhaps someother displayhook-related ticket?

> 
> Hmm.  Do you know where you first saw this?  (I'm not suggesting you do a full bisection!  Just wondering.)

I believe on sage-release. But this is not related to this ticket. I only saw your [comment:21](#comment:21) above. It should be addressed somewhere.



---

archive/issue_comments_217073.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@kcrisman](#comment:21):\n> \n> ```\n> sage: var('y')\n> y\n> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')\n> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')\n> ```\n> Note that the second thing pops up a jmol viewer.\n\nThis is now #17284.",
    "created_at": "2014-11-04T07:33:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217073",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@kcrisman](#comment:21):
> 
> ```
> sage: var('y')
> y
> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo')
> sage: plot3d(x^2+y^3,(x,-1,1),(y,-1,1),filename='foo',viewer='tachyon')
> ```
> Note that the second thing pops up a jmol viewer.

This is now #17284.



---

archive/issue_comments_217074.json:
```json
{
    "body": "Changed author from **Martin von Gagern** to **Martin von Gagern, Jeroen Demeyer**",
    "created_at": "2014-11-04T16:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217074",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Martin von Gagern** to **Martin von Gagern, Jeroen Demeyer**



---

archive/issue_comments_217075.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nFor the record: I give positive_review to everything on this ticket not authored by me.",
    "created_at": "2014-11-04T16:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217075",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">comment:49</div>

For the record: I give positive_review to everything on this ticket not authored by me.



---

archive/issue_comments_217076.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nAnd I am happy with everything except I need to look at the very last patch one more time... okay, looks good other than two questions.\n\nQuestion - is this a Python syntax I'm not aware of?\n\n```\ndef show(self, *, filename=None, **kwds):\n```\nIn particular, the extra `*` mystifies me.  (Edit - okay, I found it, but it appears to be Python 3 only?  I believe it works in recent Python 2.x since you used it, but I couldn't find a definitive reference - even the Python reference was ambiguous.)\n\nOh, and maybe add a doctest for [this commit](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d) with the error raised?  Maybe that's too trivial to do... but for some reason the doctest\n\n```\nsage: p.show(viewer='canvas3d')\n```\ndoesn't raise an error, which makes sense because of the code.  But it *also* is now doctested with the [most recent change](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d) you made, despite what you just said earlier that making canvas3d guys was too long!  \n\nSomehow this should be resolved.  I think the best way is to doctest the *creation* of the file, perhaps by setting a one-time flag or something, rather than the error - as long as we tell people that in the command line it will give an error.  (Well, we could doctest both as well!)",
    "created_at": "2014-11-07T17:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217076",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:50" align="right">comment:50</div>

And I am happy with everything except I need to look at the very last patch one more time... okay, looks good other than two questions.

Question - is this a Python syntax I'm not aware of?

```
def show(self, *, filename=None, **kwds):
```
In particular, the extra `*` mystifies me.  (Edit - okay, I found it, but it appears to be Python 3 only?  I believe it works in recent Python 2.x since you used it, but I couldn't find a definitive reference - even the Python reference was ambiguous.)

Oh, and maybe add a doctest for [this commit](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d) with the error raised?  Maybe that's too trivial to do... but for some reason the doctest

```
sage: p.show(viewer='canvas3d')
```
doesn't raise an error, which makes sense because of the code.  But it *also* is now doctested with the [most recent change](https://github.com/sagemath/sagetrac-mirror/commit/bd1479d38fe1adb42755ab92499ff8c1ba35592d) you made, despite what you just said earlier that making canvas3d guys was too long!  

Somehow this should be resolved.  I think the best way is to doctest the *creation* of the file, perhaps by setting a one-time flag or something, rather than the error - as long as we tell people that in the command line it will give an error.  (Well, we could doctest both as well!)



---

archive/issue_events_237916.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-07T17:06:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237916"
}
```



---

archive/issue_events_237917.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-07T17:06:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237917"
}
```



---

archive/issue_comments_217077.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@kcrisman](#comment:50):\n> In particular, the extra `*` mystifies me.  (Edit - okay, I found it, but it appears to be Python 3 only?  I believe it works in recent Python 2.x since you used it, but I couldn't find a definitive reference - even the Python reference was ambiguous.)\n\nThis syntax for keyword-only parameters comes from Python 3 but is supported by Cython even for older versions of Python. In #16607 I suggested support for keyword-only parameters in pure Python code, and there jdemeyer pointed out that Cython support.",
    "created_at": "2014-11-07T17:24:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217077",
    "user": "https://github.com/gagern"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@kcrisman](#comment:50):
> In particular, the extra `*` mystifies me.  (Edit - okay, I found it, but it appears to be Python 3 only?  I believe it works in recent Python 2.x since you used it, but I couldn't find a definitive reference - even the Python reference was ambiguous.)

This syntax for keyword-only parameters comes from Python 3 but is supported by Cython even for older versions of Python. In #16607 I suggested support for keyword-only parameters in pure Python code, and there jdemeyer pointed out that Cython support.



---

archive/issue_comments_217078.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\n> > In particular, the extra `*` mystifies me.  (Edit - okay, I found it, but it appears to be Python 3 only?  I believe it works in recent Python 2.x since you used it, but I couldn't find a definitive reference - even the Python reference was ambiguous.)\n\n> \n> This syntax for keyword-only parameters comes from Python 3 but is supported by Cython even for older versions of Python. In #16607 I suggested support for keyword-only parameters in pure Python code, and there jdemeyer pointed out that Cython support.\n\nAha.\n\n> With this patch, the `filename=` option does work in the notebook.\n\nAnd it really does save to where needed, awesome!  Especially in `DATA` could be useful.\n\n> despite what you just said earlier that making canvas3d guys was too long! \n\nOkay, sorry, I see what you did now - got a little too excited there.  What do you think about testing the warning?\n\nOtherwise this was good teamwork by you two, very nice.",
    "created_at": "2014-11-07T17:26:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217078",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:52" align="right">comment:52</div>

> > In particular, the extra `*` mystifies me.  (Edit - okay, I found it, but it appears to be Python 3 only?  I believe it works in recent Python 2.x since you used it, but I couldn't find a definitive reference - even the Python reference was ambiguous.)

> 
> This syntax for keyword-only parameters comes from Python 3 but is supported by Cython even for older versions of Python. In #16607 I suggested support for keyword-only parameters in pure Python code, and there jdemeyer pointed out that Cython support.

Aha.

> With this patch, the `filename=` option does work in the notebook.

And it really does save to where needed, awesome!  Especially in `DATA` could be useful.

> despite what you just said earlier that making canvas3d guys was too long! 

Okay, sorry, I see what you did now - got a little too excited there.  What do you think about testing the warning?

Otherwise this was good teamwork by you two, very nice.



---

archive/issue_events_237918.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-07T17:26:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237918"
}
```



---

archive/issue_events_237919.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-07T17:26:28Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237919"
}
```



---

archive/issue_comments_217079.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@kcrisman](#comment:52):\n> > despite what you just said earlier that making canvas3d guys was too long! \n\n> Okay, sorry, I see what you did now - got a little too excited there.  What do you think about testing the warning?\n\nI'm too confused, what are you (plural) trying to say here?",
    "created_at": "2014-11-08T10:17:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217079",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@kcrisman](#comment:52):
> > despite what you just said earlier that making canvas3d guys was too long! 

> Okay, sorry, I see what you did now - got a little too excited there.  What do you think about testing the warning?

I'm too confused, what are you (plural) trying to say here?



---

archive/issue_comments_217080.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nHere is the short version:\n> p.show(viewer='canvas3d')\n\nraises an error in the command line but not during doctesting because of the way you wrote the code (creates the file).    Perhaps the warning should also be doctested.",
    "created_at": "2014-11-09T00:37:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217080",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:54" align="right">comment:54</div>

Here is the short version:
> p.show(viewer='canvas3d')

raises an error in the command line but not during doctesting because of the way you wrote the code (creates the file).    Perhaps the warning should also be doctested.



---

archive/issue_comments_217081.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@kcrisman](#comment:54):\n> Perhaps the warning should also be doctested.\n\nThat's possible but requires some messing around with `DOCTEST_MODE`. Given that it's a minor thing and that Volker has plans to change all this code anyway, I feel that it's not worth the trouble. But if you insist, I will add that test.\n\nPS: I assume you mean \"error\", not \"warning\".",
    "created_at": "2014-11-09T13:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217081",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@kcrisman](#comment:54):
> Perhaps the warning should also be doctested.

That's possible but requires some messing around with `DOCTEST_MODE`. Given that it's a minor thing and that Volker has plans to change all this code anyway, I feel that it's not worth the trouble. But if you insist, I will add that test.

PS: I assume you mean "error", not "warning".



---

archive/issue_comments_217082.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\n> > Perhaps the warning should also be doctested.\n\n> That's possible but requires some messing around with `DOCTEST_MODE`. \n\nYes.\n> Given that it's a minor thing and that Volker has plans to change all this code anyway, I feel that it's not worth the trouble. But if you insist, I will add that test.\n\nOk.\n> PS: I assume you mean \"error\", not \"warning\".\n\nYes, though I recall writing both of those a few times and then accidentally closing the browser/getting timed out!",
    "created_at": "2014-11-10T13:23:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217082",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:56" align="right">comment:56</div>

> > Perhaps the warning should also be doctested.

> That's possible but requires some messing around with `DOCTEST_MODE`. 

Yes.
> Given that it's a minor thing and that Volker has plans to change all this code anyway, I feel that it's not worth the trouble. But if you insist, I will add that test.

Ok.
> PS: I assume you mean "error", not "warning".

Yes, though I recall writing both of those a few times and then accidentally closing the browser/getting timed out!



---

archive/issue_events_237920.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-10T13:23:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237920"
}
```



---

archive/issue_events_237921.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-11-10T13:23:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237921"
}
```



---

archive/issue_comments_217083.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nConflicts with 6.4, please merge.",
    "created_at": "2014-11-14T21:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217083",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:57" align="right">comment:57</div>

Conflicts with 6.4, please merge.



---

archive/issue_events_237922.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-14T21:05:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237922"
}
```



---

archive/issue_events_237923.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-14T21:05:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237923"
}
```



---

archive/issue_comments_217084.json:
```json
{
    "body": "Changed commit from **[`3852a0a`](https://github.com/sagemath/sagetrac-mirror/commit/3852a0a23966400e02a14512e97e8ae46e45ec2a)** to **[`e83f839`](https://github.com/sagemath/sagetrac-mirror/commit/e83f839da144e1d90e495b953ef3f5861d341f41)**",
    "created_at": "2014-11-15T09:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217084",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3852a0a`](https://github.com/sagemath/sagetrac-mirror/commit/3852a0a23966400e02a14512e97e8ae46e45ec2a)** to **[`e83f839`](https://github.com/sagemath/sagetrac-mirror/commit/e83f839da144e1d90e495b953ef3f5861d341f41)**



---

archive/issue_comments_217085.json:
```json
{
    "body": "<div id=\"comment:58\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e83f839da144e1d90e495b953ef3f5861d341f41\">e83f839</a></td><td><code>Merge tag '6.4' into ticket/16640</code></td></tr></table>\n",
    "created_at": "2014-11-15T09:56:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217085",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:58"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e83f839da144e1d90e495b953ef3f5861d341f41">e83f839</a></td><td><code>Merge tag '6.4' into ticket/16640</code></td></tr></table>




---

archive/issue_events_237924.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-15T09:57:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237924"
}
```



---

archive/issue_events_237925.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-15T09:57:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237925"
}
```



---

archive/issue_comments_217086.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nDone, the conflict was the removal of a redundant import of `tmp_filename`.",
    "created_at": "2014-11-15T09:57:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217086",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

Done, the conflict was the removal of a redundant import of `tmp_filename`.



---

archive/issue_events_237926.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-15T11:54:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237926"
}
```



---

archive/issue_events_237927.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-15T11:54:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237927"
}
```



---

archive/issue_comments_217087.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\n\n```\nsage -t --long src/sage/repl/display/formatter.py\n**********************************************************************\nFile \"src/sage/repl/display/formatter.py\", line 320, in sage.repl.display.formatter.SageNBTextFormatter.__call__\nFailed example:\n    fmt(FooGraphics())\nExpected:\n    showing graphics\n    ''\nGot:\n    showing graphics\n    doctest:239: FormatterWarning: Exception in text/plain formatter: [Errno 2] No such file or directory: '/nonexistent.png'\n**********************************************************************\n```",
    "created_at": "2014-11-15T11:54:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217087",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>


```
sage -t --long src/sage/repl/display/formatter.py
**********************************************************************
File "src/sage/repl/display/formatter.py", line 320, in sage.repl.display.formatter.SageNBTextFormatter.__call__
Failed example:
    fmt(FooGraphics())
Expected:
    showing graphics
    ''
Got:
    showing graphics
    doctest:239: FormatterWarning: Exception in text/plain formatter: [Errno 2] No such file or directory: '/nonexistent.png'
**********************************************************************
```



---

archive/issue_comments_217088.json:
```json
{
    "body": "Changed commit from **[`e83f839`](https://github.com/sagemath/sagetrac-mirror/commit/e83f839da144e1d90e495b953ef3f5861d341f41)** to **[`034fa58`](https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b)**",
    "created_at": "2014-11-17T09:15:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217088",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e83f839`](https://github.com/sagemath/sagetrac-mirror/commit/e83f839da144e1d90e495b953ef3f5861d341f41)** to **[`034fa58`](https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b)**



---

archive/issue_comments_217089.json:
```json
{
    "body": "<div id=\"comment:61\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b\">034fa58</a></td><td><code>Fix doctest to use existing file</code></td></tr></table>\n",
    "created_at": "2014-11-17T09:15:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217089",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:61"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b">034fa58</a></td><td><code>Fix doctest to use existing file</code></td></tr></table>




---

archive/issue_events_237928.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-17T09:15:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237928"
}
```



---

archive/issue_events_237929.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-17T09:15:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237929"
}
```



---

archive/issue_events_237930.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-17T09:34:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237930"
}
```



---

archive/issue_events_237931.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-17T09:34:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237931"
}
```



---

archive/issue_comments_217090.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/16640)** to **[`034fa58`](https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b)**",
    "created_at": "2014-11-17T21:21:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16640#issuecomment-217090",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/ticket/16640](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/16640)** to **[`034fa58`](https://github.com/sagemath/sagetrac-mirror/commit/034fa58b0051be5db6942a76c06010e15a3d664b)**



---

archive/issue_events_237932.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-17T21:21:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237932"
}
```



---

archive/issue_events_237933.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "f043df692e3c4dd5a9ff451d815d4d96947e7c02",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-11-17T21:21:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16640",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16640#event-237933"
}
```
