# Issue 16390: in src/bin/sage handle -patchbot option earlier

archive/issues_016153.json:
```json
{
    "assignees": [],
    "body": "As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. \n\nvbraun: \"The handling of the -patchbot switch in src/bin/sage needs to be moved above the \"Source sage-env\" step, so it is done before the environment is changed.\"\n\nBranch/Commit: **[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)**\n\nReviewer: **Volker Braun**\n\nAuthor: **Ralf Stephan**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16390_\n\n",
    "closed_at": "2014-06-01T18:23:31Z",
    "created_at": "2014-05-23T09:00:58Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20scripts",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "in src/bin/sage handle -patchbot option earlier",
    "type": "issue",
    "updated_at": "2014-06-01T18:23:31Z",
    "url": "https://github.com/sagemath/sage/issues/16390",
    "user": "https://github.com/rwst"
}
```
As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. 

vbraun: "The handling of the -patchbot switch in src/bin/sage needs to be moved above the "Source sage-env" step, so it is done before the environment is changed."

Branch/Commit: **[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)**

Reviewer: **Volker Braun**

Author: **Ralf Stephan**

_Issue created by migration from https://trac.sagemath.org/ticket/16390_





---

archive/issue_events_208771.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-23T09:00:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208771"
}
```



---

archive/issue_events_208772.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-23T09:00:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20scripts",
    "label_color": "000080",
    "label_name": "component: scripts",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208772"
}
```



---

archive/issue_events_208773.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-23T09:00:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208773"
}
```



---

archive/issue_events_208774.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-23T09:00:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208774"
}
```



---

archive/issue_comments_213965.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n+\n+Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.\n``````\n",
    "created_at": "2014-05-23T09:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213965",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
+
+Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.
``````




---

archive/issue_comments_213966.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n \n-Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.\n+Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.\n``````\n",
    "created_at": "2014-05-23T09:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213966",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
 
-Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.
+Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.
``````




---

archive/issue_events_208775.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-24T06:59:56Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "title_is": "in src/bin/SAGE handle -patchbot option earlier",
    "title_was": "remove -patchbot option to sage",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208775"
}
```



---

archive/issue_comments_213967.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. \n \n-Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.\n+vbraun: \"The handling of the -patchbot switch in src/bin/sage needs to be moved above the \"Source sage-env\" step, so it is done before the environment is changed.\"\n``````\n",
    "created_at": "2014-05-24T06:59:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213967",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and [#16377 comment:11](https://github.com/sagemath/sage/issues/16377#comment:11), patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. 
 
-Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.
+vbraun: "The handling of the -patchbot switch in src/bin/sage needs to be moved above the "Source sage-env" step, so it is done before the environment is changed."
``````




---

archive/issue_comments_213968.json:
```json
{
    "body": "Branch: **[u/rws/in_src_bin_sage_handle__patchbot_option_earlier](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/in_src_bin_sage_handle__patchbot_option_earlier)**",
    "created_at": "2014-05-30T06:57:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213968",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/in_src_bin_sage_handle__patchbot_option_earlier](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/in_src_bin_sage_handle__patchbot_option_earlier)**



---

archive/issue_comments_213969.json:
```json
{
    "body": "Commit: **[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)**",
    "created_at": "2014-05-30T07:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213969",
    "user": "https://github.com/rwst"
}
```

Commit: **[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)**



---

archive/issue_events_208776.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-30T07:12:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208776"
}
```



---

archive/issue_comments_213970.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nThis appears to work and, in conjunction with a fix for the setuptools problem, allows patchbot to test unsafe tickets successfully.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd\">c017fd5</a></td><td><code>16390: move up patchbot handling</code></td></tr></table>\n",
    "created_at": "2014-05-30T07:12:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213970",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'>Comment 5:</a>
This appears to work and, in conjunction with a fix for the setuptools problem, allows patchbot to test unsafe tickets successfully.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd">c017fd5</a></td><td><code>16390: move up patchbot handling</code></td></tr></table>




---

archive/issue_events_208777.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-05-30T07:12:55Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "title_is": "in src/bin/sage handle -patchbot option earlier",
    "title_was": "in src/bin/SAGE handle -patchbot option earlier",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208777"
}
```



---

archive/issue_comments_213971.json:
```json
{
    "body": "Author: **Ralf Stephan**",
    "created_at": "2014-05-30T07:29:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213971",
    "user": "https://github.com/rwst"
}
```

Author: **Ralf Stephan**



---

archive/issue_events_208778.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-30T11:03:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208778"
}
```



---

archive/issue_events_208779.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-30T11:03:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208779"
}
```



---

archive/issue_comments_213972.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2014-05-30T11:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213972",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_213973.json:
```json
{
    "body": "Changed branch from **[u/rws/in_src_bin_sage_handle__patchbot_option_earlier](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/in_src_bin_sage_handle__patchbot_option_earlier)** to **[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)**",
    "created_at": "2014-06-01T18:23:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16390#issuecomment-213973",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/rws/in_src_bin_sage_handle__patchbot_option_earlier](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/in_src_bin_sage_handle__patchbot_option_earlier)** to **[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)**



---

archive/issue_events_208780.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-01T18:23:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208780"
}
```



---

archive/issue_events_208781.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2440c903aef7a8d304170ff58a3c06bbd910fb44",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-06-01T18:23:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16390",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16390#event-208781"
}
```
