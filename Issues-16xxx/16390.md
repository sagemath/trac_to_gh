# Issue 16390: in src/bin/sage handle -patchbot option earlier

archive/issues_016153.json:
```json
{
    "body": "As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. \n\nvbraun: \"The handling of the -patchbot switch in src/bin/sage needs to be moved above the \"Source sage-env\" step, so it is done before the environment is changed.\"\n\nBranch/Commit: c017fd54bd50cc15373ea120adc4938a8d9dfebd\n\nReviewer: Volker Braun\n\nAuthor: Ralf Stephan\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16390\n\n",
    "closed_at": "2014-06-01T18:23:31Z",
    "created_at": "2014-05-23T09:00:58Z",
    "labels": [
        "component: scripts",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "in src/bin/sage handle -patchbot option earlier",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16390",
    "user": "https://github.com/rwst"
}
```
As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. 

vbraun: "The handling of the -patchbot switch in src/bin/sage needs to be moved above the "Source sage-env" step, so it is done before the environment is changed."

Branch/Commit: c017fd54bd50cc15373ea120adc4938a8d9dfebd

Reviewer: Volker Braun

Author: Ralf Stephan

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16390





---

archive/issue_comments_265748.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n+\n+Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.\n``````\n",
    "created_at": "2014-05-23T09:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265748",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
+
+Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.
``````




---

archive/issue_comments_265749.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n \n-Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.\n+Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.\n``````\n",
    "created_at": "2014-05-23T09:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265749",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
 
-Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.
+Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.
``````




---

archive/issue_events_062641.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "rename": {
        "from": "remove -patchbot option to sage",
        "to": "in src/bin/SAGE handle -patchbot option earlier"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16390#event-62641"
}
```



---

archive/issue_comments_265750.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. \n \n-Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.\n+vbraun: \"The handling of the -patchbot switch in src/bin/sage needs to be moved above the \"Source sage-env\" step, so it is done before the environment is changed.\"\n``````\n",
    "created_at": "2014-05-24T06:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265750",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. 
 
-Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.
+vbraun: "The handling of the -patchbot switch in src/bin/sage needs to be moved above the "Source sage-env" step, so it is done before the environment is changed."
``````




---

archive/issue_comments_265751.json:
```json
{
    "body": "Changing branch from \"\" to \"u/rws/in_src_bin_sage_handle__patchbot_option_earlier\"",
    "created_at": "2014-05-30T06:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265751",
    "user": "https://github.com/rwst"
}
```

Changing branch from "" to "u/rws/in_src_bin_sage_handle__patchbot_option_earlier"



---

archive/issue_comments_265752.json:
```json
{
    "body": "Changing commit from \"\" to \"c017fd54bd50cc15373ea120adc4938a8d9dfebd\"",
    "created_at": "2014-05-30T07:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265752",
    "user": "https://github.com/rwst"
}
```

Changing commit from "" to "c017fd54bd50cc15373ea120adc4938a8d9dfebd"



---

archive/issue_comments_265753.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-30T07:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265753",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_265754.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis appears to work and, in conjunction with a fix for the setuptools problem, allows patchbot to test unsafe tickets successfully.\n\n---\nNew commits:\n|                                                                                                                                          |                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|\n|[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)|`16390: move up patchbot handling`|",
    "created_at": "2014-05-30T07:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265754",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>
This appears to work and, in conjunction with a fix for the setuptools problem, allows patchbot to test unsafe tickets successfully.

---
New commits:
|                                                                                                                                          |                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------|
|[c017fd5](https://github.com/sagemath/sagetrac-mirror/commit/c017fd54bd50cc15373ea120adc4938a8d9dfebd)|`16390: move up patchbot handling`|



---

archive/issue_events_062642.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "rename": {
        "from": "in src/bin/SAGE handle -patchbot option earlier",
        "to": "in src/bin/sage handle -patchbot option earlier"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16390#event-62642"
}
```



---

archive/issue_comments_265755.json:
```json
{
    "body": "Changing author from \"\" to \"Ralf Stephan\"",
    "created_at": "2014-05-30T07:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265755",
    "user": "https://github.com/rwst"
}
```

Changing author from "" to "Ralf Stephan"



---

archive/issue_comments_265756.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-30T11:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265756",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_265757.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Volker Braun\"",
    "created_at": "2014-05-30T11:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265757",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "" to "Volker Braun"



---

archive/issue_comments_265758.json:
```json
{
    "body": "Changing branch from \"u/rws/in_src_bin_sage_handle__patchbot_option_earlier\" to \"c017fd54bd50cc15373ea120adc4938a8d9dfebd\"",
    "created_at": "2014-06-01T18:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265758",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/rws/in_src_bin_sage_handle__patchbot_option_earlier" to "c017fd54bd50cc15373ea120adc4938a8d9dfebd"



---

archive/issue_comments_265759.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-01T18:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-265759",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_062643.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-01T18:23:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16390#event-62643"
}
```
