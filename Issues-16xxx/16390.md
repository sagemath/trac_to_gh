# Issue 16390: in src/bin/sage handle -patchbot option earlier

archive/issues_016153.json:
```json
{
    "body": "As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. \n\nvbraun: \"The handling of the -patchbot switch in src/bin/sage needs to be moved above the \"Source sage-env\" step, so it is done before the environment is changed.\"\n\nBranch/Commit: c017fd54bd50cc15373ea120adc4938a8d9dfebd\n\nReviewer: Volker Braun\n\nAuthor: Ralf Stephan\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16390\n\n",
    "closed_at": "2014-06-01T18:23:31Z",
    "created_at": "2014-05-23T09:00:58Z",
    "labels": [
        "component: scripts",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "in src/bin/sage handle -patchbot option earlier",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16390",
    "user": "https://github.com/rwst"
}
```
As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. 

vbraun: "The handling of the -patchbot switch in src/bin/sage needs to be moved above the "Source sage-env" step, so it is done before the environment is changed."

Branch/Commit: c017fd54bd50cc15373ea120adc4938a8d9dfebd

Reviewer: Volker Braun

Author: Ralf Stephan

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16390





---

archive/issue_comments_224593.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n+\n+Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.\n \n Comment: 1\n \n``````\n",
    "created_at": "2014-05-23T09:05:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-224593",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
+
+Moreover, the `README` of `robertwb/patchbot` states to start via `python/ patchbot` maybe for a reason.
 
 Comment: 1
 
``````




---

archive/issue_comments_224594.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.\n \n+Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.\n \n Comment: 1\n \n``````\n",
    "created_at": "2014-05-23T09:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-224594",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation. This ticket will remove that option, as the underlying problem cannot be solved once and for all, i.e., it is possible to take care of known environment variables that affect unsafe patchbot runs, but any new variable will break such a solution.
 
+Moreover, the `README` of `robertwb/patchbot` states to start via `python patchbot.py` maybe for a reason.
 
 Comment: 1
 
``````




---

archive/issue_comments_224595.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. \n \n+vbraun: \"The handling of the -patchbot switch in src/bin/sage needs to be moved above the \"Source sage-env\" step, so it is done before the environment is changed.\"\n \n Comment: 1\n \n``````\n",
    "created_at": "2014-05-24T06:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-224595",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
+As explained in https://github.com/robertwb/sage-patchbot/issues/35 and http://trac.sagemath.org/ticket/16377#comment:11, patchbot when started with `sage -patchbot` will clobber your Sage installation because the environment is changed before patchbot is started. 
 
+vbraun: "The handling of the -patchbot switch in src/bin/sage needs to be moved above the "Source sage-env" step, so it is done before the environment is changed."
 
 Comment: 1
 
``````




---

archive/issue_comments_224596.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-30T07:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-224596",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_224597.json:
```json
{
    "body": "<a id='comment:5'></a>This appears to work and, in conjunction with a fix for the setuptools problem, allows patchbot to test unsafe tickets successfully.\n\n---\nNew commits:",
    "created_at": "2014-05-30T07:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-224597",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>This appears to work and, in conjunction with a fix for the setuptools problem, allows patchbot to test unsafe tickets successfully.

---
New commits:



---

archive/issue_comments_224598.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-30T11:03:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-224598",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_224599.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-01T18:23:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16390#issuecomment-224599",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048249.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-01T18:23:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16390",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16390#event-48249"
}
```
