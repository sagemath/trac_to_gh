# Issue 16702: Raise exceptions when database_gap is not installed

archive/issues_016465.json:
```json
{
    "body": "Before\n\n```\nsage: graphs.ChvatalGraph().automorphism_group().structure_description()\n...\nError, the Small Groups identification is required but not installed\n\n   executing StructureDescription($sage1);\n```\n\n\nAfter\n\n```\nsage: graphs.ChvatalGraph().automorphism_group().structure_description()\n...\nRuntimeError: You must install the optional database_gap package first.\n```\n\nCC:  @dimpase\n\nBranch/Commit: 758dd7577528561d33e13e1a8f5b29d07d72f853\n\nReviewer: Dima Pasechnik\n\nAuthor: Nathann Cohen\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16702\n\n",
    "closed_at": "2014-07-23T14:03:18Z",
    "created_at": "2014-07-22T15:11:47Z",
    "labels": [
        "component: group theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Raise exceptions when database_gap is not installed",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16702",
    "user": "https://github.com/nathanncohen"
}
```
Before

```
sage: graphs.ChvatalGraph().automorphism_group().structure_description()
...
Error, the Small Groups identification is required but not installed

   executing StructureDescription($sage1);
```


After

```
sage: graphs.ChvatalGraph().automorphism_group().structure_description()
...
RuntimeError: You must install the optional database_gap package first.
```

CC:  @dimpase

Branch/Commit: 758dd7577528561d33e13e1a8f5b29d07d72f853

Reviewer: Dima Pasechnik

Author: Nathann Cohen

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16702





---

archive/issue_comments_277734.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277734",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_277735.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,21 @@\n+Before\n \n+```\n+sage: graphs.ChvatalGraph().automorphism_group().structure_description()\n+...\n+Error, the Small Groups identification is required but not installed\n+\n+   executing StructureDescription($sage1);\n+```\n+\n+\n+After\n+\n+```\n+sage: graphs.ChvatalGraph().automorphism_group().structure_description()\n+...\n+RuntimeError: You must install the optional database_gap package first.\n+```\n \n Author: Nathann Cohen\n \n``````\n",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277735",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,21 @@
+Before
 
+```
+sage: graphs.ChvatalGraph().automorphism_group().structure_description()
+...
+Error, the Small Groups identification is required but not installed
+
+   executing StructureDescription($sage1);
+```
+
+
+After
+
+```
+sage: graphs.ChvatalGraph().automorphism_group().structure_description()
+...
+RuntimeError: You must install the optional database_gap package first.
+```
 
 Author: Nathann Cohen
 
``````




---

archive/issue_comments_277736.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277736",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_277737.json:
```json
{
    "body": "Changing commit from \"\" to \"2dbb38d2d5d528971fde504390f903d42969f6ff\"",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277737",
    "user": "https://github.com/nathanncohen"
}
```

Changing commit from "" to "2dbb38d2d5d528971fde504390f903d42969f6ff"



---

archive/issue_comments_277738.json:
```json
{
    "body": "Changing branch from \"\" to \"u/ncohen/16702\"",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277738",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "" to "u/ncohen/16702"



---

archive/issue_comments_277739.json:
```json
{
    "body": "<a id='comment:2'></a>This should be implemented using `try`, I think.",
    "created_at": "2014-07-22T15:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277739",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>This should be implemented using `try`, I think.



---

archive/issue_comments_277740.json:
```json
{
    "body": "<a id='comment:3'></a>I copy/pasted the test which is already used for gap_packages. Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.\n\nNathann",
    "created_at": "2014-07-22T15:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277740",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>I copy/pasted the test which is already used for gap_packages. Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.

Nathann



---

archive/issue_comments_277741.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:3 ncohen]:\n> I copy/pasted the test which is already used for gap_packages. \n\nhave you ever noticed that Sage is full of crappy code, in some places at least ? \n;-)\n\n> Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.\n\n\nI am not saying that inside the exception processing block you should not test for installation of this package.\nBut without `try` your patch is too intrusive.\nThere are ways to extend GAP and/or Sage in place not involving installing Sage packages...",
    "created_at": "2014-07-22T15:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277741",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>Replying to [comment:3 ncohen]:
> I copy/pasted the test which is already used for gap_packages. 

have you ever noticed that Sage is full of crappy code, in some places at least ? 
;-)

> Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.


I am not saying that inside the exception processing block you should not test for installation of this package.
But without `try` your patch is too intrusive.
There are ways to extend GAP and/or Sage in place not involving installing Sage packages...



---

archive/issue_comments_277742.json:
```json
{
    "body": "<a id='comment:5'></a>> I am not saying that inside the exception processing block you should not test for installation of this package.\n> But without `try` your patch is too intrusive.\n\n\nI don't see why, and I don't see what you would write instead.\n\n> There are ways to extend GAP and/or Sage in place not involving installing Sage packages...\n\n\nI don't understand that.\n\nNathann",
    "created_at": "2014-07-22T15:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277742",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>> I am not saying that inside the exception processing block you should not test for installation of this package.
> But without `try` your patch is too intrusive.


I don't see why, and I don't see what you would write instead.

> There are ways to extend GAP and/or Sage in place not involving installing Sage packages...


I don't understand that.

Nathann



---

archive/issue_comments_277743.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 ncohen]:\n> > I am not saying that inside the exception processing block you should not test for installation of this package.\n> > But without `try` your patch is too intrusive.\n\n> \n> I don't see why, and I don't see what you would write instead.\n\n\ne.g.\n\n```\ndef group_id(self):\n        try:\n            return [Integer(n) for n in self._gap_().IdGroup()]\n        except: \n            if not is_package_installed('database_gap'):\n                 raise RuntimeError(\"You must install the optional database_gap package first.\")\n            print \"oops...\"\n            raise\n```\n> \n> > There are ways to extend GAP and/or Sage in place not involving installing Sage packages...\n\n> \n> I don't understand that.\n\n\noften it's just copying some files into `$SAGE_LOCAL/gap` that does the trick.\nThat is, installing GAP packages (see http://gap-system.org/Packages/packages.html) often basically amounts to this.",
    "created_at": "2014-07-22T16:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277743",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>Replying to [comment:5 ncohen]:
> > I am not saying that inside the exception processing block you should not test for installation of this package.
> > But without `try` your patch is too intrusive.

> 
> I don't see why, and I don't see what you would write instead.


e.g.

```
def group_id(self):
        try:
            return [Integer(n) for n in self._gap_().IdGroup()]
        except: 
            if not is_package_installed('database_gap'):
                 raise RuntimeError("You must install the optional database_gap package first.")
            print "oops..."
            raise
```
> 
> > There are ways to extend GAP and/or Sage in place not involving installing Sage packages...

> 
> I don't understand that.


often it's just copying some files into `$SAGE_LOCAL/gap` that does the trick.
That is, installing GAP packages (see http://gap-system.org/Packages/packages.html) often basically amounts to this.



---

archive/issue_comments_277744.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-07-22T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277744",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_277745.json:
```json
{
    "body": "Changing commit from \"2dbb38d2d5d528971fde504390f903d42969f6ff\" to \"758dd7577528561d33e13e1a8f5b29d07d72f853\"",
    "created_at": "2014-07-22T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277745",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2dbb38d2d5d528971fde504390f903d42969f6ff" to "758dd7577528561d33e13e1a8f5b29d07d72f853"



---

archive/issue_comments_277746.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Dima Pasechnik\"",
    "created_at": "2014-07-22T16:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277746",
    "user": "https://github.com/dimpase"
}
```

Changing reviewer from "" to "Dima Pasechnik"



---

archive/issue_comments_277747.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-22T16:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277747",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_277748.json:
```json
{
    "body": "<a id='comment:9'></a>LGTM",
    "created_at": "2014-07-22T16:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277748",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>LGTM



---

archive/issue_comments_277749.json:
```json
{
    "body": "Changing branch from \"u/ncohen/16702\" to \"758dd7577528561d33e13e1a8f5b29d07d72f853\"",
    "created_at": "2014-07-23T14:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277749",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/ncohen/16702" to "758dd7577528561d33e13e1a8f5b29d07d72f853"



---

archive/issue_comments_277750.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-23T14:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-277750",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048942.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-23T14:03:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16702#event-48942"
}
```
