# Issue 16702: Raise exceptions when database_gap is not installed

archive/issues_016465.json:
```json
{
    "body": "Before\n\n```\nsage: graphs.ChvatalGraph().automorphism_group().structure_description()\n...\nError, the Small Groups identification is required but not installed\n\n   executing StructureDescription($sage1);\n```\n\n\nAfter\n\n```\nsage: graphs.ChvatalGraph().automorphism_group().structure_description()\n...\nRuntimeError: You must install the optional database_gap package first.\n```\n\n**CC:**  @dimpase\n\n**Branch/Commit:** [758dd7577528561d33e13e1a8f5b29d07d72f853](https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853)\n\n**Reviewer:** Dima Pasechnik\n\n**Author:** Nathann Cohen\n\nIssue created by migration from https://trac.sagemath.org/ticket/16702\n\n",
    "closed_at": "2014-07-23T14:03:18Z",
    "created_at": "2014-07-22T15:11:47Z",
    "labels": [
        "component: group theory",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Raise exceptions when database_gap is not installed",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16702",
    "user": "https://github.com/nathanncohen"
}
```
Before

```
sage: graphs.ChvatalGraph().automorphism_group().structure_description()
...
Error, the Small Groups identification is required but not installed

   executing StructureDescription($sage1);
```


After

```
sage: graphs.ChvatalGraph().automorphism_group().structure_description()
...
RuntimeError: You must install the optional database_gap package first.
```

**CC:**  @dimpase

**Branch/Commit:** [758dd7577528561d33e13e1a8f5b29d07d72f853](https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853)

**Reviewer:** Dima Pasechnik

**Author:** Nathann Cohen

Issue created by migration from https://trac.sagemath.org/ticket/16702





---

archive/issue_events_152757.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-07-22T15:16:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16702#event-152757"
}
```



---

archive/issue_comments_222358.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1,18 @@\n+Before\n \n+```\n+sage: graphs.ChvatalGraph().automorphism_group().structure_description()\n+...\n+Error, the Small Groups identification is required but not installed\n+\n+   executing StructureDescription($sage1);\n+```\n+\n+\n+After\n+\n+```\n+sage: graphs.ChvatalGraph().automorphism_group().structure_description()\n+...\n+RuntimeError: You must install the optional database_gap package first.\n+```\n``````\n",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222358",
    "user": "https://github.com/nathanncohen"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1,18 @@
+Before
 
+```
+sage: graphs.ChvatalGraph().automorphism_group().structure_description()
+...
+Error, the Small Groups identification is required but not installed
+
+   executing StructureDescription($sage1);
+```
+
+
+After
+
+```
+sage: graphs.ChvatalGraph().automorphism_group().structure_description()
+...
+RuntimeError: You must install the optional database_gap package first.
+```
``````




---

archive/issue_comments_222359.json:
```json
{
    "body": "<a id='comment:1'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2dbb38d2d5d528971fde504390f903d42969f6ff\">2dbb38d</a></td><td><code>trac #16702: Raise exceptions when database_gap is not installed</code></td></tr></table>\n",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222359",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2dbb38d2d5d528971fde504390f903d42969f6ff">2dbb38d</a></td><td><code>trac #16702: Raise exceptions when database_gap is not installed</code></td></tr></table>




---

archive/issue_comments_222360.json:
```json
{
    "body": "**Commit:** [2dbb38d2d5d528971fde504390f903d42969f6ff](https://github.com/sagemath/sagetrac-mirror/commit/2dbb38d2d5d528971fde504390f903d42969f6ff)",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222360",
    "user": "https://github.com/nathanncohen"
}
```

**Commit:** [2dbb38d2d5d528971fde504390f903d42969f6ff](https://github.com/sagemath/sagetrac-mirror/commit/2dbb38d2d5d528971fde504390f903d42969f6ff)



---

archive/issue_comments_222361.json:
```json
{
    "body": "**Branch:** [u/ncohen/16702](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16702)",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222361",
    "user": "https://github.com/nathanncohen"
}
```

**Branch:** [u/ncohen/16702](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16702)



---

archive/issue_comments_222362.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis should be implemented using `try`, I think.",
    "created_at": "2014-07-22T15:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222362",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:2'></a>
This should be implemented using `try`, I think.



---

archive/issue_comments_222363.json:
```json
{
    "body": "<a id='comment:3'></a>\nI copy/pasted the test which is already used for gap_packages. Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.\n\nNathann",
    "created_at": "2014-07-22T15:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222363",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>
I copy/pasted the test which is already used for gap_packages. Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.

Nathann



---

archive/issue_comments_222364.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [ncohen](#comment%3A3):\n> I copy/pasted the test which is already used for gap_packages. \n\nhave you ever noticed that Sage is full of crappy code, in some places at least ? \n;-)\n\n> Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.\n\n\nI am not saying that inside the exception processing block you should not test for installation of this package.\nBut without `try` your patch is too intrusive.\nThere are ways to extend GAP and/or Sage in place not involving installing Sage packages...",
    "created_at": "2014-07-22T15:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222364",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:4'></a>
Replying to [ncohen](#comment%3A3):
> I copy/pasted the test which is already used for gap_packages. 

have you ever noticed that Sage is full of crappy code, in some places at least ? 
;-)

> Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.


I am not saying that inside the exception processing block you should not test for installation of this package.
But without `try` your patch is too intrusive.
There are ways to extend GAP and/or Sage in place not involving installing Sage packages...



---

archive/issue_comments_222365.json:
```json
{
    "body": "<a id='comment:5'></a>\n> I am not saying that inside the exception processing block you should not test for installation of this package.\n> But without `try` your patch is too intrusive.\n\n\nI don't see why, and I don't see what you would write instead.\n\n> There are ways to extend GAP and/or Sage in place not involving installing Sage packages...\n\n\nI don't understand that.\n\nNathann",
    "created_at": "2014-07-22T15:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222365",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>
> I am not saying that inside the exception processing block you should not test for installation of this package.
> But without `try` your patch is too intrusive.


I don't see why, and I don't see what you would write instead.

> There are ways to extend GAP and/or Sage in place not involving installing Sage packages...


I don't understand that.

Nathann



---

archive/issue_comments_222366.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [ncohen](#comment%3A5):\n> > I am not saying that inside the exception processing block you should not test for installation of this package.\n> > But without `try` your patch is too intrusive.\n\n> \n> I don't see why, and I don't see what you would write instead.\n\n\ne.g.\n\n```\ndef group_id(self):\n        try:\n            return [Integer(n) for n in self._gap_().IdGroup()]\n        except: \n            if not is_package_installed('database_gap'):\n                 raise RuntimeError(\"You must install the optional database_gap package first.\")\n            print \"oops...\"\n            raise\n```\n> \n> > There are ways to extend GAP and/or Sage in place not involving installing Sage packages...\n\n> \n> I don't understand that.\n\n\noften it's just copying some files into `$SAGE_LOCAL/gap` that does the trick.\nThat is, installing GAP packages (see http://gap-system.org/Packages/packages.html) often basically amounts to this.",
    "created_at": "2014-07-22T16:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222366",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:6'></a>
Replying to [ncohen](#comment%3A5):
> > I am not saying that inside the exception processing block you should not test for installation of this package.
> > But without `try` your patch is too intrusive.

> 
> I don't see why, and I don't see what you would write instead.


e.g.

```
def group_id(self):
        try:
            return [Integer(n) for n in self._gap_().IdGroup()]
        except: 
            if not is_package_installed('database_gap'):
                 raise RuntimeError("You must install the optional database_gap package first.")
            print "oops..."
            raise
```
> 
> > There are ways to extend GAP and/or Sage in place not involving installing Sage packages...

> 
> I don't understand that.


often it's just copying some files into `$SAGE_LOCAL/gap` that does the trick.
That is, installing GAP packages (see http://gap-system.org/Packages/packages.html) often basically amounts to this.



---

archive/issue_comments_222367.json:
```json
{
    "body": "<a id='comment:7'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853\">758dd75</a></td><td><code>trac #16702: Raise exceptions when database_gap is not installed</code></td></tr></table>\n",
    "created_at": "2014-07-22T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222367",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853">758dd75</a></td><td><code>trac #16702: Raise exceptions when database_gap is not installed</code></td></tr></table>




---

archive/issue_comments_222368.json:
```json
{
    "body": "**Changing commit** from \"[2dbb38d2d5d528971fde504390f903d42969f6ff](https://github.com/sagemath/sagetrac-mirror/commit/2dbb38d2d5d528971fde504390f903d42969f6ff)\" to \"[758dd7577528561d33e13e1a8f5b29d07d72f853](https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853)\".",
    "created_at": "2014-07-22T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222368",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[2dbb38d2d5d528971fde504390f903d42969f6ff](https://github.com/sagemath/sagetrac-mirror/commit/2dbb38d2d5d528971fde504390f903d42969f6ff)" to "[758dd7577528561d33e13e1a8f5b29d07d72f853](https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853)".



---

archive/issue_comments_222369.json:
```json
{
    "body": "**Reviewer:** Dima Pasechnik",
    "created_at": "2014-07-22T16:39:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222369",
    "user": "https://github.com/dimpase"
}
```

**Reviewer:** Dima Pasechnik



---

archive/issue_events_152758.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2014-07-22T16:41:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16702#event-152758"
}
```



---

archive/issue_events_152759.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2014-07-22T16:41:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16702#event-152759"
}
```



---

archive/issue_comments_222370.json:
```json
{
    "body": "<a id='comment:9'></a>\nLGTM",
    "created_at": "2014-07-22T16:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222370",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'></a>
LGTM



---

archive/issue_comments_222371.json:
```json
{
    "body": "**Changing branch** from \"[u/ncohen/16702](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16702)\" to \"[758dd7577528561d33e13e1a8f5b29d07d72f853](https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853)\".",
    "created_at": "2014-07-23T14:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16702#issuecomment-222371",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/ncohen/16702](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16702)" to "[758dd7577528561d33e13e1a8f5b29d07d72f853](https://github.com/sagemath/sagetrac-mirror/commit/758dd7577528561d33e13e1a8f5b29d07d72f853)".



---

archive/issue_events_152760.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-23T14:03:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16702#event-152760"
}
```



---

archive/issue_events_152761.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-23T14:03:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16702",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16702#event-152761"
}
```
