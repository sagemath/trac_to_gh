# Issue 16298: Reenable Sphinx's lookup in the module in find_sage_dangling_links

archive/issues_016061.json:
```json
{
    "body": "IIRC, at some point Sphinx was configured (in find_sage_dangling_links) so that it was possible to reference a class/function/... as soon as it was imported in the module being documented, without having to specify a full path. Apparently this is broken (see e.g. [1]).\n\nThe steps to reproduce should be to put in a file something like:\n\n```\n\"\"\"\n...\n\nSee :class:`Partition_class`\n\"\"\"\n\nfrom sage.combinat.partition import Partition_class\n```\nand relaunch the doc building with --warn-links, and typically\n`dangling_debug = True` in `src.doc.common.conf.py`.\n\n[1] http://trac.sagemath.org/ticket/10963#comment:775\n\n\nCC:  @hivert @jhpalmieri @embray @jdemeyer\n\nBranch/Commit: 492cd729ccb80c7c406352eb256edca059c87b5e\n\nReviewer: Erik Bray\n\nAuthor: John Palmieri\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16298\n\n",
    "closed_at": "2019-01-24T18:18:09Z",
    "created_at": "2014-05-07T01:08:41Z",
    "labels": [
        "component: documentation",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "Reenable Sphinx's lookup in the module in find_sage_dangling_links",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16298",
    "user": "https://github.com/nthiery"
}
```
IIRC, at some point Sphinx was configured (in find_sage_dangling_links) so that it was possible to reference a class/function/... as soon as it was imported in the module being documented, without having to specify a full path. Apparently this is broken (see e.g. [1]).

The steps to reproduce should be to put in a file something like:

```
"""
...

See :class:`Partition_class`
"""

from sage.combinat.partition import Partition_class
```
and relaunch the doc building with --warn-links, and typically
`dangling_debug = True` in `src.doc.common.conf.py`.

[1] http://trac.sagemath.org/ticket/10963#comment:775


CC:  @hivert @jhpalmieri @embray @jdemeyer

Branch/Commit: 492cd729ccb80c7c406352eb256edca059c87b5e

Reviewer: Erik Bray

Author: John Palmieri

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16298





---

archive/issue_events_048037.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2014-05-11T14:29:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48037"
}
```



---

archive/issue_comments_208826.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-21T23:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208826",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_208827.json:
```json
{
    "body": "<a id='comment:2'></a>Here is an attempt at a fix.\n\n---\nNew commits:",
    "created_at": "2014-05-21T23:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208827",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:2'></a>Here is an attempt at a fix.

---
New commits:



---

archive/issue_comments_208828.json:
```json
{
    "body": "<a id='comment:3'></a>Thanks, I'll try this out!\n\nBy the way, a random though (most likely not for this specific ticket): to resolve dandling links we could possibly use the logic behind `import_statement` to lookup stuff anywhere in the Sage library (as long as there is no ambiguity of course).\n\nCheers,\n                                     Nicolas",
    "created_at": "2014-05-22T21:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208828",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:3'></a>Thanks, I'll try this out!

By the way, a random though (most likely not for this specific ticket): to resolve dandling links we could possibly use the logic behind `import_statement` to lookup stuff anywhere in the Sage library (as long as there is no ambiguity of course).

Cheers,
                                     Nicolas



---

archive/issue_events_048038.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48038"
}
```



---

archive/issue_events_048039.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48039"
}
```



---

archive/issue_comments_208829.json:
```json
{
    "body": "<a id='comment:5'></a>doc does not build",
    "created_at": "2015-08-04T18:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208829",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>doc does not build



---

archive/issue_comments_208830.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-04T18:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208830",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_208831.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-04T19:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208831",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_208832.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-04T19:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208832",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_208833.json:
```json
{
    "body": "<a id='comment:7'></a>Does this help?",
    "created_at": "2015-08-04T19:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208833",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:7'></a>Does this help?



---

archive/issue_comments_208834.json:
```json
{
    "body": "<a id='comment:8'></a>I just fixed the pyflakes warning\n\n---\nNew commits:",
    "created_at": "2018-12-03T10:33:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208834",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>I just fixed the pyflakes warning

---
New commits:



---

archive/issue_events_048040.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-03T10:33:28Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48040"
}
```



---

archive/issue_events_048041.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2018-12-03T10:33:28Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48041"
}
```



---

archive/issue_comments_208835.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-07T16:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208835",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_048042.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-07T16:17:10Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "milestone": "sage-8.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48042"
}
```



---

archive/issue_events_048043.json:
```json
{
    "actor": "https://github.com/embray",
    "created_at": "2019-01-07T16:17:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "milestone": "sage-8.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48043"
}
```



---

archive/issue_comments_208836.json:
```json
{
    "body": "<a id='comment:9'></a>Shame this has stalled for so long.",
    "created_at": "2019-01-07T16:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208836",
    "user": "https://github.com/embray"
}
```

<a id='comment:9'></a>Shame this has stalled for so long.



---

archive/issue_comments_208837.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2019-01-16T21:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208837",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_208838.json:
```json
{
    "body": "<a id='comment:10'></a>Documentation build errors out, see patchbot",
    "created_at": "2019-01-16T21:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208838",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>Documentation build errors out, see patchbot



---

archive/issue_comments_208839.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-16T23:27:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208839",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_208840.json:
```json
{
    "body": "<a id='comment:12'></a>Turns out that we need to import `extlinks` from `sage.misc.sagedoc`. I believe this is used by the extension `sphinx.ext.extlinks`, although it is not used explicitly anywhere in the file `conf.py`. (I'm guessing that `pyflakes` may have said to remove that import, but then `pyflakes` would have been wrong.)",
    "created_at": "2019-01-16T23:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208840",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>Turns out that we need to import `extlinks` from `sage.misc.sagedoc`. I believe this is used by the extension `sphinx.ext.extlinks`, although it is not used explicitly anywhere in the file `conf.py`. (I'm guessing that `pyflakes` may have said to remove that import, but then `pyflakes` would have been wrong.)



---

archive/issue_comments_208841.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2019-01-16T23:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208841",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_208842.json:
```json
{
    "body": "<a id='comment:13'></a>`conf.py` contains lots of settings for Sphinx itself and many extensions.  It's not a normal Python module; rather it's imported by Sphinx.  It's just a programmable config file, so most stuff in there is not used \"directly\".  It definitely should be there.",
    "created_at": "2019-01-18T10:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208842",
    "user": "https://github.com/embray"
}
```

<a id='comment:13'></a>`conf.py` contains lots of settings for Sphinx itself and many extensions.  It's not a normal Python module; rather it's imported by Sphinx.  It's just a programmable config file, so most stuff in there is not used "directly".  It definitely should be there.



---

archive/issue_comments_208843.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2019-01-18T10:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208843",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_208844.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:",
    "created_at": "2019-01-18T10:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208844",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. This was a forced push. New commits:



---

archive/issue_comments_208845.json:
```json
{
    "body": "<a id='comment:15'></a>I rebased the branch and squashed out the offending mistake.  In general when fixing regressions that occur within the development of a branch it's best to remove those before setting positive review, so that there aren't broken commits within the commit history (to the extent practical).  Having bad commits in the final history is a pain when doing things like `git bisect` to find where otherwise uncaught regressions were introduced.",
    "created_at": "2019-01-18T10:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208845",
    "user": "https://github.com/embray"
}
```

<a id='comment:15'></a>I rebased the branch and squashed out the offending mistake.  In general when fixing regressions that occur within the development of a branch it's best to remove those before setting positive review, so that there aren't broken commits within the commit history (to the extent practical).  Having bad commits in the final history is a pain when doing things like `git bisect` to find where otherwise uncaught regressions were introduced.



---

archive/issue_comments_208846.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-18T10:37:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208846",
    "user": "https://github.com/embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_208847.json:
```json
{
    "body": "<a id='comment:17'></a>Good point. Thank you for taking care of that.",
    "created_at": "2019-01-18T20:25:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208847",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>Good point. Thank you for taking care of that.



---

archive/issue_comments_208848.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-24T18:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16298#issuecomment-208848",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048044.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-01-24T18:18:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16298",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16298#event-48044"
}
```
