# Issue 16624: upgrade sympy to version 0.7.5

archive/issues_016387.json:
```json
{
    "assignees": [],
    "body": "It's at https://github.com/sympy/sympy/releases/download/sympy-0.7.5/sympy-0.7.5.tar.gz\n\nFor starters the better diophantine solver abilities are needed by #16590\n\nReported as https://github.com/sympy/sympy/issues/8022\n\nCC:  @kiwifb\n\nKeywords: **upgrade, mpmath**\n\nBranch/Commit: **[`e6c24d3`](https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520)**\n\nUpstream: **Reported upstream. Developers acknowledge bug.**\n\nReviewer: **Volker Braun**\n\nAuthor: **Ralf Stephan, Sergey B Kirpichev**\n\nComponent: **packages: standard**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16624_\n\n",
    "closed_at": "2014-11-14T21:01:27Z",
    "created_at": "2014-07-08T09:34:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "upgrade sympy to version 0.7.5",
    "type": "issue",
    "updated_at": "2014-11-14T21:01:27Z",
    "url": "https://github.com/sagemath/sage/issues/16624",
    "user": "https://github.com/rwst"
}
```
It's at https://github.com/sympy/sympy/releases/download/sympy-0.7.5/sympy-0.7.5.tar.gz

For starters the better diophantine solver abilities are needed by #16590

Reported as https://github.com/sympy/sympy/issues/8022

CC:  @kiwifb

Keywords: **upgrade, mpmath**

Branch/Commit: **[`e6c24d3`](https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520)**

Upstream: **Reported upstream. Developers acknowledge bug.**

Reviewer: **Volker Braun**

Author: **Ralf Stephan, Sergey B Kirpichev**

Component: **packages: standard**

_Issue created by migration from https://trac.sagemath.org/ticket/16624_





---

archive/issue_events_238774.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-07-08T09:34:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238774"
}
```



---

archive/issue_events_238775.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-07-08T09:34:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238775"
}
```



---

archive/issue_events_238776.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-07-08T09:34:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238776"
}
```



---

archive/issue_events_238777.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-07-08T09:34:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238777"
}
```



---

archive/issue_comments_216644.json:
```json
{
    "body": "Branch: **[u/rws/upgrade_sympy_to_version_0_7_5](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_sympy_to_version_0_7_5)**",
    "created_at": "2014-07-09T13:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216644",
    "user": "https://github.com/rwst"
}
```

Branch: **[u/rws/upgrade_sympy_to_version_0_7_5](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_sympy_to_version_0_7_5)**



---

archive/issue_comments_216645.json:
```json
{
    "body": "Author: **Ralf Stephan**",
    "created_at": "2014-07-09T13:18:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216645",
    "user": "https://github.com/rwst"
}
```

Author: **Ralf Stephan**



---

archive/issue_comments_216646.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNo idea what's the matter here:\n\n```\nTraceback (most recent call last):\n  File \"/home/ralf/sage/src/bin/sage-runtests\", line 87, in <module>\n    err = DC.run()\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 904, in run\n    self.run_doctests()\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/control.py\", line 674, in run_doctests\n    self.dispatcher = DocTestDispatcher(self)\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1335, in __init__\n    init_sage()\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 113, in init_sage\n    from sympy.printing.pretty.stringpict import stringPict\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sympy/__init__.py\", line 32, in <module>\n    from .core import *\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sympy/core/__init__.py\", line 8, in <module>\n    from .expr import Expr, AtomicExpr\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sympy/core/expr.py\", line 7, in <module>\n    from .evalf import EvalfMixin, pure_complex\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sympy/core/evalf.py\", line 9, in <module>\n    import sympy.mpmath.libmp as libmp\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/__init__.py\", line 6, in <module>\n    from .ctx_mp import MPContext\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/ctx_mp.py\", line 47, in <module>\n    from sage.libs.mpmath.ext_main import Context as BaseMPContext\n  File \"ext_main.pyx\", line 38, in init sage.libs.mpmath.ext_main (build/cythonized/sage/libs/mpmath/ext_main.c:28725)\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/__init__.py\", line 6, in <module>\n    from .ctx_mp import MPContext\n  File \"/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/ctx_mp.py\", line 49, in <module>\n    import sage.libs.mpmath.ext_main as _mpf_module\nAttributeError: 'module' object has no attribute 'ext_main'\nmake: *** [ptestlong] Error 1\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cc6ca3d31c872ecaea8bd7985c8b20ed6c0e03e\"><code>3cc6ca3</code></a></td><td><code>16624: sympy version 0.7.5</code></td></tr></table>\n",
    "created_at": "2014-07-09T13:18:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216646",
    "user": "https://github.com/rwst"
}
```

<div id="comment:2" align="right">comment:2</div>

No idea what's the matter here:

```
Traceback (most recent call last):
  File "/home/ralf/sage/src/bin/sage-runtests", line 87, in <module>
    err = DC.run()
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 904, in run
    self.run_doctests()
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/control.py", line 674, in run_doctests
    self.dispatcher = DocTestDispatcher(self)
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1335, in __init__
    init_sage()
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 113, in init_sage
    from sympy.printing.pretty.stringpict import stringPict
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sympy/__init__.py", line 32, in <module>
    from .core import *
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sympy/core/__init__.py", line 8, in <module>
    from .expr import Expr, AtomicExpr
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sympy/core/expr.py", line 7, in <module>
    from .evalf import EvalfMixin, pure_complex
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sympy/core/evalf.py", line 9, in <module>
    import sympy.mpmath.libmp as libmp
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/__init__.py", line 6, in <module>
    from .ctx_mp import MPContext
  File "/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/ctx_mp.py", line 47, in <module>
    from sage.libs.mpmath.ext_main import Context as BaseMPContext
  File "ext_main.pyx", line 38, in init sage.libs.mpmath.ext_main (build/cythonized/sage/libs/mpmath/ext_main.c:28725)
  File "/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/__init__.py", line 6, in <module>
    from .ctx_mp import MPContext
  File "/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/ctx_mp.py", line 49, in <module>
    import sage.libs.mpmath.ext_main as _mpf_module
AttributeError: 'module' object has no attribute 'ext_main'
make: *** [ptestlong] Error 1
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cc6ca3d31c872ecaea8bd7985c8b20ed6c0e03e"><code>3cc6ca3</code></a></td><td><code>16624: sympy version 0.7.5</code></td></tr></table>




---

archive/issue_comments_216647.json:
```json
{
    "body": "Commit: **[`3cc6ca3`](https://github.com/sagemath/sagetrac-mirror/commit/3cc6ca3d31c872ecaea8bd7985c8b20ed6c0e03e)**",
    "created_at": "2014-07-09T13:18:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216647",
    "user": "https://github.com/rwst"
}
```

Commit: **[`3cc6ca3`](https://github.com/sagemath/sagetrac-mirror/commit/3cc6ca3d31c872ecaea8bd7985c8b20ed6c0e03e)**



---

archive/issue_comments_216648.json:
```json
{
    "body": "Changed commit from **[`3cc6ca3`](https://github.com/sagemath/sagetrac-mirror/commit/3cc6ca3d31c872ecaea8bd7985c8b20ed6c0e03e)** to **[`c280b72`](https://github.com/sagemath/sagetrac-mirror/commit/c280b72b302616eef2d5e0b94848fe8a02af091b)**",
    "created_at": "2014-07-11T07:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216648",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3cc6ca3`](https://github.com/sagemath/sagetrac-mirror/commit/3cc6ca3d31c872ecaea8bd7985c8b20ed6c0e03e)** to **[`c280b72`](https://github.com/sagemath/sagetrac-mirror/commit/c280b72b302616eef2d5e0b94848fe8a02af091b)**



---

archive/issue_comments_216649.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c280b72b302616eef2d5e0b94848fe8a02af091b\"><code>c280b72</code></a></td><td><code>16624: fix import issue</code></td></tr></table>\n",
    "created_at": "2014-07-11T07:59:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216649",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c280b72b302616eef2d5e0b94848fe8a02af091b"><code>c280b72</code></a></td><td><code>16624: fix import issue</code></td></tr></table>




---

archive/issue_comments_216650.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nEven with sympy-0.7.4 in a fresh Sage I get\n\n```\nsage:     import sage.libs.mpmath.ext_main as _mpf_module\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-1-06f00c8c1fbc> in <module>()\n----> 1 import sage.libs.mpmath.ext_main as _mpf_module\n\n/home/ralf/sage/ext_main.pyx in init sage.libs.mpmath.ext_main (build/cythonized/sage/libs/mpmath/ext_main.c:28725)()\n\n/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/__init__.py in <module>()\n      4 \n      5 from .ctx_fp import FPContext\n----> 6 from .ctx_mp import MPContext\n      7 from .ctx_iv import MPIntervalContext\n      8 \n\n/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/ctx_mp.py in <module>()\n     47     from sage.libs.mpmath.ext_main import Context as BaseMPContext\n     48     # pickle hack\n---> 49     import sage.libs.mpmath.ext_main as _mpf_module\n     50 else:\n     51     from .ctx_mp_python import PythonMPContext as BaseMPContext\n\nAttributeError: 'module' object has no attribute 'ext_main'\n```\nThis and the 0.7.5 failure both can be cured for example with\n\n```\n--- mpmath/libmp/backend.py~    2013-08-08 14:49:58.000000000 +0200\n+++ mpmath/libmp/backend.py     2014-07-11 08:54:28.759388954 +0200\n@@ -71,6 +71,7 @@\n     try:\n         import sage.all\n         import sage.libs.mpmath.utils as _sage_utils\n+        import sage.libs.mpmath.ext_main as _mpf_module\n         sage = sage.all\n         sage_utils = _sage_utils\n         BACKEND = 'sage'\n```\nSo it seems `ext_main` has to be imported in the right place and there was somewhere an import in `sympy-0.7.4` that made that version work but that was changed in `0.7.5`. It does not work to simply catch the error and import again, while it works when in a fresh Sage with `0.7.4`.",
    "created_at": "2014-07-11T08:00:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216650",
    "user": "https://github.com/rwst"
}
```

<div id="comment:4" align="right">comment:4</div>

Even with sympy-0.7.4 in a fresh Sage I get

```
sage:     import sage.libs.mpmath.ext_main as _mpf_module
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-1-06f00c8c1fbc> in <module>()
----> 1 import sage.libs.mpmath.ext_main as _mpf_module

/home/ralf/sage/ext_main.pyx in init sage.libs.mpmath.ext_main (build/cythonized/sage/libs/mpmath/ext_main.c:28725)()

/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/__init__.py in <module>()
      4 
      5 from .ctx_fp import FPContext
----> 6 from .ctx_mp import MPContext
      7 from .ctx_iv import MPIntervalContext
      8 

/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/ctx_mp.py in <module>()
     47     from sage.libs.mpmath.ext_main import Context as BaseMPContext
     48     # pickle hack
---> 49     import sage.libs.mpmath.ext_main as _mpf_module
     50 else:
     51     from .ctx_mp_python import PythonMPContext as BaseMPContext

AttributeError: 'module' object has no attribute 'ext_main'
```
This and the 0.7.5 failure both can be cured for example with

```
--- mpmath/libmp/backend.py~    2013-08-08 14:49:58.000000000 +0200
+++ mpmath/libmp/backend.py     2014-07-11 08:54:28.759388954 +0200
@@ -71,6 +71,7 @@
     try:
         import sage.all
         import sage.libs.mpmath.utils as _sage_utils
+        import sage.libs.mpmath.ext_main as _mpf_module
         sage = sage.all
         sage_utils = _sage_utils
         BACKEND = 'sage'
```
So it seems `ext_main` has to be imported in the right place and there was somewhere an import in `sympy-0.7.4` that made that version work but that was changed in `0.7.5`. It does not work to simply catch the error and import again, while it works when in a fresh Sage with `0.7.4`.



---

archive/issue_events_238778.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238778"
}
```



---

archive/issue_events_238779.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238779"
}
```



---

archive/issue_comments_216651.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe whole thing seems to go in circle. I am wondering if the real problem is that first a function is imported from ext_main\n\n```\n/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/ctx_mp.py in <module>()\n     47     from sage.libs.mpmath.ext_main import Context as BaseMPContext\n```\nand then you want to import the whole ext_main\n\n```\n     48     # pickle hack\n---> 49     import sage.libs.mpmath.ext_main as _mpf_module\n```\nI wonder what they mean by pickle hack? Presumably if we add the import in backend.py the import in ctx_mp.py becomes redundant?",
    "created_at": "2014-08-12T22:01:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216651",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:7" align="right">comment:7</div>

The whole thing seems to go in circle. I am wondering if the real problem is that first a function is imported from ext_main

```
/home/ralf/sage/local/lib/python2.7/site-packages/mpmath/ctx_mp.py in <module>()
     47     from sage.libs.mpmath.ext_main import Context as BaseMPContext
```
and then you want to import the whole ext_main

```
     48     # pickle hack
---> 49     import sage.libs.mpmath.ext_main as _mpf_module
```
I wonder what they mean by pickle hack? Presumably if we add the import in backend.py the import in ctx_mp.py becomes redundant?



---

archive/issue_comments_216652.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI tried this patch but the results are the same:\n\n```\ndiff --git a/build/pkgs/sympy/patches/import-extmain.patch b/build/pkgs/sympy/patches/import-extmain.patch\nnew file mode 100644\nindex 0000000..af222c1\n--- /dev/null\n+++ b/build/pkgs/sympy/patches/import-extmain.patch\n@@ -0,0 +1,15 @@\n+--- sympy/mpmath/ctx_mp.py~   2014-02-22 20:13:32.000000000 +0100\n++++ sympy/mpmath/ctx_mp.py    2014-09-11 18:09:11.877599866 +0200\n+@@ -44,9 +44,9 @@\n+                          r'(?P<im>[\\+\\-]?\\d*\\.?\\d*(e[\\+\\-]?\\d+)?j)?\\)?$')\n+ \n+ if BACKEND == 'sage':\n+-    from sage.libs.mpmath.ext_main import Context as BaseMPContext\n+     # pickle hack\n+-    import sage.libs.mpmath.ext_main as _mpf_module\n++    from sage.libs.mpmath import ext_main as _mpf_module\n++    from sage.libs.mpmath.ext_main import Context as BaseMPContext\n+ else:\n+     from .ctx_mp_python import PythonMPContext as BaseMPContext\n+     from . import ctx_mp_python as _mpf_module\n+\n```\nTo be specific, at the moment it's not possible to import anything from sympy. What happens is that at the first attempt the following is raised:\n\n```\n----> 1 from sympy import sympify\n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/__init__.py in <module>()\n     33 from .logic import *\n     34 from .assumptions import *\n---> 35 from .polys import *\n     36 from .series import *\n     37 from .functions import *\n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/__init__.py in <module>()\n      3 __all__ = []\n      4 \n----> 5 from . import polytools\n      6 __all__.extend(polytools.__all__)\n      7 from .polytools import *\n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/polytools.py in <module>()                                                                                      \n     50 import sympy.mpmath\n     51 \n---> 52 from sympy.polys.domains import FF, QQ\n     53 from sympy.polys.constructor import construct_domain\n     54 \n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/__init__.py in <module>()\n     76 QQ_gmpy = GMPYRationalField\n     77 \n---> 78 RR = RealField()\n     79 CC = ComplexField()\n     80 \n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/realfield.py in __init__(self, prec, dps, tol)\n     52 \n     53         self.dtype = context.mpf\n---> 54         self.zero = self.dtype(0)\n     55         self.one = self.dtype(1)\n     56 \n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/ctx_mp_python.py in __new__(cls, val, **kwargs)\n     75         else:\n     76             v = new(cls)\n---> 77             v._mpf_ = mpf_pos(cls.mpf_convert_arg(val, prec, rounding), prec, rounding)\n     78             return v\n     79 \n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/mpelements.py in _set_mpf(self, val)\n     23         tol = self.context.tol\n     24 \n---> 25         if mpf_lt(mpf_abs(val, prec, rounding), tol):\n     26             self.__mpf__ = fzero\n     27         else:\n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/libmp/libmpf.py in mpf_abs(s, prec, rnd)\n    662             return (0, man, exp, bc)\n    663         return s\n--> 664     return normalize1(0, man, exp, bc, prec, rnd)\n    665 \n    666 def mpf_sign(s):\n\nTypeError: Argument 'man' has incorrect type (expected sage.rings.integer.Integer, got long)\n```\nand at any further attempt this one:\n\n```\n----> 1 from sympy.solvers.diophantine import *\n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/__init__.py in <module>()\n     33 from .logic import *\n     34 from .assumptions import *\n---> 35 from .polys import *\n     36 from .series import *\n     37 from .functions import *\n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/__init__.py in <module>()\n      3 __all__ = []\n      4 \n----> 5 from . import polytools\n      6 __all__.extend(polytools.__all__)\n      7 from .polytools import *\n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/polytools.py in <module>()                                                                                      \n     50 import sympy.mpmath\n     51 \n---> 52 from sympy.polys.domains import FF, QQ\n     53 from sympy.polys.constructor import construct_domain\n     54 \n\n/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/__init__.py in <module>()\n      3 __all__ = []\n      4 \n----> 5 from . import domain\n      6 __all__.extend(domain.__all__)\n      7 from .domain import *\n\nImportError: cannot import name domain\n```",
    "created_at": "2014-09-12T07:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216652",
    "user": "https://github.com/rwst"
}
```

<div id="comment:8" align="right">comment:8</div>

I tried this patch but the results are the same:

```
diff --git a/build/pkgs/sympy/patches/import-extmain.patch b/build/pkgs/sympy/patches/import-extmain.patch
new file mode 100644
index 0000000..af222c1
--- /dev/null
+++ b/build/pkgs/sympy/patches/import-extmain.patch
@@ -0,0 +1,15 @@
+--- sympy/mpmath/ctx_mp.py~   2014-02-22 20:13:32.000000000 +0100
++++ sympy/mpmath/ctx_mp.py    2014-09-11 18:09:11.877599866 +0200
+@@ -44,9 +44,9 @@
+                          r'(?P<im>[\+\-]?\d*\.?\d*(e[\+\-]?\d+)?j)?\)?$')
+ 
+ if BACKEND == 'sage':
+-    from sage.libs.mpmath.ext_main import Context as BaseMPContext
+     # pickle hack
+-    import sage.libs.mpmath.ext_main as _mpf_module
++    from sage.libs.mpmath import ext_main as _mpf_module
++    from sage.libs.mpmath.ext_main import Context as BaseMPContext
+ else:
+     from .ctx_mp_python import PythonMPContext as BaseMPContext
+     from . import ctx_mp_python as _mpf_module
+
```
To be specific, at the moment it's not possible to import anything from sympy. What happens is that at the first attempt the following is raised:

```
----> 1 from sympy import sympify

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/__init__.py in <module>()
     33 from .logic import *
     34 from .assumptions import *
---> 35 from .polys import *
     36 from .series import *
     37 from .functions import *

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/__init__.py in <module>()
      3 __all__ = []
      4 
----> 5 from . import polytools
      6 __all__.extend(polytools.__all__)
      7 from .polytools import *

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/polytools.py in <module>()                                                                                      
     50 import sympy.mpmath
     51 
---> 52 from sympy.polys.domains import FF, QQ
     53 from sympy.polys.constructor import construct_domain
     54 

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/__init__.py in <module>()
     76 QQ_gmpy = GMPYRationalField
     77 
---> 78 RR = RealField()
     79 CC = ComplexField()
     80 

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/realfield.py in __init__(self, prec, dps, tol)
     52 
     53         self.dtype = context.mpf
---> 54         self.zero = self.dtype(0)
     55         self.one = self.dtype(1)
     56 

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/ctx_mp_python.py in __new__(cls, val, **kwargs)
     75         else:
     76             v = new(cls)
---> 77             v._mpf_ = mpf_pos(cls.mpf_convert_arg(val, prec, rounding), prec, rounding)
     78             return v
     79 

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/mpelements.py in _set_mpf(self, val)
     23         tol = self.context.tol
     24 
---> 25         if mpf_lt(mpf_abs(val, prec, rounding), tol):
     26             self.__mpf__ = fzero
     27         else:

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/mpmath/libmp/libmpf.py in mpf_abs(s, prec, rnd)
    662             return (0, man, exp, bc)
    663         return s
--> 664     return normalize1(0, man, exp, bc, prec, rnd)
    665 
    666 def mpf_sign(s):

TypeError: Argument 'man' has incorrect type (expected sage.rings.integer.Integer, got long)
```
and at any further attempt this one:

```
----> 1 from sympy.solvers.diophantine import *

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/__init__.py in <module>()
     33 from .logic import *
     34 from .assumptions import *
---> 35 from .polys import *
     36 from .series import *
     37 from .functions import *

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/__init__.py in <module>()
      3 __all__ = []
      4 
----> 5 from . import polytools
      6 __all__.extend(polytools.__all__)
      7 from .polytools import *

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/polytools.py in <module>()                                                                                      
     50 import sympy.mpmath
     51 
---> 52 from sympy.polys.domains import FF, QQ
     53 from sympy.polys.constructor import construct_domain
     54 

/home/ralf/sage/local/lib/python2.7/site-packages/sympy/polys/domains/__init__.py in <module>()
      3 __all__ = []
      4 
----> 5 from . import domain
      6 __all__.extend(domain.__all__)
      7 from .domain import *

ImportError: cannot import name domain
```



---

archive/issue_events_238780.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-09-12T08:15:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238780"
}
```



---

archive/issue_comments_216653.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,5 @@\n It's at https://github.com/sympy/sympy/releases/download/sympy-0.7.5/sympy-0.7.5.tar.gz\n \n For starters the better diophantine solver abilities are needed by #16590\n+\n+Reported as https://github.com/sympy/sympy/issues/8022\n``````\n",
    "created_at": "2014-09-12T08:15:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216653",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,5 @@
 It's at https://github.com/sympy/sympy/releases/download/sympy-0.7.5/sympy-0.7.5.tar.gz
 
 For starters the better diophantine solver abilities are needed by #16590
+
+Reported as https://github.com/sympy/sympy/issues/8022
``````




---

archive/issue_comments_216654.json:
```json
{
    "body": "Upstream: **Reported upstream. No feedback yet.**",
    "created_at": "2014-09-12T08:15:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216654",
    "user": "https://github.com/rwst"
}
```

Upstream: **Reported upstream. No feedback yet.**



---

archive/issue_comments_216655.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nAttachment: **[0001-Update-the-sympy-package.patch.gz](https://github.com/sagemath/sage/files/ticket16624/0001-Update-the-sympy-package.patch.gz)**\n\nIf you include patch to unbundle mpmath (see attached patch) - it will solve your problem.",
    "created_at": "2014-09-30T16:14:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216655",
    "user": "https://github.com/skirpichev"
}
```

<div id="comment:10" align="right">comment:10</div>

Attachment: **[0001-Update-the-sympy-package.patch.gz](https://github.com/sagemath/sage/files/ticket16624/0001-Update-the-sympy-package.patch.gz)**

If you include patch to unbundle mpmath (see attached patch) - it will solve your problem.



---

archive/issue_comments_216656.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2014-09-30T16:16:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216656",
    "user": "https://github.com/skirpichev"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_events_238781.json:
```json
{
    "actor": "https://github.com/skirpichev",
    "created_at": "2014-09-30T16:16:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238781"
}
```



---

archive/issue_events_238782.json:
```json
{
    "actor": "https://github.com/skirpichev",
    "created_at": "2014-09-30T16:16:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238782"
}
```



---

archive/issue_comments_216657.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@skirpichev](#comment:10):\n> If you include patch to unbundle mpmath (see attached patch) - it will solve your problem.\n\nI am a bit surprised by this assertion. Gentoo and by extension sage-on-gentoo unbundle mpmath (I was the person who introduced unbundling of mpmath from sympy on Gentoo). Yet I can see this bug with sympy 0.7.4.1 and mpmath 0.19. Your patch must do something else apart from unbundling.",
    "created_at": "2014-10-02T08:50:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216657",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@skirpichev](#comment:10):
> If you include patch to unbundle mpmath (see attached patch) - it will solve your problem.

I am a bit surprised by this assertion. Gentoo and by extension sage-on-gentoo unbundle mpmath (I was the person who introduced unbundling of mpmath from sympy on Gentoo). Yet I can see this bug with sympy 0.7.4.1 and mpmath 0.19. Your patch must do something else apart from unbundling.



---

archive/issue_comments_216658.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n> I am a bit surprised by this assertion.\n\nIt does work for me.  Can you reproduce the bug with this patch?\n\n> Gentoo and by extension sage-on-gentoo unbundle mpmath\n\nThis:\nhttp://dev.gentoo.org/~bicatali/distfiles/sympy-0.7.4.1-system-mpmath.patch.gz\n?\n\nPerhaps, it's wrong patch and it just break sympy.  Can you post the traceback for failure in this version?\n\n> Your patch must do something else apart from unbundling.\n\nSure.  \"Something else\" - SPKG.txt changes (e.g. Homepage field, changelog and so on).  But the only real change is unbundling mpmath.",
    "created_at": "2014-10-02T10:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216658",
    "user": "https://github.com/skirpichev"
}
```

<div id="comment:13" align="right">comment:13</div>

> I am a bit surprised by this assertion.

It does work for me.  Can you reproduce the bug with this patch?

> Gentoo and by extension sage-on-gentoo unbundle mpmath

This:
http://dev.gentoo.org/~bicatali/distfiles/sympy-0.7.4.1-system-mpmath.patch.gz
?

Perhaps, it's wrong patch and it just break sympy.  Can you post the traceback for failure in this version?

> Your patch must do something else apart from unbundling.

Sure.  "Something else" - SPKG.txt changes (e.g. Homepage field, changelog and so on).  But the only real change is unbundling mpmath.



---

archive/issue_comments_216659.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nYour big patch is unreadable - too big. most of it is the removal of mpmath sources from sympy. This could be achieved in spkg-src by doing a \"rm -rf\" in the appropriate place. Once that's out of the way we can look at the patch to do the rest and it won't be 2.1MB and we'll be able to see something.",
    "created_at": "2014-10-03T02:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216659",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:14" align="right">comment:14</div>

Your big patch is unreadable - too big. most of it is the removal of mpmath sources from sympy. This could be achieved in spkg-src by doing a "rm -rf" in the appropriate place. Once that's out of the way we can look at the patch to do the rest and it won't be 2.1MB and we'll be able to see something.



---

archive/issue_comments_216660.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nIt looks like the only file not being deleted is `mpmath/tests/__init__.py`.",
    "created_at": "2014-10-03T08:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216660",
    "user": "https://github.com/rwst"
}
```

<div id="comment:15" align="right">comment:15</div>

It looks like the only file not being deleted is `mpmath/tests/__init__.py`.



---

archive/issue_comments_216661.json:
```json
{
    "body": "Changed commit from **[`c280b72`](https://github.com/sagemath/sagetrac-mirror/commit/c280b72b302616eef2d5e0b94848fe8a02af091b)** to none",
    "created_at": "2014-10-03T08:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216661",
    "user": "https://github.com/rwst"
}
```

Changed commit from **[`c280b72`](https://github.com/sagemath/sagetrac-mirror/commit/c280b72b302616eef2d5e0b94848fe8a02af091b)** to none



---

archive/issue_comments_216662.json:
```json
{
    "body": "Changed branch from **[u/rws/upgrade_sympy_to_version_0_7_5](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_sympy_to_version_0_7_5)** to **[public/sympy075](https://github.com/sagemath/sagetrac-mirror/tree/public/sympy075)**",
    "created_at": "2014-10-03T08:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216662",
    "user": "https://github.com/rwst"
}
```

Changed branch from **[u/rws/upgrade_sympy_to_version_0_7_5](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/upgrade_sympy_to_version_0_7_5)** to **[public/sympy075](https://github.com/sagemath/sagetrac-mirror/tree/public/sympy075)**



---

archive/issue_comments_216663.json:
```json
{
    "body": "Changed author from **Ralf Stephan** to **Ralf Stephan, Sergey B Kirpichev**",
    "created_at": "2014-10-03T08:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216663",
    "user": "https://github.com/rwst"
}
```

Changed author from **Ralf Stephan** to **Ralf Stephan, Sergey B Kirpichev**



---

archive/issue_comments_216664.json:
```json
{
    "body": "Changed keywords from none to **upgrade, mpmath**",
    "created_at": "2014-10-03T08:09:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216664",
    "user": "https://github.com/rwst"
}
```

Changed keywords from none to **upgrade, mpmath**



---

archive/issue_comments_216665.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63650730577e933ba984669ee1fd1f5eba3a2fef\"><code>6365073</code></a></td><td><code>shortened patch</code></td></tr></table>\n",
    "created_at": "2014-10-03T09:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216665",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63650730577e933ba984669ee1fd1f5eba3a2fef"><code>6365073</code></a></td><td><code>shortened patch</code></td></tr></table>




---

archive/issue_comments_216666.json:
```json
{
    "body": "Commit: **[`6365073`](https://github.com/sagemath/sagetrac-mirror/commit/63650730577e933ba984669ee1fd1f5eba3a2fef)**",
    "created_at": "2014-10-03T09:51:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216666",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`6365073`](https://github.com/sagemath/sagetrac-mirror/commit/63650730577e933ba984669ee1fd1f5eba3a2fef)**



---

archive/issue_comments_216667.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nMore can be deleted (mpmath docs). This passes `make ptestlong`.",
    "created_at": "2014-10-03T09:52:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216667",
    "user": "https://github.com/rwst"
}
```

<div id="comment:17" align="right">comment:17</div>

More can be deleted (mpmath docs). This passes `make ptestlong`.



---

archive/issue_comments_216668.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04d8d622e6803810d5a64826e57f4cc7f74b83eb\"><code>04d8d62</code></a></td><td><code>remove doc/src/modules/mpmath from patch; remove files via spkg-install</code></td></tr></table>\n",
    "created_at": "2014-10-03T13:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216668",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04d8d622e6803810d5a64826e57f4cc7f74b83eb"><code>04d8d62</code></a></td><td><code>remove doc/src/modules/mpmath from patch; remove files via spkg-install</code></td></tr></table>




---

archive/issue_comments_216669.json:
```json
{
    "body": "Changed commit from **[`6365073`](https://github.com/sagemath/sagetrac-mirror/commit/63650730577e933ba984669ee1fd1f5eba3a2fef)** to **[`04d8d62`](https://github.com/sagemath/sagetrac-mirror/commit/04d8d622e6803810d5a64826e57f4cc7f74b83eb)**",
    "created_at": "2014-10-03T13:06:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216669",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6365073`](https://github.com/sagemath/sagetrac-mirror/commit/63650730577e933ba984669ee1fd1f5eba3a2fef)** to **[`04d8d62`](https://github.com/sagemath/sagetrac-mirror/commit/04d8d622e6803810d5a64826e57f4cc7f74b83eb)**



---

archive/issue_comments_216670.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\n\n```\n build/pkgs/sympy/patches/01_no-mpmath.patch | 841 +++++++++++++++++++++++++++++++++++\n```\nNow that's more like it. Please review.",
    "created_at": "2014-10-03T13:08:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216670",
    "user": "https://github.com/rwst"
}
```

<div id="comment:19" align="right">comment:19</div>


```
 build/pkgs/sympy/patches/01_no-mpmath.patch | 841 +++++++++++++++++++++++++++++++++++
```
Now that's more like it. Please review.



---

archive/issue_comments_216671.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n> Your big patch is unreadable - too big.\n\nIt's upstream patch.  Does it harm your patch utility, what's wrong?)\n\nI don't see points to modify it, unless you want break this patch just like gentoo one...\n\n> remove files via spkg-install\n\nremove sympy/mpmath/tests/__init__.py too",
    "created_at": "2014-10-03T18:22:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216671",
    "user": "https://github.com/skirpichev"
}
```

<div id="comment:20" align="right">comment:20</div>

> Your big patch is unreadable - too big.

It's upstream patch.  Does it harm your patch utility, what's wrong?)

I don't see points to modify it, unless you want break this patch just like gentoo one...

> remove files via spkg-install

remove sympy/mpmath/tests/__init__.py too



---

archive/issue_comments_216672.json:
```json
{
    "body": "Changed commit from **[`04d8d62`](https://github.com/sagemath/sagetrac-mirror/commit/04d8d622e6803810d5a64826e57f4cc7f74b83eb)** to **[`4c9f288`](https://github.com/sagemath/sagetrac-mirror/commit/4c9f288dd8b571fdda9dc31906a552483b9e2afd)**",
    "created_at": "2014-10-04T12:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216672",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`04d8d62`](https://github.com/sagemath/sagetrac-mirror/commit/04d8d622e6803810d5a64826e57f4cc7f74b83eb)** to **[`4c9f288`](https://github.com/sagemath/sagetrac-mirror/commit/4c9f288dd8b571fdda9dc31906a552483b9e2afd)**



---

archive/issue_comments_216673.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4c9f288dd8b571fdda9dc31906a552483b9e2afd\"><code>4c9f288</code></a></td><td><code>16624: remove mpmath/tests/__init__.py too</code></td></tr></table>\n",
    "created_at": "2014-10-04T12:57:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216673",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4c9f288dd8b571fdda9dc31906a552483b9e2afd"><code>4c9f288</code></a></td><td><code>16624: remove mpmath/tests/__init__.py too</code></td></tr></table>




---

archive/issue_comments_216674.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nlgtm",
    "created_at": "2014-11-02T17:29:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216674",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:22" align="right">comment:22</div>

lgtm



---

archive/issue_events_238783.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-02T17:29:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238783"
}
```



---

archive/issue_events_238784.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-02T17:29:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238784"
}
```



---

archive/issue_comments_216675.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2014-11-02T17:29:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216675",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_216676.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nWhen applying patches, please use the code from\n[http://www.sagemath.org/doc/developer/packaging.html#patching-sources](http://www.sagemath.org/doc/developer/packaging.html#patching-sources)\n\nOtherwise patching will break needlessly if there no patches.",
    "created_at": "2014-11-03T09:10:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216676",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

When applying patches, please use the code from
[http://www.sagemath.org/doc/developer/packaging.html#patching-sources](http://www.sagemath.org/doc/developer/packaging.html#patching-sources)

Otherwise patching will break needlessly if there no patches.



---

archive/issue_events_238785.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-03T09:10:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238785"
}
```



---

archive/issue_events_238786.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-11-03T09:10:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238786"
}
```



---

archive/issue_comments_216677.json:
```json
{
    "body": "Changed commit from **[`4c9f288`](https://github.com/sagemath/sagetrac-mirror/commit/4c9f288dd8b571fdda9dc31906a552483b9e2afd)** to **[`e6c24d3`](https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520)**",
    "created_at": "2014-11-03T09:30:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216677",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`4c9f288`](https://github.com/sagemath/sagetrac-mirror/commit/4c9f288dd8b571fdda9dc31906a552483b9e2afd)** to **[`e6c24d3`](https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520)**



---

archive/issue_comments_216678.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/60f9af77d0c82bfe30bbbeafde3bdf8f8d1d2772\"><code>60f9af7</code></a></td><td><code>Merge branch 'develop' into t/16624/public/sympy075</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520\"><code>e6c24d3</code></a></td><td><code>16624: use standard patch script in spkg-install</code></td></tr></table>\n",
    "created_at": "2014-11-03T09:30:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216678",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/60f9af77d0c82bfe30bbbeafde3bdf8f8d1d2772"><code>60f9af7</code></a></td><td><code>Merge branch 'develop' into t/16624/public/sympy075</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520"><code>e6c24d3</code></a></td><td><code>16624: use standard patch script in spkg-install</code></td></tr></table>




---

archive/issue_events_238787.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-11-03T10:02:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238787"
}
```



---

archive/issue_events_238788.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2014-11-03T10:02:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238788"
}
```



---

archive/issue_comments_216679.json:
```json
{
    "body": "Changed branch from **[public/sympy075](https://github.com/sagemath/sagetrac-mirror/tree/public/sympy075)** to **[`e6c24d3`](https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520)**",
    "created_at": "2014-11-14T21:01:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16624#issuecomment-216679",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/sympy075](https://github.com/sagemath/sagetrac-mirror/tree/public/sympy075)** to **[`e6c24d3`](https://github.com/sagemath/sagetrac-mirror/commit/e6c24d3106cba8af3e9f662aa0b38725d656e520)**



---

archive/issue_events_238789.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-14T21:01:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238789"
}
```



---

archive/issue_events_238790.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6807f531dcba6209203052da3b9db60205e5c7af",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-11-14T21:01:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16624",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16624#event-238790"
}
```
