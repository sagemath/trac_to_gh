# Issue 16888: weak popov form does not compute weak popov form

archive/issues_016651.json:
```json
{
    "body": "While working on the sage.matrix.matrix2.weak_popov_form (for sage.matrix.matrix_misc.weak_popov_form applies the same) method for performance issues I noticed something.\n\nThe weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.\n\nFollowup ticket for reimplementation of wpf:\u00a0#16742 and #16896.\n\n[MS] T. Mulders, A. Storjohann, \"On lattice reduction for polynomial\n          matrices,\" J. Symbolic Comput. 35 (2003), no. 4, 377--401\n\nComment of weak_popov_form:\n\n  OUTPUT:\n  \n          A 3-tuple !`(W,N,d)`   consisting of:\n  \n1. !`W`   - a matrix over !`k(x)`   giving a weak the Popov form of self\n2. !`N`   - a matrix over !`k[x]`   representing row operations used to\n    transform !`self`   to !`W`  \n3. !`d`   - degree of respective columns of W; the degree of a column is\n   the maximum of the degree of its elements\n\nCC:  @johanrosenkilde\n\nKeywords: weak-popov-form matrix\n\nBranch/Commit: c19cc1182669d5534f1371dd42c5ddbcdf7875d7\n\nReviewer: David Lucas\n\nAuthor: David M\u00f6dinger\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16888\n\n",
    "closed_at": "2015-03-17T08:34:04Z",
    "created_at": "2014-08-27T13:49:56Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "weak popov form does not compute weak popov form",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16888",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```
While working on the sage.matrix.matrix2.weak_popov_form (for sage.matrix.matrix_misc.weak_popov_form applies the same) method for performance issues I noticed something.

The weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.

Followup ticket for reimplementation of wpf: #16742 and #16896.

[MS] T. Mulders, A. Storjohann, "On lattice reduction for polynomial
          matrices," J. Symbolic Comput. 35 (2003), no. 4, 377--401

Comment of weak_popov_form:

  OUTPUT:
  
          A 3-tuple !`(W,N,d)`   consisting of:
  
1. !`W`   - a matrix over !`k(x)`   giving a weak the Popov form of self
2. !`N`   - a matrix over !`k[x]`   representing row operations used to
    transform !`self`   to !`W`  
3. !`d`   - degree of respective columns of W; the degree of a column is
   the maximum of the degree of its elements

CC:  @johanrosenkilde

Keywords: weak-popov-form matrix

Branch/Commit: c19cc1182669d5534f1371dd42c5ddbcdf7875d7

Reviewer: David Lucas

Author: David Mödinger

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16888





---

archive/issue_comments_233940.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to linear algebra.",
    "created_at": "2014-08-28T11:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233940",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing component from PLEASE CHANGE to linear algebra.



---

archive/issue_comments_233941.json:
```json
{
    "body": "Changing keywords from \"\" to \"weak-popov-form matrix\".",
    "created_at": "2014-08-28T11:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233941",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing keywords from "" to "weak-popov-form matrix".



---

archive/issue_comments_233942.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2014-08-28T11:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233942",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_233943.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,29 @@\n+While working on the sage.matrix.matrix2.weak_popov_form method for performance issues I noticed something.\n \n+The weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.\n+\n+While renaming I see this as a chance to correct some (in my opinion) strange behavior of the method:\n+\n+1. It takes a parameter ascend but does not relay it to the function (it is entirely ignored)\n+2. It takes a parameter ascend which is not related to either weak Popov form or row reduced form\n+3. It returns a 3-touple even though it is only expected to compute the wpf/rrf\n+4. d of the 3-touple and the sorting is unnecessary computation and should probably not be part of the method.\n+5. while N is nice to check some things, in my opinion it should only be given if asked for\n+\n+[MS] T. Mulders, A. Storjohann, \"On lattice reduction for polynomial\n+\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 matrices,\" J. Symbolic Comput. 35 (2003), no. 4, 377--401\n+\n+Comment of weak_popov_form:\n+\n+\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 OUTPUT:\n+\n+\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 A 3-tuple !\\`(W,N,d)\\` consisting of:\n+\n+1. !\\`W\\` - a matrix over !\\`k(x)\\` giving a weak the Popov form of self\n+2. !\\`N\\` - a matrix over !\\`k[x]\\` representing row operations used to\n+\u00a0\u00a0\u00a0 transform !\\`self\\` to !\\`W\\`\n+3. !\\`d\\` - degree of respective columns of W; the degree of a column is\n+\u00a0\u00a0 the maximum of the degree of its elements\n \n Component: PLEASE CHANGE\n \n```\n",
    "created_at": "2014-08-28T11:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233943",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,29 @@
+While working on the sage.matrix.matrix2.weak_popov_form method for performance issues I noticed something.
 
+The weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.
+
+While renaming I see this as a chance to correct some (in my opinion) strange behavior of the method:
+
+1. It takes a parameter ascend but does not relay it to the function (it is entirely ignored)
+2. It takes a parameter ascend which is not related to either weak Popov form or row reduced form
+3. It returns a 3-touple even though it is only expected to compute the wpf/rrf
+4. d of the 3-touple and the sorting is unnecessary computation and should probably not be part of the method.
+5. while N is nice to check some things, in my opinion it should only be given if asked for
+
+[MS] T. Mulders, A. Storjohann, "On lattice reduction for polynomial
+          matrices," J. Symbolic Comput. 35 (2003), no. 4, 377--401
+
+Comment of weak_popov_form:
+
+        OUTPUT:
+
+        A 3-tuple !\`(W,N,d)\` consisting of:
+
+1. !\`W\` - a matrix over !\`k(x)\` giving a weak the Popov form of self
+2. !\`N\` - a matrix over !\`k[x]\` representing row operations used to
+    transform !\`self\` to !\`W\`
+3. !\`d\` - degree of respective columns of W; the degree of a column is
+   the maximum of the degree of its elements
 
 Component: PLEASE CHANGE
 
```




---

archive/issue_comments_233944.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,31 @@\n+While working on the sage.matrix.matrix2.weak_popov_form method for performance issues I noticed something.\n \n+The weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.\n+\n+While renaming I see this as a chance to correct some (in my opinion) strange behavior of the method:\n+\n+1. It takes a parameter ascend but does not relay it to the function (it is entirely ignored)\n+2. It takes a parameter ascend which is not related to either weak Popov form or row reduced form\n+3. It returns a 3-touple even though it is only expected to compute the wpf/rrf\n+4. d of the 3-touple and the sorting is unnecessary computation and should probably not be part of the method.\n+5. while N is nice to check some things, in my opinion it should only be given if asked for\n+\n+Followup ticket for reimplementation of wpf: [ticket:16742 #16742.]\n+\n+[MS] T. Mulders, A. Storjohann, \"On lattice reduction for polynomial\n+          matrices,\" J. Symbolic Comput. 35 (2003), no. 4, 377--401\n+\n+Comment of weak_popov_form:\n+\n+  OUTPUT:\n+ \n+         A 3-tuple !\\`(W,N,d)\\`  consisting of:\n+ \n+1. !\\`W\\`  - a matrix over !\\`k(x)\\`  giving a weak the Popov form of self\n+2. !\\`N\\`  - a matrix over !\\`k[x]\\`  representing row operations used to\n+    transform !\\`self\\`  to !\\`W\\` \n+3. !\\`d\\`  - degree of respective columns of W; the degree of a column is\n+   the maximum of the degree of its elements\n \n Component: PLEASE CHANGE\n \n```\n",
    "created_at": "2014-08-28T12:00:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233944",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,31 @@
+While working on the sage.matrix.matrix2.weak_popov_form method for performance issues I noticed something.
 
+The weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.
+
+While renaming I see this as a chance to correct some (in my opinion) strange behavior of the method:
+
+1. It takes a parameter ascend but does not relay it to the function (it is entirely ignored)
+2. It takes a parameter ascend which is not related to either weak Popov form or row reduced form
+3. It returns a 3-touple even though it is only expected to compute the wpf/rrf
+4. d of the 3-touple and the sorting is unnecessary computation and should probably not be part of the method.
+5. while N is nice to check some things, in my opinion it should only be given if asked for
+
+Followup ticket for reimplementation of wpf: [ticket:16742 #16742.]
+
+[MS] T. Mulders, A. Storjohann, "On lattice reduction for polynomial
+          matrices," J. Symbolic Comput. 35 (2003), no. 4, 377--401
+
+Comment of weak_popov_form:
+
+  OUTPUT:
+ 
+         A 3-tuple !\`(W,N,d)\`  consisting of:
+ 
+1. !\`W\`  - a matrix over !\`k(x)\`  giving a weak the Popov form of self
+2. !\`N\`  - a matrix over !\`k[x]\`  representing row operations used to
+    transform !\`self\`  to !\`W\` 
+3. !\`d\`  - degree of respective columns of W; the degree of a column is
+   the maximum of the degree of its elements
 
 Component: PLEASE CHANGE
 
```




---

archive/issue_comments_233945.json:
```json
{
    "body": "<a id='comment:4'></a>I think there should be a keyword (\"transposition=False\" oder  something) to indicate the matrix N is wanted. Also I am not completely  sure I did the deprecations right in any way.\n\n---\nNew commits:",
    "created_at": "2014-08-28T13:22:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233945",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

<a id='comment:4'></a>I think there should be a keyword ("transposition=False" oder  something) to indicate the matrix N is wanted. Also I am not completely  sure I did the deprecations right in any way.

---
New commits:



---

archive/issue_comments_233946.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-28T13:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233946",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_233947.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,23 @@\n+While working on the sage.matrix.matrix2.weak_popov_form (for sage.matrix.matrix_misc.weak_popov_form applies the same) method for performance issues I noticed something.\n \n+The weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.\n+\n+Followup ticket for reimplementation of wpf:\u00a0#16742 and #16896.\n+\n+[MS] T. Mulders, A. Storjohann, \"On lattice reduction for polynomial\n+          matrices,\" J. Symbolic Comput. 35 (2003), no. 4, 377--401\n+\n+Comment of weak_popov_form:\n+\n+  OUTPUT:\n+  \n+          A 3-tuple !\\`(W,N,d)\\`   consisting of:\n+  \n+1. !\\`W\\`   - a matrix over !\\`k(x)\\`   giving a weak the Popov form of self\n+2. !\\`N\\`   - a matrix over !\\`k[x]\\`   representing row operations used to\n+    transform !\\`self\\`   to !\\`W\\`  \n+3. !\\`d\\`   - degree of respective columns of W; the degree of a column is\n+   the maximum of the degree of its elements\n \n Component: PLEASE CHANGE\n \n```\n",
    "created_at": "2014-08-28T13:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233947",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,23 @@
+While working on the sage.matrix.matrix2.weak_popov_form (for sage.matrix.matrix_misc.weak_popov_form applies the same) method for performance issues I noticed something.
 
+The weak Popov form as defined in [MS] is not computed by this method. The other references do not call this form weak Popov form, it is a les restrictive definition for a certain row reduced form of matrix.
+
+Followup ticket for reimplementation of wpf: #16742 and #16896.
+
+[MS] T. Mulders, A. Storjohann, "On lattice reduction for polynomial
+          matrices," J. Symbolic Comput. 35 (2003), no. 4, 377--401
+
+Comment of weak_popov_form:
+
+  OUTPUT:
+  
+          A 3-tuple !\`(W,N,d)\`   consisting of:
+  
+1. !\`W\`   - a matrix over !\`k(x)\`   giving a weak the Popov form of self
+2. !\`N\`   - a matrix over !\`k[x]\`   representing row operations used to
+    transform !\`self\`   to !\`W\`  
+3. !\`d\`   - degree of respective columns of W; the degree of a column is
+   the maximum of the degree of its elements
 
 Component: PLEASE CHANGE
 
```




---

archive/issue_comments_233948.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[12755f1](http://git.sagemath.org/sage.git/commit/?id=12755f174d1775e53ebf719612f5e984d7120677)|`Reduced to be a renaming only.`|\n---\nNew commits:",
    "created_at": "2014-08-28T13:38:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233948",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

<a id='comment:6'></a>New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[12755f1](http://git.sagemath.org/sage.git/commit/?id=12755f174d1775e53ebf719612f5e984d7120677)|`Reduced to be a renaming only.`|
---
New commits:



---

archive/issue_comments_233949.json:
```json
{
    "body": "<a id='comment:7'></a>See also !#16896",
    "created_at": "2014-08-28T13:38:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233949",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

<a id='comment:7'></a>See also !#16896



---

archive/issue_comments_233950.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-08T08:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233950",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_233951.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-09T18:43:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233951",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_233952.json:
```json
{
    "body": "<a id='comment:9'></a>one doctest is failing",
    "created_at": "2014-09-09T18:43:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233952",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:9'></a>one doctest is failing



---

archive/issue_comments_233953.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-07T10:51:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233953",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_233954.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-07T10:52:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233954",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_233955.json:
```json
{
    "body": "<a id='comment:11'></a>Unfortunately I was sick for a long time, so i fixed the commit.",
    "created_at": "2014-10-07T10:52:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233955",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

<a id='comment:11'></a>Unfortunately I was sick for a long time, so i fixed the commit.



---

archive/issue_comments_233956.json:
```json
{
    "body": "<a id='comment:13'></a>I just changed some minor things into documentation : I removed any reference related to weak Popov form, because it does not compute the weak Popov form and I added a new reference related to the row reduced form. I also removed the name \"weak Popov form\" from the output field.",
    "created_at": "2015-03-16T13:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233956",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:13'></a>I just changed some minor things into documentation : I removed any reference related to weak Popov form, because it does not compute the weak Popov form and I added a new reference related to the row reduced form. I also removed the name "weak Popov form" from the output field.



---

archive/issue_comments_233957.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-16T13:12:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233957",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049349.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-03-16T20:21:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16888#event-49349"
}
```



---

archive/issue_events_049350.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-03-17T08:34:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16888#event-49350"
}
```



---

archive/issue_comments_233958.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-03-17T08:34:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16888",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16888#issuecomment-233958",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
