# Issue 16736: sagenb: SandboxViolation in webassets

archive/issues_016499.json:
```json
{
    "assignees": [],
    "body": "\n```\nProcessing webassets-0.9.tar.gz\nWriting /tmp/easy_install-hklIUJ/webassets-0.9/setup.cfg\nRunning webassets-0.9/setup.py -q bdist_egg --dist-dir /tmp/easy_install-hklIUJ/webassets-0.9/egg-dist-tmp-Cwkw_W\nerror: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}\n```\n\n\nCC:  @ppurka @nexttime @rwst @kiwifb\n\nReviewer: **Volker Braun**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16736_\n\n",
    "closed_at": "2016-06-12T12:02:30Z",
    "created_at": "2014-07-30T01:42:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "sagenb: SandboxViolation in webassets",
    "type": "issue",
    "updated_at": "2016-06-12T12:02:30Z",
    "url": "https://github.com/sagemath/sage/issues/16736",
    "user": "https://github.com/vbraun"
}
```

```
Processing webassets-0.9.tar.gz
Writing /tmp/easy_install-hklIUJ/webassets-0.9/setup.cfg
Running webassets-0.9/setup.py -q bdist_egg --dist-dir /tmp/easy_install-hklIUJ/webassets-0.9/egg-dist-tmp-Cwkw_W
error: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}
```


CC:  @ppurka @nexttime @rwst @kiwifb

Reviewer: **Volker Braun**

_Issue created by migration from https://trac.sagemath.org/ticket/16736_





---

archive/issue_events_221602.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T01:42:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221602"
}
```



---

archive/issue_events_221603.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T01:42:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20user%20interface",
    "label_color": "000080",
    "label_name": "component: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221603"
}
```



---

archive/issue_events_221604.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T01:42:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221604"
}
```



---

archive/issue_events_221605.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T01:42:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221605"
}
```



---

archive/issue_comments_221494.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nThe reason is that webasset setup.py imports sphinx to do some crap. Which ultimately imports PIL/Pillow which causes the egg to be unpacked, violating the sandbox.\n\nWhy does sagenb come with webassets to start with? Its not used anywhere, it seems. Some packaged js files were generated with it?",
    "created_at": "2014-07-30T02:45:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221494",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">Comment 1</div>

The reason is that webasset setup.py imports sphinx to do some crap. Which ultimately imports PIL/Pillow which causes the egg to be unpacked, violating the sandbox.

Why does sagenb come with webassets to start with? Its not used anywhere, it seems. Some packaged js files were generated with it?



---

archive/issue_comments_221495.json:
```json
{
    "body": "Branch: **[u/vbraun/sagenb__sandboxviolation_in_webassets](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/sagenb__sandboxviolation_in_webassets)**",
    "created_at": "2014-07-30T03:16:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221495",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/sagenb__sandboxviolation_in_webassets](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/sagenb__sandboxviolation_in_webassets)**



---

archive/issue_comments_221496.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,3 +6,5 @@\n error: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}\n ```\n Possibly due to the newer setuptools doing a better job at checking for shenanigans... \n+\n+New tarball: http://boxen.math.washington.edu/home/vbraun/upstream/setuptools-5.4.1.tar.gz\n``````\n",
    "created_at": "2014-07-30T03:19:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221496",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,3 +6,5 @@
 error: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}
 ```
 Possibly due to the newer setuptools doing a better job at checking for shenanigans... 
+
+New tarball: http://boxen.math.washington.edu/home/vbraun/upstream/setuptools-5.4.1.tar.gz
``````




---

archive/issue_comments_221497.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nI guess the ideal solution would be to use distutils / pip instead of easy_install (who cares about binary eggs)? Though that would probably be a bigger task. For now, just allow chmod outside of the setuptools sandbox (and, really, fixing permissions isn't so bad).\n\nUpdating to the latest setuptools alone didn't fix it, but we should do that anyway.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/425ebcc90119344116f8d1e113410b0e57c91ec8\">425ebcc</a></td><td><code>Update to setuptools 5.4.1</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a487a0d673527ab9a9b57c36edf9c5ed0a7ac483\">a487a0d</a></td><td><code>Allow chmod outside of the sandbox</code></td></tr></table>\n",
    "created_at": "2014-07-30T03:19:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221497",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">Comment 3</div>

I guess the ideal solution would be to use distutils / pip instead of easy_install (who cares about binary eggs)? Though that would probably be a bigger task. For now, just allow chmod outside of the setuptools sandbox (and, really, fixing permissions isn't so bad).

Updating to the latest setuptools alone didn't fix it, but we should do that anyway.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/425ebcc90119344116f8d1e113410b0e57c91ec8">425ebcc</a></td><td><code>Update to setuptools 5.4.1</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a487a0d673527ab9a9b57c36edf9c5ed0a7ac483">a487a0d</a></td><td><code>Allow chmod outside of the sandbox</code></td></tr></table>




---

archive/issue_events_221606.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T03:19:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221606"
}
```



---

archive/issue_comments_221498.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2014-07-30T03:19:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221498",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_comments_221499.json:
```json
{
    "body": "Commit: **[a487a0d](https://github.com/sagemath/sagetrac-mirror/commit/a487a0d673527ab9a9b57c36edf9c5ed0a7ac483)**",
    "created_at": "2014-07-30T03:19:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221499",
    "user": "https://github.com/vbraun"
}
```

Commit: **[a487a0d](https://github.com/sagemath/sagetrac-mirror/commit/a487a0d673527ab9a9b57c36edf9c5ed0a7ac483)**



---

archive/issue_events_221607.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T03:20:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221607"
}
```



---

archive/issue_events_221608.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T03:20:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221608"
}
```



---

archive/issue_comments_221500.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nNot sure what webassets does either. Is it just me or there is a violent inflation in setuptools version numbers - worse than chrome even.",
    "created_at": "2014-07-30T03:30:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221500",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:6" align="right">Comment 6</div>

Not sure what webassets does either. Is it just me or there is a violent inflation in setuptools version numbers - worse than chrome even.



---

archive/issue_comments_221501.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nIn fact I hadn't noticed that webassets had been upgraded past 0.7.1.",
    "created_at": "2014-07-30T03:42:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221501",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:7" align="right">Comment 7</div>

In fact I hadn't noticed that webassets had been upgraded past 0.7.1.



---

archive/issue_comments_221502.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nThe whole packages-inside-sagenb thing needs to be fixed at one point, too. But this is also not the scope of this ticket, but make a new beta that can be installed from scratch.",
    "created_at": "2014-07-30T03:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221502",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">Comment 8</div>

The whole packages-inside-sagenb thing needs to be fixed at one point, too. But this is also not the scope of this ticket, but make a new beta that can be installed from scratch.



---

archive/issue_comments_221503.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nThis seems to be caused by #16733, so I'll unmerge that upgrade until somebody can review this.",
    "created_at": "2014-07-30T21:13:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221503",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">Comment 9</div>

This seems to be caused by #16733, so I'll unmerge that upgrade until somebody can review this.



---

archive/issue_events_221609.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T21:14:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/p1%20%E2%80%93%20blocker",
    "label_color": "ff0000",
    "label_name": "p1 \u2013 blocker",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221609"
}
```



---

archive/issue_events_221610.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T21:14:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221610"
}
```



---

archive/issue_events_221611.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T21:14:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20user%20interface",
    "label_color": "000080",
    "label_name": "component: user interface",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221611"
}
```



---

archive/issue_events_221612.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-30T21:14:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221612"
}
```



---

archive/issue_comments_221504.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI am not convinced by the solution I will try something in the next few hours before accepting this.",
    "created_at": "2014-07-31T05:24:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221504",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">Comment 11</div>

I am not convinced by the solution I will try something in the next few hours before accepting this.



---

archive/issue_comments_221505.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nSo far I haven't been able to reproduce this. I am guessing this is a from scratch install while I am working on top of beta7 which may have an impact.",
    "created_at": "2014-07-31T09:53:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221505",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12" align="right">Comment 12</div>

So far I haven't been able to reproduce this. I am guessing this is a from scratch install while I am working on top of beta7 which may have an impact.



---

archive/issue_comments_221506.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nYou probably need to (re-)install by hand the new docutils and pillow. Or rebuild from scratch (with #16733 merged in).",
    "created_at": "2014-07-31T14:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221506",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">Comment 13</div>

You probably need to (re-)install by hand the new docutils and pillow. Or rebuild from scratch (with #16733 merged in).



---

archive/issue_comments_221507.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nThis is very curious. I merged #16733 and this ticket w/o the `sandbox.patch` (the patch was removed and the change was committed with `git commit -a`). The following sequence did not give a `SandboxViolation` in webassets:\n* ./sage -f docutils\n* ./sage -f setuptools\n* ./sage -f sagenb\nBut the following sequence did yield the violation (new docutils installed)\n* ./sage -f pillow\n* ./sage -f setuptools\n* ./sage -f sagenb\nThen adding the sandbox patch in and doing\n* ./sage -f setuptools\n* ./sage -f sagenb\nseemed to resolve things. So where is the real problem? Maybe it doesn't matter. The sandbox patch does work.",
    "created_at": "2014-08-02T19:13:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221507",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:14" align="right">Comment 14</div>

This is very curious. I merged #16733 and this ticket w/o the `sandbox.patch` (the patch was removed and the change was committed with `git commit -a`). The following sequence did not give a `SandboxViolation` in webassets:
* ./sage -f docutils
* ./sage -f setuptools
* ./sage -f sagenb
But the following sequence did yield the violation (new docutils installed)
* ./sage -f pillow
* ./sage -f setuptools
* ./sage -f sagenb
Then adding the sandbox patch in and doing
* ./sage -f setuptools
* ./sage -f sagenb
seemed to resolve things. So where is the real problem? Maybe it doesn't matter. The sandbox patch does work.



---

archive/issue_comments_221508.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nInteresting digging Steve. I am sure the patch works, I just think it is the wrong thing to do but I don't know any alternative, apart from trying to upgrade webassets since there is a newer release - of course it is likely it will suffer the same fate.",
    "created_at": "2014-08-02T20:06:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221508",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:15" align="right">Comment 15</div>

Interesting digging Steve. I am sure the patch works, I just think it is the wrong thing to do but I don't know any alternative, apart from trying to upgrade webassets since there is a newer release - of course it is likely it will suffer the same fate.



---

archive/issue_comments_221509.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nI tried upgrading webassets and it didn't work. The setup.py is till importing sphinx, so it'll die if that ends up pulling in pil(low)",
    "created_at": "2014-08-03T00:53:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221509",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:16" align="right">Comment 16</div>

I tried upgrading webassets and it didn't work. The setup.py is till importing sphinx, so it'll die if that ends up pulling in pil(low)



---

archive/issue_comments_221510.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nOK so that potentially pushes the problem in sphinx and upgrading that brings its own problems. Or may be pillow, that would be easier to try that.",
    "created_at": "2014-08-03T03:25:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221510",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">Comment 17</div>

OK so that potentially pushes the problem in sphinx and upgrading that brings its own problems. Or may be pillow, that would be easier to try that.



---

archive/issue_comments_221511.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nI've installed sphinx-1.2.2, merged #16733 and this ticket w/o the sandbox patch and I have no `SandboxViolation`. However, #16396 can't be merged w/o some work. Is it possible that sphinx-1.2.2 doesn't import pillow? I believe what I've done is correct. But maybe the sandbox patch is the thing to do in the short-term.",
    "created_at": "2014-08-03T05:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221511",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:18" align="right">Comment 18</div>

I've installed sphinx-1.2.2, merged #16733 and this ticket w/o the sandbox patch and I have no `SandboxViolation`. However, #16396 can't be merged w/o some work. Is it possible that sphinx-1.2.2 doesn't import pillow? I believe what I've done is correct. But maybe the sandbox patch is the thing to do in the short-term.



---

archive/issue_comments_221512.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nI really think that shooting an element of the sandbox for just one package is not good. It would be better if an exception could be made until we fix the faulty package rather than sabotaging setuptools.",
    "created_at": "2014-08-03T22:49:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221512",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:19" align="right">Comment 19</div>

I really think that shooting an element of the sandbox for just one package is not good. It would be better if an exception could be made until we fix the faulty package rather than sabotaging setuptools.



---

archive/issue_comments_221513.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nOK the call to sphinx in webassets is really limited to\n\n```\ntry:\n    from sphinx.setup_command import BuildDoc\n    cmdclass = {'build_sphinx': BuildDoc}\nexcept ImportError:\n    cmdclass = {}\n```\nat the top of setup.py There are calls in docs/conf.py but they probably won't be called if we remove the above. I propose we have a patched webassets in sagenb rather than breaking setuptools' sandbox.",
    "created_at": "2014-08-03T22:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221513",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:20" align="right">Comment 20</div>

OK the call to sphinx in webassets is really limited to

```
try:
    from sphinx.setup_command import BuildDoc
    cmdclass = {'build_sphinx': BuildDoc}
except ImportError:
    cmdclass = {}
```
at the top of setup.py There are calls in docs/conf.py but they probably won't be called if we remove the above. I propose we have a patched webassets in sagenb rather than breaking setuptools' sandbox.



---

archive/issue_comments_221514.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nPerhaps naive but is there any undesirable side effect of adding something like\n\n`export PYTHON_EGG_CACHE=\"./.python-eggs\"` \n\nto `build/pkgs/sagenb/spkg-install`? I'm not sure where `\".\"` is during the install of sagenb but it's apparently not outside the sandbox.",
    "created_at": "2014-08-04T23:40:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221514",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:21" align="right">Comment 21</div>

Perhaps naive but is there any undesirable side effect of adding something like

`export PYTHON_EGG_CACHE="./.python-eggs"` 

to `build/pkgs/sagenb/spkg-install`? I'm not sure where `"."` is during the install of sagenb but it's apparently not outside the sandbox.



---

archive/issue_comments_221515.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nDoing the above, a build from scratch was successful w/o the sandbox patch.",
    "created_at": "2014-08-05T03:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221515",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:22" align="right">Comment 22</div>

Doing the above, a build from scratch was successful w/o the sandbox patch.



---

archive/issue_comments_221516.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nReplying to [@strogdon](#comment%3A22):\n> Doing the above, a build from scratch was successful w/o the sandbox patch.\n\nI definitely would take that over the current patch. It is much simpler.",
    "created_at": "2014-08-05T10:48:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221516",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:23" align="right">Comment 23</div>

Replying to [@strogdon](#comment%3A22):
> Doing the above, a build from scratch was successful w/o the sandbox patch.

I definitely would take that over the current patch. It is much simpler.



---

archive/issue_comments_221517.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nPutting the egg cache in a location that you aren't sure of is potentially a security issue.\n\nI've asked on sage-devel whether we can remove webassets: https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/Nmc5kcVXfZYJ",
    "created_at": "2014-08-05T12:46:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221517",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:24" align="right">Comment 24</div>

Putting the egg cache in a location that you aren't sure of is potentially a security issue.

I've asked on sage-devel whether we can remove webassets: https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/Nmc5kcVXfZYJ



---

archive/issue_events_221613.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221613"
}
```



---

archive/issue_events_221614.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221614"
}
```



---

archive/issue_comments_221518.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nAny news? If you want a different solution then post a branch...",
    "created_at": "2014-08-11T14:29:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221518",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:26" align="right">Comment 26</div>

Any news? If you want a different solution then post a branch...



---

archive/issue_comments_221519.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nI think the best fix is to push for #16396 to be finished.",
    "created_at": "2014-08-11T21:15:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221519",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:27" align="right">Comment 27</div>

I think the best fix is to push for #16396 to be finished.



---

archive/issue_comments_221520.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nJust to note that [the reason for webassets](https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/nDOHbclqLUAJ) was discovered, though hopefully this is a moot point now that #16396 is positive review.",
    "created_at": "2014-10-21T20:22:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221520",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:28" align="right">Comment 28</div>

Just to note that [the reason for webassets](https://groups.google.com/d/msg/sage-devel/fEeGgVWuk7I/nDOHbclqLUAJ) was discovered, though hopefully this is a moot point now that #16396 is positive review.



---

archive/issue_comments_221521.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nI very much hope we can fix it invalid once the whole new docutils/sphinx/sagenb is in.",
    "created_at": "2014-10-21T20:51:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221521",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:29" align="right">Comment 29</div>

I very much hope we can fix it invalid once the whole new docutils/sphinx/sagenb is in.



---

archive/issue_comments_221522.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nIf things are fixed then there is perhaps the question of whether to upgrade setuptools anyway. But maybe another ticket.",
    "created_at": "2014-10-21T22:20:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221522",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:30" align="right">Comment 30</div>

If things are fixed then there is perhaps the question of whether to upgrade setuptools anyway. But maybe another ticket.



---

archive/issue_comments_221523.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nOK, I've merged #16396 and #16733 on top of 6.4.beta6 and I don't see the `SandboxViolation` when building sagenb. I would feel more comfortable if someone else would also confirm this. I also tried things with setuptool-5.4.1 and when rebuilding sphinx-1.2.2 (after a make) I get an error\n\n```\nRemoving old version of Sphinx...\nrm: cannot remove '/64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx': Directo\nry not empty\nError building Sphinx: 'Error deleting previous version'\n```\n\nThe only file in the subject folder is\n\n```\nls /64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx\n__init__.pyc\n```",
    "created_at": "2014-10-21T23:59:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221523",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:31" align="right">Comment 31</div>

OK, I've merged #16396 and #16733 on top of 6.4.beta6 and I don't see the `SandboxViolation` when building sagenb. I would feel more comfortable if someone else would also confirm this. I also tried things with setuptool-5.4.1 and when rebuilding sphinx-1.2.2 (after a make) I get an error

```
Removing old version of Sphinx...
rm: cannot remove '/64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx': Directo
ry not empty
Error building Sphinx: 'Error deleting previous version'
```

The only file in the subject folder is

```
ls /64bitdev/storage/sage-git_develop/sage/local/lib/python/site-packages/Sphinx-1.2.2-py2.7.egg/sphinx
__init__.pyc
```



---

archive/issue_comments_221524.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nWell I'm unable to reproduce the above sphinx build error. I'm not sure what the source could have been. Also I see no `SandboxViolation` with setuptools-5.4.1 added on top of #16396 and #16733 without the `sandbox.patch`.",
    "created_at": "2014-10-22T04:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221524",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:32" align="right">Comment 32</div>

Well I'm unable to reproduce the above sphinx build error. I'm not sure what the source could have been. Also I see no `SandboxViolation` with setuptools-5.4.1 added on top of #16396 and #16733 without the `sandbox.patch`.



---

archive/issue_comments_221525.json:
```json
{
    "body": "Reviewer: **Steve Trogdon**",
    "created_at": "2014-11-02T00:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221525",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **Steve Trogdon**



---

archive/issue_comments_221526.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nA bit late. I just noticed we haven't updated docutils in 6.4.rc0/rc1 because this ticket is blocking it. This is a positive review \"works for me/invalid\" I guess.",
    "created_at": "2014-11-02T00:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221526",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:33" align="right">Comment 33</div>

A bit late. I just noticed we haven't updated docutils in 6.4.rc0/rc1 because this ticket is blocking it. This is a positive review "works for me/invalid" I guess.



---

archive/issue_events_221615.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2014-11-02T00:41:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221615"
}
```



---

archive/issue_events_221616.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2014-11-02T00:41:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221616"
}
```



---

archive/issue_comments_221527.json:
```json
{
    "body": "Changed branch from **[u/vbraun/sagenb__sandboxviolation_in_webassets](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/sagenb__sandboxviolation_in_webassets)** to none",
    "created_at": "2014-11-02T00:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221527",
    "user": "https://github.com/kiwifb"
}
```

Changed branch from **[u/vbraun/sagenb__sandboxviolation_in_webassets](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/sagenb__sandboxviolation_in_webassets)** to none



---

archive/issue_comments_221528.json:
```json
{
    "body": "Changed commit from **[a487a0d](https://github.com/sagemath/sagetrac-mirror/commit/a487a0d673527ab9a9b57c36edf9c5ed0a7ac483)** to none",
    "created_at": "2014-11-02T00:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221528",
    "user": "https://github.com/kiwifb"
}
```

Changed commit from **[a487a0d](https://github.com/sagemath/sagetrac-mirror/commit/a487a0d673527ab9a9b57c36edf9c5ed0a7ac483)** to none



---

archive/issue_events_221617.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:25:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221617"
}
```



---

archive/issue_events_221618.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:25:35Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221618"
}
```



---

archive/issue_events_221619.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:25:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221619"
}
```



---

archive/issue_events_221620.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:25:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221620"
}
```



---

archive/issue_events_221621.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-11-15T16:25:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221621"
}
```



---

archive/issue_comments_221529.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nYou are supposed to set the milestone to invalid...",
    "created_at": "2014-11-15T16:25:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221529",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:34" align="right">Comment 34</div>

You are supposed to set the milestone to invalid...



---

archive/issue_comments_221530.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nFWCW, I just triggered it again while building Sage in a subdirectory of /tmp:\n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-OSzZkb/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-OSzZkb/webassets-0.10.1/egg-dist-tmp-H58hNo\nerror: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpMF0VYS.$extract', 493) {}\n```",
    "created_at": "2015-01-06T22:54:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221530",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:35" align="right">Comment 35</div>

FWCW, I just triggered it again while building Sage in a subdirectory of /tmp:

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-OSzZkb/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-OSzZkb/webassets-0.10.1/egg-dist-tmp-H58hNo
error: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpMF0VYS.$extract', 493) {}
```



---

archive/issue_comments_221531.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nThis is curious. I did a fresh build under /tmp after cloning from the `develop` branch and I get on my gentoo box:\n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-KBbcXK/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-KBbcXK/webassets-0.10.1/egg-dist-tmp-7cFRfA\nwarning: no files found matching 'run_tests.py'\nno previously-included directories found matching 'docs/_build'\nwarning: no previously-included files matching 'out.css' found under directory 'examples'\nwarning: no previously-included files matching 'out.js' found under directory 'examples'\nno previously-included directories found matching 'examples/appengine-sdk'\nwarning: no previously-included files matching '*.pyc' found anywhere in distribution\nwarning: no previously-included files matching '.gitignore' found anywhere in distribution\nwarning: no previously-included files matching '*.orig' found anywhere in distribution\nwarning: no previously-included files matching 'webassets-cache/*' found anywhere in distribution\nwarning: no previously-included files matching '.sass-cache/*' found anywhere in distribution\nzip_safe flag not set; analyzing archive contents...\nwebassets.filter.__init__: module references __file__\nAdding webassets 0.10.1 to easy-install.pth file\nInstalling webassets script to /tmp/sage_sandbox/sage/local/bin\n\nInstalled /tmp/sage_sandbox/sage/local/lib/python2.7/site-packages/webassets-0.10.1-py2.7.egg\nProcessing dependencies for webassets==0.10.1\nFinished processing dependencies for webassets==0.10.1\n```\nI wonder what's up?",
    "created_at": "2015-01-07T06:37:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221531",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:36" align="right">Comment 36</div>

This is curious. I did a fresh build under /tmp after cloning from the `develop` branch and I get on my gentoo box:

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-KBbcXK/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-KBbcXK/webassets-0.10.1/egg-dist-tmp-7cFRfA
warning: no files found matching 'run_tests.py'
no previously-included directories found matching 'docs/_build'
warning: no previously-included files matching 'out.css' found under directory 'examples'
warning: no previously-included files matching 'out.js' found under directory 'examples'
no previously-included directories found matching 'examples/appengine-sdk'
warning: no previously-included files matching '*.pyc' found anywhere in distribution
warning: no previously-included files matching '.gitignore' found anywhere in distribution
warning: no previously-included files matching '*.orig' found anywhere in distribution
warning: no previously-included files matching 'webassets-cache/*' found anywhere in distribution
warning: no previously-included files matching '.sass-cache/*' found anywhere in distribution
zip_safe flag not set; analyzing archive contents...
webassets.filter.__init__: module references __file__
Adding webassets 0.10.1 to easy-install.pth file
Installing webassets script to /tmp/sage_sandbox/sage/local/bin

Installed /tmp/sage_sandbox/sage/local/lib/python2.7/site-packages/webassets-0.10.1-py2.7.egg
Processing dependencies for webassets==0.10.1
Finished processing dependencies for webassets==0.10.1
```
I wonder what's up?



---

archive/issue_comments_221532.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nOK guys that prompt 2 questions from me:\n\n* Is it only happening when building in /tmp ?\n* /tmp/easy_install-${random}? is it really the spkg being installed or easy_install acting on its own?",
    "created_at": "2015-01-07T07:03:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221532",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:37" align="right">Comment 37</div>

OK guys that prompt 2 questions from me:

* Is it only happening when building in /tmp ?
* /tmp/easy_install-${random}? is it really the spkg being installed or easy_install acting on its own?



---

archive/issue_comments_221533.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nOnly happens when building in /tmp. Seems that easy_install does something different in that case.",
    "created_at": "2015-01-07T09:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221533",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:38" align="right">Comment 38</div>

Only happens when building in /tmp. Seems that easy_install does something different in that case.



---

archive/issue_events_221622.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-16T22:35:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221622"
}
```



---

archive/issue_comments_221534.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nI'm getting this again with sagenb-11.4 on some but not all user accounts. No idea what the difference is. This is in my home directory, not compiling in /tmp. \n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg\nerror: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpZhc7i8.$extract', 493) {}\n```\nHow about we just get rid of the unused webassets?",
    "created_at": "2015-02-16T22:35:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221534",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:39" align="right">Comment 39</div>

I'm getting this again with sagenb-11.4 on some but not all user accounts. No idea what the difference is. This is in my home directory, not compiling in /tmp. 

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg
error: SandboxViolation: chmod('/home/vbraun/.sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpZhc7i8.$extract', 493) {}
```
How about we just get rid of the unused webassets?



---

archive/issue_events_221623.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-16T22:35:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221623"
}
```



---

archive/issue_comments_221535.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nPS: the directory is created by setuptools just for webassets:\n\n```\n$ grep AR1rXi logs/pkgs/sagenb.log \nWriting /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg\n```",
    "created_at": "2015-02-16T22:36:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221535",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:40" align="right">Comment 40</div>

PS: the directory is created by setuptools just for webassets:

```
$ grep AR1rXi logs/pkgs/sagenb.log 
Writing /tmp/easy_install-AR1rXi/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-AR1rXi/webassets-0.10.1/egg-dist-tmp-dpb_Mg
```



---

archive/issue_comments_221536.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nYes get rid of it, especially if it is such a headache. Is the problem happening on some distros and not others or something more subtle?",
    "created_at": "2015-02-16T22:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221536",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:41" align="right">Comment 41</div>

Yes get rid of it, especially if it is such a headache. Is the problem happening on some distros and not others or something more subtle?



---

archive/issue_comments_221537.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nA different account can install webassets (again in its respective home directory):\n\n```\nProcessing webassets-0.10.1.tar.gz\nWriting /tmp/easy_install-Fd5CnH/webassets-0.10.1/setup.cfg\nRunning webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-Fd5CnH/webassets-0.10.1/egg-dist-tmp-f2qRbU\nwarning: no files found matching 'run_tests.py'\n[...]\n```",
    "created_at": "2015-02-16T22:45:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221537",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:42" align="right">Comment 42</div>

A different account can install webassets (again in its respective home directory):

```
Processing webassets-0.10.1.tar.gz
Writing /tmp/easy_install-Fd5CnH/webassets-0.10.1/setup.cfg
Running webassets-0.10.1/setup.py -q bdist_egg --dist-dir /tmp/easy_install-Fd5CnH/webassets-0.10.1/egg-dist-tmp-f2qRbU
warning: no files found matching 'run_tests.py'
[...]
```



---

archive/issue_comments_221538.json:
```json
{
    "body": "Changed reviewer from **Steve Trogdon** to none",
    "created_at": "2015-02-16T23:04:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221538",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **Steve Trogdon** to none



---

archive/issue_comments_221539.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,4 @@\n Running webassets-0.9/setup.py -q bdist_egg --dist-dir /tmp/easy_install-hklIUJ/webassets-0.9/egg-dist-tmp-Cwkw_W\n error: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}\n ```\n-Possibly due to the newer setuptools doing a better job at checking for shenanigans... \n \n-New tarball: http://boxen.math.washington.edu/home/vbraun/upstream/setuptools-5.4.1.tar.gz\n``````\n",
    "created_at": "2015-02-16T23:04:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221539",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,4 @@
 Running webassets-0.9/setup.py -q bdist_egg --dist-dir /tmp/easy_install-hklIUJ/webassets-0.9/egg-dist-tmp-Cwkw_W
 error: SandboxViolation: chmod('/home/buildslave-sage/slave/sage_git/dot_sage/.python-eggs/Pillow-2.2.2-py2.7-linux-x86_64.egg-tmp/PIL/tmpelb5a7.$extract', 493) {}
 ```
-Possibly due to the newer setuptools doing a better job at checking for shenanigans... 
 
-New tarball: http://boxen.math.washington.edu/home/vbraun/upstream/setuptools-5.4.1.tar.gz
``````




---

archive/issue_comments_221540.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nAgain, webassets is there so that people can use the \"newui\" branch of sagenb, which apparently people are indeed trying out and using (based on discussions there).",
    "created_at": "2015-02-17T01:08:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221540",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:44" align="right">Comment 44</div>

Again, webassets is there so that people can use the "newui" branch of sagenb, which apparently people are indeed trying out and using (based on discussions there).



---

archive/issue_comments_221541.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nJust off the top of my head. Would it be possible to avoid the issue by removing webassets from sagenb and then installing it separately?",
    "created_at": "2015-02-17T03:19:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221541",
    "user": "https://github.com/strogdon"
}
```

<div id="comment:45" align="right">Comment 45</div>

Just off the top of my head. Would it be possible to avoid the issue by removing webassets from sagenb and then installing it separately?



---

archive/issue_comments_221542.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nIf you need webassets you can just \"pip install webassets\". But if its not used by default then don't ship it.",
    "created_at": "2015-02-17T09:20:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221542",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:46" align="right">Comment 46</div>

If you need webassets you can just "pip install webassets". But if its not used by default then don't ship it.



---

archive/issue_comments_221543.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\n> If you need webassets you can just \"pip install webassets\". But if its not used by default then don't ship it.\n\nI'd be open to a pull request, but whatever solution there is should probably have a good and easy way to tell a user to install webassets *before* they attempt to switch to that.  It's also possible migeruhito's changes with that will have removed the need for webassets, I really know nothing about it beyond why it was added (included not knowing why that was actually necessary).",
    "created_at": "2015-02-17T12:43:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221543",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:47" align="right">Comment 47</div>

> If you need webassets you can just "pip install webassets". But if its not used by default then don't ship it.

I'd be open to a pull request, but whatever solution there is should probably have a good and easy way to tell a user to install webassets *before* they attempt to switch to that.  It's also possible migeruhito's changes with that will have removed the need for webassets, I really know nothing about it beyond why it was added (included not knowing why that was actually necessary).



---

archive/issue_comments_221544.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nThen just add it to the instructions for trying out the newui branch, wherever those might be.",
    "created_at": "2015-02-17T13:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221544",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">Comment 48</div>

Then just add it to the instructions for trying out the newui branch, wherever those might be.



---

archive/issue_events_221624.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T20:23:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "milestone_number": null,
    "milestone_title": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221624"
}
```



---

archive/issue_events_221625.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T20:23:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221625"
}
```



---

archive/issue_comments_221545.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2016-04-07T20:23:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221545",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Volker Braun**



---

archive/issue_comments_221546.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nwebassets is being removed at #14840.",
    "created_at": "2016-04-07T20:23:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221546",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">Comment 49</div>

webassets is being removed at #14840.



---

archive/issue_events_221626.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T20:23:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221626"
}
```



---

archive/issue_comments_221547.json:
```json
{
    "body": "Changed author from **Volker Braun** to none",
    "created_at": "2016-04-07T20:23:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16736#issuecomment-221547",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Volker Braun** to none



---

archive/issue_events_221627.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T20:23:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221627"
}
```



---

archive/issue_events_221628.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-04-07T20:23:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221628"
}
```



---

archive/issue_events_221629.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-12T12:02:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221629"
}
```



---

archive/issue_events_221630.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-12T12:02:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16736",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16736#event-221630"
}
```
