# Issue 16774: Sage is not listed as a failed package

archive/issues_016537.json:
```json
{
    "body": "It took me a bit to figure out what was wrong after getting\n\n```\n***************************************************************\nError building Sage.\n\nThe following package(s) may have failed to build:\n\nThe build directory may contain configuration files and other potentially\nhelpful information. WARNING: if you now run 'make' again, the build\ndirectory will, by default, be deleted. Set the environment variable\nSAGE_KEEP_BUILT_SPKGS to 'yes' to prevent this.\n```\nAnd what was wrong was that \"package sage-6.3.beta4\" failed to build (due to wrong $HOME where Cython cache was supposed to live) - is it actually considered a package? On the one hand there is no sage in upstream or build/pkgs, on the other - there is log/pkgs/sage-*\n\nIn any case it would be nice to have a more clear error message - usually it gives paths to the log files that contain the error message in the end, as looking for errors on the console or install.log is inconvenient for parallel builds. Looks like #14263 just missed this particular case.\n\n**CC:**  @jhpalmieri @nexttime @vbraun @jdemeyer\n\n**Branch/Commit:** [2682fdaed250a214bd584e6f963d8cccc8c81fc3](https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3)\n\n**Reviewer:** John Palmieri\n\n**Author:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/16774\n\n",
    "closed_at": "2015-06-20T09:20:16Z",
    "created_at": "2014-08-06T22:42:31Z",
    "labels": [
        "component: build",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Sage is not listed as a failed package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16774",
    "user": "https://github.com/novoselt"
}
```
It took me a bit to figure out what was wrong after getting

```
***************************************************************
Error building Sage.

The following package(s) may have failed to build:

The build directory may contain configuration files and other potentially
helpful information. WARNING: if you now run 'make' again, the build
directory will, by default, be deleted. Set the environment variable
SAGE_KEEP_BUILT_SPKGS to 'yes' to prevent this.
```
And what was wrong was that "package sage-6.3.beta4" failed to build (due to wrong $HOME where Cython cache was supposed to live) - is it actually considered a package? On the one hand there is no sage in upstream or build/pkgs, on the other - there is log/pkgs/sage-*

In any case it would be nice to have a more clear error message - usually it gives paths to the log files that contain the error message in the end, as looking for errors on the console or install.log is inconvenient for parallel builds. Looks like #14263 just missed this particular case.

**CC:**  @jhpalmieri @nexttime @vbraun @jdemeyer

**Branch/Commit:** [2682fdaed250a214bd584e6f963d8cccc8c81fc3](https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3)

**Reviewer:** John Palmieri

**Author:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/16774





---

archive/issue_comments_267731.json:
```json
{
    "body": "<a id='comment:1'></a>\nI think the issue is that, in the transition to git, the Sage library is no longer distributed as an spkg, and is no longer installed using the `sage-spkg` script. So the log file doesn't look the same; for example, even when successful, it doesn't record the amount of time spent building the \"package\".",
    "created_at": "2014-08-07T05:53:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267731",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:1'></a>
I think the issue is that, in the transition to git, the Sage library is no longer distributed as an spkg, and is no longer installed using the `sage-spkg` script. So the log file doesn't look the same; for example, even when successful, it doesn't record the amount of time spent building the "package".



---

archive/issue_events_056106.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16774#event-56106"
}
```



---

archive/issue_comments_267732.json:
```json
{
    "body": "<a id='comment:5'></a>\nHaha, reading the ticket's title, I of course first thought of the recent discussion on sage-flame and elsewhere... (probably substituting \"package\" by \"project\", too)",
    "created_at": "2014-08-21T15:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267732",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>
Haha, reading the ticket's title, I of course first thought of the recent discussion on sage-flame and elsewhere... (probably substituting "package" by "project", too)



---

archive/issue_comments_267733.json:
```json
{
    "body": "**Branch:** [u/jdemeyer/sage_is_not_listed_as_a_failed_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage_is_not_listed_as_a_failed_package)",
    "created_at": "2015-06-17T16:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267733",
    "user": "https://github.com/jdemeyer"
}
```

**Branch:** [u/jdemeyer/sage_is_not_listed_as_a_failed_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage_is_not_listed_as_a_failed_package)



---

archive/issue_comments_267734.json:
```json
{
    "body": "**Commit:** [2682fdaed250a214bd584e6f963d8cccc8c81fc3](https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3)",
    "created_at": "2015-06-17T16:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267734",
    "user": "https://github.com/jdemeyer"
}
```

**Commit:** [2682fdaed250a214bd584e6f963d8cccc8c81fc3](https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3)



---

archive/issue_comments_267735.json:
```json
{
    "body": "**Author:** Jeroen Demeyer",
    "created_at": "2015-06-17T16:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267735",
    "user": "https://github.com/jdemeyer"
}
```

**Author:** Jeroen Demeyer



---

archive/issue_comments_267736.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2015-06-17T16:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267736",
    "user": "https://github.com/jdemeyer"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_267737.json:
```json
{
    "body": "<a id='comment:7'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3\">2682fda</a></td><td><code>Format exceptions raised by setup.py like errors in sage-spkg</code></td></tr></table>\n",
    "created_at": "2015-06-17T16:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267737",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3">2682fda</a></td><td><code>Format exceptions raised by setup.py like errors in sage-spkg</code></td></tr></table>




---

archive/issue_comments_267738.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2015-06-18T19:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267738",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_267739.json:
```json
{
    "body": "<a id='comment:8'></a>\nLooks okay to me. I tested it out by breaking a Cython file, and then `make` exits with the appropriate error message:\n\n```\nError building Sage.\n\nThe following package(s) may have failed to build:\n\npackage: sage-6.8.beta4\n```",
    "created_at": "2015-06-18T19:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267739",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
Looks okay to me. I tested it out by breaking a Cython file, and then `make` exits with the appropriate error message:

```
Error building Sage.

The following package(s) may have failed to build:

package: sage-6.8.beta4
```



---

archive/issue_comments_267740.json:
```json
{
    "body": "**Reviewer:** John Palmieri",
    "created_at": "2015-06-18T19:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267740",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri



---

archive/issue_comments_267741.json:
```json
{
    "body": "**Changing branch** from \"[u/jdemeyer/sage_is_not_listed_as_a_failed_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage_is_not_listed_as_a_failed_package)\" to \"[2682fdaed250a214bd584e6f963d8cccc8c81fc3](https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3)\".",
    "created_at": "2015-06-20T09:20:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16774#issuecomment-267741",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/jdemeyer/sage_is_not_listed_as_a_failed_package](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/sage_is_not_listed_as_a_failed_package)" to "[2682fdaed250a214bd584e6f963d8cccc8c81fc3](https://github.com/sagemath/sagetrac-mirror/commit/2682fdaed250a214bd584e6f963d8cccc8c81fc3)".



---

archive/issue_events_056107.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-20T09:20:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16774",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16774#event-56107"
}
```
