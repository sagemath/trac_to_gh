# Issue 16896: rework of row_reduced_form/weak_popov_form calling convention

archive/issues_016659.json:
```json
{
    "body": "The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.\n\n1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.\n\n2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.\n\n3. When the input is a matrix over a polynomial ring, it returns the output as over the fraction field, though the output always *lie* in the polynomial ring. This is senseless and confusing.\n\nI've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...\n\nCC:  @johanrosenkilde dlucas\n\nKeywords: polynomial matrix\n\nReviewer: David Lucas\n\nAuthor: David M\u00f6dinger, Johan Sebastian Rosenkilde Nielsen\n\nBranch: 67c5636f25e30655a6cc5084f6e426fb181049ce\n\nDependencies: #16888\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16896\n\n",
    "closed_at": "2015-12-24T23:46:46Z",
    "created_at": "2014-08-28T13:30:57Z",
    "labels": [
        "component: linear algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "rework of row_reduced_form/weak_popov_form calling convention",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16896",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```
The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.

1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.

2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.

3. When the input is a matrix over a polynomial ring, it returns the output as over the fraction field, though the output always *lie* in the polynomial ring. This is senseless and confusing.

I've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...

CC:  @johanrosenkilde dlucas

Keywords: polynomial matrix

Reviewer: David Lucas

Author: David MÃ¶dinger, Johan Sebastian Rosenkilde Nielsen

Branch: 67c5636f25e30655a6cc5084f6e426fb181049ce

Dependencies: #16888

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16896





---

archive/issue_comments_234097.json:
```json
{
    "body": "Changing keywords from \"\" to \"weak-popov-form matrix\".",
    "created_at": "2014-08-28T13:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234097",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing keywords from "" to "weak-popov-form matrix".



---

archive/issue_comments_234098.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to linear algebra.",
    "created_at": "2014-08-28T13:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234098",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing component from PLEASE CHANGE to linear algebra.



---

archive/issue_comments_234099.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2014-08-28T13:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234099",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_234100.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,13 @@\n+See also #16888\n \n+While renaming I see this as a chance to correct some (in my opinion) strange behavior of the method:\n+\n+\n+1. It takes a parameter ascend but does not relay it to the function (it is entirely ignored)\n+2. It takes a parameter ascend which is not related to either weak Popov form or row reduced form\n+3. It returns a 3-touple even though it is only expected to compute the wpf/rrf\n+4. d of the 3-touple and the sorting is unnecessary computation and should probably not be part of the method.\n+5. while N is nice to check some things, in my opinion it should only be given if asked for\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2014-08-28T13:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234100",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,13 @@
+See also #16888
 
+While renaming I see this as a chance to correct some (in my opinion) strange behavior of the method:
+
+
+1. It takes a parameter ascend but does not relay it to the function (it is entirely ignored)
+2. It takes a parameter ascend which is not related to either weak Popov form or row reduced form
+3. It returns a 3-touple even though it is only expected to compute the wpf/rrf
+4. d of the 3-touple and the sorting is unnecessary computation and should probably not be part of the method.
+5. while N is nice to check some things, in my opinion it should only be given if asked for
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_234101.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-08T08:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234101",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_234102.json:
```json
{
    "body": "<a id='comment:4'></a>New commits:",
    "created_at": "2014-09-08T08:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234102",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

<a id='comment:4'></a>New commits:



---

archive/issue_comments_234103.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-07T10:56:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234103",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234104.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-07T13:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234104",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_049358.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/dlucas",
    "created_at": "2015-05-06T12:05:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16896#event-49358"
}
```



---

archive/issue_comments_234105.json:
```json
{
    "body": "<a id='comment:7'></a>Hello,\n\nA few comments on this ticket:\n\n1) Merge with latest beta of Sage is not possible as is, as some conflicts arise with the merge. It needs to be fixed.\n\n2) There are some trailing whitespaces in both `matrix2.pyx` and `matrix_misc.py`, it will be good to remove them.\n\n3) The documentation of `row_reduced_form` mentions weak Popov form several times, like:\n\n```\n\n OUTPUT:\n\n        `W` - a matrix over `k(x)` giving a weak the Popov form of self\n```\n\nbut as far as I understand it, `row_reduced_form` does not compute the weak Popov form, for instance:\n\n```\nsage: R.<t> = QQ['t']\nsage: M = matrix([[t,t,t^2],[0,0,t], [0, t, 0]])\nsage: M.row_reduced_form()\n[t t 0]\n[0 0 t]\n[0 t 0]\n``` \ndoes not output a matrix in wPf as leading positions are the same for the first and third third rows of `M`. In that case, change occurences of weak Popov form by row reduced form.\n\n4) It could be nice to add another example in `matrix_misc.py` to illustrate the output in the case where `transformation=True`.\n\n5) You changed the arguments of `row_reduced_form` in this ticket. But in #16742, you will get the original implementation of `row_reduced_form`, which might create a conflict between the two tickets. You need to add a dependency somewhere to be sure that the merge goes smoothly.",
    "created_at": "2015-05-06T12:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234105",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:7'></a>Hello,

A few comments on this ticket:

1) Merge with latest beta of Sage is not possible as is, as some conflicts arise with the merge. It needs to be fixed.

2) There are some trailing whitespaces in both `matrix2.pyx` and `matrix_misc.py`, it will be good to remove them.

3) The documentation of `row_reduced_form` mentions weak Popov form several times, like:

```

 OUTPUT:

        `W` - a matrix over `k(x)` giving a weak the Popov form of self
```

but as far as I understand it, `row_reduced_form` does not compute the weak Popov form, for instance:

```
sage: R.<t> = QQ['t']
sage: M = matrix([[t,t,t^2],[0,0,t], [0, t, 0]])
sage: M.row_reduced_form()
[t t 0]
[0 0 t]
[0 t 0]
``` 
does not output a matrix in wPf as leading positions are the same for the first and third third rows of `M`. In that case, change occurences of weak Popov form by row reduced form.

4) It could be nice to add another example in `matrix_misc.py` to illustrate the output in the case where `transformation=True`.

5) You changed the arguments of `row_reduced_form` in this ticket. But in #16742, you will get the original implementation of `row_reduced_form`, which might create a conflict between the two tickets. You need to add a dependency somewhere to be sure that the merge goes smoothly.



---

archive/issue_comments_234106.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-06T12:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234106",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_234107.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-06T13:57:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234107",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234108.json:
```json
{
    "body": "<a id='comment:10'></a>Tried to rebase the commits for 6.8beta or at least 6.7 and solve all conflicts. Rework of comments including the term \"weak Popov form\" are yet to be done and testing/doctesting of current changes.",
    "created_at": "2015-07-06T14:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234108",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

<a id='comment:10'></a>Tried to rebase the commits for 6.8beta or at least 6.7 and solve all conflicts. Rework of comments including the term "weak Popov form" are yet to be done and testing/doctesting of current changes.



---

archive/issue_comments_234109.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-07T09:09:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234109",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234110.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-07T09:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234110",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_234111.json:
```json
{
    "body": "<a id='comment:12'></a>I tried to incorporate the suggestions and create a patchable commit. Doctests and compilation/integration are working for me on sages git master branch.",
    "created_at": "2015-07-07T09:11:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234111",
    "user": "https://trac.sagemath.org/admin/accounts/users/ketzu"
}
```

<a id='comment:12'></a>I tried to incorporate the suggestions and create a patchable commit. Doctests and compilation/integration are working for me on sages git master branch.



---

archive/issue_comments_234112.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-04T14:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234112",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234113.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,10 @@\n+The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.\n \n+1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.\n+\n+2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.\n+\n+I've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2015-12-04T14:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234113",
    "user": "https://github.com/johanrosenkilde"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,10 @@
+The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.
 
+1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.
+
+2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.
+
+I've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_234114.json:
```json
{
    "body": "Changing keywords from \"weak-popov-form matrix\" to \"polynomial matrix\".",
    "created_at": "2015-12-04T14:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234114",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing keywords from "weak-popov-form matrix" to "polynomial matrix".



---

archive/issue_comments_234115.json:
```json
{
    "body": "<a id='comment:15'></a>I rewrote the patch because it didn't really fix the calling convention, while it still broke backwards compatibility without proper deprecation warnings. Now, the patch does as the new description says.\n\nIt's again at needs review.",
    "created_at": "2015-12-04T14:17:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234115",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:15'></a>I rewrote the patch because it didn't really fix the calling convention, while it still broke backwards compatibility without proper deprecation warnings. Now, the patch does as the new description says.

It's again at needs review.



---

archive/issue_comments_234116.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-14T09:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234116",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_234117.json:
```json
{
    "body": "<a id='comment:16'></a>I guess I'm bad news' harbinger again, as I noticed the following:\n\n```\nsage: PR.<x> = GF(7)[]\nsage: M = random_matrix(PR, 5, 5)\nsage: type(M)\n<type 'sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint'>\nsage: type(M.row_reduced_form(transformation=False, old_call=False)[0, 0])\n<type 'sage.rings.fraction_field_FpT.FpTElement'>\n```\n\nSo it seems that the actual implementation messes with the type of the elements in the matrix, which is never a good thing...\n\nDavid",
    "created_at": "2015-12-14T09:59:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234117",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:16'></a>I guess I'm bad news' harbinger again, as I noticed the following:

```
sage: PR.<x> = GF(7)[]
sage: M = random_matrix(PR, 5, 5)
sage: type(M)
<type 'sage.rings.polynomial.polynomial_zmod_flint.Polynomial_zmod_flint'>
sage: type(M.row_reduced_form(transformation=False, old_call=False)[0, 0])
<type 'sage.rings.fraction_field_FpT.FpTElement'>
```

So it seems that the actual implementation messes with the type of the elements in the matrix, which is never a good thing...

David



---

archive/issue_comments_234118.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.\n \n+1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.\n+\n+2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.\n+\n+3. When the input is a matrix over a polynomial ring, it returns the output as over the fraction field, though the output always *lie* in the polynomial ring.\n+\n+I've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2015-12-14T16:21:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234118",
    "user": "https://github.com/johanrosenkilde"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.
 
+1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.
+
+2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.
+
+3. When the input is a matrix over a polynomial ring, it returns the output as over the fraction field, though the output always *lie* in the polynomial ring.
+
+I've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_234119.json:
```json
{
    "body": "<a id='comment:17'></a>That has been the behaviour of the function always, so it's not the \"fault\" of this patch. It is, however, rather stupid, as it is because of the division with `R.one()` (named `den`) in the return line of `row_reduced_form` in `matrix_misc.py`.\n\nSo, let's say it was broken behaviour before, so we can change it without doing the deprecation-dance...",
    "created_at": "2015-12-14T16:21:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234119",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:17'></a>That has been the behaviour of the function always, so it's not the "fault" of this patch. It is, however, rather stupid, as it is because of the division with `R.one()` (named `den`) in the return line of `row_reduced_form` in `matrix_misc.py`.

So, let's say it was broken behaviour before, so we can change it without doing the deprecation-dance...



---

archive/issue_comments_234120.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-14T16:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234120",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234121.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-12-14T17:01:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234121",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_234122.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n+The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.\n \n+1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.\n+\n+2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.\n+\n+3. When the input is a matrix over a polynomial ring, it returns the output as over the fraction field, though the output always *lie* in the polynomial ring. This is senseless and confusing.\n+\n+I've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...\n \n Component: PLEASE CHANGE\n \n``````\n",
    "created_at": "2015-12-14T17:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234122",
    "user": "https://github.com/johanrosenkilde"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
+The calling convention of `row_reduced_form` and `weak_popov_form` is bizarre and should be fixed.
 
+1. It takes a parameter `ascend` but this is ignored. It's original purpose was something like sorting the rows, but this is not part of weak Popov form or row reduced, and shouldn't pollute this method.
+
+2. It returns a 3-tuple `(W,U,d)`. Usually, `W` is the only object of interest (the row reduced form), while `U` is a transformation matrix which can sometimes be useful. `d` can be computed directly from `W` and shouldn't be returned at all.
+
+3. When the input is a matrix over a polynomial ring, it returns the output as over the fraction field, though the output always *lie* in the polynomial ring. This is senseless and confusing.
+
+I've added optional parameters `transformation = False` for returning `U`. To enable printing a deprecation warning for at least a year while supporting the old call style, I've added optional parameter `old_call = True`. Set this to `False` to get the future call style and disable deprecation warning. In one year, we'll change the default behaviour but retain `old_call` as an acceptable argument, but print a deprecation warning if one sets it. In two years, we can finally remove `old_call` and have the clean calling convention. <sigh>...
 
 Component: PLEASE CHANGE
 
``````




---

archive/issue_comments_234123.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-14T17:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234123",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_234124.json:
```json
{
    "body": "<a id='comment:20'></a>Done!",
    "created_at": "2015-12-14T17:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234124",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:20'></a>Done!



---

archive/issue_comments_234125.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-12-15T09:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234125",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_234126.json:
```json
{
    "body": "<a id='comment:21'></a>Ok, it passes the tests and fixes the bug I noticed, to me it's good to go.",
    "created_at": "2015-12-15T09:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234126",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

<a id='comment:21'></a>Ok, it passes the tests and fixes the bug I noticed, to me it's good to go.



---

archive/issue_comments_234127.json:
```json
{
    "body": "<a id='comment:22'></a>Cool, thanks!",
    "created_at": "2015-12-15T10:47:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234127",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:22'></a>Cool, thanks!



---

archive/issue_events_049359.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/dlucas",
    "created_at": "2015-12-17T09:36:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16896#event-49359"
}
```



---

archive/issue_events_049360.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/dlucas",
    "created_at": "2015-12-17T09:36:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16896#event-49360"
}
```



---

archive/issue_comments_234128.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-12-23T11:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234128",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_234129.json:
```json
{
    "body": "<a id='comment:24'></a>The reviewer name is supposed to be your real name, not trac account",
    "created_at": "2015-12-23T11:08:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234129",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>The reviewer name is supposed to be your real name, not trac account



---

archive/issue_comments_234130.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-12-23T11:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234130",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_049361.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-12-24T23:46:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16896#event-49361"
}
```



---

archive/issue_comments_234131.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-12-24T23:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16896",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16896#issuecomment-234131",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
