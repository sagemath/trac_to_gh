# Issue 16247: Meaning of Modules(R) currently not very clear

archive/issues_016010.json:
```json
{
    "assignees": [],
    "body": "The doc of `class Modules` currently (#10963) says:\n\n```\n    The category of all modules over a base ring `R`.\n\n    An `R`-module `M` is a left and right `R`-module over a\n    commutative ring `R` such that:\n\n    .. math::  r*(x*s) = (r*x)*s \\qquad  \\forall r,s \\in R \\text{ and } x \\in M\n```\n\nThis is not the notion of a module that mathematicians are used to, not even when R is commutative. Instead, this is the definition of an R-R-bimodule. I fear that this is destined to lead to confusion and subtle bugs. For instance, the `WithBasis` subcategory implements methods like \"basis\" and \"support\". But a left R-module basis of an R-R-bimodule might not be a right R-module basis, and even if it is, the supports of one and the same element with respect to it (one time as a left R-module basis, another time as a right one) might be different. I have not seen the `WithBasis` subcategory being used in problematic cases (i.e., in cases where the left and right structure are different), but I fear that this is bound to eventually happen.\n\nI've run the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. Here are the relevant results:\n\nhttps://www.dropbox.com/s/oieg1ig0dliz63s/noncomm.txt\n\nIt seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. I think they should be bimodules, since there is a `Bimodules(R, R)` category already.\n\nApparently people have been aware of this for a while; the following warning message is doctested for and not written by me:\n\n```\n    doctest:...: UserWarning: You are constructing a free module\n    over a noncommutative ring. Sage does not have a concept\n    of left/right and both sided modules, so be careful.\n    It's also not guaranteed that all multiplications are\n    done from the right side.\n```\n(We do have left/right/bi-modules now.)\n\nThere are some tracebacks I don't really understand... can it be that some methods in Sage construct matrices consisting of matrices? There's nothing wrong about that; I just think the constructor for the respective matrix spaces should pick the right category for that.\n\nHere are some options:\n\n- Make `Modules` only support *symmetric* modules, i.e. modules M satisfying rx = xr for all r in R and x in M. This is useful almost only for commutative R (in fact, these modules are always modules over the abelianization of R).\n\n- Make `Modules` only support R-R-bimodules which are direct sums of copies of the R-R-bimodule R. This allows for doing most things that can be done in the commutative case, and examples are polynomial rings over noncommutative rings, matrix spaces etc. -- I actually like this category. The only problem is that it is more of a \"ModulesWithBasis\" category than a \"Modules\" category.\n\n- Make `Modules` only support R-R-bimodules which are sums (not necessarily direct) of copies of the R-R-bimodule R. This looks like a reasonable category but I know almost none of its properties.\n\nDepends on #10963\n\nCC:  @nthiery @simon-king-jena @orlitzky\n\nComponent: **algebra**\n\nKeywords: **modules, associativity, matrices**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16247_\n\n",
    "created_at": "2014-04-27T03:42:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20categories"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Meaning of Modules(R) currently not very clear",
    "type": "issue",
    "updated_at": "2022-08-31T02:51:13Z",
    "url": "https://github.com/sagemath/sage/issues/16247",
    "user": "https://github.com/darijgr"
}
```
The doc of `class Modules` currently (#10963) says:

```
    The category of all modules over a base ring `R`.

    An `R`-module `M` is a left and right `R`-module over a
    commutative ring `R` such that:

    .. math::  r*(x*s) = (r*x)*s \qquad  \forall r,s \in R \text{ and } x \in M
```

This is not the notion of a module that mathematicians are used to, not even when R is commutative. Instead, this is the definition of an R-R-bimodule. I fear that this is destined to lead to confusion and subtle bugs. For instance, the `WithBasis` subcategory implements methods like "basis" and "support". But a left R-module basis of an R-R-bimodule might not be a right R-module basis, and even if it is, the supports of one and the same element with respect to it (one time as a left R-module basis, another time as a right one) might be different. I have not seen the `WithBasis` subcategory being used in problematic cases (i.e., in cases where the left and right structure are different), but I fear that this is bound to eventually happen.

I've run the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. Here are the relevant results:

https://www.dropbox.com/s/oieg1ig0dliz63s/noncomm.txt

It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. I think they should be bimodules, since there is a `Bimodules(R, R)` category already.

Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:

```
    doctest:...: UserWarning: You are constructing a free module
    over a noncommutative ring. Sage does not have a concept
    of left/right and both sided modules, so be careful.
    It's also not guaranteed that all multiplications are
    done from the right side.
```
(We do have left/right/bi-modules now.)

There are some tracebacks I don't really understand... can it be that some methods in Sage construct matrices consisting of matrices? There's nothing wrong about that; I just think the constructor for the respective matrix spaces should pick the right category for that.

Here are some options:

- Make `Modules` only support *symmetric* modules, i.e. modules M satisfying rx = xr for all r in R and x in M. This is useful almost only for commutative R (in fact, these modules are always modules over the abelianization of R).

- Make `Modules` only support R-R-bimodules which are direct sums of copies of the R-R-bimodule R. This allows for doing most things that can be done in the commutative case, and examples are polynomial rings over noncommutative rings, matrix spaces etc. -- I actually like this category. The only problem is that it is more of a "ModulesWithBasis" category than a "Modules" category.

- Make `Modules` only support R-R-bimodules which are sums (not necessarily direct) of copies of the R-R-bimodule R. This looks like a reasonable category but I know almost none of its properties.

Depends on #10963

CC:  @nthiery @simon-king-jena @orlitzky

Component: **algebra**

Keywords: **modules, associativity, matrices**

_Issue created by migration from https://trac.sagemath.org/ticket/16247_





---

archive/issue_events_229880.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2014-04-27T03:42:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229880"
}
```



---

archive/issue_events_229881.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2014-04-27T03:42:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229881"
}
```



---

archive/issue_events_229882.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2014-04-27T03:42:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229882"
}
```



---

archive/issue_events_229883.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2014-04-27T03:42:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229883"
}
```



---

archive/issue_events_229884.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2014-04-27T03:42:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20categories",
    "label_color": "0000ff",
    "label_name": "c: categories",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229884"
}
```



---

archive/issue_comments_207824.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-We have `LeftModules` and `RightModules` functorial constructions (not sure if since #10963 or already before), and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.\n+We have `LeftModules` and `RightModules` functorial constructions, and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.\n \n I'm currently running the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. I'll post the results once it's done. So far:\n \n@@ -12,3 +12,22 @@\n Doctests interrupted: 231/2069 files tested\n ----------------------------------------------------------------------\n ```\n+It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing instead of use the defaults from the `Modules` category.\n+\n+Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:\n+\n+```\n+    doctest:...: UserWarning: You are constructing a free module\n+    over a noncommutative ring. Sage does not have a concept\n+    of left/right and both sided modules, so be careful.\n+    It's also not guaranteed that all multiplications are\n+    done from the right side.\n+    doctest:...: UserWarning: You are constructing a free module\n+    over a noncommutative ring. Sage does not have a concept\n+    of left/right and both sided modules, so be careful.\n+    It's also not guaranteed that all multiplications are\n+    done from the right side.\n+```\n+(We do have left/right/bi-modules now.)\n+\n+There are some tracebacks I don't really understand... can it be that some methods in Sage construct matrices consisting of matrices? There's nothing wrong about that; I just think the constructor for the respective matrix spaces should pick the right category for that.\n``````\n",
    "created_at": "2014-04-27T03:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207824",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-We have `LeftModules` and `RightModules` functorial constructions (not sure if since #10963 or already before), and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.
+We have `LeftModules` and `RightModules` functorial constructions, and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.
 
 I'm currently running the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. I'll post the results once it's done. So far:
 
@@ -12,3 +12,22 @@
 Doctests interrupted: 231/2069 files tested
 ----------------------------------------------------------------------
 ```
+It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing instead of use the defaults from the `Modules` category.
+
+Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:
+
+```
+    doctest:...: UserWarning: You are constructing a free module
+    over a noncommutative ring. Sage does not have a concept
+    of left/right and both sided modules, so be careful.
+    It's also not guaranteed that all multiplications are
+    done from the right side.
+    doctest:...: UserWarning: You are constructing a free module
+    over a noncommutative ring. Sage does not have a concept
+    of left/right and both sided modules, so be careful.
+    It's also not guaranteed that all multiplications are
+    done from the right side.
+```
+(We do have left/right/bi-modules now.)
+
+There are some tracebacks I don't really understand... can it be that some methods in Sage construct matrices consisting of matrices? There's nothing wrong about that; I just think the constructor for the respective matrix spaces should pick the right category for that.
``````




---

archive/issue_comments_207825.json:
```json
{
    "body": "Changed keywords from **modules, associativity** to **modules, associativity, matrices**",
    "created_at": "2014-04-27T03:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207825",
    "user": "https://github.com/darijgr"
}
```

Changed keywords from **modules, associativity** to **modules, associativity, matrices**



---

archive/issue_comments_207826.json:
```json
{
    "body": "Dependencies: **10963**",
    "created_at": "2014-04-27T03:57:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207826",
    "user": "https://github.com/darijgr"
}
```

Dependencies: **10963**



---

archive/issue_comments_207827.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,7 +12,7 @@\n Doctests interrupted: 231/2069 files tested\n ----------------------------------------------------------------------\n ```\n-It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing instead of use the defaults from the `Modules` category.\n+It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing (oops!) instead of use the defaults from the `Modules` category.\n \n Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:\n \n``````\n",
    "created_at": "2014-04-27T03:57:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207827",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,7 +12,7 @@
 Doctests interrupted: 231/2069 files tested
 ----------------------------------------------------------------------
 ```
-It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing instead of use the defaults from the `Modules` category.
+It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing (oops!) instead of use the defaults from the `Modules` category.
 
 Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:
 
``````




---

archive/issue_comments_207828.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,17 +1,9 @@\n We have `LeftModules` and `RightModules` functorial constructions, and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.\n \n-I'm currently running the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. I'll post the results once it's done. So far:\n+I've run the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. Here are the relevant results:\n \n-```\n-----------------------------------------------------------------------\n-sage -t src/sage/groups/finitely_presented.py  # 2 doctests failed\n-sage -t src/sage/matrix/matrix_sparse.pyx  # 4 doctests failed\n-sage -t src/sage/matrix/matrix0.pyx  # 5 doctests failed\n-sage -t src/sage/matrix/matrix2.pyx  # 1 doctest failed\n-sage -t src/sage/matrix/matrix_space.py  # 2 doctests failed\n-Doctests interrupted: 231/2069 files tested\n-----------------------------------------------------------------------\n-```\n+https://www.dropbox.com/s/oieg1ig0dliz63s/noncomm.txt\n+\n It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing (oops!) instead of use the defaults from the `Modules` category.\n \n Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:\n@@ -22,11 +14,6 @@\n     of left/right and both sided modules, so be careful.\n     It's also not guaranteed that all multiplications are\n     done from the right side.\n-    doctest:...: UserWarning: You are constructing a free module\n-    over a noncommutative ring. Sage does not have a concept\n-    of left/right and both sided modules, so be careful.\n-    It's also not guaranteed that all multiplications are\n-    done from the right side.\n ```\n (We do have left/right/bi-modules now.)\n \n``````\n",
    "created_at": "2014-04-27T05:37:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207828",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,17 +1,9 @@
 We have `LeftModules` and `RightModules` functorial constructions, and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.
 
-I'm currently running the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. I'll post the results once it's done. So far:
+I've run the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. Here are the relevant results:
 
-```
-----------------------------------------------------------------------
-sage -t src/sage/groups/finitely_presented.py  # 2 doctests failed
-sage -t src/sage/matrix/matrix_sparse.pyx  # 4 doctests failed
-sage -t src/sage/matrix/matrix0.pyx  # 5 doctests failed
-sage -t src/sage/matrix/matrix2.pyx  # 1 doctest failed
-sage -t src/sage/matrix/matrix_space.py  # 2 doctests failed
-Doctests interrupted: 231/2069 files tested
-----------------------------------------------------------------------
-```
+https://www.dropbox.com/s/oieg1ig0dliz63s/noncomm.txt
+
 It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing (oops!) instead of use the defaults from the `Modules` category.
 
 Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:
@@ -22,11 +14,6 @@
     of left/right and both sided modules, so be careful.
     It's also not guaranteed that all multiplications are
     done from the right side.
-    doctest:...: UserWarning: You are constructing a free module
-    over a noncommutative ring. Sage does not have a concept
-    of left/right and both sided modules, so be careful.
-    It's also not guaranteed that all multiplications are
-    done from the right side.
 ```
 (We do have left/right/bi-modules now.)
 
``````




---

archive/issue_comments_207829.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThanks for exploring how to clean this up.\n\nJust for the record: we have had left/right/bimodules since 2009 and probably even before. Also, at this point, they are just categories over a base ring, not functorial constructions.\n\nOne thing to check is how this was handled in Axiom. MuPAD was roughly as here: on the lousy side in the non commutative case.",
    "created_at": "2014-04-27T07:08:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207829",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:4" align="right">comment:4</div>

Thanks for exploring how to clean this up.

Just for the record: we have had left/right/bimodules since 2009 and probably even before. Also, at this point, they are just categories over a base ring, not functorial constructions.

One thing to check is how this was handled in Axiom. MuPAD was roughly as here: on the lousy side in the non commutative case.



---

archive/issue_events_229885.json:
```json
{
    "actor": "https://github.com/darijgr",
    "created_at": "2014-04-29T02:22:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "title_is": "Meaning of Modules(R) currently not very clear",
    "title_was": "Abuse of Modules() for modules over noncommutative rings",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229885"
}
```



---

archive/issue_comments_207830.json:
```json
{
    "body": "Changed dependencies from **10963** to **#10963**",
    "created_at": "2014-04-29T02:22:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207830",
    "user": "https://github.com/darijgr"
}
```

Changed dependencies from **10963** to **#10963**



---

archive/issue_comments_207831.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,21 @@\n-We have `LeftModules` and `RightModules` functorial constructions, and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.\n+The doc of `class Modules` currently (#10963) says:\n+\n+```\n+    The category of all modules over a base ring `R`.\n+\n+    An `R`-module `M` is a left and right `R`-module over a\n+    commutative ring `R` such that:\n+\n+    .. math::  r*(x*s) = (r*x)*s \\qquad  \\forall r,s \\in R \\text{ and } x \\in M\n+```\n+\n+This is not the notion of a module that mathematicians are used to, not even when R is commutative. Instead, this is the definition of an R-R-bimodule. I fear that this is destined to lead to confusion and subtle bugs. For instance, the `WithBasis` subcategory implements methods like \"basis\" and \"support\". But a left R-module basis of an R-R-bimodule might not be a right R-module basis, and even if it is, the supports of one and the same element with respect to it (one time as a left R-module basis, another time as a right one) might be different. I have not seen the `WithBasis` subcategory being used in problematic cases (i.e., in cases where the left and right structure are different), but I fear that this is bound to eventually happen.\n \n I've run the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. Here are the relevant results:\n \n https://www.dropbox.com/s/oieg1ig0dliz63s/noncomm.txt\n \n-It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing (oops!) instead of use the defaults from the `Modules` category.\n+It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. I think they should be bimodules, since there is a `Bimodules(R, R)` category already.\n \n Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:\n \n@@ -18,3 +29,11 @@\n (We do have left/right/bi-modules now.)\n \n There are some tracebacks I don't really understand... can it be that some methods in Sage construct matrices consisting of matrices? There's nothing wrong about that; I just think the constructor for the respective matrix spaces should pick the right category for that.\n+\n+Here are some options:\n+\n+- Make `Modules` only support *symmetric* modules, i.e. modules M satisfying rx = xr for all r in R and x in M. This is useful almost only for commutative R (in fact, these modules are always modules over the abelianization of R).\n+\n+- Make `Modules` only support R-R-bimodules which are direct sums of copies of the R-R-bimodule R. This allows for doing most things that can be done in the commutative case, and examples are polynomial rings over noncommutative rings, matrix spaces etc. -- I actually like this category. The only problem is that it is more of a \"ModulesWithBasis\" category than a \"Modules\" category.\n+\n+- Make `Modules` only support R-R-bimodules which are sums (not necessarily direct) of copies of the R-R-bimodule R. This looks like a reasonable category but I know almost none of its properties.\n``````\n",
    "created_at": "2014-04-29T02:22:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207831",
    "user": "https://github.com/darijgr"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,21 @@
-We have `LeftModules` and `RightModules` functorial constructions, and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.
+The doc of `class Modules` currently (#10963) says:
+
+```
+    The category of all modules over a base ring `R`.
+
+    An `R`-module `M` is a left and right `R`-module over a
+    commutative ring `R` such that:
+
+    .. math::  r*(x*s) = (r*x)*s \qquad  \forall r,s \in R \text{ and } x \in M
+```
+
+This is not the notion of a module that mathematicians are used to, not even when R is commutative. Instead, this is the definition of an R-R-bimodule. I fear that this is destined to lead to confusion and subtle bugs. For instance, the `WithBasis` subcategory implements methods like "basis" and "support". But a left R-module basis of an R-R-bimodule might not be a right R-module basis, and even if it is, the supports of one and the same element with respect to it (one time as a left R-module basis, another time as a right one) might be different. I have not seen the `WithBasis` subcategory being used in problematic cases (i.e., in cases where the left and right structure are different), but I fear that this is bound to eventually happen.
 
 I've run the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. Here are the relevant results:
 
 https://www.dropbox.com/s/oieg1ig0dliz63s/noncomm.txt
 
-It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. They should be bimodules! The reason why this doesn't blow up in the user's face (well, as far as I can tell) is that (I guess) the matrix space classes override the `*` operator to do the right thing (oops!) instead of use the defaults from the `Modules` category.
+It seems that matrices over noncommutative rings are the main culprit here -- or, rather, matrix spaces being cast as modules over the base rings. I think they should be bimodules, since there is a `Bimodules(R, R)` category already.
 
 Apparently people have been aware of this for a while; the following warning message is doctested for and not written by me:
 
@@ -18,3 +29,11 @@
 (We do have left/right/bi-modules now.)
 
 There are some tracebacks I don't really understand... can it be that some methods in Sage construct matrices consisting of matrices? There's nothing wrong about that; I just think the constructor for the respective matrix spaces should pick the right category for that.
+
+Here are some options:
+
+- Make `Modules` only support *symmetric* modules, i.e. modules M satisfying rx = xr for all r in R and x in M. This is useful almost only for commutative R (in fact, these modules are always modules over the abelianization of R).
+
+- Make `Modules` only support R-R-bimodules which are direct sums of copies of the R-R-bimodule R. This allows for doing most things that can be done in the commutative case, and examples are polynomial rings over noncommutative rings, matrix spaces etc. -- I actually like this category. The only problem is that it is more of a "ModulesWithBasis" category than a "Modules" category.
+
+- Make `Modules` only support R-R-bimodules which are sums (not necessarily direct) of copies of the R-R-bimodule R. This looks like a reasonable category but I know almost none of its properties.
``````




---

archive/issue_events_229886.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229886"
}
```



---

archive/issue_events_229887.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229887"
}
```



---

archive/issue_events_229888.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229888"
}
```



---

archive/issue_events_229889.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229889"
}
```



---

archive/issue_events_229890.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T16:50:02Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229890"
}
```



---

archive/issue_events_229891.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2020-08-17T16:50:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229891"
}
```



---

archive/issue_events_229892.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229892"
}
```



---

archive/issue_events_229893.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-13T20:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229893"
}
```



---

archive/issue_comments_207832.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSetting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207832",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:9" align="right">comment:9</div>

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_events_229894.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229894"
}
```



---

archive/issue_events_229895.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T01:43:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229895"
}
```



---

archive/issue_comments_207833.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI got here through #32250, in which I propose a precise definition for (magmatic) algebras over an associative unital ring, and [#32250 comment:2](https://github.com/sagemath/sage/issues/32250#comment:2).\n\nMy personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.",
    "created_at": "2021-07-27T11:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207833",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:11" align="right">comment:11</div>

I got here through #32250, in which I propose a precise definition for (magmatic) algebras over an associative unital ring, and [#32250 comment:2](https://github.com/sagemath/sage/issues/32250#comment:2).

My personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.



---

archive/issue_comments_207834.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@pjbruin](#comment%3A11):\n> \n> My personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.\n\nI agree. This is what the existing `Modules?` docstring is trying to say. The cited `UserWarning` more or less says that your ring should be commutative, and that your left- and right-module actions had better be the same. The definition should match what Sage is actually capable of.\n\nThis would leave us with new problem though, that of defining a symmetric bimodule within sage. Maybe we should just be explicit about the axioms instead of using that term.",
    "created_at": "2021-07-30T11:41:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16247#issuecomment-207834",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@pjbruin](#comment%3A11):
> 
> My personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.

I agree. This is what the existing `Modules?` docstring is trying to say. The cited `UserWarning` more or less says that your ring should be commutative, and that your left- and right-module actions had better be the same. The definition should match what Sage is actually capable of.

This would leave us with new problem though, that of defining a symmetric bimodule within sage. Maybe we should just be explicit about the axioms instead of using that term.



---

archive/issue_events_229896.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229896"
}
```



---

archive/issue_events_229897.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T02:04:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229897"
}
```



---

archive/issue_events_229898.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229898"
}
```



---

archive/issue_events_229899.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-04-01T21:16:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229899"
}
```



---

archive/issue_events_229900.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229900"
}
```



---

archive/issue_events_229901.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16247",
    "milestone_number": null,
    "milestone_title": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16247#event-229901"
}
```
