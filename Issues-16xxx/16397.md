# Issue 16397: Symbolic cmp

archive/issues_016160.json:
```json
{
    "body": "In the symbolic ring, cmp implements the print comparison which is probably not what you envisioned:\n\n```\nsage: cmp(1, sqrt(2))     # mathematically correct, uses rich comparison\n-1\nsage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order\n1\nsage: cmp(log(8), 3*log(2))\n-1\n```\nEverybody who coerces to same parents internally before comparing trips over this, for example the real lazy field:\n\n```\nsage: RLF(1) < RLF(sqrt(2))\nFalse\n```\nThis also makes `RealSet` unusable with symbolics:\n\n```\nsage: RealSet((0, pi),[pi, pi],(pi,4))\n[pi, 4)\nsage: RealSet((0, pi),[0, pi],(pi,4))\n[pi, 4)\nsage: RealSet((0, pi),[0, 3.5],(pi,4))\n(pi, 4)\n```\n\n\nCC:  @videlec @mezzarobba jpflori\n\nBranch/Commit: 07f12cdfd14f3a7af5445aab7419c0ddaea1074d\n\nReviewer: Ralf Stephan, Volker Braun\n\nAuthor: Volker Braun, Ralf Stephan\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16397\n\n",
    "closed_at": "2016-04-16T15:35:38Z",
    "created_at": "2014-05-25T17:25:28Z",
    "labels": [
        "component: symbolics",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "Symbolic cmp",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16397",
    "user": "https://github.com/vbraun"
}
```
In the symbolic ring, cmp implements the print comparison which is probably not what you envisioned:

```
sage: cmp(1, sqrt(2))     # mathematically correct, uses rich comparison
-1
sage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order
1
sage: cmp(log(8), 3*log(2))
-1
```
Everybody who coerces to same parents internally before comparing trips over this, for example the real lazy field:

```
sage: RLF(1) < RLF(sqrt(2))
False
```
This also makes `RealSet` unusable with symbolics:

```
sage: RealSet((0, pi),[pi, pi],(pi,4))
[pi, 4)
sage: RealSet((0, pi),[0, pi],(pi,4))
[pi, 4)
sage: RealSet((0, pi),[0, 3.5],(pi,4))
(pi, 4)
```


CC:  @videlec @mezzarobba jpflori

Branch/Commit: 07f12cdfd14f3a7af5445aab7419c0ddaea1074d

Reviewer: Ralf Stephan, Volker Braun

Author: Volker Braun, Ralf Stephan

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16397





---

archive/issue_comments_274147.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,8 @@\n+In the symbolic ring, cmp implements the print comparison which is probably not what you envisioned:\n \n+```\n+sage: cmp(1, sqrt(2))     # mathematically correct, uses rich comparison\n+-1\n+sage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order\n+1\n+```\n``````\n",
    "created_at": "2014-05-25T17:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274147",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,8 @@
+In the symbolic ring, cmp implements the print comparison which is probably not what you envisioned:
 
+```
+sage: cmp(1, sqrt(2))     # mathematically correct, uses rich comparison
+-1
+sage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order
+1
+```
``````




---

archive/issue_comments_274148.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,3 +6,10 @@\n sage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order\n 1\n ```\n+Everybody who coerces to same parents internally before comparing trips over this, for example the real lazy field:\n+\n+```\n+sage: RLF(1) < RLF(sqrt(2))\n+False\n+```\n+\n``````\n",
    "created_at": "2014-05-25T17:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274148",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,3 +6,10 @@
 sage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order
 1
 ```
+Everybody who coerces to same parents internally before comparing trips over this, for example the real lazy field:
+
+```
+sage: RLF(1) < RLF(sqrt(2))
+False
+```
+
``````




---

archive/issue_comments_274149.json:
```json
{
    "body": "<a id='comment:3'></a>\nI can see how that might be surprising. :)\n\nIIRC, that was a conscious decision to expose the print order from Pynac to !Python/Sage to be used for sorting lists, etc. where symbolic expressions occur. I guess many places in the code call `cmp()` instead of using the comparison operators.\n\nWe would need to get rid of this design for Python 3 compatibility anyway. Shall we remove support for `cmp()` and change all places where lists are returned from symbolics to explicitly call the print order?",
    "created_at": "2014-05-25T18:08:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274149",
    "user": "https://github.com/burcin"
}
```

<a id='comment:3'></a>
I can see how that might be surprising. :)

IIRC, that was a conscious decision to expose the print order from Pynac to !Python/Sage to be used for sorting lists, etc. where symbolic expressions occur. I guess many places in the code call `cmp()` instead of using the comparison operators.

We would need to get rid of this design for Python 3 compatibility anyway. Shall we remove support for `cmp()` and change all places where lists are returned from symbolics to explicitly call the print order?



---

archive/issue_comments_274150.json:
```json
{
    "body": "<a id='comment:4'></a>\nYes, thats what I'm thinking as well. I'll write a `print_order` function and see if I can get rid of all cmp calls...",
    "created_at": "2014-05-25T18:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274150",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>
Yes, thats what I'm thinking as well. I'll write a `print_order` function and see if I can get rid of all cmp calls...



---

archive/issue_comments_274151.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vbraun/symbolic_cmp\"",
    "created_at": "2014-05-25T21:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274151",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "" to "u/vbraun/symbolic_cmp"



---

archive/issue_comments_274152.json:
```json
{
    "body": "Changing commit from \"\" to \"62be17eb6eccffcddcc61e4f18a2123ec0c364d8\"",
    "created_at": "2014-05-27T14:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274152",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "62be17eb6eccffcddcc61e4f18a2123ec0c364d8"



---

archive/issue_comments_274153.json:
```json
{
    "body": "<a id='comment:6'></a>\nNew commits:\n|                                                                                                                                          |                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[62be17e](https://github.com/sagemath/sagetrac-mirror/commit/62be17eb6eccffcddcc61e4f18a2123ec0c364d8)|`print_sorted and math_sorted utility functions`|",
    "created_at": "2014-05-27T14:35:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274153",
    "user": "https://github.com/videlec"
}
```

<a id='comment:6'></a>
New commits:
|                                                                                                                                          |                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[62be17e](https://github.com/sagemath/sagetrac-mirror/commit/62be17eb6eccffcddcc61e4f18a2123ec0c364d8)|`print_sorted and math_sorted utility functions`|



---

archive/issue_events_054898.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54898"
}
```



---

archive/issue_comments_274154.json:
```json
{
    "body": "Changing branch from \"u/vbraun/symbolic_cmp\" to \"u/rws/symbolic_cmp\"",
    "created_at": "2014-09-05T16:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274154",
    "user": "https://github.com/rwst"
}
```

Changing branch from "u/vbraun/symbolic_cmp" to "u/rws/symbolic_cmp"



---

archive/issue_comments_274155.json:
```json
{
    "body": "<a id='comment:9'></a>\nTrying to push this ticket a bit. I also found this `cmp` call:\n\n```\n File \"matrix_integer_dense.pyx\", line 604, in sage.matrix.matrix_integer_dense.Matrix_integer_dense.__richcmp__ (build/cythonized/sage/matrix/matrix_integer_dense.c:9503)\n  File \"element.pyx\", line 873, in sage.structure.element.Element._richcmp (build/cythonized/sage/structure/element.c:8891)\n  File \"element.pyx\", line 855, in sage.structure.element.Element._richcmp_ (build/cythonized/sage/structure/element.c:8615)\n  File \"element.pyx\", line 902, in sage.structure.element.Element._richcmp (build/cythonized/sage/structure/element.c:9316)\n  File \"element.pyx\", line 949, in sage.structure.element.Element._richcmp_c_impl (build/cythonized/sage/structure/element.c:9645)\n  File \"matrix_dense.pyx\", line 126, in sage.matrix.matrix_dense.Matrix_dense._cmp_c_impl (build/cythonized/sage/matrix/matrix_dense.c:3092)\n  File \"expression.pyx\", line 3066, in sage.symbolic.expression.Expression.__cmp__ (build/cythonized/sage/symbolic/expression.cpp:16865)\n```\nDo I understand it right that this should call `math_sorted` instead of `cmp`?\n\n---\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[215cff4](https://github.com/sagemath/sagetrac-mirror/commit/215cff4e33f7a63e2da4cdde45c7f491046271ac)|`Merge branch 'develop' into t/16397/symbolic_cmp`|\n|[af5f800](https://github.com/sagemath/sagetrac-mirror/commit/af5f800fdc616022d503b5e845ec81ebfef7c25e)|`16397: use print_sorted() in two further places; fix doctest`|",
    "created_at": "2014-09-05T16:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274155",
    "user": "https://github.com/rwst"
}
```

<a id='comment:9'></a>
Trying to push this ticket a bit. I also found this `cmp` call:

```
 File "matrix_integer_dense.pyx", line 604, in sage.matrix.matrix_integer_dense.Matrix_integer_dense.__richcmp__ (build/cythonized/sage/matrix/matrix_integer_dense.c:9503)
  File "element.pyx", line 873, in sage.structure.element.Element._richcmp (build/cythonized/sage/structure/element.c:8891)
  File "element.pyx", line 855, in sage.structure.element.Element._richcmp_ (build/cythonized/sage/structure/element.c:8615)
  File "element.pyx", line 902, in sage.structure.element.Element._richcmp (build/cythonized/sage/structure/element.c:9316)
  File "element.pyx", line 949, in sage.structure.element.Element._richcmp_c_impl (build/cythonized/sage/structure/element.c:9645)
  File "matrix_dense.pyx", line 126, in sage.matrix.matrix_dense.Matrix_dense._cmp_c_impl (build/cythonized/sage/matrix/matrix_dense.c:3092)
  File "expression.pyx", line 3066, in sage.symbolic.expression.Expression.__cmp__ (build/cythonized/sage/symbolic/expression.cpp:16865)
```
Do I understand it right that this should call `math_sorted` instead of `cmp`?

---
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[215cff4](https://github.com/sagemath/sagetrac-mirror/commit/215cff4e33f7a63e2da4cdde45c7f491046271ac)|`Merge branch 'develop' into t/16397/symbolic_cmp`|
|[af5f800](https://github.com/sagemath/sagetrac-mirror/commit/af5f800fdc616022d503b5e845ec81ebfef7c25e)|`16397: use print_sorted() in two further places; fix doctest`|



---

archive/issue_comments_274156.json:
```json
{
    "body": "Changing commit from \"62be17eb6eccffcddcc61e4f18a2123ec0c364d8\" to \"af5f800fdc616022d503b5e845ec81ebfef7c25e\"",
    "created_at": "2014-09-05T16:40:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274156",
    "user": "https://github.com/rwst"
}
```

Changing commit from "62be17eb6eccffcddcc61e4f18a2123ec0c364d8" to "af5f800fdc616022d503b5e845ec81ebfef7c25e"



---

archive/issue_comments_274157.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe problem is IMHO what to do with Python 3. Sure we can play the two different comparisons (cmp vs. rich) in Python 2 against each other, but in Py3 there will be only one comparison. So either\n* Comparison is always symbolic, and sorting will have to call `__bool__` on the symbolic inequalities. We then need to make that a total order instead of returning `False` all the time. Slow.\n* Comparison is never symbolic, and you need to call `x.symbolic_less(y)`. Could be beautified by the preparser. The actual comparison returns the internal term order. Fast.\nThought? Maybe that topic is more fodder for sage-devel...",
    "created_at": "2014-09-05T20:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274157",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>
The problem is IMHO what to do with Python 3. Sure we can play the two different comparisons (cmp vs. rich) in Python 2 against each other, but in Py3 there will be only one comparison. So either
* Comparison is always symbolic, and sorting will have to call `__bool__` on the symbolic inequalities. We then need to make that a total order instead of returning `False` all the time. Slow.
* Comparison is never symbolic, and you need to call `x.symbolic_less(y)`. Could be beautified by the preparser. The actual comparison returns the internal term order. Fast.
Thought? Maybe that topic is more fodder for sage-devel...



---

archive/issue_comments_274158.json:
```json
{
    "body": "<a id='comment:11'></a>\nYes, it's a bit over my head.",
    "created_at": "2014-09-05T20:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274158",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'></a>
Yes, it's a bit over my head.



---

archive/issue_comments_274159.json:
```json
{
    "body": "<a id='comment:12'></a>\nWas there ever any consensus on sage-devel on this?  I'm leaning toward the first option, but not strongly.",
    "created_at": "2015-02-03T04:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274159",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>
Was there ever any consensus on sage-devel on this?  I'm leaning toward the first option, but not strongly.



---

archive/issue_comments_274160.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [kcrisman](#comment%3A12):\n> Was there ever any consensus on sage-devel on this?  I'm leaning toward the first option, but not strongly.\n\nYou probably mean https://groups.google.com/forum/?hl=en#!searchin/sage-devel/cmp/sage-devel/092yBmHfXQo/4qfS_JHLJdwJ and #16537, #17175. The newsgroup thread is mainly about equality/hashing and a bit of richcmp, not the two choices above. I am just starting to read about this.",
    "created_at": "2015-02-17T16:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274160",
    "user": "https://github.com/rwst"
}
```

<a id='comment:13'></a>
Replying to [kcrisman](#comment%3A12):
> Was there ever any consensus on sage-devel on this?  I'm leaning toward the first option, but not strongly.

You probably mean https://groups.google.com/forum/?hl=en#!searchin/sage-devel/cmp/sage-devel/092yBmHfXQo/4qfS_JHLJdwJ and #16537, #17175. The newsgroup thread is mainly about equality/hashing and a bit of richcmp, not the two choices above. I am just starting to read about this.



---

archive/issue_events_054899.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-17T16:51:34Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54899"
}
```



---

archive/issue_events_054900.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-17T16:51:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54900"
}
```



---

archive/issue_comments_274161.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,14 @@\n sage: RLF(1) < RLF(sqrt(2))\n False\n ```\n+This also makes `RealSet` unusable with symbolics:\n \n+```\n+sage: RealSet((0, pi),[pi, pi],(pi,4))\n+[pi, 4)\n+sage: RealSet((0, pi),[0, pi],(pi,4))\n+[pi, 4)\n+sage: RealSet((0, pi),[0, 3.5],(pi,4))\n+(pi, 4)\n+```\n+\n``````\n",
    "created_at": "2015-02-17T17:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274161",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,14 @@
 sage: RLF(1) < RLF(sqrt(2))
 False
 ```
+This also makes `RealSet` unusable with symbolics:
 
+```
+sage: RealSet((0, pi),[pi, pi],(pi,4))
+[pi, 4)
+sage: RealSet((0, pi),[0, pi],(pi,4))
+[pi, 4)
+sage: RealSet((0, pi),[0, 3.5],(pi,4))
+(pi, 4)
+```
+
``````




---

archive/issue_comments_274162.json:
```json
{
    "body": "<a id='comment:19'></a>\nWhen #19040 is done `__cmp__` could simply delegate to `__nonzero__`.",
    "created_at": "2015-10-23T06:18:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274162",
    "user": "https://github.com/rwst"
}
```

<a id='comment:19'></a>
When #19040 is done `__cmp__` could simply delegate to `__nonzero__`.



---

archive/issue_comments_274163.json:
```json
{
    "body": "Changing stopgaps from \"\" to \"#19465\"",
    "created_at": "2015-10-24T09:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274163",
    "user": "https://github.com/rwst"
}
```

Changing stopgaps from "" to "#19465"



---

archive/issue_comments_274164.json:
```json
{
    "body": "Changing branch from \"u/rws/symbolic_cmp\" to \"\"",
    "created_at": "2015-10-24T09:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274164",
    "user": "https://github.com/rwst"
}
```

Changing branch from "u/rws/symbolic_cmp" to ""



---

archive/issue_events_054901.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-10-24T09:26:11Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54901"
}
```



---

archive/issue_events_054902.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-10-24T09:26:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54902"
}
```



---

archive/issue_comments_274165.json:
```json
{
    "body": "Changing commit from \"af5f800fdc616022d503b5e845ec81ebfef7c25e\" to \"\"",
    "created_at": "2015-10-24T09:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274165",
    "user": "https://github.com/rwst"
}
```

Changing commit from "af5f800fdc616022d503b5e845ec81ebfef7c25e" to ""



---

archive/issue_comments_274166.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe newest verson of #19040 is in the `u/rws/19312-1` branch of #19312\n\nSo, the way to resolve this IMO would be to\n1. merge #19312\n2. merge #19040 using the `u/rws/19312-1` branch of #19312\n3. using `__nonzero__` to implement `__cmp__`",
    "created_at": "2015-10-24T09:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274166",
    "user": "https://github.com/rwst"
}
```

<a id='comment:20'></a>
The newest verson of #19040 is in the `u/rws/19312-1` branch of #19312

So, the way to resolve this IMO would be to
1. merge #19312
2. merge #19040 using the `u/rws/19312-1` branch of #19312
3. using `__nonzero__` to implement `__cmp__`



---

archive/issue_comments_274167.json:
```json
{
    "body": "<a id='comment:21'></a>\nThere is also a more minimal solution (part of #19040): scan the expression, if it contains variables use print order, if not use math order.",
    "created_at": "2016-03-02T07:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274167",
    "user": "https://github.com/rwst"
}
```

<a id='comment:21'></a>
There is also a more minimal solution (part of #19040): scan the expression, if it contains variables use print order, if not use math order.



---

archive/issue_comments_274168.json:
```json
{
    "body": "Changing branch from \"\" to \"public/16397-1\"",
    "created_at": "2016-03-06T16:28:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274168",
    "user": "https://github.com/rwst"
}
```

Changing branch from "" to "public/16397-1"



---

archive/issue_comments_274169.json:
```json
{
    "body": "<a id='comment:23'></a>\nWith this we introduce a mixed sort key for symbolics which is numerically correct and symbolically fast. This is part of the work on #19040 and adds to/benefits from Volker's abstraction of orders of comparison.\n\n---\nNew commits:\n|                                                                                                                                          |                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[62be17e](https://github.com/sagemath/sagetrac-mirror/commit/62be17eb6eccffcddcc61e4f18a2123ec0c364d8)|`print_sorted and math_sorted utility functions`|\n|[8d8c774](https://github.com/sagemath/sagetrac-mirror/commit/8d8c7745c66e5495476cdcb05f85cbedee94739c)|`Merge remote-tracking branch 'trac/u/vbraun/symbolic_cmp' into symbcmp`|\n|[215cff4](https://github.com/sagemath/sagetrac-mirror/commit/215cff4e33f7a63e2da4cdde45c7f491046271ac)|`Merge branch 'develop' into t/16397/symbolic_cmp`|\n|[af5f800](https://github.com/sagemath/sagetrac-mirror/commit/af5f800fdc616022d503b5e845ec81ebfef7c25e)|`16397: use print_sorted() in two further places; fix doctest`|\n|[f32de00](https://github.com/sagemath/sagetrac-mirror/commit/f32de003faf43f9fbbf3d0d786b004fcdab5c9bd)|`Merge remote-tracking branch 'trac/u/rws/symbolic_cmp' into symbcmp`|\n|[237c17e](https://github.com/sagemath/sagetrac-mirror/commit/237c17e487e9e5a92f404de4c67fc9b0419d43c0)|`mixed order comparison`|\n|[c92ffba](https://github.com/sagemath/sagetrac-mirror/commit/c92ffba371de028843bcbb08a7813fda95b9448a)|`fix wrong doctest`|",
    "created_at": "2016-03-06T16:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274169",
    "user": "https://github.com/rwst"
}
```

<a id='comment:23'></a>
With this we introduce a mixed sort key for symbolics which is numerically correct and symbolically fast. This is part of the work on #19040 and adds to/benefits from Volker's abstraction of orders of comparison.

---
New commits:
|                                                                                                                                          |                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[62be17e](https://github.com/sagemath/sagetrac-mirror/commit/62be17eb6eccffcddcc61e4f18a2123ec0c364d8)|`print_sorted and math_sorted utility functions`|
|[8d8c774](https://github.com/sagemath/sagetrac-mirror/commit/8d8c7745c66e5495476cdcb05f85cbedee94739c)|`Merge remote-tracking branch 'trac/u/vbraun/symbolic_cmp' into symbcmp`|
|[215cff4](https://github.com/sagemath/sagetrac-mirror/commit/215cff4e33f7a63e2da4cdde45c7f491046271ac)|`Merge branch 'develop' into t/16397/symbolic_cmp`|
|[af5f800](https://github.com/sagemath/sagetrac-mirror/commit/af5f800fdc616022d503b5e845ec81ebfef7c25e)|`16397: use print_sorted() in two further places; fix doctest`|
|[f32de00](https://github.com/sagemath/sagetrac-mirror/commit/f32de003faf43f9fbbf3d0d786b004fcdab5c9bd)|`Merge remote-tracking branch 'trac/u/rws/symbolic_cmp' into symbcmp`|
|[237c17e](https://github.com/sagemath/sagetrac-mirror/commit/237c17e487e9e5a92f404de4c67fc9b0419d43c0)|`mixed order comparison`|
|[c92ffba](https://github.com/sagemath/sagetrac-mirror/commit/c92ffba371de028843bcbb08a7813fda95b9448a)|`fix wrong doctest`|



---

archive/issue_events_054903.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-03-06T16:32:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54903"
}
```



---

archive/issue_events_054904.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-03-06T16:32:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "milestone": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54904"
}
```



---

archive/issue_comments_274170.json:
```json
{
    "body": "Changing commit from \"\" to \"c92ffba371de028843bcbb08a7813fda95b9448a\"",
    "created_at": "2016-03-06T16:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274170",
    "user": "https://github.com/rwst"
}
```

Changing commit from "" to "c92ffba371de028843bcbb08a7813fda95b9448a"



---

archive/issue_comments_274171.json:
```json
{
    "body": "Changing author from \"\" to \"Volker Braun, Ralf Stephan\"",
    "created_at": "2016-03-06T16:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274171",
    "user": "https://github.com/rwst"
}
```

Changing author from "" to "Volker Braun, Ralf Stephan"



---

archive/issue_comments_274172.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-03-06T16:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274172",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_274173.json:
```json
{
    "body": "<a id='comment:24'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------|\n|[06ea5a9](https://github.com/sagemath/sagetrac-mirror/commit/06ea5a9957bcfd03fa1476f7651b2d9400e9e36b)|`fix doctest`|",
    "created_at": "2016-03-07T08:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274173",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |             |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------|
|[06ea5a9](https://github.com/sagemath/sagetrac-mirror/commit/06ea5a9957bcfd03fa1476f7651b2d9400e9e36b)|`fix doctest`|



---

archive/issue_comments_274174.json:
```json
{
    "body": "Changing commit from \"c92ffba371de028843bcbb08a7813fda95b9448a\" to \"06ea5a9957bcfd03fa1476f7651b2d9400e9e36b\"",
    "created_at": "2016-03-07T08:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c92ffba371de028843bcbb08a7813fda95b9448a" to "06ea5a9957bcfd03fa1476f7651b2d9400e9e36b"



---

archive/issue_comments_274175.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,6 +5,8 @@\n -1\n sage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order\n 1\n+sage: cmp(log(8), 3*log(2))\n+-1\n ```\n Everybody who coerces to same parents internally before comparing trips over this, for example the real lazy field:\n \n``````\n",
    "created_at": "2016-03-10T09:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274175",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,6 +5,8 @@
 -1
 sage: cmp(SR(1), sqrt(2)) # unexpectedly, you get the print sort order
 1
+sage: cmp(log(8), 3*log(2))
+-1
 ```
 Everybody who coerces to same parents internally before comparing trips over this, for example the real lazy field:
 
``````




---

archive/issue_comments_274176.json:
```json
{
    "body": "<a id='comment:26'></a>\nThe results for the `RealSet` examples would be at the moment:\n\n```\nsage: RealSet((0, pi),[pi, pi],(pi,4))\n[pi, 0) + (pi, 4)\nsage: RealSet((0, pi),[0, pi],(pi,4))\n[pi, 0] + (pi, 0) + (pi, 4)\nsage: RealSet((0, pi),[0, 3.5],(pi,4))\n(pi, 4)\n```",
    "created_at": "2016-03-10T09:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274176",
    "user": "https://github.com/rwst"
}
```

<a id='comment:26'></a>
The results for the `RealSet` examples would be at the moment:

```
sage: RealSet((0, pi),[pi, pi],(pi,4))
[pi, 0) + (pi, 4)
sage: RealSet((0, pi),[0, pi],(pi,4))
[pi, 0] + (pi, 0) + (pi, 4)
sage: RealSet((0, pi),[0, 3.5],(pi,4))
(pi, 4)
```



---

archive/issue_comments_274177.json:
```json
{
    "body": "<a id='comment:27'></a>\nSo there is still\n\n```\nsage: cmp(pi,0)\n1\nsage: cmp(pi,SR(0))\n-1\nsage: cmp(0,pi)\n-1\nsage: cmp(SR(0),pi)\n-1\n```",
    "created_at": "2016-03-10T09:37:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274177",
    "user": "https://github.com/rwst"
}
```

<a id='comment:27'></a>
So there is still

```
sage: cmp(pi,0)
1
sage: cmp(pi,SR(0))
-1
sage: cmp(0,pi)
-1
sage: cmp(SR(0),pi)
-1
```



---

archive/issue_comments_274178.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-03-10T09:37:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274178",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_274179.json:
```json
{
    "body": "Changing commit from \"06ea5a9957bcfd03fa1476f7651b2d9400e9e36b\" to \"c78d15119bf930af733b831bc83b54c40c56f800\"",
    "created_at": "2016-03-10T13:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274179",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "06ea5a9957bcfd03fa1476f7651b2d9400e9e36b" to "c78d15119bf930af733b831bc83b54c40c56f800"



---

archive/issue_comments_274180.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------|\n|[c78d151](https://github.com/sagemath/sagetrac-mirror/commit/c78d15119bf930af733b831bc83b54c40c56f800)|`add Constant.__lt__`|",
    "created_at": "2016-03-10T13:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274180",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                     |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------|
|[c78d151](https://github.com/sagemath/sagetrac-mirror/commit/c78d15119bf930af733b831bc83b54c40c56f800)|`add Constant.__lt__`|



---

archive/issue_comments_274181.json:
```json
{
    "body": "<a id='comment:30'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------|\n|[1381a89](https://github.com/sagemath/sagetrac-mirror/commit/1381a89d5e960afb76815f85e771f71f99a3d1c1)|`16397: add tests`|",
    "created_at": "2016-03-10T14:05:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274181",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                  |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------|
|[1381a89](https://github.com/sagemath/sagetrac-mirror/commit/1381a89d5e960afb76815f85e771f71f99a3d1c1)|`16397: add tests`|



---

archive/issue_comments_274182.json:
```json
{
    "body": "Changing commit from \"c78d15119bf930af733b831bc83b54c40c56f800\" to \"1381a89d5e960afb76815f85e771f71f99a3d1c1\"",
    "created_at": "2016-03-10T14:05:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c78d15119bf930af733b831bc83b54c40c56f800" to "1381a89d5e960afb76815f85e771f71f99a3d1c1"



---

archive/issue_comments_274183.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-03-10T14:06:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274183",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_274184.json:
```json
{
    "body": "<a id='comment:32'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[585ceb8](https://github.com/sagemath/sagetrac-mirror/commit/585ceb894a09284361594af5ee3f891c43052048)|`Merge branch 'develop' into symbcmp`|\n|[60370a9](https://github.com/sagemath/sagetrac-mirror/commit/60370a98cc7b77a1c0884066dcc57d193dcf9a6c)|`16397: fix typo`|",
    "created_at": "2016-03-11T07:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274184",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[585ceb8](https://github.com/sagemath/sagetrac-mirror/commit/585ceb894a09284361594af5ee3f891c43052048)|`Merge branch 'develop' into symbcmp`|
|[60370a9](https://github.com/sagemath/sagetrac-mirror/commit/60370a98cc7b77a1c0884066dcc57d193dcf9a6c)|`16397: fix typo`|



---

archive/issue_comments_274185.json:
```json
{
    "body": "Changing commit from \"1381a89d5e960afb76815f85e771f71f99a3d1c1\" to \"60370a98cc7b77a1c0884066dcc57d193dcf9a6c\"",
    "created_at": "2016-03-11T07:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274185",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1381a89d5e960afb76815f85e771f71f99a3d1c1" to "60370a98cc7b77a1c0884066dcc57d193dcf9a6c"



---

archive/issue_comments_274186.json:
```json
{
    "body": "Changing stopgaps from \"#19465\" to \"\"",
    "created_at": "2016-03-11T07:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274186",
    "user": "https://github.com/rwst"
}
```

Changing stopgaps from "#19465" to ""



---

archive/issue_comments_274187.json:
```json
{
    "body": "<a id='comment:33'></a>\nConsider the commit by Volker Braun (the first) reviewed by me. Please review everything else.",
    "created_at": "2016-03-11T07:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274187",
    "user": "https://github.com/rwst"
}
```

<a id='comment:33'></a>
Consider the commit by Volker Braun (the first) reviewed by me. Please review everything else.



---

archive/issue_comments_274188.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ralf Stephan\"",
    "created_at": "2016-03-11T07:58:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274188",
    "user": "https://github.com/rwst"
}
```

Changing reviewer from "" to "Ralf Stephan"



---

archive/issue_comments_274189.json:
```json
{
    "body": "<a id='comment:34'></a>\nhmm, patchbots are still not happy...",
    "created_at": "2016-03-11T10:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274189",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>
hmm, patchbots are still not happy...



---

archive/issue_comments_274190.json:
```json
{
    "body": "<a id='comment:35'></a>\nThat was a blind merge of develop, sigh.",
    "created_at": "2016-03-11T13:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274190",
    "user": "https://github.com/rwst"
}
```

<a id='comment:35'></a>
That was a blind merge of develop, sigh.



---

archive/issue_comments_274191.json:
```json
{
    "body": "<a id='comment:36'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[f78854c](https://github.com/sagemath/sagetrac-mirror/commit/f78854cf315994d26d33b0bcc93c7e64bb0bd8a8)|`fix depecrated import of python.pxi`|\n|[eab9ec2](https://github.com/sagemath/sagetrac-mirror/commit/eab9ec2ce8ce805441543ffcbebcdf5fb527a2cb)|`16397: fix doctest`|",
    "created_at": "2016-03-11T15:35:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[f78854c](https://github.com/sagemath/sagetrac-mirror/commit/f78854cf315994d26d33b0bcc93c7e64bb0bd8a8)|`fix depecrated import of python.pxi`|
|[eab9ec2](https://github.com/sagemath/sagetrac-mirror/commit/eab9ec2ce8ce805441543ffcbebcdf5fb527a2cb)|`16397: fix doctest`|



---

archive/issue_comments_274192.json:
```json
{
    "body": "Changing commit from \"60370a98cc7b77a1c0884066dcc57d193dcf9a6c\" to \"eab9ec2ce8ce805441543ffcbebcdf5fb527a2cb\"",
    "created_at": "2016-03-11T15:35:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274192",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "60370a98cc7b77a1c0884066dcc57d193dcf9a6c" to "eab9ec2ce8ce805441543ffcbebcdf5fb527a2cb"



---

archive/issue_comments_274193.json:
```json
{
    "body": "<a id='comment:37'></a>\nIt is interesting to see from the remaining fail in `random_test` that print order itself is a buggy concept: it either makes incorrect comparisons (`e>SR(0)` False) or fail transitivity if this is fixed in mixed order (`(x>e,e>SR(0),x>SR(0)) -> (True,True,False)`). So, mixed order in the present form would be no longer transitive.",
    "created_at": "2016-03-14T09:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274193",
    "user": "https://github.com/rwst"
}
```

<a id='comment:37'></a>
It is interesting to see from the remaining fail in `random_test` that print order itself is a buggy concept: it either makes incorrect comparisons (`e>SR(0)` False) or fail transitivity if this is fixed in mixed order (`(x>e,e>SR(0),x>SR(0)) -> (True,True,False)`). So, mixed order in the present form would be no longer transitive.



---

archive/issue_comments_274194.json:
```json
{
    "body": "<a id='comment:38'></a>\nEffectively the only way to refine comparison then is by introducing a `None` result which would exclude the above case from being flagged. Opinions would be very welcome.",
    "created_at": "2016-03-14T09:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274194",
    "user": "https://github.com/rwst"
}
```

<a id='comment:38'></a>
Effectively the only way to refine comparison then is by introducing a `None` result which would exclude the above case from being flagged. Opinions would be very welcome.



---

archive/issue_comments_274195.json:
```json
{
    "body": "<a id='comment:39'></a>\nperhaps someone should have a look at interfaces/mathematica.py where one has `__cmp__` for Mathematica objects, returning -1 if it falls through. Another bug? (cf. #18888)",
    "created_at": "2016-03-14T09:59:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274195",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:39'></a>
perhaps someone should have a look at interfaces/mathematica.py where one has `__cmp__` for Mathematica objects, returning -1 if it falls through. Another bug? (cf. #18888)



---

archive/issue_comments_274196.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [dimpase](#comment%3A39):\n> perhaps someone should have a look at interfaces/mathematica.py where one has `__cmp__` for Mathematica objects, returning -1 if it falls through. Another bug? (cf. #18888)\n\nHas nothing to do with this ticket.",
    "created_at": "2016-03-14T13:37:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274196",
    "user": "https://github.com/rwst"
}
```

<a id='comment:40'></a>
Replying to [dimpase](#comment%3A39):
> perhaps someone should have a look at interfaces/mathematica.py where one has `__cmp__` for Mathematica objects, returning -1 if it falls through. Another bug? (cf. #18888)

Has nothing to do with this ticket.



---

archive/issue_comments_274197.json:
```json
{
    "body": "Changing commit from \"eab9ec2ce8ce805441543ffcbebcdf5fb527a2cb\" to \"07f12cdfd14f3a7af5445aab7419c0ddaea1074d\"",
    "created_at": "2016-03-18T08:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "eab9ec2ce8ce805441543ffcbebcdf5fb527a2cb" to "07f12cdfd14f3a7af5445aab7419c0ddaea1074d"



---

archive/issue_comments_274198.json:
```json
{
    "body": "<a id='comment:41'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|\n|[24450f8](https://github.com/sagemath/sagetrac-mirror/commit/24450f8d49fc69400e0ef59fea307cd2001bd63d)|`Merge branch 'public/16397-1' of git://trac.sagemath.org/sage into tmp04`|\n|[07f12cd](https://github.com/sagemath/sagetrac-mirror/commit/07f12cdfd14f3a7af5445aab7419c0ddaea1074d)|`16397: restore transitivity`|",
    "created_at": "2016-03-18T08:05:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------|
|[24450f8](https://github.com/sagemath/sagetrac-mirror/commit/24450f8d49fc69400e0ef59fea307cd2001bd63d)|`Merge branch 'public/16397-1' of git://trac.sagemath.org/sage into tmp04`|
|[07f12cd](https://github.com/sagemath/sagetrac-mirror/commit/07f12cdfd14f3a7af5445aab7419c0ddaea1074d)|`16397: restore transitivity`|



---

archive/issue_comments_274199.json:
```json
{
    "body": "<a id='comment:42'></a>\nThis restores transitivity by moving all expressions with variables to the right of all the numbers in a sorted list: `[1, sqrt(2), e, pi, sin(1/x), sqrt(x), x]`",
    "created_at": "2016-03-18T08:09:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274199",
    "user": "https://github.com/rwst"
}
```

<a id='comment:42'></a>
This restores transitivity by moving all expressions with variables to the right of all the numbers in a sorted list: `[1, sqrt(2), e, pi, sin(1/x), sqrt(x), x]`



---

archive/issue_comments_274200.json:
```json
{
    "body": "<a id='comment:43'></a>\nIsn't it dangerous to compare constants by float, this will go wrong because of rounding  when you have equal or near equal numbers.",
    "created_at": "2016-03-23T19:13:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274200",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:43'></a>
Isn't it dangerous to compare constants by float, this will go wrong because of rounding  when you have equal or near equal numbers.



---

archive/issue_comments_274201.json:
```json
{
    "body": "<a id='comment:44'></a>\nHow about extending constants with an `evalf` member so that in comparisons the precision can be successively increased. Reaching the prec limit before a decision will return 0, ie equal.\n\nIsn't this quite hypothetical, compared to the concretely buggy behaviour now?",
    "created_at": "2016-03-23T22:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274201",
    "user": "https://github.com/rwst"
}
```

<a id='comment:44'></a>
How about extending constants with an `evalf` member so that in comparisons the precision can be successively increased. Reaching the prec limit before a decision will return 0, ie equal.

Isn't this quite hypothetical, compared to the concretely buggy behaviour now?



---

archive/issue_comments_274202.json:
```json
{
    "body": "<a id='comment:45'></a>\nIts perhaps not that hypothetical, the old joke (aka Heegner number)\n\n```\n$ python\n>>> from math import exp, pi, sqrt\n>>> exp(pi*sqrt(163)) == 262537412640768256\nTrue\n```\ncomes to mind. But I agree that this could be tackled on a future ticket.",
    "created_at": "2016-03-24T08:40:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274202",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:45'></a>
Its perhaps not that hypothetical, the old joke (aka Heegner number)

```
$ python
>>> from math import exp, pi, sqrt
>>> exp(pi*sqrt(163)) == 262537412640768256
True
```
comes to mind. But I agree that this could be tackled on a future ticket.



---

archive/issue_comments_274203.json:
```json
{
    "body": "<a id='comment:46'></a>\nI don't understand what you are trying to do here, can someone please explain?\n\n(In my understanding, calling `cmp` means you are asking for a *total* order on the elements of the parent where the comparison ends up taking place. As most parents don't admit such an order that is compatible with their structure, it is a bug to call `cmp` and expect a mathematically meaningful answer. In contrast, it is perfectly okay for `cmp` to implement any arbitrary total order, provided that rich comparisons are implemented too. And it is acceptable, though not ideal due to the issues with Python3, to call `cmp` when you need to sort elements in an arbitrary way.)",
    "created_at": "2016-03-24T15:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274203",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:46'></a>
I don't understand what you are trying to do here, can someone please explain?

(In my understanding, calling `cmp` means you are asking for a *total* order on the elements of the parent where the comparison ends up taking place. As most parents don't admit such an order that is compatible with their structure, it is a bug to call `cmp` and expect a mathematically meaningful answer. In contrast, it is perfectly okay for `cmp` to implement any arbitrary total order, provided that rich comparisons are implemented too. And it is acceptable, though not ideal due to the issues with Python3, to call `cmp` when you need to sort elements in an arbitrary way.)



---

archive/issue_comments_274204.json:
```json
{
    "body": "<a id='comment:47'></a>\nAt the moment there is one total order (print, mathematically wrong both in expressions with and without variables). Total math order OTOH is slow because of proving and undecidable. It is possible to have two total orders side-by-side where one half (within the set of expressions without variables) is fast, correct, and meaningful; and print order (within and with the set of expressions with variables) is fast as usual.\n\nIt is needed because `cmp` is used in Sage to sort expressions in a meaningful way, contrary to what you state.",
    "created_at": "2016-03-24T15:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274204",
    "user": "https://github.com/rwst"
}
```

<a id='comment:47'></a>
At the moment there is one total order (print, mathematically wrong both in expressions with and without variables). Total math order OTOH is slow because of proving and undecidable. It is possible to have two total orders side-by-side where one half (within the set of expressions without variables) is fast, correct, and meaningful; and print order (within and with the set of expressions with variables) is fast as usual.

It is needed because `cmp` is used in Sage to sort expressions in a meaningful way, contrary to what you state.



---

archive/issue_comments_274205.json:
```json
{
    "body": "<a id='comment:48'></a>\nReplying to [rws](#comment%3A47):\n> It is needed because `cmp` is used in Sage to sort expressions in a meaningful way, contrary to what you state.\n\n\nI'm not saying that it is not used that way, I am saying that, as far as I understand, when it is used that way, the bug is there.",
    "created_at": "2016-03-24T15:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274205",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:48'></a>
Replying to [rws](#comment%3A47):
> It is needed because `cmp` is used in Sage to sort expressions in a meaningful way, contrary to what you state.


I'm not saying that it is not used that way, I am saying that, as far as I understand, when it is used that way, the bug is there.



---

archive/issue_comments_274206.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [rws](#comment%3A47):\n> It is possible to have two total orders side-by-side where one half (within the set of expressions without variables) is fast, correct, and meaningful\n\n\nIt will never be *correct* in the sense that you can rely on it in mathematical algorithms, since the zero test for constant symbolic expressions is undecidable. At best it will be a nice and natural print order. Which is not a bad thing, but I don't understand if that's the goal of this ticket (and, if not, what the goal is).",
    "created_at": "2016-03-24T16:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274206",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:49'></a>
Replying to [rws](#comment%3A47):
> It is possible to have two total orders side-by-side where one half (within the set of expressions without variables) is fast, correct, and meaningful


It will never be *correct* in the sense that you can rely on it in mathematical algorithms, since the zero test for constant symbolic expressions is undecidable. At best it will be a nice and natural print order. Which is not a bad thing, but I don't understand if that's the goal of this ticket (and, if not, what the goal is).



---

archive/issue_comments_274207.json:
```json
{
    "body": "<a id='comment:50'></a>\nLook at the ticket description. The goal is to fix those errors. If that means to remove the usage of `cmp` in those parts of Sage, then please say so. I'm not a Python guy and am not in the know what `cmp` is supposed to do. I want to fix those pesky errors that block the new piecewise functions for years now.",
    "created_at": "2016-03-24T16:18:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274207",
    "user": "https://github.com/rwst"
}
```

<a id='comment:50'></a>
Look at the ticket description. The goal is to fix those errors. If that means to remove the usage of `cmp` in those parts of Sage, then please say so. I'm not a Python guy and am not in the know what `cmp` is supposed to do. I want to fix those pesky errors that block the new piecewise functions for years now.



---

archive/issue_comments_274208.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [rws](#comment%3A50):\n> Look at the ticket description. The goal is to fix those errors. If that means to remove the usage of `cmp` in those parts of Sage, then please say so.\n\n\nI don't know. I tried to explain what I *believe* is the convention used in sage (or perhaps the most reasonable of several incompatible conventions currently in use), but I'm genuinely interested in knowing if other people agree.",
    "created_at": "2016-03-24T16:22:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274208",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:51'></a>
Replying to [rws](#comment%3A50):
> Look at the ticket description. The goal is to fix those errors. If that means to remove the usage of `cmp` in those parts of Sage, then please say so.


I don't know. I tried to explain what I *believe* is the convention used in sage (or perhaps the most reasonable of several incompatible conventions currently in use), but I'm genuinely interested in knowing if other people agree.



---

archive/issue_comments_274209.json:
```json
{
    "body": "<a id='comment:52'></a>\nBetter than what we currently have...",
    "created_at": "2016-04-15T22:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274209",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:52'></a>
Better than what we currently have...



---

archive/issue_comments_274210.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-04-15T22:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274210",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_274211.json:
```json
{
    "body": "Changing reviewer from \"Ralf Stephan\" to \"Ralf Stephan, Volker Braun\"",
    "created_at": "2016-04-15T22:31:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274211",
    "user": "https://github.com/vbraun"
}
```

Changing reviewer from "Ralf Stephan" to "Ralf Stephan, Volker Braun"



---

archive/issue_events_054905.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-16T15:35:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16397#event-54905"
}
```



---

archive/issue_comments_274212.json:
```json
{
    "body": "Changing branch from \"public/16397-1\" to \"07f12cdfd14f3a7af5445aab7419c0ddaea1074d\"",
    "created_at": "2016-04-16T15:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274212",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/16397-1" to "07f12cdfd14f3a7af5445aab7419c0ddaea1074d"



---

archive/issue_comments_274213.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-04-16T15:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16397",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16397#issuecomment-274213",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
