# Issue 16348: Cdd linker path

archive/issues_016111.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nAnother cdd buildsystem horror...\n\nComponent: **build**\n\nAuthor: **Volker Braun**\n\nBranch/Commit: **[`55d2466`](https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16348_\n\n",
    "closed_at": "2014-05-15T17:18:39Z",
    "created_at": "2014-05-13T14:17:54Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20build",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Cdd linker path",
    "type": "issue",
    "updated_at": "2014-05-15T17:18:39Z",
    "url": "https://github.com/sagemath/sage/issues/16348",
    "user": "https://github.com/vbraun"
}
```
<div id="comment:0"></div>

Another cdd buildsystem horror...

Component: **build**

Author: **Volker Braun**

Branch/Commit: **[`55d2466`](https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93)**

Reviewer: **Fran√ßois Bissey**

_Issue created by migration from https://trac.sagemath.org/ticket/16348_





---

archive/issue_events_231448.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-13T14:17:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231448"
}
```



---

archive/issue_events_231449.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-13T14:17:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231449"
}
```



---

archive/issue_comments_210641.json:
```json
{
    "body": "Branch: **[u/vbraun/cdd_linker_path](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/cdd_linker_path)**",
    "created_at": "2014-05-13T14:41:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210641",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/cdd_linker_path](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/cdd_linker_path)**



---

archive/issue_events_231450.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-13T14:42:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231450"
}
```



---

archive/issue_comments_210642.json:
```json
{
    "body": "Commit: **[`55d2466`](https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93)**",
    "created_at": "2014-05-13T14:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210642",
    "user": "https://github.com/vbraun"
}
```

Commit: **[`55d2466`](https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93)**



---

archive/issue_events_231451.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-13T14:42:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20build",
    "label_color": "0000b0",
    "label_name": "c: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231451"
}
```



---

archive/issue_comments_210643.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93\"><code>55d2466</code></a></td><td><code>remove /usr/local from include paths</code></td></tr></table>\n",
    "created_at": "2014-05-13T14:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210643",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93"><code>55d2466</code></a></td><td><code>remove /usr/local from include paths</code></td></tr></table>




---

archive/issue_comments_210644.json:
```json
{
    "body": "Author: **Volker Braun**",
    "created_at": "2014-05-13T14:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210644",
    "user": "https://github.com/vbraun"
}
```

Author: **Volker Braun**



---

archive/issue_events_231452.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-13T14:42:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231452"
}
```



---

archive/issue_comments_210645.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Another cdd buildsystem horror...\n``````\n",
    "created_at": "2014-05-13T14:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210645",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Another cdd buildsystem horror...
``````




---

archive/issue_comments_210646.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWouldn't it make sense to add a *separate* patch for this?\n\n(The other changes are unrelated, and probably subject to change/vanish with #15871.)",
    "created_at": "2014-05-13T15:15:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210646",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:3" align="right">comment:3</div>

Wouldn't it make sense to add a *separate* patch for this?

(The other changes are unrelated, and probably subject to change/vanish with #15871.)



---

archive/issue_comments_210647.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nFeel free to change the way changes are split into patches.",
    "created_at": "2014-05-13T15:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210647",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:4" align="right">comment:4</div>

Feel free to change the way changes are split into patches.



---

archive/issue_comments_210648.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nThe main culprit is\n\n```make\nexport gmpdir := /usr/local\n```\nin `cddlib-094g.p0/src/Makefile`, so calling `$MAKE gmpdir=\"$SAGE_LOCAL` might also work without patching anything further, or just changing *that* line.",
    "created_at": "2014-05-13T15:24:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210648",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:5" align="right">comment:5</div>

The main culprit is

```make
export gmpdir := /usr/local
```
in `cddlib-094g.p0/src/Makefile`, so calling `$MAKE gmpdir="$SAGE_LOCAL` might also work without patching anything further, or just changing *that* line.



---

archive/issue_comments_210649.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@vbraun](#comment%3A4):\n> Feel free to change the way changes are split into patches.\n\nNot my job.",
    "created_at": "2014-05-13T15:25:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210649",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@vbraun](#comment%3A4):
> Feel free to change the way changes are split into patches.

Not my job.



---

archive/issue_comments_210650.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nYou can override gmpdir, but then SAGE_LOCAL will be added multiple times to the include/linker path.",
    "created_at": "2014-05-13T15:27:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210650",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:7" align="right">comment:7</div>

You can override gmpdir, but then SAGE_LOCAL will be added multiple times to the include/linker path.



---

archive/issue_events_231453.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-13T15:34:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231453"
}
```



---

archive/issue_events_231454.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-13T15:34:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231454"
}
```



---

archive/issue_comments_210651.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@vbraun](#comment%3A7):\n> You can override gmpdir, but then SAGE_LOCAL will be added multiple times to the include/linker path.\n\n... which doesn't hurt (unless we're e.g. exceeding the maximal number of command line arguments, but then other packages and especially the Sage library won't build either).",
    "created_at": "2014-05-13T15:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210651",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@vbraun](#comment%3A7):
> You can override gmpdir, but then SAGE_LOCAL will be added multiple times to the include/linker path.

... which doesn't hurt (unless we're e.g. exceeding the maximal number of command line arguments, but then other packages and especially the Sage library won't build either).



---

archive/issue_comments_210652.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\n... or just remove adding `\"$SAGE_LOCAL/...\"` to `CPPFLAGS` and `LDFLAGS` in turn.",
    "created_at": "2014-05-13T15:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210652",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

... or just remove adding `"$SAGE_LOCAL/..."` to `CPPFLAGS` and `LDFLAGS` in turn.



---

archive/issue_comments_210653.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nThese are all equivalent solutions. None has any significant advantage over the others.",
    "created_at": "2014-05-13T16:03:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210653",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

These are all equivalent solutions. None has any significant advantage over the others.



---

archive/issue_comments_210654.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWell, even in Sage ;-) we have the convention\n\n* to only patch upstream if necessary (and submit such patches upstream if appropriate)\n\n* one issue per patch\n\n* ...\n\nIt's tedious and error-prone to later untangle cumulative patches, not to mention reviewing and documentation of patches.",
    "created_at": "2014-05-13T16:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210654",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

Well, even in Sage ;-) we have the convention

* to only patch upstream if necessary (and submit such patches upstream if appropriate)

* one issue per patch

* ...

It's tedious and error-prone to later untangle cumulative patches, not to mention reviewing and documentation of patches.



---

archive/issue_comments_210655.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nEither off topic or doesn't work here (because its likely to trigger autoconf runs)",
    "created_at": "2014-05-13T16:44:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210655",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:13" align="right">comment:13</div>

Either off topic or doesn't work here (because its likely to trigger autoconf runs)



---

archive/issue_comments_210656.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n[#13026 comment:15](https://github.com/sagemath/sage/issues/13026#comment:15)\n\nTo go triple-safe, touch the autotools-generated files in `spkg-install` after patching.\n\nBut as mentioned, patching the autotools *source* files is not even necessary in this case (although it would make sense to submit such a patch upstream, and hopefully remove it (and only this specific one!) upon one of the next upstream upgrades).\n\nI can't follow what otherwise would be off-topic, but that's probably intended.",
    "created_at": "2014-05-13T18:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210656",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

[#13026 comment:15](https://github.com/sagemath/sage/issues/13026#comment:15)

To go triple-safe, touch the autotools-generated files in `spkg-install` after patching.

But as mentioned, patching the autotools *source* files is not even necessary in this case (although it would make sense to submit such a patch upstream, and hopefully remove it (and only this specific one!) upon one of the next upstream upgrades).

I can't follow what otherwise would be off-topic, but that's probably intended.



---

archive/issue_comments_210657.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nThe `.am` patches are not applied in `spkg-install`, fyi.",
    "created_at": "2014-05-13T18:37:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210657",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:15" align="right">comment:15</div>

The `.am` patches are not applied in `spkg-install`, fyi.



---

archive/issue_comments_210658.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@vbraun](#comment%3A15):\n> The `.am` patches are not applied in `spkg-install`, fyi.\n\nI know, which is IMHO a bad hack anyway.\n\nBut how is this related?",
    "created_at": "2014-05-13T18:41:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210658",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@vbraun](#comment%3A15):
> The `.am` patches are not applied in `spkg-install`, fyi.

I know, which is IMHO a bad hack anyway.

But how is this related?



---

archive/issue_comments_210659.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nIMHO all of cddlib is a bad hack. We basically only have it because gfan depends on it.\n\nIn any case, this ticket is about making cddlib compile if there is something in `/usr/local`. Suggestions about how to reorganize the patches and still avoid re-running autoconf are off-topic, as you said.",
    "created_at": "2014-05-13T18:47:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210659",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:17" align="right">comment:17</div>

IMHO all of cddlib is a bad hack. We basically only have it because gfan depends on it.

In any case, this ticket is about making cddlib compile if there is something in `/usr/local`. Suggestions about how to reorganize the patches and still avoid re-running autoconf are off-topic, as you said.



---

archive/issue_comments_210660.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI'm talking about making the spkg even less maintainable (and distro-unfriendly), which is what you currently IMHO do, for no reason.\n\nThe issue here btw. popped up again because a previous patch got removed upon the last upgrade.",
    "created_at": "2014-05-13T19:09:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210660",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">comment:18</div>

I'm talking about making the spkg even less maintainable (and distro-unfriendly), which is what you currently IMHO do, for no reason.

The issue here btw. popped up again because a previous patch got removed upon the last upgrade.



---

archive/issue_comments_210661.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nNo the issue popped up again because replacing the upstream insanity with a sane autotools project was removed.",
    "created_at": "2014-05-13T19:15:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210661",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:19" align="right">comment:19</div>

No the issue popped up again because replacing the upstream insanity with a sane autotools project was removed.



---

archive/issue_comments_210662.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis is so wrong. Volker's patch is just the minimal work to make it more distro friendly. I would remove the \"export\"s statements from the the top Makefile.am too.\nThat particular mistake is usually not too bad for distro preparing binary packages in a sensible way. But it is ugly as hell.\n\nTo finish with the comments on distro unfriendliness we fortunately start with upstream adding only the piece we deem necessary. We don't start from the sage spkg unless there is no other sources around :)\n\nI am a bit uncomfortable with the way autotools patches are applied and enforced but I can  accept that. I am more to apply the full autotool solution that could be pushed upstream if they were responsive rather than the quick nice fix proposed by Leif.\nSo if I have a deciding vote I am going for Volker.",
    "created_at": "2014-05-13T22:11:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210662",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:20" align="right">comment:20</div>

This is so wrong. Volker's patch is just the minimal work to make it more distro friendly. I would remove the "export"s statements from the the top Makefile.am too.
That particular mistake is usually not too bad for distro preparing binary packages in a sensible way. But it is ugly as hell.

To finish with the comments on distro unfriendliness we fortunately start with upstream adding only the piece we deem necessary. We don't start from the sage spkg unless there is no other sources around :)

I am a bit uncomfortable with the way autotools patches are applied and enforced but I can  accept that. I am more to apply the full autotool solution that could be pushed upstream if they were responsive rather than the quick nice fix proposed by Leif.
So if I have a deciding vote I am going for Volker.



---

archive/issue_comments_210663.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@kiwifb](#comment%3A20):\n> To finish with the comments on distro unfriendliness we fortunately start with upstream adding only the piece we deem necessary. We don't start from the sage spkg unless there is no other sources around :)\n\nTo clarify, I'm not against patching the autotools files, I'm against mixing completely unrelated patches.  Especially if we want to submit *parts of it* upstream.  (And it's easy to make sure they get applied in the correct order if at all relevant.  Same for timestamps if patched files depend on other patched files.)\n\nAnd I'm sorry to say, but unfortunately Gentoo still isn't the only distro. ;-)\n\nOthers prefer to have `patches/fix_upstream_bug_{foo,bar}.patch`, `patches/add_sage_functionality_baz.patch` rather than `patches/modifying_{this,that}_file_for_a_couple_of_reason_you_can_probably_guess.patch`. \n\nEven for just Sage, the former is by far more easy to maintain.\n\n\n\n\n> I am a bit uncomfortable with the way autotools patches are applied and enforced but I can  accept that. I am more to apply the full autotool solution that could be pushed upstream if they were responsive rather than the quick nice fix proposed by Leif.\n> So if I have a deciding vote I am going for Volker.\n\nYou have it, just give it positive review if you really feel it's *the right thing*<sup>TM</sup> to do.  Also in the light of #15871.\n\nAlthough the Debianists should probably speak up, too.",
    "created_at": "2014-05-14T09:30:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210663",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@kiwifb](#comment%3A20):
> To finish with the comments on distro unfriendliness we fortunately start with upstream adding only the piece we deem necessary. We don't start from the sage spkg unless there is no other sources around :)

To clarify, I'm not against patching the autotools files, I'm against mixing completely unrelated patches.  Especially if we want to submit *parts of it* upstream.  (And it's easy to make sure they get applied in the correct order if at all relevant.  Same for timestamps if patched files depend on other patched files.)

And I'm sorry to say, but unfortunately Gentoo still isn't the only distro. ;-)

Others prefer to have `patches/fix_upstream_bug_{foo,bar}.patch`, `patches/add_sage_functionality_baz.patch` rather than `patches/modifying_{this,that}_file_for_a_couple_of_reason_you_can_probably_guess.patch`. 

Even for just Sage, the former is by far more easy to maintain.




> I am a bit uncomfortable with the way autotools patches are applied and enforced but I can  accept that. I am more to apply the full autotool solution that could be pushed upstream if they were responsive rather than the quick nice fix proposed by Leif.
> So if I have a deciding vote I am going for Volker.

You have it, just give it positive review if you really feel it's *the right thing*<sup>TM</sup> to do.  Also in the light of #15871.

Although the Debianists should probably speak up, too.



---

archive/issue_comments_210664.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@nexttime](#comment%3A21):\n> Replying to [@kiwifb](#comment%3A20):\n> > To finish with the comments on distro unfriendliness we fortunately start with upstream adding only the piece we deem necessary. We don't start from the sage spkg unless there is no other sources around :)\n> \n> \n> To clarify, I'm not against patching the autotools files, I'm against mixing completely unrelated patches.  Especially if we want to submit *parts of it* upstream.  (And it's easy to make sure they get applied in the correct order if at all relevant.  Same for timestamps if patched files depend on other patched files.)\n> \n> And I'm sorry to say, but unfortunately Gentoo still isn't the only distro. ;-)\n> \n\nHow very unfortunate ;) that's why I have to read rpm .spec files from time to time and even troll debian sources.But that was a long and boring dragging comment - the kind you make in the morning because you are gathering your thoughts.\n\n> Others prefer to have `patches/fix_upstream_bug_{foo,bar}.patch`, `patches/add_sage_functionality_baz.patch` rather than `patches/modifying_{this,that}_file_for_a_couple_of_reason_you_can_probably_guess.patch`. \n> \n> Even for just Sage, the former is by far more easy to maintain.\n> \n> \n\n> \n> > I am a bit uncomfortable with the way autotools patches are applied and enforced but I can  accept that. I am more to apply the full autotool solution that could be pushed upstream if they were responsive rather than the quick nice fix proposed by Leif.\n> > So if I have a deciding vote I am going for Volker.\n> \n> \n> You have it, just give it positive review if you really feel it's *the right thing*<sup>TM</sup> to do.  Also in the light of #15871.\n> \n> Although the Debianists should probably speak up, too.\n\nI guess we would need to invite them next time ;)\n\nIn the absence of a nice way to run autoreconf and al. on pristine source (as Gentoo would) it is good enough for me. What we should send upstream and in which form is another discussion.",
    "created_at": "2014-05-14T09:42:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210664",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@nexttime](#comment%3A21):
> Replying to [@kiwifb](#comment%3A20):
> > To finish with the comments on distro unfriendliness we fortunately start with upstream adding only the piece we deem necessary. We don't start from the sage spkg unless there is no other sources around :)
> 
> 
> To clarify, I'm not against patching the autotools files, I'm against mixing completely unrelated patches.  Especially if we want to submit *parts of it* upstream.  (And it's easy to make sure they get applied in the correct order if at all relevant.  Same for timestamps if patched files depend on other patched files.)
> 
> And I'm sorry to say, but unfortunately Gentoo still isn't the only distro. ;-)
> 

How very unfortunate ;) that's why I have to read rpm .spec files from time to time and even troll debian sources.But that was a long and boring dragging comment - the kind you make in the morning because you are gathering your thoughts.

> Others prefer to have `patches/fix_upstream_bug_{foo,bar}.patch`, `patches/add_sage_functionality_baz.patch` rather than `patches/modifying_{this,that}_file_for_a_couple_of_reason_you_can_probably_guess.patch`. 
> 
> Even for just Sage, the former is by far more easy to maintain.
> 
> 

> 
> > I am a bit uncomfortable with the way autotools patches are applied and enforced but I can  accept that. I am more to apply the full autotool solution that could be pushed upstream if they were responsive rather than the quick nice fix proposed by Leif.
> > So if I have a deciding vote I am going for Volker.
> 
> 
> You have it, just give it positive review if you really feel it's *the right thing*<sup>TM</sup> to do.  Also in the light of #15871.
> 
> Although the Debianists should probably speak up, too.

I guess we would need to invite them next time ;)

In the absence of a nice way to run autoreconf and al. on pristine source (as Gentoo would) it is good enough for me. What we should send upstream and in which form is another discussion.



---

archive/issue_comments_210665.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2014-05-14T09:42:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210665",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **Fran√ßois Bissey**



---

archive/issue_events_231455.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2014-05-14T09:42:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231455"
}
```



---

archive/issue_events_231456.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2014-05-14T09:42:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231456"
}
```



---

archive/issue_events_231457.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-15T17:18:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231457"
}
```



---

archive/issue_events_231458.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "53d70d53af773f7b3ce250c8850b61dccbec9433",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-05-15T17:18:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16348#event-231458"
}
```



---

archive/issue_comments_210666.json:
```json
{
    "body": "Changed branch from **[u/vbraun/cdd_linker_path](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/cdd_linker_path)** to **[`55d2466`](https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93)**",
    "created_at": "2014-05-15T17:18:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16348",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16348#issuecomment-210666",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vbraun/cdd_linker_path](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/cdd_linker_path)** to **[`55d2466`](https://github.com/sagemath/sagetrac-mirror/commit/55d2466229dbb6e198e4979a46ce337f99991f93)**
