# Issue 16603: permanental_minor_vector, matching polynomial

archive/issues_016366.json:
```json
{
    "body": "Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).\n\nAs a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the\nButera-Pernici algorithm, 13 seconds using the Godsil algorithm.\n\nIn the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2\n\n```\nsage: from sage.matrix.matrix_misc import permanental_minor_polynomial\nsage: n, w = 100, 5\nsage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0\n....:              for i in range(n)] for j in range(n)])\nsage: time p = permanental_minor_polynomial(m, permanent_only=True)\nWall time: 773 ms\n```\n\nThis can be used to compute the matching polynomial of bipartite graphs much faster than matching_polynomial for certain graphs. For example, using the attached file to compute the reduced adjacency matrix of a 2d grid (n1, n2):\n\n```\nsage: from grid import sq_mat\nsage: from sage.matrix.matrix_misc import permanental_minor_polynomial\nsage: m = matrix(sq_mat(6, 6))\nsage: time a = permanental_minor_polynomial(m)\nWall time: 10.6 ms\n\nsage: g = BipartiteGraph(m)\nsage: time p = g.matching_polynomial()\nWall time: 46.9 s\n```\nFor n1,n2=10,10  permanental_minor_vector(m) takes 0.3s\nFor n1,n2=50,6 it takes 0.5s\n\n**CC:**  @nathanncohen @jaapspies\n\n**Branch/Commit:** [901d36c702cfab6c13e1d14083cef7e8ee931c37](https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37)\n\n**Reviewer:** Vincent Delecroix\n\n**Author:** Mario Pernici\n\nIssue created by migration from https://trac.sagemath.org/ticket/16603\n\n",
    "closed_at": "2015-01-13T11:04:48Z",
    "created_at": "2014-07-01T18:24:37Z",
    "labels": [
        "component: linear algebra",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "title": "permanental_minor_vector, matching polynomial",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/16603",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```
Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).

As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the
Butera-Pernici algorithm, 13 seconds using the Godsil algorithm.

In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2

```
sage: from sage.matrix.matrix_misc import permanental_minor_polynomial
sage: n, w = 100, 5
sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0
....:              for i in range(n)] for j in range(n)])
sage: time p = permanental_minor_polynomial(m, permanent_only=True)
Wall time: 773 ms
```

This can be used to compute the matching polynomial of bipartite graphs much faster than matching_polynomial for certain graphs. For example, using the attached file to compute the reduced adjacency matrix of a 2d grid (n1, n2):

```
sage: from grid import sq_mat
sage: from sage.matrix.matrix_misc import permanental_minor_polynomial
sage: m = matrix(sq_mat(6, 6))
sage: time a = permanental_minor_polynomial(m)
Wall time: 10.6 ms

sage: g = BipartiteGraph(m)
sage: time p = g.matching_polynomial()
Wall time: 46.9 s
```
For n1,n2=10,10  permanental_minor_vector(m) takes 0.3s
For n1,n2=50,6 it takes 0.5s

**CC:**  @nathanncohen @jaapspies

**Branch/Commit:** [901d36c702cfab6c13e1d14083cef7e8ee931c37](https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37)

**Reviewer:** Vincent Delecroix

**Author:** Mario Pernici

Issue created by migration from https://trac.sagemath.org/ticket/16603





---

archive/issue_comments_218648.json:
```json
{
    "body": "**Author:** Mario Pernici",
    "created_at": "2014-07-01T18:29:25Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218648",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Author:** Mario Pernici



---

archive/issue_comments_218649.json:
```json
{
    "body": "**Branch:** [u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)",
    "created_at": "2014-07-01T18:35:27Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218649",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Branch:** [u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)



---

archive/issue_comments_218650.json:
```json
{
    "body": "**Commit:** [b0d714572f15dd915b1caabbb11f5f96f4020c85](https://github.com/sagemath/sagetrac-mirror/commit/b0d714572f15dd915b1caabbb11f5f96f4020c85)",
    "created_at": "2014-07-01T20:38:42Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [b0d714572f15dd915b1caabbb11f5f96f4020c85](https://github.com/sagemath/sagetrac-mirror/commit/b0d714572f15dd915b1caabbb11f5f96f4020c85)



---

archive/issue_comments_218651.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0d714572f15dd915b1caabbb11f5f96f4020c85\">b0d7145</a></td><td><code>fixed bug in `permanental_minor_vector` in case of vanishing permanent</code></td></tr></table>\n",
    "created_at": "2014-07-01T20:38:42Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218651",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0d714572f15dd915b1caabbb11f5f96f4020c85">b0d7145</a></td><td><code>fixed bug in `permanental_minor_vector` in case of vanishing permanent</code></td></tr></table>




---

archive/issue_comments_218652.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n ADD DESCRIPTION\n-  added function `permanental_minor_vector`, which computes the\n+  added function `permanental_minor_vector`, which computes\n   the polynomial of the sums of the permanental minors in an efficient\n   way, see http://arxiv.org/abs/1406.5337\n \n``````\n",
    "created_at": "2014-07-01T20:57:49Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218652",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 ADD DESCRIPTION
-  added function `permanental_minor_vector`, which computes the
+  added function `permanental_minor_vector`, which computes
   the polynomial of the sums of the permanental minors in an efficient
   way, see http://arxiv.org/abs/1406.5337
 
``````




---

archive/attachments_021251.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "grid.py",
    "asset_url": "tarball://root/attachments/ticket16603/grid.py",
    "created_at": "2014-07-13T09:19:45Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket16603/grid.py",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```



---

archive/issue_comments_218653.json:
```json
{
    "body": "**Attachment:** [grid.py](https://github.com/sagemath/sage/files/ticket16603/grid.py)",
    "created_at": "2014-07-13T09:19:45Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218653",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Attachment:** [grid.py](https://github.com/sagemath/sage/files/ticket16603/grid.py)



---

archive/issue_comments_218654.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -20,6 +20,23 @@\n   CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s\n   Wall time: 1.07 s\n \n+This can be used to compute the matching polynomial of bipartite graphs\n+much faster than matching_polynomial for certain graphs.\n+\n+For example, using the attached file to compute the reduced adjacency matrix of\n+a 2d grid (n1, n2)\n+\n+sage: from grid import sq_mat\n+sage: from sage.matrix.matrix_misc import permanental_minor_vector\n+sage: m = matrix(sq_mat(6, 6))\n+sage: time a = permanental_minor_vector(m)\n+Wall time: 16.3 ms\n+sage: g = BipartiteGraph(m)\n+sage: time p = g.matching_polynomial()\n+Wall time: 52 s\n+\n+For n1,n2=10,10  permanental_minor_vector(m) takes 0.7s\n+For n1,n2=50,6 it takes 0.8s\n \n priority:  major\n type:      enhancement\n``````\n",
    "created_at": "2014-07-13T09:22:06Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218654",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -20,6 +20,23 @@
   CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s
   Wall time: 1.07 s
 
+This can be used to compute the matching polynomial of bipartite graphs
+much faster than matching_polynomial for certain graphs.
+
+For example, using the attached file to compute the reduced adjacency matrix of
+a 2d grid (n1, n2)
+
+sage: from grid import sq_mat
+sage: from sage.matrix.matrix_misc import permanental_minor_vector
+sage: m = matrix(sq_mat(6, 6))
+sage: time a = permanental_minor_vector(m)
+Wall time: 16.3 ms
+sage: g = BipartiteGraph(m)
+sage: time p = g.matching_polynomial()
+Wall time: 52 s
+
+For n1,n2=10,10  permanental_minor_vector(m) takes 0.7s
+For n1,n2=50,6 it takes 0.8s
 
 priority:  major
 type:      enhancement
``````




---

archive/issue_events_148658.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/pernici",
    "created_at": "2014-07-13T09:24:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "rename": {
        "from": "permanental_minor_vector",
        "to": "permanental_minor_vector, matching polynomial"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148658"
}
```



---

archive/issue_comments_218655.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -31,6 +31,7 @@\n sage: m = matrix(sq_mat(6, 6))\n sage: time a = permanental_minor_vector(m)\n Wall time: 16.3 ms\n+\n sage: g = BipartiteGraph(m)\n sage: time p = g.matching_polynomial()\n Wall time: 52 s\n``````\n",
    "created_at": "2014-07-13T09:24:48Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218655",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -31,6 +31,7 @@
 sage: m = matrix(sq_mat(6, 6))
 sage: time a = permanental_minor_vector(m)
 Wall time: 16.3 ms
+
 sage: g = BipartiteGraph(m)
 sage: time p = g.matching_polynomial()
 Wall time: 52 s
``````




---

archive/issue_events_148659.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148659"
}
```



---

archive/issue_events_148660.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148660"
}
```



---

archive/issue_comments_218656.json:
```json
{
    "body": "**Changing branch** from \"[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)\" to \"[public/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/16603)\".",
    "created_at": "2014-10-31T19:35:58Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218656",
    "user": "https://github.com/fchapoton"
}
```

**Changing branch** from "[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)" to "[public/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/16603)".



---

archive/issue_comments_218657.json:
```json
{
    "body": "**Changing commit** from \"[b0d714572f15dd915b1caabbb11f5f96f4020c85](https://github.com/sagemath/sagetrac-mirror/commit/b0d714572f15dd915b1caabbb11f5f96f4020c85)\" to \"[f65acdedf20554ed8cbd88fde232da4229d96f85](https://github.com/sagemath/sagetrac-mirror/commit/f65acdedf20554ed8cbd88fde232da4229d96f85)\".",
    "created_at": "2014-10-31T19:35:58Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218657",
    "user": "https://github.com/fchapoton"
}
```

**Changing commit** from "[b0d714572f15dd915b1caabbb11f5f96f4020c85](https://github.com/sagemath/sagetrac-mirror/commit/b0d714572f15dd915b1caabbb11f5f96f4020c85)" to "[f65acdedf20554ed8cbd88fde232da4229d96f85](https://github.com/sagemath/sagetrac-mirror/commit/f65acdedf20554ed8cbd88fde232da4229d96f85)".



---

archive/issue_comments_218658.json:
```json
{
    "body": "<a id='comment:8'></a>\nI have had a quick look and made a review patch. You need to document the auxiliary function.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55d328f5ccdfdef29134353e0553a94cc130e572\">55d328f</a></td><td><code>Merge branch 'u/pernici/ticket/16603' in 6.4.rc0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f65acdedf20554ed8cbd88fde232da4229d96f85\">f65acde</a></td><td><code>trac #16603 first review commit</code></td></tr></table>\n",
    "created_at": "2014-10-31T19:35:58Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218658",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
I have had a quick look and made a review patch. You need to document the auxiliary function.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55d328f5ccdfdef29134353e0553a94cc130e572">55d328f</a></td><td><code>Merge branch 'u/pernici/ticket/16603' in 6.4.rc0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f65acdedf20554ed8cbd88fde232da4229d96f85">f65acde</a></td><td><code>trac #16603 first review commit</code></td></tr></table>




---

archive/issue_comments_218659.json:
```json
{
    "body": "**Changing branch** from \"[public/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/16603)\" to \"[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)\".",
    "created_at": "2014-11-05T17:46:54Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218659",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Changing branch** from "[public/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/16603)" to "[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)".



---

archive/issue_comments_218660.json:
```json
{
    "body": "<a id='comment:10'></a>\nI made a commit in which I documented the auxiliary function, but by mistake I committed it\nto u/pernici/ticket/16603 instead of public/ticket/16603\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/947ddd16da731019f25a951e43bf551ad997a700\">947ddd1</a></td><td><code>Added missing documentation in ``_prm_mul``;</code></td></tr></table>\n",
    "created_at": "2014-11-06T10:08:41Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218660",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:10'></a>
I made a commit in which I documented the auxiliary function, but by mistake I committed it
to u/pernici/ticket/16603 instead of public/ticket/16603

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/947ddd16da731019f25a951e43bf551ad997a700">947ddd1</a></td><td><code>Added missing documentation in ``_prm_mul``;</code></td></tr></table>




---

archive/issue_comments_218661.json:
```json
{
    "body": "**Changing commit** from \"[f65acdedf20554ed8cbd88fde232da4229d96f85](https://github.com/sagemath/sagetrac-mirror/commit/f65acdedf20554ed8cbd88fde232da4229d96f85)\" to \"[947ddd16da731019f25a951e43bf551ad997a700](https://github.com/sagemath/sagetrac-mirror/commit/947ddd16da731019f25a951e43bf551ad997a700)\".",
    "created_at": "2014-11-06T10:08:41Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218661",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Changing commit** from "[f65acdedf20554ed8cbd88fde232da4229d96f85](https://github.com/sagemath/sagetrac-mirror/commit/f65acdedf20554ed8cbd88fde232da4229d96f85)" to "[947ddd16da731019f25a951e43bf551ad997a700](https://github.com/sagemath/sagetrac-mirror/commit/947ddd16da731019f25a951e43bf551ad997a700)".



---

archive/issue_comments_218662.json:
```json
{
    "body": "<a id='comment:11'></a>\nDo you want this to be reviewed ? If yes, please turn it into \"needs review\".",
    "created_at": "2014-11-28T17:18:59Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218662",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>
Do you want this to be reviewed ? If yes, please turn it into "needs review".



---

archive/issue_comments_218663.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [chapoton](#comment%3A11):\n> Do you want this to be reviewed ? If yes, please turn it into \"needs review\".\n\nHow do I turn it into \"needs review\" ?",
    "created_at": "2014-11-28T17:40:52Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218663",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:12'></a>
Replying to [chapoton](#comment%3A11):
> Do you want this to be reviewed ? If yes, please turn it into "needs review".

How do I turn it into "needs review" ?



---

archive/issue_events_148661.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2014-11-28T20:11:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148661"
}
```



---

archive/issue_comments_218664.json:
```json
{
    "body": "<a id='comment:13'></a>\nClick on \"Modify ticket\", then on the button \"needs review\". I did it for you.",
    "created_at": "2014-11-28T20:11:24Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218664",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:13'></a>
Click on "Modify ticket", then on the button "needs review". I did it for you.



---

archive/issue_comments_218665.json:
```json
{
    "body": "<a id='comment:14'></a>\nHello,\n\nThis code is very cool! You can have a look at my branch `u/vdelecroix/16603` where I provide two commits that I describe below.\n\n- I edited a bit the code, I hope it is cleaner (and actually also a bit faster)\n\n- Please, could you fill the section `ALGORITHM` of `permanental_minor_vector`. It would be nice to have here a rough description of the algorithm.\n\n- I edited a lot the documentation. First of all the file `matrix_misc.py` was not part of the matrix documentation! After my commits it is. If you compile the documentation (with either `make doc` or `sage -docbuild reference html`) then you will see the result in the section `Matrices and Spaces of Matrices` -> `Miscellaneous matrix functions`. I changed the name `_prm_mul` to `prm_mul` in order to make it appear in the documentation.\n\n- Currently the situtation for benchmarks is unfair:\n   - the code of Jaap Spies to compute the permanent and the permanent minors can be optimized a lot!\n   - your code is in Python while Jaap's one is in Cython\n\n- As you mentioned this algorithm can be used in several contexts. It would be nice to have some methods (of graphs and matrices) that call it. But if you prefer, we can do it in a further ticket.\n\nVincent",
    "created_at": "2014-12-06T21:09:40Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218665",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>
Hello,

This code is very cool! You can have a look at my branch `u/vdelecroix/16603` where I provide two commits that I describe below.

- I edited a bit the code, I hope it is cleaner (and actually also a bit faster)

- Please, could you fill the section `ALGORITHM` of `permanental_minor_vector`. It would be nice to have here a rough description of the algorithm.

- I edited a lot the documentation. First of all the file `matrix_misc.py` was not part of the matrix documentation! After my commits it is. If you compile the documentation (with either `make doc` or `sage -docbuild reference html`) then you will see the result in the section `Matrices and Spaces of Matrices` -> `Miscellaneous matrix functions`. I changed the name `_prm_mul` to `prm_mul` in order to make it appear in the documentation.

- Currently the situtation for benchmarks is unfair:
   - the code of Jaap Spies to compute the permanent and the permanent minors can be optimized a lot!
   - your code is in Python while Jaap's one is in Cython

- As you mentioned this algorithm can be used in several contexts. It would be nice to have some methods (of graphs and matrices) that call it. But if you prefer, we can do it in a further ticket.

Vincent



---

archive/issue_events_148662.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-12-06T21:09:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148662"
}
```



---

archive/issue_events_148663.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-12-06T21:09:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148663"
}
```



---

archive/issue_comments_218666.json:
```json
{
    "body": "<a id='comment:15'></a>\nHello,\n  how can I access your branch u/vdelecroix/16603 ?",
    "created_at": "2014-12-07T09:18:53Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218666",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:15'></a>
Hello,
  how can I access your branch u/vdelecroix/16603 ?



---

archive/issue_comments_218667.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [pernici](#comment%3A15):\n> Hello,\n>   how can I access your branch u/vdelecroix/16603 ?\n\nHow do you do with your branch ` u/pernici/ticket/16603`? All users have write access to `public/*` and `u/username/*` and read access everywhere. Just do in the Sage root:\n\n```\n$ git fetch trac u/vdelecroix/16603\n$ git checkout -b 16603_vincent_branch FETCH_HEAD\n```\nThe first command download my two commits. The special temporary branch `FETCH_HEAD` is a pointer to the last commit. The second command creates a new branch called `16603_vincent_branch` and move to it.\n\nYou can then merge these commits (if you like them) in your branch with\n\n```\n$ git checkout my_original_branch\n$ git merge 16603_vincent_branch\n```\n\nIs that clear enough?\n\nVincent",
    "created_at": "2014-12-07T11:16:34Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218667",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>
Replying to [pernici](#comment%3A15):
> Hello,
>   how can I access your branch u/vdelecroix/16603 ?

How do you do with your branch ` u/pernici/ticket/16603`? All users have write access to `public/*` and `u/username/*` and read access everywhere. Just do in the Sage root:

```
$ git fetch trac u/vdelecroix/16603
$ git checkout -b 16603_vincent_branch FETCH_HEAD
```
The first command download my two commits. The special temporary branch `FETCH_HEAD` is a pointer to the last commit. The second command creates a new branch called `16603_vincent_branch` and move to it.

You can then merge these commits (if you like them) in your branch with

```
$ git checkout my_original_branch
$ git merge 16603_vincent_branch
```

Is that clear enough?

Vincent



---

archive/issue_comments_218668.json:
```json
{
    "body": "<a id='comment:17'></a>\nPreviously I used ./sage -dev checkout --ticket 16603\nFollowing your instructions I got your branch; thanks.",
    "created_at": "2014-12-07T12:08:14Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218668",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:17'></a>
Previously I used ./sage -dev checkout --ticket 16603
Following your instructions I got your branch; thanks.



---

archive/issue_comments_218669.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [pernici](#comment%3A17):\n> Previously I used ./sage -dev checkout --ticket 16603\n> Following your instructions I got your branch; thanks.\n\nI see. The `sage -dev` commands are a bit outdated (and give you much less freedom). You might better use `git` or the enhanced `git trac` that Volker Braun wrote. Have a look at [the documentation](http://sagemath.org/doc/developer/).",
    "created_at": "2014-12-07T14:00:58Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218669",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>
Replying to [pernici](#comment%3A17):
> Previously I used ./sage -dev checkout --ticket 16603
> Following your instructions I got your branch; thanks.

I see. The `sage -dev` commands are a bit outdated (and give you much less freedom). You might better use `git` or the enhanced `git trac` that Volker Braun wrote. Have a look at [the documentation](http://sagemath.org/doc/developer/).



---

archive/issue_comments_218670.json:
```json
{
    "body": "<a id='comment:19'></a>\nI rewrote the description (formatting the code).",
    "created_at": "2014-12-07T19:02:09Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218670",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>
I rewrote the description (formatting the code).



---

archive/issue_comments_218671.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,31 +1,22 @@\n-ADD DESCRIPTION\n-  added function `permanental_minor_vector`, which computes\n-  the polynomial of the sums of the permanental minors in an efficient\n-  way, see http://arxiv.org/abs/1406.5337\n+Added function `permanental_minor_vector`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).\n \n-  As a benchmark, consider\n-  http://www.jaapspies.nl/mathfiles/dancing.sage\n-  on my computer `dance(10)` took 3 hours using sage-6.2, 0.08 seconds\n-  with this patch.\n+As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2 and 0.08 seconds with this patch!\n \n-  In the case of banded matrices, the speedup is greater, since\n-  for fixed bandwidth the new algorithm is polynomial; here is a permanent\n-  which cannot be computed with sage-6.2\n+In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2\n \n-  sage: from sage.matrix.matrix_misc import permanental_minor_vector\n-  sage: n, w = 100, 5\n-  sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0\n-  ....:   for i in range(n)] for j in range(n)])\n-  sage: time p = permanental_minor_vector(m, 1)\n-  CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s\n-  Wall time: 1.07 s\n+```\n+sage: from sage.matrix.matrix_misc import permanental_minor_vector\n+sage: n, w = 100, 5\n+sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0\n+....:              for i in range(n)] for j in range(n)])\n+sage: time p = permanental_minor_vector(m, 1)\n+CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s\n+Wall time: 1.07 s\n+```\n \n-This can be used to compute the matching polynomial of bipartite graphs\n-much faster than matching_polynomial for certain graphs.\n+This can be used to compute the matching polynomial of bipartite graphs much faster than matching_polynomial for certain graphs. For example, using the attached file to compute the reduced adjacency matrix of a 2d grid (n1, n2):\n \n-For example, using the attached file to compute the reduced adjacency matrix of\n-a 2d grid (n1, n2)\n-\n+```\n sage: from grid import sq_mat\n sage: from sage.matrix.matrix_misc import permanental_minor_vector\n sage: m = matrix(sq_mat(6, 6))\n@@ -35,10 +26,6 @@\n sage: g = BipartiteGraph(m)\n sage: time p = g.matching_polynomial()\n Wall time: 52 s\n-\n+```\n For n1,n2=10,10  permanental_minor_vector(m) takes 0.7s\n For n1,n2=50,6 it takes 0.8s\n-\n-priority:  major\n-type:      enhancement\n-component: linear algebra\n``````\n",
    "created_at": "2014-12-07T19:02:09Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218671",
    "user": "https://github.com/videlec"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,31 +1,22 @@
-ADD DESCRIPTION
-  added function `permanental_minor_vector`, which computes
-  the polynomial of the sums of the permanental minors in an efficient
-  way, see http://arxiv.org/abs/1406.5337
+Added function `permanental_minor_vector`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).
 
-  As a benchmark, consider
-  http://www.jaapspies.nl/mathfiles/dancing.sage
-  on my computer `dance(10)` took 3 hours using sage-6.2, 0.08 seconds
-  with this patch.
+As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2 and 0.08 seconds with this patch!
 
-  In the case of banded matrices, the speedup is greater, since
-  for fixed bandwidth the new algorithm is polynomial; here is a permanent
-  which cannot be computed with sage-6.2
+In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2
 
-  sage: from sage.matrix.matrix_misc import permanental_minor_vector
-  sage: n, w = 100, 5
-  sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0
-  ....:   for i in range(n)] for j in range(n)])
-  sage: time p = permanental_minor_vector(m, 1)
-  CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s
-  Wall time: 1.07 s
+```
+sage: from sage.matrix.matrix_misc import permanental_minor_vector
+sage: n, w = 100, 5
+sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0
+....:              for i in range(n)] for j in range(n)])
+sage: time p = permanental_minor_vector(m, 1)
+CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s
+Wall time: 1.07 s
+```
 
-This can be used to compute the matching polynomial of bipartite graphs
-much faster than matching_polynomial for certain graphs.
+This can be used to compute the matching polynomial of bipartite graphs much faster than matching_polynomial for certain graphs. For example, using the attached file to compute the reduced adjacency matrix of a 2d grid (n1, n2):
 
-For example, using the attached file to compute the reduced adjacency matrix of
-a 2d grid (n1, n2)
-
+```
 sage: from grid import sq_mat
 sage: from sage.matrix.matrix_misc import permanental_minor_vector
 sage: m = matrix(sq_mat(6, 6))
@@ -35,10 +26,6 @@
 sage: g = BipartiteGraph(m)
 sage: time p = g.matching_polynomial()
 Wall time: 52 s
-
+```
 For n1,n2=10,10  permanental_minor_vector(m) takes 0.7s
 For n1,n2=50,6 it takes 0.8s
-
-priority:  major
-type:      enhancement
-component: linear algebra
``````




---

archive/issue_comments_218672.json:
```json
{
    "body": "**Changing commit** from \"[947ddd16da731019f25a951e43bf551ad997a700](https://github.com/sagemath/sagetrac-mirror/commit/947ddd16da731019f25a951e43bf551ad997a700)\" to \"[f511623cce7bde7f022fa212a505526b3b62f0db](https://github.com/sagemath/sagetrac-mirror/commit/f511623cce7bde7f022fa212a505526b3b62f0db)\".",
    "created_at": "2014-12-09T13:11:29Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218672",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[947ddd16da731019f25a951e43bf551ad997a700](https://github.com/sagemath/sagetrac-mirror/commit/947ddd16da731019f25a951e43bf551ad997a700)" to "[f511623cce7bde7f022fa212a505526b3b62f0db](https://github.com/sagemath/sagetrac-mirror/commit/f511623cce7bde7f022fa212a505526b3b62f0db)".



---

archive/issue_comments_218673.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6fd53b0c8a0e451254cfd5afd25a40f7d1d8a2e\">a6fd53b</a></td><td><code>trac #16603: speedup + doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f611f58d45d8a0989a47a744dfd537b8e54b2412\">f611f58</a></td><td><code>trac #16603: add matrix_misc.py to the doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f511623cce7bde7f022fa212a505526b3b62f0db\">f511623</a></td><td><code>Added documentation to `permanental_minor_vector`</code></td></tr></table>\n",
    "created_at": "2014-12-09T13:11:29Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218673",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6fd53b0c8a0e451254cfd5afd25a40f7d1d8a2e">a6fd53b</a></td><td><code>trac #16603: speedup + doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f611f58d45d8a0989a47a744dfd537b8e54b2412">f611f58</a></td><td><code>trac #16603: add matrix_misc.py to the doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f511623cce7bde7f022fa212a505526b3b62f0db">f511623</a></td><td><code>Added documentation to `permanental_minor_vector`</code></td></tr></table>




---

archive/issue_comments_218674.json:
```json
{
    "body": "<a id='comment:21'></a>\nHello,\n\nI will push several commits in a minute on my branch `u/vdelecroix/16603`. Again you are free to use/discuss/reject them. I discuss the most important changes below.\n\nChange in your original code and documentation:\n\n- I changed your initial function into `permanental_minor_polynomial`. It looks more natural as it is what you compute... I moved the part of the code that makes it a list in `matrix.rook_vector`\n\n- I added a keyword `var` (as it is the case for `matrix.charpoly` for example) and change the argument name from `m` to `A` (since A is used in the docstring)\n\n- I optimized a bit the method `prm_mul` (it was possible to remove the loop computing `exp`) and introduced the list `vars_to_do` inplace of the set `done_vars`.\n\n- Sometimes it might happen that some coefficient of the partial product become zero. I added a test in `prm_mul`. If you think this is not worth it, I can revert that change.\n\n- Again, I edited a lot the documentation of `permanental_minor_polynomial`. Please reread carefully, I tried to make it more understandable but I might have made many mistakes.\n\n- Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the `k`-th permanental minor it is just enough to ignore the terms `t<sup>l</sup>` with `l > k`)\n\nMethods of matrices:\n\n- does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).\n\n- To allow the computation using your algorith, I made changes in `matrix.permanental_minor` and `matrix.permanent`. After my commits you can do\n\n```\nsage: m = matrix(ZZ,4,4,range(16))\nsage: m.permanent(algorithm=\"Ryser\")\n22432\nsage: m.permanent(algorithm=\"ButeraPernici\")\n22432\n```\n  it will be easier to make benchmarks (but I repeat that right now it is not fair for both, see also #17457).\n\n- Right now, in all methods except `matrix.rook_vector`, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?\n\n- why `matrix.rook_vector` is only defined for {0,1} matrices... it is well defined for any matrix, isn't it?\n\n- possibly we can add a method `matrix.permanental_minor_polynomial` but it will overlap a lot with rook vector. I am not sure what to do as these methods are very specific to matrix combinatorics. Perhaps you have a better overview than me on that.\n\nDespite this big list of remarks, I am sure this is not far for being ready for integration! This is a really nice piece of work.\n\nVincent",
    "created_at": "2014-12-09T17:53:23Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218674",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>
Hello,

I will push several commits in a minute on my branch `u/vdelecroix/16603`. Again you are free to use/discuss/reject them. I discuss the most important changes below.

Change in your original code and documentation:

- I changed your initial function into `permanental_minor_polynomial`. It looks more natural as it is what you compute... I moved the part of the code that makes it a list in `matrix.rook_vector`

- I added a keyword `var` (as it is the case for `matrix.charpoly` for example) and change the argument name from `m` to `A` (since A is used in the docstring)

- I optimized a bit the method `prm_mul` (it was possible to remove the loop computing `exp`) and introduced the list `vars_to_do` inplace of the set `done_vars`.

- Sometimes it might happen that some coefficient of the partial product become zero. I added a test in `prm_mul`. If you think this is not worth it, I can revert that change.

- Again, I edited a lot the documentation of `permanental_minor_polynomial`. Please reread carefully, I tried to make it more understandable but I might have made many mistakes.

- Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the `k`-th permanental minor it is just enough to ignore the terms `t<sup>l</sup>` with `l > k`)

Methods of matrices:

- does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).

- To allow the computation using your algorith, I made changes in `matrix.permanental_minor` and `matrix.permanent`. After my commits you can do

```
sage: m = matrix(ZZ,4,4,range(16))
sage: m.permanent(algorithm="Ryser")
22432
sage: m.permanent(algorithm="ButeraPernici")
22432
```
  it will be easier to make benchmarks (but I repeat that right now it is not fair for both, see also #17457).

- Right now, in all methods except `matrix.rook_vector`, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?

- why `matrix.rook_vector` is only defined for {0,1} matrices... it is well defined for any matrix, isn't it?

- possibly we can add a method `matrix.permanental_minor_polynomial` but it will overlap a lot with rook vector. I am not sure what to do as these methods are very specific to matrix combinatorics. Perhaps you have a better overview than me on that.

Despite this big list of remarks, I am sure this is not far for being ready for integration! This is a really nice piece of work.

Vincent



---

archive/issue_comments_218675.json:
```json
{
    "body": "<a id='comment:22'></a>\nchanges pushed on `u/vdelecroix/16603`.",
    "created_at": "2014-12-09T18:00:34Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218675",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>
changes pushed on `u/vdelecroix/16603`.



---

archive/issue_events_148664.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-12-09T18:00:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148664"
}
```



---

archive/issue_events_148665.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-12-09T18:00:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148665"
}
```



---

archive/issue_comments_218676.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/97f2062c85b6845115bd0e3a3fb2e7316dc2ade5\">97f2062</a></td><td><code>trac #16603: documentation + argument modifs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/63e37cb99d665a8081e9d70672eaa1ad4b54c2df\">63e37cb</a></td><td><code>trac #16603: various optimizations</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8a228d848c278bc44fc988b622dced0d1af5c349\">8a228d8</a></td><td><code>trac #16603: modify methods of matrices</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c76177e20cc6bb21c38c1c8123a2f5dde6fa4507\">c76177e</a></td><td><code>Added `prec` parameter to `permanental_minor_polynomial`;</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6f2c1c7ee024981aa1f761bbea8819a59089e46a\">6f2c1c7</a></td><td><code>used default \"ButeraPernici\" algorithm in `rook_vector`</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/19350a4574f4caa2e0b5ad08f66e51930b647a42\">19350a4</a></td><td><code>Added \"Godsil\" algorithm to `rook_vector`.</code></td></tr></table>\n",
    "created_at": "2014-12-15T11:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218676",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/97f2062c85b6845115bd0e3a3fb2e7316dc2ade5">97f2062</a></td><td><code>trac #16603: documentation + argument modifs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/63e37cb99d665a8081e9d70672eaa1ad4b54c2df">63e37cb</a></td><td><code>trac #16603: various optimizations</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8a228d848c278bc44fc988b622dced0d1af5c349">8a228d8</a></td><td><code>trac #16603: modify methods of matrices</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c76177e20cc6bb21c38c1c8123a2f5dde6fa4507">c76177e</a></td><td><code>Added `prec` parameter to `permanental_minor_polynomial`;</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6f2c1c7ee024981aa1f761bbea8819a59089e46a">6f2c1c7</a></td><td><code>used default "ButeraPernici" algorithm in `rook_vector`</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/19350a4574f4caa2e0b5ad08f66e51930b647a42">19350a4</a></td><td><code>Added "Godsil" algorithm to `rook_vector`.</code></td></tr></table>




---

archive/issue_comments_218677.json:
```json
{
    "body": "**Changing commit** from \"[f511623cce7bde7f022fa212a505526b3b62f0db](https://github.com/sagemath/sagetrac-mirror/commit/f511623cce7bde7f022fa212a505526b3b62f0db)\" to \"[19350a4574f4caa2e0b5ad08f66e51930b647a42](https://github.com/sagemath/sagetrac-mirror/commit/19350a4574f4caa2e0b5ad08f66e51930b647a42)\".",
    "created_at": "2014-12-15T11:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218677",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[f511623cce7bde7f022fa212a505526b3b62f0db](https://github.com/sagemath/sagetrac-mirror/commit/f511623cce7bde7f022fa212a505526b3b62f0db)" to "[19350a4574f4caa2e0b5ad08f66e51930b647a42](https://github.com/sagemath/sagetrac-mirror/commit/19350a4574f4caa2e0b5ad08f66e51930b647a42)".



---

archive/issue_comments_218678.json:
```json
{
    "body": "<a id='comment:24'></a>\nHello Vincent,\n\n> Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the k-th permanental minor it is just enough to ignore the terms t<sup>l</sup> with l > k)\n\nI adapted the algorithm to compute fastly k-th permanental minor for small `k`;\ntesting on `A = matrix(n, k, range(n)` using this algorithm\n`A.permanent_minor(k)` is faster for `2 <= k <= n-2\n\n>does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).\n\nNo, it did not have a name.\n> Right now, in all methods except matrix.rook_vector, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?\n\nIn the example above, for n x n matrices in `permanental_minor`\nthe Ryser algorithm is generally faster for `k=n` (permanent), slightly faster for\n`k=1,n-1`; maybe one could make a default option which uses the Ryser\nalgorithm in those cases, the new algorithm in the other cases.\n\n> why matrix.rook_vector is only defined for {0,1} matrices... it is well defined for any matrix, isn't it? \n\nUsually `rook vector` is defined only on {0,1} matrices; I added the \"Godsil\" algorithm which\nis faster than the \"Ryser\" algorithm.",
    "created_at": "2014-12-15T12:00:31Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218678",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:24'></a>
Hello Vincent,

> Do you know an adaptation of your method to compute only a specific permanental minor? (I guess that to compute the k-th permanental minor it is just enough to ignore the terms t<sup>l</sup> with l > k)

I adapted the algorithm to compute fastly k-th permanental minor for small `k`;
testing on `A = matrix(n, k, range(n)` using this algorithm
`A.permanent_minor(k)` is faster for `2 <= k <= n-2

>does your algorithm have a name? I used Butera-Pernici (see the item just below, it has some importance).

No, it did not have a name.
> Right now, in all methods except matrix.rook_vector, the default choice for algorithm is Ryser (what was before). Where do you think we should put yours in first?

In the example above, for n x n matrices in `permanental_minor`
the Ryser algorithm is generally faster for `k=n` (permanent), slightly faster for
`k=1,n-1`; maybe one could make a default option which uses the Ryser
algorithm in those cases, the new algorithm in the other cases.

> why matrix.rook_vector is only defined for {0,1} matrices... it is well defined for any matrix, isn't it? 

Usually `rook vector` is defined only on {0,1} matrices; I added the "Godsil" algorithm which
is faster than the "Ryser" algorithm.



---

archive/issue_comments_218679.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,31 +1,31 @@\n-Added function `permanental_minor_vector`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).\n+Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).\n \n-As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2 and 0.08 seconds with this patch!\n+As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the\n+\"ButeraPernici\" algorithm, 13 seconds using the Godsil algorithm.\n \n In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2\n \n ```\n-sage: from sage.matrix.matrix_misc import permanental_minor_vector\n+sage: from sage.matrix.matrix_misc import permanental_minor_polynomial\n sage: n, w = 100, 5\n sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0\n ....:              for i in range(n)] for j in range(n)])\n-sage: time p = permanental_minor_vector(m, 1)\n-CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s\n-Wall time: 1.07 s\n+sage: time p = permanental_minor_polynomial(m, permanent_only=True)\n+Wall time: 773 ms\n ```\n \n This can be used to compute the matching polynomial of bipartite graphs much faster than matching_polynomial for certain graphs. For example, using the attached file to compute the reduced adjacency matrix of a 2d grid (n1, n2):\n \n ```\n sage: from grid import sq_mat\n-sage: from sage.matrix.matrix_misc import permanental_minor_vector\n+sage: from sage.matrix.matrix_misc import permanental_minor_polynomial\n sage: m = matrix(sq_mat(6, 6))\n-sage: time a = permanental_minor_vector(m)\n-Wall time: 16.3 ms\n+sage: time a = permanental_minor_polynomial(m)\n+Wall time: 10.6 ms\n \n sage: g = BipartiteGraph(m)\n sage: time p = g.matching_polynomial()\n-Wall time: 52 s\n+Wall time: 46.9 s\n ```\n-For n1,n2=10,10  permanental_minor_vector(m) takes 0.7s\n-For n1,n2=50,6 it takes 0.8s\n+For n1,n2=10,10  permanental_minor_vector(m) takes 0.3s\n+For n1,n2=50,6 it takes 0.5s\n``````\n",
    "created_at": "2014-12-15T12:14:10Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218679",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,31 +1,31 @@
-Added function `permanental_minor_vector`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).
+Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).
 
-As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2 and 0.08 seconds with this patch!
+As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the
+"ButeraPernici" algorithm, 13 seconds using the Godsil algorithm.
 
 In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2
 
 ```
-sage: from sage.matrix.matrix_misc import permanental_minor_vector
+sage: from sage.matrix.matrix_misc import permanental_minor_polynomial
 sage: n, w = 100, 5
 sage: m = matrix([[i*j + 1 if abs(i-j) <= w else 0
 ....:              for i in range(n)] for j in range(n)])
-sage: time p = permanental_minor_vector(m, 1)
-CPU times: user 1.11 s, sys: 20 ms, total: 1.13 s
-Wall time: 1.07 s
+sage: time p = permanental_minor_polynomial(m, permanent_only=True)
+Wall time: 773 ms
 ```
 
 This can be used to compute the matching polynomial of bipartite graphs much faster than matching_polynomial for certain graphs. For example, using the attached file to compute the reduced adjacency matrix of a 2d grid (n1, n2):
 
 ```
 sage: from grid import sq_mat
-sage: from sage.matrix.matrix_misc import permanental_minor_vector
+sage: from sage.matrix.matrix_misc import permanental_minor_polynomial
 sage: m = matrix(sq_mat(6, 6))
-sage: time a = permanental_minor_vector(m)
-Wall time: 16.3 ms
+sage: time a = permanental_minor_polynomial(m)
+Wall time: 10.6 ms
 
 sage: g = BipartiteGraph(m)
 sage: time p = g.matching_polynomial()
-Wall time: 52 s
+Wall time: 46.9 s
 ```
-For n1,n2=10,10  permanental_minor_vector(m) takes 0.7s
-For n1,n2=50,6 it takes 0.8s
+For n1,n2=10,10  permanental_minor_vector(m) takes 0.3s
+For n1,n2=50,6 it takes 0.5s
``````




---

archive/issue_comments_218680.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).\n \n As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the\n-\"ButeraPernici\" algorithm, 13 seconds using the Godsil algorithm.\n+ButeraPernici algorithm, 13 seconds using the Godsil algorithm.\n \n In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2\n \n``````\n",
    "created_at": "2014-12-15T12:14:55Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218680",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).
 
 As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the
-"ButeraPernici" algorithm, 13 seconds using the Godsil algorithm.
+ButeraPernici algorithm, 13 seconds using the Godsil algorithm.
 
 In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2
 
``````




---

archive/issue_comments_218681.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).\n \n As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the\n-ButeraPernici algorithm, 13 seconds using the Godsil algorithm.\n+Butera-Pernici algorithm, 13 seconds using the Godsil algorithm.\n \n In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2\n \n``````\n",
    "created_at": "2014-12-15T12:17:06Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218681",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 Added function `permanental_minor_polynomial`, which computes the polynomial of the sums of the permanental minors in an efficient way, see [arXiv:1406.5337](http://arxiv.org/abs/1406.5337).
 
 As a benchmark, consider [dancing.sage](http://www.jaapspies.nl/mathfiles/dancing.sage). On my computer `dance(10)` took 3 hours using sage-6.2; it takes 0.08 seconds with this patch, using the
-ButeraPernici algorithm, 13 seconds using the Godsil algorithm.
+Butera-Pernici algorithm, 13 seconds using the Godsil algorithm.
 
 In the case of banded matrices, the speedup is greater, since for fixed bandwidth the new algorithm is polynomial; here is a permanent which cannot be computed with sage-6.2
 
``````




---

archive/issue_events_148666.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/pernici",
    "created_at": "2014-12-17T18:30:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148666"
}
```



---

archive/issue_events_148667.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/pernici",
    "created_at": "2014-12-17T18:30:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148667"
}
```



---

archive/issue_comments_218682.json:
```json
{
    "body": "**Changing branch** from \"[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)\" to \"[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)\".",
    "created_at": "2014-12-18T23:23:23Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218682",
    "user": "https://github.com/videlec"
}
```

**Changing branch** from "[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)" to "[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)".



---

archive/issue_comments_218683.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2014-12-18T23:23:23Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218683",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_218684.json:
```json
{
    "body": "<a id='comment:29'></a>\nHello,\n\nI really think that the documentation is half of a software: it provides specification of functions and help the user to orient himself/herself. Next time you implement a function in Sage pay attention that your new functionality is referenced from other part of the code and that it also make references to relevant functions. There is a lot of possibilities for organization of the documentation (see the [section \"Docstring\" of the developer guide](http://sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx)).\n\nI was not happy with the current behavior and documentation of `rook_vector` and `permanental_minor` (these methods should work for rectangular matrices whatever their shape). I guess that this is my last commit for that ticket. Just have a look and if you agree we can set the ticket to positive review.\n\nNext step would be optimisation of Ryser algorithm: #17457.\n\nVincent\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699\">3e7297b</a></td><td><code>trac #16603: documentation commit</code></td></tr></table>\n",
    "created_at": "2014-12-18T23:23:23Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218684",
    "user": "https://github.com/videlec"
}
```

<a id='comment:29'></a>
Hello,

I really think that the documentation is half of a software: it provides specification of functions and help the user to orient himself/herself. Next time you implement a function in Sage pay attention that your new functionality is referenced from other part of the code and that it also make references to relevant functions. There is a lot of possibilities for organization of the documentation (see the [section "Docstring" of the developer guide](http://sagemath.org/doc/developer/coding_basics.html#docstring-markup-with-rest-and-sphinx)).

I was not happy with the current behavior and documentation of `rook_vector` and `permanental_minor` (these methods should work for rectangular matrices whatever their shape). I guess that this is my last commit for that ticket. Just have a look and if you agree we can set the ticket to positive review.

Next step would be optimisation of Ryser algorithm: #17457.

Vincent

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699">3e7297b</a></td><td><code>trac #16603: documentation commit</code></td></tr></table>




---

archive/issue_comments_218685.json:
```json
{
    "body": "**Changing commit** from \"[19350a4574f4caa2e0b5ad08f66e51930b647a42](https://github.com/sagemath/sagetrac-mirror/commit/19350a4574f4caa2e0b5ad08f66e51930b647a42)\" to \"[3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699](https://github.com/sagemath/sagetrac-mirror/commit/3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699)\".",
    "created_at": "2014-12-18T23:23:23Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218685",
    "user": "https://github.com/videlec"
}
```

**Changing commit** from "[19350a4574f4caa2e0b5ad08f66e51930b647a42](https://github.com/sagemath/sagetrac-mirror/commit/19350a4574f4caa2e0b5ad08f66e51930b647a42)" to "[3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699](https://github.com/sagemath/sagetrac-mirror/commit/3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699)".



---

archive/issue_comments_218686.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)\" to \"[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)\".",
    "created_at": "2015-01-08T11:33:16Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218686",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Changing branch** from "[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)" to "[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)".



---

archive/issue_comments_218687.json:
```json
{
    "body": "<a id='comment:31'></a>\nHello,\nI added the ``matching_polynomial`` method to the ``BipartiteGraph`` class, so one can optionally\nuse the \"rook\" algorithm.\nNow ``rook_vector`` is much faster when the matrix is made mostly of ones.\nI fixed a couple of bugs and added documentation.\n\nA simple optimization I did not include here is the one in case of matrices which can be put in block form\npermuting rows and columns. I did not include it because it does not seem to be a commonly occurring\ncase. The same optimization can be used in the computation of determinants of large matrices of this kind.\nDo you think that it is worth opening a ticket on it, or is it too obvious and useless?\n\nSooner or later I will open a ticket for a faster algorithm for the matching polynomial of graphs (non bipartite).\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dd4636a9706689dee80d16e7e11a62763ef3fe56\">dd4636a</a></td><td><code>fixed bug in ``permanental_minor_poly``;</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a60cc747d5b9270e5fb3d636ebb5fdd07d2d97d9\">a60cc74</a></td><td><code>added argument `complement`, eliminated argument `check` in ``rook_vector``;</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e4359bb3d2444375eed077c72274e4f6a4ed87bc\">e4359bb</a></td><td><code>added ``matching_polynomial`` method to ``BipartiteGraph`` class</code></td></tr></table>\n",
    "created_at": "2015-01-08T12:28:11Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218687",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:31'></a>
Hello,
I added the ``matching_polynomial`` method to the ``BipartiteGraph`` class, so one can optionally
use the "rook" algorithm.
Now ``rook_vector`` is much faster when the matrix is made mostly of ones.
I fixed a couple of bugs and added documentation.

A simple optimization I did not include here is the one in case of matrices which can be put in block form
permuting rows and columns. I did not include it because it does not seem to be a commonly occurring
case. The same optimization can be used in the computation of determinants of large matrices of this kind.
Do you think that it is worth opening a ticket on it, or is it too obvious and useless?

Sooner or later I will open a ticket for a faster algorithm for the matching polynomial of graphs (non bipartite).

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dd4636a9706689dee80d16e7e11a62763ef3fe56">dd4636a</a></td><td><code>fixed bug in ``permanental_minor_poly``;</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a60cc747d5b9270e5fb3d636ebb5fdd07d2d97d9">a60cc74</a></td><td><code>added argument `complement`, eliminated argument `check` in ``rook_vector``;</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e4359bb3d2444375eed077c72274e4f6a4ed87bc">e4359bb</a></td><td><code>added ``matching_polynomial`` method to ``BipartiteGraph`` class</code></td></tr></table>




---

archive/issue_comments_218688.json:
```json
{
    "body": "**Changing commit** from \"[3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699](https://github.com/sagemath/sagetrac-mirror/commit/3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699)\" to \"[e4359bb3d2444375eed077c72274e4f6a4ed87bc](https://github.com/sagemath/sagetrac-mirror/commit/e4359bb3d2444375eed077c72274e4f6a4ed87bc)\".",
    "created_at": "2015-01-08T12:28:11Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218688",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Changing commit** from "[3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699](https://github.com/sagemath/sagetrac-mirror/commit/3e7297b35f94986b8e0f37f30a3b3d6ee3d3b699)" to "[e4359bb3d2444375eed077c72274e4f6a4ed87bc](https://github.com/sagemath/sagetrac-mirror/commit/e4359bb3d2444375eed077c72274e4f6a4ed87bc)".



---

archive/issue_comments_218689.json:
```json
{
    "body": "**Changing commit** from \"[e4359bb3d2444375eed077c72274e4f6a4ed87bc](https://github.com/sagemath/sagetrac-mirror/commit/e4359bb3d2444375eed077c72274e4f6a4ed87bc)\" to \"[e03f93ae3016870383b50bf2a3abea4b5234e51b](https://github.com/sagemath/sagetrac-mirror/commit/e03f93ae3016870383b50bf2a3abea4b5234e51b)\".",
    "created_at": "2015-01-09T09:22:05Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218689",
    "user": "https://github.com/videlec"
}
```

**Changing commit** from "[e4359bb3d2444375eed077c72274e4f6a4ed87bc](https://github.com/sagemath/sagetrac-mirror/commit/e4359bb3d2444375eed077c72274e4f6a4ed87bc)" to "[e03f93ae3016870383b50bf2a3abea4b5234e51b](https://github.com/sagemath/sagetrac-mirror/commit/e03f93ae3016870383b50bf2a3abea4b5234e51b)".



---

archive/issue_comments_218690.json:
```json
{
    "body": "<a id='comment:32'></a>\nHello,\n\nFirst of all, there is already a lot of material on this ticket. It would be good to stop here and open tickets for new features (please put me on cc on them).\n\nI push a commit as I do not like the `complement` keyword that sounds like you want the rook vector of the complement matrix. I replaced it with `use_complement`. I know that it is different from the specification for `BipartiteGraphs` but it fits with `IndependentSets`\n\n```\nsage: from sage.graphs.independent_sets import IndependentSets\nsage: I = IndependentSets(graphs.GridGraph((5,5)))\nsage: I.cardinality()\n55447\nsage: I = IndependentSets(graphs.GridGraph((5,5)), complement=True)\nsage: I.cardinality()\n66\n```\nNevertheless, I kept the keyword `complement` to do the following as it is very useful\n\n```\nsage: identity_matrix(6).rook_vector(complement=True)\n[1, 30, 315, 1420, 2715, 1854, 265]\n```\n\nVincent\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e03f93ae3016870383b50bf2a3abea4b5234e51b\">e03f93a</a></td><td><code>trac #16603: change keywords for `rook_vector` + doc</code></td></tr></table>\n",
    "created_at": "2015-01-09T09:22:05Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218690",
    "user": "https://github.com/videlec"
}
```

<a id='comment:32'></a>
Hello,

First of all, there is already a lot of material on this ticket. It would be good to stop here and open tickets for new features (please put me on cc on them).

I push a commit as I do not like the `complement` keyword that sounds like you want the rook vector of the complement matrix. I replaced it with `use_complement`. I know that it is different from the specification for `BipartiteGraphs` but it fits with `IndependentSets`

```
sage: from sage.graphs.independent_sets import IndependentSets
sage: I = IndependentSets(graphs.GridGraph((5,5)))
sage: I.cardinality()
55447
sage: I = IndependentSets(graphs.GridGraph((5,5)), complement=True)
sage: I.cardinality()
66
```
Nevertheless, I kept the keyword `complement` to do the following as it is very useful

```
sage: identity_matrix(6).rook_vector(complement=True)
[1, 30, 315, 1420, 2715, 1854, 265]
```

Vincent

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e03f93ae3016870383b50bf2a3abea4b5234e51b">e03f93a</a></td><td><code>trac #16603: change keywords for `rook_vector` + doc</code></td></tr></table>




---

archive/issue_comments_218691.json:
```json
{
    "body": "**Changing branch** from \"[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)\" to \"[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)\".",
    "created_at": "2015-01-09T09:22:05Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218691",
    "user": "https://github.com/videlec"
}
```

**Changing branch** from "[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)" to "[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)".



---

archive/issue_comments_218692.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)\" to \"[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)\".",
    "created_at": "2015-01-12T11:34:17Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218692",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Changing branch** from "[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)" to "[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)".



---

archive/issue_comments_218693.json:
```json
{
    "body": "<a id='comment:34'></a>\nHello,\nI made one more small change.\nThank you for reviewing and improving the code and documentation.\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/127418fc436cad3561c298a8f5c685c1e4b4fb81\">127418f</a></td><td><code>fixed a bug in ``matching_polynomial``; added test.</code></td></tr></table>\n",
    "created_at": "2015-01-12T11:43:02Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218693",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

<a id='comment:34'></a>
Hello,
I made one more small change.
Thank you for reviewing and improving the code and documentation.

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/127418fc436cad3561c298a8f5c685c1e4b4fb81">127418f</a></td><td><code>fixed a bug in ``matching_polynomial``; added test.</code></td></tr></table>




---

archive/issue_comments_218694.json:
```json
{
    "body": "**Changing commit** from \"[e03f93ae3016870383b50bf2a3abea4b5234e51b](https://github.com/sagemath/sagetrac-mirror/commit/e03f93ae3016870383b50bf2a3abea4b5234e51b)\" to \"[127418fc436cad3561c298a8f5c685c1e4b4fb81](https://github.com/sagemath/sagetrac-mirror/commit/127418fc436cad3561c298a8f5c685c1e4b4fb81)\".",
    "created_at": "2015-01-12T11:43:02Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218694",
    "user": "https://trac.sagemath.org/admin/accounts/users/pernici"
}
```

**Changing commit** from "[e03f93ae3016870383b50bf2a3abea4b5234e51b](https://github.com/sagemath/sagetrac-mirror/commit/e03f93ae3016870383b50bf2a3abea4b5234e51b)" to "[127418fc436cad3561c298a8f5c685c1e4b4fb81](https://github.com/sagemath/sagetrac-mirror/commit/127418fc436cad3561c298a8f5c685c1e4b4fb81)".



---

archive/issue_comments_218695.json:
```json
{
    "body": "<a id='comment:35'></a>\nHello,\n\nLet us stop there with positive review! If you want to go any further open a new ticket (and please put me in cc).\n\nVincent",
    "created_at": "2015-01-12T14:18:50Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218695",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>
Hello,

Let us stop there with positive review! If you want to go any further open a new ticket (and please put me in cc).

Vincent



---

archive/issue_events_148668.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-01-12T14:18:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148668"
}
```



---

archive/issue_events_148669.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-01-12T14:18:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148669"
}
```



---

archive/issue_comments_218696.json:
```json
{
    "body": "<a id='comment:36'></a>\nDoctest failure in src/sage/misc/sagedoc.py",
    "created_at": "2015-01-12T18:46:49Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218696",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'></a>
Doctest failure in src/sage/misc/sagedoc.py



---

archive/issue_events_148670.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-12T18:46:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148670"
}
```



---

archive/issue_events_148671.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-12T18:46:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148671"
}
```



---

archive/issue_comments_218697.json:
```json
{
    "body": "<a id='comment:37'></a>\nFunny! Done...\n\n---\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37\">901d36c</a></td><td><code>fix doctest in misc/sagedoc.py</code></td></tr></table>\n",
    "created_at": "2015-01-12T19:54:26Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218697",
    "user": "https://github.com/videlec"
}
```

<a id='comment:37'></a>
Funny! Done...

---
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37">901d36c</a></td><td><code>fix doctest in misc/sagedoc.py</code></td></tr></table>




---

archive/issue_events_148672.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-01-12T19:54:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148672"
}
```



---

archive/issue_events_148673.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-01-12T19:54:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148673"
}
```



---

archive/issue_comments_218698.json:
```json
{
    "body": "**Changing branch** from \"[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)\" to \"[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)\".",
    "created_at": "2015-01-12T19:54:26Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218698",
    "user": "https://github.com/videlec"
}
```

**Changing branch** from "[u/pernici/ticket/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/16603)" to "[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)".



---

archive/issue_comments_218699.json:
```json
{
    "body": "**Changing commit** from \"[127418fc436cad3561c298a8f5c685c1e4b4fb81](https://github.com/sagemath/sagetrac-mirror/commit/127418fc436cad3561c298a8f5c685c1e4b4fb81)\" to \"[901d36c702cfab6c13e1d14083cef7e8ee931c37](https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37)\".",
    "created_at": "2015-01-12T19:54:26Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218699",
    "user": "https://github.com/videlec"
}
```

**Changing commit** from "[127418fc436cad3561c298a8f5c685c1e4b4fb81](https://github.com/sagemath/sagetrac-mirror/commit/127418fc436cad3561c298a8f5c685c1e4b4fb81)" to "[901d36c702cfab6c13e1d14083cef7e8ee931c37](https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37)".



---

archive/issue_events_148674.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-01-12T19:54:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148674"
}
```



---

archive/issue_events_148675.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-01-12T19:54:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148675"
}
```



---

archive/issue_comments_218700.json:
```json
{
    "body": "**Changing branch** from \"[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)\" to \"[901d36c702cfab6c13e1d14083cef7e8ee931c37](https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37)\".",
    "created_at": "2015-01-13T11:04:48Z",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16603#issuecomment-218700",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/vdelecroix/16603](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16603)" to "[901d36c702cfab6c13e1d14083cef7e8ee931c37](https://github.com/sagemath/sagetrac-mirror/commit/901d36c702cfab6c13e1d14083cef7e8ee931c37)".



---

archive/issue_events_148676.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-13T11:04:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148676"
}
```



---

archive/issue_events_148677.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "2593b3ae86aeebcfff281e561d730bd3e0dc7bca",
    "created_at": "2015-01-13T11:04:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16603",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16603#event-148677"
}
```
