# Issue 16598: New empty design classes for a better user interface and new is_group_divisible_design Cython function

archive/issues_016361.json:
```json
{
    "body": "This branch defines:\n\n- `GroupDivisibleDesign`\n- `PairwiseBalancedDesign`\n- `BalancedIncompleteBlockDesign`\n- `TransversalDesign`\n\nAll these classes (which inherit from `IncidenceStructure`) make it easier to do things like compute the `automorphism_group` of a transversal design.\n\nThe branch also adds a function `is_group_divisible_design` in `designs_pyx.pyx`, and an empty `is_pairwise_balanced_design` that call it. We can thus get rid of the ugly `_check_pbd`.\n\nNathann\n\nAssignee: @nathanncohen\n\nCC:  @videlec\n\nBranch/Commit: 5f1fb98b5a72459b220b87f1c902bda62e4a166a\n\nReviewer: Vincent Delecroix\n\nAuthor: Nathann Cohen\n\nDependencies: #16553, #16766\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16598\n\n",
    "closed_at": "2014-08-11T15:01:28Z",
    "created_at": "2014-07-01T09:53:41Z",
    "labels": [
        "component: combinatorial designs"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "New empty design classes for a better user interface and new is_group_divisible_design Cython function",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16598",
    "user": "https://github.com/nathanncohen"
}
```
This branch defines:

- `GroupDivisibleDesign`
- `PairwiseBalancedDesign`
- `BalancedIncompleteBlockDesign`
- `TransversalDesign`

All these classes (which inherit from `IncidenceStructure`) make it easier to do things like compute the `automorphism_group` of a transversal design.

The branch also adds a function `is_group_divisible_design` in `designs_pyx.pyx`, and an empty `is_pairwise_balanced_design` that call it. We can thus get rid of the ugly `_check_pbd`.

Nathann

Assignee: @nathanncohen

CC:  @videlec

Branch/Commit: 5f1fb98b5a72459b220b87f1c902bda62e4a166a

Reviewer: Vincent Delecroix

Author: Nathann Cohen

Dependencies: #16553, #16766

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16598





---

archive/issue_comments_228601.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-01T09:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228601",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_228602.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2014-07-01T09:56:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228602",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_228603.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2014-07-01T09:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228603",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_228604.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-07-01T09:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228604",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_228605.json:
```json
{
    "body": "<a id='comment:4'></a>Hey Nathann,\n\nIn group divisible design, there must be more parameters:\n- `v` the size of the ground set\n- `K` the admissible size of the blocks\n- `G` the admissible size of the groups\nThe definition seems to be standard (see the big paper of Hanani and the definition IV.1.3 of the Handbook)\n\nAnyway, GDD is just a strict generalization of PBD and it is very clear from Handbook IV.1.3.\nThat way, your `is_pbd` would just be a lambda function.\n\nActually, it would be nicer that `IncidenceStructure` would actually be a `GroupDivisibleDesign` (groups being the partition into points). The points can be ordered in such way that the groups are\n\n```\n0 1 ... g1-1|g1 g1+1 ... g1+g2-1|...\n```\nand then the new class would just need an extra `._group_sizes` attribute that would be an integer partition.\n\nSome methods are not well adapted to group divisible designs\n- `dual`: is the dual well defined for GDD?\n- `incidence_matrix`: must be the incidence matrix group/block (or put a flag allowing to have points/blocks)\n- `automorphis_group` is wrong since it must preserver the groups\n\nWhy do you use tuples where everywhere in `IncidenceStructure` there are lists?\n\nWould you mind having a \"stupid\" `.group_sizes()` method?\n\nVincent",
    "created_at": "2014-07-01T12:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228605",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>Hey Nathann,

In group divisible design, there must be more parameters:
- `v` the size of the ground set
- `K` the admissible size of the blocks
- `G` the admissible size of the groups
The definition seems to be standard (see the big paper of Hanani and the definition IV.1.3 of the Handbook)

Anyway, GDD is just a strict generalization of PBD and it is very clear from Handbook IV.1.3.
That way, your `is_pbd` would just be a lambda function.

Actually, it would be nicer that `IncidenceStructure` would actually be a `GroupDivisibleDesign` (groups being the partition into points). The points can be ordered in such way that the groups are

```
0 1 ... g1-1|g1 g1+1 ... g1+g2-1|...
```
and then the new class would just need an extra `._group_sizes` attribute that would be an integer partition.

Some methods are not well adapted to group divisible designs
- `dual`: is the dual well defined for GDD?
- `incidence_matrix`: must be the incidence matrix group/block (or put a flag allowing to have points/blocks)
- `automorphis_group` is wrong since it must preserver the groups

Why do you use tuples where everywhere in `IncidenceStructure` there are lists?

Would you mind having a "stupid" `.group_sizes()` method?

Vincent



---

archive/issue_comments_228606.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-01T12:23:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228606",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_228607.json:
```json
{
    "body": "<a id='comment:5'></a>Note that a solution for computing the automorphism group is as follows:\n1. compute the automorphism group of the partition into groups (the generators can be provided by hand, and I can provide a function for it)\n2. compute the automorphism group of the block design (ie forget about the groups)\n3. make the intersection\n\nI think that it is not that bad in terms of efficiency.\n\nVincent",
    "created_at": "2014-07-01T12:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228607",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>Note that a solution for computing the automorphism group is as follows:
1. compute the automorphism group of the partition into groups (the generators can be provided by hand, and I can provide a function for it)
2. compute the automorphism group of the block design (ie forget about the groups)
3. make the intersection

I think that it is not that bad in terms of efficiency.

Vincent



---

archive/issue_comments_228608.json:
```json
{
    "body": "<a id='comment:6'></a>Yo !\n\n> In group divisible design, there must be more parameters:\n> - `v` the size of the ground set\n> - `K` the admissible size of the blocks\n> - `G` the admissible size of the groups\n> The definition seems to be standard (see the big paper of Hanani and the definition IV.1.3 of the Handbook)\n\n\nSeems more than we need at the moment, but okay ...\n\n> Anyway, GDD is just a strict generalization of PBD and it is very clear from Handbook IV.1.3.\n> That way, your `is_pbd` would just be a lambda function.\n\n\nlambda functions have no documentation. But yes, the code just takes one line.\n\n> Actually, it would be nicer that `IncidenceStructure` would actually be a `GroupDivisibleDesign` (groups being the partition into points). The points can be ordered in such way that the groups are\n> \n> ```\n> 0 1 ... g1-1|g1 g1+1 ... g1+g2-1|...\n> ```\n> and then the new class would just need an extra `._group_sizes` attribute that would be an integer partition.\n\n\nUntil we want GDD to be defined on something different than `0,...,n-1` just like you did for `IncidenceStructure`\n\n> Some methods are not well adapted to group divisible designs\n> - `dual`: is the dual well defined for GDD?\n\n\nGiven that the GDD is a set of blocks, why not ? Plus you wanted two lines above that GDD be equal to an `IncidenceStructure`.\n\n>  - `incidence_matrix`: must be the incidence matrix group/block (or put a flag allowing to have points/blocks)\n\n\nWhy ?\n\n>  - `automorphis_group` is wrong since it must preserver the groups\n\n\nThen the implementation is correct.\n\n> Why do you use tuples where everywhere in `IncidenceStructure` there are lists?\n> \n> Would you mind having a \"stupid\" `.group_sizes()` method?\n\n\nYes, I hate those methods. Write it if you want one.\n\nNathann",
    "created_at": "2014-07-01T12:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228608",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>Yo !

> In group divisible design, there must be more parameters:
> - `v` the size of the ground set
> - `K` the admissible size of the blocks
> - `G` the admissible size of the groups
> The definition seems to be standard (see the big paper of Hanani and the definition IV.1.3 of the Handbook)


Seems more than we need at the moment, but okay ...

> Anyway, GDD is just a strict generalization of PBD and it is very clear from Handbook IV.1.3.
> That way, your `is_pbd` would just be a lambda function.


lambda functions have no documentation. But yes, the code just takes one line.

> Actually, it would be nicer that `IncidenceStructure` would actually be a `GroupDivisibleDesign` (groups being the partition into points). The points can be ordered in such way that the groups are
> 
> ```
> 0 1 ... g1-1|g1 g1+1 ... g1+g2-1|...
> ```
> and then the new class would just need an extra `._group_sizes` attribute that would be an integer partition.


Until we want GDD to be defined on something different than `0,...,n-1` just like you did for `IncidenceStructure`

> Some methods are not well adapted to group divisible designs
> - `dual`: is the dual well defined for GDD?


Given that the GDD is a set of blocks, why not ? Plus you wanted two lines above that GDD be equal to an `IncidenceStructure`.

>  - `incidence_matrix`: must be the incidence matrix group/block (or put a flag allowing to have points/blocks)


Why ?

>  - `automorphis_group` is wrong since it must preserver the groups


Then the implementation is correct.

> Why do you use tuples where everywhere in `IncidenceStructure` there are lists?
> 
> Would you mind having a "stupid" `.group_sizes()` method?


Yes, I hate those methods. Write it if you want one.

Nathann



---

archive/issue_comments_228609.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-01T13:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228609",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_228610.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-01T13:07:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228610",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_228611.json:
```json
{
    "body": "<a id='comment:9'></a>> Then the implementation is correct.\n\n\ni.e. an automorphism send a non-covered pair of vertices u,v on another non-covered pair of vertices u,v. So a group is sent on another group with the same cardinality.\n\nIt corresponds to the notion of automorphism group you expect for BIBD (`K=[1]`), and it also corresponds to the notion of group that you expect on transversal designs (`K=[k]`).\n\nNathann",
    "created_at": "2014-07-01T13:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228611",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>> Then the implementation is correct.


i.e. an automorphism send a non-covered pair of vertices u,v on another non-covered pair of vertices u,v. So a group is sent on another group with the same cardinality.

It corresponds to the notion of automorphism group you expect for BIBD (`K=[1]`), and it also corresponds to the notion of group that you expect on transversal designs (`K=[k]`).

Nathann



---

archive/issue_comments_228612.json:
```json
{
    "body": "<a id='comment:10'></a>I got it for the automorphism group! Thanks. But your definition of gdd is wrong: any pair of points is either in a group or in lambda blocks **but not both**. And this is why the blocks completely determine the groups: two points are in the same group if they are not in a block!\n\nWhat do you think of having only one class (with blocks and groups) and methods:\n- `.is_t_design(self,t,v,k,l)`\n- `.is_group_divisible_design(self,v,G,K,l)`\n- `.is_partially_balanced_design(self,v,K,l)`\nI do not like the fact of having one extra empty class whose only purpose is a check at creation... Moreover, if we switch to mutable classes it would be cool that after transformations we check the kind of thing we obtain. The only thing that bother me a little bit is this `dual` method which does not make any sense for groups (perhaps it does??).\n\nWhy do you not translate the groups over integers as it is the case for blocks?\n\nYou really like to use tuple of tuples for groups and list of lists for blocks (see comment:4 above)?\n\nVincent",
    "created_at": "2014-07-02T06:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228612",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>I got it for the automorphism group! Thanks. But your definition of gdd is wrong: any pair of points is either in a group or in lambda blocks **but not both**. And this is why the blocks completely determine the groups: two points are in the same group if they are not in a block!

What do you think of having only one class (with blocks and groups) and methods:
- `.is_t_design(self,t,v,k,l)`
- `.is_group_divisible_design(self,v,G,K,l)`
- `.is_partially_balanced_design(self,v,K,l)`
I do not like the fact of having one extra empty class whose only purpose is a check at creation... Moreover, if we switch to mutable classes it would be cool that after transformations we check the kind of thing we obtain. The only thing that bother me a little bit is this `dual` method which does not make any sense for groups (perhaps it does??).

Why do you not translate the groups over integers as it is the case for blocks?

You really like to use tuple of tuples for groups and list of lists for blocks (see comment:4 above)?

Vincent



---

archive/issue_comments_228613.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-07-02T06:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228613",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_228614.json:
```json
{
    "body": "<a id='comment:11'></a>Hello !\n\n> I got it for the automorphism group! Thanks. But your definition of gdd is wrong:\n\n\nAhahahahah. Well, that's what I intended, but... is the new version clearer ?\n\n> What do you think of having only one class (with blocks and groups) and methods:\n> - `.is_t_design(self,t,v,k,l)`\n> - `.is_group_divisible_design(self,v,G,K,l)`\n> - `.is_partially_balanced_design(self,v,K,l)`\n\n\nHow would you call the class ? If you want to have these functions as methods of something, the only choice I see is `IncidenceStructure`. We would have no `.groups()` method but those functions could get the groups as an argument.\n\n> I do not like the fact of having one extra empty class whose only purpose is a check at creation... \n\n\nI just created GDD because it was the common generalization of `TD` and `PBD`. Mostly for the doc at the moment, and we will have some place to put code that works on groups. \n\n> Moreover, if we switch to mutable classes it would be cool that after transformations we check the kind of thing we obtain. \n\n\nHmmmm... I don't expect that GDD or anything that inherits from it will ever be mutable. `IncidenceStructure` could be mutable someday, though. It wouldn't be cool to have a GDD object which is not a GDD. Plus as you noticed, most of these objects are created from others, rarely modified inplace.\n\n> The only thing that bother me a little bit is this `dual` method which does not make any sense for groups (perhaps it does??).\n\n\nWell, it just does not consider them. To me those \"groups\" are a parameter of the design, nothing else... The dual of a dual of a GDD is a GDD, so everything is cool. The blocks are forgotten (they can be re-computed automatically anyway), but who cares ? I don't think that you would find any other definition of the dual of a GDD anywhere...\n\n> Why do you not translate the groups over integers as it is the case for blocks?\n\n\nOh. I thought that I would only define GDD for integer ground set, but indeed it also handles the non-integer case almost for free as we know that \"._blocks\" are already translated to integers. You are right. I will updated that in a second.\n\n> You really like to use tuple of tuples for groups and list of lists for blocks (see comment:4 above)?\n\n\nI don't understand. `.groups()` returns lists at the moment (before my commit)\n\n```\ndef groups(self):\n    return map(list,self._groups)\n```\n\nOh, I see ! You meant for internal storage ! Fixed in the new commit.\n\nNathann\n\nP.S. : While writing the commit, I made IncidenceStructure mutable. But it's not reaaaaaaaaaaallly a problem, it preserves all the structure ! `:-D`",
    "created_at": "2014-07-02T10:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228614",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:11'></a>Hello !

> I got it for the automorphism group! Thanks. But your definition of gdd is wrong:


Ahahahahah. Well, that's what I intended, but... is the new version clearer ?

> What do you think of having only one class (with blocks and groups) and methods:
> - `.is_t_design(self,t,v,k,l)`
> - `.is_group_divisible_design(self,v,G,K,l)`
> - `.is_partially_balanced_design(self,v,K,l)`


How would you call the class ? If you want to have these functions as methods of something, the only choice I see is `IncidenceStructure`. We would have no `.groups()` method but those functions could get the groups as an argument.

> I do not like the fact of having one extra empty class whose only purpose is a check at creation... 


I just created GDD because it was the common generalization of `TD` and `PBD`. Mostly for the doc at the moment, and we will have some place to put code that works on groups. 

> Moreover, if we switch to mutable classes it would be cool that after transformations we check the kind of thing we obtain. 


Hmmmm... I don't expect that GDD or anything that inherits from it will ever be mutable. `IncidenceStructure` could be mutable someday, though. It wouldn't be cool to have a GDD object which is not a GDD. Plus as you noticed, most of these objects are created from others, rarely modified inplace.

> The only thing that bother me a little bit is this `dual` method which does not make any sense for groups (perhaps it does??).


Well, it just does not consider them. To me those "groups" are a parameter of the design, nothing else... The dual of a dual of a GDD is a GDD, so everything is cool. The blocks are forgotten (they can be re-computed automatically anyway), but who cares ? I don't think that you would find any other definition of the dual of a GDD anywhere...

> Why do you not translate the groups over integers as it is the case for blocks?


Oh. I thought that I would only define GDD for integer ground set, but indeed it also handles the non-integer case almost for free as we know that "._blocks" are already translated to integers. You are right. I will updated that in a second.

> You really like to use tuple of tuples for groups and list of lists for blocks (see comment:4 above)?


I don't understand. `.groups()` returns lists at the moment (before my commit)

```
def groups(self):
    return map(list,self._groups)
```

Oh, I see ! You meant for internal storage ! Fixed in the new commit.

Nathann

P.S. : While writing the commit, I made IncidenceStructure mutable. But it's not reaaaaaaaaaaallly a problem, it preserves all the structure ! `:-D`



---

archive/issue_comments_228615.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-07-02T10:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228615",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_228616.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-02T10:49:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228616",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_228617.json:
```json
{
    "body": "<a id='comment:13'></a>Hi Nathann,\n\nGroups are not a parameter. If you have a GDD, the group are completely determined by the blocks: define the groups in such way that two points are in the same group if and only if they do not belong to a common block.\n\nSo, it makes sense to have `.is_gdd()` at the level of `IncidenceStructure` and make it returns the groups if needed. We can also have a method `.groups()` on `IncidenceStructure` without any attribute `._groups` defined.\n\nWhat do you think?\n\nVincent",
    "created_at": "2014-07-02T11:11:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228617",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>Hi Nathann,

Groups are not a parameter. If you have a GDD, the group are completely determined by the blocks: define the groups in such way that two points are in the same group if and only if they do not belong to a common block.

So, it makes sense to have `.is_gdd()` at the level of `IncidenceStructure` and make it returns the groups if needed. We can also have a method `.groups()` on `IncidenceStructure` without any attribute `._groups` defined.

What do you think?

Vincent



---

archive/issue_comments_228618.json:
```json
{
    "body": "<a id='comment:14'></a>> Groups are not a parameter. \n\n\nv and k are not a parameter of a BIBD either, they can be deduced. Same for K in PBD.\n\n> If you have a GDD, the group are completely determined by the blocks: define the groups in such way that two points are in the same group if and only if they do not belong to a common block.\n\n\nI know, I mentionned it in my last comment....\n\n> So, it makes sense to have `.is_gdd()` at the level of `IncidenceStructure` and make it returns the groups if needed. We can also have a method `.groups()` on `IncidenceStructure` without any attribute `._groups` defined.\n> \n> What do you think?\n\n\nI don't like it, you cannot define \"groups\" properly at this level. What do you think the \"groups\" of `IncidenceStructure(3,[This is the Trac macro *1,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2-macro))` should be ?\n\nNathann",
    "created_at": "2014-07-02T11:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228618",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>> Groups are not a parameter. 


v and k are not a parameter of a BIBD either, they can be deduced. Same for K in PBD.

> If you have a GDD, the group are completely determined by the blocks: define the groups in such way that two points are in the same group if and only if they do not belong to a common block.


I know, I mentionned it in my last comment....

> So, it makes sense to have `.is_gdd()` at the level of `IncidenceStructure` and make it returns the groups if needed. We can also have a method `.groups()` on `IncidenceStructure` without any attribute `._groups` defined.
> 
> What do you think?


I don't like it, you cannot define "groups" properly at this level. What do you think the "groups" of `IncidenceStructure(3,[This is the Trac macro *1,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2-macro))` should be ?

Nathann



---

archive/issue_comments_228619.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 ncohen]:\n> > So, it makes sense to have `.is_gdd()` at the level of `IncidenceStructure` and make it returns the groups if needed. We can also have a method `.groups()` on `IncidenceStructure` without any attribute `._groups` defined.\n> > \n> > What do you think?\n\n> \n> I don't like it, you cannot define \"groups\" properly at this level. What do you think the \"groups\" of `IncidenceStructure(3,[This is the Trac macro *1,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2-macro))` should be ?\n\n\nAll right, add the extra assumption that each point is covered by at least one block! If not `.groups()` raises an exception.",
    "created_at": "2014-07-02T11:45:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228619",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>Replying to [comment:14 ncohen]:
> > So, it makes sense to have `.is_gdd()` at the level of `IncidenceStructure` and make it returns the groups if needed. We can also have a method `.groups()` on `IncidenceStructure` without any attribute `._groups` defined.
> > 
> > What do you think?

> 
> I don't like it, you cannot define "groups" properly at this level. What do you think the "groups" of `IncidenceStructure(3,[This is the Trac macro *1,2* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,2-macro))` should be ?


All right, add the extra assumption that each point is covered by at least one block! If not `.groups()` raises an exception.



---

archive/issue_comments_228620.json:
```json
{
    "body": "<a id='comment:16'></a>> All right, add the extra assumption that each point is covered by at least one block! If not `.groups()` raises an exception.\n\n\nIt's unrelated. What are the blocks of `IncidenceStructure(4,[[0,1],[1,2],[2,3]])` ? I am just telling you that {\"u~v\" if the pair `u,v` is not covered by a block} is not an equivalence relation unless you are in a GDD.\n\nNathann",
    "created_at": "2014-07-02T11:50:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228620",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>> All right, add the extra assumption that each point is covered by at least one block! If not `.groups()` raises an exception.


It's unrelated. What are the blocks of `IncidenceStructure(4,[[0,1],[1,2],[2,3]])` ? I am just telling you that {"u~v" if the pair `u,v` is not covered by a block} is not an equivalence relation unless you are in a GDD.

Nathann



---

archive/issue_comments_228621.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 ncohen]:\n> > All right, add the extra assumption that each point is covered by at least one block! If not `.groups()` raises an exception.\n\n> \n> It's unrelated. What are the blocks of `IncidenceStructure(4,[[0,1],[1,2],[2,3]])` ? I am just telling you that {\"u~v\" if the pair `u,v` is not covered by a block} is not an equivalence relation unless you are in a GDD.\n\n\nFor GDD you have an extra assumption of the existence of a lambda:\n\n```\nblocks = [[0,1],[0,2]]\ngroups = [[0],[1,2]]\n```\nis not a GDD (0 is covered by two blocks, but 1 and 2 are covered by one block). But \"not being in a block\" for pairs is an equivalence relation...\n\nI definitely agree that \"not being in the same block\" is not an equivalence relation for many incidence structures (lack of transitivity)... but it is well defined and symmetric.\n\nVincent",
    "created_at": "2014-07-02T13:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228621",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>Replying to [comment:16 ncohen]:
> > All right, add the extra assumption that each point is covered by at least one block! If not `.groups()` raises an exception.

> 
> It's unrelated. What are the blocks of `IncidenceStructure(4,[[0,1],[1,2],[2,3]])` ? I am just telling you that {"u~v" if the pair `u,v` is not covered by a block} is not an equivalence relation unless you are in a GDD.


For GDD you have an extra assumption of the existence of a lambda:

```
blocks = [[0,1],[0,2]]
groups = [[0],[1,2]]
```
is not a GDD (0 is covered by two blocks, but 1 and 2 are covered by one block). But "not being in a block" for pairs is an equivalence relation...

I definitely agree that "not being in the same block" is not an equivalence relation for many incidence structures (lack of transitivity)... but it is well defined and symmetric.

Vincent



---

archive/issue_comments_228622.json:
```json
{
    "body": "<a id='comment:18'></a>> For GDD you have an extra assumption of the existence of a lambda:\n> \n> ```\n> blocks = [[0,1],[0,2]]\n> groups = [[0],[1,2]]\n> ```\n> is not a GDD (0 is covered by two blocks, but 1 and 2 are covered by one block). But \"not being in a block\" for pairs is an equivalence relation...\n\n\nSince when do you need to be regular to be a GDD ? Even PBD are not necessarily regular ! Lambda is about pairs of vertices.\n\nNathann",
    "created_at": "2014-07-02T13:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228622",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:18'></a>> For GDD you have an extra assumption of the existence of a lambda:
> 
> ```
> blocks = [[0,1],[0,2]]
> groups = [[0],[1,2]]
> ```
> is not a GDD (0 is covered by two blocks, but 1 and 2 are covered by one block). But "not being in a block" for pairs is an equivalence relation...


Since when do you need to be regular to be a GDD ? Even PBD are not necessarily regular ! Lambda is about pairs of vertices.

Nathann



---

archive/issue_comments_228623.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-02T14:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228623",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_228624.json:
```json
{
    "body": "<a id='comment:20'></a>Hi Nathann,\n\nI added a little commit of cleaning (and also replace the deepcopy by something more explicit) at `u/vdelecroix/16598`.\n\nThe semantic of `copy=True/False` is currently not the same with `.blocks()` and `.groups()`. I decided (and you did not complain) that with `copy=False` it just returns a pointer to the attribute `._blocks` which means something on the integers... whatever the ground set could be. If you think it is bad, then we need to change it in `.blocks()` and `.points()`. Otherwise, change it in `.groups()`.\n\nIn the function `is_group_divisible_design` it is assumed that the ground set is `{0, ..., v-1}` (which is just find since it is called with the internal data from `GroupDivisibleDesign`). It would be cool to specify it in the doc...\n\nWhat is the point of `matrix[i*n+j] != <unsigned short> -1` (in `is_group_divisible_design`)?\n\nVincent",
    "created_at": "2014-07-03T06:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228624",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>Hi Nathann,

I added a little commit of cleaning (and also replace the deepcopy by something more explicit) at `u/vdelecroix/16598`.

The semantic of `copy=True/False` is currently not the same with `.blocks()` and `.groups()`. I decided (and you did not complain) that with `copy=False` it just returns a pointer to the attribute `._blocks` which means something on the integers... whatever the ground set could be. If you think it is bad, then we need to change it in `.blocks()` and `.points()`. Otherwise, change it in `.groups()`.

In the function `is_group_divisible_design` it is assumed that the ground set is `{0, ..., v-1}` (which is just find since it is called with the internal data from `GroupDivisibleDesign`). It would be cool to specify it in the doc...

What is the point of `matrix[i*n+j] != <unsigned short> -1` (in `is_group_divisible_design`)?

Vincent



---

archive/issue_comments_228625.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-03T06:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228625",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_228626.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-03T10:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228626",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_228627.json:
```json
{
    "body": "<a id='comment:21'></a>> I added a little commit of cleaning (and also replace the deepcopy by something more explicit) at `u/vdelecroix/16598`.\n\n\nLooks good !\n\n> The semantic of `copy=True/False` is currently not the same with `.blocks()` and `.groups()`. I decided [...]\n\n\nOh, cool ! Actually I thought it was written the way I first wrote `.groups` and I thought that it was not the correct way to implement it, and so I implemented it this way to follow what I thought was the previou choice. I prefer it this way too ! Fixed.\n\n> In the function `is_group_divisible_design` it is assumed that the ground set is `{0, ..., v-1}` (which is just find since it is called with the internal data from `GroupDivisibleDesign`). It would be cool to specify it in the doc...\n\n\nIt was specified in the documentation of the mandatory argument `v`, but I added another occurrence in the one-line description of the function\n\n> What is the point of `matrix[i*n+j] != <unsigned short> -1` (in `is_group_divisible_design`)?\n\n\nLeftover from a previous implementation. Removed !\n\nNathann",
    "created_at": "2014-07-03T10:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228627",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:21'></a>> I added a little commit of cleaning (and also replace the deepcopy by something more explicit) at `u/vdelecroix/16598`.


Looks good !

> The semantic of `copy=True/False` is currently not the same with `.blocks()` and `.groups()`. I decided [...]


Oh, cool ! Actually I thought it was written the way I first wrote `.groups` and I thought that it was not the correct way to implement it, and so I implemented it this way to follow what I thought was the previou choice. I prefer it this way too ! Fixed.

> In the function `is_group_divisible_design` it is assumed that the ground set is `{0, ..., v-1}` (which is just find since it is called with the internal data from `GroupDivisibleDesign`). It would be cool to specify it in the doc...


It was specified in the documentation of the mandatory argument `v`, but I added another occurrence in the one-line description of the function

> What is the point of `matrix[i*n+j] != <unsigned short> -1` (in `is_group_divisible_design`)?


Leftover from a previous implementation. Removed !

Nathann



---

archive/issue_comments_228628.json:
```json
{
    "body": "<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-03T10:30:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228628",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_228629.json:
```json
{
    "body": "<a id='comment:24'></a>`O_o`",
    "created_at": "2014-07-03T14:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228629",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:24'></a>`O_o`



---

archive/issue_comments_228630.json:
```json
{
    "body": "<a id='comment:25'></a>Hey man, I still name my tickets how I see fit, can't I ? `O_o`",
    "created_at": "2014-07-03T14:59:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228630",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:25'></a>Hey man, I still name my tickets how I see fit, can't I ? `O_o`



---

archive/issue_comments_228631.json:
```json
{
    "body": "<a id='comment:26'></a>Of course you can - you just did it and the system didn't stop you, since it's brainless.\n\nThis is however not your ticket, it is a ticket (authored by you) intended to be merged into a public collaborative project, where it is helpful to have meaningful titles/descriptions/commits. If the title is reflective of this ticket, I am ready to set it to positive review as invalid/wontfix.",
    "created_at": "2014-07-03T15:44:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228631",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:26'></a>Of course you can - you just did it and the system didn't stop you, since it's brainless.

This is however not your ticket, it is a ticket (authored by you) intended to be merged into a public collaborative project, where it is helpful to have meaningful titles/descriptions/commits. If the title is reflective of this ticket, I am ready to set it to positive review as invalid/wontfix.



---

archive/issue_comments_228632.json:
```json
{
    "body": "<a id='comment:27'></a>Hopefully, humans are not computers and they do understand humour... if you base your reviews on (first degree interpretation of) title of tickets I am not sure it is only the system which is brainless.",
    "created_at": "2014-07-03T15:57:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228632",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>Hopefully, humans are not computers and they do understand humour... if you base your reviews on (first degree interpretation of) title of tickets I am not sure it is only the system which is brainless.



---

archive/issue_comments_228633.json:
```json
{
    "body": "<a id='comment:28'></a>It seems that one cannot have an enjoyable conversation with anybody, these days ... I don't get it. It cannot be the weather, it is summer !\n\nNathann",
    "created_at": "2014-07-03T15:57:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228633",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:28'></a>It seems that one cannot have an enjoyable conversation with anybody, these days ... I don't get it. It cannot be the weather, it is summer !

Nathann



---

archive/issue_comments_228634.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 vdelecroix]:\n> Hopefully, humans are not computers and they do understand humour... if you base your reviews on (first degree interpretation of) title of tickets I am not sure it is only the system which is brainless.\n\n\nYes, and when these smart humans look at changelogs to get a sense of new functionality, of course they don't stop there: they open each ticket, read the description, the discussion, and the source code of the branch. And who cares about commit messages when it is so easy to look at diff for anything and make your own judgment unbiased by authors humour?\n\nOr perhaps I am wrong all the way from the start and nobody cares about new functionality or history, so it absolutely does not matter what one can or cannot see in changelogs.",
    "created_at": "2014-07-03T16:05:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228634",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:29'></a>Replying to [comment:27 vdelecroix]:
> Hopefully, humans are not computers and they do understand humour... if you base your reviews on (first degree interpretation of) title of tickets I am not sure it is only the system which is brainless.


Yes, and when these smart humans look at changelogs to get a sense of new functionality, of course they don't stop there: they open each ticket, read the description, the discussion, and the source code of the branch. And who cares about commit messages when it is so easy to look at diff for anything and make your own judgment unbiased by authors humour?

Or perhaps I am wrong all the way from the start and nobody cares about new functionality or history, so it absolutely does not matter what one can or cannot see in changelogs.



---

archive/issue_comments_228635.json:
```json
{
    "body": "<a id='comment:30'></a>> Or perhaps I am wrong all the way from the start and nobody cares about new functionality or history, so it absolutely does not matter what one can or cannot see in changelogs.\n\n\nYou are wrong if you believe that you can edit somebody else's ticket without asking for their opinion first. This is not a software development issue, this is called common sense.\n\nNow, as you can see that you do not bring anything to the work going on here, let's stop this. Or continue by email/sage-devel if you like, but let's not polute this trac ticket.\n\nThe same \"smart humans\" you mentionned like to read the trac tickets message by message when they are done with reading the changelog, and we are just wasting their valuable time.\n\nNathann",
    "created_at": "2014-07-03T16:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228635",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:30'></a>> Or perhaps I am wrong all the way from the start and nobody cares about new functionality or history, so it absolutely does not matter what one can or cannot see in changelogs.


You are wrong if you believe that you can edit somebody else's ticket without asking for their opinion first. This is not a software development issue, this is called common sense.

Now, as you can see that you do not bring anything to the work going on here, let's stop this. Or continue by email/sage-devel if you like, but let's not polute this trac ticket.

The same "smart humans" you mentionned like to read the trac tickets message by message when they are done with reading the changelog, and we are just wasting their valuable time.

Nathann



---

archive/issue_comments_228636.json:
```json
{
    "body": "<a id='comment:31'></a>> > Or perhaps I am wrong all the way from the start and nobody cares about new functionality or history, so it absolutely does not matter what one can or cannot see in changelogs.\n\n> \n> You are wrong if you believe that you can edit somebody else's ticket without asking for their opinion first. This is not a software development issue, this is called common sense.\n\n\nTo be far, Nathann, I think the intent was just to clarify the intent of the ticket to those who might not know the whole history of the 'useless classes'.  This seems pretty reasonable, since there are hundreds (if not thousands) of people who browse Trac.  Humor is a pretty slippery thing - all about context :-)\n\nAs to ownership, I would probably disagree that anyone \"owns\" any given ticket, any more than William \"owns\" Sage, but rather that there is significant moral authority vested in knowing the particular code and situation very well.  So people shouldn't change titles without reason, but if there is a helpful title change (as this one was clearly intending to be) we can agree it's in the common good.  Naturally, determining how the Sage community governs itself on this issue is for sage-devel - see also Steven Weber's \"The Success of Open Source\" for background reading on governance in open-source communities.  Should really be required reading for anyone who spends more than a few hours a week on Trac :-)",
    "created_at": "2014-07-05T01:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228636",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:31'></a>> > Or perhaps I am wrong all the way from the start and nobody cares about new functionality or history, so it absolutely does not matter what one can or cannot see in changelogs.

> 
> You are wrong if you believe that you can edit somebody else's ticket without asking for their opinion first. This is not a software development issue, this is called common sense.


To be far, Nathann, I think the intent was just to clarify the intent of the ticket to those who might not know the whole history of the 'useless classes'.  This seems pretty reasonable, since there are hundreds (if not thousands) of people who browse Trac.  Humor is a pretty slippery thing - all about context :-)

As to ownership, I would probably disagree that anyone "owns" any given ticket, any more than William "owns" Sage, but rather that there is significant moral authority vested in knowing the particular code and situation very well.  So people shouldn't change titles without reason, but if there is a helpful title change (as this one was clearly intending to be) we can agree it's in the common good.  Naturally, determining how the Sage community governs itself on this issue is for sage-devel - see also Steven Weber's "The Success of Open Source" for background reading on governance in open-source communities.  Should really be required reading for anyone who spends more than a few hours a week on Trac :-)



---

archive/issue_comments_228637.json:
```json
{
    "body": "Set assignee to @nathanncohen.",
    "created_at": "2014-07-05T09:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228637",
    "user": "https://github.com/nathanncohen"
}
```

Set assignee to @nathanncohen.



---

archive/issue_comments_228638.json:
```json
{
    "body": "<a id='comment:32'></a>(I don't even know what this field is for, but I need to put my name there for political reasons)",
    "created_at": "2014-07-05T09:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228638",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:32'></a>(I don't even know what this field is for, but I need to put my name there for political reasons)



---

archive/issue_comments_228639.json:
```json
{
    "body": "<a id='comment:33'></a>Oh, by the way I answered the sage-devel thread : https://groups.google.com/forum/#!topic/sage-devel/do7EAtPq4Kg\n\nNathann",
    "created_at": "2014-07-05T09:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228639",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:33'></a>Oh, by the way I answered the sage-devel thread : https://groups.google.com/forum/#!topic/sage-devel/do7EAtPq4Kg

Nathann



---

archive/issue_comments_228640.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-19T10:20:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228640",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_228641.json:
```json
{
    "body": "<a id='comment:36'></a>Hi Nathann,\n\n1) There is a problem with your `relabel` method\n\n```\nsage: I = IncidenceStructure(3, [[0,1,2],[0,1]])\nsage: I.relabel({0:'a',1:'b',2:'c'})\nsage: I._point_to_index\n{0: 0, 1: 1, 2: 2}\n```\nbut should be `{'a':0, 'b': 1, 'c': 2}`.\n\n2) For the string representation of divisible design, would not you prefer `Group Divisible Design on 40 points of type 10^4` instead of the current `Group Divisible Design on 40 points and type 10^4`\n\n3) This is very bad\n\n```\nround(sqrt(len(blocks)))\n```\n(i.e. it involves the symbolic ring). You would prefer using the method `sqrtrem` of Sage integers\n\n```\nsage: i,j = 103.sqrtrem()\nsage: 103 == i**2 + j\nTrue\n```\n\n4) In `is_group_divisible_design` the parts `# Check that the groups belong to [0,...,n-1]` and `# Check that the groups belong to [0,...,n-1]` are very complicated. It is not clear to me that it would be the fastest option (did you do some timings?). Would you mind having a more Pythonic version:\n\n```\n# Check that the groups belong to [0,...,n-1]\nif any(i < 0 or i >= n for g in groups for i in g):\n    # bad groups\n    ...\nif any(i < 0 or i >= n for b in blocks for i in b):\n    # bad blocks\n    ...\n```\n\nThat's all for now.\n\nVincent",
    "created_at": "2014-07-19T12:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228641",
    "user": "https://github.com/videlec"
}
```

<a id='comment:36'></a>Hi Nathann,

1) There is a problem with your `relabel` method

```
sage: I = IncidenceStructure(3, [[0,1,2],[0,1]])
sage: I.relabel({0:'a',1:'b',2:'c'})
sage: I._point_to_index
{0: 0, 1: 1, 2: 2}
```
but should be `{'a':0, 'b': 1, 'c': 2}`.

2) For the string representation of divisible design, would not you prefer `Group Divisible Design on 40 points of type 10^4` instead of the current `Group Divisible Design on 40 points and type 10^4`

3) This is very bad

```
round(sqrt(len(blocks)))
```
(i.e. it involves the symbolic ring). You would prefer using the method `sqrtrem` of Sage integers

```
sage: i,j = 103.sqrtrem()
sage: 103 == i**2 + j
True
```

4) In `is_group_divisible_design` the parts `# Check that the groups belong to [0,...,n-1]` and `# Check that the groups belong to [0,...,n-1]` are very complicated. It is not clear to me that it would be the fastest option (did you do some timings?). Would you mind having a more Pythonic version:

```
# Check that the groups belong to [0,...,n-1]
if any(i < 0 or i >= n for g in groups for i in g):
    # bad groups
    ...
if any(i < 0 or i >= n for b in blocks for i in b):
    # bad blocks
    ...
```

That's all for now.

Vincent



---

archive/issue_comments_228642.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-07-19T12:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228642",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_228643.json:
```json
{
    "body": "<a id='comment:37'></a>YOoooooooo !\n\n> 1) There is a problem with your `relabel` method\n\n\nGloops. Sorry 'bout that `:-/`\n\n> 2) For the string representation of divisible design, would not you prefer `Group Divisible Design on 40 points of type 10^4` instead of the current `Group Divisible Design on 40 points and type 10^4`\n\n\nI don't care. I changed it,\n\n> 3) This is very bad\n> \n> ```\n> round(sqrt(len(blocks)))\n> ```\n> (i.e. it involves the symbolic ring).\n\n\nIs it bad to involve the symbolic ring ? `O_o`\n\nI imported sqrt from Python instead.\n\n> 4) In `is_group_divisible_design` the parts `# Check that the groups belong to [0,...,n-1]` and `# Check that the groups belong to [0,...,n-1]` are very complicated. It is not clear to me that it would be the fastest option (did you do some timings?). Would you mind having a more Pythonic version:\n> \n> ```\n> # Check that the groups belong to [0,...,n-1]\n> if any(i < 0 or i >= n for g in groups for i in g):\n>     # bad groups\n>     ...\n> if any(i < 0 or i >= n for b in blocks for i in b):\n>     # bad blocks\n>     ...\n> ```\n\n\nThis code raises an exception when i cannot be turned into an integer. I simplified it a bit, though.\n\nNathann",
    "created_at": "2014-07-19T17:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228643",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:37'></a>YOoooooooo !

> 1) There is a problem with your `relabel` method


Gloops. Sorry 'bout that `:-/`

> 2) For the string representation of divisible design, would not you prefer `Group Divisible Design on 40 points of type 10^4` instead of the current `Group Divisible Design on 40 points and type 10^4`


I don't care. I changed it,

> 3) This is very bad
> 
> ```
> round(sqrt(len(blocks)))
> ```
> (i.e. it involves the symbolic ring).


Is it bad to involve the symbolic ring ? `O_o`

I imported sqrt from Python instead.

> 4) In `is_group_divisible_design` the parts `# Check that the groups belong to [0,...,n-1]` and `# Check that the groups belong to [0,...,n-1]` are very complicated. It is not clear to me that it would be the fastest option (did you do some timings?). Would you mind having a more Pythonic version:
> 
> ```
> # Check that the groups belong to [0,...,n-1]
> if any(i < 0 or i >= n for g in groups for i in g):
>     # bad groups
>     ...
> if any(i < 0 or i >= n for b in blocks for i in b):
>     # bad blocks
>     ...
> ```


This code raises an exception when i cannot be turned into an integer. I simplified it a bit, though.

Nathann



---

archive/issue_comments_228644.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-07-19T17:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228644",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_228645.json:
```json
{
    "body": "<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-19T17:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228645",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_228646.json:
```json
{
    "body": "<a id='comment:39'></a>Hi,\n\nCould we move ` _relabel_bibd` as a method of `BalancedIncompleteBlockDesign`?\n\n(not very important) Why did you put the classes `PairwiseBalancedDesign` and `BalancedIncompleteBlockDesign` in the file `bibd.py` and not in `incidence_structure.py`? I am not sure about what is the best organization should be, but right now it is not clear at all where to look to find something.\n\nVincent",
    "created_at": "2014-07-19T19:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228646",
    "user": "https://github.com/videlec"
}
```

<a id='comment:39'></a>Hi,

Could we move ` _relabel_bibd` as a method of `BalancedIncompleteBlockDesign`?

(not very important) Why did you put the classes `PairwiseBalancedDesign` and `BalancedIncompleteBlockDesign` in the file `bibd.py` and not in `incidence_structure.py`? I am not sure about what is the best organization should be, but right now it is not clear at all where to look to find something.

Vincent



---

archive/issue_comments_228647.json:
```json
{
    "body": "<a id='comment:40'></a>> Could we move ` _relabel_bibd` as a method of `BalancedIncompleteBlockDesign`?\n\n\nHmmmm.. Well, it woud mean that we have to build BIBD objects during the recursive constructions too... I'd prefer to keep it this way if you don't mind `:-/`\n\n> (not very important) Why did you put the classes `PairwiseBalancedDesign` and `BalancedIncompleteBlockDesign` in the file `bibd.py` and not in `incidence_structure.py`? I am not sure about what is the best organization should be, but right now it is not clear at all where to look to find something.\n\n\nWell, that `BalancedIncompleteBlockDesign` is defined is `bibd.py` is hardly a surprise. I feel that PBD are very close to BIBD but indeed, if GDD are in IncidenceStructure then indeed it can be moved there. What do you think ?\n\nNathann",
    "created_at": "2014-07-19T19:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228647",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:40'></a>> Could we move ` _relabel_bibd` as a method of `BalancedIncompleteBlockDesign`?


Hmmmm.. Well, it woud mean that we have to build BIBD objects during the recursive constructions too... I'd prefer to keep it this way if you don't mind `:-/`

> (not very important) Why did you put the classes `PairwiseBalancedDesign` and `BalancedIncompleteBlockDesign` in the file `bibd.py` and not in `incidence_structure.py`? I am not sure about what is the best organization should be, but right now it is not clear at all where to look to find something.


Well, that `BalancedIncompleteBlockDesign` is defined is `bibd.py` is hardly a surprise. I feel that PBD are very close to BIBD but indeed, if GDD are in IncidenceStructure then indeed it can be moved there. What do you think ?

Nathann



---

archive/issue_comments_228648.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-23T12:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228648",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_228649.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:37 ncohen]:\n> YOoooooooo !\n> \n> > 1) There is a problem with your `relabel` method\n\n> \n> Gloops. Sorry 'bout that `:-/`\n\n\nThere is still a subtle issue. When we ask for a relabeling we do not necessarily want to relabel the points. More precisely, if the ground set is {0,1,2,3} and I want to relabel {0:1, 1:3, 2:1, 3:0} I would like the ground set to be fixed and the blocks to be changed... what do you think?\n \n> > 3) This is very bad\n> > \n> > ```\n> > round(sqrt(len(blocks)))\n> > ```\n> > (i.e. it involves the symbolic ring).\n  \n> \n> Is it bad to involve the symbolic ring ? `O_o`\n\n\nYes: SR is very slow and unreliable (though for sqrt of integers it should be ok).\n\nVincent",
    "created_at": "2014-08-08T10:49:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228649",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>Replying to [comment:37 ncohen]:
> YOoooooooo !
> 
> > 1) There is a problem with your `relabel` method

> 
> Gloops. Sorry 'bout that `:-/`


There is still a subtle issue. When we ask for a relabeling we do not necessarily want to relabel the points. More precisely, if the ground set is {0,1,2,3} and I want to relabel {0:1, 1:3, 2:1, 3:0} I would like the ground set to be fixed and the blocks to be changed... what do you think?
 
> > 3) This is very bad
> > 
> > ```
> > round(sqrt(len(blocks)))
> > ```
> > (i.e. it involves the symbolic ring).
  
> 
> Is it bad to involve the symbolic ring ? `O_o`


Yes: SR is very slow and unreliable (though for sqrt of integers it should be ok).

Vincent



---

archive/issue_comments_228650.json:
```json
{
    "body": "<a id='comment:43'></a>updated version at u/vdelecroix/16598 (above 6.3.rc1 and #16766)\n\nVincent",
    "created_at": "2014-08-08T10:50:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228650",
    "user": "https://github.com/videlec"
}
```

<a id='comment:43'></a>updated version at u/vdelecroix/16598 (above 6.3.rc1 and #16766)

Vincent



---

archive/issue_comments_228651.json:
```json
{
    "body": "<a id='comment:44'></a>Yoooooooo !!\n\n> There is still a subtle issue. When we ask for a relabeling we do not necessarily want to relabel the points. More precisely, if the ground set is {0,1,2,3} and I want to relabel {0:1, 1:3, 2:1, 3:0} I would like the ground set to be fixed and the blocks to be changed... what do you think?\n\n\nI don't understand. You are just relabeling with the same ground sets, what's the problem with that ? And how does that badly affect the blocks ? Some will change, some will not, what's the problem ?\n\n> Yes: SR is very slow and unreliable (though for sqrt of integers it should be ok).\n\n\n\"B\u00f4f\". If it does not work it's a bug report, and if Sage cannot compute square roots safely we should fork it quick `:-P`\n\nNathann",
    "created_at": "2014-08-08T11:00:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228651",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:44'></a>Yoooooooo !!

> There is still a subtle issue. When we ask for a relabeling we do not necessarily want to relabel the points. More precisely, if the ground set is {0,1,2,3} and I want to relabel {0:1, 1:3, 2:1, 3:0} I would like the ground set to be fixed and the blocks to be changed... what do you think?


I don't understand. You are just relabeling with the same ground sets, what's the problem with that ? And how does that badly affect the blocks ? Some will change, some will not, what's the problem ?

> Yes: SR is very slow and unreliable (though for sqrt of integers it should be ok).


"Bôf". If it does not work it's a bug report, and if Sage cannot compute square roots safely we should fork it quick `:-P`

Nathann



---

archive/issue_comments_228652.json:
```json
{
    "body": "<a id='comment:45'></a>New commits:",
    "created_at": "2014-08-08T11:02:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228652",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:45'></a>New commits:



---

archive/issue_comments_228653.json:
```json
{
    "body": "<a id='comment:47'></a>Replying to [comment:44 ncohen]:\n> Yoooooooo !!\n> \n> > There is still a subtle issue. When we ask for a relabeling we do not necessarily want to relabel the points. More precisely, if the ground set is {0,1,2,3} and I want to relabel {0:1, 1:3, 2:1, 3:0} I would like the ground set to be fixed and the blocks to be changed... what do you think?\n\n> \n> I don't understand. You are just relabeling with the same ground sets, what's the problem with that ? And how does that badly affect the blocks ? Some will change, some will not, what's the problem ?\n\n\n```\nsage: I = IncidenceStructure(4,[[0,1,2],[1,3]])\nsage: I.ground_set()\n[0, 1, 2, 3]\nsage: I.relabel({0:3,1:2,2:1,3:0})\nsage: I.ground_set()\n[3, 2, 1, 0]\n```\nthe ground set has changed...\n\nVincent",
    "created_at": "2014-08-09T06:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228653",
    "user": "https://github.com/videlec"
}
```

<a id='comment:47'></a>Replying to [comment:44 ncohen]:
> Yoooooooo !!
> 
> > There is still a subtle issue. When we ask for a relabeling we do not necessarily want to relabel the points. More precisely, if the ground set is {0,1,2,3} and I want to relabel {0:1, 1:3, 2:1, 3:0} I would like the ground set to be fixed and the blocks to be changed... what do you think?

> 
> I don't understand. You are just relabeling with the same ground sets, what's the problem with that ? And how does that badly affect the blocks ? Some will change, some will not, what's the problem ?


```
sage: I = IncidenceStructure(4,[[0,1,2],[1,3]])
sage: I.ground_set()
[0, 1, 2, 3]
sage: I.relabel({0:3,1:2,2:1,3:0})
sage: I.ground_set()
[3, 2, 1, 0]
```
the ground set has changed...

Vincent



---

archive/issue_comments_228654.json:
```json
{
    "body": "<a id='comment:48'></a>Yooooo !\n\n> {{{\n> sage: I = IncidenceStructure(4,[[0,1,2],[1,3]])\n> sage: I.ground_set()\n> [0, 1, 2, 3]\n> sage: I.relabel({0:3,1:2,2:1,3:0})\n> sage: I.ground_set()\n> [3, 2, 1, 0]\n> }}}\n> the ground set has changed...\n\n\nWell, as a list it has, not as a set... \n\nI think that being smart here only raises new problems. Relabelling all blocks takes much more time and memory than relabelling the points only. We could hide that by returning a sorted list of points, but well... \n\nNathann",
    "created_at": "2014-08-10T07:41:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228654",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:48'></a>Yooooo !

> {{{
> sage: I = IncidenceStructure(4,[[0,1,2],[1,3]])
> sage: I.ground_set()
> [0, 1, 2, 3]
> sage: I.relabel({0:3,1:2,2:1,3:0})
> sage: I.ground_set()
> [3, 2, 1, 0]
> }}}
> the ground set has changed...


Well, as a list it has, not as a set... 

I think that being smart here only raises new problems. Relabelling all blocks takes much more time and memory than relabelling the points only. We could hide that by returning a sorted list of points, but well... 

Nathann



---

archive/issue_comments_228655.json:
```json
{
    "body": "<a id='comment:49'></a>Hello,\n\nAll right, we will see in the future.\n\nVincent",
    "created_at": "2014-08-10T13:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228655",
    "user": "https://github.com/videlec"
}
```

<a id='comment:49'></a>Hello,

All right, we will see in the future.

Vincent



---

archive/issue_comments_228656.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-10T13:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228656",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_048688.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16598#event-48688"
}
```



---

archive/issue_comments_228657.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-08-10T23:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228657",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_228658.json:
```json
{
    "body": "<a id='comment:51'></a>Reviewer name",
    "created_at": "2014-08-10T23:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228658",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:51'></a>Reviewer name



---

archive/issue_comments_228659.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-08-11T07:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228659",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_228660.json:
```json
{
    "body": "<a id='comment:53'></a>New commits:",
    "created_at": "2014-08-11T08:01:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228660",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:53'></a>New commits:



---

archive/issue_events_048689.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-11T15:01:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16598#event-48689"
}
```



---

archive/issue_comments_228661.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-11T15:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16598",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16598#issuecomment-228661",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
