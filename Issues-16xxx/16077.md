# Issue 16077: Python 3 preparation: Handle changes to "raw_input()" and "input()"

archive/issues_015840.json:
```json
{
    "body": "Keywords: python3\n\nThe Py2 function `raw_input()` is called `input()` in Py3. \n\n\nThe Py2 `input()` function (which implicitly evaluates the input) is gone.\n\nThe tool 2to3 renames `raw_input` to `input`. \n\n\nBut the code has to depend on the Python version!\n\nThere are 3 effected (usage of `raw_input()`) modules. \n\nThis ticket is tracked as a dependency of meta-ticket ticket:16052.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16077\n\n",
    "closed_at": "2015-06-11T13:50:57Z",
    "created_at": "2014-04-07T08:58:43Z",
    "labels": [
        "component: distribution"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "Python 3 preparation: Handle changes to \"raw_input()\" and \"input()\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16077",
    "user": "https://github.com/wluebbe"
}
```
Keywords: python3

The Py2 function `raw_input()` is called `input()` in Py3. 


The Py2 `input()` function (which implicitly evaluates the input) is gone.

The tool 2to3 renames `raw_input` to `input`. 


But the code has to depend on the Python version!

There are 3 effected (usage of `raw_input()`) modules. 

This ticket is tracked as a dependency of meta-ticket ticket:16052.

Issue created by migration from https://trac.sagemath.org/ticket/16077





---

archive/issue_events_047318.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16077#event-47318"
}
```



---

archive/issue_events_047319.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16077#event-47319"
}
```



---

archive/issue_events_047320.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16077#event-47320"
}
```



---

archive/issue_events_047321.json:
```json
{
    "actor": "https://github.com/a-andre",
    "created_at": "2015-06-07T09:32:09Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16077#event-47321"
}
```



---

archive/issue_events_047322.json:
```json
{
    "actor": "https://github.com/a-andre",
    "created_at": "2015-06-07T09:32:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16077#event-47322"
}
```



---

archive/issue_comments_205331.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-07T09:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205331",
    "user": "https://github.com/a-andre"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_205332.json:
```json
{
    "body": "Instead of \n\n```\n+import six\n...\n...\n-            line = raw_input()\n+            line = six.moves.input()\n```\nI would prefer\n\n```\n+from six.moves import input\n...\n...\n-            line = raw_input()\n+            line = input()\n```\nThe reasoning is\n* I see the goal as not only to enable Sage for Python 2 AND 3 but by writing **clean Python 3 code that is backwards compatible with Python 2**.\n* Usage of compatibility libraries like `six` (or `future`) should appear (if possible) only at the top of a module. The rest of the module should have only pure Python 3 code. \n* This will ease the cleaning of the code when somewhere in the (far) future Python 2 support will be dropped.\n* We will have to explain in the documentation how the write Python 3 code in Sage while maintaining compatibility with Python 2. And it would by very helpful to have automated checks ...\nBy the way all tests pass :-)",
    "created_at": "2015-06-08T13:14:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205332",
    "user": "https://github.com/wluebbe"
}
```

Instead of 

```
+import six
...
...
-            line = raw_input()
+            line = six.moves.input()
```
I would prefer

```
+from six.moves import input
...
...
-            line = raw_input()
+            line = input()
```
The reasoning is
* I see the goal as not only to enable Sage for Python 2 AND 3 but by writing **clean Python 3 code that is backwards compatible with Python 2**.
* Usage of compatibility libraries like `six` (or `future`) should appear (if possible) only at the top of a module. The rest of the module should have only pure Python 3 code. 
* This will ease the cleaning of the code when somewhere in the (far) future Python 2 support will be dropped.
* We will have to explain in the documentation how the write Python 3 code in Sage while maintaining compatibility with Python 2. And it would by very helpful to have automated checks ...
By the way all tests pass :-)



---

archive/issue_comments_205333.json:
```json
{
    "body": "Replying to [comment:4 wluebbe]:\n> {{{\n> +from six.moves import input\n> ...\n> ...\n> -            line = raw_input()\n> +            line = input()\n> }}}\n\n\nwould override Python2's `input()` which behaves different, as written in the ticket description. That's why I went the other way.\n\nCleaning is easy, too: `s/six.moves.//g`",
    "created_at": "2015-06-08T19:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205333",
    "user": "https://github.com/a-andre"
}
```

Replying to [comment:4 wluebbe]:
> {{{
> +from six.moves import input
> ...
> ...
> -            line = raw_input()
> +            line = input()
> }}}


would override Python2's `input()` which behaves different, as written in the ticket description. That's why I went the other way.

Cleaning is easy, too: `s/six.moves.//g`



---

archive/issue_comments_205334.json:
```json
{
    "body": "I did not find any uses of Python 2 `input()` in Sage, so there is no name conflict.\nThis old `input()` has been removed from Python 3 as it is not secure because `eval()` is called implicitly on an unchecked string.",
    "created_at": "2015-06-08T19:54:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205334",
    "user": "https://github.com/wluebbe"
}
```

I did not find any uses of Python 2 `input()` in Sage, so there is no name conflict.
This old `input()` has been removed from Python 3 as it is not secure because `eval()` is called implicitly on an unchecked string.



---

archive/issue_comments_205335.json:
```json
{
    "body": "Users might import one of the effected files and therefore change the meaning of `input()` in their scripts. Although I doubt anybody will import these.",
    "created_at": "2015-06-08T20:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205335",
    "user": "https://github.com/a-andre"
}
```

Users might import one of the effected files and therefore change the meaning of `input()` in their scripts. Although I doubt anybody will import these.



---

archive/issue_comments_205336.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-06-09T10:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205336",
    "user": "https://github.com/wluebbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_205337.json:
```json
{
    "body": "I still hold that the comment\n> * I see the goal as not only to enable Sage for Python 2 AND 3 but by writing **clean Python 3 code that is backwards compatible with Python 2**.\n \nis valid and important.\n\nBut this change effects only 3 modules, the code is fine and it tests OK.\n\nBut we should discuss on sage-devel how to approach the other and bigger tickets of stage 2 (usage of migration tools, which compatibility library, ...). I will try to initiate such a wider discussion of the Sage Py2/3 migration strategy. We will advance faster when there are more collaborators and ideas. A common understanding and strategy  could prevent wasted efforts.",
    "created_at": "2015-06-09T10:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205337",
    "user": "https://github.com/wluebbe"
}
```

I still hold that the comment
> * I see the goal as not only to enable Sage for Python 2 AND 3 but by writing **clean Python 3 code that is backwards compatible with Python 2**.
 
is valid and important.

But this change effects only 3 modules, the code is fine and it tests OK.

But we should discuss on sage-devel how to approach the other and bigger tickets of stage 2 (usage of migration tools, which compatibility library, ...). I will try to initiate such a wider discussion of the Sage Py2/3 migration strategy. We will advance faster when there are more collaborators and ideas. A common understanding and strategy  could prevent wasted efforts.



---

archive/issue_events_047323.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-11T13:50:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16077#event-47323"
}
```



---

archive/issue_comments_205338.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-06-11T13:50:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16077#issuecomment-205338",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
