# Issue 16066: 'make doc-clean' calls system-wide 'git', which may break 'make distclean'

archive/issues_016066.json:
```json
{
    "body": "CC:  @jhpalmieri @vbraun jguzman\n\nFrom sage-devel:\n\n```\nsage-6.2 build successfully, but perhaps the make doc-clean was not successful\n\nmake doc-clean\ncd src/doc && make -j4 clean\nDeleting generated docs...\nrm -rf en/reference/*/sage\nrm -rf en/reference/*/sagenb\nrm -rf en/reference/sage\nrm -rf en/reference/sagenb\nrm -rf output\ngit clean -f -d .\nmake[1]: git: No such file or directory\nmake[1]: *** [clean] Error 1\nmake: *** [doc-clean] Error 2\n\n\nWhat am I supposed to do?\n```\n\nIn `src/doc/Makefile` we have:\n\n```make\nall:\n        @echo \"Please build the doc using either 'make doc' from SAGE_ROOT, or\"\n        @echo \"'sage -docbuild all html'. See 'sage -docbuild help' for more informations.\"\nclean:\n        @echo \"Deleting generated docs...\"\n        rm -rf en/reference/*/sage\n        rm -rf en/reference/*/sagenb\n        rm -rf en/reference/sage\n        rm -rf en/reference/sagenb\n        rm -rf output\n        git clean -f -d .\n```\n\nand that's called from the top-level `Makefile` (outside a Sage subshell).\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16303\n\n",
    "closed_at": "2014-06-19T13:12:43Z",
    "created_at": "2014-05-07T13:51:33Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "'make doc-clean' calls system-wide 'git', which may break 'make distclean'",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16066",
    "user": "https://github.com/nexttime"
}
```
CC:  @jhpalmieri @vbraun jguzman

From sage-devel:

```
sage-6.2 build successfully, but perhaps the make doc-clean was not successful

make doc-clean
cd src/doc && make -j4 clean
Deleting generated docs...
rm -rf en/reference/*/sage
rm -rf en/reference/*/sagenb
rm -rf en/reference/sage
rm -rf en/reference/sagenb
rm -rf output
git clean -f -d .
make[1]: git: No such file or directory
make[1]: *** [clean] Error 1
make: *** [doc-clean] Error 2


What am I supposed to do?
```

In `src/doc/Makefile` we have:

```make
all:
        @echo "Please build the doc using either 'make doc' from SAGE_ROOT, or"
        @echo "'sage -docbuild all html'. See 'sage -docbuild help' for more informations."
clean:
        @echo "Deleting generated docs..."
        rm -rf en/reference/*/sage
        rm -rf en/reference/*/sagenb
        rm -rf en/reference/sage
        rm -rf en/reference/sagenb
        rm -rf output
        git clean -f -d .
```

and that's called from the top-level `Makefile` (outside a Sage subshell).


Issue created by migration from https://trac.sagemath.org/ticket/16303





---

archive/issue_comments_208896.json:
```json
{
    "body": "Thoughts?\n\nTry to call Sage's `git` if present otherwise?\n\nJust add a dash to the last line?  (What does `git` remove we couldn't by other means?)",
    "created_at": "2014-05-07T13:58:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208896",
    "user": "https://github.com/nexttime"
}
```

Thoughts?

Try to call Sage's `git` if present otherwise?

Just add a dash to the last line?  (What does `git` remove we couldn't by other means?)



---

archive/issue_comments_208897.json:
```json
{
    "body": "Actually, I think I do have git installed systemwide. At least this works outside sage\n\n```\nlolita-4:/ anne$ git --version\ngit version 1.8.4.2\n```",
    "created_at": "2014-05-07T16:35:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208897",
    "user": "https://github.com/anneschilling"
}
```

Actually, I think I do have git installed systemwide. At least this works outside sage

```
lolita-4:/ anne$ git --version
git version 1.8.4.2
```



---

archive/issue_comments_208898.json:
```json
{
    "body": "Replying to [comment:2 aschilling]:\n> Actually, I think I do have git installed systemwide. At least this works outside sage\n> \n> ```\n> lolita-4:/ anne$ git --version\n> git version 1.8.4.2\n> ```\n\n\nHmmm, but it apparently wasn't in your `PATH` when you were running `make doc-clean`.",
    "created_at": "2014-05-07T16:55:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208898",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:2 aschilling]:
> Actually, I think I do have git installed systemwide. At least this works outside sage
> 
> ```
> lolita-4:/ anne$ git --version
> git version 1.8.4.2
> ```


Hmmm, but it apparently wasn't in your `PATH` when you were running `make doc-clean`.



---

archive/issue_comments_208899.json:
```json
{
    "body": "I like the idea of adding a dash to the last line. That git command looks like a last resort anyway: the earlier part of the recipe deletes all of the autogenerated stuff. In the past, if someone did `sage --docbuild reference/junk html`, then it would create a directory `doc/en/reference/junk` (I think) which would then mess up later docbuilding, but this was fixed recently. I'm not sure how else we'd get anything that git would need to clean up.",
    "created_at": "2014-05-07T17:12:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208899",
    "user": "https://github.com/jhpalmieri"
}
```

I like the idea of adding a dash to the last line. That git command looks like a last resort anyway: the earlier part of the recipe deletes all of the autogenerated stuff. In the past, if someone did `sage --docbuild reference/junk html`, then it would create a directory `doc/en/reference/junk` (I think) which would then mess up later docbuilding, but this was fixed recently. I'm not sure how else we'd get anything that git would need to clean up.



---

archive/issue_comments_208900.json:
```json
{
    "body": "I like one-character fixes.",
    "created_at": "2014-05-07T17:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208900",
    "user": "https://github.com/nexttime"
}
```

I like one-character fixes.



---

archive/issue_comments_208901.json:
```json
{
    "body": "And while doing so doesn't fix anything related to docbuilding, it will indeed fix `make distclean` (in the cases where no system-wide `git` is available)... :-)",
    "created_at": "2014-05-07T17:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208901",
    "user": "https://github.com/nexttime"
}
```

And while doing so doesn't fix anything related to docbuilding, it will indeed fix `make distclean` (in the cases where no system-wide `git` is available)... :-)



---

archive/issue_comments_208902.json:
```json
{
    "body": "Changing priority from minor to critical.",
    "created_at": "2014-05-07T17:35:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208902",
    "user": "https://github.com/nexttime"
}
```

Changing priority from minor to critical.



---

archive/issue_comments_208903.json:
```json
{
    "body": "Haha, apparently actually Volker added that... XD",
    "created_at": "2014-05-07T17:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208903",
    "user": "https://github.com/nexttime"
}
```

Haha, apparently actually Volker added that... XD



---

archive/issue_comments_208904.json:
```json
{
    "body": "Alternate \"solution\":\n\n```diff\ndiff --git a/src/doc/Makefile b/src/doc/Makefile\nindex a4a15b3..fc0e269 100644\n--- a/src/doc/Makefile\n+++ b/src/doc/Makefile\n@@ -8,5 +8,5 @@ clean:\n        rm -rf en/reference/sage\n        rm -rf en/reference/sagenb\n        rm -rf output\n-       git clean -f -d .\n-\n+       @git clean -f -d . 2>/dev/null || \\\n+       echo \"It is recommended to have a git version installed outside of Sage.\"\n```",
    "created_at": "2014-05-07T19:08:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208904",
    "user": "https://github.com/nexttime"
}
```

Alternate "solution":

```diff
diff --git a/src/doc/Makefile b/src/doc/Makefile
index a4a15b3..fc0e269 100644
--- a/src/doc/Makefile
+++ b/src/doc/Makefile
@@ -8,5 +8,5 @@ clean:
        rm -rf en/reference/sage
        rm -rf en/reference/sagenb
        rm -rf output
-       git clean -f -d .
-
+       @git clean -f -d . 2>/dev/null || \
+       echo "It is recommended to have a git version installed outside of Sage."
```



---

archive/issue_comments_208905.json:
```json
{
    "body": "Replying to [comment:9 leif]:\n> Haha, apparently actually Volker added that... XD\n\n\nI still get the above error in the latest development version. Was this fixed? If so, I am still having trouble!",
    "created_at": "2014-06-01T14:29:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208905",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:9 leif]:
> Haha, apparently actually Volker added that... XD


I still get the above error in the latest development version. Was this fixed? If so, I am still having trouble!



---

archive/issue_comments_208906.json:
```json
{
    "body": "I don't see any branch here, hence it has not been fixed. I'm fine with hiding the git error; if you can post code instead of comments then we can fix it ;-)",
    "created_at": "2014-06-01T17:10:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208906",
    "user": "https://github.com/vbraun"
}
```

I don't see any branch here, hence it has not been fixed. I'm fine with hiding the git error; if you can post code instead of comments then we can fix it ;-)



---

archive/issue_comments_208907.json:
```json
{
    "body": "Replying to [comment:4 jhpalmieri]:\n> I like the idea of adding a dash to the last line. That git command looks like a last resort anyway: the earlier part of the recipe deletes all of the autogenerated stuff.\n\n\nIf that was true, why am I getting\n\n```\ncd src/doc && make clean\nDeleting generated docs...\nrm -rf en/reference/*/sage\nrm -rf en/reference/*/sagenb\nrm -rf en/reference/sage\nrm -rf en/reference/sagenb\nrm -rf output\ngit clean -f -d .\nRemoving common/static/\nRemoving de/thematische_anleitungen/static/\nRemoving de/thematische_anleitungen/templates/\nRemoving de/tutorial/static/\nRemoving de/tutorial/templates/\nRemoving en/a_tour_of_sage/static/\nRemoving en/a_tour_of_sage/templates/\nRemoving en/bordeaux_2008/static/\nRemoving en/bordeaux_2008/templates/\nRemoving en/constructions/static/\nRemoving en/constructions/templates/\nRemoving en/developer/templates/\nRemoving en/faq/static/\nRemoving en/faq/templates/\nRemoving en/installation/static/\nRemoving en/installation/templates/\nRemoving en/numerical_sage/static/\nRemoving en/numerical_sage/templates/\nRemoving en/prep/static/\nRemoving en/prep/templates/\nRemoving en/reference/algebras/static/\nRemoving en/reference/algebras/templates/\nRemoving en/reference/arithgroup/static/\nRemoving en/reference/arithgroup/templates/\nRemoving en/reference/calculus/static/\nRemoving en/reference/calculus/templates/\nRemoving en/reference/categories/static/\nRemoving en/reference/categories/templates/\nRemoving en/reference/coding/static/\nRemoving en/reference/coding/templates/\nRemoving en/reference/coercion/static/\nRemoving en/reference/coercion/templates/\nRemoving en/reference/combinat/static/\nRemoving en/reference/combinat/templates/\nRemoving en/reference/constants/static/\nRemoving en/reference/constants/templates/\nRemoving en/reference/cryptography/static/\nRemoving en/reference/cryptography/templates/\nRemoving en/reference/databases/static/\nRemoving en/reference/databases/templates/\nRemoving en/reference/dev/static/\nRemoving en/reference/dev/templates/\nRemoving en/reference/doctest/static/\nRemoving en/reference/doctest/templates/\nRemoving en/reference/dynamics/static/\nRemoving en/reference/dynamics/templates/\nRemoving en/reference/finance/static/\nRemoving en/reference/finance/templates/\nRemoving en/reference/finite_rings/static/\nRemoving en/reference/finite_rings/templates/\nRemoving en/reference/function_fields/static/\nRemoving en/reference/function_fields/templates/\nRemoving en/reference/functions/static/\nRemoving en/reference/functions/templates/\nRemoving en/reference/games/static/\nRemoving en/reference/games/templates/\nRemoving en/reference/geometry/static/\nRemoving en/reference/geometry/templates/\nRemoving en/reference/graphs/static/\nRemoving en/reference/graphs/templates/\nRemoving en/reference/groups/static/\nRemoving en/reference/groups/templates/\nRemoving en/reference/hecke/static/\nRemoving en/reference/hecke/templates/\nRemoving en/reference/history_and_license/static/\nRemoving en/reference/history_and_license/templates/\nRemoving en/reference/homology/static/\nRemoving en/reference/homology/templates/\nRemoving en/reference/interfaces/static/\nRemoving en/reference/interfaces/templates/\nRemoving en/reference/lfunctions/static/\nRemoving en/reference/lfunctions/templates/\nRemoving en/reference/libs/static/\nRemoving en/reference/libs/templates/\nRemoving en/reference/logic/static/\nRemoving en/reference/logic/templates/\nRemoving en/reference/matrices/static/\nRemoving en/reference/matrices/templates/\nRemoving en/reference/matroids/static/\nRemoving en/reference/matroids/templates/\nRemoving en/reference/misc/static/\nRemoving en/reference/misc/templates/\nRemoving en/reference/modabvar/static/\nRemoving en/reference/modabvar/templates/\nRemoving en/reference/modfrm/static/\nRemoving en/reference/modfrm/templates/\nRemoving en/reference/modmisc/static/\nRemoving en/reference/modmisc/templates/\nRemoving en/reference/modsym/static/\nRemoving en/reference/modsym/templates/\nRemoving en/reference/modules/static/\nRemoving en/reference/modules/templates/\nRemoving en/reference/monoids/static/\nRemoving en/reference/monoids/templates/\nRemoving en/reference/notebook/static/\nRemoving en/reference/notebook/templates/\nRemoving en/reference/number_fields/static/\nRemoving en/reference/number_fields/templates/\nRemoving en/reference/numerical/static/\nRemoving en/reference/numerical/templates/\nRemoving en/reference/padics/static/\nRemoving en/reference/padics/templates/\nRemoving en/reference/parallel/static/\nRemoving en/reference/parallel/templates/\nRemoving en/reference/plane_curves/static/\nRemoving en/reference/plane_curves/templates/\nRemoving en/reference/plot3d/static/\nRemoving en/reference/plot3d/templates/\nRemoving en/reference/plotting/static/\nRemoving en/reference/plotting/templates/\nRemoving en/reference/polynomial_rings/static/\nRemoving en/reference/polynomial_rings/templates/\nRemoving en/reference/power_series/static/\nRemoving en/reference/power_series/templates/\nRemoving en/reference/probability/static/\nRemoving en/reference/probability/templates/\nRemoving en/reference/quadratic_forms/static/\nRemoving en/reference/quadratic_forms/templates/\nRemoving en/reference/quat_algebras/static/\nRemoving en/reference/quat_algebras/templates/\nRemoving en/reference/quivers/static/\nRemoving en/reference/quivers/templates/\nRemoving en/reference/repl/static/\nRemoving en/reference/repl/templates/\nRemoving en/reference/riemannian_geometry/static/\nRemoving en/reference/riemannian_geometry/templates/\nRemoving en/reference/rings/static/\nRemoving en/reference/rings/templates/\nRemoving en/reference/rings_numerical/static/\nRemoving en/reference/rings_numerical/templates/\nRemoving en/reference/rings_standard/static/\nRemoving en/reference/rings_standard/templates/\nRemoving en/reference/sat/static/\nRemoving en/reference/sat/templates/\nRemoving en/reference/schemes/static/\nRemoving en/reference/schemes/templates/\nRemoving en/reference/semirings/static/\nRemoving en/reference/semirings/templates/\nRemoving en/reference/static/\nRemoving en/reference/stats/static/\nRemoving en/reference/stats/templates/\nRemoving en/reference/structure/static/\nRemoving en/reference/structure/templates/\nRemoving en/reference/templates/\nRemoving en/reference/tensor/static/\nRemoving en/reference/tensor/templates/\nRemoving en/thematic_tutorials/static/\nRemoving en/thematic_tutorials/templates/\nRemoving en/tutorial/static/\nRemoving en/tutorial/templates/\nRemoving fr/a_tour_of_sage/static/\nRemoving fr/a_tour_of_sage/templates/\nRemoving fr/tutorial/static/\nRemoving fr/tutorial/templates/\nRemoving pt/a_tour_of_sage/static/\nRemoving pt/a_tour_of_sage/templates/\nRemoving ru/tutorial/static/\nRemoving ru/tutorial/templates/\nRemoving tr/a_tour_of_sage/static/\nRemoving tr/a_tour_of_sage/templates/\n```\n?\n\n> [...] I'm not sure how else we'd get anything that git would need to clean up.\n\n\nI mean removing those (empty?) folders might not be necessary (I don't know), but certainly the `git clean` there isn't a nop.",
    "created_at": "2014-06-01T17:44:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208907",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:4 jhpalmieri]:
> I like the idea of adding a dash to the last line. That git command looks like a last resort anyway: the earlier part of the recipe deletes all of the autogenerated stuff.


If that was true, why am I getting

```
cd src/doc && make clean
Deleting generated docs...
rm -rf en/reference/*/sage
rm -rf en/reference/*/sagenb
rm -rf en/reference/sage
rm -rf en/reference/sagenb
rm -rf output
git clean -f -d .
Removing common/static/
Removing de/thematische_anleitungen/static/
Removing de/thematische_anleitungen/templates/
Removing de/tutorial/static/
Removing de/tutorial/templates/
Removing en/a_tour_of_sage/static/
Removing en/a_tour_of_sage/templates/
Removing en/bordeaux_2008/static/
Removing en/bordeaux_2008/templates/
Removing en/constructions/static/
Removing en/constructions/templates/
Removing en/developer/templates/
Removing en/faq/static/
Removing en/faq/templates/
Removing en/installation/static/
Removing en/installation/templates/
Removing en/numerical_sage/static/
Removing en/numerical_sage/templates/
Removing en/prep/static/
Removing en/prep/templates/
Removing en/reference/algebras/static/
Removing en/reference/algebras/templates/
Removing en/reference/arithgroup/static/
Removing en/reference/arithgroup/templates/
Removing en/reference/calculus/static/
Removing en/reference/calculus/templates/
Removing en/reference/categories/static/
Removing en/reference/categories/templates/
Removing en/reference/coding/static/
Removing en/reference/coding/templates/
Removing en/reference/coercion/static/
Removing en/reference/coercion/templates/
Removing en/reference/combinat/static/
Removing en/reference/combinat/templates/
Removing en/reference/constants/static/
Removing en/reference/constants/templates/
Removing en/reference/cryptography/static/
Removing en/reference/cryptography/templates/
Removing en/reference/databases/static/
Removing en/reference/databases/templates/
Removing en/reference/dev/static/
Removing en/reference/dev/templates/
Removing en/reference/doctest/static/
Removing en/reference/doctest/templates/
Removing en/reference/dynamics/static/
Removing en/reference/dynamics/templates/
Removing en/reference/finance/static/
Removing en/reference/finance/templates/
Removing en/reference/finite_rings/static/
Removing en/reference/finite_rings/templates/
Removing en/reference/function_fields/static/
Removing en/reference/function_fields/templates/
Removing en/reference/functions/static/
Removing en/reference/functions/templates/
Removing en/reference/games/static/
Removing en/reference/games/templates/
Removing en/reference/geometry/static/
Removing en/reference/geometry/templates/
Removing en/reference/graphs/static/
Removing en/reference/graphs/templates/
Removing en/reference/groups/static/
Removing en/reference/groups/templates/
Removing en/reference/hecke/static/
Removing en/reference/hecke/templates/
Removing en/reference/history_and_license/static/
Removing en/reference/history_and_license/templates/
Removing en/reference/homology/static/
Removing en/reference/homology/templates/
Removing en/reference/interfaces/static/
Removing en/reference/interfaces/templates/
Removing en/reference/lfunctions/static/
Removing en/reference/lfunctions/templates/
Removing en/reference/libs/static/
Removing en/reference/libs/templates/
Removing en/reference/logic/static/
Removing en/reference/logic/templates/
Removing en/reference/matrices/static/
Removing en/reference/matrices/templates/
Removing en/reference/matroids/static/
Removing en/reference/matroids/templates/
Removing en/reference/misc/static/
Removing en/reference/misc/templates/
Removing en/reference/modabvar/static/
Removing en/reference/modabvar/templates/
Removing en/reference/modfrm/static/
Removing en/reference/modfrm/templates/
Removing en/reference/modmisc/static/
Removing en/reference/modmisc/templates/
Removing en/reference/modsym/static/
Removing en/reference/modsym/templates/
Removing en/reference/modules/static/
Removing en/reference/modules/templates/
Removing en/reference/monoids/static/
Removing en/reference/monoids/templates/
Removing en/reference/notebook/static/
Removing en/reference/notebook/templates/
Removing en/reference/number_fields/static/
Removing en/reference/number_fields/templates/
Removing en/reference/numerical/static/
Removing en/reference/numerical/templates/
Removing en/reference/padics/static/
Removing en/reference/padics/templates/
Removing en/reference/parallel/static/
Removing en/reference/parallel/templates/
Removing en/reference/plane_curves/static/
Removing en/reference/plane_curves/templates/
Removing en/reference/plot3d/static/
Removing en/reference/plot3d/templates/
Removing en/reference/plotting/static/
Removing en/reference/plotting/templates/
Removing en/reference/polynomial_rings/static/
Removing en/reference/polynomial_rings/templates/
Removing en/reference/power_series/static/
Removing en/reference/power_series/templates/
Removing en/reference/probability/static/
Removing en/reference/probability/templates/
Removing en/reference/quadratic_forms/static/
Removing en/reference/quadratic_forms/templates/
Removing en/reference/quat_algebras/static/
Removing en/reference/quat_algebras/templates/
Removing en/reference/quivers/static/
Removing en/reference/quivers/templates/
Removing en/reference/repl/static/
Removing en/reference/repl/templates/
Removing en/reference/riemannian_geometry/static/
Removing en/reference/riemannian_geometry/templates/
Removing en/reference/rings/static/
Removing en/reference/rings/templates/
Removing en/reference/rings_numerical/static/
Removing en/reference/rings_numerical/templates/
Removing en/reference/rings_standard/static/
Removing en/reference/rings_standard/templates/
Removing en/reference/sat/static/
Removing en/reference/sat/templates/
Removing en/reference/schemes/static/
Removing en/reference/schemes/templates/
Removing en/reference/semirings/static/
Removing en/reference/semirings/templates/
Removing en/reference/static/
Removing en/reference/stats/static/
Removing en/reference/stats/templates/
Removing en/reference/structure/static/
Removing en/reference/structure/templates/
Removing en/reference/templates/
Removing en/reference/tensor/static/
Removing en/reference/tensor/templates/
Removing en/thematic_tutorials/static/
Removing en/thematic_tutorials/templates/
Removing en/tutorial/static/
Removing en/tutorial/templates/
Removing fr/a_tour_of_sage/static/
Removing fr/a_tour_of_sage/templates/
Removing fr/tutorial/static/
Removing fr/tutorial/templates/
Removing pt/a_tour_of_sage/static/
Removing pt/a_tour_of_sage/templates/
Removing ru/tutorial/static/
Removing ru/tutorial/templates/
Removing tr/a_tour_of_sage/static/
Removing tr/a_tour_of_sage/templates/
```
?

> [...] I'm not sure how else we'd get anything that git would need to clean up.


I mean removing those (empty?) folders might not be necessary (I don't know), but certainly the `git clean` there isn't a nop.



---

archive/issue_comments_208908.json:
```json
{
    "body": "We could of course add `find . -name static -o -name templates -exec rm -rf {} \\;` (above the `[-]git clean ...`), but should we?",
    "created_at": "2014-06-01T17:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208908",
    "user": "https://github.com/nexttime"
}
```

We could of course add `find . -name static -o -name templates -exec rm -rf {} \;` (above the `[-]git clean ...`), but should we?



---

archive/issue_comments_208909.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2014-06-01T17:51:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208909",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_208910.json:
```json
{
    "body": "We certainly don't want to delete `common/themes/sage/static`, for example. But maybe \n\n```\nrm -rf common/static\nrm -rf en/*/static\nrm -rf en/*/templates\nrm -rf en/reference/*/static\nrm -rf en/reference/*/templates\n```\n?\n\nIn any case, it looks like these are empty directories, so I don't think their presence should break docbuilding.",
    "created_at": "2014-06-01T18:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208910",
    "user": "https://github.com/jhpalmieri"
}
```

We certainly don't want to delete `common/themes/sage/static`, for example. But maybe 

```
rm -rf common/static
rm -rf en/*/static
rm -rf en/*/templates
rm -rf en/reference/*/static
rm -rf en/reference/*/templates
```
?

In any case, it looks like these are empty directories, so I don't think their presence should break docbuilding.



---

archive/issue_comments_208911.json:
```json
{
    "body": "Git does not try to remove empty directories when changing branches, but sphinx is sensitive to empty directories and they will break docbuilds.\n\nThere are various ways to clean up empty directories, but imho there is no portable and readable way in a shell script.",
    "created_at": "2014-06-01T18:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208911",
    "user": "https://github.com/vbraun"
}
```

Git does not try to remove empty directories when changing branches, but sphinx is sensitive to empty directories and they will break docbuilds.

There are various ways to clean up empty directories, but imho there is no portable and readable way in a shell script.



---

archive/issue_comments_208912.json:
```json
{
    "body": "Replying to [comment:17 vbraun]:\n> There are various ways to clean up empty directories, but imho there is no portable and readable way in a shell script. \n\n\nDepends on what you consider \"readable\", which IMHO isn't *that* relevant here either.\n\nWe can use `rmdir` (which *is* portable) and just (silently) ignore errors on non-empty directories.",
    "created_at": "2014-06-01T19:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208912",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:17 vbraun]:
> There are various ways to clean up empty directories, but imho there is no portable and readable way in a shell script. 


Depends on what you consider "readable", which IMHO isn't *that* relevant here either.

We can use `rmdir` (which *is* portable) and just (silently) ignore errors on non-empty directories.



---

archive/issue_comments_208913.json:
```json
{
    "body": "Replying to [comment:16 jhpalmieri]:\n> We certainly don't want to delete `common/themes/sage/static`, for example.\n\n\nWe could `-prune` that, or one of its parent directories.",
    "created_at": "2014-06-01T19:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208913",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:16 jhpalmieri]:
> We certainly don't want to delete `common/themes/sage/static`, for example.


We could `-prune` that, or one of its parent directories.



---

archive/issue_comments_208914.json:
```json
{
    "body": "Replying to [comment:17 vbraun]:\n> Git does not try to remove empty directories when changing branches, but sphinx is sensitive to empty directories and they will break docbuilds.\n\n\nDo you mean we should in addition have a \"light\" version of `make doc-clean` (only removing empty folders) to be run after switching branches for those who don't want to run `make doc-clean` each time but want to be on the \"safe side\" w.r.t. doc(re)building?\n\nIMHO probably rather Sphinx should get fixed if that's a/the problem.",
    "created_at": "2014-06-01T19:25:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208914",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:17 vbraun]:
> Git does not try to remove empty directories when changing branches, but sphinx is sensitive to empty directories and they will break docbuilds.


Do you mean we should in addition have a "light" version of `make doc-clean` (only removing empty folders) to be run after switching branches for those who don't want to run `make doc-clean` each time but want to be on the "safe side" w.r.t. doc(re)building?

IMHO probably rather Sphinx should get fixed if that's a/the problem.



---

archive/issue_comments_208915.json:
```json
{
    "body": "We could erase empty directories in `custom-sphinx-build.py`...",
    "created_at": "2014-06-01T19:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208915",
    "user": "https://github.com/vbraun"
}
```

We could erase empty directories in `custom-sphinx-build.py`...



---

archive/issue_comments_208916.json:
```json
{
    "body": "Replying to [comment:21 vbraun]:\n> We could erase empty directories in `custom-sphinx-build.py`...\n\n\nIf that solves potential problems, certainly the RTTD.\n\nOr is it a general Sphinx (upstream) problem?",
    "created_at": "2014-06-01T19:39:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208916",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:21 vbraun]:
> We could erase empty directories in `custom-sphinx-build.py`...


If that solves potential problems, certainly the RTTD.

Or is it a general Sphinx (upstream) problem?



---

archive/issue_comments_208917.json:
```json
{
    "body": "I think using `rmdir` makes things pretty readable. I personally hate the `find` command, but if other people can get it to work in a portable way, I wouldn't object to using that instead.\n\nHave you seen an empty `static` or `templates` directory breaking docbuilding? I understand that creating `reference/foo` might break it, because our docbuild system will then try to build a `foo` document, but I wasn't aware of any problems with these Sphinx-created directories.\n\nI think we should have some `rmdir` commands and also the current `git clean` command, all ignoring errors. `make distclean` will be the last resort if these don't fix the problem for someone. (After trying `./sage -f git` and `make doc-clean`.)",
    "created_at": "2014-06-01T20:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208917",
    "user": "https://github.com/jhpalmieri"
}
```

I think using `rmdir` makes things pretty readable. I personally hate the `find` command, but if other people can get it to work in a portable way, I wouldn't object to using that instead.

Have you seen an empty `static` or `templates` directory breaking docbuilding? I understand that creating `reference/foo` might break it, because our docbuild system will then try to build a `foo` document, but I wasn't aware of any problems with these Sphinx-created directories.

I think we should have some `rmdir` commands and also the current `git clean` command, all ignoring errors. `make distclean` will be the last resort if these don't fix the problem for someone. (After trying `./sage -f git` and `make doc-clean`.)



---

archive/issue_comments_208918.json:
```json
{
    "body": "I'm thinking of this:\n\n```diff\ndiff --git a/src/doc/Makefile b/src/doc/Makefile\nindex a4a15b3..e0f9f99 100644\n--- a/src/doc/Makefile\n+++ b/src/doc/Makefile\n@@ -8,5 +8,9 @@ clean:\n        rm -rf en/reference/sage\n        rm -rf en/reference/sagenb\n        rm -rf output\n-       git clean -f -d .\n-\n+       -rmdir common/static 2>/dev/null\n+       -rmdir en/reference/*/static 2>/dev/null\n+       -rmdir en/reference/*/templates 2>/dev/null\n+       -rmdir [a-z][a-z]/*/static 2>/dev/null\n+       -rmdir [a-z][a-z]/*/templates 2>/dev/null\n+       -git clean -f -d .\n```\nComments? Should I create a branch?",
    "created_at": "2014-06-01T22:56:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208918",
    "user": "https://github.com/jhpalmieri"
}
```

I'm thinking of this:

```diff
diff --git a/src/doc/Makefile b/src/doc/Makefile
index a4a15b3..e0f9f99 100644
--- a/src/doc/Makefile
+++ b/src/doc/Makefile
@@ -8,5 +8,9 @@ clean:
        rm -rf en/reference/sage
        rm -rf en/reference/sagenb
        rm -rf output
-       git clean -f -d .
-
+       -rmdir common/static 2>/dev/null
+       -rmdir en/reference/*/static 2>/dev/null
+       -rmdir en/reference/*/templates 2>/dev/null
+       -rmdir [a-z][a-z]/*/static 2>/dev/null
+       -rmdir [a-z][a-z]/*/templates 2>/dev/null
+       -git clean -f -d .
```
Comments? Should I create a branch?



---

archive/issue_comments_208919.json:
```json
{
    "body": "Replying to [comment:24 jhpalmieri]:\n> I'm thinking of this:\n> \n> ```\n> #!diff\n> diff --git a/src/doc/Makefile b/src/doc/Makefile\n> index a4a15b3..e0f9f99 100644\n> --- a/src/doc/Makefile\n> +++ b/src/doc/Makefile\n> @@ -8,5 +8,9 @@ clean:\n>         rm -rf en/reference/sage\n>         rm -rf en/reference/sagenb\n>         rm -rf output\n> -       git clean -f -d .\n> -\n> +       -rmdir common/static 2>/dev/null\n> +       -rmdir en/reference/*/static 2>/dev/null\n> +       -rmdir en/reference/*/templates 2>/dev/null\n> +       -rmdir [a-z][a-z]/*/static 2>/dev/null\n> +       -rmdir [a-z][a-z]/*/templates 2>/dev/null\n> +       -git clean -f -d .\n> ```\n> Comments? Should I create a branch?\n\n\nI'd be ok with that, although I can't tell whether that'll be sufficient (regarding potential docbuilding brokenness).\n\nAnd I think doing some consistency checks / removing stuff that may disturb Sphinx could really be done *before docbuilding* (i.e., in some of our builder scripts, as Volker suggested).  Maybe in addition, and on another ticket.  (As mentioned on sage-devel, I think there is currently more broken with Sphinx, e.g. `sage --docbuild reference html` apparently does no longer work.)",
    "created_at": "2014-06-01T23:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208919",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:24 jhpalmieri]:
> I'm thinking of this:
> 
> ```
> #!diff
> diff --git a/src/doc/Makefile b/src/doc/Makefile
> index a4a15b3..e0f9f99 100644
> --- a/src/doc/Makefile
> +++ b/src/doc/Makefile
> @@ -8,5 +8,9 @@ clean:
>         rm -rf en/reference/sage
>         rm -rf en/reference/sagenb
>         rm -rf output
> -       git clean -f -d .
> -
> +       -rmdir common/static 2>/dev/null
> +       -rmdir en/reference/*/static 2>/dev/null
> +       -rmdir en/reference/*/templates 2>/dev/null
> +       -rmdir [a-z][a-z]/*/static 2>/dev/null
> +       -rmdir [a-z][a-z]/*/templates 2>/dev/null
> +       -git clean -f -d .
> ```
> Comments? Should I create a branch?


I'd be ok with that, although I can't tell whether that'll be sufficient (regarding potential docbuilding brokenness).

And I think doing some consistency checks / removing stuff that may disturb Sphinx could really be done *before docbuilding* (i.e., in some of our builder scripts, as Volker suggested).  Maybe in addition, and on another ticket.  (As mentioned on sage-devel, I think there is currently more broken with Sphinx, e.g. `sage --docbuild reference html` apparently does no longer work.)



---

archive/issue_comments_208920.json:
```json
{
    "body": "`sage --docbuild reference html` is the second stage of the reference manual docbuild and works as long as you have a pre-built intersphinx inventory. If you don't you need to run the first stage, that is, `sage --docbuild reference inventory`, before that. If you think that is too complicated then you should stick to `make doc`.",
    "created_at": "2014-06-02T12:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208920",
    "user": "https://github.com/vbraun"
}
```

`sage --docbuild reference html` is the second stage of the reference manual docbuild and works as long as you have a pre-built intersphinx inventory. If you don't you need to run the first stage, that is, `sage --docbuild reference inventory`, before that. If you think that is too complicated then you should stick to `make doc`.



---

archive/issue_comments_208921.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-06-02T12:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208921",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_208922.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-06-02T12:21:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208922",
    "user": "https://github.com/vbraun"
}
```

New commits:



---

archive/issue_comments_208923.json:
```json
{
    "body": "Replying to [comment:29 vbraun]:\n> New commits:\n> |                                                                                                                                          |                                        |\n> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n> |[2118554](http://git.sagemath.org/sage.git/commit/?id=2118554d2c99f30350e7867aebe126da6fbb7236)|`use Python to delete empty directories`|\n\n\nNot sure whether modifying `builder.py` really belongs to this ticket (as already mentioned).\n\nIn any case, deleting folders should IMHO be done *after* option parsing.",
    "created_at": "2014-06-02T13:56:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208923",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:29 vbraun]:
> New commits:
> |                                                                                                                                          |                                        |
> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
> |[2118554](http://git.sagemath.org/sage.git/commit/?id=2118554d2c99f30350e7867aebe126da6fbb7236)|`use Python to delete empty directories`|


Not sure whether modifying `builder.py` really belongs to this ticket (as already mentioned).

In any case, deleting folders should IMHO be done *after* option parsing.



---

archive/issue_comments_208924.json:
```json
{
    "body": "(And I'd rather go with John's suggestion, as `make doc-clean` is supposed to clean up, *plus* perhaps the deletion in `builder.py` as well, although probably more could be done / checked there.)",
    "created_at": "2014-06-02T14:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208924",
    "user": "https://github.com/nexttime"
}
```

(And I'd rather go with John's suggestion, as `make doc-clean` is supposed to clean up, *plus* perhaps the deletion in `builder.py` as well, although probably more could be done / checked there.)



---

archive/issue_comments_208925.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-02T14:01:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208925",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_208926.json:
```json
{
    "body": "Replying to [comment:27 vbraun]:\n> `sage --docbuild reference html` is the second stage of the reference manual docbuild and works as long as you have a pre-built intersphinx inventory. If you don't you need to run the first stage, that is, `sage --docbuild reference inventory`, before that.\n\n\nIIRC that didn't always work either, but anyway, it's not documented (at least not where it should be), but instead odd errors are raised in case one hasn't (re)built the inventory prior to trying to build the reference manual.\n\n---\nNew commits:",
    "created_at": "2014-06-02T14:05:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208926",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:27 vbraun]:
> `sage --docbuild reference html` is the second stage of the reference manual docbuild and works as long as you have a pre-built intersphinx inventory. If you don't you need to run the first stage, that is, `sage --docbuild reference inventory`, before that.


IIRC that didn't always work either, but anyway, it's not documented (at least not where it should be), but instead odd errors are raised in case one hasn't (re)built the inventory prior to trying to build the reference manual.

---
New commits:



---

archive/issue_comments_208927.json:
```json
{
    "body": "Dear trac, I didn't make a new commit...\n\nBesides that, it's ok.  I still would do more in the `make` receipt.",
    "created_at": "2014-06-02T14:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208927",
    "user": "https://github.com/nexttime"
}
```

Dear trac, I didn't make a new commit...

Besides that, it's ok.  I still would do more in the `make` receipt.



---

archive/issue_comments_208928.json:
```json
{
    "body": "IMHO at least the `sage --docbuild reference html` error is spot-on, is says that it can't load the inventory.\n\nWith my patch there is no need to clean up empty directories from the `doc-clean` target, nor do we do that for any other `*-clean` target.",
    "created_at": "2014-06-02T14:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208928",
    "user": "https://github.com/vbraun"
}
```

IMHO at least the `sage --docbuild reference html` error is spot-on, is says that it can't load the inventory.

With my patch there is no need to clean up empty directories from the `doc-clean` target, nor do we do that for any other `*-clean` target.



---

archive/issue_comments_208929.json:
```json
{
    "body": "Replying to [comment:35 vbraun]:\n> With my patch there is no need to clean up empty directories from the `doc-clean` target, nor do we do that for any other `*-clean` target. \n\n\nWell, the difference is *when* a clean-up is made.\n\nI'd expect `make doc-clean` to clean up docs (and doc-related folders).  Just like I expect `make distclean` to clean up immediately, not upon the next attempt to build Sage.\n\nI don't care if it's partially redundant to call `make doc-clean` before actually (re)building docs; it's just triple-safe and shouldn't be too expensive.",
    "created_at": "2014-06-02T14:24:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208929",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:35 vbraun]:
> With my patch there is no need to clean up empty directories from the `doc-clean` target, nor do we do that for any other `*-clean` target. 


Well, the difference is *when* a clean-up is made.

I'd expect `make doc-clean` to clean up docs (and doc-related folders).  Just like I expect `make distclean` to clean up immediately, not upon the next attempt to build Sage.

I don't care if it's partially redundant to call `make doc-clean` before actually (re)building docs; it's just triple-safe and shouldn't be too expensive.



---

archive/issue_comments_208930.json:
```json
{
    "body": "The real issue is that the docs should be built under `SAGE_LOCAL`. \n\nTriple-safe is bullshit, do it once right.",
    "created_at": "2014-06-02T15:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208930",
    "user": "https://github.com/vbraun"
}
```

The real issue is that the docs should be built under `SAGE_LOCAL`. 

Triple-safe is bullshit, do it once right.



---

archive/issue_comments_208931.json:
```json
{
    "body": "Replying to [comment:37 vbraun]:\n> The real issue is that the docs should be built under `SAGE_LOCAL`.\n\n\nWell, then go ahead.  But on a follow-up I'd say.",
    "created_at": "2014-06-02T16:05:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208931",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:37 vbraun]:
> The real issue is that the docs should be built under `SAGE_LOCAL`.


Well, then go ahead.  But on a follow-up I'd say.



---

archive/issue_comments_208932.json:
```json
{
    "body": "P.S.:  John should be up soon; waiting for his opinion... (and of course those of any others)",
    "created_at": "2014-06-02T16:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208932",
    "user": "https://github.com/nexttime"
}
```

P.S.:  John should be up soon; waiting for his opinion... (and of course those of any others)



---

archive/issue_comments_208933.json:
```json
{
    "body": "I've been up for a while, actually. I tried (not very hard) to build the docs in `SAGE_LOCAL` but ran into problems. Is the issue moving just the output directory there, or also the other temporary directories (like `static` and `templates`) into `SAGE_LOCAL`?\n\nAnyway, I think the proposed change is fine, although I would also include `-git clean -f -d .` in the `Makefile` recipe.",
    "created_at": "2014-06-02T18:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208933",
    "user": "https://github.com/jhpalmieri"
}
```

I've been up for a while, actually. I tried (not very hard) to build the docs in `SAGE_LOCAL` but ran into problems. Is the issue moving just the output directory there, or also the other temporary directories (like `static` and `templates`) into `SAGE_LOCAL`?

Anyway, I think the proposed change is fine, although I would also include `-git clean -f -d .` in the `Makefile` recipe.



---

archive/issue_comments_208934.json:
```json
{
    "body": "I'm against independent code paths that depend on whether or not there is a system-wide git installed. That'll just be unnecessarily difficult to debug if it breaks. Do it once, and do it right.",
    "created_at": "2014-06-02T18:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208934",
    "user": "https://github.com/vbraun"
}
```

I'm against independent code paths that depend on whether or not there is a system-wide git installed. That'll just be unnecessarily difficult to debug if it breaks. Do it once, and do it right.



---

archive/issue_comments_208935.json:
```json
{
    "body": "Replying to [comment:40 jhpalmieri]:\n> I tried (not very hard) to build the docs in `SAGE_LOCAL` but ran into problems. Is the issue moving just the output directory there, or also the other temporary directories (like `static` and `templates`) into `SAGE_LOCAL`?\n\n\nWell, ideally `src/` should be read-only w.r.t. building/testing/running Sage, including docbuilding.  But that's certainly beyond the scope of this ticket.",
    "created_at": "2014-06-02T18:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208935",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:40 jhpalmieri]:
> I tried (not very hard) to build the docs in `SAGE_LOCAL` but ran into problems. Is the issue moving just the output directory there, or also the other temporary directories (like `static` and `templates`) into `SAGE_LOCAL`?


Well, ideally `src/` should be read-only w.r.t. building/testing/running Sage, including docbuilding.  But that's certainly beyond the scope of this ticket.



---

archive/issue_comments_208936.json:
```json
{
    "body": "There was a conflicting idea to build the Sage library in place, rather than copy it to `local/lib/python/site-package/sage`. I forget which ticket that is, but in any case, I'm not sure everyone agrees that \"ideally `src/` should be read-only ...\"",
    "created_at": "2014-06-02T18:43:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208936",
    "user": "https://github.com/jhpalmieri"
}
```

There was a conflicting idea to build the Sage library in place, rather than copy it to `local/lib/python/site-package/sage`. I forget which ticket that is, but in any case, I'm not sure everyone agrees that "ideally `src/` should be read-only ..."



---

archive/issue_comments_208937.json:
```json
{
    "body": "Any news on reviewing this ticket?",
    "created_at": "2014-06-18T12:56:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208937",
    "user": "https://github.com/vbraun"
}
```

Any news on reviewing this ticket?



---

archive/issue_comments_208938.json:
```json
{
    "body": "Replying to [comment:44 vbraun]:\n> Any news on reviewing this ticket?\n\n\nFor me everything worked again with this branch applied! So I am happy to give a positive review. But some of the other reviewers might have technical comments!\n\nAnne",
    "created_at": "2014-06-18T15:17:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208938",
    "user": "https://github.com/anneschilling"
}
```

Replying to [comment:44 vbraun]:
> Any news on reviewing this ticket?


For me everything worked again with this branch applied! So I am happy to give a positive review. But some of the other reviewers might have technical comments!

Anne



---

archive/issue_comments_208939.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-18T18:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208939",
    "user": "https://github.com/nexttime"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_208940.json:
```json
{
    "body": "Well, as John P., I would have left the `git clean`, ignoring errors, but I don't care much.\n\nBetter than no fix....",
    "created_at": "2014-06-18T18:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208940",
    "user": "https://github.com/nexttime"
}
```

Well, as John P., I would have left the `git clean`, ignoring errors, but I don't care much.

Better than no fix....



---

archive/issue_comments_208941.json:
```json
{
    "body": "P.S.:  And Volker now has the necessary pence to work on a follow-up ticket for building the docs below `$SAGE_LOCAL/`...  Gl\u00fcckwunsch auch von mir!",
    "created_at": "2014-06-18T18:22:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208941",
    "user": "https://github.com/nexttime"
}
```

P.S.:  And Volker now has the necessary pence to work on a follow-up ticket for building the docs below `$SAGE_LOCAL/`...  Glückwunsch auch von mir!



---

archive/issue_comments_208942.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-19T13:12:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16066#issuecomment-208942",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048055.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-19T13:12:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16066",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16066#event-48055"
}
```
