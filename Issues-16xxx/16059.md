# Issue 16059: Equality vs hash for braid groups

archive/issues_015822.json:
```json
{
    "body": "Playing with braid groups for a demo today, i want to see its Cayley graph in a neighbourhood of the neutral element:\n\n```\n\nball = set()\nball.add(B.one())\nfor length in range(1,4):\n    for w in Words(alphabet=B.gens(), length=length):\n        ball.add(prod(w))\nG = B.cayley_graph(elements=ball, generators=B.gens())\nG.plot()\n\n```\n\n![](Cayley_before.png)\n\nHmmm, it looks locally like the free group, as if there was no relation !\n\n`s0 * s2` is a different vertex as `s2 * s0`, while:\n\n```\nsage: s0 * s2 == s2 * s0\nTrue\n```\n\nIndeed:\n\n```\nsage: hash(s0 * s2)\n954209079\nsage: hash(s2 * s0)\n1883627875\n```\n\nThere should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `cayley_graph` answers something wrong !\n\nAfter the modification, the Cayley group looks like:\n\n![](Cayley_after.png)\n\n\nKeywords: braid group, hash, Cayley graph\n\nBranch/Commit: a5fce2a1fbb4790b581d23ef2ec0841f05f14f67\n\nReviewer: Travis Scrimshaw\n\nAuthor: Thierry Monteil\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16059\n\n",
    "closed_at": "2014-05-21T15:33:33Z",
    "created_at": "2014-04-04T11:44:01Z",
    "labels": [
        "component: group theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Equality vs hash for braid groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16059",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```
Playing with braid groups for a demo today, i want to see its Cayley graph in a neighbourhood of the neutral element:

```

ball = set()
ball.add(B.one())
for length in range(1,4):
    for w in Words(alphabet=B.gens(), length=length):
        ball.add(prod(w))
G = B.cayley_graph(elements=ball, generators=B.gens())
G.plot()

```

![](Cayley_before.png)

Hmmm, it looks locally like the free group, as if there was no relation !

`s0 * s2` is a different vertex as `s2 * s0`, while:

```
sage: s0 * s2 == s2 * s0
True
```

Indeed:

```
sage: hash(s0 * s2)
954209079
sage: hash(s2 * s0)
1883627875
```

There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `cayley_graph` answers something wrong !

After the modification, the Cayley group looks like:

![](Cayley_after.png)


Keywords: braid group, hash, Cayley graph

Branch/Commit: a5fce2a1fbb4790b581d23ef2ec0841f05f14f67

Reviewer: Travis Scrimshaw

Author: Thierry Monteil

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16059





---

archive/issue_comments_218778.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Playing with braid groups for a demo today, i want to see its Caylay graph in a neighbourhood of the neutral element:\n+Playing with braid groups for a demo today, i want to see its Cayley graph in a neighbourhood of the neutral element:\n \n ```\n \n@@ -30,9 +30,8 @@\n 1883627875\n ```\n \n-There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `caylay_graph` answers something wrong !\n+There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `cayley_graph` answers something wrong !\n \n-Keywords: braid group, hash, Caylay graph\n \n Comment: 1\n \n```\n",
    "created_at": "2014-04-07T19:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218778",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Playing with braid groups for a demo today, i want to see its Caylay graph in a neighbourhood of the neutral element:
+Playing with braid groups for a demo today, i want to see its Cayley graph in a neighbourhood of the neutral element:
 
 ```
 
@@ -30,9 +30,8 @@
 1883627875
 ```
 
-There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `caylay_graph` answers something wrong !
+There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `cayley_graph` answers something wrong !
 
-Keywords: braid group, hash, Caylay graph
 
 Comment: 1
 
```




---

archive/issue_comments_218779.json:
```json
{
    "body": "Changing keywords from \"braid group, hash, Caylay graph\" to \"braid group, hash, Cayley graph\".",
    "created_at": "2014-04-07T19:48:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218779",
    "user": "https://github.com/fchapoton"
}
```

Changing keywords from "braid group, hash, Caylay graph" to "braid group, hash, Cayley graph".



---

archive/issue_comments_218780.json:
```json
{
    "body": "Attachment [Cayley_before.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_before.png) by tmonteil created at 2014-04-14 13:53:17",
    "created_at": "2014-04-14T13:53:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218780",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Attachment [Cayley_before.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_before.png) by tmonteil created at 2014-04-14 13:53:17



---

archive/issue_comments_218781.json:
```json
{
    "body": "<a id='comment:3'></a>Attachment [Cayley_after.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_after.png) by tmonteil created at 2014-04-14 13:57:01",
    "created_at": "2014-04-14T13:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218781",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:3'></a>Attachment [Cayley_after.png](tarball://root/attachments/some-uuid/ticket16059/Cayley_after.png) by tmonteil created at 2014-04-14 13:57:01



---

archive/issue_comments_218782.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-14T13:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218782",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_218783.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,42 @@\n+Playing with braid groups for a demo today, i want to see its Cayley graph in a neighbourhood of the neutral element:\n+\n+```\n+\n+ball = set()\n+ball.add(B.one())\n+for length in range(1,4):\n+    for w in Words(alphabet=B.gens(), length=length):\n+        ball.add(prod(w))\n+G = B.cayley_graph(elements=ball, generators=B.gens())\n+G.plot()\n+\n+```\n+\n+![](Cayley_before.png)\n+\n+Hmmm, it looks locally like the free group, as if there was no relation !\n+\n+`s0 * s2` is a different vertex as `s2 * s0`, while:\n+\n+```\n+sage: s0 * s2 == s2 * s0\n+True\n+```\n+\n+Indeed:\n+\n+```\n+sage: hash(s0 * s2)\n+954209079\n+sage: hash(s2 * s0)\n+1883627875\n+```\n+\n+There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `cayley_graph` answers something wrong !\n+\n+After the modification, the Cayley group looks like:\n+\n+![](Cayley_after.png)\n \n \n Comment: 1\n```\n",
    "created_at": "2014-04-14T13:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218783",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,42 @@
+Playing with braid groups for a demo today, i want to see its Cayley graph in a neighbourhood of the neutral element:
+
+```
+
+ball = set()
+ball.add(B.one())
+for length in range(1,4):
+    for w in Words(alphabet=B.gens(), length=length):
+        ball.add(prod(w))
+G = B.cayley_graph(elements=ball, generators=B.gens())
+G.plot()
+
+```
+
+![](Cayley_before.png)
+
+Hmmm, it looks locally like the free group, as if there was no relation !
+
+`s0 * s2` is a different vertex as `s2 * s0`, while:
+
+```
+sage: s0 * s2 == s2 * s0
+True
+```
+
+Indeed:
+
+```
+sage: hash(s0 * s2)
+954209079
+sage: hash(s2 * s0)
+1883627875
+```
+
+There should be a canonical representation for elements in Braid groups. At least, two equal elements should have the same hash. Currently, `cayley_graph` answers something wrong !
+
+After the modification, the Cayley group looks like:
+
+![](Cayley_after.png)
 
 
 Comment: 1
```




---

archive/issue_comments_218784.json:
```json
{
    "body": "<a id='comment:5'></a>Could you add an `is_isomorphic()` check to the Cayley graph of the corresponding free group (or some other way of showing it's not the Cayley graph of the free group)? Once that is done, you can set a positive review on my behalf.",
    "created_at": "2014-04-14T14:52:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218784",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>Could you add an `is_isomorphic()` check to the Cayley graph of the corresponding free group (or some other way of showing it's not the Cayley graph of the free group)? Once that is done, you can set a positive review on my behalf.



---

archive/issue_comments_218785.json:
```json
{
    "body": "<a id='comment:6'></a>Actually, there is already an indirect check when `G` answers `Digraph on 31 vertices` (to be compared to `Digraph on 40 vertices` for the free group, some vertices are merged). Is it enough ?\n\nOtherwise, i do not know a short way to represent directed graphs in Sage, but i could add a test for the undirected version of the graph using `sparse6_string` representation along the following lines just after the previous example, though i am not sure it is easy to read:\n\n```\nsage: graph_string = ':^_`aa`ddd`aHhh_lmmmfLqqlStt_HjWxxvW{{'\nsage: G.to_undirected().is_isomorphic(Graph(graph_string))\nTrue\n```\n\nWhat do you think ?",
    "created_at": "2014-04-14T18:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218785",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:6'></a>Actually, there is already an indirect check when `G` answers `Digraph on 31 vertices` (to be compared to `Digraph on 40 vertices` for the free group, some vertices are merged). Is it enough ?

Otherwise, i do not know a short way to represent directed graphs in Sage, but i could add a test for the undirected version of the graph using `sparse6_string` representation along the following lines just after the previous example, though i am not sure it is easy to read:

```
sage: graph_string = ':^_`aa`ddd`aHhh_lmmmfLqqlStt_HjWxxvW{{'
sage: G.to_undirected().is_isomorphic(Graph(graph_string))
True
```

What do you think ?



---

archive/issue_events_047213.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16059#event-47213"
}
```



---

archive/issue_comments_218786.json:
```json
{
    "body": "<a id='comment:8'></a>\n```\nsage -t --long src/sage/groups/braid.py  # 1 doctest failed\n```",
    "created_at": "2014-05-10T07:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218786",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>
```
sage -t --long src/sage/groups/braid.py  # 1 doctest failed
```



---

archive/issue_comments_218787.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-10T07:44:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218787",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_218788.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-11T15:06:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_218789.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-17T17:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218789",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_218790.json:
```json
{
    "body": "<a id='comment:10'></a>Sorry for letting this slip away. I've added an extra doctest which makes the fix more explicit (at least to those of us who don't know how big the a 4 ball of a free group is `:p`). If you're happy with this, then positive review.\n\n---\nNew commits:",
    "created_at": "2014-05-17T17:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218790",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:10'></a>Sorry for letting this slip away. I've added an extra doctest which makes the fix more explicit (at least to those of us who don't know how big the a 4 ball of a free group is `:p`). If you're happy with this, then positive review.

---
New commits:



---

archive/issue_comments_218791.json:
```json
{
    "body": "<a id='comment:12'></a>`@`tscrim : now i get your point. I have merged the two Cayley graph doctests in a single one to avoid repetitions, with a sentence to explain the difference with the free group.\n\n`@`chapoton : i removed the direct hash test whose output depends on the architecture.",
    "created_at": "2014-05-19T22:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218791",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

<a id='comment:12'></a>`@`tscrim : now i get your point. I have merged the two Cayley graph doctests in a single one to avoid repetitions, with a sentence to explain the difference with the free group.

`@`chapoton : i removed the direct hash test whose output depends on the architecture.



---

archive/issue_comments_218792.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-21T04:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218792",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_218793.json:
```json
{
    "body": "<a id='comment:13'></a>I like this doctest better. Positive review. Thanks.",
    "created_at": "2014-05-21T04:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218793",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>I like this doctest better. Positive review. Thanks.



---

archive/issue_comments_218794.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-21T15:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16059#issuecomment-218794",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_047214.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-21T15:33:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16059",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16059#event-47214"
}
```
