# Issue 16246: Add functions calculating all spanning trees, all bridges in a graph

archive/issues_016009.json:
```json
{
    "body": "This patch adds\n\n1) a function that finds all spanning trees in a graph.\n(adapted from \"Bounds on Backtrack Algorithms for Listing Cycles, Paths, and Spanning Trees\" R. C. Read and R. E. Tarjan, 1975)\n\n2) a function that finds all bridges in a graph recursively, that is used in calculating the spanning trees\n(adapted from the solution to 4.1.36 in Sedgewick's _Algorithms_ 4th ed.)\n\nFor example:\n\n```\nsage: G = Graph([(1,2),(1,2),(1,3),(1,3),(2,3),(1,4)])\nsage: G.spanning_trees()\n[Graph on 4 vertices,\n Graph on 4 vertices,\n Graph on 4 vertices,\n Graph on 4 vertices,\n Graph on 4 vertices,\n Graph on 4 vertices,\n Graph on 4 vertices,\n Graph on 4 vertices]\nsage: len(G.spanning_trees()) == G.spanning_trees_count()\nTrue\nsage: G.bridges()\n[(1, 4, None)]\n```\nThese functions will assist in the calculation of the Jones polynomial of a knot.\n\nCC:  lipshitz @nathanncohen\n\nKeywords: bridge, spanning tree\n\nBranch/Commit: [e9f67fca64c10c5cf61df3f422c4e825e533c32f](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)\n\nReviewer: Nathann Cohen\n\nAuthor: Jennet Dickinson\n\nDependencies: #16307\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16246\n\n",
    "closed_at": "2014-05-15T17:18:24Z",
    "created_at": "2014-04-26T21:48:37Z",
    "labels": [
        "component: graph theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Add functions calculating all spanning trees, all bridges in a graph",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16246",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```
This patch adds

1) a function that finds all spanning trees in a graph.
(adapted from "Bounds on Backtrack Algorithms for Listing Cycles, Paths, and Spanning Trees" R. C. Read and R. E. Tarjan, 1975)

2) a function that finds all bridges in a graph recursively, that is used in calculating the spanning trees
(adapted from the solution to 4.1.36 in Sedgewick's _Algorithms_ 4th ed.)

For example:

```
sage: G = Graph([(1,2),(1,2),(1,3),(1,3),(2,3),(1,4)])
sage: G.spanning_trees()
[Graph on 4 vertices,
 Graph on 4 vertices,
 Graph on 4 vertices,
 Graph on 4 vertices,
 Graph on 4 vertices,
 Graph on 4 vertices,
 Graph on 4 vertices,
 Graph on 4 vertices]
sage: len(G.spanning_trees()) == G.spanning_trees_count()
True
sage: G.bridges()
[(1, 4, None)]
```
These functions will assist in the calculation of the Jones polynomial of a knot.

CC:  lipshitz @nathanncohen

Keywords: bridge, spanning tree

Branch/Commit: [e9f67fca64c10c5cf61df3f422c4e825e533c32f](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)

Reviewer: Nathann Cohen

Author: Jennet Dickinson

Dependencies: #16307

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16246





---

archive/issue_comments_269638.json:
```json
{
    "body": "<a id='comment:2'></a>\n(cc me)",
    "created_at": "2014-04-27T07:21:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269638",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'></a>
(cc me)



---

archive/issue_comments_269639.json:
```json
{
    "body": "Changing author from \"jdickinson\" to \"Jennet Dickinson\"",
    "created_at": "2014-04-27T12:27:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269639",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Changing author from "jdickinson" to "Jennet Dickinson"



---

archive/issue_comments_269640.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,6 +8,7 @@\n \n For example:\n \n+```\n sage: G = Graph([(1,2),(1,2),(1,3),(1,3),(2,3),(1,4)])\n sage: G.spanning_trees()\n [Graph on 4 vertices,\n@@ -22,5 +23,5 @@\n True\n sage: G.bridges()\n [(1, 4, None)]\n-\n+```\n These functions will assist in the calculation of the Jones polynomial of a knot.\n``````\n",
    "created_at": "2014-04-27T12:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269640",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,6 +8,7 @@
 
 For example:
 
+```
 sage: G = Graph([(1,2),(1,2),(1,3),(1,3),(2,3),(1,4)])
 sage: G.spanning_trees()
 [Graph on 4 vertices,
@@ -22,5 +23,5 @@
 True
 sage: G.bridges()
 [(1, 4, None)]
-
+```
 These functions will assist in the calculation of the Jones polynomial of a knot.
``````




---

archive/issue_comments_269641.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n-This patch adds \n+This patch adds\n \n-1) a function that finds all spanning trees in a graph. \n+1) a function that finds all spanning trees in a graph.\n (adapted from \"Bounds on Backtrack Algorithms for Listing Cycles, Paths, and Spanning Trees\" R. C. Read and R. E. Tarjan, 1975)\n \n 2) a function that finds all bridges in a graph recursively, that is used in calculating the spanning trees\n``````\n",
    "created_at": "2014-04-30T20:20:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269641",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
-This patch adds 
+This patch adds
 
-1) a function that finds all spanning trees in a graph. 
+1) a function that finds all spanning trees in a graph.
 (adapted from "Bounds on Backtrack Algorithms for Listing Cycles, Paths, and Spanning Trees" R. C. Read and R. E. Tarjan, 1975)
 
 2) a function that finds all bridges in a graph recursively, that is used in calculating the spanning trees
``````




---

archive/issue_comments_269642.json:
```json
{
    "body": "Branch: [u/jdickinson/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/jdickinson/ticket/16246)",
    "created_at": "2014-05-03T18:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269642",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Branch: [u/jdickinson/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/jdickinson/ticket/16246)



---

archive/issue_comments_269643.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-05T13:24:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269643",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_269644.json:
```json
{
    "body": "Commit: [ee677a9dfd6b36ed6008bcbef95950132002511b](https://github.com/sagemath/sagetrac-mirror/commit/ee677a9dfd6b36ed6008bcbef95950132002511b)",
    "created_at": "2014-05-05T13:24:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269644",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Commit: [ee677a9dfd6b36ed6008bcbef95950132002511b](https://github.com/sagemath/sagetrac-mirror/commit/ee677a9dfd6b36ed6008bcbef95950132002511b)



---

archive/issue_comments_269645.json:
```json
{
    "body": "<a id='comment:7'></a>\nNew commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[ee677a9](https://github.com/sagemath/sagetrac-mirror/commit/ee677a9dfd6b36ed6008bcbef95950132002511b)|`Add bridges and spanning trees functions for graphs`|",
    "created_at": "2014-05-05T13:24:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269645",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

<a id='comment:7'></a>
New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[ee677a9](https://github.com/sagemath/sagetrac-mirror/commit/ee677a9dfd6b36ed6008bcbef95950132002511b)|`Add bridges and spanning trees functions for graphs`|



---

archive/issue_comments_269646.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-05-05T13:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269646",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_269647.json:
```json
{
    "body": "<a id='comment:8'></a>\nHello !\n\n1) Please work on the documentation of your function. You can compare it to the other graph functions and see that they are not quite up to the standard.\n\n2) Please define your auxiliary functions INSIDE of the functions you define, and not inside of the !Graph/DiGraph class\n\n3) The file generic_graph.py applies to both graphs and digraphs. Is your code meant to handle digraphs ?\n\n4) I can write `bridges` with the following 5 lines\n\n```\ndef bridges(g):\n    r\"\"\"\n    EXAMPLES:: \n        sage: g = 2*graphs.PetersenGraph()\n        sage: g.add_edge(1,10)\n        sage: g.is_connected()\n        True\n        sage: bridges(g)\n        [(1, 10, None)]\n    \"\"\"\n    gs = g.strong_orientation()\n    bridges = []\n    for scc in gs.strongly_connected_components():\n        bridges.extend(gs.edge_boundary(scc))\n    return bridges\n```\n\nplease provide comparisons of speed with your implementation.\n\n5) Please think hard of what the following line from your code does\n\n```\n[x for x in self.edges() if x not in self.bridges()])\n```\n\nNathann",
    "created_at": "2014-05-05T13:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269647",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>
Hello !

1) Please work on the documentation of your function. You can compare it to the other graph functions and see that they are not quite up to the standard.

2) Please define your auxiliary functions INSIDE of the functions you define, and not inside of the !Graph/DiGraph class

3) The file generic_graph.py applies to both graphs and digraphs. Is your code meant to handle digraphs ?

4) I can write `bridges` with the following 5 lines

```
def bridges(g):
    r"""
    EXAMPLES:: 
        sage: g = 2*graphs.PetersenGraph()
        sage: g.add_edge(1,10)
        sage: g.is_connected()
        True
        sage: bridges(g)
        [(1, 10, None)]
    """
    gs = g.strong_orientation()
    bridges = []
    for scc in gs.strongly_connected_components():
        bridges.extend(gs.edge_boundary(scc))
    return bridges
```

please provide comparisons of speed with your implementation.

5) Please think hard of what the following line from your code does

```
[x for x in self.edges() if x not in self.bridges()])
```

Nathann



---

archive/issue_comments_269648.json:
```json
{
    "body": "<a id='comment:9'></a>\n(just updated the code above, there was an useless waste of time)",
    "created_at": "2014-05-05T14:29:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269648",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>
(just updated the code above, there was an useless waste of time)



---

archive/issue_events_054487.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16246#event-54487"
}
```



---

archive/issue_comments_269649.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|\n|[17a1a97](https://github.com/sagemath/sagetrac-mirror/commit/17a1a97a56b77ec4c0df0ac6ed0c51638f6ede96)|`Fixed bug preventing G.strong_orientation() from working on G a multigraph, added a small multigraph to doctests`|\n|[72ed2dc](https://github.com/sagemath/sagetrac-mirror/commit/72ed2dcd780f99037accfb27a0830967d22ef607)|`Merge branch 'u/jdickinson/ticket/16307' of git://trac.sagemath.org/sage into ticket/16246`|\n|[9bbee16](https://github.com/sagemath/sagetrac-mirror/commit/9bbee168e337a40d9b3a9cd4ad19197f6cc86c78)|`Remove bridges and spanning_trees from generic_graph.py`|\n|[ff10942](https://github.com/sagemath/sagetrac-mirror/commit/ff109421f292736ea327b481a2eb8a2c5c93c6e2)|`Add updated bridges and spanning_trees to graph.py`|\n|[ee9beee](https://github.com/sagemath/sagetrac-mirror/commit/ee9beee106dbc7c650dbd418ca4ec0090c01cc67)|`Minor docstring updates`|",
    "created_at": "2014-05-09T23:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------|
|[17a1a97](https://github.com/sagemath/sagetrac-mirror/commit/17a1a97a56b77ec4c0df0ac6ed0c51638f6ede96)|`Fixed bug preventing G.strong_orientation() from working on G a multigraph, added a small multigraph to doctests`|
|[72ed2dc](https://github.com/sagemath/sagetrac-mirror/commit/72ed2dcd780f99037accfb27a0830967d22ef607)|`Merge branch 'u/jdickinson/ticket/16307' of git://trac.sagemath.org/sage into ticket/16246`|
|[9bbee16](https://github.com/sagemath/sagetrac-mirror/commit/9bbee168e337a40d9b3a9cd4ad19197f6cc86c78)|`Remove bridges and spanning_trees from generic_graph.py`|
|[ff10942](https://github.com/sagemath/sagetrac-mirror/commit/ff109421f292736ea327b481a2eb8a2c5c93c6e2)|`Add updated bridges and spanning_trees to graph.py`|
|[ee9beee](https://github.com/sagemath/sagetrac-mirror/commit/ee9beee106dbc7c650dbd418ca4ec0090c01cc67)|`Minor docstring updates`|



---

archive/issue_comments_269650.json:
```json
{
    "body": "Changing commit from \"[ee677a9dfd6b36ed6008bcbef95950132002511b](https://github.com/sagemath/sagetrac-mirror/commit/ee677a9dfd6b36ed6008bcbef95950132002511b)\" to \"[ee9beee106dbc7c650dbd418ca4ec0090c01cc67](https://github.com/sagemath/sagetrac-mirror/commit/ee9beee106dbc7c650dbd418ca4ec0090c01cc67)\"",
    "created_at": "2014-05-09T23:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269650",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[ee677a9dfd6b36ed6008bcbef95950132002511b](https://github.com/sagemath/sagetrac-mirror/commit/ee677a9dfd6b36ed6008bcbef95950132002511b)" to "[ee9beee106dbc7c650dbd418ca4ec0090c01cc67](https://github.com/sagemath/sagetrac-mirror/commit/ee9beee106dbc7c650dbd418ca4ec0090c01cc67)"



---

archive/issue_comments_269651.json:
```json
{
    "body": "Dependencies: #16307",
    "created_at": "2014-05-09T23:47:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269651",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Dependencies: #16307



---

archive/issue_comments_269652.json:
```json
{
    "body": "<a id='comment:13'></a>\nHello! Thanks for the feedback.  We have been working on addressing your suggestions\n\n1) Improved documentation coming soon\n\n2) Auxiliary functions have been moved inside the functions we define\n\n3) Our code isn't meant to handle digraphs \u2013 have moved everything from generic_graph.py to graph.py\n\n4) Have replaced our bridges code with yours \u2013 it runs faster and avoids the problem of hitting a max recursion depth\n\n5) Updated spanning_trees no longer includes this line \n\nJennet",
    "created_at": "2014-05-09T23:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269652",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

<a id='comment:13'></a>
Hello! Thanks for the feedback.  We have been working on addressing your suggestions

1) Improved documentation coming soon

2) Auxiliary functions have been moved inside the functions we define

3) Our code isn't meant to handle digraphs – have moved everything from generic_graph.py to graph.py

4) Have replaced our bridges code with yours – it runs faster and avoids the problem of hitting a max recursion depth

5) Updated spanning_trees no longer includes this line 

Jennet



---

archive/issue_comments_269653.json:
```json
{
    "body": "Changing branch from \"[u/jdickinson/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/jdickinson/ticket/16246)\" to \"[u/lipshitz/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/lipshitz/ticket/16246)\"",
    "created_at": "2014-05-10T21:42:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269653",
    "user": "https://trac.sagemath.org/admin/accounts/users/lipshitz"
}
```

Changing branch from "[u/jdickinson/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/jdickinson/ticket/16246)" to "[u/lipshitz/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/lipshitz/ticket/16246)"



---

archive/issue_comments_269654.json:
```json
{
    "body": "Changing commit from \"[ee9beee106dbc7c650dbd418ca4ec0090c01cc67](https://github.com/sagemath/sagetrac-mirror/commit/ee9beee106dbc7c650dbd418ca4ec0090c01cc67)\" to \"[fed01e4c6927ed713a852f85797166e9cd6ecfdf](https://github.com/sagemath/sagetrac-mirror/commit/fed01e4c6927ed713a852f85797166e9cd6ecfdf)\"",
    "created_at": "2014-05-12T08:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269654",
    "user": "https://github.com/nathanncohen"
}
```

Changing commit from "[ee9beee106dbc7c650dbd418ca4ec0090c01cc67](https://github.com/sagemath/sagetrac-mirror/commit/ee9beee106dbc7c650dbd418ca4ec0090c01cc67)" to "[fed01e4c6927ed713a852f85797166e9cd6ecfdf](https://github.com/sagemath/sagetrac-mirror/commit/fed01e4c6927ed713a852f85797166e9cd6ecfdf)"



---

archive/issue_comments_269655.json:
```json
{
    "body": "<a id='comment:15'></a>\nRight ! Please set the ticket's status back to `needs_review` once it is ready again !\n\nNathann\n\n---\nNew commits:\n|                                                                                                                                          |                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[fed01e4](https://github.com/sagemath/sagetrac-mirror/commit/fed01e4c6927ed713a852f85797166e9cd6ecfdf)|`Slightly expand docstrings for bridges() and spanning_trees()`|",
    "created_at": "2014-05-12T08:50:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269655",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>
Right ! Please set the ticket's status back to `needs_review` once it is ready again !

Nathann

---
New commits:
|                                                                                                                                          |                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[fed01e4](https://github.com/sagemath/sagetrac-mirror/commit/fed01e4c6927ed713a852f85797166e9cd6ecfdf)|`Slightly expand docstrings for bridges() and spanning_trees()`|



---

archive/issue_comments_269656.json:
```json
{
    "body": "<a id='comment:16'></a>\nHellooooooooooo again !\n\nI spent some time over your code, and did some modifications to it. They all appear in u/ncohen/16246 for you to look at them.\n\nSome remarks which are fixed there :\n\n1) We try to keep the first line of a function's doc short. Less than a line describing the behaviour, and nothing else. Then you can be as verbose as you want.\n\n2) This :\n\n`len(G.edges()) == len(part_G.edges())`\n\nBuilds the list of edges just to compute its length. Use `G.size()`.\n\n3) This\n\n```\n-                X = G.edges()\n-                for y in part_G.edges():\n-                    X.remove(y)\n```\nresults in `part_G.size()` linear searches in a list X. When you want to test if a pair of things belongs to a set of pairs of things, the data structure you need is a graph. Besides, you only need ONE element of X, so don't compute them all.\n\n4) Call to `.bridges` in the recursive function : I don't think this is very effective. Computing all bridges is costly, and if you apply your function to a complete graph it will always be useless. Besides, the first thing you do in a recursive call (right after you removed an edge) is to test whether the graph is connected. Sooo you could use this to detect bridges instead, and wouldn't lose much.\n\n5) Function `_edges_to_remove` : when the call to `bridges` is removed, you only add edges one by one. And when you only add one edge to `part_G` it is easier to detect which edges should be removed. Thus this function can be removed\n\n6) A \"SEEALSO\" section in the doc is cool. Tells you what you may be interested in finding. I added one in `spanning_trees` and another in `spanning_trees_count`.\n\n7) No need to repeat \"in the graph\" when you describe what a function does.\n\nConsequently :\n\nBefore\n\n```\nsage: g = Graph(':I`KGgaF?SaP_UGa^') # A random graph\nsage: %timeit g.spanning_trees()    \n1 loops, best of 3: 2.21 s per loop\n```\nAfter\n\n```\nsage: g = Graph(':I`KGgaF?SaP_UGa^')\nsage: %timeit g.spanning_trees()    \n1 loops, best of 3: 975 ms per loop\n```\n\nThe branch containing my commits is now at u/ncohen/16246. If you agree with it, you can :\n\n1) Change this ticket's branch to u/ncohen/16246; or\n\n2) Append my commits to your branch\n\nand then set this ticket to `positive_review`. If you don't, let's discuss it as usual `:-)`\n\nBtw : I wanted to rename `part_G` to `forest`. What do you think ? It's not important or anything, but `part_G` does not make much sense to me ...\n\nNathann",
    "created_at": "2014-05-12T13:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269656",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>
Hellooooooooooo again !

I spent some time over your code, and did some modifications to it. They all appear in u/ncohen/16246 for you to look at them.

Some remarks which are fixed there :

1) We try to keep the first line of a function's doc short. Less than a line describing the behaviour, and nothing else. Then you can be as verbose as you want.

2) This :

`len(G.edges()) == len(part_G.edges())`

Builds the list of edges just to compute its length. Use `G.size()`.

3) This

```
-                X = G.edges()
-                for y in part_G.edges():
-                    X.remove(y)
```
results in `part_G.size()` linear searches in a list X. When you want to test if a pair of things belongs to a set of pairs of things, the data structure you need is a graph. Besides, you only need ONE element of X, so don't compute them all.

4) Call to `.bridges` in the recursive function : I don't think this is very effective. Computing all bridges is costly, and if you apply your function to a complete graph it will always be useless. Besides, the first thing you do in a recursive call (right after you removed an edge) is to test whether the graph is connected. Sooo you could use this to detect bridges instead, and wouldn't lose much.

5) Function `_edges_to_remove` : when the call to `bridges` is removed, you only add edges one by one. And when you only add one edge to `part_G` it is easier to detect which edges should be removed. Thus this function can be removed

6) A "SEEALSO" section in the doc is cool. Tells you what you may be interested in finding. I added one in `spanning_trees` and another in `spanning_trees_count`.

7) No need to repeat "in the graph" when you describe what a function does.

Consequently :

Before

```
sage: g = Graph(':I`KGgaF?SaP_UGa^') # A random graph
sage: %timeit g.spanning_trees()    
1 loops, best of 3: 2.21 s per loop
```
After

```
sage: g = Graph(':I`KGgaF?SaP_UGa^')
sage: %timeit g.spanning_trees()    
1 loops, best of 3: 975 ms per loop
```

The branch containing my commits is now at u/ncohen/16246. If you agree with it, you can :

1) Change this ticket's branch to u/ncohen/16246; or

2) Append my commits to your branch

and then set this ticket to `positive_review`. If you don't, let's discuss it as usual `:-)`

Btw : I wanted to rename `part_G` to `forest`. What do you think ? It's not important or anything, but `part_G` does not make much sense to me ...

Nathann



---

archive/issue_comments_269657.json:
```json
{
    "body": "<a id='comment:17'></a>\nHi Nathann,\n\nThanks for all of the feedback and improvements!  We read your revised code, and agree with everyone you said except perhaps point 4.\n\nAbout 4:  We think the reason that Read-Tarjan included this step in their algorithm is the opposite extreme:  the case that G is a tree, or almost a tree.  According to their analysis, their algorithm runs in O(V+E+ET), where T is the number of spanning trees. (This assumes, of course, that bridges() and so on are implemented efficiently, and that the graphs are stored in a particular way.  We think the first half is true for the Sage code, but don't know about the second.)\n\nWith your modification, suppose G is a tree.  Then it seems the running time is  E * O(is_connected()).  We don't know how is_connected is implemented.  A naive implementation runs in O(V+E) time.  Perhaps this can be improved to something like O(V) time.\n\nUpshot:  deleting the bridges() stuff adds a quadratic E*V in the algorithm, which can be worse than V+E+ET, in cases that T is small.\n\nIn practice, though, you're probably right:  probably it's (always? almost always?) faster the way you rewrote the function.\n\n\nHow do you prefer to proceed?  The simpler, probably practically faster version you wrote?  The possibly theoretically faster Read-Tarjan one?  An option in the function, allowing the user to decide (defaulting to your version, say)?\n\n\nAlso, feel free to change \"part_G\" to \"forest\" if you prefer.  (\"part_G\" stood for \"part of the original graph G\" or \"partial spanning tree\".)\n\n\nBest,\nRobert and Jennet",
    "created_at": "2014-05-14T21:38:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269657",
    "user": "https://trac.sagemath.org/admin/accounts/users/lipshitz"
}
```

<a id='comment:17'></a>
Hi Nathann,

Thanks for all of the feedback and improvements!  We read your revised code, and agree with everyone you said except perhaps point 4.

About 4:  We think the reason that Read-Tarjan included this step in their algorithm is the opposite extreme:  the case that G is a tree, or almost a tree.  According to their analysis, their algorithm runs in O(V+E+ET), where T is the number of spanning trees. (This assumes, of course, that bridges() and so on are implemented efficiently, and that the graphs are stored in a particular way.  We think the first half is true for the Sage code, but don't know about the second.)

With your modification, suppose G is a tree.  Then it seems the running time is  E * O(is_connected()).  We don't know how is_connected is implemented.  A naive implementation runs in O(V+E) time.  Perhaps this can be improved to something like O(V) time.

Upshot:  deleting the bridges() stuff adds a quadratic E*V in the algorithm, which can be worse than V+E+ET, in cases that T is small.

In practice, though, you're probably right:  probably it's (always? almost always?) faster the way you rewrote the function.


How do you prefer to proceed?  The simpler, probably practically faster version you wrote?  The possibly theoretically faster Read-Tarjan one?  An option in the function, allowing the user to decide (defaulting to your version, say)?


Also, feel free to change "part_G" to "forest" if you prefer.  ("part_G" stood for "part of the original graph G" or "partial spanning tree".)


Best,
Robert and Jennet



---

archive/issue_comments_269658.json:
```json
{
    "body": "<a id='comment:18'></a>\nHelloooooooooo !!\n\n> About 4:  We think the reason that Read-Tarjan included this step in their algorithm is the opposite extreme:  the case that G is a tree, or almost a tree.  According to their analysis, their algorithm runs in O(V+E+ET), where T is the number of spanning trees. (This assumes, of course, that bridges() and so on are implemented efficiently, and that the graphs are stored in a particular way.  We think the first half is true for the Sage code, but don't know about the second.)\n> \n> With your modification, suppose G is a tree.  Then it seems the running time is  E * O(is_connected()).  We don't know how is_connected is implemented.  A naive implementation runs in O(V+E) time.  Perhaps this can be improved to something like O(V) time.\n\n\nHmmmmm... Well, can I shamelessly avoid answering the real question by saying that if the graph is a tree then E=O(V), in which case the asymptotic analysis of the complexity is cool ?\n\n> In practice, though, you're probably right:  probably it's (always? almost always?) faster the way you rewrote the function.\n\n\nI believe that removing it really saves something when you have a lot of edges. But I can't prove it with paper and pen.\n\n> How do you prefer to proceed?  The simpler, probably practically faster version you wrote?  The possibly theoretically faster Read-Tarjan one?  An option in the function, allowing the user to decide (defaulting to your version, say)?\n\n\nOh. Well, I prefer the simple and faster version of course. I even prefer \"simple\" versions when it is just sligthly slower. Really, when it comes to programming you cannot put a lot of faith in complexity analysis. You have to profile code, there is no other way. It is possible that most of the time is taken by something you would not have thought about, something that theory discards as straightforward, which actually isn't. Or just isn't implemented as theory thinks that it should.\n\n> Also, feel free to change \"part_G\" to \"forest\" if you prefer.  (\"part_G\" stood for \"part of the original graph G\" or \"partial spanning tree\".)\n\n\nI will do this in a second.\n\nNathann",
    "created_at": "2014-05-15T11:58:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269658",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:18'></a>
Helloooooooooo !!

> About 4:  We think the reason that Read-Tarjan included this step in their algorithm is the opposite extreme:  the case that G is a tree, or almost a tree.  According to their analysis, their algorithm runs in O(V+E+ET), where T is the number of spanning trees. (This assumes, of course, that bridges() and so on are implemented efficiently, and that the graphs are stored in a particular way.  We think the first half is true for the Sage code, but don't know about the second.)
> 
> With your modification, suppose G is a tree.  Then it seems the running time is  E * O(is_connected()).  We don't know how is_connected is implemented.  A naive implementation runs in O(V+E) time.  Perhaps this can be improved to something like O(V) time.


Hmmmmm... Well, can I shamelessly avoid answering the real question by saying that if the graph is a tree then E=O(V), in which case the asymptotic analysis of the complexity is cool ?

> In practice, though, you're probably right:  probably it's (always? almost always?) faster the way you rewrote the function.


I believe that removing it really saves something when you have a lot of edges. But I can't prove it with paper and pen.

> How do you prefer to proceed?  The simpler, probably practically faster version you wrote?  The possibly theoretically faster Read-Tarjan one?  An option in the function, allowing the user to decide (defaulting to your version, say)?


Oh. Well, I prefer the simple and faster version of course. I even prefer "simple" versions when it is just sligthly slower. Really, when it comes to programming you cannot put a lot of faith in complexity analysis. You have to profile code, there is no other way. It is possible that most of the time is taken by something you would not have thought about, something that theory discards as straightforward, which actually isn't. Or just isn't implemented as theory thinks that it should.

> Also, feel free to change "part_G" to "forest" if you prefer.  ("part_G" stood for "part of the original graph G" or "partial spanning tree".)


I will do this in a second.

Nathann



---

archive/issue_comments_269659.json:
```json
{
    "body": "Changing branch from \"[u/lipshitz/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/lipshitz/ticket/16246)\" to \"[u/ncohen/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16246)\"",
    "created_at": "2014-05-15T12:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269659",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "[u/lipshitz/ticket/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/lipshitz/ticket/16246)" to "[u/ncohen/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16246)"



---

archive/issue_comments_269660.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-15T12:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269660",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_269661.json:
```json
{
    "body": "Changing commit from \"[fed01e4c6927ed713a852f85797166e9cd6ecfdf](https://github.com/sagemath/sagetrac-mirror/commit/fed01e4c6927ed713a852f85797166e9cd6ecfdf)\" to \"[353ac4bf109bf08fb6356b247a57aa2e1a5b654f](https://github.com/sagemath/sagetrac-mirror/commit/353ac4bf109bf08fb6356b247a57aa2e1a5b654f)\"",
    "created_at": "2014-05-15T12:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269661",
    "user": "https://github.com/nathanncohen"
}
```

Changing commit from "[fed01e4c6927ed713a852f85797166e9cd6ecfdf](https://github.com/sagemath/sagetrac-mirror/commit/fed01e4c6927ed713a852f85797166e9cd6ecfdf)" to "[353ac4bf109bf08fb6356b247a57aa2e1a5b654f](https://github.com/sagemath/sagetrac-mirror/commit/353ac4bf109bf08fb6356b247a57aa2e1a5b654f)"



---

archive/issue_comments_269662.json:
```json
{
    "body": "Reviewer: Nathann Cohen",
    "created_at": "2014-05-15T12:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269662",
    "user": "https://github.com/nathanncohen"
}
```

Reviewer: Nathann Cohen



---

archive/issue_comments_269663.json:
```json
{
    "body": "<a id='comment:19'></a>\nIf you agree with the code, you can set the ticket to `needs_review`. The \"procedure\" is : I reviewed your changes, you reviewed mine, so it is good to go.\n\nNathann\n\n---\nNew commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[41df4b0](https://github.com/sagemath/sagetrac-mirror/commit/41df4b01caf80cfa4ea369dc8fdd35fb348b83f0)|`trac #16246: Merged with 6.3.beta0`|\n|[aa6aa93](https://github.com/sagemath/sagetrac-mirror/commit/aa6aa939f1630102a4634303ad2b476dba6a0bd8)|`trac #16246: Rewritten all_spanning_trees function`|\n|[353ac4b](https://github.com/sagemath/sagetrac-mirror/commit/353ac4bf109bf08fb6356b247a57aa2e1a5b654f)|`trac #16246: Doc improvements`|",
    "created_at": "2014-05-15T12:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269663",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:19'></a>
If you agree with the code, you can set the ticket to `needs_review`. The "procedure" is : I reviewed your changes, you reviewed mine, so it is good to go.

Nathann

---
New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[41df4b0](https://github.com/sagemath/sagetrac-mirror/commit/41df4b01caf80cfa4ea369dc8fdd35fb348b83f0)|`trac #16246: Merged with 6.3.beta0`|
|[aa6aa93](https://github.com/sagemath/sagetrac-mirror/commit/aa6aa939f1630102a4634303ad2b476dba6a0bd8)|`trac #16246: Rewritten all_spanning_trees function`|
|[353ac4b](https://github.com/sagemath/sagetrac-mirror/commit/353ac4bf109bf08fb6356b247a57aa2e1a5b654f)|`trac #16246: Doc improvements`|



---

archive/issue_comments_269664.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[5a7d479](https://github.com/sagemath/sagetrac-mirror/commit/5a7d47982888d5f3e681dd62c710bc00fcbec14d)|`trac #16246: Merged with 6.3.beta1`|\n|[e9f67fc](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)|`trac #16246: renaming a variable`|",
    "created_at": "2014-05-15T12:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269664",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[5a7d479](https://github.com/sagemath/sagetrac-mirror/commit/5a7d47982888d5f3e681dd62c710bc00fcbec14d)|`trac #16246: Merged with 6.3.beta1`|
|[e9f67fc](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)|`trac #16246: renaming a variable`|



---

archive/issue_comments_269665.json:
```json
{
    "body": "Changing commit from \"[353ac4bf109bf08fb6356b247a57aa2e1a5b654f](https://github.com/sagemath/sagetrac-mirror/commit/353ac4bf109bf08fb6356b247a57aa2e1a5b654f)\" to \"[e9f67fca64c10c5cf61df3f422c4e825e533c32f](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)\"",
    "created_at": "2014-05-15T12:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269665",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "[353ac4bf109bf08fb6356b247a57aa2e1a5b654f](https://github.com/sagemath/sagetrac-mirror/commit/353ac4bf109bf08fb6356b247a57aa2e1a5b654f)" to "[e9f67fca64c10c5cf61df3f422c4e825e533c32f](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)"



---

archive/issue_comments_269666.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-15T14:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269666",
    "user": "https://trac.sagemath.org/admin/accounts/users/jdickinson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_269667.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-15T17:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269667",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054488.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-05-15T17:18:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16246#event-54488"
}
```



---

archive/issue_comments_269668.json:
```json
{
    "body": "Changing branch from \"[u/ncohen/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16246)\" to \"[e9f67fca64c10c5cf61df3f422c4e825e533c32f](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)\"",
    "created_at": "2014-05-15T17:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16246",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16246#issuecomment-269668",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "[u/ncohen/16246](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16246)" to "[e9f67fca64c10c5cf61df3f422c4e825e533c32f](https://github.com/sagemath/sagetrac-mirror/commit/e9f67fca64c10c5cf61df3f422c4e825e533c32f)"
