# Issue 16581: Added tides based desolvers

archive/issues_016344.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nThis patch adds two solvers for differential equations (desolve_mintides and desove_tides_mpfr) based on the TIDES library.\n\nDepends on #16578\nDepends on #16579\n\nCC:  @vbraun @videlec\n\nComponent: **numerical**\n\nKeywords: **sd59**\n\nAuthor: **Miguel Marco**\n\nBranch/Commit: **[`0ff9e7f`](https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6)**\n\nReviewer: **Volker Braun**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16581_\n\n",
    "closed_at": "2014-10-08T12:59:56Z",
    "created_at": "2014-06-28T07:10:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20numerical",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Added tides based desolvers",
    "type": "issue",
    "updated_at": "2014-10-08T12:59:56Z",
    "url": "https://github.com/sagemath/sage/issues/16581",
    "user": "https://github.com/miguelmarco"
}
```
<div id="comment:0"></div>

This patch adds two solvers for differential equations (desolve_mintides and desove_tides_mpfr) based on the TIDES library.

Depends on #16578
Depends on #16579

CC:  @vbraun @videlec

Component: **numerical**

Keywords: **sd59**

Author: **Miguel Marco**

Branch/Commit: **[`0ff9e7f`](https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6)**

Reviewer: **Volker Braun**

_Issue created by migration from https://trac.sagemath.org/ticket/16581_





---

archive/issue_events_234833.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2014-06-28T07:10:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234833"
}
```



---

archive/issue_events_234834.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2014-06-28T07:10:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20numerical",
    "label_color": "0000ff",
    "label_name": "c: numerical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234834"
}
```



---

archive/issue_events_234835.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2014-06-28T07:10:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234835"
}
```



---

archive/issue_events_234836.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2014-06-28T07:10:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234836"
}
```



---

archive/issue_comments_215714.json:
```json
{
    "body": "Branch: **[u/mmarco/ticket/16581](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/16581)**",
    "created_at": "2014-06-28T07:11:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215714",
    "user": "https://github.com/miguelmarco"
}
```

Branch: **[u/mmarco/ticket/16581](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/16581)**



---

archive/issue_comments_215715.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/31dfa8747d85fabdf35dcc8d435ba682f8aa0c3c\"><code>31dfa87</code></a></td><td><code>cleaned mintides desolver, separated file generators to the tides directory</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/addab3fb58d1fe0576127fe2eac3d001f4dc551e\"><code>addab3f</code></a></td><td><code>changed authors</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6c12cfd8de8fef523c028111d946cd4fb413228\"><code>a6c12cf</code></a></td><td><code>added c files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6fa0e484bf6bfbae1209890ea18f2c3d077c6361\"><code>6fa0e48</code></a></td><td><code>fully documented version</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8bee645807c831bc23f8e44e4c0d921bd75fc4f4\"><code>8bee645</code></a></td><td><code>Add tides as package.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99a99b767b2ef8ec7cb07d5c355d92291c2a5c90\"><code>99a99b7</code></a></td><td><code>Merge branch 'tideslib' into tides</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3bbadc01e6dd41241f810be3febec7acb15da7a\"><code>f3bbadc</code></a></td><td><code>cleaned dependencdy on .c and .h files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fba3457b8edb69479bdc46e80b168227080d3215\"><code>fba3457</code></a></td><td><code>Cleaned desolvers based in tides</code></td></tr></table>\n",
    "created_at": "2014-06-28T07:11:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215715",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:2"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/31dfa8747d85fabdf35dcc8d435ba682f8aa0c3c"><code>31dfa87</code></a></td><td><code>cleaned mintides desolver, separated file generators to the tides directory</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/addab3fb58d1fe0576127fe2eac3d001f4dc551e"><code>addab3f</code></a></td><td><code>changed authors</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6c12cfd8de8fef523c028111d946cd4fb413228"><code>a6c12cf</code></a></td><td><code>added c files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6fa0e484bf6bfbae1209890ea18f2c3d077c6361"><code>6fa0e48</code></a></td><td><code>fully documented version</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8bee645807c831bc23f8e44e4c0d921bd75fc4f4"><code>8bee645</code></a></td><td><code>Add tides as package.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99a99b767b2ef8ec7cb07d5c355d92291c2a5c90"><code>99a99b7</code></a></td><td><code>Merge branch 'tideslib' into tides</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3bbadc01e6dd41241f810be3febec7acb15da7a"><code>f3bbadc</code></a></td><td><code>cleaned dependencdy on .c and .h files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fba3457b8edb69479bdc46e80b168227080d3215"><code>fba3457</code></a></td><td><code>Cleaned desolvers based in tides</code></td></tr></table>




---

archive/issue_events_234837.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2014-06-28T07:11:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234837"
}
```



---

archive/issue_comments_215716.json:
```json
{
    "body": "Commit: **[`fba3457`](https://github.com/sagemath/sagetrac-mirror/commit/fba3457b8edb69479bdc46e80b168227080d3215)**",
    "created_at": "2014-06-28T07:11:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215716",
    "user": "https://github.com/miguelmarco"
}
```

Commit: **[`fba3457`](https://github.com/sagemath/sagetrac-mirror/commit/fba3457b8edb69479bdc46e80b168227080d3215)**



---

archive/issue_comments_215717.json:
```json
{
    "body": "Changed keywords from none to **sd59**",
    "created_at": "2014-06-28T07:42:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215717",
    "user": "https://github.com/miguelmarco"
}
```

Changed keywords from none to **sd59**



---

archive/issue_comments_215718.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHi Miguel,\n\nWhy did you include tides in source instead of making a spkg? The sources of packages are not under git management. You would better follow the instructions at [http://www.sagemath.org/doc/developer/packaging.html](http://www.sagemath.org/doc/developer/packaging.html).\n\nEDIT: I see it is at #16578... sorry for the noise\n\nCOMMENT: in the list of commit above it is **very** hard to see which are the one associated to that ticket!!\n\nVincent",
    "created_at": "2014-06-28T10:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215718",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">comment:4</div>

Hi Miguel,

Why did you include tides in source instead of making a spkg? The sources of packages are not under git management. You would better follow the instructions at [http://www.sagemath.org/doc/developer/packaging.html](http://www.sagemath.org/doc/developer/packaging.html).

EDIT: I see it is at #16578... sorry for the noise

COMMENT: in the list of commit above it is **very** hard to see which are the one associated to that ticket!!

Vincent



---

archive/issue_comments_215719.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYeah, sorry for the long list of commits, i made a lot of trial-and-error and refactoring before having this ready.... i guess there could be a way to tell git to merge all those commits into one.",
    "created_at": "2014-06-28T18:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215719",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:5" align="right">comment:5</div>

Yeah, sorry for the long list of commits, i made a lot of trial-and-error and refactoring before having this ready.... i guess there could be a way to tell git to merge all those commits into one.



---

archive/issue_comments_215720.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYes!!! I just learn it today: `git rebase -i` see: [rewriting history](http://git-scm.com/book/en/Git-Tools-Rewriting-History)",
    "created_at": "2014-06-28T18:39:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215720",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">comment:6</div>

Yes!!! I just learn it today: `git rebase -i` see: [rewriting history](http://git-scm.com/book/en/Git-Tools-Rewriting-History)



---

archive/issue_comments_215721.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nBut be careful: keep distinct commits for distinct tickets!",
    "created_at": "2014-06-28T18:39:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215721",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

But be careful: keep distinct commits for distinct tickets!



---

archive/issue_comments_215722.json:
```json
{
    "body": "Changed commit from **[`fba3457`](https://github.com/sagemath/sagetrac-mirror/commit/fba3457b8edb69479bdc46e80b168227080d3215)** to **[`8b12bac`](https://github.com/sagemath/sagetrac-mirror/commit/8b12bac74d036ab7546c63f9a8de2b8d0ef0f9e0)**",
    "created_at": "2014-06-28T21:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215722",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fba3457`](https://github.com/sagemath/sagetrac-mirror/commit/fba3457b8edb69479bdc46e80b168227080d3215)** to **[`8b12bac`](https://github.com/sagemath/sagetrac-mirror/commit/8b12bac74d036ab7546c63f9a8de2b8d0ef0f9e0)**



---

archive/issue_comments_215723.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b12bac74d036ab7546c63f9a8de2b8d0ef0f9e0\"><code>8b12bac</code></a></td><td><code>solved wrong import statement</code></td></tr></table>\n",
    "created_at": "2014-06-28T21:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215723",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b12bac74d036ab7546c63f9a8de2b8d0ef0f9e0"><code>8b12bac</code></a></td><td><code>solved wrong import statement</code></td></tr></table>




---

archive/issue_comments_215724.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYou should use the CC / CFLAGS / LDFLAGS environment variables (CXX for C++).\n\nIMHO the integration is a bit underwhelming. Its ok for an optional package, I guess. But better solutions would be\n* Use the `cython()` command to dynamically generate a function that is callable from Python, without parsing strings anywhere. Leaks a bit of memory from the imports.\n* Use `fast_callable(..., domain=RealField(prec))` to dynamically construct the expression tree and only have a single Cython class that can call tides as appropriate.\nDo you have any plans in that direction?",
    "created_at": "2014-07-08T22:00:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215724",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:9" align="right">comment:9</div>

You should use the CC / CFLAGS / LDFLAGS environment variables (CXX for C++).

IMHO the integration is a bit underwhelming. Its ok for an optional package, I guess. But better solutions would be
* Use the `cython()` command to dynamically generate a function that is callable from Python, without parsing strings anywhere. Leaks a bit of memory from the imports.
* Use `fast_callable(..., domain=RealField(prec))` to dynamically construct the expression tree and only have a single Cython class that can call tides as appropriate.
Do you have any plans in that direction?



---

archive/issue_comments_215725.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI am not sure if i understand your second suggestion. About the first one, it could be a good idea for this part (the desolvers). But it should be substitute the .c files generators in #16579, since those .c files are useful by themselves (one of the use cases of TIDES is to generate those files qith Mathematica and then tweak them by hand to get slightly different solutions, or extra information from them).\n\nIf i understand correctly, you are suggesting to substitute the call to gcc by some small cython object. Is that correct?",
    "created_at": "2014-07-09T03:27:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215725",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:10" align="right">comment:10</div>

I am not sure if i understand your second suggestion. About the first one, it could be a good idea for this part (the desolvers). But it should be substitute the .c files generators in #16579, since those .c files are useful by themselves (one of the use cases of TIDES is to generate those files qith Mathematica and then tweak them by hand to get slightly different solutions, or extra information from them).

If i understand correctly, you are suggesting to substitute the call to gcc by some small cython object. Is that correct?



---

archive/issue_comments_215726.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAbout the first, you can use the `cython()` command in Sage to compile a new cython extension module at run-time. With the magic comment `#cfile foo.c` (see `cython?`) you can even include C sources. So it should be rather easy to implement.\n\nThe second suggestion is to not compile stuff whenever you solve a differential equation (really, nobody else does that). You can just compile it once and evaluate the function/derivatives dynamically.",
    "created_at": "2014-07-09T03:48:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215726",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:11" align="right">comment:11</div>

About the first, you can use the `cython()` command in Sage to compile a new cython extension module at run-time. With the magic comment `#cfile foo.c` (see `cython?`) you can even include C sources. So it should be rather easy to implement.

The second suggestion is to not compile stuff whenever you solve a differential equation (really, nobody else does that). You can just compile it once and evaluate the function/derivatives dynamically.



---

archive/issue_comments_215727.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI am not sure if the tides design allows that kind of workflow. I will ask the developers about it. Apparently, in the world of specialized de solvers, compiling write and compile a program for each particular de is the usual (which was very surprising for me when I found out)",
    "created_at": "2014-07-09T06:53:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215727",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:12" align="right">comment:12</div>

I am not sure if the tides design allows that kind of workflow. I will ask the developers about it. Apparently, in the world of specialized de solvers, compiling write and compile a program for each particular de is the usual (which was very surprising for me when I found out)



---

archive/issue_comments_215728.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHi. I'm Marcos Rodriguez, a developer of TIDES.\n\nThank you very much for the reviewing effort.\n\nIn the numerical computation of a differential equation, the bottleneck is at the computation of the taylor series coefficients (code generated by the parser). Therefore, this scheme should be as much optimized as possible via compiler. So, a dynamical function call for this part would slow down the computation significantly.\n\nBesides, the original goal of MathTIDES (the parser written in Mathematica) was the generation of C of Fortran code which compilation and execution is independent of the symbolic preprocessor (Mathematica in this case) so that it can be tweaked or integrated in other C or Fortran codes for different purposes.\n\nWe think that the natural extension is to compile, execute and display this code in a free symbolic preprocessor.",
    "created_at": "2014-08-05T13:07:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215728",
    "user": "https://github.com/sagetrac-iMark"
}
```

<div id="comment:13" align="right">comment:13</div>

Hi. I'm Marcos Rodriguez, a developer of TIDES.

Thank you very much for the reviewing effort.

In the numerical computation of a differential equation, the bottleneck is at the computation of the taylor series coefficients (code generated by the parser). Therefore, this scheme should be as much optimized as possible via compiler. So, a dynamical function call for this part would slow down the computation significantly.

Besides, the original goal of MathTIDES (the parser written in Mathematica) was the generation of C of Fortran code which compilation and execution is independent of the symbolic preprocessor (Mathematica in this case) so that it can be tweaked or integrated in other C or Fortran codes for different purposes.

We think that the natural extension is to compile, execute and display this code in a free symbolic preprocessor.



---

archive/issue_comments_215729.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThanks for posting here! \n\nIts of course faster to do anything numerical in compiled code. But there is a reason why we don't always do that (e.g. when plotting functions). At the end of the day it is just a trade-off between speed in a single example vs. preprocessing time and ease of use. Imagine you want to solve a million ODEs, each only a short bit into the future. In any case, this need not be done on this ticket.\n\nMiguel:\n* use subprocess.check_call instead of os.system to catch potential errors\n* \"which\" is not posix, use \"command -v\"\n* Use sage's tmp_dir instead of mkdtmp\n* os.path.join instead of hard-coding \"/\" as directory separator\n* less blank lines (see pep8). Double blanks only to separate class definitons and top-level functions.\n* You should link to Sage's mpir/mpfr instead of the system default. Use `gcc -I$SAGE_ROOT/local/include -L$SAGE_ROOT/local/lib` for header and library search paths.",
    "created_at": "2014-08-05T14:23:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215729",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:14" align="right">comment:14</div>

Thanks for posting here! 

Its of course faster to do anything numerical in compiled code. But there is a reason why we don't always do that (e.g. when plotting functions). At the end of the day it is just a trade-off between speed in a single example vs. preprocessing time and ease of use. Imagine you want to solve a million ODEs, each only a short bit into the future. In any case, this need not be done on this ticket.

Miguel:
* use subprocess.check_call instead of os.system to catch potential errors
* "which" is not posix, use "command -v"
* Use sage's tmp_dir instead of mkdtmp
* os.path.join instead of hard-coding "/" as directory separator
* less blank lines (see pep8). Double blanks only to separate class definitons and top-level functions.
* You should link to Sage's mpir/mpfr instead of the system default. Use `gcc -I$SAGE_ROOT/local/include -L$SAGE_ROOT/local/lib` for header and library search paths.



---

archive/issue_events_234838.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234838"
}
```



---

archive/issue_events_234839.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234839"
}
```



---

archive/issue_comments_215730.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e192f0acc88e9849a2d821dcf2813805e07d908b\"><code>e192f0a</code></a></td><td><code>Reviewer's changes on mintides</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ae8c869bc35ada66013d731be5eb003c3cf396fd\"><code>ae8c869</code></a></td><td><code>Reviewer changes in decolve_tides_mpfr</code></td></tr></table>\n",
    "created_at": "2014-08-15T12:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215730",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e192f0acc88e9849a2d821dcf2813805e07d908b"><code>e192f0a</code></a></td><td><code>Reviewer's changes on mintides</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ae8c869bc35ada66013d731be5eb003c3cf396fd"><code>ae8c869</code></a></td><td><code>Reviewer changes in decolve_tides_mpfr</code></td></tr></table>




---

archive/issue_comments_215731.json:
```json
{
    "body": "Changed commit from **[`8b12bac`](https://github.com/sagemath/sagetrac-mirror/commit/8b12bac74d036ab7546c63f9a8de2b8d0ef0f9e0)** to **[`ae8c869`](https://github.com/sagemath/sagetrac-mirror/commit/ae8c869bc35ada66013d731be5eb003c3cf396fd)**",
    "created_at": "2014-08-15T12:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215731",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8b12bac`](https://github.com/sagemath/sagetrac-mirror/commit/8b12bac74d036ab7546c63f9a8de2b8d0ef0f9e0)** to **[`ae8c869`](https://github.com/sagemath/sagetrac-mirror/commit/ae8c869bc35ada66013d731be5eb003c3cf396fd)**



---

archive/issue_comments_215732.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nMade the suggested changes.",
    "created_at": "2014-08-15T12:19:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215732",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:17" align="right">comment:17</div>

Made the suggested changes.



---

archive/issue_comments_215733.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHello.\n\nDo you think that after the changes, a possitive revision can be given (with possible minor changes), or it would need a complete rewrite.\nThe reason for me to ask is that we are writing a paper about TIDES and integration using Taylor Method and we would like to include comparisons using Sage-tides and anounce the Sage version of the package as a completely free version of the software.\n\nThank you very much.",
    "created_at": "2014-10-06T11:45:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215733",
    "user": "https://github.com/sagetrac-iMark"
}
```

<div id="comment:20" align="right">comment:20</div>

Hello.

Do you think that after the changes, a possitive revision can be given (with possible minor changes), or it would need a complete rewrite.
The reason for me to ask is that we are writing a paper about TIDES and integration using Taylor Method and we would like to include comparisons using Sage-tides and anounce the Sage version of the package as a completely free version of the software.

Thank you very much.



---

archive/issue_events_234840.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-06T12:19:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234840"
}
```



---

archive/issue_events_234841.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-06T12:19:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234841"
}
```



---

archive/issue_comments_215734.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2014-10-06T12:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215734",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_events_234842.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-06T12:28:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234842"
}
```



---

archive/issue_events_234843.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-06T12:28:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234843"
}
```



---

archive/issue_comments_215735.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nYou want `# abs tol`\n\n```\nFile \"src/sage/calculus/desolvers.py\", line 1617, in sage.calculus.desolvers.desolve_mintides\nFailed example:\n    sol # optional -tides # abs rel 1e-5\nExpected:\n    [[0.000000000000000,\n    0.800000000000000,\n    0.000000000000000,\n    0.000000000000000,\n    1.22474487139159],\n    [314.159265358979,\n    0.800000000028622,\n    -5.91973525754241e-9,\n    7.56887091890590e-9,\n    1.22474487136329]]\nGot:\n    [[0.000000000000000,\n      0.800000000000000,\n      0.000000000000000,\n      0.000000000000000,\n      1.22474487139159],\n     [314.159265358979,\n      0.800000000028628,\n      -5.92006829669423e-9,\n      7.56929363632253e-9,\n      1.22474487136328]]\n**********************************************************************\n```",
    "created_at": "2014-10-06T12:28:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215735",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:22" align="right">comment:22</div>

You want `# abs tol`

```
File "src/sage/calculus/desolvers.py", line 1617, in sage.calculus.desolvers.desolve_mintides
Failed example:
    sol # optional -tides # abs rel 1e-5
Expected:
    [[0.000000000000000,
    0.800000000000000,
    0.000000000000000,
    0.000000000000000,
    1.22474487139159],
    [314.159265358979,
    0.800000000028622,
    -5.91973525754241e-9,
    7.56887091890590e-9,
    1.22474487136329]]
Got:
    [[0.000000000000000,
      0.800000000000000,
      0.000000000000000,
      0.000000000000000,
      1.22474487139159],
     [314.159265358979,
      0.800000000028628,
      -5.92006829669423e-9,
      7.56929363632253e-9,
      1.22474487136328]]
**********************************************************************
```



---

archive/issue_comments_215736.json:
```json
{
    "body": "Changed commit from **[`ae8c869`](https://github.com/sagemath/sagetrac-mirror/commit/ae8c869bc35ada66013d731be5eb003c3cf396fd)** to **[`0ff9e7f`](https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6)**",
    "created_at": "2014-10-06T15:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215736",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ae8c869`](https://github.com/sagemath/sagetrac-mirror/commit/ae8c869bc35ada66013d731be5eb003c3cf396fd)** to **[`0ff9e7f`](https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6)**



---

archive/issue_comments_215737.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6\"><code>0ff9e7f</code></a></td><td><code>Fixed numerical tolerance in doctests</code></td></tr></table>\n",
    "created_at": "2014-10-06T15:38:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215737",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6"><code>0ff9e7f</code></a></td><td><code>Fixed numerical tolerance in doctests</code></td></tr></table>




---

archive/issue_comments_215738.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nFixed",
    "created_at": "2014-10-06T15:40:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215738",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:24" align="right">comment:24</div>

Fixed



---

archive/issue_events_234844.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2014-10-06T15:40:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234844"
}
```



---

archive/issue_events_234845.json:
```json
{
    "actor": "https://github.com/miguelmarco",
    "created_at": "2014-10-06T15:40:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234845"
}
```



---

archive/issue_events_234846.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-07T14:23:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234846"
}
```



---

archive/issue_events_234847.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-07T14:23:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234847"
}
```



---

archive/issue_comments_215739.json:
```json
{
    "body": "Changed branch from **[u/mmarco/ticket/16581](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/16581)** to **[`0ff9e7f`](https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6)**",
    "created_at": "2014-10-08T12:59:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16581#issuecomment-215739",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/mmarco/ticket/16581](https://github.com/sagemath/sagetrac-mirror/tree/u/mmarco/ticket/16581)** to **[`0ff9e7f`](https://github.com/sagemath/sagetrac-mirror/commit/0ff9e7f48bc164c95cece98b3c3d18bfcdbd7ef6)**



---

archive/issue_events_234848.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-08T12:59:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234848"
}
```



---

archive/issue_events_234849.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0e9dbd0c3e42d7bea593549fa7140609c51c8691",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-10-08T12:59:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16581",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16581#event-234849"
}
```
