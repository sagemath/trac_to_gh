# Issue 16806: Isogeny Bounds for Elliptic Curves over Number Fields

archive/issues_016569.json:
```json
{
    "body": "\n\nCC:  @JohnCremona @categorie\n\nBranch/Commit: 8c9301671b354f7ba6c24d48f28d0e2b0698f39f\n\nReviewer: John Cremona, Chris Wuthrich\n\nAuthor: Eric Larson\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16806\n\n",
    "closed_at": "2014-09-25T12:05:22Z",
    "created_at": "2014-08-12T18:33:26Z",
    "labels": [
        "component: elliptic curves",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Isogeny Bounds for Elliptic Curves over Number Fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16806",
    "user": "https://github.com/elarson314"
}
```


CC:  @JohnCremona @categorie

Branch/Commit: 8c9301671b354f7ba6c24d48f28d0e2b0698f39f

Reviewer: John Cremona, Chris Wuthrich

Author: Eric Larson

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16806





---

archive/issue_comments_232222.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to elliptic curves.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232222",
    "user": "https://github.com/elarson314"
}
```

Changing component from PLEASE CHANGE to elliptic curves.



---

archive/issue_comments_232223.json:
```json
{
    "body": "Changing priority from major to minor.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232223",
    "user": "https://github.com/elarson314"
}
```

Changing priority from major to minor.



---

archive/issue_comments_232224.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232224",
    "user": "https://github.com/elarson314"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_events_049187.json:
```json
{
    "actor": "https://github.com/elarson314",
    "created_at": "2014-08-12T18:35:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "milestone": "sage-feature",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16806#event-49187"
}
```



---

archive/issue_comments_232225.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-12T18:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232225",
    "user": "https://github.com/elarson314"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_232226.json:
```json
{
    "body": "<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T16:36:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232226",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:4'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232227.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T16:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232227",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232228.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T16:59:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232228",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232229.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T17:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232229",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232230.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T17:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232230",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232231.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T17:55:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232231",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232232.json:
```json
{
    "body": "<a id='comment:10'></a>OK -- branch now works, I successfully merged it into my own working branch for #16743 (which does not yet use this new code).",
    "created_at": "2014-08-13T19:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232232",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:10'></a>OK -- branch now works, I successfully merged it into my own working branch for #16743 (which does not yet use this new code).



---

archive/issue_comments_232233.json:
```json
{
    "body": "<a id='comment:11'></a>I made some rather superficial changes to the new function and added a couple more examples.  The changes simlify the code while retaining exactly the same logic.   I had to rename the branch on trac (it is now u/cremona/ticket/16806) as that's the way it has to be (I cannot edit a u/elarson3 branch).\n\nMy edits were superficial, otherwise I give the original new code a positive review.  That means that if you are happy with my additional changes we can jointly give it a positive review.  Before that I'll merge in the current develop branch and re-upload, but the changes I made should all be visible already in the commit 828ed6f.\n\n---\nNew commits:",
    "created_at": "2014-08-27T12:22:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232233",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:11'></a>I made some rather superficial changes to the new function and added a couple more examples.  The changes simlify the code while retaining exactly the same logic.   I had to rename the branch on trac (it is now u/cremona/ticket/16806) as that's the way it has to be (I cannot edit a u/elarson3 branch).

My edits were superficial, otherwise I give the original new code a positive review.  That means that if you are happy with my additional changes we can jointly give it a positive review.  Before that I'll merge in the current develop branch and re-upload, but the changes I made should all be visible already in the commit 828ed6f.

---
New commits:



---

archive/issue_comments_232234.json:
```json
{
    "body": "<a id='comment:12'></a>Forget the last part of my previous comment:  I had already done the merge, as you can see from the list of new commits (first the merge, then my reviewer's patch).  So this is ready for re-review by the original author!\n\nI have now made #16743 dependent on this (isogeny classes of elliptic curves over number fields), which means that I am keener than ever to get this merged.",
    "created_at": "2014-08-27T12:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232234",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:12'></a>Forget the last part of my previous comment:  I had already done the merge, as you can see from the list of new commits (first the merge, then my reviewer's patch).  So this is ready for re-review by the original author!

I have now made #16743 dependent on this (isogeny classes of elliptic curves over number fields), which means that I am keener than ever to get this merged.



---

archive/issue_comments_232235.json:
```json
{
    "body": "<a id='comment:14'></a>A few comments:\n* The docstring of the main function reads \"\"Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel.\"\" Isn't it the complement, i.e., all those that \"may be contained in a Borel\" ?\n\n* I thought  \"try: ...  except `ValueError`: return [0]\"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.\n\n* It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.",
    "created_at": "2014-09-16T14:01:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232235",
    "user": "https://github.com/categorie"
}
```

<a id='comment:14'></a>A few comments:
* The docstring of the main function reads ""Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel."" Isn't it the complement, i.e., all those that "may be contained in a Borel" ?

* I thought  "try: ...  except `ValueError`: return [0]"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.

* It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.



---

archive/issue_comments_232236.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 wuthrich]:\n> A few comments:\n> * The docstring of the main function reads \"\"Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel.\"\" Isn't it the complement, i.e., all those that \"may be contained in a Borel\" ?\n> \n\n\nYou are right.\n\n> * I thought  \"try: ...  except `ValueError`: return [0]\"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.\n\n\nI'm to blame for the long line -- the original version had this split over many lines.   The set we return is the union of (1) primes of additive reduction (found as factors of gcd(c4,Delta) in effect; (2) primes ramified in the field; (3) the ones returned by _semistable_reducible_primes.  The latter function uses [0] to denote CM.  So I cannot see what circumstances will lead to a ValueError, and suggest we can simplify this.\n\n> \n> * It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.\n\n\nAgreed.  I said so myself somewhere.\n\nI will revise the branch to take into account your first two points...",
    "created_at": "2014-09-16T14:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232236",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:15'></a>Replying to [comment:14 wuthrich]:
> A few comments:
> * The docstring of the main function reads ""Returns a list of primes `p` including all primes for which the mod-`p` representation might not be contained in a Borel."" Isn't it the complement, i.e., all those that "may be contained in a Borel" ?
> 


You are right.

> * I thought  "try: ...  except `ValueError`: return [0]"  is not what we should do. If the long and convoluted line in try produces a `ValueError`, that could have many reasons, and we should not just ignore this and send back [0] but pass the error on.


I'm to blame for the long line -- the original version had this split over many lines.   The set we return is the union of (1) primes of additive reduction (found as factors of gcd(c4,Delta) in effect; (2) primes ramified in the field; (3) the ones returned by _semistable_reducible_primes.  The latter function uses [0] to denote CM.  So I cannot see what circumstances will lead to a ValueError, and suggest we can simplify this.

> 
> * It is a shame that this function will not be available for curves over Q. But I guess it should be a separate ticket to merge the two classes dealing with Galois Reps together at some point.


Agreed.  I said so myself somewhere.

I will revise the branch to take into account your first two points...



---

archive/issue_comments_232237.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-17T10:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232238.json:
```json
{
    "body": "<a id='comment:17'></a>I made cosmetic changes in line with Chris's comments:  various tidying of docstrings (including fixing that double negative) and simplifying (making clearer I hope) the two long lines where various sets of primes are collected.  It turned out that a try/except is needed since the function _semistable_reducible_primes() does raise a ValueError if given a CM curve.\n\nReady for a new review!",
    "created_at": "2014-09-17T10:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232238",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:17'></a>I made cosmetic changes in line with Chris's comments:  various tidying of docstrings (including fixing that double negative) and simplifying (making clearer I hope) the two long lines where various sets of primes are collected.  It turned out that a try/except is needed since the function _semistable_reducible_primes() does raise a ValueError if given a CM curve.

Ready for a new review!



---

archive/issue_comments_232239.json:
```json
{
    "body": "<a id='comment:18'></a>Am I right that the file does not appear in the reference manual ?\n\nI added this and modified the starting docstring so that the reference manual builds. \n\nStarting testing now. Except a positive review soon. \n\n---\nNew commits:",
    "created_at": "2014-09-17T11:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232239",
    "user": "https://github.com/categorie"
}
```

<a id='comment:18'></a>Am I right that the file does not appear in the reference manual ?

I added this and modified the starting docstring so that the reference manual builds. 

Starting testing now. Except a positive review soon. 

---
New commits:



---

archive/issue_comments_232240.json:
```json
{
    "body": "<a id='comment:19'></a>Thanks.  I seem to have forgotten to check that building the docs worked, but that would have been null anyway until you added it to the manual.  Good!",
    "created_at": "2014-09-17T12:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232240",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:19'></a>Thanks.  I seem to have forgotten to check that building the docs worked, but that would have been null anyway until you added it to the manual.  Good!



---

archive/issue_comments_232241.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-17T14:43:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232241",
    "user": "https://github.com/categorie"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_232242.json:
```json
{
    "body": "<a id='comment:21'></a>Thanks!",
    "created_at": "2014-09-17T14:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232242",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:21'></a>Thanks!



---

archive/issue_events_049188.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-24T11:23:41Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "milestone": "sage-feature",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16806#event-49188"
}
```



---

archive/issue_events_049189.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-09-24T11:23:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16806#event-49189"
}
```



---

archive/issue_comments_232243.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-25T12:05:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16806#issuecomment-232243",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_049190.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-25T12:05:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16806",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16806#event-49190"
}
```
