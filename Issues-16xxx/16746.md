# Issue 16746: Use the Sage displayhook in doctests

archive/issues_016509.json:
```json
{
    "body": "The doctests output should look like the Sage commandline output, which it currently does not quite. Differences include:\n* Dictionaries will be sorted by key, makes output more reproducable\n* Sets are printed as `{1,2}` instead of `set([1,2])`\n* Empty set is `set()` instead of `set([])`\n* Types are `<Foo at 0x...>` instead of `<Foo object at 0x...>`\n\nOther changes:\n* Normal tracebacks can now be distinguished from tracebacks in `__repr__` (IPython extension):\n\n```\nsage: f(*args)\n<repr(<sage.interfaces.gap.GapElement at 0x...>) failed: ValueError: The session in which this object was defined is no longer running.>\n```\n* Plots now print themselves in doctest mode:\n\n```\nsage: A.plot()\nGraphics object consisting of 1 graphics primitive\n```\n\nCC:  @dkrenn\n\nBranch/Commit: 3070715a7f656326260a9ef6635884e69fa0136f\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Volker Braun\n\nDependencies: #16992\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16746\n\n",
    "closed_at": "2014-09-27T12:56:54Z",
    "created_at": "2014-07-31T15:35:58Z",
    "labels": [
        "component: doctest framework",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Use the Sage displayhook in doctests",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16746",
    "user": "https://github.com/vbraun"
}
```
The doctests output should look like the Sage commandline output, which it currently does not quite. Differences include:
* Dictionaries will be sorted by key, makes output more reproducable
* Sets are printed as `{1,2}` instead of `set([1,2])`
* Empty set is `set()` instead of `set([])`
* Types are `<Foo at 0x...>` instead of `<Foo object at 0x...>`

Other changes:
* Normal tracebacks can now be distinguished from tracebacks in `__repr__` (IPython extension):

```
sage: f(*args)
<repr(<sage.interfaces.gap.GapElement at 0x...>) failed: ValueError: The session in which this object was defined is no longer running.>
```
* Plots now print themselves in doctest mode:

```
sage: A.plot()
Graphics object consisting of 1 graphics primitive
```

CC:  @dkrenn

Branch/Commit: 3070715a7f656326260a9ef6635884e69fa0136f

Reviewer: Fran√ßois Bissey

Author: Volker Braun

Dependencies: #16992

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16746





---

archive/issue_comments_231254.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to doctest framework.",
    "created_at": "2014-07-31T16:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231254",
    "user": "https://github.com/vbraun"
}
```

Changing component from PLEASE CHANGE to doctest framework.



---

archive/issue_comments_231255.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2014-07-31T16:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231255",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_231256.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2014-07-31T16:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231256",
    "user": "https://github.com/vbraun"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_231257.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,7 @@\n-\n+The doctests output should look like the Sage commandline output, which it currently does not. Differences include:\n+* Dictionaries will be sorted by key, makes output more reproducable\n+* Sets are printed as \\`{1,2}\\` instead of \\`set([1,2])\\`\n+* Types are \\`<Foo at 0x...>\\` instead of \\`<Foo object at 0x...>\\`\n \n Comment: 1\n \n```\n",
    "created_at": "2014-07-31T16:17:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231257",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,7 @@
-
+The doctests output should look like the Sage commandline output, which it currently does not. Differences include:
+* Dictionaries will be sorted by key, makes output more reproducable
+* Sets are printed as \`{1,2}\` instead of \`set([1,2])\`
+* Types are \`<Foo at 0x...>\` instead of \`<Foo object at 0x...>\`
 
 Comment: 1
 
```




---

archive/issue_comments_231258.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n-\n+The doctests output should look like the Sage commandline output, which it currently does not quite. Differences include:\n+* Dictionaries will be sorted by key, makes output more reproducable\n+* Sets are printed as \\`{1,2}\\` instead of \\`set([1,2])\\`\n+* Empty set is \\`set()\\` instead of \\`set([])\\`\n+* Types are \\`<Foo at 0x...>\\` instead of \\`<Foo object at 0x...>\\`\n \n Comment: 1\n \n```\n",
    "created_at": "2014-07-31T16:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231258",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,8 @@
-
+The doctests output should look like the Sage commandline output, which it currently does not quite. Differences include:
+* Dictionaries will be sorted by key, makes output more reproducable
+* Sets are printed as \`{1,2}\` instead of \`set([1,2])\`
+* Empty set is \`set()\` instead of \`set([])\`
+* Types are \`<Foo at 0x...>\` instead of \`<Foo object at 0x...>\`
 
 Comment: 1
 
```




---

archive/issue_comments_231259.json:
```json
{
    "body": "<a id='comment:5'></a>The first commit changes the doctest displayhook to the one we want. This causes various doctest changes that need to be fixed.",
    "created_at": "2014-07-31T16:18:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231259",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>The first commit changes the doctest displayhook to the one we want. This causes various doctest changes that need to be fixed.



---

archive/issue_events_049050.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16746#event-49050"
}
```



---

archive/issue_comments_231260.json:
```json
{
    "body": "<a id='comment:8'></a>I noticed that the fix for printing types \"our way\" (#14466) was incomplete, inside lists it still uses IPython style:\n\n```\nsage: type(1)\n<type 'sage.rings.integer.Integer'>\nsage: [type(1)]\n[sage.rings.integer.Integer]\n```",
    "created_at": "2014-09-17T10:57:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231260",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>I noticed that the fix for printing types "our way" (#14466) was incomplete, inside lists it still uses IPython style:

```
sage: type(1)
<type 'sage.rings.integer.Integer'>
sage: [type(1)]
[sage.rings.integer.Integer]
```



---

archive/issue_comments_231261.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-17T23:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231261",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_231262.json:
```json
{
    "body": "<a id='comment:11'></a>I've refactored our displayhook machinery so we can pick & choose which parts we want to take from IPython. Now works ok, still have to fixup old doctests.",
    "created_at": "2014-09-18T00:14:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231262",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>I've refactored our displayhook machinery so we can pick & choose which parts we want to take from IPython. Now works ok, still have to fixup old doctests.



---

archive/issue_comments_231263.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-09-18T18:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231263",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_231264.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-18T18:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231264",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_231265.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,22 @@\n+The doctests output should look like the Sage commandline output, which it currently does not quite. Differences include:\n+* Dictionaries will be sorted by key, makes output more reproducable\n+* Sets are printed as \\`{1,2}\\` instead of \\`set([1,2])\\`\n+* Empty set is \\`set()\\` instead of \\`set([])\\`\n+* Types are \\`<Foo at 0x...>\\` instead of \\`<Foo object at 0x...>\\`\n \n+Other changes:\n+* Normal tracebacks can now be distinguished from tracebacks in \\`__repr__\\` (IPython extension):\n+\n+\\`\\`\\`\n+sage: f(*args)\n+<repr(<sage.interfaces.gap.GapElement at 0x...>) failed: ValueError: The session in which this object was defined is no longer running.>\n+\\`\\`\\`\n+* Plots now print themselves in doctest mode:\n+\n+\\`\\`\\`\n+sage: A.plot()\n+Graphics object consisting of 1 graphics primitive\n+\\`\\`\\`\n \n Comment: 1\n \n```\n",
    "created_at": "2014-09-18T18:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231265",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,22 @@
+The doctests output should look like the Sage commandline output, which it currently does not quite. Differences include:
+* Dictionaries will be sorted by key, makes output more reproducable
+* Sets are printed as \`{1,2}\` instead of \`set([1,2])\`
+* Empty set is \`set()\` instead of \`set([])\`
+* Types are \`<Foo at 0x...>\` instead of \`<Foo object at 0x...>\`
 
+Other changes:
+* Normal tracebacks can now be distinguished from tracebacks in \`__repr__\` (IPython extension):
+
+\`\`\`
+sage: f(*args)
+<repr(<sage.interfaces.gap.GapElement at 0x...>) failed: ValueError: The session in which this object was defined is no longer running.>
+\`\`\`
+* Plots now print themselves in doctest mode:
+
+\`\`\`
+sage: A.plot()
+Graphics object consisting of 1 graphics primitive
+\`\`\`
 
 Comment: 1
 
```




---

archive/issue_comments_231266.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2014-09-18T18:27:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231266",
    "user": "https://github.com/vbraun"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_231267.json:
```json
{
    "body": "<a id='comment:15'></a>Wow, that is a massive set of changes... just out of curiosity, what does the documentation now look like for graphics?  I don't know whether it is more obvious before or after this change that one needs to evaluate to get them.  One reason for the spaces before (I mean the ones after plot doctests) was to \"leave room\" in the (live) doc for evaluating these.",
    "created_at": "2014-09-18T18:49:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231267",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>Wow, that is a massive set of changes... just out of curiosity, what does the documentation now look like for graphics?  I don't know whether it is more obvious before or after this change that one needs to evaluate to get them.  One reason for the spaces before (I mean the ones after plot doctests) was to "leave room" in the (live) doc for evaluating these.



---

archive/issue_comments_231268.json:
```json
{
    "body": "<a id='comment:16'></a>I see why you needed #16992 now...",
    "created_at": "2014-09-18T19:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231268",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>I see why you needed #16992 now...



---

archive/issue_comments_231269.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-18T19:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231269",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_231270.json:
```json
{
    "body": "<a id='comment:17'></a>In `src/sage/graphs/generic_graph.py`, this was probably intended as a doctest (although certainly something went wrong around those lines):\n\n```\nsage: g.layout(layout=\"acyclic_dummy\", save_po=True)\n{('0', 0): [0.3356712660780875, 0],\n ('0', 1): [0.33563875939602245, 1],\n ('1', 0): [0.6751346747788185, 0],\n ('1', 1): [0.6715689173983604, 1]}\n```",
    "created_at": "2014-09-18T19:45:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231270",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>In `src/sage/graphs/generic_graph.py`, this was probably intended as a doctest (although certainly something went wrong around those lines):

```
sage: g.layout(layout="acyclic_dummy", save_po=True)
{('0', 0): [0.3356712660780875, 0],
 ('0', 1): [0.33563875939602245, 1],
 ('1', 0): [0.6751346747788185, 0],
 ('1', 1): [0.6715689173983604, 1]}
```



---

archive/issue_comments_231271.json:
```json
{
    "body": "<a id='comment:18'></a>Honestly, I don't know what the `g.layout(layout=\"acyclic_dummy\", save_po=True)` is supposed to do. I took out the `1+1 == 2` but kept the layout call since the latter changes the rng (so without it all following doctests change).",
    "created_at": "2014-09-18T19:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231271",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>Honestly, I don't know what the `g.layout(layout="acyclic_dummy", save_po=True)` is supposed to do. I took out the `1+1 == 2` but kept the layout call since the latter changes the rng (so without it all following doctests change).



---

archive/issue_comments_231272.json:
```json
{
    "body": "<a id='comment:19'></a>There is a problem with graphics objects: they used to be actually \"plotted\" by doctests to some random file, now this gone. To easily check this, execute\n\n```\n$ chmod 0000 local/bin/tachyon\n$ ./sage -t src/sage/plot/circle.py\n```\n\nWithout this patch, this breaks 4 doctests. With this patch, this only breaks 1 doctest (where an explicit `.show()` was given), meaning there are now 3 plots no longer tested.",
    "created_at": "2014-09-18T20:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231272",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>There is a problem with graphics objects: they used to be actually "plotted" by doctests to some random file, now this gone. To easily check this, execute

```
$ chmod 0000 local/bin/tachyon
$ ./sage -t src/sage/plot/circle.py
```

Without this patch, this breaks 4 doctests. With this patch, this only breaks 1 doctest (where an explicit `.show()` was given), meaning there are now 3 plots no longer tested.



---

archive/issue_comments_231273.json:
```json
{
    "body": "<a id='comment:20'></a>Replying to [comment:18 vbraun]:\n> Honestly, I don't know what the `g.layout(layout=\"acyclic_dummy\", save_po=True)` is supposed to do. I took out the `1+1 == 2` but kept the layout call since the latter changes the rng (so without it all following doctests change). \n\nI didn't mean to remove the call, just to show the output, i.e. remove the `x =`.",
    "created_at": "2014-09-18T20:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231273",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>Replying to [comment:18 vbraun]:
> Honestly, I don't know what the `g.layout(layout="acyclic_dummy", save_po=True)` is supposed to do. I took out the `1+1 == 2` but kept the layout call since the latter changes the rng (so without it all following doctests change). 

I didn't mean to remove the call, just to show the output, i.e. remove the `x =`.



---

archive/issue_comments_231274.json:
```json
{
    "body": "<a id='comment:21'></a>Apart from the issues in the last comments, the changes to the doctests look okay. I haven't looked at the new displayhook code though.\n\nWhat does \"repl\" stand for by the way? Perhaps a one-paragraph explanation in `src/sage/repl/all.py` would be good.",
    "created_at": "2014-09-18T20:17:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231274",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Apart from the issues in the last comments, the changes to the doctests look okay. I haven't looked at the new displayhook code though.

What does "repl" stand for by the way? Perhaps a one-paragraph explanation in `src/sage/repl/all.py` would be good.



---

archive/issue_comments_231275.json:
```json
{
    "body": "<a id='comment:22'></a>Read-Eval-Print-Loop.\n\nI'll also call show() on  graphics in the doctest displayhook...",
    "created_at": "2014-09-18T20:38:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231275",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:22'></a>Read-Eval-Print-Loop.

I'll also call show() on  graphics in the doctest displayhook...



---

archive/issue_comments_231276.json:
```json
{
    "body": "<a id='comment:23'></a>`make ptestlong` on my linux mint 64 bit desktop gave a few failing doctests, mostly because sorting of integers and strings is more or less random.\n\n```\nsage -t --long src/doc/de/tutorial/programming.rst\n**********************************************************************\nFile \"src/doc/de/tutorial/programming.rst\", line 503, in doc.de.tutorial.programming\nFailed example:\n    X\nExpected:\n    {1, 19, 'a'}\nGot:\n    {'a', 1, 19}\n**********************************************************************\n1 item had failures:\n   1 of 143 in doc.de.tutorial.programming\n    [113 tests, 1 failure, 1.61 s]\nsage -t --long src/doc/en/tutorial/programming.rst\n**********************************************************************\nFile \"src/doc/en/tutorial/programming.rst\", line 485, in doc.en.tutorial.programming\nFailed example:\n    X\nExpected:\n    {1, 19, 'a'}\nGot:\n    {'a', 1, 19}\n**********************************************************************\n1 item had failures:\n   1 of 144 in doc.en.tutorial.programming\n    [114 tests, 1 failure, 0.17 s]\nsage -t --long src/doc/en/thematic_tutorials/tutorial-programming-python.rst\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/tutorial-programming-python.rst\", line 707, in doc.en.thematic_tutorials.tutorial-programming-python\nFailed example:\n    d\nExpected:\n    {3/2: 17, 3: 17, 'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo'}\nGot:\n    {'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo', 3/2: 17, 3: 17}\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/tutorial-programming-python.rst\", line 734, in doc.en.thematic_tutorials.tutorial-programming-python\nFailed example:\n    d\nExpected:\n    {3/2: 17, 3: 17, 10: 'a', 'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo'}\nGot:\n    {'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo', 3/2: 17, 3: 17, 10: 'a'}\n**********************************************************************\nFile \"src/doc/en/thematic_tutorials/tutorial-programming-python.rst\", line 767, in doc.en.thematic_tutorials.tutorial-programming-python\nFailed example:\n    d\nExpected:\n    {3: 14, 10: 'newvalue', 20: 'newervalue', 'a': [1, 2, 3]}\nGot:\n    {'a': [1, 2, 3], 3: 14, 10: 'newvalue', 20: 'newervalue'}\n**********************************************************************\n1 item had failures:\n   3 of 159 in doc.en.thematic_tutorials.tutorial-programming-python\n    [158 tests, 3 failures, 0.16 s]\nsage -t --long src/doc/fr/tutorial/programming.rst\n**********************************************************************\nFile \"src/doc/fr/tutorial/programming.rst\", line 501, in doc.fr.tutorial.programming\nFailed example:\n    X\nExpected:\n    {1, 19, 'a'}\nGot:\n    {'a', 1, 19}\n**********************************************************************\n1 item had failures:\n   1 of 143 in doc.fr.tutorial.programming\n    [113 tests, 1 failure, 0.17 s]\nsage -t --long src/doc/ru/tutorial/programming.rst\n**********************************************************************\nFile \"src/doc/ru/tutorial/programming.rst\", line 469, in doc.ru.tutorial.programming\nFailed example:\n    X\nExpected:\n    {1, 19, 'a'}\nGot:\n    {'a', 1, 19}\n**********************************************************************\n1 item had failures:\n   1 of 143 in doc.ru.tutorial.programming\n    [113 tests, 1 failure, 0.17 s]\nsage -t --long local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/notebook/worksheet.py\n**********************************************************************\nFile \"local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/notebook/worksheet.py\", line 4063, in sagenb.notebook.worksheet.Worksheet.delete_all_output\nFailed example:\n    W.cell_list()\nExpected:\n    [Cell 0: in=2+3, out=\n    5, Cell 1: in=open('afile', 'w').write('some text')\n    print 'hello', out=\n    ]\nGot:\n    [Cell 0: in=2+3, out=\n     5, Cell 1: in=open('afile', 'w').write('some text')\n     print 'hello', out=]\n**********************************************************************\n1 item had failures:\n   1 of  21 in sagenb.notebook.worksheet.Worksheet.delete_all_output\n    [530 tests, 1 failure, 13.40 s]\n```",
    "created_at": "2014-09-19T05:40:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231276",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:23'></a>`make ptestlong` on my linux mint 64 bit desktop gave a few failing doctests, mostly because sorting of integers and strings is more or less random.

```
sage -t --long src/doc/de/tutorial/programming.rst
**********************************************************************
File "src/doc/de/tutorial/programming.rst", line 503, in doc.de.tutorial.programming
Failed example:
    X
Expected:
    {1, 19, 'a'}
Got:
    {'a', 1, 19}
**********************************************************************
1 item had failures:
   1 of 143 in doc.de.tutorial.programming
    [113 tests, 1 failure, 1.61 s]
sage -t --long src/doc/en/tutorial/programming.rst
**********************************************************************
File "src/doc/en/tutorial/programming.rst", line 485, in doc.en.tutorial.programming
Failed example:
    X
Expected:
    {1, 19, 'a'}
Got:
    {'a', 1, 19}
**********************************************************************
1 item had failures:
   1 of 144 in doc.en.tutorial.programming
    [114 tests, 1 failure, 0.17 s]
sage -t --long src/doc/en/thematic_tutorials/tutorial-programming-python.rst
**********************************************************************
File "src/doc/en/thematic_tutorials/tutorial-programming-python.rst", line 707, in doc.en.thematic_tutorials.tutorial-programming-python
Failed example:
    d
Expected:
    {3/2: 17, 3: 17, 'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo'}
Got:
    {'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo', 3/2: 17, 3: 17}
**********************************************************************
File "src/doc/en/thematic_tutorials/tutorial-programming-python.rst", line 734, in doc.en.thematic_tutorials.tutorial-programming-python
Failed example:
    d
Expected:
    {3/2: 17, 3: 17, 10: 'a', 'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo'}
Got:
    {'key': [4, 1, 5, 2, 3], (3, 1, 2): 'goo', 3/2: 17, 3: 17, 10: 'a'}
**********************************************************************
File "src/doc/en/thematic_tutorials/tutorial-programming-python.rst", line 767, in doc.en.thematic_tutorials.tutorial-programming-python
Failed example:
    d
Expected:
    {3: 14, 10: 'newvalue', 20: 'newervalue', 'a': [1, 2, 3]}
Got:
    {'a': [1, 2, 3], 3: 14, 10: 'newvalue', 20: 'newervalue'}
**********************************************************************
1 item had failures:
   3 of 159 in doc.en.thematic_tutorials.tutorial-programming-python
    [158 tests, 3 failures, 0.16 s]
sage -t --long src/doc/fr/tutorial/programming.rst
**********************************************************************
File "src/doc/fr/tutorial/programming.rst", line 501, in doc.fr.tutorial.programming
Failed example:
    X
Expected:
    {1, 19, 'a'}
Got:
    {'a', 1, 19}
**********************************************************************
1 item had failures:
   1 of 143 in doc.fr.tutorial.programming
    [113 tests, 1 failure, 0.17 s]
sage -t --long src/doc/ru/tutorial/programming.rst
**********************************************************************
File "src/doc/ru/tutorial/programming.rst", line 469, in doc.ru.tutorial.programming
Failed example:
    X
Expected:
    {1, 19, 'a'}
Got:
    {'a', 1, 19}
**********************************************************************
1 item had failures:
   1 of 143 in doc.ru.tutorial.programming
    [113 tests, 1 failure, 0.17 s]
sage -t --long local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/notebook/worksheet.py
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb-0.10.8.2-py2.7.egg/sagenb/notebook/worksheet.py", line 4063, in sagenb.notebook.worksheet.Worksheet.delete_all_output
Failed example:
    W.cell_list()
Expected:
    [Cell 0: in=2+3, out=
    5, Cell 1: in=open('afile', 'w').write('some text')
    print 'hello', out=
    ]
Got:
    [Cell 0: in=2+3, out=
     5, Cell 1: in=open('afile', 'w').write('some text')
     print 'hello', out=]
**********************************************************************
1 item had failures:
   1 of  21 in sagenb.notebook.worksheet.Worksheet.delete_all_output
    [530 tests, 1 failure, 13.40 s]
```



---

archive/issue_comments_231277.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-19T14:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231277",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_231278.json:
```json
{
    "body": "<a id='comment:25'></a>I've addressed all issues so far and added more documentation (which also spells out REPL).",
    "created_at": "2014-09-19T14:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231278",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'></a>I've addressed all issues so far and added more documentation (which also spells out REPL).



---

archive/issue_comments_231279.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-19T14:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231279",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_231280.json:
```json
{
    "body": "<a id='comment:26'></a>Found some more random failures. Also, missed the `W.cell_list()` failure above which is caused by not preserving a trailing newline (IPython does that, too). Fix coming shortly...",
    "created_at": "2014-09-19T18:38:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231280",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'></a>Found some more random failures. Also, missed the `W.cell_list()` failure above which is caused by not preserving a trailing newline (IPython does that, too). Fix coming shortly...



---

archive/issue_comments_231281.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-19T19:01:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231281",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_231282.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-19T21:58:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231282",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_231283.json:
```json
{
    "body": "<a id='comment:29'></a>Now, all doctests pass on my linux mint 64 bit desktop.",
    "created_at": "2014-09-20T07:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231283",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:29'></a>Now, all doctests pass on my linux mint 64 bit desktop.



---

archive/issue_comments_231284.json:
```json
{
    "body": "<a id='comment:30'></a>All doctest pass on the buildbot...",
    "created_at": "2014-09-20T22:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231284",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:30'></a>All doctest pass on the buildbot...



---

archive/issue_comments_231285.json:
```json
{
    "body": "<a id='comment:31'></a>Did you try this on ARM?",
    "created_at": "2014-09-26T09:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231285",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:31'></a>Did you try this on ARM?



---

archive/issue_comments_231286.json:
```json
{
    "body": "<a id='comment:32'></a>ARM is part of the buildbot now, so yes ;-)",
    "created_at": "2014-09-26T09:37:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231286",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:32'></a>ARM is part of the buildbot now, so yes ;-)



---

archive/issue_comments_231287.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-26T09:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231287",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_231288.json:
```json
{
    "body": "<a id='comment:33'></a>Since it pass on the build bot and I don;t see any obvious problem with the new code itself I will give it a positive review. I expect ARM to be irrelevant in this context as we are only talking about re-formatting current doctests.\nPlus it will fix broken doctests in sage-on-gentoo (dictionaries displayed in a different order).",
    "created_at": "2014-09-26T09:39:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231288",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:33'></a>Since it pass on the build bot and I don;t see any obvious problem with the new code itself I will give it a positive review. I expect ARM to be irrelevant in this context as we are only talking about re-formatting current doctests.
Plus it will fix broken doctests in sage-on-gentoo (dictionaries displayed in a different order).



---

archive/issue_comments_231289.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-09-26T17:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231289",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_231290.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2014-09-26T17:41:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231290",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_231291.json:
```json
{
    "body": "<a id='comment:36'></a>surprisingly only one merge conflict ;-)",
    "created_at": "2014-09-26T17:45:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231291",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:36'></a>surprisingly only one merge conflict ;-)



---

archive/issue_comments_231292.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-26T17:45:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231292",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_231293.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2014-09-27T00:05:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231293",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_231294.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2014-09-27T00:05:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231294",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_231295.json:
```json
{
    "body": "<a id='comment:38'></a>At this stage I think you have done all the work that should be done in one ticket. I suggest we have a follow up ticket for any new discoveries.",
    "created_at": "2014-09-27T00:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231295",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:38'></a>At this stage I think you have done all the work that should be done in one ticket. I suggest we have a follow up ticket for any new discoveries.



---

archive/issue_comments_231296.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-27T07:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231296",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_049051.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-27T12:56:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16746#event-49051"
}
```



---

archive/issue_comments_231297.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-27T12:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16746",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16746#issuecomment-231297",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
