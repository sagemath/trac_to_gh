# Issue 16456: Bug in descend_to method for elliptic curves

archive/issues_016219.json:
```json
{
    "assignees": [
        "https://github.com/JohnCremona"
    ],
    "body": "The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some \"positive\" results are missed.  Here is an example of this. \n\n```\nsage: K.<a> = NumberField(x^3-2)\nsage: E = EllipticCurve('11a1').quadratic_twist(2)\nsage: EK = E.change_ring(K)\nsage: EK2 = EK.change_weierstrass_model((a,a,a,a+1))\nsage: EK2.descend_to(QQ)\n<None>\n```\nThe heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)\n\nI can fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.\n\nA second and independent bug is reported by Warren Moore:\n\n```\nsage: k.<i> = QuadraticField(-1)\nsage: E = EllipticCurve(k,[0,0,0,1,0])\nsage: E.descend_to(QQ) == None\nTrue\n```\nThis caused by a \"naked Except\" clause plus a call to f.preimage() for a map f which has no attribute/method \"preimage\".\n\nDepends on #16708\n\nKeywords: **elliptic curve base change**\n\nBranch/Commit: **[`e0a13b3`](https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355)**\n\nReviewer: **Peter Bruin**\n\nAuthor: **John Cremona**\n\nComponent: **elliptic curves**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16456_\n\n",
    "closed_at": "2014-07-25T05:05:41Z",
    "created_at": "2014-06-07T17:06:54Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Bug in descend_to method for elliptic curves",
    "type": "issue",
    "updated_at": "2019-12-17T09:08:18Z",
    "url": "https://github.com/sagemath/sage/issues/16456",
    "user": "https://github.com/JohnCremona"
}
```
The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some "positive" results are missed.  Here is an example of this. 

```
sage: K.<a> = NumberField(x^3-2)
sage: E = EllipticCurve('11a1').quadratic_twist(2)
sage: EK = E.change_ring(K)
sage: EK2 = EK.change_weierstrass_model((a,a,a,a+1))
sage: EK2.descend_to(QQ)
<None>
```
The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)

I can fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.

A second and independent bug is reported by Warren Moore:

```
sage: k.<i> = QuadraticField(-1)
sage: E = EllipticCurve(k,[0,0,0,1,0])
sage: E.descend_to(QQ) == None
True
```
This caused by a "naked Except" clause plus a call to f.preimage() for a map f which has no attribute/method "preimage".

Depends on #16708

Keywords: **elliptic curve base change**

Branch/Commit: **[`e0a13b3`](https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355)**

Reviewer: **Peter Bruin**

Author: **John Cremona**

Component: **elliptic curves**

_Issue created by migration from https://trac.sagemath.org/ticket/16456_





---

archive/issue_events_235030.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-06-07T17:06:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235030"
}
```



---

archive/issue_events_235031.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-06-07T17:06:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235031"
}
```



---

archive/issue_events_235032.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-06-07T17:06:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235032"
}
```



---

archive/issue_events_235033.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-06-07T17:06:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235033"
}
```



---

archive/issue_comments_212823.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n-The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo (L*)^2 and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some \"positive\" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in L*/(L*)^2 is in the image of K*/(K*)^2 or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replced by 6th or 4th powers respectively.)\n+The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some \"positive\" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)\n+\n \n I can see how to fix this for number fields (one can restrict from K*/(K*)^2 to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.\n+\n+A second and independent bug is reported by Warren Moore:\n+\n+```\n+sage: k.<i> = QuadraticField(-1)\n+sage: E = EllipticCurve(k,[0,0,0,1,0])\n+sage: E.descend_to(QQ) == None\n+True\n+```\n+This caused by a \"naked Except\" clause plus a call to f.preimage() for a map f which has no attribute/method \"preimage\".\n``````\n",
    "created_at": "2014-06-07T18:51:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212823",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
-The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo (L*)^2 and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some "positive" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in L*/(L*)^2 is in the image of K*/(K*)^2 or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replced by 6th or 4th powers respectively.)
+The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some "positive" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)
+
 
 I can see how to fix this for number fields (one can restrict from K*/(K*)^2 to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.
+
+A second and independent bug is reported by Warren Moore:
+
+```
+sage: k.<i> = QuadraticField(-1)
+sage: E = EllipticCurve(k,[0,0,0,1,0])
+sage: E.descend_to(QQ) == None
+True
+```
+This caused by a "naked Except" clause plus a call to f.preimage() for a map f which has no attribute/method "preimage".
``````




---

archive/issue_events_235034.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-06-07T18:51:45Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "subject": "https://github.com/JohnCremona",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235034"
}
```



---

archive/issue_comments_212824.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,7 @@\n The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some \"positive\" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)\n \n \n-I can see how to fix this for number fields (one can restrict from K*/(K*)^2 to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.\n+I can see how to fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.\n \n A second and independent bug is reported by Warren Moore:\n \n``````\n",
    "created_at": "2014-06-07T18:52:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212824",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,7 @@
 The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some "positive" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)
 
 
-I can see how to fix this for number fields (one can restrict from K*/(K*)^2 to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.
+I can see how to fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.
 
 A second and independent bug is reported by Warren Moore:
 
``````




---

archive/issue_comments_212825.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,16 @@\n-The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some \"positive\" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)\n+The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some \"positive\" results are missed.  Here is an example of this. \n \n+```\n+sage: K.<a> = NumberField(x^3-2)\n+sage: E = EllipticCurve('11a1').quadratic_twist(2)\n+sage: EK = E.change_ring(K)\n+sage: EK2 = EK.change_weierstrass_model((a,a,a,a+1))\n+sage: EK2.descend_to(QQ)\n+<None>\n+```\n+The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)\n \n-I can see how to fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.\n+I can fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.\n \n A second and independent bug is reported by Warren Moore:\n \n``````\n",
    "created_at": "2014-06-12T11:47:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212825",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,16 @@
-The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some "positive" results are missed.  I will post an example of this.  The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)
+The function descend_to which was implemented in #9384 is incorrect.  The twisting parameter d in L* is only defined modulo `(L*)^2` and one has to determine whether there is a representative which lies in K*, which the implementation does not do, so some "positive" results are missed.  Here is an example of this. 
 
+```
+sage: K.<a> = NumberField(x^3-2)
+sage: E = EllipticCurve('11a1').quadratic_twist(2)
+sage: EK = E.change_ring(K)
+sage: EK2 = EK.change_weierstrass_model((a,a,a,a+1))
+sage: EK2.descend_to(QQ)
+<None>
+```
+The heart of the problem being solved here is to determine whether (given that j(E) is in K of course) the twisting parameter in `L*/(L*)^2` is in the image of `K*/(K*)^2` or not, and the implementation ignores this.  (For j=0 or 1728 the principle is the same with squares replaced by 6th or 4th powers respectively.)
 
-I can see how to fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.
+I can fix this for number fields (one can restrict from `K*/(K*)^2` to a finite K(S,2) for an easily determined set S of primes) or for finite fields, but it may not be possible to have this implemented for arbitrary fields, which will cause a problem with the patching.
 
 A second and independent bug is reported by Warren Moore:
 
``````




---

archive/issue_comments_212826.json:
```json
{
    "body": "Branch: **[u/cremona/bug_in_descend_to_method_for_elliptic_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/bug_in_descend_to_method_for_elliptic_curves)**",
    "created_at": "2014-06-13T13:54:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212826",
    "user": "https://github.com/JohnCremona"
}
```

Branch: **[u/cremona/bug_in_descend_to_method_for_elliptic_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/bug_in_descend_to_method_for_elliptic_curves)**



---

archive/issue_comments_212827.json:
```json
{
    "body": "Commit: **[`9b0a5d9`](https://github.com/sagemath/sagetrac-mirror/commit/9b0a5d98c44957ef2aaed72b9f9af5389a4c2d41)**",
    "created_at": "2014-06-13T13:58:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212827",
    "user": "https://github.com/JohnCremona"
}
```

Commit: **[`9b0a5d9`](https://github.com/sagemath/sagetrac-mirror/commit/9b0a5d98c44957ef2aaed72b9f9af5389a4c2d41)**



---

archive/issue_comments_212828.json:
```json
{
    "body": "Author: **John Cremona**",
    "created_at": "2014-06-13T13:58:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212828",
    "user": "https://github.com/JohnCremona"
}
```

Author: **John Cremona**



---

archive/issue_events_235035.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-06-13T13:58:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235035"
}
```



---

archive/issue_comments_212829.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReady for review.  Note that there are two separate things here (which perhaps should have been in separate tickets):\n\nUp till the last commit the changes are in in number fields (including QQ), not touching elliptic curves, implementing the function descend_mod_power for number field elements and enhancing the selmer_group with selmer_group_iterator for ease of use.  (Also correcting the documentation for selmer_group).\n\nThe last commit does what the ticket wanted, namely to re-implement the descend_to function for elliptic curves.  Apart from trivial cases this will only work over number fields.  It would work over any other field where descend_mod_power could be implemented such as finite fields, but note that in characteristics 2 and 3 the function would need to have a completely different implementation.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/04c1c45be771c1d1bcc8ad48bbce2c94feeee6eb\"><code>04c1c45</code></a></td><td><code>Enhanced number field selmer group capabilities by adding an iterator</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b0a5d98c44957ef2aaed72b9f9af5389a4c2d41\"><code>9b0a5d9</code></a></td><td><code>#16456: fix bugs in elliptic curve descend_to function</code></td></tr></table>\n",
    "created_at": "2014-06-13T13:58:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212829",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:5" align="right">comment:5</div>

Ready for review.  Note that there are two separate things here (which perhaps should have been in separate tickets):

Up till the last commit the changes are in in number fields (including QQ), not touching elliptic curves, implementing the function descend_mod_power for number field elements and enhancing the selmer_group with selmer_group_iterator for ease of use.  (Also correcting the documentation for selmer_group).

The last commit does what the ticket wanted, namely to re-implement the descend_to function for elliptic curves.  Apart from trivial cases this will only work over number fields.  It would work over any other field where descend_mod_power could be implemented such as finite fields, but note that in characteristics 2 and 3 the function would need to have a completely different implementation.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/04c1c45be771c1d1bcc8ad48bbce2c94feeee6eb"><code>04c1c45</code></a></td><td><code>Enhanced number field selmer group capabilities by adding an iterator</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b0a5d98c44957ef2aaed72b9f9af5389a4c2d41"><code>9b0a5d9</code></a></td><td><code>#16456: fix bugs in elliptic curve descend_to function</code></td></tr></table>




---

archive/issue_comments_212830.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d5c4ba7cc88561e9715e2ac3f2e87e80decef459\"><code>d5c4ba7</code></a></td><td><code>Merge branch 'develop' into t/16456/bug_in_descend_to_method_for_elliptic_curves</code></td></tr></table>\n",
    "created_at": "2014-07-14T13:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212830",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d5c4ba7cc88561e9715e2ac3f2e87e80decef459"><code>d5c4ba7</code></a></td><td><code>Merge branch 'develop' into t/16456/bug_in_descend_to_method_for_elliptic_curves</code></td></tr></table>




---

archive/issue_comments_212831.json:
```json
{
    "body": "Changed commit from **[`9b0a5d9`](https://github.com/sagemath/sagetrac-mirror/commit/9b0a5d98c44957ef2aaed72b9f9af5389a4c2d41)** to **[`d5c4ba7`](https://github.com/sagemath/sagetrac-mirror/commit/d5c4ba7cc88561e9715e2ac3f2e87e80decef459)**",
    "created_at": "2014-07-14T13:31:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212831",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9b0a5d9`](https://github.com/sagemath/sagetrac-mirror/commit/9b0a5d98c44957ef2aaed72b9f9af5389a4c2d41)** to **[`d5c4ba7`](https://github.com/sagemath/sagetrac-mirror/commit/d5c4ba7cc88561e9715e2ac3f2e87e80decef459)**



---

archive/issue_comments_212832.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12c1b73934d343e312c0f1df2f17e431fe0cc1b7\"><code>12c1b73</code></a></td><td><code>minor addition to isogeny_small_degree for sporadic primes over number fields</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c3ddb9e818e3b27cc71b7ce9327dbe7e1fa2d99\"><code>1c3ddb9</code></a></td><td><code>Merge branch 'develop' into isogs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3db6c28c3ffb0c9d29eb5fd1e1fe5cd1acbd907f\"><code>3db6c28</code></a></td><td><code>Merge branch 'develop' into isogs</code></td></tr></table>\n",
    "created_at": "2014-07-21T13:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212832",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12c1b73934d343e312c0f1df2f17e431fe0cc1b7"><code>12c1b73</code></a></td><td><code>minor addition to isogeny_small_degree for sporadic primes over number fields</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c3ddb9e818e3b27cc71b7ce9327dbe7e1fa2d99"><code>1c3ddb9</code></a></td><td><code>Merge branch 'develop' into isogs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3db6c28c3ffb0c9d29eb5fd1e1fe5cd1acbd907f"><code>3db6c28</code></a></td><td><code>Merge branch 'develop' into isogs</code></td></tr></table>




---

archive/issue_comments_212833.json:
```json
{
    "body": "Changed commit from **[`d5c4ba7`](https://github.com/sagemath/sagetrac-mirror/commit/d5c4ba7cc88561e9715e2ac3f2e87e80decef459)** to **[`3db6c28`](https://github.com/sagemath/sagetrac-mirror/commit/3db6c28c3ffb0c9d29eb5fd1e1fe5cd1acbd907f)**",
    "created_at": "2014-07-21T13:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212833",
    "user": "https://github.com/JohnCremona"
}
```

Changed commit from **[`d5c4ba7`](https://github.com/sagemath/sagetrac-mirror/commit/d5c4ba7cc88561e9715e2ac3f2e87e80decef459)** to **[`3db6c28`](https://github.com/sagemath/sagetrac-mirror/commit/3db6c28c3ffb0c9d29eb5fd1e1fe5cd1acbd907f)**



---

archive/issue_comments_212834.json:
```json
{
    "body": "Changed branch from **[u/cremona/bug_in_descend_to_method_for_elliptic_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/bug_in_descend_to_method_for_elliptic_curves)** to **[u/cremona/16456](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456)**",
    "created_at": "2014-07-21T13:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212834",
    "user": "https://github.com/JohnCremona"
}
```

Changed branch from **[u/cremona/bug_in_descend_to_method_for_elliptic_curves](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/bug_in_descend_to_method_for_elliptic_curves)** to **[u/cremona/16456](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456)**



---

archive/issue_comments_212835.json:
```json
{
    "body": "Reviewer: **Peter Bruin**",
    "created_at": "2014-07-22T09:45:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212835",
    "user": "https://github.com/pjbruin"
}
```

Reviewer: **Peter Bruin**



---

archive/issue_comments_212836.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nI remember looking at the Selmer group code some time ago (and again just now) and getting the impression that the group *K*(*S*, *m*) returned by `selmer_group(S, m)` is the one fitting in a natural exact sequence (warning: unicode experiment ahead)\n\n1 \u27f6 O<sub>*K*,*S*</sub><sup>\u00d7</sup>/O<sub>*K*,*S*</sub><sup>\u00d7*m*</sup> \u27f6 *K*(*S*, *m*) \u27f6 Cl<sub>*K,S*</sub>[*m*] \u27f6 0.\n\n(I.e., I think *K*(*S*, *m*) should be canonically isomorphic to the flat cohomology group H<sup>1</sup>(O<sub>*K*,*S*</sub>, ***\u03bc**<sub>m</sub>*).  This can be replaced by \u00e9tale cohomology if *S* contains all places dividing *m*, and in that case I also think that the above H<sup>1</sup>, and *K*(*S*, *m*), should be isomorphic to H<sup>1</sup>(Gal(*K<sup>S</sup>*/*K*), ***\u03bc**<sub>m</sub>*) with *K<sup>S</sup>* the maximal extension of *K* that is unramified outside *S*.)\n\nIs the above exact sequence correct, and should it perhaps be mentioned in the documentation?  And is there a comparable exact sequence for the \"true\" Selmer group consisting of the elements giving unramified extensions of *K*?",
    "created_at": "2014-07-22T09:45:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212836",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:8" align="right">comment:8</div>

I remember looking at the Selmer group code some time ago (and again just now) and getting the impression that the group *K*(*S*, *m*) returned by `selmer_group(S, m)` is the one fitting in a natural exact sequence (warning: unicode experiment ahead)

1 ⟶ O<sub>*K*,*S*</sub><sup>×</sup>/O<sub>*K*,*S*</sub><sup>×*m*</sup> ⟶ *K*(*S*, *m*) ⟶ Cl<sub>*K,S*</sub>[*m*] ⟶ 0.

(I.e., I think *K*(*S*, *m*) should be canonically isomorphic to the flat cohomology group H<sup>1</sup>(O<sub>*K*,*S*</sub>, ***μ**<sub>m</sub>*).  This can be replaced by étale cohomology if *S* contains all places dividing *m*, and in that case I also think that the above H<sup>1</sup>, and *K*(*S*, *m*), should be isomorphic to H<sup>1</sup>(Gal(*K<sup>S</sup>*/*K*), ***μ**<sub>m</sub>*) with *K<sup>S</sup>* the maximal extension of *K* that is unramified outside *S*.)

Is the above exact sequence correct, and should it perhaps be mentioned in the documentation?  And is there a comparable exact sequence for the "true" Selmer group consisting of the elements giving unramified extensions of *K*?



---

archive/issue_comments_212837.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nSee http://trac.sagemath.org/ticket/16496 where you will find that exact sequence!\n\nOne thing which makes this sequence easier to deal with than one might expect is that the group in the middle is a direct product of the other two rather than some more complicated extension.",
    "created_at": "2014-07-22T10:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212837",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:9" align="right">comment:9</div>

See http://trac.sagemath.org/ticket/16496 where you will find that exact sequence!

One thing which makes this sequence easier to deal with than one might expect is that the group in the middle is a direct product of the other two rather than some more complicated extension.



---

archive/issue_comments_212838.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@JohnCremona](#comment:9):\n> See http://trac.sagemath.org/ticket/16496 where you will find that exact sequence!\n\nRight!  I am sure I have seen that ticket before...\n> One thing which makes this sequence easier to deal with than one might expect is that the group in the middle is a direct product of the other two rather than some more complicated extension.\n\nThat sounded surprising to me at first, but I tried to verify it and realised I had actually also done something very much like that before.",
    "created_at": "2014-07-22T16:09:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212838",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@JohnCremona](#comment:9):
> See http://trac.sagemath.org/ticket/16496 where you will find that exact sequence!

Right!  I am sure I have seen that ticket before...
> One thing which makes this sequence easier to deal with than one might expect is that the group in the middle is a direct product of the other two rather than some more complicated extension.

That sounded surprising to me at first, but I tried to verify it and realised I had actually also done something very much like that before.



---

archive/issue_comments_212839.json:
```json
{
    "body": "Changed commit from **[`3db6c28`](https://github.com/sagemath/sagetrac-mirror/commit/3db6c28c3ffb0c9d29eb5fd1e1fe5cd1acbd907f)** to **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)**",
    "created_at": "2014-07-22T16:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212839",
    "user": "https://github.com/pjbruin"
}
```

Changed commit from **[`3db6c28`](https://github.com/sagemath/sagetrac-mirror/commit/3db6c28c3ffb0c9d29eb5fd1e1fe5cd1acbd907f)** to **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)**



---

archive/issue_comments_212840.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHere is a reviewer patch mostly consisting of documentation/formatting changes.  If you agree with my changes, you can set it to positive review.",
    "created_at": "2014-07-22T16:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212840",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:11" align="right">comment:11</div>

Here is a reviewer patch mostly consisting of documentation/formatting changes.  If you agree with my changes, you can set it to positive review.



---

archive/issue_comments_212841.json:
```json
{
    "body": "Changed branch from **[u/cremona/16456](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456)** to **[u/pbruin/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/16456-descend_to_bug)**",
    "created_at": "2014-07-22T16:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212841",
    "user": "https://github.com/pjbruin"
}
```

Changed branch from **[u/cremona/16456](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456)** to **[u/pbruin/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/16456-descend_to_bug)**



---

archive/issue_comments_212842.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWhile trying to find a clever cohomological argument for the splitting of the exact sequence from [comment:8](#comment:8), I did not succeed but did find a bug in `selmer_group()`; see #16708.",
    "created_at": "2014-07-23T20:13:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212842",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:12" align="right">comment:12</div>

While trying to find a clever cohomological argument for the splitting of the exact sequence from [comment:8](#comment:8), I did not succeed but did find a bug in `selmer_group()`; see #16708.



---

archive/issue_comments_212843.json:
```json
{
    "body": "<div id=\"comment:13\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bed05c7c4478314743ba2517888d44ff9e8064b6\"><code>bed05c7</code></a></td><td><code>Trac 16456: corrected doctest changed by #16708</code></td></tr></table>\n",
    "created_at": "2014-07-23T20:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212843",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:13"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bed05c7c4478314743ba2517888d44ff9e8064b6"><code>bed05c7</code></a></td><td><code>Trac 16456: corrected doctest changed by #16708</code></td></tr></table>




---

archive/issue_comments_212844.json:
```json
{
    "body": "Changed commit from **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)** to **[`bed05c7`](https://github.com/sagemath/sagetrac-mirror/commit/bed05c7c4478314743ba2517888d44ff9e8064b6)**",
    "created_at": "2014-07-23T20:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212844",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)** to **[`bed05c7`](https://github.com/sagemath/sagetrac-mirror/commit/bed05c7c4478314743ba2517888d44ff9e8064b6)**



---

archive/issue_comments_212845.json:
```json
{
    "body": "Dependencies: **#16708**",
    "created_at": "2014-07-23T20:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212845",
    "user": "https://github.com/pjbruin"
}
```

Dependencies: **#16708**



---

archive/issue_comments_212846.json:
```json
{
    "body": "Changed commit from **[`bed05c7`](https://github.com/sagemath/sagetrac-mirror/commit/bed05c7c4478314743ba2517888d44ff9e8064b6)** to **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)**",
    "created_at": "2014-07-23T20:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212846",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`bed05c7`](https://github.com/sagemath/sagetrac-mirror/commit/bed05c7c4478314743ba2517888d44ff9e8064b6)** to **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)**



---

archive/issue_comments_212847.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-07-23T20:32:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212847",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_212848.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nActually both the original answer and my \"corrected\" one in the doctest changed by commit `bed05c5` are wrong; if I'm not mistaken, the correct answer is\n\n```\nsage: K = QuadraticField(-5)\nsage: list(K.selmer_group_iterator((), 4))\n[1, 4, -1, -4]\n```",
    "created_at": "2014-07-23T20:35:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212848",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:16" align="right">comment:16</div>

Actually both the original answer and my "corrected" one in the doctest changed by commit `bed05c5` are wrong; if I'm not mistaken, the correct answer is

```
sage: K = QuadraticField(-5)
sage: list(K.selmer_group_iterator((), 4))
[1, 4, -1, -4]
```



---

archive/issue_events_235036.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-07-23T20:35:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235036"
}
```



---

archive/issue_events_235037.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-07-23T20:35:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235037"
}
```



---

archive/issue_comments_212849.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@pjbruin](#comment:16):\n> Actually both the original answer and my \"corrected\" one in the doctest changed by commit `bed05c5` are wrong; if I'm not mistaken, the correct answer is\n> \n> ```\n> sage: K = QuadraticField(-5)\n> sage: list(K.selmer_group_iterator((), 4))\n> [1, 4, -1, -4]\n> ```\n\nThat is certainly correct.  I will look at this and #16708 tomorrow.",
    "created_at": "2014-07-23T20:55:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212849",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@pjbruin](#comment:16):
> Actually both the original answer and my "corrected" one in the doctest changed by commit `bed05c5` are wrong; if I'm not mistaken, the correct answer is
> 
> ```
> sage: K = QuadraticField(-5)
> sage: list(K.selmer_group_iterator((), 4))
> [1, 4, -1, -4]
> ```

That is certainly correct.  I will look at this and #16708 tomorrow.



---

archive/issue_comments_212850.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nBetween here and #16708 a doctest needed changing as I think Peter pointed out somewhere:\n\n```\n            sage: K.<a> = QuadraticField(-5)\n            sage: list(K.selmer_group_iterator((), 4))\n            [1, 2, 4, 8, -1, -2, -4, -8]\n```\nshould be \n\n```\n           sage: K.<a> = QuadraticField(-5)\n           sage: list(K.selmer_group_iterator((), 4))\n           [1, 4, 16, 64, -1, -4, -16, -64]\n```\nwhich I am changing and will commit & push.",
    "created_at": "2014-07-24T11:43:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212850",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:18" align="right">comment:18</div>

Between here and #16708 a doctest needed changing as I think Peter pointed out somewhere:

```
            sage: K.<a> = QuadraticField(-5)
            sage: list(K.selmer_group_iterator((), 4))
            [1, 2, 4, 8, -1, -2, -4, -8]
```
should be 

```
           sage: K.<a> = QuadraticField(-5)
           sage: list(K.selmer_group_iterator((), 4))
           [1, 4, 16, 64, -1, -4, -16, -64]
```
which I am changing and will commit & push.



---

archive/issue_comments_212851.json:
```json
{
    "body": "Changed commit from **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)** to **[`e6ccee2`](https://github.com/sagemath/sagetrac-mirror/commit/e6ccee27c60c15aac6f103a0b5303450e36789c1)**",
    "created_at": "2014-07-24T11:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212851",
    "user": "https://github.com/JohnCremona"
}
```

Changed commit from **[`65d3404`](https://github.com/sagemath/sagetrac-mirror/commit/65d3404d1517a2c2005604c61582f163f0947c06)** to **[`e6ccee2`](https://github.com/sagemath/sagetrac-mirror/commit/e6ccee27c60c15aac6f103a0b5303450e36789c1)**



---

archive/issue_events_235038.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-07-24T11:45:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235038"
}
```



---

archive/issue_events_235039.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-07-24T11:45:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235039"
}
```



---

archive/issue_comments_212852.json:
```json
{
    "body": "Changed branch from **[u/pbruin/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/16456-descend_to_bug)** to **[u/cremona/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456-descend_to_bug)**",
    "created_at": "2014-07-24T11:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212852",
    "user": "https://github.com/JohnCremona"
}
```

Changed branch from **[u/pbruin/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/16456-descend_to_bug)** to **[u/cremona/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456-descend_to_bug)**



---

archive/issue_comments_212853.json:
```json
{
    "body": "<div id=\"comment:19\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8474e254406c3069d5741fda290e045aeb9a33a1\"><code>8474e25</code></a></td><td><code>Trac 16708: fix computation of Selmer groups of number fields</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c584016515e8ef6f3843685cf2819bd12e3a9cc0\"><code>c584016</code></a></td><td><code>Merge remote-tracking branch 'trac/u/pbruin/16456-descend_to_bug' into 16708</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e6ccee27c60c15aac6f103a0b5303450e36789c1\"><code>e6ccee2</code></a></td><td><code>#16456: fix one doctest after #16708</code></td></tr></table>\n",
    "created_at": "2014-07-24T11:45:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212853",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:19"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8474e254406c3069d5741fda290e045aeb9a33a1"><code>8474e25</code></a></td><td><code>Trac 16708: fix computation of Selmer groups of number fields</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c584016515e8ef6f3843685cf2819bd12e3a9cc0"><code>c584016</code></a></td><td><code>Merge remote-tracking branch 'trac/u/pbruin/16456-descend_to_bug' into 16708</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e6ccee27c60c15aac6f103a0b5303450e36789c1"><code>e6ccee2</code></a></td><td><code>#16456: fix one doctest after #16708</code></td></tr></table>




---

archive/issue_comments_212854.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nPeter, thanks for your tidying up of (and improving) the documentation.  I just fixed that one doctest which I think you already noticed was incorrect because of the bug fixed now at #16708.  That means that the branch name has gone back to mine (u/cremona/...), and I have set it back to \"needs review\".  Since I like your reviewer's changes, if you agree wit hthis last one then we can set it to \"positive review\".",
    "created_at": "2014-07-24T11:47:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212854",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:20" align="right">comment:20</div>

Peter, thanks for your tidying up of (and improving) the documentation.  I just fixed that one doctest which I think you already noticed was incorrect because of the bug fixed now at #16708.  That means that the branch name has gone back to mine (u/cremona/...), and I have set it back to "needs review".  Since I like your reviewer's changes, if you agree wit hthis last one then we can set it to "positive review".



---

archive/issue_comments_212855.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@JohnCremona](#comment:18):\n> Between here and #16708 a doctest needed changing as I think Peter pointed out somewhere:\n> \n> ```\n>             sage: K.<a> = QuadraticField(-5)\n>             sage: list(K.selmer_group_iterator((), 4))\n>             [1, 2, 4, 8, -1, -2, -4, -8]\n> ```\n> should be \n> \n> ```\n>            sage: K.<a> = QuadraticField(-5)\n>            sage: list(K.selmer_group_iterator((), 4))\n>            [1, 4, 16, 64, -1, -4, -16, -64]\n> ```\n> which I am changing and will commit & push.\n\nThat second answer was actually the wrong \"correction\" I pushed and then retracted.  It should be `[1, 4, -1, -4]` (as in [comment:17](#comment:17)); in fact 16 is a fourth power, hence represents the trivial element of the Selmer group.  The Selmer group is isomorphic to *C*<sub>2</sub> x *C*<sub>2</sub> (since both the units modulo 4-th powers and the 4-torsion in the class group are cyclic of order 2.)\n\nI think the problem is the line\n\n```\nf = lambda o: m if o is Infinity else o.gcd(m)\n```\nwhere you will somehow need to take the orders of elements of the class group into account.",
    "created_at": "2014-07-24T11:56:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212855",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@JohnCremona](#comment:18):
> Between here and #16708 a doctest needed changing as I think Peter pointed out somewhere:
> 
> ```
>             sage: K.<a> = QuadraticField(-5)
>             sage: list(K.selmer_group_iterator((), 4))
>             [1, 2, 4, 8, -1, -2, -4, -8]
> ```
> should be 
> 
> ```
>            sage: K.<a> = QuadraticField(-5)
>            sage: list(K.selmer_group_iterator((), 4))
>            [1, 4, 16, 64, -1, -4, -16, -64]
> ```
> which I am changing and will commit & push.

That second answer was actually the wrong "correction" I pushed and then retracted.  It should be `[1, 4, -1, -4]` (as in [comment:17](#comment:17)); in fact 16 is a fourth power, hence represents the trivial element of the Selmer group.  The Selmer group is isomorphic to *C*<sub>2</sub> x *C*<sub>2</sub> (since both the units modulo 4-th powers and the 4-torsion in the class group are cyclic of order 2.)

I think the problem is the line

```
f = lambda o: m if o is Infinity else o.gcd(m)
```
where you will somehow need to take the orders of elements of the class group into account.



---

archive/issue_events_235040.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-07-24T11:56:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235040"
}
```



---

archive/issue_events_235041.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-07-24T11:56:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235041"
}
```



---

archive/issue_comments_212856.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nSorry about that.  I'll work out how to correct it....",
    "created_at": "2014-07-24T12:31:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212856",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:22" align="right">comment:22</div>

Sorry about that.  I'll work out how to correct it....



---

archive/issue_comments_212857.json:
```json
{
    "body": "Changed commit from **[`e6ccee2`](https://github.com/sagemath/sagetrac-mirror/commit/e6ccee27c60c15aac6f103a0b5303450e36789c1)** to **[`e0a13b3`](https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355)**",
    "created_at": "2014-07-24T13:27:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212857",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e6ccee2`](https://github.com/sagemath/sagetrac-mirror/commit/e6ccee27c60c15aac6f103a0b5303450e36789c1)** to **[`e0a13b3`](https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355)**



---

archive/issue_comments_212858.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355\"><code>e0a13b3</code></a></td><td><code>#16456: fix bug in orders of Selmer group elements</code></td></tr></table>\n",
    "created_at": "2014-07-24T13:27:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212858",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355"><code>e0a13b3</code></a></td><td><code>#16456: fix bug in orders of Selmer group elements</code></td></tr></table>




---

archive/issue_comments_212859.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\n...done.  I added an optional parameter \"orders\" to the selmer_group method, default False gives the old behavious, if True also outputs a list of the orders of the generators, which are all equal to m when m is prime, but not necesarily otherwise.  Added doctests for this.  Now the iterator uses this instead of the old formula, which was wrong.  I thought that this was simpler than trying to recover the orders from the list of generators, since it is information we have to hand when constructing the list of generators.\n\nFor consistency I did the same for the special versions over QQ, though the bug did not apply here.  At the same time I noticed that over QQ when -1 is a generator it was put last while over number fields the units are always first, so I changed that (and the associated doctests) too.\n\nNote that this change will be superceded after #16496 when there is a proper class for these Selmer groups.  And also that the correctness of the current selmer_group function relies on the direct product fact alluded to in earlier comments!",
    "created_at": "2014-07-24T13:32:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212859",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:24" align="right">comment:24</div>

...done.  I added an optional parameter "orders" to the selmer_group method, default False gives the old behavious, if True also outputs a list of the orders of the generators, which are all equal to m when m is prime, but not necesarily otherwise.  Added doctests for this.  Now the iterator uses this instead of the old formula, which was wrong.  I thought that this was simpler than trying to recover the orders from the list of generators, since it is information we have to hand when constructing the list of generators.

For consistency I did the same for the special versions over QQ, though the bug did not apply here.  At the same time I noticed that over QQ when -1 is a generator it was put last while over number fields the units are always first, so I changed that (and the associated doctests) too.

Note that this change will be superceded after #16496 when there is a proper class for these Selmer groups.  And also that the correctness of the current selmer_group function relies on the direct product fact alluded to in earlier comments!



---

archive/issue_events_235042.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-07-24T13:32:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235042"
}
```



---

archive/issue_events_235043.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2014-07-24T13:32:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235043"
}
```



---

archive/issue_comments_212860.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nOK, everything looks good to me now!",
    "created_at": "2014-07-24T15:14:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212860",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:25" align="right">comment:25</div>

OK, everything looks good to me now!



---

archive/issue_events_235044.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-07-24T15:14:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235044"
}
```



---

archive/issue_events_235045.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-07-24T15:14:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235045"
}
```



---

archive/issue_comments_212861.json:
```json
{
    "body": "Changed branch from **[u/cremona/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456-descend_to_bug)** to **[`e0a13b3`](https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355)**",
    "created_at": "2014-07-25T05:05:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16456#issuecomment-212861",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/cremona/16456-descend_to_bug](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/16456-descend_to_bug)** to **[`e0a13b3`](https://github.com/sagemath/sagetrac-mirror/commit/e0a13b3931a2c0d0360a57a36a841cde96e00355)**



---

archive/issue_events_235046.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-25T05:05:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235046"
}
```



---

archive/issue_events_235047.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "6af23b7660a47afa5bc7c0344e126165284ca62b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-07-25T05:05:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16456",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16456#event-235047"
}
```
