# Issue 16007: give solution constants of ODEs unique names

archive/issues_015770.json:
```json
{
    "body": "CC:  @kcrisman\n\n(this was reported as part of #6882)\n\n... solving of ode y'=c*x is not correct, the free variable is messed up with a parameter, see [sage-devel](http://groups.google.cz/group/sage-devel/browse_thread/thread/e04cbc547095f2ac) - thanks for Yuri Karadzhov\n\n```\nsage: from sage.calculus.calculus import symbolic_expression_from_maxima_string\nsage: symbolic_expression_from_maxima_string('%c')\nc\nsage: c=var('c'); y=function('y',x); eq=diff(y,x)==c*x; eq\nD[0](y)(x) == c*x\nsage: desolve(eq,y,ivar=x)\n1/2*c*x^2 + c\n```\nthe answer should be something like 1/2*c*x<sup>2</sup> + c1\n\nThe fix depends on closing #8734. The `c` variable that comes from Sage can then be easily recognized, and the constant `c` should then be renamed to `c1` or `_C1`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16007\n\n",
    "closed_at": "2014-07-08T13:06:29Z",
    "created_at": "2014-03-25T10:09:58Z",
    "labels": [
        "component: calculus",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "give solution constants of ODEs unique names",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16007",
    "user": "https://github.com/rwst"
}
```
CC:  @kcrisman

(this was reported as part of #6882)

... solving of ode y'=c*x is not correct, the free variable is messed up with a parameter, see [sage-devel](http://groups.google.cz/group/sage-devel/browse_thread/thread/e04cbc547095f2ac) - thanks for Yuri Karadzhov

```
sage: from sage.calculus.calculus import symbolic_expression_from_maxima_string
sage: symbolic_expression_from_maxima_string('%c')
c
sage: c=var('c'); y=function('y',x); eq=diff(y,x)==c*x; eq
D[0](y)(x) == c*x
sage: desolve(eq,y,ivar=x)
1/2*c*x^2 + c
```
the answer should be something like 1/2*c*x<sup>2</sup> + c1

The fix depends on closing #8734. The `c` variable that comes from Sage can then be easily recognized, and the constant `c` should then be renamed to `c1` or `_C1`.

Issue created by migration from https://trac.sagemath.org/ticket/16007





---

archive/issue_comments_204117.json:
```json
{
    "body": "Actually, these variables are very easy to recognize any way:\n\n```\nsage: function('f',x)\nf(x)\nsage: var('c')\nc\nsage: W=diff(f(x),x,x)-f(x)+c\nsage: V=diff(f(x),x)-f(x)+c\nsage: maxima_calculus(V).ode2(f(x),x)\n'f(x)=(c*%e^-x+%c)*%e^x\nsage: maxima_calculus(W).ode2(f(x),x)\n'f(x)=%k1*%e^x+%k2*%e^-x+c\n```\nAs you can see, maxima creates these constants as `%c, %k1, %k2`, so there's no collision there. The collision only happens upon conversion back to sage. So we make the conversion more intelligent there wouldn't be an issue at all. Using `sage.interfaces.maxima_lib.max_to_sr` this would be fairly straightforward.",
    "created_at": "2014-03-26T06:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204117",
    "user": "https://github.com/nbruin"
}
```

Actually, these variables are very easy to recognize any way:

```
sage: function('f',x)
f(x)
sage: var('c')
c
sage: W=diff(f(x),x,x)-f(x)+c
sage: V=diff(f(x),x)-f(x)+c
sage: maxima_calculus(V).ode2(f(x),x)
'f(x)=(c*%e^-x+%c)*%e^x
sage: maxima_calculus(W).ode2(f(x),x)
'f(x)=%k1*%e^x+%k2*%e^-x+c
```
As you can see, maxima creates these constants as `%c, %k1, %k2`, so there's no collision there. The collision only happens upon conversion back to sage. So we make the conversion more intelligent there wouldn't be an issue at all. Using `sage.interfaces.maxima_lib.max_to_sr` this would be fairly straightforward.



---

archive/issue_comments_204118.json:
```json
{
    "body": "Indeed, many thanks. With this easy patch the output is now\n\n```\nsage: sage: x=function('x',t)\nsage: sage: var('c')\nc\nsage: sage: desolve(diff(x,t)+2*x==t^2-2*t+c,x,ivar=t).expand()\n1/2*t^2 + _C*e^(-2*t) + 1/2*c - 3/2*t + 3/4\n\nsage: desolve(diff(f(x),x,x)-f(x),f(x))\n_K2*e^(-x) + _K1*e^x\n```\nAny more variables?\n\n---\nNew commits:",
    "created_at": "2014-03-26T15:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204118",
    "user": "https://github.com/rwst"
}
```

Indeed, many thanks. With this easy patch the output is now

```
sage: sage: x=function('x',t)
sage: sage: var('c')
c
sage: sage: desolve(diff(x,t)+2*x==t^2-2*t+c,x,ivar=t).expand()
1/2*t^2 + _C*e^(-2*t) + 1/2*c - 3/2*t + 3/4

sage: desolve(diff(f(x),x,x)-f(x),f(x))
_K2*e^(-x) + _K1*e^x
```
Any more variables?

---
New commits:



---

archive/issue_comments_204119.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-26T15:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204119",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_204120.json:
```json
{
    "body": "seems to be a duplicate of #9421.\n\nPaul",
    "created_at": "2014-03-27T09:05:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204120",
    "user": "https://github.com/zimmermann6"
}
```

seems to be a duplicate of #9421.

Paul



---

archive/issue_comments_204121.json:
```json
{
    "body": "Yes. So, are you okay with this solution applied to #9421, instead of the warning? If so, then I will make a reviewer's patch there and invalid this ticket.",
    "created_at": "2014-03-27T10:17:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204121",
    "user": "https://github.com/rwst"
}
```

Yes. So, are you okay with this solution applied to #9421, instead of the warning? If so, then I will make a reviewer's patch there and invalid this ticket.



---

archive/issue_comments_204122.json:
```json
{
    "body": "yes I agree with this solution, but I won't have time quite soon to check the doctests still pass.\n\nPaul",
    "created_at": "2014-03-27T11:04:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204122",
    "user": "https://github.com/zimmermann6"
}
```

yes I agree with this solution, but I won't have time quite soon to check the doctests still pass.

Paul



---

archive/issue_comments_204123.json:
```json
{
    "body": "It might be worth doing a few things.  First, you must have documentation testing this fix - especially since people will be confused by underscore variables without some documentation!  Also, how many different things can show up?  Just `c`, `k1`, `k2`, or also `c1` et al, or `k3`, ... ?  It would be worth asking on the [Maxima email list](http://sourceforge.net/p/maxima/mailman/maxima-discuss/) about what outputs can possibly happen (assuming it's working - I was at some point subscribed to the \"new\" version but now am apparently not again).\n\nBut I agree it's very unlikely for anyone to have an underscore variable, so this could be a good compromise... there remains the issue of substituting in for non-Sageified variables.",
    "created_at": "2014-03-27T16:38:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204123",
    "user": "https://github.com/kcrisman"
}
```

It might be worth doing a few things.  First, you must have documentation testing this fix - especially since people will be confused by underscore variables without some documentation!  Also, how many different things can show up?  Just `c`, `k1`, `k2`, or also `c1` et al, or `k3`, ... ?  It would be worth asking on the [Maxima email list](http://sourceforge.net/p/maxima/mailman/maxima-discuss/) about what outputs can possibly happen (assuming it's working - I was at some point subscribed to the "new" version but now am apparently not again).

But I agree it's very unlikely for anyone to have an underscore variable, so this could be a good compromise... there remains the issue of substituting in for non-Sageified variables.



---

archive/issue_comments_204124.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-04T07:10:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204124",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_047096.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16007#event-47096"
}
```



---

archive/issue_comments_204125.json:
```json
{
    "body": "Deleted misplaced comment.",
    "created_at": "2014-06-05T15:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204125",
    "user": "https://github.com/rwst"
}
```

Deleted misplaced comment.



---

archive/issue_comments_204126.json:
```json
{
    "body": "Maxima-discuss list mail:\n\n```\nOn 05-06-2014 16:36, Ralf Stephan wrote:\n>Sage uses Maxima to solve ODEs. To do that bug free we would\n>need to know which constant vars apart from %c, %k1, %k2 are\n>returned by Maxima. Can you please help?\nlooking at the source code of the programs in share/diffequations,\nit seems to me that those 3 are the only ones. I don't know if you\nhave other programs in mind, apart from those in share/diffequations.\n\nRegards,\nJaime\n```\nI take it then the ticket is complete for review.",
    "created_at": "2014-06-06T08:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204126",
    "user": "https://github.com/rwst"
}
```

Maxima-discuss list mail:

```
On 05-06-2014 16:36, Ralf Stephan wrote:
>Sage uses Maxima to solve ODEs. To do that bug free we would
>need to know which constant vars apart from %c, %k1, %k2 are
>returned by Maxima. Can you please help?
looking at the source code of the programs in share/diffequations,
it seems to me that those 3 are the only ones. I don't know if you
have other programs in mind, apart from those in share/diffequations.

Regards,
Jaime
```
I take it then the ticket is complete for review.



---

archive/issue_comments_204127.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-06T08:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204127",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_204128.json:
```json
{
    "body": "Thanks for doing that due diligence.  Yes, I believe these only arise from a contrib package in Maxima.\n> I take it then the ticket is complete for review.\nWell... see in comment:8\n> First, you must have documentation testing this fix - especially since people will be confused by underscore variables without some documentation! \n\nIt's really unfortunate with the underscores.  But I hate to think of checking whether `C`, `C1`, `C2` etc. were defined and then using whatever the next one was.  Anyway, unless Nils (who knows this stuff better than me) objects to your solution (quoting comment:9:ticket:9421)\n>  (with the righter solution being: making sage's \"forget the %\" more intelligent, so that collisions can be avoided)\n\nthen as I said, this is definitely much better than leaving it 'as is'.",
    "created_at": "2014-06-06T14:35:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204128",
    "user": "https://github.com/kcrisman"
}
```

Thanks for doing that due diligence.  Yes, I believe these only arise from a contrib package in Maxima.
> I take it then the ticket is complete for review.
Well... see in comment:8
> First, you must have documentation testing this fix - especially since people will be confused by underscore variables without some documentation! 

It's really unfortunate with the underscores.  But I hate to think of checking whether `C`, `C1`, `C2` etc. were defined and then using whatever the next one was.  Anyway, unless Nils (who knows this stuff better than me) objects to your solution (quoting comment:9:ticket:9421)
>  (with the righter solution being: making sage's "forget the %" more intelligent, so that collisions can be avoided)

then as I said, this is definitely much better than leaving it 'as is'.



---

archive/issue_comments_204129.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2014-06-07T06:53:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204129",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_204130.json:
```json
{
    "body": "Merged in #8734. Thanks for the doctest reminder.",
    "created_at": "2014-06-07T06:54:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204130",
    "user": "https://github.com/rwst"
}
```

Merged in #8734. Thanks for the doctest reminder.



---

archive/issue_comments_204131.json:
```json
{
    "body": "> Merged in #8734. Thanks for the doctest reminder.\n\nNo problem.   Do you think it's useful to add an example where there might have otherwise been a collision of names, or is that superfluous?\n\nAlso, why is the doctest\n\n```\nsefms('%k1*%x + %k2*%y + %c')\n```\nand not\n\n```\nsefms('%k1*x + %k2*y + %c')\n```\nI'm not sure what the `%` is doing on the variables, though I don't doubt Sage would strip those percents off, if I recall that part of the code correctly (it's been a while, though).",
    "created_at": "2014-06-08T00:46:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204131",
    "user": "https://github.com/kcrisman"
}
```

> Merged in #8734. Thanks for the doctest reminder.

No problem.   Do you think it's useful to add an example where there might have otherwise been a collision of names, or is that superfluous?

Also, why is the doctest

```
sefms('%k1*%x + %k2*%y + %c')
```
and not

```
sefms('%k1*x + %k2*y + %c')
```
I'm not sure what the `%` is doing on the variables, though I don't doubt Sage would strip those percents off, if I recall that part of the code correctly (it's been a while, though).



---

archive/issue_comments_204132.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-08T07:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204132",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204133.json:
```json
{
    "body": "OK. Though not wrong, it wasn't what I intended, so it's changed now.",
    "created_at": "2014-06-08T07:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204133",
    "user": "https://github.com/rwst"
}
```

OK. Though not wrong, it wasn't what I intended, so it's changed now.



---

archive/issue_comments_204134.json:
```json
{
    "body": "I realized another question.  I can't build a branch right now to check this, but I believe that in the past the `c` and friends were not only confusing, they didn't actually correspond to any Sage variable.  So now we have it that there is unlikely collision, but even then we still have `_C` and friends not corresponding to any Sage variable - they haven't been injected into any namespace.  (And I don't think we want to do it at startup on the off chance someone needs them.)  We *may* want to do a seek-and-find for them but doing it every time could be annoying/add a little time.  Anyway, at the very least that should probably be (finally!) documented if we're going to fix this.\n\nSorry for all the minor things occurring to me.",
    "created_at": "2014-06-10T00:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204134",
    "user": "https://github.com/kcrisman"
}
```

I realized another question.  I can't build a branch right now to check this, but I believe that in the past the `c` and friends were not only confusing, they didn't actually correspond to any Sage variable.  So now we have it that there is unlikely collision, but even then we still have `_C` and friends not corresponding to any Sage variable - they haven't been injected into any namespace.  (And I don't think we want to do it at startup on the off chance someone needs them.)  We *may* want to do a seek-and-find for them but doing it every time could be annoying/add a little time.  Anyway, at the very least that should probably be (finally!) documented if we're going to fix this.

Sorry for all the minor things occurring to me.



---

archive/issue_comments_204135.json:
```json
{
    "body": "Replying to [comment:19 kcrisman]:\n> I realized another question.  I can't build a branch right now to check this, but I believe that in the past the `c` and friends were not only confusing, they didn't actually correspond to any Sage variable.  So now we have it that there is unlikely collision, but even then we still have `_C` and friends not corresponding to any Sage variable\n\n\nUh ... as soon as these make it back in sage there are symbolic variable objects that represent them. They are full-blown pynac objects right then.\n\n> - they haven't been injected into any namespace.\n\n\nThat has never been a requirement for objects to \"exist\" in sage. I don't think this is an issue at all. The objects can be accessed via `SR(\"_C\")` as usual, and in fact if the user does `_C=var(\"_C\")` or toplevel `var(\"_C\")` he/she can have the object bound. We should absolutely not mess with namespaces during runtime. We *might* prebind `_C` etc. if someone thinks it's too difficult for users otherwise.",
    "created_at": "2014-06-10T01:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204135",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:19 kcrisman]:
> I realized another question.  I can't build a branch right now to check this, but I believe that in the past the `c` and friends were not only confusing, they didn't actually correspond to any Sage variable.  So now we have it that there is unlikely collision, but even then we still have `_C` and friends not corresponding to any Sage variable


Uh ... as soon as these make it back in sage there are symbolic variable objects that represent them. They are full-blown pynac objects right then.

> - they haven't been injected into any namespace.


That has never been a requirement for objects to "exist" in sage. I don't think this is an issue at all. The objects can be accessed via `SR("_C")` as usual, and in fact if the user does `_C=var("_C")` or toplevel `var("_C")` he/she can have the object bound. We should absolutely not mess with namespaces during runtime. We *might* prebind `_C` etc. if someone thinks it's too difficult for users otherwise.



---

archive/issue_comments_204136.json:
```json
{
    "body": "Replying to [comment:20 nbruin]:\n> We *might* prebind `_C` etc. if someone thinks it's too difficult for users otherwise.\n\nI would like to. How would I do it?",
    "created_at": "2014-06-10T04:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204136",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:20 nbruin]:
> We *might* prebind `_C` etc. if someone thinks it's too difficult for users otherwise.

I would like to. How would I do it?



---

archive/issue_comments_204137.json:
```json
{
    "body": "You can already have them predefined by putting in `$HOME/.sage/init.sage` something like:\n\n```\n_C = SR.var(\"_C\")\n_K1 = SR.var(\"_K1\")\n_K2 = SR.var(\"_K2\")\n```\nVarious notebook/mathcloud solutions probably expose this mechanism or something equivalent somehow.\n\nThe error people get when they do try to access these objects via the correspondingly named variables is pretty clear and they'll probably do the right thing next (they've already been able to define a differential equation in sage, so they've had to jump some hurdles already). I'd propose holding off on filling global namespace now and only consider that if it turns out to be a common complaint. The \"c,k1,k2\" we had before suffered the same problem and didn't generate complaints either.",
    "created_at": "2014-06-10T16:07:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204137",
    "user": "https://github.com/nbruin"
}
```

You can already have them predefined by putting in `$HOME/.sage/init.sage` something like:

```
_C = SR.var("_C")
_K1 = SR.var("_K1")
_K2 = SR.var("_K2")
```
Various notebook/mathcloud solutions probably expose this mechanism or something equivalent somehow.

The error people get when they do try to access these objects via the correspondingly named variables is pretty clear and they'll probably do the right thing next (they've already been able to define a differential equation in sage, so they've had to jump some hurdles already). I'd propose holding off on filling global namespace now and only consider that if it turns out to be a common complaint. The "c,k1,k2" we had before suffered the same problem and didn't generate complaints either.



---

archive/issue_comments_204138.json:
```json
{
    "body": "> > We *might* prebind `_C` etc. if someone thinks it's too difficult for users otherwise.\n\n> I would like to. How would I do it?\nI think my point is that presumably if one then retyped the answer, or tried to use it somehow, one would get an error about an undefined variable.  \n\n```\n\nsage: var('d')\nd\nsage: y=function('y',x); eq=diff(y,x)==d*x; eq\nD[0](y)(x) == d*x\nsage: desolve(eq,y,ivar=x)\n1/2*d*x^2 + c\nsage: c\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n<ipython-input-4-2cd6ee2c70b0> in <module>()\n----> 1 c\n\nNameError: name 'c' is not defined\n```\nThat said, \n\n```\n\nsage: D = desolve(eq,y,ivar=x)\nsage: D.subs(c=3)\n1/2*d*x^2 + 3\n```\nworks.  So I would be comfortable with very good documentation or something ahead of time - and Nils' comment indicates that better documentation for how to use these is best.",
    "created_at": "2014-06-10T17:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204138",
    "user": "https://github.com/kcrisman"
}
```

> > We *might* prebind `_C` etc. if someone thinks it's too difficult for users otherwise.

> I would like to. How would I do it?
I think my point is that presumably if one then retyped the answer, or tried to use it somehow, one would get an error about an undefined variable.  

```

sage: var('d')
d
sage: y=function('y',x); eq=diff(y,x)==d*x; eq
D[0](y)(x) == d*x
sage: desolve(eq,y,ivar=x)
1/2*d*x^2 + c
sage: c
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-4-2cd6ee2c70b0> in <module>()
----> 1 c

NameError: name 'c' is not defined
```
That said, 

```

sage: D = desolve(eq,y,ivar=x)
sage: D.subs(c=3)
1/2*d*x^2 + 3
```
works.  So I would be comfortable with very good documentation or something ahead of time - and Nils' comment indicates that better documentation for how to use these is best.



---

archive/issue_comments_204139.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-14T08:01:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204139",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204140.json:
```json
{
    "body": "Please don't forget to add your names.",
    "created_at": "2014-06-14T08:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204140",
    "user": "https://github.com/rwst"
}
```

Please don't forget to add your names.



---

archive/issue_comments_204141.json:
```json
{
    "body": "Not positive? So what's missing?",
    "created_at": "2014-06-17T12:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204141",
    "user": "https://github.com/rwst"
}
```

Not positive? So what's missing?



---

archive/issue_comments_204142.json:
```json
{
    "body": "> Not positive? So what's missing?\n\nStill working on it!  I wanted to look more closely at #8734 first.  It does look okay, but I just wanted to think a little more about any unintended interactions.",
    "created_at": "2014-06-17T13:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204142",
    "user": "https://github.com/kcrisman"
}
```

> Not positive? So what's missing?

Still working on it!  I wanted to look more closely at #8734 first.  It does look okay, but I just wanted to think a little more about any unintended interactions.



---

archive/issue_comments_204143.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-06-17T15:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204143",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_204144.json:
```json
{
    "body": "Is the line\n\n```\nsage: from sage.calculus.calculus import symbolic_expression_from_maxima_string as sefms\n```\nnecessary in the doctest?  Though it doesn't hurt anything.\n\n---\n\n```\nsage: sefms('%k1*x + %k2*y + %c')\n_K1*x + _K2*y + _C\nsage: _._latex_()\n'_{K_{1}} x + _{K_{2}} y + _{C}'\n```\nI have a feeling this is not what we are looking for, but I don't know how to deal with it best.  Presumably 'naked variables/constants' don't need to be subscripted in typesetting.\n\nOne idea, which [mimics our handling of lambda](http://sagemath.org/doc/prep/Programming.html#gotchas-from-names-and-copies), would be to make the constants have names `k1_` and `c_` instead.\n\n```\nsage: var('lambda_')\nlambda_\nsage: latex(_)\n\\lambda\nsage: var('beta_')\nbeta_\nsage: latex(_)\n\\beta\nsage: var('k1_')\nk1_\nsage: latex(_)\n\\mathit{k1}\n```\nNote that this is not what is desired either, since\n\n```\nsage: latex(k1)\nk_{1}\nsage: latex(k1_)\n\\mathit{k1}\nsage: latex(c_)\nc\n```\nI don't know whether this is a good solution, but we do need proper typesetting of these guys.",
    "created_at": "2014-06-17T15:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204144",
    "user": "https://github.com/kcrisman"
}
```

Is the line

```
sage: from sage.calculus.calculus import symbolic_expression_from_maxima_string as sefms
```
necessary in the doctest?  Though it doesn't hurt anything.

---

```
sage: sefms('%k1*x + %k2*y + %c')
_K1*x + _K2*y + _C
sage: _._latex_()
'_{K_{1}} x + _{K_{2}} y + _{C}'
```
I have a feeling this is not what we are looking for, but I don't know how to deal with it best.  Presumably 'naked variables/constants' don't need to be subscripted in typesetting.

One idea, which [mimics our handling of lambda](http://sagemath.org/doc/prep/Programming.html#gotchas-from-names-and-copies), would be to make the constants have names `k1_` and `c_` instead.

```
sage: var('lambda_')
lambda_
sage: latex(_)
\lambda
sage: var('beta_')
beta_
sage: latex(_)
\beta
sage: var('k1_')
k1_
sage: latex(_)
\mathit{k1}
```
Note that this is not what is desired either, since

```
sage: latex(k1)
k_{1}
sage: latex(k1_)
\mathit{k1}
sage: latex(c_)
c
```
I don't know whether this is a good solution, but we do need proper typesetting of these guys.



---

archive/issue_comments_204145.json:
```json
{
    "body": "Indeed. I would propose to use `c_`, `k_`, and `K_` then, because `%k2` rarely appears. Changing the behaviour of `latex()` wrt to leading underscore will open the next can of worms, like complaints about typesetting `_3F_1`.",
    "created_at": "2014-06-17T16:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204145",
    "user": "https://github.com/rwst"
}
```

Indeed. I would propose to use `c_`, `k_`, and `K_` then, because `%k2` rarely appears. Changing the behaviour of `latex()` wrt to leading underscore will open the next can of worms, like complaints about typesetting `_3F_1`.



---

archive/issue_comments_204146.json:
```json
{
    "body": "On the other hand, no. The best solution is in `latex_variable_name()` to recognize if a varname matches one entry of the `symtable` in `calculus.py`.",
    "created_at": "2014-06-18T08:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204146",
    "user": "https://github.com/rwst"
}
```

On the other hand, no. The best solution is in `latex_variable_name()` to recognize if a varname matches one entry of the `symtable` in `calculus.py`.



---

archive/issue_comments_204147.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-18T09:27:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204147",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204148.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-18T09:28:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204148",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_204149.json:
```json
{
    "body": "> On the other hand, no. The best solution is in `latex_variable_name()` to recognize if a varname matches one entry of the `symtable` in `calculus.py`.\n\nReally?  But now the distinction between `c` and `_c` is lost in typesetting, if I understand this correctly, though I don't know how one would typeset the underscore in any case.  I guess there probably isn't any better way, though - or? Ideas?",
    "created_at": "2014-06-18T20:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204149",
    "user": "https://github.com/kcrisman"
}
```

> On the other hand, no. The best solution is in `latex_variable_name()` to recognize if a varname matches one entry of the `symtable` in `calculus.py`.

Really?  But now the distinction between `c` and `_c` is lost in typesetting, if I understand this correctly, though I don't know how one would typeset the underscore in any case.  I guess there probably isn't any better way, though - or? Ideas?



---

archive/issue_comments_204150.json:
```json
{
    "body": "Well, now there is a code point where the behaviour can be changed. So, again, is there anything missing?",
    "created_at": "2014-06-19T03:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204150",
    "user": "https://github.com/rwst"
}
```

Well, now there is a code point where the behaviour can be changed. So, again, is there anything missing?



---

archive/issue_comments_204151.json:
```json
{
    "body": "> though I don't know how one would typeset the underscore in any case.\n\nTurns out it currently just keeps the underscore.\n\nThis change could minutely slow down latex for variables that start with underscores, or if the symtable gets huge... but that is probably silly to worry about for now, neither are likely in the near future.  Also may help with #6882.  So I'm happy with this commit.\n> So, again, is there anything missing?\n\nDoctest (presumably just in `latex_variable_name`) for the latexing.  I realize this seems like a lot of rounds, but I've found the review process very helpful in the past, anyway.   (And I'm sorry I haven't time to check out the last commit of #8734 yet.)",
    "created_at": "2014-06-24T15:48:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204151",
    "user": "https://github.com/kcrisman"
}
```

> though I don't know how one would typeset the underscore in any case.

Turns out it currently just keeps the underscore.

This change could minutely slow down latex for variables that start with underscores, or if the symtable gets huge... but that is probably silly to worry about for now, neither are likely in the near future.  Also may help with #6882.  So I'm happy with this commit.
> So, again, is there anything missing?

Doctest (presumably just in `latex_variable_name`) for the latexing.  I realize this seems like a lot of rounds, but I've found the review process very helpful in the past, anyway.   (And I'm sorry I haven't time to check out the last commit of #8734 yet.)



---

archive/issue_comments_204152.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-25T05:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204152",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204153.json:
```json
{
    "body": "Replying to [comment:36 kcrisman]:\n> > So, again, is there anything missing?\n\n> Doctest (presumably just in `latex_variable_name`) for the latexing.  I realize this seems like a lot of rounds, but I've found the review process very helpful in the past, anyway.   (And I'm sorry I haven't time to check out the last commit of #8734 yet.)\nI appreciate your thoroughness, and thanks for the review!",
    "created_at": "2014-06-25T05:43:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204153",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:36 kcrisman]:
> > So, again, is there anything missing?

> Doctest (presumably just in `latex_variable_name`) for the latexing.  I realize this seems like a lot of rounds, but I've found the review process very helpful in the past, anyway.   (And I'm sorry I haven't time to check out the last commit of #8734 yet.)
I appreciate your thoroughness, and thanks for the review!



---

archive/issue_comments_204154.json:
```json
{
    "body": "Okay, if doctests pass (currently attempting to build the branch but it will take a while) then I'm happy with this.  Thanks for working on so many symbolics/calculus things recently.",
    "created_at": "2014-06-25T13:37:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204154",
    "user": "https://github.com/kcrisman"
}
```

Okay, if doctests pass (currently attempting to build the branch but it will take a while) then I'm happy with this.  Thanks for working on so many symbolics/calculus things recently.



---

archive/issue_comments_204155.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-25T14:07:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204155",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_204156.json:
```json
{
    "body": "Doctests don't pass (try `make ptestlong`)\n\n```\nsage -t --long src/doc/en/tutorial/tour_algebra.rst\n**********************************************************************\nFile \"src/doc/en/tutorial/tour_algebra.rst\", line 156, in doc.en.tutorial.tour_algebra\nFailed example:\n    desolve(DE, [x,t])\nExpected:\n    (c + e^t)*e^(-t)\nGot:\n    (_C + e^t)*e^(-t)\n**********************************************************************\n```",
    "created_at": "2014-06-26T02:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204156",
    "user": "https://github.com/vbraun"
}
```

Doctests don't pass (try `make ptestlong`)

```
sage -t --long src/doc/en/tutorial/tour_algebra.rst
**********************************************************************
File "src/doc/en/tutorial/tour_algebra.rst", line 156, in doc.en.tutorial.tour_algebra
Failed example:
    desolve(DE, [x,t])
Expected:
    (c + e^t)*e^(-t)
Got:
    (_C + e^t)*e^(-t)
**********************************************************************
```



---

archive/issue_comments_204157.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-06-26T02:46:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204157",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_204158.json:
```json
{
    "body": "Nuts!!!  I could have sworn I checked everything... and now I see why long tests on #8734 are taking so long too, I did `make testlong` and not `make ptestlong`.   Very sorry about this.",
    "created_at": "2014-06-26T03:13:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204158",
    "user": "https://github.com/kcrisman"
}
```

Nuts!!!  I could have sworn I checked everything... and now I see why long tests on #8734 are taking so long too, I did `make testlong` and not `make ptestlong`.   Very sorry about this.



---

archive/issue_comments_204159.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-06-26T08:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204159",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204160.json:
```json
{
    "body": "Not all of #8734 was merged. Sorry for the inconvenience.",
    "created_at": "2014-06-26T08:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204160",
    "user": "https://github.com/rwst"
}
```

Not all of #8734 was merged. Sorry for the inconvenience.



---

archive/issue_comments_204161.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-26T08:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204161",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_204162.json:
```json
{
    "body": "So has the code from #8734 been reviewed? If not make it a dependency here so I don't accidentally merge it.",
    "created_at": "2014-06-26T12:24:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204162",
    "user": "https://github.com/vbraun"
}
```

So has the code from #8734 been reviewed? If not make it a dependency here so I don't accidentally merge it.



---

archive/issue_comments_204163.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-02T15:22:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204163",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204164.json:
```json
{
    "body": "I am not going to check whether this passes tests, but at any rate the changes most recent seem fine, although I don't know why the non-doctest pieces had to have the constant `C` instead of `c` (but I don't really care about that).  So if anyone checks it passes tests we are good here, since #8734 is positive review.",
    "created_at": "2014-07-02T15:48:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204164",
    "user": "https://github.com/kcrisman"
}
```

I am not going to check whether this passes tests, but at any rate the changes most recent seem fine, although I don't know why the non-doctest pieces had to have the constant `C` instead of `c` (but I don't really care about that).  So if anyone checks it passes tests we are good here, since #8734 is positive review.



---

archive/issue_comments_204165.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-03T06:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204165",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_204166.json:
```json
{
    "body": "Thanks. Pulled in changes from dependencies. I'll run a patchbot on this now.",
    "created_at": "2014-07-03T06:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204166",
    "user": "https://github.com/rwst"
}
```

Thanks. Pulled in changes from dependencies. I'll run a patchbot on this now.



---

archive/issue_events_047097.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-08T13:06:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16007#event-47097"
}
```



---

archive/issue_comments_204167.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-08T13:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16007",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16007#issuecomment-204167",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
