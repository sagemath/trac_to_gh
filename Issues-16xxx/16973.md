# Issue 16973: Shuffle algebras use words for their basis keys...

archive/issues_016736.json:
```json
{
    "body": "... which limits their functionality in an annoying and rather intransparent way:\n\n```\nsage: A = ShuffleAlgebra(QQ, ['x1','x2'])\nsage: A.gens()\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-14-53db6b193798> in <module>()\n----> 1 A.gens()\n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/misc/cachefunc.so in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12768)()\n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/algebras/shuffle_algebra.pyc in algebra_generators(self)\n    339         \"\"\"\n    340         Words = self.basis().keys()\n--> 341         return Family( [self.monomial(Words(a)) for a in self._alphabet] )\n    342         # FIXME: use this once the keys argument of FiniteFamily will be honoured\n    343         # for the specifying the order of the elements in the family\n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/combinat/words/words.pyc in __call__(self, data, length, datatype, caching, **kwds)\n    264         # The function _construct_word handles the construction of the words.\n    265         w = self._construct_word(**kwds)\n--> 266         self._check(w)\n    267         return w\n    268 \n\n/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/combinat/words/words.pyc in _check(self, w, length)\n    591         for a in itertools.islice(w, length):\n    592             if a not in self._alphabet:\n--> 593                 raise ValueError(\"%s not in alphabet!\" % a)\n    594 \n    595     def _repr_(self):\n\nValueError: x not in alphabet!\n```\n\nI wish I had an idea how to fix this.\n\nIMHO shuffle algebras and free algebras should behave alike in as many as ways as possible. They are identical as modules and differ only in their algebra and coalgebra structure (the latter of which should be implemented at some point). No, the free algebra doesn't use words for its basis keys.\n\nCC:  @nthiery @tscrim deneufchatel @fchapoton\n\nKeywords: shuffle algebra, words\n\nBranch/Commit: 031b6337aa587a4c364aa2c04dfa8b05ab0e1569\n\nReviewer: Darij Grinberg\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16973\n\n",
    "closed_at": "2014-10-09T22:30:37Z",
    "created_at": "2014-09-12T01:15:23Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Shuffle algebras use words for their basis keys...",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16973",
    "user": "https://github.com/darijgr"
}
```
... which limits their functionality in an annoying and rather intransparent way:

```
sage: A = ShuffleAlgebra(QQ, ['x1','x2'])
sage: A.gens()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-14-53db6b193798> in <module>()
----> 1 A.gens()

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/misc/cachefunc.so in sage.misc.cachefunc.CachedMethodCallerNoArgs.__call__ (build/cythonized/sage/misc/cachefunc.c:12768)()

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/algebras/shuffle_algebra.pyc in algebra_generators(self)
    339         """
    340         Words = self.basis().keys()
--> 341         return Family( [self.monomial(Words(a)) for a in self._alphabet] )
    342         # FIXME: use this once the keys argument of FiniteFamily will be honoured
    343         # for the specifying the order of the elements in the family

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/combinat/words/words.pyc in __call__(self, data, length, datatype, caching, **kwds)
    264         # The function _construct_word handles the construction of the words.
    265         w = self._construct_word(**kwds)
--> 266         self._check(w)
    267         return w
    268 

/home/darij/sage-6.3.beta6/local/lib/python2.7/site-packages/sage/combinat/words/words.pyc in _check(self, w, length)
    591         for a in itertools.islice(w, length):
    592             if a not in self._alphabet:
--> 593                 raise ValueError("%s not in alphabet!" % a)
    594 
    595     def _repr_(self):

ValueError: x not in alphabet!
```

I wish I had an idea how to fix this.

IMHO shuffle algebras and free algebras should behave alike in as many as ways as possible. They are identical as modules and differ only in their algebra and coalgebra structure (the latter of which should be implemented at some point). No, the free algebra doesn't use words for its basis keys.

CC:  @nthiery @tscrim deneufchatel @fchapoton

Keywords: shuffle algebra, words

Branch/Commit: 031b6337aa587a4c364aa2c04dfa8b05ab0e1569

Reviewer: Darij Grinberg

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16973





---

archive/issue_comments_284922.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe (short-term) fix in `algebra_generators` would be:\n\n```\nWords = self.basis().keys()\nreturn Family( [self.monomial(Words([a])) for a in self._alphabet] )\n```\nNotice the list around `a`. I'll start the branch after dinner (unless someone beats me to it).",
    "created_at": "2014-09-12T03:30:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284922",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
The (short-term) fix in `algebra_generators` would be:

```
Words = self.basis().keys()
return Family( [self.monomial(Words([a])) for a in self._alphabet] )
```
Notice the list around `a`. I'll start the branch after dinner (unless someone beats me to it).



---

archive/issue_comments_284923.json:
```json
{
    "body": "Changing branch from \"\" to \"public/algebras/shuffle_algebra_generators-16973\"",
    "created_at": "2014-09-12T05:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284923",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/algebras/shuffle_algebra_generators-16973"



---

archive/issue_comments_284924.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n|[031b633](http://git.sagemath.org/sage.git/commit/?id=031b6337aa587a4c364aa2c04dfa8b05ab0e1569)|`Fix for alphabets whose letters have length more than 1.`|",
    "created_at": "2014-09-12T05:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284924",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
|[031b633](http://git.sagemath.org/sage.git/commit/?id=031b6337aa587a4c364aa2c04dfa8b05ab0e1569)|`Fix for alphabets whose letters have length more than 1.`|



---

archive/issue_comments_284925.json:
```json
{
    "body": "Changing commit from \"\" to \"031b6337aa587a4c364aa2c04dfa8b05ab0e1569\"",
    "created_at": "2014-09-12T05:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284925",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "031b6337aa587a4c364aa2c04dfa8b05ab0e1569"



---

archive/issue_comments_284926.json:
```json
{
    "body": "Changing author from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2014-09-12T05:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284926",
    "user": "https://github.com/tscrim"
}
```

Changing author from "" to "Travis Scrimshaw"



---

archive/issue_comments_284927.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-12T05:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284927",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_284928.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-08T19:22:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284928",
    "user": "https://github.com/darijgr"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_284929.json:
```json
{
    "body": "<a id='comment:4'></a>\nI didn't give this a positive_review? Sorry! Good change.",
    "created_at": "2014-10-08T19:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284929",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:4'></a>
I didn't give this a positive_review? Sorry! Good change.



---

archive/issue_comments_284930.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Darij Grinberg\"",
    "created_at": "2014-10-08T19:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284930",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Darij Grinberg"



---

archive/issue_comments_284931.json:
```json
{
    "body": "Changing branch from \"public/algebras/shuffle_algebra_generators-16973\" to \"031b6337aa587a4c364aa2c04dfa8b05ab0e1569\"",
    "created_at": "2014-10-09T22:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284931",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/algebras/shuffle_algebra_generators-16973" to "031b6337aa587a4c364aa2c04dfa8b05ab0e1569"



---

archive/issue_comments_284932.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-09T22:30:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16973#issuecomment-284932",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_049478.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-09T22:30:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16973",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16973#event-49478"
}
```
