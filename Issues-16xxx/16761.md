# Issue 16761: symbolic_expression: Better handling of vectors and matrices

archive/issues_016524.json:
```json
{
    "body": "\n```\nsage: symbolic_expression(vector([1,2]))\n<boom>\nTypeError:\n```\nThis is pretty uninformative, esp. when it is in [the midst of a larger computation](http://ask.sagemath.org/question/23690/how-to-fit-data-to-an-arrhenius-equation/).\n\nInstead of working on the error message, we add some code to handle vector and matrix inputs.\n\n\nDepends on #14270\n\n**CC:**  @tscrim\n\n**Branch/Commit:** [0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348](https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348)\n\n**Reviewer:** Karl-Dieter Crisman, Travis Scrimshaw\n\n**Author:** Matthias Koeppe\n\nIssue created by migration from https://trac.sagemath.org/ticket/16761\n\n",
    "closed_at": "2021-08-29T09:37:59Z",
    "created_at": "2014-08-05T01:36:04Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-9.5",
    "title": "symbolic_expression: Better handling of vectors and matrices",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/16761",
    "user": "https://github.com/kcrisman"
}
```

```
sage: symbolic_expression(vector([1,2]))
<boom>
TypeError:
```
This is pretty uninformative, esp. when it is in [the midst of a larger computation](http://ask.sagemath.org/question/23690/how-to-fit-data-to-an-arrhenius-equation/).

Instead of working on the error message, we add some code to handle vector and matrix inputs.


Depends on #14270

**CC:**  @tscrim

**Branch/Commit:** [0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348](https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348)

**Reviewer:** Karl-Dieter Crisman, Travis Scrimshaw

**Author:** Matthias Koeppe

Issue created by migration from https://trac.sagemath.org/ticket/16761





---

archive/issue_events_150215.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150215"
}
```



---

archive/issue_events_150216.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150216"
}
```



---

archive/issue_events_150217.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T03:31:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150217"
}
```



---

archive/issue_events_150218.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T03:31:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150218"
}
```



---

archive/issue_comments_221991.json:
```json
{
    "body": "**Dependencies:** #32103",
    "created_at": "2021-07-06T03:31:19Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221991",
    "user": "https://github.com/mkoeppe"
}
```

**Dependencies:** #32103



---

archive/issue_comments_221992.json:
```json
{
    "body": "**Branch:** [u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression)",
    "created_at": "2021-07-06T05:02:07Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221992",
    "user": "https://github.com/mkoeppe"
}
```

**Branch:** [u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression)



---

archive/issue_events_150219.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-06T05:03:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150219"
}
```



---

archive/issue_comments_221993.json:
```json
{
    "body": "<a id='comment:4'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e523ac00d9c89e36a6341a731633b12e87ee1bd7\">e523ac0</a></td><td><code>sage.calculus.all.symbolic_expression: Handle callables</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d2e8c8f402167c5ecc0fe0ee6514ce9e21fa6bd1\">d2e8c8f</a></td><td><code>symbolic_expression: Update doctest output</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0b9408efe48d3344ef39113ba2097cefb85704eb\">0b9408e</a></td><td><code>Merge #32103</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5e3e34fab35aa537d978b11df4bb2666040f7071\">5e3e34f</a></td><td><code>symbolic_expression: Handle vectors and matrices; fix result parent for list/tuple of length 0</code></td></tr></table>\n",
    "created_at": "2021-07-06T05:03:33Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221993",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:4'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e523ac00d9c89e36a6341a731633b12e87ee1bd7">e523ac0</a></td><td><code>sage.calculus.all.symbolic_expression: Handle callables</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d2e8c8f402167c5ecc0fe0ee6514ce9e21fa6bd1">d2e8c8f</a></td><td><code>symbolic_expression: Update doctest output</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0b9408efe48d3344ef39113ba2097cefb85704eb">0b9408e</a></td><td><code>Merge #32103</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5e3e34fab35aa537d978b11df4bb2666040f7071">5e3e34f</a></td><td><code>symbolic_expression: Handle vectors and matrices; fix result parent for list/tuple of length 0</code></td></tr></table>




---

archive/issue_comments_221994.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,9 +6,5 @@\n ```\n This is pretty uninformative, esp. when it is in [the midst of a larger computation](http://ask.sagemath.org/question/23690/how-to-fit-data-to-an-arrhenius-equation/).\n \n-I'm not suggesting we make a vector a symbolic expression, though of course \n+Instead of working on the error message, we add some code to handle vector and matrix inputs.\n \n-```\n-sage: vector([x,2*x])\n-```\n-works so we could go that way.\n``````\n",
    "created_at": "2021-07-06T05:03:33Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221994",
    "user": "https://github.com/mkoeppe"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,9 +6,5 @@
 ```
 This is pretty uninformative, esp. when it is in [the midst of a larger computation](http://ask.sagemath.org/question/23690/how-to-fit-data-to-an-arrhenius-equation/).
 
-I'm not suggesting we make a vector a symbolic expression, though of course 
+Instead of working on the error message, we add some code to handle vector and matrix inputs.
 
-```
-sage: vector([x,2*x])
-```
-works so we could go that way.
``````




---

archive/issue_comments_221995.json:
```json
{
    "body": "**Commit:** [5e3e34fab35aa537d978b11df4bb2666040f7071](https://github.com/sagemath/sagetrac-mirror/commit/5e3e34fab35aa537d978b11df4bb2666040f7071)",
    "created_at": "2021-07-06T05:03:33Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221995",
    "user": "https://github.com/mkoeppe"
}
```

**Commit:** [5e3e34fab35aa537d978b11df4bb2666040f7071](https://github.com/sagemath/sagetrac-mirror/commit/5e3e34fab35aa537d978b11df4bb2666040f7071)



---

archive/issue_comments_221996.json:
```json
{
    "body": "**Author:** Matthias Koeppe",
    "created_at": "2021-07-06T05:03:33Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221996",
    "user": "https://github.com/mkoeppe"
}
```

**Author:** Matthias Koeppe



---

archive/issue_comments_221997.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt's always so great to wake up to someone working on a ticket from seven years ago :-)\n\nI agree that this is the preferred way to handle it, and on a first pass the code looks good for it.  I do have two usage questions.\n\n```\nsage: f = symbolic_expression(lambda z: z^2 + 1); f\n```\nAm I correct that this does *not* inject `z` into the global namespace?  This seems to be how you constructed it with `SR.var`.\n\nAlso, I'm not familiar with `SR.subring(no_variables=True)`, which is presumably what generates the \"Symbolic Constants Subring\".  If someone later wanted to take something like `symbolic_expression(vector(QQ, 0))` and then add it to another (zero-dimensional) vector, how would that behave?  Would it complain because it has a different base ring?  Or would it do the \"obvious\" thing in any of these degenerate cases?  I don't know if there is a \"right\" answer here (for degenerate cases), but I wanted to ask.\n\nFinally, it could be fun to exemplify the recursive nature of the code by having a vector composed of vector functions or something.  Though I doubt that would be a real use case; this ticket is more to make sure that if people insist on making everything \"symbolic\" that nothing goes boom.",
    "created_at": "2021-07-06T12:05:40Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221997",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>
It's always so great to wake up to someone working on a ticket from seven years ago :-)

I agree that this is the preferred way to handle it, and on a first pass the code looks good for it.  I do have two usage questions.

```
sage: f = symbolic_expression(lambda z: z^2 + 1); f
```
Am I correct that this does *not* inject `z` into the global namespace?  This seems to be how you constructed it with `SR.var`.

Also, I'm not familiar with `SR.subring(no_variables=True)`, which is presumably what generates the "Symbolic Constants Subring".  If someone later wanted to take something like `symbolic_expression(vector(QQ, 0))` and then add it to another (zero-dimensional) vector, how would that behave?  Would it complain because it has a different base ring?  Or would it do the "obvious" thing in any of these degenerate cases?  I don't know if there is a "right" answer here (for degenerate cases), but I wanted to ask.

Finally, it could be fun to exemplify the recursive nature of the code by having a vector composed of vector functions or something.  Though I doubt that would be a real use case; this ticket is more to make sure that if people insist on making everything "symbolic" that nothing goes boom.



---

archive/issue_comments_221998.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [kcrisman](#comment%3A5):\n> \n> ```\n> sage: f = symbolic_expression(lambda z: z^2 + 1); f\n> ```\n> Am I correct that this does *not* inject `z` into the global namespace?  This seems to be how you constructed it with `SR.var`.\n\nThat's right. (Note this is from #32103, not the present ticket.)",
    "created_at": "2021-07-06T12:34:35Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221998",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:6'></a>
Replying to [kcrisman](#comment%3A5):
> 
> ```
> sage: f = symbolic_expression(lambda z: z^2 + 1); f
> ```
> Am I correct that this does *not* inject `z` into the global namespace?  This seems to be how you constructed it with `SR.var`.

That's right. (Note this is from #32103, not the present ticket.)



---

archive/issue_comments_221999.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [kcrisman](#comment%3A5):\n> Also, I'm not familiar with `SR.subring(no_variables=True)`, which is presumably what generates the \"Symbolic Constants Subring\".  If someone later wanted to take something like `symbolic_expression(vector(QQ, 0))` and then add it to another (zero-dimensional) vector, how would that behave?\n\nThe coercion system takes care of it:\n\n```\nsage: vector(SR.subring(no_variables=True), 0) + vector(SR, 0) + vector(ZZ, 0)\n()\nsage: _.parent()\nVector space of dimension 0 over Symbolic Ring\n```",
    "created_at": "2021-07-06T12:36:26Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-221999",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:7'></a>
Replying to [kcrisman](#comment%3A5):
> Also, I'm not familiar with `SR.subring(no_variables=True)`, which is presumably what generates the "Symbolic Constants Subring".  If someone later wanted to take something like `symbolic_expression(vector(QQ, 0))` and then add it to another (zero-dimensional) vector, how would that behave?

The coercion system takes care of it:

```
sage: vector(SR.subring(no_variables=True), 0) + vector(SR, 0) + vector(ZZ, 0)
()
sage: _.parent()
Vector space of dimension 0 over Symbolic Ring
```



---

archive/issue_comments_222000.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [kcrisman](#comment%3A5):\n > it could be fun to exemplify the recursive nature of the code by having a vector composed of vector functions or something.  Though I doubt that would be a real use case; this ticket is more to make sure that if people insist on making everything \"symbolic\" that nothing goes boom.\n\nI think I'd rather not advertise more complicated possible uses of this function at this point. I only became aware of its existence when I was looking for a preparser-less idiom for creating callable symbolic expressions (#32103).",
    "created_at": "2021-07-06T12:43:38Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222000",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:8'></a>
Replying to [kcrisman](#comment%3A5):
 > it could be fun to exemplify the recursive nature of the code by having a vector composed of vector functions or something.  Though I doubt that would be a real use case; this ticket is more to make sure that if people insist on making everything "symbolic" that nothing goes boom.

I think I'd rather not advertise more complicated possible uses of this function at this point. I only became aware of its existence when I was looking for a preparser-less idiom for creating callable symbolic expressions (#32103).



---

archive/issue_comments_222001.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman",
    "created_at": "2021-07-06T12:49:41Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222001",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman



---

archive/issue_comments_222002.json:
```json
{
    "body": "<a id='comment:9'></a>\n> I only became aware of its existence when I was looking for a preparser-less idiom for creating callable symbolic expressions (#32103). \n\nI see now.  I certainly can give positive review to the changes for this ticket (modulo green patchbot).  I'll make one or two other comments there.  Thanks for fixing this!",
    "created_at": "2021-07-06T12:49:41Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222002",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
> I only became aware of its existence when I was looking for a preparser-less idiom for creating callable symbolic expressions (#32103). 

I see now.  I certainly can give positive review to the changes for this ticket (modulo green patchbot).  I'll make one or two other comments there.  Thanks for fixing this!



---

archive/issue_comments_222003.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2b5535ff600251430fee311881d319fea5e65082\">2b5535f</a></td><td><code>sage.calculus.all.symbolic_expression: Add more tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b2c8b8ec7df50c65a739f262cf7adee5baada8b3\">b2c8b8e</a></td><td><code>Merge #32103</code></td></tr></table>\n",
    "created_at": "2021-07-06T13:41:46Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222003",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2b5535ff600251430fee311881d319fea5e65082">2b5535f</a></td><td><code>sage.calculus.all.symbolic_expression: Add more tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b2c8b8ec7df50c65a739f262cf7adee5baada8b3">b2c8b8e</a></td><td><code>Merge #32103</code></td></tr></table>




---

archive/issue_comments_222004.json:
```json
{
    "body": "**Changing commit** from \"[5e3e34fab35aa537d978b11df4bb2666040f7071](https://github.com/sagemath/sagetrac-mirror/commit/5e3e34fab35aa537d978b11df4bb2666040f7071)\" to \"[b2c8b8ec7df50c65a739f262cf7adee5baada8b3](https://github.com/sagemath/sagetrac-mirror/commit/b2c8b8ec7df50c65a739f262cf7adee5baada8b3)\".",
    "created_at": "2021-07-06T13:41:46Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222004",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5e3e34fab35aa537d978b11df4bb2666040f7071](https://github.com/sagemath/sagetrac-mirror/commit/5e3e34fab35aa537d978b11df4bb2666040f7071)" to "[b2c8b8ec7df50c65a739f262cf7adee5baada8b3](https://github.com/sagemath/sagetrac-mirror/commit/b2c8b8ec7df50c65a739f262cf7adee5baada8b3)".



---

archive/issue_events_150220.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-26T17:55:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150220"
}
```



---

archive/issue_events_150221.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-26T17:55:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150221"
}
```



---

archive/issue_comments_222005.json:
```json
{
    "body": "<a id='comment:11'></a>\nDoctest failures",
    "created_at": "2021-07-26T17:55:14Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222005",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:11'></a>
Doctest failures



---

archive/issue_comments_222006.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4ace52bfddee6a937458553025bdbd195ba9236\">a4ace52</a></td><td><code>Merge tag '9.4.beta6' into t/16761/error_message_bad_when_trying_to_make_vector_symbolic_expression</code></td></tr></table>\n",
    "created_at": "2021-07-26T20:14:54Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222006",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4ace52bfddee6a937458553025bdbd195ba9236">a4ace52</a></td><td><code>Merge tag '9.4.beta6' into t/16761/error_message_bad_when_trying_to_make_vector_symbolic_expression</code></td></tr></table>




---

archive/issue_comments_222007.json:
```json
{
    "body": "**Changing commit** from \"[b2c8b8ec7df50c65a739f262cf7adee5baada8b3](https://github.com/sagemath/sagetrac-mirror/commit/b2c8b8ec7df50c65a739f262cf7adee5baada8b3)\" to \"[a4ace52bfddee6a937458553025bdbd195ba9236](https://github.com/sagemath/sagetrac-mirror/commit/a4ace52bfddee6a937458553025bdbd195ba9236)\".",
    "created_at": "2021-07-26T20:14:54Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222007",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b2c8b8ec7df50c65a739f262cf7adee5baada8b3](https://github.com/sagemath/sagetrac-mirror/commit/b2c8b8ec7df50c65a739f262cf7adee5baada8b3)" to "[a4ace52bfddee6a937458553025bdbd195ba9236](https://github.com/sagemath/sagetrac-mirror/commit/a4ace52bfddee6a937458553025bdbd195ba9236)".



---

archive/issue_events_150222.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-26T20:15:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150222"
}
```



---

archive/issue_events_150223.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-26T20:15:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150223"
}
```



---

archive/issue_comments_222008.json:
```json
{
    "body": "<a id='comment:14'></a>\nDo we also want to support the case when a list of lists is passed to create a symbolic matrix? It could be done by\n\n```diff\n     elif isinstance(x, (tuple, list)) or is_FreeModuleElement(x):\n         expressions = [symbolic_expression(item) for item in x]\n         if not expressions:\n             # Make sure it is symbolic also when length is 0\n             return vector(SR.subring(no_variables=True), 0)\n+        if is_FreeModuleElement(expressions[0]):\n+            return matrix(expressions)\n         return vector(expressions)\n```",
    "created_at": "2021-07-26T22:43:37Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222008",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:14'></a>
Do we also want to support the case when a list of lists is passed to create a symbolic matrix? It could be done by

```diff
     elif isinstance(x, (tuple, list)) or is_FreeModuleElement(x):
         expressions = [symbolic_expression(item) for item in x]
         if not expressions:
             # Make sure it is symbolic also when length is 0
             return vector(SR.subring(no_variables=True), 0)
+        if is_FreeModuleElement(expressions[0]):
+            return matrix(expressions)
         return vector(expressions)
```



---

archive/issue_comments_222009.json:
```json
{
    "body": "<a id='comment:15'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eee0def9032500f85de574d82ba51f1e904af071\">eee0def</a></td><td><code>symbolic_expression: Make matrices from lists of lists etc.</code></td></tr></table>\n",
    "created_at": "2021-07-26T23:45:39Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222009",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eee0def9032500f85de574d82ba51f1e904af071">eee0def</a></td><td><code>symbolic_expression: Make matrices from lists of lists etc.</code></td></tr></table>




---

archive/issue_comments_222010.json:
```json
{
    "body": "**Changing commit** from \"[a4ace52bfddee6a937458553025bdbd195ba9236](https://github.com/sagemath/sagetrac-mirror/commit/a4ace52bfddee6a937458553025bdbd195ba9236)\" to \"[eee0def9032500f85de574d82ba51f1e904af071](https://github.com/sagemath/sagetrac-mirror/commit/eee0def9032500f85de574d82ba51f1e904af071)\".",
    "created_at": "2021-07-26T23:45:39Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222010",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a4ace52bfddee6a937458553025bdbd195ba9236](https://github.com/sagemath/sagetrac-mirror/commit/a4ace52bfddee6a937458553025bdbd195ba9236)" to "[eee0def9032500f85de574d82ba51f1e904af071](https://github.com/sagemath/sagetrac-mirror/commit/eee0def9032500f85de574d82ba51f1e904af071)".



---

archive/issue_comments_222011.json:
```json
{
    "body": "<a id='comment:16'></a>\nGood idea, done",
    "created_at": "2021-07-26T23:46:07Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222011",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:16'></a>
Good idea, done



---

archive/issue_comments_222012.json:
```json
{
    "body": "<a id='comment:17'></a>\nThanks. Green bot => positive review.",
    "created_at": "2021-07-27T01:53:10Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222012",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:17'></a>
Thanks. Green bot => positive review.



---

archive/issue_comments_222013.json:
```json
{
    "body": "**Changing reviewer** from \"Karl-Dieter Crisman\" to \"Karl-Dieter Crisman, Travis Scrimshaw\".",
    "created_at": "2021-07-27T01:53:10Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222013",
    "user": "https://github.com/tscrim"
}
```

**Changing reviewer** from "Karl-Dieter Crisman" to "Karl-Dieter Crisman, Travis Scrimshaw".



---

archive/issue_comments_222014.json:
```json
{
    "body": "**Changing dependencies** from \"#32103\" to \"#14270\".",
    "created_at": "2021-08-03T18:54:12Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222014",
    "user": "https://github.com/mkoeppe"
}
```

**Changing dependencies** from "#32103" to "#14270".



---

archive/issue_comments_222015.json:
```json
{
    "body": "<a id='comment:19'></a>\nUsing the symbolic constants ring actually depends on #31999, #31988",
    "created_at": "2021-08-03T19:13:58Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222015",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:19'></a>
Using the symbolic constants ring actually depends on #31999, #31988



---

archive/issue_comments_222016.json:
```json
{
    "body": "**Changing commit** from \"[eee0def9032500f85de574d82ba51f1e904af071](https://github.com/sagemath/sagetrac-mirror/commit/eee0def9032500f85de574d82ba51f1e904af071)\" to \"[9666263fa7e56a0dccead48fcae3b6555ec539ac](https://github.com/sagemath/sagetrac-mirror/commit/9666263fa7e56a0dccead48fcae3b6555ec539ac)\".",
    "created_at": "2021-08-03T19:32:34Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222016",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[eee0def9032500f85de574d82ba51f1e904af071](https://github.com/sagemath/sagetrac-mirror/commit/eee0def9032500f85de574d82ba51f1e904af071)" to "[9666263fa7e56a0dccead48fcae3b6555ec539ac](https://github.com/sagemath/sagetrac-mirror/commit/9666263fa7e56a0dccead48fcae3b6555ec539ac)".



---

archive/issue_comments_222017.json:
```json
{
    "body": "<a id='comment:20'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9666263fa7e56a0dccead48fcae3b6555ec539ac\">9666263</a></td><td><code>symbolic_expression: Do not try to use the Symbolic Constants Subring when creating matrices/vectors with dim 0</code></td></tr></table>\n",
    "created_at": "2021-08-03T19:32:34Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222017",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9666263fa7e56a0dccead48fcae3b6555ec539ac">9666263</a></td><td><code>symbolic_expression: Do not try to use the Symbolic Constants Subring when creating matrices/vectors with dim 0</code></td></tr></table>




---

archive/issue_comments_222018.json:
```json
{
    "body": "<a id='comment:21'></a>\nAnother issue remains - symbolic matrices have no `function` method\n\n```\nsage -t --random-seed=0 src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 3186, in sage.symbolic.expression.Expression.__nonzero__\nFailed example:\n    f(x) = matrix()\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py\", line 718, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py\", line 1137, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.expression.Expression.__nonzero__[87]>\", line 1, in <module>\n        __tmp__=var(\"x\"); f = symbolic_expression(matrix()).function(x)\n      File \"sage/structure/element.pyx\", line 493, in sage.structure.element.Element.__getattr__\n        return self.getattr_from_category(name)\n      File \"sage/structure/element.pyx\", line 506, in sage.structure.element.Element.getattr_from_category\n        return getattr_from_other_class(self, cls, name)\n      File \"sage/cpython/getattr.pyx\", line 372, in sage.cpython.getattr.getattr_from_other_class\n        raise AttributeError(dummy_error_message)\n    AttributeError: 'sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense' object has no attribute 'function'\n```",
    "created_at": "2021-08-03T19:37:35Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222018",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:21'></a>
Another issue remains - symbolic matrices have no `function` method

```
sage -t --random-seed=0 src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 3186, in sage.symbolic.expression.Expression.__nonzero__
Failed example:
    f(x) = matrix()
Exception raised:
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 718, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 1137, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.expression.Expression.__nonzero__[87]>", line 1, in <module>
        __tmp__=var("x"); f = symbolic_expression(matrix()).function(x)
      File "sage/structure/element.pyx", line 493, in sage.structure.element.Element.__getattr__
        return self.getattr_from_category(name)
      File "sage/structure/element.pyx", line 506, in sage.structure.element.Element.getattr_from_category
        return getattr_from_other_class(self, cls, name)
      File "sage/cpython/getattr.pyx", line 372, in sage.cpython.getattr.getattr_from_other_class
        raise AttributeError(dummy_error_message)
    AttributeError: 'sage.matrix.matrix_symbolic_dense.Matrix_symbolic_dense' object has no attribute 'function'
```



---

archive/issue_comments_222019.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348\">0623d79</a></td><td><code>Matrix_symbolic_dense.function: New</code></td></tr></table>\n",
    "created_at": "2021-08-03T19:49:42Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222019",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348">0623d79</a></td><td><code>Matrix_symbolic_dense.function: New</code></td></tr></table>




---

archive/issue_comments_222020.json:
```json
{
    "body": "**Changing commit** from \"[9666263fa7e56a0dccead48fcae3b6555ec539ac](https://github.com/sagemath/sagetrac-mirror/commit/9666263fa7e56a0dccead48fcae3b6555ec539ac)\" to \"[0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348](https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348)\".",
    "created_at": "2021-08-03T19:49:42Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[9666263fa7e56a0dccead48fcae3b6555ec539ac](https://github.com/sagemath/sagetrac-mirror/commit/9666263fa7e56a0dccead48fcae3b6555ec539ac)" to "[0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348](https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348)".



---

archive/issue_comments_222021.json:
```json
{
    "body": "<a id='comment:23'></a>\nThis works now but it is not perfect yet because we do not have a matrix element class in analogy to `Vector_callable_symbolic_dense`, so the repr of such callable symbolic matrices does not look nice. But this is a cosmetic wishlist item that is already noted in #31988.",
    "created_at": "2021-08-03T20:03:23Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222021",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:23'></a>
This works now but it is not perfect yet because we do not have a matrix element class in analogy to `Vector_callable_symbolic_dense`, so the repr of such callable symbolic matrices does not look nice. But this is a cosmetic wishlist item that is already noted in #31988.



---

archive/issue_events_150224.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-03T20:05:05Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "rename": {
        "from": "Error message bad when trying to make vector symbolic expression",
        "to": "symbolic_expression: Better handling of vectors and matrices"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150224"
}
```



---

archive/issue_comments_222022.json:
```json
{
    "body": "<a id='comment:25'></a>\nI have noticed in the past other inconsistencies between matrices and vectors over symbolic rings with elements in SR. I just can't remember them now. We can just add any missing functionality as we come across it.\n\nAnyways, the current branch LGTM.",
    "created_at": "2021-08-05T22:40:02Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222022",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:25'></a>
I have noticed in the past other inconsistencies between matrices and vectors over symbolic rings with elements in SR. I just can't remember them now. We can just add any missing functionality as we come across it.

Anyways, the current branch LGTM.



---

archive/issue_events_150225.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-08-05T22:40:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150225"
}
```



---

archive/issue_events_150226.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2021-08-05T22:40:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150226"
}
```



---

archive/issue_comments_222023.json:
```json
{
    "body": "<a id='comment:26'></a>\nThanks!",
    "created_at": "2021-08-09T20:01:26Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222023",
    "user": "https://github.com/mkoeppe"
}
```

<a id='comment:26'></a>
Thanks!



---

archive/issue_events_150227.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150227"
}
```



---

archive/issue_events_150228.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-09T21:07:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150228"
}
```



---

archive/issue_comments_222024.json:
```json
{
    "body": "**Changing branch** from \"[u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression)\" to \"[0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348](https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348)\".",
    "created_at": "2021-08-29T09:37:59Z",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16761#issuecomment-222024",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression](https://github.com/sagemath/sagetrac-mirror/tree/u/mkoeppe/error_message_bad_when_trying_to_make_vector_symbolic_expression)" to "[0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348](https://github.com/sagemath/sagetrac-mirror/commit/0623d795c7e1d8a90cc06d9fa0b618f4ee4e9348)".



---

archive/issue_events_150229.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2021-08-29T09:37:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150229"
}
```



---

archive/issue_events_150230.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3ecf4ba9042ea49a79ab7222d429776039a5b168",
    "created_at": "2021-08-29T09:37:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16761",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16761#event-150230"
}
```
