# Issue 16308: Improve sums of squares

archive/issues_016071.json:
```json
{
    "body": "This ticket will:\n- add a Sage implementation of writing a number as a sum of 2 squares\n- add a Sage implementation of writing a number as a sum of 3 squares\n- add a Sage implementation of writing a number as a sum of 4 squares\n- add a Sage implementation of writing a number as a sum of `k` squares for any `k`\n\nfollow up: #16374\n\nCC:  @nathanncohen @kcrisman @videlec\n\nBranch/Commit: [f071a8db1316a7bf8503f6c6c9227fcaa6b953f7](https://github.com/sagemath/sagetrac-mirror/commit/f071a8db1316a7bf8503f6c6c9227fcaa6b953f7)\n\nReviewer: Peter Bruin, Leif Leonhardy , Vincent Delecroix\n\nAuthor: Jeroen Demeyer\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16308\n\n",
    "closed_at": "2014-06-26T19:37:47Z",
    "created_at": "2014-05-08T09:28:38Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Improve sums of squares",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16308",
    "user": "https://github.com/jdemeyer"
}
```
This ticket will:
- add a Sage implementation of writing a number as a sum of 2 squares
- add a Sage implementation of writing a number as a sum of 3 squares
- add a Sage implementation of writing a number as a sum of 4 squares
- add a Sage implementation of writing a number as a sum of `k` squares for any `k`

follow up: #16374

CC:  @nathanncohen @kcrisman @videlec

Branch/Commit: [f071a8db1316a7bf8503f6c6c9227fcaa6b953f7](https://github.com/sagemath/sagetrac-mirror/commit/f071a8db1316a7bf8503f6c6c9227fcaa6b953f7)

Reviewer: Peter Bruin, Leif Leonhardy , Vincent Delecroix

Author: Jeroen Demeyer

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16308





---

archive/issue_comments_271597.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,7 @@\n Writing an integer as sum of N squares.\n+\n+There are various questions:\n+- Is it possible to write an integer *n* as a sum of *k* squares?\n+- What is the number of ways in which one can do this?\n+- Find a solution if there exists one.\n+\n``````\n",
    "created_at": "2014-05-08T09:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271597",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,7 @@
 Writing an integer as sum of N squares.
+
+There are various questions:
+- Is it possible to write an integer *n* as a sum of *k* squares?
+- What is the number of ways in which one can do this?
+- Find a solution if there exists one.
+
``````




---

archive/issue_comments_271598.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,6 @@\n-Writing an integer as sum of N squares.\n+Writing an integer as sum of k squares.\n \n-There are various questions:\n-- Is it possible to write an integer *n* as a sum of *k* squares?\n-- What is the number of ways in which one can do this?\n-- Find a solution if there exists one.\n-\n+This ticket will:\n+- add a Sage implementation of writing a number as a sum of 2 squares\n+- add a Sage implementation of writing a number as a sum of 3 squares\n+- add a Sage implementation of writing a number as a sum of k squares for any k >= 4\n``````\n",
    "created_at": "2014-05-08T10:23:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271598",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,6 @@
-Writing an integer as sum of N squares.
+Writing an integer as sum of k squares.
 
-There are various questions:
-- Is it possible to write an integer *n* as a sum of *k* squares?
-- What is the number of ways in which one can do this?
-- Find a solution if there exists one.
-
+This ticket will:
+- add a Sage implementation of writing a number as a sum of 2 squares
+- add a Sage implementation of writing a number as a sum of 3 squares
+- add a Sage implementation of writing a number as a sum of k squares for any k >= 4
``````




---

archive/issue_comments_271599.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,5 @@\n-Writing an integer as sum of k squares.\n-\n This ticket will:\n - add a Sage implementation of writing a number as a sum of 2 squares\n - add a Sage implementation of writing a number as a sum of 3 squares\n-- add a Sage implementation of writing a number as a sum of k squares for any k >= 4\n+- add a Sage implementation of writing a number as a sum of 4 squares\n+- add a Sage implementation of writing a number as a sum of `k` squares for any `k`\n``````\n",
    "created_at": "2014-05-08T13:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271599",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,5 @@
-Writing an integer as sum of k squares.
-
 This ticket will:
 - add a Sage implementation of writing a number as a sum of 2 squares
 - add a Sage implementation of writing a number as a sum of 3 squares
-- add a Sage implementation of writing a number as a sum of k squares for any k >= 4
+- add a Sage implementation of writing a number as a sum of 4 squares
+- add a Sage implementation of writing a number as a sum of `k` squares for any `k`
``````




---

archive/issue_comments_271600.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [jdemeyer](#comment%3A2):\n\nOK, I should have written a comment to ask what the idea was instead of adding possible interpretations to the description.  Given that your name is in the Author field, are you working on this?",
    "created_at": "2014-05-08T13:51:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271600",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:5'></a>
Replying to [jdemeyer](#comment%3A2):

OK, I should have written a comment to ask what the idea was instead of adding possible interpretations to the description.  Given that your name is in the Author field, are you working on this?



---

archive/issue_comments_271601.json:
```json
{
    "body": "<a id='comment:6'></a>\nDefine \"number\".",
    "created_at": "2014-05-08T14:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271601",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:6'></a>
Define "number".



---

archive/issue_comments_271602.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [leif](#comment%3A6):\n> Define \"number\".\n\nElement of `ZZ`.",
    "created_at": "2014-05-08T15:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271602",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>
Replying to [leif](#comment%3A6):
> Define "number".

Element of `ZZ`.



---

archive/issue_comments_271603.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/ticket/16308\"",
    "created_at": "2014-05-08T16:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271603",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/ticket/16308"



---

archive/issue_comments_271604.json:
```json
{
    "body": "Changing commit from \"\" to \"6b94a6576031e6e341143a4fc1fd83263a800ed9\"",
    "created_at": "2014-05-08T16:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271604",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "6b94a6576031e6e341143a4fc1fd83263a800ed9"



---

archive/issue_comments_271605.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-08T16:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271605",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_271606.json:
```json
{
    "body": "<a id='comment:9'></a>\nNew commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[6b94a65](https://github.com/sagemath/sagetrac-mirror/commit/6b94a6576031e6e341143a4fc1fd83263a800ed9)|`Improve sums of squares of integers`|",
    "created_at": "2014-05-08T16:15:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271606",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[6b94a65](https://github.com/sagemath/sagetrac-mirror/commit/6b94a6576031e6e341143a4fc1fd83263a800ed9)|`Improve sums of squares of integers`|



---

archive/issue_comments_271607.json:
```json
{
    "body": "<a id='comment:10'></a>\nIt is embarrassing to say so, but for many examples, the old GAP code is actually faster. The reason seems to be that GAP beats PARI on factoring small numbers (which is a big surprise to me!). But GAP doesn't support large numbers:\n\n```\nsage: two_squares(3^100+1)\nRuntimeError: Gap produced error output\nError, sorry,  cannot factor [ 1109667565348268894775749972955601 ]\ntype 'return;' to try again with a larger number of trials in\nFactorsRho (or use option 'RhoTrials')\n\n\n   executing TwoSquares(515377520732011331036461129765621272702107522002);\n\n```",
    "created_at": "2014-05-08T16:25:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271607",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>
It is embarrassing to say so, but for many examples, the old GAP code is actually faster. The reason seems to be that GAP beats PARI on factoring small numbers (which is a big surprise to me!). But GAP doesn't support large numbers:

```
sage: two_squares(3^100+1)
RuntimeError: Gap produced error output
Error, sorry,  cannot factor [ 1109667565348268894775749972955601 ]
type 'return;' to try again with a larger number of trials in
FactorsRho (or use option 'RhoTrials')


   executing TwoSquares(515377520732011331036461129765621272702107522002);

```



---

archive/issue_comments_271608.json:
```json
{
    "body": "<a id='comment:11'></a>\nGAP is amazing:\n\n```\nsage: timeit('libgap(19180172397815991981).FactorsInt()', number=1000, repeat=10)\n1000 loops, best of 10: 103 \u00b5s per loop\nsage: timeit('pari(19180172397815991981).factor(proof=False)', number=1000, repeat=10)\n1000 loops, best of 10: 2.43 ms per loop\n```",
    "created_at": "2014-05-08T16:31:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271608",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
GAP is amazing:

```
sage: timeit('libgap(19180172397815991981).FactorsInt()', number=1000, repeat=10)
1000 loops, best of 10: 103 µs per loop
sage: timeit('pari(19180172397815991981).factor(proof=False)', number=1000, repeat=10)
1000 loops, best of 10: 2.43 ms per loop
```



---

archive/issue_comments_271609.json:
```json
{
    "body": "<a id='comment:12'></a>\nInteresting...  Since this code is probably not the place where Sage should have to make a decision about which factoring algorithm to use, it looks tempting to use `Integer.factor()` instead of `pari.factor()` and spend some effort on #1145.  (And possibly add support for `algorithm=gap` in `Integer.factor()` if it is worthwhile?)",
    "created_at": "2014-05-08T16:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271609",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:12'></a>
Interesting...  Since this code is probably not the place where Sage should have to make a decision about which factoring algorithm to use, it looks tempting to use `Integer.factor()` instead of `pari.factor()` and spend some effort on #1145.  (And possibly add support for `algorithm=gap` in `Integer.factor()` if it is worthwhile?)



---

archive/issue_comments_271610.json:
```json
{
    "body": "<a id='comment:13'></a>\nAnd I'd still support the `algorithm` keyword...\n\nDoes make returning `(a,b)` with a (or b) zero any sense?",
    "created_at": "2014-05-08T16:59:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271610",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
And I'd still support the `algorithm` keyword...

Does make returning `(a,b)` with a (or b) zero any sense?



---

archive/issue_comments_271611.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [leif](#comment%3A13):\n> Does make returning `(a,b)` with a (or b) zero any sense?\n\n\nTo be more precise, IMHO both a and b should be < n<sup>1/2</sup> (for `two_squares()`).\n\nI don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.",
    "created_at": "2014-05-08T17:19:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271611",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
Replying to [leif](#comment%3A13):
> Does make returning `(a,b)` with a (or b) zero any sense?


To be more precise, IMHO both a and b should be < n<sup>1/2</sup> (for `two_squares()`).

I don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.



---

archive/issue_comments_271612.json:
```json
{
    "body": "<a id='comment:15'></a>\n(GAP apparently only returns (0,sqrt(n)) if there is no other solution, with sqrt(n) integer of course.)",
    "created_at": "2014-05-08T17:32:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271612",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'></a>
(GAP apparently only returns (0,sqrt(n)) if there is no other solution, with sqrt(n) integer of course.)



---

archive/issue_comments_271613.json:
```json
{
    "body": "<a id='comment:16'></a>\n> I don't think anybody would expect e.g. two_squares(25) to return the trivial solution (0,5) instead of (3,4).\n\nHmm, well that IS a solution.  And if you want to use it to approximate the value of pi, you need all of them (though this one in any case wouldn't give negative solutions).",
    "created_at": "2014-05-08T17:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271613",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:16'></a>
> I don't think anybody would expect e.g. two_squares(25) to return the trivial solution (0,5) instead of (3,4).

Hmm, well that IS a solution.  And if you want to use it to approximate the value of pi, you need all of them (though this one in any case wouldn't give negative solutions).



---

archive/issue_comments_271614.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [kcrisman](#comment%3A16):\n> > I don't think anybody would expect e.g. two_squares(25) to return the trivial solution (0,5) instead of (3,4).\n\n> Hmm, well that IS a solution.\n\nDepends on the definition of two_squares(); the previous one in Sage was pretty vague.",
    "created_at": "2014-05-08T18:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271614",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'></a>
Replying to [kcrisman](#comment%3A16):
> > I don't think anybody would expect e.g. two_squares(25) to return the trivial solution (0,5) instead of (3,4).

> Hmm, well that IS a solution.

Depends on the definition of two_squares(); the previous one in Sage was pretty vague.



---

archive/issue_comments_271615.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [leif](#comment%3A14):\n> I don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.\n\n\nFrom a number-theory point of view, there is nothing wrong with `(0,5)`. In fact, in some cases, the only solution is the \"trivial\" one, for example for 9.",
    "created_at": "2014-05-08T19:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271615",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
Replying to [leif](#comment%3A14):
> I don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.


From a number-theory point of view, there is nothing wrong with `(0,5)`. In fact, in some cases, the only solution is the "trivial" one, for example for 9.



---

archive/issue_comments_271616.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [pbruin](#comment%3A12):\n> Interesting...  Since this code is probably not the place where Sage should have to make a decision about which factoring algorithm to use, it looks tempting to use `Integer.factor()` instead of `pari.factor()`\n  \nI guess you're right, but I decided to do everything in PARI for speed, also with the idea that the code could be changed to use direct calls to the PARI library if needed.",
    "created_at": "2014-05-08T19:49:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271616",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
Replying to [pbruin](#comment%3A12):
> Interesting...  Since this code is probably not the place where Sage should have to make a decision about which factoring algorithm to use, it looks tempting to use `Integer.factor()` instead of `pari.factor()`
  
I guess you're right, but I decided to do everything in PARI for speed, also with the idea that the code could be changed to use direct calls to the PARI library if needed.



---

archive/issue_comments_271617.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [jdemeyer](#comment%3A18):\n> Replying to [leif](#comment%3A14):\n> > I don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.\n\n> \n> From a number-theory point of view, there is nothing wrong with `(0,5)`. In fact, in some cases, the only solution is the \"trivial\" one, for example for 9.\n\n\nAs mentioned, depends on how you specify two_squares().\n\nFrom a user perspective, I think there should be some optional argument `no_trivial_solutions`, as feeding the function with perfect squares otherwise doesn't make much sense.",
    "created_at": "2014-05-08T19:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271617",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'></a>
Replying to [jdemeyer](#comment%3A18):
> Replying to [leif](#comment%3A14):
> > I don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.

> 
> From a number-theory point of view, there is nothing wrong with `(0,5)`. In fact, in some cases, the only solution is the "trivial" one, for example for 9.


As mentioned, depends on how you specify two_squares().

From a user perspective, I think there should be some optional argument `no_trivial_solutions`, as feeding the function with perfect squares otherwise doesn't make much sense.



---

archive/issue_comments_271618.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [leif](#comment%3A20):\n> as feeding the function with perfect squares otherwise doesn't make much sense.\n\nDepends on your application...\n\nAnyway, if people really care about non-trivial solutions, let those people implement such a flag, I'm not going to do it.",
    "created_at": "2014-05-08T20:07:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271618",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>
Replying to [leif](#comment%3A20):
> as feeding the function with perfect squares otherwise doesn't make much sense.

Depends on your application...

Anyway, if people really care about non-trivial solutions, let those people implement such a flag, I'm not going to do it.



---

archive/issue_comments_271619.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [jdemeyer](#comment%3A18):\n> Replying to [leif](#comment%3A14):\n> > I don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.\n\n> \n> From a number-theory point of view, there is nothing wrong with `(0,5)`. In fact, in some cases, the only solution is the \"trivial\" one, for example for 9.\n\nI agree.  Given that 0 is a square, it makes complete sense to allow it as a term in a sum of squares.  That convention makes a lot of things nicer, for example:\n- every square is also a sum of two squares, and more generally every sum of *k* squares is also a sum of *k* + 1 squares;\n- *n* is a sum of 2 squares if and only if *n* can be factored non-trivially in **Z**[*i*];\n- *n* is a sum of *k* squares if and only if the lattice **Z**<sup>*k*</sup> has a point of squared distance *n* from the origin.\nThere are also nice formulae for the number of ways to write *n* as a sum of *k* squares if you interpret this number as the number of points (*x*<sub>1</sub> , ... , *x*<sub>k</sub>) in **Z**<sup>*k*</sup> with *x*<sub>1</sub><sup>2</sup> + ... + *x<sub>k</sub>*<sup>2</sup> = *n*.",
    "created_at": "2014-05-08T20:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271619",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:22'></a>
Replying to [jdemeyer](#comment%3A18):
> Replying to [leif](#comment%3A14):
> > I don't think anybody would expect e.g. `two_squares(25)` to return the trivial solution `(0,5)` instead of `(3,4)`.

> 
> From a number-theory point of view, there is nothing wrong with `(0,5)`. In fact, in some cases, the only solution is the "trivial" one, for example for 9.

I agree.  Given that 0 is a square, it makes complete sense to allow it as a term in a sum of squares.  That convention makes a lot of things nicer, for example:
- every square is also a sum of two squares, and more generally every sum of *k* squares is also a sum of *k* + 1 squares;
- *n* is a sum of 2 squares if and only if *n* can be factored non-trivially in **Z**[*i*];
- *n* is a sum of *k* squares if and only if the lattice **Z**<sup>*k*</sup> has a point of squared distance *n* from the origin.
There are also nice formulae for the number of ways to write *n* as a sum of *k* squares if you interpret this number as the number of points (*x*<sub>1</sub> , ... , *x*<sub>k</sub>) in **Z**<sup>*k*</sup> with *x*<sub>1</sub><sup>2</sup> + ... + *x<sub>k</sub>*<sup>2</sup> = *n*.



---

archive/issue_comments_271620.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [jdemeyer](#comment%3A21):\n> Anyway, if people really care about non-trivial solutions, let those people implement such a flag, I'm not going to do it.\n\n\n`algorithm=\"gap\"`?\n\nWe'd need that for backwards compatibility anyway, besides that you said GAP is faster (in factoring at least) for some (which kind of?) inputs.",
    "created_at": "2014-05-08T20:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271620",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>
Replying to [jdemeyer](#comment%3A21):
> Anyway, if people really care about non-trivial solutions, let those people implement such a flag, I'm not going to do it.


`algorithm="gap"`?

We'd need that for backwards compatibility anyway, besides that you said GAP is faster (in factoring at least) for some (which kind of?) inputs.



---

archive/issue_comments_271621.json:
```json
{
    "body": "<a id='comment:25'></a>\nHi there,\n\nFor very small integers (<500) a naive cython implementation is **much** faster (at least x100)... as this was the initial purpose of Nathann I make the remark here.\n\n```\ndef two_squares_pyx(int n):\n    cdef int i,ii,j,nn\n    if n < 2:\n        return True\n\n    i = ii = 0\n    while ii < n:\n        j = 0\n        while j <= i:\n            nn = ii + j*j\n            if nn >= n:\n                break\n            j += 1\n\n        if nn == n:\n            return (i,j)\n\n        i += 1\n        ii = i*i\n\n    raise ValueError(\"%d is not the sum of 2 squares\"%n)\n```\nthen\n\n```\nsage: %timeit two_squares(37)\n10000 loops, best of 3: 108 \u00b5s per loop\nsage: %timeit two_squares_pyx(37)\n1000000 loops, best of 3: 464 ns per loop\n\nsage: %timeit two_squares(97)\n10000 loops, best of 3: 185 \u00b5s per loop\nsage: %timeit two_squares_pyx(97)\n1000000 loops, best of 3: 558 ns per loop\n\nsage: %timeit two_squares(212)\n10000 loops, best of 3: 130 \u00b5s per loop\nsage: %timeit two_squares_pyx(212)\n1000000 loops, best of 3: 734 ns per loop\n\nsage: %timeit two_squares(500)\n10000 loops, best of 3: 131 \u00b5s per loop\nsage: %timeit two_squares_pyx(500)\n1000000 loops, best of 3: 1 \u00b5s per loop\n```\n\nWhat do you think of using it for entries < 500?\n\nVincent",
    "created_at": "2014-05-08T21:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271621",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>
Hi there,

For very small integers (<500) a naive cython implementation is **much** faster (at least x100)... as this was the initial purpose of Nathann I make the remark here.

```
def two_squares_pyx(int n):
    cdef int i,ii,j,nn
    if n < 2:
        return True

    i = ii = 0
    while ii < n:
        j = 0
        while j <= i:
            nn = ii + j*j
            if nn >= n:
                break
            j += 1

        if nn == n:
            return (i,j)

        i += 1
        ii = i*i

    raise ValueError("%d is not the sum of 2 squares"%n)
```
then

```
sage: %timeit two_squares(37)
10000 loops, best of 3: 108 µs per loop
sage: %timeit two_squares_pyx(37)
1000000 loops, best of 3: 464 ns per loop

sage: %timeit two_squares(97)
10000 loops, best of 3: 185 µs per loop
sage: %timeit two_squares_pyx(97)
1000000 loops, best of 3: 558 ns per loop

sage: %timeit two_squares(212)
10000 loops, best of 3: 130 µs per loop
sage: %timeit two_squares_pyx(212)
1000000 loops, best of 3: 734 ns per loop

sage: %timeit two_squares(500)
10000 loops, best of 3: 131 µs per loop
sage: %timeit two_squares_pyx(500)
1000000 loops, best of 3: 1 µs per loop
```

What do you think of using it for entries < 500?

Vincent



---

archive/issue_comments_271622.json:
```json
{
    "body": "<a id='comment:26'></a>\n(and the Cython version can even be improved)",
    "created_at": "2014-05-08T21:18:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271622",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>
(and the Cython version can even be improved)



---

archive/issue_comments_271623.json:
```json
{
    "body": "<a id='comment:27'></a>\nI was hoping someone would do this.\n\nI agree with pbruin, though of course this is not the same function as \"number of ways to write as two squares\" or \"all ways to write as sum of two squares\".  This is what happens when we \"unwrap\" :-)",
    "created_at": "2014-05-09T01:18:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271623",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:27'></a>
I was hoping someone would do this.

I agree with pbruin, though of course this is not the same function as "number of ways to write as two squares" or "all ways to write as sum of two squares".  This is what happens when we "unwrap" :-)



---

archive/issue_comments_271624.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [vdelecroix](#comment%3A25):\n> {{{\n> def two_squares_pyx(int n):\n>     cdef int i,ii,j,nn\n>     if n < 2:\n>         return True\n> \n>     i = ii = 0\n>     while ii < n:\n>         j = 0\n>         while j <= i:\n>             nn = ii + j*j\n>             if nn >= n:\n>                 break\n>             j += 1\n> \n>         if nn == n:\n>             return (i,j)\n> \n>         i += 1\n>         ii = i*i\n> \n>     raise ValueError(\"%d is not the sum of 2 squares\"%n)\n> }}}\n\n\nMinor correction: `while ii <= n` (such that we get \"trivial\" solutions with `j==0` as well).  Also, I'd swap i and j, or `return (j,i)`.",
    "created_at": "2014-05-09T01:19:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271624",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:28'></a>
Replying to [vdelecroix](#comment%3A25):
> {{{
> def two_squares_pyx(int n):
>     cdef int i,ii,j,nn
>     if n < 2:
>         return True
> 
>     i = ii = 0
>     while ii < n:
>         j = 0
>         while j <= i:
>             nn = ii + j*j
>             if nn >= n:
>                 break
>             j += 1
> 
>         if nn == n:
>             return (i,j)
> 
>         i += 1
>         ii = i*i
> 
>     raise ValueError("%d is not the sum of 2 squares"%n)
> }}}


Minor correction: `while ii <= n` (such that we get "trivial" solutions with `j==0` as well).  Also, I'd swap i and j, or `return (j,i)`.



---

archive/issue_comments_271625.json:
```json
{
    "body": "<a id='comment:29'></a>\nWell, I don't care much about `a==0` (a matter of definition, it's ok, and one usually has to treat zeroes differently anyway), but normally one isn't interested in a trivial solution, unless it's *the only one*, and if there's no way to get (or even get to know whether there is) a non-trivial solution [as well]...",
    "created_at": "2014-05-09T01:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271625",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:29'></a>
Well, I don't care much about `a==0` (a matter of definition, it's ok, and one usually has to treat zeroes differently anyway), but normally one isn't interested in a trivial solution, unless it's *the only one*, and if there's no way to get (or even get to know whether there is) a non-trivial solution [as well]...



---

archive/issue_comments_271626.json:
```json
{
    "body": "<a id='comment:30'></a>\nAnd feel free to implement a *different* function that returns *a list of* [all] solutions...",
    "created_at": "2014-05-09T01:29:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271626",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:30'></a>
And feel free to implement a *different* function that returns *a list of* [all] solutions...



---

archive/issue_comments_271627.json:
```json
{
    "body": "Changing commit from \"6b94a6576031e6e341143a4fc1fd83263a800ed9\" to \"9b81872a5ff12ba45acbbc32a711c85f2fd58d08\"",
    "created_at": "2014-05-15T20:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271627",
    "user": "https://github.com/videlec"
}
```

Changing commit from "6b94a6576031e6e341143a4fc1fd83263a800ed9" to "9b81872a5ff12ba45acbbc32a711c85f2fd58d08"



---

archive/issue_comments_271628.json:
```json
{
    "body": "<a id='comment:31'></a>\nHello,\n\nI implemented what I said in Cython (i.e. `two_squares_pyx`, `three_squares_pyx` and `four_squares_pyx`). Timings are now much better for small values (but it also influences small values).\n\nBased on the timings below (with the old version), I put the threshold to 500 for the three functions. But if you have strong opinion for another threshold please tell me. \n\nThere are many comments, but is there somebody up for a review ?\n\nVincent\n\nTwo squares\n\n```\nsage: %timeit two_squares(101)\n10000 loops, best of 3: 94.5 \u00b5s per loop\nsage: %timeit two_squares_pyx(101)\n1000000 loops, best of 3: 780 ns per loop\n\nsage: timeit(\"try:\\n    two_squares(102)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 57.4 \u00b5s per loop\nsage: timeit(\"try:\\n    two_squares_pyx(102)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 6.4 \u00b5s per loop\n\nsage: %timeit two_squares(200)\n10000 loops, best of 3: 87.3 \u00b5s per loop\nsage: %timeit two_squares_pyx(200)\n1000000 loops, best of 3: 788 ns per loop\n\nsage: timeit(\"try:\\n    two_squares(201)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 39.6 \u00b5s per loop\nsage: timeit(\"try:\\n    two_squares_pyx(201)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 6.61 \u00b5s per loop\n\nsage: %timeit two_squares(305)\n10000 loops, best of 3: 158 \u00b5s per loop\nsage: %timeit two_squares_pyx(305)\n1000000 loops, best of 3: 998 ns per loop\n\nsage: timeit(\"try:\\n    two_squares(304)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 50.8 \u00b5s per loop\nsage: timeit(\"try:\\n    two_squares_pyx(304)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 6.71 \u00b5s per loop\n\nsage: %timeit two_squares(400)\n10000 loops, best of 3: 69.4 \u00b5s per loop\nsage: %timeit two_squares_pyx(400)\n1000000 loops, best of 3: 1.01 \u00b5s per loop\n\nsage: timeit(\"try:\\n    two_squares(402)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 57.5 \u00b5s per loop\nsage: timeit(\"try:\\n    two_squares_pyx(402)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 6.85 \u00b5s per loop\n\nsage: %timeit two_squares(500)\n10000 loops, best of 3: 119 \u00b5s per loop\nsage: %timeit two_squares_pyx(500)\n1000000 loops, best of 3: 1.18 \u00b5s per loop\n\nsage: timeit(\"try:\\n    two_squares(501)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 39.5 \u00b5s per loop\nsage: timeit(\"try:\\n    two_squares_pyx(501)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 6.76 \u00b5s per loop\n```\n\nThree squares\n\n```\nsage: %timeit three_squares(106)\n1000 loops, best of 3: 266 \u00b5s per loop\nsage: %timeit three_squares_pyx(106)\n1000000 loops, best of 3: 1.38 \u00b5s per loop\n\nsage: timeit(\"try:\\n    three_squares(103)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 52.2 \u00b5s per loop\nsage: timeit(\"try:\\n    three_squares_pyx(103)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 6.9 \u00b5s per loop\n\nsage: %timeit three_squares(200)\n1000 loops, best of 3: 205 \u00b5s per loop\nsage: %timeit three_squares_pyx(200)\n1000000 loops, best of 3: 1.81 \u00b5s per loop\n\nsage: timeit(\"try:\\n    three_squares(303)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 52.1 \u00b5s per loop\nsage: timeit(\"try:\\n    three_squares_pyx(303)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 9.24 \u00b5s per loop\n\nsage: %timeit three_squares(406)\n1000 loops, best of 3: 189 \u00b5s per loop\nsage: %timeit three_squares_pyx(406)\n100000 loops, best of 3: 3.46 \u00b5s per loop\n\nsage: timeit(\"try:\\n    three_squares(407)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 51.6 \u00b5s per loop\nsage: timeit(\"try:\\n    three_squares_pyx(407)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 10.5 \u00b5s per loop\n\nsage: %timeit three_squares(500)\n10000 loops, best of 3: 167 \u00b5s per loop\nsage: %timeit three_squares_pyx(500)\n100000 loops, best of 3: 3.89 \u00b5s per loop\n\nsage: timeit(\"try:\\n    three_squares(503)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 51.2 \u00b5s per loop\nsage: timeit(\"try:\\n    three_squares_pyx(503)\\nexcept ValueError:\\n    pass\")\n625 loops, best of 3: 10.7 \u00b5s per loop\n```\n\nFour squares\n\n```\nsage: %timeit four_squares(503)\n1000 loops, best of 3: 259 \u00b5s per loop\nsage: %timeit four_squares_pyx(503)\n100000 loops, best of 3: 13.5 \u00b5s per loop\n```\n\n---\nNew commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[616c606](https://github.com/sagemath/sagetrac-mirror/commit/616c606cf62a0f74a3f36a9cf86d6322c43c2d77)|`trac #16308: cython version of x_squares`|\n|[9b81872](https://github.com/sagemath/sagetrac-mirror/commit/9b81872a5ff12ba45acbbc32a711c85f2fd58d08)|`trac #16308: add the file arith_pyx.pyx`|",
    "created_at": "2014-05-15T20:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271628",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>
Hello,

I implemented what I said in Cython (i.e. `two_squares_pyx`, `three_squares_pyx` and `four_squares_pyx`). Timings are now much better for small values (but it also influences small values).

Based on the timings below (with the old version), I put the threshold to 500 for the three functions. But if you have strong opinion for another threshold please tell me. 

There are many comments, but is there somebody up for a review ?

Vincent

Two squares

```
sage: %timeit two_squares(101)
10000 loops, best of 3: 94.5 µs per loop
sage: %timeit two_squares_pyx(101)
1000000 loops, best of 3: 780 ns per loop

sage: timeit("try:\n    two_squares(102)\nexcept ValueError:\n    pass")
625 loops, best of 3: 57.4 µs per loop
sage: timeit("try:\n    two_squares_pyx(102)\nexcept ValueError:\n    pass")
625 loops, best of 3: 6.4 µs per loop

sage: %timeit two_squares(200)
10000 loops, best of 3: 87.3 µs per loop
sage: %timeit two_squares_pyx(200)
1000000 loops, best of 3: 788 ns per loop

sage: timeit("try:\n    two_squares(201)\nexcept ValueError:\n    pass")
625 loops, best of 3: 39.6 µs per loop
sage: timeit("try:\n    two_squares_pyx(201)\nexcept ValueError:\n    pass")
625 loops, best of 3: 6.61 µs per loop

sage: %timeit two_squares(305)
10000 loops, best of 3: 158 µs per loop
sage: %timeit two_squares_pyx(305)
1000000 loops, best of 3: 998 ns per loop

sage: timeit("try:\n    two_squares(304)\nexcept ValueError:\n    pass")
625 loops, best of 3: 50.8 µs per loop
sage: timeit("try:\n    two_squares_pyx(304)\nexcept ValueError:\n    pass")
625 loops, best of 3: 6.71 µs per loop

sage: %timeit two_squares(400)
10000 loops, best of 3: 69.4 µs per loop
sage: %timeit two_squares_pyx(400)
1000000 loops, best of 3: 1.01 µs per loop

sage: timeit("try:\n    two_squares(402)\nexcept ValueError:\n    pass")
625 loops, best of 3: 57.5 µs per loop
sage: timeit("try:\n    two_squares_pyx(402)\nexcept ValueError:\n    pass")
625 loops, best of 3: 6.85 µs per loop

sage: %timeit two_squares(500)
10000 loops, best of 3: 119 µs per loop
sage: %timeit two_squares_pyx(500)
1000000 loops, best of 3: 1.18 µs per loop

sage: timeit("try:\n    two_squares(501)\nexcept ValueError:\n    pass")
625 loops, best of 3: 39.5 µs per loop
sage: timeit("try:\n    two_squares_pyx(501)\nexcept ValueError:\n    pass")
625 loops, best of 3: 6.76 µs per loop
```

Three squares

```
sage: %timeit three_squares(106)
1000 loops, best of 3: 266 µs per loop
sage: %timeit three_squares_pyx(106)
1000000 loops, best of 3: 1.38 µs per loop

sage: timeit("try:\n    three_squares(103)\nexcept ValueError:\n    pass")
625 loops, best of 3: 52.2 µs per loop
sage: timeit("try:\n    three_squares_pyx(103)\nexcept ValueError:\n    pass")
625 loops, best of 3: 6.9 µs per loop

sage: %timeit three_squares(200)
1000 loops, best of 3: 205 µs per loop
sage: %timeit three_squares_pyx(200)
1000000 loops, best of 3: 1.81 µs per loop

sage: timeit("try:\n    three_squares(303)\nexcept ValueError:\n    pass")
625 loops, best of 3: 52.1 µs per loop
sage: timeit("try:\n    three_squares_pyx(303)\nexcept ValueError:\n    pass")
625 loops, best of 3: 9.24 µs per loop

sage: %timeit three_squares(406)
1000 loops, best of 3: 189 µs per loop
sage: %timeit three_squares_pyx(406)
100000 loops, best of 3: 3.46 µs per loop

sage: timeit("try:\n    three_squares(407)\nexcept ValueError:\n    pass")
625 loops, best of 3: 51.6 µs per loop
sage: timeit("try:\n    three_squares_pyx(407)\nexcept ValueError:\n    pass")
625 loops, best of 3: 10.5 µs per loop

sage: %timeit three_squares(500)
10000 loops, best of 3: 167 µs per loop
sage: %timeit three_squares_pyx(500)
100000 loops, best of 3: 3.89 µs per loop

sage: timeit("try:\n    three_squares(503)\nexcept ValueError:\n    pass")
625 loops, best of 3: 51.2 µs per loop
sage: timeit("try:\n    three_squares_pyx(503)\nexcept ValueError:\n    pass")
625 loops, best of 3: 10.7 µs per loop
```

Four squares

```
sage: %timeit four_squares(503)
1000 loops, best of 3: 259 µs per loop
sage: %timeit four_squares_pyx(503)
100000 loops, best of 3: 13.5 µs per loop
```

---
New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[616c606](https://github.com/sagemath/sagetrac-mirror/commit/616c606cf62a0f74a3f36a9cf86d6322c43c2d77)|`trac #16308: cython version of x_squares`|
|[9b81872](https://github.com/sagemath/sagetrac-mirror/commit/9b81872a5ff12ba45acbbc32a711c85f2fd58d08)|`trac #16308: add the file arith_pyx.pyx`|



---

archive/issue_comments_271629.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/16308\" to \"u/vdelecroix/16308\"",
    "created_at": "2014-05-15T20:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271629",
    "user": "https://github.com/videlec"
}
```

Changing branch from "u/jdemeyer/ticket/16308" to "u/vdelecroix/16308"



---

archive/issue_comments_271630.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer\" to \"Jeroen Demeyer, Vincent Delecroix\"",
    "created_at": "2014-05-15T20:37:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271630",
    "user": "https://github.com/videlec"
}
```

Changing author from "Jeroen Demeyer" to "Jeroen Demeyer, Vincent Delecroix"



---

archive/issue_comments_271631.json:
```json
{
    "body": "<a id='comment:32'></a>\nOf course, we can revert to the jeroen branch if my contribution seems useless...\n\nVincent",
    "created_at": "2014-05-15T21:54:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271631",
    "user": "https://github.com/videlec"
}
```

<a id='comment:32'></a>
Of course, we can revert to the jeroen branch if my contribution seems useless...

Vincent



---

archive/issue_comments_271632.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/16308\" to \"u/jeroen/ticket/16308\"",
    "created_at": "2014-05-15T22:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271632",
    "user": "https://github.com/videlec"
}
```

Changing branch from "u/vdelecroix/16308" to "u/jeroen/ticket/16308"



---

archive/issue_comments_271633.json:
```json
{
    "body": "<a id='comment:33'></a>\nHi,\n\nSorry. I was a bit fast. The decision of choosing my branch or not might be the choice of the author of the ticket. So if you want to have a look at my changes, see either u/vdelecroix/16308 or public/16308\n\nVincent",
    "created_at": "2014-05-15T22:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271633",
    "user": "https://github.com/videlec"
}
```

<a id='comment:33'></a>
Hi,

Sorry. I was a bit fast. The decision of choosing my branch or not might be the choice of the author of the ticket. So if you want to have a look at my changes, see either u/vdelecroix/16308 or public/16308

Vincent



---

archive/issue_comments_271634.json:
```json
{
    "body": "Changing commit from \"9b81872a5ff12ba45acbbc32a711c85f2fd58d08\" to \"\"",
    "created_at": "2014-05-15T22:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271634",
    "user": "https://github.com/videlec"
}
```

Changing commit from "9b81872a5ff12ba45acbbc32a711c85f2fd58d08" to ""



---

archive/issue_comments_271635.json:
```json
{
    "body": "Changing author from \"Jeroen Demeyer, Vincent Delecroix\" to \"Jeroen Demeyer\"",
    "created_at": "2014-05-15T22:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271635",
    "user": "https://github.com/videlec"
}
```

Changing author from "Jeroen Demeyer, Vincent Delecroix" to "Jeroen Demeyer"



---

archive/issue_comments_271636.json:
```json
{
    "body": "<a id='comment:34'></a>\nNew commits:\n|                                                                                                                                          |                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[6b94a65](https://github.com/sagemath/sagetrac-mirror/commit/6b94a6576031e6e341143a4fc1fd83263a800ed9)|`Improve sums of squares of integers`|",
    "created_at": "2014-05-15T22:01:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271636",
    "user": "https://github.com/videlec"
}
```

<a id='comment:34'></a>
New commits:
|                                                                                                                                          |                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[6b94a65](https://github.com/sagemath/sagetrac-mirror/commit/6b94a6576031e6e341143a4fc1fd83263a800ed9)|`Improve sums of squares of integers`|



---

archive/issue_comments_271637.json:
```json
{
    "body": "Changing branch from \"u/jeroen/ticket/16308\" to \"u/jdemeyer/ticket/16308\"",
    "created_at": "2014-05-15T22:01:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271637",
    "user": "https://github.com/videlec"
}
```

Changing branch from "u/jeroen/ticket/16308" to "u/jdemeyer/ticket/16308"



---

archive/issue_comments_271638.json:
```json
{
    "body": "Changing commit from \"\" to \"6b94a6576031e6e341143a4fc1fd83263a800ed9\"",
    "created_at": "2014-05-15T22:01:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271638",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "6b94a6576031e6e341143a4fc1fd83263a800ed9"



---

archive/issue_comments_271639.json:
```json
{
    "body": "<a id='comment:35'></a>\nThere's even more room for optimizations; a C/Cython version is probably faster up to at least 10000 or even 2<sup>16</sup> (for `two_squares()`).\n\nI'd also compare the overall speed over a range.",
    "created_at": "2014-05-15T23:43:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271639",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:35'></a>
There's even more room for optimizations; a C/Cython version is probably faster up to at least 10000 or even 2<sup>16</sup> (for `two_squares()`).

I'd also compare the overall speed over a range.



---

archive/issue_comments_271640.json:
```json
{
    "body": "<a id='comment:36'></a>\nP.S.:  If a solution exists, *k*`_squares()` should IMHO **always** return a *k*-tuple.",
    "created_at": "2014-05-15T23:47:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271640",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:36'></a>
P.S.:  If a solution exists, *k*`_squares()` should IMHO **always** return a *k*-tuple.



---

archive/issue_comments_271641.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [vdelecroix](#comment%3A33):\n> Sorry. I was a bit fast. The decision of choosing my branch or not might be the choice of the author of the ticket. So if you want to have a look at my changes, see either u/vdelecroix/16308 or public/16308\n\n\nProbably open a separate ticket \"Improve sums of squares *for small input*\" and we can later (re)base one of them on the other.",
    "created_at": "2014-05-16T15:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271641",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:37'></a>
Replying to [vdelecroix](#comment%3A33):
> Sorry. I was a bit fast. The decision of choosing my branch or not might be the choice of the author of the ticket. So if you want to have a look at my changes, see either u/vdelecroix/16308 or public/16308


Probably open a separate ticket "Improve sums of squares *for small input*" and we can later (re)base one of them on the other.



---

archive/issue_comments_271642.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,5 @@\n - add a Sage implementation of writing a number as a sum of 3 squares\n - add a Sage implementation of writing a number as a sum of 4 squares\n - add a Sage implementation of writing a number as a sum of `k` squares for any `k`\n+\n+follow up: #16374\n``````\n",
    "created_at": "2014-05-17T19:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271642",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,5 @@
 - add a Sage implementation of writing a number as a sum of 3 squares
 - add a Sage implementation of writing a number as a sum of 4 squares
 - add a Sage implementation of writing a number as a sum of `k` squares for any `k`
+
+follow up: #16374
``````




---

archive/issue_comments_271643.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [leif](#comment%3A37):\n> Replying to [vdelecroix](#comment%3A33):\n> > Sorry. I was a bit fast. The decision of choosing my branch or not might be the choice of the author of the ticket. So if you want to have a look at my changes, see either u/vdelecroix/16308 or public/16308\n  \n> \n> Probably open a separate ticket \"Improve sums of squares *for small input*\" and we can later (re)base one of them on the other.\n\n\nGood idea. Done in #16374.",
    "created_at": "2014-05-17T19:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271643",
    "user": "https://github.com/videlec"
}
```

<a id='comment:39'></a>
Replying to [leif](#comment%3A37):
> Replying to [vdelecroix](#comment%3A33):
> > Sorry. I was a bit fast. The decision of choosing my branch or not might be the choice of the author of the ticket. So if you want to have a look at my changes, see either u/vdelecroix/16308 or public/16308
  
> 
> Probably open a separate ticket "Improve sums of squares *for small input*" and we can later (re)base one of them on the other.


Good idea. Done in #16374.



---

archive/issue_comments_271644.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [leif](#comment%3A36):\n> P.S.:  If a solution exists, *k*`_squares()` should IMHO **always** return a *k*-tuple.\n\nSure, in which case does it not do that?",
    "created_at": "2014-05-19T10:10:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271644",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>
Replying to [leif](#comment%3A36):
> P.S.:  If a solution exists, *k*`_squares()` should IMHO **always** return a *k*-tuple.

Sure, in which case does it not do that?



---

archive/issue_comments_271645.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [jdemeyer](#comment%3A40):\n> Replying to [leif](#comment%3A36):\n> > P.S.:  If a solution exists, *k*`_squares()` should IMHO **always** return a *k*-tuple.\n\n> Sure, in which case does it not do that?\n\nSorry, I had been looking at some diff of Vincent's code against yours, and only saw some `return (foo,)` (and I **swear** it was more than one!1!!1 ;-) ), but in your original code, or the one that's again here now, it's of course only in the case k=1 (sum of *one* square), which is correct.\n\nSorry for the noise.",
    "created_at": "2014-05-19T19:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271645",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:41'></a>
Replying to [jdemeyer](#comment%3A40):
> Replying to [leif](#comment%3A36):
> > P.S.:  If a solution exists, *k*`_squares()` should IMHO **always** return a *k*-tuple.

> Sure, in which case does it not do that?

Sorry, I had been looking at some diff of Vincent's code against yours, and only saw some `return (foo,)` (and I **swear** it was more than one!1!!1 ;-) ), but in your original code, or the one that's again here now, it's of course only in the case k=1 (sum of *one* square), which is correct.

Sorry for the noise.



---

archive/issue_comments_271646.json:
```json
{
    "body": "<a id='comment:42'></a>\nHi,\n\nRelated to[comment:12](#comment%3A12), can you justify why using pari? We already have `factor` and `is_pseudoprime` and `sqrtrem` might be the replacement for `N.sqrtint`.\n\nThere are also trailing whitespaces on the lines 5161 and 5246.\n\nVincent",
    "created_at": "2014-06-06T16:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271646",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>
Hi,

Related to[comment:12](#comment%3A12), can you justify why using pari? We already have `factor` and `is_pseudoprime` and `sqrtrem` might be the replacement for `N.sqrtint`.

There are also trailing whitespaces on the lines 5161 and 5246.

Vincent



---

archive/issue_comments_271647.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-06-06T16:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271647",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_271648.json:
```json
{
    "body": "<a id='comment:43'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[c4f603b](https://github.com/sagemath/sagetrac-mirror/commit/c4f603b4b967ca841571fb0d565d4328ec0c2802)|`Use Integer.factor() for factoring`|\n|[f6754d0](https://github.com/sagemath/sagetrac-mirror/commit/f6754d02137ea838ccae59cb61dca780b057e0c7)|`Merge remote-tracking branch 'origin/develop' into ticket/16308`|\n|[7b33df2](https://github.com/sagemath/sagetrac-mirror/commit/7b33df2464a78e70766fbb031af1750e5ed6239a)|`Speed up sums of squares`|",
    "created_at": "2014-06-25T09:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271648",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[c4f603b](https://github.com/sagemath/sagetrac-mirror/commit/c4f603b4b967ca841571fb0d565d4328ec0c2802)|`Use Integer.factor() for factoring`|
|[f6754d0](https://github.com/sagemath/sagetrac-mirror/commit/f6754d02137ea838ccae59cb61dca780b057e0c7)|`Merge remote-tracking branch 'origin/develop' into ticket/16308`|
|[7b33df2](https://github.com/sagemath/sagetrac-mirror/commit/7b33df2464a78e70766fbb031af1750e5ed6239a)|`Speed up sums of squares`|



---

archive/issue_comments_271649.json:
```json
{
    "body": "Changing commit from \"6b94a6576031e6e341143a4fc1fd83263a800ed9\" to \"7b33df2464a78e70766fbb031af1750e5ed6239a\"",
    "created_at": "2014-06-25T09:14:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271649",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6b94a6576031e6e341143a4fc1fd83263a800ed9" to "7b33df2464a78e70766fbb031af1750e5ed6239a"



---

archive/issue_comments_271650.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-06-25T09:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271650",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_271651.json:
```json
{
    "body": "<a id='comment:45'></a>\nHey,\n\nLooks cool! I added micro optimizations and random tests at `u/vdelecroix/16308`. If you like my changes, this is good for a positive review!\n\nVincent",
    "created_at": "2014-06-25T18:48:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271651",
    "user": "https://github.com/videlec"
}
```

<a id='comment:45'></a>
Hey,

Looks cool! I added micro optimizations and random tests at `u/vdelecroix/16308`. If you like my changes, this is good for a positive review!

Vincent



---

archive/issue_comments_271652.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Peter Bruin, Leif Leonhardy , Vincent Delecroix\"",
    "created_at": "2014-06-25T18:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271652",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Peter Bruin, Leif Leonhardy , Vincent Delecroix"



---

archive/issue_comments_271653.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/16308\" to \"u/vdelecroix/16308\"",
    "created_at": "2014-06-25T21:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271653",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "u/jdemeyer/ticket/16308" to "u/vdelecroix/16308"



---

archive/issue_comments_271654.json:
```json
{
    "body": "<a id='comment:47'></a>\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[f071a8d](https://github.com/sagemath/sagetrac-mirror/commit/f071a8db1316a7bf8503f6c6c9227fcaa6b953f7)|`sum of squares: micro improvement + random tests`|",
    "created_at": "2014-06-25T21:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271654",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:47'></a>
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[f071a8d](https://github.com/sagemath/sagetrac-mirror/commit/f071a8db1316a7bf8503f6c6c9227fcaa6b953f7)|`sum of squares: micro improvement + random tests`|



---

archive/issue_comments_271655.json:
```json
{
    "body": "Changing commit from \"7b33df2464a78e70766fbb031af1750e5ed6239a\" to \"f071a8db1316a7bf8503f6c6c9227fcaa6b953f7\"",
    "created_at": "2014-06-25T21:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271655",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "7b33df2464a78e70766fbb031af1750e5ed6239a" to "f071a8db1316a7bf8503f6c6c9227fcaa6b953f7"



---

archive/issue_comments_271656.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-25T21:42:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271656",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_271657.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/16308\" to \"f071a8db1316a7bf8503f6c6c9227fcaa6b953f7\"",
    "created_at": "2014-06-26T19:37:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271657",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/16308" to "f071a8db1316a7bf8503f6c6c9227fcaa6b953f7"



---

archive/issue_comments_271658.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-26T19:37:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16308#issuecomment-271658",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054683.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-26T19:37:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16308",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16308#event-54683"
}
```
