# Issue 16697: implement symbolic lower incomplete gamma function

archive/issues_016460.json:
```json
{
    "body": "CC:  @kcrisman @nbruin\n\nKeywords: gamma, incomplete, special, functions\n\nThis is actually a defect because we leave a result from Maxima undefined:\n\n```\nsage: hypergeometric([1],[b],x).simplify_hypergeometric()\n(b - 1)*x^(-b + 1)*e^x*gamma_greek(b - 1, x)\nsage: gamma_greek\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n<ipython-input-18-6e90901bc5cb> in <module>()\n----> 1 gamma_greek\n\nNameError: name 'gamma_greek' is not defined\n```\nhttps://en.wikipedia.org/wiki/Incomplete_gamma_function#Lower_incomplete_Gamma_function\n\nMathematica seems to have Gamma[a,z] for upper and Gamma[a,0,z] for lower; Maple seems to have upper Gamma. `gamma_inc` (the upper one in Sage) gets immediately converted to `gamma(a,x)`. The symbolic functions `gamma_inc==incomplete_gamma` are converted and never returned to the user as expression:\n\n```\nsage: gamma_inc(x,x,hold=True)\ngamma(x, x)\nsage: incomplete_gamma(x,x,hold=True)\ngamma(x, x)\nsage: assume(x>0)\nsage: integral(t^(s-1)*e^(-t),t,0,x)\n-gamma(s, x) + gamma(s)\n```\nThis ticket should deprecate \"incomplete_gamma\" and add the symbolic function `gamma_inc_lower`, leaving open the question of the global alias for and the displayed name of `Function_gamma_inc`.\n\nPrevious part of description:\n\n---\n\n1. Provide all three \"user input interfaces\" `gamma_inc`, `incomplete_gamma` and `lower_incomplete_gamma`, and convert the Maxima `gamma_greek` to `-gamma(a, x) + gamma(a)`\n2. Provide all three \"user input interfaces\" `gamma_inc`, `incomplete_gamma` and `lower_incomplete_gamma`, and convert to `gamma(a,x)` and `gamma(a,0,x)`n on output\n3. Provide all three \"user input interfaces\" `gamma_inc`, `incomplete_gamma` and `lower_incomplete_gamma`, and have `incomplete_gamma` and `lower_incomplete_gamma` as result instead of `gamma(...)'\n4. Change the user interface completely to `lower_incomplete_gamma` and `upper_incomplete_gamma`\n5. Change the user interface completely to `gamma_inc_lower` and `gamma_inc_upper`\n6. Change the user interface completely to `gamma(a,x)` and `gamma(a,0,x)`\n\nIssue created by migration from https://trac.sagemath.org/ticket/16697\n\n",
    "closed_at": "2016-06-27T16:22:10Z",
    "created_at": "2014-07-22T08:45:10Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.2",
    "title": "implement symbolic lower incomplete gamma function",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16697",
    "user": "https://github.com/rwst"
}
```
CC:  @kcrisman @nbruin

Keywords: gamma, incomplete, special, functions

This is actually a defect because we leave a result from Maxima undefined:

```
sage: hypergeometric([1],[b],x).simplify_hypergeometric()
(b - 1)*x^(-b + 1)*e^x*gamma_greek(b - 1, x)
sage: gamma_greek
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-18-6e90901bc5cb> in <module>()
----> 1 gamma_greek

NameError: name 'gamma_greek' is not defined
```
https://en.wikipedia.org/wiki/Incomplete_gamma_function#Lower_incomplete_Gamma_function

Mathematica seems to have Gamma[a,z] for upper and Gamma[a,0,z] for lower; Maple seems to have upper Gamma. `gamma_inc` (the upper one in Sage) gets immediately converted to `gamma(a,x)`. The symbolic functions `gamma_inc==incomplete_gamma` are converted and never returned to the user as expression:

```
sage: gamma_inc(x,x,hold=True)
gamma(x, x)
sage: incomplete_gamma(x,x,hold=True)
gamma(x, x)
sage: assume(x>0)
sage: integral(t^(s-1)*e^(-t),t,0,x)
-gamma(s, x) + gamma(s)
```
This ticket should deprecate "incomplete_gamma" and add the symbolic function `gamma_inc_lower`, leaving open the question of the global alias for and the displayed name of `Function_gamma_inc`.

Previous part of description:

---

1. Provide all three "user input interfaces" `gamma_inc`, `incomplete_gamma` and `lower_incomplete_gamma`, and convert the Maxima `gamma_greek` to `-gamma(a, x) + gamma(a)`
2. Provide all three "user input interfaces" `gamma_inc`, `incomplete_gamma` and `lower_incomplete_gamma`, and convert to `gamma(a,x)` and `gamma(a,0,x)`n on output
3. Provide all three "user input interfaces" `gamma_inc`, `incomplete_gamma` and `lower_incomplete_gamma`, and have `incomplete_gamma` and `lower_incomplete_gamma` as result instead of `gamma(...)'
4. Change the user interface completely to `lower_incomplete_gamma` and `upper_incomplete_gamma`
5. Change the user interface completely to `gamma_inc_lower` and `gamma_inc_upper`
6. Change the user interface completely to `gamma(a,x)` and `gamma(a,0,x)`

Issue created by migration from https://trac.sagemath.org/ticket/16697





---

archive/issue_comments_216055.json:
```json
{
    "body": "We don't need all of `gamma, gamma_inc, incomplete_gamma` as symbolic function if they all mean the same. Some of them are probably there for user convenience or because of legacy. I think we want only one spelling for `gamma_upper`, whatever it may be. The `gamma(a,x)` convention seems fairly prominent in computer algebra, but is a poor translation of math notation, where the difference between upper and lower is made with case (and indeed, the complete gamma function tends to be capital gamma. I don't think I've ever seen different).\n\nBecause of tab completion, you definitely want a binding available that starts with `gamma`. I'd be fine with `gamma_lower` but if you want to go with `gamma_lower_incomplete`, that's fine with me too. So, I'd propose\n\n8. Maintain status quo with respect to upper incomplete gamma, i.e., don't change sage's behaviour for `gamma(a,x)` and `gamma_inc(a,x)`. Just implement a symbolic function `gamma_lower` (or modified spelling) to correspond to maxima's gamma_greek.",
    "created_at": "2014-07-22T15:25:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216055",
    "user": "https://github.com/nbruin"
}
```

We don't need all of `gamma, gamma_inc, incomplete_gamma` as symbolic function if they all mean the same. Some of them are probably there for user convenience or because of legacy. I think we want only one spelling for `gamma_upper`, whatever it may be. The `gamma(a,x)` convention seems fairly prominent in computer algebra, but is a poor translation of math notation, where the difference between upper and lower is made with case (and indeed, the complete gamma function tends to be capital gamma. I don't think I've ever seen different).

Because of tab completion, you definitely want a binding available that starts with `gamma`. I'd be fine with `gamma_lower` but if you want to go with `gamma_lower_incomplete`, that's fine with me too. So, I'd propose

8. Maintain status quo with respect to upper incomplete gamma, i.e., don't change sage's behaviour for `gamma(a,x)` and `gamma_inc(a,x)`. Just implement a symbolic function `gamma_lower` (or modified spelling) to correspond to maxima's gamma_greek.



---

archive/issue_comments_216056.json:
```json
{
    "body": "I don't underswtand. With \"leave as is\" you would keep `gamma(a,x)` as returned expression for the upper function? Or would you make `gamma_inc` fully symbolic in that it gets no longer converted to `gamma(a,x)`?",
    "created_at": "2014-07-22T16:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216056",
    "user": "https://github.com/rwst"
}
```

I don't underswtand. With "leave as is" you would keep `gamma(a,x)` as returned expression for the upper function? Or would you make `gamma_inc` fully symbolic in that it gets no longer converted to `gamma(a,x)`?



---

archive/issue_comments_216057.json:
```json
{
    "body": "The reason why `gamma_inc(x,y)` gets output as `gamma(x,y)` is not conversion as I thought but simple naming super in the constructor. It would be just as easy to make that `gamma_inc` and change a few doctests such that then:\n\n```\n         sage: f = exp_integral_e(-1,x)\n         sage: f.integrate(x)\n-        Ei(-x) - gamma(-1, x)\n+        Ei(-x) - gamma_inc(-1, x)\n\n             sage: gamma_inc(3,2)\n-            gamma(3, 2)\n+            gamma_inc(3, 2)\n\n             sage: gamma(3,2)\n             gamma_inc(3, 2)\n\n             sage: gamma(x,0)\n             gamma(x)\n\n             sage: gamma(x, 0, hold=True)\n-            gamma(x, 0)\n+            gamma_inc(x, 0)\n```\nI'm appending the patch that enables this here, so it is preserved.",
    "created_at": "2014-07-23T07:07:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216057",
    "user": "https://github.com/rwst"
}
```

The reason why `gamma_inc(x,y)` gets output as `gamma(x,y)` is not conversion as I thought but simple naming super in the constructor. It would be just as easy to make that `gamma_inc` and change a few doctests such that then:

```
         sage: f = exp_integral_e(-1,x)
         sage: f.integrate(x)
-        Ei(-x) - gamma(-1, x)
+        Ei(-x) - gamma_inc(-1, x)

             sage: gamma_inc(3,2)
-            gamma(3, 2)
+            gamma_inc(3, 2)

             sage: gamma(3,2)
             gamma_inc(3, 2)

             sage: gamma(x,0)
             gamma(x)

             sage: gamma(x, 0, hold=True)
-            gamma(x, 0)
+            gamma_inc(x, 0)
```
I'm appending the patch that enables this here, so it is preserved.



---

archive/issue_comments_216058.json:
```json
{
    "body": "Attachment [16697-gammainc-alt-patch](tarball://root/attachments/some-uuid/ticket16697/16697-gammainc-alt-patch) by @rwst created at 2014-07-23 07:08:35\n\nsee comment",
    "created_at": "2014-07-23T07:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216058",
    "user": "https://github.com/rwst"
}
```

Attachment [16697-gammainc-alt-patch](tarball://root/attachments/some-uuid/ticket16697/16697-gammainc-alt-patch) by @rwst created at 2014-07-23 07:08:35

see comment



---

archive/issue_comments_216059.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-23T12:40:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216059",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216060.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-23T14:43:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216060",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216061.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-23T14:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216061",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_216062.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-26T07:02:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216062",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216063.json:
```json
{
    "body": "On [sage-support](https://groups.google.com/d/msg/sage-support/duiLiYbLNww/i8towxGMOkUJ) Rafael Greenblatt reports\n\n```\nsage: (incomplete_gamma(x,y).diff(x)).simplify()\nTypeError: ECL says: Error executing code in Maxima: gamma: wrong number of arguments.\n```\nThe problem probably arises because the function ends up separated from its arguments:\n\n```\nsage: incomplete_gamma(x,y).diff(x)\nD[0](gamma)(x, y)\n```\nwhich might confuse the translator (the behaviour is consistent with just going by strings). The changes here might improve the situation. It's worth checking.\n\nThe following of course works because it does NOT primarily look at strings:\n\n```\nsage: from sage.interfaces.maxima_lib import *\nsage: maxima_calculus(sr_to_max(incomplete_gamma(x,y).diff(x)))\n'diff(gamma_incomplete(x,y),x,1)\n```",
    "created_at": "2014-08-08T14:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216063",
    "user": "https://github.com/nbruin"
}
```

On [sage-support](https://groups.google.com/d/msg/sage-support/duiLiYbLNww/i8towxGMOkUJ) Rafael Greenblatt reports

```
sage: (incomplete_gamma(x,y).diff(x)).simplify()
TypeError: ECL says: Error executing code in Maxima: gamma: wrong number of arguments.
```
The problem probably arises because the function ends up separated from its arguments:

```
sage: incomplete_gamma(x,y).diff(x)
D[0](gamma)(x, y)
```
which might confuse the translator (the behaviour is consistent with just going by strings). The changes here might improve the situation. It's worth checking.

The following of course works because it does NOT primarily look at strings:

```
sage: from sage.interfaces.maxima_lib import *
sage: maxima_calculus(sr_to_max(incomplete_gamma(x,y).diff(x)))
'diff(gamma_incomplete(x,y),x,1)
```



---

archive/issue_comments_216064.json:
```json
{
    "body": "Replying to [comment:11 nbruin]:\n> On [sage-support](https://groups.google.com/d/msg/sage-support/duiLiYbLNww/i8towxGMOkUJ) Rafael Greenblatt reports\n> \n> ```\n> sage: (incomplete_gamma(x,y).diff(x)).simplify()\n> TypeError: ECL says: Error executing code in Maxima: gamma: wrong number of arguments.\n> ```\n> The problem probably arises because the function ends up separated from its arguments:\n> \n> ```\n> sage: incomplete_gamma(x,y).diff(x)\n> D[0](gamma)(x, y)\n> ```\n> which might confuse the translator (the behaviour is consistent with just going by strings). The changes here might improve the situation. It's worth checking.\n\nDoes the same with the patch. Maybe include the fix here? Is it simple?",
    "created_at": "2014-08-08T15:34:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216064",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:11 nbruin]:
> On [sage-support](https://groups.google.com/d/msg/sage-support/duiLiYbLNww/i8towxGMOkUJ) Rafael Greenblatt reports
> 
> ```
> sage: (incomplete_gamma(x,y).diff(x)).simplify()
> TypeError: ECL says: Error executing code in Maxima: gamma: wrong number of arguments.
> ```
> The problem probably arises because the function ends up separated from its arguments:
> 
> ```
> sage: incomplete_gamma(x,y).diff(x)
> D[0](gamma)(x, y)
> ```
> which might confuse the translator (the behaviour is consistent with just going by strings). The changes here might improve the situation. It's worth checking.

Does the same with the patch. Maybe include the fix here? Is it simple?



---

archive/issue_comments_216065.json:
```json
{
    "body": "Replying to [comment:12 rws]:\n> Does the same with the patch. Maybe include the fix here? Is it simple?\n\nMight not be too bad. I think the problem is in [sage.symbolic.expression_conversions.InterfaceInit.derivative (line 515 or so)](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/symbolic/expression_conversions.py#n515). You can see there that the string representation of a derivative expression gets assembled by using `f.name()`. Replacing that by `f._maxima_init_()` might already do a better job:\n\n```\nsage: gamma(x,y).operator().name()\n'gamma'\nsage: gamma(x).operator().name()\n'gamma'\nsage: gamma(x,y).operator()._maxima_init_()\n'gamma_incomplete'\nsage: gamma(x).operator()._maxima_init_()\n'gamma'\n```",
    "created_at": "2014-08-08T16:27:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216065",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:12 rws]:
> Does the same with the patch. Maybe include the fix here? Is it simple?

Might not be too bad. I think the problem is in [sage.symbolic.expression_conversions.InterfaceInit.derivative (line 515 or so)](https://github.com/sagemath/sagetrac-mirror/blob/master/src/sage/symbolic/expression_conversions.py#n515). You can see there that the string representation of a derivative expression gets assembled by using `f.name()`. Replacing that by `f._maxima_init_()` might already do a better job:

```
sage: gamma(x,y).operator().name()
'gamma'
sage: gamma(x).operator().name()
'gamma'
sage: gamma(x,y).operator()._maxima_init_()
'gamma_incomplete'
sage: gamma(x).operator()._maxima_init_()
'gamma'
```



---

archive/issue_comments_216066.json:
```json
{
    "body": "That gives:\n\n```\nsage: (incomplete_gamma(x,y).diff(x)).simplify()\nD[0](gamma)(x, y)\n```",
    "created_at": "2014-08-08T16:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216066",
    "user": "https://github.com/rwst"
}
```

That gives:

```
sage: (incomplete_gamma(x,y).diff(x)).simplify()
D[0](gamma)(x, y)
```



---

archive/issue_comments_216067.json:
```json
{
    "body": "Replying to [comment:14 rws]:\n> That gives:\n> \n> ```\n> sage: (incomplete_gamma(x,y).diff(x)).simplify()\n> D[0](gamma)(x, y)\n> ```\n\nCool! so it IS easy. Be sure to also test (I haven't checked the answer is correct, but at least it shouldn't raise an error):\n\n```\nsage: (incomplete_gamma(x,x+1).diff(x)).simplify().simplify()\n-(x + 1)^(x - 1)*e^(-x - 1) + D[0](gamma)(x, x + 1)\n```\nto check that both occurrences of `f.name()` have been replaced. I check the rest of that file and didn't find any further suspicious uses of `name` so after this, our maxima interface is probably perfect  :-).",
    "created_at": "2014-08-08T18:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216067",
    "user": "https://github.com/nbruin"
}
```

Replying to [comment:14 rws]:
> That gives:
> 
> ```
> sage: (incomplete_gamma(x,y).diff(x)).simplify()
> D[0](gamma)(x, y)
> ```

Cool! so it IS easy. Be sure to also test (I haven't checked the answer is correct, but at least it shouldn't raise an error):

```
sage: (incomplete_gamma(x,x+1).diff(x)).simplify().simplify()
-(x + 1)^(x - 1)*e^(-x - 1) + D[0](gamma)(x, x + 1)
```
to check that both occurrences of `f.name()` have been replaced. I check the rest of that file and didn't find any further suspicious uses of `name` so after this, our maxima interface is probably perfect  :-).



---

archive/issue_comments_216068.json:
```json
{
    "body": "See #16785 for a more complete fix.",
    "created_at": "2014-08-08T22:48:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216068",
    "user": "https://github.com/nbruin"
}
```

See #16785 for a more complete fix.



---

archive/issue_comments_216069.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-09T15:18:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216069",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216070.json:
```json
{
    "body": "I also had to fix a doctest in integration where the given result didn't have enough precision because it came from maxima. Now the default is mpmath and that uncovered it.",
    "created_at": "2014-08-09T15:20:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216070",
    "user": "https://github.com/rwst"
}
```

I also had to fix a doctest in integration where the given result didn't have enough precision because it came from maxima. Now the default is mpmath and that uncovered it.



---

archive/issue_comments_216071.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-10T09:28:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216071",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_048926.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48926"
}
```



---

archive/issue_comments_216072.json:
```json
{
    "body": "Sorry, we should make this clearer - that field is one currently not used but which should be (!!!) that was for saying which version/beta of Sage a given ticket was merged in.  I agree that might not be clear given the word \"merge\" meaning something else in git!",
    "created_at": "2014-08-11T03:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216072",
    "user": "https://github.com/kcrisman"
}
```

Sorry, we should make this clearer - that field is one currently not used but which should be (!!!) that was for saying which version/beta of Sage a given ticket was merged in.  I agree that might not be clear given the word "merge" meaning something else in git!



---

archive/issue_comments_216073.json:
```json
{
    "body": "So, is there anything missing?",
    "created_at": "2014-08-13T06:56:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216073",
    "user": "https://github.com/rwst"
}
```

So, is there anything missing?



---

archive/issue_comments_216074.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-16T06:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216074",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216075.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-13T07:30:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216075",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216076.json:
```json
{
    "body": "Just to let you know: this conflicts with #17130.",
    "created_at": "2014-10-13T08:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216076",
    "user": "https://github.com/jdemeyer"
}
```

Just to let you know: this conflicts with #17130.



---

archive/issue_comments_216077.json:
```json
{
    "body": "See also the information [here](http://www.walkingrandomly.com/images/maxima/ChangeLog-5.17-special-functions.txt), which seems to be more information than the documentation of Maxima gives.\n\n```\n\n\nImplementation of the Incomplete Gamma function\n\n New Maxima User function: gamma_incomplete(a,z)\n\n The following features are implemented:\n\n - Evaluation for real and complex numbers in double float and\n   bigfloat precision\n - Special values for gamma_incomplete(a,0) and gamma_incomplete(a,inf)\n - When $gamma_expand T expand the following expressions:\n   gamma_incomplete(0,z)\n   gamma_incomplete(n+1/2)\n   gamma_incomplete(1/2-n)\n   gamma_incomplete(n,z)\n   gamma_incomplete(-n,z)\n   gamma_incomplete(a+n,z)\n   gamma_incomplete(a-n,z)\n - Mirror symmetry\n - Derivative wrt the arguments a and z\n\n--------------------------------------------------------------------------------\nImplementation of the Generalized Incomplete Gamma function\n\n New Maxima User function: gamma_incomplete_generalized(a,z1,z2)\n\n The following features are implemented:\n\n - Evaluation for real and complex numbers in double float and\n   bigfloat precision\n - Special values for:\n   gamma_incomplete_generalized(a,z1,0)\n   gamma_incomplete_generalized(a,0,z2),\n   gamma_incomplete_generalized(a,z1,inf)\n   gamma_incomplete_generalized(a,inf,z2)\n   gamma_incomplete_generalized(a,0,inf)\n   gamma_incomplete_generalized(a,x,x)\n - When $gamma_expand T and n an integer expand\n   gamma_incomplete_generalized(a+n,z1,z2)\n - Implementation of Mirror symmetry\n - Derivative wrt the arguments a, z1 and z2\n\n--------------------------------------------------------------------------------\nImplementation of the Regularized Incomplete Gamma function\n\n New Maxima User function: gamma_incomplete_regularized(a,z)\n\n The following features are implemented:\n\n - Evaluation for real and complex numbers in double float and\n   bigfloat precision\n - Special values for:\n   gamma_incomplete_regularized(a,0)\n   gamma_incomplete_regularized(0,z)\n   gamma_incomplete_regularized(a,inf)\n - When $gamma_expand T and n a positive integer expansions for\n   gamma_incomplete_regularized(n+1/2,z)\n   gamma_incomplete_regularized(1/2-n,z)\n   gamma_incomplete_regularized(n,z)\n   gamma_incomplete_regularized(a+n,z)\n   gamma_incomplete_regularized(a-n,z)\n - Derivative wrt the arguments a and z\n - Implementation of Mirror symmetry\n\n```",
    "created_at": "2014-11-17T16:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216077",
    "user": "https://github.com/kcrisman"
}
```

See also the information [here](http://www.walkingrandomly.com/images/maxima/ChangeLog-5.17-special-functions.txt), which seems to be more information than the documentation of Maxima gives.

```


Implementation of the Incomplete Gamma function

 New Maxima User function: gamma_incomplete(a,z)

 The following features are implemented:

 - Evaluation for real and complex numbers in double float and
   bigfloat precision
 - Special values for gamma_incomplete(a,0) and gamma_incomplete(a,inf)
 - When $gamma_expand T expand the following expressions:
   gamma_incomplete(0,z)
   gamma_incomplete(n+1/2)
   gamma_incomplete(1/2-n)
   gamma_incomplete(n,z)
   gamma_incomplete(-n,z)
   gamma_incomplete(a+n,z)
   gamma_incomplete(a-n,z)
 - Mirror symmetry
 - Derivative wrt the arguments a and z

--------------------------------------------------------------------------------
Implementation of the Generalized Incomplete Gamma function

 New Maxima User function: gamma_incomplete_generalized(a,z1,z2)

 The following features are implemented:

 - Evaluation for real and complex numbers in double float and
   bigfloat precision
 - Special values for:
   gamma_incomplete_generalized(a,z1,0)
   gamma_incomplete_generalized(a,0,z2),
   gamma_incomplete_generalized(a,z1,inf)
   gamma_incomplete_generalized(a,inf,z2)
   gamma_incomplete_generalized(a,0,inf)
   gamma_incomplete_generalized(a,x,x)
 - When $gamma_expand T and n an integer expand
   gamma_incomplete_generalized(a+n,z1,z2)
 - Implementation of Mirror symmetry
 - Derivative wrt the arguments a, z1 and z2

--------------------------------------------------------------------------------
Implementation of the Regularized Incomplete Gamma function

 New Maxima User function: gamma_incomplete_regularized(a,z)

 The following features are implemented:

 - Evaluation for real and complex numbers in double float and
   bigfloat precision
 - Special values for:
   gamma_incomplete_regularized(a,0)
   gamma_incomplete_regularized(0,z)
   gamma_incomplete_regularized(a,inf)
 - When $gamma_expand T and n a positive integer expansions for
   gamma_incomplete_regularized(n+1/2,z)
   gamma_incomplete_regularized(1/2-n,z)
   gamma_incomplete_regularized(n,z)
   gamma_incomplete_regularized(a+n,z)
   gamma_incomplete_regularized(a-n,z)
 - Derivative wrt the arguments a and z
 - Implementation of Mirror symmetry

```



---

archive/issue_comments_216078.json:
```json
{
    "body": "We don't have `gamma_incomplete_regularized` either. This would be a different ticket.",
    "created_at": "2014-11-26T14:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216078",
    "user": "https://github.com/rwst"
}
```

We don't have `gamma_incomplete_regularized` either. This would be a different ticket.



---

archive/issue_comments_216079.json:
```json
{
    "body": "I'm going back to Pari as default since mpmath has similar problems as earlier Pari, see #17328 and https://github.com/fredrik-johansson/mpmath/issues/301",
    "created_at": "2014-11-29T17:16:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216079",
    "user": "https://github.com/rwst"
}
```

I'm going back to Pari as default since mpmath has similar problems as earlier Pari, see #17328 and https://github.com/fredrik-johansson/mpmath/issues/301



---

archive/issue_comments_216080.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-11-30T09:03:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216080",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216081.json:
```json
{
    "body": "rebased on latest 6.5.beta3\n\nalso added one missing trac role\n\n---\nNew commits:",
    "created_at": "2014-12-21T07:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216081",
    "user": "https://github.com/fchapoton"
}
```

rebased on latest 6.5.beta3

also added one missing trac role

---
New commits:



---

archive/issue_comments_216082.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-12-21T07:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216082",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216083.json:
```json
{
    "body": "Fr\u00e9d\u00e9ric, any comments on review, or was this just a drive-by improvement?\n\nDoes the following (from the description) now come out better?\n\n```\nsage: hypergeometric([1],[b],x).simplify_hypergeometric()\n```\n\nCould we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?",
    "created_at": "2015-02-03T03:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216083",
    "user": "https://github.com/kcrisman"
}
```

Frédéric, any comments on review, or was this just a drive-by improvement?

Does the following (from the description) now come out better?

```
sage: hypergeometric([1],[b],x).simplify_hypergeometric()
```

Could we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?



---

archive/issue_comments_216084.json:
```json
{
    "body": "Replying to [comment:35 kcrisman]:\n> Does the following (from the description) now come out better?\n> \n> ```\n> sage: hypergeometric([1],[b],x).simplify_hypergeometric()\n> ```\n\n`(b - 1)*x^(-b + 1)*e^x*gamma_inc_lower(b - 1, x)`\n> \n> Could we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?\n\nA separate ticket, please?",
    "created_at": "2015-02-03T09:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216084",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:35 kcrisman]:
> Does the following (from the description) now come out better?
> 
> ```
> sage: hypergeometric([1],[b],x).simplify_hypergeometric()
> ```

`(b - 1)*x^(-b + 1)*e^x*gamma_inc_lower(b - 1, x)`
> 
> Could we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?

A separate ticket, please?



---

archive/issue_comments_216085.json:
```json
{
    "body": "> > {{{\n> > sage: hypergeometric([1],[b],x).simplify_hypergeometric()\n> > }}}\n\n> `(b - 1)*x^(-b + 1)*e^x*gamma_inc_lower(b - 1, x)`\nNice.\n> > Could we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?\n\n> A separate ticket, please?\nSeems quite reasonable.   Do you agree this would be a useful addition?  I only mention it because it seems that at least a couple 'competitors' support it, so presumably it is somewhat of a standard and not a surprise if Sage implements it.",
    "created_at": "2015-02-03T14:07:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216085",
    "user": "https://github.com/kcrisman"
}
```

> > {{{
> > sage: hypergeometric([1],[b],x).simplify_hypergeometric()
> > }}}

> `(b - 1)*x^(-b + 1)*e^x*gamma_inc_lower(b - 1, x)`
Nice.
> > Could we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?

> A separate ticket, please?
Seems quite reasonable.   Do you agree this would be a useful addition?  I only mention it because it seems that at least a couple 'competitors' support it, so presumably it is somewhat of a standard and not a surprise if Sage implements it.



---

archive/issue_comments_216086.json:
```json
{
    "body": "Replying to [comment:37 kcrisman]:\n> > > Could we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?\n\n> > A separate ticket, please?\n> Seems quite reasonable.   Do you agree this would be a useful addition?  I only mention it because it seems that at least a couple 'competitors' support it, so presumably it is somewhat of a standard and not a surprise if Sage implements it.\n\nAny UI change that reduces surprise is fine with me. (Actually, I have a GUI development history and have read and care much about this subject)",
    "created_at": "2015-02-03T16:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216086",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:37 kcrisman]:
> > > Could we add the `gamma(a,0,x)` interface for the lower gamma?  *Should* we?

> > A separate ticket, please?
> Seems quite reasonable.   Do you agree this would be a useful addition?  I only mention it because it seems that at least a couple 'competitors' support it, so presumably it is somewhat of a standard and not a surprise if Sage implements it.

Any UI change that reduces surprise is fine with me. (Actually, I have a GUI development history and have read and care much about this subject)



---

archive/issue_comments_216087.json:
```json
{
    "body": "For the record, I know nearly nothing about UI development!  It was only a question.  #17722\n\nI'm going to hold off on looking at this in more detail in case chapoton already did but a brief glance looks good.",
    "created_at": "2015-02-03T16:32:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216087",
    "user": "https://github.com/kcrisman"
}
```

For the record, I know nearly nothing about UI development!  It was only a question.  #17722

I'm going to hold off on looking at this in more detail in case chapoton already did but a brief glance looks good.



---

archive/issue_comments_216088.json:
```json
{
    "body": "Note sympy apparently implements this as `lowergamma` (?).",
    "created_at": "2015-03-17T01:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216088",
    "user": "https://github.com/kcrisman"
}
```

Note sympy apparently implements this as `lowergamma` (?).



---

archive/issue_comments_216089.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-17T07:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216089",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_216090.json:
```json
{
    "body": "Thanks, I was completely unaware. I think I will use their `eval`. The `diff` cannot be used in completeness because we don't know about the Meijer G function (EDIT: #17970), but I can steal half of it.",
    "created_at": "2015-03-17T07:43:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216090",
    "user": "https://github.com/rwst"
}
```

Thanks, I was completely unaware. I think I will use their `eval`. The `diff` cannot be used in completeness because we don't know about the Meijer G function (EDIT: #17970), but I can steal half of it.



---

archive/issue_events_048927.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-17T07:43:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48927"
}
```



---

archive/issue_events_048928.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-17T07:43:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48928"
}
```



---

archive/issue_comments_216091.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-17T16:25:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216091",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216092.json:
```json
{
    "body": "Three doctests fail now because we depend on `sympy.erf._sage_()` which will be in Sympy-0.7.7. So this is pending.",
    "created_at": "2015-03-17T16:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216092",
    "user": "https://github.com/rwst"
}
```

Three doctests fail now because we depend on `sympy.erf._sage_()` which will be in Sympy-0.7.7. So this is pending.



---

archive/issue_events_048929.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-17T16:31:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48929"
}
```



---

archive/issue_events_048930.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-03-17T16:31:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48930"
}
```



---

archive/issue_comments_216093.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-03-17T16:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216093",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_216094.json:
```json
{
    "body": "Is there a ticket for sympy-0.7.7?",
    "created_at": "2015-04-17T00:35:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216094",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Is there a ticket for sympy-0.7.7?



---

archive/issue_comments_216095.json:
```json
{
    "body": "Replying to [comment:44 buck]:\n> Is there a ticket for sympy-0.7.7?\n\nThere will be as soon it is released!",
    "created_at": "2015-04-17T06:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216095",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:44 buck]:
> Is there a ticket for sympy-0.7.7?

There will be as soon it is released!



---

archive/issue_comments_216096.json:
```json
{
    "body": "The diff link of this ticket shows not the correct diff but if you `git trac checkout 16697` you get the right branch.",
    "created_at": "2015-04-20T13:25:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216096",
    "user": "https://github.com/rwst"
}
```

The diff link of this ticket shows not the correct diff but if you `git trac checkout 16697` you get the right branch.



---

archive/issue_comments_216097.json:
```json
{
    "body": "I tried to review this (per ticket:18210#comment:18) but quickly got confused. (This would be a lot easier on github.)\n\n1. Could one of you point me to the doc pertaining to `_sage_`? I did look, but the [special sage functions](http://www.sagemath.org/doc/developer/coding_in_python.html#special-sage-functions) page doesn't mention it.\n2. There are some [doctests regarding precision](https://github.com/sagemath/sage/blob/master/src/sage/functions/other.py#L1040-L1056) that have been obliterated. Was this intentional? Why?\n3. It seems like this new function (gamma_inc_lower) would be deprecated as soon as #17722 is implemented. Don't we want to take a minute to figure out a design that works for both issues?\n\nI think if this patch implemented lower-gamma as a special case of a single general gamma function we would end up with less if statements / edge cases / opportunities for bugs. \n\nEdit: ... end up with *less* bugs",
    "created_at": "2015-04-20T16:40:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216097",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

I tried to review this (per ticket:18210#comment:18) but quickly got confused. (This would be a lot easier on github.)

1. Could one of you point me to the doc pertaining to `_sage_`? I did look, but the [special sage functions](http://www.sagemath.org/doc/developer/coding_in_python.html#special-sage-functions) page doesn't mention it.
2. There are some [doctests regarding precision](https://github.com/sagemath/sage/blob/master/src/sage/functions/other.py#L1040-L1056) that have been obliterated. Was this intentional? Why?
3. It seems like this new function (gamma_inc_lower) would be deprecated as soon as #17722 is implemented. Don't we want to take a minute to figure out a design that works for both issues?

I think if this patch implemented lower-gamma as a special case of a single general gamma function we would end up with less if statements / edge cases / opportunities for bugs. 

Edit: ... end up with *less* bugs



---

archive/issue_comments_216098.json:
```json
{
    "body": "Replying to [comment:47 buck]:\n>  1. Could one of you point me to the doc pertaining to `_sage_`?\n  \nhttps://github.com/sagemath/sage/blob/master/src/sage/structure/sage_object.pyx#L557\nThis is overridden where necessary so please see the resp. class. Probably you want to know about interfaces:\nhttps://github.com/sagemath/sage/blob/master/src/sage/interfaces/interface.py#L803\nhttp://sagemath.org/doc/reference/interfaces/index.html \n>  2. There are some [doctests regarding precision](https://github.com/sagemath/sage/blob/master/src/sage/functions/other.py#L1040-L1056) that have been obliterated. Was this intentional? Why?\n  \nOh that's true, I don't know why that got ditched. \n>  3. It seems like this new function (gamma_inc_lower) would be deprecated as soon as #17722 is implemented. Don't we want to take a minute to figure out a design that works for both issues?\n  \nThere should be no problem to support both interfaces, and without code duplication. We already have\n\n```\nsage: incomplete_gamma(1,2)\ne^(-2)\nsage: gamma(1,2)\ne^(-2)\nsage: gamma(2)\n1\n```\n> I think if this patch implemented lower-gamma as a special case of a single general gamma function we would end up with less if statements / edge cases / opportunities for bugs. \n\nWell that's the task for #17722, right. To have many doctests will help a good deal.\n\nNote that even if you review this ticket (please add your real name to the ticket head in case) we would need to wait for Sympy-0.7.7 to be released. But a review of the code and the math would leave only a `make ptestlong` to finish it all.\n\nEDIT: typos",
    "created_at": "2015-04-21T06:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216098",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:47 buck]:
>  1. Could one of you point me to the doc pertaining to `_sage_`?
  
https://github.com/sagemath/sage/blob/master/src/sage/structure/sage_object.pyx#L557
This is overridden where necessary so please see the resp. class. Probably you want to know about interfaces:
https://github.com/sagemath/sage/blob/master/src/sage/interfaces/interface.py#L803
http://sagemath.org/doc/reference/interfaces/index.html 
>  2. There are some [doctests regarding precision](https://github.com/sagemath/sage/blob/master/src/sage/functions/other.py#L1040-L1056) that have been obliterated. Was this intentional? Why?
  
Oh that's true, I don't know why that got ditched. 
>  3. It seems like this new function (gamma_inc_lower) would be deprecated as soon as #17722 is implemented. Don't we want to take a minute to figure out a design that works for both issues?
  
There should be no problem to support both interfaces, and without code duplication. We already have

```
sage: incomplete_gamma(1,2)
e^(-2)
sage: gamma(1,2)
e^(-2)
sage: gamma(2)
1
```
> I think if this patch implemented lower-gamma as a special case of a single general gamma function we would end up with less if statements / edge cases / opportunities for bugs. 

Well that's the task for #17722, right. To have many doctests will help a good deal.

Note that even if you review this ticket (please add your real name to the ticket head in case) we would need to wait for Sympy-0.7.7 to be released. But a review of the code and the math would leave only a `make ptestlong` to finish it all.

EDIT: typos



---

archive/issue_comments_216099.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-22T06:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216099",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_216100.json:
```json
{
    "body": "I left this as \"needs work\" because of your \"Oh that's true, I don't know why that got ditched.\"\n\nCould you merge this up with master and I'll attempt to review again?\n\nAlso, please show me how to run all the relevant tests, please?\n\nI'm surprised sympy hasn't cut a release yet, still.\nIf I'm counting correctly, it's been eight months since their last release.",
    "created_at": "2015-07-26T19:59:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216100",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

I left this as "needs work" because of your "Oh that's true, I don't know why that got ditched."

Could you merge this up with master and I'll attempt to review again?

Also, please show me how to run all the relevant tests, please?

I'm surprised sympy hasn't cut a release yet, still.
If I'm counting correctly, it's been eight months since their last release.



---

archive/issue_comments_216101.json:
```json
{
    "body": "Merged and attempted to run the doctests, and got this result:\n\n```\n./sage -t src/sage/functions/other.py                                                                    \u2b06 \u2731 \u25fc\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2015-07-26-17-39-51-10ac5315.\nGit branch: master\nUsing --optional=mpir,python2,sage,scons\nDoctesting 1 file.\nsage -t src/sage/functions/other.py\n**********************************************************************\nFile \"src/sage/functions/other.py\", line 1076, in sage.functions.other.Function_gamma_inc_lower._eval_\nFailed example:\n    gamma_inc_lower(1/2,2)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.functions.other.Function_gamma_inc_lower._eval_[2]>\", line 1, in <module>\n        gamma_inc_lower(Integer(1)/Integer(2),Integer(2))\n      File \"sage/symbolic/function.pyx\", line 994, in sage.symbolic.function.BuiltinFunction.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:10875)\n        res = super(BuiltinFunction, self).__call__(\n      File \"sage/symbolic/function.pyx\", line 507, in sage.symbolic.function.Function.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:6887)\n        res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,\n      File \"sage/symbolic/pynac.pyx\", line 185, in sage.symbolic.pynac.pyExpression_to_ex (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/pynac.cpp:3934)\n        t = ring.SR.coerce(res)\n      File \"sage/structure/parent.pyx\", line 1310, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10682)\n        cpdef coerce(self, x):\n      File \"sage/structure/parent.pyx\", line 1339, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10628)\n        return (<map.Map>mor)._call_(x)\n      File \"sage/symbolic/ring.pyx\", line 927, in sage.symbolic.ring.UnderscoreSageMorphism._call_ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/ring.cpp:10428)\n        return self.codomain()(a._sage_())\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/mul.py\", line 1467, in _sage_\n        s *= x._sage_()\n    AttributeError: 'erf' object has no attribute '_sage_'\n**********************************************************************\nFile \"src/sage/functions/other.py\", line 1078, in sage.functions.other.Function_gamma_inc_lower._eval_\nFailed example:\n    gamma_inc_lower(1/2,1)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.functions.other.Function_gamma_inc_lower._eval_[3]>\", line 1, in <module>\n        gamma_inc_lower(Integer(1)/Integer(2),Integer(1))\n      File \"sage/symbolic/function.pyx\", line 994, in sage.symbolic.function.BuiltinFunction.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:10875)\n        res = super(BuiltinFunction, self).__call__(\n      File \"sage/symbolic/function.pyx\", line 507, in sage.symbolic.function.Function.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:6887)\n        res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,\n      File \"sage/symbolic/pynac.pyx\", line 185, in sage.symbolic.pynac.pyExpression_to_ex (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/pynac.cpp:3934)\n        t = ring.SR.coerce(res)\n      File \"sage/structure/parent.pyx\", line 1310, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10682)\n        cpdef coerce(self, x):\n      File \"sage/structure/parent.pyx\", line 1339, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10628)\n        return (<map.Map>mor)._call_(x)\n      File \"sage/symbolic/ring.pyx\", line 927, in sage.symbolic.ring.UnderscoreSageMorphism._call_ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/ring.cpp:10428)\n        return self.codomain()(a._sage_())\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/mul.py\", line 1467, in _sage_\n        s *= x._sage_()\n    AttributeError: 'erf' object has no attribute '_sage_'\n**********************************************************************\nFile \"src/sage/functions/other.py\", line 1092, in sage.functions.other.Function_gamma_inc_lower._eval_\nFailed example:\n    gamma_inc_lower(9/2,37/7)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.functions.other.Function_gamma_inc_lower._eval_[10]>\", line 1, in <module>\n        gamma_inc_lower(Integer(9)/Integer(2),Integer(37)/Integer(7))\n      File \"sage/symbolic/function.pyx\", line 994, in sage.symbolic.function.BuiltinFunction.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:10875)\n        res = super(BuiltinFunction, self).__call__(\n      File \"sage/symbolic/function.pyx\", line 507, in sage.symbolic.function.Function.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:6887)\n        res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,\n      File \"sage/symbolic/pynac.pyx\", line 185, in sage.symbolic.pynac.pyExpression_to_ex (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/pynac.cpp:3934)\n        t = ring.SR.coerce(res)\n      File \"sage/structure/parent.pyx\", line 1310, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10682)\n        cpdef coerce(self, x):\n      File \"sage/structure/parent.pyx\", line 1339, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10628)\n        return (<map.Map>mor)._call_(x)\n      File \"sage/symbolic/ring.pyx\", line 927, in sage.symbolic.ring.UnderscoreSageMorphism._call_ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/ring.cpp:10428)\n        return self.codomain()(a._sage_())\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/add.py\", line 732, in _sage_\n        s += x._sage_()\n      File \"/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/mul.py\", line 1467, in _sage_\n        s *= x._sage_()\n    AttributeError: 'erf' object has no attribute '_sage_'\n**********************************************************************\n1 item had failures:\n   3 of  12 in sage.functions.other.Function_gamma_inc_lower._eval_\n    [509 tests, 3 failures, 3.90 s]\n----------------------------------------------------------------------\nsage -t src/sage/functions/other.py  # 3 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 4.1 seconds\n    cpu time: 2.5 seconds\n    cumulative wall time: 3.9 seconds\n```",
    "created_at": "2015-07-27T00:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216101",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Merged and attempted to run the doctests, and got this result:

```
./sage -t src/sage/functions/other.py                                                                    ⬆ ✱ ◼
too few successful tests, not using stored timings
Running doctests with ID 2015-07-26-17-39-51-10ac5315.
Git branch: master
Using --optional=mpir,python2,sage,scons
Doctesting 1 file.
sage -t src/sage/functions/other.py
**********************************************************************
File "src/sage/functions/other.py", line 1076, in sage.functions.other.Function_gamma_inc_lower._eval_
Failed example:
    gamma_inc_lower(1/2,2)
Exception raised:
    Traceback (most recent call last):
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.functions.other.Function_gamma_inc_lower._eval_[2]>", line 1, in <module>
        gamma_inc_lower(Integer(1)/Integer(2),Integer(2))
      File "sage/symbolic/function.pyx", line 994, in sage.symbolic.function.BuiltinFunction.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:10875)
        res = super(BuiltinFunction, self).__call__(
      File "sage/symbolic/function.pyx", line 507, in sage.symbolic.function.Function.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:6887)
        res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,
      File "sage/symbolic/pynac.pyx", line 185, in sage.symbolic.pynac.pyExpression_to_ex (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/pynac.cpp:3934)
        t = ring.SR.coerce(res)
      File "sage/structure/parent.pyx", line 1310, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10682)
        cpdef coerce(self, x):
      File "sage/structure/parent.pyx", line 1339, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10628)
        return (<map.Map>mor)._call_(x)
      File "sage/symbolic/ring.pyx", line 927, in sage.symbolic.ring.UnderscoreSageMorphism._call_ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/ring.cpp:10428)
        return self.codomain()(a._sage_())
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/mul.py", line 1467, in _sage_
        s *= x._sage_()
    AttributeError: 'erf' object has no attribute '_sage_'
**********************************************************************
File "src/sage/functions/other.py", line 1078, in sage.functions.other.Function_gamma_inc_lower._eval_
Failed example:
    gamma_inc_lower(1/2,1)
Exception raised:
    Traceback (most recent call last):
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.functions.other.Function_gamma_inc_lower._eval_[3]>", line 1, in <module>
        gamma_inc_lower(Integer(1)/Integer(2),Integer(1))
      File "sage/symbolic/function.pyx", line 994, in sage.symbolic.function.BuiltinFunction.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:10875)
        res = super(BuiltinFunction, self).__call__(
      File "sage/symbolic/function.pyx", line 507, in sage.symbolic.function.Function.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:6887)
        res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,
      File "sage/symbolic/pynac.pyx", line 185, in sage.symbolic.pynac.pyExpression_to_ex (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/pynac.cpp:3934)
        t = ring.SR.coerce(res)
      File "sage/structure/parent.pyx", line 1310, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10682)
        cpdef coerce(self, x):
      File "sage/structure/parent.pyx", line 1339, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10628)
        return (<map.Map>mor)._call_(x)
      File "sage/symbolic/ring.pyx", line 927, in sage.symbolic.ring.UnderscoreSageMorphism._call_ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/ring.cpp:10428)
        return self.codomain()(a._sage_())
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/mul.py", line 1467, in _sage_
        s *= x._sage_()
    AttributeError: 'erf' object has no attribute '_sage_'
**********************************************************************
File "src/sage/functions/other.py", line 1092, in sage.functions.other.Function_gamma_inc_lower._eval_
Failed example:
    gamma_inc_lower(9/2,37/7)
Exception raised:
    Traceback (most recent call last):
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.functions.other.Function_gamma_inc_lower._eval_[10]>", line 1, in <module>
        gamma_inc_lower(Integer(9)/Integer(2),Integer(37)/Integer(7))
      File "sage/symbolic/function.pyx", line 994, in sage.symbolic.function.BuiltinFunction.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:10875)
        res = super(BuiltinFunction, self).__call__(
      File "sage/symbolic/function.pyx", line 507, in sage.symbolic.function.Function.__call__ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/function.cpp:6887)
        res = g_function_eval2(self._serial, (<Expression>args[0])._gobj,
      File "sage/symbolic/pynac.pyx", line 185, in sage.symbolic.pynac.pyExpression_to_ex (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/pynac.cpp:3934)
        t = ring.SR.coerce(res)
      File "sage/structure/parent.pyx", line 1310, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10682)
        cpdef coerce(self, x):
      File "sage/structure/parent.pyx", line 1339, in sage.structure.parent.Parent.coerce (/home/buck/trees/mine/sage/src/build/cythonized/sage/structure/parent.c:10628)
        return (<map.Map>mor)._call_(x)
      File "sage/symbolic/ring.pyx", line 927, in sage.symbolic.ring.UnderscoreSageMorphism._call_ (/home/buck/trees/mine/sage/src/build/cythonized/sage/symbolic/ring.cpp:10428)
        return self.codomain()(a._sage_())
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/add.py", line 732, in _sage_
        s += x._sage_()
      File "/home/buck/trees/mine/sage/local/lib/python2.7/site-packages/sympy/core/mul.py", line 1467, in _sage_
        s *= x._sage_()
    AttributeError: 'erf' object has no attribute '_sage_'
**********************************************************************
1 item had failures:
   3 of  12 in sage.functions.other.Function_gamma_inc_lower._eval_
    [509 tests, 3 failures, 3.90 s]
----------------------------------------------------------------------
sage -t src/sage/functions/other.py  # 3 doctests failed
----------------------------------------------------------------------
Total time for all tests: 4.1 seconds
    cpu time: 2.5 seconds
    cumulative wall time: 3.9 seconds
```



---

archive/issue_comments_216102.json:
```json
{
    "body": "I realized I needed to upgrade sympy for this branch to work.\nAfter that, the functions.other doctests pass, but a full ptest shows some failures that seem unrelated, but it's hard for me to be sure. I've attached the full result.",
    "created_at": "2015-07-27T01:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216102",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

I realized I needed to upgrade sympy for this branch to work.
After that, the functions.other doctests pass, but a full ptest shows some failures that seem unrelated, but it's hard for me to be sure. I've attached the full result.



---

archive/issue_comments_216103.json:
```json
{
    "body": "ptest results",
    "created_at": "2015-07-27T02:00:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216103",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

ptest results



---

archive/issue_comments_216104.json:
```json
{
    "body": "Attachment [ptest.log](tarball://root/attachments/some-uuid/ticket16697/ptest.log) by buck created at 2015-07-27 03:29:57\n\nThere's something not quite right with this branch. I get `gamma_greek` if I use combine().\n\n```\nsage: e\ngamma(x, y) + gamma_inc_lower(x, y)\nsage: e.combine()\ngamma(x, y) + gamma_greek(x, y)\nsage: e(x=1, y=2)\n1\nsage: e.combine()(x=1, y=2)\ne^(-2) + gamma_greek(1, 2)\n```",
    "created_at": "2015-07-27T03:29:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216104",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Attachment [ptest.log](tarball://root/attachments/some-uuid/ticket16697/ptest.log) by buck created at 2015-07-27 03:29:57

There's something not quite right with this branch. I get `gamma_greek` if I use combine().

```
sage: e
gamma(x, y) + gamma_inc_lower(x, y)
sage: e.combine()
gamma(x, y) + gamma_greek(x, y)
sage: e(x=1, y=2)
1
sage: e.combine()(x=1, y=2)
e^(-2) + gamma_greek(1, 2)
```



---

archive/issue_comments_216105.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-27T06:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216105",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_216106.json:
```json
{
    "body": "Cannot confirm your doctest failures (except those where sympy-0.7.7 is needed), nor the combine problem. It looks like you tested with an older Sage the doctests of a newer Sage. \n\nI have squashed all commits into one, and uploaded a new branch based on Sage-6.8. In this branch the three missing doctests were added as well.\n\nReally, a full test should only be done with sympy-0.7.7 but if you think the rest is fine(?) then the missing long test eventually is done quickly by the patchbot.\n\n---\nNew commits:",
    "created_at": "2015-07-27T06:57:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216106",
    "user": "https://github.com/rwst"
}
```

Cannot confirm your doctest failures (except those where sympy-0.7.7 is needed), nor the combine problem. It looks like you tested with an older Sage the doctests of a newer Sage. 

I have squashed all commits into one, and uploaded a new branch based on Sage-6.8. In this branch the three missing doctests were added as well.

Really, a full test should only be done with sympy-0.7.7 but if you think the rest is fine(?) then the missing long test eventually is done quickly by the patchbot.

---
New commits:



---

archive/issue_comments_216107.json:
```json
{
    "body": "I did the full test with sympy-0.7.7, only after I got your new doctests in functions.other passing.\n\nI reproduced the combine-gamma-greek problem with sage -br, which I would think should avoid any version-mismatch issues no?  (Apparently the maxima writer forgot that uppercase gamma is also greek?)\n\nThat said, I can't reproduce it anymore after merging your branch and running another sage -br.\n\nShould this not come out as gamma_inc_lower?\n\n```\n./sage -br\nsage: maxima('gamma_greek(x, y)')\ngamma_greek(x,y)\n```\n\nI do see that `_sage_` of the same expression yields gamma_inc_lower. I suppose I don't know enough about the coersion going on here. I did try looking in the docs but didn't find anything that helped me understand this particular aspect.\n\n```\nsage: maxima('gamma_greek(x, y)')\ngamma_greek(x,y)\n\nsage: maxima('gamma_greek(x, y)')._sage_()\ngamma_inc_lower(x, y)\n\nsage: maxima('gamma_greek(x, y)').simplify()\nsimplify(gamma_greek(x,y))\n\nsage: maxima('gamma_greek(x, y)')._sage_().simplify()\ngamma_inc_lower(x, y)\n```",
    "created_at": "2015-07-27T15:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216107",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

I did the full test with sympy-0.7.7, only after I got your new doctests in functions.other passing.

I reproduced the combine-gamma-greek problem with sage -br, which I would think should avoid any version-mismatch issues no?  (Apparently the maxima writer forgot that uppercase gamma is also greek?)

That said, I can't reproduce it anymore after merging your branch and running another sage -br.

Should this not come out as gamma_inc_lower?

```
./sage -br
sage: maxima('gamma_greek(x, y)')
gamma_greek(x,y)
```

I do see that `_sage_` of the same expression yields gamma_inc_lower. I suppose I don't know enough about the coersion going on here. I did try looking in the docs but didn't find anything that helped me understand this particular aspect.

```
sage: maxima('gamma_greek(x, y)')
gamma_greek(x,y)

sage: maxima('gamma_greek(x, y)')._sage_()
gamma_inc_lower(x, y)

sage: maxima('gamma_greek(x, y)').simplify()
simplify(gamma_greek(x,y))

sage: maxima('gamma_greek(x, y)')._sage_().simplify()
gamma_inc_lower(x, y)
```



---

archive/issue_comments_216108.json:
```json
{
    "body": "Replying to [comment:56 buck]:\n> I did the full test with sympy-0.7.7, only after I got your new doctests in functions.other passing.\n\nHow did you do that. Are there release tarballs of sympy-0.7.7? Note that having it on your machine does not mean Sage will use it. The version used is that in the upstream directory of Sage.",
    "created_at": "2015-07-28T07:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216108",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:56 buck]:
> I did the full test with sympy-0.7.7, only after I got your new doctests in functions.other passing.

How did you do that. Are there release tarballs of sympy-0.7.7? Note that having it on your machine does not mean Sage will use it. The version used is that in the upstream directory of Sage.



---

archive/issue_comments_216109.json:
```json
{
    "body": "I installed their master branch to the local/ tree.\nPutting local/bin on the $PATH makes it close enough to a virtualenv that pip will Just Work.\n\nI needed this to get the doctests working as well, so I presumed it was also your procedure. If not, how were you getting your tests to pass?",
    "created_at": "2015-07-28T15:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216109",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

I installed their master branch to the local/ tree.
Putting local/bin on the $PATH makes it close enough to a virtualenv that pip will Just Work.

I needed this to get the doctests working as well, so I presumed it was also your procedure. If not, how were you getting your tests to pass?



---

archive/issue_comments_216110.json:
```json
{
    "body": "Replying to [comment:58 buck]:\n> I needed this to get the doctests working as well, so I presumed it was also your procedure. If not, how were you getting your tests to pass?\n\nNever said I did. The ticket has pending and dependency set as well. But thanks anyway 8) So, except from a final test, would you say your review is positive?",
    "created_at": "2015-07-28T16:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216110",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:58 buck]:
> I needed this to get the doctests working as well, so I presumed it was also your procedure. If not, how were you getting your tests to pass?

Never said I did. The ticket has pending and dependency set as well. But thanks anyway 8) So, except from a final test, would you say your review is positive?



---

archive/issue_comments_216111.json:
```json
{
    "body": "There's doctest coverage missing (for the deprecated function), and this patch doesn't fix the numerical instability in incomplete gamma as promised [ticket:18210#comment:18 elsewhere].\n\n\n```\nsage: gamma_inc_lower(25, 14.5).n()\n-6.63538851954338e22\nsage: gamma_inc_lower(25, 14.5).n(algorithm='mpmath')\n-6.63538851954338e22\nsage: gamma_inc_lower(25, 14.5).n(algorithm='pari')\n-6.63538851954338e22\n```",
    "created_at": "2015-07-28T16:42:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216111",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

There's doctest coverage missing (for the deprecated function), and this patch doesn't fix the numerical instability in incomplete gamma as promised [ticket:18210#comment:18 elsewhere].


```
sage: gamma_inc_lower(25, 14.5).n()
-6.63538851954338e22
sage: gamma_inc_lower(25, 14.5).n(algorithm='mpmath')
-6.63538851954338e22
sage: gamma_inc_lower(25, 14.5).n(algorithm='pari')
-6.63538851954338e22
```



---

archive/issue_comments_216112.json:
```json
{
    "body": "Of note, gamma (even incomplete) is strictly positive in the reals; it's an integral of a strictly positive function.\n\nhttps://en.wikipedia.org/wiki/Incomplete_gamma_function#Definition",
    "created_at": "2015-07-28T16:46:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216112",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Of note, gamma (even incomplete) is strictly positive in the reals; it's an integral of a strictly positive function.

https://en.wikipedia.org/wiki/Incomplete_gamma_function#Definition



---

archive/issue_comments_216113.json:
```json
{
    "body": "Wolfram gives the value of the same as 4.7e21, which seems correct.\n\nhttp://www.wolframalpha.com/input/?i=Gamma%5B25%2C+0%2C+14.5%5D",
    "created_at": "2015-07-28T16:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216113",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Wolfram gives the value of the same as 4.7e21, which seems correct.

http://www.wolframalpha.com/input/?i=Gamma%5B25%2C+0%2C+14.5%5D



---

archive/issue_comments_216114.json:
```json
{
    "body": "Actually, if I ask pari directly, it gets the correct value, so maybe the algorithm argument is broken?\n\n```\nsage: pari('gamma(25) - incgam(25, 14.5)')\n4.71197173824555 E21\nsage: pari('incgamc(25, 14.5)')\n4.71197173824555 E21\n```",
    "created_at": "2015-07-28T17:04:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216114",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Actually, if I ask pari directly, it gets the correct value, so maybe the algorithm argument is broken?

```
sage: pari('gamma(25) - incgam(25, 14.5)')
4.71197173824555 E21
sage: pari('incgamc(25, 14.5)')
4.71197173824555 E21
```



---

archive/issue_comments_216115.json:
```json
{
    "body": "Same story if I ask mpmath directly. I can't imagine what's wrong.\n\n```\nsage: call(mpmath.gammainc, 25, 0, 14.5)\n4.71197173824555e21\n```",
    "created_at": "2015-07-28T17:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216115",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Same story if I ask mpmath directly. I can't imagine what's wrong.

```
sage: call(mpmath.gammainc, 25, 0, 14.5)
4.71197173824555e21
```



---

archive/issue_comments_216116.json:
```json
{
    "body": "Replying to [comment:64 buck]:\n> Same story if I ask mpmath directly. I can't imagine what's wrong.\n\n\n'algorithm' isn't propagated to `evalf` so we always get the buggy pari values. As we would have to switch the default anyway as soon as a later pari version fixes the bug, I'll now simply disable pari. We'll have to live with `mpmath`'s 53 bits for now.",
    "created_at": "2015-07-29T07:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216116",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:64 buck]:
> Same story if I ask mpmath directly. I can't imagine what's wrong.


'algorithm' isn't propagated to `evalf` so we always get the buggy pari values. As we would have to switch the default anyway as soon as a later pari version fixes the bug, I'll now simply disable pari. We'll have to live with `mpmath`'s 53 bits for now.



---

archive/issue_comments_216117.json:
```json
{
    "body": "Replying to [comment:63 buck]:\n> Actually, if I ask pari directly, it gets the correct value, so maybe the algorithm argument is broken?\n> \n> \n> ```\n> sage: pari('gamma(25) - incgam(25, 14.5)')\n> 4.71197173824555 E21\n> sage: pari('incgamc(25, 14.5)')\n> 4.71197173824555 E21\n> ```\n\nThis works because it uses the gp interface (the libpari might be broken on our side). Ah, that's two different bugs. However, even if it is in our interface to libpari and we fix this, or if we use the gp interface, there is still the unfixed pari bug at\nhttp://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1689PARI/GP",
    "created_at": "2015-07-29T07:59:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216117",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:63 buck]:
> Actually, if I ask pari directly, it gets the correct value, so maybe the algorithm argument is broken?
> 
> 
> ```
> sage: pari('gamma(25) - incgam(25, 14.5)')
> 4.71197173824555 E21
> sage: pari('incgamc(25, 14.5)')
> 4.71197173824555 E21
> ```

This works because it uses the gp interface (the libpari might be broken on our side). Ah, that's two different bugs. However, even if it is in our interface to libpari and we fix this, or if we use the gp interface, there is still the unfixed pari bug at
http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1689PARI/GP



---

archive/issue_comments_216118.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-29T08:30:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216118",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216119.json:
```json
{
    "body": "Actually the 53-bit restriction applies only to larger values, so all is not lost.",
    "created_at": "2015-07-29T08:31:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216119",
    "user": "https://github.com/rwst"
}
```

Actually the 53-bit restriction applies only to larger values, so all is not lost.



---

archive/issue_comments_216120.json:
```json
{
    "body": "Replying to [comment:30 rws]:\n> I'm going back to Pari as default since mpmath has similar problems as earlier Pari, see #17328 and https://github.com/fredrik-johansson/mpmath/issues/301\n\nThe mpmath issue is now fixed as well so we have both options, mpmath or Pari/GP.",
    "created_at": "2016-02-19T07:46:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216120",
    "user": "https://github.com/rwst"
}
```

Replying to [comment:30 rws]:
> I'm going back to Pari as default since mpmath has similar problems as earlier Pari, see #17328 and https://github.com/fredrik-johansson/mpmath/issues/301

The mpmath issue is now fixed as well so we have both options, mpmath or Pari/GP.



---

archive/issue_comments_216121.json:
```json
{
    "body": "You could also compute the incomplete gamma function with Arb.",
    "created_at": "2016-02-19T10:10:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216121",
    "user": "https://github.com/fredrik-johansson"
}
```

You could also compute the incomplete gamma function with Arb.



---

archive/issue_events_048931.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-03-14T16:03:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48931"
}
```



---

archive/issue_events_048932.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-03-14T16:03:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "milestone": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48932"
}
```



---

archive/issue_comments_216122.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-03-14T16:03:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216122",
    "user": "https://github.com/rwst"
}
```

New commits:



---

archive/issue_comments_216123.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-05-14T08:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216123",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_216124.json:
```json
{
    "body": "does not apply",
    "created_at": "2016-05-14T08:28:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216124",
    "user": "https://github.com/fchapoton"
}
```

does not apply



---

archive/issue_comments_216125.json:
```json
{
    "body": "Wanna review?",
    "created_at": "2016-05-14T12:28:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216125",
    "user": "https://github.com/rwst"
}
```

Wanna review?



---

archive/issue_comments_216126.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-05-20T15:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216126",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_216127.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-05-20T15:11:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216127",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_216128.json:
```json
{
    "body": "Current 7.3.beta5 Sage builds fine with these modifications. Doctests all pass. Documentation builds.\n\nRandom numeric tests accurate. Function plots. One curious difference from `gamma_inc`:\n\n\n```\nsage: gamma_inc_lower(a,x).diff(x)\nx^(a - 1)*e^(-x)\nsage: gamma_inc(a,x).diff(x)\nD[1](gamma)(a, x)\n```\n\nLooks good to me. Sympy already updated: any other reason not to merge?",
    "created_at": "2016-06-26T22:01:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216128",
    "user": "https://github.com/paulmasson"
}
```

Current 7.3.beta5 Sage builds fine with these modifications. Doctests all pass. Documentation builds.

Random numeric tests accurate. Function plots. One curious difference from `gamma_inc`:


```
sage: gamma_inc_lower(a,x).diff(x)
x^(a - 1)*e^(-x)
sage: gamma_inc(a,x).diff(x)
D[1](gamma)(a, x)
```

Looks good to me. Sympy already updated: any other reason not to merge?



---

archive/issue_comments_216129.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-06-26T22:02:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216129",
    "user": "https://github.com/paulmasson"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_216130.json:
```json
{
    "body": "Thanks.",
    "created_at": "2016-06-27T07:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216130",
    "user": "https://github.com/rwst"
}
```

Thanks.



---

archive/issue_comments_216131.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-06-27T16:22:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16697#issuecomment-216131",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_048933.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-27T16:22:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16697",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16697#event-48933"
}
```
