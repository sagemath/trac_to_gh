# Issue 16001: Make the tensor functorial construction work for crystals

archive/issues_015764.json:
```json
{
    "body": "Assignee: sage-combinat\n\nCC:  sage-combinat @nthiery @anneschilling @bsalisbury1\n\nKeywords: tensor products construction\n\nSo we don't have to use `TensorProductOfCrystals` (or with #15882 `crystals.TensorProduct`).\n\n```\nsage: B = CrystalOfTableaux(['A',2], shape=[2,1])\n\nsage: tensor([B, B])\nFull tensor product of the crystals\n [The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]],\n  The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]]]\n\nsage: B.tensor(B)\nFull tensor product of the crystals\n [The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]],\n  The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]]]\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/16001\n\n",
    "closed_at": "2014-09-27T12:57:10Z",
    "created_at": "2014-03-23T19:47:51Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Make the tensor functorial construction work for crystals",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16001",
    "user": "https://github.com/tscrim"
}
```
Assignee: sage-combinat

CC:  sage-combinat @nthiery @anneschilling @bsalisbury1

Keywords: tensor products construction

So we don't have to use `TensorProductOfCrystals` (or with #15882 `crystals.TensorProduct`).

```
sage: B = CrystalOfTableaux(['A',2], shape=[2,1])

sage: tensor([B, B])
Full tensor product of the crystals
 [The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]],
  The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]]]

sage: B.tensor(B)
Full tensor product of the crystals
 [The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]],
  The crystal of tableaux of type ['A', 2] and shape(s) [[2, 1]]]
```

Issue created by migration from https://trac.sagemath.org/ticket/16001





---

archive/issue_comments_203877.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-03-23T20:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203877",
    "user": "https://github.com/tscrim"
}
```

New commits:



---

archive/issue_comments_203878.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-23T20:41:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203878",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_203879.json:
```json
{
    "body": "Hi Travis!\n\nThanks for the feature, we want it!\n\nI know the math tradition of calling this a tensor, and see the point of being kind to the user there, but it's still an abuse: in term of functorial construction, it's a cartesian product and I believe it should really be *implemented* as such for consistency with the rest of the infrastructure. For example, this would have the following desirable consequences:\n\n- Inheriting features from cartesian products (counting, enumeration, ...)\n- When we will start working more intensively on the linear span of cristals, the tensor product thereof will call the cartesian product on the basis, not the tensor product, so you would not get the crystal structure on the basis\n- For someone not knowing crystals, that's more informative\n- ...\n\nAlso we might want some day to endow a vector space with a crystal structure, in which case there would be an ambiguity about the meaning of the tensor product. But I don't have a serious use case.\n\nSo, to accomodate the user, it's probably possible to introduce a little trick so that calling `tensor` on a bunch of crystals automatically builds their cartesian product.\n\nCheers,\n\n                                    Nicolas\n\nPS: It's not exactly the same situation, but it's a bit like direct sums of vector spaces that are actually implemented as what they are in terms of construction on sets, namely cartesian products.",
    "created_at": "2014-03-24T08:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203879",
    "user": "https://github.com/nthiery"
}
```

Hi Travis!

Thanks for the feature, we want it!

I know the math tradition of calling this a tensor, and see the point of being kind to the user there, but it's still an abuse: in term of functorial construction, it's a cartesian product and I believe it should really be *implemented* as such for consistency with the rest of the infrastructure. For example, this would have the following desirable consequences:

- Inheriting features from cartesian products (counting, enumeration, ...)
- When we will start working more intensively on the linear span of cristals, the tensor product thereof will call the cartesian product on the basis, not the tensor product, so you would not get the crystal structure on the basis
- For someone not knowing crystals, that's more informative
- ...

Also we might want some day to endow a vector space with a crystal structure, in which case there would be an ambiguity about the meaning of the tensor product. But I don't have a serious use case.

So, to accomodate the user, it's probably possible to introduce a little trick so that calling `tensor` on a bunch of crystals automatically builds their cartesian product.

Cheers,

                                    Nicolas

PS: It's not exactly the same situation, but it's a bit like direct sums of vector spaces that are actually implemented as what they are in terms of construction on sets, namely cartesian products.



---

archive/issue_comments_203880.json:
```json
{
    "body": "This is an attempt at me doing category theory with Lang's *Algebra* in front of me, so I hope it's not too far off.\n\nI don't think this is a (Cartesian) product (in the category of crystals) since there are not natural projection maps (crystal morphisms) onto the factors as the weight/epsilons/phis are not preserved. In the category of crystals, I believe \"multi-linearity\" is defined by the tensor product rule, so it is a tensor product.\n\nFor vector spaces, the direct sum does correspond to the category theoretic product. So when we want to consider this as a basis indexing *set* for a free module and take a tensor product of those modules, we will want to consider the product, but only after applying the forgetful functor to the crystal. I think we'd want to do this in other situations where we have a concrete category that doesn't have a product.\n\nHowever I think the situation is a bit different as a U<sub>q</sub>(**g**)-module in category *O* when we want to use the crystal structure to construct the canonical basis. I'm currently doing this in #14901. Although I will need to override the tensor product construction to pass to the corresponding tensor product of crystals in order to use that structure.\n\nNow onto code. I do agree it would be nice to have `TensorProdutOfCrystals` inherit from Cartesian products when thought of as sets, but I think there would only be three methods that we'd need to duplicate (`__iter__()`, `__contains__()`, and `cardinality()`). Unless you can think of others? Maybe we should keep the class of `CartesianProduct` (of sets) around as a way to inherit these features?\n\nPlease correct me if I'm wrong on any of the above.\n\nBest,\n\nTravis",
    "created_at": "2014-03-24T16:58:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203880",
    "user": "https://github.com/tscrim"
}
```

This is an attempt at me doing category theory with Lang's *Algebra* in front of me, so I hope it's not too far off.

I don't think this is a (Cartesian) product (in the category of crystals) since there are not natural projection maps (crystal morphisms) onto the factors as the weight/epsilons/phis are not preserved. In the category of crystals, I believe "multi-linearity" is defined by the tensor product rule, so it is a tensor product.

For vector spaces, the direct sum does correspond to the category theoretic product. So when we want to consider this as a basis indexing *set* for a free module and take a tensor product of those modules, we will want to consider the product, but only after applying the forgetful functor to the crystal. I think we'd want to do this in other situations where we have a concrete category that doesn't have a product.

However I think the situation is a bit different as a U<sub>q</sub>(**g**)-module in category *O* when we want to use the crystal structure to construct the canonical basis. I'm currently doing this in #14901. Although I will need to override the tensor product construction to pass to the corresponding tensor product of crystals in order to use that structure.

Now onto code. I do agree it would be nice to have `TensorProdutOfCrystals` inherit from Cartesian products when thought of as sets, but I think there would only be three methods that we'd need to duplicate (`__iter__()`, `__contains__()`, and `cardinality()`). Unless you can think of others? Maybe we should keep the class of `CartesianProduct` (of sets) around as a way to inherit these features?

Please correct me if I'm wrong on any of the above.

Best,

Travis



---

archive/issue_comments_203881.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-16T14:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203881",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_047073.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16001#event-47073"
}
```



---

archive/issue_events_047074.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16001#event-47074"
}
```



---

archive/issue_events_047075.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16001#event-47075"
}
```



---

archive/issue_comments_203882.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-16T18:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203882",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_203883.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-25T13:56:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203883",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_203884.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-25T15:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203884",
    "user": "https://github.com/bsalisbury1"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_203885.json:
```json
{
    "body": "Looks good!  Thanks, Travis.",
    "created_at": "2014-09-25T15:41:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203885",
    "user": "https://github.com/bsalisbury1"
}
```

Looks good!  Thanks, Travis.



---

archive/issue_comments_203886.json:
```json
{
    "body": "There seem to be misspellings and broken links!\n\n:class:`RiggedConfiguraitons`",
    "created_at": "2014-09-25T16:04:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203886",
    "user": "https://github.com/anneschilling"
}
```

There seem to be misspellings and broken links!

:class:`RiggedConfiguraitons`



---

archive/issue_comments_203887.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-09-25T16:04:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203887",
    "user": "https://github.com/anneschilling"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_203888.json:
```json
{
    "body": "Good catch!  Each :class:`RiggedConfiguraitons` should be replaced with :class:`RiggedConfigurations`.",
    "created_at": "2014-09-25T16:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203888",
    "user": "https://github.com/bsalisbury1"
}
```

Good catch!  Each :class:`RiggedConfiguraitons` should be replaced with :class:`RiggedConfigurations`.



---

archive/issue_comments_203889.json:
```json
{
    "body": "Also, there is a test in the new code\n\n```\n   sage: C = crystals.Letters(['A', 3])\n   sage: B = crystals.infinity.Tableaux(['A',2])\n   sage: T = C.tensor(C, B); T\n```\nWhat does it mean to take tensor products of crystals of different Cartan type? The documentation of crystals.TensorProduct explicitly says that the Cartan type needs to be the same!",
    "created_at": "2014-09-25T16:32:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203889",
    "user": "https://github.com/anneschilling"
}
```

Also, there is a test in the new code

```
   sage: C = crystals.Letters(['A', 3])
   sage: B = crystals.infinity.Tableaux(['A',2])
   sage: T = C.tensor(C, B); T
```
What does it mean to take tensor products of crystals of different Cartan type? The documentation of crystals.TensorProduct explicitly says that the Cartan type needs to be the same!



---

archive/issue_comments_203890.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-25T16:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203890",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_203891.json:
```json
{
    "body": "Documentation is fixed.\n\nReplying to [comment:13 aschilling]:\n> Also, there is a test in the new code\n> \n> ```\n>    sage: C = crystals.Letters(['A', 3])\n>    sage: B = crystals.infinity.Tableaux(['A',2])\n>    sage: T = C.tensor(C, B); T\n> ```\n> What does it mean to take tensor products of crystals of different Cartan type? The documentation of crystals.TensorProduct explicitly says that the Cartan type needs to be the same!\n\n\nI've added a test to explicitly check this in the constructor (for such a quick and important test, it's somewhat surprising it wasn't there beforehand). I've also changed that specific test to have the same Cartan type.",
    "created_at": "2014-09-25T16:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203891",
    "user": "https://github.com/tscrim"
}
```

Documentation is fixed.

Replying to [comment:13 aschilling]:
> Also, there is a test in the new code
> 
> ```
>    sage: C = crystals.Letters(['A', 3])
>    sage: B = crystals.infinity.Tableaux(['A',2])
>    sage: T = C.tensor(C, B); T
> ```
> What does it mean to take tensor products of crystals of different Cartan type? The documentation of crystals.TensorProduct explicitly says that the Cartan type needs to be the same!


I've added a test to explicitly check this in the constructor (for such a quick and important test, it's somewhat surprising it wasn't there beforehand). I've also changed that specific test to have the same Cartan type.



---

archive/issue_comments_203892.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-25T16:47:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203892",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_203893.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-25T18:22:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203893",
    "user": "https://github.com/anneschilling"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_203894.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-27T12:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16001#issuecomment-203894",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_047076.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-09-27T12:57:10Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16001",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16001#event-47076"
}
```
