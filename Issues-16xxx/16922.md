# Issue 16922: find_brouwer_van_rees_with_one_truncated_column

archive/issues_016685.json:
```json
{
    "body": "Here is what we have been waiting for. Removes a lot of '-', but in parts of the table that we do not see `:-P`\n\nDepends on #16920\n\n**CC:**  @videlec\n\n**Branch/Commit:** [955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e](https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e)\n\n**Reviewer:** Vincent Delecroix\n\n**Author:** Nathann Cohen\n\nIssue created by migration from https://trac.sagemath.org/ticket/16922\n\n",
    "closed_at": "2014-10-29T10:39:53Z",
    "created_at": "2014-09-02T16:33:51Z",
    "labels": [
        "component: combinatorial designs",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "title": "find_brouwer_van_rees_with_one_truncated_column",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/16922",
    "user": "https://github.com/nathanncohen"
}
```
Here is what we have been waiting for. Removes a lot of '-', but in parts of the table that we do not see `:-P`

Depends on #16920

**CC:**  @videlec

**Branch/Commit:** [955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e](https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e)

**Reviewer:** Vincent Delecroix

**Author:** Nathann Cohen

Issue created by migration from https://trac.sagemath.org/ticket/16922





---

archive/issue_comments_225512.json:
```json
{
    "body": "**Branch:** [public/16922](https://github.com/sagemath/sagetrac-mirror/tree/public/16922)",
    "created_at": "2014-09-02T16:34:08Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225512",
    "user": "https://github.com/nathanncohen"
}
```

**Branch:** [public/16922](https://github.com/sagemath/sagetrac-mirror/tree/public/16922)



---

archive/issue_events_151860.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-09-02T16:34:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151860"
}
```



---

archive/issue_comments_225513.json:
```json
{
    "body": "<a id='comment:2'></a>\n**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f23e0cf91e989dd462f78aa123040acba13055dc\">f23e0cf</a></td><td><code>trac #16884: A database entry for Quasi-difference matrices. +doc and stuff</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f074c38f8e432a1bec8a9df9f978139388ad8de3\">f074c38</a></td><td><code>trac #16884: Convert OA(9,514) into a Vmt</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/781b168879114caa1da5708d8e1fcd0aa9be0f02\">781b168</a></td><td><code>trac #16884: is_quasi_difference_matrix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/15c78ba967f5f15644a7eb83f2825de3ba5fd7fd\">15c78ba</a></td><td><code>trac #16884: A V(12,185) that yields a OA(11,2406)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8916046ca141a64b8c50fee198f852b812216a82\">8916046</a></td><td><code>trac #16559: Brouwer-Van Rees version of Wilson's decomposition</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf1145783cc67664986ced298e0f31d4e6c1d3b4\">cf11457</a></td><td><code>trac #16559: Fixed error message for large holes and smaller example</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ecf942e5616e68338fbb6e1d1c73f3e42efe3a8\">4ecf942</a></td><td><code>trac #16920: New V(m,t) vectors</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b06bc3b567ee490b70c338d4d2f02d7c94e2fcb4\">b06bc3b</a></td><td><code>trac #16920: Make the V(m,t) database more compact</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c26542b5d3d206603cabfcc0db5234e8abbd39c8\">c26542b</a></td><td><code>trac #16920: Even more MOLS</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/822f174b04d1fbea062e4431bbba4a95215c4071\">822f174</a></td><td><code>trac #16922: find_brouwer_van_rees_with_one_truncated_column</code></td></tr></table>\n",
    "created_at": "2014-09-02T16:36:55Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225513",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
**Branch pushed to git repo; I updated commit sha1.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f23e0cf91e989dd462f78aa123040acba13055dc">f23e0cf</a></td><td><code>trac #16884: A database entry for Quasi-difference matrices. +doc and stuff</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f074c38f8e432a1bec8a9df9f978139388ad8de3">f074c38</a></td><td><code>trac #16884: Convert OA(9,514) into a Vmt</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/781b168879114caa1da5708d8e1fcd0aa9be0f02">781b168</a></td><td><code>trac #16884: is_quasi_difference_matrix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/15c78ba967f5f15644a7eb83f2825de3ba5fd7fd">15c78ba</a></td><td><code>trac #16884: A V(12,185) that yields a OA(11,2406)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8916046ca141a64b8c50fee198f852b812216a82">8916046</a></td><td><code>trac #16559: Brouwer-Van Rees version of Wilson's decomposition</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf1145783cc67664986ced298e0f31d4e6c1d3b4">cf11457</a></td><td><code>trac #16559: Fixed error message for large holes and smaller example</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ecf942e5616e68338fbb6e1d1c73f3e42efe3a8">4ecf942</a></td><td><code>trac #16920: New V(m,t) vectors</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b06bc3b567ee490b70c338d4d2f02d7c94e2fcb4">b06bc3b</a></td><td><code>trac #16920: Make the V(m,t) database more compact</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c26542b5d3d206603cabfcc0db5234e8abbd39c8">c26542b</a></td><td><code>trac #16920: Even more MOLS</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/822f174b04d1fbea062e4431bbba4a95215c4071">822f174</a></td><td><code>trac #16922: find_brouwer_van_rees_with_one_truncated_column</code></td></tr></table>




---

archive/issue_comments_225514.json:
```json
{
    "body": "**Commit:** [822f174b04d1fbea062e4431bbba4a95215c4071](https://github.com/sagemath/sagetrac-mirror/commit/822f174b04d1fbea062e4431bbba4a95215c4071)",
    "created_at": "2014-09-02T16:36:55Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225514",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [822f174b04d1fbea062e4431bbba4a95215c4071](https://github.com/sagemath/sagetrac-mirror/commit/822f174b04d1fbea062e4431bbba4a95215c4071)



---

archive/issue_comments_225515.json:
```json
{
    "body": "<a id='comment:3'></a>\nHi Nathann,\n\nI got a lot of segmentation error while running the tests with this branch! Do you know what happen?\n\nVincent",
    "created_at": "2014-10-26T12:01:44Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225515",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>
Hi Nathann,

I got a lot of segmentation error while running the tests with this branch! Do you know what happen?

Vincent



---

archive/issue_events_151861.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-10-26T12:01:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151861"
}
```



---

archive/issue_events_151862.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-10-26T12:01:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151862"
}
```



---

archive/issue_events_151863.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-10-26T12:26:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151863"
}
```



---

archive/issue_events_151864.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-10-26T12:26:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151864"
}
```



---

archive/issue_comments_225516.json:
```json
{
    "body": "<a id='comment:4'></a>\nSorry about that. Don't know where the segfaults came from, but when I solved the bug about the \"more than 4 values needed to unpack\" there was none left.\n\nAlso, I rewrote history to move this last commit above its dependencies (in which commits had been added in the meantime).\n\nThis should be better now.\n\nBy the way: the current implementation may look a bit \"hacky\". The thing is that it is 'a bit too early' to implement this construction, because at the moment there are no 'nice' functions to query the database of incomplete orthogonal arrays, and there is none yet because caching incomplete orthogonal arrays is much harder than caching orthogonal arrays (more parameters, mainly !). In the future we may even have find functions for incomplete orthogonal arrays and stuff.\n\nWell, I have to write that and because it is not exactly straightforward to get a good design (and because it requires a lot of 'administrative' code) I implemented that first.\n\nStill, it works and it is not so bad.\n\nWell, just know that I am not intending to leave that code in the current state. Though I tried to not make it too awful either, and of course the review is there to fix anything you will not like.\n\nBranch updated.\n\nNathann",
    "created_at": "2014-10-26T12:26:02Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225516",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
Sorry about that. Don't know where the segfaults came from, but when I solved the bug about the "more than 4 values needed to unpack" there was none left.

Also, I rewrote history to move this last commit above its dependencies (in which commits had been added in the meantime).

This should be better now.

By the way: the current implementation may look a bit "hacky". The thing is that it is 'a bit too early' to implement this construction, because at the moment there are no 'nice' functions to query the database of incomplete orthogonal arrays, and there is none yet because caching incomplete orthogonal arrays is much harder than caching orthogonal arrays (more parameters, mainly !). In the future we may even have find functions for incomplete orthogonal arrays and stuff.

Well, I have to write that and because it is not exactly straightforward to get a good design (and because it requires a lot of 'administrative' code) I implemented that first.

Still, it works and it is not so bad.

Well, just know that I am not intending to leave that code in the current state. Though I tried to not make it too awful either, and of course the review is there to fix anything you will not like.

Branch updated.

Nathann



---

archive/issue_comments_225517.json:
```json
{
    "body": "<a id='comment:5'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b8ba79c4956a5962a2fc3d7491cc7ae58907511\">9b8ba79</a></td><td><code>trac #16559: Fixes reported by Julian R. Abel</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0419b83e4bc0f1d589d371d99c41859b48fe661\">b0419b8</a></td><td><code>trac #16559: Merged with 6.4.beta6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe62ae45eb1ce7642aa35380c8e4fc6033405f9f\">fe62ae4</a></td><td><code>trac #16559: Bugfix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/12177d8c1dd4802baa2608ae4736d805932bca5c\">12177d8</a></td><td><code>trac #16559: fix documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/38251553c0f3ff3c7b4837508cd29eef04d96855\">3825155</a></td><td><code>trac #16559: remove simple_wilson_construction</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9bbd1f24e0689368b338777363ae2199c79e5c17\">9bbd1f2</a></td><td><code>trac #16559: A description for the Brouwer-van Rees construction</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf909063c4c41cf265b70529fccc596beced69e3\">cf90906</a></td><td><code>trac #16920: Correct bibliographical references</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cf378abeaad3db018b88d85c19e5b72218a05a65\">cf378ab</a></td><td><code>trac #16920: Merged with updated #16559</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d26d101552d5c279f849f17fbc7186a421d709e\">0d26d10</a></td><td><code>trac #16922: find_brouwer_van_rees_with_one_truncated_column</code></td></tr></table>\n",
    "created_at": "2014-10-26T12:28:50Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225517",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b8ba79c4956a5962a2fc3d7491cc7ae58907511">9b8ba79</a></td><td><code>trac #16559: Fixes reported by Julian R. Abel</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0419b83e4bc0f1d589d371d99c41859b48fe661">b0419b8</a></td><td><code>trac #16559: Merged with 6.4.beta6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe62ae45eb1ce7642aa35380c8e4fc6033405f9f">fe62ae4</a></td><td><code>trac #16559: Bugfix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/12177d8c1dd4802baa2608ae4736d805932bca5c">12177d8</a></td><td><code>trac #16559: fix documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/38251553c0f3ff3c7b4837508cd29eef04d96855">3825155</a></td><td><code>trac #16559: remove simple_wilson_construction</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9bbd1f24e0689368b338777363ae2199c79e5c17">9bbd1f2</a></td><td><code>trac #16559: A description for the Brouwer-van Rees construction</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf909063c4c41cf265b70529fccc596beced69e3">cf90906</a></td><td><code>trac #16920: Correct bibliographical references</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cf378abeaad3db018b88d85c19e5b72218a05a65">cf378ab</a></td><td><code>trac #16920: Merged with updated #16559</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d26d101552d5c279f849f17fbc7186a421d709e">0d26d10</a></td><td><code>trac #16922: find_brouwer_van_rees_with_one_truncated_column</code></td></tr></table>




---

archive/issue_comments_225518.json:
```json
{
    "body": "**Changing commit** from \"[822f174b04d1fbea062e4431bbba4a95215c4071](https://github.com/sagemath/sagetrac-mirror/commit/822f174b04d1fbea062e4431bbba4a95215c4071)\" to \"[0d26d101552d5c279f849f17fbc7186a421d709e](https://github.com/sagemath/sagetrac-mirror/commit/0d26d101552d5c279f849f17fbc7186a421d709e)\".",
    "created_at": "2014-10-26T12:28:50Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225518",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[822f174b04d1fbea062e4431bbba4a95215c4071](https://github.com/sagemath/sagetrac-mirror/commit/822f174b04d1fbea062e4431bbba4a95215c4071)" to "[0d26d101552d5c279f849f17fbc7186a421d709e](https://github.com/sagemath/sagetrac-mirror/commit/0d26d101552d5c279f849f17fbc7186a421d709e)".



---

archive/issue_comments_225519.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b71013a5ffb081f77fc8a0a75338c8a39c3a378c\">b71013a</a></td><td><code>trac #16922: big optim. + small optim. + doctest</code></td></tr></table>\n",
    "created_at": "2014-10-26T15:36:31Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225519",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b71013a5ffb081f77fc8a0a75338c8a39c3a378c">b71013a</a></td><td><code>trac #16922: big optim. + small optim. + doctest</code></td></tr></table>




---

archive/issue_comments_225520.json:
```json
{
    "body": "**Changing commit** from \"[0d26d101552d5c279f849f17fbc7186a421d709e](https://github.com/sagemath/sagetrac-mirror/commit/0d26d101552d5c279f849f17fbc7186a421d709e)\" to \"[b71013a5ffb081f77fc8a0a75338c8a39c3a378c](https://github.com/sagemath/sagetrac-mirror/commit/b71013a5ffb081f77fc8a0a75338c8a39c3a378c)\".",
    "created_at": "2014-10-26T15:36:31Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225520",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0d26d101552d5c279f849f17fbc7186a421d709e](https://github.com/sagemath/sagetrac-mirror/commit/0d26d101552d5c279f849f17fbc7186a421d709e)" to "[b71013a5ffb081f77fc8a0a75338c8a39c3a378c](https://github.com/sagemath/sagetrac-mirror/commit/b71013a5ffb081f77fc8a0a75338c8a39c3a378c)".



---

archive/issue_comments_225521.json:
```json
{
    "body": "<a id='comment:7'></a>\nHi Nathann,\n\nI changed the complexity of `multiple` by one order. And we can win more by cutting some of the branches (if I got the value `v` in `m` steps then I can not be bigger than `v + (k-m) max_value` at the end).\n\nHave a look and tell me if it is worth it to add this cut.\n\nVincent",
    "created_at": "2014-10-26T15:40:12Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225521",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'></a>
Hi Nathann,

I changed the complexity of `multiple` by one order. And we can win more by cutting some of the branches (if I got the value `v` in `m` steps then I can not be bigger than `v + (k-m) max_value` at the end).

Have a look and tell me if it is worth it to add this cut.

Vincent



---

archive/issue_comments_225522.json:
```json
{
    "body": "<a id='comment:8'></a>\n> I changed the complexity of `multiple` by one order. \n\nTrue, True. Well done `O_o`\n\n> And we can win more by cutting some of the branches (if I got the value `v` in `m` steps then I can not be bigger than `v + (k-m) max_value` at the end).\n\nWell, technically can't we do it with `log(k)` iterations instead of `k` ?\n\nI mean, if you call `S^n={x_1+...+x_n: x_i \\in S}` then you can use the log algorithm to compute the power of a matrix, can't you ? And you can do even faster is you initialize `D` with `D = {r*x:tuple([x]*r) for x in S for r in tuple(range(cutoff/x+1))}`.\n\nKeep in mind that this function will change, somehow. I mean... If we want to be able to do the same for the Brouwer-van Rees decomposition with 2 truncated columns, the problem is very different: in each column you can have any combinations of 'allowed value', but you cannot have a multiplier x in column 1 and a multiplier y in column 2 unless you have an `OA(k,m+x+y)-OA(k,x)-OA(k,y)`.\n\nI still don't know how to write that nicely `T_T`\n\nNathann",
    "created_at": "2014-10-26T15:52:16Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225522",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>
> I changed the complexity of `multiple` by one order. 

True, True. Well done `O_o`

> And we can win more by cutting some of the branches (if I got the value `v` in `m` steps then I can not be bigger than `v + (k-m) max_value` at the end).

Well, technically can't we do it with `log(k)` iterations instead of `k` ?

I mean, if you call `S^n={x_1+...+x_n: x_i \in S}` then you can use the log algorithm to compute the power of a matrix, can't you ? And you can do even faster is you initialize `D` with `D = {r*x:tuple([x]*r) for x in S for r in tuple(range(cutoff/x+1))}`.

Keep in mind that this function will change, somehow. I mean... If we want to be able to do the same for the Brouwer-van Rees decomposition with 2 truncated columns, the problem is very different: in each column you can have any combinations of 'allowed value', but you cannot have a multiplier x in column 1 and a multiplier y in column 2 unless you have an `OA(k,m+x+y)-OA(k,x)-OA(k,y)`.

I still don't know how to write that nicely `T_T`

Nathann



---

archive/issue_comments_225523.json:
```json
{
    "body": "<a id='comment:9'></a>\nYo !\n\n> Have a look and tell me if it is worth it to add this cut.\n\nIt is up to you. I am not sure that it is necessary at the moment: I hope that this will all be rewritten in not so long to handle two columns.\n\nNathann",
    "created_at": "2014-10-26T15:58:16Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225523",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>
Yo !

> Have a look and tell me if it is worth it to add this cut.

It is up to you. I am not sure that it is necessary at the moment: I hope that this will all be rewritten in not so long to handle two columns.

Nathann



---

archive/issue_comments_225524.json:
```json
{
    "body": "**Changing commit** from \"[b71013a5ffb081f77fc8a0a75338c8a39c3a378c](https://github.com/sagemath/sagetrac-mirror/commit/b71013a5ffb081f77fc8a0a75338c8a39c3a378c)\" to \"[955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e](https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e)\".",
    "created_at": "2014-10-26T16:26:54Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225524",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b71013a5ffb081f77fc8a0a75338c8a39c3a378c](https://github.com/sagemath/sagetrac-mirror/commit/b71013a5ffb081f77fc8a0a75338c8a39c3a378c)" to "[955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e](https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e)".



---

archive/issue_comments_225525.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e\">955b67f</a></td><td><code>trac #16922: rewrite multiple (new name int_as_sum)</code></td></tr></table>\n",
    "created_at": "2014-10-26T16:26:54Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225525",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e">955b67f</a></td><td><code>trac #16922: rewrite multiple (new name int_as_sum)</code></td></tr></table>




---

archive/issue_comments_225526.json:
```json
{
    "body": "<a id='comment:11'></a>\nAll right. Done.\n\nI find it much clearer. Perhaps less nicer to make it works for two columns...\n\nVincent",
    "created_at": "2014-10-26T16:27:49Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225526",
    "user": "https://github.com/videlec"
}
```

<a id='comment:11'></a>
All right. Done.

I find it much clearer. Perhaps less nicer to make it works for two columns...

Vincent



---

archive/issue_comments_225527.json:
```json
{
    "body": "<a id='comment:12'></a>\nWhat is the point of making it decrease toward zero ? `O_o`\n\nTo have more meaningful comments like\n`if (vv > 0 and   # The new integer i is too big` ?\n\nHonestly I do not care, this will be rewritten soon anyway. But why would you do something like that ?\n\nYou even do `for j in range(k-1,-1,-1)` which is totally equivalent to `for j in range(k)` given that you do not use j. Only to make it more complicated ?...\n\nNathann",
    "created_at": "2014-10-26T22:24:44Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225527",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>
What is the point of making it decrease toward zero ? `O_o`

To have more meaningful comments like
`if (vv > 0 and   # The new integer i is too big` ?

Honestly I do not care, this will be rewritten soon anyway. But why would you do something like that ?

You even do `for j in range(k-1,-1,-1)` which is totally equivalent to `for j in range(k)` given that you do not use j. Only to make it more complicated ?...

Nathann



---

archive/issue_comments_225528.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [ncohen](#comment%3A12):\n> What is the point of making it decrease toward zero ? `O_o`\n> \n> To have more meaningful comments like\n> `if (vv > 0 and   # The new integer i is too big` ?\n> \n> Honestly I do not care, this will be rewritten soon anyway. But why would you do something like that ?\n> \n> You even do `for j in range(k-1,-1,-1)` which is totally equivalent to `for j in range(k)` given that you do not use j. Only to make it more complicated ?...\n\nHum. `j` **is** useful as it is the remaining number of steps and allow to cut branches when the maximum number of steps allowed (i.e. `k_max`) is relatively small.\n\n```\n+ if (vv > 0 and            # The new integer i is too big\n+     vv <= j*max_value and # The new integer i is too small\n+     vv not in D and       # We had it in D already\n+     vv not in new_D):     # We had it in new_D already\n```\n\nVincent",
    "created_at": "2014-10-27T11:11:44Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225528",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>
Replying to [ncohen](#comment%3A12):
> What is the point of making it decrease toward zero ? `O_o`
> 
> To have more meaningful comments like
> `if (vv > 0 and   # The new integer i is too big` ?
> 
> Honestly I do not care, this will be rewritten soon anyway. But why would you do something like that ?
> 
> You even do `for j in range(k-1,-1,-1)` which is totally equivalent to `for j in range(k)` given that you do not use j. Only to make it more complicated ?...

Hum. `j` **is** useful as it is the remaining number of steps and allow to cut branches when the maximum number of steps allowed (i.e. `k_max`) is relatively small.

```
+ if (vv > 0 and            # The new integer i is too big
+     vv <= j*max_value and # The new integer i is too small
+     vv not in D and       # We had it in D already
+     vv not in new_D):     # We had it in new_D already
```

Vincent



---

archive/issue_comments_225529.json:
```json
{
    "body": "<a id='comment:14'></a>\nThis code is awful.\n\nAnyway, I will rewrite it soon.\n\nNathann",
    "created_at": "2014-10-27T12:29:38Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225529",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>
This code is awful.

Anyway, I will rewrite it soon.

Nathann



---

archive/issue_events_151865.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-10-27T13:09:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151865"
}
```



---

archive/issue_events_151866.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-10-27T13:09:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151866"
}
```



---

archive/issue_comments_225530.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2014-10-27T13:09:29Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225530",
    "user": "https://github.com/nathanncohen"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_events_151867.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-29T10:39:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151867"
}
```



---

archive/issue_events_151868.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a46bc2565fa618f143d962a4fb66ff51b839b133",
    "created_at": "2014-10-29T10:39:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16922#event-151868"
}
```



---

archive/issue_comments_225531.json:
```json
{
    "body": "**Changing branch** from \"[public/16922](https://github.com/sagemath/sagetrac-mirror/tree/public/16922)\" to \"[955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e](https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e)\".",
    "created_at": "2014-10-29T10:39:53Z",
    "issue": "https://github.com/sagemath/sage/issues/16922",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16922#issuecomment-225531",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[public/16922](https://github.com/sagemath/sagetrac-mirror/tree/public/16922)" to "[955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e](https://github.com/sagemath/sagetrac-mirror/commit/955b67f0cf7f5f0e584a8f7fb0d3520c675fc37e)".
