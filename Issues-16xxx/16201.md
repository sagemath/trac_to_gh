# Issue 16201: default precision for all series (symbolic, power, Laurent)

archive/issues_015964.json:
```json
{
    "body": "Both Laurent and power series ring elements have a default precision of 20. OTOH, symbolic series expansions need the precision set:\n\n```\nsage: R.<t> = LaurentSeriesRing(QQ)\nsage: 1/(1-t)\n1 + t + t^2 + t^3 + t^4 + t^5 + t^6 + t^7 + t^8 + t^9 + t^10 + t^11 + t^12 + t^13 + t^14 + t^15 + t^16 + t^17 + t^18 + t^19 + O(t^20)\nsage: var('x')\nx\nsage: ex=1/(1-x)\nsage: ex.series(x)\n...\nTypeError: series() takes exactly 2 positional arguments (1 given)\n```\nThis ticket proposes to unify the behaviour by allowing the following:\n\n```\nsage: ex.series(x)\n1 + 1*x + 1*x^2 + 1*x^3 + 1*x^4 + 1*x^5 + 1*x^6 + 1*x^7 + 1*x^8 + 1*x^9 + 1*x^10 + 1*x^11 + 1*x^12 + 1*x^13 + 1*x^14 + 1*x^15 + 1*x^16 + 1*x^17 + 1*x^18 + 1*x^19 + Order(x^20)\n```\nAs this is about reducing surprise for the user both algebra and symbolic series default precision should have the same value, so the ticket should also implement such a global value.\n\nThis ticket also deprecates the use of `LaurentSeriesRing_generic.set_default_prec` as it contradicts the immutability of parents and conflicts with the caching of LaurentSeriesRings.\n\n**Keywords:** series precision\n\n**Branch/Commit:** [0d7da1b7f690134eb9109e7062d06df59a5e3ab3](https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3)\n\n**Reviewer:** Clemens Heuberger\n\n**Author:** Ralf Stephan\n\nIssue created by migration from https://trac.sagemath.org/ticket/16201\n\n",
    "closed_at": "2015-01-15T08:41:50Z",
    "created_at": "2014-04-22T06:32:09Z",
    "labels": [
        "component: algebra",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "title": "default precision for all series (symbolic, power, Laurent)",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/16201",
    "user": "https://github.com/rwst"
}
```
Both Laurent and power series ring elements have a default precision of 20. OTOH, symbolic series expansions need the precision set:

```
sage: R.<t> = LaurentSeriesRing(QQ)
sage: 1/(1-t)
1 + t + t^2 + t^3 + t^4 + t^5 + t^6 + t^7 + t^8 + t^9 + t^10 + t^11 + t^12 + t^13 + t^14 + t^15 + t^16 + t^17 + t^18 + t^19 + O(t^20)
sage: var('x')
x
sage: ex=1/(1-x)
sage: ex.series(x)
...
TypeError: series() takes exactly 2 positional arguments (1 given)
```
This ticket proposes to unify the behaviour by allowing the following:

```
sage: ex.series(x)
1 + 1*x + 1*x^2 + 1*x^3 + 1*x^4 + 1*x^5 + 1*x^6 + 1*x^7 + 1*x^8 + 1*x^9 + 1*x^10 + 1*x^11 + 1*x^12 + 1*x^13 + 1*x^14 + 1*x^15 + 1*x^16 + 1*x^17 + 1*x^18 + 1*x^19 + Order(x^20)
```
As this is about reducing surprise for the user both algebra and symbolic series default precision should have the same value, so the ticket should also implement such a global value.

This ticket also deprecates the use of `LaurentSeriesRing_generic.set_default_prec` as it contradicts the immutability of parents and conflicts with the caching of LaurentSeriesRings.

**Keywords:** series precision

**Branch/Commit:** [0d7da1b7f690134eb9109e7062d06df59a5e3ab3](https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3)

**Reviewer:** Clemens Heuberger

**Author:** Ralf Stephan

Issue created by migration from https://trac.sagemath.org/ticket/16201





---

archive/issue_events_144344.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144344"
}
```



---

archive/issue_events_144345.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144345"
}
```



---

archive/issue_events_144346.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144346"
}
```



---

archive/issue_events_144347.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144347"
}
```



---

archive/issue_comments_209396.json:
```json
{
    "body": "**Branch:** [u/rws/default_precision_for_symbolic_power_series_from_sr_series__](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/default_precision_for_symbolic_power_series_from_sr_series__)",
    "created_at": "2015-01-01T16:08:35Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209396",
    "user": "https://github.com/rwst"
}
```

**Branch:** [u/rws/default_precision_for_symbolic_power_series_from_sr_series__](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/default_precision_for_symbolic_power_series_from_sr_series__)



---

archive/issue_comments_209397.json:
```json
{
    "body": "<a id='comment:4'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5fc4999530c6462e560b07dcb2c99463ae6a4a55\">5fc4999</a></td><td><code>16201: implement global default series precision, accessors</code></td></tr></table>\n",
    "created_at": "2015-01-01T16:10:30Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209397",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5fc4999530c6462e560b07dcb2c99463ae6a4a55">5fc4999</a></td><td><code>16201: implement global default series precision, accessors</code></td></tr></table>




---

archive/issue_comments_209398.json:
```json
{
    "body": "**Commit:** [5fc4999530c6462e560b07dcb2c99463ae6a4a55](https://github.com/sagemath/sagetrac-mirror/commit/5fc4999530c6462e560b07dcb2c99463ae6a4a55)",
    "created_at": "2015-01-01T16:10:30Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209398",
    "user": "https://github.com/rwst"
}
```

**Commit:** [5fc4999530c6462e560b07dcb2c99463ae6a4a55](https://github.com/sagemath/sagetrac-mirror/commit/5fc4999530c6462e560b07dcb2c99463ae6a4a55)



---

archive/issue_events_144348.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-01T16:10:30Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "rename": {
        "from": "default precision for symbolic power series from SR.series()",
        "to": "default precision for all series (symbolic, power, Laurent)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144348"
}
```



---

archive/issue_comments_209399.json:
```json
{
    "body": "**Author:** Ralf Stephan",
    "created_at": "2015-01-01T16:10:30Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209399",
    "user": "https://github.com/rwst"
}
```

**Author:** Ralf Stephan



---

archive/issue_events_144349.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-01T16:10:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144349"
}
```



---

archive/issue_comments_209400.json:
```json
{
    "body": "<a id='comment:5'></a>\nI do not think that `order=-1` is a good default value, as it changes previous behaviour:\n\nPrior to this patch:\n\n```\nsage: f = sin(x)^(-2)\n....: f.series(x, -1)\n1*x^(-2) + Order(1/x)\n```\n\nAfter this patch:\n\n```\nsage: f = sin(x)^(-2)\n....: f.series(x, -1)\n1*x^(-2) + 1/3 + 1/15*x^2 + 2/189*x^4 + 1/675*x^6 + 2/10395*x^8 + 1382/58046625*x^10 + 4/1403325*x^12 + 3617/10854718875*x^14 + 87734/2292899734125*x^16 + 349222/80596287646875*x^18 + Order(x^20)\n```\n\nFurthermore, I'd like to see doctests testing the new behaviour.\n\nFinally, `sage.misc.defaults` could be added to the reference manual such that the documentation of all *three* modified methods (symbolic, power, Laurent) could link to that place for setting the default precision.",
    "created_at": "2015-01-04T07:42:05Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209400",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:5'></a>
I do not think that `order=-1` is a good default value, as it changes previous behaviour:

Prior to this patch:

```
sage: f = sin(x)^(-2)
....: f.series(x, -1)
1*x^(-2) + Order(1/x)
```

After this patch:

```
sage: f = sin(x)^(-2)
....: f.series(x, -1)
1*x^(-2) + 1/3 + 1/15*x^2 + 2/189*x^4 + 1/675*x^6 + 2/10395*x^8 + 1382/58046625*x^10 + 4/1403325*x^12 + 3617/10854718875*x^14 + 87734/2292899734125*x^16 + 349222/80596287646875*x^18 + Order(x^20)
```

Furthermore, I'd like to see doctests testing the new behaviour.

Finally, `sage.misc.defaults` could be added to the reference manual such that the documentation of all *three* modified methods (symbolic, power, Laurent) could link to that place for setting the default precision.



---

archive/issue_comments_209401.json:
```json
{
    "body": "<a id='comment:6'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3cb45774f2f91f75ea070ffac22a826c7cff396\">b3cb457</a></td><td><code>16201: change keyword default; add doctests; add misc.defaults to doctree and point to it</code></td></tr></table>\n",
    "created_at": "2015-01-04T17:13:36Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209401",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3cb45774f2f91f75ea070ffac22a826c7cff396">b3cb457</a></td><td><code>16201: change keyword default; add doctests; add misc.defaults to doctree and point to it</code></td></tr></table>




---

archive/issue_comments_209402.json:
```json
{
    "body": "**Changing commit** from \"[5fc4999530c6462e560b07dcb2c99463ae6a4a55](https://github.com/sagemath/sagetrac-mirror/commit/5fc4999530c6462e560b07dcb2c99463ae6a4a55)\" to \"[b3cb45774f2f91f75ea070ffac22a826c7cff396](https://github.com/sagemath/sagetrac-mirror/commit/b3cb45774f2f91f75ea070ffac22a826c7cff396)\".",
    "created_at": "2015-01-04T17:13:36Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209402",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[5fc4999530c6462e560b07dcb2c99463ae6a4a55](https://github.com/sagemath/sagetrac-mirror/commit/5fc4999530c6462e560b07dcb2c99463ae6a4a55)" to "[b3cb45774f2f91f75ea070ffac22a826c7cff396](https://github.com/sagemath/sagetrac-mirror/commit/b3cb45774f2f91f75ea070ffac22a826c7cff396)".



---

archive/issue_comments_209403.json:
```json
{
    "body": "<a id='comment:7'></a>\nDone. Unfortunately this is Cython so I had to pick a value that signals default, changed to -65535 now.\n\nPlease add your realname to Reviewers.",
    "created_at": "2015-01-04T17:15:40Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209403",
    "user": "https://github.com/rwst"
}
```

<a id='comment:7'></a>
Done. Unfortunately this is Cython so I had to pick a value that signals default, changed to -65535 now.

Please add your realname to Reviewers.



---

archive/issue_comments_209404.json:
```json
{
    "body": "**Reviewer:** Clemens Heuberger",
    "created_at": "2015-01-06T07:03:52Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209404",
    "user": "https://github.com/cheuberg"
}
```

**Reviewer:** Clemens Heuberger



---

archive/issue_events_144350.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-06T07:03:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144350"
}
```



---

archive/issue_events_144351.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-06T07:03:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144351"
}
```



---

archive/issue_comments_209405.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [rws](#comment%3A7):\n> Done. Unfortunately this is Cython so I had to pick a value that signals default, changed to -65535 now.\n\nI think that replacing `int order=-65535` by `order=None` would lead to clearer code at a negligible performance penalty.\n\nFurther comments:\n* The docstrings of `series_precision` and `set_series_precision` should have `EXAMPLE` sections.\n* The parameter `default_prec` of the Laurent series classes should be explained; the only explanation now is in `def default_prec(self)` which should be rephrased anyway (\"Set ...\" is not correct).\n* I'd like to see doctests showing examples on how to construct series with different values for `set_series_precision`\n* <code>:meth:\\`set_series_precision\\`</code> is a dead link.",
    "created_at": "2015-01-06T07:03:52Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209405",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:8'></a>
Replying to [rws](#comment%3A7):
> Done. Unfortunately this is Cython so I had to pick a value that signals default, changed to -65535 now.

I think that replacing `int order=-65535` by `order=None` would lead to clearer code at a negligible performance penalty.

Further comments:
* The docstrings of `series_precision` and `set_series_precision` should have `EXAMPLE` sections.
* The parameter `default_prec` of the Laurent series classes should be explained; the only explanation now is in `def default_prec(self)` which should be rephrased anyway ("Set ..." is not correct).
* I'd like to see doctests showing examples on how to construct series with different values for `set_series_precision`
* <code>:meth:\`set_series_precision\`</code> is a dead link.



---

archive/issue_comments_209406.json:
```json
{
    "body": "<a id='comment:9'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b682e2a637b58323979f8fca2f97e470a4c2436\">3b682e2</a></td><td><code>16201: misc.defauts doctests; deprecate LaurentSeriesRing.set_default_prec; cosmetics</code></td></tr></table>\n",
    "created_at": "2015-01-06T16:48:36Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209406",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b682e2a637b58323979f8fca2f97e470a4c2436">3b682e2</a></td><td><code>16201: misc.defauts doctests; deprecate LaurentSeriesRing.set_default_prec; cosmetics</code></td></tr></table>




---

archive/issue_comments_209407.json:
```json
{
    "body": "**Changing commit** from \"[b3cb45774f2f91f75ea070ffac22a826c7cff396](https://github.com/sagemath/sagetrac-mirror/commit/b3cb45774f2f91f75ea070ffac22a826c7cff396)\" to \"[3b682e2a637b58323979f8fca2f97e470a4c2436](https://github.com/sagemath/sagetrac-mirror/commit/3b682e2a637b58323979f8fca2f97e470a4c2436)\".",
    "created_at": "2015-01-06T16:48:36Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209407",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[b3cb45774f2f91f75ea070ffac22a826c7cff396](https://github.com/sagemath/sagetrac-mirror/commit/b3cb45774f2f91f75ea070ffac22a826c7cff396)" to "[3b682e2a637b58323979f8fca2f97e470a4c2436](https://github.com/sagemath/sagetrac-mirror/commit/3b682e2a637b58323979f8fca2f97e470a4c2436)".



---

archive/issue_comments_209408.json:
```json
{
    "body": "<a id='comment:10'></a>\nThe default for order is now `None`. The `misc` functions now have examples. The description of `def default_prec(self)` was corrected. I think the `LaurentSeriesRing` method `set_default_prec` should be deprecated as is already hinted. Done.\n\nThe general improvement of Laurent series documentation is ticket #12259.\n\nI don't think doctests showing examples on how to construct series with different values for `set_series_precision` should be added. I don't want to encourage frequent usage of the global setting to set single series precisions.\n\nIf the link is dead you should do `make doc-clean; make doc`. It will not suffice to `sage -docbuild` since a file was added.",
    "created_at": "2015-01-06T16:49:53Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209408",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>
The default for order is now `None`. The `misc` functions now have examples. The description of `def default_prec(self)` was corrected. I think the `LaurentSeriesRing` method `set_default_prec` should be deprecated as is already hinted. Done.

The general improvement of Laurent series documentation is ticket #12259.

I don't think doctests showing examples on how to construct series with different values for `set_series_precision` should be added. I don't want to encourage frequent usage of the global setting to set single series precisions.

If the link is dead you should do `make doc-clean; make doc`. It will not suffice to `sage -docbuild` since a file was added.



---

archive/issue_events_144352.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-06T16:49:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144352"
}
```



---

archive/issue_events_144353.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-06T16:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144353"
}
```



---

archive/issue_events_144354.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-06T17:41:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144354"
}
```



---

archive/issue_events_144355.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-06T17:41:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144355"
}
```



---

archive/issue_comments_209409.json:
```json
{
    "body": "<a id='comment:11'></a>\nFor now, just three comments, I'll have a closer look later.\n\n```\nFile \"src/sage/symbolic/expression.pyx\", line 3542, in sage.symbolic.expression.Expression.series\nFailed example:\n    f.series(x)\nException raised:\n    Traceback (most recent call last):\n      File \"/local/sage/sage-6.5.beta4/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 488, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/local/sage/sage-6.5.beta4/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 850, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.symbolic.expression.Expression.series[9]>\", line 1, in <module>\n        f.series(x)\n      File \"sage/symbolic/expression.pyx\", line 3584, in sage.symbolic.expression.Expression.series (build/cythonized/sage/symbolic/expression.cpp:20710)\n        x = self._gobj.series(symbol0._gobj, order, 0)\n    TypeError: an integer is required\n```\nThe reason is that `prec` is set but never used.\n\nReplying to [rws](#comment%3A10):\n> I don't think doctests showing examples on how to construct series with different values for `set_series_precision` should be added. I don't want to encourage frequent usage of the global setting to set single series precisions.\n\nI concur that we should not encourage the actual frequent usage of the global settings.\nHowever, I'd prefer it to be at least be covered by a test in a \"TESTS\" section, just to be sure to avoid small errors as the issue outlined above.\n\n> \n> If the link is dead you should do `make doc-clean; make doc`. It will not suffice to `sage -docbuild` since a file was added.\n\nI think that the problem is rather the `meth` instead of `func`.",
    "created_at": "2015-01-06T17:41:04Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209409",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:11'></a>
For now, just three comments, I'll have a closer look later.

```
File "src/sage/symbolic/expression.pyx", line 3542, in sage.symbolic.expression.Expression.series
Failed example:
    f.series(x)
Exception raised:
    Traceback (most recent call last):
      File "/local/sage/sage-6.5.beta4/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 488, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/local/sage/sage-6.5.beta4/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 850, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.symbolic.expression.Expression.series[9]>", line 1, in <module>
        f.series(x)
      File "sage/symbolic/expression.pyx", line 3584, in sage.symbolic.expression.Expression.series (build/cythonized/sage/symbolic/expression.cpp:20710)
        x = self._gobj.series(symbol0._gobj, order, 0)
    TypeError: an integer is required
```
The reason is that `prec` is set but never used.

Replying to [rws](#comment%3A10):
> I don't think doctests showing examples on how to construct series with different values for `set_series_precision` should be added. I don't want to encourage frequent usage of the global setting to set single series precisions.

I concur that we should not encourage the actual frequent usage of the global settings.
However, I'd prefer it to be at least be covered by a test in a "TESTS" section, just to be sure to avoid small errors as the issue outlined above.

> 
> If the link is dead you should do `make doc-clean; make doc`. It will not suffice to `sage -docbuild` since a file was added.

I think that the problem is rather the `meth` instead of `func`.



---

archive/issue_comments_209410.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe deprecation of `set_series_precision` leads to four failing doctests elsewhere:\n\n```\nsage -t src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py\", line 74, in sage.schemes.hyperelliptic_curves.hyperelliptic_padic_field.HyperellipticCurve_padic_field.local_analytic_interpolation\nFailed example:\n    x,y,z = HK.local_analytic_interpolation(P,Q)\nExpected nothing\nGot:\n    doctest:512: DeprecationWarning: This method is deprecated.\n    See http://trac.sagemath.org/16201 for details.\n**********************************************************************\nsage -t src/sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py\", line 490, in sage.schemes.hyperelliptic_curves.hyperelliptic_generic.HyperellipticCurve_generic.local_coordinates_at_infinity\nFailed example:\n    x,y = H.local_coordinates_at_infinity(10)\nExpected nothing\nGot:\n    doctest:512: DeprecationWarning: This method is deprecated.\n    See http://trac.sagemath.org/16201 for details.\n**********************************************************************\nsage -t src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\n**********************************************************************\nFile \"src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py\", line 3580, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coleman_integral\nFailed example:\n    w.coleman_integral(P,2*P)\nExpected:\n    O(5^6)\nGot:\n    doctest:512: DeprecationWarning: This method is deprecated.\n    See http://trac.sagemath.org/16201 for details.\n    O(5^6)\n**********************************************************************\nsage -t src/sage/rings/morphism.pyx\n**********************************************************************\nFile \"src/sage/rings/morphism.pyx\", line 249, in sage.rings.morphism\nFailed example:\n    R.set_default_prec(10)\nExpected nothing\nGot:\n    doctest:1: DeprecationWarning: This method is deprecated.\n    See http://trac.sagemath.org/16201 for details.\n**********************************************************************\n```",
    "created_at": "2015-01-06T18:21:35Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209410",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:12'></a>
The deprecation of `set_series_precision` leads to four failing doctests elsewhere:

```
sage -t src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/hyperelliptic_padic_field.py", line 74, in sage.schemes.hyperelliptic_curves.hyperelliptic_padic_field.HyperellipticCurve_padic_field.local_analytic_interpolation
Failed example:
    x,y,z = HK.local_analytic_interpolation(P,Q)
Expected nothing
Got:
    doctest:512: DeprecationWarning: This method is deprecated.
    See http://trac.sagemath.org/16201 for details.
**********************************************************************
sage -t src/sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/hyperelliptic_generic.py", line 490, in sage.schemes.hyperelliptic_curves.hyperelliptic_generic.HyperellipticCurve_generic.local_coordinates_at_infinity
Failed example:
    x,y = H.local_coordinates_at_infinity(10)
Expected nothing
Got:
    doctest:512: DeprecationWarning: This method is deprecated.
    See http://trac.sagemath.org/16201 for details.
**********************************************************************
sage -t src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py
**********************************************************************
File "src/sage/schemes/hyperelliptic_curves/monsky_washnitzer.py", line 3580, in sage.schemes.hyperelliptic_curves.monsky_washnitzer.MonskyWashnitzerDifferential.coleman_integral
Failed example:
    w.coleman_integral(P,2*P)
Expected:
    O(5^6)
Got:
    doctest:512: DeprecationWarning: This method is deprecated.
    See http://trac.sagemath.org/16201 for details.
    O(5^6)
**********************************************************************
sage -t src/sage/rings/morphism.pyx
**********************************************************************
File "src/sage/rings/morphism.pyx", line 249, in sage.rings.morphism
Failed example:
    R.set_default_prec(10)
Expected nothing
Got:
    doctest:1: DeprecationWarning: This method is deprecated.
    See http://trac.sagemath.org/16201 for details.
**********************************************************************
```



---

archive/issue_comments_209411.json:
```json
{
    "body": "**Changing commit** from \"[3b682e2a637b58323979f8fca2f97e470a4c2436](https://github.com/sagemath/sagetrac-mirror/commit/3b682e2a637b58323979f8fca2f97e470a4c2436)\" to \"[0fcce825397b78e58a13b0fa5eaa930e7bd17960](https://github.com/sagemath/sagetrac-mirror/commit/0fcce825397b78e58a13b0fa5eaa930e7bd17960)\".",
    "created_at": "2015-01-07T09:48:11Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209411",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[3b682e2a637b58323979f8fca2f97e470a4c2436](https://github.com/sagemath/sagetrac-mirror/commit/3b682e2a637b58323979f8fca2f97e470a4c2436)" to "[0fcce825397b78e58a13b0fa5eaa930e7bd17960](https://github.com/sagemath/sagetrac-mirror/commit/0fcce825397b78e58a13b0fa5eaa930e7bd17960)".



---

archive/issue_comments_209412.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0fcce825397b78e58a13b0fa5eaa930e7bd17960\">0fcce82</a></td><td><code>16201: more doctests, fixes; remove deprecated usage</code></td></tr></table>\n",
    "created_at": "2015-01-07T09:48:11Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0fcce825397b78e58a13b0fa5eaa930e7bd17960">0fcce82</a></td><td><code>16201: more doctests, fixes; remove deprecated usage</code></td></tr></table>




---

archive/issue_events_144356.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-07T09:48:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144356"
}
```



---

archive/issue_events_144357.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-07T09:48:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144357"
}
```



---

archive/issue_comments_209413.json:
```json
{
    "body": "<a id='comment:14'></a>\nAll done.",
    "created_at": "2015-01-07T09:48:55Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209413",
    "user": "https://github.com/rwst"
}
```

<a id='comment:14'></a>
All done.



---

archive/issue_comments_209414.json:
```json
{
    "body": "<a id='comment:15'></a>\nAll Doctests (`make ptestlong`) pass; code looks ok; thanks.\n\nThe changes in `hyperelliptic_generic.py` demonstrate that there is a default precision of `20`, too, which is not covered by this ticket. For the ReSt formatting errors in that file, see #17599.",
    "created_at": "2015-01-08T13:58:21Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209414",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:15'></a>
All Doctests (`make ptestlong`) pass; code looks ok; thanks.

The changes in `hyperelliptic_generic.py` demonstrate that there is a default precision of `20`, too, which is not covered by this ticket. For the ReSt formatting errors in that file, see #17599.



---

archive/issue_events_144358.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-08T13:58:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144358"
}
```



---

archive/issue_events_144359.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-08T13:58:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144359"
}
```



---

archive/issue_comments_209415.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -18,3 +18,5 @@\n 1 + 1*x + 1*x^2 + 1*x^3 + 1*x^4 + 1*x^5 + 1*x^6 + 1*x^7 + 1*x^8 + 1*x^9 + 1*x^10 + 1*x^11 + 1*x^12 + 1*x^13 + 1*x^14 + 1*x^15 + 1*x^16 + 1*x^17 + 1*x^18 + 1*x^19 + Order(x^20)\n ```\n As this is about reducing surprise for the user both algebra and symbolic series default precision should have the same value, so the ticket should also implement such a global value.\n+\n+This ticket also deprecates the use of `LaurentSeriesRing_generic.set_default_prec` as it contradicts the immutability of parents and conflicts with the caching of LaurentSeriesRings.\n``````\n",
    "created_at": "2015-01-08T13:58:21Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209415",
    "user": "https://github.com/cheuberg"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -18,3 +18,5 @@
 1 + 1*x + 1*x^2 + 1*x^3 + 1*x^4 + 1*x^5 + 1*x^6 + 1*x^7 + 1*x^8 + 1*x^9 + 1*x^10 + 1*x^11 + 1*x^12 + 1*x^13 + 1*x^14 + 1*x^15 + 1*x^16 + 1*x^17 + 1*x^18 + 1*x^19 + Order(x^20)
 ```
 As this is about reducing surprise for the user both algebra and symbolic series default precision should have the same value, so the ticket should also implement such a global value.
+
+This ticket also deprecates the use of `LaurentSeriesRing_generic.set_default_prec` as it contradicts the immutability of parents and conflicts with the caching of LaurentSeriesRings.
``````




---

archive/issue_comments_209416.json:
```json
{
    "body": "<a id='comment:16'></a>\nThanks for the review.",
    "created_at": "2015-01-08T15:14:51Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209416",
    "user": "https://github.com/rwst"
}
```

<a id='comment:16'></a>
Thanks for the review.



---

archive/issue_comments_209417.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [cheuberg](#comment%3A15):\n> The changes in `hyperelliptic_generic.py` demonstrate that there is a default precision of `20`, too, which is not covered by this ticket.\n\nThat is now #17613.",
    "created_at": "2015-01-10T16:54:44Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209417",
    "user": "https://github.com/rwst"
}
```

<a id='comment:17'></a>
Replying to [cheuberg](#comment%3A15):
> The changes in `hyperelliptic_generic.py` demonstrate that there is a default precision of `20`, too, which is not covered by this ticket.

That is now #17613.



---

archive/issue_comments_209418.json:
```json
{
    "body": "<a id='comment:18'></a>\nThis is wrongly indented:\n\n```\nTESTS:\n\n    Check if changing global series precision does it right::\n```\nIt should be\n\n```\nTESTS:\n\nCheck if changing global series precision does it right::\n```",
    "created_at": "2015-01-11T22:04:22Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209418",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>
This is wrongly indented:

```
TESTS:

    Check if changing global series precision does it right::
```
It should be

```
TESTS:

Check if changing global series precision does it right::
```



---

archive/issue_events_144360.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-11T22:04:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144360"
}
```



---

archive/issue_events_144361.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-11T22:04:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144361"
}
```



---

archive/issue_comments_209419.json:
```json
{
    "body": "<a id='comment:19'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3\">0d7da1b</a></td><td><code>16201: fix indentation</code></td></tr></table>\n",
    "created_at": "2015-01-12T07:12:54Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209419",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3">0d7da1b</a></td><td><code>16201: fix indentation</code></td></tr></table>




---

archive/issue_comments_209420.json:
```json
{
    "body": "**Changing commit** from \"[0fcce825397b78e58a13b0fa5eaa930e7bd17960](https://github.com/sagemath/sagetrac-mirror/commit/0fcce825397b78e58a13b0fa5eaa930e7bd17960)\" to \"[0d7da1b7f690134eb9109e7062d06df59a5e3ab3](https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3)\".",
    "created_at": "2015-01-12T07:12:54Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209420",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[0fcce825397b78e58a13b0fa5eaa930e7bd17960](https://github.com/sagemath/sagetrac-mirror/commit/0fcce825397b78e58a13b0fa5eaa930e7bd17960)" to "[0d7da1b7f690134eb9109e7062d06df59a5e3ab3](https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3)".



---

archive/issue_events_144362.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-12T07:14:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144362"
}
```



---

archive/issue_events_144363.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-01-12T07:14:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144363"
}
```



---

archive/issue_comments_209421.json:
```json
{
    "body": "<a id='comment:21'></a>\nJeroen, can you please have a quick look again, so that we can finish it?",
    "created_at": "2015-01-13T16:07:25Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209421",
    "user": "https://github.com/rwst"
}
```

<a id='comment:21'></a>
Jeroen, can you please have a quick look again, so that we can finish it?



---

archive/issue_events_144364.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-13T18:55:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144364"
}
```



---

archive/issue_events_144365.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-01-13T18:55:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144365"
}
```



---

archive/issue_comments_209422.json:
```json
{
    "body": "<a id='comment:22'></a>\nThe wrong indentation has been fixed.",
    "created_at": "2015-01-13T18:55:59Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209422",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:22'></a>
The wrong indentation has been fixed.



---

archive/issue_events_144366.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-01-15T08:41:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144366"
}
```



---

archive/issue_events_144367.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "14a5bbf514ac302a22f83989462a4cd89ff3b6c7",
    "created_at": "2015-01-15T08:41:50Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16201#event-144367"
}
```



---

archive/issue_comments_209423.json:
```json
{
    "body": "**Changing branch** from \"[u/rws/default_precision_for_symbolic_power_series_from_sr_series__](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/default_precision_for_symbolic_power_series_from_sr_series__)\" to \"[0d7da1b7f690134eb9109e7062d06df59a5e3ab3](https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3)\".",
    "created_at": "2015-01-15T08:41:50Z",
    "issue": "https://github.com/sagemath/sage/issues/16201",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16201#issuecomment-209423",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/rws/default_precision_for_symbolic_power_series_from_sr_series__](https://github.com/sagemath/sagetrac-mirror/tree/u/rws/default_precision_for_symbolic_power_series_from_sr_series__)" to "[0d7da1b7f690134eb9109e7062d06df59a5e3ab3](https://github.com/sagemath/sagetrac-mirror/commit/0d7da1b7f690134eb9109e7062d06df59a5e3ab3)".
