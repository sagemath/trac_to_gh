# Issue 16633: indefinite factorization changes an immutable matrix

archive/issues_016396.json:
```json
{
    "body": "In 6.3.beta5 we have\n\n```\nsage: A = matrix(QQ, [[ 4, -2,  4,  2],\n....:                 [-2, 10, -2, -7],\n....:                 [ 4, -2,  8,  4],\n....:                 [ 2, -7,  4,  7]])\nsage: A.indefinite_factorization()\n(\n[   1    0    0    0]              \n[-1/2    1    0    0]              \n[   1    0    1    0]              \n[ 1/2 -2/3  1/2    1], (4, 9, 4, 1)\n)\nsage: A\n[ 4 -2  4  2]\n[-2 10 -2 -7]\n[ 4 -2  8  4]\n[ 2 -7  4  7]\n\nsage: B = matrix(QQ, [[ 4, -2,  4,  2],\n....:                 [-2, 10, -2, -7],\n....:                 [ 4, -2,  8,  4],\n....:                 [ 2, -7,  4,  7]])\nsage: B.set_immutable()\nsage: B.indefinite_factorization()\n(\n[   1    0    0    0]              \n[-1/2    1    0    0]              \n[   1    0    1    0]              \n[ 1/2 -2/3  1/2    1], (4, 9, 4, 1)\n)\nsage: B\n[   1    0    0    0]\n[-1/2    1    0    0]\n[   1    0    1    0]\n[ 1/2 -2/3  1/2    1]\n```\n\nActually the problem stems from the output of `change_ring()`:\n\n```\nsage: A.change_ring(QQ) is A\nFalse\nsage: B.change_ring(QQ) is B\nTrue\n```\n\nAssignee: @tscrim\n\nKeywords: matrix mutation\n\nBranch/Commit: 484ae916381c9dca15192c8d9209646543c73980\n\nReviewer: Jan Keitel\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16633\n\n",
    "closed_at": "2014-07-11T04:19:37Z",
    "created_at": "2014-07-09T05:36:46Z",
    "labels": [
        "component: linear algebra",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "indefinite factorization changes an immutable matrix",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16633",
    "user": "https://github.com/tscrim"
}
```
In 6.3.beta5 we have

```
sage: A = matrix(QQ, [[ 4, -2,  4,  2],
....:                 [-2, 10, -2, -7],
....:                 [ 4, -2,  8,  4],
....:                 [ 2, -7,  4,  7]])
sage: A.indefinite_factorization()
(
[   1    0    0    0]              
[-1/2    1    0    0]              
[   1    0    1    0]              
[ 1/2 -2/3  1/2    1], (4, 9, 4, 1)
)
sage: A
[ 4 -2  4  2]
[-2 10 -2 -7]
[ 4 -2  8  4]
[ 2 -7  4  7]

sage: B = matrix(QQ, [[ 4, -2,  4,  2],
....:                 [-2, 10, -2, -7],
....:                 [ 4, -2,  8,  4],
....:                 [ 2, -7,  4,  7]])
sage: B.set_immutable()
sage: B.indefinite_factorization()
(
[   1    0    0    0]              
[-1/2    1    0    0]              
[   1    0    1    0]              
[ 1/2 -2/3  1/2    1], (4, 9, 4, 1)
)
sage: B
[   1    0    0    0]
[-1/2    1    0    0]
[   1    0    1    0]
[ 1/2 -2/3  1/2    1]
```

Actually the problem stems from the output of `change_ring()`:

```
sage: A.change_ring(QQ) is A
False
sage: B.change_ring(QQ) is B
True
```

Assignee: @tscrim

Keywords: matrix mutation

Branch/Commit: 484ae916381c9dca15192c8d9209646543c73980

Reviewer: Jan Keitel

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16633





---

archive/issue_comments_280437.json:
```json
{
    "body": "Changing branch from \"\" to \"public/matrix/indefinite_factorization_immutable-16633\"",
    "created_at": "2014-07-09T05:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280437",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/matrix/indefinite_factorization_immutable-16633"



---

archive/issue_comments_280438.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|\n|[484ae91](https://github.com/sagemath/sagetrac-mirror/commit/484ae916381c9dca15192c8d9209646543c73980)|`Fixed _indefinite_factorization() for immutable matrix over fields.`|",
    "created_at": "2014-07-09T05:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280438",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------|
|[484ae91](https://github.com/sagemath/sagetrac-mirror/commit/484ae916381c9dca15192c8d9209646543c73980)|`Fixed _indefinite_factorization() for immutable matrix over fields.`|



---

archive/issue_comments_280439.json:
```json
{
    "body": "Changing commit from \"\" to \"484ae916381c9dca15192c8d9209646543c73980\"",
    "created_at": "2014-07-09T05:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280439",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "484ae916381c9dca15192c8d9209646543c73980"



---

archive/issue_comments_280440.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-09T05:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280440",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_280441.json:
```json
{
    "body": "Changing author from \"\" to \"Travis Scrimshaw\"",
    "created_at": "2014-07-09T05:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280441",
    "user": "https://github.com/tscrim"
}
```

Changing author from "" to "Travis Scrimshaw"



---

archive/issue_comments_280442.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jan Keitel\"",
    "created_at": "2014-07-10T08:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280442",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

Changing reviewer from "" to "Jan Keitel"



---

archive/issue_comments_280443.json:
```json
{
    "body": "<a id='comment:2'></a>\nHi Travis, the patch looks good to me, so I'm putting it to positive review.",
    "created_at": "2014-07-10T08:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280443",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

<a id='comment:2'></a>
Hi Travis, the patch looks good to me, so I'm putting it to positive review.



---

archive/issue_comments_280444.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-10T08:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280444",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_055492.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-07-11T04:19:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16633#event-55492"
}
```



---

archive/issue_comments_280445.json:
```json
{
    "body": "Changing branch from \"public/matrix/indefinite_factorization_immutable-16633\" to \"484ae916381c9dca15192c8d9209646543c73980\"",
    "created_at": "2014-07-11T04:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280445",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/matrix/indefinite_factorization_immutable-16633" to "484ae916381c9dca15192c8d9209646543c73980"



---

archive/issue_comments_280446.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-11T04:19:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16633",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16633#issuecomment-280446",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
