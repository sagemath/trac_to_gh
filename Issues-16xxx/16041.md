# Issue 16041: Get git to build on OS X 10.4 PPC

archive/issues_015804.json:
```json
{
    "body": "CC:  @vbraun\n\nAs in the summary.\n\n```\n    CC http-backend.o\n    LINK git-http-backend\n/usr/bin/ld: warning multiple definitions of symbol _regcomp\nlibgit.a(regex.o) definition of _regcomp in section (__TEXT,__text)\n/usr/lib/libSystem.dylib(regcomp.So) definition of _regcomp\n/usr/bin/ld: warning multiple definitions of symbol _regexec\nlibgit.a(regex.o) definition of _regexec in section (__TEXT,__text)\n/usr/lib/libSystem.dylib(regexec.So) definition of _regexec\n/usr/bin/ld: warning multiple definitions of symbol _regfree\nlibgit.a(regex.o) definition of _regfree in section (__TEXT,__text)\n/usr/lib/libSystem.dylib(regfree.So) definition of _regfree\n    CC imap-send.o\nimap-send.c:33:37: fatal error: CommonCrypto/CommonHMAC.h: No such file or directory\ncompilation terminated.\nmake[3]: *** [imap-send.o] Error 1\nError building git.\n\nreal    9m46.658s\nuser    5m48.673s\nsys     1m46.609s\n************************************************************************\nError installing package git-1.8.4.4\n************************************************************************\n```\n\nVolker says [this macports ticket](http://trac.macports.org/ticket/39848) has the fix, which seems reasonable.\n\n```diff\n--- a/trunk/dports/devel/git-core/Portfile\n+++ b/trunk/dports/devel/git-core/Portfile\n@@ -202,4 +202,8 @@\n }\n \n+platform darwin 8 {\n+    build.args-append   NO_APPLE_COMMON_CRYPTO=1\n+}\n+\n default_variants    +doc +pcre +credential_osxkeychain\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/16041\n\n",
    "closed_at": "2014-04-07T19:09:09Z",
    "created_at": "2014-04-01T00:23:55Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Get git to build on OS X 10.4 PPC",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16041",
    "user": "https://github.com/kcrisman"
}
```
CC:  @vbraun

As in the summary.

```
    CC http-backend.o
    LINK git-http-backend
/usr/bin/ld: warning multiple definitions of symbol _regcomp
libgit.a(regex.o) definition of _regcomp in section (__TEXT,__text)
/usr/lib/libSystem.dylib(regcomp.So) definition of _regcomp
/usr/bin/ld: warning multiple definitions of symbol _regexec
libgit.a(regex.o) definition of _regexec in section (__TEXT,__text)
/usr/lib/libSystem.dylib(regexec.So) definition of _regexec
/usr/bin/ld: warning multiple definitions of symbol _regfree
libgit.a(regex.o) definition of _regfree in section (__TEXT,__text)
/usr/lib/libSystem.dylib(regfree.So) definition of _regfree
    CC imap-send.o
imap-send.c:33:37: fatal error: CommonCrypto/CommonHMAC.h: No such file or directory
compilation terminated.
make[3]: *** [imap-send.o] Error 1
Error building git.

real    9m46.658s
user    5m48.673s
sys     1m46.609s
************************************************************************
Error installing package git-1.8.4.4
************************************************************************
```

Volker says [this macports ticket](http://trac.macports.org/ticket/39848) has the fix, which seems reasonable.

```diff
--- a/trunk/dports/devel/git-core/Portfile
+++ b/trunk/dports/devel/git-core/Portfile
@@ -202,4 +202,8 @@
 }
 
+platform darwin 8 {
+    build.args-append   NO_APPLE_COMMON_CRYPTO=1
+}
+
 default_variants    +doc +pcre +credential_osxkeychain
```

Issue created by migration from https://trac.sagemath.org/ticket/16041





---

archive/issue_comments_204730.json:
```json
{
    "body": "Sorry, this means we have to add this to the flags.  I'll try something kludgy like adding\n\n```\nexport NO_APPLE_COMMON_CRYPTO=1\n```\nin my own to try this out, but presumably we would want to do a case for Darwin 8 in spkg-install.",
    "created_at": "2014-04-01T20:31:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16041#issuecomment-204730",
    "user": "https://github.com/kcrisman"
}
```

Sorry, this means we have to add this to the flags.  I'll try something kludgy like adding

```
export NO_APPLE_COMMON_CRYPTO=1
```
in my own to try this out, but presumably we would want to do a case for Darwin 8 in spkg-install.



---

archive/issue_comments_204731.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2014-04-01T21:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16041#issuecomment-204731",
    "user": "https://github.com/kcrisman"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_204732.json:
```json
{
    "body": "Yes, this works.  In spkg-install, do\n\n```\nif { uname -sr | grep 'Darwin 8' ;} &>/dev/null; then\n    export NO_APPLE_COMMON_CRYPTO=1\nfi\n```\nI can't turn this into a branch yet on that machine, I don't think - at least, `sage -git diff` hangs - but I'll gladly approve this if someone does.  This shouldn't affect any other platform than Tiger, since we don't support Panther and anything after this supports this common crypto thingie.\n\nPutting as blocker since fix is here and prevents building.",
    "created_at": "2014-04-01T21:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16041#issuecomment-204732",
    "user": "https://github.com/kcrisman"
}
```

Yes, this works.  In spkg-install, do

```
if { uname -sr | grep 'Darwin 8' ;} &>/dev/null; then
    export NO_APPLE_COMMON_CRYPTO=1
fi
```
I can't turn this into a branch yet on that machine, I don't think - at least, `sage -git diff` hangs - but I'll gladly approve this if someone does.  This shouldn't affect any other platform than Tiger, since we don't support Panther and anything after this supports this common crypto thingie.

Putting as blocker since fix is here and prevents building.



---

archive/issue_comments_204733.json:
```json
{
    "body": "Okay, I did this change on my other machine.  Needs review.\n\n---\nNew commits:",
    "created_at": "2014-04-02T17:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16041#issuecomment-204733",
    "user": "https://github.com/kcrisman"
}
```

Okay, I did this change on my other machine.  Needs review.

---
New commits:



---

archive/issue_comments_204734.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-02T17:57:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16041#issuecomment-204734",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_204735.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-04-07T17:27:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16041#issuecomment-204735",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_204736.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-04-07T19:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16041#issuecomment-204736",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_047160.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-04-07T19:09:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16041",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16041#event-47160"
}
```
