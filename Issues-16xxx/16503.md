# Issue 16503: q-x construction of Orthogonal Arrays

archive/issues_016266.json:
```json
{
    "assignees": [],
    "body": "Another construction of orthogonal arrays. New OA for `n=158, 329, 334, 355, 517, 574, 745, 979, 1926`.\n\nThanks to Julian R. Abel's pointers, as usual `:-)`\n\nNathann\n\nDepends on #16500\n\nCC:  @videlec\n\nBranch/Commit: **[8da2c73](https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Nathann Cohen**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16503_\n\n",
    "closed_at": "2014-06-29T00:32:55Z",
    "created_at": "2014-06-20T10:32:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorial%20designs",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "q-x construction of Orthogonal Arrays",
    "type": "issue",
    "updated_at": "2014-06-29T00:32:55Z",
    "url": "https://github.com/sagemath/sage/issues/16503",
    "user": "https://github.com/nathanncohen"
}
```
Another construction of orthogonal arrays. New OA for `n=158, 329, 334, 355, 517, 574, 745, 979, 1926`.

Thanks to Julian R. Abel's pointers, as usual `:-)`

Nathann

Depends on #16500

CC:  @videlec

Branch/Commit: **[8da2c73](https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c)**

Reviewer: **Vincent Delecroix**

Author: **Nathann Cohen**

_Issue created by migration from https://trac.sagemath.org/ticket/16503_





---

archive/issue_events_218122.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-20T10:32:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218122"
}
```



---

archive/issue_events_218123.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-20T10:32:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20combinatorial%20designs",
    "label_color": "0000ff",
    "label_name": "component: combinatorial designs",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218123"
}
```



---

archive/issue_events_218124.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-20T10:32:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218124"
}
```



---

archive/issue_events_218125.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-20T10:32:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218125"
}
```



---

archive/issue_comments_216299.json:
```json
{
    "body": "Branch: **[u/ncohen/16503](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16503)**",
    "created_at": "2014-06-20T10:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216299",
    "user": "https://github.com/nathanncohen"
}
```

Branch: **[u/ncohen/16503](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16503)**



---

archive/issue_events_218126.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-20T10:36:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218126"
}
```



---

archive/issue_comments_216300.json:
```json
{
    "body": "Dependencies: **#16500**",
    "created_at": "2014-06-20T10:36:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216300",
    "user": "https://github.com/nathanncohen"
}
```

Dependencies: **#16500**



---

archive/issue_comments_216301.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/004833af803033e08e71011d4e69462de8909283\">004833a</a></td><td><code>trac #16347: Wilson's construction with two truncated groups</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5069f0dd30bd698489fa047b6fdabd7b8cdaf03\">f5069f0</a></td><td><code>trac #16347: Merged with 6.3.beta4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f182d3691892b0b1cdde8f4ab61df26845eb3e8b\">f182d36</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462\">70f7046</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9128badc12a22a2fed2b78f4e08e9bb349d1ecaa\">9128bad</a></td><td><code>trac #16503: q-x construction of Orthogonal Arrays</code></td></tr></table>\n",
    "created_at": "2014-06-20T10:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216301",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2" align="right">Comment 2</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/004833af803033e08e71011d4e69462de8909283">004833a</a></td><td><code>trac #16347: Wilson's construction with two truncated groups</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5069f0dd30bd698489fa047b6fdabd7b8cdaf03">f5069f0</a></td><td><code>trac #16347: Merged with 6.3.beta4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f182d3691892b0b1cdde8f4ab61df26845eb3e8b">f182d36</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462">70f7046</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9128badc12a22a2fed2b78f4e08e9bb349d1ecaa">9128bad</a></td><td><code>trac #16503: q-x construction of Orthogonal Arrays</code></td></tr></table>




---

archive/issue_comments_216302.json:
```json
{
    "body": "Commit: **[9128bad](https://github.com/sagemath/sagetrac-mirror/commit/9128badc12a22a2fed2b78f4e08e9bb349d1ecaa)**",
    "created_at": "2014-06-20T10:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216302",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[9128bad](https://github.com/sagemath/sagetrac-mirror/commit/9128badc12a22a2fed2b78f4e08e9bb349d1ecaa)**



---

archive/issue_comments_216303.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/828ff220b83ce8427025bebe42bbc3aaa21ac28b\">828ff22</a></td><td><code>trac #16437: cut the branches in W. dec. with two trunc. blocks</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ebd21be12c81b751a7f09067221bef01014b705\">8ebd21b</a></td><td><code>trac #16347: use is_sum_of_squares_pyx instead of two_squares</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0175134767948882f3d8c2ea0a612161ed3d4154\">0175134</a></td><td><code>trac #16347: doc + simplifications</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ff5062f8d005f19bcdfabf1f9ea65a11856da0b\">9ff5062</a></td><td><code>trac #16423: Table of MOLS from the handbook and comparison with Sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e64be9845ccf9a763bc6b89dcb6530e9962bbe92\">e64be98</a></td><td><code>trac #16423: tiny code improvement and alignment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e948cf64a435f48206b3f46ff9693201c5675ed5\">e948cf6</a></td><td><code>trac #16423: Aligning the alignment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a7d853bf758ac7abce1acfe54e18c5ea784d21f\">0a7d853</a></td><td><code>trac #16423: Broken doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3293519d314c2bd98c8074a4bd24f1535d92247\">b329351</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c\">a67c04f</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6087843eba8aac6bf74b4ef69ea72762ce47cacf\">6087843</a></td><td><code>trac #16503: q-x construction of Orthogonal Arrays</code></td></tr></table>\n",
    "created_at": "2014-06-25T15:12:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216303",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3" align="right">Comment 3</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/828ff220b83ce8427025bebe42bbc3aaa21ac28b">828ff22</a></td><td><code>trac #16437: cut the branches in W. dec. with two trunc. blocks</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ebd21be12c81b751a7f09067221bef01014b705">8ebd21b</a></td><td><code>trac #16347: use is_sum_of_squares_pyx instead of two_squares</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0175134767948882f3d8c2ea0a612161ed3d4154">0175134</a></td><td><code>trac #16347: doc + simplifications</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ff5062f8d005f19bcdfabf1f9ea65a11856da0b">9ff5062</a></td><td><code>trac #16423: Table of MOLS from the handbook and comparison with Sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e64be9845ccf9a763bc6b89dcb6530e9962bbe92">e64be98</a></td><td><code>trac #16423: tiny code improvement and alignment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e948cf64a435f48206b3f46ff9693201c5675ed5">e948cf6</a></td><td><code>trac #16423: Aligning the alignment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a7d853bf758ac7abce1acfe54e18c5ea784d21f">0a7d853</a></td><td><code>trac #16423: Broken doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3293519d314c2bd98c8074a4bd24f1535d92247">b329351</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c">a67c04f</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6087843eba8aac6bf74b4ef69ea72762ce47cacf">6087843</a></td><td><code>trac #16503: q-x construction of Orthogonal Arrays</code></td></tr></table>




---

archive/issue_comments_216304.json:
```json
{
    "body": "Changed commit from **[9128bad](https://github.com/sagemath/sagetrac-mirror/commit/9128badc12a22a2fed2b78f4e08e9bb349d1ecaa)** to **[6087843](https://github.com/sagemath/sagetrac-mirror/commit/6087843eba8aac6bf74b4ef69ea72762ce47cacf)**",
    "created_at": "2014-06-25T15:12:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216304",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9128bad](https://github.com/sagemath/sagetrac-mirror/commit/9128badc12a22a2fed2b78f4e08e9bb349d1ecaa)** to **[6087843](https://github.com/sagemath/sagetrac-mirror/commit/6087843eba8aac6bf74b4ef69ea72762ce47cacf)**



---

archive/issue_comments_216305.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nUpdated on top of #16500 !\n\nNathann",
    "created_at": "2014-06-26T10:47:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216305",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:4" align="right">Comment 4</div>

Updated on top of #16500 !

Nathann



---

archive/issue_comments_216306.json:
```json
{
    "body": "Changed commit from **[6087843](https://github.com/sagemath/sagetrac-mirror/commit/6087843eba8aac6bf74b4ef69ea72762ce47cacf)** to **[71dad5d](https://github.com/sagemath/sagetrac-mirror/commit/71dad5d46b3fe7b343962974a75a9c199e0904a6)**",
    "created_at": "2014-06-26T10:48:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216306",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6087843](https://github.com/sagemath/sagetrac-mirror/commit/6087843eba8aac6bf74b4ef69ea72762ce47cacf)** to **[71dad5d](https://github.com/sagemath/sagetrac-mirror/commit/71dad5d46b3fe7b343962974a75a9c199e0904a6)**



---

archive/issue_comments_216307.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b\">41c50d5</a></td><td><code>trac #16500: Simplified find_recursive_construction</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173\">e1992ce</a></td><td><code>trac #16500: doc + speedup</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4\">697dd0c</a></td><td><code>trac #16500: Typoes in the doc</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/71dad5d46b3fe7b343962974a75a9c199e0904a6\">71dad5d</a></td><td><code>trac #16503: q-x construction of Orthogonal Arrays</code></td></tr></table>\n",
    "created_at": "2014-06-26T10:48:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216307",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5" align="right">Comment 5</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b">41c50d5</a></td><td><code>trac #16500: Simplified find_recursive_construction</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173">e1992ce</a></td><td><code>trac #16500: doc + speedup</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4">697dd0c</a></td><td><code>trac #16500: Typoes in the doc</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/71dad5d46b3fe7b343962974a75a9c199e0904a6">71dad5d</a></td><td><code>trac #16503: q-x construction of Orthogonal Arrays</code></td></tr></table>




---

archive/issue_comments_216308.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nHi Nathann,\n\n1) One lines 656-659 you have an import followed by a commented check!!\n\n```\nfrom sage.combinat.designs.bibd import _check_pbd\nPBD = [[relabel[xx] for xx in B if not xx in points_to_delete] for B in TD]\n\n# _check_pbd(PBD,n,[q,q-x-1,q-x+1,x+2])\n```\nwhy is that?\n\n2) This is wrong (lines 730-731)\n\n```\n# The next is always True, because q is a prime power\n# orthogonal_array(k+1,q,existence=True) and\n```\nif k+1 > q... instead we can start the loop at k+1 instead of 3.\n\n3) I bounced into something bad: I wanted to change in `find_recursive_construction` the\n\n```\nassert k >= 3\n```\ninto a\n\n```\nassert k > 3, \"you do not need recursion for k<4\"\n```\nsince it is trivial to build one latin square. But it appears that the recursive constructions is called with k=3 many times! so bad! This has to be corrected... but hopefully, not here. I guess that #16535 would be the good place.\n\nVincent",
    "created_at": "2014-06-27T12:02:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216308",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">Comment 6</div>

Hi Nathann,

1) One lines 656-659 you have an import followed by a commented check!!

```
from sage.combinat.designs.bibd import _check_pbd
PBD = [[relabel[xx] for xx in B if not xx in points_to_delete] for B in TD]

# _check_pbd(PBD,n,[q,q-x-1,q-x+1,x+2])
```
why is that?

2) This is wrong (lines 730-731)

```
# The next is always True, because q is a prime power
# orthogonal_array(k+1,q,existence=True) and
```
if k+1 > q... instead we can start the loop at k+1 instead of 3.

3) I bounced into something bad: I wanted to change in `find_recursive_construction` the

```
assert k >= 3
```
into a

```
assert k > 3, "you do not need recursion for k<4"
```
since it is trivial to build one latin square. But it appears that the recursive constructions is called with k=3 many times! so bad! This has to be corrected... but hopefully, not here. I guess that #16535 would be the good place.

Vincent



---

archive/issue_comments_216309.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nHello !\n\n> 1) One lines 656-659 you have an import followed by a commented check!!\n> \n> ```\n> from sage.combinat.designs.bibd import _check_pbd\n> PBD = [[relabel[xx] for xx in B if not xx in points_to_delete] for B in TD]\n> \n> # _check_pbd(PBD,n,[q,q-x-1,q-x+1,x+2])\n> ```\n> why is that?\n\nIt is something I used while implementing the construction and as it said something about the PBD I left it. I updated that comment as that troubled you.\n\n> 2) This is wrong (lines 730-731)\n> \n> ```\n> # The next is always True, because q is a prime power\n> # orthogonal_array(k+1,q,existence=True) and\n> ```\n\nThe line before that one is \n\n```\n            orthogonal_array(k+1,q-x+1,existence=True) and\n```\n\n> 3) I bounced into something bad: I wanted to change in `find_recursive_construction` the\n> \n> ```\n> assert k >= 3\n> ```\n> into a\n> \n> ```\n> assert k > 3, \"you do not need recursion for k<4\"\n> ```\n> since it is trivial to build one latin square. But it appears that the recursive constructions is called with k=3 many times! so bad! This has to be corrected... but hopefully, not here. I guess that #16535 would be the good place.\n\nWhy in #16535 ? What we need to do is add a case for k=3 in the `orthogonal_array` constructor.\n\nI fixed the things above, plus an apparently incorrect `1<x`.\n\nNathann",
    "created_at": "2014-06-27T12:43:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216309",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:7" align="right">Comment 7</div>

Hello !

> 1) One lines 656-659 you have an import followed by a commented check!!
> 
> ```
> from sage.combinat.designs.bibd import _check_pbd
> PBD = [[relabel[xx] for xx in B if not xx in points_to_delete] for B in TD]
> 
> # _check_pbd(PBD,n,[q,q-x-1,q-x+1,x+2])
> ```
> why is that?

It is something I used while implementing the construction and as it said something about the PBD I left it. I updated that comment as that troubled you.

> 2) This is wrong (lines 730-731)
> 
> ```
> # The next is always True, because q is a prime power
> # orthogonal_array(k+1,q,existence=True) and
> ```

The line before that one is 

```
            orthogonal_array(k+1,q-x+1,existence=True) and
```

> 3) I bounced into something bad: I wanted to change in `find_recursive_construction` the
> 
> ```
> assert k >= 3
> ```
> into a
> 
> ```
> assert k > 3, "you do not need recursion for k<4"
> ```
> since it is trivial to build one latin square. But it appears that the recursive constructions is called with k=3 many times! so bad! This has to be corrected... but hopefully, not here. I guess that #16535 would be the good place.

Why in #16535 ? What we need to do is add a case for k=3 in the `orthogonal_array` constructor.

I fixed the things above, plus an apparently incorrect `1<x`.

Nathann



---

archive/issue_comments_216310.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/91eb3d2d16fa8a4576d6b5d6e2686af6f8593def\">91eb3d2</a></td><td><code>trac #16503: Review</code></td></tr></table>\n",
    "created_at": "2014-06-27T12:44:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216310",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8" align="right">Comment 8</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/91eb3d2d16fa8a4576d6b5d6e2686af6f8593def">91eb3d2</a></td><td><code>trac #16503: Review</code></td></tr></table>




---

archive/issue_comments_216311.json:
```json
{
    "body": "Changed commit from **[71dad5d](https://github.com/sagemath/sagetrac-mirror/commit/71dad5d46b3fe7b343962974a75a9c199e0904a6)** to **[91eb3d2](https://github.com/sagemath/sagetrac-mirror/commit/91eb3d2d16fa8a4576d6b5d6e2686af6f8593def)**",
    "created_at": "2014-06-27T12:44:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216311",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[71dad5d](https://github.com/sagemath/sagetrac-mirror/commit/71dad5d46b3fe7b343962974a75a9c199e0904a6)** to **[91eb3d2](https://github.com/sagemath/sagetrac-mirror/commit/91eb3d2d16fa8a4576d6b5d6e2686af6f8593def)**



---

archive/issue_comments_216312.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nHi Nathann,\n\nYou can actually cut the loop if `x >= q` as `x` is increasing along the loop. It is done at `public/16503` (it does not matter too much right now, but it will if you want to compute a big MOLS table).\n\nBeyond that, you can set to positive review.\n\nVincent",
    "created_at": "2014-06-27T17:51:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216312",
    "user": "https://github.com/videlec"
}
```

<div id="comment:9" align="right">Comment 9</div>

Hi Nathann,

You can actually cut the loop if `x >= q` as `x` is increasing along the loop. It is done at `public/16503` (it does not matter too much right now, but it will if you want to compute a big MOLS table).

Beyond that, you can set to positive review.

Vincent



---

archive/issue_events_218127.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-27T17:51:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218127"
}
```



---

archive/issue_events_218128.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-27T17:51:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218128"
}
```



---

archive/issue_comments_216313.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nHMmmmm... I don't like much to differentiate over integer divisions.. Do you mind if we keep it like that ?\n\nNathann",
    "created_at": "2014-06-27T18:06:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216313",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:11" align="right">Comment 11</div>

HMmmmm... I don't like much to differentiate over integer divisions.. Do you mind if we keep it like that ?

Nathann



---

archive/issue_comments_216314.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@nathanncohen](#comment%3A11):\n> HMmmmm... I don't like much to differentiate over integer divisions.. Do you mind if we keep it like that ?\n\nMe neither, but the floor function is increasing... so it is fine (as the composition of increasing functions is increasing)! But we can keep it as it is, since we cut very little with that: `(q^2-n)/(q-2) ~ q + cte` for large `q`.\n\nVincent",
    "created_at": "2014-06-27T18:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216314",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@nathanncohen](#comment%3A11):
> HMmmmm... I don't like much to differentiate over integer divisions.. Do you mind if we keep it like that ?

Me neither, but the floor function is increasing... so it is fine (as the composition of increasing functions is increasing)! But we can keep it as it is, since we cut very little with that: `(q^2-n)/(q-2) ~ q + cte` for large `q`.

Vincent



---

archive/issue_events_218129.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-27T18:13:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218129"
}
```



---

archive/issue_events_218130.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-27T18:13:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218130"
}
```



---

archive/issue_comments_216315.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2014-06-27T18:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216315",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_events_218131.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-28T08:15:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218131"
}
```



---

archive/issue_events_218132.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-28T08:15:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218132"
}
```



---

archive/issue_comments_216316.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nAs reported in #16524 there is a problem building the doc. Solution (line 622)\n\n```\n-    REFERENCES::\n+    REFERENCES:\n```",
    "created_at": "2014-06-28T08:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216316",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">Comment 13</div>

As reported in #16524 there is a problem building the doc. Solution (line 622)

```
-    REFERENCES::
+    REFERENCES:
```



---

archive/issue_comments_216317.json:
```json
{
    "body": "Changed commit from **[91eb3d2](https://github.com/sagemath/sagetrac-mirror/commit/91eb3d2d16fa8a4576d6b5d6e2686af6f8593def)** to **[8da2c73](https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c)**",
    "created_at": "2014-06-28T08:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216317",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[91eb3d2](https://github.com/sagemath/sagetrac-mirror/commit/91eb3d2d16fa8a4576d6b5d6e2686af6f8593def)** to **[8da2c73](https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c)**



---

archive/issue_comments_216318.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c\">8da2c73</a></td><td><code>trac #16503: Broken doc</code></td></tr></table>\n",
    "created_at": "2014-06-28T08:17:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216318",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14" align="right">Comment 14</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c">8da2c73</a></td><td><code>trac #16503: Broken doc</code></td></tr></table>




---

archive/issue_events_218133.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-28T08:17:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218133"
}
```



---

archive/issue_events_218134.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-28T08:17:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218134"
}
```



---

archive/issue_comments_216319.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\n... building the doc...",
    "created_at": "2014-06-28T08:22:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216319",
    "user": "https://github.com/videlec"
}
```

<div id="comment:16" align="right">Comment 16</div>

... building the doc...



---

archive/issue_events_218135.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-28T08:26:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218135"
}
```



---

archive/issue_events_218136.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-28T08:26:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218136"
}
```



---

archive/issue_events_218137.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-29T00:32:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218137"
}
```



---

archive/issue_events_218138.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "11fc783617fad3f9789293cfb9ff9ea215a192ec",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-06-29T00:32:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16503#event-218138"
}
```



---

archive/issue_comments_216320.json:
```json
{
    "body": "Changed branch from **[u/ncohen/16503](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16503)** to **[8da2c73](https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c)**",
    "created_at": "2014-06-29T00:32:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16503",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16503#issuecomment-216320",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/ncohen/16503](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16503)** to **[8da2c73](https://github.com/sagemath/sagetrac-mirror/commit/8da2c73aeb5a5ca2e1561131fb3218b3c451b33c)**
