# Issue 16455: Update zeromq and pyzmq to recent version and new git layout

archive/issues_016218.json:
```json
{
    "assignees": [],
    "body": "The packages zero an pyzmq are required to let IPython notebook work within Sage. There seems to be a [consensus](https://groups.google.com/forum/#!topic/sage-devel/TbjumtvzCM0) to have those as standard packages. See also #16053.\n\nThe upstream tarballs can be found at : \n- http://download.zeromq.org/zeromq-4.0.4.tar.gz\n- https://pypi.python.org/packages/source/p/pyzmq/pyzmq-14.3.0.tar.gz\n\n\nCC:  @seblabbe @vbraun @williamstein @dimpase\n\nKeywords: **ipython**\n\nBranch: **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)**\n\nReviewer: **S\u00e9bastien Labb\u00e9**\n\nAuthor: **Thierry Monteil**\n\nComponent: **packages: optional**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16455_\n\n",
    "closed_at": "2014-06-18T12:00:20Z",
    "created_at": "2014-06-07T13:39:25Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Update zeromq and pyzmq to recent version and new git layout",
    "type": "issue",
    "updated_at": "2014-12-15T21:28:27Z",
    "url": "https://github.com/sagemath/sage/issues/16455",
    "user": "https://github.com/sagetrac-tmonteil"
}
```
The packages zero an pyzmq are required to let IPython notebook work within Sage. There seems to be a [consensus](https://groups.google.com/forum/#!topic/sage-devel/TbjumtvzCM0) to have those as standard packages. See also #16053.

The upstream tarballs can be found at : 
- http://download.zeromq.org/zeromq-4.0.4.tar.gz
- https://pypi.python.org/packages/source/p/pyzmq/pyzmq-14.3.0.tar.gz


CC:  @seblabbe @vbraun @williamstein @dimpase

Keywords: **ipython**

Branch: **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)**

Reviewer: **Sébastien Labbé**

Author: **Thierry Monteil**

Component: **packages: optional**

_Issue created by migration from https://trac.sagemath.org/ticket/16455_





---

archive/issue_events_235015.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-07T13:39:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235015"
}
```



---

archive/issue_events_235016.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-07T13:39:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235016"
}
```



---

archive/issue_comments_212786.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n+The packages zero an pyzmq are required to let IPython notebook work within Sage. There seems to be a [consensus](https://groups.google.com/forum/#!topic/sage-devel/TbjumtvzCM0) to have those as standard packages. See also #16053.\n \n``````\n",
    "created_at": "2014-06-07T13:47:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212786",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
+The packages zero an pyzmq are required to let IPython notebook work within Sage. There seems to be a [consensus](https://groups.google.com/forum/#!topic/sage-devel/TbjumtvzCM0) to have those as standard packages. See also #16053.
 
``````




---

archive/issue_comments_212787.json:
```json
{
    "body": "Branch: **[u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout)**",
    "created_at": "2014-06-07T14:11:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212787",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Branch: **[u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout)**



---

archive/issue_comments_212788.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/524b2d2b214cee5efbda50cca468c258b03e2db5\"><code>524b2d2</code></a></td><td><code>#16455 : pyzmq new git layout + update to version 14.3.0 + remove old-style-spkg changelog + update buildutils patch.</code></td></tr></table>\n",
    "created_at": "2014-06-07T14:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212788",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/524b2d2b214cee5efbda50cca468c258b03e2db5"><code>524b2d2</code></a></td><td><code>#16455 : pyzmq new git layout + update to version 14.3.0 + remove old-style-spkg changelog + update buildutils patch.</code></td></tr></table>




---

archive/issue_comments_212789.json:
```json
{
    "body": "Commit: **[`524b2d2`](https://github.com/sagemath/sagetrac-mirror/commit/524b2d2b214cee5efbda50cca468c258b03e2db5)**",
    "created_at": "2014-06-07T14:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212789",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`524b2d2`](https://github.com/sagemath/sagetrac-mirror/commit/524b2d2b214cee5efbda50cca468c258b03e2db5)**



---

archive/issue_events_235017.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-07T15:04:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235017"
}
```



---

archive/issue_comments_212790.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSebastien, i modified the patch that could not be applied anymore, please can you check whether this still works on Darwin ?",
    "created_at": "2014-06-07T15:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212790",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:4" align="right">comment:4</div>

Sebastien, i modified the patch that could not be applied anymore, please can you check whether this still works on Darwin ?



---

archive/issue_comments_212791.json:
```json
{
    "body": "Changed keywords from none to **ipython**",
    "created_at": "2014-06-07T15:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212791",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Changed keywords from none to **ipython**



---

archive/issue_events_235018.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-07T15:04:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235018"
}
```



---

archive/issue_comments_212792.json:
```json
{
    "body": "Author: **Thierry Monteil**",
    "created_at": "2014-06-07T15:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212792",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Author: **Thierry Monteil**



---

archive/issue_comments_212793.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1,6 @@\n The packages zero an pyzmq are required to let IPython notebook work within Sage. There seems to be a [consensus](https://groups.google.com/forum/#!topic/sage-devel/TbjumtvzCM0) to have those as standard packages. See also #16053.\n \n+The upstream tarballs can be found at : \n+- http://download.zeromq.org/zeromq-4.0.4.tar.gz\n+- https://pypi.python.org/packages/source/p/pyzmq/pyzmq-14.3.0.tar.gz\n+\n``````\n",
    "created_at": "2014-06-07T15:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212793",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1,6 @@
 The packages zero an pyzmq are required to let IPython notebook work within Sage. There seems to be a [consensus](https://groups.google.com/forum/#!topic/sage-devel/TbjumtvzCM0) to have those as standard packages. See also #16053.
 
+The upstream tarballs can be found at : 
+- http://download.zeromq.org/zeromq-4.0.4.tar.gz
+- https://pypi.python.org/packages/source/p/pyzmq/pyzmq-14.3.0.tar.gz
+
``````




---

archive/issue_events_235019.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-07T15:04:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235019"
}
```



---

archive/issue_comments_212794.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nFor what it is worth, I strongly support including IPython notebook (and deps) in Sage standard.  -- William",
    "created_at": "2014-06-07T16:08:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212794",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:5" align="right">comment:5</div>

For what it is worth, I strongly support including IPython notebook (and deps) in Sage standard.  -- William



---

archive/issue_comments_212795.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI get this after installing your branch :\n\n```\n10 slabbe@pol ~/Applications/sage-review $ ./sage -f http://download.zeromq.org/zeromq-4.0.4.tar.gz\nAttempting to download package zeromq-4.0.4.tar.gz\n>>> Trying to download http://download.zeromq.org/zeromq-4.0.4.tar.gz\n[............................................................]\nzeromq-4.0.4.tar.gz\n====================================================\nExtracting package /Users/slabbe/Applications/sage-review/upstream/zeromq-4.0.4.tar.gz\n-rw-r--r--  1 slabbe  staff  2149732 Jun 10 08:55 /Users/slabbe/Applications/sage-review/upstream/zeromq-4.0.4.tar.gz\nFinished extraction\n/Users/slabbe/Applications/sage-review/src/bin/sage-spkg: line 594: cd: zeromq-4.0.4.tar.gz: No such file or directory\nError: after extracting, the directory zeromq-4.0.4.tar.gz does not exist\n```",
    "created_at": "2014-06-10T06:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212795",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:6" align="right">comment:6</div>

I get this after installing your branch :

```
10 slabbe@pol ~/Applications/sage-review $ ./sage -f http://download.zeromq.org/zeromq-4.0.4.tar.gz
Attempting to download package zeromq-4.0.4.tar.gz
>>> Trying to download http://download.zeromq.org/zeromq-4.0.4.tar.gz
[............................................................]
zeromq-4.0.4.tar.gz
====================================================
Extracting package /Users/slabbe/Applications/sage-review/upstream/zeromq-4.0.4.tar.gz
-rw-r--r--  1 slabbe  staff  2149732 Jun 10 08:55 /Users/slabbe/Applications/sage-review/upstream/zeromq-4.0.4.tar.gz
Finished extraction
/Users/slabbe/Applications/sage-review/src/bin/sage-spkg: line 594: cd: zeromq-4.0.4.tar.gz: No such file or directory
Error: after extracting, the directory zeromq-4.0.4.tar.gz does not exist
```



---

archive/issue_comments_212796.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThe tarball you found at `http://download.zeromq.org/zeromq-4.0.4.tar.gz` is not a sage package, it is the source code of zeromq. You have to put this tarball on your `/Users/slabbe/Applications/sage-review/upstream/` directory, and then do `./sage -f zeromq`.",
    "created_at": "2014-06-10T09:07:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212796",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:7" align="right">comment:7</div>

The tarball you found at `http://download.zeromq.org/zeromq-4.0.4.tar.gz` is not a sage package, it is the source code of zeromq. You have to put this tarball on your `/Users/slabbe/Applications/sage-review/upstream/` directory, and then do `./sage -f zeromq`.



---

archive/issue_comments_212797.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@sagetrac-tmonteil](#comment:7):\n> The tarball you found at `http://download.zeromq.org/zeromq-4.0.4.tar.gz` is not a sage package, it is the source code of zeromq. You have to put this tarball on your `/Users/slabbe/Applications/sage-review/upstream/` directory, and then do `./sage -f zeromq`.\n\nBut the above put the tarball in the upstream directory. So that means I can do :\n\n```\n./sage -i http://download.zeromq.org/zeromq-4.0.4.tar.gz   # download in upstream\n./sage -i zeromq\n```",
    "created_at": "2014-06-10T09:16:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212797",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@sagetrac-tmonteil](#comment:7):
> The tarball you found at `http://download.zeromq.org/zeromq-4.0.4.tar.gz` is not a sage package, it is the source code of zeromq. You have to put this tarball on your `/Users/slabbe/Applications/sage-review/upstream/` directory, and then do `./sage -f zeromq`.

But the above put the tarball in the upstream directory. So that means I can do :

```
./sage -i http://download.zeromq.org/zeromq-4.0.4.tar.gz   # download in upstream
./sage -i zeromq
```



---

archive/issue_comments_212798.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe first command will lead to an error, since it not only tries to download the tarball in upstream/, but also tries to install it as a sage spkg, explaining your error, hence you should consider using wget ot curl for that part of the review. Of course, once the ticket is merged, there is no need to download the tarball manually since sage will find it at http://sagemath.org/packages/upstream/\n\nThat said, after that error, the second command should work, since zeromq-4.0.4.tar.gz is now in the upstream/ directory.",
    "created_at": "2014-06-10T09:26:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212798",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:9" align="right">comment:9</div>

The first command will lead to an error, since it not only tries to download the tarball in upstream/, but also tries to install it as a sage spkg, explaining your error, hence you should consider using wget ot curl for that part of the review. Of course, once the ticket is merged, there is no need to download the tarball manually since sage will find it at http://sagemath.org/packages/upstream/

That said, after that error, the second command should work, since zeromq-4.0.4.tar.gz is now in the upstream/ directory.



---

archive/issue_comments_212799.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nOk, so I just tested and it does work on my machine. I also managed to open the ipython notebook with these.\n\nI also tested without the buildutils patch on pyzmq, and `sage -i pyzmq` also worked. Indeed, I remembered I read somewhere (maybe on sage-devel) that my patch was now useless since the problem was fixed in a later release... I tried to find where I read that, but I was not able.",
    "created_at": "2014-06-10T09:28:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212799",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:10" align="right">comment:10</div>

Ok, so I just tested and it does work on my machine. I also managed to open the ipython notebook with these.

I also tested without the buildutils patch on pyzmq, and `sage -i pyzmq` also worked. Indeed, I remembered I read somewhere (maybe on sage-devel) that my patch was now useless since the problem was fixed in a later release... I tried to find where I read that, but I was not able.



---

archive/issue_comments_212800.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nOK, once you confirm that the patch is not needed anymore, i will remove it from the branch.",
    "created_at": "2014-06-10T09:34:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212800",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:11" align="right">comment:11</div>

OK, once you confirm that the patch is not needed anymore, i will remove it from the branch.



---

archive/issue_comments_212801.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWith the following modifications:\n\n```\n~/Applications/sage-review $ git diff\ndiff --git a/build/pkgs/pyzmq/spkg-install b/build/pkgs/pyzmq/spkg-install\nindex c7e1216..269f055 100755\n--- a/build/pkgs/pyzmq/spkg-install\n+++ b/build/pkgs/pyzmq/spkg-install\n@@ -13,16 +13,6 @@ echo \"include_dirs = $SAGE_LOCAL/include/\" >> src/setup.cfg\n \n cd src\n \n-# Apply patches.  See SPKG.txt for information about what each patch\n-# does.\n-for patch in ../patches/*.patch; do\n-    patch -p1 <\"$patch\"\n-    if [ $? -ne 0 ]; then\n-        echo >&2 \"Error applying '$patch'\"\n-        exit 1\n-    fi\n-done\n-\n # Configure and install\n python setup.py configure --zmq=\"$SAGE_LOCAL\"\n python setup.py install\n```\n\nI confirm that it works:\n\n```\n./sage -f pyzmq\nFound local metadata for pyzmq-14.3.0\n\n[...]\n\nSuccessfully installed pyzmq-14.3.0\nDeleting temporary build directory\nFinished installing pyzmq-14.3.0.spkg\n```",
    "created_at": "2014-06-10T09:46:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212801",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:12" align="right">comment:12</div>

With the following modifications:

```
~/Applications/sage-review $ git diff
diff --git a/build/pkgs/pyzmq/spkg-install b/build/pkgs/pyzmq/spkg-install
index c7e1216..269f055 100755
--- a/build/pkgs/pyzmq/spkg-install
+++ b/build/pkgs/pyzmq/spkg-install
@@ -13,16 +13,6 @@ echo "include_dirs = $SAGE_LOCAL/include/" >> src/setup.cfg
 
 cd src
 
-# Apply patches.  See SPKG.txt for information about what each patch
-# does.
-for patch in ../patches/*.patch; do
-    patch -p1 <"$patch"
-    if [ $? -ne 0 ]; then
-        echo >&2 "Error applying '$patch'"
-        exit 1
-    fi
-done
-
 # Configure and install
 python setup.py configure --zmq="$SAGE_LOCAL"
 python setup.py install
```

I confirm that it works:

```
./sage -f pyzmq
Found local metadata for pyzmq-14.3.0

[...]

Successfully installed pyzmq-14.3.0
Deleting temporary build directory
Finished installing pyzmq-14.3.0.spkg
```



---

archive/issue_comments_212802.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nremove the patch for pyzmq",
    "created_at": "2014-06-10T09:47:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212802",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:13" align="right">comment:13</div>

remove the patch for pyzmq



---

archive/issue_events_235020.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-06-10T09:47:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235020"
}
```



---

archive/issue_events_235021.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-06-10T09:47:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235021"
}
```



---

archive/issue_comments_212803.json:
```json
{
    "body": "Changed commit from **[`524b2d2`](https://github.com/sagemath/sagetrac-mirror/commit/524b2d2b214cee5efbda50cca468c258b03e2db5)** to **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)**",
    "created_at": "2014-06-10T10:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212803",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`524b2d2`](https://github.com/sagemath/sagetrac-mirror/commit/524b2d2b214cee5efbda50cca468c258b03e2db5)** to **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)**



---

archive/issue_comments_212804.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a\"><code>184da0c</code></a></td><td><code>#16455 remove useless buildutils patch</code></td></tr></table>\n",
    "created_at": "2014-06-10T10:04:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212804",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a"><code>184da0c</code></a></td><td><code>#16455 remove useless buildutils patch</code></td></tr></table>




---

archive/issue_comments_212805.json:
```json
{
    "body": "Reviewer: **\u200bS\u00e9bastien Labb\u00e9**",
    "created_at": "2014-06-10T10:06:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212805",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Reviewer: **​Sébastien Labbé**



---

archive/issue_events_235022.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-10T10:06:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235022"
}
```



---

archive/issue_events_235023.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-10T10:06:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235023"
}
```



---

archive/issue_comments_212806.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nOne question before giving a positive review. Can the spkg-install of pyzmq check that zeromq spkg was installed before? But maybe it is not a good idea, and it is better to let the installation breaks by itself....",
    "created_at": "2014-06-10T12:40:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212806",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:16" align="right">comment:16</div>

One question before giving a positive review. Can the spkg-install of pyzmq check that zeromq spkg was installed before? But maybe it is not a good idea, and it is better to let the installation breaks by itself....



---

archive/issue_events_235024.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-10T13:05:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235024"
}
```



---

archive/issue_events_235025.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2014-06-10T13:05:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20optional",
    "label_color": "000080",
    "label_name": "c: packages: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235025"
}
```



---

archive/issue_comments_212807.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nTo my understanding, the dependencies are set via the `build/deps` file, but it seems to be reserved to standard packages only. Volker, is this correct ?\n\nThat said, since those packages are optional for more than one year and many people want them to become standard, i plan to make a ticket for that.",
    "created_at": "2014-06-10T13:05:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212807",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:17" align="right">comment:17</div>

To my understanding, the dependencies are set via the `build/deps` file, but it seems to be reserved to standard packages only. Volker, is this correct ?

That said, since those packages are optional for more than one year and many people want them to become standard, i plan to make a ticket for that.



---

archive/issue_comments_212808.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nWe don't have a dependency mechanism for optional packaeges yet. But please don't roll your own just for zeromq...",
    "created_at": "2014-06-10T13:06:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212808",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:18" align="right">comment:18</div>

We don't have a dependency mechanism for optional packaeges yet. But please don't roll your own just for zeromq...



---

archive/issue_events_235026.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-06-10T15:42:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235026"
}
```



---

archive/issue_events_235027.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2014-06-10T15:42:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235027"
}
```



---

archive/issue_comments_212809.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nSome optional packages do some dependency checking in their spkg-install, for example the p_group_cohomology package does this:\n\n```sh\nSMALL_GROUPS=`echo \"SmallGroup(13,1); quit;\" | gap -b -T | grep \"13\"`\nif [ \"$SMALL_GROUPS\" = \"\" ]; then\n   echo \"It seems that GAP's SmallGroups library is missing.\"\n   echo \"One way to install it is by doing\"\n   echo \"    sage: install_package('database_gap')\"\n   echo \"in a Sage session.\"\n   exit 1\nfi\n```\nWill installation of pyzmq fail gracefully if zeromq is missing, or is it better to have a check like this?",
    "created_at": "2014-06-10T17:30:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212809",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:20" align="right">comment:20</div>

Some optional packages do some dependency checking in their spkg-install, for example the p_group_cohomology package does this:

```sh
SMALL_GROUPS=`echo "SmallGroup(13,1); quit;" | gap -b -T | grep "13"`
if [ "$SMALL_GROUPS" = "" ]; then
   echo "It seems that GAP's SmallGroups library is missing."
   echo "One way to install it is by doing"
   echo "    sage: install_package('database_gap')"
   echo "in a Sage session."
   exit 1
fi
```
Will installation of pyzmq fail gracefully if zeromq is missing, or is it better to have a check like this?



---

archive/issue_comments_212810.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nsomeone installing pyzmq before zeromq will get something like :\n\n```\n******************************************\nConfigure: Autodetecting ZMQ settings...\n    Custom ZMQ dir:       /Users/slabbe/Applications/sage-git/local\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -I/Users/slabbe/Applications/sage-git/local/include -Izmq/utils -Izmq/core -Izmq/devices -c detect/vers.c -o detect/vers.o\ndetect/vers.c:3:17: fatal error: zmq.h: No such file or directory\ncompilation terminated.\nFatal: \n    Failed to compile ZMQ test program.  Please check to make sure:\n\n    * You have a C compiler installed\n    * A development version of Python is installed (including header files)\n    * A development version of ZMQ >= 2.1.4 is installed (including header files)\n    * If ZMQ is not in a default location, supply the argument --zmq=<path>\n    * If you did recently install ZMQ to a default location, \n      try rebuilding the ld cache with `sudo ldconfig`\n      or specify zmq's location with `--zmq=/usr/local`\n    \nerror: command 'gcc' failed with exit status 1\n******************************************\n\nreal\t0m0.622s\nuser\t0m0.259s\nsys\t0m0.335s\n************************************************************************\nError installing package pyzmq-2.1.11.p1\n************************************************************************\n```",
    "created_at": "2014-06-10T18:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212810",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:21" align="right">comment:21</div>

someone installing pyzmq before zeromq will get something like :

```
******************************************
Configure: Autodetecting ZMQ settings...
    Custom ZMQ dir:       /Users/slabbe/Applications/sage-git/local
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -I/Users/slabbe/Applications/sage-git/local/include -Izmq/utils -Izmq/core -Izmq/devices -c detect/vers.c -o detect/vers.o
detect/vers.c:3:17: fatal error: zmq.h: No such file or directory
compilation terminated.
Fatal: 
    Failed to compile ZMQ test program.  Please check to make sure:

    * You have a C compiler installed
    * A development version of Python is installed (including header files)
    * A development version of ZMQ >= 2.1.4 is installed (including header files)
    * If ZMQ is not in a default location, supply the argument --zmq=<path>
    * If you did recently install ZMQ to a default location, 
      try rebuilding the ld cache with `sudo ldconfig`
      or specify zmq's location with `--zmq=/usr/local`
    
error: command 'gcc' failed with exit status 1
******************************************

real	0m0.622s
user	0m0.259s
sys	0m0.335s
************************************************************************
Error installing package pyzmq-2.1.11.p1
************************************************************************
```



---

archive/issue_comments_212811.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAnyway, these two packages are aimed to become standard soon if I understand correctly, so their dependencies will be set via the `build/deps` as mentionned before. So I believe it OK like that without any dependency checking.",
    "created_at": "2014-06-10T18:47:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212811",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:22" align="right">comment:22</div>

Anyway, these two packages are aimed to become standard soon if I understand correctly, so their dependencies will be set via the `build/deps` as mentionned before. So I believe it OK like that without any dependency checking.



---

archive/issue_comments_212812.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\ndelete invisible space",
    "created_at": "2014-06-17T19:07:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212812",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:23" align="right">comment:23</div>

delete invisible space



---

archive/issue_comments_212813.json:
```json
{
    "body": "Changed reviewer from **\u200bS\u00e9bastien Labb\u00e9** to **S\u00e9bastien Labb\u00e9**",
    "created_at": "2014-06-17T19:07:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212813",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **​Sébastien Labbé** to **Sébastien Labbé**



---

archive/issue_comments_212814.json:
```json
{
    "body": "Changed branch from **[u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout)** to **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)**",
    "created_at": "2014-06-18T12:00:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212814",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout](https://github.com/sagemath/sagetrac-mirror/tree/u/tmonteil/update_zeromq_and_pyzmq_to_recent_version_and_new_git_layout)** to **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)**



---

archive/issue_events_235028.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-18T12:00:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235028"
}
```



---

archive/issue_events_235029.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "15b55956f948f1209c3c6f0935531171d3cb715b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-06-18T12:00:20Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16455#event-235029"
}
```



---

archive/issue_comments_212815.json:
```json
{
    "body": "Changed commit from **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)** to none",
    "created_at": "2014-12-13T23:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212815",
    "user": "https://github.com/kcrisman"
}
```

Changed commit from **[`184da0c`](https://github.com/sagemath/sagetrac-mirror/commit/184da0c30ccdd81b3d1c0c70ff3590ca14b3446a)** to none



---

archive/issue_comments_212816.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\n> OK, once you confirm that the patch is not needed anymore, i will remove it from the branch.\n\nWho confirmed that this was useless?  This will still not work on older Macs - see the **actual note that was in the SPKG.txt**!!!\n\n```\n   - patches/buildutils.patch: This patches the file src/buildutils/detect.py.\n     It remove the option -arch for gcc which was broken on MacOSX 10.5.8.\n     The reason to this is that Sage's gcc spkg does not build a compiler\n     which understands the option -arch of Apple's clone of gcc.\n     https://groups.google.com/forum/?fromgroups#!topic/sage-devel/CuZNKclprIQ\n     https://github.com/sagemath/sage/issues/13313\n```\nAnd now that this is standard with all the big changes at the end of 6.4, it breaks some of them.  And since the machine I am currently trying to build Sage on does not have git, nor has git built yet, I will have to type this entire patch in BY HAND, or nearly so.",
    "created_at": "2014-12-13T23:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212816",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:25" align="right">comment:25</div>

> OK, once you confirm that the patch is not needed anymore, i will remove it from the branch.

Who confirmed that this was useless?  This will still not work on older Macs - see the **actual note that was in the SPKG.txt**!!!

```
   - patches/buildutils.patch: This patches the file src/buildutils/detect.py.
     It remove the option -arch for gcc which was broken on MacOSX 10.5.8.
     The reason to this is that Sage's gcc spkg does not build a compiler
     which understands the option -arch of Apple's clone of gcc.
     https://groups.google.com/forum/?fromgroups#!topic/sage-devel/CuZNKclprIQ
     https://github.com/sagemath/sage/issues/13313
```
And now that this is standard with all the big changes at the end of 6.4, it breaks some of them.  And since the machine I am currently trying to build Sage on does not have git, nor has git built yet, I will have to type this entire patch in BY HAND, or nearly so.



---

archive/issue_comments_212817.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n> Who confirmed that this was useless?\n\nMe. My machine is a MacOSX 10.5.8. I have read that note in the SPKG. When I did the review, I confirmed that the patch was needed with the earlier spkg but not with the new one which I gave a positive review.\n\nI am sorry for having cause you trouble today. Maybe we should add more documentation in the patch to re-add saying for what machine exactly it is mandatory. Because to me, it is not needed for 10.5.8 anymore.\n\nS\u00e9bastien",
    "created_at": "2014-12-15T14:24:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212817",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:26" align="right">comment:26</div>

> Who confirmed that this was useless?

Me. My machine is a MacOSX 10.5.8. I have read that note in the SPKG. When I did the review, I confirmed that the patch was needed with the earlier spkg but not with the new one which I gave a positive review.

I am sorry for having cause you trouble today. Maybe we should add more documentation in the patch to re-add saying for what machine exactly it is mandatory. Because to me, it is not needed for 10.5.8 anymore.

Sébastien



---

archive/issue_comments_212818.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\n> Me. My machine is a MacOSX 10.5.8. I have read that note in the SPKG. When I did the review, I confirmed that the patch was needed with the earlier spkg but not with the new one which I gave a positive review.\n\nOh!  And indeed if I had been more careful I would have seen that you were responsible for #13313 and so knew what you were talking about.\n> I am sorry for having cause you trouble today. Maybe we should add more documentation in the patch to re-add saying for what machine exactly it is mandatory. Because to me, it is not needed for 10.5.8 anymore.\n\nI apologize also, because I was snippy in my comment.  I had left the machine compiling all night, only to discover this (relatively early) error.\n\nI think that the question is in when they add these flags.  What do you get for\n\n```\nimport platform\nplatform.architecture()\n```\non my Lion computer (10.7) I get `('64bit', '')`.  I will see what I get on my other one.  My guess is that probably Dima's machine was already building a 64-bit Python (see e.g. [the SAGE64 flag](http://www.sagemath.org/doc/installation/source.html)), and that in the meantime maybe your 10.5 computer also is doing that, maybe we are building Python 64-bit by default or you are using `SAGE64='yes'` all the time on that computer? In principle if you don't have the patch but you get `if platform.architecture()[0]=='32bit':` then you should be getting the bad Apple-gcc-only flags.",
    "created_at": "2014-12-15T14:53:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212818",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:27" align="right">comment:27</div>

> Me. My machine is a MacOSX 10.5.8. I have read that note in the SPKG. When I did the review, I confirmed that the patch was needed with the earlier spkg but not with the new one which I gave a positive review.

Oh!  And indeed if I had been more careful I would have seen that you were responsible for #13313 and so knew what you were talking about.
> I am sorry for having cause you trouble today. Maybe we should add more documentation in the patch to re-add saying for what machine exactly it is mandatory. Because to me, it is not needed for 10.5.8 anymore.

I apologize also, because I was snippy in my comment.  I had left the machine compiling all night, only to discover this (relatively early) error.

I think that the question is in when they add these flags.  What do you get for

```
import platform
platform.architecture()
```
on my Lion computer (10.7) I get `('64bit', '')`.  I will see what I get on my other one.  My guess is that probably Dima's machine was already building a 64-bit Python (see e.g. [the SAGE64 flag](http://www.sagemath.org/doc/installation/source.html)), and that in the meantime maybe your 10.5 computer also is doing that, maybe we are building Python 64-bit by default or you are using `SAGE64='yes'` all the time on that computer? In principle if you don't have the patch but you get `if platform.architecture()[0]=='32bit':` then you should be getting the bad Apple-gcc-only flags.



---

archive/issue_comments_212819.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n@kcrisman: I pinged Sebastien on that ticket because he was the author of the patch and i have no mac to test. If there is some problem with some particular version of OSX, i think this is worth opening a new ticket for that issue now, or the information you will provide on the current thread will be less visible there.",
    "created_at": "2014-12-15T15:17:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212819",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<div id="comment:28" align="right">comment:28</div>

@kcrisman: I pinged Sebastien on that ticket because he was the author of the patch and i have no mac to test. If there is some problem with some particular version of OSX, i think this is worth opening a new ticket for that issue now, or the information you will provide on the current thread will be less visible there.



---

archive/issue_comments_212820.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nNaturally, just wanting to confirm before opening a new ticket.  See #17510.",
    "created_at": "2014-12-15T15:21:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212820",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:29" align="right">comment:29</div>

Naturally, just wanting to confirm before opening a new ticket.  See #17510.



---

archive/issue_comments_212821.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nNo problem. I should have thought of adding you in cc of this ticket by the time of the review, since I remember that #13313 was also useful for you.",
    "created_at": "2014-12-15T16:39:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212821",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:30" align="right">comment:30</div>

No problem. I should have thought of adding you in cc of this ticket by the time of the review, since I remember that #13313 was also useful for you.



---

archive/issue_comments_212822.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@kcrisman](#comment:27):\n> > Me. My machine is a MacOSX 10.5.8. I have read that note in the SPKG. When I did the review, I confirmed that the patch was needed with the earlier spkg but not with the new one which I gave a positive review.\n\n> Oh!  And indeed if I had been more careful I would have seen that you were responsible for #13313 and so knew what you were talking about.\n> > I am sorry for having cause you trouble today. Maybe we should add more documentation in the patch to re-add saying for what machine exactly it is mandatory. Because to me, it is not needed for 10.5.8 anymore.\n\n> I apologize also, because I was snippy in my comment.  I had left the machine compiling all night, only to discover this (relatively early) error.\n> \n> I think that the question is in when they add these flags.  What do you get for\n> \n> ```\n> import platform\n> platform.architecture()\n> ```\n> on my Lion computer (10.7) I get `('64bit', '')`.  I will see what I get on my other one.  My guess is that probably Dima's machine was already building a 64-bit Python (see e.g. [the SAGE64 flag](http://www.sagemath.org/doc/installation/source.html)), and that in the meantime maybe your 10.5 computer also is doing that, maybe we are building Python 64-bit by default or you are using `SAGE64='yes'` all the time on that computer?\n\nWhen I reported that (cf the link to sage-devel in #13313) I tried that on an PPC OSX 10.5.8 machine, which is 32-bit all the way. I don't think I did build anything with SAGE64.",
    "created_at": "2014-12-15T21:28:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16455",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16455#issuecomment-212822",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@kcrisman](#comment:27):
> > Me. My machine is a MacOSX 10.5.8. I have read that note in the SPKG. When I did the review, I confirmed that the patch was needed with the earlier spkg but not with the new one which I gave a positive review.

> Oh!  And indeed if I had been more careful I would have seen that you were responsible for #13313 and so knew what you were talking about.
> > I am sorry for having cause you trouble today. Maybe we should add more documentation in the patch to re-add saying for what machine exactly it is mandatory. Because to me, it is not needed for 10.5.8 anymore.

> I apologize also, because I was snippy in my comment.  I had left the machine compiling all night, only to discover this (relatively early) error.
> 
> I think that the question is in when they add these flags.  What do you get for
> 
> ```
> import platform
> platform.architecture()
> ```
> on my Lion computer (10.7) I get `('64bit', '')`.  I will see what I get on my other one.  My guess is that probably Dima's machine was already building a 64-bit Python (see e.g. [the SAGE64 flag](http://www.sagemath.org/doc/installation/source.html)), and that in the meantime maybe your 10.5 computer also is doing that, maybe we are building Python 64-bit by default or you are using `SAGE64='yes'` all the time on that computer?

When I reported that (cf the link to sage-devel in #13313) I tried that on an PPC OSX 10.5.8 machine, which is 32-bit all the way. I don't think I did build anything with SAGE64.
