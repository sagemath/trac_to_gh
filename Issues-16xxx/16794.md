# Issue 16794: Circular dependencies: patch : bzip2 : pkgconf

archive/issues_016557.json:
```json
{
    "body": "This usually doesn't surface since pretty much everybody has patch installed already, but:\n* patch requires bzip2\n* bzip2 requires pkgconf\n* pkgconf uses patch to apply a patch (currently this dependency is not known to the Sage build system in `build/deps`)\n\nPatch gzip tarball: ftp://ftp.gnu.org/gnu/patch/patch-2.7.1.tar.gz\n\nBranch/Commit: e66c236347131cf8e0489f4cd16c2f0fbe948af3\n\nReviewer: Jeroen Demeyer\n\nAuthor: Volker Braun\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16794\n\n",
    "closed_at": "2014-08-13T17:06:38Z",
    "created_at": "2014-08-10T22:34:54Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Circular dependencies: patch : bzip2 : pkgconf",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16794",
    "user": "https://github.com/vbraun"
}
```
This usually doesn't surface since pretty much everybody has patch installed already, but:
* patch requires bzip2
* bzip2 requires pkgconf
* pkgconf uses patch to apply a patch (currently this dependency is not known to the Sage build system in `build/deps`)

Patch gzip tarball: ftp://ftp.gnu.org/gnu/patch/patch-2.7.1.tar.gz

Branch/Commit: e66c236347131cf8e0489f4cd16c2f0fbe948af3

Reviewer: Jeroen Demeyer

Author: Volker Braun

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16794





---

archive/issue_comments_279775.json:
```json
{
    "body": "<a id='comment:1'></a>The solution seems to be to distribute patch as gzipped tarball (not: bzip2) and remove this dependency, and add the dependency of pkgconf on patch instead.",
    "created_at": "2014-08-10T22:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279775",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:1'></a>The solution seems to be to distribute patch as gzipped tarball (not: bzip2) and remove this dependency, and add the dependency of pkgconf on patch instead.



---

archive/issue_comments_279776.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,8 @@\n * patch requires bzip2\n * bzip2 requires pkgconf\n * pkgconf uses patch to apply a patch (currently this dependency is not known to the Sage build system in `build/deps`)\n+\n+Patch gzip tarball: ftp://ftp.gnu.org/gnu/patch/patch-2.7.tar.gz\n \n Comment: 1\n \n``````\n",
    "created_at": "2014-08-10T22:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279776",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,8 @@
 * patch requires bzip2
 * bzip2 requires pkgconf
 * pkgconf uses patch to apply a patch (currently this dependency is not known to the Sage build system in `build/deps`)
+
+Patch gzip tarball: ftp://ftp.gnu.org/gnu/patch/patch-2.7.tar.gz
 
 Comment: 1
 
``````




---

archive/issue_comments_279777.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,9 @@\n+This usually doesn't surface since pretty much everybody has patch installed already, but:\n+* patch requires bzip2\n+* bzip2 requires pkgconf\n+* pkgconf uses patch to apply a patch (currently this dependency is not known to the Sage build system in `build/deps`)\n \n+Patch gzip tarball: ftp://ftp.gnu.org/gnu/patch/patch-2.7.1.tar.gz\n \n Comment: 1\n \n``````\n",
    "created_at": "2014-08-10T22:42:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279777",
    "user": "https://github.com/vbraun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,9 @@
+This usually doesn't surface since pretty much everybody has patch installed already, but:
+* patch requires bzip2
+* bzip2 requires pkgconf
+* pkgconf uses patch to apply a patch (currently this dependency is not known to the Sage build system in `build/deps`)
 
+Patch gzip tarball: ftp://ftp.gnu.org/gnu/patch/patch-2.7.1.tar.gz
 
 Comment: 1
 
``````




---

archive/issue_comments_279778.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vbraun/circular_dependencies\"",
    "created_at": "2014-08-10T22:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279778",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "" to "u/vbraun/circular_dependencies"



---

archive/issue_comments_279779.json:
```json
{
    "body": "Changing author from \"\" to \"Volker Braun\"",
    "created_at": "2014-08-10T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279779",
    "user": "https://github.com/vbraun"
}
```

Changing author from "" to "Volker Braun"



---

archive/issue_comments_279780.json:
```json
{
    "body": "Changing commit from \"\" to \"7883bdc822e8a8704cf9629f4326567ee838d471\"",
    "created_at": "2014-08-10T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279780",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "" to "7883bdc822e8a8704cf9629f4326567ee838d471"



---

archive/issue_comments_279781.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-10T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279781",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_279782.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2014-08-10T22:49:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279782",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_279783.json:
```json
{
    "body": "Changing commit from \"7883bdc822e8a8704cf9629f4326567ee838d471\" to \"e38b2d387016ea7d8381d9043349001cf26da8b4\"",
    "created_at": "2014-08-11T11:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279783",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7883bdc822e8a8704cf9629f4326567ee838d471" to "e38b2d387016ea7d8381d9043349001cf26da8b4"



---

archive/issue_comments_279784.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-11T11:00:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279784",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_279785.json:
```json
{
    "body": "Changing commit from \"e38b2d387016ea7d8381d9043349001cf26da8b4\" to \"e66c236347131cf8e0489f4cd16c2f0fbe948af3\"",
    "created_at": "2014-08-11T11:06:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279785",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e38b2d387016ea7d8381d9043349001cf26da8b4" to "e66c236347131cf8e0489f4cd16c2f0fbe948af3"



---

archive/issue_comments_279786.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-08-11T11:06:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279786",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_279787.json:
```json
{
    "body": "<a id='comment:8'></a>The pyparsing sources have DOS line endings, ughh..",
    "created_at": "2014-08-11T11:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279787",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>The pyparsing sources have DOS line endings, ughh..



---

archive/issue_comments_279788.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2014-08-11T14:27:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279788",
    "user": "https://github.com/vbraun"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_279789.json:
```json
{
    "body": "<a id='comment:10'></a>Should bzip2 even be a package anymore? I always thought that we included it for compressing and decompressing `.spkg` files. Now with the new packaging system (although there are some old-style optional and experimental packages still), not to mention the fact that bzip2 is pretty standard, can we just get rid of it?",
    "created_at": "2014-08-11T15:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279789",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:10'></a>Should bzip2 even be a package anymore? I always thought that we included it for compressing and decompressing `.spkg` files. Now with the new packaging system (although there are some old-style optional and experimental packages still), not to mention the fact that bzip2 is pretty standard, can we just get rid of it?



---

archive/issue_comments_279790.json:
```json
{
    "body": "<a id='comment:11'></a>There are still bzip2-compressed tarballs. We can certainly discuss adding it as a host dependency on another ticket...",
    "created_at": "2014-08-11T16:56:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279790",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:11'></a>There are still bzip2-compressed tarballs. We can certainly discuss adding it as a host dependency on another ticket...



---

archive/issue_comments_279791.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2014-08-13T10:16:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279791",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_279792.json:
```json
{
    "body": "<a id='comment:13'></a>What's the reason for upgrading `patch`? Have you tested this well on the buildbots? I remember lots of portability trouble with `patch-2.6.x`, that's the reason why we never upgraded before.\n\nThe changes to `build/deps` look good to me.",
    "created_at": "2014-08-13T10:25:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279792",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>What's the reason for upgrading `patch`? Have you tested this well on the buildbots? I remember lots of portability trouble with `patch-2.6.x`, that's the reason why we never upgraded before.

The changes to `build/deps` look good to me.



---

archive/issue_comments_279793.json:
```json
{
    "body": "<a id='comment:14'></a>I haven't tried, but I will anyway when merging the ticket. It seems a bit redundant to do it twice.\n\nSince we don't have a solaris buildbot any more its probably fine. I upgraded patch since I think there will be problem with the build system if tarballs only differ by extension, haven't tried to find out exactly what might break though.",
    "created_at": "2014-08-13T10:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279793",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>I haven't tried, but I will anyway when merging the ticket. It seems a bit redundant to do it twice.

Since we don't have a solaris buildbot any more its probably fine. I upgraded patch since I think there will be problem with the build system if tarballs only differ by extension, haven't tried to find out exactly what might break though.



---

archive/issue_comments_279794.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-13T11:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279794",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_279795.json:
```json
{
    "body": "<a id='comment:15'></a>OK, I'm giving it the benefit of the doubt...",
    "created_at": "2014-08-13T11:04:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279795",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>OK, I'm giving it the benefit of the doubt...



---

archive/issue_comments_279796.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-13T17:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279796",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_279797.json:
```json
{
    "body": "Changing branch from \"u/vbraun/circular_dependencies\" to \"e66c236347131cf8e0489f4cd16c2f0fbe948af3\"",
    "created_at": "2014-08-13T17:06:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16794#issuecomment-279797",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vbraun/circular_dependencies" to "e66c236347131cf8e0489f4cd16c2f0fbe948af3"



---

archive/issue_events_049160.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-13T17:06:38Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16794",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16794#event-49160"
}
```
