# Issue 16374: better two_squares, three_squares, four_squares for small input

archive/issues_016137.json:
```json
{
    "assignees": [],
    "body": "We implement a much more efficient version of square decomposition for small values.\n\nCC:  @nathanncohen @jdemeyer @nexttime\n\nComponent: **number theory**\n\nAuthor: **Vincent Delecroix**\n\nBranch/Commit: **[`51e36d8`](https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e)**\n\nReviewer: **Jeroen Demeyer, Leif Leonhardy,  \u200bNathann Cohen**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16374_\n\n",
    "closed_at": "2014-06-08T12:09:04Z",
    "created_at": "2014-05-17T19:27:43Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "better two_squares, three_squares, four_squares for small input",
    "type": "issue",
    "updated_at": "2014-06-08T12:09:04Z",
    "url": "https://github.com/sagemath/sage/issues/16374",
    "user": "https://github.com/videlec"
}
```
We implement a much more efficient version of square decomposition for small values.

CC:  @nathanncohen @jdemeyer @nexttime

Component: **number theory**

Author: **Vincent Delecroix**

Branch/Commit: **[`51e36d8`](https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e)**

Reviewer: **Jeroen Demeyer, Leif Leonhardy,  â€‹Nathann Cohen**

_Issue created by migration from https://trac.sagemath.org/ticket/16374_





---

archive/issue_events_231804.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-17T19:27:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231804"
}
```



---

archive/issue_events_231805.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-17T19:27:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "c: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231805"
}
```



---

archive/issue_events_231806.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-17T19:27:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231806"
}
```



---

archive/issue_events_231807.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-17T19:27:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231807"
}
```



---

archive/issue_comments_211194.json:
```json
{
    "body": "Branch: **[u/vdelecroix/16374](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16374)**",
    "created_at": "2014-05-17T19:37:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211194",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/16374](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16374)**



---

archive/issue_comments_211195.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nHi,\n\nI implemented a much better version than my proposal in #16308 (linear complexity in the input for `two_squares_pyx`). It is not yet branched in `arith.py`, I will do this when #16308 is merged.\n\ntimings:\n\n```\nsage: from sage.rings.arith_pyx import four_squares_pyx\nsage: timeit(\"for n in xrange(10000,50000): x = four_squares_pyx(n)\")\n5 loops, best of 3: 46 ms per loop\n```\n\nBest\nVincent\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7cf5fff24e77135cc00032a7347d4e5a6402324b\"><code>7cf5fff</code></a></td><td><code>trac #16374: new file arith_pyx.pyx</code></td></tr></table>\n",
    "created_at": "2014-05-17T19:37:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211195",
    "user": "https://github.com/videlec"
}
```

<div id="comment:1" align="right">comment:1</div>

Hi,

I implemented a much better version than my proposal in #16308 (linear complexity in the input for `two_squares_pyx`). It is not yet branched in `arith.py`, I will do this when #16308 is merged.

timings:

```
sage: from sage.rings.arith_pyx import four_squares_pyx
sage: timeit("for n in xrange(10000,50000): x = four_squares_pyx(n)")
5 loops, best of 3: 46 ms per loop
```

Best
Vincent

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7cf5fff24e77135cc00032a7347d4e5a6402324b"><code>7cf5fff</code></a></td><td><code>trac #16374: new file arith_pyx.pyx</code></td></tr></table>




---

archive/issue_comments_211196.json:
```json
{
    "body": "Commit: **[`7cf5fff`](https://github.com/sagemath/sagetrac-mirror/commit/7cf5fff24e77135cc00032a7347d4e5a6402324b)**",
    "created_at": "2014-05-17T19:37:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211196",
    "user": "https://github.com/videlec"
}
```

Commit: **[`7cf5fff`](https://github.com/sagemath/sagetrac-mirror/commit/7cf5fff24e77135cc00032a7347d4e5a6402324b)**



---

archive/issue_comments_211197.json:
```json
{
    "body": "Changed commit from **[`7cf5fff`](https://github.com/sagemath/sagetrac-mirror/commit/7cf5fff24e77135cc00032a7347d4e5a6402324b)** to **[`f1354e6`](https://github.com/sagemath/sagetrac-mirror/commit/f1354e68519feecd5de198c10a532b89ee938a7b)**",
    "created_at": "2014-05-17T22:18:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211197",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7cf5fff`](https://github.com/sagemath/sagetrac-mirror/commit/7cf5fff24e77135cc00032a7347d4e5a6402324b)** to **[`f1354e6`](https://github.com/sagemath/sagetrac-mirror/commit/f1354e68519feecd5de198c10a532b89ee938a7b)**



---

archive/issue_comments_211198.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f1354e68519feecd5de198c10a532b89ee938a7b\"><code>f1354e6</code></a></td><td><code>trac #16374: two small optimization</code></td></tr></table>\n",
    "created_at": "2014-05-17T22:18:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211198",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f1354e68519feecd5de198c10a532b89ee938a7b"><code>f1354e6</code></a></td><td><code>trac #16374: two small optimization</code></td></tr></table>




---

archive/issue_comments_211199.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHello !\n\nI added a commit in u/ncohen/16374 which contains some tests and comments.\n\nI have two questions to ask though :\n\n- Why `ii <= n/2` and not `ii<=jj` ?\n\n- Why a \"while\" instead of a \"if\" in the following code ?\n\n```\n    j = (<unsigned int> sqrt(<double> n)) + 1 # (rounding is toward zero)\n    while j*j > n:\n        j -= 1\n```\n\nBesides, there is a way to avoid many multiplications, and **perhaps** it can improve the code a bit (no idea, profiling is the only way `:-P`)\n\n```\nsage: i = 5    \nsage: ii = i**2\nsage: i**2 == ii\nTrue\nsage: ii+=2*i+1\nsage: i+=1\nsage: i**2 == ii\nTrue\n```\n\nNathann",
    "created_at": "2014-05-18T10:43:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211199",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:3" align="right">comment:3</div>

Hello !

I added a commit in u/ncohen/16374 which contains some tests and comments.

I have two questions to ask though :

- Why `ii <= n/2` and not `ii<=jj` ?

- Why a "while" instead of a "if" in the following code ?

```
    j = (<unsigned int> sqrt(<double> n)) + 1 # (rounding is toward zero)
    while j*j > n:
        j -= 1
```

Besides, there is a way to avoid many multiplications, and **perhaps** it can improve the code a bit (no idea, profiling is the only way `:-P`)

```
sage: i = 5    
sage: ii = i**2
sage: i**2 == ii
True
sage: ii+=2*i+1
sage: i+=1
sage: i**2 == ii
True
```

Nathann



---

archive/issue_events_231808.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-05-18T10:43:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231808"
}
```



---

archive/issue_comments_211200.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHi Nathann,\n\nThanks for reading it.\n\n> I added a commit in u/ncohen/16374 which contains some tests and comments.\n\nGreat. I also have something important to modify in `three_squares_pyx` and `four_squares_pyx`. It is **much** faster to first remove a huge square and then try to decompose the rest into a sum of less squares. The result is not the smallest for lexicographical order but the timings are x4 better.\n\nIt seems that you like C function declaration of the form `int f(int res[3])`. It makes the specifications clearer but at compilation the results are strictly equivalent.\n \n> I have two questions to ask though :\n> \n> - Why `ii <= n/2` and not `ii<=jj` ?\n\nRight.\n\n> - Why a \"while\" instead of a \"if\" in the following code ?\n> \n> ```\n>     j = (<unsigned int> sqrt(<double> n)) + 1 # (rounding is toward zero)\n>     while j*j > n:\n>         j -= 1\n> ```\n\nI am not sure of the specification (if any) of `sqrt` which deals with double... I will try to improve it.\n\n> Besides, there is a way to avoid many multiplications, and **perhaps** it can improve the code a bit (no idea, profiling is the only way `:-P`)\n\nI thought about it. I am not sure that `ii += 2*i + 1` is cheaper than `ii = i*i` ? Will have a look.\n\nVincent",
    "created_at": "2014-05-18T20:19:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211200",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

Hi Nathann,

Thanks for reading it.

> I added a commit in u/ncohen/16374 which contains some tests and comments.

Great. I also have something important to modify in `three_squares_pyx` and `four_squares_pyx`. It is **much** faster to first remove a huge square and then try to decompose the rest into a sum of less squares. The result is not the smallest for lexicographical order but the timings are x4 better.

It seems that you like C function declaration of the form `int f(int res[3])`. It makes the specifications clearer but at compilation the results are strictly equivalent.
 
> I have two questions to ask though :
> 
> - Why `ii <= n/2` and not `ii<=jj` ?

Right.

> - Why a "while" instead of a "if" in the following code ?
> 
> ```
>     j = (<unsigned int> sqrt(<double> n)) + 1 # (rounding is toward zero)
>     while j*j > n:
>         j -= 1
> ```

I am not sure of the specification (if any) of `sqrt` which deals with double... I will try to improve it.

> Besides, there is a way to avoid many multiplications, and **perhaps** it can improve the code a bit (no idea, profiling is the only way `:-P`)

I thought about it. I am not sure that `ii += 2*i + 1` is cheaper than `ii = i*i` ? Will have a look.

Vincent



---

archive/issue_comments_211201.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a2b31ca5ec86eaed275a854e41cb5fd7a3ce5c95\"><code>a2b31ca</code></a></td><td><code>trac #16374: reviewer comment + further optimization</code></td></tr></table>\n",
    "created_at": "2014-05-19T09:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211201",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a2b31ca5ec86eaed275a854e41cb5fd7a3ce5c95"><code>a2b31ca</code></a></td><td><code>trac #16374: reviewer comment + further optimization</code></td></tr></table>




---

archive/issue_comments_211202.json:
```json
{
    "body": "Changed commit from **[`f1354e6`](https://github.com/sagemath/sagetrac-mirror/commit/f1354e68519feecd5de198c10a532b89ee938a7b)** to **[`a2b31ca`](https://github.com/sagemath/sagetrac-mirror/commit/a2b31ca5ec86eaed275a854e41cb5fd7a3ce5c95)**",
    "created_at": "2014-05-19T09:45:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211202",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f1354e6`](https://github.com/sagemath/sagetrac-mirror/commit/f1354e68519feecd5de198c10a532b89ee938a7b)** to **[`a2b31ca`](https://github.com/sagemath/sagetrac-mirror/commit/a2b31ca5ec86eaed275a854e41cb5fd7a3ce5c95)**



---

archive/issue_events_231809.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-19T09:50:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231809"
}
```



---

archive/issue_events_231810.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-19T09:50:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231810"
}
```



---

archive/issue_comments_211203.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHi,\n\nI confirm that there is no difference between \"ii = i*i\" and \"ii -= 2*i + 1\". Anyway, I am pretty sure that this is the kind of optimization that gcc takes care of with the option \"-O3\". In the new commit there are the modifications relative to your comment and mine.\n\nNew timings\n\n```\nsage: from sage.rings.arith_pyx import four_squares_pyx\nsage: timeit(\"for n in xrange(10000,50000): x = four_squares_pyx(n)\")\n25 loops, best of 3: 11.3 ms per loop\n```\n\nAbout the dependencies, I am not sure whether this ticket should go before or after #16308...\n\nVincent",
    "created_at": "2014-05-19T09:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211203",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

Hi,

I confirm that there is no difference between "ii = i*i" and "ii -= 2*i + 1". Anyway, I am pretty sure that this is the kind of optimization that gcc takes care of with the option "-O3". In the new commit there are the modifications relative to your comment and mine.

New timings

```
sage: from sage.rings.arith_pyx import four_squares_pyx
sage: timeit("for n in xrange(10000,50000): x = four_squares_pyx(n)")
25 loops, best of 3: 11.3 ms per loop
```

About the dependencies, I am not sure whether this ticket should go before or after #16308...

Vincent



---

archive/issue_comments_211204.json:
```json
{
    "body": "Changed dependencies from **#16308** to none",
    "created_at": "2014-05-19T10:02:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211204",
    "user": "https://github.com/videlec"
}
```

Changed dependencies from **#16308** to none



---

archive/issue_comments_211205.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nInstead of adding a new module `arith_pyx`, either\n1. Rename this module such that it explicitly refers to sums of squares.\n2. Use `fast_arith.pyx` instead.",
    "created_at": "2014-05-19T10:12:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211205",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

Instead of adding a new module `arith_pyx`, either
1. Rename this module such that it explicitly refers to sums of squares.
2. Use `fast_arith.pyx` instead.



---

archive/issue_comments_211206.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@videlec](#comment%3A7):\n> Anyway, I am pretty sure that this is the kind of optimization that gcc takes care of with the option \"-O3\".\n\nSure, write the most readable code and let the compiler do its job.\n\n> About the dependencies, I am not sure whether this ticket should go before or after #16308...\n\nEven better: make these two tickets independent and then make a third ticket to integrate them.",
    "created_at": "2014-05-19T10:22:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211206",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@videlec](#comment%3A7):
> Anyway, I am pretty sure that this is the kind of optimization that gcc takes care of with the option "-O3".

Sure, write the most readable code and let the compiler do its job.

> About the dependencies, I am not sure whether this ticket should go before or after #16308...

Even better: make these two tickets independent and then make a third ticket to integrate them.



---

archive/issue_comments_211207.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI would recommend to use `unsigned long` instead of `instead int`. If could imagine that the sum of 4 squares function is useful for numbers larger than `2^32`.\n\nAlso a typo: `plateform` -> `platform`",
    "created_at": "2014-05-19T10:26:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211207",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

I would recommend to use `unsigned long` instead of `instead int`. If could imagine that the sum of 4 squares function is useful for numbers larger than `2^32`.

Also a typo: `plateform` -> `platform`



---

archive/issue_events_231811.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-05-19T10:26:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231811"
}
```



---

archive/issue_events_231812.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-05-19T10:26:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231812"
}
```



---

archive/issue_comments_211208.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@jdemeyer](#comment%3A11):\n> I would recommend to use `unsigned long` instead of `instead int`. If could imagine that the sum of 4 squares function is useful for numbers larger than `2^32`.\n\nOf course. But for large entries, we would better use the `*_squares` from #16308. I will do some timings, but if we loose something on small integers I will not change it.\n\n> Also a typo: `plateform` -> `platform`\n\nThank you. I will modify it.",
    "created_at": "2014-05-19T10:41:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211208",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@jdemeyer](#comment%3A11):
> I would recommend to use `unsigned long` instead of `instead int`. If could imagine that the sum of 4 squares function is useful for numbers larger than `2^32`.

Of course. But for large entries, we would better use the `*_squares` from #16308. I will do some timings, but if we loose something on small integers I will not change it.

> Also a typo: `plateform` -> `platform`

Thank you. I will modify it.



---

archive/issue_comments_211209.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nWhat's the point of `<unsigned int> sqrt(<double> n + .5)`? Are you worried that the libm `sqrt` function does not round correctly? I believe that IEEE-754 requires this.",
    "created_at": "2014-05-19T10:42:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211209",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

What's the point of `<unsigned int> sqrt(<double> n + .5)`? Are you worried that the libm `sqrt` function does not round correctly? I believe that IEEE-754 requires this.



---

archive/issue_comments_211210.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@jdemeyer](#comment%3A13):\n> What's the point of `<unsigned int> sqrt(<double> n + .5)`? Are you worried that the libm `sqrt` function does not round correctly? I believe that IEEE-754 requires this.\n\nI believe it is in IEEE-754, but I am not sure that all compilers follow IEEE-754. You think it is safe to remove this `.5` ?",
    "created_at": "2014-05-19T10:48:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211210",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@jdemeyer](#comment%3A13):
> What's the point of `<unsigned int> sqrt(<double> n + .5)`? Are you worried that the libm `sqrt` function does not round correctly? I believe that IEEE-754 requires this.

I believe it is in IEEE-754, but I am not sure that all compilers follow IEEE-754. You think it is safe to remove this `.5` ?



---

archive/issue_comments_211211.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@videlec](#comment%3A14):\n> I believe it is in IEEE-754, but I am not sure that all compilers follow IEEE-754. You think it is safe to remove this `.5` ?\n\nIt is certainly not a compiler issue, but a `libm`/hardware issue. I would expect IEEE-754 and would remove the `+ 0.5`.",
    "created_at": "2014-05-19T11:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211211",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@videlec](#comment%3A14):
> I believe it is in IEEE-754, but I am not sure that all compilers follow IEEE-754. You think it is safe to remove this `.5` ?

It is certainly not a compiler issue, but a `libm`/hardware issue. I would expect IEEE-754 and would remove the `+ 0.5`.



---

archive/issue_comments_211212.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@jdemeyer](#comment%3A15):\n> Replying to [@videlec](#comment%3A14):\n> > I believe it is in IEEE-754, but I am not sure that all compilers follow IEEE-754. You think it is safe to remove this `.5` ?\n\n> \n> It is certainly not a compiler issue, but a `libm`/hardware issue. I would expect IEEE-754 and would remove the `+ 0.5`.\n\nYes.  Integers up to 2<sup>53</sup>-1 can be represented *exactly* in a `double`, at least on the plat[e]forms we support.\n\nI like the type `instead int` btw. (Google would have asked: *\"Did you mean `instant int`?\"*, or probably *\"`insteady int`\"*?)\n\nRegarding that, I'd write versions for / using integers of known, platform-independent width, that is, use `uint8_t`, `uint16_t`, `uint32_t` etc., with a wrapper function that delegates to the appropriate function, or use if-then-elif-else such that the compiler is aware of the exact range of numbers.  (Separate functions could more easily be checked for overflow conditions as well.)",
    "created_at": "2014-05-19T20:04:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211212",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@jdemeyer](#comment%3A15):
> Replying to [@videlec](#comment%3A14):
> > I believe it is in IEEE-754, but I am not sure that all compilers follow IEEE-754. You think it is safe to remove this `.5` ?

> 
> It is certainly not a compiler issue, but a `libm`/hardware issue. I would expect IEEE-754 and would remove the `+ 0.5`.

Yes.  Integers up to 2<sup>53</sup>-1 can be represented *exactly* in a `double`, at least on the plat[e]forms we support.

I like the type `instead int` btw. (Google would have asked: *"Did you mean `instant int`?"*, or probably *"`insteady int`"*?)

Regarding that, I'd write versions for / using integers of known, platform-independent width, that is, use `uint8_t`, `uint16_t`, `uint32_t` etc., with a wrapper function that delegates to the appropriate function, or use if-then-elif-else such that the compiler is aware of the exact range of numbers.  (Separate functions could more easily be checked for overflow conditions as well.)



---

archive/issue_comments_211213.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@videlec](#comment%3A7):\n> I confirm that there is no difference between \"ii = i*i\" and \"ii -= 2*i + 1\".\n\nThere of course is; just look at what the (C) compiler produces from it.  (I don't know what Cython itself does; it may optimize it, but may also further obfuscate the code.)\n\nOn older machines, presumably any 32-bit processor [we support], multiplication (or squaring) is more expensive than addition, increment, and/or a shift.  (And its cost depends on the number of 1-bits in the multiplicands.)\n\n> Anyway, I am pretty sure that this is the kind of optimization that gcc takes care of with the option \"-O3\".\n\nNope, you have to be more explicit.  It of course does some strength reduction, e.g. replacing multiplication/division by powers of two by shifts, additions or nice addressing modes etc., but you cannot expect it to run a theorem prover... ;-)",
    "created_at": "2014-05-19T20:44:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211213",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@videlec](#comment%3A7):
> I confirm that there is no difference between "ii = i*i" and "ii -= 2*i + 1".

There of course is; just look at what the (C) compiler produces from it.  (I don't know what Cython itself does; it may optimize it, but may also further obfuscate the code.)

On older machines, presumably any 32-bit processor [we support], multiplication (or squaring) is more expensive than addition, increment, and/or a shift.  (And its cost depends on the number of 1-bits in the multiplicands.)

> Anyway, I am pretty sure that this is the kind of optimization that gcc takes care of with the option "-O3".

Nope, you have to be more explicit.  It of course does some strength reduction, e.g. replacing multiplication/division by powers of two by shifts, additions or nice addressing modes etc., but you cannot expect it to run a theorem prover... ;-)



---

archive/issue_comments_211214.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b1421fef125d5498b474b28172d244971223f32\"><code>5b1421f</code></a></td><td><code>trac #16374: rename arith_pyx.pyx into sum_of_squares.pyx</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/352e255834a35c951f8bf22a6161df8cef56e51a\"><code>352e255</code></a></td><td><code>trac #16374: unsigned int -> unsigned long</code></td></tr></table>\n",
    "created_at": "2014-05-19T21:55:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211214",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b1421fef125d5498b474b28172d244971223f32"><code>5b1421f</code></a></td><td><code>trac #16374: rename arith_pyx.pyx into sum_of_squares.pyx</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/352e255834a35c951f8bf22a6161df8cef56e51a"><code>352e255</code></a></td><td><code>trac #16374: unsigned int -> unsigned long</code></td></tr></table>




---

archive/issue_comments_211215.json:
```json
{
    "body": "Changed commit from **[`a2b31ca`](https://github.com/sagemath/sagetrac-mirror/commit/a2b31ca5ec86eaed275a854e41cb5fd7a3ce5c95)** to **[`352e255`](https://github.com/sagemath/sagetrac-mirror/commit/352e255834a35c951f8bf22a6161df8cef56e51a)**",
    "created_at": "2014-05-19T21:55:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211215",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a2b31ca`](https://github.com/sagemath/sagetrac-mirror/commit/a2b31ca5ec86eaed275a854e41cb5fd7a3ce5c95)** to **[`352e255`](https://github.com/sagemath/sagetrac-mirror/commit/352e255834a35c951f8bf22a6161df8cef56e51a)**



---

archive/issue_comments_211216.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nHi,\n\nThe file is now `sum_of_squares.pyx`.\n\nI changed the `unsigned int` to `unsigned long` as Jeroen suggested. The loss in terms of timing seems to be around 1% (see below). Nevertheless, the function makes no sense for very large input as it is much faster to called the Python function from `arith` (see also below).\n\nFor the rounding issue with `sqrt`, it uses now `<unsigned long> sqrt(<double> n)` and there is an exhaustive test in the doc of the function `two_squares_pyx`.\n\nunsigned int\n\n```\nsage: from sage.rings.sum_of_squares import four_squares_pyx\nsage: timeit(\"for n in xrange(10000,50000): x = four_squares_pyx(n)\")\n25 loops, best of 3: 11 ms per loop\n```\n\nunsigned long\n\n```\nsage: from sage.rings.sum_of_squares import four_squares_pyx\nsage: timeit(\"for n in xrange(10000,50000): x = four_squares_pyx(n)\")\n25 loops, best of 3: 11.3 ms per loop\n```\n\nVery large input\n\n```\nsage: from sage.rings.sum_of_squares import two_squares_pyx\nsage: %timeit two_squares_pyx(2**51+21)\n10 loops, best of 3: 88.1 ms per loop\nsage: %timeit two_squares(2**51+21)\n1000 loops, best of 3: 1.04 ms per loop\n```\n\nVincent",
    "created_at": "2014-05-19T21:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211216",
    "user": "https://github.com/videlec"
}
```

<div id="comment:19" align="right">comment:19</div>

Hi,

The file is now `sum_of_squares.pyx`.

I changed the `unsigned int` to `unsigned long` as Jeroen suggested. The loss in terms of timing seems to be around 1% (see below). Nevertheless, the function makes no sense for very large input as it is much faster to called the Python function from `arith` (see also below).

For the rounding issue with `sqrt`, it uses now `<unsigned long> sqrt(<double> n)` and there is an exhaustive test in the doc of the function `two_squares_pyx`.

unsigned int

```
sage: from sage.rings.sum_of_squares import four_squares_pyx
sage: timeit("for n in xrange(10000,50000): x = four_squares_pyx(n)")
25 loops, best of 3: 11 ms per loop
```

unsigned long

```
sage: from sage.rings.sum_of_squares import four_squares_pyx
sage: timeit("for n in xrange(10000,50000): x = four_squares_pyx(n)")
25 loops, best of 3: 11.3 ms per loop
```

Very large input

```
sage: from sage.rings.sum_of_squares import two_squares_pyx
sage: %timeit two_squares_pyx(2**51+21)
10 loops, best of 3: 88.1 ms per loop
sage: %timeit two_squares(2**51+21)
1000 loops, best of 3: 1.04 ms per loop
```

Vincent



---

archive/issue_events_231813.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-19T21:56:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231813"
}
```



---

archive/issue_events_231814.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-05-19T21:56:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231814"
}
```



---

archive/issue_comments_211217.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI wouldn't call 2<sup>51</sup>+21 \"very large\", at least not if the functions now take `unsigned long` s.  (Ok, on most of current machines that exceeds an `unsigned int`.)\n\nWhile we're at it, if `n` is `unsigned long`, you should take `(unsigned long)sqrtl((long double)n)`, otherwise you'd probably have to add 1 to the result in case `n` is a perfect square or slightly above.  (On 32-bit machines, where `unsigned long`s are only 32-bit as well, that doesn't matter.)",
    "created_at": "2014-05-19T23:20:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211217",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:20" align="right">comment:20</div>

I wouldn't call 2<sup>51</sup>+21 "very large", at least not if the functions now take `unsigned long` s.  (Ok, on most of current machines that exceeds an `unsigned int`.)

While we're at it, if `n` is `unsigned long`, you should take `(unsigned long)sqrtl((long double)n)`, otherwise you'd probably have to add 1 to the result in case `n` is a perfect square or slightly above.  (On 32-bit machines, where `unsigned long`s are only 32-bit as well, that doesn't matter.)



---

archive/issue_comments_211218.json:
```json
{
    "body": "Changed commit from **[`352e255`](https://github.com/sagemath/sagetrac-mirror/commit/352e255834a35c951f8bf22a6161df8cef56e51a)** to **[`17883e3`](https://github.com/sagemath/sagetrac-mirror/commit/17883e34f96f7f78f35f56bad527dcbaa728169d)**",
    "created_at": "2014-05-20T06:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211218",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`352e255`](https://github.com/sagemath/sagetrac-mirror/commit/352e255834a35c951f8bf22a6161df8cef56e51a)** to **[`17883e3`](https://github.com/sagemath/sagetrac-mirror/commit/17883e34f96f7f78f35f56bad527dcbaa728169d)**



---

archive/issue_comments_211219.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17883e34f96f7f78f35f56bad527dcbaa728169d\"><code>17883e3</code></a></td><td><code>trac #16374: replace sqrt by sqrtl</code></td></tr></table>\n",
    "created_at": "2014-05-20T06:13:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211219",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17883e34f96f7f78f35f56bad527dcbaa728169d"><code>17883e3</code></a></td><td><code>trac #16374: replace sqrt by sqrtl</code></td></tr></table>




---

archive/issue_comments_211220.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@nexttime](#comment%3A20):\n> I wouldn't call 2<sup>51</sup>+21 \"very large\", at least not if the functions now take `unsigned long` s.  (Ok, on most of current machines that exceeds an `unsigned int`.)\n\nVery large meant \"the function is no more efficient with such input\".\n \n> While we're at it, if `n` is `unsigned long`, you should take `(unsigned long)sqrtl((long double)n)`, otherwise you'd probably have to add 1 to the result in case `n` is a perfect square or slightly above.  (On 32-bit machines, where `unsigned long`s are only 32-bit as well, that doesn't matter.)\n\nDone.\n\nVincent",
    "created_at": "2014-05-20T06:13:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211220",
    "user": "https://github.com/videlec"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@nexttime](#comment%3A20):
> I wouldn't call 2<sup>51</sup>+21 "very large", at least not if the functions now take `unsigned long` s.  (Ok, on most of current machines that exceeds an `unsigned int`.)

Very large meant "the function is no more efficient with such input".
 
> While we're at it, if `n` is `unsigned long`, you should take `(unsigned long)sqrtl((long double)n)`, otherwise you'd probably have to add 1 to the result in case `n` is a perfect square or slightly above.  (On 32-bit machines, where `unsigned long`s are only 32-bit as well, that doesn't matter.)

Done.

Vincent



---

archive/issue_comments_211221.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nWell... Theeeeeeeeeeeeeeeeeeeeeeen if there is no other comment, can this ticket be flagged as `positive_review` ? I agreed with what I read but I know can't follow you on the \"hardware/programming standard\" ground `:-)`\n\nNathann",
    "created_at": "2014-05-20T06:53:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211221",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:23" align="right">comment:23</div>

Well... Theeeeeeeeeeeeeeeeeeeeeeen if there is no other comment, can this ticket be flagged as `positive_review` ? I agreed with what I read but I know can't follow you on the "hardware/programming standard" ground `:-)`

Nathann



---

archive/issue_comments_211222.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nJust to mention: if there is an overflow, the error is very explicit\n\n```\nsage: from sage.rings.sum_of_squares import two_squares_pyx\nsage: two_squares_pyx(2**65+19)\nTraceback (most recent call last):\n...\nOverflowError: long int too large to convert\n```",
    "created_at": "2014-05-20T07:43:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211222",
    "user": "https://github.com/videlec"
}
```

<div id="comment:24" align="right">comment:24</div>

Just to mention: if there is an overflow, the error is very explicit

```
sage: from sage.rings.sum_of_squares import two_squares_pyx
sage: two_squares_pyx(2**65+19)
Traceback (most recent call last):
...
OverflowError: long int too large to convert
```



---

archive/issue_comments_211223.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@videlec](#comment%3A24):\n> Just to mention: if there is an overflow, the error is very explicit\n> \n> ```\n> sage: from sage.rings.sum_of_squares import two_squares_pyx\n> sage: two_squares_pyx(2**65+19)\n> Traceback (most recent call last):\n> ...\n> OverflowError: long int too large to convert\n> ```\n\nI rather meant overflows in the C/Cython code, where just modulo arithmetic happens, without throwing exceptions.  (With using `unsigned long`s you're probably on the safe[r] side, but that's something I(?)'ll have to check more carefully...)",
    "created_at": "2014-05-20T13:21:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211223",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@videlec](#comment%3A24):
> Just to mention: if there is an overflow, the error is very explicit
> 
> ```
> sage: from sage.rings.sum_of_squares import two_squares_pyx
> sage: two_squares_pyx(2**65+19)
> Traceback (most recent call last):
> ...
> OverflowError: long int too large to convert
> ```

I rather meant overflows in the C/Cython code, where just modulo arithmetic happens, without throwing exceptions.  (With using `unsigned long`s you're probably on the safe[r] side, but that's something I(?)'ll have to check more carefully...)



---

archive/issue_comments_211224.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nP.S.:  On modern (64-bit) AMD CPUs, not using squaring is significantly faster, while on Intel CPUs there's apparently not much of a difference, with I think a slight advantage of doing squaring explicitly (i.e., integer multiplication), but it's hard to get reliable timings there.\n\n(And GCC definitely doesn't do the transformation either way.)",
    "created_at": "2014-05-20T13:32:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211224",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:26" align="right">comment:26</div>

P.S.:  On modern (64-bit) AMD CPUs, not using squaring is significantly faster, while on Intel CPUs there's apparently not much of a difference, with I think a slight advantage of doing squaring explicitly (i.e., integer multiplication), but it's hard to get reliable timings there.

(And GCC definitely doesn't do the transformation either way.)



---

archive/issue_comments_211225.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@nexttime](#comment%3A25):\n> Replying to [@videlec](#comment%3A24):\n> > Just to mention: if there is an overflow, the error is very explicit\n> > \n> > ```\n> > sage: from sage.rings.sum_of_squares import two_squares_pyx\n> > sage: two_squares_pyx(2**65+19)\n> > Traceback (most recent call last):\n> > ...\n> > OverflowError: long int too large to convert\n> > ```\n\n> \n> I rather meant overflows in the C/Cython code, where just modulo arithmetic happens, without throwing exceptions.  (With using `unsigned long`s you're probably on the safe[r] side, but that's something I(?)'ll have to check more carefully...)\n\nThere are only two places were overflow may occur:\n- the input\n- when we rely on long double to perform the square root (i.e. are we sure that an `unsigned long` fits into a `long double` ?) \nAll integers that appear inside the function are smaller than the input. So, no trouble here.\n\nVincent",
    "created_at": "2014-05-20T17:47:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211225",
    "user": "https://github.com/videlec"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@nexttime](#comment%3A25):
> Replying to [@videlec](#comment%3A24):
> > Just to mention: if there is an overflow, the error is very explicit
> > 
> > ```
> > sage: from sage.rings.sum_of_squares import two_squares_pyx
> > sage: two_squares_pyx(2**65+19)
> > Traceback (most recent call last):
> > ...
> > OverflowError: long int too large to convert
> > ```

> 
> I rather meant overflows in the C/Cython code, where just modulo arithmetic happens, without throwing exceptions.  (With using `unsigned long`s you're probably on the safe[r] side, but that's something I(?)'ll have to check more carefully...)

There are only two places were overflow may occur:
- the input
- when we rely on long double to perform the square root (i.e. are we sure that an `unsigned long` fits into a `long double` ?) 
All integers that appear inside the function are smaller than the input. So, no trouble here.

Vincent



---

archive/issue_comments_211226.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@nexttime](#comment%3A26):\n> P.S.:  On modern (64-bit) AMD CPUs, not using squaring is significantly faster, while on Intel CPUs there's apparently not much of a difference, with I think a slight advantage of doing squaring explicitly (i.e., integer multiplication), but it's hard to get reliable timings there.\n> \n> (And GCC definitely doesn't do the transformation either way.)\n\nI would prefer to keep the multiplication as it is much more readable.",
    "created_at": "2014-05-20T17:52:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211226",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@nexttime](#comment%3A26):
> P.S.:  On modern (64-bit) AMD CPUs, not using squaring is significantly faster, while on Intel CPUs there's apparently not much of a difference, with I think a slight advantage of doing squaring explicitly (i.e., integer multiplication), but it's hard to get reliable timings there.
> 
> (And GCC definitely doesn't do the transformation either way.)

I would prefer to keep the multiplication as it is much more readable.



---

archive/issue_comments_211227.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI think the `long double` is overkill and would revert to using `sqrt()`.\n\n1. It decreases portability (`sqrtl()` is C99 so at least you need to compile in C99 mode and not all systems have this function).\n\n2. You will never want to call `two_squares` in this range (`2^53`) anyway.\n\n3. For `three_squares` and `four_squares`, there are many solutions, so it doesn't matter if the square root is off by 1.",
    "created_at": "2014-05-20T19:02:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211227",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

I think the `long double` is overkill and would revert to using `sqrt()`.

1. It decreases portability (`sqrtl()` is C99 so at least you need to compile in C99 mode and not all systems have this function).

2. You will never want to call `two_squares` in this range (`2^53`) anyway.

3. For `three_squares` and `four_squares`, there are many solutions, so it doesn't matter if the square root is off by 1.



---

archive/issue_events_231815.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-05-20T19:02:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231815"
}
```



---

archive/issue_events_231816.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-05-20T19:02:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231816"
}
```



---

archive/issue_comments_211228.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nAlso, these functions should be interruptible: http://www.sagemath.org/doc/developer/coding_in_cython.html#interrupt-and-signal-handling",
    "created_at": "2014-05-20T19:11:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211228",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

Also, these functions should be interruptible: http://www.sagemath.org/doc/developer/coding_in_cython.html#interrupt-and-signal-handling



---

archive/issue_comments_211229.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jdemeyer](#comment%3A29):\n> I think the `long double` is overkill and would revert to using `sqrt()`.\n> \n> 1. It decreases portability (`sqrtl()` is C99 so at least you need to compile in C99 mode and not all systems have this function).\n\n:-)  Yes, C99 is only 15 years old.  (Note that a lot of code in Sage requires C99, and any recent GCC defaults to `-std=gnu99`.)\n\nWhile there are (very few) platforms where the math library at least used to lack some long double functions, I really wouldn't care here.\n\nBy the way, IMHO `i` and `j` should be `unsigned` rather than `unsigned long`.  (And as mentioned, I'd rather use `uint32_t` and `uint64_t`, or even better, `uint_fast32_t` instead of the former.)\n\nNote that in\n\n```python\n        j = <unsigned> sqrt[l](<[long] double> n)\n        j += 1 - j%2\n```\n`j` still cannot overflow, since `sqrt[l]()` returns `UINT_MAX` (which is odd) for n close to `ULONG_MAX`.\n\nHowever, I'd limit the input to values far below `ULONG_MAX` (more precisely, `UINT64_MAX`) anyway.\n\n\n\n\n\n> 2. You will never want to call `two_squares` in this range (`2^53`) anyway.\n\nYes, and I'd actually bail out above some cutoff.\n\n\n\n\n> 4. I have to check the details, but I think that `<unsigned long> sqrt(<double> n)` is actually sufficiently precise that it computes the exact integer square root.\n\n? You mean `(unsigned long)sqrt((double)N) * (unsigned long)sqrt((double)N) <= N` (for all N < 2<sup>53</sup>, say), or `(unsigned long)sqrt((double)(N*N)) == N` (for all N < 2<sup>26</sup>, say)?\n\n\n\n\nI'm ok with using `sqrt()` if we limit the input accordingly (to at most 2<sup>53</sup>-1).",
    "created_at": "2014-05-20T20:17:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211229",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jdemeyer](#comment%3A29):
> I think the `long double` is overkill and would revert to using `sqrt()`.
> 
> 1. It decreases portability (`sqrtl()` is C99 so at least you need to compile in C99 mode and not all systems have this function).

:-)  Yes, C99 is only 15 years old.  (Note that a lot of code in Sage requires C99, and any recent GCC defaults to `-std=gnu99`.)

While there are (very few) platforms where the math library at least used to lack some long double functions, I really wouldn't care here.

By the way, IMHO `i` and `j` should be `unsigned` rather than `unsigned long`.  (And as mentioned, I'd rather use `uint32_t` and `uint64_t`, or even better, `uint_fast32_t` instead of the former.)

Note that in

```python
        j = <unsigned> sqrt[l](<[long] double> n)
        j += 1 - j%2
```
`j` still cannot overflow, since `sqrt[l]()` returns `UINT_MAX` (which is odd) for n close to `ULONG_MAX`.

However, I'd limit the input to values far below `ULONG_MAX` (more precisely, `UINT64_MAX`) anyway.





> 2. You will never want to call `two_squares` in this range (`2^53`) anyway.

Yes, and I'd actually bail out above some cutoff.




> 4. I have to check the details, but I think that `<unsigned long> sqrt(<double> n)` is actually sufficiently precise that it computes the exact integer square root.

? You mean `(unsigned long)sqrt((double)N) * (unsigned long)sqrt((double)N) <= N` (for all N < 2<sup>53</sup>, say), or `(unsigned long)sqrt((double)(N*N)) == N` (for all N < 2<sup>26</sup>, say)?




I'm ok with using `sqrt()` if we limit the input accordingly (to at most 2<sup>53</sup>-1).



---

archive/issue_comments_211230.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@nexttime](#comment%3A32):\n> While there are (very few) platforms where the math library at least used to lack some long double functions, I really wouldn't care here.\n\nYes indeed, I was referring to the math library part of C99.\n> > 4. I have to check the details, but I think that `<unsigned long> sqrt(<double> n)` is actually sufficiently precise that it computes the exact integer square root.\n\n> \n> `(unsigned long)sqrt((double)(N*N)) == N` (for all N < 2<sup>26</sup>, say)?\n\nI meant this, which is true even for much larger values of `N` (as long as `N` is representable in a `double`). But we actually require `sqrt((double) n)**2 <= n` for all inputs `n`, which is not true with my formula.",
    "created_at": "2014-05-21T08:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211230",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@nexttime](#comment%3A32):
> While there are (very few) platforms where the math library at least used to lack some long double functions, I really wouldn't care here.

Yes indeed, I was referring to the math library part of C99.
> > 4. I have to check the details, but I think that `<unsigned long> sqrt(<double> n)` is actually sufficiently precise that it computes the exact integer square root.

> 
> `(unsigned long)sqrt((double)(N*N)) == N` (for all N < 2<sup>26</sup>, say)?

I meant this, which is true even for much larger values of `N` (as long as `N` is representable in a `double`). But we actually require `sqrt((double) n)**2 <= n` for all inputs `n`, which is not true with my formula.



---

archive/issue_comments_211231.json:
```json
{
    "body": "<div id=\"comment:34\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39c83cae8575fa8748dc97f67ee62b8788b79b48\"><code>39c83ca</code></a></td><td><code>trac #16374: unsigned long -> uint_fast32_t and signal handling</code></td></tr></table>\n",
    "created_at": "2014-06-02T07:48:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211231",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39c83cae8575fa8748dc97f67ee62b8788b79b48"><code>39c83ca</code></a></td><td><code>trac #16374: unsigned long -> uint_fast32_t and signal handling</code></td></tr></table>




---

archive/issue_comments_211232.json:
```json
{
    "body": "Changed commit from **[`17883e3`](https://github.com/sagemath/sagetrac-mirror/commit/17883e34f96f7f78f35f56bad527dcbaa728169d)** to **[`39c83ca`](https://github.com/sagemath/sagetrac-mirror/commit/39c83cae8575fa8748dc97f67ee62b8788b79b48)**",
    "created_at": "2014-06-02T07:48:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211232",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`17883e3`](https://github.com/sagemath/sagetrac-mirror/commit/17883e34f96f7f78f35f56bad527dcbaa728169d)** to **[`39c83ca`](https://github.com/sagemath/sagetrac-mirror/commit/39c83cae8575fa8748dc97f67ee62b8788b79b48)**



---

archive/issue_comments_211233.json:
```json
{
    "body": "Changed commit from **[`39c83ca`](https://github.com/sagemath/sagetrac-mirror/commit/39c83cae8575fa8748dc97f67ee62b8788b79b48)** to **[`8ba94c4`](https://github.com/sagemath/sagetrac-mirror/commit/8ba94c4a3cb84aec3bd71f8a8620a6639da4bfa6)**",
    "created_at": "2014-06-02T07:51:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211233",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`39c83ca`](https://github.com/sagemath/sagetrac-mirror/commit/39c83cae8575fa8748dc97f67ee62b8788b79b48)** to **[`8ba94c4`](https://github.com/sagemath/sagetrac-mirror/commit/8ba94c4a3cb84aec3bd71f8a8620a6639da4bfa6)**



---

archive/issue_comments_211234.json:
```json
{
    "body": "<div id=\"comment:35\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ba94c4a3cb84aec3bd71f8a8620a6639da4bfa6\"><code>8ba94c4</code></a></td><td><code>trac #16374: fix a signal handling error</code></td></tr></table>\n",
    "created_at": "2014-06-02T07:51:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211234",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:35"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ba94c4a3cb84aec3bd71f8a8620a6639da4bfa6"><code>8ba94c4</code></a></td><td><code>trac #16374: fix a signal handling error</code></td></tr></table>




---

archive/issue_events_231817.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-02T07:54:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231817"
}
```



---

archive/issue_events_231818.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-02T07:54:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231818"
}
```



---

archive/issue_comments_211235.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nHi,\n\nThe file now uses `uint_fast32_t` and `sqrt`. There is a check on the input size of the three cython functions (since on some platform a `uint_fast32_t` is actually 64 bits). But I did not know how to test it properly... so it is `# not tested`.\n\nPlease review!\nVincent",
    "created_at": "2014-06-02T07:54:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211235",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">comment:36</div>

Hi,

The file now uses `uint_fast32_t` and `sqrt`. There is a check on the input size of the three cython functions (since on some platform a `uint_fast32_t` is actually 64 bits). But I did not know how to test it properly... so it is `# not tested`.

Please review!
Vincent



---

archive/issue_comments_211236.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nSmall comment: you could make the input type `uint32_t` and use `uint_fast32_t` for the computation. Then your exceptions will be platform-independent.",
    "created_at": "2014-06-02T09:31:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211236",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:37" align="right">comment:37</div>

Small comment: you could make the input type `uint32_t` and use `uint_fast32_t` for the computation. Then your exceptions will be platform-independent.



---

archive/issue_events_231819.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-02T09:31:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231819"
}
```



---

archive/issue_events_231820.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-06-02T09:31:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231820"
}
```



---

archive/issue_comments_211237.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1106b2e32ec4e9878bbf5626e6aae12042c345f9\"><code>1106b2e</code></a></td><td><code>trac #16374: fix input overflow + some cleaning</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fdf90e6da61efa184245e5e7fb61c27f79bf0396\"><code>fdf90e6</code></a></td><td><code>trac #16374: overflow test + is_sum_of_two_squares_pyx</code></td></tr></table>\n",
    "created_at": "2014-06-02T16:29:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211237",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1106b2e32ec4e9878bbf5626e6aae12042c345f9"><code>1106b2e</code></a></td><td><code>trac #16374: fix input overflow + some cleaning</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fdf90e6da61efa184245e5e7fb61c27f79bf0396"><code>fdf90e6</code></a></td><td><code>trac #16374: overflow test + is_sum_of_two_squares_pyx</code></td></tr></table>




---

archive/issue_comments_211238.json:
```json
{
    "body": "Changed commit from **[`8ba94c4`](https://github.com/sagemath/sagetrac-mirror/commit/8ba94c4a3cb84aec3bd71f8a8620a6639da4bfa6)** to **[`fdf90e6`](https://github.com/sagemath/sagetrac-mirror/commit/fdf90e6da61efa184245e5e7fb61c27f79bf0396)**",
    "created_at": "2014-06-02T16:29:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211238",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8ba94c4`](https://github.com/sagemath/sagetrac-mirror/commit/8ba94c4a3cb84aec3bd71f8a8620a6639da4bfa6)** to **[`fdf90e6`](https://github.com/sagemath/sagetrac-mirror/commit/fdf90e6da61efa184245e5e7fb61c27f79bf0396)**



---

archive/issue_events_231821.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-02T16:31:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231821"
}
```



---

archive/issue_events_231822.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-02T16:31:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231822"
}
```



---

archive/issue_comments_211239.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@jdemeyer](#comment%3A37):\n> Small comment: you could make the input type `uint32_t` and use `uint_fast32_t` for the computation. Then your exceptions will be platform-independent.\n\nGreat. Thanks for the suggestion. Done in the new version and the tests are updated. I also add a function `is_sum_of_square_pyx` which is much faster than using `sum_of_squares_pyx` with `try/except`, especially if the answer is `False`.",
    "created_at": "2014-06-02T16:31:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211239",
    "user": "https://github.com/videlec"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@jdemeyer](#comment%3A37):
> Small comment: you could make the input type `uint32_t` and use `uint_fast32_t` for the computation. Then your exceptions will be platform-independent.

Great. Thanks for the suggestion. Done in the new version and the tests are updated. I also add a function `is_sum_of_square_pyx` which is much faster than using `sum_of_squares_pyx` with `try/except`, especially if the answer is `False`.



---

archive/issue_comments_211240.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nHllooooooooo !\n\nI re-read this thing again and I think that it is good to go. I added a small commit in public/16374 to replace `2^32` with `2^{32}` which produced a bad output in the html doc.\n\nIf you have no objection to that you can set the ticket to `positive_review` `:-P` \n\nNathann",
    "created_at": "2014-06-06T10:29:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211240",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:40" align="right">comment:40</div>

Hllooooooooo !

I re-read this thing again and I think that it is good to go. I added a small commit in public/16374 to replace `2^32` with `2^{32}` which produced a bad output in the html doc.

If you have no objection to that you can set the ticket to `positive_review` `:-P` 

Nathann



---

archive/issue_comments_211241.json:
```json
{
    "body": "Changed commit from **[`fdf90e6`](https://github.com/sagemath/sagetrac-mirror/commit/fdf90e6da61efa184245e5e7fb61c27f79bf0396)** to **[`1b965f8`](https://github.com/sagemath/sagetrac-mirror/commit/1b965f8361b779b8e888bb56a249ea48ac4b6852)**",
    "created_at": "2014-06-06T14:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211241",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[`fdf90e6`](https://github.com/sagemath/sagetrac-mirror/commit/fdf90e6da61efa184245e5e7fb61c27f79bf0396)** to **[`1b965f8`](https://github.com/sagemath/sagetrac-mirror/commit/1b965f8361b779b8e888bb56a249ea48ac4b6852)**



---

archive/issue_comments_211242.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer, Leif Leonhardy,  \u200bNathann Cohen**",
    "created_at": "2014-06-06T14:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211242",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Jeroen Demeyer, Leif Leonhardy,  â€‹Nathann Cohen**



---

archive/issue_comments_211243.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/16374](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16374)** to **[public/16374](https://github.com/sagemath/sagetrac-mirror/tree/public/16374)**",
    "created_at": "2014-06-06T14:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211243",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[u/vdelecroix/16374](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/16374)** to **[public/16374](https://github.com/sagemath/sagetrac-mirror/tree/public/16374)**



---

archive/issue_comments_211244.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nThanks!\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6894cd05f3cb81dbdb9528332114ded0193673f9\"><code>6894cd0</code></a></td><td><code>trac #16374: Merged with 6.3.beta3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b965f8361b779b8e888bb56a249ea48ac4b6852\"><code>1b965f8</code></a></td><td><code>trac #16374: Latex typos</code></td></tr></table>\n",
    "created_at": "2014-06-06T14:10:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211244",
    "user": "https://github.com/videlec"
}
```

<div id="comment:41" align="right">comment:41</div>

Thanks!

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6894cd05f3cb81dbdb9528332114ded0193673f9"><code>6894cd0</code></a></td><td><code>trac #16374: Merged with 6.3.beta3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b965f8361b779b8e888bb56a249ea48ac4b6852"><code>1b965f8</code></a></td><td><code>trac #16374: Latex typos</code></td></tr></table>




---

archive/issue_events_231823.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-06T14:10:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231823"
}
```



---

archive/issue_events_231824.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-06T14:10:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231824"
}
```



---

archive/issue_events_231825.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-06T20:01:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231825"
}
```



---

archive/issue_events_231826.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-06T20:01:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231826"
}
```



---

archive/issue_comments_211245.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nFails on 32 bit:\n\n```\nsage -t --long src/sage/rings/sum_of_squares.pyx\n**********************************************************************\nFile \"src/sage/rings/sum_of_squares.pyx\", line 156, in sage.rings.sum_of_squares.two_squares_pyx\nFailed example:\n    two_squares_pyx(2**32)\nExpected:\n    Traceback (most recent call last):\n    ...\n    OverflowError: value too large to convert to uint32_t\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 839, in execute\n        exec compiled in globs\n      File \"<doctest sage.rings.sum_of_squares.two_squares_pyx[6]>\", line 1, in <module>\n        two_squares_pyx(Integer(2)**Integer(32))\n      File \"sum_of_squares.pyx\", line 128, in sage.rings.sum_of_squares.two_squares_pyx (sage/rings/sum_of_squares.c:2759)\n    OverflowError: long int too large to convert\n**********************************************************************\nFile \"src/sage/rings/sum_of_squares.pyx\", line 197, in sage.rings.sum_of_squares.is_sum_of_two_squares_pyx\nFailed example:\n    is_sum_of_two_squares_pyx(2**32)\nExpected:\n    Traceback (most recent call last):\n    ...\n    OverflowError: value too large to convert to uint32_t\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 839, in execute\n        exec compiled in globs\n      File \"<doctest sage.rings.sum_of_squares.is_sum_of_two_squares_pyx[2]>\", line 1, in <module>\n        is_sum_of_two_squares_pyx(Integer(2)**Integer(32))\n      File \"sum_of_squares.pyx\", line 184, in sage.rings.sum_of_squares.is_sum_of_two_squares_pyx (sage/rings/sum_of_squares.c:2916)\n    OverflowError: long int too large to convert\n**********************************************************************\nFile \"src/sage/rings/sum_of_squares.pyx\", line 244, in sage.rings.sum_of_squares.three_squares_pyx\nFailed example:\n    three_squares_pyx(2**32)\nExpected:\n    Traceback (most recent call last):\n    ...\n    OverflowError: value too large to convert to uint32_t\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 839, in execute\n        exec compiled in globs\n      File \"<doctest sage.rings.sum_of_squares.three_squares_pyx[10]>\", line 1, in <module>\n        three_squares_pyx(Integer(2)**Integer(32))\n      File \"sum_of_squares.pyx\", line 212, in sage.rings.sum_of_squares.three_squares_pyx (sage/rings/sum_of_squares.c:3045)\n    OverflowError: long int too large to convert\n**********************************************************************\nFile \"src/sage/rings/sum_of_squares.pyx\", line 291, in sage.rings.sum_of_squares.four_squares_pyx\nFailed example:\n    four_squares_pyx(2**32)\nExpected:\n    Traceback (most recent call last):\n    ...\n    OverflowError: value too large to convert to uint32_t\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 480, in _run\n        self.execute(example, compiled, test.globs)\n      File \"/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 839, in execute\n        exec compiled in globs\n      File \"<doctest sage.rings.sum_of_squares.four_squares_pyx[5]>\", line 1, in <module>\n        four_squares_pyx(Integer(2)**Integer(32))\n      File \"sum_of_squares.pyx\", line 266, in sage.rings.sum_of_squares.four_squares_pyx (sage/rings/sum_of_squares.c:3209)\n    OverflowError: long int too large to convert\n**********************************************************************\n4 items had failures:\n   1 of  10 in sage.rings.sum_of_squares.four_squares_pyx\n   1 of   4 in sage.rings.sum_of_squares.is_sum_of_two_squares_pyx\n   1 of  14 in sage.rings.sum_of_squares.three_squares_pyx\n   1 of  11 in sage.rings.sum_of_squares.two_squares_pyx\n    [35 tests, 4 failures, 0.83 s]\n```",
    "created_at": "2014-06-06T20:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211245",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:42" align="right">comment:42</div>

Fails on 32 bit:

```
sage -t --long src/sage/rings/sum_of_squares.pyx
**********************************************************************
File "src/sage/rings/sum_of_squares.pyx", line 156, in sage.rings.sum_of_squares.two_squares_pyx
Failed example:
    two_squares_pyx(2**32)
Expected:
    Traceback (most recent call last):
    ...
    OverflowError: value too large to convert to uint32_t
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest sage.rings.sum_of_squares.two_squares_pyx[6]>", line 1, in <module>
        two_squares_pyx(Integer(2)**Integer(32))
      File "sum_of_squares.pyx", line 128, in sage.rings.sum_of_squares.two_squares_pyx (sage/rings/sum_of_squares.c:2759)
    OverflowError: long int too large to convert
**********************************************************************
File "src/sage/rings/sum_of_squares.pyx", line 197, in sage.rings.sum_of_squares.is_sum_of_two_squares_pyx
Failed example:
    is_sum_of_two_squares_pyx(2**32)
Expected:
    Traceback (most recent call last):
    ...
    OverflowError: value too large to convert to uint32_t
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest sage.rings.sum_of_squares.is_sum_of_two_squares_pyx[2]>", line 1, in <module>
        is_sum_of_two_squares_pyx(Integer(2)**Integer(32))
      File "sum_of_squares.pyx", line 184, in sage.rings.sum_of_squares.is_sum_of_two_squares_pyx (sage/rings/sum_of_squares.c:2916)
    OverflowError: long int too large to convert
**********************************************************************
File "src/sage/rings/sum_of_squares.pyx", line 244, in sage.rings.sum_of_squares.three_squares_pyx
Failed example:
    three_squares_pyx(2**32)
Expected:
    Traceback (most recent call last):
    ...
    OverflowError: value too large to convert to uint32_t
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest sage.rings.sum_of_squares.three_squares_pyx[10]>", line 1, in <module>
        three_squares_pyx(Integer(2)**Integer(32))
      File "sum_of_squares.pyx", line 212, in sage.rings.sum_of_squares.three_squares_pyx (sage/rings/sum_of_squares.c:3045)
    OverflowError: long int too large to convert
**********************************************************************
File "src/sage/rings/sum_of_squares.pyx", line 291, in sage.rings.sum_of_squares.four_squares_pyx
Failed example:
    four_squares_pyx(2**32)
Expected:
    Traceback (most recent call last):
    ...
    OverflowError: value too large to convert to uint32_t
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 480, in _run
        self.execute(example, compiled, test.globs)
      File "/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 839, in execute
        exec compiled in globs
      File "<doctest sage.rings.sum_of_squares.four_squares_pyx[5]>", line 1, in <module>
        four_squares_pyx(Integer(2)**Integer(32))
      File "sum_of_squares.pyx", line 266, in sage.rings.sum_of_squares.four_squares_pyx (sage/rings/sum_of_squares.c:3209)
    OverflowError: long int too large to convert
**********************************************************************
4 items had failures:
   1 of  10 in sage.rings.sum_of_squares.four_squares_pyx
   1 of   4 in sage.rings.sum_of_squares.is_sum_of_two_squares_pyx
   1 of  14 in sage.rings.sum_of_squares.three_squares_pyx
   1 of  11 in sage.rings.sum_of_squares.two_squares_pyx
    [35 tests, 4 failures, 0.83 s]
```



---

archive/issue_comments_211246.json:
```json
{
    "body": "Changed commit from **[`1b965f8`](https://github.com/sagemath/sagetrac-mirror/commit/1b965f8361b779b8e888bb56a249ea48ac4b6852)** to **[`51e36d8`](https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e)**",
    "created_at": "2014-06-06T20:22:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211246",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1b965f8`](https://github.com/sagemath/sagetrac-mirror/commit/1b965f8361b779b8e888bb56a249ea48ac4b6852)** to **[`51e36d8`](https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e)**



---

archive/issue_comments_211247.json:
```json
{
    "body": "<div id=\"comment:43\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e\"><code>51e36d8</code></a></td><td><code>trac #16374: fix OverflowError test to be platform independent</code></td></tr></table>\n",
    "created_at": "2014-06-06T20:22:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211247",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:43"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e"><code>51e36d8</code></a></td><td><code>trac #16374: fix OverflowError test to be platform independent</code></td></tr></table>




---

archive/issue_events_231827.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-06T20:23:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231827"
}
```



---

archive/issue_events_231828.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-06T20:23:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231828"
}
```



---

archive/issue_comments_211248.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nSorry! I did no think that the message of the `OverflowError` was platform dependent... new version that needs review.",
    "created_at": "2014-06-06T20:23:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211248",
    "user": "https://github.com/videlec"
}
```

<div id="comment:44" align="right">comment:44</div>

Sorry! I did no think that the message of the `OverflowError` was platform dependent... new version that needs review.



---

archive/issue_events_231829.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-06T20:32:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231829"
}
```



---

archive/issue_events_231830.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-06T20:32:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231830"
}
```



---

archive/issue_comments_211249.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nlgtm",
    "created_at": "2014-06-06T20:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211249",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:45" align="right">comment:45</div>

lgtm



---

archive/issue_comments_211250.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nThanks Volker!",
    "created_at": "2014-06-06T20:46:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211250",
    "user": "https://github.com/videlec"
}
```

<div id="comment:46" align="right">comment:46</div>

Thanks Volker!



---

archive/issue_comments_211251.json:
```json
{
    "body": "Changed branch from **[public/16374](https://github.com/sagemath/sagetrac-mirror/tree/public/16374)** to **[`51e36d8`](https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e)**",
    "created_at": "2014-06-08T12:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16374#issuecomment-211251",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/16374](https://github.com/sagemath/sagetrac-mirror/tree/public/16374)** to **[`51e36d8`](https://github.com/sagemath/sagetrac-mirror/commit/51e36d88f4f171ee241b0eb5e467b513ddfa312e)**



---

archive/issue_events_231831.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-08T12:09:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231831"
}
```



---

archive/issue_events_231832.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "fa04b13e22324c3bdee68acfd2beb9533a1ed8d1",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-06-08T12:09:04Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16374",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16374#event-231832"
}
```
