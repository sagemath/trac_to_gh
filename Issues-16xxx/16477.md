# Issue 16477: implement Dirichlet series

archive/issues_016240.json:
```json
{
    "body": "kcrisman in comment:20:ticket:8383:\n> Did somebody say [defining Dirichlet series](http://ask.sagemath.org/question/2540/defining-dirichlet-series)?  [Here is an implementation](http://www.wordpress.jonhanke.com/Software/Sage__Dirichlet_series/Dirichlet_series.sage) that I haven't had time to try out but which might be a good basis for that.  [This sage-support thread](https://groups.google.com/forum/#!msg/sage-support/v7TFXKbAV0E/) may also be relevant, though I don't know how advanced that psage code is.\n\n\nThe following file lists some product forms and their corresponding generating functions, it should be used to pick doctests for the g.f. input part of this ticket. The resp. OEIS entries are partly conjectural.\nhttps://drive.google.com/file/d/0B4PmRyK1JXgHY29aa00zZnhib1k/\n\nFollowup: #18102\n\nCC:  @kcrisman mkamalakshya @jonhanke @slel\n\nKeywords: moebius, zeta, sigma, euler_phi, euler, Dirichlet series\n\nReviewer: Kamalakshya Mahatab, Vincent Delecroix, Jeroen Demeyer, Jonas Jermann, Ralf Stephan\n\nAuthor: Jonathan Hanke, Ralf Stephan\n\nBranch: public/ticket/16477\n\nCommit: eb2006785b5c456048ba4773fd58be652a409d5c\n\nIssue created by migration from https://trac.sagemath.org/ticket/16477\n\n",
    "created_at": "2014-06-12T16:28:24Z",
    "labels": [
        "component: number theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "implement Dirichlet series",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16477",
    "user": "https://github.com/rwst"
}
```
kcrisman in comment:20:ticket:8383:
> Did somebody say [defining Dirichlet series](http://ask.sagemath.org/question/2540/defining-dirichlet-series)?  [Here is an implementation](http://www.wordpress.jonhanke.com/Software/Sage__Dirichlet_series/Dirichlet_series.sage) that I haven't had time to try out but which might be a good basis for that.  [This sage-support thread](https://groups.google.com/forum/#!msg/sage-support/v7TFXKbAV0E/) may also be relevant, though I don't know how advanced that psage code is.


The following file lists some product forms and their corresponding generating functions, it should be used to pick doctests for the g.f. input part of this ticket. The resp. OEIS entries are partly conjectural.
https://drive.google.com/file/d/0B4PmRyK1JXgHY29aa00zZnhib1k/

Followup: #18102

CC:  @kcrisman mkamalakshya @jonhanke @slel

Keywords: moebius, zeta, sigma, euler_phi, euler, Dirichlet series

Reviewer: Kamalakshya Mahatab, Vincent Delecroix, Jeroen Demeyer, Jonas Jermann, Ralf Stephan

Author: Jonathan Hanke, Ralf Stephan

Branch: public/ticket/16477

Commit: eb2006785b5c456048ba4773fd58be652a409d5c

Issue created by migration from https://trac.sagemath.org/ticket/16477





---

archive/issue_comments_212091.json:
```json
{
    "body": "Attachment [Dirichlet_series.sage](tarball://root/attachments/some-uuid/ticket16477/Dirichlet_series.sage) by @kcrisman created at 2014-07-08 13:42:24",
    "created_at": "2014-07-08T13:42:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212091",
    "user": "https://github.com/kcrisman"
}
```

Attachment [Dirichlet_series.sage](tarball://root/attachments/some-uuid/ticket16477/Dirichlet_series.sage) by @kcrisman created at 2014-07-08 13:42:24



---

archive/issue_comments_212092.json:
```json
{
    "body": "<a id='comment:3'></a>I've attached the relevant file as well.",
    "created_at": "2014-07-08T13:42:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212092",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>I've attached the relevant file as well.



---

archive/issue_events_048423.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48423"
}
```



---

archive/issue_comments_212093.json:
```json
{
    "body": "<a id='comment:6'></a>New commits:",
    "created_at": "2014-08-16T11:05:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212093",
    "user": "https://trac.sagemath.org/admin/accounts/users/mkamalakshya"
}
```

<a id='comment:6'></a>New commits:



---

archive/issue_events_048424.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-17T13:52:22Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48424"
}
```



---

archive/issue_events_048425.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-02-17T13:52:22Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48425"
}
```



---

archive/issue_comments_212094.json:
```json
{
    "body": "<a id='comment:8'></a>See also how to [do it in Pari](http://math.stackexchange.com/questions/1193708/question-about-direuler-command-in-pari-gp).  Indeed, it has multiplication of Dirichlet series and so forth.  Maybe that could be used somehow, since it already exists and is presumably well-tested.",
    "created_at": "2015-03-17T14:10:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212094",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>See also how to [do it in Pari](http://math.stackexchange.com/questions/1193708/question-about-direuler-command-in-pari-gp).  Indeed, it has multiplication of Dirichlet series and so forth.  Maybe that could be used somehow, since it already exists and is presumably well-tested.



---

archive/issue_comments_212095.json:
```json
{
    "body": "<a id='comment:9'></a>This is not correct. The commit author (contrary to the committer) should show as `Jonathan Hanke`. This is done by using the `--author` option of `git ci`. I will change that.",
    "created_at": "2015-03-22T16:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212095",
    "user": "https://github.com/rwst"
}
```

<a id='comment:9'></a>This is not correct. The commit author (contrary to the committer) should show as `Jonathan Hanke`. This is done by using the `--author` option of `git ci`. I will change that.



---

archive/issue_comments_212096.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-22T16:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212096",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_212097.json:
```json
{
    "body": "<a id='comment:11'></a>I also moved the file under `modular/`.\n\n---\nNew commits:",
    "created_at": "2015-03-22T16:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212097",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'></a>I also moved the file under `modular/`.

---
New commits:



---

archive/issue_comments_212098.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-03-22T16:26:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212098",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212099.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-22T17:01:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212099",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212100.json:
```json
{
    "body": "<a id='comment:16'></a>About PARI: `dirmul` and `dirdiv` already work in Sage. `direuler` is difficult because of the syntax `direuler(p=a,b,expr)` involving a loop variable and an expression to be evaluated.",
    "created_at": "2015-03-23T12:35:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212100",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>About PARI: `dirmul` and `dirdiv` already work in Sage. `direuler` is difficult because of the syntax `direuler(p=a,b,expr)` involving a loop variable and an expression to be evaluated.



---

archive/issue_comments_212101.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-23T15:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212101",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212102.json:
```json
{
    "body": "<a id='comment:19'></a>Hi\n\nJust an idea:\n\nShouldn't it be possible to define/implement Dirichlet series by specifying a function\n(from Z/ideals/whatever) for their coefficients?\n\nI guess that would require some base class (which ideally would accept/parse/recognize\nfunctions from Z/whatever) for the coefficient functions.\nIt would do parsing tasks, printing(!) of functions, arithmetic operations/dirichlet\nconvolutions/etc... (Completely) multiplicative functions would be a \"nice\" subclass.\nIdeally the implementation would at least support basic Dirichlet series example.\n\nAgain: Just an idea (for either an extension or a new implementation/ticket).\n\nRegards,\nJonas",
    "created_at": "2015-03-24T19:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212102",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:19'></a>Hi

Just an idea:

Shouldn't it be possible to define/implement Dirichlet series by specifying a function
(from Z/ideals/whatever) for their coefficients?

I guess that would require some base class (which ideally would accept/parse/recognize
functions from Z/whatever) for the coefficient functions.
It would do parsing tasks, printing(!) of functions, arithmetic operations/dirichlet
convolutions/etc... (Completely) multiplicative functions would be a "nice" subclass.
Ideally the implementation would at least support basic Dirichlet series example.

Again: Just an idea (for either an extension or a new implementation/ticket).

Regards,
Jonas



---

archive/issue_comments_212103.json:
```json
{
    "body": "<a id='comment:20'></a>You are quite right - so, does Pari support this?  If not, then it's probably a fairly big job and should be a different ticket (while you should make sure that this ticket remains agnostic with respect to your questions so the backend can be changed).  If yes, hopefully we could just hook into their stuff for anything nontrivial.",
    "created_at": "2015-03-24T19:54:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212103",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>You are quite right - so, does Pari support this?  If not, then it's probably a fairly big job and should be a different ticket (while you should make sure that this ticket remains agnostic with respect to your questions so the backend can be changed).  If yes, hopefully we could just hook into their stuff for anything nontrivial.



---

archive/issue_comments_212104.json:
```json
{
    "body": "<a id='comment:21'></a>At the moment this is implemented:\n\n```\nsage: Lminus4 = dirichlet_series([kronecker(-4,n) for n in range(1,21)]); Lminus4\n1 + -1/(3^s) + 1/(5^s) + -1/(7^s) + 1/(9^s) + -1/(11^s) + 1/(13^s) + -1/(15^s) + 1/(17^s) + -1/(19^s) + O(21^(-s))\nsage: zeta = dirichlet_series([1]*20); zeta\n1 + 1/(2^s) + 1/(3^s) + 1/(4^s) + 1/(5^s) + 1/(6^s) + 1/(7^s) + 1/(8^s) + 1/(9^s) + 1/(10^s) + 1/(11^s) + 1/(12^s) + 1/(13^s) + 1/(14^s) + 1/(15^s) + 1/(16^s) + 1/(17^s) + 1/(18^s) + 1/(19^s) + 1/(20^s) + O(21^(-s))\nsage: zeta * Lminus4^(-1)\n1 + 1/(2^s) + 2/(3^s) + 1/(4^s) + 2/(6^s) + 2/(7^s) + 1/(8^s) + 2/(9^s) + 2/(11^s) + 2/(12^s) + 2/(14^s) + 1/(16^s) + 2/(18^s) + 2/(19^s) + O(21^(-s))\n```\nPlease give a concrete example what you like to see!",
    "created_at": "2015-03-25T06:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212104",
    "user": "https://github.com/rwst"
}
```

<a id='comment:21'></a>At the moment this is implemented:

```
sage: Lminus4 = dirichlet_series([kronecker(-4,n) for n in range(1,21)]); Lminus4
1 + -1/(3^s) + 1/(5^s) + -1/(7^s) + 1/(9^s) + -1/(11^s) + 1/(13^s) + -1/(15^s) + 1/(17^s) + -1/(19^s) + O(21^(-s))
sage: zeta = dirichlet_series([1]*20); zeta
1 + 1/(2^s) + 1/(3^s) + 1/(4^s) + 1/(5^s) + 1/(6^s) + 1/(7^s) + 1/(8^s) + 1/(9^s) + 1/(10^s) + 1/(11^s) + 1/(12^s) + 1/(13^s) + 1/(14^s) + 1/(15^s) + 1/(16^s) + 1/(17^s) + 1/(18^s) + 1/(19^s) + 1/(20^s) + O(21^(-s))
sage: zeta * Lminus4^(-1)
1 + 1/(2^s) + 2/(3^s) + 1/(4^s) + 2/(6^s) + 2/(7^s) + 1/(8^s) + 2/(9^s) + 2/(11^s) + 2/(12^s) + 2/(14^s) + 1/(16^s) + 2/(18^s) + 2/(19^s) + O(21^(-s))
```
Please give a concrete example what you like to see!



---

archive/issue_comments_212105.json:
```json
{
    "body": "<a id='comment:22'></a>I just found this:\nhttps://github.com/williamstein/psage/blob/master/psage/lseries/eulerprod.py#L1128\n\nEDIT: This has much more generality and lets this ticket look like a child's toy, so there 8P",
    "created_at": "2015-03-25T09:27:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212105",
    "user": "https://github.com/rwst"
}
```

<a id='comment:22'></a>I just found this:
https://github.com/williamstein/psage/blob/master/psage/lseries/eulerprod.py#L1128

EDIT: This has much more generality and lets this ticket look like a child's toy, so there 8P



---

archive/issue_comments_212106.json:
```json
{
    "body": "<a id='comment:23'></a>Concerning the dependencies #18038 and #18041: if you want to use `direuler` *now*, you can still do it using strings: `pari(\"direuler(...)\")` should work just like in GP:\n\n```\nsage: pari(\"direuler(p=2, 20, 1/(1-X)/(1-p*X))\")\n[1, 3, 4, 7, 6, 12, 8, 15, 13, 18, 12, 28, 14, 24, 24, 31, 18, 39, 20, 42]\n```",
    "created_at": "2015-03-25T09:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212106",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Concerning the dependencies #18038 and #18041: if you want to use `direuler` *now*, you can still do it using strings: `pari("direuler(...)")` should work just like in GP:

```
sage: pari("direuler(p=2, 20, 1/(1-X)/(1-p*X))")
[1, 3, 4, 7, 6, 12, 8, 15, 13, 18, 12, 28, 14, 24, 24, 31, 18, 39, 20, 42]
```



---

archive/issue_comments_212107.json:
```json
{
    "body": "<a id='comment:24'></a>rws:\n\nI'm in particular hoping for an exact implementation of arithmetic/multiplicative functions:\n\n```\nid = ArithmeticFunctions().id()\nsigma0 = ArithmeticFunction(lambda n: sigma0(n))\nid*id == sigma0 // Dirichlet convolution\n```\n\n...\n\n```\nf = DirichletSeries(id)*DirichletSeries(id)\nf == DirichletSeries(sigma0)\nf[91234154]\nf // nice representations:\n=> sum_{n in Z} (sum_{d|n} 1)\nor: sum_{n in Z} sigma0(n)\n```\n\n...\n\nThose certainly form a nice subset of possible coefficient functions / dirichlet series.\nMore generally I was hoping for the possibility to specify Dirichlet series /\ncoefficient functions exactly, not only up to some precision.\nE.g. (bad example) DirichletSeries(lambda n: sin(n))\nor e.g. by specifying an (exact) generating series as e.g. a rational function\n\nCalculating the n'th coefficient from these to get a DirichletSeries as now\nis at least rather simple.\n\nOther ideas: exact verification of identities (not only up to precision),\nnice representations/output of coefficient functions after operations (hard),\nsupport functions from ideals (TODO: figure out the correct category for the domain\nof coefficient functions).\n\nI am aware that this is not a small task and might not be easily possible in python.\nBut I hope you get the idea of what I had in mind...",
    "created_at": "2015-03-25T19:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212107",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:24'></a>rws:

I'm in particular hoping for an exact implementation of arithmetic/multiplicative functions:

```
id = ArithmeticFunctions().id()
sigma0 = ArithmeticFunction(lambda n: sigma0(n))
id*id == sigma0 // Dirichlet convolution
```

...

```
f = DirichletSeries(id)*DirichletSeries(id)
f == DirichletSeries(sigma0)
f[91234154]
f // nice representations:
=> sum_{n in Z} (sum_{d|n} 1)
or: sum_{n in Z} sigma0(n)
```

...

Those certainly form a nice subset of possible coefficient functions / dirichlet series.
More generally I was hoping for the possibility to specify Dirichlet series /
coefficient functions exactly, not only up to some precision.
E.g. (bad example) DirichletSeries(lambda n: sin(n))
or e.g. by specifying an (exact) generating series as e.g. a rational function

Calculating the n'th coefficient from these to get a DirichletSeries as now
is at least rather simple.

Other ideas: exact verification of identities (not only up to precision),
nice representations/output of coefficient functions after operations (hard),
support functions from ideals (TODO: figure out the correct category for the domain
of coefficient functions).

I am aware that this is not a small task and might not be easily possible in python.
But I hope you get the idea of what I had in mind...



---

archive/issue_comments_212108.json:
```json
{
    "body": "<a id='comment:25'></a>That is probably a bit beyond this ticket, though maybe not.  It would be nice to have such \"symbolic\" ones too.",
    "created_at": "2015-03-25T20:24:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212108",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:25'></a>That is probably a bit beyond this ticket, though maybe not.  It would be nice to have such "symbolic" ones too.



---

archive/issue_comments_212109.json:
```json
{
    "body": "<a id='comment:26'></a>Replying to [comment:24 jj]:\n> {{{\n> f = DirichletSeries(id)*DirichletSeries(id)\n> f == DirichletSeries(sigma0)\n> f[91234154]\n> f // nice representations:\n> => sum_{n in Z} (sum_{d|n} 1)\n> or: sum_{n in Z} sigma0(n)\n> }}}\n> nice representations/output of coefficient functions after operations (hard),\n\nThat would first need conversion of the g.f. into divisor sum form. Another ticket.\n> {{{\n> id = ArithmeticFunctions().id()\n> sigma0 = ArithmeticFunction(lambda n: sigma0(n))\n> id*id == sigma0 // Dirichlet convolution\n> }}}\n\nThat would need ability to compute a g.f. from the coefficients. I think this is possible but hard.\n> support functions from ideals (TODO: figure out the correct category for the domain\n> of coefficient functions).\n\nAnd a third ticket.\n\nSo this ticket would prepare for the others by providing creation from expressions of a limited form (polynomial fractions with generator from `zeta(a*s+b)` and `L(c)`).",
    "created_at": "2015-03-26T09:29:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212109",
    "user": "https://github.com/rwst"
}
```

<a id='comment:26'></a>Replying to [comment:24 jj]:
> {{{
> f = DirichletSeries(id)*DirichletSeries(id)
> f == DirichletSeries(sigma0)
> f[91234154]
> f // nice representations:
> => sum_{n in Z} (sum_{d|n} 1)
> or: sum_{n in Z} sigma0(n)
> }}}
> nice representations/output of coefficient functions after operations (hard),

That would first need conversion of the g.f. into divisor sum form. Another ticket.
> {{{
> id = ArithmeticFunctions().id()
> sigma0 = ArithmeticFunction(lambda n: sigma0(n))
> id*id == sigma0 // Dirichlet convolution
> }}}

That would need ability to compute a g.f. from the coefficients. I think this is possible but hard.
> support functions from ideals (TODO: figure out the correct category for the domain
> of coefficient functions).

And a third ticket.

So this ticket would prepare for the others by providing creation from expressions of a limited form (polynomial fractions with generator from `zeta(a*s+b)` and `L(c)`).



---

archive/issue_comments_212110.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 rws]:\n> Replying to [comment:24 jj]:\n> > {{{\n> > f = DirichletSeries(id)*DirichletSeries(id)\n> > f == DirichletSeries(sigma0)\n> > f[91234154]\n> > f // nice representations:\n> > => sum_{n in Z} (sum_{d|n} 1)\n> > or: sum_{n in Z} sigma0(n)\n> > }}}\n> > nice representations/output of coefficient functions after operations (hard),\n\n> That would first need conversion of the g.f. into divisor sum form. Another ticket.\n>\n\n\nThere are (at least) two different (exact) approaches:\n- Coefficient functions\n- Generating functions (as q-series?), I am not entirely sure what you mean by it...\n\nI was emphasizing on the coefficient function part.\nClearly it is possible to define dirichlet series by specifying the coefficient function (as a normal function). It is even relatively simple to implement all kind of operations.\nIndividual coefficients could also be calculated (up to some precision).\nWhat is hard is getting a \"nice representation\" (e.g. a divisor sum form as you mentioned above).\n- One idea might be to somehow \"decompile\" a function into source code / some at least nicer form.\n- One idea might be to use symbolic expression (rather limited).\n- Another idea might be to implement very basic coefficient functions and allow all kind of operations with them (using ast(?)/whatever) to be as flexible as possible with the combinations (include as many of the popular examples as possible).\n- Finally we could simply use the old representation by just calculating the coefficients up to some precision. The advantage would be that \"precision\" is no longer part of the series, only of the representation.\n\n> > {{{\n> > id = ArithmeticFunctions().id()\n> > sigma0 = ArithmeticFunction(lambda n: sigma0(n))\n> > id*id == sigma0 // Dirichlet convolution\n> > }}}\n\n> That would need ability to compute a g.f. from the coefficients. I think this is possible but hard.\n\nThe relation between coefficient functions and generating series might be a challenge. I wonder what approach is more suitable. Maybe the two concepts both have interesting cases that cannot easily be translated to the other way. So maybe both ways should be supported (?).\n\n> > support functions from ideals (TODO: figure out the correct category for the domain\n> > of coefficient functions).\n\n> And a third ticket.\n> \n> So this ticket would prepare for the others by providing creation from expressions of a limited form (polynomial fractions with generator from `zeta(a*s+b)` and `L(c)`).\n\n\nI was thinking in very general terms (\"any\" function from Z). That should be fairly simple (even with operations on series) and allow the calculation of the coefficients up to an arbitrary precision. Example:\n\n```\n(F+G).cf = lambda n: F.cf(n) + G.cf(n)\n(F*G).cf = lambda n: sum(F.cf(d)*G.cf(n/d) for d in divisors(n))\n```\n\nHowever it will be very hard to get \"nice\" representation of the coefficient functions.\n\nMaybe \"polynomial fractions with genertore from zeta(a*s+b) and L(c)\" is more powerful, I don't know.\n\nSide remark: *Dirichlet series* could/should be viewed as something like a *Fourier transform* of an *Arithmetic function*.",
    "created_at": "2015-03-26T19:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212110",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:27'></a>Replying to [comment:26 rws]:
> Replying to [comment:24 jj]:
> > {{{
> > f = DirichletSeries(id)*DirichletSeries(id)
> > f == DirichletSeries(sigma0)
> > f[91234154]
> > f // nice representations:
> > => sum_{n in Z} (sum_{d|n} 1)
> > or: sum_{n in Z} sigma0(n)
> > }}}
> > nice representations/output of coefficient functions after operations (hard),

> That would first need conversion of the g.f. into divisor sum form. Another ticket.
>


There are (at least) two different (exact) approaches:
- Coefficient functions
- Generating functions (as q-series?), I am not entirely sure what you mean by it...

I was emphasizing on the coefficient function part.
Clearly it is possible to define dirichlet series by specifying the coefficient function (as a normal function). It is even relatively simple to implement all kind of operations.
Individual coefficients could also be calculated (up to some precision).
What is hard is getting a "nice representation" (e.g. a divisor sum form as you mentioned above).
- One idea might be to somehow "decompile" a function into source code / some at least nicer form.
- One idea might be to use symbolic expression (rather limited).
- Another idea might be to implement very basic coefficient functions and allow all kind of operations with them (using ast(?)/whatever) to be as flexible as possible with the combinations (include as many of the popular examples as possible).
- Finally we could simply use the old representation by just calculating the coefficients up to some precision. The advantage would be that "precision" is no longer part of the series, only of the representation.

> > {{{
> > id = ArithmeticFunctions().id()
> > sigma0 = ArithmeticFunction(lambda n: sigma0(n))
> > id*id == sigma0 // Dirichlet convolution
> > }}}

> That would need ability to compute a g.f. from the coefficients. I think this is possible but hard.

The relation between coefficient functions and generating series might be a challenge. I wonder what approach is more suitable. Maybe the two concepts both have interesting cases that cannot easily be translated to the other way. So maybe both ways should be supported (?).

> > support functions from ideals (TODO: figure out the correct category for the domain
> > of coefficient functions).

> And a third ticket.
> 
> So this ticket would prepare for the others by providing creation from expressions of a limited form (polynomial fractions with generator from `zeta(a*s+b)` and `L(c)`).


I was thinking in very general terms ("any" function from Z). That should be fairly simple (even with operations on series) and allow the calculation of the coefficients up to an arbitrary precision. Example:

```
(F+G).cf = lambda n: F.cf(n) + G.cf(n)
(F*G).cf = lambda n: sum(F.cf(d)*G.cf(n/d) for d in divisors(n))
```

However it will be very hard to get "nice" representation of the coefficient functions.

Maybe "polynomial fractions with genertore from zeta(a*s+b) and L(c)" is more powerful, I don't know.

Side remark: *Dirichlet series* could/should be viewed as something like a *Fourier transform* of an *Arithmetic function*.



---

archive/issue_comments_212111.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 jj]:\n> - Generating functions (as q-series?), I am not entirely sure what you mean by it...\n \nSee https://en.wikipedia.org/wiki/Generating_function#Dirichlet_series_generating_functions",
    "created_at": "2015-03-27T06:48:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212111",
    "user": "https://github.com/rwst"
}
```

<a id='comment:28'></a>Replying to [comment:27 jj]:
> - Generating functions (as q-series?), I am not entirely sure what you mean by it...
 
See https://en.wikipedia.org/wiki/Generating_function#Dirichlet_series_generating_functions



---

archive/issue_comments_212112.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 rws]:\n> Replying to [comment:27 jj]:\n> > - Generating functions (as q-series?), I am not entirely sure what you mean by it...\n \n> See https://en.wikipedia.org/wiki/Generating_function#Dirichlet_series_generating_functions\n\nYes but that doesn't explain how the g.f. is implemented (in an exact way).\nFor some families of Dirichlet series the corresponding ordinary (or exponential)\ngenerating series could be stored as a rational function (e.g. 1/(1-q)).\n\nI assumed you meant this when refering to g.f.\nHow else could you store the g.f. in an exact matter?",
    "created_at": "2015-03-27T15:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212112",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:29'></a>Replying to [comment:28 rws]:
> Replying to [comment:27 jj]:
> > - Generating functions (as q-series?), I am not entirely sure what you mean by it...
 
> See https://en.wikipedia.org/wiki/Generating_function#Dirichlet_series_generating_functions

Yes but that doesn't explain how the g.f. is implemented (in an exact way).
For some families of Dirichlet series the corresponding ordinary (or exponential)
generating series could be stored as a rational function (e.g. 1/(1-q)).

I assumed you meant this when refering to g.f.
How else could you store the g.f. in an exact matter?



---

archive/issue_comments_212113.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:29 jj]:\n> How else could you store the g.f. in an exact matter?\n\nNearly all D.g.f.'s I have seen (and certainly all that generate your arithmetic functions) are polynomials in A. `zeta(as+b)`, B. `L(chi(c,d), s)`, C. `(1-e^(-s+f))`, with a,b,c,d,e,f integer. Okay, this is not a proof, but well supported by data in the OEIS. So I want to store that polynomial.",
    "created_at": "2015-03-27T15:17:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212113",
    "user": "https://github.com/rwst"
}
```

<a id='comment:30'></a>Replying to [comment:29 jj]:
> How else could you store the g.f. in an exact matter?

Nearly all D.g.f.'s I have seen (and certainly all that generate your arithmetic functions) are polynomials in A. `zeta(as+b)`, B. `L(chi(c,d), s)`, C. `(1-e^(-s+f))`, with a,b,c,d,e,f integer. Okay, this is not a proof, but well supported by data in the OEIS. So I want to store that polynomial.



---

archive/issue_comments_212114.json:
```json
{
    "body": "<a id='comment:31'></a>I agree that both of these representations are useful and desired.  Would it be possible to implement the basics here - esp. since it turns out Pari has a lot of the functionality we need - and then put the generating function stuff (which I would also use) in a separate ticket?  I'm just concerned that this will never happen despite a lot of enthusiasm.",
    "created_at": "2015-03-27T16:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212114",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:31'></a>I agree that both of these representations are useful and desired.  Would it be possible to implement the basics here - esp. since it turns out Pari has a lot of the functionality we need - and then put the generating function stuff (which I would also use) in a separate ticket?  I'm just concerned that this will never happen despite a lot of enthusiasm.



---

archive/issue_comments_212115.json:
```json
{
    "body": "<a id='comment:32'></a>Unfortunately experience shows that this concern is well founded.\nSo yes, I agree.",
    "created_at": "2015-03-28T16:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212115",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:32'></a>Unfortunately experience shows that this concern is well founded.
So yes, I agree.



---

archive/issue_comments_212116.json:
```json
{
    "body": "<a id='comment:33'></a>Just for your information:\n\nI started some preliminary (poc) test implementation of arithmetic functions (no tests/documentation etc). The first idea was to use symbolic expressions but they don't work well together with sums which are absolutely crucial for operations on arithmetic functions...\n\nThe test implementation is available on u/jj/arith_functions:\n\nhttp://git.sagemath.org/sage.git/commit/?id=526e1ae40f94cff95e5dc6926208b831643edfb4\n\nHere is a simple example:\n\n```\nsigma3 = ArithmeticFunction(lambda n: sigma(n,3), lambda n,_: \"sigma({},3)\".format(n), lambda n,_: \"\\\\sigma_{{3}}\\\\left({}\\\\right)\".format(n))\nsigma3^2\nshow(sigma3^2)\n(sigma3^2)(5)\n```",
    "created_at": "2015-03-30T16:48:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212116",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:33'></a>Just for your information:

I started some preliminary (poc) test implementation of arithmetic functions (no tests/documentation etc). The first idea was to use symbolic expressions but they don't work well together with sums which are absolutely crucial for operations on arithmetic functions...

The test implementation is available on u/jj/arith_functions:

http://git.sagemath.org/sage.git/commit/?id=526e1ae40f94cff95e5dc6926208b831643edfb4

Here is a simple example:

```
sigma3 = ArithmeticFunction(lambda n: sigma(n,3), lambda n,_: "sigma({},3)".format(n), lambda n,_: "\\sigma_{{3}}\\left({}\\right)".format(n))
sigma3^2
show(sigma3^2)
(sigma3^2)(5)
```



---

archive/issue_comments_212117.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:33 jj]:\n> I started some preliminary (poc) test implementation of arithmetic functions (no tests/documentation etc).\n> \n> http://git.sagemath.org/sage.git/commit/?id=526e1ae40f94cff95e5dc6926208b831643edfb4\n\n\nI think you should open an enhancement ticket for this branch, just to make it possible to discuss specifics. Note: I am supporting your effort of formulating the algebraic side of these functions. Note too that Dirichlet series represent a superset of these functions, so your code cannot serve as the parent ring implementation of this ticket, and a different ticket is needed.",
    "created_at": "2015-03-31T08:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212117",
    "user": "https://github.com/rwst"
}
```

<a id='comment:34'></a>Replying to [comment:33 jj]:
> I started some preliminary (poc) test implementation of arithmetic functions (no tests/documentation etc).
> 
> http://git.sagemath.org/sage.git/commit/?id=526e1ae40f94cff95e5dc6926208b831643edfb4


I think you should open an enhancement ticket for this branch, just to make it possible to discuss specifics. Note: I am supporting your effort of formulating the algebraic side of these functions. Note too that Dirichlet series represent a superset of these functions, so your code cannot serve as the parent ring implementation of this ticket, and a different ticket is needed.



---

archive/issue_comments_212118.json:
```json
{
    "body": "<a id='comment:35'></a>Ok, I created a ticket: http://trac.sagemath.org/ticket/18102\n\nRegarding Dirichlet series: It seems that rational functions (over what?) might provide a nice (internal) basis for how (exact) Dirichlet series are stored. The coefficients can be calculated and it should be possible to automatically define a corresponding coefficient function. This would still benefit from a nice base class for arithmetic functions (in particular since we know to construct/represent the coefficient function, this additional information could be \"passed on\" to / used by the arithmetic function element).",
    "created_at": "2015-04-01T21:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212118",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:35'></a>Ok, I created a ticket: http://trac.sagemath.org/ticket/18102

Regarding Dirichlet series: It seems that rational functions (over what?) might provide a nice (internal) basis for how (exact) Dirichlet series are stored. The coefficients can be calculated and it should be possible to automatically define a corresponding coefficient function. This would still benefit from a nice base class for arithmetic functions (in particular since we know to construct/represent the coefficient function, this additional information could be "passed on" to / used by the arithmetic function element).



---

archive/issue_comments_212119.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-12T09:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212119",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212120.json:
```json
{
    "body": "<a id='comment:37'></a>This version now supports generating functions of a certain form. Please see the documentation. This should suffice as a first version. Further development possibilities were already discussed in this ticket.\n\nPlease review.\n\n---\nNew commits:",
    "created_at": "2015-04-12T09:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212120",
    "user": "https://github.com/rwst"
}
```

<a id='comment:37'></a>This version now supports generating functions of a certain form. Please see the documentation. This should suffice as a first version. Further development possibilities were already discussed in this ticket.

Please review.

---
New commits:



---

archive/issue_events_048426.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-04-12T09:10:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-wishlist",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48426"
}
```



---

archive/issue_events_048427.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-04-12T09:10:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48427"
}
```



---

archive/issue_comments_212121.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-12T11:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212121",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212122.json:
```json
{
    "body": "<a id='comment:38'></a>Hello,\n\n1. there is no need to add method `dirmul` and `dirdiv` to the pari `gen` object. This is taken care automatically since #17631. Doctesting is cool thoug. But move it somewhere else.\n\n2. Why is this new module in `sage.modular`? It makes no sense.\n\n3. You should try harder to use `pari` and not `gp`. Since #17631, most functions are available directly in `pari`.\n\n4. `DirichletSeries` would better inherit from `RingElement`. In that case, you must not define `__add__`, `__mul__`, `__div__` etc but `_add_`, `_mul_`, `_div_`. That way you will get benefits from coercion (e.g. multiplication by scalars). You might have a look to polynomials (in `sage.rings.polynomials.*` or power series (in `sage.rings.power_series_*`).\n\n5. What is the purpose of the commented code?\n\n6. The error must be new style ones. Please use\n\n```\n    raise MyError(\"my message\")\n```\n  instead of\n\n```\n    raise MyError, \"my message\"\n```\n\nVincent",
    "created_at": "2015-04-12T11:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212122",
    "user": "https://github.com/videlec"
}
```

<a id='comment:38'></a>Hello,

1. there is no need to add method `dirmul` and `dirdiv` to the pari `gen` object. This is taken care automatically since #17631. Doctesting is cool thoug. But move it somewhere else.

2. Why is this new module in `sage.modular`? It makes no sense.

3. You should try harder to use `pari` and not `gp`. Since #17631, most functions are available directly in `pari`.

4. `DirichletSeries` would better inherit from `RingElement`. In that case, you must not define `__add__`, `__mul__`, `__div__` etc but `_add_`, `_mul_`, `_div_`. That way you will get benefits from coercion (e.g. multiplication by scalars). You might have a look to polynomials (in `sage.rings.polynomials.*` or power series (in `sage.rings.power_series_*`).

5. What is the purpose of the commented code?

6. The error must be new style ones. Please use

```
    raise MyError("my message")
```
  instead of

```
    raise MyError, "my message"
```

Vincent



---

archive/issue_comments_212123.json:
```json
{
    "body": "<a id='comment:39'></a>Replying to [comment:38 vdelecroix]:\n\nThanks, I accept points 1 and 6 but:\n\n> 2. Why is this new module in `sage.modular`? It makes no sense.\n  \nThe Dirichlet characters are there too. I don't see why not.\n\n> 3. You should try harder to use `pari` and not `gp`. Since #17631, most functions are available directly in `pari`.\n  \nBut not those needing closures, see comment:16 and #18038\n\n> 4. `DirichletSeries` would better inherit from `RingElement`. In that case, you must not define `__add__`, `__mul__`, `__div__` etc but `_add_`, `_mul_`, `_div_`. That way you will get benefits from coercion (e.g. multiplication by scalars). You might have a look to polynomials (in `sage.rings.polynomials.*` or power series (in `sage.rings.power_series_*`).\n  \nThis is clearly a separate ticket.\n\n> 5. What is the purpose of the commented code?\n  \nI didn't want to erase useful ideas of the original author.",
    "created_at": "2015-04-12T12:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212123",
    "user": "https://github.com/rwst"
}
```

<a id='comment:39'></a>Replying to [comment:38 vdelecroix]:

Thanks, I accept points 1 and 6 but:

> 2. Why is this new module in `sage.modular`? It makes no sense.
  
The Dirichlet characters are there too. I don't see why not.

> 3. You should try harder to use `pari` and not `gp`. Since #17631, most functions are available directly in `pari`.
  
But not those needing closures, see comment:16 and #18038

> 4. `DirichletSeries` would better inherit from `RingElement`. In that case, you must not define `__add__`, `__mul__`, `__div__` etc but `_add_`, `_mul_`, `_div_`. That way you will get benefits from coercion (e.g. multiplication by scalars). You might have a look to polynomials (in `sage.rings.polynomials.*` or power series (in `sage.rings.power_series_*`).
  
This is clearly a separate ticket.

> 5. What is the purpose of the commented code?
  
I didn't want to erase useful ideas of the original author.



---

archive/issue_comments_212124.json:
```json
{
    "body": "<a id='comment:40'></a>Hello,\n\nReplying to [comment:39 rws]:\n> Replying to [comment:38 vdelecroix]:\n> \n> > 2. Why is this new module in `sage.modular`? It makes no sense.\n  \n> The Dirichlet characters are there too. I don't see why not.\n\nBecause `sage.modular` is intended for modular forms. A Dirichlet serie is not necessarily a modular form. To me, modules and submodules should work by inclusion. Or at least try to.\n\nI do not see Dirichlet series as a subset of modular forms. I perfectly understand the reason why it is here, but it would be better in `sage.functions` or `sage.rings`. The directory `sage.modular` really contains too much stuff. This is historical as people that initiated Sage were very interested in modular forms.\n\n> > 3. You should try harder to use `pari` and not `gp`. Since #17631, most functions are available directly in `pari`.\n  \n> But not those needing closures, see comment:16 and #18038\n\nI see! Do you mind adding a comment in the docstring saying that as soon as #18038 is ready, this can be modified?\n\n> > 5. What is the purpose of the commented code?\n  \n> I didn't want to erase useful ideas of the original author.\n\nWhy letting it commented then?\n\nVincent",
    "created_at": "2015-04-12T13:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212124",
    "user": "https://github.com/videlec"
}
```

<a id='comment:40'></a>Hello,

Replying to [comment:39 rws]:
> Replying to [comment:38 vdelecroix]:
> 
> > 2. Why is this new module in `sage.modular`? It makes no sense.
  
> The Dirichlet characters are there too. I don't see why not.

Because `sage.modular` is intended for modular forms. A Dirichlet serie is not necessarily a modular form. To me, modules and submodules should work by inclusion. Or at least try to.

I do not see Dirichlet series as a subset of modular forms. I perfectly understand the reason why it is here, but it would be better in `sage.functions` or `sage.rings`. The directory `sage.modular` really contains too much stuff. This is historical as people that initiated Sage were very interested in modular forms.

> > 3. You should try harder to use `pari` and not `gp`. Since #17631, most functions are available directly in `pari`.
  
> But not those needing closures, see comment:16 and #18038

I see! Do you mind adding a comment in the docstring saying that as soon as #18038 is ready, this can be modified?

> > 5. What is the purpose of the commented code?
  
> I didn't want to erase useful ideas of the original author.

Why letting it commented then?

Vincent



---

archive/issue_comments_212125.json:
```json
{
    "body": "<a id='comment:41'></a>Replying to [comment:40 vdelecroix]:\n> Hello,\n> \n> Replying to [comment:39 rws]:\n> > Replying to [comment:38 vdelecroix]:\n> > \n> > > 2. Why is this new module in `sage.modular`? It makes no sense.\n  \n> > The Dirichlet characters are there too. I don't see why not.\n> \n> Because `sage.modular` is intended for modular forms. A Dirichlet serie is not necessarily a modular form. To me, modules and submodules should work by inclusion. Or at least try to.\n> \n> I do not see Dirichlet series as a subset of modular forms. I perfectly understand the reason why it is here, but it would be better in `sage.functions` or `sage.rings`. The directory `sage.modular` really contains too much stuff. This is historical as people that initiated Sage were very interested in modular forms.\n\n\nWhat do you think of `sage.lfunctions`?\n\nVincent",
    "created_at": "2015-04-13T14:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212125",
    "user": "https://github.com/videlec"
}
```

<a id='comment:41'></a>Replying to [comment:40 vdelecroix]:
> Hello,
> 
> Replying to [comment:39 rws]:
> > Replying to [comment:38 vdelecroix]:
> > 
> > > 2. Why is this new module in `sage.modular`? It makes no sense.
  
> > The Dirichlet characters are there too. I don't see why not.
> 
> Because `sage.modular` is intended for modular forms. A Dirichlet serie is not necessarily a modular form. To me, modules and submodules should work by inclusion. Or at least try to.
> 
> I do not see Dirichlet series as a subset of modular forms. I perfectly understand the reason why it is here, but it would be better in `sage.functions` or `sage.rings`. The directory `sage.modular` really contains too much stuff. This is historical as people that initiated Sage were very interested in modular forms.


What do you think of `sage.lfunctions`?

Vincent



---

archive/issue_comments_212126.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:41 vdelecroix]:\n> What do you think of `sage.lfunctions`?\n\nWhat else would you put in there (I have no idea myself)?",
    "created_at": "2015-04-13T14:35:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212126",
    "user": "https://github.com/rwst"
}
```

<a id='comment:42'></a>Replying to [comment:41 vdelecroix]:
> What do you think of `sage.lfunctions`?

What else would you put in there (I have no idea myself)?



---

archive/issue_comments_212127.json:
```json
{
    "body": "<a id='comment:43'></a>Replying to [comment:42 rws]:\n> Replying to [comment:41 vdelecroix]:\n> > What do you think of `sage.lfunctions`?\n\n> What else would you put in there (I have no idea myself)?\n\nYou can first have a look to what is already in.",
    "created_at": "2015-04-13T14:41:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212127",
    "user": "https://github.com/videlec"
}
```

<a id='comment:43'></a>Replying to [comment:42 rws]:
> Replying to [comment:41 vdelecroix]:
> > What do you think of `sage.lfunctions`?

> What else would you put in there (I have no idea myself)?

You can first have a look to what is already in.



---

archive/issue_comments_212128.json:
```json
{
    "body": "<a id='comment:44'></a>I vaguely remember having had a look at some time but now I see you're right.",
    "created_at": "2015-04-13T14:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212128",
    "user": "https://github.com/rwst"
}
```

<a id='comment:44'></a>I vaguely remember having had a look at some time but now I see you're right.



---

archive/issue_comments_212129.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:44 rws]:\n> I vaguely remember having had a look at some time but now I see you're right.\n\n\nNote that L-function / L-series usual refer to functions / series satisfying\nsome very specific (more restrictive) set of axioms (AC/FE/etc) - in contrast\nto Dirichlet series or abstract Dirichlet series. So there is definitely some\njustification for introducing a new class (at least if it supports exact\nrepresentation).\n\nAlso if I remember correctly the L-function is not an exact representation but\nalso restricted by precision. What I would like to see is support for exact\nabstract Dirichlet series, e.g. by using symbolic coefficient functions or\nby using exact generating series in terms of rational functions.\n\nIf they are not implemented in an exact way I am curious about the background:\nHow / in what context will they be used? Why is a new class required?\n\nIn any case I agree that Dirichlet series don't belong to sage.modular.\n\nBest\n    Jonas",
    "created_at": "2015-04-13T15:03:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212129",
    "user": "https://github.com/jjermann"
}
```

<a id='comment:45'></a>Replying to [comment:44 rws]:
> I vaguely remember having had a look at some time but now I see you're right.


Note that L-function / L-series usual refer to functions / series satisfying
some very specific (more restrictive) set of axioms (AC/FE/etc) - in contrast
to Dirichlet series or abstract Dirichlet series. So there is definitely some
justification for introducing a new class (at least if it supports exact
representation).

Also if I remember correctly the L-function is not an exact representation but
also restricted by precision. What I would like to see is support for exact
abstract Dirichlet series, e.g. by using symbolic coefficient functions or
by using exact generating series in terms of rational functions.

If they are not implemented in an exact way I am curious about the background:
How / in what context will they be used? Why is a new class required?

In any case I agree that Dirichlet series don't belong to sage.modular.

Best
    Jonas



---

archive/issue_comments_212130.json:
```json
{
    "body": "<a id='comment:46'></a>Hello Jonas,\n\nReplying to [comment:45 jj]:\n\nThanks for your input. After reading your comment I think that one reasonable option is to create a new module `dirichlet_series` and move `lfunctions` in there. What do you think?\n\nVincent",
    "created_at": "2015-04-13T15:13:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212130",
    "user": "https://github.com/videlec"
}
```

<a id='comment:46'></a>Hello Jonas,

Replying to [comment:45 jj]:

Thanks for your input. After reading your comment I think that one reasonable option is to create a new module `dirichlet_series` and move `lfunctions` in there. What do you think?

Vincent



---

archive/issue_comments_212131.json:
```json
{
    "body": "<a id='comment:47'></a>I'm not sure that would be as useful of a top-level module, and might break some existing code that imports them.  I agree it would be confusing to have this in `lfunctions`, but not as confusing as having it somewhere else!",
    "created_at": "2015-04-13T15:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212131",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:47'></a>I'm not sure that would be as useful of a top-level module, and might break some existing code that imports them.  I agree it would be confusing to have this in `lfunctions`, but not as confusing as having it somewhere else!



---

archive/issue_comments_212132.json:
```json
{
    "body": "<a id='comment:48'></a>Replying to [comment:47 kcrisman]:\n> I'm not sure that would be as useful of a top-level module, and might break some existing code that imports them.  I agree it would be confusing to have this in `lfunctions`, but not as confusing as having it somewhere else!\n\n\nIt is not a problem to keep the old `lfunctions` module as an alias for `dirichlet_series.lfunctions` (if we really care, there can be a deprecated alias). But for matter of code organisation that would be better to have `lfunctions` included in `dirichlet_series`.\n\nVincent",
    "created_at": "2015-04-13T15:18:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212132",
    "user": "https://github.com/videlec"
}
```

<a id='comment:48'></a>Replying to [comment:47 kcrisman]:
> I'm not sure that would be as useful of a top-level module, and might break some existing code that imports them.  I agree it would be confusing to have this in `lfunctions`, but not as confusing as having it somewhere else!


It is not a problem to keep the old `lfunctions` module as an alias for `dirichlet_series.lfunctions` (if we really care, there can be a deprecated alias). But for matter of code organisation that would be better to have `lfunctions` included in `dirichlet_series`.

Vincent



---

archive/issue_comments_212133.json:
```json
{
    "body": "<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-14T08:31:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212133",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212134.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-14T08:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212134",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212135.json:
```json
{
    "body": "<a id='comment:50'></a>That addresses all discussed issues save the new module, which IMHO should be a separate ticket and discussed on sage-devel.",
    "created_at": "2015-04-14T08:33:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212135",
    "user": "https://github.com/rwst"
}
```

<a id='comment:50'></a>That addresses all discussed issues save the new module, which IMHO should be a separate ticket and discussed on sage-devel.



---

archive/issue_comments_212136.json:
```json
{
    "body": "<a id='comment:51'></a>Hello,\n\nThanks for moving it! You need to add an entry to your new file to get it included in the documentation (this is one line in `$SAGE_ROOT/doc/en/reference/lfunctions/index.rst`).\n\nVincent",
    "created_at": "2015-04-14T08:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212136",
    "user": "https://github.com/videlec"
}
```

<a id='comment:51'></a>Hello,

Thanks for moving it! You need to add an entry to your new file to get it included in the documentation (this is one line in `$SAGE_ROOT/doc/en/reference/lfunctions/index.rst`).

Vincent



---

archive/issue_comments_212137.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-14T09:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212137",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212138.json:
```json
{
    "body": "<a id='comment:52'></a>Hello,\n\n6 more questions/issues.\n\n7. Why are you importing the alias `dirichlet_series` and not `DirichletSeries` in the global namespace?\n\n8. How do I get the coefficients of the Dirichlet L functions obtained with the command `dirichlet_L(3,2,s)`?\n\n9. There are several issues with the documentation:\n   - you forgot `::` at line 107 (in `DirichletSeries` class documentation).\n   - the `INPUT` block does not follow the convention (see the developer guide, section Documentation String)\n   - doctests are missing from many important functions (e.g. `base_ring`, `is_Eulerian`, `has_infinite_precision`, `list`)\n\n10. In `__mul__` I do not understand\n\n```\nR = self.base_ring() \ntry: \n    _ = RR(other)\n```\n  Did you want to write `R(other)`? If so it is very wrong since if you multiply `2.0` with a Dirichlet serie with rational coefficients you would end up with rational coefficients as\n\n```\nsage: QQ(3.2314)\n16157/5000\n```\n  You should really use coercion here (i.e. the item 4 in [comment:38 comment:38]) or do stronger type check such as `parent(other) is self.base_ring()`.\n\n11. This should work\n\n```\nsage: D1 = dirichlet_series([1,1,1])\nsage: D1 + 1\nTraceback (most recent call last):\n...\n```\n(also related to item 4 in [comment:38 comment:38]).\n\n12. What is the purpose of this nested `MaskFunction` class?\n\nVincent",
    "created_at": "2015-04-14T09:22:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212138",
    "user": "https://github.com/videlec"
}
```

<a id='comment:52'></a>Hello,

6 more questions/issues.

7. Why are you importing the alias `dirichlet_series` and not `DirichletSeries` in the global namespace?

8. How do I get the coefficients of the Dirichlet L functions obtained with the command `dirichlet_L(3,2,s)`?

9. There are several issues with the documentation:
   - you forgot `::` at line 107 (in `DirichletSeries` class documentation).
   - the `INPUT` block does not follow the convention (see the developer guide, section Documentation String)
   - doctests are missing from many important functions (e.g. `base_ring`, `is_Eulerian`, `has_infinite_precision`, `list`)

10. In `__mul__` I do not understand

```
R = self.base_ring() 
try: 
    _ = RR(other)
```
  Did you want to write `R(other)`? If so it is very wrong since if you multiply `2.0` with a Dirichlet serie with rational coefficients you would end up with rational coefficients as

```
sage: QQ(3.2314)
16157/5000
```
  You should really use coercion here (i.e. the item 4 in [comment:38 comment:38]) or do stronger type check such as `parent(other) is self.base_ring()`.

11. This should work

```
sage: D1 = dirichlet_series([1,1,1])
sage: D1 + 1
Traceback (most recent call last):
...
```
(also related to item 4 in [comment:38 comment:38]).

12. What is the purpose of this nested `MaskFunction` class?

Vincent



---

archive/issue_comments_212139.json:
```json
{
    "body": "<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-14T14:53:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212139",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212140.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:52 vdelecroix]:\n> 8. How do I get the coefficients of the Dirichlet L functions obtained with the command `dirichlet_L(3,2,s)`?\n  \nAnalogous to polynomial coefficients, now added as example:\n\n```\nsage: D=dirichlet_series(dirichlet_L(3,2,s))\nsage: D.list()\n[1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1]\nsage: D.list(5)\n[1, -1, 0, 1, -1]\n```\n> 10. In `__mul__` I do not understand\n> \n> ```\n> R = self.base_ring() \n> try: \n>     _ = RR(other)\n> ```\n>   Did you want to write `R(other)`?\n\nI haven't looked extensively at Jon's code as long as it worked.\n>   You should really use coercion here (i.e. the item 4 in [comment:38 comment:38]) or do stronger type check such as `parent(other) is self.base_ring()`.\n\n\n> 11. This should work\n> \n> ```\n> sage: D1 = dirichlet_series([1,1,1])\n> sage: D1 + 1\n> Traceback (most recent call last):\n> ...\n> ```\n\nNo, this is a feature request. With this ticket you can do as well:\n\n```\nsage: D1 = dirichlet_series([1,1,1])\nsage: one = dirichlet_series(1)\nsage: D1 + one                                                                          \n2 + 1/(2^s) + 1/(3^s) + O(4^(-s))                                                       \n```\n> 12. What is the purpose of this nested `MaskFunction` class?\n  \nAs this is only of developer interest I added at l.156: \n\n```\n                # the specific form of the factors returned by Maxima\n                # (see ticket #18081) makes masking necessary\n                arg = dirichlet_series._mask_exp_factors(arg)\n```\nThe rest should be addressed with the latest commit.",
    "created_at": "2015-04-14T14:55:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212140",
    "user": "https://github.com/rwst"
}
```

<a id='comment:54'></a>Replying to [comment:52 vdelecroix]:
> 8. How do I get the coefficients of the Dirichlet L functions obtained with the command `dirichlet_L(3,2,s)`?
  
Analogous to polynomial coefficients, now added as example:

```
sage: D=dirichlet_series(dirichlet_L(3,2,s))
sage: D.list()
[1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1, 0, 1, -1]
sage: D.list(5)
[1, -1, 0, 1, -1]
```
> 10. In `__mul__` I do not understand
> 
> ```
> R = self.base_ring() 
> try: 
>     _ = RR(other)
> ```
>   Did you want to write `R(other)`?

I haven't looked extensively at Jon's code as long as it worked.
>   You should really use coercion here (i.e. the item 4 in [comment:38 comment:38]) or do stronger type check such as `parent(other) is self.base_ring()`.


> 11. This should work
> 
> ```
> sage: D1 = dirichlet_series([1,1,1])
> sage: D1 + 1
> Traceback (most recent call last):
> ...
> ```

No, this is a feature request. With this ticket you can do as well:

```
sage: D1 = dirichlet_series([1,1,1])
sage: one = dirichlet_series(1)
sage: D1 + one                                                                          
2 + 1/(2^s) + 1/(3^s) + O(4^(-s))                                                       
```
> 12. What is the purpose of this nested `MaskFunction` class?
  
As this is only of developer interest I added at l.156: 

```
                # the specific form of the factors returned by Maxima
                # (see ticket #18081) makes masking necessary
                arg = dirichlet_series._mask_exp_factors(arg)
```
The rest should be addressed with the latest commit.



---

archive/issue_comments_212141.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-14T14:55:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212141",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212142.json:
```json
{
    "body": "<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-03T07:11:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212142",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:58'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_212143.json:
```json
{
    "body": "<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-13T08:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212143",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_048428.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-06-13T08:30:17Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48428"
}
```



---

archive/issue_events_048429.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-06-13T08:30:17Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48429"
}
```



---

archive/issue_comments_212144.json:
```json
{
    "body": "<a id='comment:61'></a>What is the status of review on this?  I.e., what does the latest reviewer/author (rws) believe still needs review?  I personally dearly wish for convolution/DP but I think I won't get that on this ticket and better to have this in than not.",
    "created_at": "2016-07-13T17:48:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212144",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:61'></a>What is the status of review on this?  I.e., what does the latest reviewer/author (rws) believe still needs review?  I personally dearly wish for convolution/DP but I think I won't get that on this ticket and better to have this in than not.



---

archive/issue_comments_212145.json:
```json
{
    "body": "Changing keywords from \"moebius, zeta, sigma, euler_phi, euler\" to \"moebius, zeta, sigma, euler_phi, euler, Dirichlet series\".",
    "created_at": "2016-09-09T22:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212145",
    "user": "https://github.com/slel"
}
```

Changing keywords from "moebius, zeta, sigma, euler_phi, euler" to "moebius, zeta, sigma, euler_phi, euler, Dirichlet series".



---

archive/issue_comments_212146.json:
```json
{
    "body": "<a id='comment:64'></a>Squashed, used lazy import, and completed coverage.\n\n---\nNew commits:",
    "created_at": "2017-04-11T15:22:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212146",
    "user": "https://github.com/rwst"
}
```

<a id='comment:64'></a>Squashed, used lazy import, and completed coverage.

---
New commits:



---

archive/issue_events_048430.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-04-11T15:22:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48430"
}
```



---

archive/issue_events_048431.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-04-11T15:22:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48431"
}
```



---

archive/issue_comments_212147.json:
```json
{
    "body": "<a id='comment:65'></a>Curious whether this supports e.g. a Dirichlet series from the M\u00f6bius function (I couldn't find an example like that, other than the evident one where you take the appropriate version of zeta - but that is a theorem, not a series).  \n\nIt looks quite nice.  Ralf, what piece of this would you say still needs review?  After all, I think at least some of it you have in essence reviewed Jon Hanke's work.  So it would be nice to know what would still need a good hard look.\n\nFinal note - I'm confused by the `dummy`.  Is that something from pari or Sage?",
    "created_at": "2017-04-11T15:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212147",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:65'></a>Curious whether this supports e.g. a Dirichlet series from the Möbius function (I couldn't find an example like that, other than the evident one where you take the appropriate version of zeta - but that is a theorem, not a series).  

It looks quite nice.  Ralf, what piece of this would you say still needs review?  After all, I think at least some of it you have in essence reviewed Jon Hanke's work.  So it would be nice to know what would still need a good hard look.

Final note - I'm confused by the `dummy`.  Is that something from pari or Sage?



---

archive/issue_comments_212148.json:
```json
{
    "body": "<a id='comment:66'></a>Replying to [comment:65 kcrisman]:\n> Curious whether this supports e.g. a Dirichlet series from the M\u00f6bius function (I couldn't find an example like that, other than the evident one where you take the appropriate version of zeta - but that is a theorem, not a series).\n\n\nI don't understand. The Dirichlet g.f. of the Moebius function is `1/zeta(s)` via `Sum_{n >= 1} mu(n)/n^s = 1/zeta(s)` so you can get it via:\n\n```\nsage: var('s')\ns\nsage: dirichlet_series(1/zeta(s))\n1 + -1/(2^s) + -1/(3^s) + -1/(5^s) + 1/(6^s) + -1/(7^s) + 1/(10^s) + -1/(11^s) + -1/(13^s) + 1/(14^s) + 1/(15^s) + -1/(17^s) + -1/(19^s) + O(20^(-s))\nsage: _.list()\n[1, -1, -1, 0, -1, 1, -1, 0, 0, 1, -1, 0, -1, 1, 1, 0, -1, 0, -1, 0]\n```\n\n> It looks quite nice.  Ralf, what piece of this would you say still needs review?  After all, I think at least some of it you have in essence reviewed Jon Hanke's work.  So it would be nice to know what would still need a good hard look.\n\n\nThe conversion from g.f. to the form Pari uses for generation is unpublished research. If I insist on a review it will never go into Sage so what do I say? I tested it on all known D.g.f.s collected from the OEIS. But there are surely future cases where it will fail.\n\n> Final note - I'm confused by the `dummy`.  Is that something from pari or Sage?  \n\n\nIt is only used internally for pattern matching. If there is a next version pattern matching will be done in Pynac.",
    "created_at": "2017-04-12T15:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212148",
    "user": "https://github.com/rwst"
}
```

<a id='comment:66'></a>Replying to [comment:65 kcrisman]:
> Curious whether this supports e.g. a Dirichlet series from the Möbius function (I couldn't find an example like that, other than the evident one where you take the appropriate version of zeta - but that is a theorem, not a series).


I don't understand. The Dirichlet g.f. of the Moebius function is `1/zeta(s)` via `Sum_{n >= 1} mu(n)/n^s = 1/zeta(s)` so you can get it via:

```
sage: var('s')
s
sage: dirichlet_series(1/zeta(s))
1 + -1/(2^s) + -1/(3^s) + -1/(5^s) + 1/(6^s) + -1/(7^s) + 1/(10^s) + -1/(11^s) + -1/(13^s) + 1/(14^s) + 1/(15^s) + -1/(17^s) + -1/(19^s) + O(20^(-s))
sage: _.list()
[1, -1, -1, 0, -1, 1, -1, 0, 0, 1, -1, 0, -1, 1, 1, 0, -1, 0, -1, 0]
```

> It looks quite nice.  Ralf, what piece of this would you say still needs review?  After all, I think at least some of it you have in essence reviewed Jon Hanke's work.  So it would be nice to know what would still need a good hard look.


The conversion from g.f. to the form Pari uses for generation is unpublished research. If I insist on a review it will never go into Sage so what do I say? I tested it on all known D.g.f.s collected from the OEIS. But there are surely future cases where it will fail.

> Final note - I'm confused by the `dummy`.  Is that something from pari or Sage?  


It is only used internally for pattern matching. If there is a next version pattern matching will be done in Pynac.



---

archive/issue_comments_212149.json:
```json
{
    "body": "<a id='comment:67'></a>Replying to [comment:66 rws]:\n> Replying to [comment:65 kcrisman]:\n> > Curious whether this supports e.g. a Dirichlet series from the M\u00f6bius function (I couldn't find an example like that, other than the evident one where you take the appropriate version of zeta - but that is a theorem, not a series).\n\n> \n> I don't understand. The Dirichlet g.f. of the Moebius function is `1/zeta(s)` via `Sum_{n >= 1} mu(n)/n^s = 1/zeta(s)` so you can get it via:\n\n\nWhat I meant was precisely that I knew you could do that, but one might want to just plug Moebius in if (say) one didn't know this fact.  (And not just for finitely many values.)  But apparently not, which is fine for now.\n\n> The conversion from g.f. to the form Pari uses for generation is unpublished research. If I insist on a review it will never go into Sage so what do I say? I tested it on all known D.g.f.s collected from the OEIS. But there are surely future cases where it will fail.\n> \n\n\nSure.  I just meant that since this is currently \"needs review\", what things would still need to be looked at?  You can presumably vouch for quite a bit not due to your self.",
    "created_at": "2017-04-13T01:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212149",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:67'></a>Replying to [comment:66 rws]:
> Replying to [comment:65 kcrisman]:
> > Curious whether this supports e.g. a Dirichlet series from the Möbius function (I couldn't find an example like that, other than the evident one where you take the appropriate version of zeta - but that is a theorem, not a series).

> 
> I don't understand. The Dirichlet g.f. of the Moebius function is `1/zeta(s)` via `Sum_{n >= 1} mu(n)/n^s = 1/zeta(s)` so you can get it via:


What I meant was precisely that I knew you could do that, but one might want to just plug Moebius in if (say) one didn't know this fact.  (And not just for finitely many values.)  But apparently not, which is fine for now.

> The conversion from g.f. to the form Pari uses for generation is unpublished research. If I insist on a review it will never go into Sage so what do I say? I tested it on all known D.g.f.s collected from the OEIS. But there are surely future cases where it will fail.
> 


Sure.  I just meant that since this is currently "needs review", what things would still need to be looked at?  You can presumably vouch for quite a bit not due to your self.



---

archive/issue_comments_212150.json:
```json
{
    "body": "<a id='comment:68'></a>Replying to [comment:67 kcrisman]:\n> Sure.  I just meant that since this is currently \"needs review\", what things would still need to be looked at?  You can presumably vouch for quite a bit not due to your self.\n\n\nI think it's ready but I can't set positive, can I?",
    "created_at": "2017-04-13T06:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212150",
    "user": "https://github.com/rwst"
}
```

<a id='comment:68'></a>Replying to [comment:67 kcrisman]:
> Sure.  I just meant that since this is currently "needs review", what things would still need to be looked at?  You can presumably vouch for quite a bit not due to your self.


I think it's ready but I can't set positive, can I?



---

archive/issue_comments_212151.json:
```json
{
    "body": "<a id='comment:69'></a>> > Sure.  I just meant that since this is currently \"needs review\", what things would still need to be looked at?  You can presumably vouch for quite a bit not due to your self.\n  \n> \n> I think it's ready but I can't set positive, can I?\n\n\nTypically not, unless you really didn't add anything beyond window-dressing.  Which is why I'm asking what you *did* add - I guess a lot of the examples, right?  Any actual code?  (Since you squashed I guess that won't be visible in the log.)  Then anyone (hopefully me) who is ready can just review the pieces that are \"new since you\", if that makes sense.",
    "created_at": "2017-04-13T15:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212151",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:69'></a>> > Sure.  I just meant that since this is currently "needs review", what things would still need to be looked at?  You can presumably vouch for quite a bit not due to your self.
  
> 
> I think it's ready but I can't set positive, can I?


Typically not, unless you really didn't add anything beyond window-dressing.  Which is why I'm asking what you *did* add - I guess a lot of the examples, right?  Any actual code?  (Since you squashed I guess that won't be visible in the log.)  Then anyone (hopefully me) who is ready can just review the pieces that are "new since you", if that makes sense.



---

archive/issue_comments_212152.json:
```json
{
    "body": "<a id='comment:70'></a>Jon's code was completely rewritten, so you would have to review it all.",
    "created_at": "2017-04-13T17:11:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212152",
    "user": "https://github.com/rwst"
}
```

<a id='comment:70'></a>Jon's code was completely rewritten, so you would have to review it all.



---

archive/issue_comments_212153.json:
```json
{
    "body": "<a id='comment:71'></a>Okay, that's a bigger job, but good for us to know.  I didn't realize that.  No, typically we don't review external Pari code, though, so no worries there.",
    "created_at": "2017-04-13T18:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212153",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:71'></a>Okay, that's a bigger job, but good for us to know.  I didn't realize that.  No, typically we don't review external Pari code, though, so no worries there.



---

archive/issue_comments_212154.json:
```json
{
    "body": "<a id='comment:72'></a>Import arith errors from patchbot.",
    "created_at": "2017-11-28T07:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212154",
    "user": "https://github.com/rwst"
}
```

<a id='comment:72'></a>Import arith errors from patchbot.



---

archive/issue_comments_212155.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-11-28T07:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212155",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_212156.json:
```json
{
    "body": "<a id='comment:73'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-02-23T07:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212156",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:73'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_048432.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-23T07:20:14Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48432"
}
```



---

archive/issue_events_048433.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2018-02-23T07:20:14Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16477#event-48433"
}
```



---

archive/issue_comments_212157.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-02-23T07:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212157",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_212158.json:
```json
{
    "body": "<a id='comment:75'></a>New commits:",
    "created_at": "2019-03-09T08:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212158",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:75'></a>New commits:



---

archive/issue_comments_212159.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2019-03-09T09:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212159",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_212160.json:
```json
{
    "body": "<a id='comment:76'></a>Why Dirichlet series derive from `SageObject`? Don't you want the Dirichlet series to form an algebra?",
    "created_at": "2019-03-09T09:39:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212160",
    "user": "https://github.com/videlec"
}
```

<a id='comment:76'></a>Why Dirichlet series derive from `SageObject`? Don't you want the Dirichlet series to form an algebra?



---

archive/issue_comments_212161.json:
```json
{
    "body": "<a id='comment:77'></a>> Why Dirichlet series derive from `SageObject`? Don't you want the Dirichlet series to form an algebra?\n\n\nYes, since these are formal Dirichlet series, ideally they would be, see e.g. Shapiro Chapter 4.6.",
    "created_at": "2019-05-02T17:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212161",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:77'></a>> Why Dirichlet series derive from `SageObject`? Don't you want the Dirichlet series to form an algebra?


Yes, since these are formal Dirichlet series, ideally they would be, see e.g. Shapiro Chapter 4.6.



---

archive/issue_comments_212162.json:
```json
{
    "body": "<a id='comment:78'></a>See also #26098 which possibly might overlap this (or even supersede it?).",
    "created_at": "2019-08-21T02:11:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212162",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:78'></a>See also #26098 which possibly might overlap this (or even supersede it?).



---

archive/issue_comments_212163.json:
```json
{
    "body": "<a id='comment:79'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2021-07-15T18:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212163",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:79'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_212164.json:
```json
{
    "body": "<a id='comment:80'></a>See #32309 for a lazy variant.",
    "created_at": "2021-07-30T14:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212164",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:80'></a>See #32309 for a lazy variant.



---

archive/issue_comments_212165.json:
```json
{
    "body": "<a id='comment:81'></a>See also this call for feature requests posted on sage-devel:\n\n- https://groups.google.com/g/sage-devel/c/ADTbjMZc4ng",
    "created_at": "2021-08-28T15:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212165",
    "user": "https://github.com/slel"
}
```

<a id='comment:81'></a>See also this call for feature requests posted on sage-devel:

- https://groups.google.com/g/sage-devel/c/ADTbjMZc4ng



---

archive/issue_comments_212166.json:
```json
{
    "body": "<a id='comment:82'></a>Beware that there seem to be typos in the list given at https://drive.google.com/file/d/0B4PmRyK1JXgHY29aa00zZnhib1k/\n\nFor example,\n\n```\n(1+pX)/(1-X)     A048250 sum of squfr. div.             Z(s)Z(s-1)/Z(2s-1)\n```\nbut A048250 has Dirichlet g.f.: zeta(s)*zeta(s-1)/zeta(2*s-2).",
    "created_at": "2021-08-29T16:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212166",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:82'></a>Beware that there seem to be typos in the list given at https://drive.google.com/file/d/0B4PmRyK1JXgHY29aa00zZnhib1k/

For example,

```
(1+pX)/(1-X)     A048250 sum of squfr. div.             Z(s)Z(s-1)/Z(2s-1)
```
but A048250 has Dirichlet g.f.: zeta(s)*zeta(s-1)/zeta(2*s-2).



---

archive/issue_comments_212167.json:
```json
{
    "body": "<a id='comment:83'></a>Here is a better reference: http://dx.doi.org/10.35834/mjms/1316032830",
    "created_at": "2021-08-30T20:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16477",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16477#issuecomment-212167",
    "user": "https://github.com/mantepse"
}
```

<a id='comment:83'></a>Here is a better reference: http://dx.doi.org/10.35834/mjms/1316032830
