# Issue 16347: Wilson's constructions of OA with 2 truncated groups

archive/issues_016110.json:
```json
{
    "body": "Heeeeeeeere it is ! The new construction !\n\nAs a result, the MOLS table really took a lifetime to fill. This is fixed by caching the OA that Sage can build, a new feature from #16460.\n\nNathann\n\nCC:  @videlec @KPanComputes @dimpase\n\nBranch/Commit: 0175134767948882f3d8c2ea0a612161ed3d4154\n\nReviewer: Vincent Delecroix\n\nAuthor: Nathann Cohen\n\nDependencies: #16373\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16347\n\n",
    "closed_at": "2014-06-26T01:50:37Z",
    "created_at": "2014-05-13T13:58:30Z",
    "labels": [
        "component: combinatorial designs"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Wilson's constructions of OA with 2 truncated groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16347",
    "user": "https://github.com/nathanncohen"
}
```
Heeeeeeeere it is ! The new construction !

As a result, the MOLS table really took a lifetime to fill. This is fixed by caching the OA that Sage can build, a new feature from #16460.

Nathann

CC:  @videlec @KPanComputes @dimpase

Branch/Commit: 0175134767948882f3d8c2ea0a612161ed3d4154

Reviewer: Vincent Delecroix

Author: Nathann Cohen

Dependencies: #16373

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16347





---

archive/issue_comments_268348.json:
```json
{
    "body": "Changing branch from \"\" to \"u/ncohen/16347\"",
    "created_at": "2014-05-13T13:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268348",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "" to "u/ncohen/16347"



---

archive/issue_comments_268349.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-13T13:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268349",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_268350.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n|                                                                                                                                          |                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[9fb0f62](http://git.sagemath.org/sage.git/commit/?id=9fb0f625c1b2dd63c11cc1e44beb61e69c832acf)|`trac #16241: useless if condition in MOLS constructor`|\n|[67ab2d2](http://git.sagemath.org/sage.git/commit/?id=67ab2d2e5c9e4bdf88ee54e32f9492de59f44ec6)|`trac #16241: Merged with updated #16235`|\n|[e655b36](http://git.sagemath.org/sage.git/commit/?id=e655b363ae30694fa5f36e6b0edbdddcfb95f0cf)|`trac #16236: Five mutually orthogonal latin squares of order 12`|\n|[b516266](http://git.sagemath.org/sage.git/commit/?id=b51626696a83e0072ae5c9a2ef42fc505f1da37f)|`trac #16236: Merged with updated #16241`|\n|[f5339fa](http://git.sagemath.org/sage.git/commit/?id=f5339fabafd4d2b3ffe56b1e68bb68d75ec19902)|`trac #16236: Broken doctests`|\n|[2d7da8a](http://git.sagemath.org/sage.git/commit/?id=2d7da8a150862462eaadd3e261ecc81abbe712c9)|`trac #16236: Merged with updated #16241`|\n|[973b926](http://git.sagemath.org/sage.git/commit/?id=973b926f14224d464da1abba065fd5b78690142c)|`trac #16236: Merged with #16272`|\n|[37681e2](http://git.sagemath.org/sage.git/commit/?id=37681e278ccc71e0c70f74bb3b48b178a0c3c792)|`trac #16295 : Faster is_orthogonal_array`|\n|[994324e](http://git.sagemath.org/sage.git/commit/?id=994324e77dbe8f3126aeba9059dc847feaebe8bc)|`trac #16295: Doctests and review`|\n|[9fefb55](http://git.sagemath.org/sage.git/commit/?id=9fefb55ae381228affcfa085d6814fef6e8dd1bf)|`trac #16347: Wilson's constructions of OA with 2 truncated groups`|",
    "created_at": "2014-05-13T13:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
|                                                                                                                                          |                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[9fb0f62](http://git.sagemath.org/sage.git/commit/?id=9fb0f625c1b2dd63c11cc1e44beb61e69c832acf)|`trac #16241: useless if condition in MOLS constructor`|
|[67ab2d2](http://git.sagemath.org/sage.git/commit/?id=67ab2d2e5c9e4bdf88ee54e32f9492de59f44ec6)|`trac #16241: Merged with updated #16235`|
|[e655b36](http://git.sagemath.org/sage.git/commit/?id=e655b363ae30694fa5f36e6b0edbdddcfb95f0cf)|`trac #16236: Five mutually orthogonal latin squares of order 12`|
|[b516266](http://git.sagemath.org/sage.git/commit/?id=b51626696a83e0072ae5c9a2ef42fc505f1da37f)|`trac #16236: Merged with updated #16241`|
|[f5339fa](http://git.sagemath.org/sage.git/commit/?id=f5339fabafd4d2b3ffe56b1e68bb68d75ec19902)|`trac #16236: Broken doctests`|
|[2d7da8a](http://git.sagemath.org/sage.git/commit/?id=2d7da8a150862462eaadd3e261ecc81abbe712c9)|`trac #16236: Merged with updated #16241`|
|[973b926](http://git.sagemath.org/sage.git/commit/?id=973b926f14224d464da1abba065fd5b78690142c)|`trac #16236: Merged with #16272`|
|[37681e2](http://git.sagemath.org/sage.git/commit/?id=37681e278ccc71e0c70f74bb3b48b178a0c3c792)|`trac #16295 : Faster is_orthogonal_array`|
|[994324e](http://git.sagemath.org/sage.git/commit/?id=994324e77dbe8f3126aeba9059dc847feaebe8bc)|`trac #16295: Doctests and review`|
|[9fefb55](http://git.sagemath.org/sage.git/commit/?id=9fefb55ae381228affcfa085d6814fef6e8dd1bf)|`trac #16347: Wilson's constructions of OA with 2 truncated groups`|



---

archive/issue_comments_268351.json:
```json
{
    "body": "Changing commit from \"\" to \"9fefb55ae381228affcfa085d6814fef6e8dd1bf\"",
    "created_at": "2014-05-13T13:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268351",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "9fefb55ae381228affcfa085d6814fef6e8dd1bf"



---

archive/issue_comments_268352.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[fc6de73](http://git.sagemath.org/sage.git/commit/?id=fc6de7365d89bfa33903bd4c00d58f5757578c6b)|`trac #16295: Merged with 6.3.beta1`|\n|[b9f8b03](http://git.sagemath.org/sage.git/commit/?id=b9f8b0388a8cd333bfaf4160896b09be5550896a)|`trac #16295: bugfix in wilson's construction`|\n|[00ee241](http://git.sagemath.org/sage.git/commit/?id=00ee241a234506c6dfade78b97ce445c0d3b87b1)|`trac #16347: Wilson's constructions of OA with 2 truncated groups`|",
    "created_at": "2014-05-14T09:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[fc6de73](http://git.sagemath.org/sage.git/commit/?id=fc6de7365d89bfa33903bd4c00d58f5757578c6b)|`trac #16295: Merged with 6.3.beta1`|
|[b9f8b03](http://git.sagemath.org/sage.git/commit/?id=b9f8b0388a8cd333bfaf4160896b09be5550896a)|`trac #16295: bugfix in wilson's construction`|
|[00ee241](http://git.sagemath.org/sage.git/commit/?id=00ee241a234506c6dfade78b97ce445c0d3b87b1)|`trac #16347: Wilson's constructions of OA with 2 truncated groups`|



---

archive/issue_comments_268353.json:
```json
{
    "body": "Changing commit from \"9fefb55ae381228affcfa085d6814fef6e8dd1bf\" to \"00ee241a234506c6dfade78b97ce445c0d3b87b1\"",
    "created_at": "2014-05-14T09:40:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9fefb55ae381228affcfa085d6814fef6e8dd1bf" to "00ee241a234506c6dfade78b97ce445c0d3b87b1"



---

archive/issue_comments_268354.json:
```json
{
    "body": "Changing component from combinatorics to combinatorial designs.",
    "created_at": "2014-05-16T21:14:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268354",
    "user": "https://github.com/nathanncohen"
}
```

Changing component from combinatorics to combinatorial designs.



---

archive/issue_comments_268355.json:
```json
{
    "body": "<a id='comment:5'></a>\nWith this updated patch, we only have one version of `wilson_construction` which can handle 0,1 or 2 truncated columns. It can actually handle much more situations that will appear in new constructions I am writing these days. I think that it is a much cleaner code `:-)`\n\nThe two function which look for decomposition of integers are left as they are, they are still useful : they find sets of parameters with which the new `wilson_construction` function is to be fed.\n\nNathann",
    "created_at": "2014-05-29T19:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268355",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>
With this updated patch, we only have one version of `wilson_construction` which can handle 0,1 or 2 truncated columns. It can actually handle much more situations that will appear in new constructions I am writing these days. I think that it is a much cleaner code `:-)`

The two function which look for decomposition of integers are left as they are, they are still useful : they find sets of parameters with which the new `wilson_construction` function is to be fed.

Nathann



---

archive/issue_comments_268356.json:
```json
{
    "body": "Changing dependencies from \"#16295\" to \"#16295, #16391\"",
    "created_at": "2014-05-29T19:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268356",
    "user": "https://github.com/nathanncohen"
}
```

Changing dependencies from "#16295" to "#16295, #16391"



---

archive/issue_comments_268357.json:
```json
{
    "body": "Changing commit from \"00ee241a234506c6dfade78b97ce445c0d3b87b1\" to \"a4554f5c90ea6a4fee0a170b2fb8a862b21df724\"",
    "created_at": "2014-05-29T19:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268357",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "00ee241a234506c6dfade78b97ce445c0d3b87b1" to "a4554f5c90ea6a4fee0a170b2fb8a862b21df724"



---

archive/issue_comments_268358.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[90a72bd](http://git.sagemath.org/sage.git/commit/?id=90a72bd39d74c24cb548e5b7dc5995c67ac386f8)|`trac #16370: OA(k,n) strongly regular graphs`|\n|[395458f](http://git.sagemath.org/sage.git/commit/?id=395458fdb6487289f5add7702c7c6fe66018ad96)|`trac #16391: Helper functions for OA constructions`|\n|[0ed318e](http://git.sagemath.org/sage.git/commit/?id=0ed318ef025a88b2ef5f69891b03fb60b725c7a7)|`trac #16391: Merged with 6.3.beta2`|\n|[f86d187](http://git.sagemath.org/sage.git/commit/?id=f86d187a1fdd25bb662663de314fd1528e675fc0)|`trac #16391: small improvement`|\n|[d954b93](http://git.sagemath.org/sage.git/commit/?id=d954b936c11f31d79b5dca0d6b8da579afb53d5f)|`trac #16391: Independent Set problem with a LP`|\n|[c1bb903](http://git.sagemath.org/sage.git/commit/?id=c1bb9037a3de163f7db69f76247f24b9b27d159b)|`trac #16347: Merged with #16391`|\n|[a4554f5](http://git.sagemath.org/sage.git/commit/?id=a4554f5c90ea6a4fee0a170b2fb8a862b21df724)|`trac #16347: Genelarized Wilson construction`|",
    "created_at": "2014-05-29T19:40:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268358",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[90a72bd](http://git.sagemath.org/sage.git/commit/?id=90a72bd39d74c24cb548e5b7dc5995c67ac386f8)|`trac #16370: OA(k,n) strongly regular graphs`|
|[395458f](http://git.sagemath.org/sage.git/commit/?id=395458fdb6487289f5add7702c7c6fe66018ad96)|`trac #16391: Helper functions for OA constructions`|
|[0ed318e](http://git.sagemath.org/sage.git/commit/?id=0ed318ef025a88b2ef5f69891b03fb60b725c7a7)|`trac #16391: Merged with 6.3.beta2`|
|[f86d187](http://git.sagemath.org/sage.git/commit/?id=f86d187a1fdd25bb662663de314fd1528e675fc0)|`trac #16391: small improvement`|
|[d954b93](http://git.sagemath.org/sage.git/commit/?id=d954b936c11f31d79b5dca0d6b8da579afb53d5f)|`trac #16391: Independent Set problem with a LP`|
|[c1bb903](http://git.sagemath.org/sage.git/commit/?id=c1bb9037a3de163f7db69f76247f24b9b27d159b)|`trac #16347: Merged with #16391`|
|[a4554f5](http://git.sagemath.org/sage.git/commit/?id=a4554f5c90ea6a4fee0a170b2fb8a862b21df724)|`trac #16347: Genelarized Wilson construction`|



---

archive/issue_comments_268359.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,6 +10,4 @@\n \n Nathann\n \n-\n-\n-Nathann\n+TODO : Update #16423 when this patch is reviewed\n``````\n",
    "created_at": "2014-06-02T09:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268359",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,6 +10,4 @@
 
 Nathann
 
-
-
-Nathann
+TODO : Update #16423 when this patch is reviewed
``````




---

archive/issue_comments_268360.json:
```json
{
    "body": "Changing dependencies from \"#16295, #16391\" to \"#16295, #16391, #16373\"",
    "created_at": "2014-06-02T09:26:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268360",
    "user": "https://github.com/nathanncohen"
}
```

Changing dependencies from "#16295, #16391" to "#16295, #16391, #16373"



---

archive/issue_comments_268361.json:
```json
{
    "body": "Changing dependencies from \"#16295, #16391, #16373\" to \"#16391, #16373\"",
    "created_at": "2014-06-02T09:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268361",
    "user": "https://github.com/nathanncohen"
}
```

Changing dependencies from "#16295, #16391, #16373" to "#16391, #16373"



---

archive/issue_comments_268362.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|\n|[f969003](http://git.sagemath.org/sage.git/commit/?id=f9690032a77345bd0d370a3099503574fbf6c96e)|`trac #16356: MOLS for n=18,57,154,276,298,342`|\n|[20ef216](http://git.sagemath.org/sage.git/commit/?id=20ef21682cfe8b6532e2e2621b88d921236528f2)|`trac #16361: OA(7,66), OA(7,68), OA(8,69), OA(7,74) and OA(8,76)`|\n|[dcf5843](http://git.sagemath.org/sage.git/commit/?id=dcf5843e8f14e52ef1cacc1583a9206b47d4d53b)|`trac #16373: OA(18,273), OA(12,474), OA(33,993)`|\n|[2e46351](http://git.sagemath.org/sage.git/commit/?id=2e463514ceb2fb48d3c6fdc2a3391055bfafe373)|`trac #16347: Merged with #16373`|",
    "created_at": "2014-06-02T13:20:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
|[f969003](http://git.sagemath.org/sage.git/commit/?id=f9690032a77345bd0d370a3099503574fbf6c96e)|`trac #16356: MOLS for n=18,57,154,276,298,342`|
|[20ef216](http://git.sagemath.org/sage.git/commit/?id=20ef21682cfe8b6532e2e2621b88d921236528f2)|`trac #16361: OA(7,66), OA(7,68), OA(8,69), OA(7,74) and OA(8,76)`|
|[dcf5843](http://git.sagemath.org/sage.git/commit/?id=dcf5843e8f14e52ef1cacc1583a9206b47d4d53b)|`trac #16373: OA(18,273), OA(12,474), OA(33,993)`|
|[2e46351](http://git.sagemath.org/sage.git/commit/?id=2e463514ceb2fb48d3c6fdc2a3391055bfafe373)|`trac #16347: Merged with #16373`|



---

archive/issue_comments_268363.json:
```json
{
    "body": "Changing commit from \"a4554f5c90ea6a4fee0a170b2fb8a862b21df724\" to \"2e463514ceb2fb48d3c6fdc2a3391055bfafe373\"",
    "created_at": "2014-06-02T13:20:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a4554f5c90ea6a4fee0a170b2fb8a862b21df724" to "2e463514ceb2fb48d3c6fdc2a3391055bfafe373"



---

archive/issue_comments_268364.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n Anyway caching the OA/TD is not as bad as it seems, for it will only build those who are useful in some construction the users asks. When an OA is not useful, a existence check is made before building the actual design, so this is cool !\n \n-I asked on #15657 if the guys there knew a way to tune cached_function to only cache some inputs. \n+I asked on #15657 if the guys there knew a way to tune cached_function to only cache some inputs (see also the following threads on sage-devel [cached_function: a filter to only cache some inputs ?](https://groups.google.com/forum/#!topic/sage-devel/OPe5VJpBiB4) and [cached_function: cache a(n) only when n is *not* a prime power](https://groups.google.com/forum/#!topic/sage-devel/rnqhwGk6e0E)).\n \n Note that MOLS is not a cached_function, because they output matrix objects .... Does not matter much anyway, the MOLS constructor does not contain much.\n \n``````\n",
    "created_at": "2014-06-05T10:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268364",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 Anyway caching the OA/TD is not as bad as it seems, for it will only build those who are useful in some construction the users asks. When an OA is not useful, a existence check is made before building the actual design, so this is cool !
 
-I asked on #15657 if the guys there knew a way to tune cached_function to only cache some inputs. 
+I asked on #15657 if the guys there knew a way to tune cached_function to only cache some inputs (see also the following threads on sage-devel [cached_function: a filter to only cache some inputs ?](https://groups.google.com/forum/#!topic/sage-devel/OPe5VJpBiB4) and [cached_function: cache a(n) only when n is *not* a prime power](https://groups.google.com/forum/#!topic/sage-devel/rnqhwGk6e0E)).
 
 Note that MOLS is not a cached_function, because they output matrix objects .... Does not matter much anyway, the MOLS constructor does not contain much.
 
``````




---

archive/issue_comments_268365.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-06-05T13:51:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268365",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_268366.json:
```json
{
    "body": "<a id='comment:12'></a>\nHi Nathann,\n\nI do not like the fact that we would have to cache everything. Could we instead cache the construction? In other words, have a function\n\n```\n@cached_function\ndef orthogonal_array_construction(n):\n    r\"\"\"\n    Return a triple `(k,f,args)` such that `k` is the maximum value\n    such that Sage knows how to build a `OA(k,n)` and `f(*args)` actually\n    return this `OA(k,n)`.\n    \"\"\"\n```\nAdvantages:\n- that function can be use to speed up both boolean and designs answers of `orthogonal_array`.\n- we can remove the current cache from `find_wilson_decomposition*` and `TD_find_product_decomposition`\n- it might be used later on to draw the tree of constructions.\n\nI am not sure it is feasible, but without thinking too much, it looks like a good solution.\n\nVincent",
    "created_at": "2014-06-05T13:51:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268366",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>
Hi Nathann,

I do not like the fact that we would have to cache everything. Could we instead cache the construction? In other words, have a function

```
@cached_function
def orthogonal_array_construction(n):
    r"""
    Return a triple `(k,f,args)` such that `k` is the maximum value
    such that Sage knows how to build a `OA(k,n)` and `f(*args)` actually
    return this `OA(k,n)`.
    """
```
Advantages:
- that function can be use to speed up both boolean and designs answers of `orthogonal_array`.
- we can remove the current cache from `find_wilson_decomposition*` and `TD_find_product_decomposition`
- it might be used later on to draw the tree of constructions.

I am not sure it is feasible, but without thinking too much, it looks like a good solution.

Vincent



---

archive/issue_comments_268367.json:
```json
{
    "body": "<a id='comment:13'></a>\nYo !\n\n> I do not like the fact that we would have to cache everything.\n\n\nCould you have missed the 10 000 posts about a new flag for the `@`cached_method decorator ?\n\n> Could we instead cache the construction? In other words, have a function\n> \n> ```\n> @cached_function\n> def orthogonal_array_construction(n):\n>     r\"\"\"\n>     Return a triple `(k,f,args)` such that `k` is the maximum value\n>     such that Sage knows how to build a `OA(k,n)` and `f(*args)` actually\n>     return this `OA(k,n)`.\n>     \"\"\"\n> ```\n\n\nYou should not compute the largest k if you do not need to. If your function takes both k and n as an argument then it is Volker's idea.\n\nIt actually isn't a bad idea, if not for the fact that there is no reason why we should go that far to implement a caching mechanism in combinat.designs while the caching mechanism has nothing to do with designs.\n\nThe \"clean/proper\" solution is to implement a real caching mechanism for designs which takes k,n as input and answer accordingly, by only storing for each n the largest k that has been built so far, and the smallest k such that it has been proved that no OA(k,n) could built so far.\n\nThis is what I want to do eventually, but I first wanted to get the actual constructions in ..... This is not a definitive solution but it is not the moment to implement a caching mechanism either... There are features to get in, really ...\n\nNathann\n\nP.S. : When I say eventually I do not say \"in two years\". I say --> as soon as all the current patches are merged into Sage, along with the 4 constructions I have been keeping on my hard drive waiting for all these patches to be reviewed.",
    "created_at": "2014-06-05T14:02:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268367",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:13'></a>
Yo !

> I do not like the fact that we would have to cache everything.


Could you have missed the 10 000 posts about a new flag for the `@`cached_method decorator ?

> Could we instead cache the construction? In other words, have a function
> 
> ```
> @cached_function
> def orthogonal_array_construction(n):
>     r"""
>     Return a triple `(k,f,args)` such that `k` is the maximum value
>     such that Sage knows how to build a `OA(k,n)` and `f(*args)` actually
>     return this `OA(k,n)`.
>     """
> ```


You should not compute the largest k if you do not need to. If your function takes both k and n as an argument then it is Volker's idea.

It actually isn't a bad idea, if not for the fact that there is no reason why we should go that far to implement a caching mechanism in combinat.designs while the caching mechanism has nothing to do with designs.

The "clean/proper" solution is to implement a real caching mechanism for designs which takes k,n as input and answer accordingly, by only storing for each n the largest k that has been built so far, and the smallest k such that it has been proved that no OA(k,n) could built so far.

This is what I want to do eventually, but I first wanted to get the actual constructions in ..... This is not a definitive solution but it is not the moment to implement a caching mechanism either... There are features to get in, really ...

Nathann

P.S. : When I say eventually I do not say "in two years". I say --> as soon as all the current patches are merged into Sage, along with the 4 constructions I have been keeping on my hard drive waiting for all these patches to be reviewed.



---

archive/issue_comments_268368.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-06-05T14:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268368",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_268369.json:
```json
{
    "body": "<a id='comment:15'></a>\nOh, I forgot something : the other solution is of course to implement a `@`cached_method_with_conditions decorator which can filter the input.\n\nNathann",
    "created_at": "2014-06-05T14:15:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268369",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>
Oh, I forgot something : the other solution is of course to implement a `@`cached_method_with_conditions decorator which can filter the input.

Nathann



---

archive/issue_comments_268370.json:
```json
{
    "body": "<a id='comment:16'></a>\nIt is now implemented in #16353 but Volker introduced a notion of morality in computer science and it seems that one is not allowed to write a function that could be used for possibly dark deeds.\n\nNathann",
    "created_at": "2014-06-05T16:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268370",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>
It is now implemented in #16353 but Volker introduced a notion of morality in computer science and it seems that one is not allowed to write a function that could be used for possibly dark deeds.

Nathann



---

archive/issue_comments_268371.json:
```json
{
    "body": "<a id='comment:17'></a>\nI actually developed the same idea as yours while thinking a bit more about it. What we want to cache is something like `n -> (k1,OA,k2)` where `OA` is a OA(k1,n) and `k2` is such that Sage does not know how to compute OA(k2,n). And this feature looks very specific to design and I do not see how a decorator can handle that nicely.\n\nSo, if you are willing to use these `@`cached_method everywhere or even the one you wrote in #16353, there is a need for a big **TODO** saying that it is here for quick-and-dirty speedup.\n\nSo let's not talk to much about caching right now, I will look at the construction.\n\nVincent",
    "created_at": "2014-06-05T16:29:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268371",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>
I actually developed the same idea as yours while thinking a bit more about it. What we want to cache is something like `n -> (k1,OA,k2)` where `OA` is a OA(k1,n) and `k2` is such that Sage does not know how to compute OA(k2,n). And this feature looks very specific to design and I do not see how a decorator can handle that nicely.

So, if you are willing to use these `@`cached_method everywhere or even the one you wrote in #16353, there is a need for a big **TODO** saying that it is here for quick-and-dirty speedup.

So let's not talk to much about caching right now, I will look at the construction.

Vincent



---

archive/issue_comments_268372.json:
```json
{
    "body": "<a id='comment:18'></a>\nYo !\n\n> I actually developed the same idea as yours while thinking a bit more about it. What we want to cache is something like `n -> (k1,OA,k2)` where `OA` is a OA(k1,n) and `k2` is such that Sage does not know how to compute OA(k2,n). And this feature looks very specific to design and I do not see how a decorator can handle that nicely.\n\n\nYes of course, this would be design-specific.\n\n> So, if you are willing to use these `@`cached_method everywhere or even the one you wrote in #16353, there is a need for a big **TODO** saying that it is here for quick-and-dirty speedup.\n\n\nWhat was done here is quick but not dirty. We cache too much, but that's much better than not caching anything at all because all functions would become useless. What I implemented in #16353 is NOT quick and dirty, it is the most generic way to solve our problem here. Anything more would be design-specific and that's where it would actually become to be ugly, because it would just be \"for our own purposes\" with global variabls everywhere ....\n\n> So let's not talk to much about caching right now, I will look at the construction.\n\n\nYes, please do. But remember that there are many dependencies to this patch that have to be reviewed first.\n\nNathann",
    "created_at": "2014-06-05T16:33:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268372",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:18'></a>
Yo !

> I actually developed the same idea as yours while thinking a bit more about it. What we want to cache is something like `n -> (k1,OA,k2)` where `OA` is a OA(k1,n) and `k2` is such that Sage does not know how to compute OA(k2,n). And this feature looks very specific to design and I do not see how a decorator can handle that nicely.


Yes of course, this would be design-specific.

> So, if you are willing to use these `@`cached_method everywhere or even the one you wrote in #16353, there is a need for a big **TODO** saying that it is here for quick-and-dirty speedup.


What was done here is quick but not dirty. We cache too much, but that's much better than not caching anything at all because all functions would become useless. What I implemented in #16353 is NOT quick and dirty, it is the most generic way to solve our problem here. Anything more would be design-specific and that's where it would actually become to be ugly, because it would just be "for our own purposes" with global variabls everywhere ....

> So let's not talk to much about caching right now, I will look at the construction.


Yes, please do. But remember that there are many dependencies to this patch that have to be reviewed first.

Nathann



---

archive/issue_comments_268373.json:
```json
{
    "body": "Changing dependencies from \"#16391, #16373\" to \"#16391, #16373, #16460\"",
    "created_at": "2014-06-10T10:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268373",
    "user": "https://github.com/nathanncohen"
}
```

Changing dependencies from "#16391, #16373" to "#16391, #16373, #16460"



---

archive/issue_comments_268374.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,6 @@\n Heeeeeeeere it is ! The new construction !\n \n-As a result, the MOLS table really took a lifetime to fill. So I turned TD and OA into cached functions and they give their answer MUCH faster. The bad side is that it also cached the OA/TD, and this is not necessarily a good idea. The idea would be to cache ONLY the boolean/integer answers, but I do not know how right now.\n-\n-Anyway caching the OA/TD is not as bad as it seems, for it will only build those who are useful in some construction the users asks. When an OA is not useful, a existence check is made before building the actual design, so this is cool !\n-\n-I asked on #15657 if the guys there knew a way to tune cached_function to only cache some inputs (see also the following threads on sage-devel [cached_function: a filter to only cache some inputs ?](https://groups.google.com/forum/#!topic/sage-devel/OPe5VJpBiB4) and [cached_function: cache a(n) only when n is *not* a prime power](https://groups.google.com/forum/#!topic/sage-devel/rnqhwGk6e0E)).\n-\n-Note that MOLS is not a cached_function, because they output matrix objects .... Does not matter much anyway, the MOLS constructor does not contain much.\n+As a result, the MOLS table really took a lifetime to fill. This is fixed by caching the OA that Sage can build, a new feature from #16460.\n \n Nathann\n \n``````\n",
    "created_at": "2014-06-10T10:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268374",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,6 @@
 Heeeeeeeere it is ! The new construction !
 
-As a result, the MOLS table really took a lifetime to fill. So I turned TD and OA into cached functions and they give their answer MUCH faster. The bad side is that it also cached the OA/TD, and this is not necessarily a good idea. The idea would be to cache ONLY the boolean/integer answers, but I do not know how right now.
-
-Anyway caching the OA/TD is not as bad as it seems, for it will only build those who are useful in some construction the users asks. When an OA is not useful, a existence check is made before building the actual design, so this is cool !
-
-I asked on #15657 if the guys there knew a way to tune cached_function to only cache some inputs (see also the following threads on sage-devel [cached_function: a filter to only cache some inputs ?](https://groups.google.com/forum/#!topic/sage-devel/OPe5VJpBiB4) and [cached_function: cache a(n) only when n is *not* a prime power](https://groups.google.com/forum/#!topic/sage-devel/rnqhwGk6e0E)).
-
-Note that MOLS is not a cached_function, because they output matrix objects .... Does not matter much anyway, the MOLS constructor does not contain much.
+As a result, the MOLS table really took a lifetime to fill. This is fixed by caching the OA that Sage can build, a new feature from #16460.
 
 Nathann
 
``````




---

archive/issue_comments_268375.json:
```json
{
    "body": "Changing dependencies from \"#16391, #16373, #16460\" to \"#16373\"",
    "created_at": "2014-06-13T11:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268375",
    "user": "https://github.com/nathanncohen"
}
```

Changing dependencies from "#16391, #16373, #16460" to "#16373"



---

archive/issue_comments_268376.json:
```json
{
    "body": "<a id='comment:21'></a>\nRebased on top of #16373, all in one commit !\n\nNathann",
    "created_at": "2014-06-13T11:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268376",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:21'></a>
Rebased on top of #16373, all in one commit !

Nathann



---

archive/issue_comments_268377.json:
```json
{
    "body": "Changing commit from \"2e463514ceb2fb48d3c6fdc2a3391055bfafe373\" to \"004833af803033e08e71011d4e69462de8909283\"",
    "created_at": "2014-06-13T11:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "2e463514ceb2fb48d3c6fdc2a3391055bfafe373" to "004833af803033e08e71011d4e69462de8909283"



---

archive/issue_comments_268378.json:
```json
{
    "body": "<a id='comment:22'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[8704b9c](http://git.sagemath.org/sage.git/commit/?id=8704b9cdc1c8ae606f81b8613da6db379061a51b)|`trac #16361: merge updated #16461`|\n|[767e091](http://git.sagemath.org/sage.git/commit/?id=767e0911107e5b374ad182acd0e5dac79ae8c874)|`trac #16388: Specify the values of k,n in the exceptions`|\n|[a460169](http://git.sagemath.org/sage.git/commit/?id=a46016940e56a1d56bb0542c1320f87c057862da)|`merge Sage version 6.3.beta3`|\n|[c365a39](http://git.sagemath.org/sage.git/commit/?id=c365a39d76ea00e63e1f11de86ad3474fc3f77b9)|`trac #16388: use format for OA + specify (k,n) for BIBD`|\n|[ec26ca2](http://git.sagemath.org/sage.git/commit/?id=ec26ca23d2549d6dc111c6d69d03df739115ee9f)|`trac #16388: a missing one in BIBD_from_TD`|\n|[79178b6](http://git.sagemath.org/sage.git/commit/?id=79178b62b55c9d38b4ee015118e1cbc6acefb8f8)|`trac #16388: (v,k,1)-BIBD instead of BIBD(v,k,1)`|\n|[02ecf51](http://git.sagemath.org/sage.git/commit/?id=02ecf51a3101880f34db39cf4ed38f19c7fd34f3)|`trac #16361: Merged with #16388`|\n|[5d4607a](http://git.sagemath.org/sage.git/commit/?id=5d4607aad0675c6ea4afd914796bc78d043a1600)|`trac #16361: Don't re-raise the exceptions`|\n|[541269b](http://git.sagemath.org/sage.git/commit/?id=541269b79a442543bc7351cc3d96972d1ba717c0)|`trac #16373: merge #16361`|\n|[004833a](http://git.sagemath.org/sage.git/commit/?id=004833af803033e08e71011d4e69462de8909283)|`trac #16347: Wilson's construction with two truncated groups`|",
    "created_at": "2014-06-13T11:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268378",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[8704b9c](http://git.sagemath.org/sage.git/commit/?id=8704b9cdc1c8ae606f81b8613da6db379061a51b)|`trac #16361: merge updated #16461`|
|[767e091](http://git.sagemath.org/sage.git/commit/?id=767e0911107e5b374ad182acd0e5dac79ae8c874)|`trac #16388: Specify the values of k,n in the exceptions`|
|[a460169](http://git.sagemath.org/sage.git/commit/?id=a46016940e56a1d56bb0542c1320f87c057862da)|`merge Sage version 6.3.beta3`|
|[c365a39](http://git.sagemath.org/sage.git/commit/?id=c365a39d76ea00e63e1f11de86ad3474fc3f77b9)|`trac #16388: use format for OA + specify (k,n) for BIBD`|
|[ec26ca2](http://git.sagemath.org/sage.git/commit/?id=ec26ca23d2549d6dc111c6d69d03df739115ee9f)|`trac #16388: a missing one in BIBD_from_TD`|
|[79178b6](http://git.sagemath.org/sage.git/commit/?id=79178b62b55c9d38b4ee015118e1cbc6acefb8f8)|`trac #16388: (v,k,1)-BIBD instead of BIBD(v,k,1)`|
|[02ecf51](http://git.sagemath.org/sage.git/commit/?id=02ecf51a3101880f34db39cf4ed38f19c7fd34f3)|`trac #16361: Merged with #16388`|
|[5d4607a](http://git.sagemath.org/sage.git/commit/?id=5d4607aad0675c6ea4afd914796bc78d043a1600)|`trac #16361: Don't re-raise the exceptions`|
|[541269b](http://git.sagemath.org/sage.git/commit/?id=541269b79a442543bc7351cc3d96972d1ba717c0)|`trac #16373: merge #16361`|
|[004833a](http://git.sagemath.org/sage.git/commit/?id=004833af803033e08e71011d4e69462de8909283)|`trac #16347: Wilson's construction with two truncated groups`|



---

archive/issue_comments_268379.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,5 +3,3 @@\n As a result, the MOLS table really took a lifetime to fill. This is fixed by caching the OA that Sage can build, a new feature from #16460.\n \n Nathann\n-\n-TODO : Update #16423 when this patch is reviewed\n``````\n",
    "created_at": "2014-06-18T16:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268379",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,5 +3,3 @@
 As a result, the MOLS table really took a lifetime to fill. This is fixed by caching the OA that Sage can build, a new feature from #16460.
 
 Nathann
-
-TODO : Update #16423 when this patch is reviewed
``````




---

archive/issue_comments_268380.json:
```json
{
    "body": "<a id='comment:24'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[f5069f0](http://git.sagemath.org/sage.git/commit/?id=f5069f0dd30bd698489fa047b6fdabd7b8cdaf03)|`trac #16347: Merged with 6.3.beta4`|",
    "created_at": "2014-06-19T14:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268380",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[f5069f0](http://git.sagemath.org/sage.git/commit/?id=f5069f0dd30bd698489fa047b6fdabd7b8cdaf03)|`trac #16347: Merged with 6.3.beta4`|



---

archive/issue_comments_268381.json:
```json
{
    "body": "Changing commit from \"004833af803033e08e71011d4e69462de8909283\" to \"f5069f0dd30bd698489fa047b6fdabd7b8cdaf03\"",
    "created_at": "2014-06-19T14:50:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268381",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "004833af803033e08e71011d4e69462de8909283" to "f5069f0dd30bd698489fa047b6fdabd7b8cdaf03"



---

archive/issue_comments_268382.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-06-23T20:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268382",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_268383.json:
```json
{
    "body": "<a id='comment:25'></a>\nHi Nathann,\n\nI did several things at `public/16347`. But I still need to understand more the Wilson construction.\n\nThe only construction that does not belong to `orthogonal_array` is the product construction (which can be seen as a particular case of wilson construction). What do you think if we move it to `orthogonal_array` and remove the `who_asked` stuff? It would be much more readable.\n\nEDIT: more precisely, all constructions in `mutually_orthogonal_latin_squares` and `transversal_design` comes from the database except the product construction. As your Wilson construction can be used for the product we can move **all** recursive constructions in `orthogonal_array` and remove the `who_asked` argument in all these functions.\n\nVincent",
    "created_at": "2014-06-23T20:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268383",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>
Hi Nathann,

I did several things at `public/16347`. But I still need to understand more the Wilson construction.

The only construction that does not belong to `orthogonal_array` is the product construction (which can be seen as a particular case of wilson construction). What do you think if we move it to `orthogonal_array` and remove the `who_asked` stuff? It would be much more readable.

EDIT: more precisely, all constructions in `mutually_orthogonal_latin_squares` and `transversal_design` comes from the database except the product construction. As your Wilson construction can be used for the product we can move **all** recursive constructions in `orthogonal_array` and remove the `who_asked` argument in all these functions.

Vincent



---

archive/issue_comments_268384.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-06-24T08:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268384",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_268385.json:
```json
{
    "body": "Changing commit from \"f5069f0dd30bd698489fa047b6fdabd7b8cdaf03\" to \"1d1a476fe12b2cca3e7249b092582e2a16005380\"",
    "created_at": "2014-06-24T08:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268385",
    "user": "https://github.com/nathanncohen"
}
```

Changing commit from "f5069f0dd30bd698489fa047b6fdabd7b8cdaf03" to "1d1a476fe12b2cca3e7249b092582e2a16005380"



---

archive/issue_comments_268386.json:
```json
{
    "body": "<a id='comment:26'></a>\nYo !\n\n> I did several things at `public/16347`. But I still need to understand more the Wilson construction.\n\n\nI took a picture of a drawing I made, hoping that it helps.\n\nhttp://www.steinertriples.fr/ncohen/tmp/photo1.jpg\n\n> The only construction that does not belong to `orthogonal_array` is the product construction (which can be seen as a particular case of wilson construction). What do you think if we move it to `orthogonal_array` and remove the `who_asked` stuff? It would be much more readable.\n\n\nI agree, I agree. I intended to do this at some point, but.. Well... When the current patches will be reviewed, etc etc ...\n\nActually, tickets #16500 and #16503 create a file named `orthogonal_arrays_recursive.py` which contain many pairs construction/find_parameters. I intended to move the \"find decompositions\" that we already have in other files there (e.g. the one implemented here, and the `find_product_decomposition`), and indeed to rewrite this last TD construction for OA.\n\nIt will be done. For everty patch that you review I will write another one that does one of these things `:-P`\n\nNathann\n\n---\nNew commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[03c1f45](http://git.sagemath.org/sage.git/commit/?id=03c1f4515b266f11e905136d6bda9a9de126b322)|`trac #16430: Small speedup for OA(None,p^c)`|\n|[8e8a9f3](http://git.sagemath.org/sage.git/commit/?id=8e8a9f3226e5ee5815e40156bd71286998476ff0)|`trac #16430: Merged with 6.3.beta4`|\n|[162b83c](http://git.sagemath.org/sage.git/commit/?id=162b83c0772a9c2a02eb3cea71028e8d14a6c0a7)|`trac #16430: Many bugfixes`|\n|[3e01acb](http://git.sagemath.org/sage.git/commit/?id=3e01acb6cc2f189d606f6877264f7d635a9a2036)|`trac #16430: micro improvements`|\n|[81b9448](http://git.sagemath.org/sage.git/commit/?id=81b9448a730769e28af52c3ea36faa5b8156232a)|`trac #16430: put back the seealso`|\n|[d3f9702](http://git.sagemath.org/sage.git/commit/?id=d3f9702840c197937865d728f596549606c811ea)|`trac #16347: merge #16430`|\n|[8bcbe6f](http://git.sagemath.org/sage.git/commit/?id=8bcbe6f8ccf62f502a96fc8442ef2c0bd87467c5)|`trac #16437: fix MOLS table doctest`|\n|[49169d5](http://git.sagemath.org/sage.git/commit/?id=49169d5da071b718c8e9340abf29af34f730ab5c)|`trac #16437: use is_sum_of_two_squares and fix error msg`|\n|[1d1a476](http://git.sagemath.org/sage.git/commit/?id=1d1a476fe12b2cca3e7249b092582e2a16005380)|`trac #16347: optimize find_wilson_decomposition`|",
    "created_at": "2014-06-24T08:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268386",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:26'></a>
Yo !

> I did several things at `public/16347`. But I still need to understand more the Wilson construction.


I took a picture of a drawing I made, hoping that it helps.

http://www.steinertriples.fr/ncohen/tmp/photo1.jpg

> The only construction that does not belong to `orthogonal_array` is the product construction (which can be seen as a particular case of wilson construction). What do you think if we move it to `orthogonal_array` and remove the `who_asked` stuff? It would be much more readable.


I agree, I agree. I intended to do this at some point, but.. Well... When the current patches will be reviewed, etc etc ...

Actually, tickets #16500 and #16503 create a file named `orthogonal_arrays_recursive.py` which contain many pairs construction/find_parameters. I intended to move the "find decompositions" that we already have in other files there (e.g. the one implemented here, and the `find_product_decomposition`), and indeed to rewrite this last TD construction for OA.

It will be done. For everty patch that you review I will write another one that does one of these things `:-P`

Nathann

---
New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[03c1f45](http://git.sagemath.org/sage.git/commit/?id=03c1f4515b266f11e905136d6bda9a9de126b322)|`trac #16430: Small speedup for OA(None,p^c)`|
|[8e8a9f3](http://git.sagemath.org/sage.git/commit/?id=8e8a9f3226e5ee5815e40156bd71286998476ff0)|`trac #16430: Merged with 6.3.beta4`|
|[162b83c](http://git.sagemath.org/sage.git/commit/?id=162b83c0772a9c2a02eb3cea71028e8d14a6c0a7)|`trac #16430: Many bugfixes`|
|[3e01acb](http://git.sagemath.org/sage.git/commit/?id=3e01acb6cc2f189d606f6877264f7d635a9a2036)|`trac #16430: micro improvements`|
|[81b9448](http://git.sagemath.org/sage.git/commit/?id=81b9448a730769e28af52c3ea36faa5b8156232a)|`trac #16430: put back the seealso`|
|[d3f9702](http://git.sagemath.org/sage.git/commit/?id=d3f9702840c197937865d728f596549606c811ea)|`trac #16347: merge #16430`|
|[8bcbe6f](http://git.sagemath.org/sage.git/commit/?id=8bcbe6f8ccf62f502a96fc8442ef2c0bd87467c5)|`trac #16437: fix MOLS table doctest`|
|[49169d5](http://git.sagemath.org/sage.git/commit/?id=49169d5da071b718c8e9340abf29af34f730ab5c)|`trac #16437: use is_sum_of_two_squares and fix error msg`|
|[1d1a476](http://git.sagemath.org/sage.git/commit/?id=1d1a476fe12b2cca3e7249b092582e2a16005380)|`trac #16347: optimize find_wilson_decomposition`|



---

archive/issue_comments_268387.json:
```json
{
    "body": "Changing branch from \"u/ncohen/16347\" to \"public/16347\"",
    "created_at": "2014-06-24T08:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268387",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "u/ncohen/16347" to "public/16347"



---

archive/issue_comments_268388.json:
```json
{
    "body": "<a id='comment:27'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[d93a97c](http://git.sagemath.org/sage.git/commit/?id=d93a97c5abb48f3f5067c516ca0b133b52146da4)|`trac #16347: more docs + simplifications`|",
    "created_at": "2014-06-24T11:33:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268388",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[d93a97c](http://git.sagemath.org/sage.git/commit/?id=d93a97c5abb48f3f5067c516ca0b133b52146da4)|`trac #16347: more docs + simplifications`|



---

archive/issue_comments_268389.json:
```json
{
    "body": "Changing commit from \"1d1a476fe12b2cca3e7249b092582e2a16005380\" to \"d93a97c5abb48f3f5067c516ca0b133b52146da4\"",
    "created_at": "2014-06-24T11:33:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268389",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1d1a476fe12b2cca3e7249b092582e2a16005380" to "d93a97c5abb48f3f5067c516ca0b133b52146da4"



---

archive/issue_comments_268390.json:
```json
{
    "body": "<a id='comment:28'></a>\nMore changes on public if you agree...\n\nQuestions:\n- I do not understand why you output `n` in `find_wilson_decomposition_with_one_truncated_group`\n- I do not understand why you output `k` in `find_wilson_decomposition_with_two_truncated_groups`\n\nI would rather output `(r,m,(r1,))` and `(r,m,(r1,r2))`. That way the call would be uniform in `orthogonal_array`... and you should decide between `r1,r2` and `u1,u2`.\n\nVincent\n\nPS: right now I am going to teach ctypes and cython, so I will not look at it again until tonight.",
    "created_at": "2014-06-24T11:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268390",
    "user": "https://github.com/videlec"
}
```

<a id='comment:28'></a>
More changes on public if you agree...

Questions:
- I do not understand why you output `n` in `find_wilson_decomposition_with_one_truncated_group`
- I do not understand why you output `k` in `find_wilson_decomposition_with_two_truncated_groups`

I would rather output `(r,m,(r1,))` and `(r,m,(r1,r2))`. That way the call would be uniform in `orthogonal_array`... and you should decide between `r1,r2` and `u1,u2`.

Vincent

PS: right now I am going to teach ctypes and cython, so I will not look at it again until tonight.



---

archive/issue_comments_268391.json:
```json
{
    "body": "<a id='comment:29'></a>\nYo !\n\n> More changes on public if you agree...\n\n\nThey look good ! Except for tho things :\n\n```\nFinds a wilson decomposition to build an `OA(k,n)` with one truncated column\n```\n\nHere one can understand that the purpose of the function is to build a truncated OA....\n\n```\n+    Then there exists an `OA(k,rm+\\sum u_i)`. This construction is a\n+    straightforward generalization of Lemma 3.16 of [HananiBIBD]_.\n```\n\nIt is only straightforward when one tells you what there is to find `:-P`\n\n> - I do not understand why you output `n` in `find_wilson_decomposition_with_one_truncated_group`\n> - I do not understand why you output `k` in `find_wilson_decomposition_with_two_truncated_groups`\n\n\nHistorical resons I would say. You just changed the inputs used by Wilson's construction, I did it too before, and I did not think necessary to update the related functions ...\n\n> I would rather output `(r,m,(r1,))` and `(r,m,(r1,r2))`. That way the call would be uniform in `orthogonal_array`... and you should decide between `r1,r2` and `u1,u2`.\n\n\nIf you sleep better this way you can update them. Really it is only internal stuff, I thought that we could make them private functions at some point.. I do not care as long as the designs are produced `:-P`\n\nBy the way, #16500 defines a `find_recursive_construction` is `orthogonal_array_recursive.py` which calls all recursive constructions. The plan was to move the two `find_wilson_decomposition*` to this file later, and this will require to change their output again.\n\n> PS: right now I am going to teach ctypes and cython, so I will not look at it again until tonight.\n\n\nGood luck ! And show them \n\n```\nsage -cython -a my_file.pyx # produces a html file whose lines are clickable\n```\nthat's really cool !\n\nNathann",
    "created_at": "2014-06-24T12:01:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268391",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:29'></a>
Yo !

> More changes on public if you agree...


They look good ! Except for tho things :

```
Finds a wilson decomposition to build an `OA(k,n)` with one truncated column
```

Here one can understand that the purpose of the function is to build a truncated OA....

```
+    Then there exists an `OA(k,rm+\sum u_i)`. This construction is a
+    straightforward generalization of Lemma 3.16 of [HananiBIBD]_.
```

It is only straightforward when one tells you what there is to find `:-P`

> - I do not understand why you output `n` in `find_wilson_decomposition_with_one_truncated_group`
> - I do not understand why you output `k` in `find_wilson_decomposition_with_two_truncated_groups`


Historical resons I would say. You just changed the inputs used by Wilson's construction, I did it too before, and I did not think necessary to update the related functions ...

> I would rather output `(r,m,(r1,))` and `(r,m,(r1,r2))`. That way the call would be uniform in `orthogonal_array`... and you should decide between `r1,r2` and `u1,u2`.


If you sleep better this way you can update them. Really it is only internal stuff, I thought that we could make them private functions at some point.. I do not care as long as the designs are produced `:-P`

By the way, #16500 defines a `find_recursive_construction` is `orthogonal_array_recursive.py` which calls all recursive constructions. The plan was to move the two `find_wilson_decomposition*` to this file later, and this will require to change their output again.

> PS: right now I am going to teach ctypes and cython, so I will not look at it again until tonight.


Good luck ! And show them 

```
sage -cython -a my_file.pyx # produces a html file whose lines are clickable
```
that's really cool !

Nathann



---

archive/issue_comments_268392.json:
```json
{
    "body": "Changing commit from \"d93a97c5abb48f3f5067c516ca0b133b52146da4\" to \"80bbb95e063a1105007ecb6fb61d1b08b34d6ca5\"",
    "created_at": "2014-06-24T22:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268392",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d93a97c5abb48f3f5067c516ca0b133b52146da4" to "80bbb95e063a1105007ecb6fb61d1b08b34d6ca5"



---

archive/issue_comments_268393.json:
```json
{
    "body": "<a id='comment:30'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|\n|[b83dd74](http://git.sagemath.org/sage.git/commit/?id=b83dd746367eef4609d95e8c8c68ed6e3f846d1e)|`trac #16347: author comment`|\n|[80bbb95](http://git.sagemath.org/sage.git/commit/?id=80bbb95e063a1105007ecb6fb61d1b08b34d6ca5)|`trac #16347: get rid of who_asked`|",
    "created_at": "2014-06-24T22:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268393",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:30'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                             |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------|
|[b83dd74](http://git.sagemath.org/sage.git/commit/?id=b83dd746367eef4609d95e8c8c68ed6e3f846d1e)|`trac #16347: author comment`|
|[80bbb95](http://git.sagemath.org/sage.git/commit/?id=80bbb95e063a1105007ecb6fb61d1b08b34d6ca5)|`trac #16347: get rid of who_asked`|



---

archive/issue_comments_268394.json:
```json
{
    "body": "Changing commit from \"80bbb95e063a1105007ecb6fb61d1b08b34d6ca5\" to \"cb67ae69db6ed23971e2ba8eceeebe1e72f714db\"",
    "created_at": "2014-06-24T23:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268394",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "80bbb95e063a1105007ecb6fb61d1b08b34d6ca5" to "cb67ae69db6ed23971e2ba8eceeebe1e72f714db"



---

archive/issue_comments_268395.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[cb67ae6](http://git.sagemath.org/sage.git/commit/?id=cb67ae69db6ed23971e2ba8eceeebe1e72f714db)|`trac #16347: fix doctest and speedup find_wilson`|",
    "created_at": "2014-06-24T23:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268395",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[cb67ae6](http://git.sagemath.org/sage.git/commit/?id=cb67ae69db6ed23971e2ba8eceeebe1e72f714db)|`trac #16347: fix doctest and speedup find_wilson`|



---

archive/issue_comments_268396.json:
```json
{
    "body": "<a id='comment:32'></a>\nHi Nathann,\n\nIt is much clearer now without the `who_asked`. I did a bit of speedup in `find_wilson_*` and the test in `latin_squares` run in 11sec instead of 17sec. Not yet marvelous but not bad. It would be nice to spend some time there as most of the time is clearly spent in looking for decompositions.\n\n(I messed up the case of `k=1` in the intermediate commit... so they are not relevant)\n\nVincent",
    "created_at": "2014-06-24T23:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268396",
    "user": "https://github.com/videlec"
}
```

<a id='comment:32'></a>
Hi Nathann,

It is much clearer now without the `who_asked`. I did a bit of speedup in `find_wilson_*` and the test in `latin_squares` run in 11sec instead of 17sec. Not yet marvelous but not bad. It would be nice to spend some time there as most of the time is clearly spent in looking for decompositions.

(I messed up the case of `k=1` in the intermediate commit... so they are not relevant)

Vincent



---

archive/issue_comments_268397.json:
```json
{
    "body": "<a id='comment:33'></a>\nYo.\n\n> It is much clearer now without the `who_asked`. I did a bit of speedup in `find_wilson_*` and the test in `latin_squares` run in 11sec instead of 17sec. Not yet marvelous but not bad. It would be nice to spend some time there as most of the time is clearly spent in looking for decompositions.\n> \n> (I messed up the case of `k=1` in the intermediate commit... so they are not relevant)\n\n\nSeveral values decreased in the table of mols.\n\nBtw, you should have opened another ticket to remove `who_asked` and move functions around.\n\nNathann",
    "created_at": "2014-06-25T07:56:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268397",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:33'></a>
Yo.

> It is much clearer now without the `who_asked`. I did a bit of speedup in `find_wilson_*` and the test in `latin_squares` run in 11sec instead of 17sec. Not yet marvelous but not bad. It would be nice to spend some time there as most of the time is clearly spent in looking for decompositions.
> 
> (I messed up the case of `k=1` in the intermediate commit... so they are not relevant)


Several values decreased in the table of mols.

Btw, you should have opened another ticket to remove `who_asked` and move functions around.

Nathann



---

archive/issue_comments_268398.json:
```json
{
    "body": "<a id='comment:34'></a>\nWhat the hell is this `find_wilson_decomposition` function ? I told you that I had already written the very same thing in #16500 !!\n\nNathann",
    "created_at": "2014-06-25T08:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268398",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:34'></a>
What the hell is this `find_wilson_decomposition` function ? I told you that I had already written the very same thing in #16500 !!

Nathann



---

archive/issue_comments_268399.json:
```json
{
    "body": "<a id='comment:35'></a>\nOkay, could you move the last two commits to a different patch, *above* those that are aready in `needs_review` ?\n\nNathann",
    "created_at": "2014-06-25T08:06:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268399",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:35'></a>
Okay, could you move the last two commits to a different patch, *above* those that are aready in `needs_review` ?

Nathann



---

archive/issue_comments_268400.json:
```json
{
    "body": "<a id='comment:36'></a>\nAll right...",
    "created_at": "2014-06-25T09:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268400",
    "user": "https://github.com/videlec"
}
```

<a id='comment:36'></a>
All right...



---

archive/issue_comments_268401.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-06-25T09:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268401",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_268402.json:
```json
{
    "body": "<a id='comment:37'></a>\nHi Nathann,\n\nThere is something that I do not understand. After the merge of #16430 the MOLS table gets better... but it is fake\n\n```\nsage: designs.orthogonal_array(8,66,existence=True)\nTrue\nsage: designs.orthogonal_array(8,66)\nTraceback (most recent call last):\n...\nAssertionError\n```\n\nSo please do the merge yourself from f5069f0. I will adapt the review from there.\n\nVincent",
    "created_at": "2014-06-25T09:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268402",
    "user": "https://github.com/videlec"
}
```

<a id='comment:37'></a>
Hi Nathann,

There is something that I do not understand. After the merge of #16430 the MOLS table gets better... but it is fake

```
sage: designs.orthogonal_array(8,66,existence=True)
True
sage: designs.orthogonal_array(8,66)
Traceback (most recent call last):
...
AssertionError
```

So please do the merge yourself from f5069f0. I will adapt the review from there.

Vincent



---

archive/issue_comments_268403.json:
```json
{
    "body": "<a id='comment:38'></a>\nYo !\n\n> So please do the merge yourself from f5069f0.\n\n\n....\n\nNow I have to fix the bugs you meet when you do a merge ?...\n\nNathann",
    "created_at": "2014-06-25T09:41:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268403",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:38'></a>
Yo !

> So please do the merge yourself from f5069f0.


....

Now I have to fix the bugs you meet when you do a merge ?...

Nathann



---

archive/issue_comments_268404.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [ncohen](#comment%3A38):\n> Yo !\n> \n> > So please do the merge yourself from f5069f0.\n\n> \n> ....\n> \n> Now I have to fix the bugs you meet when you do a merge ?...\n\n\nNope. The merge with #16430 just fails. f5069f0 is your commit before I started the review. I can dig to find what is the problem here but you should be able to find better than me what is the problem...",
    "created_at": "2014-06-25T09:45:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268404",
    "user": "https://github.com/videlec"
}
```

<a id='comment:39'></a>
Replying to [ncohen](#comment%3A38):
> Yo !
> 
> > So please do the merge yourself from f5069f0.

> 
> ....
> 
> Now I have to fix the bugs you meet when you do a merge ?...


Nope. The merge with #16430 just fails. f5069f0 is your commit before I started the review. I can dig to find what is the problem here but you should be able to find better than me what is the problem...



---

archive/issue_comments_268405.json:
```json
{
    "body": "<a id='comment:40'></a>\nOkay, here it is. There was a problem in `find_wilson_decomposition_with_two_truncated_groups`, a variable was being assigned negative values.\n\nFixed in the updated branch which rebases history. I will also need to rewrite the branches above this one.\n\nNathann\n\nP.S. : I pushed the changes on u/ncohen/16347 because pushing on the public one may have deleted commits, though you probably have them on your computer.",
    "created_at": "2014-06-25T10:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268405",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:40'></a>
Okay, here it is. There was a problem in `find_wilson_decomposition_with_two_truncated_groups`, a variable was being assigned negative values.

Fixed in the updated branch which rebases history. I will also need to rewrite the branches above this one.

Nathann

P.S. : I pushed the changes on u/ncohen/16347 because pushing on the public one may have deleted commits, though you probably have them on your computer.



---

archive/issue_comments_268406.json:
```json
{
    "body": "Changing commit from \"cb67ae69db6ed23971e2ba8eceeebe1e72f714db\" to \"f5069f0dd30bd698489fa047b6fdabd7b8cdaf03\"",
    "created_at": "2014-06-25T10:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268406",
    "user": "https://github.com/nathanncohen"
}
```

Changing commit from "cb67ae69db6ed23971e2ba8eceeebe1e72f714db" to "f5069f0dd30bd698489fa047b6fdabd7b8cdaf03"



---

archive/issue_comments_268407.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-06-25T10:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268407",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_268408.json:
```json
{
    "body": "Changing branch from \"public/16347\" to \"u/ncohen/16347\"",
    "created_at": "2014-06-25T10:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268408",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "public/16347" to "u/ncohen/16347"



---

archive/issue_comments_268409.json:
```json
{
    "body": "Changing commit from \"f5069f0dd30bd698489fa047b6fdabd7b8cdaf03\" to \"0fa89d548f431a8929c76f3205bdb6c3779cf432\"",
    "created_at": "2014-06-25T10:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268409",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f5069f0dd30bd698489fa047b6fdabd7b8cdaf03" to "0fa89d548f431a8929c76f3205bdb6c3779cf432"



---

archive/issue_comments_268410.json:
```json
{
    "body": "<a id='comment:41'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[03c1f45](http://git.sagemath.org/sage.git/commit/?id=03c1f4515b266f11e905136d6bda9a9de126b322)|`trac #16430: Small speedup for OA(None,p^c)`|\n|[8e8a9f3](http://git.sagemath.org/sage.git/commit/?id=8e8a9f3226e5ee5815e40156bd71286998476ff0)|`trac #16430: Merged with 6.3.beta4`|\n|[162b83c](http://git.sagemath.org/sage.git/commit/?id=162b83c0772a9c2a02eb3cea71028e8d14a6c0a7)|`trac #16430: Many bugfixes`|\n|[3e01acb](http://git.sagemath.org/sage.git/commit/?id=3e01acb6cc2f189d606f6877264f7d635a9a2036)|`trac #16430: micro improvements`|\n|[81b9448](http://git.sagemath.org/sage.git/commit/?id=81b9448a730769e28af52c3ea36faa5b8156232a)|`trac #16430: put back the seealso`|\n|[0fa89d5](http://git.sagemath.org/sage.git/commit/?id=0fa89d548f431a8929c76f3205bdb6c3779cf432)|`trac #16347: Wilson's construction with two truncated groups`|",
    "created_at": "2014-06-25T10:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268410",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[03c1f45](http://git.sagemath.org/sage.git/commit/?id=03c1f4515b266f11e905136d6bda9a9de126b322)|`trac #16430: Small speedup for OA(None,p^c)`|
|[8e8a9f3](http://git.sagemath.org/sage.git/commit/?id=8e8a9f3226e5ee5815e40156bd71286998476ff0)|`trac #16430: Merged with 6.3.beta4`|
|[162b83c](http://git.sagemath.org/sage.git/commit/?id=162b83c0772a9c2a02eb3cea71028e8d14a6c0a7)|`trac #16430: Many bugfixes`|
|[3e01acb](http://git.sagemath.org/sage.git/commit/?id=3e01acb6cc2f189d606f6877264f7d635a9a2036)|`trac #16430: micro improvements`|
|[81b9448](http://git.sagemath.org/sage.git/commit/?id=81b9448a730769e28af52c3ea36faa5b8156232a)|`trac #16430: put back the seealso`|
|[0fa89d5](http://git.sagemath.org/sage.git/commit/?id=0fa89d548f431a8929c76f3205bdb6c3779cf432)|`trac #16347: Wilson's construction with two truncated groups`|



---

archive/issue_comments_268411.json:
```json
{
    "body": "<a id='comment:42'></a>\nThank you!",
    "created_at": "2014-06-25T10:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268411",
    "user": "https://github.com/videlec"
}
```

<a id='comment:42'></a>
Thank you!



---

archive/issue_comments_268412.json:
```json
{
    "body": "<a id='comment:43'></a>\nMore reasonable review at `public/16347-bis`. If you like it enough, set to positive review.\n\nVincent",
    "created_at": "2014-06-25T10:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268412",
    "user": "https://github.com/videlec"
}
```

<a id='comment:43'></a>
More reasonable review at `public/16347-bis`. If you like it enough, set to positive review.

Vincent



---

archive/issue_comments_268413.json:
```json
{
    "body": "<a id='comment:44'></a>\nYo !\n\n> More reasonable review at `public/16347-bis`. If you like it enough, set to positive review.\n\n\nI agree with the latest two commits but when it comes to the modifications made in `find_wilson_decomposition_with_two_truncated_groups` I believe that you are really making the code harder to read for almost no improvement. You add 6 lines to replace one, and this only to avoid calling `orthogonal_arrays` several times, knowing that all calls would answer instantly (they do the check that \"n<=1 or k<n+1\" each time).\n\nWhen `n` is not a prime power, I expect that `orthogonal_array(n+1,n,existence=True)` is much more costly than all `orthogonal_array(n+1,n_prime,existence=True)` for `n_prime<n` combined (all straightforward 'no').\n\nReally, that's not where the performance is hidden. The next patch improves things a lot, and the next patch on recursive constructions make things a lot worse. There will be profiling to do there, but really that's not where performance is to be found.\n\nNathann",
    "created_at": "2014-06-25T11:11:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268413",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:44'></a>
Yo !

> More reasonable review at `public/16347-bis`. If you like it enough, set to positive review.


I agree with the latest two commits but when it comes to the modifications made in `find_wilson_decomposition_with_two_truncated_groups` I believe that you are really making the code harder to read for almost no improvement. You add 6 lines to replace one, and this only to avoid calling `orthogonal_arrays` several times, knowing that all calls would answer instantly (they do the check that "n<=1 or k<n+1" each time).

When `n` is not a prime power, I expect that `orthogonal_array(n+1,n,existence=True)` is much more costly than all `orthogonal_array(n+1,n_prime,existence=True)` for `n_prime<n` combined (all straightforward 'no').

Really, that's not where the performance is hidden. The next patch improves things a lot, and the next patch on recursive constructions make things a lot worse. There will be profiling to do there, but really that's not where performance is to be found.

Nathann



---

archive/issue_comments_268414.json:
```json
{
    "body": "<a id='comment:45'></a>\n(There are broken doctests in `block_design.py`)",
    "created_at": "2014-06-25T11:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268414",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:45'></a>
(There are broken doctests in `block_design.py`)



---

archive/issue_comments_268415.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [ncohen](#comment%3A44):\n> Yo !\n> \n> > More reasonable review at `public/16347-bis`. If you like it enough, set to positive review.\n\n> \n> I agree with the latest two commits but when it comes to the modifications made in `find_wilson_decomposition_with_two_truncated_groups` I believe that you are really making the code harder to read for almost no improvement. You add 6 lines to replace one, and this only to avoid calling `orthogonal_arrays` several times, knowing that all calls would answer instantly (they do the check that \"n<=1 or k<n+1\" each time).\n> \n> When `n` is not a prime power, I expect that `orthogonal_array(n+1,n,existence=True)` is much more costly than all `orthogonal_array(n+1,n_prime,existence=True)` for `n_prime<n` combined (all straightforward 'no').\n> \n> Really, that's not where the performance is hidden. The next patch improves things a lot, and the next patch on recursive constructions make things a lot worse. There will be profiling to do there, but really that's not where performance is to be found.\n\n\nThen, why after the commit is it 30% faster to construct the MOLS table?\n\nEDIT: and I have no doctest error.\n\nVincent",
    "created_at": "2014-06-25T11:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268415",
    "user": "https://github.com/videlec"
}
```

<a id='comment:46'></a>
Replying to [ncohen](#comment%3A44):
> Yo !
> 
> > More reasonable review at `public/16347-bis`. If you like it enough, set to positive review.

> 
> I agree with the latest two commits but when it comes to the modifications made in `find_wilson_decomposition_with_two_truncated_groups` I believe that you are really making the code harder to read for almost no improvement. You add 6 lines to replace one, and this only to avoid calling `orthogonal_arrays` several times, knowing that all calls would answer instantly (they do the check that "n<=1 or k<n+1" each time).
> 
> When `n` is not a prime power, I expect that `orthogonal_array(n+1,n,existence=True)` is much more costly than all `orthogonal_array(n+1,n_prime,existence=True)` for `n_prime<n` combined (all straightforward 'no').
> 
> Really, that's not where the performance is hidden. The next patch improves things a lot, and the next patch on recursive constructions make things a lot worse. There will be profiling to do there, but really that's not where performance is to be found.


Then, why after the commit is it 30% faster to construct the MOLS table?

EDIT: and I have no doctest error.

Vincent



---

archive/issue_comments_268416.json:
```json
{
    "body": "<a id='comment:47'></a>\nHere are the timings I got\n\nold timing before the branch cut (at 0fa89d5)\n\n```\nsage -t --long latin_squares.py\n    [36 tests, 17.83 s]\n```\nnew timings after the branch cut (at  828ff22)\n\n```\nsage -t --long latin_squares.py\n    [36 tests, 15.00 s]\n```",
    "created_at": "2014-06-25T11:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268416",
    "user": "https://github.com/videlec"
}
```

<a id='comment:47'></a>
Here are the timings I got

old timing before the branch cut (at 0fa89d5)

```
sage -t --long latin_squares.py
    [36 tests, 17.83 s]
```
new timings after the branch cut (at  828ff22)

```
sage -t --long latin_squares.py
    [36 tests, 15.00 s]
```



---

archive/issue_comments_268417.json:
```json
{
    "body": "<a id='comment:48'></a>\nRight right it's faster this way, sorry for what I said. I find it weird, but still, it is faster `O_o`\n\nNathann",
    "created_at": "2014-06-25T11:39:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268417",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:48'></a>
Right right it's faster this way, sorry for what I said. I find it weird, but still, it is faster `O_o`

Nathann



---

archive/issue_comments_268418.json:
```json
{
    "body": "<a id='comment:49'></a>\nSorry, it was my fault again for the doctests too. Positive review then, thank you for your help !\n\nNathann",
    "created_at": "2014-06-25T11:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268418",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:49'></a>
Sorry, it was my fault again for the doctests too. Positive review then, thank you for your help !

Nathann



---

archive/issue_comments_268419.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Vincent Delecroix\"",
    "created_at": "2014-06-25T11:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268419",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Vincent Delecroix"



---

archive/issue_comments_268420.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-06-25T11:43:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268420",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_268421.json:
```json
{
    "body": "Changing commit from \"0fa89d548f431a8929c76f3205bdb6c3779cf432\" to \"0175134767948882f3d8c2ea0a612161ed3d4154\"",
    "created_at": "2014-06-25T11:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268421",
    "user": "https://github.com/nathanncohen"
}
```

Changing commit from "0fa89d548f431a8929c76f3205bdb6c3779cf432" to "0175134767948882f3d8c2ea0a612161ed3d4154"



---

archive/issue_comments_268422.json:
```json
{
    "body": "<a id='comment:50'></a>\nNew commits:\n|                                                                                                                                          |                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|\n|[828ff22](http://git.sagemath.org/sage.git/commit/?id=828ff220b83ce8427025bebe42bbc3aaa21ac28b)|`trac #16437: cut the branches in W. dec. with two trunc. blocks`|\n|[8ebd21b](http://git.sagemath.org/sage.git/commit/?id=8ebd21be12c81b751a7f09067221bef01014b705)|`trac #16347: use is_sum_of_squares_pyx instead of two_squares`|\n|[0175134](http://git.sagemath.org/sage.git/commit/?id=0175134767948882f3d8c2ea0a612161ed3d4154)|`trac #16347: doc + simplifications`|",
    "created_at": "2014-06-25T11:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268422",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:50'></a>
New commits:
|                                                                                                                                          |                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
|[828ff22](http://git.sagemath.org/sage.git/commit/?id=828ff220b83ce8427025bebe42bbc3aaa21ac28b)|`trac #16437: cut the branches in W. dec. with two trunc. blocks`|
|[8ebd21b](http://git.sagemath.org/sage.git/commit/?id=8ebd21be12c81b751a7f09067221bef01014b705)|`trac #16347: use is_sum_of_squares_pyx instead of two_squares`|
|[0175134](http://git.sagemath.org/sage.git/commit/?id=0175134767948882f3d8c2ea0a612161ed3d4154)|`trac #16347: doc + simplifications`|



---

archive/issue_comments_268423.json:
```json
{
    "body": "Changing branch from \"u/ncohen/16347\" to \"public/16347-bis\"",
    "created_at": "2014-06-25T11:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268423",
    "user": "https://github.com/nathanncohen"
}
```

Changing branch from "u/ncohen/16347" to "public/16347-bis"



---

archive/issue_events_048172.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-26T01:50:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16347#event-48172"
}
```



---

archive/issue_comments_268424.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-06-26T01:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268424",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_268425.json:
```json
{
    "body": "Changing branch from \"public/16347-bis\" to \"0175134767948882f3d8c2ea0a612161ed3d4154\"",
    "created_at": "2014-06-26T01:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16347",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16347#issuecomment-268425",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/16347-bis" to "0175134767948882f3d8c2ea0a612161ed3d4154"
