# Issue 16500: New recursive constructions of Orthogonal Arrays

archive/issues_016263.json:
```json
{
    "body": "Here they are ! They have been sitting on my HD for a long time `:-P`\n\nNathann\n\n**CC:**  @videlec @KPanComputes\n\n**Branch/Commit:** [697dd0ca8284485897b051015af74b385c345fb4](https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4)\n\n**Reviewer:** Vincent Delecroix\n\n**Author:** Nathann Cohen\n\n**Dependencies:** #16499\n\nIssue created by migration from https://trac.sagemath.org/ticket/16500\n\n",
    "closed_at": "2014-06-26T19:37:07Z",
    "created_at": "2014-06-19T15:04:25Z",
    "labels": [
        "component: combinatorial designs",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "New recursive constructions of Orthogonal Arrays",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16500",
    "user": "https://github.com/nathanncohen"
}
```
Here they are ! They have been sitting on my HD for a long time `:-P`

Nathann

**CC:**  @videlec @KPanComputes

**Branch/Commit:** [697dd0ca8284485897b051015af74b385c345fb4](https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4)

**Reviewer:** Vincent Delecroix

**Author:** Nathann Cohen

**Dependencies:** #16499

Issue created by migration from https://trac.sagemath.org/ticket/16500





---

archive/issue_events_150475.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-19T15:22:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150475"
}
```



---

archive/issue_comments_217782.json:
```json
{
    "body": "**Branch:** [u/ncohen/16500](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16500)",
    "created_at": "2014-06-19T15:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217782",
    "user": "https://github.com/nathanncohen"
}
```

**Branch:** [u/ncohen/16500](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16500)



---

archive/issue_comments_217783.json:
```json
{
    "body": "<a id='comment:3'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/004833af803033e08e71011d4e69462de8909283\">004833a</a></td><td><code>trac #16347: Wilson's construction with two truncated groups</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f5069f0dd30bd698489fa047b6fdabd7b8cdaf03\">f5069f0</a></td><td><code>trac #16347: Merged with 6.3.beta4</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f182d3691892b0b1cdde8f4ab61df26845eb3e8b\">f182d36</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462\">70f7046</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr></table>\n",
    "created_at": "2014-06-19T15:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217783",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/004833af803033e08e71011d4e69462de8909283">004833a</a></td><td><code>trac #16347: Wilson's construction with two truncated groups</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f5069f0dd30bd698489fa047b6fdabd7b8cdaf03">f5069f0</a></td><td><code>trac #16347: Merged with 6.3.beta4</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f182d3691892b0b1cdde8f4ab61df26845eb3e8b">f182d36</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462">70f7046</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr></table>




---

archive/issue_comments_217784.json:
```json
{
    "body": "**Commit:** [70f7046fea49d3ae47cfd3670a9c53f34791e462](https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462)",
    "created_at": "2014-06-19T15:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217784",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Commit:** [70f7046fea49d3ae47cfd3670a9c53f34791e462](https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462)



---

archive/issue_events_150476.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-19T21:20:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150476"
}
```



---

archive/issue_events_150477.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-19T21:20:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150477"
}
```



---

archive/issue_comments_217785.json:
```json
{
    "body": "<a id='comment:4'></a>\nEDIT: deleted comment as I messed up ticket numbers...",
    "created_at": "2014-06-19T21:20:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217785",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
EDIT: deleted comment as I messed up ticket numbers...



---

archive/issue_comments_217786.json:
```json
{
    "body": "<a id='comment:5'></a>\n(Replying to [comment:4](#comment%3A4)) sorry, this comment was for #16430. Not this one!!",
    "created_at": "2014-06-19T21:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217786",
    "user": "https://github.com/videlec"
}
```

<a id='comment:5'></a>
(Replying to [comment:4](#comment%3A4)) sorry, this comment was for #16430. Not this one!!



---

archive/issue_events_150478.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-19T21:29:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150478"
}
```



---

archive/issue_events_150479.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-19T21:29:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150479"
}
```



---

archive/issue_comments_217787.json:
```json
{
    "body": "<a id='comment:7'></a>\nRebased on top of #16499. But.... \n\n```\nsage -t --long latin_squares.py\n    [40 tests, 35.08 s]\n```\n\n`T_T`\n\nNathann",
    "created_at": "2014-06-25T13:58:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217787",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>
Rebased on top of #16499. But.... 

```
sage -t --long latin_squares.py
    [40 tests, 35.08 s]
```

`T_T`

Nathann



---

archive/issue_comments_217788.json:
```json
{
    "body": "<a id='comment:8'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0fa89d548f431a8929c76f3205bdb6c3779cf432\">0fa89d5</a></td><td><code>trac #16347: Wilson's construction with two truncated groups</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/828ff220b83ce8427025bebe42bbc3aaa21ac28b\">828ff22</a></td><td><code>trac #16437: cut the branches in W. dec. with two trunc. blocks</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8ebd21be12c81b751a7f09067221bef01014b705\">8ebd21b</a></td><td><code>trac #16347: use is_sum_of_squares_pyx instead of two_squares</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0175134767948882f3d8c2ea0a612161ed3d4154\">0175134</a></td><td><code>trac #16347: doc + simplifications</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ff5062f8d005f19bcdfabf1f9ea65a11856da0b\">9ff5062</a></td><td><code>trac #16423: Table of MOLS from the handbook and comparison with Sage</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e64be9845ccf9a763bc6b89dcb6530e9962bbe92\">e64be98</a></td><td><code>trac #16423: tiny code improvement and alignment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e948cf64a435f48206b3f46ff9693201c5675ed5\">e948cf6</a></td><td><code>trac #16423: Aligning the alignment</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0a7d853bf758ac7abce1acfe54e18c5ea784d21f\">0a7d853</a></td><td><code>trac #16423: Broken doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b3293519d314c2bd98c8074a4bd24f1535d92247\">b329351</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/770a28da24236a2b13f905eab3d827e0fbfe34d8\">770a28d</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr></table>\n",
    "created_at": "2014-06-25T13:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217788",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **Last 10 new commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0fa89d548f431a8929c76f3205bdb6c3779cf432">0fa89d5</a></td><td><code>trac #16347: Wilson's construction with two truncated groups</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/828ff220b83ce8427025bebe42bbc3aaa21ac28b">828ff22</a></td><td><code>trac #16437: cut the branches in W. dec. with two trunc. blocks</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8ebd21be12c81b751a7f09067221bef01014b705">8ebd21b</a></td><td><code>trac #16347: use is_sum_of_squares_pyx instead of two_squares</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0175134767948882f3d8c2ea0a612161ed3d4154">0175134</a></td><td><code>trac #16347: doc + simplifications</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ff5062f8d005f19bcdfabf1f9ea65a11856da0b">9ff5062</a></td><td><code>trac #16423: Table of MOLS from the handbook and comparison with Sage</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e64be9845ccf9a763bc6b89dcb6530e9962bbe92">e64be98</a></td><td><code>trac #16423: tiny code improvement and alignment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e948cf64a435f48206b3f46ff9693201c5675ed5">e948cf6</a></td><td><code>trac #16423: Aligning the alignment</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0a7d853bf758ac7abce1acfe54e18c5ea784d21f">0a7d853</a></td><td><code>trac #16423: Broken doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b3293519d314c2bd98c8074a4bd24f1535d92247">b329351</a></td><td><code>trac #16499: Cheap speedup in the OA recursive constructions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/770a28da24236a2b13f905eab3d827e0fbfe34d8">770a28d</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr></table>




---

archive/issue_comments_217789.json:
```json
{
    "body": "**Changing commit** from \"[70f7046fea49d3ae47cfd3670a9c53f34791e462](https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462)\" to \"[770a28da24236a2b13f905eab3d827e0fbfe34d8](https://github.com/sagemath/sagetrac-mirror/commit/770a28da24236a2b13f905eab3d827e0fbfe34d8)\".",
    "created_at": "2014-06-25T13:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217789",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[70f7046fea49d3ae47cfd3670a9c53f34791e462](https://github.com/sagemath/sagetrac-mirror/commit/70f7046fea49d3ae47cfd3670a9c53f34791e462)" to "[770a28da24236a2b13f905eab3d827e0fbfe34d8](https://github.com/sagemath/sagetrac-mirror/commit/770a28da24236a2b13f905eab3d827e0fbfe34d8)".



---

archive/issue_comments_217790.json:
```json
{
    "body": "<a id='comment:9'></a>\nHi Nathann,\n\nStupid questions to start:\n- It would be nice to have references! You provide `[AC07]_` for `construction_3_4` but that's all.\n- Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?\n- Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)\n\nVicent",
    "created_at": "2014-06-25T14:40:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217790",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>
Hi Nathann,

Stupid questions to start:
- It would be nice to have references! You provide `[AC07]_` for `construction_3_4` but that's all.
- Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?
- Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)

Vicent



---

archive/issue_comments_217791.json:
```json
{
    "body": "<a id='comment:10'></a>\nYo !\n\nI updated the \"find\" functions a bit. Nothing smart, just common sense, and the `MOLS_table` function is fast again. Yeepeeeeeeeeee !!! `:-P`\n\n> - It would be nice to have references! You provide `[AC07]_` for `construction_3_4` but that's all.\n\n\nAhahahah. I had nothing else `:-P`\n\nI tried to reverse-engineer the construction from the theorem's claim, and when I was not able too I asked Julian R. Abel for a hint. This being said, the explanations I give in the docstring are more or less like a proof.\n\n> - Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?\n\n\nBecause I thought that it would be abusing your kindness. I waste my health implementing those things, but I still try to makes patches somehow readable so that reviewing them will not be hell for you. I can add a commit for that if you don't mind. As I told you by email, \"this is in the plan\" `:-P`\n\n> - Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)\n\n\nBecause this function returns both OA and !True/False answers. The `find_*` functions I cached only return immutable stuff.\n\nNathann",
    "created_at": "2014-06-25T14:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217791",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:10'></a>
Yo !

I updated the "find" functions a bit. Nothing smart, just common sense, and the `MOLS_table` function is fast again. Yeepeeeeeeeeee !!! `:-P`

> - It would be nice to have references! You provide `[AC07]_` for `construction_3_4` but that's all.


Ahahahah. I had nothing else `:-P`

I tried to reverse-engineer the construction from the theorem's claim, and when I was not able too I asked Julian R. Abel for a hint. This being said, the explanations I give in the docstring are more or less like a proof.

> - Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?


Because I thought that it would be abusing your kindness. I waste my health implementing those things, but I still try to makes patches somehow readable so that reviewing them will not be hell for you. I can add a commit for that if you don't mind. As I told you by email, "this is in the plan" `:-P`

> - Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)


Because this function returns both OA and !True/False answers. The `find_*` functions I cached only return immutable stuff.

Nathann



---

archive/issue_comments_217792.json:
```json
{
    "body": "<a id='comment:11'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c\">a67c04f</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr></table>\n",
    "created_at": "2014-06-25T14:51:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217792",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c">a67c04f</a></td><td><code>trac #16500: New recursive constructions of Orthogonal Arrays</code></td></tr></table>




---

archive/issue_comments_217793.json:
```json
{
    "body": "**Changing commit** from \"[770a28da24236a2b13f905eab3d827e0fbfe34d8](https://github.com/sagemath/sagetrac-mirror/commit/770a28da24236a2b13f905eab3d827e0fbfe34d8)\" to \"[a67c04f13bd0aa2b46e6998d2b996437f342470c](https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c)\".",
    "created_at": "2014-06-25T14:51:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217793",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[770a28da24236a2b13f905eab3d827e0fbfe34d8](https://github.com/sagemath/sagetrac-mirror/commit/770a28da24236a2b13f905eab3d827e0fbfe34d8)" to "[a67c04f13bd0aa2b46e6998d2b996437f342470c](https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c)".



---

archive/issue_comments_217794.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [ncohen](#comment%3A10):\n \n> > - Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?\n \n> \n> Because I thought that it would be abusing your kindness. I waste my health implementing those things, but I still try to makes patches somehow readable so that reviewing them will not be hell for you. I can add a commit for that if you don't mind. As I told you by email, \"this is in the plan\" `:-P`\n\n\nOk. Will see that later. I postponed to #16535 if you agree.\n\n> > - Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)\n \n> \n> Because this function returns both OA and !True/False answers. The `find_*` functions I cached only return immutable stuff.\n\n\nBut why not having `orthogonal_array` implements the three lines that are right now in `find_recursive_construction`? My main concern is about readability. I would prefer\n\n```\n@cached_method\ndef find_recursive_construction(k,n):\n    for find_c in [find_construction_3_3,\n                   find_construction_3_4,\n                   find_construction_3_5,\n                   find_construction_3_6]:\n        res = find_c(k,n)\n        if res: return res\n```\nThat way:\n- you still have the freedom to update `find_recursive_construction` without touching `orthogonal_array`\n- you keep an eye on who did what with the cache\n- you perform the work of adapting your answer only in `orthogonal_array`\n- if you changed your mind about the syntax `existence=True` and such you will not have to touch to `find_recursive_construction`\n- the file `orthogonal_array_recursive.py` will look like a \"dynamical\" database in the very same way that `database.py` is a static one\n\nVincent",
    "created_at": "2014-06-25T15:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217794",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>
Replying to [ncohen](#comment%3A10):
 
> > - Why you did not move `product`, `one_truncated_group` and `two_trucated_group` in the recursive construction?
 
> 
> Because I thought that it would be abusing your kindness. I waste my health implementing those things, but I still try to makes patches somehow readable so that reviewing them will not be hell for you. I can add a commit for that if you don't mind. As I told you by email, "this is in the plan" `:-P`


Ok. Will see that later. I postponed to #16535 if you agree.

> > - Why not put the cache only for `find_recursive_construction`? (less cached function and less function calls)
 
> 
> Because this function returns both OA and !True/False answers. The `find_*` functions I cached only return immutable stuff.


But why not having `orthogonal_array` implements the three lines that are right now in `find_recursive_construction`? My main concern is about readability. I would prefer

```
@cached_method
def find_recursive_construction(k,n):
    for find_c in [find_construction_3_3,
                   find_construction_3_4,
                   find_construction_3_5,
                   find_construction_3_6]:
        res = find_c(k,n)
        if res: return res
```
That way:
- you still have the freedom to update `find_recursive_construction` without touching `orthogonal_array`
- you keep an eye on who did what with the cache
- you perform the work of adapting your answer only in `orthogonal_array`
- if you changed your mind about the syntax `existence=True` and such you will not have to touch to `find_recursive_construction`
- the file `orthogonal_array_recursive.py` will look like a "dynamical" database in the very same way that `database.py` is a static one

Vincent



---

archive/issue_comments_217795.json:
```json
{
    "body": "<a id='comment:13'></a>\nYo !\n\n> Ok. Will see that later. I postponed to #16535 if you agree.\n\n\nI will have to rebase what is currently above this patch, then.\n\nWell.... does not matter...\n\n> But why not having `orthogonal_array` implements the three lines that are right now in `find_recursive_construction`? \n\n\nOh, you mean only the part that actually creates the design ? Yeah, why not !...\n\nI will add a commit for that in a second.\n\nNathann",
    "created_at": "2014-06-25T15:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217795",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:13'></a>
Yo !

> Ok. Will see that later. I postponed to #16535 if you agree.


I will have to rebase what is currently above this patch, then.

Well.... does not matter...

> But why not having `orthogonal_array` implements the three lines that are right now in `find_recursive_construction`? 


Oh, you mean only the part that actually creates the design ? Yeah, why not !...

I will add a commit for that in a second.

Nathann



---

archive/issue_comments_217796.json:
```json
{
    "body": "**Changing commit** from \"[a67c04f13bd0aa2b46e6998d2b996437f342470c](https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c)\" to \"[41c50d5a256d9e746d8acfb33a4ff7c58e05789b](https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b)\".",
    "created_at": "2014-06-25T15:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217796",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[a67c04f13bd0aa2b46e6998d2b996437f342470c](https://github.com/sagemath/sagetrac-mirror/commit/a67c04f13bd0aa2b46e6998d2b996437f342470c)" to "[41c50d5a256d9e746d8acfb33a4ff7c58e05789b](https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b)".



---

archive/issue_comments_217797.json:
```json
{
    "body": "<a id='comment:14'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b\">41c50d5</a></td><td><code>trac #16500: Simplified find_recursive_construction</code></td></tr></table>\n",
    "created_at": "2014-06-25T15:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217797",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b">41c50d5</a></td><td><code>trac #16500: Simplified find_recursive_construction</code></td></tr></table>




---

archive/issue_comments_217798.json:
```json
{
    "body": "<a id='comment:15'></a>\nHi,\n\nsmall commit at `u/vdelecroix/16500`\n\nBe careful that a truncated OA is **not** an incomplete OA. In truncated OA you removed points in columns whereas in incomplete OA you have less blocks than an OA (but columns are not changed)... it is very confusing to read your doc. And moreover you use block or column indifferently but it would be better to have a unique name for that.\n\nIn the doc of the construction 3.4 there is\n\n```\n- If there exists an `OA(k,m+r+1)` the column of size `s` is truncated in\n  order to intersect `B_0`.\n\n- If there exists an `OA(k,m+r+1)`, the last column must not intersect `B_0`\n```\nwhich is contradictory!\n\nThe rest is fine except that there is no need to use linear programming to build an oval, see #16552.\n\nVincent",
    "created_at": "2014-06-26T09:31:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217798",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>
Hi,

small commit at `u/vdelecroix/16500`

Be careful that a truncated OA is **not** an incomplete OA. In truncated OA you removed points in columns whereas in incomplete OA you have less blocks than an OA (but columns are not changed)... it is very confusing to read your doc. And moreover you use block or column indifferently but it would be better to have a unique name for that.

In the doc of the construction 3.4 there is

```
- If there exists an `OA(k,m+r+1)` the column of size `s` is truncated in
  order to intersect `B_0`.

- If there exists an `OA(k,m+r+1)`, the last column must not intersect `B_0`
```
which is contradictory!

The rest is fine except that there is no need to use linear programming to build an oval, see #16552.

Vincent



---

archive/issue_events_150480.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-26T09:32:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150480"
}
```



---

archive/issue_events_150481.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-26T09:32:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150481"
}
```



---

archive/issue_comments_217799.json:
```json
{
    "body": "<a id='comment:17'></a>\nYo !\n\n> small commit at `u/vdelecroix/16500`\n\n\nLooks good !\n\n> Be careful that a truncated OA is **not** an incomplete OA. \n\n\nArg yes yes, I always mix the two words `^^;`\n\nAnd moreover you use block or column indifferently but it would be better to have a unique name for that.\n\nDo you mean \"column or group\" ? There are `n^2` blocks in an `OA(k,n)` but `k` columns.\n\n> In the doc of the construction 3.4 there is\n> \n> ```\n> - If there exists an `OA(k,m+r+1)` the column of size `s` is truncated in\n>   order to intersect `B_0`.\n> \n> - If there exists an `OA(k,m+r+1)`, the last column must not intersect `B_0`\n> ```\n> which is contradictory!\n\n\nI don't se how `O_o`\n\n> The rest is fine except that there is no need to use linear programming to build an oval, see #16552.\n\n\nOh ? Cool. Free ovals ! `:-D`\n\nNathann",
    "created_at": "2014-06-26T09:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217799",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>
Yo !

> small commit at `u/vdelecroix/16500`


Looks good !

> Be careful that a truncated OA is **not** an incomplete OA. 


Arg yes yes, I always mix the two words `^^;`

And moreover you use block or column indifferently but it would be better to have a unique name for that.

Do you mean "column or group" ? There are `n^2` blocks in an `OA(k,n)` but `k` columns.

> In the doc of the construction 3.4 there is
> 
> ```
> - If there exists an `OA(k,m+r+1)` the column of size `s` is truncated in
>   order to intersect `B_0`.
> 
> - If there exists an `OA(k,m+r+1)`, the last column must not intersect `B_0`
> ```
> which is contradictory!


I don't se how `O_o`

> The rest is fine except that there is no need to use linear programming to build an oval, see #16552.


Oh ? Cool. Free ovals ! `:-D`

Nathann



---

archive/issue_comments_217800.json:
```json
{
    "body": "<a id='comment:18'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173\">e1992ce</a></td><td><code>trac #16500: doc + speedup</code></td></tr></table>\n",
    "created_at": "2014-06-26T09:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217800",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173">e1992ce</a></td><td><code>trac #16500: doc + speedup</code></td></tr></table>




---

archive/issue_comments_217801.json:
```json
{
    "body": "**Changing commit** from \"[41c50d5a256d9e746d8acfb33a4ff7c58e05789b](https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b)\" to \"[e1992ce4c0a145ce8fd61fae0abe0809cd6ff173](https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173)\".",
    "created_at": "2014-06-26T09:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217801",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[41c50d5a256d9e746d8acfb33a4ff7c58e05789b](https://github.com/sagemath/sagetrac-mirror/commit/41c50d5a256d9e746d8acfb33a4ff7c58e05789b)" to "[e1992ce4c0a145ce8fd61fae0abe0809cd6ff173](https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173)".



---

archive/issue_comments_217802.json:
```json
{
    "body": "<a id='comment:19'></a>\nWhat exactly needs work ?\n\nNathann",
    "created_at": "2014-06-26T09:59:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217802",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:19'></a>
What exactly needs work ?

Nathann



---

archive/issue_comments_217803.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [ncohen](#comment%3A19):\n> What exactly needs work ?\n\n\nthe doc of construction 3.4",
    "created_at": "2014-06-26T10:03:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217803",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>
Replying to [ncohen](#comment%3A19):
> What exactly needs work ?


the doc of construction 3.4



---

archive/issue_comments_217804.json:
```json
{
    "body": "<a id='comment:21'></a>\nThen please answer my question above : what is wrong in those sentences ?\n\nNathann",
    "created_at": "2014-06-26T10:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217804",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:21'></a>
Then please answer my question above : what is wrong in those sentences ?

Nathann



---

archive/issue_comments_217805.json:
```json
{
    "body": "<a id='comment:22'></a>\nOh. Right.",
    "created_at": "2014-06-26T10:05:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217805",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>
Oh. Right.



---

archive/issue_comments_217806.json:
```json
{
    "body": "<a id='comment:23'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4\">697dd0c</a></td><td><code>trac #16500: Typoes in the doc</code></td></tr></table>\n",
    "created_at": "2014-06-26T10:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217806",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4">697dd0c</a></td><td><code>trac #16500: Typoes in the doc</code></td></tr></table>




---

archive/issue_comments_217807.json:
```json
{
    "body": "**Changing commit** from \"[e1992ce4c0a145ce8fd61fae0abe0809cd6ff173](https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173)\" to \"[697dd0ca8284485897b051015af74b385c345fb4](https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4)\".",
    "created_at": "2014-06-26T10:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217807",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[e1992ce4c0a145ce8fd61fae0abe0809cd6ff173](https://github.com/sagemath/sagetrac-mirror/commit/e1992ce4c0a145ce8fd61fae0abe0809cd6ff173)" to "[697dd0ca8284485897b051015af74b385c345fb4](https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4)".



---

archive/issue_events_150482.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-26T10:11:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150482"
}
```



---

archive/issue_events_150483.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-06-26T10:11:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150483"
}
```



---

archive/issue_comments_217808.json:
```json
{
    "body": "<a id='comment:25'></a>\nThis one was much easier once the Wilson construction is understood!\n\nDo you already did the even more general construction from Brouwer-Rees 1982 (they consider generalization of truncated OA where the extra columns are partitioned in possibly more than two parts)?\n\nVincent",
    "created_at": "2014-06-26T10:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217808",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>
This one was much easier once the Wilson construction is understood!

Do you already did the even more general construction from Brouwer-Rees 1982 (they consider generalization of truncated OA where the extra columns are partitioned in possibly more than two parts)?

Vincent



---

archive/issue_events_150484.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-26T10:21:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150484"
}
```



---

archive/issue_events_150485.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-06-26T10:21:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150485"
}
```



---

archive/issue_comments_217809.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2014-06-26T10:22:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217809",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_217810.json:
```json
{
    "body": "<a id='comment:27'></a>\nYo !\n> This one was much easier once the Wilson construction is understood!\n\n\nYep yep. That's what I will remember of design theory. Deadly scary stuff that becomes totally straightforward once you pay attention to it.\n\nStill, a lot of stuff remains deadly scary in the field `:-P`\n\n> Do you already did the even more general construction from Brouwer-Rees 1982 (they consider generalization of truncated OA where the extra columns are partitioned in possibly more than two parts)?\n\n\nNow yet, but I will have to. What scares me is not the implementation of the construction, but how to properly write the input part of the function `T_T`\n\nNathann",
    "created_at": "2014-06-26T10:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217810",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:27'></a>
Yo !
> This one was much easier once the Wilson construction is understood!


Yep yep. That's what I will remember of design theory. Deadly scary stuff that becomes totally straightforward once you pay attention to it.

Still, a lot of stuff remains deadly scary in the field `:-P`

> Do you already did the even more general construction from Brouwer-Rees 1982 (they consider generalization of truncated OA where the extra columns are partitioned in possibly more than two parts)?


Now yet, but I will have to. What scares me is not the implementation of the construction, but how to properly write the input part of the function `T_T`

Nathann



---

archive/issue_comments_217811.json:
```json
{
    "body": "<a id='comment:28'></a>\n> > This one was much easier once the Wilson construction is understood!\n\n\nSome smarter comment: I believe that it is thanks to work like the one we do that we can get to understand such things. That's how it happened to me with LP : I had to implement very basic things 1000 times for Sage, and in the end I find myself understanding the basics properly, which would have NEVER happened if I had just had a book in front of me. Or even if it was in Sage's code.\n\nWhen you implement Sage stuff you are forced to spend time on things you would quickly look at otherwise.\n\nNathann",
    "created_at": "2014-06-26T10:30:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217811",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:28'></a>
> > This one was much easier once the Wilson construction is understood!


Some smarter comment: I believe that it is thanks to work like the one we do that we can get to understand such things. That's how it happened to me with LP : I had to implement very basic things 1000 times for Sage, and in the end I find myself understanding the basics properly, which would have NEVER happened if I had just had a book in front of me. Or even if it was in Sage's code.

When you implement Sage stuff you are forced to spend time on things you would quickly look at otherwise.

Nathann



---

archive/issue_comments_217812.json:
```json
{
    "body": "**Changing branch** from \"[u/ncohen/16500](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16500)\" to \"[697dd0ca8284485897b051015af74b385c345fb4](https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4)\".",
    "created_at": "2014-06-26T19:37:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16500#issuecomment-217812",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/ncohen/16500](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16500)" to "[697dd0ca8284485897b051015af74b385c345fb4](https://github.com/sagemath/sagetrac-mirror/commit/697dd0ca8284485897b051015af74b385c345fb4)".



---

archive/issue_events_150486.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-26T19:37:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150486"
}
```



---

archive/issue_events_150487.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-26T19:37:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16500",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16500#event-150487"
}
```
