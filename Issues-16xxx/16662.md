# Issue 16662: OA for n=1046,1059,2164,3992,3994

archive/issues_016425.json:
```json
{
    "assignees": [],
    "body": "As the title says ! New MOLS from another paper.\n\nNathann\n\nDepends on #16604\n\nCC:  @videlec\n\nBranch/Commit: **[`7a73e74`](https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45)**\n\nReviewer: **Vincent Delecroix**\n\nAuthor: **Nathann Cohen**\n\nComponent: **combinatorial designs**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/16662_\n\n",
    "closed_at": "2014-08-16T09:32:19Z",
    "created_at": "2014-07-16T12:46:12Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorial%20designs",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "OA for n=1046,1059,2164,3992,3994",
    "type": "issue",
    "updated_at": "2014-08-16T09:32:19Z",
    "url": "https://github.com/sagemath/sage/issues/16662",
    "user": "https://github.com/nathanncohen"
}
```
As the title says ! New MOLS from another paper.

Nathann

Depends on #16604

CC:  @videlec

Branch/Commit: **[`7a73e74`](https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45)**

Reviewer: **Vincent Delecroix**

Author: **Nathann Cohen**

Component: **combinatorial designs**

_Issue created by migration from https://trac.sagemath.org/ticket/16662_





---

archive/issue_events_236040.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-07-16T12:46:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236040"
}
```



---

archive/issue_events_236041.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-07-16T12:46:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorial%20designs",
    "label_color": "0000ff",
    "label_name": "c: combinatorial designs",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236041"
}
```



---

archive/issue_events_236042.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-07-16T12:46:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236042"
}
```



---

archive/issue_events_236043.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-07-16T12:46:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236043"
}
```



---

archive/issue_comments_217450.json:
```json
{
    "body": "Branch: **[u/ncohen/16662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16662)**",
    "created_at": "2014-07-16T12:46:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217450",
    "user": "https://github.com/nathanncohen"
}
```

Branch: **[u/ncohen/16662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16662)**



---

archive/issue_events_236044.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-07-16T12:46:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236044"
}
```



---

archive/issue_comments_217451.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/00654fb8dbffe2134dc0b55ead5cea52dadf1654\"><code>00654fb</code></a></td><td><code>trac #16604: new OA for n=112,160,224,514,796</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba6609df5508dd25035203e9e53ce9e4d1ca1ee7\"><code>ba6609d</code></a></td><td><code>trac #16604: OA for n=640, reviewer's remarks and silly mistake</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c218148c1f076c08ad5a448754421e82c78b5509\"><code>c218148</code></a></td><td><code>trac #16604: OA(15,896)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6074f4b7fcfcbb18b60726954adfa78e68716384\"><code>6074f4b</code></a></td><td><code>trac #16604: OA(16,208)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/35cbadc1fe6d60fe52b86ec19a6ad337ddb201d2\"><code>35cbadc</code></a></td><td><code>trac #16604: OA(16,176)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfcc6f5e263fa92bf04424dfabe825314c6b225d\"><code>bfcc6f5</code></a></td><td><code>trac #16604: Now without copy and paste</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/326ece4053b973beef506e427f5bc29846cfa8ed\"><code>326ece4</code></a></td><td><code>trac #16604: OA(20,352)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6212204674050c40fca7a7c41d4f25c6c2c066c\"><code>a621220</code></a></td><td><code>trac #16604: OA(20,416)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/54fc1e1fdf98c8c09142b00d1a905e0f7f2aa6a0\"><code>54fc1e1</code></a></td><td><code>trac #16604: OA(20,544)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e47439f639b269679ee5640d4c497ec73ded499\"><code>6e47439</code></a></td><td><code>trac #16662: OA for n=1046,1059,2164,3992,3994</code></td></tr></table>\n",
    "created_at": "2014-07-16T12:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217451",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/00654fb8dbffe2134dc0b55ead5cea52dadf1654"><code>00654fb</code></a></td><td><code>trac #16604: new OA for n=112,160,224,514,796</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba6609df5508dd25035203e9e53ce9e4d1ca1ee7"><code>ba6609d</code></a></td><td><code>trac #16604: OA for n=640, reviewer's remarks and silly mistake</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c218148c1f076c08ad5a448754421e82c78b5509"><code>c218148</code></a></td><td><code>trac #16604: OA(15,896)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6074f4b7fcfcbb18b60726954adfa78e68716384"><code>6074f4b</code></a></td><td><code>trac #16604: OA(16,208)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/35cbadc1fe6d60fe52b86ec19a6ad337ddb201d2"><code>35cbadc</code></a></td><td><code>trac #16604: OA(16,176)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfcc6f5e263fa92bf04424dfabe825314c6b225d"><code>bfcc6f5</code></a></td><td><code>trac #16604: Now without copy and paste</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/326ece4053b973beef506e427f5bc29846cfa8ed"><code>326ece4</code></a></td><td><code>trac #16604: OA(20,352)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6212204674050c40fca7a7c41d4f25c6c2c066c"><code>a621220</code></a></td><td><code>trac #16604: OA(20,416)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/54fc1e1fdf98c8c09142b00d1a905e0f7f2aa6a0"><code>54fc1e1</code></a></td><td><code>trac #16604: OA(20,544)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e47439f639b269679ee5640d4c497ec73ded499"><code>6e47439</code></a></td><td><code>trac #16662: OA for n=1046,1059,2164,3992,3994</code></td></tr></table>




---

archive/issue_comments_217452.json:
```json
{
    "body": "Commit: **[`6e47439`](https://github.com/sagemath/sagetrac-mirror/commit/6e47439f639b269679ee5640d4c497ec73ded499)**",
    "created_at": "2014-07-16T12:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217452",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`6e47439`](https://github.com/sagemath/sagetrac-mirror/commit/6e47439f639b269679ee5640d4c497ec73ded499)**



---

archive/issue_comments_217453.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0232b73b42b1460f05622dbfc81f8d3f51b9a50b\"><code>0232b73</code></a></td><td><code>trac #16604: OA(20,544)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e5f428d75ade25f0524abbb61c71a67039ed754a\"><code>e5f428d</code></a></td><td><code>trac #16604: Merged with 6.3.beta6</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/355ac2a741154e5fca99ec1d5137c5be0b9d4377\"><code>355ac2a</code></a></td><td><code>trac #16662: OA for n=1046,1059,2164,3992,3994</code></td></tr></table>\n",
    "created_at": "2014-07-26T07:17:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217453",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0232b73b42b1460f05622dbfc81f8d3f51b9a50b"><code>0232b73</code></a></td><td><code>trac #16604: OA(20,544)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e5f428d75ade25f0524abbb61c71a67039ed754a"><code>e5f428d</code></a></td><td><code>trac #16604: Merged with 6.3.beta6</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/355ac2a741154e5fca99ec1d5137c5be0b9d4377"><code>355ac2a</code></a></td><td><code>trac #16662: OA for n=1046,1059,2164,3992,3994</code></td></tr></table>




---

archive/issue_comments_217454.json:
```json
{
    "body": "Changed commit from **[`6e47439`](https://github.com/sagemath/sagetrac-mirror/commit/6e47439f639b269679ee5640d4c497ec73ded499)** to **[`355ac2a`](https://github.com/sagemath/sagetrac-mirror/commit/355ac2a741154e5fca99ec1d5137c5be0b9d4377)**",
    "created_at": "2014-07-26T07:17:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217454",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6e47439`](https://github.com/sagemath/sagetrac-mirror/commit/6e47439f639b269679ee5640d4c497ec73ded499)** to **[`355ac2a`](https://github.com/sagemath/sagetrac-mirror/commit/355ac2a741154e5fca99ec1d5137c5be0b9d4377)**



---

archive/issue_events_236045.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236045"
}
```



---

archive/issue_events_236046.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236046"
}
```



---

archive/issue_events_236047.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-11T10:19:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236047"
}
```



---

archive/issue_events_236048.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-11T10:19:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236048"
}
```



---

archive/issue_comments_217455.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHello\n\n1) I corrected typos in the doc, added a check, added a test, modify few sentences at u/vdelecroix/16662\n\n2) I do not understand why he following is not valid\n\n```\nsage: k=10; n=2; m=79; a=b=c=1\nsage: for kk,nn in ((k,m),(k,m+1),(k,m+2),(k,a),(k,b),(k,c)):\n....:     assert designs.orthogonal_array(k,n,existence=True)\nsage: OA=thwart_lemma_3_5(10,2,79,1,1,1)\nTraceback (most recent call last):\n...\n    913         if existence:\n    914             return Unknown\n--> 915         raise NotImplementedError(\"I don't know how to build an OA({},{})!\".format(k,n))\n    916 \n    917     if check:\n\nNotImplementedError: I don't know how to build an OA(10,69)!\n```\nAre a,b,c allowed to be 1? In the examples of the article a,b,c are never 1 (but d might be).\n\n3) I found two examples which yield to error I do not understand from the specifications. The first one is related to the point 2) I guess\n\n```\nsage: OA=thwart_lemma_3_5(10,2,89,1,1,1)\nTraceback (most recent call last):\n...\n    456     for B in master_design:\n    457         # The missing entries belong to the last n_trunc columns\n--> 458         assert all(x is not None for x in B[:k])\n    459         n_in_truncated = n_trunc-B.count(None)\n    460 \n\nAssertionError: \n```\n\nFor the other one, the existence of an OA(9,21) should not be necessary for the construction\n\n```\nsage: OA = thwart_lemma_3_5(9,9,22,8,8,8,complement=True)\nTraceback (most recent call last):\n...\n    913         if existence:\n    914             return Unknown\n--> 915         raise NotImplementedError(\"I don't know how to build an OA({},{})!\".format(k,n))\n    916 \n    917     if check:\n\nNotImplementedError: I don't know how to build an OA(9,21)!\n```\n\n4) I found several new values for which the thwart construction works. But I first would like to understand first why 3) fail.\n\nVincent",
    "created_at": "2014-08-11T10:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217455",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

Hello

1) I corrected typos in the doc, added a check, added a test, modify few sentences at u/vdelecroix/16662

2) I do not understand why he following is not valid

```
sage: k=10; n=2; m=79; a=b=c=1
sage: for kk,nn in ((k,m),(k,m+1),(k,m+2),(k,a),(k,b),(k,c)):
....:     assert designs.orthogonal_array(k,n,existence=True)
sage: OA=thwart_lemma_3_5(10,2,79,1,1,1)
Traceback (most recent call last):
...
    913         if existence:
    914             return Unknown
--> 915         raise NotImplementedError("I don't know how to build an OA({},{})!".format(k,n))
    916 
    917     if check:

NotImplementedError: I don't know how to build an OA(10,69)!
```
Are a,b,c allowed to be 1? In the examples of the article a,b,c are never 1 (but d might be).

3) I found two examples which yield to error I do not understand from the specifications. The first one is related to the point 2) I guess

```
sage: OA=thwart_lemma_3_5(10,2,89,1,1,1)
Traceback (most recent call last):
...
    456     for B in master_design:
    457         # The missing entries belong to the last n_trunc columns
--> 458         assert all(x is not None for x in B[:k])
    459         n_in_truncated = n_trunc-B.count(None)
    460 

AssertionError: 
```

For the other one, the existence of an OA(9,21) should not be necessary for the construction

```
sage: OA = thwart_lemma_3_5(9,9,22,8,8,8,complement=True)
Traceback (most recent call last):
...
    913         if existence:
    914             return Unknown
--> 915         raise NotImplementedError("I don't know how to build an OA({},{})!".format(k,n))
    916 
    917     if check:

NotImplementedError: I don't know how to build an OA(9,21)!
```

4) I found several new values for which the thwart construction works. But I first would like to understand first why 3) fail.

Vincent



---

archive/issue_comments_217456.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHello !\n\n> 1) I corrected typos in the doc, added a check, added a test, modify few sentences at u/vdelecroix/16662\n\nIs it me or is the git server slow ? It takes MINUTES to download a branch `O_o`\n\n> 2) I do not understand why he following is not valid\n\nHow, not \"valid\" ? The input is valid but in order to build the new designs you need some sub-designs, and among the subdesigns there is a `OA(10,69)` that Sage does not know how to build. Soo well, the construction can't be applied because you need one of the required designs... What's wrong with that ? This is what the `find_` functions usually checks !\n\n> Are a,b,c allowed to be 1? In the examples of the article a,b,c are never 1 (but d might be).\n\nI don't think that there is anything wrong with =1 values.\n\n> 3) I found two examples which yield to error I do not understand from the specifications. The first one is related to the point 2) I guess\n\nNo, it is just that there exists no `OA(13,2)`. The code has to build an `OA(k+3,n)` (or `OA(k+4,n)` when `d` is defined) and it does not exist if k is too large. I missed that one, probably because that's the kind of thing that I filter in the `find_` function usually.\n\n> For the other one, the existence of an OA(9,21) should not be necessary for the construction\n\nThe exception I added for the previous one is also triggered here.\n\n> 4) I found several new values for which the thwart construction works. But I first would like to understand first why 3) fail.\n\nNathann",
    "created_at": "2014-08-11T10:59:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217456",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:6" align="right">comment:6</div>

Hello !

> 1) I corrected typos in the doc, added a check, added a test, modify few sentences at u/vdelecroix/16662

Is it me or is the git server slow ? It takes MINUTES to download a branch `O_o`

> 2) I do not understand why he following is not valid

How, not "valid" ? The input is valid but in order to build the new designs you need some sub-designs, and among the subdesigns there is a `OA(10,69)` that Sage does not know how to build. Soo well, the construction can't be applied because you need one of the required designs... What's wrong with that ? This is what the `find_` functions usually checks !

> Are a,b,c allowed to be 1? In the examples of the article a,b,c are never 1 (but d might be).

I don't think that there is anything wrong with =1 values.

> 3) I found two examples which yield to error I do not understand from the specifications. The first one is related to the point 2) I guess

No, it is just that there exists no `OA(13,2)`. The code has to build an `OA(k+3,n)` (or `OA(k+4,n)` when `d` is defined) and it does not exist if k is too large. I missed that one, probably because that's the kind of thing that I filter in the `find_` function usually.

> For the other one, the existence of an OA(9,21) should not be necessary for the construction

The exception I added for the previous one is also triggered here.

> 4) I found several new values for which the thwart construction works. But I first would like to understand first why 3) fail.

Nathann



---

archive/issue_comments_217457.json:
```json
{
    "body": "Changed commit from **[`355ac2a`](https://github.com/sagemath/sagetrac-mirror/commit/355ac2a741154e5fca99ec1d5137c5be0b9d4377)** to **[`8fcaed0`](https://github.com/sagemath/sagetrac-mirror/commit/8fcaed066b7f110af10c6a471cbebcad370bd312)**",
    "created_at": "2014-08-11T11:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217457",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`355ac2a`](https://github.com/sagemath/sagetrac-mirror/commit/355ac2a741154e5fca99ec1d5137c5be0b9d4377)** to **[`8fcaed0`](https://github.com/sagemath/sagetrac-mirror/commit/8fcaed066b7f110af10c6a471cbebcad370bd312)**



---

archive/issue_comments_217458.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/053945db4f9a536337e83837364598308769a206\"><code>053945d</code></a></td><td><code>trac #16662: merge 6.3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/166b5253a4aea402bd37dee3af159f89b02acc23\"><code>166b525</code></a></td><td><code>trac #16662: doc + test</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8fcaed066b7f110af10c6a471cbebcad370bd312\"><code>8fcaed0</code></a></td><td><code>trac #16662: New assertion</code></td></tr></table>\n",
    "created_at": "2014-08-11T11:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217458",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/053945db4f9a536337e83837364598308769a206"><code>053945d</code></a></td><td><code>trac #16662: merge 6.3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/166b5253a4aea402bd37dee3af159f89b02acc23"><code>166b525</code></a></td><td><code>trac #16662: doc + test</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8fcaed066b7f110af10c6a471cbebcad370bd312"><code>8fcaed0</code></a></td><td><code>trac #16662: New assertion</code></td></tr></table>




---

archive/issue_events_236049.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-08-11T11:01:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236049"
}
```



---

archive/issue_events_236050.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-08-11T11:01:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236050"
}
```



---

archive/issue_comments_217459.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHi,\n\nYou add a check at the begining but there is no associated specification in the doc...\n\nVincent",
    "created_at": "2014-08-11T12:04:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217459",
    "user": "https://github.com/videlec"
}
```

<div id="comment:9" align="right">comment:9</div>

Hi,

You add a check at the begining but there is no associated specification in the doc...

Vincent



---

archive/issue_comments_217460.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nVery bad... I was not able to build the potentially new `OA(12,3362)`\n\n```\nsage: OA=thwart_lemma_3_5(12,16,207,13,13,13,11,complement=True)\nTraceback (most recent call last):\n...\n.../incidence_structures.pyc in blocks(self, copy)\n    520             if self._point_to_index is None:\n    521                 from copy import deepcopy\n--> 522                 return deepcopy(self._blocks)\n    523             else:\n    524                 return [[self._points[i] for i in b] for b in self._blocks]\n...\nMemoryError:\n```",
    "created_at": "2014-08-11T12:30:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217460",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">comment:10</div>

Very bad... I was not able to build the potentially new `OA(12,3362)`

```
sage: OA=thwart_lemma_3_5(12,16,207,13,13,13,11,complement=True)
Traceback (most recent call last):
...
.../incidence_structures.pyc in blocks(self, copy)
    520             if self._point_to_index is None:
    521                 from copy import deepcopy
--> 522                 return deepcopy(self._blocks)
    523             else:
    524                 return [[self._points[i] for i in b] for b in self._blocks]
...
MemoryError:
```



---

archive/issue_comments_217461.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nWell you can't build a `OA(2<sup>300+1,2</sup>300)` either... `:-P`\n\nThis deepcopy is a crime.\n\nNathann",
    "created_at": "2014-08-11T12:33:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217461",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:11" align="right">comment:11</div>

Well you can't build a `OA(2<sup>300+1,2</sup>300)` either... `:-P`

This deepcopy is a crime.

Nathann



---

archive/issue_comments_217462.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI said that because this one is smaller than the largest you add to the database: an OA(12,3994).\n\nI will create a ticket to remove all deepcopy around (and in that case I think it is more like a `toto.blocks(copy=False)` which is needed).\n\nVincent",
    "created_at": "2014-08-11T12:39:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217462",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">comment:12</div>

I said that because this one is smaller than the largest you add to the database: an OA(12,3994).

I will create a ticket to remove all deepcopy around (and in that case I think it is more like a `toto.blocks(copy=False)` which is needed).

Vincent



---

archive/issue_comments_217463.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nYoooooooo !\n\n> I said that because this one is smaller than the largest you add to the database: an OA(12,3994).\n> \n> I will create a ticket to remove all deepcopy around (and in that case I think it is more like a `toto.blocks(copy=False)` which is needed).\n\nPlease don't, I fixed that in at least two `needs_review` tickets already `^^;`\n\nNathann",
    "created_at": "2014-08-11T12:41:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217463",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:13" align="right">comment:13</div>

Yoooooooo !

> I said that because this one is smaller than the largest you add to the database: an OA(12,3994).
> 
> I will create a ticket to remove all deepcopy around (and in that case I think it is more like a `toto.blocks(copy=False)` which is needed).

Please don't, I fixed that in at least two `needs_review` tickets already `^^;`

Nathann



---

archive/issue_comments_217464.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAll right...\n\nI put constructions for OA(10,1048), OA(11,1524) and OA(12,3362) at `u/vdelecroix/16662`. And by the way, I wrote a function which compute the set of new values you get by using this construction... should I add it somewhere? It is not exactly a `find_XXX` function, it go the other way around: play with parameters m,n,a,b,c,d and see if the m*n+a+b+c+d you obtain is already available.\n\nVincent",
    "created_at": "2014-08-11T12:47:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217464",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">comment:14</div>

All right...

I put constructions for OA(10,1048), OA(11,1524) and OA(12,3362) at `u/vdelecroix/16662`. And by the way, I wrote a function which compute the set of new values you get by using this construction... should I add it somewhere? It is not exactly a `find_XXX` function, it go the other way around: play with parameters m,n,a,b,c,d and see if the m*n+a+b+c+d you obtain is already available.

Vincent



---

archive/issue_comments_217465.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nYo !\n\n> I put constructions for OA(10,1048), OA(11,1524) and OA(12,3362) at `u/vdelecroix/16662`. \n\nOh. Are they the only other MOLS that we can build ? If there are more it may be worth writing a find function after all...\n\nNathann",
    "created_at": "2014-08-11T18:08:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217465",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:15" align="right">comment:15</div>

Yo !

> I put constructions for OA(10,1048), OA(11,1524) and OA(12,3362) at `u/vdelecroix/16662`. 

Oh. Are they the only other MOLS that we can build ? If there are more it may be worth writing a find function after all...

Nathann



---

archive/issue_comments_217466.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@nathanncohen](#comment%3A15):\n> Yo !\n> \n> > I put constructions for OA(10,1048), OA(11,1524) and OA(12,3362) at `u/vdelecroix/16662`. \n\n> \n> Oh. Are they the only other MOLS that we can build ? If there are more it may be worth writing a find function after all...\n\nSeems to be the only one. If you want to write this find function that's also an option. But I am not sure you will ever get the `OA(10,1046)` in less than a minute. A possible alternative is to write a function that checks that:\n- those constructions are not useless (i.e. there are no other way to get them)\n- there is nothing more to build with these thwarts (this is pretty much what I wrote)\n\nVincent",
    "created_at": "2014-08-11T19:37:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217466",
    "user": "https://github.com/videlec"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@nathanncohen](#comment%3A15):
> Yo !
> 
> > I put constructions for OA(10,1048), OA(11,1524) and OA(12,3362) at `u/vdelecroix/16662`. 

> 
> Oh. Are they the only other MOLS that we can build ? If there are more it may be worth writing a find function after all...

Seems to be the only one. If you want to write this find function that's also an option. But I am not sure you will ever get the `OA(10,1046)` in less than a minute. A possible alternative is to write a function that checks that:
- those constructions are not useless (i.e. there are no other way to get them)
- there is nothing more to build with these thwarts (this is pretty much what I wrote)

Vincent



---

archive/issue_comments_217467.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nYo !\n\n> Seems to be the only one. If you want to write this find function that's also an option.\n\nI tried several times and it really was complicated. And required a lot of copy/paste.\n\n> But I am not sure you will ever get the `OA(10,1046)` in less than a minute\n\nWell, you need to fill the cache at first, like for all constructions.\n\n> A possible alternative is to write a function that checks that:\n> - those constructions are not useless (i.e. there are no other way to get them)\n\nWhy do you care so much about not having useless constructions ? It is good to have several ways to generate the same design. Some paths may be better than others, some paths may result in designs with different properties...\n\n> - there is nothing more to build with these thwarts (this is pretty much what I wrote)\n\nThe problem with that is that it is true with the current OA that Sage can build. Wait a bit and new one will appear that may change that.\n\nNathann",
    "created_at": "2014-08-11T19:40:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217467",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:17" align="right">comment:17</div>

Yo !

> Seems to be the only one. If you want to write this find function that's also an option.

I tried several times and it really was complicated. And required a lot of copy/paste.

> But I am not sure you will ever get the `OA(10,1046)` in less than a minute

Well, you need to fill the cache at first, like for all constructions.

> A possible alternative is to write a function that checks that:
> - those constructions are not useless (i.e. there are no other way to get them)

Why do you care so much about not having useless constructions ? It is good to have several ways to generate the same design. Some paths may be better than others, some paths may result in designs with different properties...

> - there is nothing more to build with these thwarts (this is pretty much what I wrote)

The problem with that is that it is true with the current OA that Sage can build. Wait a bit and new one will appear that may change that.

Nathann



---

archive/issue_comments_217468.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@nathanncohen](#comment%3A17):\n> Yo !\n> \n> > Seems to be the only one. If you want to write this find function that's also an option.\n\n> \n> I tried several times and it really was complicated. And required a lot of copy/paste.\n\nSo let us not do that.\n\n> > A possible alternative is to write a function that checks that:\n> > - those constructions are not useless (i.e. there are no other way to get them)\n\n> \n> Why do you care so much about not having useless constructions ? It is good to have several ways to generate the same design. Some paths may be better than others, some paths may result in designs with different properties...\n\nAll right. Then there are thousands of thwarts construction that you may want to consider...\n\n> > - there is nothing more to build with these thwarts (this is pretty much what I wrote)\n\n> \n> The problem with that is that it is true with the current OA that Sage can build. Wait a bit and new one will appear that may change that.\n\nThis is cool. If a ticket creates new OA that allows more of this construction, then it will create an error in a doctest and the database will be automatically updated. Nevertheless, filling the cache up to 3000 is too long for a doctest. So I can keep my file under my pillow and run it from time to time.\n\nVincent",
    "created_at": "2014-08-11T19:45:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217468",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@nathanncohen](#comment%3A17):
> Yo !
> 
> > Seems to be the only one. If you want to write this find function that's also an option.

> 
> I tried several times and it really was complicated. And required a lot of copy/paste.

So let us not do that.

> > A possible alternative is to write a function that checks that:
> > - those constructions are not useless (i.e. there are no other way to get them)

> 
> Why do you care so much about not having useless constructions ? It is good to have several ways to generate the same design. Some paths may be better than others, some paths may result in designs with different properties...

All right. Then there are thousands of thwarts construction that you may want to consider...

> > - there is nothing more to build with these thwarts (this is pretty much what I wrote)

> 
> The problem with that is that it is true with the current OA that Sage can build. Wait a bit and new one will appear that may change that.

This is cool. If a ticket creates new OA that allows more of this construction, then it will create an error in a doctest and the database will be automatically updated. Nevertheless, filling the cache up to 3000 is too long for a doctest. So I can keep my file under my pillow and run it from time to time.

Vincent



---

archive/issue_comments_217469.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nYo !\n\n> So let us not do that.\n\nHmmmmmmmmm. I know it will haunt me `:-P`\n\n> All right. Then there are thousands of thwarts construction that you may want to consider...\n\nWell, for the moment I try to fill the table until we stick to the Handbook.\n\n> This is cool. If a ticket creates new OA that allows more of this construction, then it will create an error in a doctest and the database will be automatically updated. Nevertheless, filling the cache up to 3000 is too long for a doctest. So I can keep my file under my pillow and run it from time to time.\n\nUnder a pillow is no place to store code. You can't wash away the stains of a memory leak.\n\nNathann",
    "created_at": "2014-08-11T19:48:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217469",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:19" align="right">comment:19</div>

Yo !

> So let us not do that.

Hmmmmmmmmm. I know it will haunt me `:-P`

> All right. Then there are thousands of thwarts construction that you may want to consider...

Well, for the moment I try to fill the table until we stick to the Handbook.

> This is cool. If a ticket creates new OA that allows more of this construction, then it will create an error in a doctest and the database will be automatically updated. Nevertheless, filling the cache up to 3000 is too long for a doctest. So I can keep my file under my pillow and run it from time to time.

Under a pillow is no place to store code. You can't wash away the stains of a memory leak.

Nathann



---

archive/issue_comments_217470.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nAll right, I wrote the `find_thwart_lemma_3_5`... it works at least for the parameters that were found before. It is at `u/vdelecroix/16662`.\n\nVincent",
    "created_at": "2014-08-12T08:50:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217470",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">comment:20</div>

All right, I wrote the `find_thwart_lemma_3_5`... it works at least for the parameters that were found before. It is at `u/vdelecroix/16662`.

Vincent



---

archive/issue_comments_217471.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nCould you add some comments ? So many loops and tests, even an internal caching system and no comments is a bit tough.\n\nAlso, I don't think you should implement caching systems like that in a `find_` function. If we need such caching (and we do) it should be implemented where it belongs, with a dedicated function.\n\nI had in mind something like that:\n\n```\ndesigns.orthogonal_arrays.build(k,n)\ndesigns.orthogonal_arrays.build_information(k,n)\ndesigns.orthogonal_arrays.is_available(k,n)\ndesigns.orthogonal_arrays.exists(k,n)\ndesigns.orthogonal_arrays.max_k(n)\ndesigns.orthogonal_arrays.all_n(k, min=None, max=None)\n```\n\nThough I like this interface, it means quite some amount of copy/paste in the code. For TD and MOLS. Maybe there is a trick.\n\nNathann",
    "created_at": "2014-08-12T15:46:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217471",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:21" align="right">comment:21</div>

Could you add some comments ? So many loops and tests, even an internal caching system and no comments is a bit tough.

Also, I don't think you should implement caching systems like that in a `find_` function. If we need such caching (and we do) it should be implemented where it belongs, with a dedicated function.

I had in mind something like that:

```
designs.orthogonal_arrays.build(k,n)
designs.orthogonal_arrays.build_information(k,n)
designs.orthogonal_arrays.is_available(k,n)
designs.orthogonal_arrays.exists(k,n)
designs.orthogonal_arrays.max_k(n)
designs.orthogonal_arrays.all_n(k, min=None, max=None)
```

Though I like this interface, it means quite some amount of copy/paste in the code. For TD and MOLS. Maybe there is a trick.

Nathann



---

archive/issue_comments_217472.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nHello,\n\nIt is not only caching. With a more naive approach you would have\n\n```\nfor a in xrange(n):\n    if not orthogonal_arrays(k,a,existence=True):\n        continue\n    for b in xrange(a+1):\n        if not orthogonal_arrays(k,b,existence=True):\n            continue\n        for c in xrange(b+1):\n            if not orthogonal_arrays(k,c,existence=True):\n                continue\n```\n\nAbout your caching system, what would be the difference between `is_available` and `exists`? And instead of `all_n` I would prefer `nrange` or something more pythonic.\n\nI will write some doc but I won't change the code.\n\nVincent",
    "created_at": "2014-08-13T06:48:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217472",
    "user": "https://github.com/videlec"
}
```

<div id="comment:22" align="right">comment:22</div>

Hello,

It is not only caching. With a more naive approach you would have

```
for a in xrange(n):
    if not orthogonal_arrays(k,a,existence=True):
        continue
    for b in xrange(a+1):
        if not orthogonal_arrays(k,b,existence=True):
            continue
        for c in xrange(b+1):
            if not orthogonal_arrays(k,c,existence=True):
                continue
```

About your caching system, what would be the difference between `is_available` and `exists`? And instead of `all_n` I would prefer `nrange` or something more pythonic.

I will write some doc but I won't change the code.

Vincent



---

archive/issue_comments_217473.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nIt is at `u/vdelecroix/16662`.\n\nVincent",
    "created_at": "2014-08-13T07:50:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217473",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">comment:23</div>

It is at `u/vdelecroix/16662`.

Vincent



---

archive/issue_comments_217474.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nYo !\n\n> It is not only caching. With a more naive approach you would have\n\nWhat you do there is the work of the \"all_n\" function I wound like to write. I would like to replace the \n\n```\nfor n in range(N-2):\n    if is_prime(n)\n```\n\nwith \n\n```\nfor n in prime_powers(N-2):\n   ...\n```\n\nBut it is not possible because you use n to build the cache.\n\n> About your caching system, what would be the difference between `is_available` and `exists`? And instead of `all_n` I would prefer `nrange` or something more pythonic.\n\n`is_available` would not trigger non-existence tests. But perhaps that is less useful since your rewrote the `is_sum_of_squares` thing.\n\nNathann",
    "created_at": "2014-08-13T13:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217474",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:24" align="right">comment:24</div>

Yo !

> It is not only caching. With a more naive approach you would have

What you do there is the work of the "all_n" function I wound like to write. I would like to replace the 

```
for n in range(N-2):
    if is_prime(n)
```

with 

```
for n in prime_powers(N-2):
   ...
```

But it is not possible because you use n to build the cache.

> About your caching system, what would be the difference between `is_available` and `exists`? And instead of `all_n` I would prefer `nrange` or something more pythonic.

`is_available` would not trigger non-existence tests. But perhaps that is less useful since your rewrote the `is_sum_of_squares` thing.

Nathann



---

archive/issue_comments_217475.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nWith the find function\n\n```\nsage: %time designs.orthogonal_array(None,1000,existence=1)\nCPU times: user 24.6 s, sys: 52 ms, total: 24.6 s\nWall time: 24.6 s\n9\n```\nWithout\n\n```\nsage: %time designs.orthogonal_array(None,1000,existence=1)\nCPU times: user 14.5 s, sys: 32 ms, total: 14.5 s\nWall time: 14.5 s\n9\n```",
    "created_at": "2014-08-13T14:17:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217475",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:25" align="right">comment:25</div>

With the find function

```
sage: %time designs.orthogonal_array(None,1000,existence=1)
CPU times: user 24.6 s, sys: 52 ms, total: 24.6 s
Wall time: 24.6 s
9
```
Without

```
sage: %time designs.orthogonal_array(None,1000,existence=1)
CPU times: user 14.5 s, sys: 32 ms, total: 14.5 s
Wall time: 14.5 s
9
```



---

archive/issue_comments_217476.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nYo !\n\nIt seems that the list \"good\" is very very often useless. I wanted to know how often it was used and added a \"print n\" right before the loop \"for a in good\"\n\n```diff\n@@ -999,6 +999,7 @@ def find_thwart_lemma_3_5(k,N):\n                     orthogonal_array(k,m+2,existence=True)):\n                 continue\n\n+            print \"A\",n\n             for a in good:\n                 if a > N-n*m:\n                     break\n@@ -1023,7 +1024,7 @@ def find_thwart_lemma_3_5(k,N):\n                     orthogonal_array(k,m+2,existence=True) and\n                     orthogonal_array(k,m+3,existence=True)):\n                 continue\n-\n+            print \"B\",n\n             for a in good:\n                 if a > N-n*m:\n                     break         \n```\n\nGuess how many times they appear when you type `designs.orthogonal_array(None,1000,existence=1)`: never.\n\nWhich means that for 1000 at least computing all `OA(k,n,existence=True)` for n<N is all for naught (but takes 10s).\n\nNathann",
    "created_at": "2014-08-13T14:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217476",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:26" align="right">comment:26</div>

Yo !

It seems that the list "good" is very very often useless. I wanted to know how often it was used and added a "print n" right before the loop "for a in good"

```diff
@@ -999,6 +999,7 @@ def find_thwart_lemma_3_5(k,N):
                     orthogonal_array(k,m+2,existence=True)):
                 continue

+            print "A",n
             for a in good:
                 if a > N-n*m:
                     break
@@ -1023,7 +1024,7 @@ def find_thwart_lemma_3_5(k,N):
                     orthogonal_array(k,m+2,existence=True) and
                     orthogonal_array(k,m+3,existence=True)):
                 continue
-
+            print "B",n
             for a in good:
                 if a > N-n*m:
                     break         
```

Guess how many times they appear when you type `designs.orthogonal_array(None,1000,existence=1)`: never.

Which means that for 1000 at least computing all `OA(k,n,existence=True)` for n<N is all for naught (but takes 10s).

Nathann



---

archive/issue_comments_217477.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nBy the way, shouldn't `range(N-3)` be `range(N-2)` ? The last element is not included in the list, so m=a=b=c=1 is not tested.\n\nNathann",
    "created_at": "2014-08-13T14:48:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217477",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:27" align="right">comment:27</div>

By the way, shouldn't `range(N-3)` be `range(N-2)` ? The last element is not included in the list, so m=a=b=c=1 is not tested.

Nathann



---

archive/issue_comments_217478.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nHello,\n\nMoving the `good` part would change nothing to the timings. You already have the following for the `m` loop which is the cost of everything\n\n```\n            if not (orthogonal_array(k,m+0,existence=True) and\n                    orthogonal_array(k,m+1,existence=True) and\n                    orthogonal_array(k,m+2,existence=True)):\n                continue\n```\nIf you feel like this function is too costly, we can remove it from the `find_recursive_constructions` and just store the interesting values:\n\n```\nif (k,n) not in  ((10,1046), (10,1048), (10,1059), (11,1524),\n                  (11,2164), (12,3362), (12,3992),  (12,3994)):\n    return False\n```\n\nAbout your question, you were right and we can even go up to `n=N-1`.\n\nTell me what you think about the first question and I will add a commit.\n\nVincent",
    "created_at": "2014-08-13T15:42:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217478",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">comment:28</div>

Hello,

Moving the `good` part would change nothing to the timings. You already have the following for the `m` loop which is the cost of everything

```
            if not (orthogonal_array(k,m+0,existence=True) and
                    orthogonal_array(k,m+1,existence=True) and
                    orthogonal_array(k,m+2,existence=True)):
                continue
```
If you feel like this function is too costly, we can remove it from the `find_recursive_constructions` and just store the interesting values:

```
if (k,n) not in  ((10,1046), (10,1048), (10,1059), (11,1524),
                  (11,2164), (12,3362), (12,3992),  (12,3994)):
    return False
```

About your question, you were right and we can even go up to `n=N-1`.

Tell me what you think about the first question and I will add a commit.

Vincent



---

archive/issue_comments_217479.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nCommit a `u/vdelecroix/16662`.\n\n- I removed the good\n- I cut the loop as much as possible\n\nVincent",
    "created_at": "2014-08-14T18:41:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217479",
    "user": "https://github.com/videlec"
}
```

<div id="comment:29" align="right">comment:29</div>

Commit a `u/vdelecroix/16662`.

- I removed the good
- I cut the loop as much as possible

Vincent



---

archive/issue_comments_217480.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nHelloooooooo Vincent !\n\nOkay... So let's do that:\n\n1) You saved some time since the first version, and although it is still slower than needed it's not that awful that we should keep this construction out of those that are automatically tested\n\n2) Those triple loops are really awful things, so we will have to do something about it\n\n3) I am thinking of a data structure that would be useful to us, and whose purpose is to store things like \"all n such that there exists a OA(k,n)\" or even \"all m such that there exists a OA(k,m), OA(k,m+1), OA(k,m+2)\".\n\nWhat it stores: a set of integers defined by a boolean function\nWhat it is meant to answer: give the list of integers between x and y such that the boolean function is satisfied.\n\nOf course we want to minimize the number of boolean function queries. Even though it takes spaces, I am thinking of something like that:\n\nAn array which associates to (any) integer n:\n\na) if f(n) is computed: the smallest integer n'>=n such that f(n') is True or has not been computed yet.\n\nb) if f(n) is not computed yet: None\n\nThis way, if you want to get all solutions to `f(n) is True` between x and y, here is what you do:\n\n```\ncurrent=x\nwhile current<=y:\n    if array[current] is None:\n        array[current] = f(current)\n    elif array[current] == current:\n        yield current\n        current+=1\n    else:\n        new_current = array[current]\n        # if array[a]==b and array[b]==c then let's define array[a]=c\n        if array[new_current] is not None: \n            array[current] = array[new_current]\n        current = new_current\n```\n\nThis may be cool if we ever implement the `all_n` or `range_n` function.\n\nAnd we could use it in conjunction with a real function to solve the partition problem, i.e. \"try to find integers from a set S whose sum is equal or lequal to C\".\n\nAnyway.\n\n1) I merged all your commits into one, as some were undoing the previous ones\n\n2) I added a small commit on top of it. In particular some additional constraint on k that removes fake '+' in the n<100 area `:-D`\n\nYour code is good otherwise.\n\nNathann",
    "created_at": "2014-08-14T21:30:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217480",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:30" align="right">comment:30</div>

Helloooooooo Vincent !

Okay... So let's do that:

1) You saved some time since the first version, and although it is still slower than needed it's not that awful that we should keep this construction out of those that are automatically tested

2) Those triple loops are really awful things, so we will have to do something about it

3) I am thinking of a data structure that would be useful to us, and whose purpose is to store things like "all n such that there exists a OA(k,n)" or even "all m such that there exists a OA(k,m), OA(k,m+1), OA(k,m+2)".

What it stores: a set of integers defined by a boolean function
What it is meant to answer: give the list of integers between x and y such that the boolean function is satisfied.

Of course we want to minimize the number of boolean function queries. Even though it takes spaces, I am thinking of something like that:

An array which associates to (any) integer n:

a) if f(n) is computed: the smallest integer n'>=n such that f(n') is True or has not been computed yet.

b) if f(n) is not computed yet: None

This way, if you want to get all solutions to `f(n) is True` between x and y, here is what you do:

```
current=x
while current<=y:
    if array[current] is None:
        array[current] = f(current)
    elif array[current] == current:
        yield current
        current+=1
    else:
        new_current = array[current]
        # if array[a]==b and array[b]==c then let's define array[a]=c
        if array[new_current] is not None: 
            array[current] = array[new_current]
        current = new_current
```

This may be cool if we ever implement the `all_n` or `range_n` function.

And we could use it in conjunction with a real function to solve the partition problem, i.e. "try to find integers from a set S whose sum is equal or lequal to C".

Anyway.

1) I merged all your commits into one, as some were undoing the previous ones

2) I added a small commit on top of it. In particular some additional constraint on k that removes fake '+' in the n<100 area `:-D`

Your code is good otherwise.

Nathann



---

archive/issue_comments_217481.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adf5105279da55b5178a1d0692674fdf6984c6b0\"><code>adf5105</code></a></td><td><code>trac #16662: find_thwart_lemma_3_5</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2f936c57507cbd475f860a76b94ed44882d7de7b\"><code>2f936c5</code></a></td><td><code>trac #16662: Review</code></td></tr></table>\n",
    "created_at": "2014-08-14T21:33:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217481",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adf5105279da55b5178a1d0692674fdf6984c6b0"><code>adf5105</code></a></td><td><code>trac #16662: find_thwart_lemma_3_5</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2f936c57507cbd475f860a76b94ed44882d7de7b"><code>2f936c5</code></a></td><td><code>trac #16662: Review</code></td></tr></table>




---

archive/issue_comments_217482.json:
```json
{
    "body": "Changed commit from **[`8fcaed0`](https://github.com/sagemath/sagetrac-mirror/commit/8fcaed066b7f110af10c6a471cbebcad370bd312)** to **[`2f936c5`](https://github.com/sagemath/sagetrac-mirror/commit/2f936c57507cbd475f860a76b94ed44882d7de7b)**",
    "created_at": "2014-08-14T21:33:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217482",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8fcaed0`](https://github.com/sagemath/sagetrac-mirror/commit/8fcaed066b7f110af10c6a471cbebcad370bd312)** to **[`2f936c5`](https://github.com/sagemath/sagetrac-mirror/commit/2f936c57507cbd475f860a76b94ed44882d7de7b)**



---

archive/issue_events_236051.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-15T08:47:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236051"
}
```



---

archive/issue_events_236052.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-15T08:47:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236052"
}
```



---

archive/issue_comments_217483.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nHello,\n\nReplying to [@nathanncohen](#comment%3A30): \n\n> 3) I am thinking of a data structure that would be useful to us, and whose purpose is to store things like \"all n such that there exists a OA(k,n)\" or even \"all m such that there exists a OA(k,m), OA(k,m+1), OA(k,m+2)\".\n\n+1\n\n> What it stores: a set of integers defined by a boolean function\n> What it is meant to answer: give the list of integers between x and y such that the boolean function is satisfied.\n> \n> Of course we want to minimize the number of boolean function queries. Even though it takes spaces, I am thinking of something like that:\n> \n> An array which associates to (any) integer n:\n> \n> a) if f(n) is computed: the smallest integer n'>=n such that f(n') is True or has not been computed yet.\n> \n> b) if f(n) is not computed yet: None\n\n>\n> [...]\n> \n> This may be cool if we ever implement the `all_n` or `range_n` function.\n\nAnd:\n- what is the next value (like next_prime)\n- what is the previous value (like previous_prime)\n\nThe problem with your approach is that you store a lot of data. It is perhaps not as bad as what I imagine.\n\nQuestions:\n\n1) why do you stop `n` at `N-3` in the first loop? I think that `n=N-1, m=1, a=1, b=0, c=0` is a valid input:\n\n```\nsage: OA = thwart_lemma_3_5(3,13,1,1,0,0)\nsage: is_orthogonal_array(OA,3,14,2)\nTrue\n```\nSo the bound should be `N-1`. Perhaps the particular case of `m=1` is taken care by another construction, in that case, this must be documented (and the upper bound for n updated accordingly).\n\n2) the check `d <= n` is not necessary because of the lower bound on `c`.\n\nI edit my commit at `u/vdelecroix/16662` to simplify the code with respect to 2). As soon as 1) is solve, I would be happy to set this to positive review.\n\nVincent",
    "created_at": "2014-08-15T08:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217483",
    "user": "https://github.com/videlec"
}
```

<div id="comment:32" align="right">comment:32</div>

Hello,

Replying to [@nathanncohen](#comment%3A30): 

> 3) I am thinking of a data structure that would be useful to us, and whose purpose is to store things like "all n such that there exists a OA(k,n)" or even "all m such that there exists a OA(k,m), OA(k,m+1), OA(k,m+2)".

+1

> What it stores: a set of integers defined by a boolean function
> What it is meant to answer: give the list of integers between x and y such that the boolean function is satisfied.
> 
> Of course we want to minimize the number of boolean function queries. Even though it takes spaces, I am thinking of something like that:
> 
> An array which associates to (any) integer n:
> 
> a) if f(n) is computed: the smallest integer n'>=n such that f(n') is True or has not been computed yet.
> 
> b) if f(n) is not computed yet: None

>
> [...]
> 
> This may be cool if we ever implement the `all_n` or `range_n` function.

And:
- what is the next value (like next_prime)
- what is the previous value (like previous_prime)

The problem with your approach is that you store a lot of data. It is perhaps not as bad as what I imagine.

Questions:

1) why do you stop `n` at `N-3` in the first loop? I think that `n=N-1, m=1, a=1, b=0, c=0` is a valid input:

```
sage: OA = thwart_lemma_3_5(3,13,1,1,0,0)
sage: is_orthogonal_array(OA,3,14,2)
True
```
So the bound should be `N-1`. Perhaps the particular case of `m=1` is taken care by another construction, in that case, this must be documented (and the upper bound for n updated accordingly).

2) the check `d <= n` is not necessary because of the lower bound on `c`.

I edit my commit at `u/vdelecroix/16662` to simplify the code with respect to 2). As soon as 1) is solve, I would be happy to set this to positive review.

Vincent



---

archive/issue_comments_217484.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nYooooooo !\n\n> And:\n> - what is the next value (like next_prime)\n\nThat's easy to do. It would be the result of all_n(min=current_value,max=None).next()\n\n> - what is the previous value (like previous_prime)\n\nThis would be harder, but I'm not sure it is needed either `O_o`\n\n> The problem with your approach is that you store a lot of data. It is perhaps not as bad as what I imagine.\n\nit bothered me at first but we are thinking of k lists (and k<50 usually) or size around 2000 at most. How bad can that be ? If it were stored in C it would represent 500ko `:-P`\n\n> 1) why do you stop `n` at `N-3` in the first loop? I think that `n=N-1, m=1, a=1, b=0, c=0` is a valid input:\n\nArgg... Because I thought we could assume `a,c,b>0`, I did some changes then removed them, but I forgot one. If d=0 and c=0 I think that what the code does is roughly equivalent to Wilson's construction wth 2 truncated columns. But well, you are right, I will undo that !\n\n> 2) the check `d <= n` is not necessary because of the lower bound on `c`.\n> \n> I edit my commit at `u/vdelecroix/16662` to simplify the code with respect to 2). As soon as 1) is solve, I would be happy to set this to positive review.\n\nI just downloaded your branch but did not see anything new. I just merged it with the beta0 but I will add a commit in a second !\n\nNathann",
    "created_at": "2014-08-15T10:18:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217484",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:33" align="right">comment:33</div>

Yooooooo !

> And:
> - what is the next value (like next_prime)

That's easy to do. It would be the result of all_n(min=current_value,max=None).next()

> - what is the previous value (like previous_prime)

This would be harder, but I'm not sure it is needed either `O_o`

> The problem with your approach is that you store a lot of data. It is perhaps not as bad as what I imagine.

it bothered me at first but we are thinking of k lists (and k<50 usually) or size around 2000 at most. How bad can that be ? If it were stored in C it would represent 500ko `:-P`

> 1) why do you stop `n` at `N-3` in the first loop? I think that `n=N-1, m=1, a=1, b=0, c=0` is a valid input:

Argg... Because I thought we could assume `a,c,b>0`, I did some changes then removed them, but I forgot one. If d=0 and c=0 I think that what the code does is roughly equivalent to Wilson's construction wth 2 truncated columns. But well, you are right, I will undo that !

> 2) the check `d <= n` is not necessary because of the lower bound on `c`.
> 
> I edit my commit at `u/vdelecroix/16662` to simplify the code with respect to 2). As soon as 1) is solve, I would be happy to set this to positive review.

I just downloaded your branch but did not see anything new. I just merged it with the beta0 but I will add a commit in a second !

Nathann



---

archive/issue_comments_217485.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@nathanncohen](#comment%3A33):\n> > 2) the check `d <= n` is not necessary because of the lower bound on `c`.\n> > \n> > I edit my commit at `u/vdelecroix/16662` to simplify the code with respect to 2). As soon as 1) is solve, I would be happy to set this to positive review.\n\n> \n> I just downloaded your branch but did not see anything new. I just merged it with the beta0 but I will add a commit in a second !\n\nI edited my commit. I did not add a commit. My last commit in my branch is 68a2d99 and not 2f936c5.\n\nVincent",
    "created_at": "2014-08-15T12:54:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217485",
    "user": "https://github.com/videlec"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@nathanncohen](#comment%3A33):
> > 2) the check `d <= n` is not necessary because of the lower bound on `c`.
> > 
> > I edit my commit at `u/vdelecroix/16662` to simplify the code with respect to 2). As soon as 1) is solve, I would be happy to set this to positive review.

> 
> I just downloaded your branch but did not see anything new. I just merged it with the beta0 but I will add a commit in a second !

I edited my commit. I did not add a commit. My last commit in my branch is 68a2d99 and not 2f936c5.

Vincent



---

archive/issue_comments_217486.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nYo !\n\n> I edited my commit. I did not add a commit. My last commit in my branch is 68a2d99 and not 2f936c5.\n\nOh, I see. I think that this N-2 is correct after all, however. If n=N-2, then it means that there are at most two points in the last 4 columns, i.e. that at most two columns are used. And because all pairs of points are equivalent, this is already handled by the wilson construction with two truncated columns.\n\nI had written some code which I hoped would improve the performances of this function, but well... It produced no difference whatsoever. And I don't know why yet, so let's get this in.\n\nPerhaps the cached \"all_n\" function will change something `:-/`\n\nNathann",
    "created_at": "2014-08-15T14:03:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217486",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:35" align="right">comment:35</div>

Yo !

> I edited my commit. I did not add a commit. My last commit in my branch is 68a2d99 and not 2f936c5.

Oh, I see. I think that this N-2 is correct after all, however. If n=N-2, then it means that there are at most two points in the last 4 columns, i.e. that at most two columns are used. And because all pairs of points are equivalent, this is already handled by the wilson construction with two truncated columns.

I had written some code which I hoped would improve the performances of this function, but well... It produced no difference whatsoever. And I don't know why yet, so let's get this in.

Perhaps the cached "all_n" function will change something `:-/`

Nathann



---

archive/issue_comments_217487.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@nathanncohen](#comment%3A35):\n> Yo !\n> \n> > I edited my commit. I did not add a commit. My last commit in my branch is 68a2d99 and not 2f936c5.\n\n> \n> Oh, I see. I think that this N-2 is correct after all, however. If n=N-2, then it means that there are at most two points in the last 4 columns, i.e. that at most two columns are used. And because all pairs of points are equivalent, this is already handled by the wilson construction with two truncated columns.\n\nI believe it but please write it in a comment!\n\n> I had written some code which I hoped would improve the performances of this function, but well... It produced no difference whatsoever. And I don't know why yet, so let's get this in.\n> \n> Perhaps the cached \"all_n\" function will change something `:-/`\n\n \nI hope it will.\n\nVincent",
    "created_at": "2014-08-15T16:39:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217487",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@nathanncohen](#comment%3A35):
> Yo !
> 
> > I edited my commit. I did not add a commit. My last commit in my branch is 68a2d99 and not 2f936c5.

> 
> Oh, I see. I think that this N-2 is correct after all, however. If n=N-2, then it means that there are at most two points in the last 4 columns, i.e. that at most two columns are used. And because all pairs of points are equivalent, this is already handled by the wilson construction with two truncated columns.

I believe it but please write it in a comment!

> I had written some code which I hoped would improve the performances of this function, but well... It produced no difference whatsoever. And I don't know why yet, so let's get this in.
> 
> Perhaps the cached "all_n" function will change something `:-/`

 
I hope it will.

Vincent



---

archive/issue_comments_217488.json:
```json
{
    "body": "Changed commit from **[`2f936c5`](https://github.com/sagemath/sagetrac-mirror/commit/2f936c57507cbd475f860a76b94ed44882d7de7b)** to **[`a9b594f`](https://github.com/sagemath/sagetrac-mirror/commit/a9b594f3991f67cf7d2c82a91d8c332c47c35ba7)**",
    "created_at": "2014-08-15T17:36:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217488",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2f936c5`](https://github.com/sagemath/sagetrac-mirror/commit/2f936c57507cbd475f860a76b94ed44882d7de7b)** to **[`a9b594f`](https://github.com/sagemath/sagetrac-mirror/commit/a9b594f3991f67cf7d2c82a91d8c332c47c35ba7)**



---

archive/issue_comments_217489.json:
```json
{
    "body": "<div id=\"comment:37\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2a64fa25c95997f68ae816a2fd9e1062f3cf8e60\"><code>2a64fa2</code></a></td><td><code>trac #16662: find_thwart_lemma_3_5</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68a2d9926ea5c94e2d792b51695ff92daea578e5\"><code>68a2d99</code></a></td><td><code>trac #16662: Review</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7e0480e40d558018c14f3f8eb3c5cb0591a036ea\"><code>7e0480e</code></a></td><td><code>trac #16662: Merged with 6.4.beta0</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a9b594f3991f67cf7d2c82a91d8c332c47c35ba7\"><code>a9b594f</code></a></td><td><code>trac #16662: A comment about n<N-2</code></td></tr></table>\n",
    "created_at": "2014-08-15T17:36:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217489",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:37"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2a64fa25c95997f68ae816a2fd9e1062f3cf8e60"><code>2a64fa2</code></a></td><td><code>trac #16662: find_thwart_lemma_3_5</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68a2d9926ea5c94e2d792b51695ff92daea578e5"><code>68a2d99</code></a></td><td><code>trac #16662: Review</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7e0480e40d558018c14f3f8eb3c5cb0591a036ea"><code>7e0480e</code></a></td><td><code>trac #16662: Merged with 6.4.beta0</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a9b594f3991f67cf7d2c82a91d8c332c47c35ba7"><code>a9b594f</code></a></td><td><code>trac #16662: A comment about n<N-2</code></td></tr></table>




---

archive/issue_events_236053.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-16T06:17:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236053"
}
```



---

archive/issue_events_236054.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-16T06:17:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236054"
}
```



---

archive/issue_comments_217490.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nGreat great... and of lot of rebase for the follow-up tickets!\n\nVincent",
    "created_at": "2014-08-16T06:17:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217490",
    "user": "https://github.com/videlec"
}
```

<div id="comment:38" align="right">comment:38</div>

Great great... and of lot of rebase for the follow-up tickets!

Vincent



---

archive/issue_comments_217491.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThanks !\n\nNathann",
    "created_at": "2014-08-16T06:24:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217491",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:39" align="right">comment:39</div>

Thanks !

Nathann



---

archive/issue_events_236055.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-16T06:49:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236055"
}
```



---

archive/issue_events_236056.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2014-08-16T06:49:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236056"
}
```



---

archive/issue_comments_217492.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThere is a (simple) conflict with #16604.\n\nVincent",
    "created_at": "2014-08-16T06:49:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217492",
    "user": "https://github.com/videlec"
}
```

<div id="comment:40" align="right">comment:40</div>

There is a (simple) conflict with #16604.

Vincent



---

archive/issue_comments_217493.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nsee at `u/vdelecroix/16662`.\n\nVincent",
    "created_at": "2014-08-16T06:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217493",
    "user": "https://github.com/videlec"
}
```

<div id="comment:41" align="right">comment:41</div>

see at `u/vdelecroix/16662`.

Vincent



---

archive/issue_comments_217494.json:
```json
{
    "body": "Changed commit from **[`a9b594f`](https://github.com/sagemath/sagetrac-mirror/commit/a9b594f3991f67cf7d2c82a91d8c332c47c35ba7)** to **[`7a73e74`](https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45)**",
    "created_at": "2014-08-16T07:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217494",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a9b594f`](https://github.com/sagemath/sagetrac-mirror/commit/a9b594f3991f67cf7d2c82a91d8c332c47c35ba7)** to **[`7a73e74`](https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45)**



---

archive/issue_comments_217495.json:
```json
{
    "body": "<div id=\"comment:42\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3cf39835a05cafffa1406c0ace944f9f4b7e3042\"><code>3cf3983</code></a></td><td><code>trac #16604: Reviewing the review</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d612056869f25d94835570fca45572bfd2f5ccc8\"><code>d612056</code></a></td><td><code>trac #16604: on the doc again</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bff470ee5b4bb561cae7f01cf08ed7dfe126fa94\"><code>bff470e</code></a></td><td><code>trac #16604: small check of dimensions</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c21904f748561cea56fe47d1c45a8e3d222d7a1\"><code>6c21904</code></a></td><td><code>trac #16797: correct a row/column inversion</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/48b69020bbb171f4b9d1594b5e686c463c4d92b1\"><code>48b6902</code></a></td><td><code>trac #16604: merge #16797</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/579e75bd1c2a355082d5cf04b7f0ecc95d6c092a\"><code>579e75b</code></a></td><td><code>trac #16604: input check + doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1a83d0b320496df398fb5373ffb0c1cbe1ae590\"><code>e1a83d0</code></a></td><td><code>trac #16604: Optional check flag</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/05c691500eb1131cb71303ed759ddf2cbc13b46f\"><code>05c6915</code></a></td><td><code>trac #16604: Variable rename and list->set</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24c4f7fc4cf619fca8cceb5707b74b935de880c2\"><code>24c4f7f</code></a></td><td><code>trac #16604: Merge with updated #16797</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45\"><code>7a73e74</code></a></td><td><code>trac #16662: Merge with updated #16604</code></td></tr></table>\n",
    "created_at": "2014-08-16T07:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217495",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:42"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3cf39835a05cafffa1406c0ace944f9f4b7e3042"><code>3cf3983</code></a></td><td><code>trac #16604: Reviewing the review</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d612056869f25d94835570fca45572bfd2f5ccc8"><code>d612056</code></a></td><td><code>trac #16604: on the doc again</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bff470ee5b4bb561cae7f01cf08ed7dfe126fa94"><code>bff470e</code></a></td><td><code>trac #16604: small check of dimensions</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c21904f748561cea56fe47d1c45a8e3d222d7a1"><code>6c21904</code></a></td><td><code>trac #16797: correct a row/column inversion</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/48b69020bbb171f4b9d1594b5e686c463c4d92b1"><code>48b6902</code></a></td><td><code>trac #16604: merge #16797</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/579e75bd1c2a355082d5cf04b7f0ecc95d6c092a"><code>579e75b</code></a></td><td><code>trac #16604: input check + doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1a83d0b320496df398fb5373ffb0c1cbe1ae590"><code>e1a83d0</code></a></td><td><code>trac #16604: Optional check flag</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/05c691500eb1131cb71303ed759ddf2cbc13b46f"><code>05c6915</code></a></td><td><code>trac #16604: Variable rename and list->set</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24c4f7fc4cf619fca8cceb5707b74b935de880c2"><code>24c4f7f</code></a></td><td><code>trac #16604: Merge with updated #16797</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45"><code>7a73e74</code></a></td><td><code>trac #16662: Merge with updated #16604</code></td></tr></table>




---

archive/issue_events_236057.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-08-16T07:04:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236057"
}
```



---

archive/issue_events_236058.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2014-08-16T07:04:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236058"
}
```



---

archive/issue_comments_217496.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix**",
    "created_at": "2014-08-16T07:05:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217496",
    "user": "https://github.com/videlec"
}
```

Reviewer: **Vincent Delecroix**



---

archive/issue_comments_217497.json:
```json
{
    "body": "Changed branch from **[u/ncohen/16662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16662)** to **[`7a73e74`](https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45)**",
    "created_at": "2014-08-16T09:32:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/16662#issuecomment-217497",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/ncohen/16662](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/16662)** to **[`7a73e74`](https://github.com/sagemath/sagetrac-mirror/commit/7a73e74549a080ac7ac139241521a871d667cd45)**



---

archive/issue_events_236059.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-16T09:32:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236059"
}
```



---

archive/issue_events_236060.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "4fc59288f8733e164f6a16181cf5d39dbda124b1",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-08-16T09:32:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/16662",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/16662#event-236060"
}
```
