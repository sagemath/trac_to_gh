# Issue 16834: Change ring fails for affine morphisms.

archive/issues_016597.json:
```json
{
    "body": "When calling the change ring function on affine morphisms an index out of bounds error occurs:\n\n```\n\n sage: A.<x,y,z> = AffineSpace(RR,3)\n sage: h = Hom(A,A)\n sage: f = h([x^2+1.5,y^3,z^5-2.0])\n sage: f.change_ring(CC)\n\n```\n\n\n\nAssignee: gjorgenson\n\nCC:  @bhutz\n\nBranch/Commit: 4b8492632a6064f3396c7a49815b1bffa161ded0\n\nReviewer: Ben Hutz\n\nAuthor: Grayson Jorgenson\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/16834\n\n",
    "closed_at": "2014-08-21T09:09:14Z",
    "created_at": "2014-08-15T18:01:08Z",
    "labels": [
        "component: algebraic geometry",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Change ring fails for affine morphisms.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16834",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```
When calling the change ring function on affine morphisms an index out of bounds error occurs:

```

 sage: A.<x,y,z> = AffineSpace(RR,3)
 sage: h = Hom(A,A)
 sage: f = h([x^2+1.5,y^3,z^5-2.0])
 sage: f.change_ring(CC)

```



Assignee: gjorgenson

CC:  @bhutz

Branch/Commit: 4b8492632a6064f3396c7a49815b1bffa161ded0

Reviewer: Ben Hutz

Author: Grayson Jorgenson

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/16834





---

archive/issue_comments_232907.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2014-08-17T18:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232907",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_232908.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-17T18:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232908",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_232909.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,15 @@\n-When calling the change ring function on affine morphisms an error occurs.\n+When calling the change ring function on affine morphisms an index out of bounds error occurs:\n \n ```\n \n-A.<x> = AffineSpace(QQ,1)\n-h = Hom(A,A)\n-f = h([1])\n-f.change_ring(ZZ)\n+sage: A.<x> = AffineSpace(QQ,1)\n+sage: h = Hom(A,A)\n+sage: f = h([1])\n+sage: f.change_ring(ZZ)\n \n ```\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2014-08-17T18:04:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232909",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,15 @@
-When calling the change ring function on affine morphisms an error occurs.
+When calling the change ring function on affine morphisms an index out of bounds error occurs:
 
 ```
 
-A.<x> = AffineSpace(QQ,1)
-h = Hom(A,A)
-f = h([1])
-f.change_ring(ZZ)
+sage: A.<x> = AffineSpace(QQ,1)
+sage: h = Hom(A,A)
+sage: f = h([1])
+sage: f.change_ring(ZZ)
 
 ```
+
+
 
 Comment: 1
 
``````




---

archive/issue_comments_232910.json:
```json
{
    "body": "<a id='comment:3'></a>I'd like to see the example a little more complex. Say at least dimension 2 with non-constant polynomials.\n\nFor the code itself you can get rid of the helper list F with the following\n\n```\nG=[F.change_ring(R) for F in self._polys]\n```\n\nAnother thought. What happens when the domain and codomain are different? This code is assuming that the domain and codomain are the same.",
    "created_at": "2014-08-18T00:30:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232910",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:3'></a>I'd like to see the example a little more complex. Say at least dimension 2 with non-constant polynomials.

For the code itself you can get rid of the helper list F with the following

```
G=[F.change_ring(R) for F in self._polys]
```

Another thought. What happens when the domain and codomain are different? This code is assuming that the domain and codomain are the same.



---

archive/issue_comments_232911.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-18T00:30:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232911",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_232912.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-18T19:37:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232912",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232913.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-18T19:39:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232913",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232914.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,14 @@\n+When calling the change ring function on affine morphisms an index out of bounds error occurs:\n+\n+```\n+\n+ sage: A.<x,y,z> = AffineSpace(RR,3)\n+ sage: h = Hom(A,A)\n+ sage: f = h([x^2+1.5,y^3,z^5-2.0])\n+ sage: f.change_ring(CC)\n+\n+```\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2014-08-18T19:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232914",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,14 @@
+When calling the change ring function on affine morphisms an index out of bounds error occurs:
+
+```
+
+ sage: A.<x,y,z> = AffineSpace(RR,3)
+ sage: h = Hom(A,A)
+ sage: f = h([x^2+1.5,y^3,z^5-2.0])
+ sage: f.change_ring(CC)
+
+```
+
 
 
 Comment: 1
``````




---

archive/issue_comments_232915.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-18T22:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232915",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_232916.json:
```json
{
    "body": "<a id='comment:8'></a>I think the endomorphism check needs some work, since we really want `is` instead of `==`.  Here is a suggestion to simplify things:\n\n```\nT=self.domain().change_ring(R)\nif self.is_endomorphism():\n    H=End(T)\nelse:\n    H=Hom(T,self.codomain().change_ring(R))\n```",
    "created_at": "2014-08-18T22:20:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232916",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'></a>I think the endomorphism check needs some work, since we really want `is` instead of `==`.  Here is a suggestion to simplify things:

```
T=self.domain().change_ring(R)
if self.is_endomorphism():
    H=End(T)
else:
    H=Hom(T,self.codomain().change_ring(R))
```



---

archive/issue_comments_232917.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-19T01:58:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232917",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232918.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-19T02:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232918",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232919.json:
```json
{
    "body": "<a id='comment:10'></a>Is the use of `is_endomorphism()` more sound than using `==` for the comparison of the domain and codomain?",
    "created_at": "2014-08-19T02:00:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232919",
    "user": "https://trac.sagemath.org/admin/accounts/users/gjorgenson"
}
```

<a id='comment:10'></a>Is the use of `is_endomorphism()` more sound than using `==` for the comparison of the domain and codomain?



---

archive/issue_comments_232920.json:
```json
{
    "body": "<a id='comment:11'></a>I think it is faster, since you don't have to access and change_ring the codomain unless you really need it and it makes the code easily human readable.\n\nThe functionality looks fine at this point, but while you're fixing this function, there are a couple other things to fix\n\n1) there are many instances of trailing white space that need to be removed\n\n2) fix the formatting for the earlier examples for this function\n\n3) the output doesn't seem like an accurate description. Perhaps something more like in the description: a :class:`SchemeMorphism_polynomial` which is `self` coerced to `R`",
    "created_at": "2014-08-19T16:34:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232920",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:11'></a>I think it is faster, since you don't have to access and change_ring the codomain unless you really need it and it makes the code easily human readable.

The functionality looks fine at this point, but while you're fixing this function, there are a couple other things to fix

1) there are many instances of trailing white space that need to be removed

2) fix the formatting for the earlier examples for this function

3) the output doesn't seem like an accurate description. Perhaps something more like in the description: a :class:`SchemeMorphism_polynomial` which is `self` coerced to `R`



---

archive/issue_comments_232921.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-20T16:53:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232921",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232922.json:
```json
{
    "body": "<a id='comment:14'></a>Just removed some extra/trailing white space. This looks good.\n\n---\nNew commits:",
    "created_at": "2014-08-20T19:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232922",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:14'></a>Just removed some extra/trailing white space. This looks good.

---
New commits:



---

archive/issue_comments_232923.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-08-20T19:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232923",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_232924.json:
```json
{
    "body": "<a id='comment:15'></a>Author name",
    "created_at": "2014-08-20T20:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232924",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>Author name



---

archive/issue_comments_232925.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2014-08-20T20:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232925",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_232926.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2014-08-20T20:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232926",
    "user": "https://github.com/bhutz"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_232927.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-08-21T09:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16834#issuecomment-232927",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_049281.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-08-21T09:09:14Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16834",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16834#event-49281"
}
```
