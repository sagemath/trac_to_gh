# Issue 18720: ehrhart_polynomial should be made available for polytopes defined over QQ

archive/issues_018720.json:
```json
{
    "body": "CC:  @jplab @sophiasage\n\nKeywords: latte, days100\n\n... because they can happen to be lattice polytopes. An exception should be raised when they are not.\n\nSee http://trac.sagemath.org/ticket/18812#comment:33\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/18957\n\n",
    "closed_at": "2019-10-20T22:16:54Z",
    "created_at": "2015-07-27T17:27:37Z",
    "labels": [
        "component: geometry",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "ehrhart_polynomial should be made available for polytopes defined over QQ",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18720",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @jplab @sophiasage

Keywords: latte, days100

... because they can happen to be lattice polytopes. An exception should be raised when they are not.

See http://trac.sagemath.org/ticket/18812#comment:33



Issue created by migration from https://trac.sagemath.org/ticket/18957





---

archive/issue_comments_255176.json:
```json
{
    "body": "This should also be done through the backend `normaliz` with the version coming after 3.5.3. The call to get the `ehrhart_polynomial` in normaliz will be facilitated and would be nice to have too.\n\nThe upgrade to normaliz 3.5.3 is here: #22984.",
    "created_at": "2018-04-12T14:32:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255176",
    "user": "https://github.com/jplab"
}
```

This should also be done through the backend `normaliz` with the version coming after 3.5.3. The call to get the `ehrhart_polynomial` in normaliz will be facilitated and would be nice to have too.

The upgrade to normaliz 3.5.3 is here: #22984.



---

archive/issue_comments_255177.json:
```json
{
    "body": "Normaliz and PyNormaliz have the computation goal EhrhartQuasipolynomial since Normaliz version 3.6.0.",
    "created_at": "2018-07-05T09:23:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255177",
    "user": "https://trac.sagemath.org/admin/accounts/users/Winfried"
}
```

Normaliz and PyNormaliz have the computation goal EhrhartQuasipolynomial since Normaliz version 3.6.0.



---

archive/issue_comments_255178.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-07-23T16:08:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255178",
    "user": "https://github.com/sophiasage"
}
```

New commits:



---

archive/issue_comments_255179.json:
```json
{
    "body": "Changing keywords from \"latte\" to \"latte, days100\".",
    "created_at": "2019-07-23T16:08:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255179",
    "user": "https://github.com/sophiasage"
}
```

Changing keywords from "latte" to "latte, days100".



---

archive/issue_comments_255180.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-23T16:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255180",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255181.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T06:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255181",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255182.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T06:12:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255182",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255183.json:
```json
{
    "body": "Let's start with `ZZ`.\n\nIn `base_ZZ.py` (structure looks great):\n\n- You can correct the doctests later (this might save time)\n- `ehrhart_polynomial`: empty line after INPUT, and period at the end of engine description.\n- Eventually replace the third input by the description in the `_latte` method.\n- the current check `if self.is_empty():` located at the beginning of `_ehrhart_polynomial_latte` could be moved to the public `ehrhart_polynomial`.\n\nIn `backend_normaliz.py`:\n\n- looks good!\n\n- I am tempted to simply make the definition of the two `_ehrhart_polynomial_normaliz` as alias:\n\n```\n    _ehrhart_polynomial_normaliz = _ehrhart_quasi_polynomial_normaliz\n```\n\n- The check `if self.is_empty():` of `_ehrhart_quasi_normaliz` can be safely removed since the function should not be reached if it is empty since it is dealt with in the front function. I believe the same could also be checked for compactness in the front function (in `base_ZZ` and `base_QQ`).",
    "created_at": "2019-07-24T08:09:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255183",
    "user": "https://github.com/jplab"
}
```

Let's start with `ZZ`.

In `base_ZZ.py` (structure looks great):

- You can correct the doctests later (this might save time)
- `ehrhart_polynomial`: empty line after INPUT, and period at the end of engine description.
- Eventually replace the third input by the description in the `_latte` method.
- the current check `if self.is_empty():` located at the beginning of `_ehrhart_polynomial_latte` could be moved to the public `ehrhart_polynomial`.

In `backend_normaliz.py`:

- looks good!

- I am tempted to simply make the definition of the two `_ehrhart_polynomial_normaliz` as alias:

```
    _ehrhart_polynomial_normaliz = _ehrhart_quasi_polynomial_normaliz
```

- The check `if self.is_empty():` of `_ehrhart_quasi_normaliz` can be safely removed since the function should not be reached if it is empty since it is dealt with in the front function. I believe the same could also be checked for compactness in the front function (in `base_ZZ` and `base_QQ`).



---

archive/issue_comments_255184.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T09:27:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255184",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255185.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T10:02:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255185",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255186.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T10:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255186",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255187.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T11:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255188.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T12:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255188",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255189.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T14:55:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255189",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255190.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T15:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_052865.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2019-07-24T15:32:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18720#event-52865"
}
```



---

archive/issue_comments_255191.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T16:04:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255192.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-24T16:12:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255192",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255193.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-25T13:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255194.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-25T14:39:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255194",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255195.json:
```json
{
    "body": "Ok, I give up, it is not nice to try to make latte have the option to specify the variable. It involves changing the interface, and perhaps not in the scope of this ticket.\n\nI reverted the changes involving that around the `_latte` functions. It should be back to normal. So, I suggest that the `variable=` be only a `normaliz` engine option and not a `latte` one. Normaliz returns the data without the use of a variable, this is why it makes it easy to provide the option for the user to choose it since we have to choose one anyway.",
    "created_at": "2019-07-25T14:43:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255195",
    "user": "https://github.com/jplab"
}
```

Ok, I give up, it is not nice to try to make latte have the option to specify the variable. It involves changing the interface, and perhaps not in the scope of this ticket.

I reverted the changes involving that around the `_latte` functions. It should be back to normal. So, I suggest that the `variable=` be only a `normaliz` engine option and not a `latte` one. Normaliz returns the data without the use of a variable, this is why it makes it easy to provide the option for the user to choose it since we have to choose one anyway.



---

archive/issue_comments_255196.json:
```json
{
    "body": "... if one really wants to make it also possible for latte, the option to change the base ring variable is then a valid choice. But I would add a comment next to it saying:\n\n```\n# TO DO: replace this change of variable by creating the appropriate polynomial ring in the latte interface.\n```",
    "created_at": "2019-07-25T14:45:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255196",
    "user": "https://github.com/jplab"
}
```

... if one really wants to make it also possible for latte, the option to change the base ring variable is then a valid choice. But I would add a comment next to it saying:

```
# TO DO: replace this change of variable by creating the appropriate polynomial ring in the latte interface.
```



---

archive/issue_comments_255197.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-26T12:33:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255198.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-26T15:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255199.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-26T16:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255199",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255200.json:
```json
{
    "body": "Here are some small edits to be done:\n\n- You can forget my previous comment abour the heading space added.\n\n- No spaces are needed between equality in the definition of a function:\n\n```diff\n- def _ehrhart_quasipolynomial_normaliz(self,variable = 't'):\n+ def _ehrhart_quasipolynomial_normaliz(self,variable='t'):\n```\n\n- The output should be related to the data structure, without much details of what they are. The text with details should then be moved after the one-line description of the function to explain the output.\n\n```diff\n        OUTPUT:\n\n-        If it is a polynomial, returns the polynomial. Otherwise, returns a\n-        tuple of rational polynomials whose length is the quasi-period of the\n-        quasi-polynomial and each rational polynomial describes a residue class.\n\n+        A polynomial or tuple of polynomials.\n```\n\n- Most examples in doctests with text explanations should be moved to the public function without underscore so that they are accessible to the users. Then the examples of the private functions should show that they work as needed and that raising Errors are done appropriately.\n\n- Some formating of variables are missing (see http://doc.sagemath.org/html/en/developer/coding_basics.html):\n\n```diff\n- * None (default): When no input is given the Ehrhart polynomial\n+ * ``None`` (default): When no input is given the Ehrhart polynomial\n```\n\n- it is conventional to use lower cases for objects:\n\n```diff\n- sage: Line_Seg = Polyhedron(vertices=[[0],[1/2]],backend='normaliz')\n+ sage: line_seg = Polyhedron(vertices=[[0],[1/2]],backend='normaliz')\n```",
    "created_at": "2019-07-30T22:34:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255200",
    "user": "https://github.com/jplab"
}
```

Here are some small edits to be done:

- You can forget my previous comment abour the heading space added.

- No spaces are needed between equality in the definition of a function:

```diff
- def _ehrhart_quasipolynomial_normaliz(self,variable = 't'):
+ def _ehrhart_quasipolynomial_normaliz(self,variable='t'):
```

- The output should be related to the data structure, without much details of what they are. The text with details should then be moved after the one-line description of the function to explain the output.

```diff
        OUTPUT:

-        If it is a polynomial, returns the polynomial. Otherwise, returns a
-        tuple of rational polynomials whose length is the quasi-period of the
-        quasi-polynomial and each rational polynomial describes a residue class.

+        A polynomial or tuple of polynomials.
```

- Most examples in doctests with text explanations should be moved to the public function without underscore so that they are accessible to the users. Then the examples of the private functions should show that they work as needed and that raising Errors are done appropriately.

- Some formating of variables are missing (see http://doc.sagemath.org/html/en/developer/coding_basics.html):

```diff
- * None (default): When no input is given the Ehrhart polynomial
+ * ``None`` (default): When no input is given the Ehrhart polynomial
```

- it is conventional to use lower cases for objects:

```diff
- sage: Line_Seg = Polyhedron(vertices=[[0],[1/2]],backend='normaliz')
+ sage: line_seg = Polyhedron(vertices=[[0],[1/2]],backend='normaliz')
```



---

archive/issue_comments_255201.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-31T18:07:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255201",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255202.json:
```json
{
    "body": "ready for review ?",
    "created_at": "2019-08-20T18:12:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255202",
    "user": "https://github.com/fchapoton"
}
```

ready for review ?



---

archive/issue_comments_255203.json:
```json
{
    "body": "The branch is red, and the required rebase on the latest develop branch is not trivial.",
    "created_at": "2019-08-20T18:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255203",
    "user": "https://github.com/fchapoton"
}
```

The branch is red, and the required rebase on the latest develop branch is not trivial.



---

archive/issue_comments_255204.json:
```json
{
    "body": "I forgot that we could have put it to needs review to get some bot feedback already, but it was still quite under constant development.\n\nOnce the merge conflict is resolved, it could benefit from some bot-runs before another round of review.\n\nAs this function is a good example of interfacing of normaliz, I would say it is worth to make it a robust and clean model for other eventual methods using normaliz. It is in quite good shape, once it is on needs review, I would check again if we covered all the intricate cases of backends and base rings...",
    "created_at": "2019-08-20T19:14:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255204",
    "user": "https://github.com/jplab"
}
```

I forgot that we could have put it to needs review to get some bot feedback already, but it was still quite under constant development.

Once the merge conflict is resolved, it could benefit from some bot-runs before another round of review.

As this function is a good example of interfacing of normaliz, I would say it is worth to make it a robust and clean model for other eventual methods using normaliz. It is in quite good shape, once it is on needs review, I would check again if we covered all the intricate cases of backends and base rings...



---

archive/issue_comments_255205.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-08-27T11:59:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255206.json:
```json
{
    "body": "Could you merge the latest sage version into your branch? There is a conflict...\n\nThen, I guess it would ready for review.",
    "created_at": "2019-08-27T13:30:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255206",
    "user": "https://github.com/jplab"
}
```

Could you merge the latest sage version into your branch? There is a conflict...

Then, I guess it would ready for review.



---

archive/issue_comments_255207.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-09-05T15:46:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255207",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_255208.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-09-05T15:48:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255208",
    "user": "https://github.com/jplab"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_255209.json:
```json
{
    "body": "Okay!\n\nFrom the patchbot:\n\n- 2 failing doctests in `backend_normaliz`\n- 2 functions are missing doctests in `base_ZZ`\n- pyflakes error in `base_ZZ`\n- the documentation of `base_QQ` does not build: \n\n```\nOSError: /home/worker/sage-patchbot/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base_QQ.py:docstring of sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.ehrhart_quasipolynomial:69: WARNING: Inline literal start-string without end-string.\n```",
    "created_at": "2019-09-06T06:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255209",
    "user": "https://github.com/jplab"
}
```

Okay!

From the patchbot:

- 2 failing doctests in `backend_normaliz`
- 2 functions are missing doctests in `base_ZZ`
- pyflakes error in `base_ZZ`
- the documentation of `base_QQ` does not build: 

```
OSError: /home/worker/sage-patchbot/local/lib/python2.7/site-packages/sage/geometry/polyhedron/base_QQ.py:docstring of sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.ehrhart_quasipolynomial:69: WARNING: Inline literal start-string without end-string.
```



---

archive/issue_comments_255210.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-06T06:41:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255210",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_255211.json:
```json
{
    "body": "One more thing: we should consider making some of these methods cached so as to not recompute everything every time...",
    "created_at": "2019-09-11T15:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255211",
    "user": "https://github.com/jplab"
}
```

One more thing: we should consider making some of these methods cached so as to not recompute everything every time...



---

archive/issue_comments_255212.json:
```json
{
    "body": "empty TESTS section should be removed:\n\n```\n+        TESTS::\n+        \"\"\"\n```",
    "created_at": "2019-09-16T08:07:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255212",
    "user": "https://github.com/fchapoton"
}
```

empty TESTS section should be removed:

```
+        TESTS::
+        """
```



---

archive/issue_comments_255213.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-20T12:23:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255213",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255214.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-20T12:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255214",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255215.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-09-20T14:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255215",
    "user": "https://github.com/sophiasage"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_255216.json:
```json
{
    "body": "doc still does not build:\n\n```\nsage.geometry.polyhedron.base_QQ.Polyhedron_QQ.ehrhart_quasipolynomial:110: WARNING: Inline literal start-string without end-string\n```\nmaybe because of a missing empty line after `.. WARNING::`",
    "created_at": "2019-09-20T19:16:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255216",
    "user": "https://github.com/fchapoton"
}
```

doc still does not build:

```
sage.geometry.polyhedron.base_QQ.Polyhedron_QQ.ehrhart_quasipolynomial:110: WARNING: Inline literal start-string without end-string
```
maybe because of a missing empty line after `.. WARNING::`



---

archive/issue_comments_255217.json:
```json
{
    "body": "And there is one superfluous import, see the pyflake error.\n\nThere is also the coverage to take care of ...",
    "created_at": "2019-09-23T07:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255217",
    "user": "https://github.com/jplab"
}
```

And there is one superfluous import, see the pyflake error.

There is also the coverage to take care of ...



---

archive/issue_comments_255218.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-23T11:57:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255218",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255219.json:
```json
{
    "body": "You might also still have some doc problems\n\n```\n         -  ``variable`` -- string (default: 't'); The variable in which the\n-              Ehrhart polynomial should be expressed.\n+           Ehrhart polynomial should be expressed\n \n         - ``engine`` -- string; The backend to use. Allowed values are:\n \n-            * ``None`` (default); When no input is given the Ehrhart polynomial\n-              is computed using LattE Integrale (optional)\n+          * ``None`` (default); When no input is given the Ehrhart polynomial\n+            is computed using LattE Integrale (optional)\n```\nand similar. My understanding is sphinx likes things to be aligned with the first non-whitespace character after the `-` (or `*`) in a list.",
    "created_at": "2019-09-23T23:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255219",
    "user": "https://github.com/tscrim"
}
```

You might also still have some doc problems

```
         -  ``variable`` -- string (default: 't'); The variable in which the
-              Ehrhart polynomial should be expressed.
+           Ehrhart polynomial should be expressed
 
         - ``engine`` -- string; The backend to use. Allowed values are:
 
-            * ``None`` (default); When no input is given the Ehrhart polynomial
-              is computed using LattE Integrale (optional)
+          * ``None`` (default); When no input is given the Ehrhart polynomial
+            is computed using LattE Integrale (optional)
```
and similar. My understanding is sphinx likes things to be aligned with the first non-whitespace character after the `-` (or `*`) in a list.



---

archive/issue_comments_255220.json:
```json
{
    "body": "The following is not good:\n\n```\nTypeError: The backend of ``self`` should be 'normaliz'\n```\nThere should be no such formatting inside doctests themselves.",
    "created_at": "2019-09-24T07:18:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255220",
    "user": "https://github.com/fchapoton"
}
```

The following is not good:

```
TypeError: The backend of ``self`` should be 'normaliz'
```
There should be no such formatting inside doctests themselves.



---

archive/issue_comments_255221.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-24T08:48:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255221",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255222.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-24T11:22:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255222",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255223.json:
```json
{
    "body": "and some failing doctests, one missing optional and some misplaced optional",
    "created_at": "2019-09-24T12:20:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255223",
    "user": "https://github.com/fchapoton"
}
```

and some failing doctests, one missing optional and some misplaced optional



---

archive/issue_comments_255224.json:
```json
{
    "body": "and doc still does not build. The offending line seems to be\n\n```\n``backend``='normaliz'::\n```\nin line 490, which should rather be\n\n```\n``backend='normaliz'``::\n```",
    "created_at": "2019-09-24T14:51:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255224",
    "user": "https://github.com/fchapoton"
}
```

and doc still does not build. The offending line seems to be

```
``backend``='normaliz'::
```
in line 490, which should rather be

```
``backend='normaliz'``::
```



---

archive/issue_comments_255225.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-24T15:16:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255225",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255226.json:
```json
{
    "body": "There remains the same backtick problem in the other file `base_ZZ.py` in the line 400\n\n```\n``engine``='latte' and then with ``engine``='normaliz'.\n```\n\nand still the pyflakes warnings: do not write `engine is 'latte'` but `engine == 'latte'`. See patchbot pyflakes plugins for the 4 exact lines where you should fix that.\n\nand still the failing doctests due to missing or misplaced `# optional` tags.",
    "created_at": "2019-09-24T18:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255226",
    "user": "https://github.com/fchapoton"
}
```

There remains the same backtick problem in the other file `base_ZZ.py` in the line 400

```
``engine``='latte' and then with ``engine``='normaliz'.
```

and still the pyflakes warnings: do not write `engine is 'latte'` but `engine == 'latte'`. See patchbot pyflakes plugins for the 4 exact lines where you should fix that.

and still the failing doctests due to missing or misplaced `# optional` tags.



---

archive/issue_comments_255227.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-04T07:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255227",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255228.json:
```json
{
    "body": "I have fixed my own comments. There remains only one failing doctest in\n\n```\nsrc/sage/geometry/polyhedron/base_ZZ.py\n```\n, that you should take care of.",
    "created_at": "2019-10-04T07:47:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255228",
    "user": "https://github.com/fchapoton"
}
```

I have fixed my own comments. There remains only one failing doctest in

```
src/sage/geometry/polyhedron/base_ZZ.py
```
, that you should take care of.



---

archive/issue_comments_255229.json:
```json
{
    "body": "one last effort is required..",
    "created_at": "2019-10-13T19:49:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255229",
    "user": "https://github.com/fchapoton"
}
```

one last effort is required..



---

archive/issue_comments_255230.json:
```json
{
    "body": "We're on it! :) The semester starts today, and we'll have more time to look into sage.",
    "created_at": "2019-10-14T06:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255230",
    "user": "https://github.com/jplab"
}
```

We're on it! :) The semester starts today, and we'll have more time to look into sage.



---

archive/issue_comments_255231.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-14T09:18:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255231",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255232.json:
```json
{
    "body": "Needs review again. It should be good to go now.\n\nThe failing doctest due to a missing optional package was a superfluous indirect doctest, so I removed it. I don't think it needed testing there. If you disagree, I could put it back with the optional tag.",
    "created_at": "2019-10-14T09:23:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255232",
    "user": "https://github.com/jplab"
}
```

Needs review again. It should be good to go now.

The failing doctest due to a missing optional package was a superfluous indirect doctest, so I removed it. I don't think it needed testing there. If you disagree, I could put it back with the optional tag.



---

archive/issue_comments_255233.json:
```json
{
    "body": "typo \"integeral\"\n\nsinon, c'est bon : positive review",
    "created_at": "2019-10-14T12:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255233",
    "user": "https://github.com/fchapoton"
}
```

typo "integeral"

sinon, c'est bon : positive review



---

archive/issue_comments_255234.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-14T12:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255234",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_255235.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-14T12:18:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255235",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_052866.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-14T20:01:46Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "milestone": "sage-8.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18720#event-52866"
}
```



---

archive/issue_events_052867.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2019-10-14T20:01:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "milestone": "sage-9.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18720#event-52867"
}
```



---

archive/issue_comments_255236.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-20T22:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18720#issuecomment-255236",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_052868.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-10-20T22:16:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18720",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18720#event-52868"
}
```
