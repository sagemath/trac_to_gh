# Issue 21670: Bug in Maxima interface wrt polylog

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2016-11-20 07:55:56


```
sage: bool(x*polylog(x,x)==0)
...
/home/ralf/sage/local/lib/python2.7/site-packages/sage/symbolic/expression_conversions.pyc in composition(self, ex, operator)
    644         #FIXME: consider stripping pyobjects() in ops
    645         if hasattr(operator, self.name_init + "evaled_"):
--> 646             return getattr(operator, self.name_init + "evaled_")(*ops)
    647         else:
    648             ops = [self(_) for _ in ops]

/home/ralf/sage/local/lib/python2.7/site-packages/sage/functions/log.pyc in _maxima_init_evaled_(self, *args)
    451 
    452         n, x = args_maxima
--> 453         if int(n) in [1,2,3]:
    454             return 'li[%s](%s)'%(n, x)
    455         else:

ValueError: invalid literal for int() with base 10: '_SAGE_VAR_x'
```




---

Comment by chapoton created at 2020-12-26 17:58:08

This seems to be invalid. `polylog(x,x)` is not correct, the first argument must be an integer.

Of course, one could ask for a better error message.

https://doc.sagemath.org/html/en/reference/functions/sage/functions/log.html?#sage.functions.log.Function_polylog


---

Comment by chapoton created at 2020-12-26 17:58:08

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2020-12-27 03:39:31

Changing status from needs_review to needs_info.


---

Comment by @DaveWitteMorris created at 2020-12-27 03:39:31

I don't understand. The documentation seems to clearly state that non-integral values are allowed:

```
This definition is valid for arbitrary complex order s and for all complex 
arguments z with |z|<1; it can be extended to |z|â‰¥1 by the process of analytic 
continuation.
```

And non-integral values are accepted in my testing:

```
sage: polylog(1.1 + 2.2*I, 3.3 + 4.4*I)                                                        
-13.9758786469542 + 8.16803654165145*I
```


PS I think the documentation should tell us which parameter is `s` and which is `z`. (And I find the phrase "complex order s" to be confusing.)


---

Comment by chapoton created at 2021-01-21 16:48:06

This seems to work fine in 9.3.beta6, for some reason.


---

Comment by chapoton created at 2021-01-21 16:48:51

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2021-01-21 16:48:51

Here is a branch adding a doctest, and cleaning the file "en passant".
----
New commits:


---

Comment by chapoton created at 2021-01-22 13:43:05

green bot, please review


---

Comment by @DaveWitteMorris created at 2021-01-22 18:06:33

Please clarify the definition of `polylog` by making the following revision or something similar that specifies the branch cut.


```diff
-        This definition is valid for arbitrary complex order `s` and for
-        all complex arguments `z` with `|z| < 1`; it can be extended to
-        `|z| \ge 1` by the process of analytic continuation. So the
-        function may have a discontinuity at `z=1` which can cause a
-        `NaN` value returned for floating point arguments.
+        This definition is valid for arbitrary complex numbers `s` and `z`
+        with `|z| < 1`. It can be extended to `|z| \ge 1` by the process of
+        analytic continuation, with a branch cut along the positive real axis
+        from `1` to `+\infty`. A `NaN` value may be returned for floating
+        point arguments that are on the branch cut.
```



---

Comment by git created at 2021-01-22 19:31:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2021-01-22 19:32:20

ok, done


---

Comment by @DaveWitteMorris created at 2021-01-22 20:24:40

Changing priority from major to minor.


---

Comment by @DaveWitteMorris created at 2021-01-22 20:24:40

Thanks!  You can set to positive review on my behalf when there is a green patchbot again.


---

Comment by @DaveWitteMorris created at 2021-01-23 00:40:51

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2021-01-31 20:53:00

Resolution: fixed
