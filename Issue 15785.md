# Issue 15785: simon_two_descent sometimes gives wrong answers

archive/issues_015785.json:
```json
{
    "body": "CC:  @JohnCremona @mmasdeu\n\nKeywords: simon_two_descent\n\nThe current version of Denis Simon's 2-descent program (in Sage since #11005) has a bug:\n\n```\nsage: K.<y> = NumberField(x^4 + x^2 - 7);\nsage: E = EllipticCurve(K, [1, 0, 5*y^2 + 16, 0, 0])\nsage: E.simon_two_descent(lim1=2, limtriv=3)\n[0, 0, []]\n```\nThe rank is in fact 1, and a correct return value would be `(1, 1, [(-369/25*y^3 + 539/25*y^2 - 1178/25*y + 1718/25 : -27193/125*y^3 + 39683/125*y^2 - 86816/125*y + 126696/125 : 1)])`.\n\nThis ticket is just to fix this as quickly as possible; it should eventually be fixed in a new version of Simon's program.\n\n(See #15608 for a list of tickets related to `simon_two_descent`.)\n\nIssue created by migration from https://trac.sagemath.org/ticket/16022\n\n",
    "closed_at": "2014-03-31T14:59:45Z",
    "created_at": "2014-03-27T10:46:18Z",
    "labels": [
        "component: elliptic curves",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "simon_two_descent sometimes gives wrong answers",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15785",
    "user": "https://github.com/pjbruin"
}
```
CC:  @JohnCremona @mmasdeu

Keywords: simon_two_descent

The current version of Denis Simon's 2-descent program (in Sage since #11005) has a bug:

```
sage: K.<y> = NumberField(x^4 + x^2 - 7);
sage: E = EllipticCurve(K, [1, 0, 5*y^2 + 16, 0, 0])
sage: E.simon_two_descent(lim1=2, limtriv=3)
[0, 0, []]
```
The rank is in fact 1, and a correct return value would be `(1, 1, [(-369/25*y^3 + 539/25*y^2 - 1178/25*y + 1718/25 : -27193/125*y^3 + 39683/125*y^2 - 86816/125*y + 126696/125 : 1)])`.

This ticket is just to fix this as quickly as possible; it should eventually be fixed in a new version of Simon's program.

(See #15608 for a list of tickets related to `simon_two_descent`.)

Issue created by migration from https://trac.sagemath.org/ticket/16022





---

archive/issue_comments_204399.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-27T10:51:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15785#issuecomment-204399",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_204400.json:
```json
{
    "body": "To reproduce this directly in GP:\n\n```\n\\r ell.gp\nK = bnfinit(y^4 + y^2 - 7);\na = Mod(y, K.pol);\nE = [1, 0, 5*a^2 + 16, 0, 0];\nDEBUGLEVEL_ell = 2;\nLIM1 = 2;\nLIMTRIV = 3;\nbnfellrank(K, E)\n```",
    "created_at": "2014-03-27T11:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15785#issuecomment-204400",
    "user": "https://github.com/pjbruin"
}
```

To reproduce this directly in GP:

```
\r ell.gp
K = bnfinit(y^4 + y^2 - 7);
a = Mod(y, K.pol);
E = [1, 0, 5*a^2 + 16, 0, 0];
DEBUGLEVEL_ell = 2;
LIM1 = 2;
LIMTRIV = 3;
bnfellrank(K, E)
```



---

archive/issue_comments_204401.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-27T14:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15785#issuecomment-204401",
    "user": "https://github.com/mmasdeu"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_204402.json:
```json
{
    "body": "Comment moved from #10745:\n\nI see that you changed ell.gp. Is this good ? It is very very likely that the next update of simon's scripts will forget to make this patch-fix of a upstream file. Would it not be better to tell the author to change this in his version and we update our file ? This is a genuine question as I am not sure what is better. One thing to bear in mind is that it seems that Denis has not been very active on the bugs in his script recently.",
    "created_at": "2014-03-30T16:15:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15785#issuecomment-204402",
    "user": "https://github.com/categorie"
}
```

Comment moved from #10745:

I see that you changed ell.gp. Is this good ? It is very very likely that the next update of simon's scripts will forget to make this patch-fix of a upstream file. Would it not be better to tell the author to change this in his version and we update our file ? This is a genuine question as I am not sure what is better. One thing to bear in mind is that it seems that Denis has not been very active on the bugs in his script recently.



---

archive/issue_comments_204403.json:
```json
{
    "body": "Replying to [comment:4 wuthrich]:\n> I see that you changed ell.gp. Is this good ? It is very very likely that the next update of simon's scripts will forget to make this patch-fix of a upstream file. Would it not be better to tell the author to change this in his version and we update our file ? This is a genuine question as I am not sure what is better. One thing to bear in mind is that it seems that Denis has not been very active on the bugs in his script recently. \n\nI reported the bug to Denis and sent him the same patch used for this ticket.  Something similar happened with #15483.  So far, these are the only two tickets in which changes to `ell.gp` were made.  Hopefully he will make these fixes (or alternative ones) in the next version.  (We don't know when that will be, but the last version of `ell.gp` dates from 2011, while all his other programs were updated last January.)",
    "created_at": "2014-03-30T21:33:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15785#issuecomment-204403",
    "user": "https://github.com/pjbruin"
}
```

Replying to [comment:4 wuthrich]:
> I see that you changed ell.gp. Is this good ? It is very very likely that the next update of simon's scripts will forget to make this patch-fix of a upstream file. Would it not be better to tell the author to change this in his version and we update our file ? This is a genuine question as I am not sure what is better. One thing to bear in mind is that it seems that Denis has not been very active on the bugs in his script recently. 

I reported the bug to Denis and sent him the same patch used for this ticket.  Something similar happened with #15483.  So far, these are the only two tickets in which changes to `ell.gp` were made.  Hopefully he will make these fixes (or alternative ones) in the next version.  (We don't know when that will be, but the last version of `ell.gp` dates from 2011, while all his other programs were updated last January.)



---

archive/issue_comments_204404.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-03-31T14:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15785",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15785#issuecomment-204404",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_047121.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-31T14:59:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15785",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15785#event-47121"
}
```
