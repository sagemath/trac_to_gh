# Issue 13244: Fix GAP dependencies

Issue created by migration from https://trac.sagemath.org/ticket/13416

Original creator: jdemeyer

Original creation time: 2012-08-31 13:36:02

Assignee: GeorgSWeber

According to `spkg/standard/deps`, GAP depends on SAGE and on READLINE.  However, it seems neither of this is true.

For SAGE: there is nothing in the GAP sources nor patches which refers to Sage, `gap_reset_worksheet()` is a Sage libary function.

For READLINE: there is nothing in the GAP sources nor patches which refers to readline.  There is a call to `tgetent()`, so we should depend on TERMCAP.


---

Comment by vbraun created at 2012-09-03 17:57:44

GAP does use readline if available, and we do link against it:

```
(sage-sh) vbraun@volker-desktop:hg$ ldd $SAGE_LOCAL/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap
	linux-vdso.so.1 =>  (0x00007fff78fff000)
	libm.so.6 => /lib64/libm.so.6 (0x00000036c4800000)
	libreadline.so.6 => /home/vbraun/opt/sage-5.3.rc1/local/lib/libreadline.so.6 (0x00007f2291759000)
	libncurses.so.5 => /lib64/libncurses.so.5 (0x00000036da400000)
	libtinfo.so.5 => /lib64/libtinfo.so.5 (0x00000036d5800000)
	libdl.so.2 => /lib64/libdl.so.2 (0x00000036c5000000)
	libutil.so.1 => /lib64/libutil.so.1 (0x00000036d6800000)
	libc.so.6 => /lib64/libc.so.6 (0x00000036c4400000)
	/lib64/ld-linux-x86-64.so.2 (0x00000036c4000000)
```

We don't need the Sage library, at least gap-4.5.5 doesn't build the workspace cache as part of the spkg. Adding TERMCAP to the deps sounds good to me.


---

Comment by jdemeyer created at 2012-09-04 06:50:04

You must be using a different version of GAP:

```
jdemeyer@arcanis:/usr/local/src/sage-5.3.rc0$ ./sage --sh -c 'ldd $SAGE_LOCAL/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap'
ldd: /usr/local/src/sage-5.3.rc0/local/gap/latest/bin/x86_64-unknown-linux-gnu-gcc-default64/gap: No such file or directory
```


However:

```
jdemeyer@arcanis:/usr/local/src/sage-5.3.rc0$ ./sage --sh -c 'ldd $SAGE_LOCAL/lib/gap-4.4.12/bin/x86_64-unknown-linux-gnu-gcc/gap'
        linux-vdso.so.1 =>  (0x00007fffe05f5000)
        libm.so.6 => /lib/libm.so.6 (0x00007f40c9311000)
        libdl.so.2 => /lib/libdl.so.2 (0x00007f40c910d000)
        libc.so.6 => /lib/libc.so.6 (0x00007f40c8db1000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f40c9594000)
```



---

Comment by jdemeyer created at 2012-09-04 06:51:15

OK, I'm having a look at #13211 now...


---

Comment by jdemeyer created at 2012-09-04 06:54:12

GAP-4.5.5 links against readline indeed.  So the person who wrote these dependencies must have had a crystal ball to predict that GAP would be using `readline`.


---

Comment by jdemeyer created at 2012-09-04 06:58:52

Changing status from new to needs_review.


---

Attachment

Kept READLINE dependency in anticipation of #13211, needs review.


---

Comment by vbraun created at 2012-09-04 15:03:18

Looks good to me!


---

Comment by vbraun created at 2012-09-04 15:03:18

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-09-04 17:15:59

Resolution: fixed
