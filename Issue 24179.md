# Issue 24179: GeneralDiscreteDistribution broken when entries >= 10^309

Issue created by migration from Trac.

Original creator: slabbe

Original creation time: 2017-12-21 15:21:21

Keywords: thursdaysbdx


```
sage: from collections import Counter
```


This is ok:

```
sage: X = GeneralDiscreteDistribution([1,2,10^308])
sage: Counter(X.get_random_element() for _ in range(100))
Counter({2: 100})
sage: Counter(X.get_random_element() for _ in range(100))
Counter({2: 100})
```


This is not ok:

```
sage: X = GeneralDiscreteDistribution([1,2,10^309])
sage: Counter(X.get_random_element() for _ in range(100))
Counter({2: 66, 0: 34})
sage: Counter(X.get_random_element() for _ in range(100))
Counter({2: 67, 0: 33})
```



---

Comment by slabbe created at 2017-12-21 15:29:29

... replacing `10^309` by `2^1024`


---

Comment by slabbe created at 2018-05-01 08:59:33

The proposed fix simply does what `GeneralDiscreteDistribution?` says:


```
* "P" - list of probabilities. The list will automatically be
  normalised if "sum(P)" is not equal to 1. 
```

----
New commits:


---

Comment by slabbe created at 2018-05-01 08:59:33

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2018-05-01 12:56:23

Changing status from needs_review to positive_review.


---

Comment by vdelecroix created at 2018-05-01 12:56:23

Naïsse!


---

Comment by slabbe created at 2018-05-01 13:45:28

Merci.

Et si tu es motivé, tu peux terminer le review de #25125 qui prolonge le #24315 que tu avais déjà reviewé


---

Comment by vbraun created at 2018-05-08 17:26:55

Resolution: fixed
