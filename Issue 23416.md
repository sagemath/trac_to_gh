# Issue 23416: py3: fixing the sage-cython script

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2017-08-19 16:30:11

CC:  jdemeyer jhpalmieri embray

extracted from #23106


---

Comment by chapoton created at 2017-08-19 16:31:03

Changing status from new to needs_review.


---

Comment by chapoton created at 2017-08-19 16:31:03

easy one, please review
----
New commits:


---

Comment by jhpalmieri created at 2017-08-20 20:28:00

I think it's fine. I suppose stylistically some people might prefer

```
try:
    SAGE_SRC = os.environ["SAGE_SRC"]
except KeyError:
    ...
```

but it doesn't matter to me.


---

Comment by jhpalmieri created at 2017-08-20 20:28:00

Changing status from needs_review to positive_review.


---

Comment by fbissey created at 2017-08-22 09:33:31

Well, I prefer `from sage.env import SAGE_SRC` personally. I am sure my sage-on-distro colleagues are of the same mind. I am not sure why trying to get `SAGE_SRC` from the shell environment is any better or fix anything. Do you want it to work while sage is not installed yet? 

But that brings me to a uglier point. You are using sage's source at run time? OK, you need .pxi files that are not currently installed by "vanilla" sage (sage-on-gentoo does so I can point to my sage install instead). And yet another problem with that file is that it is full of .pxi which are currently being systematically phased out.

Volker's already started to merge this ticket so it may be too late, but at least can someone explain the rationale for using `os.environ`?


---

Comment by chapoton created at 2017-08-22 09:52:03

the reason is python3 : under a python3 sage install, "python" means python2, so that the import of sage.env would fail. See #23106 for another possibility, namely use "sage-python23" in the headline instead of "python"


---

Comment by fbissey created at 2017-08-22 10:07:57

I see. I have other tools at my disposal for wrapping python scripts, so that particular issue doesn't exist for me. From sage-on-distro point of view, we are not thrilled by `sage-python23` in scripts. But at least it is easy to spot and fix systematically.


---

Comment by vbraun created at 2017-08-26 09:57:52

Resolution: fixed
