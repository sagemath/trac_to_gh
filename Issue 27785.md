# Issue 27785: Downgrade rubiks to optional

Issue created by migration from https://trac.sagemath.org/ticket/28022

Original creator: isuruf

Original creation time: 2019-06-20 05:34:09

CC:  @timokau jhpalmieri

See discussion in https://groups.google.com/forum/?utm_medium=email&utm_source=footer#!msg/sage-devel/lc-HqYCFrDw/r4TlV6qCBAAJ


---

Comment by chapoton created at 2019-06-20 11:22:13

here is first tentative
----
New commits:


---

Comment by chapoton created at 2019-06-20 11:22:13

Changing status from new to needs_review.


---

Comment by dimpase created at 2019-06-20 12:13:50

this also needs an update of  `http://wrongway.org/?rubiksource` in rubiks.py, as it's not working any more (domain is up for sale).

e.g. we can link to https://web.archive.org/web/20121212175710/http://www.wrongway.org/?rubiksource


---

Comment by git created at 2019-06-20 13:57:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-06-20 13:58:08

done


---

Comment by embray created at 2019-06-20 17:57:28

+1  Would it make sense to use `sage.features` for this?


---

Comment by jdemeyer created at 2019-06-20 18:32:25

If we're not changing the package, there is no need to edit `build/pkgs/rubiks/package-version.txt`


---

Comment by git created at 2019-06-21 07:02:38

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2019-06-21 07:03:17

version bump was undone, and then the branch squashed


---

Comment by dimpase created at 2019-06-21 12:09:36

OK, don't forget the author's name.


---

Comment by dimpase created at 2019-06-21 12:09:36

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2019-06-21 12:13:05

thx


---

Comment by dimpase created at 2019-06-26 12:39:03

Changing status from positive_review to needs_work.


---

Comment by dimpase created at 2019-06-26 12:39:03

We forgot `src/sage/groups/perm_gps/cubegroup.py`, where `rubiks` is used unconditionally.


---

Comment by git created at 2019-06-26 13:30:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2019-06-26 13:30:39

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2019-06-26 13:30:39

indeed. Here is a fix.


---

Comment by dimpase created at 2019-06-26 15:52:07

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2019-06-26 15:52:07

this seems to be a wrong (always succeeding) test for the presense of rubiks package:

```
        try:
            import sage.interfaces.rubik  # here to avoid circular referencing
        except ImportError:
            algorithm = 'gap'
```

indeed, the interface is always there, whether or not rubiks is installed.


---

Comment by chapoton created at 2019-06-26 15:57:02

ok.. Then I have no idea what to do. If you know how to fix that, please do..


---

Comment by dimpase created at 2019-06-26 16:24:12

How about simply calling `is_package_installed('rubiks')` ?

```
sage: is_package_installed('rubiks')
False
```



---

Comment by @timokau created at 2019-06-26 16:45:09

Note that `is_package_installed` is supposed to be deprecated: #20382, mostly (I think) because it is a pain for packagers.


---

Comment by dimpase created at 2019-06-26 17:00:28

`Features` entails creating `sage/features/rubiks.py` with some runtime tests... looks a bit insane, but OK...


---

Comment by jhpalmieri created at 2019-06-26 18:57:16

According to the file manifest, the `rubiks` package only installs six binaries, and it shouldn't be too bad to check that they exist and work, for the `Features` test. You could model it on `sage/features/graphviz.py`, for example.


---

Comment by embray created at 2019-07-01 13:27:11

+1 to adding it to `sage.features`.  This is what I suggested in the first place :)


---

Comment by chapoton created at 2019-07-01 13:31:01

I will not be the one that does that.


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by mkoeppe created at 2020-09-02 16:41:07

Changing priority from major to critical.


---

Comment by git created at 2020-09-02 21:16:22

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jhpalmieri created at 2020-09-02 21:18:00

I rebased Frédéric's work, and I added a file `features/rubiks.py`. Please test with and without installing the `rubiks` package.


---

Comment by jhpalmieri created at 2020-09-02 21:18:00

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2020-09-03 02:47:45

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-09-03 02:47:45

This works well.


---

Comment by vbraun created at 2020-09-15 22:01:08

Resolution: fixed
