# Issue 27206: spring cleanup for QQbar

archive/issues_027206.json:
```json
{
    "body": "CC:  @tscrim\n\nremoving one deprecated class (after #19954)\n\nalso fix most of the pep8 warnings\n\nplus a few minor code improvements\n\nIssue created by migration from https://trac.sagemath.org/ticket/27443\n\n",
    "created_at": "2019-03-08T07:59:32Z",
    "labels": [
        "component: algebra",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.7",
    "title": "spring cleanup for QQbar",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27206",
    "user": "https://github.com/fchapoton"
}
```
CC:  @tscrim

removing one deprecated class (after #19954)

also fix most of the pep8 warnings

plus a few minor code improvements

Issue created by migration from https://trac.sagemath.org/ticket/27443





---

archive/issue_comments_382890.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-03-08T08:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382890",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_382891.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-03-08T08:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382891",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_382892.json:
```json
{
    "body": "green bot, please review",
    "created_at": "2019-03-08T10:21:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382892",
    "user": "https://github.com/fchapoton"
}
```

green bot, please review



---

archive/issue_comments_382893.json:
```json
{
    "body": "I do not understand the `extras=None` change. I think it is fine to have an optional parameter that has a default value as optional is a way to convey a little more context/information to the user (rather than saying it is a default value). If there is something that is passing `None`, then I feel that should be changed.",
    "created_at": "2019-03-08T23:09:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382893",
    "user": "https://github.com/tscrim"
}
```

I do not understand the `extras=None` change. I think it is fine to have an optional parameter that has a default value as optional is a way to convey a little more context/information to the user (rather than saying it is a default value). If there is something that is passing `None`, then I feel that should be changed.



---

archive/issue_comments_382894.json:
```json
{
    "body": "The reason is the following (as explained by lgtm):\n\nWhen a parameter default value is a dictionary, it is stored in the function definition, and any modification of this dictionary is acting on (changing) this stored default. So the next call of the function will use the modified default. Which is not the expected effect.",
    "created_at": "2019-03-09T07:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382894",
    "user": "https://github.com/fchapoton"
}
```

The reason is the following (as explained by lgtm):

When a parameter default value is a dictionary, it is stored in the function definition, and any modification of this dictionary is acting on (changing) this stored default. So the next call of the function will use the modified default. Which is not the expected effect.



---

archive/issue_comments_382895.json:
```json
{
    "body": "I was not aware of that, but it makes sense that things were designed that way. That sure can lead to subtle bugs.\n\n```\nsage: def foo(x, d={}):\n....:     d[x] = 1\n....:     return d\n....: \nsage: x = foo(5)\nsage: x\n{5: 1}\nsage: x[10] = 10\nsage: foo(0)\n{0: 1, 5: 1, 10: 10}\n```\n\n\nHowever, in these cases the `dict` is only expanded and never changed. So I don't see the point of making the code more complex to silence a warning:\n\n```\nsage: def bar(**opts):\n....:     opts[1] = 5\n....:     \nsage: def foo(d={}):\n....:     bar(**d)\n....:     return d\n....: \nsage: foo()\n{}\nsage: foo()\n{}\n```\n",
    "created_at": "2019-03-09T08:55:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382895",
    "user": "https://github.com/tscrim"
}
```

I was not aware of that, but it makes sense that things were designed that way. That sure can lead to subtle bugs.

```
sage: def foo(x, d={}):
....:     d[x] = 1
....:     return d
....: 
sage: x = foo(5)
sage: x
{5: 1}
sage: x[10] = 10
sage: foo(0)
{0: 1, 5: 1, 10: 10}
```


However, in these cases the `dict` is only expanded and never changed. So I don't see the point of making the code more complex to silence a warning:

```
sage: def bar(**opts):
....:     opts[1] = 5
....:     
sage: def foo(d={}):
....:     bar(**d)
....:     return d
....: 
sage: foo()
{}
sage: foo()
{}
```




---

archive/issue_comments_382896.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-03-09T12:48:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382896",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_382897.json:
```json
{
    "body": "done, back to `{}`",
    "created_at": "2019-03-09T12:48:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382897",
    "user": "https://github.com/fchapoton"
}
```

done, back to `{}`



---

archive/issue_comments_382898.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-03-09T12:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382898",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_382899.json:
```json
{
    "body": "Thank you. LGTM.",
    "created_at": "2019-03-09T12:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382899",
    "user": "https://github.com/tscrim"
}
```

Thank you. LGTM.



---

archive/issue_events_025250.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2019-03-11T22:39:55Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27206#event-25250"
}
```



---

archive/issue_comments_382900.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-03-11T22:39:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27206",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27206#issuecomment-382900",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
