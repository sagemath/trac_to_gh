# Issue 27206: spring cleanup for QQbar

Issue created by migration from https://trac.sagemath.org/ticket/27443

Original creator: chapoton

Original creation time: 2019-03-08 07:59:32

CC:  tscrim

removing one deprecated class (after #19954)

also fix most of the pep8 warnings

plus a few minor code improvements


---

Comment by chapoton created at 2019-03-08 08:00:05

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-03-08 08:00:05

New commits:


---

Comment by chapoton created at 2019-03-08 10:21:43

green bot, please review


---

Comment by tscrim created at 2019-03-08 23:09:14

I do not understand the `extras=None` change. I think it is fine to have an optional parameter that has a default value as optional is a way to convey a little more context/information to the user (rather than saying it is a default value). If there is something that is passing `None`, then I feel that should be changed.


---

Comment by chapoton created at 2019-03-09 07:01:09

The reason is the following (as explained by lgtm):

When a parameter default value is a dictionary, it is stored in the function definition, and any modification of this dictionary is acting on (changing) this stored default. So the next call of the function will use the modified default. Which is not the expected effect.


---

Comment by tscrim created at 2019-03-09 08:55:03

I was not aware of that, but it makes sense that things were designed that way. That sure can lead to subtle bugs.

```
sage: def foo(x, d={}):
....:     d[x] = 1
....:     return d
....: 
sage: x = foo(5)
sage: x
{5: 1}
sage: x[10] = 10
sage: foo(0)
{0: 1, 5: 1, 10: 10}
```


However, in these cases the `dict` is only expanded and never changed. So I don't see the point of making the code more complex to silence a warning:

```
sage: def bar(**opts):
....:     opts[1] = 5
....:     
sage: def foo(d={}):
....:     bar(**d)
....:     return d
....: 
sage: foo()
{}
sage: foo()
{}
```



---

Comment by git created at 2019-03-09 12:48:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2019-03-09 12:48:48

done, back to `{}`


---

Comment by tscrim created at 2019-03-09 12:51:03

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2019-03-09 12:51:03

Thank you. LGTM.


---

Comment by vbraun created at 2019-03-11 22:39:55

Resolution: fixed
