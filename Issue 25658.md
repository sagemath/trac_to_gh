# Issue 25658: LatticePoset, optimize congruence-related functions for trivial cases

archive/issues_025658.json:
```json
{
    "body": "CC:  @tscrim @fchapoton\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/25895\n\n",
    "created_at": "2018-07-22T07:17:36Z",
    "labels": [
        "component: please change"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "LatticePoset, optimize congruence-related functions for trivial cases",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25658",
    "user": "https://github.com/jm58660"
}
```
CC:  @tscrim @fchapoton



Issue created by migration from https://trac.sagemath.org/ticket/25895





---

archive/issue_comments_361498.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361498",
    "user": "https://github.com/jm58660"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_361499.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361499",
    "user": "https://github.com/jm58660"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_361500.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to combinatorics.",
    "created_at": "2018-07-22T07:19:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361500",
    "user": "https://github.com/jm58660"
}
```

Changing component from PLEASE CHANGE to combinatorics.



---

archive/issue_comments_361501.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-22T07:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361501",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361502.json:
```json
{
    "body": "How is this method being used? I don't want to add a hidden method that is not used. I think it is generally better to have at least one use-case in the same ticket.",
    "created_at": "2018-07-22T15:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361502",
    "user": "https://github.com/tscrim"
}
```

How is this method being used? I don't want to add a hidden method that is not used. I think it is generally better to have at least one use-case in the same ticket.



---

archive/issue_comments_361503.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-23T05:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361503",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361504.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-23T05:53:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361504",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361505.json:
```json
{
    "body": "Replying to [comment:4 tscrim]:\n> I think it is generally better to have at least one use-case in the same ticket.\n\nDone this. If `Lats` is a list of all 10-element lattices, then the time for\n\n\n```\nsum(1 for L in Lats if L.is_uniform())\n```\n\n\ndrops from 26 seconds to 9 seconds with this patch.",
    "created_at": "2018-07-23T05:56:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361505",
    "user": "https://github.com/jm58660"
}
```

Replying to [comment:4 tscrim]:
> I think it is generally better to have at least one use-case in the same ticket.

Done this. If `Lats` is a list of all 10-element lattices, then the time for


```
sum(1 for L in Lats if L.is_uniform())
```


drops from 26 seconds to 9 seconds with this patch.



---

archive/issue_comments_361506.json:
```json
{
    "body": "LGTM. Thanks. Nice speedup too.",
    "created_at": "2018-07-23T11:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361506",
    "user": "https://github.com/tscrim"
}
```

LGTM. Thanks. Nice speedup too.



---

archive/issue_comments_361507.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-07-23T11:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361507",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_361508.json:
```json
{
    "body": "Changing keywords from \"\" to \"sagedays@icerm\".",
    "created_at": "2018-07-23T11:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361508",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "" to "sagedays@icerm".



---

archive/issue_comments_361509.json:
```json
{
    "body": "Thanks.\n\nThe speedup thing for this kind of functions is hard to decide. It the user asks if a lattice is modular, should we first try to see if it happens to be distributive? If so, it must be also modular and the test was very fast. But then, distributive lattices are \"rare\". OTOH also lattices with at least one \"doubledouble\"-irreducible element are \"rare\", so should we test for those?\n\nAt the other extreme we have for example `is_orthocomplemented`, where we start by checking that the number of elements is even; here the quick test is extremely cheap.",
    "created_at": "2018-07-23T11:44:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361509",
    "user": "https://github.com/jm58660"
}
```

Thanks.

The speedup thing for this kind of functions is hard to decide. It the user asks if a lattice is modular, should we first try to see if it happens to be distributive? If so, it must be also modular and the test was very fast. But then, distributive lattices are "rare". OTOH also lattices with at least one "doubledouble"-irreducible element are "rare", so should we test for those?

At the other extreme we have for example `is_orthocomplemented`, where we start by checking that the number of elements is even; here the quick test is extremely cheap.



---

archive/issue_comments_361510.json:
```json
{
    "body": "Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail. (Although perhaps stronger properties are easier to test for in general?)",
    "created_at": "2018-07-23T11:50:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361510",
    "user": "https://github.com/tscrim"
}
```

Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail. (Although perhaps stronger properties are easier to test for in general?)



---

archive/issue_comments_361511.json:
```json
{
    "body": "Replying to [comment:10 tscrim]:\n\n> Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail.\n\nMaybe... But that might depend on use case.\n\n> (Although perhaps stronger properties are easier to test for in general?)\n\nNo, for example testing for semimodularity is faster that testing for modularity. But of course one can always test for a stronger property to get sure \"yes\"-answer, test for a weaker property to get sure \"no\"-answer, and only when needed to proceed testing the original property.",
    "created_at": "2018-07-23T12:23:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361511",
    "user": "https://github.com/jm58660"
}
```

Replying to [comment:10 tscrim]:

> Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail.

Maybe... But that might depend on use case.

> (Although perhaps stronger properties are easier to test for in general?)

No, for example testing for semimodularity is faster that testing for modularity. But of course one can always test for a stronger property to get sure "yes"-answer, test for a weaker property to get sure "no"-answer, and only when needed to proceed testing the original property.



---

archive/issue_comments_361512.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-08-05T08:15:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25658",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25658#issuecomment-361512",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
