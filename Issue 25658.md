# Issue 25658: LatticePoset, optimize congruence-related functions for trivial cases

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2018-07-22 07:17:36

CC:  tscrim chapoton




---

Comment by jmantysalo created at 2018-07-22 07:19:31

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2018-07-22 07:19:31

Changing type from PLEASE CHANGE to enhancement.


---

Comment by jmantysalo created at 2018-07-22 07:19:31

Changing component from PLEASE CHANGE to combinatorics.


---

Comment by git created at 2018-07-22 07:21:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-07-22 15:59:37

How is this method being used? I don't want to add a hidden method that is not used. I think it is generally better to have at least one use-case in the same ticket.


---

Comment by git created at 2018-07-23 05:26:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-23 05:53:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2018-07-23 05:56:56

Replying to [comment:4 tscrim]:
> I think it is generally better to have at least one use-case in the same ticket.

Done this. If `Lats` is a list of all 10-element lattices, then the time for


```
sum(1 for L in Lats if L.is_uniform())
```


drops from 26 seconds to 9 seconds with this patch.


---

Comment by tscrim created at 2018-07-23 11:34:32

LGTM. Thanks. Nice speedup too.


---

Comment by tscrim created at 2018-07-23 11:34:32

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2018-07-23 11:34:32

Changing keywords from "" to "sagedays@icerm".


---

Comment by jmantysalo created at 2018-07-23 11:44:16

Thanks.

The speedup thing for this kind of functions is hard to decide. It the user asks if a lattice is modular, should we first try to see if it happens to be distributive? If so, it must be also modular and the test was very fast. But then, distributive lattices are "rare". OTOH also lattices with at least one "doubledouble"-irreducible element are "rare", so should we test for those?

At the other extreme we have for example `is_orthocomplemented`, where we start by checking that the number of elements is even; here the quick test is extremely cheap.


---

Comment by tscrim created at 2018-07-23 11:50:13

Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail. (Although perhaps stronger properties are easier to test for in general?)


---

Comment by jmantysalo created at 2018-07-23 12:23:07

Replying to [comment:10 tscrim]:

> Because the test for distributive is relatively expensive (and a stronger property?), I would not do it. One possibility is putting a `.. NOTE::` in the doc saying something like in your comment: that the distributive test is faster but more likely to fail.

Maybe... But that might depend on use case.

> (Although perhaps stronger properties are easier to test for in general?)

No, for example testing for semimodularity is faster that testing for modularity. But of course one can always test for a stronger property to get sure "yes"-answer, test for a weaker property to get sure "no"-answer, and only when needed to proceed testing the original property.


---

Comment by vbraun created at 2018-08-05 08:15:49

Resolution: fixed
