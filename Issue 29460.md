# Issue 29460: src/setup.py, src/sage/env.py (sage_include_directories): Do not add another copy of SAGE_INC, SAGE_LOCAL/lib to include dirs, library dirs

Issue created by migration from https://trac.sagemath.org/ticket/29697

Original creator: mkoeppe

Original creation time: 2020-05-17 02:45:38

CC:  dimpase fbissey mjo isuruf

`$SAGE_LOCAL/{include,lib}` are already added to the front of the search paths `CPATH` and `LIBRARY_PATH` by `sage-env`.


---

Comment by fbissey created at 2020-05-17 03:08:29

I don't think it is controversial at all. Is there anyone who think we are forgetting something here?
----
New commits:


---

Comment by mkoeppe created at 2020-05-17 03:13:09

I plan to add some doctests to make sure that functions such as `sage.misc.cython.cython` also work correctly when `sage.all` is imported into plain Python (without runnning `sage-env`). Things like this are currently not tested at all (and probably not guaranteed by anything); I plan to use #29446 for this.


---

Comment by mkoeppe created at 2020-05-17 03:13:40

Changing status from new to needs_review.


---

Comment by git created at 2020-05-17 03:33:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-05-17 03:34:04

Replying to [comment:2 fbissey]:
> I don't think it is controversial at all. 

No, just needs review.


---

Comment by fbissey created at 2020-05-17 03:53:22

Well, I think you have gone after the only breakage in the last commit. Unless someone can point to a corner case, it is all positive from me.


---

Comment by fbissey created at 2020-05-17 03:53:22

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-05-17 03:54:19

Thanks!


---

Comment by fbissey created at 2020-05-17 21:05:03

I didn't realise at the time, but that will be one less line of patching for me in sage-on-gentoo.


---

Comment by vbraun created at 2020-05-29 21:16:18

Resolution: fixed


---

Comment by mkoeppe created at 2020-07-26 20:58:04

This may have caused some breakage: https://groups.google.com/d/msg/sage-release/SdxKEn7CuLM/3ru84S_zAgAJ


---

Comment by mkoeppe created at 2020-07-26 21:53:51

... because of incorrect usage of `extra_compile_args` in some of our modules - to be fixed in #30227


---

Comment by mkoeppe created at 2021-02-04 03:18:23

Follow-up: #31335
