# Issue 19273: asymptotic expansion generator for binomial(kn, n)

Issue created by migration from Trac.

Original creator: dkrenn

Original creation time: 2015-11-01 18:10:01

CC:  behackl cheuberg

Implement a generator for `binomial(k*n, n)`.


---

Comment by dkrenn created at 2015-11-04 16:06:41

Last 10 new commits:


---

Comment by git created at 2015-11-05 02:37:22

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2015-11-05 02:40:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dkrenn created at 2015-11-05 02:41:02

Changing status from new to needs_review.


---

Comment by git created at 2015-11-07 00:31:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-01-22 05:13:18

Merged latest version of #19306 to avoid doctest failure.
----
New commits:


---

Comment by git created at 2016-01-23 18:55:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-01-23 19:06:04

Reviewed the code (without its dependency #19521) and the documentation, but did not yet verify the final output of the doctests. I had to modify the "constant factor" in order to get rational coefficients when `k-1` is not a square.

I am not happy with the growth group of the output:
- `(e<sup>(n*log(n)))</sup>(Symbolic Constants Subring)` will never occur.
- `log(n)^(Symbolic Constants Subring)` will never occur.
- `(e<sup>n)</sup>(Symbolic Constants Subring)` is hard to read; actually, the only exponential factor that will ever occur is `(k<sup>k/(k-1)</sup>(k-1))^n`, so `FractionField(k.parent())^n` would be enough (so `QQ^n` in all examples). However, it is not clear to me how to implement this without pain.


---

Comment by cheuberg created at 2016-01-23 19:06:04

Changing status from needs_review to needs_work.


---

Comment by dkrenn created at 2016-01-26 19:46:53

Changing status from needs_work to needs_review.


---

Comment by dkrenn created at 2016-01-26 19:46:53

Replying to [comment:11 cheuberg]:
> Reviewed the code (without its dependency #19521) and the documentation, but did not yet verify the final output of the doctests. I had to modify the "constant factor" in order to get rational coefficients when `k-1` is not a square.
> 
> I am not happy with the growth group of the output:
> - `(e<sup>(n*log(n)))</sup>(Symbolic Constants Subring)` will never occur.
> - `log(n)^(Symbolic Constants Subring)` will never occur.
> - `(e<sup>n)</sup>(Symbolic Constants Subring)` is hard to read; actually, the only exponential factor that will ever occur is `(k<sup>k/(k-1)</sup>(k-1))^n`, so `FractionField(k.parent())^n` would be enough (so `QQ^n` in all examples). However, it is not clear to me how to implement this without pain. 

More or less complete rewrite of function.
----
Last 10 new commits:


---

Comment by cheuberg created at 2016-01-27 11:46:20

I reviewed this version. 

I merged #19957 and added doctests using `compare_with_values`. Please cross-review and set to positive if you are satisfied.
----
Last 10 new commits:


---

Comment by dkrenn created at 2016-01-27 12:59:29

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-01-29 17:43:25

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-01-29 17:43:25

http://build.sagedev.org/release/builders/%20%20fast%20Oxford%20arando%20%28Ubuntu%2013.04%20i686%29%20incremental/builds/797/steps/shell_4/logs/stdio

```
sage -t --long src/sage/rings/asymptotic/asymptotic_expansion_generators.py
**********************************************************************
File "src/sage/rings/asymptotic/asymptotic_expansion_generators.py", line 141, in sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling
Failed example:
    expansion.compare_with_values(n, lambda x: x.factorial(), [5, 10, 20])
Expected:
    [(5, 0.00675841118?), (10, 0.0067589306?), (20, 0.006744925?)]
Got:
    [(5, 0.006758411181?), (10, 0.0067589306?), (20, 0.006744925?)]
**********************************************************************
1 item had failures:
   1 of  11 in sage.rings.asymptotic.asymptotic_expansion_generators.AsymptoticExpansionGenerators.Stirling
    [45 tests, 1 failure, 8.78 s]
```



---

Comment by git created at 2016-01-30 14:16:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cheuberg created at 2016-01-30 14:17:50

Added relative tolerance.


---

Comment by cheuberg created at 2016-01-30 14:17:50

Changing status from needs_work to needs_review.


---

Comment by dkrenn created at 2016-01-30 14:40:07

New commits:


---

Comment by dkrenn created at 2016-01-30 14:40:07

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-01-31 13:31:35

Resolution: fixed
