# Issue 22412: py3 use richcmp for morphisms of schemes

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2017-03-19 20:43:15

CC:  tscrim jdemeyer bhutz cremona rlmiller

tentative to move towards python3


---

Comment by chapoton created at 2017-03-19 20:44:07

New commits:


---

Comment by chapoton created at 2017-03-20 19:24:51

almost works..


---

Comment by git created at 2017-04-01 19:59:34

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-04-01 20:30:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-04-01 20:42:58

It seems that the current state of this ticket has the following effect:

**Before**, comparison of an element of projective space Pn with "other" tried (by itself) to convert "other" to an element of Pn

**After**, no such conversion is performed. This means that comparison behaves differently, for example P1(0,1) == 0 is not True.

This should rather be fixed by a proper coercion, maybe ?


---

Comment by chapoton created at 2017-04-01 20:42:58

Changing status from new to needs_info.


---

Comment by git created at 2017-04-02 18:53:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2017-04-02 19:19:57

one doctest failure should be solved by #22743


---

Comment by chapoton created at 2017-04-07 16:36:37

May be good now. Back to needs review. Waiting for a bot to go through.


---

Comment by chapoton created at 2017-04-07 16:36:37

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2017-04-11 20:48:14

ok,green bot, please review


---

Comment by tscrim created at 2017-04-11 22:07:26

I think you might want to cc some of the people who work on schemes to look at this because of the behavior change. I don't know enough about that area of math or how that code is used to say whether or not the change is likely to break stuff.


---

Comment by chapoton created at 2017-04-12 06:44:15

ok, but who are they ?


---

Comment by bhutz created at 2017-04-12 14:58:53

I agree that coercion is the right way to go (it's been on the TODO list for awhile now).

As for this change without coercion. I'm not concerned with most of the schemes files as anything being careful about where points live will be fine and those short cuts are much less intuitive when the dimension is >1. I thought the elliptic curve files used the implicit P(0,1)==0 fairly often, but it seems like all tests currently pass. Perhaps John Cremona can comment more on the elliptic curve perspective. 

It might be a little more annoying to the user until we get coercion for schemes implemented, but I don't see anything wrong with the new behavior.


---

Comment by chapoton created at 2017-04-15 09:56:44

`@`cremona, any comments ?


---

Comment by cremona created at 2017-04-15 13:12:06

Replying to [comment:14 chapoton]:
> `@`cremona, any comments ?
No. I try to avoid looking at this low level stuff so if tests still pass and it is no slower to test equality of points on elliptic curves then go ahead.


---

Comment by tscrim created at 2017-04-15 16:07:21

Since that is a relatively special case, I don't think it will be used that much. If it is desired, then 1-dim projective spaces from their base rings, which would be the simplest way to get the old behavior back. (At least, this is my impression from quickly looking at things.) So I'm setting a positive review and the coercion can be done on a followup ticket.


---

Comment by tscrim created at 2017-04-15 16:22:13

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-04-16 11:31:22

Resolution: fixed
