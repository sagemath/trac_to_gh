# Issue 22412: py3 use richcmp for morphisms of schemes

archive/issues_022412.json:
```json
{
    "body": "CC:  @tscrim @jdemeyer @bhutz @JohnCremona rlmiller\n\ntentative to move towards python3\n\nIssue created by migration from https://trac.sagemath.org/ticket/22649\n\n",
    "created_at": "2017-03-19T20:43:15Z",
    "labels": [
        "python3",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "py3 use richcmp for morphisms of schemes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22412",
    "user": "@fchapoton"
}
```
CC:  @tscrim @jdemeyer @bhutz @JohnCremona rlmiller

tentative to move towards python3

Issue created by migration from https://trac.sagemath.org/ticket/22649





---

archive/issue_comments_312189.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-03-19T20:44:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312189",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_312190.json:
```json
{
    "body": "almost works..",
    "created_at": "2017-03-20T19:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312190",
    "user": "@fchapoton"
}
```

almost works..



---

archive/issue_comments_312191.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-01T19:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312191",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312192.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-01T20:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312192",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312193.json:
```json
{
    "body": "It seems that the current state of this ticket has the following effect:\n\n**Before**, comparison of an element of projective space Pn with \"other\" tried (by itself) to convert \"other\" to an element of Pn\n\n**After**, no such conversion is performed. This means that comparison behaves differently, for example P1(0,1) == 0 is not True.\n\nThis should rather be fixed by a proper coercion, maybe ?",
    "created_at": "2017-04-01T20:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312193",
    "user": "@fchapoton"
}
```

It seems that the current state of this ticket has the following effect:

**Before**, comparison of an element of projective space Pn with "other" tried (by itself) to convert "other" to an element of Pn

**After**, no such conversion is performed. This means that comparison behaves differently, for example P1(0,1) == 0 is not True.

This should rather be fixed by a proper coercion, maybe ?



---

archive/issue_comments_312194.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2017-04-01T20:42:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312194",
    "user": "@fchapoton"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_312195.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-02T18:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312195",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_312196.json:
```json
{
    "body": "one doctest failure should be solved by #22743",
    "created_at": "2017-04-02T19:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312196",
    "user": "@fchapoton"
}
```

one doctest failure should be solved by #22743



---

archive/issue_comments_312197.json:
```json
{
    "body": "May be good now. Back to needs review. Waiting for a bot to go through.",
    "created_at": "2017-04-07T16:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312197",
    "user": "@fchapoton"
}
```

May be good now. Back to needs review. Waiting for a bot to go through.



---

archive/issue_comments_312198.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2017-04-07T16:36:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312198",
    "user": "@fchapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_312199.json:
```json
{
    "body": "ok,green bot, please review",
    "created_at": "2017-04-11T20:48:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312199",
    "user": "@fchapoton"
}
```

ok,green bot, please review



---

archive/issue_comments_312200.json:
```json
{
    "body": "I think you might want to cc some of the people who work on schemes to look at this because of the behavior change. I don't know enough about that area of math or how that code is used to say whether or not the change is likely to break stuff.",
    "created_at": "2017-04-11T22:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312200",
    "user": "@tscrim"
}
```

I think you might want to cc some of the people who work on schemes to look at this because of the behavior change. I don't know enough about that area of math or how that code is used to say whether or not the change is likely to break stuff.



---

archive/issue_comments_312201.json:
```json
{
    "body": "ok, but who are they ?",
    "created_at": "2017-04-12T06:44:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312201",
    "user": "@fchapoton"
}
```

ok, but who are they ?



---

archive/issue_comments_312202.json:
```json
{
    "body": "I agree that coercion is the right way to go (it's been on the TODO list for awhile now).\n\nAs for this change without coercion. I'm not concerned with most of the schemes files as anything being careful about where points live will be fine and those short cuts are much less intuitive when the dimension is >1. I thought the elliptic curve files used the implicit P(0,1)==0 fairly often, but it seems like all tests currently pass. Perhaps John Cremona can comment more on the elliptic curve perspective. \n\nIt might be a little more annoying to the user until we get coercion for schemes implemented, but I don't see anything wrong with the new behavior.",
    "created_at": "2017-04-12T14:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312202",
    "user": "@bhutz"
}
```

I agree that coercion is the right way to go (it's been on the TODO list for awhile now).

As for this change without coercion. I'm not concerned with most of the schemes files as anything being careful about where points live will be fine and those short cuts are much less intuitive when the dimension is >1. I thought the elliptic curve files used the implicit P(0,1)==0 fairly often, but it seems like all tests currently pass. Perhaps John Cremona can comment more on the elliptic curve perspective. 

It might be a little more annoying to the user until we get coercion for schemes implemented, but I don't see anything wrong with the new behavior.



---

archive/issue_comments_312203.json:
```json
{
    "body": "`@`cremona, any comments ?",
    "created_at": "2017-04-15T09:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312203",
    "user": "@fchapoton"
}
```

`@`cremona, any comments ?



---

archive/issue_comments_312204.json:
```json
{
    "body": "Replying to [comment:14 chapoton]:\n> `@`cremona, any comments ?\nNo. I try to avoid looking at this low level stuff so if tests still pass and it is no slower to test equality of points on elliptic curves then go ahead.",
    "created_at": "2017-04-15T13:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312204",
    "user": "@JohnCremona"
}
```

Replying to [comment:14 chapoton]:
> `@`cremona, any comments ?
No. I try to avoid looking at this low level stuff so if tests still pass and it is no slower to test equality of points on elliptic curves then go ahead.



---

archive/issue_comments_312205.json:
```json
{
    "body": "Since that is a relatively special case, I don't think it will be used that much. If it is desired, then 1-dim projective spaces from their base rings, which would be the simplest way to get the old behavior back. (At least, this is my impression from quickly looking at things.) So I'm setting a positive review and the coercion can be done on a followup ticket.",
    "created_at": "2017-04-15T16:07:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312205",
    "user": "@tscrim"
}
```

Since that is a relatively special case, I don't think it will be used that much. If it is desired, then 1-dim projective spaces from their base rings, which would be the simplest way to get the old behavior back. (At least, this is my impression from quickly looking at things.) So I'm setting a positive review and the coercion can be done on a followup ticket.



---

archive/issue_comments_312206.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-15T16:22:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312206",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_312207.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-16T11:31:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22412",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22412#issuecomment-312207",
    "user": "@vbraun"
}
```

Resolution: fixed
