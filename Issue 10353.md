# Issue 10353: Remove deprecated word objects from the pickle jar

archive/issues_010353.json:
```json
{
    "body": "Assignee: @seblabbe\n\nCC:  abmasse @saliola @nthiery\n\nThe [sage-words google code](http://code.google.com/p/sage-words/) was merged into sage-3.2.2 two years ago in December 2008 (#4653). At that time, about a dozen of objects were added in the sage pickle jar using that code.\n\nThen, in January 2009, we realized that all of our work was not that good and we started to change all the hierarchy of classes. Basically, we decided after discussions that it was better to get the mathematical classes independent of the chosen representation. This was achieved by ticket #6519 merged in sage-4.1.1 during summer 2009.\n\nTwist in the code were made to make the dozen of old word objects pickled from version < 4.1.1 still usable. As written by Franco Saliola in #6519 :\n\n\n```\nthis way, an old-style word can be unpickled, and during the unpickling, it\ngets converted to a new-style word, and the user is given a warning to re-save\nthe word\n\n[...]\n\nThis is a temporary fix: since the WordContent code is not necessary for any\nother part of Sage, it will be deleted in a few months. In the meantime, if\nthere is anyone with some saved word objects, then unpickling will work. \n```\n\n\nThose deprecation warnings now exists since more than one year, so it's now time to complete the cleaning. As I [wrote](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/440ae08a74c35df7) on sage-combinat devel mailing list in June 2010 :\n\n\n```\nI would like to remove those 6 pickled object from the pickle jar and replace\nthem with the new generation of words that got in Sage during summer 2009. This\nway, it would really make sure that we do not break the pickle of objects that\nare really used. Also, this will allow us to then clean up the code a lot,\nbecause some kind of arabesques are being done to support the old stuff...\n\nI know William prefer to keep old objects in the pickle jar, but in this case,\nI would like to remove them.... Will put time on this when I have time...\n```\n\n\nThen, William answered in the same conversation :\n\n\n```\nI do prefer keeping old pickles (that's the point of the pickle jar), but I\ndefinitely don't want to get in the way of the sage-combinatorics group, and\nunderstand that your code is under very active development.\n\nThanks for the work you're doing on cleanup!\n\nWilliam \n```\n\n\nSo let's do the cleanup now!\n\nBy the way, the current output of the unpickle testing (taken from `sage/structure/sage_object.pyx`) is ugly and will be fixed by this ticket :\n\n\n```\nsage: std = os.environ['SAGE_DATA'] + '/extcode/pickle_jar/pickle_jar.tar.bz2'\nsage: print \"x\"; sage.structure.sage_object.unpickle_all(std)\nx\n/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:\nDeprecationWarning: Your word object is saved in an old file format since\nFiniteWord_over_OrderedAlphabet is deprecated and will be deleted in a future\nversion of Sage (you can use FiniteWord_list instead). You can re-save your\nword by typing \"word.save(filename)\" to ensure that it will load in future\nversions of Sage.  #!/usr/bin/env python\n/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:\nDeprecationWarning: Your word object is saved in an old file format since\nAbstractWord is deprecated and will be deleted in a future version of Sage (you\ncan use FiniteWord_list instead). You can re-save your word by typing\n\"word.save(filename)\" to ensure that it will load in future versions of Sage.\n#!/usr/bin/env python\n/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:\nDeprecationWarning: Your word object is saved in an old file format since\nWord_over_Alphabet is deprecated and will be deleted in a future version of\nSage (you can use FiniteWord_list instead). You can re-save your word by typing\n\"word.save(filename)\" to ensure that it will load in future versions of Sage.\n#!/usr/bin/env python\n/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:\nDeprecationWarning: Your word object is saved in an old file format since\nWord_over_OrderedAlphabet is deprecated and will be deleted in a future version\nof Sage (you can use FiniteWord_list instead). You can re-save your word by\ntyping \"word.save(filename)\" to ensure that it will load in future versions of\nSage.  #!/usr/bin/env python\n/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:\nDeprecationWarning: ChristoffelWord_Lower is deprecated, use\nLowerChristoffelWord instead #!/usr/bin/env python\nSuccessfully unpickled 586 objects.\nFailed to unpickle 0 objects.\n```\n\n\nThe goal of this ticket is to remove, update or add objects to the pickle jar so that one can remove the deprecated file `sage/combinat/words/utils.py` and `sage/combinat/words/content.py`. I need more testing to do before saying what to do on each object, but the following objects will be certainly considered :\n\n- `_class__sage_combinat_lyndon_word_LyndonWords_evaluation__.sobj`\n- `_class__sage_combinat_lyndon_word_LyndonWords_nk__.sobj`\n- `_class__sage_combinat_lyndon_word_StandardBracketedLyndonWords_nk__.sobj`\n- `_class__sage_combinat_subword_Subwords_w__.sobj`\n- `_class__sage_combinat_subword_Subwords_wk__.sobj`\n- `_class__sage_combinat_words_alphabet_OrderedAlphabet_Finite__.sobj`\n- `_class__sage_combinat_words_alphabet_OrderedAlphabet_NaturalNumbers__.sobj`\n- `_class__sage_combinat_words_alphabet_OrderedAlphabet_PositiveIntegers__.sobj`\n- `_class__sage_combinat_words_morphism_WordMorphism__.sobj`\n- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping__.sobj`\n- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping_r__.sobj`\n- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_shifted__.sobj`\n- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_w1w2__.sobj`\n- `_class__sage_combinat_words_suffix_trees_ImplicitSuffixTree__.sobj`\n- `_class__sage_combinat_words_suffix_trees_SuffixTrie__.sobj`\n- `_class__sage_combinat_words_utils_Factorization__.sobj`\n- `_class__sage_combinat_words_word_AbstractWord__.sobj`\n- `_class__sage_combinat_words_word_Word_over_Alphabet__.sobj`\n- `_class__sage_combinat_words_word_Word_over_OrderedAlphabet__.sobj`\n- `_class__sage_combinat_words_word_content_WordContentFromFunction__.sobj`\n- `_class__sage_combinat_words_word_content_WordContentFromList__.sobj`\n- `_class__sage_combinat_words_word_generators_ChristoffelWord_Lower__.sobj`\n- `_class__sage_combinat_words_word_generators_WordGenerator__.sobj`\n- `_class__sage_combinat_words_words_FiniteWords_length_k_over_OrderedAlphabet__.sobj`\n- `_class__sage_combinat_words_words_FiniteWords_over_OrderedAlphabet__.sobj`\n- `_class__sage_combinat_words_words_InfiniteWords_over_OrderedAlphabet__.sobj`\n- `_class__sage_combinat_words_words_Words_n__.sobj`\n- `_class__sage_combinat_words_words_Words_over_Alphabet__.sobj`\n- `_class__sage_combinat_words_words_Words_over_OrderedAlphabet__.sobj`\n\n\nFor references, a ticket where objects were removed/updated from the pickle jar : #8911. The update was made by uploading the modified `sage/data/extcode/pickle_jar.tar.bz2` directly on the trac ticket.\n\nIssue created by migration from https://trac.sagemath.org/ticket/10354\n\n",
    "created_at": "2010-11-29T17:43:37Z",
    "labels": [
        "pickling",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "Remove deprecated word objects from the pickle jar",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10353",
    "user": "@seblabbe"
}
```
Assignee: @seblabbe

CC:  abmasse @saliola @nthiery

The [sage-words google code](http://code.google.com/p/sage-words/) was merged into sage-3.2.2 two years ago in December 2008 (#4653). At that time, about a dozen of objects were added in the sage pickle jar using that code.

Then, in January 2009, we realized that all of our work was not that good and we started to change all the hierarchy of classes. Basically, we decided after discussions that it was better to get the mathematical classes independent of the chosen representation. This was achieved by ticket #6519 merged in sage-4.1.1 during summer 2009.

Twist in the code were made to make the dozen of old word objects pickled from version < 4.1.1 still usable. As written by Franco Saliola in #6519 :


```
this way, an old-style word can be unpickled, and during the unpickling, it
gets converted to a new-style word, and the user is given a warning to re-save
the word

[...]

This is a temporary fix: since the WordContent code is not necessary for any
other part of Sage, it will be deleted in a few months. In the meantime, if
there is anyone with some saved word objects, then unpickling will work. 
```


Those deprecation warnings now exists since more than one year, so it's now time to complete the cleaning. As I [wrote](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/440ae08a74c35df7) on sage-combinat devel mailing list in June 2010 :


```
I would like to remove those 6 pickled object from the pickle jar and replace
them with the new generation of words that got in Sage during summer 2009. This
way, it would really make sure that we do not break the pickle of objects that
are really used. Also, this will allow us to then clean up the code a lot,
because some kind of arabesques are being done to support the old stuff...

I know William prefer to keep old objects in the pickle jar, but in this case,
I would like to remove them.... Will put time on this when I have time...
```


Then, William answered in the same conversation :


```
I do prefer keeping old pickles (that's the point of the pickle jar), but I
definitely don't want to get in the way of the sage-combinatorics group, and
understand that your code is under very active development.

Thanks for the work you're doing on cleanup!

William 
```


So let's do the cleanup now!

By the way, the current output of the unpickle testing (taken from `sage/structure/sage_object.pyx`) is ugly and will be fixed by this ticket :


```
sage: std = os.environ['SAGE_DATA'] + '/extcode/pickle_jar/pickle_jar.tar.bz2'
sage: print "x"; sage.structure.sage_object.unpickle_all(std)
x
/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:
DeprecationWarning: Your word object is saved in an old file format since
FiniteWord_over_OrderedAlphabet is deprecated and will be deleted in a future
version of Sage (you can use FiniteWord_list instead). You can re-save your
word by typing "word.save(filename)" to ensure that it will load in future
versions of Sage.  #!/usr/bin/env python
/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:
DeprecationWarning: Your word object is saved in an old file format since
AbstractWord is deprecated and will be deleted in a future version of Sage (you
can use FiniteWord_list instead). You can re-save your word by typing
"word.save(filename)" to ensure that it will load in future versions of Sage.
#!/usr/bin/env python
/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:
DeprecationWarning: Your word object is saved in an old file format since
Word_over_Alphabet is deprecated and will be deleted in a future version of
Sage (you can use FiniteWord_list instead). You can re-save your word by typing
"word.save(filename)" to ensure that it will load in future versions of Sage.
#!/usr/bin/env python
/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:
DeprecationWarning: Your word object is saved in an old file format since
Word_over_OrderedAlphabet is deprecated and will be deleted in a future version
of Sage (you can use FiniteWord_list instead). You can re-save your word by
typing "word.save(filename)" to ensure that it will load in future versions of
Sage.  #!/usr/bin/env python
/Users/slabbe/Applications/sage-4.6/local/bin/sage-ipython:1:
DeprecationWarning: ChristoffelWord_Lower is deprecated, use
LowerChristoffelWord instead #!/usr/bin/env python
Successfully unpickled 586 objects.
Failed to unpickle 0 objects.
```


The goal of this ticket is to remove, update or add objects to the pickle jar so that one can remove the deprecated file `sage/combinat/words/utils.py` and `sage/combinat/words/content.py`. I need more testing to do before saying what to do on each object, but the following objects will be certainly considered :

- `_class__sage_combinat_lyndon_word_LyndonWords_evaluation__.sobj`
- `_class__sage_combinat_lyndon_word_LyndonWords_nk__.sobj`
- `_class__sage_combinat_lyndon_word_StandardBracketedLyndonWords_nk__.sobj`
- `_class__sage_combinat_subword_Subwords_w__.sobj`
- `_class__sage_combinat_subword_Subwords_wk__.sobj`
- `_class__sage_combinat_words_alphabet_OrderedAlphabet_Finite__.sobj`
- `_class__sage_combinat_words_alphabet_OrderedAlphabet_NaturalNumbers__.sobj`
- `_class__sage_combinat_words_alphabet_OrderedAlphabet_PositiveIntegers__.sobj`
- `_class__sage_combinat_words_morphism_WordMorphism__.sobj`
- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping__.sobj`
- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping_r__.sobj`
- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_shifted__.sobj`
- `_class__sage_combinat_words_shuffle_product_ShuffleProduct_w1w2__.sobj`
- `_class__sage_combinat_words_suffix_trees_ImplicitSuffixTree__.sobj`
- `_class__sage_combinat_words_suffix_trees_SuffixTrie__.sobj`
- `_class__sage_combinat_words_utils_Factorization__.sobj`
- `_class__sage_combinat_words_word_AbstractWord__.sobj`
- `_class__sage_combinat_words_word_Word_over_Alphabet__.sobj`
- `_class__sage_combinat_words_word_Word_over_OrderedAlphabet__.sobj`
- `_class__sage_combinat_words_word_content_WordContentFromFunction__.sobj`
- `_class__sage_combinat_words_word_content_WordContentFromList__.sobj`
- `_class__sage_combinat_words_word_generators_ChristoffelWord_Lower__.sobj`
- `_class__sage_combinat_words_word_generators_WordGenerator__.sobj`
- `_class__sage_combinat_words_words_FiniteWords_length_k_over_OrderedAlphabet__.sobj`
- `_class__sage_combinat_words_words_FiniteWords_over_OrderedAlphabet__.sobj`
- `_class__sage_combinat_words_words_InfiniteWords_over_OrderedAlphabet__.sobj`
- `_class__sage_combinat_words_words_Words_n__.sobj`
- `_class__sage_combinat_words_words_Words_over_Alphabet__.sobj`
- `_class__sage_combinat_words_words_Words_over_OrderedAlphabet__.sobj`


For references, a ticket where objects were removed/updated from the pickle jar : #8911. The update was made by uploading the modified `sage/data/extcode/pickle_jar.tar.bz2` directly on the trac ticket.

Issue created by migration from https://trac.sagemath.org/ticket/10354





---

archive/issue_comments_106378.json:
```json
{
    "body": "Here is a pickle jar made of the objects I am adding to the pickle jar :\n\nhttp://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2",
    "created_at": "2011-01-28T19:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106378",
    "user": "@seblabbe"
}
```

Here is a pickle jar made of the objects I am adding to the pickle jar :

http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2



---

archive/issue_comments_106379.json:
```json
{
    "body": "Here is the command I am using to remove the 19 pickled object from the pickle_jar directory :\n\n\n``` \nmv _class__sage_combinat_words_morphism_WordMorphism__.sobj\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping__.sobj\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping_r__.sobj\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_shifted__.sobj\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_w1w2__.sobj\n_class__sage_combinat_words_suffix_trees_ImplicitSuffixTree__.sobj\n_class__sage_combinat_words_suffix_trees_SuffixTrie__.sobj\n_class__sage_combinat_words_utils_Factorization__.sobj\n_class__sage_combinat_words_word_AbstractWord__.sobj\n_class__sage_combinat_words_word_Word_over_Alphabet__.sobj\n_class__sage_combinat_words_word_Word_over_OrderedAlphabet__.sobj\n_class__sage_combinat_words_word_content_WordContentFromFunction__.sobj\n_class__sage_combinat_words_word_content_WordContentFromList__.sobj\n_class__sage_combinat_words_word_generators_ChristoffelWord_Lower__.sobj\n_class__sage_combinat_words_words_FiniteWords_length_k_over_OrderedAlphabet__.sobj\n_class__sage_combinat_words_words_FiniteWords_over_OrderedAlphabet__.sobj\n_class__sage_combinat_words_words_InfiniteWords_over_OrderedAlphabet__.sobj\n_class__sage_combinat_words_words_Words_over_Alphabet__.sobj\n_class__sage_combinat_words_words_Words_over_OrderedAlphabet__.sobj ../removed\n```\n\n\n\n``` \nmv _class__sage_combinat_words_morphism_WordMorphism__.txt\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping__.txt\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping_r__.txt\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_shifted__.txt\n_class__sage_combinat_words_shuffle_product_ShuffleProduct_w1w2__.txt\n_class__sage_combinat_words_suffix_trees_ImplicitSuffixTree__.txt\n_class__sage_combinat_words_suffix_trees_SuffixTrie__.txt\n_class__sage_combinat_words_utils_Factorization__.txt\n_class__sage_combinat_words_word_AbstractWord__.txt\n_class__sage_combinat_words_word_Word_over_Alphabet__.txt\n_class__sage_combinat_words_word_Word_over_OrderedAlphabet__.txt\n_class__sage_combinat_words_word_content_WordContentFromFunction__.txt\n_class__sage_combinat_words_word_content_WordContentFromList__.txt\n_class__sage_combinat_words_word_generators_ChristoffelWord_Lower__.txt\n_class__sage_combinat_words_words_FiniteWords_length_k_over_OrderedAlphabet__.txt\n_class__sage_combinat_words_words_FiniteWords_over_OrderedAlphabet__.txt\n_class__sage_combinat_words_words_InfiniteWords_over_OrderedAlphabet__.txt\n_class__sage_combinat_words_words_Words_over_Alphabet__.txt\n_class__sage_combinat_words_words_Words_over_OrderedAlphabet__.txt ../removed\n```\n",
    "created_at": "2011-01-28T19:41:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106379",
    "user": "@seblabbe"
}
```

Here is the command I am using to remove the 19 pickled object from the pickle_jar directory :


``` 
mv _class__sage_combinat_words_morphism_WordMorphism__.sobj
_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping__.sobj
_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping_r__.sobj
_class__sage_combinat_words_shuffle_product_ShuffleProduct_shifted__.sobj
_class__sage_combinat_words_shuffle_product_ShuffleProduct_w1w2__.sobj
_class__sage_combinat_words_suffix_trees_ImplicitSuffixTree__.sobj
_class__sage_combinat_words_suffix_trees_SuffixTrie__.sobj
_class__sage_combinat_words_utils_Factorization__.sobj
_class__sage_combinat_words_word_AbstractWord__.sobj
_class__sage_combinat_words_word_Word_over_Alphabet__.sobj
_class__sage_combinat_words_word_Word_over_OrderedAlphabet__.sobj
_class__sage_combinat_words_word_content_WordContentFromFunction__.sobj
_class__sage_combinat_words_word_content_WordContentFromList__.sobj
_class__sage_combinat_words_word_generators_ChristoffelWord_Lower__.sobj
_class__sage_combinat_words_words_FiniteWords_length_k_over_OrderedAlphabet__.sobj
_class__sage_combinat_words_words_FiniteWords_over_OrderedAlphabet__.sobj
_class__sage_combinat_words_words_InfiniteWords_over_OrderedAlphabet__.sobj
_class__sage_combinat_words_words_Words_over_Alphabet__.sobj
_class__sage_combinat_words_words_Words_over_OrderedAlphabet__.sobj ../removed
```



``` 
mv _class__sage_combinat_words_morphism_WordMorphism__.txt
_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping__.txt
_class__sage_combinat_words_shuffle_product_ShuffleProduct_overlapping_r__.txt
_class__sage_combinat_words_shuffle_product_ShuffleProduct_shifted__.txt
_class__sage_combinat_words_shuffle_product_ShuffleProduct_w1w2__.txt
_class__sage_combinat_words_suffix_trees_ImplicitSuffixTree__.txt
_class__sage_combinat_words_suffix_trees_SuffixTrie__.txt
_class__sage_combinat_words_utils_Factorization__.txt
_class__sage_combinat_words_word_AbstractWord__.txt
_class__sage_combinat_words_word_Word_over_Alphabet__.txt
_class__sage_combinat_words_word_Word_over_OrderedAlphabet__.txt
_class__sage_combinat_words_word_content_WordContentFromFunction__.txt
_class__sage_combinat_words_word_content_WordContentFromList__.txt
_class__sage_combinat_words_word_generators_ChristoffelWord_Lower__.txt
_class__sage_combinat_words_words_FiniteWords_length_k_over_OrderedAlphabet__.txt
_class__sage_combinat_words_words_FiniteWords_over_OrderedAlphabet__.txt
_class__sage_combinat_words_words_InfiniteWords_over_OrderedAlphabet__.txt
_class__sage_combinat_words_words_Words_over_Alphabet__.txt
_class__sage_combinat_words_words_Words_over_OrderedAlphabet__.txt ../removed
```




---

archive/issue_comments_106380.json:
```json
{
    "body": "Here is the pickle jar I suggest for replacement (removed 19 word object mentionned above and added 19 new word objects) :\n\nhttp://sage.math.washington.edu/home/slabbe/pickle_jar.tar.bz2\n\nThis new pickle jar should replace the one found here : `SAGE_ROOT/data/extcode/pickle_jar/pickle_jar.tar.bz2`.",
    "created_at": "2011-01-28T20:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106380",
    "user": "@seblabbe"
}
```

Here is the pickle jar I suggest for replacement (removed 19 word object mentionned above and added 19 new word objects) :

http://sage.math.washington.edu/home/slabbe/pickle_jar.tar.bz2

This new pickle jar should replace the one found here : `SAGE_ROOT/data/extcode/pickle_jar/pickle_jar.tar.bz2`.



---

archive/issue_comments_106381.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-01-28T20:10:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106381",
    "user": "@seblabbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_106382.json:
```json
{
    "body": "Short version: positive review for the proposed changes and the proposed patch.\n\nSlightly longer version. I dropped the provided tarball \n\n    [http://sage.math.washington.edu/home/slabbe/pickle_jar.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar.tar.bz2)\n\ninto place and tested unpickling; everything works:\n\n```\nsage: sage.structure.sage_object.unpickle_all()\nSuccessfully unpickled 586 objects.\nFailed to unpickle 0 objects.\nsage: \n```\n\nI also compared new pickle jar directory with the old (using `diff -rq`), and no other pickles were effected.",
    "created_at": "2011-02-18T20:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106382",
    "user": "@saliola"
}
```

Short version: positive review for the proposed changes and the proposed patch.

Slightly longer version. I dropped the provided tarball 

    [http://sage.math.washington.edu/home/slabbe/pickle_jar.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar.tar.bz2)

into place and tested unpickling; everything works:

```
sage: sage.structure.sage_object.unpickle_all()
Successfully unpickled 586 objects.
Failed to unpickle 0 objects.
sage: 
```

I also compared new pickle jar directory with the old (using `diff -rq`), and no other pickles were effected.



---

archive/issue_comments_106383.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-02-18T20:42:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106383",
    "user": "@saliola"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_106384.json:
```json
{
    "body": "Instead of providing a whole new pickle jar, could you make a tarball containing **only** the new pickles?  I would prefer that for merging as opposed to replacing the pickle jar as a whole.",
    "created_at": "2011-02-20T17:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106384",
    "user": "@jdemeyer"
}
```

Instead of providing a whole new pickle jar, could you make a tarball containing **only** the new pickles?  I would prefer that for merging as opposed to replacing the pickle jar as a whole.



---

archive/issue_comments_106385.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-02-20T17:55:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106385",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_106386.json:
```json
{
    "body": "Replying to [comment:11 jdemeyer]:\n> Instead of providing a whole new pickle jar, could you make a tarball containing **only** the new pickles?  I would prefer that for merging as opposed to replacing the pickle jar as a whole.\n\nAlready done. A tarball containing the new 19 pickles is here : [comment:4 comment 4]. Should Franco take a look at this tarball before putting the status back to positive review?\n\nAlso, see [comment:5 comment 5] for the command I use to remove the 19 deprecated objects from the pickle jar.",
    "created_at": "2011-02-21T14:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106386",
    "user": "@seblabbe"
}
```

Replying to [comment:11 jdemeyer]:
> Instead of providing a whole new pickle jar, could you make a tarball containing **only** the new pickles?  I would prefer that for merging as opposed to replacing the pickle jar as a whole.

Already done. A tarball containing the new 19 pickles is here : [comment:4 comment 4]. Should Franco take a look at this tarball before putting the status back to positive review?

Also, see [comment:5 comment 5] for the command I use to remove the 19 deprecated objects from the pickle jar.



---

archive/issue_comments_106387.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-02-21T14:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106387",
    "user": "@seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_106388.json:
```json
{
    "body": "Some notes about things I learned on the pickle jar during this ticket:\n\n1. Create a Sage object :\n\n\n```\nsage: w = Word(range(10))\nsage: type(w)\n<class 'sage.combinat.words.word.FiniteWord_list'>\n```\n\n\n2. Add this object to the current pickle jar:\n\n\n```\nsage: sage.structure.sage_object.picklejar(w)\n```\n\n\n3. By default, the current pickle jar is in `SAGE_ROOT/tmp/pickle_jar-4.6.1` :\n\n\n```\ncd sage-4.6.1/tmp/pickle_jar-4.6.1\nls\n_class__sage_combinat_words_word_FiniteWord_list__.sobj\n_class__sage_combinat_words_word_FiniteWord_list__.txt\n```\n\n\n4. The command to create a .tar.bz2 from a directory:\n \n\n```\ntar -jcvf archive_name.tar.bz2 directory_to_compress \n```\n",
    "created_at": "2011-02-21T15:14:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106388",
    "user": "@seblabbe"
}
```

Some notes about things I learned on the pickle jar during this ticket:

1. Create a Sage object :


```
sage: w = Word(range(10))
sage: type(w)
<class 'sage.combinat.words.word.FiniteWord_list'>
```


2. Add this object to the current pickle jar:


```
sage: sage.structure.sage_object.picklejar(w)
```


3. By default, the current pickle jar is in `SAGE_ROOT/tmp/pickle_jar-4.6.1` :


```
cd sage-4.6.1/tmp/pickle_jar-4.6.1
ls
_class__sage_combinat_words_word_FiniteWord_list__.sobj
_class__sage_combinat_words_word_FiniteWord_list__.txt
```


4. The command to create a .tar.bz2 from a directory:
 

```
tar -jcvf archive_name.tar.bz2 directory_to_compress 
```




---

archive/issue_comments_106389.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-02-21T15:49:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106389",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_106390.json:
```json
{
    "body": "Attachment [trac_10354_pickle_jar_test_fix-sl.patch](tarball://root/attachments/some-uuid/ticket10354/trac_10354_pickle_jar_test_fix-sl.patch) by @seblabbe created at 2011-03-08 18:19:51\n\nI just refreshed the patch because of conflicts with #10712 merged in sage-4.6.2.",
    "created_at": "2011-03-08T18:19:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106390",
    "user": "@seblabbe"
}
```

Attachment [trac_10354_pickle_jar_test_fix-sl.patch](tarball://root/attachments/some-uuid/ticket10354/trac_10354_pickle_jar_test_fix-sl.patch) by @seblabbe created at 2011-03-08 18:19:51

I just refreshed the patch because of conflicts with #10712 merged in sage-4.6.2.



---

archive/issue_comments_106391.json:
```json
{
    "body": "Applies over the precedent patch",
    "created_at": "2011-03-21T20:37:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106391",
    "user": "@seblabbe"
}
```

Applies over the precedent patch



---

archive/issue_comments_106392.json:
```json
{
    "body": "Attachment [trac_10354_remove_longtest-sl.patch](tarball://root/attachments/some-uuid/ticket10354/trac_10354_remove_longtest-sl.patch) by @seblabbe created at 2011-03-21 20:44:17\n\nIn a recent thread on [sage-combinat-devel](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/3690f524b5cae1a7), it was mentioned to revert the long test comment on the unpickleall test. I am fixing this here for practical reasons.\n\nThis last patch needs review (Nicolas Thierry proposed himself).\n\nS\u00e9bastien",
    "created_at": "2011-03-21T20:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106392",
    "user": "@seblabbe"
}
```

Attachment [trac_10354_remove_longtest-sl.patch](tarball://root/attachments/some-uuid/ticket10354/trac_10354_remove_longtest-sl.patch) by @seblabbe created at 2011-03-21 20:44:17

In a recent thread on [sage-combinat-devel](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/3690f524b5cae1a7), it was mentioned to revert the long test comment on the unpickleall test. I am fixing this here for practical reasons.

This last patch needs review (Nicolas Thierry proposed himself).

Sébastien



---

archive/issue_comments_106393.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-03-21T20:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106393",
    "user": "@seblabbe"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_106394.json:
```json
{
    "body": "> This last patch needs review (Nicolas Thierry proposed himself).\n\nThi\u00e9ry, sorry.",
    "created_at": "2011-03-21T20:46:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106394",
    "user": "@seblabbe"
}
```

> This last patch needs review (Nicolas Thierry proposed himself).

Thiéry, sorry.



---

archive/issue_comments_106395.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-03-21T20:47:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106395",
    "user": "@seblabbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_106396.json:
```json
{
    "body": "Replying to [comment:16 slabbe]:\n> In a recent thread on [sage-combinat-devel](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/3690f524b5cae1a7), it was mentioned to revert the long test comment on the unpickleall test. I am fixing this here for practical reasons.\n> \n> This last patch needs review (Nicolas Thi\u00e9ry proposed himself).\n\nDone. Back to positive review! (assuming the builbot is happy, which I assume it will)",
    "created_at": "2011-03-21T21:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106396",
    "user": "@nthiery"
}
```

Replying to [comment:16 slabbe]:
> In a recent thread on [sage-combinat-devel](http://groups.google.com/group/sage-combinat-devel/browse_thread/thread/3690f524b5cae1a7), it was mentioned to revert the long test comment on the unpickleall test. I am fixing this here for practical reasons.
> 
> This last patch needs review (Nicolas Thiéry proposed himself).

Done. Back to positive review! (assuming the builbot is happy, which I assume it will)



---

archive/issue_comments_106397.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-03-21T21:09:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106397",
    "user": "@nthiery"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_106398.json:
```json
{
    "body": "> Done. Back to positive review! (assuming the builbot is happy, which I assume it will\n\nIt will not be \"All tests passed!\" because the buildbot is testing the applied patches with sage-4.6.2 which still uses the old pickles. But no other error should be raised.\n\nS\u00e9bastien",
    "created_at": "2011-03-21T21:36:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106398",
    "user": "@seblabbe"
}
```

> Done. Back to positive review! (assuming the builbot is happy, which I assume it will

It will not be "All tests passed!" because the buildbot is testing the applied patches with sage-4.6.2 which still uses the old pickles. But no other error should be raised.

Sébastien



---

archive/issue_comments_106399.json:
```json
{
    "body": "The new pickles ([http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2)) are in a directory called `pickle_jar-4.6.1`.  Is there a reason for this?  If not, please fix this.",
    "created_at": "2011-03-27T14:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106399",
    "user": "@jdemeyer"
}
```

The new pickles ([http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2)) are in a directory called `pickle_jar-4.6.1`.  Is there a reason for this?  If not, please fix this.



---

archive/issue_comments_106400.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-03-27T14:02:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106400",
    "user": "@jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_106401.json:
```json
{
    "body": "> The new pickles ([http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2)) are in a directory called `pickle_jar-4.6.1`.  Is there a reason for this?  \n\nNot really. That is the default directory name when one creates pickles :\n\n\n```\nsage: import os\nsage: os.listdir(SAGE_ROOT+'/tmp')\n['COPYING.txt', 'install', 'README.txt', 'sage-README-osx.txt', 'VERSION.txt']\nsage: from sage.structure.sage_object import picklejar    \nsage: picklejar(matrix([0,1,1]))\nsage: os.listdir(SAGE_ROOT+'/tmp')\n['COPYING.txt', 'install', 'pickle_jar-4.6.2', 'README.txt', 'sage-README-osx.txt', 'VERSION.txt']\nsage: os.listdir(SAGE_ROOT+'/tmp/pickle_jar-4.6.2')\n['_type__sage_matrix_matrix_integer_dense_Matrix_integer_dense__.sobj', '_type__sage_matrix_matrix_integer_dense_Matrix_integer_dense__.txt']\n```\n\n\n> If not, please fix this.\n\nOf course, I can rename the directory `pickle_jar-4.6.1`. What name should I chose ?\n\nI think there are no documentation anywhere for adding/removing objects from the pickle jar. So, if there is anything I should do better, we should write it somewhere so that the next time, it will be done the right way.\n\nS\u00e9bastien",
    "created_at": "2011-03-27T19:03:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106401",
    "user": "@seblabbe"
}
```

> The new pickles ([http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2)) are in a directory called `pickle_jar-4.6.1`.  Is there a reason for this?  

Not really. That is the default directory name when one creates pickles :


```
sage: import os
sage: os.listdir(SAGE_ROOT+'/tmp')
['COPYING.txt', 'install', 'README.txt', 'sage-README-osx.txt', 'VERSION.txt']
sage: from sage.structure.sage_object import picklejar    
sage: picklejar(matrix([0,1,1]))
sage: os.listdir(SAGE_ROOT+'/tmp')
['COPYING.txt', 'install', 'pickle_jar-4.6.2', 'README.txt', 'sage-README-osx.txt', 'VERSION.txt']
sage: os.listdir(SAGE_ROOT+'/tmp/pickle_jar-4.6.2')
['_type__sage_matrix_matrix_integer_dense_Matrix_integer_dense__.sobj', '_type__sage_matrix_matrix_integer_dense_Matrix_integer_dense__.txt']
```


> If not, please fix this.

Of course, I can rename the directory `pickle_jar-4.6.1`. What name should I chose ?

I think there are no documentation anywhere for adding/removing objects from the pickle jar. So, if there is anything I should do better, we should write it somewhere so that the next time, it will be done the right way.

Sébastien



---

archive/issue_comments_106402.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2011-03-28T08:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106402",
    "user": "@jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_106403.json:
```json
{
    "body": "Replying to [comment:25 slabbe]:\n> > The new pickles ([http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2)) are in a directory called `pickle_jar-4.6.1`.  Is there a reason for this?  \n> \n> Not really. That is the default directory name when one creates pickles :\nOkay, point taken.  You can leave the file as it is.\n\nQuestion is: why does the default directory name for creating pickles contain the version number of Sage?  It might be better to simply use \"$SAGE_ROOT/tmp/pickle_jar\" without version number.",
    "created_at": "2011-03-28T08:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106403",
    "user": "@jdemeyer"
}
```

Replying to [comment:25 slabbe]:
> > The new pickles ([http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2](http://sage.math.washington.edu/home/slabbe/pickle_jar_new_word_objects.tar.bz2)) are in a directory called `pickle_jar-4.6.1`.  Is there a reason for this?  
> 
> Not really. That is the default directory name when one creates pickles :
Okay, point taken.  You can leave the file as it is.

Question is: why does the default directory name for creating pickles contain the version number of Sage?  It might be better to simply use "$SAGE_ROOT/tmp/pickle_jar" without version number.



---

archive/issue_comments_106404.json:
```json
{
    "body": "See #11069 for a follow-up.",
    "created_at": "2011-03-28T08:46:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106404",
    "user": "@jdemeyer"
}
```

See #11069 for a follow-up.



---

archive/issue_comments_106405.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-03-28T19:24:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106405",
    "user": "@jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_106406.json:
```json
{
    "body": "> Question is: why does the default directory name for creating pickles contain the version number of Sage?  It might be better to simply use \"$SAGE_ROOT/tmp/pickle_jar\" without version number.\n\nPersonally, I don't have argument for one or the other. But I know that Nicolas Thi\u00e9ry proposed in #10768 (Revisit the pickle jar procedure) that :\n\n\"For each version of Sage (say 4.6.2), a fresh pickle jar (say pickle_jar-4.6.2.tar.bz2) would be produced by the release manager, and *added* to the Sage distribution.\"\n\nSo if this proposition is followed, maybe version number could be kept as a default. Am I confusing the name of the directory with the name of the archive?\n\nS\u00e9bastien",
    "created_at": "2011-03-28T22:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106406",
    "user": "@seblabbe"
}
```

> Question is: why does the default directory name for creating pickles contain the version number of Sage?  It might be better to simply use "$SAGE_ROOT/tmp/pickle_jar" without version number.

Personally, I don't have argument for one or the other. But I know that Nicolas Thiéry proposed in #10768 (Revisit the pickle jar procedure) that :

"For each version of Sage (say 4.6.2), a fresh pickle jar (say pickle_jar-4.6.2.tar.bz2) would be produced by the release manager, and *added* to the Sage distribution."

So if this proposition is followed, maybe version number could be kept as a default. Am I confusing the name of the directory with the name of the archive?

Sébastien



---

archive/issue_comments_106407.json:
```json
{
    "body": "I left some comments at #10768, let's see what happens.  In any case, I propose to move the discussion to the relevant tickets: #10768 and #11069 and not anymore on this ticket.",
    "created_at": "2011-03-29T07:33:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10353",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10353#issuecomment-106407",
    "user": "@jdemeyer"
}
```

I left some comments at #10768, let's see what happens.  In any case, I propose to move the discussion to the relevant tickets: #10768 and #11069 and not anymore on this ticket.
