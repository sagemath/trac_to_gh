# Issue 23261: Ship Sebastian Pancratz's deformation code

Issue created by migration from https://trac.sagemath.org/ticket/23498

Original creator: jpflori

Original creation time: 2017-07-20 19:17:46

CC:  edgarcosta vbraun

Tarball at:
https://perso.telecom-paristech.fr/~flori/sage/deformation-0.0.0.tar.bz2

Original code from Sebastian at:
https://github.com/SPancratz/deformation/
modified by JP:
https://github.com/jpflori/deformation/


---

Comment by jpflori created at 2017-07-20 19:18:02

Changing keywords from "" to "sd87".


---

Comment by git created at 2017-07-20 19:24:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jpflori created at 2017-07-20 19:24:34

Changing status from new to needs_review.


---

Comment by git created at 2017-07-20 20:42:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2017-07-21 14:43:08

In the flint declaration file you are giving access to the precise structure of the C struct, namely

```
cdef extern from "flint/fmpz_poly.h":
    ctypedef struct fmpz_poly_struct:
        fmpz* coeffs
        long alloc
        long length
```

This not part of the public API of flint and would better be avoided in public Cython headers. Moreover, flint provides macros for accessing them. Please change to

```
cdef extern from "flint/fmpz_poly.h":
    ctypedef struct fmpz_poly_struct:
        pass
```



---

Comment by vdelecroix created at 2017-07-21 14:44:24

BTW, what these flint declarations have to do with the ticket!?


---

Comment by jpflori created at 2017-07-21 14:48:40

These changes are from #23466.
I added flint types there and cleaned up the previous pxd files a little bit.
I agree we could live without the internal data structure of flint but I did not check we never actually use them in sage.


---

Comment by jpflori created at 2017-07-21 14:50:18

(Note that I did not expand the fmpz_poly declaration, I just moved it so that it appears at a more natural place in types.pxd.)


---

Comment by git created at 2017-07-21 19:35:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by edgarcosta created at 2017-07-22 03:15:09

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-07-30 09:13:14

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2017-07-30 09:13:14

Reviewer name missing


---

Comment by jpflori created at 2017-07-30 18:39:07

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2017-08-01 22:25:05

Resolution: fixed


---

Comment by fbissey created at 2017-08-01 23:40:15

Probably need a follow up because #23179 was merged at the same time. `spkg-check` and `spkg-install` shouldn't start with `#!/usr/bin/env bash` or equivalent anymore and they shouldn't be executable (644 instead of the current 755) either.


---

Comment by jpflori created at 2017-08-08 12:47:37

And it also seems I forgot to update the ticket description with the latest tarball version.
The correct one is at:
* http://perso.telecom-paristech.fr/~flori/sage/deformation-d05941b.tar.bz2

`@`volker: can you upload the correct tarball on the mirrors? sorry about the mess...


---

Comment by jpflori created at 2017-08-09 11:24:49

Follow up for spkg-install at #23604


---

Comment by vbraun created at 2017-08-09 19:22:08

ok done
