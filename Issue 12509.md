# Issue 12509: Fix hardcoded 'g++' in Lcalc 1.23 [p9]

archive/issues_012509.json:
```json
{
    "body": "Assignee: leif\n\nCC:  rishi jdemeyer ohanar mjo\n\nKeywords: spkg CC CXX C++ compiler hard-coded\n\nThe horrible `Makefile` still uses `CC` for compiling C++ (as well as C), and hardcodes it to `g++`.\n\nThe updated spkg (p10) fixes this by using `$(CXX)` for compiling C++, and allows both `CC` and `CXX` in the `Makefile` to get overridden by their respective environment settings.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12681\n\n",
    "created_at": "2012-03-17T11:28:24Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "Fix hardcoded 'g++' in Lcalc 1.23 [p9]",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12509",
    "user": "leif"
}
```
Assignee: leif

CC:  rishi jdemeyer ohanar mjo

Keywords: spkg CC CXX C++ compiler hard-coded

The horrible `Makefile` still uses `CC` for compiling C++ (as well as C), and hardcodes it to `g++`.

The updated spkg (p10) fixes this by using `$(CXX)` for compiling C++, and allows both `CC` and `CXX` in the `Makefile` to get overridden by their respective environment settings.

Issue created by migration from https://trac.sagemath.org/ticket/12681





---

archive/issue_comments_148193.json:
```json
{
    "body": "Diff between the p9 and my p10. For reference / review only.",
    "created_at": "2012-03-17T12:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148193",
    "user": "leif"
}
```

Diff between the p9 and my p10. For reference / review only.



---

archive/issue_comments_148194.json:
```json
{
    "body": "Attachment [lcalc-1.23.p9-p10.diff](tarball://root/attachments/some-uuid/ticket12681/lcalc-1.23.p9-p10.diff) by leif created at 2012-03-17 12:20:32\n\nDiff between the (patched) Makefile of the p9 and the p10.  For reference / review only.",
    "created_at": "2012-03-17T12:20:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148194",
    "user": "leif"
}
```

Attachment [lcalc-1.23.p9-p10.diff](tarball://root/attachments/some-uuid/ticket12681/lcalc-1.23.p9-p10.diff) by leif created at 2012-03-17 12:20:32

Diff between the (patched) Makefile of the p9 and the p10.  For reference / review only.



---

archive/issue_comments_148195.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-03-17T12:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148195",
    "user": "leif"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_148196.json:
```json
{
    "body": "Attachment [Lcalc-1.23-Makefile.p9-p10.diff](tarball://root/attachments/some-uuid/ticket12681/Lcalc-1.23-Makefile.p9-p10.diff) by leif created at 2012-03-17 12:42:39\n\nI've also attached a diff between the resulting Makefiles (p9 vs. p10), for review only of course.\n\nI apologize in case there are already pending changes to the Lcalc spkg; haven't searched for such (also since the p9 is quite new).",
    "created_at": "2012-03-17T12:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148196",
    "user": "leif"
}
```

Attachment [Lcalc-1.23-Makefile.p9-p10.diff](tarball://root/attachments/some-uuid/ticket12681/Lcalc-1.23-Makefile.p9-p10.diff) by leif created at 2012-03-17 12:42:39

I've also attached a diff between the resulting Makefiles (p9 vs. p10), for review only of course.

I apologize in case there are already pending changes to the Lcalc spkg; haven't searched for such (also since the p9 is quite new).



---

archive/issue_comments_148197.json:
```json
{
    "body": "Same comment as on ratpoints: I think we should avoid adding patches unless absolutely necessary. The conditional assignment of `CC` is nice, but if we're going to do it, we should try to get it added upstream and override it the standard way in the meantime.\n\n(Using `$CXX` instead of `g++` is obviously correct; although we should report that upstream too.)",
    "created_at": "2012-03-17T15:58:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148197",
    "user": "mjo"
}
```

Same comment as on ratpoints: I think we should avoid adding patches unless absolutely necessary. The conditional assignment of `CC` is nice, but if we're going to do it, we should try to get it added upstream and override it the standard way in the meantime.

(Using `$CXX` instead of `g++` is obviously correct; although we should report that upstream too.)



---

archive/issue_comments_148198.json:
```json
{
    "body": "Replying to [comment:2 mjo]:\n> Same comment as on ratpoints: I think we should avoid adding patches unless absolutely necessary.\n\nLcalc is a special case in many ways (cf. my reply on #12682), and we have to patch the Makefile anyway (since there's still no `configure`, and therefore the Makefile is supposed to get edited).\n\nMichael Rubinstein would certainly be happy if we sent him some generic solution, but so far nobody found the time for such, as mentioned.\n\n\n\n\n> (Using `$CXX` instead of `g++` is obviously correct; although we should report that upstream too.)\n\nWe already did so, IIRC...\nBtw., haven't yet looked at the 1.3 (beta) version, which I think is still work in progress.\nWe can certainly contribute to that, although e.g. Jeroen rejected to make patches more upstream-friendly, i.e. generic (w.r.t. supporting different PARI versions).  Also took me some time to convince people to use `-lgmp` instead of `-lmpir`.",
    "created_at": "2012-03-17T17:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148198",
    "user": "leif"
}
```

Replying to [comment:2 mjo]:
> Same comment as on ratpoints: I think we should avoid adding patches unless absolutely necessary.

Lcalc is a special case in many ways (cf. my reply on #12682), and we have to patch the Makefile anyway (since there's still no `configure`, and therefore the Makefile is supposed to get edited).

Michael Rubinstein would certainly be happy if we sent him some generic solution, but so far nobody found the time for such, as mentioned.




> (Using `$CXX` instead of `g++` is obviously correct; although we should report that upstream too.)

We already did so, IIRC...
Btw., haven't yet looked at the 1.3 (beta) version, which I think is still work in progress.
We can certainly contribute to that, although e.g. Jeroen rejected to make patches more upstream-friendly, i.e. generic (w.r.t. supporting different PARI versions).  Also took me some time to convince people to use `-lgmp` instead of `-lmpir`.



---

archive/issue_comments_148199.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-03-18T00:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148199",
    "user": "ohanar"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_148200.json:
```json
{
    "body": "works well and looks good!",
    "created_at": "2012-03-18T00:36:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148200",
    "user": "ohanar"
}
```

works well and looks good!



---

archive/issue_comments_148201.json:
```json
{
    "body": "Changing keywords from \"spkg CC CXX C++ compiler hard-coded\" to \"rd2 spkg CC CXX C++ compiler hard-coded\".",
    "created_at": "2012-03-18T00:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148201",
    "user": "ohanar"
}
```

Changing keywords from "spkg CC CXX C++ compiler hard-coded" to "rd2 spkg CC CXX C++ compiler hard-coded".



---

archive/issue_comments_148202.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-03-21T22:09:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12509#issuecomment-148202",
    "user": "jdemeyer"
}
```

Resolution: fixed
