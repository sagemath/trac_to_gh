# Issue 12509: Fix hardcoded 'g++' in Lcalc 1.23 [p9]

Issue created by migration from Trac.

Original creator: leif

Original creation time: 2012-03-17 11:28:24

Assignee: leif

CC:  rishi jdemeyer ohanar mjo

Keywords: spkg CC CXX C++ compiler hard-coded

The horrible `Makefile` still uses `CC` for compiling C++ (as well as C), and hardcodes it to `g++`.

The updated spkg (p10) fixes this by using `$(CXX)` for compiling C++, and allows both `CC` and `CXX` in the `Makefile` to get overridden by their respective environment settings.


---

Comment by leif created at 2012-03-17 12:19:05

Diff between the p9 and my p10. For reference / review only.


---

Attachment

Diff between the (patched) Makefile of the p9 and the p10.  For reference / review only.


---

Comment by leif created at 2012-03-17 12:42:39

Changing status from new to needs_review.


---

Attachment

I've also attached a diff between the resulting Makefiles (p9 vs. p10), for review only of course.

I apologize in case there are already pending changes to the Lcalc spkg; haven't searched for such (also since the p9 is quite new).


---

Comment by mjo created at 2012-03-17 15:58:17

Same comment as on ratpoints: I think we should avoid adding patches unless absolutely necessary. The conditional assignment of `CC` is nice, but if we're going to do it, we should try to get it added upstream and override it the standard way in the meantime.

(Using `$CXX` instead of `g++` is obviously correct; although we should report that upstream too.)


---

Comment by leif created at 2012-03-17 17:14:14

Replying to [comment:2 mjo]:
> Same comment as on ratpoints: I think we should avoid adding patches unless absolutely necessary.

Lcalc is a special case in many ways (cf. my reply on #12682), and we have to patch the Makefile anyway (since there's still no `configure`, and therefore the Makefile is supposed to get edited).

Michael Rubinstein would certainly be happy if we sent him some generic solution, but so far nobody found the time for such, as mentioned.




> (Using `$CXX` instead of `g++` is obviously correct; although we should report that upstream too.)

We already did so, IIRC...
Btw., haven't yet looked at the 1.3 (beta) version, which I think is still work in progress.
We can certainly contribute to that, although e.g. Jeroen rejected to make patches more upstream-friendly, i.e. generic (w.r.t. supporting different PARI versions).  Also took me some time to convince people to use `-lgmp` instead of `-lmpir`.


---

Comment by ohanar created at 2012-03-18 00:36:22

Changing status from needs_review to positive_review.


---

Comment by ohanar created at 2012-03-18 00:36:22

works well and looks good!


---

Comment by ohanar created at 2012-03-18 00:50:08

Changing keywords from "spkg CC CXX C++ compiler hard-coded" to "rd2 spkg CC CXX C++ compiler hard-coded".


---

Comment by jdemeyer created at 2012-03-21 22:09:46

Resolution: fixed
