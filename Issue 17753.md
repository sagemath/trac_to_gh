# Issue 17753: Implements is_zero and is_commutative for infinity ring

archive/issues_017753.json:
```json
{
    "body": "CC:  @jplab @rwst\n\nKeywords: InfinityRing, matrix, days64\n\nInfinity ring is commutative and non-zero.\n\nBecause there is no `is_zero` and `is_commutative` method for `InfinityRing`, numerous methods fails for matrices with infinity elements. This problem came up in relation with the ticket #17798.\n\n```\nsage: m = Matrix([Infinity])\nsage: m.nrows()\n1\nsage: m.rows()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n\n[...]\nAttributeError: 'InfinityRing_class' object has no attribute 'is_zero'\n```\n\nIssue created by migration from https://trac.sagemath.org/ticket/17990\n\n",
    "closed_at": "2015-05-06T23:57:47Z",
    "created_at": "2015-03-18T21:33:18Z",
    "labels": [
        "component: calculus",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "Implements is_zero and is_commutative for infinity ring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17753",
    "user": "https://github.com/avirmaux"
}
```
CC:  @jplab @rwst

Keywords: InfinityRing, matrix, days64

Infinity ring is commutative and non-zero.

Because there is no `is_zero` and `is_commutative` method for `InfinityRing`, numerous methods fails for matrices with infinity elements. This problem came up in relation with the ticket #17798.

```
sage: m = Matrix([Infinity])
sage: m.nrows()
1
sage: m.rows()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

[...]
AttributeError: 'InfinityRing_class' object has no attribute 'is_zero'
```

Issue created by migration from https://trac.sagemath.org/ticket/17990





---

archive/issue_comments_237516.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-18T21:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237516",
    "user": "https://github.com/avirmaux"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_237517.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-03-18T21:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237517",
    "user": "https://github.com/avirmaux"
}
```

New commits:



---

archive/issue_comments_237518.json:
```json
{
    "body": "Do other systems (such as in the mission statement) even have matrices with infinity?  I *guess* the infinity ring is commutative...?",
    "created_at": "2015-03-19T02:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237518",
    "user": "https://github.com/kcrisman"
}
```

Do other systems (such as in the mission statement) even have matrices with infinity?  I *guess* the infinity ring is commutative...?



---

archive/issue_comments_237519.json:
```json
{
    "body": "Hello!\nI am not sure to understand your question. Are you looking for actual examples in sage of code using matrix for infinity elements ?\n\nThe depth of the problem of the mission statement is that the base ring of `InfinityRing` is itself. The methods rows is looking if self has the attribute is_commutative, and if not suppose that self.base_ring has it.",
    "created_at": "2015-03-19T03:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237519",
    "user": "https://github.com/avirmaux"
}
```

Hello!
I am not sure to understand your question. Are you looking for actual examples in sage of code using matrix for infinity elements ?

The depth of the problem of the mission statement is that the base ring of `InfinityRing` is itself. The methods rows is looking if self has the attribute is_commutative, and if not suppose that self.base_ring has it.



---

archive/issue_comments_237520.json:
```json
{
    "body": "Sorry, what I meant was do other math software systems such as Maple, Mathematica, Magma, ... have matrices with infinity in them?  Does anyone ever use such things?  Or should we instead disallow them?  (I'm not speaking of arrays with `NaN` values, but of matrices specifically and infinity specifically.)",
    "created_at": "2015-03-19T14:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237520",
    "user": "https://github.com/kcrisman"
}
```

Sorry, what I meant was do other math software systems such as Maple, Mathematica, Magma, ... have matrices with infinity in them?  Does anyone ever use such things?  Or should we instead disallow them?  (I'm not speaking of arrays with `NaN` values, but of matrices specifically and infinity specifically.)



---

archive/issue_comments_237521.json:
```json
{
    "body": "Coxeter matrices is an example of matrix where infinity is a possible value. See #17798.",
    "created_at": "2015-03-19T14:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237521",
    "user": "https://github.com/jplab"
}
```

Coxeter matrices is an example of matrix where infinity is a possible value. See #17798.



---

archive/issue_comments_237522.json:
```json
{
    "body": "Replying to [comment:6 jipilab]:\n> Coxeter matrices is an example of matrix where infinity is a possible value. See #17798.\n\n\nBut matrices over the infinity ring will not allow you to mix infinite entries with integers or whatever else. While\n\n```\nsage: Matrix([[SR(Infinity), 1],[2,3]])\n[+Infinity         1]\n[        2         3]\n```\nworks fine.",
    "created_at": "2015-03-19T15:57:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237522",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:6 jipilab]:
> Coxeter matrices is an example of matrix where infinity is a possible value. See #17798.


But matrices over the infinity ring will not allow you to mix infinite entries with integers or whatever else. While

```
sage: Matrix([[SR(Infinity), 1],[2,3]])
[+Infinity         1]
[        2         3]
```
works fine.



---

archive/issue_comments_237523.json:
```json
{
    "body": "Hello,\n\n```\nWe check that #17990 is fixed::\n```\nshould be\n\n```\nWe check that :trac:`17990` is fixed::\n```\n\nOn the other hand, a better solution would be to use the new category framework for that and get rid of `ParentWithGens`.\n\nVincent",
    "created_at": "2015-03-21T12:13:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237523",
    "user": "https://github.com/videlec"
}
```

Hello,

```
We check that #17990 is fixed::
```
should be

```
We check that :trac:`17990` is fixed::
```

On the other hand, a better solution would be to use the new category framework for that and get rid of `ParentWithGens`.

Vincent



---

archive/issue_comments_237524.json:
```json
{
    "body": "This ticket deals exclusively with `MatrixSpace` over `InfinityRing`, and in this case, it is `InfinityRing` that needs to become a new-style `Parent` class to fix this ticket and perhaps is the better fix IMO for `is_zero` (along with the implementation of `is_commutative`).\n\nIn parallel to this, `MatrixSpace` should become a `Parent`, and since it walks like one, it shouldn't be too hard to convert it over.\n\nFor matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution. I guess fundamentally we want a 2D array since we don't need the ground set to be a ring (it'd be `NN[oo]`), but the matrix class(es) in Sage have nice displays...",
    "created_at": "2015-03-21T15:32:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237524",
    "user": "https://github.com/tscrim"
}
```

This ticket deals exclusively with `MatrixSpace` over `InfinityRing`, and in this case, it is `InfinityRing` that needs to become a new-style `Parent` class to fix this ticket and perhaps is the better fix IMO for `is_zero` (along with the implementation of `is_commutative`).

In parallel to this, `MatrixSpace` should become a `Parent`, and since it walks like one, it shouldn't be too hard to convert it over.

For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution. I guess fundamentally we want a 2D array since we don't need the ground set to be a ring (it'd be `NN[oo]`), but the matrix class(es) in Sage have nice displays...



---

archive/issue_comments_237525.json:
```json
{
    "body": "Replying to [comment:9 tscrim]:\n> For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution.\n\n\nSo then I guess you need something like an \"Alexandroff extension functor\" that you could apply to a Parent to adjoin it an element at infinity, don't you?",
    "created_at": "2015-03-21T16:58:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237525",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:9 tscrim]:
> For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution.


So then I guess you need something like an "Alexandroff extension functor" that you could apply to a Parent to adjoin it an element at infinity, don't you?



---

archive/issue_comments_237526.json:
```json
{
    "body": "Replying to [comment:10 mmezzarobba]:\n> Replying to [comment:9 tscrim]:\n> > For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution.\n\n> \n> So then I guess you need something like an \"Alexandroff extension functor\" that you could apply to a Parent to adjoin it an element at infinity, don't you?\n\n\nIf that means given an ordered set `S`, we can add an element `oo` such that `x < oo` for all in `S`, then yes.",
    "created_at": "2015-03-21T17:02:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237526",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:10 mmezzarobba]:
> Replying to [comment:9 tscrim]:
> > For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution.

> 
> So then I guess you need something like an "Alexandroff extension functor" that you could apply to a Parent to adjoin it an element at infinity, don't you?


If that means given an ordered set `S`, we can add an element `oo` such that `x < oo` for all in `S`, then yes.



---

archive/issue_comments_237527.json:
```json
{
    "body": "Please use the trac role `:trac:`17990`` instead of just `#17990` in the doc.",
    "created_at": "2015-04-05T18:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237527",
    "user": "https://github.com/fchapoton"
}
```

Please use the trac role `:trac:`17990`` instead of just `#17990` in the doc.



---

archive/issue_comments_237528.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-05T18:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237528",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_237529.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-08T19:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237529",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_237530.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-08T19:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237530",
    "user": "https://github.com/avirmaux"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_237531.json:
```json
{
    "body": "I just merged develop and corrected the wrong reference to trac into `:trac:`17990``.",
    "created_at": "2015-04-08T19:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237531",
    "user": "https://github.com/avirmaux"
}
```

I just merged develop and corrected the wrong reference to trac into `:trac:`17990``.



---

archive/issue_comments_237532.json:
```json
{
    "body": "Replying to [comment:11 tscrim]:\n> > So then I guess you need something like an \"Alexandroff extension functor\" that you could apply to a Parent to adjoin it an element at infinity, don't you?\n\n> \n> If that means given an ordered set `S`, we can add an element `oo` such that `x < oo` for all in `S`, then yes.\n\n\nWell, the reference to Alexandroff extensions is not appropriate then, but the idea would be the same.\n\nIn any case, let me ask again: is the following really what you want?\n\n```\nsage: matrix([[Infinity], [1]])\n[               +Infinity]\n[A positive finite number]\n```",
    "created_at": "2015-04-09T07:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237532",
    "user": "https://github.com/mezzarobba"
}
```

Replying to [comment:11 tscrim]:
> > So then I guess you need something like an "Alexandroff extension functor" that you could apply to a Parent to adjoin it an element at infinity, don't you?

> 
> If that means given an ordered set `S`, we can add an element `oo` such that `x < oo` for all in `S`, then yes.


Well, the reference to Alexandroff extensions is not appropriate then, but the idea would be the same.

In any case, let me ask again: is the following really what you want?

```
sage: matrix([[Infinity], [1]])
[               +Infinity]
[A positive finite number]
```



---

archive/issue_comments_237533.json:
```json
{
    "body": "I believe not. What we wish to have is something like this:\n\n```\nsage: Matrix([[oo, 3],[2,3]])\n[+Infinity         1]\n[        2         3]\nsage: M.parent()\nFull MatrixSpace of 2 by 2 dense matrices over (NN\\cup \\{oo\\}) <--------------\n```\n\n... but this is not related to the ticket description. If the ticket is fixed, it will be enough for now.",
    "created_at": "2015-04-13T13:32:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237533",
    "user": "https://github.com/jplab"
}
```

I believe not. What we wish to have is something like this:

```
sage: Matrix([[oo, 3],[2,3]])
[+Infinity         1]
[        2         3]
sage: M.parent()
Full MatrixSpace of 2 by 2 dense matrices over (NN\cup \{oo\}) <--------------
```

... but this is not related to the ticket description. If the ticket is fixed, it will be enough for now.



---

archive/issue_events_051131.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-04-15T06:39:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17753#event-51131"
}
```



---

archive/issue_comments_237534.json:
```json
{
    "body": "Coming back to the description of the ticket, does it make sense for Infinityring to have the two methods\n\nis_zero() and is_commutative()?\n\nIMHO, the answer is yes and the patch fixes this. This is the problem raised in the ticket. Otherwise, the description should be changed to be more precise.",
    "created_at": "2015-04-29T09:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237534",
    "user": "https://github.com/jplab"
}
```

Coming back to the description of the ticket, does it make sense for Infinityring to have the two methods

is_zero() and is_commutative()?

IMHO, the answer is yes and the patch fixes this. This is the problem raised in the ticket. Otherwise, the description should be changed to be more precise.



---

archive/issue_comments_237535.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-29T15:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237535",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_237536.json:
```json
{
    "body": "Hi Aladin,\n\nCould you please do the following\n\n-add your full name as an Author,\n-make the title of the ticket reflect the addition of the two methods.\n\nThis ticket is not about matrix with Infinity, but rather about the fact that we need two methods on the infinity ring.",
    "created_at": "2015-04-29T15:56:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237536",
    "user": "https://github.com/jplab"
}
```

Hi Aladin,

Could you please do the following

-add your full name as an Author,
-make the title of the ticket reflect the addition of the two methods.

This ticket is not about matrix with Infinity, but rather about the fact that we need two methods on the infinity ring.



---

archive/issue_comments_237537.json:
```json
{
    "body": "Hey, sorry for the delay but I have been really busy these last days. I have also merged develop and corrected a few PEP8.",
    "created_at": "2015-05-03T18:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237537",
    "user": "https://github.com/avirmaux"
}
```

Hey, sorry for the delay but I have been really busy these last days. I have also merged develop and corrected a few PEP8.



---

archive/issue_comments_237538.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-03T18:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_237539.json:
```json
{
    "body": "This looks good to me.",
    "created_at": "2015-05-06T08:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237539",
    "user": "https://github.com/jplab"
}
```

This looks good to me.



---

archive/issue_comments_237540.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-05-06T08:57:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237540",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_events_051132.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-06T23:57:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17753#event-51132"
}
```



---

archive/issue_comments_237541.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-05-06T23:57:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17753",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17753#issuecomment-237541",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
