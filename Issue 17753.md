# Issue 17753: Matrix with Infinity

Issue created by migration from https://trac.sagemath.org/ticket/17990

Original creator: virmaux

Original creation time: 2015-03-18 21:33:18

CC:  jipilab rws

Keywords: InfinityRing, matrix, days64

Because there is no `is_zero` and `is_commutative` method for `InfinityRing`, a numerous methods fails for matrices with infinity elements.


```
sage: m = Matrix([Infinity])
sage: m.nrows()
1
sage: m.rows()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

[...]
AttributeError: 'InfinityRing_class' object has no attribute 'is_zero'
```



---

Comment by virmaux created at 2015-03-18 21:44:56

Changing status from new to needs_review.


---

Comment by virmaux created at 2015-03-18 21:44:56

New commits:


---

Comment by kcrisman created at 2015-03-19 02:35:33

Do other systems (such as in the mission statement) even have matrices with infinity?  I _guess_ the infinity ring is commutative...?


---

Comment by virmaux created at 2015-03-19 03:52:18

Hello!
I am not sure to understand your question. Are you looking for actual examples in sage of code using matrix for infinity elements ?

The depth of the problem of the mission statement is that the base ring of `InfinityRing` is itself. The methods rows is looking if self has the attribute is_commutative, and if not suppose that self.base_ring has it.


---

Comment by kcrisman created at 2015-03-19 14:12:45

Sorry, what I meant was do other math software systems such as Maple, Mathematica, Magma, ... have matrices with infinity in them?  Does anyone ever use such things?  Or should we instead disallow them?  (I'm not speaking of arrays with `NaN` values, but of matrices specifically and infinity specifically.)


---

Comment by jipilab created at 2015-03-19 14:32:57

Coxeter matrices is an example of matrix where infinity is a possible value. See #17798.


---

Comment by mmezzarobba created at 2015-03-19 15:57:08

Replying to [comment:6 jipilab]:
> Coxeter matrices is an example of matrix where infinity is a possible value. See #17798.

But matrices over the infinity ring will not allow you to mix infinite entries with integers or whatever else. While

```
sage: Matrix([[SR(Infinity), 1],[2,3]])
[+Infinity         1]
[        2         3]
```

works fine.


---

Comment by vdelecroix created at 2015-03-21 12:13:07

Hello,


```
We check that #17990 is fixed::
```

should be

```
We check that :trac:`17990` is fixed::
```


On the other hand, a better solution would be to use the new category framework for that and get rid of `ParentWithGens`.

Vincent


---

Comment by tscrim created at 2015-03-21 15:32:31

This ticket deals exclusively with `MatrixSpace` over `InfinityRing`, and in this case, it is `InfinityRing` that needs to become a new-style `Parent` class to fix this ticket and perhaps is the better fix IMO for `is_zero` (along with the implementation of `is_commutative`).

In parallel to this, `MatrixSpace` should become a `Parent`, and since it walks like one, it shouldn't be too hard to convert it over.

For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution. I guess fundamentally we want a 2D array since we don't need the ground set to be a ring (it'd be `NN[oo]`), but the matrix class(es) in Sage have nice displays...


---

Comment by mmezzarobba created at 2015-03-21 16:58:34

Replying to [comment:9 tscrim]:
> For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution.

So then I guess you need something like an "Alexandroff extension functor" that you could apply to a Parent to adjoin it an element at infinity, don't you?


---

Comment by tscrim created at 2015-03-21 17:02:10

Replying to [comment:10 mmezzarobba]:
> Replying to [comment:9 tscrim]:
> > For matrices with infinities, we want to construct a Coxeter matrix without the current hack of representing `oo` with `-1` (in `CoxeterMatrixGroup`), nor do we want to use the `SymbolicRing` as we feel it is way too heavy-handed of a solution.
> 
> So then I guess you need something like an "Alexandroff extension functor" that you could apply to a Parent to adjoin it an element at infinity, don't you?

If that means given an ordered set `S`, we can add an element `oo` such that `x < oo` for all in `S`, then yes.


---

Comment by chapoton created at 2015-04-05 18:44:54

Please use the trac role `:trac:`17990`` instead of just `#17990` in the doc.


---

Comment by chapoton created at 2015-04-05 18:44:54

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-04-08 19:00:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by virmaux created at 2015-04-08 19:03:09

Changing status from needs_work to needs_review.


---

Comment by virmaux created at 2015-04-08 19:03:09

I just merged develop and corrected the wrong reference to trac into `:trac:`17990``.


---

Comment by mmezzarobba created at 2015-04-09 07:01:34

Replying to [comment:11 tscrim]:
> > So then I guess you need something like an "Alexandroff extension functor" that you could apply to a Parent to adjoin it an element at infinity, don't you?
> 
> If that means given an ordered set `S`, we can add an element `oo` such that `x < oo` for all in `S`, then yes.

Well, the reference to Alexandroff extensions is not appropriate then, but the idea would be the same.

In any case, let me ask again: is the following really what you want?

```
sage: matrix([[Infinity], [1]])
[               +Infinity]
[A positive finite number]
```



---

Comment by jipilab created at 2015-04-13 13:32:52

I believe not. What we wish to have is something like this:


```
sage: Matrix([[oo, 3],[2,3]])
[+Infinity         1]
[        2         3]
sage: M.parent()
Full MatrixSpace of 2 by 2 dense matrices over (NN\cup \{oo\}) <--------------
```


... but this is not related to the ticket description. If the ticket is fixed, it will be enough for now.


---

Comment by jipilab created at 2015-04-29 09:54:39

Coming back to the description of the ticket, does it make sense for Infinityring to have the two methods

is_zero() and is_commutative()?

IMHO, the answer is yes and the patch fixes this. This is the problem raised in the ticket. Otherwise, the description should be changed to be more precise.


---

Comment by jipilab created at 2015-04-29 15:56:41

Changing status from needs_review to needs_work.


---

Comment by jipilab created at 2015-04-29 15:56:41

Hi Aladin,

Could you please do the following

-add your full name as an Author,
-make the title of the ticket reflect the addition of the two methods.

This ticket is not about matrix with Infinity, but rather about the fact that we need two methods on the infinity ring.


---

Comment by virmaux created at 2015-05-03 18:19:16

Hey, sorry for the delay but I have been really busy these last days. I have also merged develop and corrected a few PEP8.


---

Comment by git created at 2015-05-03 18:25:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jipilab created at 2015-05-06 08:57:37

This looks good to me.


---

Comment by jipilab created at 2015-05-06 08:57:37

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2015-05-06 23:57:47

Resolution: fixed
