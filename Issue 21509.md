# Issue 21509: overflow for vector mod2 dense

archive/issues_021509.json:
```json
{
    "body": "\n```\nsage: VS = VectorSpace(GF(2),1)\nsage: VS([2**64])\nTraceback (most recent call last):\n...\nOverflowError: Python int too large to convert to C long\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/21746\n\n",
    "created_at": "2016-10-23T13:04:04Z",
    "labels": [
        "linear algebra",
        "major",
        "bug"
    ],
    "title": "overflow for vector mod2 dense",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21509",
    "user": "vdelecroix"
}
```

```
sage: VS = VectorSpace(GF(2),1)
sage: VS([2**64])
Traceback (most recent call last):
...
OverflowError: Python int too large to convert to C long
```


Issue created by migration from https://trac.sagemath.org/ticket/21746





---

archive/issue_comments_298549.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-10-23T13:17:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298549",
    "user": "vdelecroix"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_298550.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-23T13:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298550",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_298551.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-23T18:56:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298551",
    "user": "jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_298552.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2016-10-25T16:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298552",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_298553.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2016-10-25T16:47:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298553",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_298554.json:
```json
{
    "body": "Fixed doctest failure in `coding/`. Needs review again.",
    "created_at": "2016-10-25T16:48:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298554",
    "user": "vdelecroix"
}
```

Fixed doctest failure in `coding/`. Needs review again.



---

archive/issue_comments_298555.json:
```json
{
    "body": "This branch does result in ~10% slowdown:\n\n```\nsage: V = VectorSpace(GF(2), 2^10)\nsage: %timeit V([1]*(2^10))\nThe slowest run took 5.95 times longer than the fastest. This could mean that an intermediate result is being cached.\n10000 loops, best of 3: 49.8 \u00b5s per loop\n```\n\nBefore:\n\n```\nsage: V = VectorSpace(GF(2), 2^10)\nsage: %timeit V([1]*(2^10))\nThe slowest run took 5.69 times longer than the fastest. This could mean that an intermediate result is being cached.\n10000 loops, best of 3: 45.8 \u00b5s per loop\n```\n\nHowever, changing the for loop over `enumerate` back to `for i from 0 <= i < self._degree:` and setting `xi = x[i]` doesn't have a noticeable impact. So I think we have to deal with this.\n\nI do have one nitpick: change the `ZeroDivisionError` to start with a lowercase. Once that is done, you can put this back to a positive review.",
    "created_at": "2016-10-25T22:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298555",
    "user": "tscrim"
}
```

This branch does result in ~10% slowdown:

```
sage: V = VectorSpace(GF(2), 2^10)
sage: %timeit V([1]*(2^10))
The slowest run took 5.95 times longer than the fastest. This could mean that an intermediate result is being cached.
10000 loops, best of 3: 49.8 µs per loop
```

Before:

```
sage: V = VectorSpace(GF(2), 2^10)
sage: %timeit V([1]*(2^10))
The slowest run took 5.69 times longer than the fastest. This could mean that an intermediate result is being cached.
10000 loops, best of 3: 45.8 µs per loop
```

However, changing the for loop over `enumerate` back to `for i from 0 <= i < self._degree:` and setting `xi = x[i]` doesn't have a noticeable impact. So I think we have to deal with this.

I do have one nitpick: change the `ZeroDivisionError` to start with a lowercase. Once that is done, you can put this back to a positive review.



---

archive/issue_comments_298556.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-26T07:19:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298556",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_298557.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-10-26T07:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298557",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_298558.json:
```json
{
    "body": "Thanks for the timings!\n\nI removed the enumerate and also did some cleaning in the case `x = 0`. This code is completely useless\n\n```\nfor i from 0 <= i < self._degree:\n    mzd_set_ui(self._entries, 0)\n```\n",
    "created_at": "2016-10-26T07:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298558",
    "user": "vdelecroix"
}
```

Thanks for the timings!

I removed the enumerate and also did some cleaning in the case `x = 0`. This code is completely useless

```
for i from 0 <= i < self._degree:
    mzd_set_ui(self._entries, 0)
```




---

archive/issue_comments_298559.json:
```json
{
    "body": "The `enumerate` is optimized by Cython, so no need to remove it!",
    "created_at": "2016-10-26T11:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298559",
    "user": "jdemeyer"
}
```

The `enumerate` is optimized by Cython, so no need to remove it!



---

archive/issue_comments_298560.json:
```json
{
    "body": "I realize the phrasing in my comment was somewhat vague too; I meant we have to just live with the slowdown. I did come to the conclusion that `enumerate` was likely optimized by Cython, but it is good to know. Anyways, removing it is a net-zero change, so I'm setting this back to a positive review.",
    "created_at": "2016-10-26T14:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298560",
    "user": "tscrim"
}
```

I realize the phrasing in my comment was somewhat vague too; I meant we have to just live with the slowdown. I did come to the conclusion that `enumerate` was likely optimized by Cython, but it is good to know. Anyways, removing it is a net-zero change, so I'm setting this back to a positive review.



---

archive/issue_comments_298561.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-26T14:54:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298561",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_298562.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-10-30T14:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298562",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_298563.json:
```json
{
    "body": "segfault galore... see patchbot",
    "created_at": "2016-10-30T14:15:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298563",
    "user": "vbraun"
}
```

segfault galore... see patchbot



---

archive/issue_comments_298564.json:
```json
{
    "body": "Indeed. I am able to reproduce it with the shorter\n\n```\nsage: (GF(2)**0).zero_vector()\n```\n",
    "created_at": "2016-10-30T14:59:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298564",
    "user": "vdelecroix"
}
```

Indeed. I am able to reproduce it with the shorter

```
sage: (GF(2)**0).zero_vector()
```




---

archive/issue_comments_298565.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-10-30T15:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298565",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_298566.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-10-30T15:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298566",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_298567.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-10-30T22:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298567",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_298568.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-11-02T19:20:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21509",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21509#issuecomment-298568",
    "user": "vbraun"
}
```

Resolution: fixed
