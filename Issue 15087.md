# Issue 15087: Docbuilder issue with LinearMatroid

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2013-10-25 08:57:51

CC:  stefan vbraun

Sometimes, `make doc` yields

```
Traceback (most recent call last):
  File "/scratch/release/merger/sage-5.13.beta2/devel/sage/doc/common/builder.py", line 1452, in <module>
    getattr(get_builder(name), type)()
  File "/scratch/release/merger/sage-5.13.beta2/devel/sage/doc/common/builder.py", line 269, in _wrapper
    getattr(get_builder(document), 'inventory')(*args, **kwds)
  File "/scratch/release/merger/sage-5.13.beta2/devel/sage/doc/common/builder.py", line 472, in _wrapper
    pool.map_async(build_ref_doc, L, 1).get(99999)
  File "/scratch/release/merger/sage-5.13.beta2/local/lib/python/multiprocessing/pool.py", line 554, in get
    raise self._value
AttributeError: 'module' object has no attribute 'LinearMatroid'
make: *** [doc-html] Error 1
```



---

Comment by Stefan created at 2013-10-25 13:53:58

I *think* I know what causes this (an import in sage.matroids.utilities), but I'll do a thorough review of the imports in sage.matroids so this is the last ticket of its kind.

For the record, we started seeing these things when we moved to lazy_import in sage.matroids.all. Before, everything would be imported in a "safe" order at startup. Now it's possible to import things in a different order, and these circular imports are coming to light. It's probably a good thing, I guess.


---

Comment by Stefan created at 2013-10-25 15:04:33

To reproduce, we can use Volker's trick from the last ticket:


```
sage: from sage.matroids.linear_matroid import LinearMatroid
```



---

Attachment

Ok, this should fix it. There are no more circular imports in sage.matroids (all the ones that used to be there are now imported at method level). Doctests pass.


---

Comment by Stefan created at 2013-10-25 21:20:04

Changing status from new to needs_review.


---

Comment by jdemeyer created at 2013-10-31 09:33:59

Resolution: fixed


---

Comment by jdemeyer created at 2013-10-31 09:33:59

The patch looks sensible to me.
