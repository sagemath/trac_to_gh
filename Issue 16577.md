# Issue 16577: Add SAGE_PROFILE to enable profiler

Issue created by migration from Trac.

Original creator: vbraun

Original creation time: 2014-08-13 17:13:49

CC:  mraum jdemeyer novoselt




---

Comment by vbraun created at 2014-08-13 17:35:24

New commits:


---

Comment by vbraun created at 2014-08-13 17:35:36

Changing status from new to needs_review.


---

Comment by mraum created at 2014-08-14 09:10:29

This, it seems, gives only the filename, e.g. integer.pyx.  Is it possible to modify the profiling so that we get the full path?


---

Comment by vbraun created at 2014-08-14 10:32:28

Its certainly possible, but I have no intention of modifying the way cProfile works.


---

Comment by vbraun created at 2014-08-14 11:05:50

PS: https://docs.python.org/2/library/profile.html#pstats.Stats.strip_dirs


---

Comment by mraum created at 2014-08-14 14:03:31

I investigated on this. It's not an issue of cProfile. Rather Cython must be changed. Line 688 of Cython/Compiler/ModuleNode.py one has to put os.path.abspath. Such a change would be really useful for citation management. How big, do you think, are chances that we have a downstream patch or upstream accepts such a change?


---

Comment by mmezzarobba created at 2014-08-14 14:16:54

How about including a note on how to profile a single Cython module (perhaps a link to http://docs.cython.org/src/tutorial/profiling_tutorial.html)?


---

Comment by mraum created at 2014-08-14 14:19:40

That's a nice suggestion, and we should indeed include such a note.

As for citation management (see #16777), the burden to the user to obtain correct citations for the code that he or she uses should not be excessively high. That's why I'm looking for a nice way to get the full module path.


---

Comment by vbraun created at 2014-08-14 14:56:54

The link to the cython tutorial has no place in the installation instructions. But you are welcome to write more on Cython debugging and profiling  in the developer guide. On another ticket, ideally.


---

Comment by mraum created at 2014-08-14 14:58:22

You're absoultely right. The purpose of this ticket is to add an environment variable. And this change looks good.


---

Comment by mraum created at 2014-08-14 14:58:22

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-08-14 15:10:31

For citation management (re)compiling Sage is probably too much of a burden. This will exclude everybody with a system-wide Sage installation, for starters. 

Have you thought about inspecting memory? Any third-party interface will create objects, so thats an easy place to look at what changed. You could temporarily disable gc if you worry about them being collected too early.


---

Comment by vbraun created at 2014-08-16 07:52:24

Resolution: fixed
