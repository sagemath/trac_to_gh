# Issue 22719: p-adic completions/Henselizations backed by exact rings

archive/issues_022719.json:
```json
{
    "body": "CC:  roed caruso\n\nAll p-adic rings currently available in Sage are backed by elements that consist of an approximation and a precision. It can sometimes be tedious to work with such elements since error propagation needs to be analyzed and many algorithms in Sage don't play nice with such inexact elements.\n\nThis ticket implements an exact alternative where p-adic rings are backed by absolute number fields. The idea is to use exact elements in number fields where possible and describe algebraic elements as limits of Mac Lane valuations (see #21869). Since computations in number fields (and in particular in relative extensions) are slow in Sage, extensions are always rewritten as isomorphic rings defined by an absolute number field with defining (Eisenstein) polynomials with small coefficients.\n\nA prototype of this exists as a standalone project https://github.com/saraedum/completion. The idea of this ticket is not necessarily to get this prototype into Sage but to track the few things that need to change in Sage for it to work (fast).\n\nOne can of course not expect arithmetic to be as fast as in the inexact p-adic rings but the approach seems to have its merits. With a few tweaks in Sage, this implementation can compute the degree 384 splitting field (unramified of degree 2) of a degree 12 polynomial over Q2 in less than three minutes.\n\n**Required changes to Sage** (that can not be monkey-patched, the ones in parentheses are for better performance):\n1. Polynomials should not require coefficients to implement `__nonzero__` for printing.\n2. `PolynomialQuotientRing` should be a unique parent.\n3. (`is_irreducible` should be cached)\n4. (`is_irreducible` should be able to call `_is_irreducible_univariate_polynomial` on the base ring.)\n5. (`is_squarefree` should be able to call `_is_squarefree_univariate_polynomial` on the base ring.)\n6. (Ideal generators should be more stable (i.e., the generator of a principal ideal should be exactly the element that was used to create that ideal))\n7. (`gcd(a,a) is a` should be true for polynomials over number fields.)\n\nIssue created by migration from https://trac.sagemath.org/ticket/22956\n\n",
    "created_at": "2017-05-06T23:11:42Z",
    "labels": [
        "padics",
        "major",
        "enhancement"
    ],
    "title": "p-adic completions/Henselizations backed by exact rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22719",
    "user": "saraedum"
}
```
CC:  roed caruso

All p-adic rings currently available in Sage are backed by elements that consist of an approximation and a precision. It can sometimes be tedious to work with such elements since error propagation needs to be analyzed and many algorithms in Sage don't play nice with such inexact elements.

This ticket implements an exact alternative where p-adic rings are backed by absolute number fields. The idea is to use exact elements in number fields where possible and describe algebraic elements as limits of Mac Lane valuations (see #21869). Since computations in number fields (and in particular in relative extensions) are slow in Sage, extensions are always rewritten as isomorphic rings defined by an absolute number field with defining (Eisenstein) polynomials with small coefficients.

A prototype of this exists as a standalone project https://github.com/saraedum/completion. The idea of this ticket is not necessarily to get this prototype into Sage but to track the few things that need to change in Sage for it to work (fast).

One can of course not expect arithmetic to be as fast as in the inexact p-adic rings but the approach seems to have its merits. With a few tweaks in Sage, this implementation can compute the degree 384 splitting field (unramified of degree 2) of a degree 12 polynomial over Q2 in less than three minutes.

**Required changes to Sage** (that can not be monkey-patched, the ones in parentheses are for better performance):
1. Polynomials should not require coefficients to implement `__nonzero__` for printing.
2. `PolynomialQuotientRing` should be a unique parent.
3. (`is_irreducible` should be cached)
4. (`is_irreducible` should be able to call `_is_irreducible_univariate_polynomial` on the base ring.)
5. (`is_squarefree` should be able to call `_is_squarefree_univariate_polynomial` on the base ring.)
6. (Ideal generators should be more stable (i.e., the generator of a principal ideal should be exactly the element that was used to create that ideal))
7. (`gcd(a,a) is a` should be true for polynomials over number fields.)

Issue created by migration from https://trac.sagemath.org/ticket/22956





---

archive/issue_comments_317208.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd86.5\".",
    "created_at": "2017-06-07T15:59:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22719",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22719#issuecomment-317208",
    "user": "saraedum"
}
```

Changing keywords from "" to "sd86.5".



---

archive/issue_comments_317209.json:
```json
{
    "body": "Changing keywords from \"sd86.5\" to \"sd86.5, sd87\".",
    "created_at": "2017-07-17T17:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22719",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22719#issuecomment-317209",
    "user": "roed"
}
```

Changing keywords from "sd86.5" to "sd86.5, sd87".



---

archive/issue_comments_317210.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2018-04-23T10:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22719",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22719#issuecomment-317210",
    "user": "saraedum"
}
```

Last 10 new commits:



---

archive/issue_comments_317211.json:
```json
{
    "body": "Changing keywords from \"sd86.5, sd87\" to \"sd86.5, sd87, padicIMA\".",
    "created_at": "2018-07-22T20:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22719",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22719#issuecomment-317211",
    "user": "roed"
}
```

Changing keywords from "sd86.5, sd87" to "sd86.5, sd87, padicIMA".



---

archive/issue_comments_317212.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2018-07-22T20:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22719",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22719#issuecomment-317212",
    "user": "roed"
}
```

Last 10 new commits:
