# Issue 29226: homebrew-macos-standard: Fix Fortran-related doctest errors

Issue created by migration from https://trac.sagemath.org/ticket/29463

Original creator: mkoeppe

Original creation time: 2020-04-04 13:27:40

CC:  jhpalmieri isuruf dimpase

From #29451:

https://github.com/mkoeppe/sage/runs/559191935

```
----------------------------------------------------------------------
sage -t src/sage/interfaces/gap.py  # 1 doctest failed
sage -t src/sage/misc/inline_fortran.py  # 3 doctests failed
sage -t src/sage/misc/persist.pyx  # 2 doctests failed
sage -t src/sage/repl/ipython_extension.py  # 4 doctests failed
----------------------------------------------------------------------
```



```
      File "/Users/runner/runners/2.165.2/work/sage/sage/.tox/local-homebrew-macos-standard/local/lib/python3.7/site-packages/sage/misc/inline_fortran.py", line 194, in eval
        "failed to compile Fortran code:\n{}".format(exc.output))
    RuntimeError: failed to compile Fortran code:
    b'Could not locate executable g++ -std=gnu++11 -pthread -bundle -undefined dynamic_lookup\nIn file included from /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmpjff9tknw/src.macosx-10.15-x86_64-3.7/fortran_modulemodule.c:16:\nIn file included from /var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T/tmpjff9tknw/src.macosx-10.15-x86_64-3.7/fortranobject.h:13:\nIn file included from 
```


To reproduce (with #29417):

```
 tox -e local-homebrew-macos-standard -- ptest 
```




---

Comment by mkoeppe created at 2020-04-09 03:59:28

Should check if the fix in #29408 fixes any of these too.


---

Comment by mkoeppe created at 2020-04-09 03:59:40

Tests at https://github.com/mkoeppe/sage/actions/runs/73955490


---

Comment by jhpalmieri created at 2020-04-09 19:00:19

The fix in #29408 works at least with the OS X Python installation. When I say "works," I mean that all tests pass. I did, however, twice see a dialog box saying "Python quit unexpectedly."

I will also try with Homebrew's Python.


---

Comment by jhpalmieri created at 2020-04-09 23:28:09

Same behavior with Homebrew's Python. So if #29408 gets a positive review, we can close this.


---

Comment by mkoeppe created at 2020-04-09 23:37:58

Replying to [comment:3 jhpalmieri]:
> The fix in #29408 works at least with the OS X Python installation. When I say "works," I mean that all tests pass. I did, however, twice see a dialog box saying "Python quit unexpectedly."
Yes, I have seen this too on my machine.  My guess is that we have some tests that crash some python process deliberately


---

Comment by jhpalmieri created at 2020-04-10 00:08:35

Oh, yes, that makes sense.


---

Comment by mkoeppe created at 2020-04-15 03:24:46

Changing priority from critical to blocker.


---

Comment by mkoeppe created at 2020-04-15 19:43:47

Still present on 9.1.rc0 because #29408 is not merged


---

Comment by jhpalmieri created at 2020-04-18 21:57:18

Can now be closed, I think.


---

Comment by mkoeppe created at 2020-04-18 22:51:30

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2020-04-18 23:39:46

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-05-06 16:50:00

Resolution: duplicate
