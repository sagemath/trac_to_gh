# Issue 29756: Enable MathJax in the TOC of Sage reference manual

archive/issues_029756.json:
```json
{
    "body": "CC:  slelievre jhpalmieri\n\nWe do that, and reorganize the TOC a bit while we are at it.\n\nIn particular, the plane and space curves section is split away from elliptic and hyperelliptic curves section.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29993\n\n",
    "created_at": "2020-06-26T07:48:33Z",
    "labels": [
        "documentation",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Enable MathJax in the TOC of Sage reference manual",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29756",
    "user": "klee"
}
```
CC:  slelievre jhpalmieri

We do that, and reorganize the TOC a bit while we are at it.

In particular, the plane and space curves section is split away from elliptic and hyperelliptic curves section.

Issue created by migration from https://trac.sagemath.org/ticket/29993





---

archive/issue_comments_422671.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-26T07:51:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422671",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422672.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-06-26T07:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422672",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_422673.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-06-26T07:58:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422673",
    "user": "klee"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_422674.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-06-30T06:23:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422674",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_422675.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-07-09T07:14:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422675",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_422676.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-07-29T05:29:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422676",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_422677.json:
```json
{
    "body": "Fails to merge.",
    "created_at": "2020-08-11T03:46:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422677",
    "user": "jhpalmieri"
}
```

Fails to merge.



---

archive/issue_comments_422678.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-11T03:46:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422678",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_422679.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-08-11T08:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422679",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_422680.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-11T08:18:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422680",
    "user": "klee"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_422681.json:
```json
{
    "body": "Is there a reason why we want to enable mathjax on the TOC? Maybe the idea is that perhaps we have been omitting putting tex in the TOC before for some reason, and now we can? Or is there perhaps a particular reason?",
    "created_at": "2020-08-11T20:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422681",
    "user": "DavidLowry"
}
```

Is there a reason why we want to enable mathjax on the TOC? Maybe the idea is that perhaps we have been omitting putting tex in the TOC before for some reason, and now we can? Or is there perhaps a particular reason?



---

archive/issue_comments_422682.json:
```json
{
    "body": "It looks okay to me. I don't understand the changes in the themes; can you explain those?",
    "created_at": "2020-08-11T23:21:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422682",
    "user": "jhpalmieri"
}
```

It looks okay to me. I don't understand the changes in the themes; can you explain those?



---

archive/issue_comments_422683.json:
```json
{
    "body": "Replying to [comment:16 DavidLowry]:\n> Is there a reason why we want to enable mathjax on the TOC? Maybe the idea is that perhaps we have been omitting putting tex in the TOC before for some reason, and now we can? Or is there perhaps a particular reason?\n\nThere have been maths in the TOC, like p-adic and SL_2(Z). I guess they were not in tex just because mathjax didn't work. This ticket solves the problem.",
    "created_at": "2020-08-16T07:06:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422683",
    "user": "klee"
}
```

Replying to [comment:16 DavidLowry]:
> Is there a reason why we want to enable mathjax on the TOC? Maybe the idea is that perhaps we have been omitting putting tex in the TOC before for some reason, and now we can? Or is there perhaps a particular reason?

There have been maths in the TOC, like p-adic and SL_2(Z). I guess they were not in tex just because mathjax didn't work. This ticket solves the problem.



---

archive/issue_comments_422684.json:
```json
{
    "body": "Replying to [comment:17 jhpalmieri]:\n> It looks okay to me. I don't understand the changes in the themes; can you explain those? \n\nI split arithmetic geometry (elliptic and hyperelliptic curves) from algebraic geometry (plane and space curves). Other than this, the changes are minor and rephrasings.\n\nIf you have better suggestions on the changes, let me know.",
    "created_at": "2020-08-16T07:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422684",
    "user": "klee"
}
```

Replying to [comment:17 jhpalmieri]:
> It looks okay to me. I don't understand the changes in the themes; can you explain those? 

I split arithmetic geometry (elliptic and hyperelliptic curves) from algebraic geometry (plane and space curves). Other than this, the changes are minor and rephrasings.

If you have better suggestions on the changes, let me know.



---

archive/issue_comments_422685.json:
```json
{
    "body": "Replying to [comment:16 DavidLowry]:\n> Maybe the idea is that perhaps we have been omitting putting tex in the TOC before for some reason...\n\nThe pdf doc of the TOC does not still render the maths correctly with this ticket. That might be one of the reasons.",
    "created_at": "2020-08-16T09:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422685",
    "user": "klee"
}
```

Replying to [comment:16 DavidLowry]:
> Maybe the idea is that perhaps we have been omitting putting tex in the TOC before for some reason...

The pdf doc of the TOC does not still render the maths correctly with this ticket. That might be one of the reasons.



---

archive/issue_comments_422686.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-08-16T09:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422686",
    "user": "klee"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_422687.json:
```json
{
    "body": "Replying to [comment:19 klee]:\n> Replying to [comment:17 jhpalmieri]:\n> > It looks okay to me. I don't understand the changes in the themes; can you explain those? \n> \n> I split arithmetic geometry (elliptic and hyperelliptic curves) from algebraic geometry (plane and space curves). Other than this, the changes are minor and rephrasings.\n> \n> If you have better suggestions on the changes, let me know.\n\nSorry, my question was about the changes to the two files `layout.html`.",
    "created_at": "2020-08-16T16:29:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422687",
    "user": "jhpalmieri"
}
```

Replying to [comment:19 klee]:
> Replying to [comment:17 jhpalmieri]:
> > It looks okay to me. I don't understand the changes in the themes; can you explain those? 
> 
> I split arithmetic geometry (elliptic and hyperelliptic curves) from algebraic geometry (plane and space curves). Other than this, the changes are minor and rephrasings.
> 
> If you have better suggestions on the changes, let me know.

Sorry, my question was about the changes to the two files `layout.html`.



---

archive/issue_comments_422688.json:
```json
{
    "body": "Replying to [comment:21 jhpalmieri]:\n> Replying to [comment:19 klee]:\n> > Replying to [comment:17 jhpalmieri]:\n> > > It looks okay to me. I don't understand the changes in the themes; can you explain those? \n> > \n> > I split arithmetic geometry (elliptic and hyperelliptic curves) from algebraic geometry (plane and space curves). Other than this, the changes are minor and rephrasings.\n> > \n> > If you have better suggestions on the changes, let me know.\n> \n> Sorry, my question was about the changes to the two files `layout.html`.\n\nAh! They are actually bug fixes. Look at this page:\n\nhttps://doc.sagemath.org/html/en/reference/arithgroup/index.html\n\nThe vertical line, called sidebar toggle, separating the search box on the left and the main content on the right has wrong height and looks ugly.\n\nThe changes do the right job to compute the height of the sidebar toggle.",
    "created_at": "2020-08-18T21:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422688",
    "user": "klee"
}
```

Replying to [comment:21 jhpalmieri]:
> Replying to [comment:19 klee]:
> > Replying to [comment:17 jhpalmieri]:
> > > It looks okay to me. I don't understand the changes in the themes; can you explain those? 
> > 
> > I split arithmetic geometry (elliptic and hyperelliptic curves) from algebraic geometry (plane and space curves). Other than this, the changes are minor and rephrasings.
> > 
> > If you have better suggestions on the changes, let me know.
> 
> Sorry, my question was about the changes to the two files `layout.html`.

Ah! They are actually bug fixes. Look at this page:

https://doc.sagemath.org/html/en/reference/arithgroup/index.html

The vertical line, called sidebar toggle, separating the search box on the left and the main content on the right has wrong height and looks ugly.

The changes do the right job to compute the height of the sidebar toggle.



---

archive/issue_comments_422689.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-08-20T09:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422689",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_422690.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-20T09:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422690",
    "user": "klee"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_422691.json:
```json
{
    "body": "Replying to [comment:20 klee]:\n> The pdf doc of the TOC does not still render the maths correctly with this ticket. That might be one of the reasons.\n\nThis is fixed now, by somewhat ad-hoc manner.\n\nAlong the way, I also resurrected the Sage reference manual website for pdfs, which has been broken (I might be guilty for this).",
    "created_at": "2020-08-20T09:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422691",
    "user": "klee"
}
```

Replying to [comment:20 klee]:
> The pdf doc of the TOC does not still render the maths correctly with this ticket. That might be one of the reasons.

This is fixed now, by somewhat ad-hoc manner.

Along the way, I also resurrected the Sage reference manual website for pdfs, which has been broken (I might be guilty for this).



---

archive/issue_comments_422692.json:
```json
{
    "body": "Would you mind changing `:math:`e^\\pi+1=0`` to `:math:`e^{i\\pi}+1=0``? And I think I would call the line `\\(s=\\frac{1}{2}+it\\)` just a \"line\", not an \"imaginary line\".",
    "created_at": "2020-08-20T17:54:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422692",
    "user": "jhpalmieri"
}
```

Would you mind changing `:math:`e^\pi+1=0`` to `:math:`e^{i\pi}+1=0``? And I think I would call the line `\(s=\frac{1}{2}+it\)` just a "line", not an "imaginary line".



---

archive/issue_comments_422693.json:
```json
{
    "body": "Replying to [comment:26 jhpalmieri]:\n> Would you mind changing `:math:`e^\\pi+1=0`` to `:math:`e^{i\\pi}+1=0``? \n\nOf course, not. Thank you.\n\n> And I think I would call the line `\\(s=\\frac{1}{2}+it\\)` just a \"line\", not an \"imaginary line\".\n\nOkay.",
    "created_at": "2020-08-21T00:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422693",
    "user": "klee"
}
```

Replying to [comment:26 jhpalmieri]:
> Would you mind changing `:math:`e^\pi+1=0`` to `:math:`e^{i\pi}+1=0``? 

Of course, not. Thank you.

> And I think I would call the line `\(s=\frac{1}{2}+it\)` just a "line", not an "imaginary line".

Okay.



---

archive/issue_comments_422694.json:
```json
{
    "body": "To check the documentation website for pdf docs, run:\n\n```\nsage --docbuild reference pdf\nsage --docbuild website html\n```\n\nand open `local/share/doc/sage/html/en/index.html`.\n\nRunning\n\n```\nsage --docbuild website pdf\n```\n\ngenerates a not-so-useful file  `local/share/doc/sage/pdf/en/website/sage_documentation.pdf`.",
    "created_at": "2020-08-21T01:02:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422694",
    "user": "klee"
}
```

To check the documentation website for pdf docs, run:

```
sage --docbuild reference pdf
sage --docbuild website html
```

and open `local/share/doc/sage/html/en/index.html`.

Running

```
sage --docbuild website pdf
```

generates a not-so-useful file  `local/share/doc/sage/pdf/en/website/sage_documentation.pdf`.



---

archive/issue_comments_422695.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-21T01:03:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422695",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422696.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-21T01:12:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422696",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_422697.json:
```json
{
    "body": "The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.\n\n- Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.\n\n- If I copy that file by hand, then the links are available, but the one for the reference manual (`local/share/doc/sage/pdf/en/reference/index.html`) is badly formatted. It is an html file with links to the different components in PDF format, but the table of contents basically appear twice, once badly and then once better, but not perfect.\n\n- mathjax is not enabled in that main reference manual html file.",
    "created_at": "2020-08-21T03:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422697",
    "user": "jhpalmieri"
}
```

The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.

- Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.

- If I copy that file by hand, then the links are available, but the one for the reference manual (`local/share/doc/sage/pdf/en/reference/index.html`) is badly formatted. It is an html file with links to the different components in PDF format, but the table of contents basically appear twice, once badly and then once better, but not perfect.

- mathjax is not enabled in that main reference manual html file.



---

archive/issue_comments_422698.json:
```json
{
    "body": "Replying to [comment:32 jhpalmieri]:\n> The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.\n> \n> - Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.\n\nDid you run `sage --docbuild website html`? This copies the PDF icon.\n\n> - If I copy that file by hand, then the links are available, but the one for the reference manual (`local/share/doc/sage/pdf/en/reference/index.html`) is badly formatted. It is an html file with links to the different components in PDF format, but the table of contents basically appear twice, once badly and then once better, but not perfect.\n\nI think you are seeing the old version.",
    "created_at": "2020-08-21T04:21:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422698",
    "user": "klee"
}
```

Replying to [comment:32 jhpalmieri]:
> The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.
> 
> - Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.

Did you run `sage --docbuild website html`? This copies the PDF icon.

> - If I copy that file by hand, then the links are available, but the one for the reference manual (`local/share/doc/sage/pdf/en/reference/index.html`) is badly formatted. It is an html file with links to the different components in PDF format, but the table of contents basically appear twice, once badly and then once better, but not perfect.

I think you are seeing the old version.



---

archive/issue_comments_422699.json:
```json
{
    "body": "Replying to [comment:33 klee]:\n> Replying to [comment:32 jhpalmieri]:\n> > The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.\n> > \n> > - Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.\n> \n> Did you run `sage --docbuild website html`? This copies the PDF icon.\n\nThis works, but it should not be necessary: I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. See line 582 in `src/sage_setup/docbuild/__init__.py`:\n\n```py\n            if format == 'pdf':\n                # First build the website page. This only takes a few seconds.\n                getattr(get_builder('website'), 'html')()\n```\n\n\n\n> > - If I copy that file by hand, then the links are available, but the one for the reference manual (`local/share/doc/sage/pdf/en/reference/index.html`) is badly formatted. It is an html file with links to the different components in PDF format, but the table of contents basically appear twice, once badly and then once better, but not perfect.\n> \n> I think you are seeing the old version.\n\nThe version I see has (for example) the new sentences \"Welcome to the Sage reference manual. Here you find documentation for all of `Sage <http://www.sagemath.org/>`_'s features, illustrated with lots of examples. A thematic index follows.\" So it's the new one. (I also ran `make doc-clean` before building the documentation.) I'm attaching `local/share/doc/sage/pdf/en/reference/index.html`.",
    "created_at": "2020-08-21T04:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422699",
    "user": "jhpalmieri"
}
```

Replying to [comment:33 klee]:
> Replying to [comment:32 jhpalmieri]:
> > The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.
> > 
> > - Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.
> 
> Did you run `sage --docbuild website html`? This copies the PDF icon.

This works, but it should not be necessary: I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. See line 582 in `src/sage_setup/docbuild/__init__.py`:

```py
            if format == 'pdf':
                # First build the website page. This only takes a few seconds.
                getattr(get_builder('website'), 'html')()
```



> > - If I copy that file by hand, then the links are available, but the one for the reference manual (`local/share/doc/sage/pdf/en/reference/index.html`) is badly formatted. It is an html file with links to the different components in PDF format, but the table of contents basically appear twice, once badly and then once better, but not perfect.
> 
> I think you are seeing the old version.

The version I see has (for example) the new sentences "Welcome to the Sage reference manual. Here you find documentation for all of `Sage <http://www.sagemath.org/>`_'s features, illustrated with lots of examples. A thematic index follows." So it's the new one. (I also ran `make doc-clean` before building the documentation.) I'm attaching `local/share/doc/sage/pdf/en/reference/index.html`.



---

archive/issue_comments_422700.json:
```json
{
    "body": "Attachment [index.html](tarball://root/attachments/some-uuid/ticket29993/index.html) by klee created at 2020-08-21 05:23:32\n\nReplying to [comment:34 jhpalmieri]:\n> Replying to [comment:33 klee]:\n> > Replying to [comment:32 jhpalmieri]:\n> > > The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.\n> > > \n> > > - Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.\n> > \n> > Did you run `sage --docbuild website html`? This copies the PDF icon.\n> \n> This works, but it should not be necessary: I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. See line 582 in `src/sage_setup/docbuild/__init__.py`:\n> {{{\n> #!py\n>             if format == 'pdf':\n>                 # First build the website page. This only takes a few seconds.\n>                 getattr(get_builder('website'), 'html')()\n> }}}\n> \n\nStrangely `sage --docbuild all html` does not copy the PDF icon, but ``sage --docbuild website html` does. I don't know why. I didn't touch this part.\n\n> > I think you are seeing the old version.\n> \n> The version I see has (for example) the new sentences \"Welcome to the Sage reference manual. Here you find documentation for all of `Sage <http://www.sagemath.org/>`_'s features, illustrated with lots of examples. A thematic index follows.\" So it's the new one. (I also ran `make doc-clean` before building the documentation.) I'm attaching `local/share/doc/sage/pdf/en/reference/index.html`.\n\nRight. It is strange. The file `local/share/doc/sage/pdf/en/reference/index.html` is generated using the file `local/share/doc/sage/html/en/website/index.html` as a template. Would you upload this file as well so that I can compare it with mine?",
    "created_at": "2020-08-21T05:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422700",
    "user": "klee"
}
```

Attachment [index.html](tarball://root/attachments/some-uuid/ticket29993/index.html) by klee created at 2020-08-21 05:23:32

Replying to [comment:34 jhpalmieri]:
> Replying to [comment:33 klee]:
> > Replying to [comment:32 jhpalmieri]:
> > > The html version looks good, but I'm having problems with the PDF. You should be able to run `sage --docbuild all pdf` to have it build the html website file and everything else in PDF format.
> > > 
> > > - Broken before this ticket: in local/share/doc/sage/html/en/index.html, there are supposed to be PDF icons next to each document, as links leading to the PDF builds. Those are missing, because the file `_static/pdf.png` is missing. For some reason, it is not copied from `src/doc/en/website/static` to `local/share/doc/sage/html/en/_static`.
> > 
> > Did you run `sage --docbuild website html`? This copies the PDF icon.
> 
> This works, but it should not be necessary: I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. See line 582 in `src/sage_setup/docbuild/__init__.py`:
> {{{
> #!py
>             if format == 'pdf':
>                 # First build the website page. This only takes a few seconds.
>                 getattr(get_builder('website'), 'html')()
> }}}
> 

Strangely `sage --docbuild all html` does not copy the PDF icon, but ``sage --docbuild website html` does. I don't know why. I didn't touch this part.

> > I think you are seeing the old version.
> 
> The version I see has (for example) the new sentences "Welcome to the Sage reference manual. Here you find documentation for all of `Sage <http://www.sagemath.org/>`_'s features, illustrated with lots of examples. A thematic index follows." So it's the new one. (I also ran `make doc-clean` before building the documentation.) I'm attaching `local/share/doc/sage/pdf/en/reference/index.html`.

Right. It is strange. The file `local/share/doc/sage/pdf/en/reference/index.html` is generated using the file `local/share/doc/sage/html/en/website/index.html` as a template. Would you upload this file as well so that I can compare it with mine?



---

archive/issue_comments_422701.json:
```json
{
    "body": "Replying to [comment:35 klee]:\n\n> Strangely `sage --docbuild all html` does not copy the PDF icon, but ``sage --docbuild website html` does. \n\nI withdraw this assertion. It is quite confusing...",
    "created_at": "2020-08-21T05:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422701",
    "user": "klee"
}
```

Replying to [comment:35 klee]:

> Strangely `sage --docbuild all html` does not copy the PDF icon, but ``sage --docbuild website html` does. 

I withdraw this assertion. It is quite confusing...



---

archive/issue_comments_422702.json:
```json
{
    "body": "Attachment [index.2.html](tarball://root/attachments/some-uuid/ticket29993/index.2.html) by klee created at 2020-08-21 06:39:16\n\nlocal/share/doc/sage/pdf/en/reference/index.html",
    "created_at": "2020-08-21T06:39:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422702",
    "user": "klee"
}
```

Attachment [index.2.html](tarball://root/attachments/some-uuid/ticket29993/index.2.html) by klee created at 2020-08-21 06:39:16

local/share/doc/sage/pdf/en/reference/index.html



---

archive/issue_comments_422703.json:
```json
{
    "body": "I added the file `local/share/doc/sage/pdf/en/reference/index.html`, the right one.",
    "created_at": "2020-08-21T06:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422703",
    "user": "klee"
}
```

I added the file `local/share/doc/sage/pdf/en/reference/index.html`, the right one.



---

archive/issue_comments_422704.json:
```json
{
    "body": "I don't know why, but would you try specifically?\n\n```\nsage --docbuild reference pdf\n```\n",
    "created_at": "2020-08-21T07:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422704",
    "user": "klee"
}
```

I don't know why, but would you try specifically?

```
sage --docbuild reference pdf
```




---

archive/issue_comments_422705.json:
```json
{
    "body": "Replying to [comment:34 jhpalmieri]:\n> I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. \n\nI now see what have happened to you. You did not run `make build`, but only ran `make doc-clean`, `sage --docbuild all html` and `sage --docbuild all pdf`. Right? Thus you built the new document by old docbuild code.\n\nPlease try again. This time you run `make; sage --docbuild all pdf`.\n\nStill the PDF icon would not appear. This problem existed before this ticket, I think. Anyway, this copies the PDF icon to the right place:\n\n```\n$ sage --docbuild website html\n[website  ] building [html]: targets for 1 source files that are out of date\n[website  ] Merging environment/index files...\n[website  ] ... done (0 todos, 1 index, 0 citations, 0 modules)\n[website  ] Merging js index files...\n[website  ] ... done (15 js index entries)\n[website  ] copying static files... ... done\n[website  ] dumping search index in English (code: en)... done\n[website  ] The HTML pages are in local/share/doc/sage/html/en/website.\nBuild finished. The built documents can be found in .../local/share/doc/sage/html/en/website\n```\n\n\nNotice that \"copying static files...\". Then reload `local/share/doc/sage/html/en/index.html`.",
    "created_at": "2020-08-21T14:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422705",
    "user": "klee"
}
```

Replying to [comment:34 jhpalmieri]:
> I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. 

I now see what have happened to you. You did not run `make build`, but only ran `make doc-clean`, `sage --docbuild all html` and `sage --docbuild all pdf`. Right? Thus you built the new document by old docbuild code.

Please try again. This time you run `make; sage --docbuild all pdf`.

Still the PDF icon would not appear. This problem existed before this ticket, I think. Anyway, this copies the PDF icon to the right place:

```
$ sage --docbuild website html
[website  ] building [html]: targets for 1 source files that are out of date
[website  ] Merging environment/index files...
[website  ] ... done (0 todos, 1 index, 0 citations, 0 modules)
[website  ] Merging js index files...
[website  ] ... done (15 js index entries)
[website  ] copying static files... ... done
[website  ] dumping search index in English (code: en)... done
[website  ] The HTML pages are in local/share/doc/sage/html/en/website.
Build finished. The built documents can be found in .../local/share/doc/sage/html/en/website
```


Notice that "copying static files...". Then reload `local/share/doc/sage/html/en/index.html`.



---

archive/issue_comments_422706.json:
```json
{
    "body": "To see clearly the problem of the PDF icon:\n\nRunning `make doc-clean; sage --docbuild all html` does not install the PDF icon to the right place, that is under `local/share/doc/sage/html/en/website/_static`.\n\nRunning `make doc-clean; sage --docbuild website html` does install the PDF icon to the right place, that is under `local/share/doc/sage/html/en/website/_static`.",
    "created_at": "2020-08-21T14:45:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422706",
    "user": "klee"
}
```

To see clearly the problem of the PDF icon:

Running `make doc-clean; sage --docbuild all html` does not install the PDF icon to the right place, that is under `local/share/doc/sage/html/en/website/_static`.

Running `make doc-clean; sage --docbuild website html` does install the PDF icon to the right place, that is under `local/share/doc/sage/html/en/website/_static`.



---

archive/issue_comments_422707.json:
```json
{
    "body": "Replying to [comment:39 klee]:\n> Replying to [comment:34 jhpalmieri]:\n> > I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. \n> \n> I now see what have happened to you. You did not run `make build`, but only ran `make doc-clean`, `sage --docbuild all html` and `sage --docbuild all pdf`. Right? Thus you built the new document by old docbuild code.\n> \n> Please try again. This time you run `make; sage --docbuild all pdf`.\n\nYou're right, this fixed it.\n\n> Still the PDF icon would not appear. This problem existed before this ticket, I think. \n\nRight, that's what I said in comment:32. It would be nice to fix that, too.",
    "created_at": "2020-08-21T16:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422707",
    "user": "jhpalmieri"
}
```

Replying to [comment:39 klee]:
> Replying to [comment:34 jhpalmieri]:
> > I ran both `sage --docbuild all html` and `sage --docbuild all pdf`, and at least one of those should build the website page. 
> 
> I now see what have happened to you. You did not run `make build`, but only ran `make doc-clean`, `sage --docbuild all html` and `sage --docbuild all pdf`. Right? Thus you built the new document by old docbuild code.
> 
> Please try again. This time you run `make; sage --docbuild all pdf`.

You're right, this fixed it.

> Still the PDF icon would not appear. This problem existed before this ticket, I think. 

Right, that's what I said in comment:32. It would be nice to fix that, too.



---

archive/issue_comments_422708.json:
```json
{
    "body": "Replying to [comment:41 jhpalmieri]:\n> > Still the PDF icon would not appear. This problem existed before this ticket, I think. \n> \n> Right, that's what I said in comment:32. It would be nice to fix that, too.\n\nI would love to see it fixed. But I have no idea of how to fix it. Do you have?\n\nI suggest to fix it separately, and not to delay this ticket.",
    "created_at": "2020-08-21T22:33:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422708",
    "user": "klee"
}
```

Replying to [comment:41 jhpalmieri]:
> > Still the PDF icon would not appear. This problem existed before this ticket, I think. 
> 
> Right, that's what I said in comment:32. It would be nice to fix that, too.

I would love to see it fixed. But I have no idea of how to fix it. Do you have?

I suggest to fix it separately, and not to delay this ticket.



---

archive/issue_comments_422709.json:
```json
{
    "body": "I created a ticket for the PDF icon problem: #30418.",
    "created_at": "2020-08-22T00:47:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422709",
    "user": "klee"
}
```

I created a ticket for the PDF icon problem: #30418.



---

archive/issue_comments_422710.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-22T20:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422710",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_422711.json:
```json
{
    "body": "Okay, let's merge it.",
    "created_at": "2020-08-22T20:12:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422711",
    "user": "jhpalmieri"
}
```

Okay, let's merge it.



---

archive/issue_comments_422712.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-26T21:15:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29756",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29756#issuecomment-422712",
    "user": "vbraun"
}
```

Resolution: fixed
