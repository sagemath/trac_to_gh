# Issue 32796: Prepare sage.doctest for namespace packages

Issue created by migration from https://trac.sagemath.org/ticket/33033

Original creator: mkoeppe

Original creation time: 2021-12-16 17:15:26

CC:  @tobiasdiez klee fbissey arojas slabbe

The behavior of the Sage doctester decides whether a Python file is part of package based on the presence of `__init__.py` files. This is no longer appropriate because PEP 420 implicit namespace packages do not have `__init__.py` files.


---

Comment by git created at 2021-12-16 18:46:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-12-16 18:48:04

Changing status from new to needs_review.


---

Comment by @tobiasdiez created at 2021-12-16 19:02:44

A few nitpicks from my side, otherwise looks good (codewise, didn't try it locally).

The explicit bool in https://github.com/sagemath/sagetrac-mirror/compare/develop...u/mkoeppe/prepare_sage_doctest_for_namespace_packages#diff-944be831a2285f89611252d94988abde763acd41fd84353c5b46c01df443dc82L680-L683 can probably be removed (at least according to the comment that had been there).


> sage: d = os.path.dirname(sage.cpython.__file__); d

For readability, I would propose to use `dir` or `directory` instead of the single-letter variable name.


---

Comment by git created at 2021-12-16 19:12:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @tobiasdiez created at 2021-12-16 19:13:02

Thanks, the changes look good to me!


---

Comment by git created at 2021-12-16 21:59:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-12-17 04:01:07

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2021-12-17 04:01:07

Turns out that this module is not the best place for the new function because the function will need to be packaged in the distribution *sagemath-environment*.


---

Comment by git created at 2021-12-17 05:16:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-12-17 05:43:08

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2021-12-21 17:39:54

Ready for review


---

Comment by git created at 2022-01-23 05:53:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-02-01 06:59:17

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-02-01 06:59:54

Changing priority from major to critical.


---

Comment by git created at 2022-02-06 23:14:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by klee created at 2022-02-08 02:14:58

LGTM.


---

Comment by klee created at 2022-02-08 02:14:58

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-02-08 02:30:30

Thank you!


---

Comment by vbraun created at 2022-02-13 10:17:50

Resolution: fixed
