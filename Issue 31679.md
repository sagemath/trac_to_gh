# Issue 31679: Polyhedron.relative_interior

Issue created by migration from https://trac.sagemath.org/ticket/31916

Original creator: mkoeppe

Original creation time: 2021-06-06 01:16:13

CC:  @kliem yzh jipilab tscrim novoselt mjo

We introduce a new method `relative_interior`, which returns a simple object with a `__contains__` method. Then one can write `x in P.relative_interior()` instead of `P.relative_interior_contains(x)`.

This will also simplify #31660.


---

Comment by mkoeppe created at 2021-06-06 18:30:18

New commits:


---

Comment by git created at 2021-06-06 18:30:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-06-06 18:45:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-06-06 19:41:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2021-06-06 20:03:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-06-06 20:05:01

Changing status from new to needs_review.


---

Comment by @kliem created at 2021-06-07 10:55:26

Changing status from needs_review to needs_work.


---

Comment by @kliem created at 2021-06-07 10:55:26

There are various small things:

The interior of a non-full-dimensional cone should be a cone, not a polyhedron.

Why do you implement `relative_interior` for relative interiors but not `interior`?

Why is `closure` defined for relative interiors, but not for polyhedra or cones? The problem is, that `P.relative_interior().closure()` will not always work.

Comparison will raise `AttributeErrors`, when `other` is the universe.


---

Comment by @kliem created at 2021-06-07 19:00:24

#31919 solves the problem with `closure`.


---

Comment by git created at 2021-06-07 19:02:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-06-07 19:06:17

Replying to [comment:9 gh-kliem]:
> The interior of a non-full-dimensional cone should be a cone, not a polyhedron.

Can't do - a `ConvexRationalPolyhedralCone` always contains 0

> Why do you implement `relative_interior` for relative interiors but not `interior`?

Done

> Why is `closure` defined for relative interiors, but not for polyhedra or cones? The problem is, that `P.relative_interior().closure()` will not always work.

For this ticket, it's just the accessor to the original polytope, not a more general API. See #31919 (ABC for convex sets), where I am adding such methods.

> Comparison will raise `AttributeErrors`, when `other` is the universe.

Done


---

Comment by mkoeppe created at 2021-06-07 19:07:26

Changing status from needs_work to needs_review.


---

Comment by @kliem created at 2021-06-07 19:21:47

Changing status from needs_review to positive_review.


---

Comment by @kliem created at 2021-06-07 19:21:47

LGTM.


---

Comment by @kliem created at 2021-06-07 19:22:37

Replying to [comment:12 mkoeppe]:
> Replying to [comment:9 gh-kliem]:
> > The interior of a non-full-dimensional cone should be a cone, not a polyhedron.
> 
> Can't do - a `ConvexRationalPolyhedralCone` always contains 0
Right.
> 
> > Why do you implement `relative_interior` for relative interiors but not `interior`?
> 
> Done
> 
> > Why is `closure` defined for relative interiors, but not for polyhedra or cones? The problem is, that `P.relative_interior().closure()` will not always work.
> 
> For this ticket, it's just the accessor to the original polytope, not a more general API. See #31919 (ABC for convex sets), where I am adding such methods.

As noted above, I later discovered this on #31919 and it's fine to add it later on.
> 
> > Comparison will raise `AttributeErrors`, when `other` is the universe.
> 
> Done
>


---

Comment by mkoeppe created at 2021-06-07 19:25:48

Thanks! But I think I need to revise `relative_interior` to handle polyhedra that are already relatively open


---

Comment by mkoeppe created at 2021-06-07 19:25:48

Changing status from positive_review to needs_work.


---

Comment by git created at 2021-06-07 19:38:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-06-07 19:38:43

Changing status from needs_work to needs_review.


---

Comment by @kliem created at 2021-06-07 19:43:16

I was locking for a boundary case, but yes, if a polyhedron is it's affine hull, then it either empty or the universe it it's affine hull.


---

Comment by @kliem created at 2021-06-07 19:43:16

Changing status from needs_review to positive_review.


---

Comment by git created at 2021-06-07 20:01:59

Changing status from positive_review to needs_review.


---

Comment by git created at 2021-06-07 20:01:59

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by mkoeppe created at 2021-06-07 20:02:18

Sorry, here's the same fix for cones


---

Comment by git created at 2021-06-07 20:25:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2021-06-07 21:18:59

Is there a reason for the emptylines:


```
+    def is_relatively_open(self):
+
+        r"""
+        Return whether ``self`` is relatively open.
```



```
+class RelativeInterior(SageObject):
+
+    r"""
```


> Surround top-level function and class definitions with two blank lines.


```
+# ****************************************************************************
+
+from sage.structure.sage_object import SageObject
+
+class RelativeInterior(SageObject):
```


I'm not sure, if it also applies to the import.

Really tiny: Does a docstring ending with an example contain an empty line in the end? (Doesn't need to be fixed, I just noticed.)

Maybe for another ticket: Replace the `ppl` imports in `cone.py` by explicity imports to help pyflakes.

Otherwise it's a positive review.


---

Comment by git created at 2021-06-07 22:07:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2021-06-08 06:56:50

LGTM.


---

Comment by @kliem created at 2021-06-08 06:56:50

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-06-08 17:01:59

Thanks!


---

Comment by vbraun created at 2021-06-29 17:40:29

Resolution: fixed
