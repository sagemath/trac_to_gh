# Issue 29947: Support Python 3.9

Issue created by migration from https://trac.sagemath.org/ticket/30184

Original creator: slelievre

Original creation time: 2020-07-20 20:20:29

CC:  arojas embray fbissey @kliem @timokau isuruf jhpalmieri mkoeppe slelievre thansen tscrim jdemeyer dimpase

Keywords: upgrade, python

We should support Python 3.9.

- [Python 3.9 release schedule](https://www.python.org/dev/peps/pep-0596/)
- [What's new in Python 3.9](https://docs.python.org/3.9/whatsnew/3.9.html)


---

Comment by slelievre created at 2020-07-20 23:13:32

Python 3.9.0.beta5, the last of five planned beta release previews,
was released on 2020-07-20.

- https://www.python.org/downloads/release/python-390b5/

It would be nice to test and report any issues to the Python bug tracker.


---

Comment by jhpalmieri created at 2020-07-20 23:17:26

I can't even get 3.8 to work (#27754).  :(


---

Comment by slelievre created at 2020-08-11 23:16:11

Python 3.9.0 is *almost* ready, with *3.9.0rc1*,
the penultimate release preview, released.

- https://www.python.org/downloads/release/python-390rc1/


---

Comment by slelievre created at 2020-09-17 16:48:40

Python 3.9.0rc2 announced today on python-announce:

> Python 3.9.0 is almost ready. This release, 3.9.0rc2,
> is the last planned preview before the final release
> of Python 3.9.0 on 2020-10-05. Get it here:
>
> https://www.python.org/downloads/release/python-390rc2/
>
> In the mean time, we strongly encourage maintainers of
> third-party Python projects to prepare their projects
> for 3.9 compatibility during this phase. As always,
> report any issues to the Python bug tracker
> <https://bugs.python.org/>.


---

Comment by mkoeppe created at 2020-09-17 18:58:58

With #30589 (Python 3.9.0rc2), the build goes smoothly up to here:

```
[sagelib-9.2.beta12] [1/1] gcc -Wno-unused-result -Wsign-compare -Wunreachable-code -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src -I/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/ext -I/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/include/python3.9 -I/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/site-packages/numpy/core/include -Ibuild/cythonized -I/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/include/python3.9 -c build/cythonized/sage/cpython/debug.c -o build/temp.macosx-10.9-x86_64-3.9/build/cythonized/sage/cpython/debug.o -fno-strict-aliasing -DCYTHON_CLINE_IN_TRACEBACK=1 -std=c99
[sagelib-9.2.beta12] In file included from build/cythonized/sage/cpython/debug.c:1446:
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:86:32: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     pointer_check_constant(tp->attr, NULL) \
[sagelib-9.2.beta12]                            ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:87:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, PyType_GenericAlloc) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:88:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, PyType_GenericNew) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:89:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, PyObject_Del) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:90:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, PyObject_GC_Del) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:91:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, PyObject_GenericGetAttr) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:92:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, PyObject_GenericSetAttr) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:93:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, _Py_HashPointer) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:94:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, PyObject_HashNotImplemented) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:95:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, subtype_traverse) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:96:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, subtype_clear) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:97:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     else pointer_check_constant(tp->attr, subtype_dealloc) \
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:78:9: note: expanded from macro 'pointer_check_constant'
[sagelib-9.2.beta12]     if (ptr == (void*)(val)) \
[sagelib-9.2.beta12]         ^~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:108:39: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]                 if (subtp->sub && tp->attr == subtp->attr) \
[sagelib-9.2.beta12]                                   ~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:108:54: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]                 if (subtp->sub && tp->attr == subtp->attr) \
[sagelib-9.2.beta12]                                               ~~~~~  ^
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:188:18: error: no member named 'tp_print' in 'struct _typeobject'
[sagelib-9.2.beta12]     attr_pointer(tp_print);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~^~~~~~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:123:24: note: expanded from macro 'attr_pointer'
[sagelib-9.2.beta12]     attr_pointer_value(attr);
[sagelib-9.2.beta12]     ~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:119:65: note: expanded from macro 'attr_pointer_value'
[sagelib-9.2.beta12] #define attr_pointer_value(attr) subattr_pointer_value(tp_name, attr);
[sagelib-9.2.beta12]                                  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^~~~~
[sagelib-9.2.beta12] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/build/pkgs/sagelib/src/sage/cpython/debugimpl.c:117:37: note: expanded from macro 'subattr_pointer_value'
[sagelib-9.2.beta12]     if (special) printf("%p\n", tp->attr);
[sagelib-9.2.beta12]                                 ~~  ^
[sagelib-9.2.beta12] 15 errors generated.
[sagelib-9.2.beta12] error: command '/usr/bin/gcc' failed with exit code 1
[sagelib-9.2.beta12] Exception ignored in: <function Pool.__del__ at 0x1196803a0>
[sagelib-9.2.beta12] Traceback (most recent call last):
[sagelib-9.2.beta12]   File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/multiprocessing/pool.py", line 268, in __del__
[sagelib-9.2.beta12]     self._change_notifier.put(None)
[sagelib-9.2.beta12]   File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/multiprocessing/queues.py", line 378, in put
[sagelib-9.2.beta12]     self._writer.send_bytes(obj)
[sagelib-9.2.beta12]   File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/multiprocessing/connection.py", line 205, in send_bytes
[sagelib-9.2.beta12]     self._send_bytes(m[offset:offset + size])
[sagelib-9.2.beta12]   File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/multiprocessing/connection.py", line 416, in _send_bytes
[sagelib-9.2.beta12]     self._send(header + buf)
[sagelib-9.2.beta12]   File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/multiprocessing/connection.py", line 373, in _send
[sagelib-9.2.beta12]     n = write(self._handle, buf)
[sagelib-9.2.beta12] OSError: [Errno 9] Bad file descriptor
[sagelib-9.2.beta12] 
[sagelib-9.2.beta12] real	0m7.479s
[sagelib-9.2.beta12] user	0m4.042s
[sagelib-9.2.beta12] sys	0m2.327s
```



---

Comment by mkoeppe created at 2020-09-17 19:29:12

There is little evidence that anyone but the author of `type_debug` has used this facility. Candidate for removal. Surely there must be something like this on PyPI somewhere?


---

Comment by mkoeppe created at 2020-09-17 20:51:22

Deprecation warnings in docbuild:

```
[dochtml] <frozen importlib._bootstrap>:228: DeprecationWarning: The parser module is deprecated and will be removed in future versions of Python
[dochtml] [arithgrou] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/ast.py:407: DeprecationWarning: visit_NameConstant is deprecated; add visit_Constant
[dochtml] [arithgrou]   return visitor(node)
[dochtml] [plot3d   ] /Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/ast.py:407: DeprecationWarning: visit_Str is deprecated; add visit_Constant
```

----
New commits:


---

Comment by mkoeppe created at 2020-09-17 22:27:42

`make ptestlong` also has various failures due to new warnings `DeprecationWarning: visit_Str is deprecated; add visit_Constant` and similar


---

Comment by mkoeppe created at 2020-09-17 22:28:05

Any warning-suppression specialists here?


---

Comment by jhpalmieri created at 2020-09-17 22:40:30

Can you add to the relevant section of `src/sage/all.py`? There are lines like

```
# scipy 1.18 introduced reprecation warnings on a number of things they are moving to
# numpy, e.g. DeprecationWarning: scipy.array is deprecated
#             and will be removed in SciPy 2.0.0, use numpy.array instead
# This affects networkx 2.2 up and including 2.4 (cf. :trac:29766)
warnings.filterwarnings('ignore', category=DeprecationWarning,
    module='.*(scipy|networkx)')
```



---

Comment by mkoeppe created at 2020-09-17 22:55:27

Thanks!


---

Comment by git created at 2020-09-17 23:00:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-17 23:01:52

Replying to [comment:14 mkoeppe]:
> Deprecation warnings in docbuild:
> {{{
> [dochtml] <frozen importlib._bootstrap>:228: DeprecationWarning: The parser module is deprecated and will be removed in future versions of Python
> }}}
This one also shows up on normal startup. Coming from here:

```
$ git grep 'import parser'
src/sage/symbolic/ring.pyx:import parser
```

(Implementation of `isidentifier`.)


---

Comment by mkoeppe created at 2020-09-17 23:07:35

Looks like we can simplify `isidentifier` now that we are py3-only, similar to https://stackoverflow.com/questions/12700893/how-to-check-if-a-string-is-a-valid-python-identifier-including-keyword-check


---

Comment by git created at 2020-09-18 00:11:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-18 00:12:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-18 00:18:21

More doctest failures:

```
sage -t --long --random-seed=0 src/sage/rings/polynomial/pbori/randompoly.py
**********************************************************************
File "src/sage/rings/polynomial/pbori/randompoly.py", line 46, in sage.rings.polynomial.pbori.randompoly.?
Failed example:
    s=sparse_random_system(r, number_of_polynomials = 20, variables_per_polynomial = 3, degree=2, random_seed=123)
    DeprecationWarning: Seeding based on hashing is deprecated
    since Python 3.9 and will be removed in a subsequent version. The only 
    supported seed types are: None, int, float, str, bytes, and bytearray.
**********************************************************************
File "src/sage/functions/other.py", line 1629, in sage.functions.other.Function_factorial._eval_
Failed example:
    factorial(float(3.2))        # abs tol 1e-14
      File "<doctest sage.functions.other.Function_factorial._eval_[8]>", line 1, in <module>
        factorial(float(RealNumber('3.2')))        # abs tol 1e-14
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/warnings.py", line 109, in _showwarnmsg
        sw(msg.message, msg.category, msg.filename, msg.lineno,
    :
    DeprecationWarning: Using factorial() with floats is deprecated
    7.756689535793181
sage -t --long --random-seed=0 src/sage/misc/sageinspect.py
**********************************************************************
File "src/sage/misc/sageinspect.py", line 428, in sage.misc.sageinspect.SageArgSpecVisitor
Failed example:
    v = ast.parse("jc = ['veni', 'vidi', 'vici']").body[0]; v
Expected:
    <_ast.Assign object at ...>
Got:
    <ast.Assign object at 0x11ce58a00>
sage -t --long --random-seed=0 src/sage/combinat/root_system/pieri_factors.py
**********************************************************************
File "src/sage/combinat/root_system/pieri_factors.py", line 150, in sage.combinat.root_system.pieri_factors.PieriFactors.elements
Failed example:
    [w.reduced_word() for w in PF.elements()]
Expected:
    [[3, 2, 1], [2, 1], [3, 1], [3, 2], [2], [1], [3], []]
Got:
    [[3, 2, 1], [2, 1], [3, 1], [2], [1], [3], [3, 2], []]

sage -t --long --random-seed=0 src/sage/misc/latex.py
**********************************************************************
File "src/sage/misc/latex.py", line 556, in sage.misc.latex.has_latex_attr
Failed example:
    T._latex_()
Expected:
    Traceback (most recent call last):
    ...
    TypeError: descriptor '_latex_' of 'sage.matrix.matrix0.Matrix' object needs an argument
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 720, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/site-packages/sage/doctest/forker.py", line 1145, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.latex.has_latex_attr[5]>", line 1, in <module>
        T._latex_()
    TypeError: unbound method Matrix._latex_() needs an argument
```



---

Comment by git created at 2020-09-18 00:19:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-18 00:20:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-09-18 00:24:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-18 00:25:39

Also various doctest errors because the order of deprecation warning and output changed in `sage.libs.ppl`:

```
9 items had failures:
   1 of   9 in sage.libs.ppl.Constraint.ascii_dump
   1 of   9 in sage.libs.ppl.Constraint_System.ascii_dump
   1 of   9 in sage.libs.ppl.Generator.ascii_dump
   1 of   9 in sage.libs.ppl.Generator_System.ascii_dump
   1 of   9 in sage.libs.ppl.Linear_Expression.ascii_dump
   1 of   6 in sage.libs.ppl.Poly_Con_Relation.ascii_dump
   1 of   6 in sage.libs.ppl.Poly_Gen_Relation.ascii_dump
   1 of  10 in sage.libs.ppl.Polyhedron.ascii_dump
   1 of   8 in sage.libs.ppl.Variables_Set.ascii_dump
```



---

Comment by mkoeppe created at 2020-09-18 00:31:41

Replying to [comment:29 mkoeppe]:
> Also various doctest errors because the order of deprecation warning and output changed in `sage.libs.ppl`:

I think we can just remove `sage.libs.ppl` - #30595


---

Comment by git created at 2020-09-18 00:38:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-18 00:40:37

Only these two remain. Perhaps "good enough for 9.2"?

```
sage -t --long --random-seed=0 src/sage/functions/other.py  # 1 doctest failed
sage -t --long --random-seed=0 src/sage/rings/polynomial/pbori/randompoly.py  # 1 doctest failed
```



---

Comment by git created at 2020-09-18 00:51:09

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by mkoeppe created at 2020-09-18 00:52:09

Changing status from new to needs_review.


---

Comment by git created at 2020-09-18 00:53:00

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2020-09-18 00:53:32

Changing priority from major to critical.


---

Comment by git created at 2020-09-18 00:59:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2020-09-18 01:43:39

Replying to [comment:33 mkoeppe]:
> Only these two remain. Perhaps "good enough for 9.2"?
> {{{
> sage -t --long --random-seed=0 src/sage/functions/other.py  # 1 doctest failed
> sage -t --long --random-seed=0 src/sage/rings/polynomial/pbori/randompoly.py  # 1 doctest failed
> }}}
> 

I can take ownership of the pbori one, I'll see what I can do.


---

Comment by mkoeppe created at 2020-09-20 20:54:31

Replying to [comment:25 mkoeppe]:
> {{{
> File "src/sage/functions/other.py", line 1629, in sage.functions.other.Function_factorial._eval_
> Failed example:
>     factorial(float(3.2))        # abs tol 1e-14
>       File "<doctest sage.functions.other.Function_factorial._eval_[8]>", line 1, in <module>
>         factorial(float(RealNumber('3.2')))        # abs tol 1e-14
>       File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-py39/local/lib/python3.9/warnings.py", line 109, in _showwarnmsg
>         sw(msg.message, msg.category, msg.filename, msg.lineno,
>     :
>     DeprecationWarning: Using factorial() with floats is deprecated
>     7.756689535793181
> sage -t --long --random-seed=0 src/sage/misc/sageinspect.py
> **********************************************************************

https://docs.python.org/3.9/library/math.html#math.factorial
"Deprecated since version 3.9: Accepting floats with integral values (like 5.0) is deprecated."


---

Comment by jhpalmieri created at 2020-09-20 21:51:38

Shouldn't this be using Sage's factorial function, as defined in that file by the line `factorial = Function_factorial()`? Why is `math.factorial` being used?


---

Comment by mkoeppe created at 2020-09-20 23:26:11

Yes, this is using `Function_factorial`. Its `_eval_` method does not seem to handle `float`s. My guess is that it is delegated to pynac or sympy, one of which eventually delegates to `math.factorial`.


---

Comment by git created at 2020-09-21 04:34:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-22 14:28:13

Let's get this ticket in please. The two remaining issues can be done in follow-up tickets.


---

Comment by git created at 2020-09-24 18:45:29

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by mkoeppe created at 2020-09-24 18:46:17

Last 10 new commits:


---

Comment by git created at 2020-09-24 18:57:31

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2020-09-25 01:53:51

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-27 15:21:48

Changing priority from critical to blocker.


---

Comment by jhpalmieri created at 2020-09-28 23:52:10

The changes look okay to me, and doctests pass. I'm not sure why it's a blocker, though.


---

Comment by jhpalmieri created at 2020-09-28 23:52:10

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-09-29 00:53:54

Thanks! 

I marked it a blocker because we won't be able to release 9.2 before Python 3.9 is released and our new release would therefore already be outdated.


---

Comment by dimpase created at 2020-09-30 09:22:36

I've tested this with system Python 3.9.rc2 on Gentoo, and got

```
sage -t --random-seed=0 src/sage/rings/polynomial/pbori/randompoly.py
**********************************************************************
File "src/sage/rings/polynomial/pbori/randompoly.py", line 46, in sage.rings.polynomial.pbori.randompoly.?
Failed example:
    s=sparse_random_system(r, number_of_polynomials = 20, variables_per_polynomial = 3, degree=2, random_seed=123)
Expected nothing
Got:
    doctest:warning
      File "/mnt/opt/Sage/sage-clang/src/bin/sage-runtests", line 182, in <module>
        err = DC.run()
...
      File "/mnt/opt/Sage/sage-clang/local/lib/python3.9/site-packages/sage/rings/polynomial/pbori/randompoly.py", line 54, in sparse_random_system
        random_generator = Random(random_seed)
      File "/usr/lib/python3.9/random.py", line 122, in __init__
        self.seed(x)
      File "/usr/lib/python3.9/random.py", line 158, in seed
        _warn('Seeding based on hashing is deprecated\n'
      File "/usr/lib/python3.9/warnings.py", line 109, in _showwarnmsg
        sw(msg.message, msg.category, msg.filename, msg.lineno,
    :
    DeprecationWarning: Seeding based on hashing is deprecated
    since Python 3.9 and will be removed in a subsequent version. The only 
    supported seed types are: None, int, float, str, bytes, and bytearray.
```


and also

```
File "src/sage/misc/sageinspect.py", line 2275, in sage.misc.sageinspect.sage_getsourcelines
Failed example:
    sage_getsourcelines(I)
Expected:
    (...['class MPolynomialIdeal( MPolynomialIdeal_singular_repr, \\\n',
    ...)
Got:
    (['@richcmp_method\n', 'class MPolynomialIdeal( MPolynomialIdeal_singular_repr, \\\n', '                        MPolynomialIdeal_macaulay2_repr, \\\n', '  ....
...
```



---

Comment by dimpase created at 2020-09-30 09:29:19

Changing status from positive_review to needs_work.


---

Comment by git created at 2020-09-30 20:34:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2020-09-30 21:45:21

Changing status from needs_work to needs_review.


---

Comment by mkoeppe created at 2020-09-30 21:45:21

See comment 45.


---

Comment by dimpase created at 2020-10-01 08:18:56

Replying to [comment:58 mkoeppe]:
> See comment 45.
oops, sorry, I was somewhat late to the party. Another problem I'm investigating is that this upgrade seems to lead to zombie Maxima and ECL processes.


---

Comment by dimpase created at 2020-10-01 14:26:53

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2020-10-01 14:26:53

ok, good (Zombies have nothing to do with this update)


---

Comment by mkoeppe created at 2020-10-01 15:55:44

Thanks.


---

Comment by vbraun created at 2020-10-03 22:57:25

Resolution: fixed


---

Comment by slelievre created at 2020-10-08 13:39:32

Replying to [comment:40 fbissey]:
> Replying to [comment:33 mkoeppe]:
> > Only these two remain. Perhaps "good enough for 9.2"?
> > {{{
> > sage -t --long --random-seed=0 src/sage/functions/other.py  # 1 doctest failed
> > sage -t --long --random-seed=0 src/sage/rings/polynomial/pbori/randompoly.py  # 1 doctest failed
> > }}}
> > 
> 
> I can take ownership of the pbori one, I'll see what I can do.

Should a follow-up ticket for each of these two issues be opened?

Meta-ticket for all Python 3.9 issues?

Too early for a ticket for Python 3.10 support? Python 3.10.0a1 is out:

- https://www.python.org/downloads/release/python-3100a1/


---

Comment by mkoeppe created at 2020-10-13 20:49:14

Replying to [comment:63 slelievre]:
> Replying to [comment:40 fbissey]:
> > Replying to [comment:33 mkoeppe]:
> > > Only these two remain. Perhaps "good enough for 9.2"?
> > > {{{
> > > sage -t --long --random-seed=0 src/sage/functions/other.py  # 1 doctest failed
> > > sage -t --long --random-seed=0 src/sage/rings/polynomial/pbori/randompoly.py  # 1 doctest failed
> > > }}}
> > > 
> > 
> > I can take ownership of the pbori one, I'll see what I can do.
> 
> Should a follow-up ticket for each of these two issues be opened?

Yes please

> Meta-ticket for all Python 3.9 issues?

I don't think this is necessary

> Too early for a ticket for Python 3.10 support? Python 3.10.0a1 is out:
> 
> - https://www.python.org/downloads/release/python-3100a1/

Sure, please open a ticket


---

Comment by slelievre created at 2020-10-13 22:06:04

Follow-up tickets:

- #30764: Adapt to float factorial deprecation in Python 3.9
- #30765: Adapt to deprecation of seeding based on hashing in Python 3.9
- #30766: Support Python 3.10
- #30767: Test ticket: Python 3.10 development releases


---

Comment by dimpase created at 2020-10-20 16:16:16

you might have seen this:
https://github.com/python/cpython/pull/22670  - a critical incompatibility with  pybind11


---

Comment by dimpase created at 2020-10-20 16:21:53

From https://pybind11.readthedocs.io/en/latest/


```
Warning

Combining older versions of pybind11 (< 2.6.0) with the brand-new Python 3.9.0 will trigger undefined behavior that typically manifests as crashes during interpreter shutdown (but could also destroy your data. You have been warned.)

We recommend that you wait for Python 3.9.1 slated for release in December, which will include a fix that resolves this problem. In the meantime, please update to the latest version of pybind11 (2.6.0 or newer), which includes a temporary workaround specifically when Python 3.9.0 is detected at runtime.
```


should we hold off 3.9.0  (in spkg-configure.m4 of python3) ?


---

Comment by mkoeppe created at 2020-10-20 17:47:26

We can do the pybind11 upgrade


---

Comment by mkoeppe created at 2020-10-20 17:50:07

Replying to [comment:68 mkoeppe]:
> We can do the pybind11 upgrade

Created #30803 for this
