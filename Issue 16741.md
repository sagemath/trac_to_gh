# Issue 16741: Update gdb

archive/issues_016741.json:
```json
{
    "body": "CC:  simonking jpflori @kiwifb\n\nNew upstream tarball: ftp://sourceware.org/pub/gdb/releases/gdb-7.8.tar.gz\n\nIssue created by migration from https://trac.sagemath.org/ticket/16978\n\n",
    "created_at": "2014-09-12T15:06:13Z",
    "labels": [
        "packages: experimental",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Update gdb",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16741",
    "user": "@vbraun"
}
```
CC:  simonking jpflori @kiwifb

New upstream tarball: ftp://sourceware.org/pub/gdb/releases/gdb-7.8.tar.gz

Issue created by migration from https://trac.sagemath.org/ticket/16978





---

archive/issue_comments_221311.json:
```json
{
    "body": "Useful with `SAGE_DEBUG=yes`, of course.\n----\nNew commits:",
    "created_at": "2014-09-12T15:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221311",
    "user": "@vbraun"
}
```

Useful with `SAGE_DEBUG=yes`, of course.
----
New commits:



---

archive/issue_comments_221312.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-12T15:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221312",
    "user": "@vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_221313.json:
```json
{
    "body": "What is supposed to be done for reviewing?\n\nBuilding: Just doing `make distclean`, `export SAGE_DEBUG=yes` and `make`? Or is this an optional package, and one needs to just do `sage -i gdb` in an existing Sage install built with `SAGE_DEBUG=yes`?\n\nTesting: What would one usually do to test that gdb works? Sure, I can do `sage -gdb` and then run a program that crashes...",
    "created_at": "2014-09-13T09:34:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221313",
    "user": "@simon-king-jena"
}
```

What is supposed to be done for reviewing?

Building: Just doing `make distclean`, `export SAGE_DEBUG=yes` and `make`? Or is this an optional package, and one needs to just do `sage -i gdb` in an existing Sage install built with `SAGE_DEBUG=yes`?

Testing: What would one usually do to test that gdb works? Sure, I can do `sage -gdb` and then run a program that crashes...



---

archive/issue_comments_221314.json:
```json
{
    "body": "The most interesting part is of course that you can use cygdb with a debug build. The system gdb will be built with a non-debug Python and hence have mismatching CPython structures. \n\nTo build you need to run `sage -i gdb`. It is not built by default. You can build with or without `SAGE_DEBUG`, and you can only use cygdb if the Python build matches.",
    "created_at": "2014-09-13T11:15:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221314",
    "user": "@vbraun"
}
```

The most interesting part is of course that you can use cygdb with a debug build. The system gdb will be built with a non-debug Python and hence have mismatching CPython structures. 

To build you need to run `sage -i gdb`. It is not built by default. You can build with or without `SAGE_DEBUG`, and you can only use cygdb if the Python build matches.



---

archive/issue_comments_221315.json:
```json
{
    "body": "Replying to [comment:4 vbraun]:\n> The most interesting part is of course that you can use cygdb with a debug build. The system gdb will be built with a non-debug Python and hence have mismatching CPython structures. \n\nI don't understand that comment. Does \"system gdb\" mean that we are using the system wide gdb here? \n\n> To build you need to run `sage -i gdb`. It is not built by default. You can build with or without `SAGE_DEBUG`, and you can only use cygdb if the Python build matches.\n\nWill the Python build match if I take a sage install created with `SAGE_DEBUG=yes`, and later do `sage -i gdb`?",
    "created_at": "2014-09-13T12:19:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221315",
    "user": "@simon-king-jena"
}
```

Replying to [comment:4 vbraun]:
> The most interesting part is of course that you can use cygdb with a debug build. The system gdb will be built with a non-debug Python and hence have mismatching CPython structures. 

I don't understand that comment. Does "system gdb" mean that we are using the system wide gdb here? 

> To build you need to run `sage -i gdb`. It is not built by default. You can build with or without `SAGE_DEBUG`, and you can only use cygdb if the Python build matches.

Will the Python build match if I take a sage install created with `SAGE_DEBUG=yes`, and later do `sage -i gdb`?



---

archive/issue_comments_221316.json:
```json
{
    "body": "Replying to [comment:5 SimonKing]:\n> I don't understand that comment. Does \"system gdb\" mean that we are using the system wide gdb here? \n\nNo, what I'm trying to say is that the distributor had built gdb a long time ago without debug Python.\n\n> Will the Python build match if I take a sage install created with `SAGE_DEBUG=yes`, and later do `sage -i gdb`?\n\nIf and only if you don't change the setting of the `SAGE_DEBUG` environment variable in the meantime.",
    "created_at": "2014-09-13T13:45:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221316",
    "user": "@vbraun"
}
```

Replying to [comment:5 SimonKing]:
> I don't understand that comment. Does "system gdb" mean that we are using the system wide gdb here? 

No, what I'm trying to say is that the distributor had built gdb a long time ago without debug Python.

> Will the Python build match if I take a sage install created with `SAGE_DEBUG=yes`, and later do `sage -i gdb`?

If and only if you don't change the setting of the `SAGE_DEBUG` environment variable in the meantime.



---

archive/issue_comments_221317.json:
```json
{
    "body": "Replying to [comment:6 vbraun]:\n> > Will the Python build match if I take a sage install created with `SAGE_DEBUG=yes`, and later do `sage -i gdb`?\n> \n> If and only if you don't change the setting of the `SAGE_DEBUG` environment variable in the meantime.\n\nOK, I will do \"make\" and \"sage -i gdb\" without break, and without changing `SAGE_DEBUG`.\n\nWhat happens if I change later some Cython file and compile this without `SAGE_DEBUG`. Would gdb work on that file, since it only matters that Python itself was build with `SAGE_DEBUG`? Or would gdb simply not work on that single non-debug compiled Cython file?",
    "created_at": "2014-09-13T14:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221317",
    "user": "@simon-king-jena"
}
```

Replying to [comment:6 vbraun]:
> > Will the Python build match if I take a sage install created with `SAGE_DEBUG=yes`, and later do `sage -i gdb`?
> 
> If and only if you don't change the setting of the `SAGE_DEBUG` environment variable in the meantime.

OK, I will do "make" and "sage -i gdb" without break, and without changing `SAGE_DEBUG`.

What happens if I change later some Cython file and compile this without `SAGE_DEBUG`. Would gdb work on that file, since it only matters that Python itself was build with `SAGE_DEBUG`? Or would gdb simply not work on that single non-debug compiled Cython file?



---

archive/issue_comments_221318.json:
```json
{
    "body": "\n```\nking@linux-etl7:~/Sage/debug/sage> ./sage -i gdb\nFound local metadata for gdb-7.8\nAttempting to download package gdb-7.8\n>>> Trying to download http://www.sagemath.org/packages/upstream/gdb/gdb-7.8.tar.gz\n[Traceback (most recent call last):\n  File \"<stdin>\", line 35, in <module>\n  File \"/home/king/Sage/debug/sage/local/lib/python/urllib.py\", line 240, in retrieve\n    fp = self.open(url, data)\n  File \"/home/king/Sage/debug/sage/local/lib/python/urllib.py\", line 208, in open\n    return getattr(self, name)(url)\n  File \"/home/king/Sage/debug/sage/local/lib/python/urllib.py\", line 359, in open_http\n    return self.http_error(url, fp, errcode, errmsg, headers)\n  File \"/home/king/Sage/debug/sage/local/lib/python/urllib.py\", line 376, in http_error\n    return self.http_error_default(url, fp, errcode, errmsg, headers)\n  File \"<stdin>\", line 17, in http_error_default\nIOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/gdb/gdb-7.8.tar.gz'\nError: failed to download package gdb-7.8\n```\n\nWhat to do? I thought that after checking out the branch attached to this ticket, the gdb sources would be found.",
    "created_at": "2014-09-13T14:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221318",
    "user": "@simon-king-jena"
}
```


```
king@linux-etl7:~/Sage/debug/sage> ./sage -i gdb
Found local metadata for gdb-7.8
Attempting to download package gdb-7.8
>>> Trying to download http://www.sagemath.org/packages/upstream/gdb/gdb-7.8.tar.gz
[Traceback (most recent call last):
  File "<stdin>", line 35, in <module>
  File "/home/king/Sage/debug/sage/local/lib/python/urllib.py", line 240, in retrieve
    fp = self.open(url, data)
  File "/home/king/Sage/debug/sage/local/lib/python/urllib.py", line 208, in open
    return getattr(self, name)(url)
  File "/home/king/Sage/debug/sage/local/lib/python/urllib.py", line 359, in open_http
    return self.http_error(url, fp, errcode, errmsg, headers)
  File "/home/king/Sage/debug/sage/local/lib/python/urllib.py", line 376, in http_error
    return self.http_error_default(url, fp, errcode, errmsg, headers)
  File "<stdin>", line 17, in http_error_default
IOError: [Errno 404] Not Found: '//www.sagemath.org/packages/upstream/gdb/gdb-7.8.tar.gz'
Error: failed to download package gdb-7.8
```

What to do? I thought that after checking out the branch attached to this ticket, the gdb sources would be found.



---

archive/issue_comments_221319.json:
```json
{
    "body": "Aha, I suppose I need to put the upstream sources manually into `SAGE_ROOT/upstream/`, right?",
    "created_at": "2014-09-13T14:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221319",
    "user": "@simon-king-jena"
}
```

Aha, I suppose I need to put the upstream sources manually into `SAGE_ROOT/upstream/`, right?



---

archive/issue_comments_221320.json:
```json
{
    "body": "You need to put the source tarball in the \"upstream\" directory. Its not mirrored until the ticket is reviewed...",
    "created_at": "2014-09-13T14:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221320",
    "user": "@vbraun"
}
```

You need to put the source tarball in the "upstream" directory. Its not mirrored until the ticket is reviewed...



---

archive/issue_comments_221321.json:
```json
{
    "body": "Anybody dare press the positive review button on this trivial ticket?",
    "created_at": "2014-09-23T11:19:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221321",
    "user": "@vbraun"
}
```

Anybody dare press the positive review button on this trivial ticket?



---

archive/issue_comments_221322.json:
```json
{
    "body": "Sure I'll push. One remark though about the configuration options. The dependencies on gmp, mpfr, mpc, ppl and what not are bogus and only appear because the top configuration of gcc, binutils and gdb is mostly shared. gdb doesn't use them at all so setting them is a waste of characters.",
    "created_at": "2014-09-23T11:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221322",
    "user": "@kiwifb"
}
```

Sure I'll push. One remark though about the configuration options. The dependencies on gmp, mpfr, mpc, ppl and what not are bogus and only appear because the top configuration of gcc, binutils and gdb is mostly shared. gdb doesn't use them at all so setting them is a waste of characters.



---

archive/issue_comments_221323.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-23T11:45:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221323",
    "user": "@kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_221324.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-09-25T12:05:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16741",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16741#issuecomment-221324",
    "user": "@vbraun"
}
```

Resolution: fixed
