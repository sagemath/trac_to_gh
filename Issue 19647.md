# Issue 19647: LatticePosets: Add is_relatively_complemented()

Issue created by migration from https://trac.sagemath.org/ticket/19884

Original creator: jmantysalo

Original creation time: 2016-01-13 20:22:41

CC:  chapoton

Keywords: latticeposet

This patch adds a function to check if a lattice is relatively complemented or not.


---

Comment by jmantysalo created at 2016-01-13 20:23:56

New commits:


---

Comment by jmantysalo created at 2016-01-13 20:23:56

Changing status from new to needs_review.


---

Comment by git created at 2016-01-27 06:45:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-01-27 07:32:06

Frédéric, maybe you are not yet bored of reviewing...?


---

Comment by dimpase created at 2016-02-01 10:19:48

test, please ignore


---

Comment by tscrim created at 2016-03-20 02:26:25

For the reverse implication counterexample, could you also have it display that `L` is (co)atomic.

Also, could you make the following changes:

```diff
             sage: [Posets.ChainPoset(i).is_relatively_complemented() for
-            ....: i in range(5)]
+            ....:  i in range(5)]
             [True, True, True, False, False]
```


```diff
         Usually a lattice that is not relatively complemented contains elements
-        `l`, `m`, and `u` such that rank(`l`)+1 == rank(`m`) == rank(`u`)-1
-        and `m` is the only element in the interval `[l, u]`. We make an
+        `l`, `m`, and `u` such that `r(l) + 1 = r(m) = r(u) - 1`, where `r` is
+        the rank function and `m` is the only element in the interval `[l, u]`.
+        We construct an example where this does not hold::
```


```diff
         C = Counter(flatten([H.neighbors_out(e2) for e2 in H.neighbors_out(e1)]))
-            for e3, c in C.iteritems():
-                if c == 1:
-                    if len(H.closed_interval(e1, e3)) == 3:
-                        return False
+            if any(c == 1 and len(H.closed_interval(e1, e3)) == 3 for e3, c in C.iteritems()):
+                return False
         return True
```


Otherwise it is a positive review.


---

Comment by jmantysalo created at 2016-03-20 05:30:54

Replying to [comment:7 tscrim]:

> For the reverse implication counterexample, could you also have it display that `L` is (co)atomic.

I can do that, but `is_coatomic()` is not yet closed, see #19878.

Your suggestions to code and documentation seems good.


---

Comment by tscrim created at 2016-03-20 07:41:51

Then we should merge it in and set it as a dependency. It's already positively reviewed, so there shouldn't be any issues.


---

Comment by git created at 2016-03-20 13:14:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2016-03-20 13:16:44

Changing status from needs_review to needs_work.


---

Comment by jmantysalo created at 2016-03-20 13:16:44

Replying to [comment:9 tscrim]:
> Then we should merge it in and set it as a dependency. It's already positively reviewed, so there shouldn't be any issues.

But if we just wait for the next beta, shouldn't this then work without any extra job to do?

I made changes you suggested, but I'm compiling and testing - so this is in _needs_work_.


---

Comment by jmantysalo created at 2016-03-21 05:31:36

I got error from docbuilding, but it seems not to relate `lattices.py`. Strange.


---

Comment by tscrim created at 2016-03-22 14:18:58

Changing status from needs_work to positive_review.


---

Comment by tscrim created at 2016-03-22 14:18:58

Chances are that it this will get merged, along with #19878, in beta1. So I have merged in #19878 because that is 0 additional work in reviewing. I did not get any docbuilding, no doctesting errors with #19878, and your changes look good. So I'm setting a positive review.
----
New commits:


---

Comment by jmantysalo created at 2016-03-22 14:25:14

Thanks!


---

Comment by tscrim created at 2016-03-22 14:39:37

Thank you for all your work on posets.


---

Comment by vbraun created at 2016-03-26 11:30:57

Resolution: fixed
