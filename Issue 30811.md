# Issue 30811: Cone equality check does not work

Issue created by migration from https://trac.sagemath.org/ticket/31048

Original creator: @kliem

Original creation time: 2020-12-14 10:08:32

CC:  mjo novoselt


```
sage: P = polytopes.cube()                                                                                                                                                          
sage: Q = Cone([[1]+list(v) for v in P.vertices()])                                                                                                                                 
sage: R = Q.dual()                                                                                                                                                                  
sage: P1 = P.polar()                                                                                                                                                                
sage: R1 = Cone([[1]+list(v) for v in P1.vertices()], R.lattice())                                                                                                                  
sage: R1 == R                                                                                                                                                                       
False
sage: set(R1.rays()) == set(R.rays())                                                                                                                                               
True
sage: R1.rays()                                                                                                                                                                     
M(1, -1,  0,  0),
M(1,  0, -1,  0),
M(1,  0,  0, -1),
M(1,  0,  0,  1),
M(1,  0,  1,  0),
M(1,  1,  0,  0)
in 4-d lattice M
sage: R.rays()                                                                                                                                                                      
M(1,  0,  0, -1),
M(1, -1,  0,  0),
M(1,  0, -1,  0),
M(1,  0,  1,  0),
M(1,  0,  0,  1),
M(1,  1,  0,  0)
in 4-d lattice M
```


First I thought, I had to pay attention to the lattice, but that is not the issue here. It seems that the equality check depends on the order of the rays.


---

Comment by mjo created at 2020-12-14 13:58:23

You have to use `R1.is_equivalent(R)` or `R.is_equivalent(R1)`. The usual equality check depends on the order of the rays (see the docs for `is_equivalent`).


---

Comment by @kliem created at 2020-12-14 14:18:56

Thanks for the reply.

Why? Is there a use case for checking that the order is the same?

I would usually assume that `==` checks if two things are mathematically the same, just as `1/1 == 1` evaluates to true. Is the order of the rays even guaranteed to be preserved from input?


---

Comment by novoselt created at 2020-12-14 16:15:28

If you have things associated to a cone and, for example, variables corresponding to rays and indexed in the same way, then the order of rays is important. I would be strongly opposed to changing this behaviour.


---

Comment by @kliem created at 2020-12-14 20:50:30

Ok.

Still, I think it is really weird.


```
sage: C = Cone([(1, -1, -1), (1, -1, 0), (1, -1, 1), (1, 0, -1), (1, 0, 0), (1, 0, 1), (1, 1, -1), (1, 1, 0), (1, 1, 1)])             
sage: D = Cone(C.rays())                                                                                                              
sage: C == D                                                                                                                          
True
sage: C.facet_normals() == D.facet_normals()                                                                                          
False
```



```
sage: Cone([(1, -1, -1), (1, -1, 0), (1, -1, 1), (1, 1, -1), (1, 1, 1)]) == Cone([(1, -1, -1), (1, -1, 1), (1, 1, -1), (1, 1, 1)])
False
```



---

Comment by @kliem created at 2020-12-14 20:53:00

Changing status from new to needs_review.


---

Comment by @kliem created at 2020-12-14 20:53:00

Anyway, I don't think it is super important. If you have strong opinions, then I won't insist on it.


---

Comment by @kliem created at 2020-12-17 19:45:36

Sorry for bothering with the ticket. I did think it was by mistake and not by design.


---

Comment by mjo created at 2020-12-17 20:53:16

No problem, I only knew the answer immediately because I did the same thing once upon a time.


---

Comment by mjo created at 2020-12-17 20:53:16

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-12-19 18:12:04

Resolution: invalid
