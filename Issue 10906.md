# Issue 10906: building ecl fails in case the installed etags is actually exuberant-ctags

Issue created by migration from Trac.

Original creator: fbissey

Original creation time: 2011-03-22 21:01:13

Assignee: tbd

CC:  schilly

In some debian installs (and derivatives such as ubuntu) the etags program is actually to ctags from exuberant-ctags. This is incompatible with what ecl expect. the symptoms are as follow:

```
echo > TAGS
if test "xetags" != "x"; then \
        srcfiles=`find 
/scratch/scratch/schilly/sage/sage-4.6.2/spkg/build/ecl-11.1.1/src/src/c 
/scratch/scratch/schilly/sage/sage-4.6.2/spkg/build/ecl-11.1.1/src/src/h 
-name '*.[chd]'` && \
        etags --language=c    -o TAGS $srcfiles && \
        etags --language=none -o TAGS --append \
              --regex='/`@`\([-:*a-zA-z]+\)/\1/' \
              --regex='/`@`(defun \([-:*a-zA-z]+\)/\1/' \
              $srcfiles; \
        fi
etags: relocation error: /usr/lib/libldap_r-2.4.so.2: symbol 
}}} 
or
{{{
echo > TAGS
if test "xetags" != "x"; then \
srcfiles=`find  
/storage/strogdon/gentoo/var/tmp/portage/dev-lisp/ecls-11.1.1/work/ecl-11.1.1/src/c  
/storage/strogdon/gentoo/var/tmp/portage/dev-lisp/ecls-11.1.1/work/ecl-11.1.1/src/h  
-name '*.[chd]'` && \
etags --language=c    -o TAGS $srcfiles && \
etags --language=none -o TAGS --append \
       --regex='/`@`\([-:*a-zA-z]+\)/\1/' \
       --regex='/`@`(defun \([-:*a-zA-z]+\)/\1/' \
       $srcfiles; \
fi
etags: Warning: "--language" option is obsolete; use "--language-force"  
instead
etags: "TAGS" doesn't look like a tag file; I refuse to overwrite it.
}}}
There is no way to disable the building of TAGS in the configuration and detecting that you have an etags program from emacs is complicated. See the following bug reports:
 * [http://bugs.gentoo.org/show_bug.cgi?id=357319](http://bugs.gentoo.org/show_bug.cgi?id=357319)
 * [http://sourceforge.net/tracker/?func=detail&aid=3202253&group_id=30035&atid=398053](http://sourceforge.net/tracker/?func=detail&aid=3202253&group_id=30035&atid=398053) (upstream)


---

Comment by fbissey created at 2011-03-22 21:51:09

Here is the new spkg. Basically I touch build/TAGS before make is called so that TAGS is never built. Bypassing any problem with a broken etags or ctags passing for etags.
I will attach a patch for the reviewer with all the changes to the spkg.


---

Comment by fbissey created at 2011-03-22 21:51:09

Changing status from new to needs_review.


---

Comment by fbissey created at 2011-03-22 21:52:27

summary of change patch, for the reviewer only


---

Attachment

This is now ready for review.


---

Comment by schilly created at 2011-03-22 21:59:35

nice, it just built successfully on the same machine where i reported the problem mentioned above!


---

Comment by jdemeyer created at 2011-04-13 08:03:29

Changing status from needs_review to positive_review.


---

Comment by SimonKing created at 2011-04-13 08:23:11

Thank you for changing it into a positive review! I was just about to do that myself.


---

Comment by jdemeyer created at 2011-04-13 15:17:57

Resolution: fixed
