# Issue 17709: Use ipython own's function to get its configuration folder

archive/issues_017709.json:
```json
{
    "body": "Currently the IPython code in sage relies on code such as\n\n```\nIPYTHONDIR = os.environ['IPYTHONDIR']\n```\n\nwhen ipython has its own call to discover what IPYTHONDIR should be. This is particularly important if you want to unset IPYTHONDIR for your own purpose - or you run sage-on-gentoo where we let ipython run with its system default.\n\nIssue created by migration from https://trac.sagemath.org/ticket/17946\n\n",
    "created_at": "2015-03-13T10:04:07Z",
    "labels": [
        "PLEASE CHANGE",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "Use ipython own's function to get its configuration folder",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17709",
    "user": "fbissey"
}
```
Currently the IPython code in sage relies on code such as

```
IPYTHONDIR = os.environ['IPYTHONDIR']
```

when ipython has its own call to discover what IPYTHONDIR should be. This is particularly important if you want to unset IPYTHONDIR for your own purpose - or you run sage-on-gentoo where we let ipython run with its system default.

Issue created by migration from https://trac.sagemath.org/ticket/17946





---

archive/issue_comments_236776.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-13T12:04:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236776",
    "user": "fbissey"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_236777.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2015-03-13T13:01:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236777",
    "user": "kcrisman"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_236778.json:
```json
{
    "body": "LGTM.",
    "created_at": "2015-03-13T15:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236778",
    "user": "tscrim"
}
```

LGTM.



---

archive/issue_comments_236779.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to build.",
    "created_at": "2015-03-13T15:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236779",
    "user": "tscrim"
}
```

Changing component from PLEASE CHANGE to build.



---

archive/issue_comments_236780.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-03-13T15:01:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236780",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_236781.json:
```json
{
    "body": "\n```\nsage -t --long src/sage/repl/ipython_kernel/install.py\n**********************************************************************\nFile \"src/sage/repl/ipython_kernel/install.py\", line 118, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax\nFailed example:\n    ipython_dir = get_ipython_dir()\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 492, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 854, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[3]>\", line 1, in <module>\n        ipython_dir = get_ipython_dir()\n    NameError: name 'get_ipython_dir' is not defined\n**********************************************************************\nFile \"src/sage/repl/ipython_kernel/install.py\", line 119, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax\nFailed example:\n    mathjax = os.path.join(ipython_dir, 'nbextensions', 'mathjax')\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 492, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 854, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[4]>\", line 1, in <module>\n        mathjax = os.path.join(ipython_dir, 'nbextensions', 'mathjax')\n    NameError: name 'ipython_dir' is not defined\n**********************************************************************\nFile \"src/sage/repl/ipython_kernel/install.py\", line 120, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax\nFailed example:\n    os.path.exists(mathjax)\nException raised:\n    Traceback (most recent call last):\n      File \"/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 492, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 854, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[5]>\", line 1, in <module>\n        os.path.exists(mathjax)\n    NameError: name 'mathjax' is not defined\n**********************************************************************\n1 item had failures:\n   3 of   7 in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax\n    [37 tests, 3 failures, 0.16 s]\n```\n",
    "created_at": "2015-03-14T00:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236781",
    "user": "vbraun"
}
```


```
sage -t --long src/sage/repl/ipython_kernel/install.py
**********************************************************************
File "src/sage/repl/ipython_kernel/install.py", line 118, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
Failed example:
    ipython_dir = get_ipython_dir()
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 492, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 854, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[3]>", line 1, in <module>
        ipython_dir = get_ipython_dir()
    NameError: name 'get_ipython_dir' is not defined
**********************************************************************
File "src/sage/repl/ipython_kernel/install.py", line 119, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
Failed example:
    mathjax = os.path.join(ipython_dir, 'nbextensions', 'mathjax')
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 492, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 854, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[4]>", line 1, in <module>
        mathjax = os.path.join(ipython_dir, 'nbextensions', 'mathjax')
    NameError: name 'ipython_dir' is not defined
**********************************************************************
File "src/sage/repl/ipython_kernel/install.py", line 120, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
Failed example:
    os.path.exists(mathjax)
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 492, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 854, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[5]>", line 1, in <module>
        os.path.exists(mathjax)
    NameError: name 'mathjax' is not defined
**********************************************************************
1 item had failures:
   3 of   7 in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
    [37 tests, 3 failures, 0.16 s]
```




---

archive/issue_comments_236782.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-03-14T00:31:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236782",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_236783.json:
```json
{
    "body": "Yes I am an idiot, I forgot an essential step in that doctest.",
    "created_at": "2015-03-14T00:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236783",
    "user": "fbissey"
}
```

Yes I am an idiot, I forgot an essential step in that doctest.



---

archive/issue_comments_236784.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-03-14T00:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236784",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_236785.json:
```json
{
    "body": "Fixed, back to need review.",
    "created_at": "2015-03-14T00:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236785",
    "user": "fbissey"
}
```

Fixed, back to need review.



---

archive/issue_comments_236786.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-03-14T00:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236786",
    "user": "fbissey"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_236787.json:
```json
{
    "body": "Hum didn't know you could go from `needs_work` to `positive_review` in one go.",
    "created_at": "2015-03-14T01:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236787",
    "user": "fbissey"
}
```

Hum didn't know you could go from `needs_work` to `positive_review` in one go.



---

archive/issue_comments_236788.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-03-17T08:34:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17709",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17709#issuecomment-236788",
    "user": "vbraun"
}
```

Resolution: fixed
