# Issue 17709: Use ipython own's function to get its configuration folder

Issue created by migration from Trac.

Original creator: fbissey

Original creation time: 2015-03-13 10:04:07

Currently the IPython code in sage relies on code such as

```
IPYTHONDIR = os.environ['IPYTHONDIR']
```

when ipython has its own call to discover what IPYTHONDIR should be. This is particularly important if you want to unset IPYTHONDIR for your own purpose - or you run sage-on-gentoo where we let ipython run with its system default.


---

Comment by fbissey created at 2015-03-13 12:04:45

Changing status from new to needs_review.


---

Comment by kcrisman created at 2015-03-13 13:01:47

Changing type from PLEASE CHANGE to defect.


---

Comment by tscrim created at 2015-03-13 15:01:10

LGTM.


---

Comment by tscrim created at 2015-03-13 15:01:10

Changing component from PLEASE CHANGE to build.


---

Comment by tscrim created at 2015-03-13 15:01:10

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-03-14 00:31:57


```
sage -t --long src/sage/repl/ipython_kernel/install.py
**********************************************************************
File "src/sage/repl/ipython_kernel/install.py", line 118, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
Failed example:
    ipython_dir = get_ipython_dir()
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 492, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 854, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[3]>", line 1, in <module>
        ipython_dir = get_ipython_dir()
    NameError: name 'get_ipython_dir' is not defined
**********************************************************************
File "src/sage/repl/ipython_kernel/install.py", line 119, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
Failed example:
    mathjax = os.path.join(ipython_dir, 'nbextensions', 'mathjax')
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 492, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 854, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[4]>", line 1, in <module>
        mathjax = os.path.join(ipython_dir, 'nbextensions', 'mathjax')
    NameError: name 'ipython_dir' is not defined
**********************************************************************
File "src/sage/repl/ipython_kernel/install.py", line 120, in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
Failed example:
    os.path.exists(mathjax)
Exception raised:
    Traceback (most recent call last):
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 492, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 854, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax[5]>", line 1, in <module>
        os.path.exists(mathjax)
    NameError: name 'mathjax' is not defined
**********************************************************************
1 item had failures:
   3 of   7 in sage.repl.ipython_kernel.install.SageKernelSpec.use_local_mathjax
    [37 tests, 3 failures, 0.16 s]
```



---

Comment by vbraun created at 2015-03-14 00:31:57

Changing status from positive_review to needs_work.


---

Comment by fbissey created at 2015-03-14 00:45:18

Yes I am an idiot, I forgot an essential step in that doctest.


---

Comment by git created at 2015-03-14 00:48:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by fbissey created at 2015-03-14 00:50:58

Fixed, back to need review.


---

Comment by fbissey created at 2015-03-14 00:50:58

Changing status from needs_work to positive_review.


---

Comment by fbissey created at 2015-03-14 01:05:16

Hum didn't know you could go from `needs_work` to `positive_review` in one go.


---

Comment by vbraun created at 2015-03-17 08:34:09

Resolution: fixed
