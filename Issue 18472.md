# Issue 18472: closed forms of C-finite sequences

Issue created by migration from Trac.

Original creator: rws

Original creation time: 2015-06-16 06:34:27

CC:  vivianepons


```
            sage: CFiniteSequence(x/(1-x^2)).closed_form()
            -1/2*(-1)^n + 1/2
            sage: CFiniteSequence(x*(x^2+4*x+1)/(1-x)^5).closed_form()
            1/4*n^4 + 1/2*n^3 + 1/4*n^2
            sage: CFiniteSequence((1+2*x-x^2)/(1-x)^4/(1+x)^2).closed_form()
            1/12*n^3 - 1/8*(-1)^n*(n + 1) + 3/4*n^2 + 43/24*n + 9/8
            sage: CFiniteSequence(1/(1-x)/(1-2*x)/(1-3*x)).closed_form()
            1/2*3^(n + 2) - 2^(n + 2) + 1/2
            sage: CFiniteSequence(x/(1-x^3)).closed_form()
            1/9*sqrt(3)*(sqrt(3) + 6*sin(2/3*pi*n))
            sage: CFiniteSequence(x/(1-x^4)).closed_form()
            1/2*I*(-I)^n - 1/2*I*(-1)^(1/2*n) - 1/4*(-1)^n + 1/4
            sage: CFiniteSequence(x/(1-x-x^2)).closed_form()
            -1/5*sqrt(5)*((-2/(sqrt(5) + 1))^n - (2/(sqrt(5) - 1))^n)
            sage: CFiniteSequence(x/(1+x^4)).closed_form()
            -(0.1767766952966369? - 0.1767766952966369?*I)*(0.7071067811865475? + ...
```



---

Comment by rws created at 2015-06-16 06:42:30

This is only lacking implementation of ogf factors of form `P/Q^c` with `Q` polynomial of degree `>1`, and `c>1`. Needs research, probably even a new concept.
----
New commits:


---

Comment by rws created at 2015-06-16 06:42:30

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2015-08-10 08:46:17

Hello Ralf,

Sorry, I am late into the `CFiniteSequence` implementation. So my comment are not especially appropriate for this ticket.

Did you notice that there is already `sage/combinat/binary_recurrence_sequences.py`? It is far from being perfect but multiplying the implementations is *very* confusing. And what was your motivation to put this in `sage.rings`?

Vincent


---

Comment by rws created at 2015-08-11 06:20:29

Vincent, you probably read the word `fibonacci`, but did you notice that in `binary_recurrence_sequences.py` only a small part of C-finite sequences is treated, ie those of degree 2? Have you noticed that our implementation can guess a sequence from the numbers? And with this ticket you get a closed form for immediate and fast evaluation of any binary or other recurrence.

As to your question about the ring of C-finite sequences I refer you to 

```
.. [Z11] Zeilberger, Doron. "The C-finite ansatz." The Ramanujan Journal
   (2011): 1-10.
```



---

Comment by vdelecroix created at 2015-08-11 08:12:23

Replying to [comment:5 rws]:
> Vincent, you probably read the word `fibonacci`, but did you notice that in `binary_recurrence_sequences.py` only a small part of C-finite sequences is treated, ie those of degree 2? Have you noticed that our implementation can guess a sequence from the numbers? And with this ticket you get a closed form for immediate and fast evaluation of any binary or other recurrence.

I have enough mathematical background to know that binary means two. Recurrence of degree 2 is a particular case and this is why it may have been a _starting point_ for general linear recurrence sequences. I never claimed that you redid what was already done. But just that you ignored other's work.

> As to your question about the ring of C-finite sequences I refer you to 
> {{{
> .. [Z11] Zeilberger, Doron. "The C-finite ansatz." The Ramanujan Journal
>    (2011): 1-10.
> }}}

The word ring is not in the article... could you give more explanations?


---

Comment by git created at 2016-06-14 08:17:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by arminstraub created at 2016-08-21 03:13:41

Thank you for your work on bringing Binet-like formulas to CFiniteSequences!  That's a nice idea.

There was a couple of issues with the code.  For instance, multiple roots were not fully supported (previously, `CFiniteSequence((x/(1-x-x<sup>2))</sup>2).closed_form()` would return an empty list).  Also, the code seemed unneccesarily difficult for higher degree algebraic roots.

In an attempt to make it more organized (there is no case distinctions now) and to fix the issue of multiple roots, I have rewritten the code.  Please check!


---

Comment by rws created at 2016-08-21 15:37:17

Many thanks for looking at and improving it. This was a long-standing unimplemented part. The code is beautifully small now. Although higher-degree QQbar expressions take a long time for substitution the forms themselves are there. Please add yourself to the reviewers too.


---

Comment by rws created at 2016-08-21 15:37:17

Changing status from needs_review to positive_review.


---

Comment by arminstraub created at 2016-08-21 19:43:07

Thanks for checking!


---

Comment by vbraun created at 2016-08-24 06:45:24

Resolution: fixed
