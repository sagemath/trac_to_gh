# Issue 16179: provide AtlasRep GAP package

Issue created by migration from https://trac.sagemath.org/ticket/16416

Original creator: dimpase

Original creation time: 2014-05-31 02:10:34

CC:  vbraun was

It is needed for a functioning TomLib GAP package, which we do provide, but which is broken due to this.


---

Comment by dimpase created at 2014-05-31 02:56:36

please test (for the updated tarball, see the link in the ticket description).


---

Comment by dimpase created at 2014-05-31 02:56:47

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-05-31 11:34:41

Tarball name must be different (on name per hash).

Branch contains unrelated javascript plotting stuff.


---

Comment by was created at 2014-06-01 02:09:55

I got nowhere (on Ubuntu 14.04 with sage-6.2):


```
$ sage -i http://boxen.math.washington.edu/home/dima/packages/gap_packages-4.7.4.tar.bz2
Attempting to download package gap_packages-4.7.4.tar.bz2
>>> Trying to download http://boxen.math.washington.edu/home/dima/packages/gap_packages-4.7.4.tar.bz2
[............................................................]
gap_packages-4.7.4.tar.bz2
====================================================
Extracting package /usr/local/sage/sage-6.2.rc0/upstream/gap_packages-4.7.4.tar.bz2
-rw-r--r-- 1 salvus salvus 32177447 Jun  1 02:06 /usr/local/sage/sage-6.2.rc0/upstream/gap_packages-4.7.4.tar.bz2
Finished extraction
/usr/local/sage/sage-6.2.rc0/src/bin/sage-spkg: line 594: cd: gap_packages-4.7.4.tar.bz2: No such file or directory
Error: after extracting, the directory gap_packages-4.7.4.tar.bz2 does not exist
```


This is probably just another instance of 7-year old functionality of Sage conflicting with "the git transition"...


---

Comment by was created at 2014-06-01 02:11:15

Replying to [comment:6 vbraun]:
> Tarball name must be different (on name per hash).
> 
> Branch contains unrelated javascript plotting stuff.

Ugh -- this is exactly the problem with the branch approach (instead of patch approach) to development that everybody is complaining about on sage-devel right now.   Does this happen all the time?


---

Comment by dimpase created at 2014-06-01 02:31:27

Replying to [comment:7 was]:
> I got nowhere (on Ubuntu 14.04 with sage-6.2):
> 
> {{{
> $ sage -i http://boxen.math.washington.edu/home/dima/packages/gap_packages-4.7.4.tar.bz2
> Attempting to download package gap_packages-4.7.4.tar.bz2
> >>> Trying to download http://boxen.math.washington.edu/home/dima/packages/gap_packages-4.7.4.tar.bz2
> [............................................................]
> gap_packages-4.7.4.tar.bz2
> ====================================================
> Extracting package /usr/local/sage/sage-6.2.rc0/upstream/gap_packages-4.7.4.tar.bz2
> -rw-r--r-- 1 salvus salvus 32177447 Jun  1 02:06 /usr/local/sage/sage-6.2.rc0/upstream/gap_packages-4.7.4.tar.bz2
> Finished extraction
> /usr/local/sage/sage-6.2.rc0/src/bin/sage-spkg: line 594: cd: gap_packages-4.7.4.tar.bz2: No such file or directory
> Error: after extracting, the directory gap_packages-4.7.4.tar.bz2 does not exist
> }}}
> 

download the tarball to `$SAGEROOT/upstream` and then run sage -f gap_packages

it will work then.

> This is probably just another instance of 7-year old functionality of Sage conflicting with "the git transition"...


---

Comment by dimpase created at 2014-06-01 03:11:14

Replying to [comment:10 dimpase]:

this addresses both the branch mess (sorry, my fault!) and the tarball naming.

I also checked that `AtlasRep` works just fine on OSX if one installs `wget` (to some global place like `/usr/local/bin`).
[`wget`](http://ftp.gnu.org/gnu/wget/wget-1.14.tar.gz) builds just fine on OSX 10.9.3 if configured with 

```
./configure --with-ssl=openssl
```

----
New commits:


---

Comment by vbraun created at 2014-06-01 12:08:04

Replying to [comment:8 was]:
> Ugh -- this is exactly the problem with the branch approach (instead of patch approach) 

No its not, basing your branch on the wrong starting point is just as much of a problem as diffing your patch relative to the wrong base. Its only easier to detect and fix with git since the history is recorded and can be edited if necessary.


---

Comment by vbraun created at 2014-06-01 12:10:56

The tarball name must match the `package-version.txt`, i.e. `gap_packages-4.7.4.20140531.tar.bz`


---

Comment by dimpase created at 2014-06-01 12:13:50

Replying to [comment:13 vbraun]:
> The tarball name must match the `package-version.txt`, i.e. `gap_packages-4.7.4.20140531.tar.bz`

but it does match in the new branch u/dimpase/16416, no?


---

Comment by vbraun created at 2014-06-01 12:25:51

The branch was correct, just not the actual name of the tarball (but is fixed now)


---

Comment by vbraun created at 2014-06-01 12:25:51

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2014-06-01 12:49:10

Replying to [comment:17 vbraun]:
> The branch was correct, just not the actual name of the tarball (but is fixed now)
Thanks. I changed the ticket description only after shooting off the question in comment 15, realising the nature of your complaint... 

Regarding the problem to install an spkg from a specific URL - is it a bug or a feature?


---

Comment by vbraun created at 2014-06-01 13:33:10

You can install an old-style spkg (containing `spkg-install` and so on inside the archive) from a url. It has never been supported to install a tarball from a url (where is the build script, what about checksums, etc).


---

Comment by was created at 2014-06-01 16:49:39

Replying to [comment:19 vbraun]:
> You can install an old-style spkg (containing `spkg-install` and so on inside the archive) from a url. It has never 
> been supported to install a tarball from a url (where is the build script, what about checksums, etc).

Then "sage -i foo.tar.bz2" should immediately give an error, rather than downloading the tarball, extracting it, etc.?


---

Comment by was created at 2014-06-01 16:52:47

Replying to [comment:11 dimpase]:
> Replying to [comment:10 dimpase]:
> 
> this addresses both the branch mess (sorry, my fault!) and the tarball naming.
> 
> I also checked that `AtlasRep` works just fine on OSX if one installs `wget` (to some global place like `/usr/local/bin`).
> [`wget`](http://ftp.gnu.org/gnu/wget/wget-1.14.tar.gz) builds just fine on OSX 10.9.3 if configured with 
> {{{
> ./configure --with-ssl=openssl
> }}}
> ----
> New commits:
> ||[203e3cd](http://git.sagemath.org/sage.git/commit/?id=203e3cd084c8c51eb1b855dbc6925c7c02fb25b6)||`changes necessary for the updated gap_packages tarball, which includes`||

It's `OS X`, not `OSX`.  For what it's worth, curl is standard on OS X instead of wget and can do the same thing (though with very different commands).   This is probably due to licensing, as wget is GPL'd and curl is MIT licensed.   Apple tries very hard to avoid shipping GPL'd software.


---

Comment by vbraun created at 2014-06-01 17:15:18

Replying to [comment:20 was]:
> Then "sage -i foo.tar.bz2" should immediately give an error, rather than downloading the tarball, extracting it, etc.?

I agree, feel free to fix it.


---

Comment by vbraun created at 2014-06-01 18:22:47

Resolution: fixed
