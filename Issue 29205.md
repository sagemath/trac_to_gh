# Issue 29205: Fix failing doctest in src/sage/interfaces/tachyon.py

Issue created by migration from https://trac.sagemath.org/ticket/29442

Original creator: @kliem

Original creation time: 2020-04-01 08:25:01

CC:  mkoeppe

Keywords: tachyon


```
sage -t src/sage/interfaces/tachyon.py
**********************************************************************
File "src/sage/interfaces/tachyon.py", line 175, in sage.interfaces.tachyon.TachyonRT.usage
Failed example:
    t.usage(use_pager=False)
Expected:
    Tachyon Parallel/Multiprocessor Ray Tracer   Version...
Got:
    Usage: tachyon modelfile [options] 
    <BLANKLINE>
    Valid options and accepted formats are as follows (** denotes default behaviour).
    <BLANKLINE>
    Model file formats supported:
...
```


This seems to have been introduced by using the systems tachyon. It appears that in some cases (depending on the version probably) tachyon does not print out the first lines

```
Tachyon Parallel/Multiprocessor Ray Tracer   Version 0.98.9   
Copyright 1994-2010,    John E. Stone <john.stone@gmail.com> 
------------------------------------------------------------ 
```


We fix this by testing for the following output:

```
...
Usage: 
  tachyon modelfile [options] 

Model file formats supported:
  filename.dat ...
```



---

Comment by @kliem created at 2020-04-01 08:28:17

New commits:


---

Comment by @kliem created at 2020-04-01 08:28:17

Changing status from new to needs_review.


---

Comment by chapoton created at 2020-04-01 10:25:25

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2020-04-01 10:25:25

ok, thanks


---

Comment by @kliem created at 2020-04-01 20:01:27

Changing status from positive_review to needs_work.


---

Comment by @kliem created at 2020-04-01 20:01:27

I should have double checked.


```
Usage: tachyon modelfile [options] 
    <BLANKLINE>
    Valid options and accepted formats are as follows (** denotes default behaviour).
    <BLANKLINE>
    Model file formats supported:
```



---

Comment by git created at 2020-04-01 20:06:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @kliem created at 2020-04-01 20:07:02

Changing status from needs_work to needs_review.


---

Comment by @kliem created at 2020-04-01 20:07:02

Sorry, but the ticket as it was would have been pointless.
----
New commits:
----
New commits:


---

Comment by mkoeppe created at 2020-04-02 13:03:07

Changing status from needs_review to needs_work.


---

Comment by mkoeppe created at 2020-04-02 13:03:07

I don't think doctest results starting with "..." work because they are mistaken for continuation prompts.
See https://github.com/mkoeppe/sage/runs/553984065

```
File "src/sage/interfaces/tachyon.py", line 175, in sage.interfaces.tachyon.TachyonRT.usage
Failed example:
    t.usage(use_pager=False)
Expected:
    ...
    Usage:
      tachyon modelfile [options]...
    Model file formats supported:
      filename.dat ...
Got:
    Usage: tachyon modelfile [options] 
    <BLANKLINE>
    Valid options and accepted formats are as follows (** denotes default behaviour).
    <BLANKLINE>
```



---

Comment by @kliem created at 2020-04-02 15:24:14

Ok. Now, I'm testing internally the following and it seems it passes:


```
            sage: from sage.interfaces.tachyon import TachyonRT
            sage: t = TachyonRT()
            sage: t.usage(use_pager=False)
            ...
              tachyon modelfile [options]...
            <BLANKLINE>
            Model file formats supported:
              filename.dat ...
            sage: print("Usage: tachyon modelfile [options]\n\nValid options and accepted formats are as follows (** denotes default behaviour).\n\nModel file formats supported    +++:\n  filename.dat        the model files originated with this package")
            ...
              tachyon modelfile [options]...
            Model file formats supported:
              filename.dat ...
```



---

Comment by git created at 2020-04-02 15:25:35

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by @kliem created at 2020-04-02 15:26:04

Changing status from needs_work to needs_review.


---

Comment by @kliem created at 2020-04-05 06:23:51

This seems to work now

https://github.com/kliem/sage-test-27122/actions/runs/70559675

There are many clean runs now.


---

Comment by mkoeppe created at 2020-04-18 16:42:33

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-04-18 16:42:33

Looks good to me.


---

Comment by vbraun created at 2020-04-22 20:52:32

Resolution: fixed
