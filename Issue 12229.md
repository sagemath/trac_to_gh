# Issue 12229: Get Pynac functions to work on FreeBSD

Issue created by migration from Trac.

Original creator: kcrisman

Original creation time: 2012-01-31 02:25:36

Assignee: pjeremy

CC:  pjeremy

This could just be related to the [ticket:9543 Cephes on FreeBSD ticket].  But it seems that using slightly different functions in one of the Pynac files helps on FreeBSD.  As reported by [Stephen Montgomery-Smith](http://groups.google.com/group/sage-devel/browse_thread/thread/2feec7c5511c4ae5/910b7f95f297678b):

```

--- sage-4.8/sage/symbolic/pynac_cc.h.orig	2010-06-28 16:37:01.000000000 +0000
+++ sage-4.8/sage/symbolic/pynac_cc.h	2012-01-21 22:48:22.000000000 +0000
`@``@` -1,37 +1,21 `@``@`
-#include <math.h>
+#include <cmath>
 
 inline long double sage_logl(long double x) 
 {
-#if defined(__CYGWIN__)
   return log(x);
-#else
-  return logl(x);
-#endif 
 }
 
 inline long double sage_sqrtl(long double x) 
 {
-#if defined(__CYGWIN__)
   return sqrt(x);
-#else
-  return sqrtl(x);
-#endif 
 } 
 
 inline long double sage_tgammal(long double x) 
 {
-#if defined(__CYGWIN__)
   return tgamma(x);
-#else
-  return tgammal(x);
-#endif 
 }
 
 inline long double sage_lgammal(long double x)
 {
-#if defined(__CYGWIN__)
   return lgamma(x);
-#else
-  return lgammal(x);
-#endif 
 }
```



---

Attachment

Updated patch for pynac_cc.h


---

Comment by stephen created at 2012-04-08 14:35:09

Please use the updated patch instead.  It should be possible to add this patch without interfering with builds from other OS.


```
--- sage-5.0.beta12/sage/symbolic/pynac_cc.h-orig	2012-04-07 22:52:53.000000000 +0000
+++ sage-5.0.beta12/sage/symbolic/pynac_cc.h	2012-04-07 22:53:27.000000000 +0000
`@``@` -2,7 +2,7 `@``@`
 
 inline long double sage_logl(long double x) 
 {
-#if defined(__CYGWIN__)
+#if defined(__CYGWIN__) || defined(__FreeBSD__)
   return log(x);
 #else
   return logl(x);
`@``@` -11,7 +11,7 `@``@`
 
 inline long double sage_sqrtl(long double x) 
 {
-#if defined(__CYGWIN__)
+#if defined(__CYGWIN__) || defined(__FreeBSD__)
   return sqrt(x);
 #else
   return sqrtl(x);
`@``@` -20,7 +20,7 `@``@`
 
 inline long double sage_tgammal(long double x) 
 {
-#if defined(__CYGWIN__)
+#if defined(__CYGWIN__) || defined(__FreeBSD__)
   return tgamma(x);
 #else
   return tgammal(x);
`@``@` -29,7 +29,7 `@``@`
 
 inline long double sage_lgammal(long double x)
 {
-#if defined(__CYGWIN__)
+#if defined(__CYGWIN__) || defined(__FreeBSD__)
   return lgamma(x);
 #else
   return lgammal(x);
```



---

Comment by stephen created at 2012-04-14 21:02:11

The changes reported here do not need to be made if the following trac is committed:

http://trac.sagemath.org/sage_trac/ticket/9543


---

Comment by kcrisman created at 2012-06-20 19:25:24

Okay, this sounds almost like a positive review.  Once #9543 is in, we can probably close this, then.


---

Comment by kcrisman created at 2013-01-16 01:35:49

Changing status from new to needs_review.


---

Comment by kcrisman created at 2013-01-16 01:35:49

Well, #9543 is now in.  Stephen, when you end up building Sage 5.6 (whenever that comes out), a quick switch to "positive review" is all that would be needed here.


---

Comment by stephen created at 2013-01-16 02:42:31

I have already checked it out using sage 5.6.rc0.  Is it OK if I set it to "positive review" now?


---

Comment by kcrisman created at 2013-01-16 02:52:00

Changing status from needs_review to positive_review.


---

Comment by kcrisman created at 2013-01-16 02:52:00

> I have already checked it out using sage 5.6.rc0.  Is it OK if I set it to "positive review" now?
That was what I meant :-) so I'll do it now.  Thanks so much for your continuing help.


---

Comment by jdemeyer created at 2013-01-17 10:04:04

Resolution: worksforme
