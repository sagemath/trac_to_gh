# Issue 15979: Improve PEP8 compliance: replace "== None" by "is None"

archive/issues_015979.json:
```json
{
    "body": "CC:  @tscrim\n\nKeywords: pep8\n\nTo cite from [PEP8](http://legacy.python.org/dev/peps/pep-0008/):\n\n\nComparisons to singletons like None should always be done with is or is not, never the equality operators.\n\nThis ticket is also related to a promise in ticket:15984.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16216\n\n",
    "created_at": "2014-04-23T12:28:28Z",
    "labels": [
        "component: build",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Improve PEP8 compliance: replace \"== None\" by \"is None\"",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15979",
    "user": "https://github.com/wluebbe"
}
```
CC:  @tscrim

Keywords: pep8

To cite from [PEP8](http://legacy.python.org/dev/peps/pep-0008/):


Comparisons to singletons like None should always be done with is or is not, never the equality operators.

This ticket is also related to a promise in ticket:15984.

Issue created by migration from https://trac.sagemath.org/ticket/16216





---

archive/issue_comments_207111.json:
```json
{
    "body": "Hi Travis, these are the changes you suggested in ticket:15984.\n\n\nWould you like to review this ticket?\n----\nNew commits:",
    "created_at": "2014-04-24T05:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207111",
    "user": "https://github.com/wluebbe"
}
```

Hi Travis, these are the changes you suggested in ticket:15984.


Would you like to review this ticket?
----
New commits:



---

archive/issue_comments_207112.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-04-24T05:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207112",
    "user": "https://github.com/wluebbe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_207113.json:
```json
{
    "body": "Why not provide a script here? It should be possible to apply it just before the stable release.\n\nWith a simple grep I found many more instances in\n\n- sage/coding/code_bounds.py\n- sage/schemes/toric/variety.py\n- sage/schemes/toric/chow_group.py\n- sage/schemes/projective/projective_morphism.py\n- sage/schemes/generic/divisor_group.py\n- sage/schemes/elliptic_curves/weierstrass_morphism.py\n- sage/schemes/elliptic_curves/ell_finite_field.py\n- sage/schemes/elliptic_curves/ell_generic.py\n- sage/geometry/toric_lattice.py\n- sage/geometry/triangulation/point_configuration.py\n- sage/geometry/polyhedron/misc.py\n- sage/geometry/polyhedron/cdd_file_format.py\n- sage/geometry/polyhedron/face.py\n- sage/numerical/optimize.py\n- sage/calculus/desolvers.py\n- sage/sandpiles/sandpile.py\n- sage/graphs/generic_graph.py\n- sage/graphs/graph_coloring.py\n- sage/graphs/graph.py\n- sage/modular/modform/ambient_eps.py\n- sage/categories/coxeter_groups.py\n- sage/matrix/constructor.py\n- sage/quadratic_forms/quadratic_form__ternary_Tornaria.py\n- sage/interfaces/singular.py\n- sage/combinat/root_system/root_lattice_realizations.py\n- sage/combinat/sf/ns_macdonald.py\n- sage/combinat/tableau_tuple.py\n- sage/combinat/composition_tableau.py\n- sage/combinat/k_tableau.py\n- sage/combinat/affine_permutation.py\n- sage/ext/gen_interpreters.py",
    "created_at": "2014-04-24T07:58:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207113",
    "user": "https://github.com/videlec"
}
```

Why not provide a script here? It should be possible to apply it just before the stable release.

With a simple grep I found many more instances in

- sage/coding/code_bounds.py
- sage/schemes/toric/variety.py
- sage/schemes/toric/chow_group.py
- sage/schemes/projective/projective_morphism.py
- sage/schemes/generic/divisor_group.py
- sage/schemes/elliptic_curves/weierstrass_morphism.py
- sage/schemes/elliptic_curves/ell_finite_field.py
- sage/schemes/elliptic_curves/ell_generic.py
- sage/geometry/toric_lattice.py
- sage/geometry/triangulation/point_configuration.py
- sage/geometry/polyhedron/misc.py
- sage/geometry/polyhedron/cdd_file_format.py
- sage/geometry/polyhedron/face.py
- sage/numerical/optimize.py
- sage/calculus/desolvers.py
- sage/sandpiles/sandpile.py
- sage/graphs/generic_graph.py
- sage/graphs/graph_coloring.py
- sage/graphs/graph.py
- sage/modular/modform/ambient_eps.py
- sage/categories/coxeter_groups.py
- sage/matrix/constructor.py
- sage/quadratic_forms/quadratic_form__ternary_Tornaria.py
- sage/interfaces/singular.py
- sage/combinat/root_system/root_lattice_realizations.py
- sage/combinat/sf/ns_macdonald.py
- sage/combinat/tableau_tuple.py
- sage/combinat/composition_tableau.py
- sage/combinat/k_tableau.py
- sage/combinat/affine_permutation.py
- sage/ext/gen_interpreters.py



---

archive/issue_comments_207114.json:
```json
{
    "body": "I guess something like the following would do the job (trickier than what I thought... I edited twice my answer)\n\n```/usr/bin/env bash\n\nfor f in $(find . -name \"*py\");\ndo\n    echo \"processing $f\"\n    sed -i -e's/==\\ *None$/is None/g' $f\n    sed -i -e's/==\\ *None\\([ :)]\\)/is None\\1/g' $f\n    sed -i -e's/!=\\ *None$/is not None/g' $f\n    sed -i -e's/!=\\ *None\\([ :)]\\)/is not None\\1/g' $f\ndone\n```\n",
    "created_at": "2014-04-24T08:19:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207114",
    "user": "https://github.com/videlec"
}
```

I guess something like the following would do the job (trickier than what I thought... I edited twice my answer)

```/usr/bin/env bash

for f in $(find . -name "*py");
do
    echo "processing $f"
    sed -i -e's/==\ *None$/is None/g' $f
    sed -i -e's/==\ *None\([ :)]\)/is None\1/g' $f
    sed -i -e's/!=\ *None$/is not None/g' $f
    sed -i -e's/!=\ *None\([ :)]\)/is not None\1/g' $f
done
```




---

archive/issue_comments_207115.json:
```json
{
    "body": "I did it with a small Python script, but instead of \"\\w*\" I had \"\\w+\"  :-(\n\n\nWait a minute ... ;-)",
    "created_at": "2014-04-24T09:12:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207115",
    "user": "https://github.com/wluebbe"
}
```

I did it with a small Python script, but instead of "\w*" I had "\w+"  :-(


Wait a minute ... ;-)



---

archive/issue_comments_207116.json:
```json
{
    "body": "In [that thread](https://groups.google.com/forum/#!topic/sage-devel/SN93zx3YnAA) on sage-devel I asked the question of whether we can provide a script rather than a branch... it would make more sense here.\n\nVincent",
    "created_at": "2014-04-24T09:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207116",
    "user": "https://github.com/videlec"
}
```

In [that thread](https://groups.google.com/forum/#!topic/sage-devel/SN93zx3YnAA) on sage-devel I asked the question of whether we can provide a script rather than a branch... it would make more sense here.

Vincent



---

archive/issue_comments_207117.json:
```json
{
    "body": "See also [this thread](https://groups.google.com/forum/#!msg/sage-devel/r-85whQZGhY/KkUkGMzg7tgJ)",
    "created_at": "2014-04-24T09:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207117",
    "user": "https://github.com/videlec"
}
```

See also [this thread](https://groups.google.com/forum/#!msg/sage-devel/r-85whQZGhY/KkUkGMzg7tgJ)



---

archive/issue_comments_207118.json:
```json
{
    "body": "Such scripts should ideally be applied by the release manager right before doing a new stable release.  Not sure whether Volker is aware of this ticket.\n\nFor new code / changes, it's up to the reviewers to check no new instances get introduced. ;-)",
    "created_at": "2014-04-24T10:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207118",
    "user": "https://github.com/nexttime"
}
```

Such scripts should ideally be applied by the release manager right before doing a new stable release.  Not sure whether Volker is aware of this ticket.

For new code / changes, it's up to the reviewers to check no new instances get introduced. ;-)



---

archive/issue_comments_207119.json:
```json
{
    "body": "Thanks Leif. I will ask Volker directly if he does not answer on sage-devel.\n\nThe script was not the good one (because of things like \"my_variable!=None\"), new try\n\n```/usr/bin/env bash\n\nfor f in $(find . -name \"*py\");\ndo\n    echo \"processing $f\"\n    sed -i -e's/\\ *==\\ *None$/ is None/g' $f\n    sed -i -e's/\\ *==\\ *None\\([ :)]\\)/ is None\\1/g' $f\n    sed -i -e's/\\ *!=\\ *None$/ is not None/g' $f\n    sed -i -e's/\\ *!=\\ *None\\([ :)]\\)/ is not None\\1/g' $f\ndone\n```\n\nI applied it to Sage source code, and obtain 505 occurrences... and Sage even starts after that!!",
    "created_at": "2014-04-24T10:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207119",
    "user": "https://github.com/videlec"
}
```

Thanks Leif. I will ask Volker directly if he does not answer on sage-devel.

The script was not the good one (because of things like "my_variable!=None"), new try

```/usr/bin/env bash

for f in $(find . -name "*py");
do
    echo "processing $f"
    sed -i -e's/\ *==\ *None$/ is None/g' $f
    sed -i -e's/\ *==\ *None\([ :)]\)/ is None\1/g' $f
    sed -i -e's/\ *!=\ *None$/ is not None/g' $f
    sed -i -e's/\ *!=\ *None\([ :)]\)/ is not None\1/g' $f
done
```

I applied it to Sage source code, and obtain 505 occurrences... and Sage even starts after that!!



---

archive/issue_comments_207120.json:
```json
{
    "body": "There are several competing / overlapping tools that could support such a \"project\". \nHere are some links:\n* [Pylint](http://www.pylint.org/) and [in PIP](https://pypi.python.org/pypi/pylint/1.2.0)\n* [pep8](http://pep8.readthedocs.org/en/latest/) and [in PIP](https://pypi.python.org/pypi/pep8)\n* [flake8](https://bitbucket.org/tarek/flake8/wiki/Home) and [in PIP](https://pypi.python.org/pypi/flake8)\n* [pyflakes](https://github.com/pyflakes/pyflakes/) and [in PIP](https://pypi.python.org/pypi/pyflakes/0.8.1)\n* [frosted](https://github.com/timothycrosley/frosted) and [in PIP](https://pypi.python.org/pypi/frosted)\n\nThe cross tool mailing list is [code-quality](https://mail.python.org/mailman/listinfo/code-quality).\n\nThese are the Python guidelines:\n* [PEP8 Style Guide for Python Code](http://legacy.python.org/dev/peps/pep-0008/)\n* [PEP257 Docstring Conventions](http://legacy.python.org/dev/peps/pep-0257/)\n* [PEP7 Style Guide for C Code](http://legacy.python.org/dev/peps/pep-0007/)\n\nI had a quick look at them - there is no obvious BEST one.\nBut it would certainly be worthwhile to select / combine / customize them for use with Sage.",
    "created_at": "2014-04-24T10:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207120",
    "user": "https://github.com/wluebbe"
}
```

There are several competing / overlapping tools that could support such a "project". 
Here are some links:
* [Pylint](http://www.pylint.org/) and [in PIP](https://pypi.python.org/pypi/pylint/1.2.0)
* [pep8](http://pep8.readthedocs.org/en/latest/) and [in PIP](https://pypi.python.org/pypi/pep8)
* [flake8](https://bitbucket.org/tarek/flake8/wiki/Home) and [in PIP](https://pypi.python.org/pypi/flake8)
* [pyflakes](https://github.com/pyflakes/pyflakes/) and [in PIP](https://pypi.python.org/pypi/pyflakes/0.8.1)
* [frosted](https://github.com/timothycrosley/frosted) and [in PIP](https://pypi.python.org/pypi/frosted)

The cross tool mailing list is [code-quality](https://mail.python.org/mailman/listinfo/code-quality).

These are the Python guidelines:
* [PEP8 Style Guide for Python Code](http://legacy.python.org/dev/peps/pep-0008/)
* [PEP257 Docstring Conventions](http://legacy.python.org/dev/peps/pep-0257/)
* [PEP7 Style Guide for C Code](http://legacy.python.org/dev/peps/pep-0007/)

I had a quick look at them - there is no obvious BEST one.
But it would certainly be worthwhile to select / combine / customize them for use with Sage.



---

archive/issue_comments_207121.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-24T10:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207121",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207122.json:
```json
{
    "body": "1) The script can be done with only one call to sed and is much faster that way (took less than 10 secs on my computer)\n\n```/usr/bin/env bash\n\nfor f in $(find . -name \"*py\");\ndo\n    echo \"processing $f\"\n    sed -i -e's/\\ *==\\ *None$/ is None/g' \\\n           -e's/\\ *==\\ *None\\([ :)]\\)/ is None\\1/g' \\\n           -e's/\\ *!=\\ *None$/ is not None/g' \\\n           -e's/\\ *!=\\ *None\\([ :)]\\)/ is not None\\1/g' $f\ndone\n```\n\n\n2) There are few things to fix by hand. For example, some occurrences appear in the docstrings and the script did bad to them (src/sage/ext/gen_interpreters.py, src/sage/geometry/polyhedron/misc.py, ...)\n\nFor Wilfried:\n\n3) It is not a good idea to provide a git branch (it will certainly create plenty of conflicts). The best would be to apply the script just before the stable release.\n\n4) If you used a script different from mine, it would be nice that you provide it!",
    "created_at": "2014-04-24T10:57:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207122",
    "user": "https://github.com/videlec"
}
```

1) The script can be done with only one call to sed and is much faster that way (took less than 10 secs on my computer)

```/usr/bin/env bash

for f in $(find . -name "*py");
do
    echo "processing $f"
    sed -i -e's/\ *==\ *None$/ is None/g' \
           -e's/\ *==\ *None\([ :)]\)/ is None\1/g' \
           -e's/\ *!=\ *None$/ is not None/g' \
           -e's/\ *!=\ *None\([ :)]\)/ is not None\1/g' $f
done
```


2) There are few things to fix by hand. For example, some occurrences appear in the docstrings and the script did bad to them (src/sage/ext/gen_interpreters.py, src/sage/geometry/polyhedron/misc.py, ...)

For Wilfried:

3) It is not a good idea to provide a git branch (it will certainly create plenty of conflicts). The best would be to apply the script just before the stable release.

4) If you used a script different from mine, it would be nice that you provide it!



---

archive/issue_comments_207123.json:
```json
{
    "body": "The update also includes some pyx modules. And a few py modules not in your list.\n\nThe regexp now looks like\n\n```\n  c_pat_1 = re.compile(r\"\"\"\\s? == \\s* None \\b\"\"\", re.VERBOSE)\n  contents_1, n1 = re.subn(c_pat_1, \" is None\", contents_0)\n  c_pat_2 = re.compile(r\"\"\"\\s? != \\s* None \\b\"\"\", re.VERBOSE)\n  new_contents, n2 = re.subn(c_pat_2, \" is not None\", contents_1)\n```\n",
    "created_at": "2014-04-24T10:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207123",
    "user": "https://github.com/wluebbe"
}
```

The update also includes some pyx modules. And a few py modules not in your list.

The regexp now looks like

```
  c_pat_1 = re.compile(r"""\s? == \s* None \b""", re.VERBOSE)
  contents_1, n1 = re.subn(c_pat_1, " is None", contents_0)
  c_pat_2 = re.compile(r"""\s? != \s* None \b""", re.VERBOSE)
  new_contents, n2 = re.subn(c_pat_2, " is not None", contents_1)
```




---

archive/issue_comments_207124.json:
```json
{
    "body": "Replying to [comment:11 vdelecroix]:\n> 3) It is not a good idea to provide a git branch (it will certainly create plenty of conflicts). The best would be to apply the script just before the stable release.\nI would agree but at least once you have to clean up the existing stuff. - And the conflicts should be manageable.\n\n\n\n\n> 4) If you used a script different from mine, it would be nice that you provide it!\nI am more familiar with Python than with the classic Un*x tools like grep and sed :-/\n\n\nI attached my quick and dirty Python script.",
    "created_at": "2014-04-24T11:21:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207124",
    "user": "https://github.com/wluebbe"
}
```

Replying to [comment:11 vdelecroix]:
> 3) It is not a good idea to provide a git branch (it will certainly create plenty of conflicts). The best would be to apply the script just before the stable release.
I would agree but at least once you have to clean up the existing stuff. - And the conflicts should be manageable.




> 4) If you used a script different from mine, it would be nice that you provide it!
I am more familiar with Python than with the classic Un*x tools like grep and sed :-/


I attached my quick and dirty Python script.



---

archive/issue_comments_207125.json:
```json
{
    "body": "There's also at least one occurrence in `.rst` source (as opposed to generated) files:\n\n\n```\nsrc/doc/en/thematic_tutorials/lie/crystals.rst:421:    sage: v.f(1).f(1) == None\n```\n",
    "created_at": "2014-04-24T11:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207125",
    "user": "https://github.com/nexttime"
}
```

There's also at least one occurrence in `.rst` source (as opposed to generated) files:


```
src/doc/en/thematic_tutorials/lie/crystals.rst:421:    sage: v.f(1).f(1) == None
```




---

archive/issue_comments_207126.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-04-24T13:25:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207126",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207127.json:
```json
{
    "body": "This was also the only `.rst` I could find.",
    "created_at": "2014-04-24T13:26:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207127",
    "user": "https://github.com/wluebbe"
}
```

This was also the only `.rst` I could find.



---

archive/issue_comments_207128.json:
```json
{
    "body": "Update for .rst and to exclude selected modules",
    "created_at": "2014-04-24T13:42:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207128",
    "user": "https://github.com/wluebbe"
}
```

Update for .rst and to exclude selected modules



---

archive/issue_comments_207129.json:
```json
{
    "body": "Attachment [patch-isNone.py](tarball://root/attachments/some-uuid/ticket16216/patch-isNone.py) by @videlec created at 2014-04-24 13:53:19\n\nHi,\n\nThanks Wilfried for providing your script. Your regexps look much nicer than mine!\n\nThe syntax for regexp in sed is (almost) the same as in Python! You can write what you did in sed as\n\n```\nsed -e's/\\s\\?==\\s*None\\b/ is None/g' \\\n    -e's/\\s\\?!=\\s*None\\b/ is not None/g' my_file.py\n```\n\n\nInstead of the for loop, it is faster and cleaner to use xargs. The following one-line command takes care of py and pyx files.\n\n```\nfind -regex \".*pyx?\" | xargs sed -i        \\\n        -e's/\\s\\?==\\s*None\\b/ is None/g'   \\\n        -e's/\\s\\?!=\\s*None\\b/ is not None/g'\n```\n\nWith the command above I got 637 instances on 6.2.rc0.\n\nAt the very last, there are two possibilities to avoid occurrence of \"bla == None\" in the future (see Volker's answer in [that thread](https://groups.google.com/forum/#!topic/sage-devel/SN93zx3YnAA)):\n- provide a pre-commit hook for git\n- modify the \"sage -b\" command\n\nVincent\n\nPS: sed is not Unix but [GNU](http://www.gnu.org/)!",
    "created_at": "2014-04-24T13:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207129",
    "user": "https://github.com/videlec"
}
```

Attachment [patch-isNone.py](tarball://root/attachments/some-uuid/ticket16216/patch-isNone.py) by @videlec created at 2014-04-24 13:53:19

Hi,

Thanks Wilfried for providing your script. Your regexps look much nicer than mine!

The syntax for regexp in sed is (almost) the same as in Python! You can write what you did in sed as

```
sed -e's/\s\?==\s*None\b/ is None/g' \
    -e's/\s\?!=\s*None\b/ is not None/g' my_file.py
```


Instead of the for loop, it is faster and cleaner to use xargs. The following one-line command takes care of py and pyx files.

```
find -regex ".*pyx?" | xargs sed -i        \
        -e's/\s\?==\s*None\b/ is None/g'   \
        -e's/\s\?!=\s*None\b/ is not None/g'
```

With the command above I got 637 instances on 6.2.rc0.

At the very last, there are two possibilities to avoid occurrence of "bla == None" in the future (see Volker's answer in [that thread](https://groups.google.com/forum/#!topic/sage-devel/SN93zx3YnAA)):
- provide a pre-commit hook for git
- modify the "sage -b" command

Vincent

PS: sed is not Unix but [GNU](http://www.gnu.org/)!



---

archive/issue_comments_207130.json:
```json
{
    "body": "Thanks Vincent, I guess I have to learn these tools :-))\n\nBut I am also still learning git, vim, Linux ... and often even Python. Not to mention Sage!!",
    "created_at": "2014-04-24T14:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207130",
    "user": "https://github.com/wluebbe"
}
```

Thanks Vincent, I guess I have to learn these tools :-))

But I am also still learning git, vim, Linux ... and often even Python. Not to mention Sage!!



---

archive/issue_comments_207131.json:
```json
{
    "body": "Also there is no difference in conflicts with a branch that gets merged into develop versus a script that fixes these things right before release. However it would be nice to have such a script in order to make reviews easier (mostly for reviewers who are unaware of what we're trying to do) and so we don't (re)introduce non-conformance.\n\nLet me know if you need me to review anything (it seems both of you [Vincent and Wilfried] are taking care of it).",
    "created_at": "2014-04-24T14:08:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207131",
    "user": "https://github.com/tscrim"
}
```

Also there is no difference in conflicts with a branch that gets merged into develop versus a script that fixes these things right before release. However it would be nice to have such a script in order to make reviews easier (mostly for reviewers who are unaware of what we're trying to do) and so we don't (re)introduce non-conformance.

Let me know if you need me to review anything (it seems both of you [Vincent and Wilfried] are taking care of it).



---

archive/issue_comments_207132.json:
```json
{
    "body": "Replying to [comment:17 vdelecroix]:\n> Instead of the for loop, it is faster and cleaner to use xargs. The following one-line command takes care of py and pyx files.\n> {{{\n> find -regex \".*pyx?\" | xargs sed -i        \\\n>         -e's/\\s\\?==\\s*None\\b/ is None/g'   \\\n>         -e's/\\s\\?!=\\s*None\\b/ is not None/g'\n> }}}\n\n`-regex` is not portable; one should use `-name \\*.py -o -name \\*.pyx` [`-o -name \\*.rst`] instead.  (And you can also use `sed ... $(find ...)`, or -- preferably -- `find ... -exec sed ...`, because the latter reduces the required size of the environment, i.e. `argv`.)\n\n`sed -i ...` is (unfortunately) also not portable, nor  is `\\s`, and IIRC neither `\\b` nor `\\?`.\n\n\n\n\n> PS: sed is not Unix but [GNU](http://www.gnu.org/)!\n\n`sed` is UNIX from the very beginning, while **G**NU's **N**ot **U**nix! ;-)",
    "created_at": "2014-04-24T17:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207132",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:17 vdelecroix]:
> Instead of the for loop, it is faster and cleaner to use xargs. The following one-line command takes care of py and pyx files.
> {{{
> find -regex ".*pyx?" | xargs sed -i        \
>         -e's/\s\?==\s*None\b/ is None/g'   \
>         -e's/\s\?!=\s*None\b/ is not None/g'
> }}}

`-regex` is not portable; one should use `-name \*.py -o -name \*.pyx` [`-o -name \*.rst`] instead.  (And you can also use `sed ... $(find ...)`, or -- preferably -- `find ... -exec sed ...`, because the latter reduces the required size of the environment, i.e. `argv`.)

`sed -i ...` is (unfortunately) also not portable, nor  is `\s`, and IIRC neither `\b` nor `\?`.




> PS: sed is not Unix but [GNU](http://www.gnu.org/)!

`sed` is UNIX from the very beginning, while **G**NU's **N**ot **U**nix! ;-)



---

archive/issue_comments_207133.json:
```json
{
    "body": "Replying to [comment:19 tscrim]:\n> Also there is no difference in conflicts with a branch that gets merged into develop versus a script that fixes these things right before release.\n\nWell, in application, there is.\n\nAlso, I'd apply it last before preparing a *stable* release, since developers will have to rebase their pending patches afterwards anyway.  (Of course the *number* of potential conflicts with work in progress they'll face doesn't really change though.)",
    "created_at": "2014-04-24T17:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207133",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:19 tscrim]:
> Also there is no difference in conflicts with a branch that gets merged into develop versus a script that fixes these things right before release.

Well, in application, there is.

Also, I'd apply it last before preparing a *stable* release, since developers will have to rebase their pending patches afterwards anyway.  (Of course the *number* of potential conflicts with work in progress they'll face doesn't really change though.)



---

archive/issue_comments_207134.json:
```json
{
    "body": "This ticket now has \n* 177 files changed, 515 insertions, 515 deletions\nbut ticket:15990 had\n* 503 files changed, 3138 insertions, 3170 deletions\nOn the way there were some merge conflict, but nothing serious.\n\n\nTherefore I'm not afraid about conflicts (for this ticket).",
    "created_at": "2014-04-24T18:21:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207134",
    "user": "https://github.com/wluebbe"
}
```

This ticket now has 
* 177 files changed, 515 insertions, 515 deletions
but ticket:15990 had
* 503 files changed, 3138 insertions, 3170 deletions
On the way there were some merge conflict, but nothing serious.


Therefore I'm not afraid about conflicts (for this ticket).



---

archive/issue_comments_207135.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-04-25T08:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207135",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_207136.json:
```json
{
    "body": "Hi,\n\n1) As I already told you, the substitutions made bad things to the documentation. Hopefully, in very few places. For examples\n- `/src/sage/ext/gen_interpreters.py`: we had \"so len==None is different than len==1\" and now it is \"so len is None is different than len==1\".  The new sentence is much harder to read.\n- `/src/sage/coding/code_bounds.py`: in a comment we had \"algorithm==None or algorithm=\"gap\"\" would be better to have \"algorithm=None or algorithm=\"gap\" (instead of the is None here).\n- etc\n\n2) You start removing unnecessary parenthesis. First of all it is not the job of that ticket. Secondly, one can arguably says that code is more readable with more parenthesis. So revert all those changes. If you want to remove parenthesis (which I think is a bad idea in general) then open a discussion on sage-devel and then a ticket if a consensus is reached.\n\nVincent",
    "created_at": "2014-04-25T08:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207136",
    "user": "https://github.com/videlec"
}
```

Hi,

1) As I already told you, the substitutions made bad things to the documentation. Hopefully, in very few places. For examples
- `/src/sage/ext/gen_interpreters.py`: we had "so len==None is different than len==1" and now it is "so len is None is different than len==1".  The new sentence is much harder to read.
- `/src/sage/coding/code_bounds.py`: in a comment we had "algorithm==None or algorithm="gap"" would be better to have "algorithm=None or algorithm="gap" (instead of the is None here).
- etc

2) You start removing unnecessary parenthesis. First of all it is not the job of that ticket. Secondly, one can arguably says that code is more readable with more parenthesis. So revert all those changes. If you want to remove parenthesis (which I think is a bad idea in general) then open a discussion on sage-devel and then a ticket if a consensus is reached.

Vincent



---

archive/issue_comments_207137.json:
```json
{
    "body": "Replying to [comment:23 vdelecroix]:\n> 1) As I already told you, the substitutions made bad things to the documentation. Hopefully, in very few places.\n\nYep, at least where \"is None\" isn't typeset as code.\n\nAnd I also wouldn't touch most of the *comments*.\n\n\n\n\n> 2) You start removing unnecessary parenthesis. First of all it is not the job of that ticket. Secondly, one can arguably says that code is more readable with more parenthesis. So revert all those changes. If you want to remove parenthesis (which I think is a bad idea in general) then open a discussion on sage-devel and then a ticket if a consensus is reached.\n\nI'm in general ok with changing the \"C style\" `if (cond):` and `while (cond):` to usual Python syntax (without *outer* parentheses), but I agree that this should be done on another ticket, especially since currently only *some* instances (namely those in or near the context of other changes) get \"normalized\".\n\nThere are also a couple of conditions where I'd personally change *the order* of evaluation, of the form `if <expensive_test> <and|or> <cheap_test>:`,  but that's also out of the scope of this ticket.",
    "created_at": "2014-04-25T12:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207137",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:23 vdelecroix]:
> 1) As I already told you, the substitutions made bad things to the documentation. Hopefully, in very few places.

Yep, at least where "is None" isn't typeset as code.

And I also wouldn't touch most of the *comments*.




> 2) You start removing unnecessary parenthesis. First of all it is not the job of that ticket. Secondly, one can arguably says that code is more readable with more parenthesis. So revert all those changes. If you want to remove parenthesis (which I think is a bad idea in general) then open a discussion on sage-devel and then a ticket if a consensus is reached.

I'm in general ok with changing the "C style" `if (cond):` and `while (cond):` to usual Python syntax (without *outer* parentheses), but I agree that this should be done on another ticket, especially since currently only *some* instances (namely those in or near the context of other changes) get "normalized".

There are also a couple of conditions where I'd personally change *the order* of evaluation, of the form `if <expensive_test> <and|or> <cheap_test>:`,  but that's also out of the scope of this ticket.



---

archive/issue_comments_207138.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-05-07T09:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207138",
    "user": "https://github.com/wluebbe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_207139.json:
```json
{
    "body": "I pushed a fresh start based on Sage 6.2.\n\nFrom commit message of the manual changes:\n\n```\n    * changed \"not xxx is None\" to \"xxx is not None\" (where appropriate)\n    * reverted changes in docstring text\n      - usually did not revert changes to doctest *code*\n      - but reverted changes to expected results (if required)\n    * (usually) did not revert changes to *code* in comments\n    \n    Always tried to apply good judgement - but refrained from changes\n    unrelated to the subject \"is None\".\n```\n\n----\nNew commits:",
    "created_at": "2014-05-07T09:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207139",
    "user": "https://github.com/wluebbe"
}
```

I pushed a fresh start based on Sage 6.2.

From commit message of the manual changes:

```
    * changed "not xxx is None" to "xxx is not None" (where appropriate)
    * reverted changes in docstring text
      - usually did not revert changes to doctest *code*
      - but reverted changes to expected results (if required)
    * (usually) did not revert changes to *code* in comments
    
    Always tried to apply good judgement - but refrained from changes
    unrelated to the subject "is None".
```

----
New commits:



---

archive/issue_comments_207140.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-16T10:41:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207140",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207141.json:
```json
{
    "body": "I've eyeballed it all and patchbot is happy, too. So, if you remove that unrelated change in combinat/backtrack you can set positive.",
    "created_at": "2014-05-20T06:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207141",
    "user": "https://github.com/rwst"
}
```

I've eyeballed it all and patchbot is happy, too. So, if you remove that unrelated change in combinat/backtrack you can set positive.



---

archive/issue_comments_207142.json:
```json
{
    "body": "That //unrelated change in combinat/backtrack// resulted from resolving the merge conflict (comment 27). So it is not mine ;-) and I am reluctant removing it.\n\nPositive review anyway?",
    "created_at": "2014-05-20T09:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207142",
    "user": "https://github.com/wluebbe"
}
```

That //unrelated change in combinat/backtrack// resulted from resolving the merge conflict (comment 27). So it is not mine ;-) and I am reluctant removing it.

Positive review anyway?



---

archive/issue_comments_207143.json:
```json
{
    "body": "But develop doesn't have this code so you introduced (or re-introduced) it.",
    "created_at": "2014-05-20T09:39:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207143",
    "user": "https://github.com/rwst"
}
```

But develop doesn't have this code so you introduced (or re-introduced) it.



---

archive/issue_comments_207144.json:
```json
{
    "body": "If you don't know the best way to check it: `git diff develop` when in your up-to-date branch should show only your own changes.",
    "created_at": "2014-05-20T09:53:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207144",
    "user": "https://github.com/rwst"
}
```

If you don't know the best way to check it: `git diff develop` when in your up-to-date branch should show only your own changes.



---

archive/issue_comments_207145.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-20T13:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207145",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_207146.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-20T13:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207146",
    "user": "https://github.com/wluebbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_207147.json:
```json
{
    "body": "Thanks Ralf, for the help! The merge error is fixed.\n\nI set to positive as you suggested in comment 28.",
    "created_at": "2014-05-20T13:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207147",
    "user": "https://github.com/wluebbe"
}
```

Thanks Ralf, for the help! The merge error is fixed.

I set to positive as you suggested in comment 28.



---

archive/issue_events_015554.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2014-05-21T15:33:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/15979#event-15554"
}
```



---

archive/issue_comments_207148.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-21T15:33:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15979",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15979#issuecomment-207148",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
