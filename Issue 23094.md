# Issue 23094: Allow exact defining polynomials for p-adic extensions

archive/issues_023094.json:
```json
{
    "body": "CC:  saraedum\n\nKeywords: sd87\n\nCurrently, the defining polynomial of a p-adic extension always has coefficients over the base ring:\n\n\n```\nsage: R.<x> = ZZ[]\nsage: W.<w> = Zp(5).extension(x^2 - 5)\nsage: W.defining_polynomial().base_ring()\n5-adic Ring with capped relative precision 20\n```\n\n\nWe should allow exact defining polynomials, since they simplify reasoning for the precision of elements and do not impose a maximum precision cap on the extension.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23331\n\n",
    "created_at": "2017-06-27T23:25:45Z",
    "labels": [
        "padics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Allow exact defining polynomials for p-adic extensions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23094",
    "user": "roed"
}
```
CC:  saraedum

Keywords: sd87

Currently, the defining polynomial of a p-adic extension always has coefficients over the base ring:


```
sage: R.<x> = ZZ[]
sage: W.<w> = Zp(5).extension(x^2 - 5)
sage: W.defining_polynomial().base_ring()
5-adic Ring with capped relative precision 20
```


We should allow exact defining polynomials, since they simplify reasoning for the precision of elements and do not impose a maximum precision cap on the extension.

Issue created by migration from https://trac.sagemath.org/ticket/23331





---

archive/issue_comments_322899.json:
```json
{
    "body": "I ended up doing some additional things:\n\n* Remove some old code related to lazy p-adics (since I was changing the key format anyway)\n* Change the printing of unramified and eisenstein extensions\n----\nNew commits:",
    "created_at": "2017-07-19T06:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322899",
    "user": "roed"
}
```

I ended up doing some additional things:

* Remove some old code related to lazy p-adics (since I was changing the key format anyway)
* Change the printing of unramified and eisenstein extensions
----
New commits:



---

archive/issue_comments_322900.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-19T06:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322900",
    "user": "roed"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_322901.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-19T06:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322901",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_322902.json:
```json
{
    "body": "Awesome! Some comments through:\n- Why did you implement only `exact_field` and not `exact_ring` (for p-adic rings)?\n- Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring?\n- I would say that the methods `modulus` and `defining_polynomial` should both by default return a polynomial defined over the p-adic field and accept an attribute specifying whether the user wants an exact defining polynomial (I believe that having different behaviour for these two methods is quite confusing).\n- Shouldn't we check that the precision of the defining polynomial is enough to well-defined extension (thanks to Krasner's Lemma)?",
    "created_at": "2017-07-19T13:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322902",
    "user": "caruso"
}
```

Awesome! Some comments through:
- Why did you implement only `exact_field` and not `exact_ring` (for p-adic rings)?
- Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring?
- I would say that the methods `modulus` and `defining_polynomial` should both by default return a polynomial defined over the p-adic field and accept an attribute specifying whether the user wants an exact defining polynomial (I believe that having different behaviour for these two methods is quite confusing).
- Shouldn't we check that the precision of the defining polynomial is enough to well-defined extension (thanks to Krasner's Lemma)?



---

archive/issue_comments_322903.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-19T22:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322903",
    "user": "roed"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_322904.json:
```json
{
    "body": "Replying to [comment:5 caruso]:\n> Awesome! Some comments through:\n> - Why did you implement only `exact_field` and not `exact_ring` (for p-adic rings)?\n\nTwo reasons:\n1. We didn't need it for this ticket\n2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.\n\n> - Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring?\n\nYes.  I'll add this to the the followup ticket #23471\n\n> - I would say that the methods `modulus` and `defining_polynomial` should both by default return a polynomial defined over the p-adic field and accept an attribute specifying whether the user wants an exact defining polynomial (I believe that having different behaviour for these two methods is quite confusing).\n\nI had a conversation with Julian, Marc and Rob and we agree.\n\n> - Shouldn't we check that the precision of the defining polynomial is enough to well-defined extension (thanks to Krasner's Lemma)?\n\nYes, but I think that this should be saved for a followup ticket #23480 (Julian has code for doing this, but it depends on the MacLane package).",
    "created_at": "2017-07-19T22:46:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322904",
    "user": "roed"
}
```

Replying to [comment:5 caruso]:
> Awesome! Some comments through:
> - Why did you implement only `exact_field` and not `exact_ring` (for p-adic rings)?

Two reasons:
1. We didn't need it for this ticket
2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.

> - Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring?

Yes.  I'll add this to the the followup ticket #23471

> - I would say that the methods `modulus` and `defining_polynomial` should both by default return a polynomial defined over the p-adic field and accept an attribute specifying whether the user wants an exact defining polynomial (I believe that having different behaviour for these two methods is quite confusing).

I had a conversation with Julian, Marc and Rob and we agree.

> - Shouldn't we check that the precision of the defining polynomial is enough to well-defined extension (thanks to Krasner's Lemma)?

Yes, but I think that this should be saved for a followup ticket #23480 (Julian has code for doing this, but it depends on the MacLane package).



---

archive/issue_comments_322905.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-19T23:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322905",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_322906.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-19T23:13:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322906",
    "user": "roed"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_322907.json:
```json
{
    "body": "Positive review once the patchbot is happy.\n----\nNew commits:",
    "created_at": "2017-07-20T02:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322907",
    "user": "saraedum"
}
```

Positive review once the patchbot is happy.
----
New commits:



---

archive/issue_comments_322908.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-07-20T18:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322908",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_322909.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-21T07:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322909",
    "user": "saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_322910.json:
```json
{
    "body": "Replying to [comment:7 roed]:\n> 2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.\n\nI don't unserstand why implementing `exact_ring` would require something more than just calling `ZZ.extension(...)` that creates the order in a number field defined by the given polynomial. We do not care if it is not the maximal order, don't we?\n\n> > Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring? \n> Yes.  I'll add this to the the followup ticket #23471\n\nIs it in it? (I ask the question because this ticket is not marked as a dependency of #23471.)",
    "created_at": "2017-07-21T15:33:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322910",
    "user": "caruso"
}
```

Replying to [comment:7 roed]:
> 2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.

I don't unserstand why implementing `exact_ring` would require something more than just calling `ZZ.extension(...)` that creates the order in a number field defined by the given polynomial. We do not care if it is not the maximal order, don't we?

> > Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring? 
> Yes.  I'll add this to the the followup ticket #23471

Is it in it? (I ask the question because this ticket is not marked as a dependency of #23471.)



---

archive/issue_comments_322911.json:
```json
{
    "body": "Replying to [comment:18 caruso]:\n> Replying to [comment:7 roed]:\n> > 2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.\n> \n> I don't unserstand why implementing `exact_ring` would require something more than just calling `ZZ.extension(...)` that creates the order in a number field defined by the given polynomial. We do not care if it is not the maximal order, don't we?\n\nGood point.  See #23507.\n> > > Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring? \n> > Yes.  I'll add this to the the followup ticket #23471\n> \n> Is it in it? (I ask the question because this ticket is not marked as a dependency of #23471.)\n\nThis ticket is an indirect dependency, through #20310.",
    "created_at": "2017-07-21T16:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322911",
    "user": "roed"
}
```

Replying to [comment:18 caruso]:
> Replying to [comment:7 roed]:
> > 2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.
> 
> I don't unserstand why implementing `exact_ring` would require something more than just calling `ZZ.extension(...)` that creates the order in a number field defined by the given polynomial. We do not care if it is not the maximal order, don't we?

Good point.  See #23507.
> > > Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring? 
> > Yes.  I'll add this to the the followup ticket #23471
> 
> Is it in it? (I ask the question because this ticket is not marked as a dependency of #23471.)

This ticket is an indirect dependency, through #20310.



---

archive/issue_comments_322912.json:
```json
{
    "body": "Merge conflict, wait for next beta...",
    "created_at": "2017-07-21T22:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322912",
    "user": "vbraun"
}
```

Merge conflict, wait for next beta...



---

archive/issue_comments_322913.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-07-21T22:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322913",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_322914.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-02T17:31:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322914",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_322915.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-02T17:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322915",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_322916.json:
```json
{
    "body": "I fixed the merge conflict and ran all tests (fixing two).",
    "created_at": "2017-08-02T17:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322916",
    "user": "roed"
}
```

I fixed the merge conflict and ran all tests (fixing two).



---

archive/issue_comments_322917.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-08-02T17:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322917",
    "user": "roed"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_322918.json:
```json
{
    "body": "There are patchbot failures. But these seem to be in develop already.",
    "created_at": "2017-08-03T15:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322918",
    "user": "saraedum"
}
```

There are patchbot failures. But these seem to be in develop already.



---

archive/issue_comments_322919.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-04T18:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23094#issuecomment-322919",
    "user": "vbraun"
}
```

Resolution: fixed
