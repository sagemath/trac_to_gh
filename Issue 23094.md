# Issue 23094: Allow exact defining polynomials for p-adic extensions

Issue created by migration from https://trac.sagemath.org/ticket/23331

Original creator: roed

Original creation time: 2017-06-27 23:25:45

CC:  saraedum

Keywords: sd87

Currently, the defining polynomial of a p-adic extension always has coefficients over the base ring:


```
sage: R.<x> = ZZ[]
sage: W.<w> = Zp(5).extension(x^2 - 5)
sage: W.defining_polynomial().base_ring()
5-adic Ring with capped relative precision 20
```


We should allow exact defining polynomials, since they simplify reasoning for the precision of elements and do not impose a maximum precision cap on the extension.


---

Comment by roed created at 2017-07-19 06:41:47

I ended up doing some additional things:

 * Remove some old code related to lazy p-adics (since I was changing the key format anyway)
 * Change the printing of unramified and eisenstein extensions
----
New commits:


---

Comment by roed created at 2017-07-19 06:41:47

Changing status from new to needs_review.


---

Comment by git created at 2017-07-19 06:45:15

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by caruso created at 2017-07-19 13:04:13

Awesome! Some comments through:
- Why did you implement only `exact_field` and not `exact_ring` (for p-adic rings)?
- Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring?
- I would say that the methods `modulus` and `defining_polynomial` should both by default return a polynomial defined over the p-adic field and accept an attribute specifying whether the user wants an exact defining polynomial (I believe that having different behaviour for these two methods is quite confusing).
- Shouldn't we check that the precision of the defining polynomial is enough to well-defined extension (thanks to Krasner's Lemma)?


---

Comment by roed created at 2017-07-19 22:46:39

Changing status from needs_review to needs_work.


---

Comment by roed created at 2017-07-19 22:46:39

Replying to [comment:5 caruso]:
> Awesome! Some comments through:
> - Why did you implement only `exact_field` and not `exact_ring` (for p-adic rings)?

Two reasons:
1. We didn't need it for this ticket
2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.

> - Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring?

Yes.  I'll add this to the the followup ticket #23471

> - I would say that the methods `modulus` and `defining_polynomial` should both by default return a polynomial defined over the p-adic field and accept an attribute specifying whether the user wants an exact defining polynomial (I believe that having different behaviour for these two methods is quite confusing).

I had a conversation with Julian, Marc and Rob and we agree.

> - Shouldn't we check that the precision of the defining polynomial is enough to well-defined extension (thanks to Krasner's Lemma)?

Yes, but I think that this should be saved for a followup ticket #23480 (Julian has code for doing this, but it depends on the MacLane package).


---

Comment by git created at 2017-07-19 23:12:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2017-07-19 23:13:26

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-07-20 02:08:33

Positive review once the patchbot is happy.
----
New commits:


---

Comment by git created at 2017-07-20 18:47:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2017-07-21 07:39:58

Changing status from needs_review to positive_review.


---

Comment by caruso created at 2017-07-21 15:33:11

Replying to [comment:7 roed]:
> 2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.

I don't unserstand why implementing `exact_ring` would require something more than just calling `ZZ.extension(...)` that creates the order in a number field defined by the given polynomial. We do not care if it is not the maximal order, don't we?

> > Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring? 
> Yes.  I'll add this to the the followup ticket #23471

Is it in it? (I ask the question because this ticket is not marked as a dependency of #23471.)


---

Comment by roed created at 2017-07-21 16:10:27

Replying to [comment:18 caruso]:
> Replying to [comment:7 roed]:
> > 2. Eventually, exact rings would require computing rings of integers in number fields, or at least p-maximal orders.  We don't want to solve a hard computational problem problem to do something trivial.
> 
> I don't unserstand why implementing `exact_ring` would require something more than just calling `ZZ.extension(...)` that creates the order in a number field defined by the given polynomial. We do not care if it is not the maximal order, don't we?

Good point.  See #23507.
> > > Shouldn't we have a coercion map from the exact subfield/subring to the p-adic field/ring? 
> > Yes.  I'll add this to the the followup ticket #23471
> 
> Is it in it? (I ask the question because this ticket is not marked as a dependency of #23471.)

This ticket is an indirect dependency, through #20310.


---

Comment by vbraun created at 2017-07-21 22:47:01

Merge conflict, wait for next beta...


---

Comment by vbraun created at 2017-07-21 22:47:01

Changing status from positive_review to needs_work.


---

Comment by git created at 2017-08-02 17:31:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2017-08-02 17:54:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by roed created at 2017-08-02 17:57:39

I fixed the merge conflict and ran all tests (fixing two).


---

Comment by roed created at 2017-08-02 17:57:39

Changing status from needs_work to positive_review.


---

Comment by saraedum created at 2017-08-03 15:49:12

There are patchbot failures. But these seem to be in develop already.


---

Comment by vbraun created at 2017-08-04 18:21:34

Resolution: fixed
