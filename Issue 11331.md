# Issue 11331: Make new spkg to install Jmol in SAGE_LOCAL/share

archive/issues_011331.json:
```json
{
    "body": "Assignee: @gutow\n\nCC:  rado @kiwifb @strogdon\n\nKeywords: sd31 Jmol flask\n\nIn an effort to remove Jmol from the notebook in the Flask notebook it is being moved to SAGE_LOCAL/share. This is based on the logic that the notebook can run without Jmol, but Sage cannot run without either the notebook or Jmol even when using just the command line.\n\nTo achieve this relocation of Jmol:\n\n1. install the **spkg** [http://www.uwosh.edu/faculty_staff/gutow/jmol-12.2.21.p0.spkg](http://www.uwosh.edu/faculty_staff/gutow/jmol-12.2.21.p0.spkg)\n\n2. **Apply** [attachment:trac-11503-jmol-spkg.2.patch] to the **sage root** repository.\n\n3. **Apply** [attachment:trac-11503-jmol-commandline.patch] to the sage repository (fixes jmol on the command line)\n\nThe necessary patch for sagenb has already been merged with the master sagenb branch: https://github.com/sagemath/sagenb/pull/28\n\nIssue created by migration from https://trac.sagemath.org/ticket/11503\n\n",
    "closed_at": "2012-07-25T06:40:37Z",
    "created_at": "2011-06-16T15:55:59Z",
    "labels": [
        "component: notebook"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.2",
    "title": "Make new spkg to install Jmol in SAGE_LOCAL/share",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11331",
    "user": "https://github.com/gutow"
}
```
Assignee: @gutow

CC:  rado @kiwifb @strogdon

Keywords: sd31 Jmol flask

In an effort to remove Jmol from the notebook in the Flask notebook it is being moved to SAGE_LOCAL/share. This is based on the logic that the notebook can run without Jmol, but Sage cannot run without either the notebook or Jmol even when using just the command line.

To achieve this relocation of Jmol:

1. install the **spkg** [http://www.uwosh.edu/faculty_staff/gutow/jmol-12.2.21.p0.spkg](http://www.uwosh.edu/faculty_staff/gutow/jmol-12.2.21.p0.spkg)

2. **Apply** [attachment:trac-11503-jmol-spkg.2.patch] to the **sage root** repository.

3. **Apply** [attachment:trac-11503-jmol-commandline.patch] to the sage repository (fixes jmol on the command line)

The necessary patch for sagenb has already been merged with the master sagenb branch: https://github.com/sagemath/sagenb/pull/28

Issue created by migration from https://trac.sagemath.org/ticket/11503





---

archive/issue_comments_124944.json:
```json
{
    "body": "Changing assignee from jason, mpatel, was to @gutow.",
    "created_at": "2011-06-16T15:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124944",
    "user": "https://github.com/gutow"
}
```

Changing assignee from jason, mpatel, was to @gutow.



---

archive/issue_comments_124945.json:
```json
{
    "body": "Attachment [trac_11503_path_fix.patch](tarball://root/attachments/some-uuid/ticket11503/trac_11503_path_fix.patch) by @gutow created at 2011-06-16 16:23:53\n\npath fix for flask",
    "created_at": "2011-06-16T16:23:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124945",
    "user": "https://github.com/gutow"
}
```

Attachment [trac_11503_path_fix.patch](tarball://root/attachments/some-uuid/ticket11503/trac_11503_path_fix.patch) by @gutow created at 2011-06-16 16:23:53

path fix for flask



---

archive/issue_comments_124946.json:
```json
{
    "body": "plot3d command line fix",
    "created_at": "2011-06-16T16:37:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124946",
    "user": "https://github.com/gutow"
}
```

plot3d command line fix



---

archive/issue_comments_124947.json:
```json
{
    "body": "Attachment [trac_11503_cmd_line_fix.patch](tarball://root/attachments/some-uuid/ticket11503/trac_11503_cmd_line_fix.patch) by @gutow created at 2011-06-16 16:38:44",
    "created_at": "2011-06-16T16:38:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124947",
    "user": "https://github.com/gutow"
}
```

Attachment [trac_11503_cmd_line_fix.patch](tarball://root/attachments/some-uuid/ticket11503/trac_11503_cmd_line_fix.patch) by @gutow created at 2011-06-16 16:38:44



---

archive/issue_comments_124948.json:
```json
{
    "body": "spkg refactored to better meet Sage standards and remove dead code from spkg-install.",
    "created_at": "2011-06-17T18:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124948",
    "user": "https://github.com/gutow"
}
```

spkg refactored to better meet Sage standards and remove dead code from spkg-install.



---

archive/issue_comments_124949.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-06-25T18:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124949",
    "user": "https://github.com/gutow"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_124950.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-17T02:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124950",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124951.json:
```json
{
    "body": "Several comments: \n\n- There are some backup files present: SPKG.txt~ and spkg-install~.  \n- As I noted on #11496, you should copy the jmol shell script to SAGE_LOCAL/bin as part of spkg-install.\n- It would be helpful if you could prepare the mercurial repository with the version of hg installed with Sage.  When I use the version included with Sage (which is the only version on my computer), I get\n\n```\n$ hg status\nabort: requirement 'dotencode' not supported!\n```\n so I can't check the state of the repo without installing a new version of hg.",
    "created_at": "2011-07-17T02:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124951",
    "user": "https://github.com/jhpalmieri"
}
```

Several comments: 

- There are some backup files present: SPKG.txt~ and spkg-install~.  
- As I noted on #11496, you should copy the jmol shell script to SAGE_LOCAL/bin as part of spkg-install.
- It would be helpful if you could prepare the mercurial repository with the version of hg installed with Sage.  When I use the version included with Sage (which is the only version on my computer), I get

```
$ hg status
abort: requirement 'dotencode' not supported!
```
 so I can't check the state of the repo without installing a new version of hg.



---

archive/issue_comments_124952.json:
```json
{
    "body": "* Hmm...didn't notice the backup files. \u00a0I'll look into that...\n  * I could add the Jmol script to the jmol .spkg. \u00a0The one that is in there is the generic install not the one for SAGE...It seems reasonable that it should not be tracked by SAGE...I will add the SAGE version as a patch to the .spkg. \u00a0Once I get this done, I believe\u00a0#11496\u00a0should be closed, as it will no longer apply...let me know who to notify about that.\n  * Not sure if I can manage to successfully backtrack on the Hg repository format. \u00a0In order to work with the flask-notebook on my machine, I found I needed a system install of Hg and I got the latest. \u00a0Is this going to be a hold up? \u00a0Hg has been a real pain compared to the other version control systems I've \u00a0used. \u00a0Can somebody point out how to do the backtrack cleanly and quickly. \u00a0If it takes me a couple of hours to untangle Hg that's more time than it will take me to fix the rest of the .spkg problems and more time than I have for this project at the moment.\n\n\n\nReplying to [comment:8 jhpalmieri]:\n\n> Several comments:  - There are some backup files present: SPKG.txt~ and spkg-install~.   - As I noted on #11496, you should copy the jmol shell script to SAGE_LOCAL/bin as part of spkg-install. - It would be helpful if you could prepare the mercurial repository with the version of hg installed with Sage.  When I use the version included with Sage (which is the only version on my computer), I get ` $ hg status abort: requirement 'dotencode' not supported! ` so I can't check the state of the repo without installing a new version of hg.",
    "created_at": "2011-07-17T14:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124952",
    "user": "https://github.com/gutow"
}
```

* Hmm...didn't notice the backup files.  I'll look into that...
  * I could add the Jmol script to the jmol .spkg.  The one that is in there is the generic install not the one for SAGE...It seems reasonable that it should not be tracked by SAGE...I will add the SAGE version as a patch to the .spkg.  Once I get this done, I believe #11496 should be closed, as it will no longer apply...let me know who to notify about that.
  * Not sure if I can manage to successfully backtrack on the Hg repository format.  In order to work with the flask-notebook on my machine, I found I needed a system install of Hg and I got the latest.  Is this going to be a hold up?  Hg has been a real pain compared to the other version control systems I've  used.  Can somebody point out how to do the backtrack cleanly and quickly.  If it takes me a couple of hours to untangle Hg that's more time than it will take me to fix the rest of the .spkg problems and more time than I have for this project at the moment.



Replying to [comment:8 jhpalmieri]:

> Several comments:  - There are some backup files present: SPKG.txt~ and spkg-install~.   - As I noted on #11496, you should copy the jmol shell script to SAGE_LOCAL/bin as part of spkg-install. - It would be helpful if you could prepare the mercurial repository with the version of hg installed with Sage.  When I use the version included with Sage (which is the only version on my computer), I get ` $ hg status abort: requirement 'dotencode' not supported! ` so I can't check the state of the repo without installing a new version of hg.



---

archive/issue_comments_124953.json:
```json
{
    "body": ".p2 addresses the following: * reverted to mercurial version included in Sage (lost all the history in the process).\n* jmol launch script is now included in the patches and copied to SAGE_LOCAL/bin.\n* I think I removed all the backup files.",
    "created_at": "2011-07-18T20:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124953",
    "user": "https://github.com/gutow"
}
```

.p2 addresses the following: * reverted to mercurial version included in Sage (lost all the history in the process).
* jmol launch script is now included in the patches and copied to SAGE_LOCAL/bin.
* I think I removed all the backup files.



---

archive/issue_comments_124954.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-07-18T20:41:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124954",
    "user": "https://github.com/gutow"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124955.json:
```json
{
    "body": "I upgraded my version of mercurial so I can look at the repo, and I hope that the version included with Sage will be upgraded soon, too (see #10594).  Oh, and now I see that I can open this repo with the old version.  Anyway, there are some uncommitted files:\n\n```\n$ hg status\n? patches/Jmol.js.patch\n? patches/jmol.patch\n```\n(So you should run \"hg add\" and then commit again.)\n\nThe file spkg-install needs some work.  In particular, any variable which refers to a path should be quoted, in case there are spaces in it.  (Right now, we don't support having spaces in the path where Sage is, but when it's easy to allow, we should.)  I think this should do it:\n\n```diff\n\ndiff --git a/spkg-install b/spkg-install\n--- a/spkg-install\n+++ b/spkg-install\n@@ -27,12 +27,12 @@ if [ $? -ne 0 ]; then\n fi\n \n # Check for sagenb location\n-cd $SAGE_ROOT\"/devel/sagenb/sagenb/data/jmol\"\n+cd \"$SAGE_ROOT/devel/sagenb/sagenb/data/jmol\"\n if [ $? -ne 0 ]; then\n     echo \"No old Jmol install in notebook. Skipping removal of Jmol from notebook.\"\n else\n     echo \"Removing Jmol files from the notebook data directory...\"\n-    rm -r $SAGE_ROOT\"/devel/sagenb/sagenb/data/jmol\"\n+    rm -r \"$SAGE_ROOT/devel/sagenb/sagenb/data/jmol\"\n fi\n \n TEMPDIR=$SPKDIR\"/src\"\n@@ -47,15 +47,15 @@ if [ $? -ne 0 ]; then\n    echo \"Directory \"$SAGE_LOCAL\"/share/jmol does not exist.  Creating Directory...\"\n else\n     echo \"Deleting all files from \"$SAGE_LOCAL\"/share/jmol...\"\n-    rm -r $SAGE_LOCAL\"/share/jmol\"\n+    rm -r \"$SAGE_LOCAL/share/jmol\"\n     echo \"replacing jmol directory and contents...\"\n fi\n \n-mkdir $SAGE_LOCAL\"/share/jmol\"\n+mkdir \"$SAGE_LOCAL/share/jmol\"\n \n TEMPDIR=$SPKDIR\"/src/jmol\"\n cd \"$TEMPDIR\"\n-cp -r * $SAGE_LOCAL\"/share/jmol/\"\n+cp -r * \"$SAGE_LOCAL/share/jmol/\"\n \n cd $SAGE_LOCAL\"/bin\"\n if [ $? -ne 0 ]; then\n@@ -64,12 +64,12 @@ if [ $? -ne 0 ]; then\n else\n     echo \"Copying jmol script to \"$SAGE_LOCAL\"/bin.\"\n     cd \"$TEMPDIR\"\n-    cp -f jmol $SAGE_LOCAL\"/bin\"\n+    cp -f jmol \"$SAGE_LOCAL/bin\"\n fi\n \n echo \"Installing applet web directory\"\n-mkdir $SAGE_LOCAL\"/share/jmol/appletweb\"\n-cp Jmol.js $SAGE_LOCAL\"/share/jmol/appletweb\"\n+mkdir \"$SAGE_LOCAL/share/jmol/appletweb\"\n+cp Jmol.js \"$SAGE_LOCAL/share/jmol/appletweb\"\n \n TEMPDIR=$SPKDIR\"/patches/appletweb\"\n cd \"$TEMPDIR\"\n@@ -77,7 +77,7 @@ if [ $? -ne 0 ]; then\n    echo \"Error finding patches/appletweb directory. Exiting.\"\n    exit 1\n fi\n-cp -r * $SAGE_LOCAL\"/share/jmol/appletweb\"\n+cp -r * \"$SAGE_LOCAL/share/jmol/appletweb\"\n \n if [ $? -ne 0 ]; then\n    echo \"Error installing PACKAGE_NAME.\"\n```",
    "created_at": "2011-07-19T17:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124955",
    "user": "https://github.com/jhpalmieri"
}
```

I upgraded my version of mercurial so I can look at the repo, and I hope that the version included with Sage will be upgraded soon, too (see #10594).  Oh, and now I see that I can open this repo with the old version.  Anyway, there are some uncommitted files:

```
$ hg status
? patches/Jmol.js.patch
? patches/jmol.patch
```
(So you should run "hg add" and then commit again.)

The file spkg-install needs some work.  In particular, any variable which refers to a path should be quoted, in case there are spaces in it.  (Right now, we don't support having spaces in the path where Sage is, but when it's easy to allow, we should.)  I think this should do it:

```diff

diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -27,12 +27,12 @@ if [ $? -ne 0 ]; then
 fi
 
 # Check for sagenb location
-cd $SAGE_ROOT"/devel/sagenb/sagenb/data/jmol"
+cd "$SAGE_ROOT/devel/sagenb/sagenb/data/jmol"
 if [ $? -ne 0 ]; then
     echo "No old Jmol install in notebook. Skipping removal of Jmol from notebook."
 else
     echo "Removing Jmol files from the notebook data directory..."
-    rm -r $SAGE_ROOT"/devel/sagenb/sagenb/data/jmol"
+    rm -r "$SAGE_ROOT/devel/sagenb/sagenb/data/jmol"
 fi
 
 TEMPDIR=$SPKDIR"/src"
@@ -47,15 +47,15 @@ if [ $? -ne 0 ]; then
    echo "Directory "$SAGE_LOCAL"/share/jmol does not exist.  Creating Directory..."
 else
     echo "Deleting all files from "$SAGE_LOCAL"/share/jmol..."
-    rm -r $SAGE_LOCAL"/share/jmol"
+    rm -r "$SAGE_LOCAL/share/jmol"
     echo "replacing jmol directory and contents..."
 fi
 
-mkdir $SAGE_LOCAL"/share/jmol"
+mkdir "$SAGE_LOCAL/share/jmol"
 
 TEMPDIR=$SPKDIR"/src/jmol"
 cd "$TEMPDIR"
-cp -r * $SAGE_LOCAL"/share/jmol/"
+cp -r * "$SAGE_LOCAL/share/jmol/"
 
 cd $SAGE_LOCAL"/bin"
 if [ $? -ne 0 ]; then
@@ -64,12 +64,12 @@ if [ $? -ne 0 ]; then
 else
     echo "Copying jmol script to "$SAGE_LOCAL"/bin."
     cd "$TEMPDIR"
-    cp -f jmol $SAGE_LOCAL"/bin"
+    cp -f jmol "$SAGE_LOCAL/bin"
 fi
 
 echo "Installing applet web directory"
-mkdir $SAGE_LOCAL"/share/jmol/appletweb"
-cp Jmol.js $SAGE_LOCAL"/share/jmol/appletweb"
+mkdir "$SAGE_LOCAL/share/jmol/appletweb"
+cp Jmol.js "$SAGE_LOCAL/share/jmol/appletweb"
 
 TEMPDIR=$SPKDIR"/patches/appletweb"
 cd "$TEMPDIR"
@@ -77,7 +77,7 @@ if [ $? -ne 0 ]; then
    echo "Error finding patches/appletweb directory. Exiting."
    exit 1
 fi
-cp -r * $SAGE_LOCAL"/share/jmol/appletweb"
+cp -r * "$SAGE_LOCAL/share/jmol/appletweb"
 
 if [ $? -ne 0 ]; then
    echo "Error installing PACKAGE_NAME."
```



---

archive/issue_comments_124956.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-07-19T17:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124956",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124957.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-07-19T19:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124957",
    "user": "https://github.com/gutow"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124958.json:
```json
{
    "body": "The below is done. \u00a0Try downloading the spkg again after 3 PM CDT.\n\nReplying to [comment:12 jhpalmieri]:\n\n> I upgraded my version of mercurial so I can look at the repo, and I hope that the version included with Sage will be upgraded soon, too (see #10594).  Oh, and now I see that I can open this repo with the old version.  Anyway, there are some uncommitted files: ` $ hg status ? patches/Jmol.js.patch ? patches/jmol.patch ` (So you should run \"hg add\" and then commit again.) The file spkg-install needs some work.  In particular, any variable which refers to a path should be quoted, in case there are spaces in it.  (Right now, we don't support having spaces in the path where Sage is, but when it's easy to allow, we should.)  I think this should do it: ` #!diff diff --git a/spkg-install b/spkg-install --- a/spkg-install +++ b/spkg-install `@``@` -27,12 +27,12 `@``@` if [ $? -ne 0 ]; then fi # Check for sagenb location -cd $SAGE_ROOT\"/devel/sagenb/sagenb/data/jmol\" +cd \"$SAGE_ROOT/devel/sagenb/sagenb/data/jmol\" if [ $? -ne 0 ]; then echo \"No old Jmol install in notebook. Skipping removal of Jmol from notebook.\" else echo \"Removing Jmol files from the notebook data directory...\" -    rm -r $SAGE_ROOT\"/devel/sagenb/sagenb/data/jmol\" +    rm -r \"$SAGE_ROOT/devel/sagenb/sagenb/data/jmol\" fi TEMPDIR=$SPKDIR\"/src\" `@``@` -47,15 +47,15 `@``@` if [ $? -ne 0 ]; then echo \"Directory \"$SAGE_LOCAL\"/share/jmol does not exist.  Creating Directory...\" else echo \"Deleting all files from \"$SAGE_LOCAL\"/share/jmol...\" -    rm -r $SAGE_LOCAL\"/share/jmol\" +    rm -r \"$SAGE_LOCAL/share/jmol\" echo \"replacing jmol directory and contents...\" fi -mkdir $SAGE_LOCAL\"/share/jmol\" +mkdir \"$SAGE_LOCAL/share/jmol\" TEMPDIR=$SPKDIR\"/src/jmol\" cd \"$TEMPDIR\" -cp -r * $SAGE_LOCAL\"/share/jmol/\" +cp -r * \"$SAGE_LOCAL/share/jmol/\" cd $SAGE_LOCAL\"/bin\" if [ $? -ne 0 ]; then `@``@` -64,12 +64,12 `@``@` if [ $? -ne 0 ]; then else echo \"Copying jmol script to \"$SAGE_LOCAL\"/bin.\" cd \"$TEMPDIR\" -    cp -f jmol $SAGE_LOCAL\"/bin\" +    cp -f jmol \"$SAGE_LOCAL/bin\" fi echo \"Installing applet web directory\" -mkdir $SAGE_LOCAL\"/share/jmol/appletweb\" -cp Jmol.js $SAGE_LOCAL\"/share/jmol/appletweb\" +mkdir \"$SAGE_LOCAL/share/jmol/appletweb\" +cp Jmol.js \"$SAGE_LOCAL/share/jmol/appletweb\" TEMPDIR=$SPKDIR\"/patches/appletweb\" cd \"$TEMPDIR\" `@``@` -77,7 +77,7 `@``@` if [ $? -ne 0 ]; then echo \"Error finding patches/appletweb directory. Exiting.\" exit 1 fi -cp -r * $SAGE_LOCAL\"/share/jmol/appletweb\" +cp -r * \"$SAGE_LOCAL/share/jmol/appletweb\" if [ $? -ne 0 ]; then echo \"Error installing PACKAGE_NAME.\" `",
    "created_at": "2011-07-19T19:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124958",
    "user": "https://github.com/gutow"
}
```

The below is done.  Try downloading the spkg again after 3 PM CDT.

Replying to [comment:12 jhpalmieri]:

> I upgraded my version of mercurial so I can look at the repo, and I hope that the version included with Sage will be upgraded soon, too (see #10594).  Oh, and now I see that I can open this repo with the old version.  Anyway, there are some uncommitted files: ` $ hg status ? patches/Jmol.js.patch ? patches/jmol.patch ` (So you should run "hg add" and then commit again.) The file spkg-install needs some work.  In particular, any variable which refers to a path should be quoted, in case there are spaces in it.  (Right now, we don't support having spaces in the path where Sage is, but when it's easy to allow, we should.)  I think this should do it: ` #!diff diff --git a/spkg-install b/spkg-install --- a/spkg-install +++ b/spkg-install `@``@` -27,12 +27,12 `@``@` if [ $? -ne 0 ]; then fi # Check for sagenb location -cd $SAGE_ROOT"/devel/sagenb/sagenb/data/jmol" +cd "$SAGE_ROOT/devel/sagenb/sagenb/data/jmol" if [ $? -ne 0 ]; then echo "No old Jmol install in notebook. Skipping removal of Jmol from notebook." else echo "Removing Jmol files from the notebook data directory..." -    rm -r $SAGE_ROOT"/devel/sagenb/sagenb/data/jmol" +    rm -r "$SAGE_ROOT/devel/sagenb/sagenb/data/jmol" fi TEMPDIR=$SPKDIR"/src" `@``@` -47,15 +47,15 `@``@` if [ $? -ne 0 ]; then echo "Directory "$SAGE_LOCAL"/share/jmol does not exist.  Creating Directory..." else echo "Deleting all files from "$SAGE_LOCAL"/share/jmol..." -    rm -r $SAGE_LOCAL"/share/jmol" +    rm -r "$SAGE_LOCAL/share/jmol" echo "replacing jmol directory and contents..." fi -mkdir $SAGE_LOCAL"/share/jmol" +mkdir "$SAGE_LOCAL/share/jmol" TEMPDIR=$SPKDIR"/src/jmol" cd "$TEMPDIR" -cp -r * $SAGE_LOCAL"/share/jmol/" +cp -r * "$SAGE_LOCAL/share/jmol/" cd $SAGE_LOCAL"/bin" if [ $? -ne 0 ]; then `@``@` -64,12 +64,12 `@``@` if [ $? -ne 0 ]; then else echo "Copying jmol script to "$SAGE_LOCAL"/bin." cd "$TEMPDIR" -    cp -f jmol $SAGE_LOCAL"/bin" +    cp -f jmol "$SAGE_LOCAL/bin" fi echo "Installing applet web directory" -mkdir $SAGE_LOCAL"/share/jmol/appletweb" -cp Jmol.js $SAGE_LOCAL"/share/jmol/appletweb" +mkdir "$SAGE_LOCAL/share/jmol/appletweb" +cp Jmol.js "$SAGE_LOCAL/share/jmol/appletweb" TEMPDIR=$SPKDIR"/patches/appletweb" cd "$TEMPDIR" `@``@` -77,7 +77,7 `@``@` if [ $? -ne 0 ]; then echo "Error finding patches/appletweb directory. Exiting." exit 1 fi -cp -r * $SAGE_LOCAL"/share/jmol/appletweb" +cp -r * "$SAGE_LOCAL/share/jmol/appletweb" if [ $? -ne 0 ]; then echo "Error installing PACKAGE_NAME." `



---

archive/issue_comments_124959.json:
```json
{
    "body": "Removing command line patch as it appears to be incorporated into 4.8.",
    "created_at": "2011-12-22T02:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124959",
    "user": "https://github.com/gutow"
}
```

Removing command line patch as it appears to be incorporated into 4.8.



---

archive/issue_events_029973.json:
```json
{
    "actor": "https://github.com/gutow",
    "created_at": "2011-12-22T02:04:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29973"
}
```



---

archive/issue_comments_124960.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-01-11T06:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124960",
    "user": "https://github.com/dandrake"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124961.json:
```json
{
    "body": "I'm looking this over, and I have some more minor nits to pick with spkg-install. Here's an idiom I see a couple times:\n\n```\nTEMPDIR=something\ncd \"$TEMPDIR\"\ndo some stuff\n...\n```\nTwo things bother me about that: (1) you call it `TEMPDIR`, which implies to me that it's a temporary directory used for some scratch work, but you're talking about an existing directory with important files in it. (2) You never use the `TEMPDIR` variable, except in the `cd` command...so why not just `cd` to the directory?\n\nAlso, I think it's more readable to just put the paths into commands, rather than `cd`ing around. I would prefer to see\n\n```\ncp $SAGE_FOO/dir/file.txt $SAGE_BAR/dir/dir2/\n```\nrather than\n\n```\ncd $SAGE_FOO/dir\ncp file.txt $SAGE_BAR/dir/dir2/\n```\nIt makes it easier to read the script, since you don't have to remember what the working directory is. Also, you sometimes change directories inside an if-then-else, so the working directory depends on what happened there!\n\nFinally, at the end of `spkg-install`, you have \"PACKAGE NAME\" instead of Jmol!",
    "created_at": "2012-01-11T06:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124961",
    "user": "https://github.com/dandrake"
}
```

I'm looking this over, and I have some more minor nits to pick with spkg-install. Here's an idiom I see a couple times:

```
TEMPDIR=something
cd "$TEMPDIR"
do some stuff
...
```
Two things bother me about that: (1) you call it `TEMPDIR`, which implies to me that it's a temporary directory used for some scratch work, but you're talking about an existing directory with important files in it. (2) You never use the `TEMPDIR` variable, except in the `cd` command...so why not just `cd` to the directory?

Also, I think it's more readable to just put the paths into commands, rather than `cd`ing around. I would prefer to see

```
cp $SAGE_FOO/dir/file.txt $SAGE_BAR/dir/dir2/
```
rather than

```
cd $SAGE_FOO/dir
cp file.txt $SAGE_BAR/dir/dir2/
```
It makes it easier to read the script, since you don't have to remember what the working directory is. Also, you sometimes change directories inside an if-then-else, so the working directory depends on what happened there!

Finally, at the end of `spkg-install`, you have "PACKAGE NAME" instead of Jmol!



---

archive/issue_comments_124962.json:
```json
{
    "body": "changes to spkg-install, SPKG.txt. For review only.",
    "created_at": "2012-01-11T07:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124962",
    "user": "https://github.com/dandrake"
}
```

changes to spkg-install, SPKG.txt. For review only.



---

archive/issue_comments_124963.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-01-11T07:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124963",
    "user": "https://github.com/dandrake"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124964.json:
```json
{
    "body": "Attachment [trac11503.patch](tarball://root/attachments/some-uuid/ticket11503/trac11503.patch) by @dandrake created at 2012-01-11 07:13:09\n\nI've looked over the spkg, and modulo my fixes to `spkg-install`, I can give it a positive review. My changes are in attachment:trac11503.patch and I have a spkg with those changes at http://sagenb.kaist.ac.kr/~drake/Jmol-12.0.45.p3.spkg. It's identical to Jonathan's version except for the changes in attachment:trac11503.patch.\n\nJason, you volunteered to look it over, but that shouldn't stop anyone else. :)",
    "created_at": "2012-01-11T07:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124964",
    "user": "https://github.com/dandrake"
}
```

Attachment [trac11503.patch](tarball://root/attachments/some-uuid/ticket11503/trac11503.patch) by @dandrake created at 2012-01-11 07:13:09

I've looked over the spkg, and modulo my fixes to `spkg-install`, I can give it a positive review. My changes are in attachment:trac11503.patch and I have a spkg with those changes at http://sagenb.kaist.ac.kr/~drake/Jmol-12.0.45.p3.spkg. It's identical to Jonathan's version except for the changes in attachment:trac11503.patch.

Jason, you volunteered to look it over, but that shouldn't stop anyone else. :)



---

archive/issue_comments_124965.json:
```json
{
    "body": "Dan's changes look good to me (obviously much more experience writing these scripts than I have:))\u00a0I suggest we try Dan's .spkg for the review and have changed the description to reflect this.\n\nJonathan\n\nReplying to [comment:16 ddrake]:\n\n> I've looked over the spkg, and modulo my fixes to `spkg-install`, I can give it a positive review. My changes are in attachment:trac11503.patch and I have a spkg with those changes at http://sagenb.kaist.ac.kr/~drake/Jmol-12.0.45.p3.spkg. It's identical to Jonathan's version except for the changes in attachment:trac11503.patch. Jason, you volunteered to look it over, but that shouldn't stop anyone else. :)",
    "created_at": "2012-01-11T14:21:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124965",
    "user": "https://github.com/gutow"
}
```

Dan's changes look good to me (obviously much more experience writing these scripts than I have:)) I suggest we try Dan's .spkg for the review and have changed the description to reflect this.

Jonathan

Replying to [comment:16 ddrake]:

> I've looked over the spkg, and modulo my fixes to `spkg-install`, I can give it a positive review. My changes are in attachment:trac11503.patch and I have a spkg with those changes at http://sagenb.kaist.ac.kr/~drake/Jmol-12.0.45.p3.spkg. It's identical to Jonathan's version except for the changes in attachment:trac11503.patch. Jason, you volunteered to look it over, but that shouldn't stop anyone else. :)



---

archive/issue_comments_124966.json:
```json
{
    "body": "Dan: your changes look fine to me.  Do you give everything else a positive review?",
    "created_at": "2012-01-17T02:31:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124966",
    "user": "https://github.com/jasongrout"
}
```

Dan: your changes look fine to me.  Do you give everything else a positive review?



---

archive/issue_comments_124967.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-01-17T02:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124967",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_124968.json:
```json
{
    "body": "Oh, wait, I see that you just said modulo your fixes, you give the spkg a positive review.  So it sounds like we agree: positive review.",
    "created_at": "2012-01-17T02:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124968",
    "user": "https://github.com/jasongrout"
}
```

Oh, wait, I see that you just said modulo your fixes, you give the spkg a positive review.  So it sounds like we agree: positive review.



---

archive/issue_comments_124969.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-01-17T03:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124969",
    "user": "https://github.com/jasongrout"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_124970.json:
```json
{
    "body": "hmm...nothing has been added to the deps file.  There should be another patch for that.",
    "created_at": "2012-01-17T03:05:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124970",
    "user": "https://github.com/jasongrout"
}
```

hmm...nothing has been added to the deps file.  There should be another patch for that.



---

archive/issue_comments_124971.json:
```json
{
    "body": "So I think what needs to be done at this point is:\n\n1. Make the jmol spkg not start with a capital letter (simple rename of the spkg file)\n\n2. Apply the [attachment:trac-11503-jmol-spkg.patch] to the sage root repository, make an sdist, put the jmol spkg in there, and try building.  In essence, review the changes to the sage root repository.",
    "created_at": "2012-01-17T03:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124971",
    "user": "https://github.com/jasongrout"
}
```

So I think what needs to be done at this point is:

1. Make the jmol spkg not start with a capital letter (simple rename of the spkg file)

2. Apply the [attachment:trac-11503-jmol-spkg.patch] to the sage root repository, make an sdist, put the jmol spkg in there, and try building.  In essence, review the changes to the sage root repository.



---

archive/issue_comments_124972.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-01-17T03:27:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124972",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124973.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-01-17T14:59:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124973",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124974.json:
```json
{
    "body": "For `SPKG.txt`, you should follow the format at [http://sagemath.org/doc/developer/producing_spkgs.html#creating-a-new-spkg](http://sagemath.org/doc/developer/producing_spkgs.html#creating-a-new-spkg)",
    "created_at": "2012-01-17T14:59:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124974",
    "user": "https://github.com/jdemeyer"
}
```

For `SPKG.txt`, you should follow the format at [http://sagemath.org/doc/developer/producing_spkgs.html#creating-a-new-spkg](http://sagemath.org/doc/developer/producing_spkgs.html#creating-a-new-spkg)



---

archive/issue_comments_124975.json:
```json
{
    "body": "Okay, it's not in the documentation, but you should format the Changelog with lines like\n\n```\n### mypackage-3.18.spkg (Jeroen Demeyer, 17 January 2012)\n * Changed foo to bar\n```\nThis is how every spkg does it (except for sagenb, which I can live with).",
    "created_at": "2012-01-17T15:03:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124975",
    "user": "https://github.com/jdemeyer"
}
```

Okay, it's not in the documentation, but you should format the Changelog with lines like

```
### mypackage-3.18.spkg (Jeroen Demeyer, 17 January 2012)
 * Changed foo to bar
```
This is how every spkg does it (except for sagenb, which I can live with).



---

archive/issue_comments_124976.json:
```json
{
    "body": "Should I change this or will you Dan?\n\nA comment. \u00a0As a relatively newer developer, I do not appreciate formatting requirements that are not documented. \u00a0I followed the example in the developer's guide.\n\nJonathan\n\nReplying to [comment:27 jdemeyer]:\n\n> Okay, it's not in the documentation, but you should format the Changelog with lines like ` === mypackage-3.18.spkg (Jeroen Demeyer, 17 January 2012) === * Changed foo to bar ` This is how every spkg does it (except for sagenb, which I can live with).",
    "created_at": "2012-01-17T15:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124976",
    "user": "https://github.com/gutow"
}
```

Should I change this or will you Dan?

A comment.  As a relatively newer developer, I do not appreciate formatting requirements that are not documented.  I followed the example in the developer's guide.

Jonathan

Replying to [comment:27 jdemeyer]:

> Okay, it's not in the documentation, but you should format the Changelog with lines like ` === mypackage-3.18.spkg (Jeroen Demeyer, 17 January 2012) === * Changed foo to bar ` This is how every spkg does it (except for sagenb, which I can live with).



---

archive/issue_comments_124977.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-01-17T15:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124977",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124978.json:
```json
{
    "body": "I made an spkg that reformats the changelog and makes the spkg lowercase.  See the new instructions.\n\nJonathan: I understand---I didn't object before because it wasn't in the docs.",
    "created_at": "2012-01-17T15:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124978",
    "user": "https://github.com/jasongrout"
}
```

I made an spkg that reformats the changelog and makes the spkg lowercase.  See the new instructions.

Jonathan: I understand---I didn't object before because it wasn't in the docs.



---

archive/issue_comments_124979.json:
```json
{
    "body": "Yeah, I can imagine it's annoying. It should be documented better. I always thought it was documented, for the simple reason that every spkg is doing it the same way.\n\nThe docs should probably be clarified.",
    "created_at": "2012-01-17T15:47:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124979",
    "user": "https://github.com/jdemeyer"
}
```

Yeah, I can imagine it's annoying. It should be documented better. I always thought it was documented, for the simple reason that every spkg is doing it the same way.

The docs should probably be clarified.



---

archive/issue_comments_124980.json:
```json
{
    "body": "I made some further improvements to `SPKG.txt`, in particular I simplified the Dependencies to \n\n```\n * Sage Notebook (sagenb)\n```",
    "created_at": "2012-01-17T16:11:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124980",
    "user": "https://github.com/jdemeyer"
}
```

I made some further improvements to `SPKG.txt`, in particular I simplified the Dependencies to 

```
 * Sage Notebook (sagenb)
```



---

archive/issue_comments_124981.json:
```json
{
    "body": "I've updated the instructions over at #11080 to reflect your new spkg.",
    "created_at": "2012-01-17T16:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124981",
    "user": "https://github.com/jasongrout"
}
```

I've updated the instructions over at #11080 to reflect your new spkg.



---

archive/issue_comments_124982.json:
```json
{
    "body": "Replying to [comment:30 jdemeyer]:\n> Yeah, I can imagine it's annoying. It should be documented better.\n\n\nSee [http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch).",
    "created_at": "2012-01-17T16:30:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124982",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:30 jdemeyer]:
> Yeah, I can imagine it's annoying. It should be documented better.


See [http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch).



---

archive/issue_comments_124983.json:
```json
{
    "body": "> > Yeah, I can imagine it's annoying. It should be documented better.\n\n> \n> See [http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch).\n\n\nI knew this sounded familiar!",
    "created_at": "2012-01-17T16:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124983",
    "user": "https://github.com/kcrisman"
}
```

> > Yeah, I can imagine it's annoying. It should be documented better.

> 
> See [http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch](http://trac.sagemath.org/sage_trac/attachment/ticket/9419/trac_9419-part2.patch).


I knew this sounded familiar!



---

archive/issue_comments_124984.json:
```json
{
    "body": "apply to sage repository",
    "created_at": "2012-01-18T06:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124984",
    "user": "https://github.com/jasongrout"
}
```

apply to sage repository



---

archive/issue_comments_124985.json:
```json
{
    "body": "Attachment [trac-11503-jmol-commandline.patch](tarball://root/attachments/some-uuid/ticket11503/trac-11503-jmol-commandline.patch) by @jasongrout created at 2012-01-18 06:12:32\n\nAttached patch which fixes command-line jmol.  This issue was discovered over on #9238; I used the fix from the comments there.",
    "created_at": "2012-01-18T06:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124985",
    "user": "https://github.com/jasongrout"
}
```

Attachment [trac-11503-jmol-commandline.patch](tarball://root/attachments/some-uuid/ticket11503/trac-11503-jmol-commandline.patch) by @jasongrout created at 2012-01-18 06:12:32

Attached patch which fixes command-line jmol.  This issue was discovered over on #9238; I used the fix from the comments there.



---

archive/issue_comments_124986.json:
```json
{
    "body": "To review this ticket, this is what is left:\n\n* My and jdemeyer's changes to the spkg (reformatting SPKG.txt, basically)\n* the [attachment:trac-11503-jmol-commandline.patch] that fixes command-line jmol",
    "created_at": "2012-01-19T17:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124986",
    "user": "https://github.com/jasongrout"
}
```

To review this ticket, this is what is left:

* My and jdemeyer's changes to the spkg (reformatting SPKG.txt, basically)
* the [attachment:trac-11503-jmol-commandline.patch] that fixes command-line jmol



---

archive/issue_comments_124987.json:
```json
{
    "body": "Since jmol doesn't use setuptools, it should be listed normally between the dependencies.  My new [attachment:trac-11503-jmol-spkg.patch] does this.",
    "created_at": "2012-01-19T21:00:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124987",
    "user": "https://github.com/jdemeyer"
}
```

Since jmol doesn't use setuptools, it should be listed normally between the dependencies.  My new [attachment:trac-11503-jmol-spkg.patch] does this.



---

archive/issue_comments_124988.json:
```json
{
    "body": "Jason, what did you base your commandline patch on? It doesn't apply to 4.8.rc0, even with fuzz, since there seem to be some different lines in the context of the second chunk. Here's a rebase on 4.8.rc0, though I don't know what's going on here so I won't put it in the ticket description.",
    "created_at": "2012-01-20T07:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124988",
    "user": "https://github.com/kini"
}
```

Jason, what did you base your commandline patch on? It doesn't apply to 4.8.rc0, even with fuzz, since there seem to be some different lines in the context of the second chunk. Here's a rebase on 4.8.rc0, though I don't know what's going on here so I won't put it in the ticket description.



---

archive/issue_comments_124989.json:
```json
{
    "body": "Changing keywords from \"sd31,Jmol, flask\" to \"sd31 Jmol flask\".",
    "created_at": "2012-01-20T07:10:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124989",
    "user": "https://github.com/kini"
}
```

Changing keywords from "sd31,Jmol, flask" to "sd31 Jmol flask".



---

archive/issue_comments_124990.json:
```json
{
    "body": "Attachment [trac_11503-jmol-commandline.rebase.patch](tarball://root/attachments/some-uuid/ticket11503/trac_11503-jmol-commandline.rebase.patch) by @kini created at 2012-01-20 07:10:41\n\napply to $SAGE_ROOT/devel/sage",
    "created_at": "2012-01-20T07:10:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124990",
    "user": "https://github.com/kini"
}
```

Attachment [trac_11503-jmol-commandline.rebase.patch](tarball://root/attachments/some-uuid/ticket11503/trac_11503-jmol-commandline.rebase.patch) by @kini created at 2012-01-20 07:10:41

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_124991.json:
```json
{
    "body": "I made the patch on 5.0something (prealpha/beta1 maybe?).  I also had #11078 applied before this.",
    "created_at": "2012-01-20T07:22:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124991",
    "user": "https://github.com/jasongrout"
}
```

I made the patch on 5.0something (prealpha/beta1 maybe?).  I also had #11078 applied before this.



---

archive/issue_comments_124992.json:
```json
{
    "body": "Oh, OK. Then there is no rebasing needed -- 4.8.rc0 -> #11078 -> your patch works perfectly.",
    "created_at": "2012-01-20T07:28:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124992",
    "user": "https://github.com/kini"
}
```

Oh, OK. Then there is no rebasing needed -- 4.8.rc0 -> #11078 -> your patch works perfectly.



---

archive/issue_comments_124993.json:
```json
{
    "body": "I tried building a clean sage with this spkg and the new notebook, and command-line jmol didn't work because the local/bin/jmol script was not executable.  So it should probably be set to executable inside the spkg.",
    "created_at": "2012-01-22T02:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124993",
    "user": "https://github.com/jasongrout"
}
```

I tried building a clean sage with this spkg and the new notebook, and command-line jmol didn't work because the local/bin/jmol script was not executable.  So it should probably be set to executable inside the spkg.



---

archive/issue_comments_124994.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-01-22T02:05:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124994",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124995.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-02-04T19:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124995",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124996.json:
```json
{
    "body": "I just uploaded a p4 version that sets the jmol script to executable after copying to local/bin.  So it's needs review again.",
    "created_at": "2012-02-04T19:04:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124996",
    "user": "https://github.com/jasongrout"
}
```

I just uploaded a p4 version that sets the jmol script to executable after copying to local/bin.  So it's needs review again.



---

archive/issue_comments_124997.json:
```json
{
    "body": "apply to the sage root repository",
    "created_at": "2012-02-08T07:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124997",
    "user": "https://github.com/jdemeyer"
}
```

apply to the sage root repository



---

archive/issue_comments_124998.json:
```json
{
    "body": "Attachment [trac-11503-jmol-spkg.2.patch](tarball://root/attachments/some-uuid/ticket11503/trac-11503-jmol-spkg.2.patch) by @ppurka created at 2012-04-02 08:50:53\n\nRebased to sage-5.0beta11",
    "created_at": "2012-04-02T08:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124998",
    "user": "https://github.com/ppurka"
}
```

Attachment [trac-11503-jmol-spkg.2.patch](tarball://root/attachments/some-uuid/ticket11503/trac-11503-jmol-spkg.2.patch) by @ppurka created at 2012-04-02 08:50:53

Rebased to sage-5.0beta11



---

archive/issue_comments_124999.json:
```json
{
    "body": "The attachment [attachment:trac-11503-jmol-spkg.2.patch] has been rebased to sage-5.0beta11. Compiling it now (along with #11874 and the patches to `SAGE_ROOT` from #11080).",
    "created_at": "2012-04-02T08:57:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-124999",
    "user": "https://github.com/ppurka"
}
```

The attachment [attachment:trac-11503-jmol-spkg.2.patch] has been rebased to sage-5.0beta11. Compiling it now (along with #11874 and the patches to `SAGE_ROOT` from #11080).



---

archive/issue_events_029974.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-08T08:39:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29974"
}
```



---

archive/issue_events_029975.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-08T08:39:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29975"
}
```



---

archive/issue_comments_125000.json:
```json
{
    "body": "Updated to Jmol-12.2.21...this will allow using Jmol to generate images server-side.",
    "created_at": "2012-04-08T22:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125000",
    "user": "https://github.com/gutow"
}
```

Updated to Jmol-12.2.21...this will allow using Jmol to generate images server-side.



---

archive/issue_comments_125001.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-04-09T08:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125001",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_125002.json:
```json
{
    "body": "```\n$ hg status\n? SPKG.txt~\n```",
    "created_at": "2012-04-09T08:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125002",
    "user": "https://github.com/jdemeyer"
}
```

```
$ hg status
? SPKG.txt~
```



---

archive/issue_comments_125003.json:
```json
{
    "body": "Since it's a new jmol version, the p-version number should be reset.",
    "created_at": "2012-04-09T11:07:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125003",
    "user": "https://github.com/kini"
}
```

Since it's a new jmol version, the p-version number should be reset.



---

archive/issue_comments_125004.json:
```json
{
    "body": "Odd that the chmod is gone...I didn't edit the script....All I did was replace the .jar files....I'll check this afternoon. \u00a0Not sure why the SPKG backup got left behind, but I can delete it....\n\nReplying to [comment:50 jdemeyer]:\n\n> ` $ hg status ? SPKG.txt~ `",
    "created_at": "2012-04-09T12:50:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125004",
    "user": "https://github.com/gutow"
}
```

Odd that the chmod is gone...I didn't edit the script....All I did was replace the .jar files....I'll check this afternoon.  Not sure why the SPKG backup got left behind, but I can delete it....

Replying to [comment:50 jdemeyer]:

> ` $ hg status ? SPKG.txt~ `



---

archive/issue_comments_125005.json:
```json
{
    "body": "SPKG.txt~ removed and renamed to ...p0",
    "created_at": "2012-04-09T23:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125005",
    "user": "https://github.com/gutow"
}
```

SPKG.txt~ removed and renamed to ...p0



---

archive/issue_comments_125006.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-04-09T23:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125006",
    "user": "https://github.com/gutow"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_125007.json:
```json
{
    "body": "I believe this ticket is actually included in the positively reviewed\u00a0#11080. \u00a0If there are no objections, I believe this should become a positive review as well.",
    "created_at": "2012-05-28T14:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125007",
    "user": "https://github.com/gutow"
}
```

I believe this ticket is actually included in the positively reviewed #11080.  If there are no objections, I believe this should become a positive review as well.



---

archive/issue_comments_125008.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-28T15:10:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125008",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_125009.json:
```json
{
    "body": "Indeed this should be positive review. I have been using it both from the notebook and from the command line without issues, for several months.\n\nSetting it to positive review.",
    "created_at": "2012-05-28T15:10:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125009",
    "user": "https://github.com/ppurka"
}
```

Indeed this should be positive review. I have been using it both from the notebook and from the command line without issues, for several months.

Setting it to positive review.



---

archive/issue_events_029976.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T14:39:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29976"
}
```



---

archive/issue_events_029977.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-02T14:39:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29977"
}
```



---

archive/issue_comments_125010.json:
```json
{
    "body": "Please put the latest version of the SPKG up on this ticket. It looks like #12299's instructions mention a newer version of the SPKG than is found here.",
    "created_at": "2012-06-27T23:20:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125010",
    "user": "https://github.com/kini"
}
```

Please put the latest version of the SPKG up on this ticket. It looks like #12299's instructions mention a newer version of the SPKG than is found here.



---

archive/issue_comments_125011.json:
```json
{
    "body": "Jonathan can correct me if I'm wrong, but as far as I know, this is on purpose, because the newest Jmol at #12299 needs the many updates to Jmol there.  In that sense this ticket is a 'hard' prereq for #11080 and hence for #13121/#12299.",
    "created_at": "2012-06-28T01:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125011",
    "user": "https://github.com/kcrisman"
}
```

Jonathan can correct me if I'm wrong, but as far as I know, this is on purpose, because the newest Jmol at #12299 needs the many updates to Jmol there.  In that sense this ticket is a 'hard' prereq for #11080 and hence for #13121/#12299.



---

archive/issue_comments_125012.json:
```json
{
    "body": "OK, fair enough.",
    "created_at": "2012-06-28T02:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125012",
    "user": "https://github.com/kini"
}
```

OK, fair enough.



---

archive/issue_events_029978.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-02T15:22:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29978"
}
```



---

archive/issue_comments_125013.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-07-02T15:22:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125013",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_125014.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2012-07-23T06:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125014",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_125015.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2012-07-23T06:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125015",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_029979.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:50:54Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29979"
}
```



---

archive/issue_events_029980.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:50:54Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29980"
}
```



---

archive/issue_events_029981.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-23T06:50:54Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29981"
}
```



---

archive/issue_comments_125016.json:
```json
{
    "body": "Unmerging this from sage-5.2 due to the serious security issue at #13270.",
    "created_at": "2012-07-23T06:50:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125016",
    "user": "https://github.com/jdemeyer"
}
```

Unmerging this from sage-5.2 due to the serious security issue at #13270.



---

archive/issue_comments_125017.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-07-23T06:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125017",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_125018.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-07-23T06:51:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125018",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_029982.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-25T06:40:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29982"
}
```



---

archive/issue_events_029983.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-25T06:40:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29983"
}
```



---

archive/issue_events_029984.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-07-25T06:40:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11331#event-29984"
}
```



---

archive/issue_comments_125019.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-07-25T06:40:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11331",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11331#issuecomment-125019",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
