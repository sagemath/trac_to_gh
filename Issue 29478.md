# Issue 29478: Radius computation for undirected graph using certificates

archive/issues_029478.json:
```json
{
    "body": "CC:  dcoudert\n\nKeywords: gsoc\n\nThis ticket aims to implement radius computation method given in [http://arxiv.org/abs/1803.04660](http://arxiv.org/abs/1803.04660)\n\nIssue created by migration from https://trac.sagemath.org/ticket/29715\n\n",
    "created_at": "2020-05-19T20:30:03Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "title": "Radius computation for undirected graph using certificates",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29478",
    "user": "@vipul79321"
}
```
CC:  dcoudert

Keywords: gsoc

This ticket aims to implement radius computation method given in [http://arxiv.org/abs/1803.04660](http://arxiv.org/abs/1803.04660)

Issue created by migration from https://trac.sagemath.org/ticket/29715





---

archive/issue_comments_418382.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-05-19T20:32:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418382",
    "user": "@vipul79321"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_418383.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-19T20:32:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418383",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418384.json:
```json
{
    "body": "Replying to [comment:2 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[bf852a4](https://git.sagemath.org/sage.git/commit/?id=bf852a412f4f730b2b4e2eadd6e3d4c5f1f2b24c)||`radius, diameter, eccentricity, center, periphery moved to graph and digraph separately`||\n> ||[9e2dcc8](https://git.sagemath.org/sage.git/commit/?id=9e2dcc8af873970454449639cb7ee253289447c9)||`unneccessary comments removed`||\n> ||[49c60b6](https://git.sagemath.org/sage.git/commit/?id=49c60b69b893792fbb6262190fa66637b7a82caa)||`added for unweighted graphs`||\n\nThe first two commits are from #29660.\n\nCurrently, it is for unweighted graph. And I havent modified radius method in `graph.py` yet, because it might cause merge conflict.||\nAnd also, any suggestion on documentation will be helpful",
    "created_at": "2020-05-19T20:36:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418384",
    "user": "@vipul79321"
}
```

Replying to [comment:2 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[bf852a4](https://git.sagemath.org/sage.git/commit/?id=bf852a412f4f730b2b4e2eadd6e3d4c5f1f2b24c)||`radius, diameter, eccentricity, center, periphery moved to graph and digraph separately`||
> ||[9e2dcc8](https://git.sagemath.org/sage.git/commit/?id=9e2dcc8af873970454449639cb7ee253289447c9)||`unneccessary comments removed`||
> ||[49c60b6](https://git.sagemath.org/sage.git/commit/?id=49c60b69b893792fbb6262190fa66637b7a82caa)||`added for unweighted graphs`||

The first two commits are from #29660.

Currently, it is for unweighted graph. And I havent modified radius method in `graph.py` yet, because it might cause merge conflict.||
And also, any suggestion on documentation will be helpful



---

archive/issue_comments_418385.json:
```json
{
    "body": "Several comments to start:\n- `bitset_init` to a malloc, so it should be call only once. check file `src/sage/data_structures/bitset.pxi`.\n- and before returning the result, you must do `bitset_free`\n- to empty the bitset, use `bitset_zero` or `bitset_clear`\n- all BFS call can be done inside the main loop. I don't see the need for starting computation before the loop.\n- If needed, you can emulate a `do..while` loop using a `while True:` and a test at the end with a break or return statement.\n- You don't need to maintain sets K and L. \n- It shall be more efficient to maintain the list of active vertices, i.e. for which the eccentricity is not proved yet.\n- You could rename `min_L` and `min_K` as `LB` and `UB` to ease readability of the code ?",
    "created_at": "2020-05-20T07:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418385",
    "user": "dcoudert"
}
```

Several comments to start:
- `bitset_init` to a malloc, so it should be call only once. check file `src/sage/data_structures/bitset.pxi`.
- and before returning the result, you must do `bitset_free`
- to empty the bitset, use `bitset_zero` or `bitset_clear`
- all BFS call can be done inside the main loop. I don't see the need for starting computation before the loop.
- If needed, you can emulate a `do..while` loop using a `while True:` and a test at the end with a break or return statement.
- You don't need to maintain sets K and L. 
- It shall be more efficient to maintain the list of active vertices, i.e. for which the eccentricity is not proved yet.
- You could rename `min_L` and `min_K` as `LB` and `UB` to ease readability of the code ?



---

archive/issue_comments_418386.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-20T18:10:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418386",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418387.json:
```json
{
    "body": "Replying to [comment:4 dcoudert]:\n> Several comments to start:\n> - `bitset_init` to a malloc, so it should be call only once. check file `src/sage/data_structures/bitset.pxi`.\n> - and before returning the result, you must do `bitset_free`\n> - to empty the bitset, use `bitset_zero` or `bitset_clear`\nDidnt knew that. Fixed it.\n> - all BFS call can be done inside the main loop. I don't see the need for starting computation before the loop.\n> - If needed, you can emulate a `do..while` loop using a `while True:` and a test at the end with a break or return statement.\nYou are right. I dont know what was I thinking. \nFixed it.\n> - You don't need to maintain sets K and L. \nagreed\n> - It shall be more efficient to maintain the list of active vertices, i.e. for which the eccentricity is not proved yet.\nI guess, we wont need this too.\n> - You could rename `min_L` and `min_K` as `LB` and `UB` to ease readability of the code ?\nDone.",
    "created_at": "2020-05-20T18:13:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418387",
    "user": "@vipul79321"
}
```

Replying to [comment:4 dcoudert]:
> Several comments to start:
> - `bitset_init` to a malloc, so it should be call only once. check file `src/sage/data_structures/bitset.pxi`.
> - and before returning the result, you must do `bitset_free`
> - to empty the bitset, use `bitset_zero` or `bitset_clear`
Didnt knew that. Fixed it.
> - all BFS call can be done inside the main loop. I don't see the need for starting computation before the loop.
> - If needed, you can emulate a `do..while` loop using a `while True:` and a test at the end with a break or return statement.
You are right. I dont know what was I thinking. 
Fixed it.
> - You don't need to maintain sets K and L. 
agreed
> - It shall be more efficient to maintain the list of active vertices, i.e. for which the eccentricity is not proved yet.
I guess, we wont need this too.
> - You could rename `min_L` and `min_K` as `LB` and `UB` to ease readability of the code ?
Done.



---

archive/issue_comments_418388.json:
```json
{
    "body": "- In the tests, you have to be very careful with random graphs. May be it's not connected, or has a larger diameter, etc. I suggest to change the test as follows:\n  - use a smaller value of n, like 20 or 30\n  - use a smaller density like .3. .6 is for very dense graphs.\n  - don't print the result. Instead, call another algorithm (the basic one) and check that the results are the same. This is much more robust.\n\n- some simple improvements\n\n```diff\n-    if not n or n == 1:\n+    if n <= 1:\n```\n\n\n```diff\n-    memset(ecc_lower_bound,0,n * sizeof(uint32_t))\n+    memset(ecc_lower_bound, 0, n * sizeof(uint32_t))\n```\n\n\n```diff\n-        if(ecc[source] == ecc_lower_bound[source]):\n+        if ecc[source] == ecc_lower_bound[source]:\n```\n\n- when adding a comment at the end of a line, ensure to let 2 spaces. I don't remember if it's pep8 or something else, but it's apparently better.\n\n```diff\n-    bitset_init(seen,n) # intializing bitset\n+    bitset_init(seen,n)  # intializing bitset\n```\n\n\n\nAlong the code, you should add comments like: \n- we take a vertex with minimum eccentricity lower bound and compute it's exact eccentricity\n- if its eccentricity equals its lower bound, we found a vertex with minimum eccentricity, and so the radius\n- otherwise, we take the vertex at largest distance from the current source, called the antipode, and use BFS distances from this antipode to improve eccentricity lower bounds.\n\nAnd FYI, in this kind of algorithms, a vertex with small eccentricity helps reducing the upper bounds while a vertex with large eccentricity helps increasing lower bounds.  That's why we don't use more the BFS from source here. We care only about lower bound.\n\nQ: have you tested the algorithm on rather large graphs ? Do you agree that it's way faster than other algorithms ?",
    "created_at": "2020-05-21T09:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418388",
    "user": "dcoudert"
}
```

- In the tests, you have to be very careful with random graphs. May be it's not connected, or has a larger diameter, etc. I suggest to change the test as follows:
  - use a smaller value of n, like 20 or 30
  - use a smaller density like .3. .6 is for very dense graphs.
  - don't print the result. Instead, call another algorithm (the basic one) and check that the results are the same. This is much more robust.

- some simple improvements

```diff
-    if not n or n == 1:
+    if n <= 1:
```


```diff
-    memset(ecc_lower_bound,0,n * sizeof(uint32_t))
+    memset(ecc_lower_bound, 0, n * sizeof(uint32_t))
```


```diff
-        if(ecc[source] == ecc_lower_bound[source]):
+        if ecc[source] == ecc_lower_bound[source]:
```

- when adding a comment at the end of a line, ensure to let 2 spaces. I don't remember if it's pep8 or something else, but it's apparently better.

```diff
-    bitset_init(seen,n) # intializing bitset
+    bitset_init(seen,n)  # intializing bitset
```



Along the code, you should add comments like: 
- we take a vertex with minimum eccentricity lower bound and compute it's exact eccentricity
- if its eccentricity equals its lower bound, we found a vertex with minimum eccentricity, and so the radius
- otherwise, we take the vertex at largest distance from the current source, called the antipode, and use BFS distances from this antipode to improve eccentricity lower bounds.

And FYI, in this kind of algorithms, a vertex with small eccentricity helps reducing the upper bounds while a vertex with large eccentricity helps increasing lower bounds.  That's why we don't use more the BFS from source here. We care only about lower bound.

Q: have you tested the algorithm on rather large graphs ? Do you agree that it's way faster than other algorithms ?



---

archive/issue_comments_418389.json:
```json
{
    "body": "Yeah it works faster than other algorithms. Few examples are as follows-\n\n```\nsage: from sage.graphs.distances_all_pairs import radius\nsage: G = graphs.BubbleSortGraph(7)\nsage: %time radius(G)\nCPU times: user 1.41 s, sys: 7.12 ms, total: 1.42 s\nWall time: 1.42 s\n21\nsage: %time G.radius()\nCPU times: user 45.3 s, sys: 6.58 ms, total: 45.3 s\nWall time: 45.3 s\n21\n\n```\n\n\n\n\n```\nsage: G = graphs.FoldedCubeGraph(13)\nsage: %time radius(G)\nCPU times: user 47.2 ms, sys: 0 ns, total: 47.2 ms\nWall time: 46.6 ms\n6\nsage: %time G.radius()\nCPU times: user 1min 1s, sys: 3.15 ms, total: 1min 1s\nWall time: 1min 1s\n6\n\n```\n\n\n\n\n```\nsage: G = graphs.RandomBicubicPlanar(400)\nsage: %time radius(G)\nCPU times: user 10.3 ms, sys: 0 ns, total: 10.3 ms\nWall time: 9.91 ms\n23\nsage: %time G.radius()\nCPU times: user 538 ms, sys: 4 \u00b5s, total: 538 ms\nWall time: 536 ms\n23\n\n```\n\n\n\n\n```\nsage: G = graphs.RandomGNP(1000,0.6)\nsage: %time radius(G)\nCPU times: user 181 ms, sys: 7.99 ms, total: 189 ms\nWall time: 188 ms\n2\nsage: %time G.radius()\nCPU times: user 2min 9s, sys: 26 s, total: 2min 35s\nWall time: 2min 35s\n2\n\n```\n",
    "created_at": "2020-05-21T18:09:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418389",
    "user": "@vipul79321"
}
```

Yeah it works faster than other algorithms. Few examples are as follows-

```
sage: from sage.graphs.distances_all_pairs import radius
sage: G = graphs.BubbleSortGraph(7)
sage: %time radius(G)
CPU times: user 1.41 s, sys: 7.12 ms, total: 1.42 s
Wall time: 1.42 s
21
sage: %time G.radius()
CPU times: user 45.3 s, sys: 6.58 ms, total: 45.3 s
Wall time: 45.3 s
21

```




```
sage: G = graphs.FoldedCubeGraph(13)
sage: %time radius(G)
CPU times: user 47.2 ms, sys: 0 ns, total: 47.2 ms
Wall time: 46.6 ms
6
sage: %time G.radius()
CPU times: user 1min 1s, sys: 3.15 ms, total: 1min 1s
Wall time: 1min 1s
6

```




```
sage: G = graphs.RandomBicubicPlanar(400)
sage: %time radius(G)
CPU times: user 10.3 ms, sys: 0 ns, total: 10.3 ms
Wall time: 9.91 ms
23
sage: %time G.radius()
CPU times: user 538 ms, sys: 4 Âµs, total: 538 ms
Wall time: 536 ms
23

```




```
sage: G = graphs.RandomGNP(1000,0.6)
sage: %time radius(G)
CPU times: user 181 ms, sys: 7.99 ms, total: 189 ms
Wall time: 188 ms
2
sage: %time G.radius()
CPU times: user 2min 9s, sys: 26 s, total: 2min 35s
Wall time: 2min 35s
2

```




---

archive/issue_comments_418390.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-21T18:13:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418390",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418391.json:
```json
{
    "body": "The default of this test is that soon it will compare the new algorithm with itself ;)\nCurrently, when calling `G.radius()`, we take the minimum over all eccentricities, and for unweighted undirected graphs, eccentricities are computed using the algorithm by Takes and Kosters in `distances_all_pairs`.\nSo you could do for instance the following\n\n```diff\n-        sage: radius(G) == G.radius()\n+        sage: from sage.graphs.distances_all_pairs import eccentricity\n+        sage: radius(G) == min(eccentricity(G, algorithm='bounds'))\n```\n\nIn the future, we should rename `'bounds'` to something like `'TK'` to better distinguish between algorithms by Takes and Koster and algorithms by Dragan, Habib and Viennot.\n\nI just realized that the key of the reference to the paper is Habib2018 while the first author is Dragan. Please correct that and put the reference at the right place.",
    "created_at": "2020-05-22T08:13:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418391",
    "user": "dcoudert"
}
```

The default of this test is that soon it will compare the new algorithm with itself ;)
Currently, when calling `G.radius()`, we take the minimum over all eccentricities, and for unweighted undirected graphs, eccentricities are computed using the algorithm by Takes and Kosters in `distances_all_pairs`.
So you could do for instance the following

```diff
-        sage: radius(G) == G.radius()
+        sage: from sage.graphs.distances_all_pairs import eccentricity
+        sage: radius(G) == min(eccentricity(G, algorithm='bounds'))
```

In the future, we should rename `'bounds'` to something like `'TK'` to better distinguish between algorithms by Takes and Koster and algorithms by Dragan, Habib and Viennot.

I just realized that the key of the reference to the paper is Habib2018 while the first author is Dragan. Please correct that and put the reference at the right place.



---

archive/issue_comments_418392.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-22T10:51:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418392",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418393.json:
```json
{
    "body": "Replying to [comment:10 dcoudert]:\n> The default of this test is that soon it will compare the new algorithm with itself ;)\nDidnt saw that coming :)\n> Currently, when calling `G.radius()`, we take the minimum over all eccentricities, and for unweighted undirected graphs, eccentricities are computed using the algorithm by Takes and Kosters in `distances_all_pairs`.\n> So you could do for instance the following\n> {{{#!diff\n> -        sage: radius(G) == G.radius()\n> +        sage: from sage.graphs.distances_all_pairs import eccentricity\n> +        sage: radius(G) == min(eccentricity(G, algorithm='bounds'))\n> }}}\nDone\n> In the future, we should rename `'bounds'` to something like `'TK'` to better distinguish between algorithms by Takes and Koster and algorithms by Dragan, Habib and Viennot.\n> \nok\n> I just realized that the key of the reference to the paper is Habib2018 while the first author is Dragan. Please correct that and put the reference at the right place.\n> \nfixed.\\\\\n\\\\\nOne more thing. Should I implement the weighted version of this algorithm in this ticket or open separate ticket for that purpose?",
    "created_at": "2020-05-22T10:54:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418393",
    "user": "@vipul79321"
}
```

Replying to [comment:10 dcoudert]:
> The default of this test is that soon it will compare the new algorithm with itself ;)
Didnt saw that coming :)
> Currently, when calling `G.radius()`, we take the minimum over all eccentricities, and for unweighted undirected graphs, eccentricities are computed using the algorithm by Takes and Kosters in `distances_all_pairs`.
> So you could do for instance the following
> {{{#!diff
> -        sage: radius(G) == G.radius()
> +        sage: from sage.graphs.distances_all_pairs import eccentricity
> +        sage: radius(G) == min(eccentricity(G, algorithm='bounds'))
> }}}
Done
> In the future, we should rename `'bounds'` to something like `'TK'` to better distinguish between algorithms by Takes and Koster and algorithms by Dragan, Habib and Viennot.
> 
ok
> I just realized that the key of the reference to the paper is Habib2018 while the first author is Dragan. Please correct that and put the reference at the right place.
> 
fixed.\\
\\
One more thing. Should I implement the weighted version of this algorithm in this ticket or open separate ticket for that purpose?



---

archive/issue_comments_418394.json:
```json
{
    "body": "> One more thing. Should I implement the weighted version of this algorithm in this ticket or open separate ticket for that purpose?\n\nyou can certainly do it here, but in another file (different backend). The + is that you will be able to integrate all at once. The - is that the risk of conflict with other tickets increases, but is honestly rather limited.\n\nI just realized that it is incorrect to raise an error if the graph is weighted. This method does not take edge weights into account and it is clear in the method description (you can be more explicit if you think it is not enough).\n\n```diff\n-    if G.is_directed() or G.weighted():\n+    if G.is_directed():\n```\n",
    "created_at": "2020-05-22T11:58:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418394",
    "user": "dcoudert"
}
```

> One more thing. Should I implement the weighted version of this algorithm in this ticket or open separate ticket for that purpose?

you can certainly do it here, but in another file (different backend). The + is that you will be able to integrate all at once. The - is that the risk of conflict with other tickets increases, but is honestly rather limited.

I just realized that it is incorrect to raise an error if the graph is weighted. This method does not take edge weights into account and it is clear in the method description (you can be more explicit if you think it is not enough).

```diff
-    if G.is_directed() or G.weighted():
+    if G.is_directed():
```




---

archive/issue_comments_418395.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-23T19:45:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418395",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418396.json:
```json
{
    "body": "Replying to [comment:14 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[25f7230](https://git.sagemath.org/sage.git/commit/?id=25f72302aabc364e87d5c9e4c473d6f0ffa5b3da)||`added radius method for weighted graphs`||\n\nI have added method for computing radius of weighted graph in boost_graph.pyx file.\n\nTODO: \n- complete documentation\n- add testcases\n\nMajor issue: \n- on running program alongwith radius, following error occurs. I tried solving it, with no luck. Can you look into it.\n\n\n```\nsage: from sage.graphs.base.boost_graph import radius\nsage: G = graphs.PetersenGraph()\nsage: radius(G)\n2.0\nsage: free(): invalid next size (fast)\n------------------------------------------------------------------------\n/home/vipul/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x827b)[0x7f85753f427b]\n/home/vipul/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x8338)[0x7f85753f4338]\n/home/vipul/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0xb2e5)[0x7f85753f72e5]\n/lib/x86_64-linux-gnu/libc.so.6(+0x3ef20)[0x7f8584092f20]\n/lib/x86_64-linux-gnu/libc.so.6(gsignal+0xc7)[0x7f8584092e97]\n/lib/x86_64-linux-gnu/libc.so.6(abort+0x141)[0x7f8584094801]\n/lib/x86_64-linux-gnu/libc.so.6(+0x89897)[0x7f85840dd897]\n/lib/x86_64-linux-gnu/libc.so.6(+0x9090a)[0x7f85840e490a]\n/lib/x86_64-linux-gnu/libc.so.6(+0x19bcc1)[0x7f85841efcc1]\n/lib/x86_64-linux-gnu/libc.so.6(__libc_thread_freeres+0x32)[0x7f85841f0652]\n/lib/x86_64-linux-gnu/libpthread.so.0(+0x7700)[0x7f8583e3c700]\n/lib/x86_64-linux-gnu/libc.so.6(clone+0x3f)[0x7f858417588f]\n------------------------------------------------------------------------\nAttaching gdb to process id 13376.\n\n```\n",
    "created_at": "2020-05-23T19:48:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418396",
    "user": "@vipul79321"
}
```

Replying to [comment:14 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[25f7230](https://git.sagemath.org/sage.git/commit/?id=25f72302aabc364e87d5c9e4c473d6f0ffa5b3da)||`added radius method for weighted graphs`||

I have added method for computing radius of weighted graph in boost_graph.pyx file.

TODO: 
- complete documentation
- add testcases

Major issue: 
- on running program alongwith radius, following error occurs. I tried solving it, with no luck. Can you look into it.


```
sage: from sage.graphs.base.boost_graph import radius
sage: G = graphs.PetersenGraph()
sage: radius(G)
2.0
sage: free(): invalid next size (fast)
------------------------------------------------------------------------
/home/vipul/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x827b)[0x7f85753f427b]
/home/vipul/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0x8338)[0x7f85753f4338]
/home/vipul/sage/local/lib/python3.7/site-packages/cysignals/signals.cpython-37m-x86_64-linux-gnu.so(+0xb2e5)[0x7f85753f72e5]
/lib/x86_64-linux-gnu/libc.so.6(+0x3ef20)[0x7f8584092f20]
/lib/x86_64-linux-gnu/libc.so.6(gsignal+0xc7)[0x7f8584092e97]
/lib/x86_64-linux-gnu/libc.so.6(abort+0x141)[0x7f8584094801]
/lib/x86_64-linux-gnu/libc.so.6(+0x89897)[0x7f85840dd897]
/lib/x86_64-linux-gnu/libc.so.6(+0x9090a)[0x7f85840e490a]
/lib/x86_64-linux-gnu/libc.so.6(+0x19bcc1)[0x7f85841efcc1]
/lib/x86_64-linux-gnu/libc.so.6(__libc_thread_freeres+0x32)[0x7f85841f0652]
/lib/x86_64-linux-gnu/libpthread.so.0(+0x7700)[0x7f8583e3c700]
/lib/x86_64-linux-gnu/libc.so.6(clone+0x3f)[0x7f858417588f]
------------------------------------------------------------------------
Attaching gdb to process id 13376.

```




---

archive/issue_comments_418397.json:
```json
{
    "body": "What is the relation with #29431? It looks to me like they should be combined somehow, or one should be closed as a duplicate.",
    "created_at": "2020-05-23T21:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418397",
    "user": "@DaveWitteMorris"
}
```

What is the relation with #29431? It looks to me like they should be combined somehow, or one should be closed as a duplicate.



---

archive/issue_comments_418398.json:
```json
{
    "body": "I suspect the issue is `cdef vector[double] ecc = {0 for i in range(n)}`. I tried using a for loop with `push_back` and got no issue.\n\nYou can:\n- use type `bint` for `negative_weight`\n- use type `v_index` for `source`, `next_source`, `antipode` and `v`\n- use strict comparison for `if eccentricity <= result.distances[v]:`\n- error message start with lower case letter, so This -> this",
    "created_at": "2020-05-24T09:39:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418398",
    "user": "dcoudert"
}
```

I suspect the issue is `cdef vector[double] ecc = {0 for i in range(n)}`. I tried using a for loop with `push_back` and got no issue.

You can:
- use type `bint` for `negative_weight`
- use type `v_index` for `source`, `next_source`, `antipode` and `v`
- use strict comparison for `if eccentricity <= result.distances[v]:`
- error message start with lower case letter, so This -> this



---

archive/issue_comments_418399.json:
```json
{
    "body": "Replying to [comment:16 gh-DaveWitteMorris]:\n> What is the relation with #29431? It looks to me like they should be combined somehow, or one should be closed as a duplicate.\n\nRight. We will certainly have to close #29431 as duplicate.",
    "created_at": "2020-05-24T09:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418399",
    "user": "dcoudert"
}
```

Replying to [comment:16 gh-DaveWitteMorris]:
> What is the relation with #29431? It looks to me like they should be combined somehow, or one should be closed as a duplicate.

Right. We will certainly have to close #29431 as duplicate.



---

archive/issue_comments_418400.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-05-24T18:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418400",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418401.json:
```json
{
    "body": "Replying to [comment:19 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[abdabce](https://git.sagemath.org/sage.git/commit/?id=abdabce90fd9cb623753c1e5fcde4b00b39b46b9)||`Documentation completed`||\n\nI have updated documentation. For testing correctness, I have checked this on unweighted graphs. For performance comparisons, I have compared it with `G.radius(algorithm='Dijkstra_Boost')` on unweighted graphs.\n\\\\\nCan you suggest me some weighted graph to test and compare it on.\n\n\\\\\nMajor issue\n-\n\n\n```\nsage: from sage.graphs.base.boost_graph import radius\nsage: G = graphs.PathGraph(7)\nsage: radius(G)\n3.0\nsage: G.weighted()\nFalse\nsage: G.radius(algorithm = 'Dijkstra_Boost')\n3\nsage: G.weighted()\nTrue\nsage: radius(G)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-7-7c36f6341733> in <module>()\n----> 1 radius(G)\n\n/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.radius (build/cythonized/sage/graphs/base/boost_graph.cpp:19859)()\n   1605     return cycle_basis\n   1606 \n-> 1607 cpdef radius(g, weight_function=None):\n   1608     r\"\"\"\n   1609     Return radius of weighted graph `g`.\n\n/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.radius (build/cythonized/sage/graphs/base/boost_graph.cpp:19149)()\n   1672     cdef dict v_to_int = {vv: vi for vi, vv in enumerate(g)}\n   1673     cdef BoostVecWeightedGraph g_boost\n-> 1674     boost_weighted_graph_from_sage_graph(&g_boost, g, v_to_int, weight_function)\n   1675 \n   1676     import sys\n\n/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.boost_weighted_graph_from_sage_graph (build/cythonized/sage/graphs/base/boost_graph.cpp:3879)()\n    159         else:\n    160             for u,v,w in g_sage.edge_iterator():\n--> 161                 g.add_edge(vertex_to_int[u], vertex_to_int[v], float(w))\n    162     else:\n    163         if reverse:\n\nTypeError: float() argument must be a string or a number, not 'NoneType'\n\n```\n\nThis error occurs due to conversion of `G` from `unweighted` to `weighted` and this conversion occurs in `shortest_path_lengths` method in `generic_graph.py`\n\nIdeas to solve this problem \n- Either we make sure that `radius` method in `boost_graph.pyx` is always called with non-none weight function, as done in `shortest_path_lengths` method in `generic_graph.py`. As we cannot define a function inside cpdef function.\n\n- We make changes in `shortest_path_lengths` in `generic_graph.pyx` method and simultaneously update `shortest_paths` method in `boost_graph.pyx`. (This might have some other consequences.)",
    "created_at": "2020-05-24T19:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418401",
    "user": "@vipul79321"
}
```

Replying to [comment:19 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[abdabce](https://git.sagemath.org/sage.git/commit/?id=abdabce90fd9cb623753c1e5fcde4b00b39b46b9)||`Documentation completed`||

I have updated documentation. For testing correctness, I have checked this on unweighted graphs. For performance comparisons, I have compared it with `G.radius(algorithm='Dijkstra_Boost')` on unweighted graphs.
\\
Can you suggest me some weighted graph to test and compare it on.

\\
Major issue
-


```
sage: from sage.graphs.base.boost_graph import radius
sage: G = graphs.PathGraph(7)
sage: radius(G)
3.0
sage: G.weighted()
False
sage: G.radius(algorithm = 'Dijkstra_Boost')
3
sage: G.weighted()
True
sage: radius(G)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-7-7c36f6341733> in <module>()
----> 1 radius(G)

/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.radius (build/cythonized/sage/graphs/base/boost_graph.cpp:19859)()
   1605     return cycle_basis
   1606 
-> 1607 cpdef radius(g, weight_function=None):
   1608     r"""
   1609     Return radius of weighted graph `g`.

/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.radius (build/cythonized/sage/graphs/base/boost_graph.cpp:19149)()
   1672     cdef dict v_to_int = {vv: vi for vi, vv in enumerate(g)}
   1673     cdef BoostVecWeightedGraph g_boost
-> 1674     boost_weighted_graph_from_sage_graph(&g_boost, g, v_to_int, weight_function)
   1675 
   1676     import sys

/home/vipul/sage/local/lib/python3.7/site-packages/sage/graphs/base/boost_graph.pyx in sage.graphs.base.boost_graph.boost_weighted_graph_from_sage_graph (build/cythonized/sage/graphs/base/boost_graph.cpp:3879)()
    159         else:
    160             for u,v,w in g_sage.edge_iterator():
--> 161                 g.add_edge(vertex_to_int[u], vertex_to_int[v], float(w))
    162     else:
    163         if reverse:

TypeError: float() argument must be a string or a number, not 'NoneType'

```

This error occurs due to conversion of `G` from `unweighted` to `weighted` and this conversion occurs in `shortest_path_lengths` method in `generic_graph.py`

Ideas to solve this problem 
- Either we make sure that `radius` method in `boost_graph.pyx` is always called with non-none weight function, as done in `shortest_path_lengths` method in `generic_graph.py`. As we cannot define a function inside cpdef function.

- We make changes in `shortest_path_lengths` in `generic_graph.pyx` method and simultaneously update `shortest_paths` method in `boost_graph.pyx`. (This might have some other consequences.)



---

archive/issue_comments_418402.json:
```json
{
    "body": "You raised an issue that must be fixed separately.\n\nCan you open a specific ticket (no need to build it on top of this ticket) ?\n\nIn general, the input graph should never be modified by a method, unless the method is specifically designed for (e.g., add an edge/vertex, etc.).",
    "created_at": "2020-05-25T11:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418402",
    "user": "dcoudert"
}
```

You raised an issue that must be fixed separately.

Can you open a specific ticket (no need to build it on top of this ticket) ?

In general, the input graph should never be modified by a method, unless the method is specifically designed for (e.g., add an edge/vertex, etc.).



---

archive/issue_comments_418403.json:
```json
{
    "body": "Replying to [comment:21 dcoudert]:\n> You raised an issue that must be fixed separately.\n> \n> Can you open a specific ticket (no need to build it on top of this ticket) ?\n> \n> In general, the input graph should never be modified by a method, unless the method is specifically designed for (e.g., add an edge/vertex, etc.).\n\nI have opened #29734 for this purpose and provided my solution for it. You can review it. And tell me, if anything needs to be done.",
    "created_at": "2020-05-25T16:14:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418403",
    "user": "@vipul79321"
}
```

Replying to [comment:21 dcoudert]:
> You raised an issue that must be fixed separately.
> 
> Can you open a specific ticket (no need to build it on top of this ticket) ?
> 
> In general, the input graph should never be modified by a method, unless the method is specifically designed for (e.g., add an edge/vertex, etc.).

I have opened #29734 for this purpose and provided my solution for it. You can review it. And tell me, if anything needs to be done.



---

archive/issue_comments_418404.json:
```json
{
    "body": "you can now rename the methods `radius_DHV` and expose them in `graph.py`.",
    "created_at": "2020-05-31T17:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418404",
    "user": "dcoudert"
}
```

you can now rename the methods `radius_DHV` and expose them in `graph.py`.



---

archive/issue_comments_418405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-01T13:03:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418405",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418406.json:
```json
{
    "body": "Replying to [comment:23 dcoudert]:\n> you can now rename the methods `radius_DHV` and expose them in `graph.py`.\nDone rebasing and updating graph.py.",
    "created_at": "2020-06-01T13:04:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418406",
    "user": "@vipul79321"
}
```

Replying to [comment:23 dcoudert]:
> you can now rename the methods `radius_DHV` and expose them in `graph.py`.
Done rebasing and updating graph.py.



---

archive/issue_comments_418407.json:
```json
{
    "body": "I pushed further improvements in a new branch and removed dependency on 29660.\nThe main change is to reduce the number of arrays used. Do not hesitate to make further tests.\n----\nNew commits:",
    "created_at": "2020-06-01T14:26:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418407",
    "user": "dcoudert"
}
```

I pushed further improvements in a new branch and removed dependency on 29660.
The main change is to reduce the number of arrays used. Do not hesitate to make further tests.
----
New commits:



---

archive/issue_comments_418408.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-02T05:26:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418408",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418409.json:
```json
{
    "body": "Replying to [comment:27 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[a02a614](https://git.sagemath.org/sage.git/commit/?id=a02a614ca3d98e4b9e76cf21d23a8efe96d78b98)||`minor changes and improved consistency`||\n\nI have made changes in defining weight_function in `eccentricity` method. So that both`G.radius(algorithm='Dijkstra_Boost', by_weight=True)` and `G.radius(by_weight=True)` will give same result when graph is unweighted and edge_labels are `None`\n\nRest look fine to me :)",
    "created_at": "2020-06-02T05:31:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418409",
    "user": "@vipul79321"
}
```

Replying to [comment:27 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[a02a614](https://git.sagemath.org/sage.git/commit/?id=a02a614ca3d98e4b9e76cf21d23a8efe96d78b98)||`minor changes and improved consistency`||

I have made changes in defining weight_function in `eccentricity` method. So that both`G.radius(algorithm='Dijkstra_Boost', by_weight=True)` and `G.radius(by_weight=True)` will give same result when graph is unweighted and edge_labels are `None`

Rest look fine to me :)



---

archive/issue_comments_418410.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-02T07:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418410",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418411.json:
```json
{
    "body": "This should fix the documentation.\n\nSome issues remain with the usage of weights with boost. If the method is called without weight function and that `g.weigthed() == False`, then the weight of edges is set to 1. This is not documented in the boost method.\nAlso, we don't use the parameter `check_weight`.",
    "created_at": "2020-06-02T07:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418411",
    "user": "dcoudert"
}
```

This should fix the documentation.

Some issues remain with the usage of weights with boost. If the method is called without weight function and that `g.weigthed() == False`, then the weight of edges is set to 1. This is not documented in the boost method.
Also, we don't use the parameter `check_weight`.



---

archive/issue_comments_418412.json:
```json
{
    "body": "Replying to [comment:30 dcoudert]:\n> Some issues remain with the usage of weights with boost. If the method is called without weight function and that `g.weigthed() == False`, then the weight of edges is set to 1. This is not documented in the boost method.\n\n\n```diff\n-    - ``weight_function`` -- function (default: ``None``); a function that\n-      associates a weight to each edge. If ``None`` (default), the weights of\n-      ``g`` are used, if available, otherwise all edges have weight 1.\n\n+    - ``weight_function`` -- function (default: ``None``); a function that\n+      associates a weight to each edge. If ``None`` (default), the weights of\n+      ``g`` are used, if ``g.weighted()==True``, otherwise all edges have weight 1.\n```\n\nAre you suggesting this?\n\\\\\\\\\n\n> Also, we don't use the parameter `check_weight`.\nFor this we can do the following:\n- In `radius` method in `graph.py`\n\n\n```diff\n+    if by_weight and not weight_function:\n+        def weight_function(e):\n+            return e[2] if e[2] else 1\n```\n\n\n- In `radius_DHV` in `boost_graph.pyx`, introduce check_weight parameter\n\n\n```diff\n+    if check_weight and weight_function:\n+         self._check_weight_function(weight_function)\n```\n\n\nWhat are your opinion on this. I will apply same changes in #29744",
    "created_at": "2020-06-02T16:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418412",
    "user": "@vipul79321"
}
```

Replying to [comment:30 dcoudert]:
> Some issues remain with the usage of weights with boost. If the method is called without weight function and that `g.weigthed() == False`, then the weight of edges is set to 1. This is not documented in the boost method.


```diff
-    - ``weight_function`` -- function (default: ``None``); a function that
-      associates a weight to each edge. If ``None`` (default), the weights of
-      ``g`` are used, if available, otherwise all edges have weight 1.

+    - ``weight_function`` -- function (default: ``None``); a function that
+      associates a weight to each edge. If ``None`` (default), the weights of
+      ``g`` are used, if ``g.weighted()==True``, otherwise all edges have weight 1.
```

Are you suggesting this?
\\\\

> Also, we don't use the parameter `check_weight`.
For this we can do the following:
- In `radius` method in `graph.py`


```diff
+    if by_weight and not weight_function:
+        def weight_function(e):
+            return e[2] if e[2] else 1
```


- In `radius_DHV` in `boost_graph.pyx`, introduce check_weight parameter


```diff
+    if check_weight and weight_function:
+         self._check_weight_function(weight_function)
```


What are your opinion on this. I will apply same changes in #29744



---

archive/issue_comments_418413.json:
```json
{
    "body": "> Are you suggesting this?\n\nYes, something like that.\n\n> > Also, we don't use the parameter `check_weight`.\n> For this we can do the following:\n> - In `radius` method in `graph.py`\n> \n> {{{#!diff\n> +    if by_weight and not weight_function:\n> +        def weight_function(e):\n> +            return e[2] if e[2] else 1\n> }}}\n\nbetter to do `return 1 if e[2] is None else e[2]`. Somehow, we should raise an error if the label of an edge is a string or something else.\n\n\n> - In `radius_DHV` in `boost_graph.pyx`, introduce check_weight parameter\n> \n> {{{#!diff\n> +    if check_weight and weight_function:\n> +         self._check_weight_function(weight_function)\n> }}}\n> \n> What are your opinion on this. I will apply same changes in #29744\n\nok",
    "created_at": "2020-06-02T16:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418413",
    "user": "dcoudert"
}
```

> Are you suggesting this?

Yes, something like that.

> > Also, we don't use the parameter `check_weight`.
> For this we can do the following:
> - In `radius` method in `graph.py`
> 
> {{{#!diff
> +    if by_weight and not weight_function:
> +        def weight_function(e):
> +            return e[2] if e[2] else 1
> }}}

better to do `return 1 if e[2] is None else e[2]`. Somehow, we should raise an error if the label of an edge is a string or something else.


> - In `radius_DHV` in `boost_graph.pyx`, introduce check_weight parameter
> 
> {{{#!diff
> +    if check_weight and weight_function:
> +         self._check_weight_function(weight_function)
> }}}
> 
> What are your opinion on this. I will apply same changes in #29744

ok



---

archive/issue_comments_418414.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-02T18:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418414",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418415.json:
```json
{
    "body": "Replying to [comment:33 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[e495db8](https://git.sagemath.org/sage.git/commit/?id=e495db83ee3a3c6062af53777603221a57077b7b)||`updated according to last commit`||\nupdated according to comment 31",
    "created_at": "2020-06-02T18:45:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418415",
    "user": "@vipul79321"
}
```

Replying to [comment:33 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[e495db8](https://git.sagemath.org/sage.git/commit/?id=e495db83ee3a3c6062af53777603221a57077b7b)||`updated according to last commit`||
updated according to comment 31



---

archive/issue_comments_418416.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-03T05:41:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418416",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418417.json:
```json
{
    "body": "One problem that, I encountered is when method `eccentricity` is called with `v = G.vertices()` and `algorithm = Johnson_Boost` or or `Floyd-Warshall-Python` or `Floyd-Warshall-Cython`. It raises error that works only when all eccentricities are needed.\n\nIt has consequences on `radius` and `diameter` method, since they call min or max of `G.eccentricity(v=list(self),....)`\n\nIn my opinion, We should make condition as `v is None or v == self.vertices()`. Also, to be more precise, shall we do `set(v) == set(self.vertices())`, so ordering wont affect?\n\nShall I proceed to open a ticket for this problem and do suggested changes?",
    "created_at": "2020-06-03T05:54:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418417",
    "user": "@vipul79321"
}
```

One problem that, I encountered is when method `eccentricity` is called with `v = G.vertices()` and `algorithm = Johnson_Boost` or or `Floyd-Warshall-Python` or `Floyd-Warshall-Cython`. It raises error that works only when all eccentricities are needed.

It has consequences on `radius` and `diameter` method, since they call min or max of `G.eccentricity(v=list(self),....)`

In my opinion, We should make condition as `v is None or v == self.vertices()`. Also, to be more precise, shall we do `set(v) == set(self.vertices())`, so ordering wont affect?

Shall I proceed to open a ticket for this problem and do suggested changes?



---

archive/issue_comments_418418.json:
```json
{
    "body": "You can do it here and mention in diameter ticket that the issue is fixed here.\n\nA possible fix is to change the test in method eccentricity to:\n\n```\n        if v is None or all(u in self for u in v):\n```\n\n\nand when calling method eccentricity to set `v=None` instead of `v=list(self)`.",
    "created_at": "2020-06-03T09:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418418",
    "user": "dcoudert"
}
```

You can do it here and mention in diameter ticket that the issue is fixed here.

A possible fix is to change the test in method eccentricity to:

```
        if v is None or all(u in self for u in v):
```


and when calling method eccentricity to set `v=None` instead of `v=list(self)`.



---

archive/issue_comments_418419.json:
```json
{
    "body": "One problem that we forget to address in #29734 was that :\n- We didnt updated documentation of `shortest_paths` method in `boost_graph.pyx`, to this. \n\n\n```diff\n+    - ``weight_function`` -- function (default: ``None``); a function that\n+      associates a weight to each edge. If ``None`` (default), the weights of\n+      ``g`` are used, if ``g.weighted()==True``, otherwise all edges have weight 1\n```\n\n\n- To make weight_function use uniform, I think, we should make following changes in, `shortest_path`, `shortest_path_length`, `shortest_paths` , `shortest_path_lengths`,  `shortest_path_all_pairs`\n\n\n```diff\n+ if by_weight and weight_function is None:\n+     def weight_function(e):\n+         return 1 if e[2] is None else e[2] \n```\n\nand this should be at the begining of each method, so that we wont have to worry about it anymore.\n\nWhat are your opinion on this?",
    "created_at": "2020-06-03T11:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418419",
    "user": "@vipul79321"
}
```

One problem that we forget to address in #29734 was that :
- We didnt updated documentation of `shortest_paths` method in `boost_graph.pyx`, to this. 


```diff
+    - ``weight_function`` -- function (default: ``None``); a function that
+      associates a weight to each edge. If ``None`` (default), the weights of
+      ``g`` are used, if ``g.weighted()==True``, otherwise all edges have weight 1
```


- To make weight_function use uniform, I think, we should make following changes in, `shortest_path`, `shortest_path_length`, `shortest_paths` , `shortest_path_lengths`,  `shortest_path_all_pairs`


```diff
+ if by_weight and weight_function is None:
+     def weight_function(e):
+         return 1 if e[2] is None else e[2] 
```

and this should be at the begining of each method, so that we wont have to worry about it anymore.

What are your opinion on this?



---

archive/issue_comments_418420.json:
```json
{
    "body": "What I suggest is:\n- We finalize this ticket for radius / DHV and postpone to other tickets problems we raised but that are independent of this ticket.\n- For each identified issue, you add a note in the meta ticket #29657 with example and possibly ideas on how to fix it. It will help organizing the discussion and following the tasks. We are currently discussing the same issues in 2 tickets...\n\nAnd your proposal is certainly good.",
    "created_at": "2020-06-03T11:59:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418420",
    "user": "dcoudert"
}
```

What I suggest is:
- We finalize this ticket for radius / DHV and postpone to other tickets problems we raised but that are independent of this ticket.
- For each identified issue, you add a note in the meta ticket #29657 with example and possibly ideas on how to fix it. It will help organizing the discussion and following the tasks. We are currently discussing the same issues in 2 tickets...

And your proposal is certainly good.



---

archive/issue_comments_418421.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-03T17:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418421",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418422.json:
```json
{
    "body": "TODO:\n\n- Find a reliable way to detect negative cycle, which can be used in our method. For more info check comment_22 in #29744\n\n- Decide default algorithms.",
    "created_at": "2020-06-03T17:27:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418422",
    "user": "@vipul79321"
}
```

TODO:

- Find a reliable way to detect negative cycle, which can be used in our method. For more info check comment_22 in #29744

- Decide default algorithms.



---

archive/issue_comments_418423.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-06-04T17:53:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418423",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_418424.json:
```json
{
    "body": "Replying to [comment:42 git]:\n> Branch pushed to git repo; I updated commit sha1. New commits:\n> ||[2437136](https://git.sagemath.org/sage.git/commit/?id=2437136be053d0ef9e44de79c0ed2cec512dbd4e)||`Fixed for negative edge weights`||\n\nFixed for negative weights and Finalized.",
    "created_at": "2020-06-04T17:56:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418424",
    "user": "@vipul79321"
}
```

Replying to [comment:42 git]:
> Branch pushed to git repo; I updated commit sha1. New commits:
> ||[2437136](https://git.sagemath.org/sage.git/commit/?id=2437136be053d0ef9e44de79c0ed2cec512dbd4e)||`Fixed for negative edge weights`||

Fixed for negative weights and Finalized.



---

archive/issue_comments_418425.json:
```json
{
    "body": "LGTM.",
    "created_at": "2020-06-05T07:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418425",
    "user": "dcoudert"
}
```

LGTM.



---

archive/issue_comments_418426.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-06-05T07:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418426",
    "user": "dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_418427.json:
```json
{
    "body": "Changing keywords from \"gsoc\" to \"gsoc2020\".",
    "created_at": "2020-06-05T07:40:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418427",
    "user": "dcoudert"
}
```

Changing keywords from "gsoc" to "gsoc2020".



---

archive/issue_comments_418428.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-06-21T22:36:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29478",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29478#issuecomment-418428",
    "user": "vbraun"
}
```

Resolution: fixed
