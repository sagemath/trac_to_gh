# Issue 26564: py3: change sorting of neighbors labels in static_sparse_graph.pyx

archive/issues_026564.json:
```json
{
    "body": "CC:  @tscrim @fchapoton\n\nMany doctests are failing in Python 3 due to the operation `neighbor_label.sort()` in method `init_short_digraph` of `static_sparse_graph.pyx`.\n\nIn the `short_digraph` data structure, the neighbors of a vertex are sorted by increasing integer value. This can be useful for some algorithms... \n\n`neighbor_label` is a list of tuples `(int, object)` used only when edges are labeled and that we want to store these labels. Clearly, when the graph has no multiple edges, is suffices to sort `neighbor_label` according the integer values. When the graph has multiple edges, there is so far no need for sorting the labels of the edges between a given pair of vertices, and furthermore no assumption is documented on this ordering.\nAlso, this patch changes the sorting to sort using the integer values only.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/26801\n\n",
    "created_at": "2018-12-02T22:20:15Z",
    "labels": [
        "graph theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.5",
    "title": "py3: change sorting of neighbors labels in static_sparse_graph.pyx",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/26564",
    "user": "@dcoudert"
}
```
CC:  @tscrim @fchapoton

Many doctests are failing in Python 3 due to the operation `neighbor_label.sort()` in method `init_short_digraph` of `static_sparse_graph.pyx`.

In the `short_digraph` data structure, the neighbors of a vertex are sorted by increasing integer value. This can be useful for some algorithms... 

`neighbor_label` is a list of tuples `(int, object)` used only when edges are labeled and that we want to store these labels. Clearly, when the graph has no multiple edges, is suffices to sort `neighbor_label` according the integer values. When the graph has multiple edges, there is so far no need for sorting the labels of the edges between a given pair of vertices, and furthermore no assumption is documented on this ordering.
Also, this patch changes the sorting to sort using the integer values only.


Issue created by migration from https://trac.sagemath.org/ticket/26801





---

archive/issue_comments_373493.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-12-02T23:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26564#issuecomment-373493",
    "user": "@dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_373494.json:
```json
{
    "body": "Applying this patch over 8.5.beta6 compiled for Python3, we reduce the number of failing doctests in `connectivity.pyx` from 49 to 5. The files for which progresses are observed are:\n\n```\nsage -t --long --warn-long 119.6 src/sage/graphs/generic_graph.py  # 77 doctests failed\nsage -t --long --warn-long 119.6 src/sage/graphs/connectivity.pyx  # 5 doctests failed\nsage -t --long --warn-long 119.6 src/sage/graphs/digraph.py  # 8 doctests failed\nsage -t --long --warn-long 119.6 src/sage/graphs/base/graph_backends.pyx  # 1 doctest failed\n```\n\nWithout this patch, we get\n\n```\nsage -t --long src/sage/graphs/generic_graph.py  # 78 doctests failed\nsage -t --long src/sage/graphs/connectivity.pyx  # 49 doctests failed\nsage -t --long src/sage/graphs/digraph.py  # 15 doctests failed\nsage -t --long src/sage/graphs/base/graph_backends.pyx  # 5 doctests failed\n```\n\n----\nNew commits:",
    "created_at": "2018-12-02T23:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26564#issuecomment-373494",
    "user": "@dcoudert"
}
```

Applying this patch over 8.5.beta6 compiled for Python3, we reduce the number of failing doctests in `connectivity.pyx` from 49 to 5. The files for which progresses are observed are:

```
sage -t --long --warn-long 119.6 src/sage/graphs/generic_graph.py  # 77 doctests failed
sage -t --long --warn-long 119.6 src/sage/graphs/connectivity.pyx  # 5 doctests failed
sage -t --long --warn-long 119.6 src/sage/graphs/digraph.py  # 8 doctests failed
sage -t --long --warn-long 119.6 src/sage/graphs/base/graph_backends.pyx  # 1 doctest failed
```

Without this patch, we get

```
sage -t --long src/sage/graphs/generic_graph.py  # 78 doctests failed
sage -t --long src/sage/graphs/connectivity.pyx  # 49 doctests failed
sage -t --long src/sage/graphs/digraph.py  # 15 doctests failed
sage -t --long src/sage/graphs/base/graph_backends.pyx  # 5 doctests failed
```

----
New commits:



---

archive/issue_comments_373495.json:
```json
{
    "body": "Changing keywords from \"\" to \"py3, graph\".",
    "created_at": "2018-12-02T23:08:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26564#issuecomment-373495",
    "user": "@dcoudert"
}
```

Changing keywords from "" to "py3, graph".



---

archive/issue_comments_373496.json:
```json
{
    "body": "Green bot => positive review (unless Fr\u00e9d\u00e9ric has some other comments).",
    "created_at": "2018-12-02T23:31:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26564#issuecomment-373496",
    "user": "@tscrim"
}
```

Green bot => positive review (unless Frédéric has some other comments).



---

archive/issue_comments_373497.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-12-03T13:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26564#issuecomment-373497",
    "user": "@fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_373498.json:
```json
{
    "body": "ok, looks good to me too",
    "created_at": "2018-12-03T13:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26564#issuecomment-373498",
    "user": "@fchapoton"
}
```

ok, looks good to me too



---

archive/issue_comments_373499.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-12-07T12:10:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/26564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/26564#issuecomment-373499",
    "user": "@vbraun"
}
```

Resolution: fixed
