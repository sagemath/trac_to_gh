# Issue 28192: Add the classical construction of the 120-cell

archive/issues_028192.json:
```json
{
    "body": "CC:  winfried @jplab @mkoeppe @videlec\n\nKeywords: polytopes, non-rational, normaliz\n\nTicket #27760 introduced the 120-cell in the library, but it does not give the classical construction of Coxeter form 1969 available on Wikipedia:\n\nhttps://en.wikipedia.org/wiki/120-cell\n\nThis ticket provides this classical construction which is much faster since it uses only a degree 2 extension of the rationals.\n\nIssue created by migration from https://trac.sagemath.org/ticket/28429\n\n",
    "created_at": "2019-08-30T10:08:54Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.0",
    "title": "Add the classical construction of the 120-cell",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28192",
    "user": "@jplab"
}
```
CC:  winfried @jplab @mkoeppe @videlec

Keywords: polytopes, non-rational, normaliz

Ticket #27760 introduced the 120-cell in the library, but it does not give the classical construction of Coxeter form 1969 available on Wikipedia:

https://en.wikipedia.org/wiki/120-cell

This ticket provides this classical construction which is much faster since it uses only a degree 2 extension of the rationals.

Issue created by migration from https://trac.sagemath.org/ticket/28429





---

archive/issue_comments_398113.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-08-30T10:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398113",
    "user": "@jplab"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_398114.json:
```json
{
    "body": "Last 10 new commits:",
    "created_at": "2019-08-30T10:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398114",
    "user": "@jplab"
}
```

Last 10 new commits:



---

archive/issue_comments_398115.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-09-01T13:19:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398115",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398116.json:
```json
{
    "body": "I merged the missing commit from #27760 to get a clean bot test.",
    "created_at": "2019-09-01T13:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398116",
    "user": "@jplab"
}
```

I merged the missing commit from #27760 to get a clean bot test.



---

archive/issue_comments_398117.json:
```json
{
    "body": "I think this can be simplified:\n\n```diff\n-list(set([tuple(p) for p in flatten([Permutations(list(c)).list() for c in cp])]))\n+list(set([tuple(p) for c in cp for p in Permutations(list(c))]))\n```\n\nso there are less transient (large) lists. Also, you should be able to do\n\n```python\nverts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)\n```\n\nsince `+=` for lists works for iterators and you might as well pass a iterable to `from_iterable` to avoid storing the entire list in memory (twice). Next, I would use latex formatting here: `of type `H_4`::`. Finally, is it reasonable to do this test with the backend that comes standard with Sage? In that same vein, how long does the normaliz test take?",
    "created_at": "2019-09-03T00:24:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398117",
    "user": "@tscrim"
}
```

I think this can be simplified:

```diff
-list(set([tuple(p) for p in flatten([Permutations(list(c)).list() for c in cp])]))
+list(set([tuple(p) for c in cp for p in Permutations(list(c))]))
```

so there are less transient (large) lists. Also, you should be able to do

```python
verts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)
```

since `+=` for lists works for iterators and you might as well pass a iterable to `from_iterable` to avoid storing the entire list in memory (twice). Next, I would use latex formatting here: `of type `H_4`::`. Finally, is it reasonable to do this test with the backend that comes standard with Sage? In that same vein, how long does the normaliz test take?



---

archive/issue_comments_398118.json:
```json
{
    "body": "Hi Travis,\n\nThanks for the feedback, I'll do the changes.\n\nThe new implementation with normaliz takes less than 1 sec. Before, it was taking much longer that's why it was tagged not tested.\n\nNow, for the default `'field'` backend, I did not test, but I expect it to take a long while. But I'll test it and write it here for the record.",
    "created_at": "2019-09-03T18:01:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398118",
    "user": "@jplab"
}
```

Hi Travis,

Thanks for the feedback, I'll do the changes.

The new implementation with normaliz takes less than 1 sec. Before, it was taking much longer that's why it was tagged not tested.

Now, for the default `'field'` backend, I did not test, but I expect it to take a long while. But I'll test it and write it here for the record.



---

archive/issue_comments_398119.json:
```json
{
    "body": "A few comments:\n\n- Most importantly `exact=False` does not work. `base_ring` is not defined. Also you don't define `sqrt5`. On that not, it makes sense to define `phi` outside the `if ... else` environment.\n\n- \n\n```diff\n-            sage: polytopes.one_hundred_twenty_cell(backend='normaliz',construction='as_permutahedron') # not tested - long time\n+            sage: polytopes.one_hundred_twenty_cell(backend='normaliz', construction='as_permutahedron') # not tested - long time\n```\n\n\n- \n\n```\n# The 64 permutations of [\u00b12,\u00b12,0,0] (the \u00b1 are independant)\n```\n\n  I count 24.\n\n- I somehow don't like the construction with the Cartesian product. In the comments its all so easy and then I have to think about, why this is exactly true.\n\n  Couldn't we make a use of `product` from `itertools`? This creates all possible signs and then we just multiply (elementwise) all permutations:\n\n  {{{\nverts = [[sign[i]*perm[i] for i in range(4)] for sign in product(*[This is the Trac macro *1,-1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,-1-macro)*4) for perm in verts_without_sign]\n}}}\n\nFor the record:\n\n\n```\nsage: %time polytopes.one_hundred_twenty_cell(backend='normaliz')\nCPU times: user 1.04 s, sys: 8 ms, total: 1.05 s\nWall time: 255 ms\nA 4-dimensional polyhedron in (Number Field in sqrt5 with defining polynomial x^2 - 5 with sqrt5 = 2.236067977499790?)^4 defined as the convex hull of 600 vertices\nsage: %time polytopes.one_hundred_twenty_cell(backend='field')\nCPU times: user 18.1 s, sys: 28 ms, total: 18.2 s\nWall time: 18.2 s\nA 4-dimensional polyhedron in (Number Field in sqrt5 with defining polynomial x^2 - 5 with sqrt5 = 2.236067977499790?)^4 defined as the convex hull of 600 vertices\nsage: %time polytopes.one_hundred_twenty_cell(backend='normaliz',construction='as_permutahedron')\nCPU times: user 17.2 s, sys: 52 ms, total: 17.2 s\nWall time: 15.5 s\n```\n",
    "created_at": "2019-09-05T19:33:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398119",
    "user": "@kliem"
}
```

A few comments:

- Most importantly `exact=False` does not work. `base_ring` is not defined. Also you don't define `sqrt5`. On that not, it makes sense to define `phi` outside the `if ... else` environment.

- 

```diff
-            sage: polytopes.one_hundred_twenty_cell(backend='normaliz',construction='as_permutahedron') # not tested - long time
+            sage: polytopes.one_hundred_twenty_cell(backend='normaliz', construction='as_permutahedron') # not tested - long time
```


- 

```
# The 64 permutations of [±2,±2,0,0] (the ± are independant)
```

  I count 24.

- I somehow don't like the construction with the Cartesian product. In the comments its all so easy and then I have to think about, why this is exactly true.

  Couldn't we make a use of `product` from `itertools`? This creates all possible signs and then we just multiply (elementwise) all permutations:

  {{{
verts = [[sign[i]*perm[i] for i in range(4)] for sign in product(*[This is the Trac macro *1,-1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,-1-macro)*4) for perm in verts_without_sign]
}}}

For the record:


```
sage: %time polytopes.one_hundred_twenty_cell(backend='normaliz')
CPU times: user 1.04 s, sys: 8 ms, total: 1.05 s
Wall time: 255 ms
A 4-dimensional polyhedron in (Number Field in sqrt5 with defining polynomial x^2 - 5 with sqrt5 = 2.236067977499790?)^4 defined as the convex hull of 600 vertices
sage: %time polytopes.one_hundred_twenty_cell(backend='field')
CPU times: user 18.1 s, sys: 28 ms, total: 18.2 s
Wall time: 18.2 s
A 4-dimensional polyhedron in (Number Field in sqrt5 with defining polynomial x^2 - 5 with sqrt5 = 2.236067977499790?)^4 defined as the convex hull of 600 vertices
sage: %time polytopes.one_hundred_twenty_cell(backend='normaliz',construction='as_permutahedron')
CPU times: user 17.2 s, sys: 52 ms, total: 17.2 s
Wall time: 15.5 s
```




---

archive/issue_comments_398120.json:
```json
{
    "body": "Replying to [comment:6 gh-kliem]:\n> - I somehow don't like the construction with the Cartesian product. In the comments its all so easy and then I have to think about, why this is exactly true.\n> \n>   Couldn't we make a use of `product` from `itertools`? This creates all possible signs and then we just multiply (elementwise) all permutations:\n> \n>   {{{\n> verts = [[sign[i]*perm[i] for i in range(4)] for sign in product(*[This is the Trac macro *1,-1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,-1-macro)*4) for perm in verts_without_sign]\n> }}}\n\nI should have read the code better...\nDidn't know that cartesian product does exactly that. Just figured it's way to many lines for something that simple and then I stopped reading and tried to find a shorter solution.\n\nStill one could do all the signs with one line instead of doing it over and over again. Something like:\n\n\n```diff\n-            # The 64 permutations of [\u00b12,\u00b12,0,0] (the \u00b1 are independant)\n-            verts = Permutations([0,0,2,2]).list() + Permutations([0,0,-2,-2]).list() + Permutations([0,0,2,-2]).list()\n-\n-            # The 64 permutations of the following vectors:\n-            # [\u00b11,\u00b11,\u00b11,\u00b1sqrt(5)]\n-            # [\u00b11/phi^2,\u00b1phi,\u00b1phi,\u00b1phi]\n-            # [\u00b11/phi,\u00b11/phi,\u00b11/phi,\u00b1phi^2]\n-            from sage.categories.cartesian_product import cartesian_product\n-            from sage.misc.flatten import flatten\n-            full_perm_vectors = [[[1,-1],[1,-1],[1,-1],[-sqrt5,sqrt5]],\n-                                 [[phi_inv**2,-phi_inv**2],[phi,-phi],[phi,-phi],[-phi,phi]],\n-                                 [[phi_inv,-phi_inv],[phi_inv,-phi_inv],[phi_inv,-phi_inv],[-(phi**2),phi**2]]]\n-            for vect in full_perm_vectors:\n-                cp = cartesian_product(vect)\n-                # The cartesian product creates duplicates, so we reduce it:\n-                verts += list(set([tuple(p) for p in flatten([Permutations(list(c)).list() for c in cp])]))\n-\n-            # The 96 even permutations of [0,\u00b11/phi^2,\u00b11,\u00b1phi^2]\n-            # The 96 even permutations of [0,\u00b11/phi,\u00b1phi,\u00b1sqrt(5)]\n-            # The 192 even permutations of [\u00b11/phi,\u00b11,\u00b1phi,\u00b12]\n-            import itertools\n-            even_perm_vectors = [[[0],[phi_inv**2,-phi_inv**2],[1,-1],[-(phi**2),phi**2]],\n-                                 [[0],[phi_inv,-phi_inv],[phi,-phi],[-sqrt5,sqrt5]],\n-                                 [[phi_inv,-phi_inv],[1,-1],[phi,-phi],[-2,2]]]\n-            even_perm = AlternatingGroup(4)\n-            for vect in even_perm_vectors:\n-                cp = cartesian_product(vect)\n-                # The cartesian product creates duplicates, so we reduce it:\n-                verts += list(itertools.chain.from_iterable([[p(tuple(c)) for p in even_perm] for c in cp]))\n+            # The permutations of:\n+            # [2,2,0,0]\n+            # [1,1,1,sqrt(5)]\n+            # [1/phi^2,phi,phi,phi]\n+            # [1/phi,1/phi,1/phi,phi^2]\n+            vectors = [[2,2,0,0], [1,1,1,sqrt5], [1/phi**2,phi,phi,phi], [1/phi, 1/phi, 1/phi, phi**2]]\n+            verts_no_sign = list(x for vec in vectors for x in Permutations(vec).list())\n+\n+            # The even permutations of [0,1/phi^2,1,phi^2]\n+            # The even permutations of [0,1/phi,phi,sqrt(5)]\n+            # The even permutations of [1/phi,1,phi,2]\n+            import itertools\n+            vectors = [[0,1/phi**2,1,phi**2], [0,1/phi,phi,sqrt5], [1/phi,1,phi,2]]\n+            even_perm = AlternatingGroup(4)\n+            verts_no_sign += list(itertools.chain.from_iterable([[p(tuple(vec)) for p in even_perm] for vec in vectors]))\n+\n+            # Adding for each vertex copies in all orthants:\n+            # [1,1,1,sqrt(5)] -> [\u00b11,\u00b11,\u00b11,\u00b1sqrt(5)]\n+            from itertools import product\n+            verts = [[sign[i]*perm[i] for i in range(4)] for sign in product(*[[1,-1]]*4) for perm in verts_no_sign]\n```\n\n\nBut I guess it's up to taste, what one prefers.",
    "created_at": "2019-09-06T06:57:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398120",
    "user": "@kliem"
}
```

Replying to [comment:6 gh-kliem]:
> - I somehow don't like the construction with the Cartesian product. In the comments its all so easy and then I have to think about, why this is exactly true.
> 
>   Couldn't we make a use of `product` from `itertools`? This creates all possible signs and then we just multiply (elementwise) all permutations:
> 
>   {{{
> verts = [[sign[i]*perm[i] for i in range(4)] for sign in product(*[This is the Trac macro *1,-1* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#1,-1-macro)*4) for perm in verts_without_sign]
> }}}

I should have read the code better...
Didn't know that cartesian product does exactly that. Just figured it's way to many lines for something that simple and then I stopped reading and tried to find a shorter solution.

Still one could do all the signs with one line instead of doing it over and over again. Something like:


```diff
-            # The 64 permutations of [±2,±2,0,0] (the ± are independant)
-            verts = Permutations([0,0,2,2]).list() + Permutations([0,0,-2,-2]).list() + Permutations([0,0,2,-2]).list()
-
-            # The 64 permutations of the following vectors:
-            # [±1,±1,±1,±sqrt(5)]
-            # [±1/phi^2,±phi,±phi,±phi]
-            # [±1/phi,±1/phi,±1/phi,±phi^2]
-            from sage.categories.cartesian_product import cartesian_product
-            from sage.misc.flatten import flatten
-            full_perm_vectors = [[[1,-1],[1,-1],[1,-1],[-sqrt5,sqrt5]],
-                                 [[phi_inv**2,-phi_inv**2],[phi,-phi],[phi,-phi],[-phi,phi]],
-                                 [[phi_inv,-phi_inv],[phi_inv,-phi_inv],[phi_inv,-phi_inv],[-(phi**2),phi**2]]]
-            for vect in full_perm_vectors:
-                cp = cartesian_product(vect)
-                # The cartesian product creates duplicates, so we reduce it:
-                verts += list(set([tuple(p) for p in flatten([Permutations(list(c)).list() for c in cp])]))
-
-            # The 96 even permutations of [0,±1/phi^2,±1,±phi^2]
-            # The 96 even permutations of [0,±1/phi,±phi,±sqrt(5)]
-            # The 192 even permutations of [±1/phi,±1,±phi,±2]
-            import itertools
-            even_perm_vectors = [[[0],[phi_inv**2,-phi_inv**2],[1,-1],[-(phi**2),phi**2]],
-                                 [[0],[phi_inv,-phi_inv],[phi,-phi],[-sqrt5,sqrt5]],
-                                 [[phi_inv,-phi_inv],[1,-1],[phi,-phi],[-2,2]]]
-            even_perm = AlternatingGroup(4)
-            for vect in even_perm_vectors:
-                cp = cartesian_product(vect)
-                # The cartesian product creates duplicates, so we reduce it:
-                verts += list(itertools.chain.from_iterable([[p(tuple(c)) for p in even_perm] for c in cp]))
+            # The permutations of:
+            # [2,2,0,0]
+            # [1,1,1,sqrt(5)]
+            # [1/phi^2,phi,phi,phi]
+            # [1/phi,1/phi,1/phi,phi^2]
+            vectors = [[2,2,0,0], [1,1,1,sqrt5], [1/phi**2,phi,phi,phi], [1/phi, 1/phi, 1/phi, phi**2]]
+            verts_no_sign = list(x for vec in vectors for x in Permutations(vec).list())
+
+            # The even permutations of [0,1/phi^2,1,phi^2]
+            # The even permutations of [0,1/phi,phi,sqrt(5)]
+            # The even permutations of [1/phi,1,phi,2]
+            import itertools
+            vectors = [[0,1/phi**2,1,phi**2], [0,1/phi,phi,sqrt5], [1/phi,1,phi,2]]
+            even_perm = AlternatingGroup(4)
+            verts_no_sign += list(itertools.chain.from_iterable([[p(tuple(vec)) for p in even_perm] for vec in vectors]))
+
+            # Adding for each vertex copies in all orthants:
+            # [1,1,1,sqrt(5)] -> [±1,±1,±1,±sqrt(5)]
+            from itertools import product
+            verts = [[sign[i]*perm[i] for i in range(4)] for sign in product(*[[1,-1]]*4) for perm in verts_no_sign]
```


But I guess it's up to taste, what one prefers.



---

archive/issue_comments_398121.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-09-14T18:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398121",
    "user": "@kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_398122.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-24T11:37:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398122",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398123.json:
```json
{
    "body": "I did the changes. I decided to keep the construction as is.\n\nI added a raise ValueError if one tries to construct it with `RDF` as cdd returns a numerical inconsistency error.",
    "created_at": "2019-10-24T11:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398123",
    "user": "@jplab"
}
```

I did the changes. I decided to keep the construction as is.

I added a raise ValueError if one tries to construct it with `RDF` as cdd returns a numerical inconsistency error.



---

archive/issue_comments_398124.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-24T11:38:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398124",
    "user": "@jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_398125.json:
```json
{
    "body": "Some minor things:\n\n- The order should be consistent here:\n\n```\n+            # The 64 permutations of [\u00b12,\u00b12,0,0] (the \u00b1 are independant)\n+            verts = Permutations([0,0,2,2]).list() + Permutations([0,0,-2,-2]).list() + \nPermutations([0,0,2,-2]).list()\n```\n\n  also I still count 24 permutations as I already mentioned.\n- I'm a bit puzzled, where you remove the duplicates here:\n\n```\n+                # The cartesian product creates duplicates, so we reduce it:\n+                verts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)\n```\n\n- Instead of importing `itertools` I would vote for importing just `itertools.chain`.\n  Otherwise you might also consider to use `itertools.product` instead of `sage.categories.cartesian_product`.\n- Whats the point of naming it `K` here?\n\n```\nK = QuadraticField(5, 'sqrt5')\nbase_ring = K\n```\n",
    "created_at": "2019-10-28T09:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398125",
    "user": "@kliem"
}
```

Some minor things:

- The order should be consistent here:

```
+            # The 64 permutations of [±2,±2,0,0] (the ± are independant)
+            verts = Permutations([0,0,2,2]).list() + Permutations([0,0,-2,-2]).list() + 
Permutations([0,0,2,-2]).list()
```

  also I still count 24 permutations as I already mentioned.
- I'm a bit puzzled, where you remove the duplicates here:

```
+                # The cartesian product creates duplicates, so we reduce it:
+                verts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)
```

- Instead of importing `itertools` I would vote for importing just `itertools.chain`.
  Otherwise you might also consider to use `itertools.product` instead of `sage.categories.cartesian_product`.
- Whats the point of naming it `K` here?

```
K = QuadraticField(5, 'sqrt5')
base_ring = K
```




---

archive/issue_comments_398126.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-10-28T09:25:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398126",
    "user": "@kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_398127.json:
```json
{
    "body": "Replying to [comment:11 gh-kliem]:\n> - The order should be consistent here:\n> {{{\n> +            # The 64 permutations of [\u00b12,\u00b12,0,0] (the \u00b1 are independant)\n> +            verts = Permutations([0,0,2,2]).list() + Permutations([0,0,-2,-2]).list() + \n> Permutations([0,0,2,-2]).list()\n> }}}\n>   also I still count 24 permutations as I already mentioned.\nTypo. Fixed.\n\n> - I'm a bit puzzled, where you remove the duplicates here:\n> {{{\n> +                # The cartesian product creates duplicates, so we reduce it:\n> +                verts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)\n> }}}\n\nWell, this does what I want, what else can I say? It is very annoying to write something that creates them without duplicates, and we are dealing with a negligible amount of vertices, so I see now reason to make a fuss about inefficiency here.\n\n> - Instead of importing `itertools` I would vote for importing just `itertools.chain`.\n\nDone.\n\n> - Whats the point of naming it `K` here?\n> {{{\n> K = QuadraticField(5, 'sqrt5')\n> base_ring = K\n> }}}\n\nThat's a wonderful rhetorical question. My rhetorical answer: to make you ask rhetorical questions. ;-)\n----\nNew commits:",
    "created_at": "2019-10-29T09:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398127",
    "user": "@jplab"
}
```

Replying to [comment:11 gh-kliem]:
> - The order should be consistent here:
> {{{
> +            # The 64 permutations of [±2,±2,0,0] (the ± are independant)
> +            verts = Permutations([0,0,2,2]).list() + Permutations([0,0,-2,-2]).list() + 
> Permutations([0,0,2,-2]).list()
> }}}
>   also I still count 24 permutations as I already mentioned.
Typo. Fixed.

> - I'm a bit puzzled, where you remove the duplicates here:
> {{{
> +                # The cartesian product creates duplicates, so we reduce it:
> +                verts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)
> }}}

Well, this does what I want, what else can I say? It is very annoying to write something that creates them without duplicates, and we are dealing with a negligible amount of vertices, so I see now reason to make a fuss about inefficiency here.

> - Instead of importing `itertools` I would vote for importing just `itertools.chain`.

Done.

> - Whats the point of naming it `K` here?
> {{{
> K = QuadraticField(5, 'sqrt5')
> base_ring = K
> }}}

That's a wonderful rhetorical question. My rhetorical answer: to make you ask rhetorical questions. ;-)
----
New commits:



---

archive/issue_comments_398128.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-29T09:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398128",
    "user": "@jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_398129.json:
```json
{
    "body": "Replying to [comment:13 jipilab]:\n> Replying to [comment:11 gh-kliem]:\n> \n> > - I'm a bit puzzled, where you remove the duplicates here:\n> > {{{\n> > +                # The cartesian product creates duplicates, so we reduce it:\n> > +                verts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)\n> > }}}\n> \n> Well, this does what I want, what else can I say? It is very annoying to write something that creates them without duplicates, and we are dealing with a negligible amount of vertices, so I see now reason to make a fuss about inefficiency here.\n\nWell, as every entry is unique, the cartesian product creates no duplicates. Hence, you don't have to remove them.\n\nThis is why I find this comment very confusing. You comment that you will remove duplicates, but neither are there duplicate nor do you do any instructions that would remove duplicates, if they where there.\n\nAlso you have a typo in your chain import, so this doesn't build.",
    "created_at": "2019-10-29T10:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398129",
    "user": "@kliem"
}
```

Replying to [comment:13 jipilab]:
> Replying to [comment:11 gh-kliem]:
> 
> > - I'm a bit puzzled, where you remove the duplicates here:
> > {{{
> > +                # The cartesian product creates duplicates, so we reduce it:
> > +                verts += itertools.chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)
> > }}}
> 
> Well, this does what I want, what else can I say? It is very annoying to write something that creates them without duplicates, and we are dealing with a negligible amount of vertices, so I see now reason to make a fuss about inefficiency here.

Well, as every entry is unique, the cartesian product creates no duplicates. Hence, you don't have to remove them.

This is why I find this comment very confusing. You comment that you will remove duplicates, but neither are there duplicate nor do you do any instructions that would remove duplicates, if they where there.

Also you have a typo in your chain import, so this doesn't build.



---

archive/issue_comments_398130.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-10-29T10:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398130",
    "user": "@kliem"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_398131.json:
```json
{
    "body": "Oops, yes, I changed the `import` to `from`.\n\nPerhaps my comment is not clear enough, it is not the cartesian product but the action of the even permutations:\n\n\n```diff\n+            import itertools import chain\n+            even_perm_vectors = [[[0],[phi_inv**2,-phi_inv**2],[1,-1],[-(phi**2),phi**2]],\n+                                 [[0],[phi_inv,-phi_inv],[phi,-phi],[-sqrt5,sqrt5]],\n+                                 [[phi_inv,-phi_inv],[1,-1],[phi,-phi],[-2,2]]]\n+            even_perm = AlternatingGroup(4)\n+            for vect in even_perm_vectors:\n+                cp = cartesian_product(vect)\n+                # The cartesian product creates duplicates, so we reduce it:\n+                verts += chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)\n                                               ^-------p acts here and creates duplicates\n```\n",
    "created_at": "2019-10-29T11:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398131",
    "user": "@jplab"
}
```

Oops, yes, I changed the `import` to `from`.

Perhaps my comment is not clear enough, it is not the cartesian product but the action of the even permutations:


```diff
+            import itertools import chain
+            even_perm_vectors = [[[0],[phi_inv**2,-phi_inv**2],[1,-1],[-(phi**2),phi**2]],
+                                 [[0],[phi_inv,-phi_inv],[phi,-phi],[-sqrt5,sqrt5]],
+                                 [[phi_inv,-phi_inv],[1,-1],[phi,-phi],[-2,2]]]
+            even_perm = AlternatingGroup(4)
+            for vect in even_perm_vectors:
+                cp = cartesian_product(vect)
+                # The cartesian product creates duplicates, so we reduce it:
+                verts += chain.from_iterable([p(tuple(c)) for p in even_perm] for c in cp)
                                               ^-------p acts here and creates duplicates
```




---

archive/issue_comments_398132.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-29T11:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398132",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398133.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-10-29T11:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398133",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_398134.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-10-29T11:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398134",
    "user": "@jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_398135.json:
```json
{
    "body": "Should be good to go now.",
    "created_at": "2019-10-29T11:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398135",
    "user": "@jplab"
}
```

Should be good to go now.



---

archive/issue_comments_398136.json:
```json
{
    "body": "LGTM",
    "created_at": "2019-10-30T13:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398136",
    "user": "@kliem"
}
```

LGTM



---

archive/issue_comments_398137.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-10-30T13:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398137",
    "user": "@kliem"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_398138.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-10-31T22:40:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28192",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28192#issuecomment-398138",
    "user": "@vbraun"
}
```

Resolution: fixed
