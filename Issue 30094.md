# Issue 30094: Issue with toric_substitute for Laurent polynomials

Issue created by migration from https://trac.sagemath.org/ticket/30331

Original creator: kedlaya

Original creation time: 2020-08-10 20:55:51

CC:  tscrim

Keywords: Laurent polynomials

A bit of unfinished business from #29512:


```
sage: P.<x> = LaurentPolynomialRing(QQ, 1)
sage: u = x - 1
sage: v = u.toric_substitute((-1,), (-1,), 1)
sage: v
0
sage: v.is_zero()
False
```


The issue can be seen here:

```
sage: v.dict() # Should be empty, but isn't
{(0,): 0}
```




---

Comment by kedlaya created at 2020-08-10 20:59:07

Changing status from new to needs_review.


---

Comment by kedlaya created at 2020-08-10 20:59:07

The fix for this is simple enough: just strip zeroes in the internal dictionary `dr` before passing it to the constructor for `MPolynomial`.
----
New commits:


---

Comment by kedlaya created at 2020-08-10 21:22:45

There is also an issue with `rescale_vars` that I'd like to fix on this ticket also. New patch pending.


---

Comment by git created at 2020-08-10 21:32:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2020-08-10 22:52:20

I agree with the fix. When the patchbot comes back green, you can set a positive review.


---

Comment by kedlaya created at 2020-08-11 01:24:56

Changing status from needs_review to positive_review.


---

Comment by kedlaya created at 2020-08-11 01:24:56

Patchbot has come up green, so off we go.


---

Comment by git created at 2020-08-11 03:01:16

Changing status from positive_review to needs_review.


---

Comment by git created at 2020-08-11 03:01:16

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by kedlaya created at 2020-08-11 03:02:33

Oops, I forgot that there is a similar ring conversion issue in `toric_substitute` itself. Let's give patchbot a go at that one too before proceeding.


---

Comment by tscrim created at 2020-08-11 04:06:41

Green bot => positive review again.


---

Comment by tscrim created at 2020-08-11 05:30:32

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-08-14 22:23:22

Resolution: fixed
