# Issue 30094: Issue with toric_substitute for Laurent polynomials

archive/issues_030094.json:
```json
{
    "body": "CC:  tscrim\n\nKeywords: Laurent polynomials\n\nA bit of unfinished business from #29512:\n\n\n```\nsage: P.<x> = LaurentPolynomialRing(QQ, 1)\nsage: u = x - 1\nsage: v = u.toric_substitute((-1,), (-1,), 1)\nsage: v\n0\nsage: v.is_zero()\nFalse\n```\n\n\nThe issue can be seen here:\n\n```\nsage: v.dict() # Should be empty, but isn't\n{(0,): 0}\n```\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/30331\n\n",
    "created_at": "2020-08-10T20:55:51Z",
    "labels": [
        "commutative algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Issue with toric_substitute for Laurent polynomials",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30094",
    "user": "kedlaya"
}
```
CC:  tscrim

Keywords: Laurent polynomials

A bit of unfinished business from #29512:


```
sage: P.<x> = LaurentPolynomialRing(QQ, 1)
sage: u = x - 1
sage: v = u.toric_substitute((-1,), (-1,), 1)
sage: v
0
sage: v.is_zero()
False
```


The issue can be seen here:

```
sage: v.dict() # Should be empty, but isn't
{(0,): 0}
```



Issue created by migration from https://trac.sagemath.org/ticket/30331





---

archive/issue_comments_427876.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-10T20:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427876",
    "user": "kedlaya"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_427877.json:
```json
{
    "body": "The fix for this is simple enough: just strip zeroes in the internal dictionary `dr` before passing it to the constructor for `MPolynomial`.\n----\nNew commits:",
    "created_at": "2020-08-10T20:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427877",
    "user": "kedlaya"
}
```

The fix for this is simple enough: just strip zeroes in the internal dictionary `dr` before passing it to the constructor for `MPolynomial`.
----
New commits:



---

archive/issue_comments_427878.json:
```json
{
    "body": "There is also an issue with `rescale_vars` that I'd like to fix on this ticket also. New patch pending.",
    "created_at": "2020-08-10T21:22:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427878",
    "user": "kedlaya"
}
```

There is also an issue with `rescale_vars` that I'd like to fix on this ticket also. New patch pending.



---

archive/issue_comments_427879.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-10T21:32:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427879",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_427880.json:
```json
{
    "body": "I agree with the fix. When the patchbot comes back green, you can set a positive review.",
    "created_at": "2020-08-10T22:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427880",
    "user": "tscrim"
}
```

I agree with the fix. When the patchbot comes back green, you can set a positive review.



---

archive/issue_comments_427881.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-11T01:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427881",
    "user": "kedlaya"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_427882.json:
```json
{
    "body": "Patchbot has come up green, so off we go.",
    "created_at": "2020-08-11T01:24:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427882",
    "user": "kedlaya"
}
```

Patchbot has come up green, so off we go.



---

archive/issue_comments_427883.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-08-11T03:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427883",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_427884.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-08-11T03:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427884",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_427885.json:
```json
{
    "body": "Oops, I forgot that there is a similar ring conversion issue in `toric_substitute` itself. Let's give patchbot a go at that one too before proceeding.",
    "created_at": "2020-08-11T03:02:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427885",
    "user": "kedlaya"
}
```

Oops, I forgot that there is a similar ring conversion issue in `toric_substitute` itself. Let's give patchbot a go at that one too before proceeding.



---

archive/issue_comments_427886.json:
```json
{
    "body": "Green bot => positive review again.",
    "created_at": "2020-08-11T04:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427886",
    "user": "tscrim"
}
```

Green bot => positive review again.



---

archive/issue_comments_427887.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-11T05:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427887",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_427888.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-14T22:23:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30094",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30094#issuecomment-427888",
    "user": "vbraun"
}
```

Resolution: fixed
