# Issue 16465: Raise exceptions when database_gap is not installed

archive/issues_016465.json:
```json
{
    "body": "CC:  dimpase\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16702\n\n",
    "created_at": "2014-07-22T15:11:47Z",
    "labels": [
        "group theory",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "Raise exceptions when database_gap is not installed",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16465",
    "user": "ncohen"
}
```
CC:  dimpase



Issue created by migration from https://trac.sagemath.org/ticket/16702





---

archive/issue_comments_216457.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216457",
    "user": "ncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_216458.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-07-22T15:16:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216458",
    "user": "ncohen"
}
```

New commits:



---

archive/issue_comments_216459.json:
```json
{
    "body": "This should be implemented using `try`, I think.",
    "created_at": "2014-07-22T15:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216459",
    "user": "dimpase"
}
```

This should be implemented using `try`, I think.



---

archive/issue_comments_216460.json:
```json
{
    "body": "I copy/pasted the test which is already used for gap_packages. Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.\n\nNathann",
    "created_at": "2014-07-22T15:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216460",
    "user": "ncohen"
}
```

I copy/pasted the test which is already used for gap_packages. Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.

Nathann



---

archive/issue_comments_216461.json:
```json
{
    "body": "Replying to [comment:3 ncohen]:\n> I copy/pasted the test which is already used for gap_packages. \nhave you ever noticed that Sage is full of crappy code, in some places at least ? \n;-)\n\n> Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.\n\nI am not saying that inside the exception processing block you should not test for installation of this package.\nBut without `try` your patch is too intrusive.\nThere are ways to extend GAP and/or Sage in place not involving installing Sage packages...",
    "created_at": "2014-07-22T15:52:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216461",
    "user": "dimpase"
}
```

Replying to [comment:3 ncohen]:
> I copy/pasted the test which is already used for gap_packages. 
have you ever noticed that Sage is full of crappy code, in some places at least ? 
;-)

> Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.

I am not saying that inside the exception processing block you should not test for installation of this package.
But without `try` your patch is too intrusive.
There are ways to extend GAP and/or Sage in place not involving installing Sage packages...



---

archive/issue_comments_216462.json:
```json
{
    "body": "> I am not saying that inside the exception processing block you should not test for installation of this package.\n> But without `try` your patch is too intrusive.\n\nI don't see why, and I don't see what you would write instead.\n\n> There are ways to extend GAP and/or Sage in place not involving installing Sage packages...\n\nI don't understand that.\n\nNathann",
    "created_at": "2014-07-22T15:56:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216462",
    "user": "ncohen"
}
```

> I am not saying that inside the exception processing block you should not test for installation of this package.
> But without `try` your patch is too intrusive.

I don't see why, and I don't see what you would write instead.

> There are ways to extend GAP and/or Sage in place not involving installing Sage packages...

I don't understand that.

Nathann



---

archive/issue_comments_216463.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> > I am not saying that inside the exception processing block you should not test for installation of this package.\n> > But without `try` your patch is too intrusive.\n> \n> I don't see why, and I don't see what you would write instead.\n\ne.g.\n\n```\ndef group_id(self):\n        try:\n            return [Integer(n) for n in self._gap_().IdGroup()]\n        except: \n            if not is_package_installed('database_gap'):\n                 raise RuntimeError(\"You must install the optional database_gap package first.\")\n            print \"oops...\"\n            raise\n```\n\n> \n> > There are ways to extend GAP and/or Sage in place not involving installing Sage packages...\n> \n> I don't understand that.\n\noften it's just copying some files into `$SAGE_LOCAL/gap` that does the trick.\nThat is, installing GAP packages (see http://gap-system.org/Packages/packages.html) often basically amounts to this.",
    "created_at": "2014-07-22T16:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216463",
    "user": "dimpase"
}
```

Replying to [comment:5 ncohen]:
> > I am not saying that inside the exception processing block you should not test for installation of this package.
> > But without `try` your patch is too intrusive.
> 
> I don't see why, and I don't see what you would write instead.

e.g.

```
def group_id(self):
        try:
            return [Integer(n) for n in self._gap_().IdGroup()]
        except: 
            if not is_package_installed('database_gap'):
                 raise RuntimeError("You must install the optional database_gap package first.")
            print "oops..."
            raise
```

> 
> > There are ways to extend GAP and/or Sage in place not involving installing Sage packages...
> 
> I don't understand that.

often it's just copying some files into `$SAGE_LOCAL/gap` that does the trick.
That is, installing GAP packages (see http://gap-system.org/Packages/packages.html) often basically amounts to this.



---

archive/issue_comments_216464.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2014-07-22T16:18:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216464",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_216465.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-07-22T16:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216465",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_216466.json:
```json
{
    "body": "LGTM",
    "created_at": "2014-07-22T16:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216466",
    "user": "dimpase"
}
```

LGTM



---

archive/issue_comments_216467.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-07-23T14:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16465",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16465#issuecomment-216467",
    "user": "vbraun"
}
```

Resolution: fixed
