# Issue 16465: Raise exceptions when database_gap is not installed

Issue created by migration from https://trac.sagemath.org/ticket/16702

Original creator: ncohen

Original creation time: 2014-07-22 15:11:47

CC:  dimpase




---

Comment by ncohen created at 2014-07-22 15:16:32

Changing status from new to needs_review.


---

Comment by ncohen created at 2014-07-22 15:16:32

New commits:


---

Comment by dimpase created at 2014-07-22 15:26:08

This should be implemented using `try`, I think.


---

Comment by ncohen created at 2014-07-22 15:30:08

I copy/pasted the test which is already used for gap_packages. Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.

Nathann


---

Comment by dimpase created at 2014-07-22 15:52:16

Replying to [comment:3 ncohen]:
> I copy/pasted the test which is already used for gap_packages. 
have you ever noticed that Sage is full of crappy code, in some places at least ? 
;-)

> Plus you don't have any way to differentiate exceptions originating from a gap code I guess. If you try/catch you could catch too much and say that the package is not installed when something else is going wrong.

I am not saying that inside the exception processing block you should not test for installation of this package.
But without `try` your patch is too intrusive.
There are ways to extend GAP and/or Sage in place not involving installing Sage packages...


---

Comment by ncohen created at 2014-07-22 15:56:34

> I am not saying that inside the exception processing block you should not test for installation of this package.
> But without `try` your patch is too intrusive.

I don't see why, and I don't see what you would write instead.

> There are ways to extend GAP and/or Sage in place not involving installing Sage packages...

I don't understand that.

Nathann


---

Comment by dimpase created at 2014-07-22 16:09:22

Replying to [comment:5 ncohen]:
> > I am not saying that inside the exception processing block you should not test for installation of this package.
> > But without `try` your patch is too intrusive.
> 
> I don't see why, and I don't see what you would write instead.

e.g.

```
def group_id(self):
        try:
            return [Integer(n) for n in self._gap_().IdGroup()]
        except: 
            if not is_package_installed('database_gap'):
                 raise RuntimeError("You must install the optional database_gap package first.")
            print "oops..."
            raise
```

> 
> > There are ways to extend GAP and/or Sage in place not involving installing Sage packages...
> 
> I don't understand that.

often it's just copying some files into `$SAGE_LOCAL/gap` that does the trick.
That is, installing GAP packages (see http://gap-system.org/Packages/packages.html) often basically amounts to this.


---

Comment by git created at 2014-07-22 16:18:19

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2014-07-22 16:41:04

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2014-07-22 16:41:04

LGTM


---

Comment by vbraun created at 2014-07-23 14:03:18

Resolution: fixed
