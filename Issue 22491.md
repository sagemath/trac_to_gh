# Issue 22491: Patch Cython to find includes better

Issue created by migration from https://trac.sagemath.org/ticket/22728

Original creator: jdemeyer

Original creation time: 2017-03-31 10:24:03




---

Comment by jdemeyer created at 2017-03-31 18:29:17

New commits:


---

Comment by jdemeyer created at 2017-03-31 18:29:17

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2017-04-11 09:17:17

Do you know why nothing is happening on Cyhon side?


---

Comment by jdemeyer created at 2017-04-11 09:21:30

Replying to [comment:4 vdelecroix]:
> Do you know why nothing is happening on Cyhon side?

No.


---

Comment by vdelecroix created at 2017-04-11 09:26:14

Replying to [comment:5 jdemeyer]:
> Replying to [comment:4 vdelecroix]:
> > Do you know why nothing is happening on Cyhon side?
> 
> No.

Do you think it is worth mentioning that it is a blocker for several projects on their mailing list?


---

Comment by jdemeyer created at 2017-04-11 12:01:19

Replying to [comment:6 vdelecroix]:
> Do you think it is worth mentioning that it is a blocker for several projects on their mailing list?

Done: https://mail.python.org/pipermail/cython-devel/2017-April/004995.html


---

Comment by jdemeyer created at 2017-04-14 07:20:14

On the Cython mailing list, upstream answered

> I'm in favor of the idea (basically attempting to resolve header files
> relative to the cython file including them and transitively passing
> these paths to modules cimporting them); haven't had time to look at
> the code yet or think if there could be negative implications.

So we could consider just patching Cython in Sage in order to move forward with #20238.


---

Comment by vdelecroix created at 2017-04-14 16:11:55

Replying to [comment:8 jdemeyer]:
> On the Cython mailing list, upstream answered
> 
> > I'm in favor of the idea (basically attempting to resolve header files
> > relative to the cython file including them and transitively passing
> > these paths to modules cimporting them); haven't had time to look at
> > the code yet or think if there could be negative implications.
> 
> So we could consider just patching Cython in Sage in order to move forward with #20238.

If you need the Sage patched version of Cython to install cypari it is not really independent of Sage...


---

Comment by jdemeyer created at 2017-04-14 16:53:14

Replying to [comment:9 vdelecroix]:
> If you need the Sage patched version of Cython to install cypari it is not really independent of Sage...

True, but that's still better than just keeping #20238 blocked.


---

Comment by embray created at 2017-04-17 20:21:59

IIUC Cypari will still install/work without this patch _in principle_--this is just needed for some specific use cases in integration with Sage.  If it were really needed for cypari to work independently of Sage at the worst cypari could monkey-patch Cython.  But considering that this patch is, as far as I can tell, pretty non-controversial and obvious, and is likely to be accepted upstream, I see no problem adding it in Sage as well at least for the sake of progressing on #20238.


---

Comment by embray created at 2017-04-17 20:21:59

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2017-04-18 08:19:46

Replying to [comment:11 embray]:
> IIUC Cypari will still install/work without this patch _in principle_--this is just needed for some specific use cases in integration with Sage.

To be specific: that patch is needed whenever some package (Sage in this case) wants to use the _Cython_ interface of `CyPari2`. So you are right that CyPari2 by itself does not need that patch.


---

Comment by vbraun created at 2017-04-23 12:57:46

Resolution: fixed
