# Issue 22491: Patch Cython to find includes better

archive/issues_022491.json:
```json
{
    "body": "\n\nIssue created by migration from https://trac.sagemath.org/ticket/22728\n\n",
    "created_at": "2017-03-31T10:24:03Z",
    "labels": [
        "packages: standard",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Patch Cython to find includes better",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22491",
    "user": "jdemeyer"
}
```


Issue created by migration from https://trac.sagemath.org/ticket/22728





---

archive/issue_comments_313344.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-03-31T18:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313344",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_313345.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-31T18:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313345",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_313346.json:
```json
{
    "body": "Do you know why nothing is happening on Cyhon side?",
    "created_at": "2017-04-11T09:17:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313346",
    "user": "vdelecroix"
}
```

Do you know why nothing is happening on Cyhon side?



---

archive/issue_comments_313347.json:
```json
{
    "body": "Replying to [comment:4 vdelecroix]:\n> Do you know why nothing is happening on Cyhon side?\n\nNo.",
    "created_at": "2017-04-11T09:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313347",
    "user": "jdemeyer"
}
```

Replying to [comment:4 vdelecroix]:
> Do you know why nothing is happening on Cyhon side?

No.



---

archive/issue_comments_313348.json:
```json
{
    "body": "Replying to [comment:5 jdemeyer]:\n> Replying to [comment:4 vdelecroix]:\n> > Do you know why nothing is happening on Cyhon side?\n> \n> No.\n\nDo you think it is worth mentioning that it is a blocker for several projects on their mailing list?",
    "created_at": "2017-04-11T09:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313348",
    "user": "vdelecroix"
}
```

Replying to [comment:5 jdemeyer]:
> Replying to [comment:4 vdelecroix]:
> > Do you know why nothing is happening on Cyhon side?
> 
> No.

Do you think it is worth mentioning that it is a blocker for several projects on their mailing list?



---

archive/issue_comments_313349.json:
```json
{
    "body": "Replying to [comment:6 vdelecroix]:\n> Do you think it is worth mentioning that it is a blocker for several projects on their mailing list?\n\nDone: https://mail.python.org/pipermail/cython-devel/2017-April/004995.html",
    "created_at": "2017-04-11T12:01:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313349",
    "user": "jdemeyer"
}
```

Replying to [comment:6 vdelecroix]:
> Do you think it is worth mentioning that it is a blocker for several projects on their mailing list?

Done: https://mail.python.org/pipermail/cython-devel/2017-April/004995.html



---

archive/issue_comments_313350.json:
```json
{
    "body": "On the Cython mailing list, upstream answered\n\n> I'm in favor of the idea (basically attempting to resolve header files\n> relative to the cython file including them and transitively passing\n> these paths to modules cimporting them); haven't had time to look at\n> the code yet or think if there could be negative implications.\n\nSo we could consider just patching Cython in Sage in order to move forward with #20238.",
    "created_at": "2017-04-14T07:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313350",
    "user": "jdemeyer"
}
```

On the Cython mailing list, upstream answered

> I'm in favor of the idea (basically attempting to resolve header files
> relative to the cython file including them and transitively passing
> these paths to modules cimporting them); haven't had time to look at
> the code yet or think if there could be negative implications.

So we could consider just patching Cython in Sage in order to move forward with #20238.



---

archive/issue_comments_313351.json:
```json
{
    "body": "Replying to [comment:8 jdemeyer]:\n> On the Cython mailing list, upstream answered\n> \n> > I'm in favor of the idea (basically attempting to resolve header files\n> > relative to the cython file including them and transitively passing\n> > these paths to modules cimporting them); haven't had time to look at\n> > the code yet or think if there could be negative implications.\n> \n> So we could consider just patching Cython in Sage in order to move forward with #20238.\n\nIf you need the Sage patched version of Cython to install cypari it is not really independent of Sage...",
    "created_at": "2017-04-14T16:11:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313351",
    "user": "vdelecroix"
}
```

Replying to [comment:8 jdemeyer]:
> On the Cython mailing list, upstream answered
> 
> > I'm in favor of the idea (basically attempting to resolve header files
> > relative to the cython file including them and transitively passing
> > these paths to modules cimporting them); haven't had time to look at
> > the code yet or think if there could be negative implications.
> 
> So we could consider just patching Cython in Sage in order to move forward with #20238.

If you need the Sage patched version of Cython to install cypari it is not really independent of Sage...



---

archive/issue_comments_313352.json:
```json
{
    "body": "Replying to [comment:9 vdelecroix]:\n> If you need the Sage patched version of Cython to install cypari it is not really independent of Sage...\n\nTrue, but that's still better than just keeping #20238 blocked.",
    "created_at": "2017-04-14T16:53:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313352",
    "user": "jdemeyer"
}
```

Replying to [comment:9 vdelecroix]:
> If you need the Sage patched version of Cython to install cypari it is not really independent of Sage...

True, but that's still better than just keeping #20238 blocked.



---

archive/issue_comments_313353.json:
```json
{
    "body": "IIUC Cypari will still install/work without this patch *in principle*--this is just needed for some specific use cases in integration with Sage.  If it were really needed for cypari to work independently of Sage at the worst cypari could monkey-patch Cython.  But considering that this patch is, as far as I can tell, pretty non-controversial and obvious, and is likely to be accepted upstream, I see no problem adding it in Sage as well at least for the sake of progressing on #20238.",
    "created_at": "2017-04-17T20:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313353",
    "user": "embray"
}
```

IIUC Cypari will still install/work without this patch *in principle*--this is just needed for some specific use cases in integration with Sage.  If it were really needed for cypari to work independently of Sage at the worst cypari could monkey-patch Cython.  But considering that this patch is, as far as I can tell, pretty non-controversial and obvious, and is likely to be accepted upstream, I see no problem adding it in Sage as well at least for the sake of progressing on #20238.



---

archive/issue_comments_313354.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-17T20:21:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313354",
    "user": "embray"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_313355.json:
```json
{
    "body": "Replying to [comment:11 embray]:\n> IIUC Cypari will still install/work without this patch *in principle*--this is just needed for some specific use cases in integration with Sage.\n\nTo be specific: that patch is needed whenever some package (Sage in this case) wants to use the *Cython* interface of `CyPari2`. So you are right that CyPari2 by itself does not need that patch.",
    "created_at": "2017-04-18T08:19:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313355",
    "user": "jdemeyer"
}
```

Replying to [comment:11 embray]:
> IIUC Cypari will still install/work without this patch *in principle*--this is just needed for some specific use cases in integration with Sage.

To be specific: that patch is needed whenever some package (Sage in this case) wants to use the *Cython* interface of `CyPari2`. So you are right that CyPari2 by itself does not need that patch.



---

archive/issue_comments_313356.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-23T12:57:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22491",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22491#issuecomment-313356",
    "user": "vbraun"
}
```

Resolution: fixed
