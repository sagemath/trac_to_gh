# Issue 31754: Efficient numerical computations with tensor trains

Issue created by migration from https://trac.sagemath.org/ticket/31991

Original creator: @honglizhaobob

Original creation time: 2021-06-16 17:27:03

CC:  mkoeppe egourgoulhon dimpase

Following the progress with Ticket #30307, we propose to add computational functionalities with tensors via the tensor train decomposition, which is an idea in fact originally named "Density Matrix Renormalization Group (DMRG)" and later popularized by Prof. Ivan Oseledets. 

This functionality is especially useful for high dimensional tasks to prevent the curse of dimensionality (such as in Riemannian optimization), currently supported in MATLAB, Python, and C++. The MATLAB version is currently most versatile and robust.

We may consider internalizing this computational library for Sage, as an effort to formalize the currently available implementations. This addition can either be an additional child class under `tensor`, and overwrite the arithmetics; or a separate module. The backend is currently proposed to be TensorFlow, however this may change / be flexible based on how the refactoring of `Components` progresses. 

One can look at this github page for an example implementation (https://github.com/oseledets/ttpy).

Ideally after the implementation of this ticket, users can specify a fixed rank tensor for a general manifold using `tensor.modules`, specify a ring and a frame, and perform useful and normally computationally intractable tasks using tensor train as a backend. Based on the progress of this ticket, one may also consider implementing other backends for storing a numerical tensor such as tensor rings and quantized tensor train.

For the theory behind why one can reduce a normally exponential (in the number of dimensions) task to a linear task, see (https://epubs.siam.org/doi/abs/10.1137/090752286?journalCode=sjoce3).


---

Comment by mkoeppe created at 2021-06-16 17:41:49

Is `ttpy` still being maintained? I tried to install it (using `sage -pip install ttpy`) and ran into a Fortran issue:

```
    Error: Type mismatch between actual argument at (1) and actual argument at (2) (REAL(8)/COMPLEX(8)).
    tt/tt-fort/ort.f90:271:22:
    
      271 |    call dgemv('t',n,r,1.d0,yy,n,x,1, 0.d0,gv,1)
```



---

Comment by mkoeppe created at 2021-06-16 17:59:32

(This is with gfortran 11.1 on macOS; this may be similar to the many issues that we had when gfortran 10 came along - #29456)


---

Comment by @honglizhaobob created at 2021-06-16 18:07:56

Replying to [comment:6 mkoeppe]:
> (This is with gfortran 11.1 on macOS; this may be similar to the many issues that we had when gfortran 10 came along - #29456)

I didn't have an issue with downloading since I wasn't using pip but directly cloned the code on github. Based on their github's commit history it doesn't seem to be frequently maintained.. The MATLAB version is what I now use for my projects. I will update the MATLAB link in the ticket description.


---

Comment by egourgoulhon created at 2021-06-16 18:57:01

Waouh! This looks promising!


---

Comment by mkoeppe created at 2021-06-16 19:01:14

I have opened an upstream issue for the compilation errors: https://github.com/oseledets/ttpy/issues/82


---

Comment by egourgoulhon created at 2021-06-16 19:12:25

Replying to [comment:9 egourgoulhon]:
> Waouh! This looks promising!
To make it clear: the above comment was about the ticket main goal and was not some ironical statement about the ttpy issue with gfortran ;-)


---

Comment by @honglizhaobob created at 2021-06-19 21:27:42

slightly modified description
