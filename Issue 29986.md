# Issue 29986: Combinatorial designs: generate GQ with spread

archive/issues_029986.json:
```json
{
    "body": "CC:  dimpase\n\nKeywords: generalised_quadrangle\n\nImplement a few functions to generate and work on generalised quadrangles with spreads\n\nIssue created by migration from https://trac.sagemath.org/ticket/30223\n\n",
    "created_at": "2020-07-26T11:13:24Z",
    "labels": [
        "combinatorial designs",
        "major",
        "PLEASE CHANGE"
    ],
    "title": "Combinatorial designs: generate GQ with spread",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29986",
    "user": "@Ivo-Maffei"
}
```
CC:  dimpase

Keywords: generalised_quadrangle

Implement a few functions to generate and work on generalised quadrangles with spreads

Issue created by migration from https://trac.sagemath.org/ticket/30223





---

archive/issue_comments_425968.json:
```json
{
    "body": "At the moment the examples at the top of the file fail and they shouldn't.\nIn particular using the objects defined there one gets:\n\n```\nsage: set(GQ2._points) == set(range(1,1106))\nFalse\nsage: for i in GQ2._points:\n....:     if i not in range(1,1106):\n....:         print(i)\n....:         \nsage: for i in range(1,1106):\n....:     if i not in GQ2._points:\n....:         print(i)\n....:      \nsage:\n```\n\nI wonder if I'm missing something or if `==` is returning some weird output.",
    "created_at": "2020-07-26T11:17:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425968",
    "user": "@Ivo-Maffei"
}
```

At the moment the examples at the top of the file fail and they shouldn't.
In particular using the objects defined there one gets:

```
sage: set(GQ2._points) == set(range(1,1106))
False
sage: for i in GQ2._points:
....:     if i not in range(1,1106):
....:         print(i)
....:         
sage: for i in range(1,1106):
....:     if i not in GQ2._points:
....:         print(i)
....:      
sage:
```

I wonder if I'm missing something or if `==` is returning some weird output.



---

archive/issue_comments_425969.json:
```json
{
    "body": "Minor suggestions, no hurry.\n\n\n```\n-- YOUR NAME (2005-01-03): initial version\n+- Ivo Maffei (2020-07-26): initial version\n```\n\n\n\n```\n-#       Copyright (C) 2013 IVO MAFFEI <ivomaffei@gmail.com>\n+#       Copyright (C) 2013 Ivo Maffei <ivomaffei@gmail.com>\n```\n\n\n\n```\n-    Construct the generalised quadrangle `H(3,q^2)` with an ovoid\n-    The GQ has order `(q^2,q)`\n+    Construct the generalised quadrangle `H(3,q^2)` with an ovoid.\n+\n+    The GQ has order `(q^2,q)`.\n```\n",
    "created_at": "2020-07-26T13:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425969",
    "user": "slelievre"
}
```

Minor suggestions, no hurry.


```
-- YOUR NAME (2005-01-03): initial version
+- Ivo Maffei (2020-07-26): initial version
```



```
-#       Copyright (C) 2013 IVO MAFFEI <ivomaffei@gmail.com>
+#       Copyright (C) 2013 Ivo Maffei <ivomaffei@gmail.com>
```



```
-    Construct the generalised quadrangle `H(3,q^2)` with an ovoid
-    The GQ has order `(q^2,q)`
+    Construct the generalised quadrangle `H(3,q^2)` with an ovoid.
+
+    The GQ has order `(q^2,q)`.
```




---

archive/issue_comments_425970.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2020-07-26T13:06:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425970",
    "user": "slelievre"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_425971.json:
```json
{
    "body": "Replying to [comment:1 gh-Ivo-Maffei]:\n> At the moment the examples at the top of the file fail and they shouldn't.\n> In particular using the objects defined there one gets:\n> {{{\n> sage: set(GQ2._points) == set(range(1,1106))\n> False\n> sage: for i in GQ2._points:\n> ....:     if i not in range(1,1106):\n> ....:         print(i)\n> ....:         \n> sage: for i in range(1,1106):\n> ....:     if i not in GQ2._points:\n> ....:         print(i)\n> ....:      \n> sage:\n> }}}\n> I wonder if I'm missing something or if `==` is returning some weird output.\n\n`set(GQ2._points)` consists of GAP's  Integers, but in `range(1,1106)` you have Python `<int>`.\n\nThere is no automatic conversion between these set elements when you compare them:\n\n```\nsage: libgap(1)==int(1)\nTrue\nsage: type(libgap(1))\n<class 'sage.libs.gap.element.GapElement_Integer'>\nsage: set([libgap(1)])==set([int(1)])\nFalse\n```\n",
    "created_at": "2020-07-26T22:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425971",
    "user": "dimpase"
}
```

Replying to [comment:1 gh-Ivo-Maffei]:
> At the moment the examples at the top of the file fail and they shouldn't.
> In particular using the objects defined there one gets:
> {{{
> sage: set(GQ2._points) == set(range(1,1106))
> False
> sage: for i in GQ2._points:
> ....:     if i not in range(1,1106):
> ....:         print(i)
> ....:         
> sage: for i in range(1,1106):
> ....:     if i not in GQ2._points:
> ....:         print(i)
> ....:      
> sage:
> }}}
> I wonder if I'm missing something or if `==` is returning some weird output.

`set(GQ2._points)` consists of GAP's  Integers, but in `range(1,1106)` you have Python `<int>`.

There is no automatic conversion between these set elements when you compare them:

```
sage: libgap(1)==int(1)
True
sage: type(libgap(1))
<class 'sage.libs.gap.element.GapElement_Integer'>
sage: set([libgap(1)])==set([int(1)])
False
```




---

archive/issue_comments_425972.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-27T08:52:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425972",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425973.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-07-27T08:53:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425973",
    "user": "@Ivo-Maffei"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_425974.json:
```json
{
    "body": "where is this supposed to be used?",
    "created_at": "2020-08-11T13:56:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425974",
    "user": "dimpase"
}
```

where is this supposed to be used?



---

archive/issue_comments_425975.json:
```json
{
    "body": "The point graph of a GQ removed its spread is distance-regular. It's shown in BCN 12.5.\nI haven't yet made a ticket that puts the required code in distance_regular.pyx.",
    "created_at": "2020-08-11T16:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425975",
    "user": "@Ivo-Maffei"
}
```

The point graph of a GQ removed its spread is distance-regular. It's shown in BCN 12.5.
I haven't yet made a ticket that puts the required code in distance_regular.pyx.



---

archive/issue_comments_425976.json:
```json
{
    "body": "The description of \nhttps://en.wikipedia.org/wiki/Generalized_quadrangle\n\nHow about renaming gen_quadrangles.pyx to gen_quadrangles_with_spread.pyx\n\nAlso, `generalised_quadrangle_hermitian` should be renamed to something like\n`generalised_quadrangle_hermitian_with_ovoid`\n\nPerhaps it makes sense to introduce spreads for general Sage's incidence systems\n(sets of blocks that don't pairwise intersect and cover all the points) - then spreads here will be a particular case.",
    "created_at": "2020-08-22T10:26:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425976",
    "user": "dimpase"
}
```

The description of 
https://en.wikipedia.org/wiki/Generalized_quadrangle

How about renaming gen_quadrangles.pyx to gen_quadrangles_with_spread.pyx

Also, `generalised_quadrangle_hermitian` should be renamed to something like
`generalised_quadrangle_hermitian_with_ovoid`

Perhaps it makes sense to introduce spreads for general Sage's incidence systems
(sets of blocks that don't pairwise intersect and cover all the points) - then spreads here will be a particular case.



---

archive/issue_comments_425977.json:
```json
{
    "body": "Replying to [comment:8 dimpase]:\n> Perhaps it makes sense to introduce spreads for general Sage's incidence systems\n> (sets of blocks that don't pairwise intersect and cover all the points) - then spreads here will be a particular case.\nDo you have any idea on how to do so? We could add a field to the `IncidenceStructure` class or make a subclass `IncidenceStructureWithSpread`...",
    "created_at": "2020-08-22T10:54:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425977",
    "user": "@Ivo-Maffei"
}
```

Replying to [comment:8 dimpase]:
> Perhaps it makes sense to introduce spreads for general Sage's incidence systems
> (sets of blocks that don't pairwise intersect and cover all the points) - then spreads here will be a particular case.
Do you have any idea on how to do so? We could add a field to the `IncidenceStructure` class or make a subclass `IncidenceStructureWithSpread`...



---

archive/issue_comments_425978.json:
```json
{
    "body": "I meant a member function that verifies that a given set of blocks is a spread.",
    "created_at": "2020-08-22T11:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425978",
    "user": "dimpase"
}
```

I meant a member function that verifies that a given set of blocks is a spread.



---

archive/issue_comments_425979.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-22T13:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425979",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425980.json:
```json
{
    "body": "I get a memory error here:\n\n```\nFile \"src/sage/combinat/designs/gen_quadrangles_with_spread.pyx\", line 257, in sage.combinat.designs.gen_quadrangles_with_spread.generalised_quadrangle_hermitian_with_ovoid\nFailed example:\n    t[0].is_generalized_quadrangle()  # long time\nException raised:\n...\n```\n\nand even worse crash (Bad Exit) here:\n\n```\nFile \"src/sage/combinat/designs/gen_quadrangles_with_spread.pyx\", line 271, in sage.combinat.designs.gen_quadrangles_with_spread.generalised_quadrangle_hermitian_with_ovoid\nFailed example:\n    is_GQ_with_spread(*t, s=3, t=9)\nException raised:\n...\n```\n",
    "created_at": "2020-08-24T17:42:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425980",
    "user": "dimpase"
}
```

I get a memory error here:

```
File "src/sage/combinat/designs/gen_quadrangles_with_spread.pyx", line 257, in sage.combinat.designs.gen_quadrangles_with_spread.generalised_quadrangle_hermitian_with_ovoid
Failed example:
    t[0].is_generalized_quadrangle()  # long time
Exception raised:
...
```

and even worse crash (Bad Exit) here:

```
File "src/sage/combinat/designs/gen_quadrangles_with_spread.pyx", line 271, in sage.combinat.designs.gen_quadrangles_with_spread.generalised_quadrangle_hermitian_with_ovoid
Failed example:
    is_GQ_with_spread(*t, s=3, t=9)
Exception raised:
...
```




---

archive/issue_comments_425981.json:
```json
{
    "body": "I merged 9.2.beta10 and tried both:\n\n```\nsage -tp src/sage/combinat/designs/gen_quadrangles_with_spread.pyx\nsage -tp --long src/sage/combinat/designs/gen_quadrangles_with_spread.pyx\n```\n\n\nThey both terminate with all tests passed.\nCould you try again with the merged branch and post the traceback?",
    "created_at": "2020-08-25T09:23:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425981",
    "user": "@Ivo-Maffei"
}
```

I merged 9.2.beta10 and tried both:

```
sage -tp src/sage/combinat/designs/gen_quadrangles_with_spread.pyx
sage -tp --long src/sage/combinat/designs/gen_quadrangles_with_spread.pyx
```


They both terminate with all tests passed.
Could you try again with the merged branch and post the traceback?



---

archive/issue_comments_425982.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-25T09:23:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425982",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425983.json:
```json
{
    "body": "The non-long tests pass, but the long ones end up with\n\n```\n$ ./sage -tp 1 --long src/sage/combinat/designs/gen_quadrangles_with_spread.pyx 2>&1 >/tmp/p\nProcess DocTestWorker-1:\nTraceback (most recent call last):\n  File \"/usr/lib/python3.7/multiprocessing/process.py\", line 297, in _bootstrap\n    self.run()\n  File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2185, in run\n    task(self.options, self.outtmpfile, msgpipe, self.result_queue)\n  File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 2535, in __call__\n    result_queue.put(result, False)\n  File \"/usr/lib/python3.7/multiprocessing/queues.py\", line 87, in put\n    self._start_thread()\n  File \"/usr/lib/python3.7/multiprocessing/queues.py\", line 170, in _start_thread\n    self._thread.start()\n  File \"/usr/lib/python3.7/threading.py\", line 852, in start\n    _start_new_thread(self._bootstrap, ())\nRuntimeError: can't start new thread\n```\n\nin \n\n```\nsage: t[0].is_generalized_quadrangle()  # long time ## line 257 ##\n```\n\n\nThis seems to be limited to this machine, though. If I run the test in question at the Sage prompt\nit takes about 30 sec and takes a lot of RAM.\nA much quicker test for t[0] being GQ(16,4) is to look at the dual graph\n\n```\nsage: tt=t[0]                                                                                                                        \nsage: ig=tt.intersection_graph([1])                                                                                                  \nsage: ig.is_strongly_regular(parameters=True)                                                                                        \n(325, 68, 3, 17)\nsage: set(tt.block_sizes())                                                                                                          \n{17}\n```\n\nIndeed, we got the collinearity graph of GQ(s,t)=GQ(4,16), as 68=s(t+1)=4*17, lambda=s-1=3, mu=t+1=17, and each of 325 blocks has size 17 (i.e. dually each of the 325 points has 17 blocks\nof size s+1=5 on it).",
    "created_at": "2020-08-25T22:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425983",
    "user": "dimpase"
}
```

The non-long tests pass, but the long ones end up with

```
$ ./sage -tp 1 --long src/sage/combinat/designs/gen_quadrangles_with_spread.pyx 2>&1 >/tmp/p
Process DocTestWorker-1:
Traceback (most recent call last):
  File "/usr/lib/python3.7/multiprocessing/process.py", line 297, in _bootstrap
    self.run()
  File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2185, in run
    task(self.options, self.outtmpfile, msgpipe, self.result_queue)
  File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 2535, in __call__
    result_queue.put(result, False)
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 87, in put
    self._start_thread()
  File "/usr/lib/python3.7/multiprocessing/queues.py", line 170, in _start_thread
    self._thread.start()
  File "/usr/lib/python3.7/threading.py", line 852, in start
    _start_new_thread(self._bootstrap, ())
RuntimeError: can't start new thread
```

in 

```
sage: t[0].is_generalized_quadrangle()  # long time ## line 257 ##
```


This seems to be limited to this machine, though. If I run the test in question at the Sage prompt
it takes about 30 sec and takes a lot of RAM.
A much quicker test for t[0] being GQ(16,4) is to look at the dual graph

```
sage: tt=t[0]                                                                                                                        
sage: ig=tt.intersection_graph([1])                                                                                                  
sage: ig.is_strongly_regular(parameters=True)                                                                                        
(325, 68, 3, 17)
sage: set(tt.block_sizes())                                                                                                          
{17}
```

Indeed, we got the collinearity graph of GQ(s,t)=GQ(4,16), as 68=s(t+1)=4*17, lambda=s-1=3, mu=t+1=17, and each of 325 blocks has size 17 (i.e. dually each of the 325 points has 17 blocks
of size s+1=5 on it).



---

archive/issue_comments_425984.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-25T22:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425984",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425985.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-08-26T06:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425985",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_425986.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-08-26T06:47:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425986",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_425987.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-26T07:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425987",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425988.json:
```json
{
    "body": "perhaps on another ticket one should change the is_generalised_quadrangle to use this approach, it is faster.",
    "created_at": "2020-08-26T07:21:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425988",
    "user": "dimpase"
}
```

perhaps on another ticket one should change the is_generalised_quadrangle to use this approach, it is faster.



---

archive/issue_comments_425989.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-08-26T13:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425989",
    "user": "dimpase"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_425990.json:
```json
{
    "body": "I spoke too soon - docs don't build:\n\n```\n...\n[dochtml] [combinat ] The inventory files are in local/share/doc/sage/inventory/en/reference/combinat.\n[dochtml] Error building the documentation.\n[dochtml] Traceback (most recent call last):\n[dochtml]   File \"/usr/lib/python3.7/runpy.py\", line 193, in _run_module_as_main\n[dochtml]     \"__main__\", mod_spec)\n[dochtml]   File \"/usr/lib/python3.7/runpy.py\", line 85, in _run_code\n[dochtml]     exec(code, run_globals)\n[dochtml]   File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__main__.py\", line 2, in <module>\n[dochtml]     main()\n[dochtml]   File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 1721, in main\n[dochtml]     builder()\n[dochtml]   File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 328, in _wrapper\n[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)\n[dochtml]   File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 553, in _wrapper\n[dochtml]     self._build_everything_except_bibliography(lang, format, *args, **kwds)\n[dochtml]   File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 539, in _build_everything_except_bibliography\n[dochtml]     build_many(build_ref_doc, non_references)\n[dochtml]   File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py\", line 281, in build_many\n[dochtml]     _build_many(target, args, processes=NUM_THREADS)\n[dochtml]   File \"/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/utils.py\", line 283, in build_many\n[dochtml]     raise worker_exc.original_exception\n[dochtml] OSError: WARNING: autodoc: failed to import module 'gen_quadrangles' from module 'sage.combinat.designs'; the following exception was raised:\nmake[3]: *** [Makefile:1866: doc-html] Error 1\n```\n",
    "created_at": "2020-08-26T13:40:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425990",
    "user": "dimpase"
}
```

I spoke too soon - docs don't build:

```
...
[dochtml] [combinat ] The inventory files are in local/share/doc/sage/inventory/en/reference/combinat.
[dochtml] Error building the documentation.
[dochtml] Traceback (most recent call last):
[dochtml]   File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
[dochtml]     "__main__", mod_spec)
[dochtml]   File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
[dochtml]     exec(code, run_globals)
[dochtml]   File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__main__.py", line 2, in <module>
[dochtml]     main()
[dochtml]   File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 1721, in main
[dochtml]     builder()
[dochtml]   File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 328, in _wrapper
[dochtml]     getattr(get_builder(document), 'inventory')(*args, **kwds)
[dochtml]   File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 553, in _wrapper
[dochtml]     self._build_everything_except_bibliography(lang, format, *args, **kwds)
[dochtml]   File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 539, in _build_everything_except_bibliography
[dochtml]     build_many(build_ref_doc, non_references)
[dochtml]   File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/__init__.py", line 281, in build_many
[dochtml]     _build_many(target, args, processes=NUM_THREADS)
[dochtml]   File "/mnt/opt/Sage/sage-dev/local/lib/python3.7/site-packages/sage_setup/docbuild/utils.py", line 283, in build_many
[dochtml]     raise worker_exc.original_exception
[dochtml] OSError: WARNING: autodoc: failed to import module 'gen_quadrangles' from module 'sage.combinat.designs'; the following exception was raised:
make[3]: *** [Makefile:1866: doc-html] Error 1
```




---

archive/issue_comments_425991.json:
```json
{
    "body": "I suppose one needs\n\n```diff\ndiff --git a/src/doc/en/reference/combinat/module_list.rst b/src/doc/en/reference/combinat/module_list.rst\nindex 39ca27c4a6..c8eca43954 100644\n--- a/src/doc/en/reference/combinat/module_list.rst\n+++ b/src/doc/en/reference/combinat/module_list.rst\n@@ -104,7 +104,7 @@ Comprehensive Module list\n     sage/combinat/designs/difference_matrices\n     sage/combinat/designs/evenly_distributed_sets\n     sage/combinat/designs/ext_rep\n-    sage/combinat/designs/gen_quadrangles\n+    sage/combinat/designs/gen_quadrangles_with_spread\n     sage/combinat/designs/incidence_structures\n     sage/combinat/designs/latin_squares\n     sage/combinat/designs/orthogonal_arrays\ndiff --git a/src/sage/combinat/designs/__init__.py b/src/sage/combinat/designs/__init__.py\nindex f8de34936f..4808cf1a55 100644\n--- a/src/sage/combinat/designs/__init__.py\n+++ b/src/sage/combinat/designs/__init__.py\n@@ -27,7 +27,7 @@ design catalog:\n - :ref:`sage.combinat.designs.steiner_quadruple_systems`\n - :ref:`sage.combinat.designs.twographs`\n - :ref:`sage.combinat.designs.database`\n-- :ref:`sage.combinat.designs.gen_quadrangles`\n+- :ref:`sage.combinat.designs.gen_quadrangles_with_spread`\n \n **Technical things**\n \ndiff --git a/src/sage/combinat/designs/design_catalog.py b/src/sage/combinat/designs/design_catalog.py\nindex 3a3c11597a..a9572e119c 100644\n--- a/src/sage/combinat/designs/design_catalog.py\n+++ b/src/sage/combinat/designs/design_catalog.py\n@@ -59,7 +59,7 @@ This module gathers the following designs:\n     :meth:`~sage.combinat.designs.steiner_quadruple_systems.steiner_quadruple_system`\n     :meth:`~sage.combinat.designs.block_design.projective_plane`\n     :meth:`~sage.combinat.designs.biplane`\n-    :meth:`~sage.combinat.designs.gen_quadrangles`\n+    :meth:`~sage.combinat.designs.gen_quadrangles_with_spread`\n \n And the :meth:`designs.best_known_covering_design_from_LJCR\n <sage.combinat.designs.covering_design.best_known_covering_design_www>` function\n```\n",
    "created_at": "2020-08-26T13:57:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425991",
    "user": "dimpase"
}
```

I suppose one needs

```diff
diff --git a/src/doc/en/reference/combinat/module_list.rst b/src/doc/en/reference/combinat/module_list.rst
index 39ca27c4a6..c8eca43954 100644
--- a/src/doc/en/reference/combinat/module_list.rst
+++ b/src/doc/en/reference/combinat/module_list.rst
@@ -104,7 +104,7 @@ Comprehensive Module list
     sage/combinat/designs/difference_matrices
     sage/combinat/designs/evenly_distributed_sets
     sage/combinat/designs/ext_rep
-    sage/combinat/designs/gen_quadrangles
+    sage/combinat/designs/gen_quadrangles_with_spread
     sage/combinat/designs/incidence_structures
     sage/combinat/designs/latin_squares
     sage/combinat/designs/orthogonal_arrays
diff --git a/src/sage/combinat/designs/__init__.py b/src/sage/combinat/designs/__init__.py
index f8de34936f..4808cf1a55 100644
--- a/src/sage/combinat/designs/__init__.py
+++ b/src/sage/combinat/designs/__init__.py
@@ -27,7 +27,7 @@ design catalog:
 - :ref:`sage.combinat.designs.steiner_quadruple_systems`
 - :ref:`sage.combinat.designs.twographs`
 - :ref:`sage.combinat.designs.database`
-- :ref:`sage.combinat.designs.gen_quadrangles`
+- :ref:`sage.combinat.designs.gen_quadrangles_with_spread`
 
 **Technical things**
 
diff --git a/src/sage/combinat/designs/design_catalog.py b/src/sage/combinat/designs/design_catalog.py
index 3a3c11597a..a9572e119c 100644
--- a/src/sage/combinat/designs/design_catalog.py
+++ b/src/sage/combinat/designs/design_catalog.py
@@ -59,7 +59,7 @@ This module gathers the following designs:
     :meth:`~sage.combinat.designs.steiner_quadruple_systems.steiner_quadruple_system`
     :meth:`~sage.combinat.designs.block_design.projective_plane`
     :meth:`~sage.combinat.designs.biplane`
-    :meth:`~sage.combinat.designs.gen_quadrangles`
+    :meth:`~sage.combinat.designs.gen_quadrangles_with_spread`
 
 And the :meth:`designs.best_known_covering_design_from_LJCR
 <sage.combinat.designs.covering_design.best_known_covering_design_www>` function
```




---

archive/issue_comments_425992.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-26T14:13:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425992",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_425993.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-08-26T14:16:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425993",
    "user": "@Ivo-Maffei"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_425994.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-26T14:30:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425994",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_425995.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-30T08:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425995",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_425996.json:
```json
{
    "body": "Replying to [comment:3 dimpase]:\n> Replying to [comment:1 gh-Ivo-Maffei]:\n> > At the moment the examples at the top of the file fail and they shouldn't.\n> > In particular using the objects defined there one gets:\n> > {{{\n> > sage: set(GQ2._points) == set(range(1,1106))\n> > False\n> > sage: for i in GQ2._points:\n> > ....:     if i not in range(1,1106):\n> > ....:         print(i)\n> > ....:         \n> > sage: for i in range(1,1106):\n> > ....:     if i not in GQ2._points:\n> > ....:         print(i)\n> > ....:      \n> > sage:\n> > }}}\n> > I wonder if I'm missing something or if `==` is returning some weird output.\n> \n> `set(GQ2._points)` consists of GAP's  Integers, but in `range(1,1106)` you have Python `<int>`.\n> \n> There is no automatic conversion between these set elements when you compare them:\n> {{{\n> sage: libgap(1)==int(1)\n> True\n> sage: type(libgap(1))\n> <class 'sage.libs.gap.element.GapElement_Integer'>\n> sage: set([libgap(1)])==set([int(1)])\n> False\n> }}}\n> \n> \n\nTo my mind this is a serious issue, see #30498.",
    "created_at": "2020-09-03T09:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29986",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29986#issuecomment-425996",
    "user": "vdelecroix"
}
```

Replying to [comment:3 dimpase]:
> Replying to [comment:1 gh-Ivo-Maffei]:
> > At the moment the examples at the top of the file fail and they shouldn't.
> > In particular using the objects defined there one gets:
> > {{{
> > sage: set(GQ2._points) == set(range(1,1106))
> > False
> > sage: for i in GQ2._points:
> > ....:     if i not in range(1,1106):
> > ....:         print(i)
> > ....:         
> > sage: for i in range(1,1106):
> > ....:     if i not in GQ2._points:
> > ....:         print(i)
> > ....:      
> > sage:
> > }}}
> > I wonder if I'm missing something or if `==` is returning some weird output.
> 
> `set(GQ2._points)` consists of GAP's  Integers, but in `range(1,1106)` you have Python `<int>`.
> 
> There is no automatic conversion between these set elements when you compare them:
> {{{
> sage: libgap(1)==int(1)
> True
> sage: type(libgap(1))
> <class 'sage.libs.gap.element.GapElement_Integer'>
> sage: set([libgap(1)])==set([int(1)])
> False
> }}}
> 
> 

To my mind this is a serious issue, see #30498.
