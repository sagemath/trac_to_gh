# Issue 12453: Conversion of pari elements to Sage fails on some negative valuation elements

Issue created by migration from Trac.

Original creator: roed

Original creation time: 2012-03-03 18:50:28

Assignee: roed


```
sage: K = Qp(11,5)
sage: pari(K(11^-5)).sage()
ArithmeticError
sage: ZZ(pari(Qp(11)(11^-7)))
SEGFAULT
```



---

Attachment


---

Comment by roed created at 2012-03-03 18:55:08

Changing status from new to needs_review.


---

Comment by caruso created at 2012-03-03 19:47:23

I propose to modify the function padicprec() so that it computes itself the underlying prime number. Currently, one have:


```
sage: K = Qp(11,5)
sage: x = K(5)
sage: x
5 + O(11^5)
sage: y = pari(x)
sage: y.padicprec(11)
5
sage: y.padicprec(17)
  ***   not the same prime in padicprec.
  ***   Error in the PARI system. End of program.
```



---

Comment by caruso created at 2012-03-03 19:47:23

Changing status from needs_review to needs_work.


---

Attachment

apply after the other patch


---

Comment by was created at 2012-03-04 16:22:18

Changing status from needs_work to needs_review.


---

Comment by was created at 2012-03-04 16:22:18

I'm happy with this, but due to the amount I added, somebody else (anybody!) should sign off on it.


---

Comment by roed created at 2012-03-05 07:53:45

Yep.  That looks good.


---

Comment by roed created at 2012-03-05 07:53:45

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-03-13 08:25:12

Resolution: fixed
