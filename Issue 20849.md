# Issue 20849: new style package for database_kohel

Issue created by migration from https://trac.sagemath.org/ticket/21086

Original creator: vdelecroix

Original creation time: 2016-07-24 23:21:06

CC:  jdemeyer was vbraun

Make a new style package for database_kohel

Upstream tarball available at

    http://www.labri.fr/perso/vdelecro/database_kohel-20160724.tar.gz


---

Comment by vdelecroix created at 2016-07-24 23:23:51

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2016-07-24 23:23:51

(few minutes needed to upload the tarball)


---

Comment by git created at 2016-07-24 23:23:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2016-07-25 08:44:39

1. You need to check for errors in `spkg-install` (in particular, the `mv` commands).

2. You can replace

```

if [ -d ${TARGET} ]
then
	echo "REMOVING PREVIOUS VERSION"
    rm -rf ${TARGET}
fi
```

by

```
rm -rf ${TARGET}
```


3. I don't like this error handling:

```
         try:
             coeff_list = _dbz_to_integer_list(modpol)
        except IOError:
            raise KeyError("No database entry for modular polynomial of level %s"%level)
```


I think it would be better to raise the error directly in `_dbz_to_integer_list` and then only if the file really cannot be opened. If the error is raised while reading the file, it should be propagated as `IOError`. I also think that `KeyError` is not really appropriate, since it's not a key. I would prefer `LookupError`.


---

Comment by jdemeyer created at 2016-07-25 08:44:39

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2016-07-25 08:45:26

I should also add that this package is not as important as it used to be, since PARI can now compute the modular polynomials provided by this package.


---

Comment by jdemeyer created at 2016-07-25 09:25:08

For the `dependencies`, can you use a more explicit `# no dependencies`?


---

Comment by vdelecroix created at 2016-07-25 18:15:40

Replying to [comment:4 jdemeyer]:
> I should also add that this package is not as important as it used to be, since PARI can now compute the modular polynomials provided by this package.

Could you provide the commands available to check the data in the package?

What do you think about using pari and deprecate the database?


---

Comment by git created at 2016-07-25 18:27:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-07-25 18:27:59

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2016-07-26 07:45:50

Replying to [comment:6 vdelecroix]:
> Could you provide the commands available to check the data in the package?

Maybe you should ask the PARI developers (are you currently in Bordeaux?)

> What do you think about using pari

This already happens. The database is no longer used by anything else in Sage.

> and deprecate the database?

I don't think this is needed. It is still useful to avoid long computations if you need the large polynomials.


---

Comment by jdemeyer created at 2016-07-26 07:47:25

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2016-07-26 07:47:25

You didn't fix this:

1. You need to check for errors in `spkg-install` (in particular, the `mv` commands).


---

Comment by jdemeyer created at 2016-07-26 07:50:45

Another detail (feel free to fix this or not): I don't think that the extra arguments to `__getitem__` are useful:

```
def __getitem__(self, disc, level=1, var='x'):
```

I would change this to

```
def __getitem__(self, disc):
```



---

Comment by git created at 2016-07-26 16:19:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-07-26 16:20:07

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2016-07-27 15:35:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-28 17:44:26

Resolution: fixed
