# Issue 20849: new style package for database_kohel

archive/issues_020849.json:
```json
{
    "body": "CC:  @jdemeyer @williamstein @vbraun\n\nMake a new style package for database_kohel\n\nUpstream tarball available at\n\n    http://www.labri.fr/perso/vdelecro/database_kohel-20160724.tar.gz\n\nIssue created by migration from https://trac.sagemath.org/ticket/21086\n\n",
    "created_at": "2016-07-24T23:21:06Z",
    "labels": [
        "component: packages: optional"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "new style package for database_kohel",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20849",
    "user": "https://github.com/videlec"
}
```
CC:  @jdemeyer @williamstein @vbraun

Make a new style package for database_kohel

Upstream tarball available at

    http://www.labri.fr/perso/vdelecro/database_kohel-20160724.tar.gz

Issue created by migration from https://trac.sagemath.org/ticket/21086





---

archive/issue_comments_287890.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-24T23:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287890",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_287891.json:
```json
{
    "body": "(few minutes needed to upload the tarball)",
    "created_at": "2016-07-24T23:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287891",
    "user": "https://github.com/videlec"
}
```

(few minutes needed to upload the tarball)



---

archive/issue_comments_287892.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-24T23:23:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287892",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287893.json:
```json
{
    "body": "1. You need to check for errors in `spkg-install` (in particular, the `mv` commands).\n\n2. You can replace\n\n```\n\nif [ -d ${TARGET} ]\nthen\n\techo \"REMOVING PREVIOUS VERSION\"\n    rm -rf ${TARGET}\nfi\n```\n\nby\n\n```\nrm -rf ${TARGET}\n```\n\n\n3. I don't like this error handling:\n\n```\n         try:\n             coeff_list = _dbz_to_integer_list(modpol)\n        except IOError:\n            raise KeyError(\"No database entry for modular polynomial of level %s\"%level)\n```\n\n\nI think it would be better to raise the error directly in `_dbz_to_integer_list` and then only if the file really cannot be opened. If the error is raised while reading the file, it should be propagated as `IOError`. I also think that `KeyError` is not really appropriate, since it's not a key. I would prefer `LookupError`.",
    "created_at": "2016-07-25T08:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287893",
    "user": "https://github.com/jdemeyer"
}
```

1. You need to check for errors in `spkg-install` (in particular, the `mv` commands).

2. You can replace

```

if [ -d ${TARGET} ]
then
	echo "REMOVING PREVIOUS VERSION"
    rm -rf ${TARGET}
fi
```

by

```
rm -rf ${TARGET}
```


3. I don't like this error handling:

```
         try:
             coeff_list = _dbz_to_integer_list(modpol)
        except IOError:
            raise KeyError("No database entry for modular polynomial of level %s"%level)
```


I think it would be better to raise the error directly in `_dbz_to_integer_list` and then only if the file really cannot be opened. If the error is raised while reading the file, it should be propagated as `IOError`. I also think that `KeyError` is not really appropriate, since it's not a key. I would prefer `LookupError`.



---

archive/issue_comments_287894.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-25T08:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287894",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_287895.json:
```json
{
    "body": "I should also add that this package is not as important as it used to be, since PARI can now compute the modular polynomials provided by this package.",
    "created_at": "2016-07-25T08:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287895",
    "user": "https://github.com/jdemeyer"
}
```

I should also add that this package is not as important as it used to be, since PARI can now compute the modular polynomials provided by this package.



---

archive/issue_comments_287896.json:
```json
{
    "body": "For the `dependencies`, can you use a more explicit `# no dependencies`?",
    "created_at": "2016-07-25T09:25:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287896",
    "user": "https://github.com/jdemeyer"
}
```

For the `dependencies`, can you use a more explicit `# no dependencies`?



---

archive/issue_comments_287897.json:
```json
{
    "body": "Replying to [comment:4 jdemeyer]:\n> I should also add that this package is not as important as it used to be, since PARI can now compute the modular polynomials provided by this package.\n\nCould you provide the commands available to check the data in the package?\n\nWhat do you think about using pari and deprecate the database?",
    "created_at": "2016-07-25T18:15:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287897",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:4 jdemeyer]:
> I should also add that this package is not as important as it used to be, since PARI can now compute the modular polynomials provided by this package.

Could you provide the commands available to check the data in the package?

What do you think about using pari and deprecate the database?



---

archive/issue_comments_287898.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-25T18:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287898",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287899.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-25T18:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287899",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_287900.json:
```json
{
    "body": "Replying to [comment:6 vdelecroix]:\n> Could you provide the commands available to check the data in the package?\n\nMaybe you should ask the PARI developers (are you currently in Bordeaux?)\n\n> What do you think about using pari\n\nThis already happens. The database is no longer used by anything else in Sage.\n\n> and deprecate the database?\n\nI don't think this is needed. It is still useful to avoid long computations if you need the large polynomials.",
    "created_at": "2016-07-26T07:45:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287900",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:6 vdelecroix]:
> Could you provide the commands available to check the data in the package?

Maybe you should ask the PARI developers (are you currently in Bordeaux?)

> What do you think about using pari

This already happens. The database is no longer used by anything else in Sage.

> and deprecate the database?

I don't think this is needed. It is still useful to avoid long computations if you need the large polynomials.



---

archive/issue_comments_287901.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-26T07:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287901",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_287902.json:
```json
{
    "body": "You didn't fix this:\n\n1. You need to check for errors in `spkg-install` (in particular, the `mv` commands).",
    "created_at": "2016-07-26T07:47:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287902",
    "user": "https://github.com/jdemeyer"
}
```

You didn't fix this:

1. You need to check for errors in `spkg-install` (in particular, the `mv` commands).



---

archive/issue_comments_287903.json:
```json
{
    "body": "Another detail (feel free to fix this or not): I don't think that the extra arguments to `__getitem__` are useful:\n\n```\ndef __getitem__(self, disc, level=1, var='x'):\n```\n\nI would change this to\n\n```\ndef __getitem__(self, disc):\n```\n",
    "created_at": "2016-07-26T07:50:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287903",
    "user": "https://github.com/jdemeyer"
}
```

Another detail (feel free to fix this or not): I don't think that the extra arguments to `__getitem__` are useful:

```
def __getitem__(self, disc, level=1, var='x'):
```

I would change this to

```
def __getitem__(self, disc):
```




---

archive/issue_comments_287904.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-26T16:19:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287904",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_287905.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-07-26T16:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287905",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_287906.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-27T15:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287906",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_019774.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-28T17:44:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/20849#event-19774"
}
```



---

archive/issue_comments_287907.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-28T17:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20849",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20849#issuecomment-287907",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
