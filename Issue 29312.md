# Issue 29312: bootstrap: Clean up use of gettextize

Issue created by migration from https://trac.sagemath.org/ticket/29549

Original creator: mkoeppe

Original creation time: 2020-04-22 04:31:54

CC:  dimpase

See discussion at
https://github.com/Homebrew/homebrew-core/issues/53192


---

Comment by mkoeppe created at 2020-04-22 04:32:03

Definitely not for 9.1.


---

Comment by mkoeppe created at 2021-02-07 21:55:42

(from dimpase on #27823)

Bruno Haible says on [bug-autoconf](https://lists.gnu.org/archive/html/bug-autoconf/2021-01/msg00033.html) that one should use gnulib's iconv module to install `config.rpath` etc. Indeed, 

```
gnulib-tool --import iconv
```

will install `config.rpath` into `config/` (among with other things that probably can be ignored).
So this is something to try in order to get rid of the hacky `install_config_rpath()` in comment:18


---

Comment by mkoeppe created at 2021-02-07 22:00:44

Unfortunately, `gnulib` is not present on `homebrew` (https://repology.org/project/gnulib/versions), so we should not try to use it in the `bootstrap` phase... Of course we can just commit the generated file -- it probably does not change so often.


---

Comment by mkoeppe created at 2022-06-18 18:33:40

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2022-06-18 18:33:40

New commits:


---

Comment by dimpase created at 2022-06-23 09:22:32

Replying to [comment:4 mkoeppe]:
> Unfortunately, `gnulib` is not present on `homebrew` (https://repology.org/project/gnulib/versions), so we should not try to use it in the `bootstrap` phase... Of course we can just commit the generated file -- it probably does not change so often.

any reason for gnulib not being on `homebrew`?

(anyhow, I'm testing this now).


---

Comment by dimpase created at 2022-06-23 09:39:19

Replying to [comment:7 dimpase]:

> any reason for gnulib not being on `homebrew`?
> 
> (anyhow, I'm testing this now).

upstream says: just use git to get `gnulib`, as there is nothing to build.
https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html

Hmm, yes, we can in principle have `gnulib` installed as a git submodule...


---

Comment by mkoeppe created at 2022-06-25 18:14:18

Replying to [comment:8 dimpase]:
> upstream says: just use git to get `gnulib`, as there is nothing to build.

That's what I did, and I committed the result.


---

Comment by git created at 2022-06-25 21:19:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-06-25 21:21:30

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2022-06-28 08:12:00

I tested this before the last 2 commits were added. Should they be tested with docker somehow?


---

Comment by mkoeppe created at 2022-06-28 18:10:07

It ran successfully at https://github.com/mkoeppe/sage/actions/runs/2561994135


---

Comment by dimpase created at 2022-06-28 18:16:00

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2022-06-28 18:16:00

ok, lgtm


---

Comment by mkoeppe created at 2022-06-28 18:22:00

Thanks!


---

Comment by vbraun created at 2022-07-01 20:56:06

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2022-07-01 20:56:06

When actually trying to use the generated confball I get (on OSX):

```
Using cached file /Users/buildbot-sage/worker/sage_git/build/upstream/configure-4b0180ea3fe0842fd17ffa15afa79dc3b4bf2cd0.tar.gz
config/install-sh: Skipping hardlink pointing to itself: config/install-sh
tar: Error exit delayed from previous errors.
```

The build seems to continue but skipping to untar a file is probably not good...


---

Comment by mkoeppe created at 2022-07-01 21:11:26

`which tar`?


---

Comment by mkoeppe created at 2022-07-01 21:18:06

Do use rdfind in this tree?


---

Comment by git created at 2022-07-01 21:22:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-07-01 21:22:49

Can't reproduce without more detail but here's removing a duplication of `install-sh` as an argument to tar.


---

Comment by mkoeppe created at 2022-07-01 21:22:49

Changing status from needs_work to needs_review.


---

Comment by dimpase created at 2022-07-04 11:20:42

let me test this on macOS


---

Comment by dimpase created at 2022-07-04 15:27:52

lgtm - running `./bootstrap -s` followed by `/bootstrap -d` works without warnings/errors.


---

Comment by dimpase created at 2022-07-04 15:27:52

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-07-04 15:32:30

Thanks!


---

Comment by vbraun created at 2022-07-09 22:33:47

Resolution: fixed


---

Comment by mkoeppe created at 2022-07-11 16:15:53

Follow-up in #34152
