# Issue 29312: bootstrap: Clean up use of gettextize

archive/issues_029312.json:
```json
{
    "body": "CC:  dimpase\n\nSee discussion at\nhttps://github.com/Homebrew/homebrew-core/issues/53192\n\nIssue created by migration from https://trac.sagemath.org/ticket/29549\n\n",
    "created_at": "2020-04-22T04:31:54Z",
    "labels": [
        "build: configure",
        "major",
        "enhancement"
    ],
    "title": "bootstrap: Clean up use of gettextize",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29312",
    "user": "mkoeppe"
}
```
CC:  dimpase

See discussion at
https://github.com/Homebrew/homebrew-core/issues/53192

Issue created by migration from https://trac.sagemath.org/ticket/29549





---

archive/issue_comments_415539.json:
```json
{
    "body": "Definitely not for 9.1.",
    "created_at": "2020-04-22T04:32:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415539",
    "user": "mkoeppe"
}
```

Definitely not for 9.1.



---

archive/issue_comments_415540.json:
```json
{
    "body": "(from dimpase on #27823)\n\nBruno Haible says on [bug-autoconf](https://lists.gnu.org/archive/html/bug-autoconf/2021-01/msg00033.html) that one should use gnulib's iconv module to install `config.rpath` etc. Indeed, \n\n```\ngnulib-tool --import iconv\n```\n\nwill install `config.rpath` into `config/` (among with other things that probably can be ignored).\nSo this is something to try in order to get rid of the hacky `install_config_rpath()` in comment:18",
    "created_at": "2021-02-07T21:55:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415540",
    "user": "mkoeppe"
}
```

(from dimpase on #27823)

Bruno Haible says on [bug-autoconf](https://lists.gnu.org/archive/html/bug-autoconf/2021-01/msg00033.html) that one should use gnulib's iconv module to install `config.rpath` etc. Indeed, 

```
gnulib-tool --import iconv
```

will install `config.rpath` into `config/` (among with other things that probably can be ignored).
So this is something to try in order to get rid of the hacky `install_config_rpath()` in comment:18



---

archive/issue_comments_415541.json:
```json
{
    "body": "Unfortunately, `gnulib` is not present on `homebrew` (https://repology.org/project/gnulib/versions), so we should not try to use it in the `bootstrap` phase... Of course we can just commit the generated file -- it probably does not change so often.",
    "created_at": "2021-02-07T22:00:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415541",
    "user": "mkoeppe"
}
```

Unfortunately, `gnulib` is not present on `homebrew` (https://repology.org/project/gnulib/versions), so we should not try to use it in the `bootstrap` phase... Of course we can just commit the generated file -- it probably does not change so often.



---

archive/issue_comments_415542.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-06-18T18:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415542",
    "user": "mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_415543.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-06-18T18:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415543",
    "user": "mkoeppe"
}
```

New commits:



---

archive/issue_comments_415544.json:
```json
{
    "body": "Replying to [comment:4 mkoeppe]:\n> Unfortunately, `gnulib` is not present on `homebrew` (https://repology.org/project/gnulib/versions), so we should not try to use it in the `bootstrap` phase... Of course we can just commit the generated file -- it probably does not change so often.\n\nany reason for gnulib not being on `homebrew`?\n\n(anyhow, I'm testing this now).",
    "created_at": "2022-06-23T09:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415544",
    "user": "dimpase"
}
```

Replying to [comment:4 mkoeppe]:
> Unfortunately, `gnulib` is not present on `homebrew` (https://repology.org/project/gnulib/versions), so we should not try to use it in the `bootstrap` phase... Of course we can just commit the generated file -- it probably does not change so often.

any reason for gnulib not being on `homebrew`?

(anyhow, I'm testing this now).



---

archive/issue_comments_415545.json:
```json
{
    "body": "Replying to [comment:7 dimpase]:\n\n> any reason for gnulib not being on `homebrew`?\n> \n> (anyhow, I'm testing this now).\n\nupstream says: just use git to get `gnulib`, as there is nothing to build.\nhttps://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html\n\nHmm, yes, we can in principle have `gnulib` installed as a git submodule...",
    "created_at": "2022-06-23T09:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415545",
    "user": "dimpase"
}
```

Replying to [comment:7 dimpase]:

> any reason for gnulib not being on `homebrew`?
> 
> (anyhow, I'm testing this now).

upstream says: just use git to get `gnulib`, as there is nothing to build.
https://lists.gnu.org/archive/html/bug-gnulib/2018-02/msg00041.html

Hmm, yes, we can in principle have `gnulib` installed as a git submodule...



---

archive/issue_comments_415546.json:
```json
{
    "body": "Replying to [comment:8 dimpase]:\n> upstream says: just use git to get `gnulib`, as there is nothing to build.\n\nThat's what I did, and I committed the result.",
    "created_at": "2022-06-25T18:14:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415546",
    "user": "mkoeppe"
}
```

Replying to [comment:8 dimpase]:
> upstream says: just use git to get `gnulib`, as there is nothing to build.

That's what I did, and I committed the result.



---

archive/issue_comments_415547.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-06-25T21:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415547",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415548.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-06-25T21:21:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415548",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_415549.json:
```json
{
    "body": "I tested this before the last 2 commits were added. Should they be tested with docker somehow?",
    "created_at": "2022-06-28T08:12:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415549",
    "user": "dimpase"
}
```

I tested this before the last 2 commits were added. Should they be tested with docker somehow?



---

archive/issue_comments_415550.json:
```json
{
    "body": "It ran successfully at https://github.com/mkoeppe/sage/actions/runs/2561994135",
    "created_at": "2022-06-28T18:10:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415550",
    "user": "mkoeppe"
}
```

It ran successfully at https://github.com/mkoeppe/sage/actions/runs/2561994135



---

archive/issue_comments_415551.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-06-28T18:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415551",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_415552.json:
```json
{
    "body": "ok, lgtm",
    "created_at": "2022-06-28T18:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415552",
    "user": "dimpase"
}
```

ok, lgtm



---

archive/issue_comments_415553.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-06-28T18:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415553",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_415554.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-07-01T20:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415554",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_415555.json:
```json
{
    "body": "When actually trying to use the generated confball I get (on OSX):\n\n```\nUsing cached file /Users/buildbot-sage/worker/sage_git/build/upstream/configure-4b0180ea3fe0842fd17ffa15afa79dc3b4bf2cd0.tar.gz\nconfig/install-sh: Skipping hardlink pointing to itself: config/install-sh\ntar: Error exit delayed from previous errors.\n```\n\nThe build seems to continue but skipping to untar a file is probably not good...",
    "created_at": "2022-07-01T20:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415555",
    "user": "vbraun"
}
```

When actually trying to use the generated confball I get (on OSX):

```
Using cached file /Users/buildbot-sage/worker/sage_git/build/upstream/configure-4b0180ea3fe0842fd17ffa15afa79dc3b4bf2cd0.tar.gz
config/install-sh: Skipping hardlink pointing to itself: config/install-sh
tar: Error exit delayed from previous errors.
```

The build seems to continue but skipping to untar a file is probably not good...



---

archive/issue_comments_415556.json:
```json
{
    "body": "`which tar`?",
    "created_at": "2022-07-01T21:11:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415556",
    "user": "mkoeppe"
}
```

`which tar`?



---

archive/issue_comments_415557.json:
```json
{
    "body": "Do use rdfind in this tree?",
    "created_at": "2022-07-01T21:18:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415557",
    "user": "mkoeppe"
}
```

Do use rdfind in this tree?



---

archive/issue_comments_415558.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-07-01T21:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415558",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_415559.json:
```json
{
    "body": "Can't reproduce without more detail but here's removing a duplication of `install-sh` as an argument to tar.",
    "created_at": "2022-07-01T21:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415559",
    "user": "mkoeppe"
}
```

Can't reproduce without more detail but here's removing a duplication of `install-sh` as an argument to tar.



---

archive/issue_comments_415560.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-07-01T21:22:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415560",
    "user": "mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_415561.json:
```json
{
    "body": "let me test this on macOS",
    "created_at": "2022-07-04T11:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415561",
    "user": "dimpase"
}
```

let me test this on macOS



---

archive/issue_comments_415562.json:
```json
{
    "body": "lgtm - running `./bootstrap -s` followed by `/bootstrap -d` works without warnings/errors.",
    "created_at": "2022-07-04T15:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415562",
    "user": "dimpase"
}
```

lgtm - running `./bootstrap -s` followed by `/bootstrap -d` works without warnings/errors.



---

archive/issue_comments_415563.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-07-04T15:27:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415563",
    "user": "dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_415564.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-07-04T15:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415564",
    "user": "mkoeppe"
}
```

Thanks!



---

archive/issue_comments_415565.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-07-09T22:33:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415565",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_415566.json:
```json
{
    "body": "Follow-up in #34152",
    "created_at": "2022-07-11T16:15:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29312",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29312#issuecomment-415566",
    "user": "mkoeppe"
}
```

Follow-up in #34152
