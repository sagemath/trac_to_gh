# Issue 18254: osx R spkg error: expected ',' or '}' before '__attribute__'

archive/issues_018017.json:
```json
{
    "body": "The sage-support discussion is here:  https://groups.google.com/forum/#!topic/sage-support/9m5N0KUqkWo\n\nI'm on OS X 10.10.3. I've removed homebrew from any part of the build. I've updated sage to the develop branch.\n\nThe error still persists: ([full output](http://www.google.com/url?q=http%3A%2F%2Fpaste.pound-python.org%2Fshow%2FCSFQbBf722doPeyrXxJi%2F&sa=D&sntz=1&usg=AFQjCNE3nLaYMBJtas9IBEsp7q23P8Odug))\n\n\n```\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o\nIn file included from /usr/include/Availability.h:153:0,\n                 from /usr/include/stdio.h:65,\n                 from ../../../../include/Rinternals.h:37,\n                 from ../../../include/Defn.h:80,\n                 from devQuartz.c:30:\n/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'\n   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,\n```\n\n\n\n\nI suspect this needs another patch to fix up inappropriate objective-c in the C code, similar to what was done for [dispatch/object.h](https://github.com/sagemath/sage/blob/master/build/pkgs/gcc/spkg-install#L77,L78), but I might be off base.\n\n**CC:**  @vbraun\n\n**Branch/Commit:** [3c5cd0f74446992a2b98f84c34043cfa181b68b4](https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4)\n\n**Reviewer:** John Palmieri, Volker Braun\n\n**Author:** Buck Evan\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18254\n\n",
    "closed_at": "2015-04-27T04:16:13Z",
    "created_at": "2015-04-20T02:24:35Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "osx R spkg error: expected ',' or '}' before '__attribute__'",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18254",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```
The sage-support discussion is here:  https://groups.google.com/forum/#!topic/sage-support/9m5N0KUqkWo

I'm on OS X 10.10.3. I've removed homebrew from any part of the build. I've updated sage to the develop branch.

The error still persists: ([full output](http://www.google.com/url?q=http%3A%2F%2Fpaste.pound-python.org%2Fshow%2FCSFQbBf722doPeyrXxJi%2F&sa=D&sntz=1&usg=AFQjCNE3nLaYMBJtas9IBEsp7q23P8Odug))


```
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o
In file included from /usr/include/Availability.h:153:0,
                 from /usr/include/stdio.h:65,
                 from ../../../../include/Rinternals.h:37,
                 from ../../../include/Defn.h:80,
                 from devQuartz.c:30:
/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'
   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,
```




I suspect this needs another patch to fix up inappropriate objective-c in the C code, similar to what was done for [dispatch/object.h](https://github.com/sagemath/sage/blob/master/build/pkgs/gcc/spkg-install#L77,L78), but I might be off base.

**CC:**  @vbraun

**Branch/Commit:** [3c5cd0f74446992a2b98f84c34043cfa181b68b4](https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4)

**Reviewer:** John Palmieri, Volker Braun

**Author:** Buck Evan

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/18254





---

archive/issue_comments_320577.json:
```json
{
    "body": "<a id='comment:1'></a>\nJust to make double-sure, I tried one more time with an essentially empty environment from the develop branch. I get the same error:\n\n```\n$ env\nPATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/texbin\nPWD=/Users/buck/trees/mine/sage\nHOME=/Users/buck\nSHLVL=1\n_=/usr/bin/env\n\n$ ./src/bin/sage-spkg r 2>&1 | tee r.log.3\nFound local metadata for r-3.1.2.p0\nFound local sources at /Users/buck/trees/mine/sage/upstream/r-3.1.2.tar.gz\nChecksum: 93809368e5735a630611633ac1fa99010020c5d6 vs 93809368e5735a630611633ac1fa99010020c5d6\nr-3.1.2.p0\n====================================================\nSetting up build directory for r-3.1.2.p0\nFinished set up\n****************************************************\nHost system:\nDarwin YELP-BUCK.lan 14.3.0 Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~5/RELEASE_X86_64 x86_64\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/Users/buck/trees/mine/sage/local/libexec/gcc/x86_64-apple-darwin14.3.0/4.9.2/lto-wrapper\nTarget: x86_64-apple-darwin14.3.0\nConfigured with: ../src/configure --prefix=/Users/buck/trees/mine/sage/local --with-local-prefix=/Users/buck/trees/mine/sage/local --with-gmp=/Users/buck/trees/mine/sage/local --with-mpfr=/Users/buck/trees/mine/sage/local --with-mpc=/Users/buck/trees/mine/sage/local --with-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm --without-isl --without-cloog  \nThread model: posix\ngcc version 4.9.2 (GCC) \n****************************************************\nCopying fake java and javac compiler on OS X\nConfiguring R without ATLAS for OS X\npatching file src/scripts/R.sh.in\n<snip>\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devPS.c -o devPS.o\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o\nIn file included from /usr/include/Availability.h:153:0,\n                 from /usr/include/stdio.h:65,\n                 from ../../../../include/Rinternals.h:37,\n                 from ../../../include/Defn.h:80,\n                 from devQuartz.c:30:\n/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'\n   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,\n                                         ^\ndevQuartz.c: In function 'RQuartz_Font':\ndevQuartz.c:646:13: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]\n             atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);\n             ^\ndevQuartz.c:648:17: warning: 'ATSFontFindFromPostScriptName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:820) [-Wdeprecated-declarations]\n                 atsFont = ATSFontFindFromPostScriptName(cfFontName, kATSOptionFlagsDefault);\n                 ^\ndevQuartz.c:675:17: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]\n                 atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);\n                 ^\ndevQuartz.c:676:17: warning: 'ATSFontFindFromPostScriptName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:820) [-Wdeprecated-declarations]\n                 if (!atsFont) atsFont = ATSFontFindFromPostScriptName(cfFontName, kATSOptionFlagsDefault);\n                 ^\ndevQuartz.c:682:25: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]\n                         atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);\n                         ^\ndevQuartz.c:688:29: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]\n                             atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);\n                             ^\ndevQuartz.c:696:25: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]\n                         atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);\n                         ^\ndevQuartz.c:715:5: warning: 'CGFontCreateWithPlatformFont' is deprecated (declared at /System/Library/Frameworks/CoreGraphics.framework/Headers/CGFont.h:61) [-Wdeprecated-declarations]\n     return CGFontCreateWithPlatformFont(&atsFont);\n     ^\ndevQuartz.c: In function 'RQuartz_Text':\ndevQuartz.c:997:5: warning: 'CGContextShowGlyphsWithAdvances' is deprecated (declared at /System/Library/Frameworks/CoreGraphics.framework/Headers/CGContext.h:1023) [-Wdeprecated-declarations]\n     CGContextShowGlyphsWithAdvances(ctx,glyphs, g_adv, len);\n     ^\nmake[5]: *** [devQuartz.o] Error 1\nmake[4]: *** [mksrc] Error 1\nmake[3]: *** [all] Error 2\nmake[2]: *** [R] Error 1\nmake[1]: *** [R] Error 1\nmake: *** [R] Error 1\nError building R.\n\nreal\t4m58.277s\nuser\t4m10.787s\nsys\t0m42.757s\n************************************************************************\nError installing package r-3.1.2.p0\n************************************************************************\nPlease email sage-devel (http://groups.google.com/group/sage-devel)\nexplaining the problem and including the relevant part of the log file\n  /Users/buck/trees/mine/sage/logs/pkgs/r-3.1.2.p0.log\nDescribe your computer, operating system, etc.\nIf you want to try to fix the problem yourself, *don't* just cd to\n/Users/buck/trees/mine/sage/local/var/tmp/sage/build/r-3.1.2.p0 and type 'make' or whatever is appropriate.\nInstead, the following commands setup all environment variables\ncorrectly and load a subshell for you to debug the error:\n  (cd '/Users/buck/trees/mine/sage/local/var/tmp/sage/build/r-3.1.2.p0' && '/Users/buck/trees/mine/sage/sage' --sh)\nWhen you are done debugging, you can type \"exit\" to leave the subshell.\n************************************************************************\n```",
    "created_at": "2015-04-20T02:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320577",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:1'></a>
Just to make double-sure, I tried one more time with an essentially empty environment from the develop branch. I get the same error:

```
$ env
PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/texbin
PWD=/Users/buck/trees/mine/sage
HOME=/Users/buck
SHLVL=1
_=/usr/bin/env

$ ./src/bin/sage-spkg r 2>&1 | tee r.log.3
Found local metadata for r-3.1.2.p0
Found local sources at /Users/buck/trees/mine/sage/upstream/r-3.1.2.tar.gz
Checksum: 93809368e5735a630611633ac1fa99010020c5d6 vs 93809368e5735a630611633ac1fa99010020c5d6
r-3.1.2.p0
====================================================
Setting up build directory for r-3.1.2.p0
Finished set up
****************************************************
Host system:
Darwin YELP-BUCK.lan 14.3.0 Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~5/RELEASE_X86_64 x86_64
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/Users/buck/trees/mine/sage/local/libexec/gcc/x86_64-apple-darwin14.3.0/4.9.2/lto-wrapper
Target: x86_64-apple-darwin14.3.0
Configured with: ../src/configure --prefix=/Users/buck/trees/mine/sage/local --with-local-prefix=/Users/buck/trees/mine/sage/local --with-gmp=/Users/buck/trees/mine/sage/local --with-mpfr=/Users/buck/trees/mine/sage/local --with-mpc=/Users/buck/trees/mine/sage/local --with-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm --without-isl --without-cloog  
Thread model: posix
gcc version 4.9.2 (GCC) 
****************************************************
Copying fake java and javac compiler on OS X
Configuring R without ATLAS for OS X
patching file src/scripts/R.sh.in
<snip>
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devPS.c -o devPS.o
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o
In file included from /usr/include/Availability.h:153:0,
                 from /usr/include/stdio.h:65,
                 from ../../../../include/Rinternals.h:37,
                 from ../../../include/Defn.h:80,
                 from devQuartz.c:30:
/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'
   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,
                                         ^
devQuartz.c: In function 'RQuartz_Font':
devQuartz.c:646:13: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]
             atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);
             ^
devQuartz.c:648:17: warning: 'ATSFontFindFromPostScriptName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:820) [-Wdeprecated-declarations]
                 atsFont = ATSFontFindFromPostScriptName(cfFontName, kATSOptionFlagsDefault);
                 ^
devQuartz.c:675:17: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]
                 atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);
                 ^
devQuartz.c:676:17: warning: 'ATSFontFindFromPostScriptName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:820) [-Wdeprecated-declarations]
                 if (!atsFont) atsFont = ATSFontFindFromPostScriptName(cfFontName, kATSOptionFlagsDefault);
                 ^
devQuartz.c:682:25: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]
                         atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);
                         ^
devQuartz.c:688:29: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]
                             atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);
                             ^
devQuartz.c:696:25: warning: 'ATSFontFindFromName' is deprecated (declared at /System/Library/Frameworks/ApplicationServices.framework/Frameworks/ATS.framework/Headers/ATSFont.h:803) [-Wdeprecated-declarations]
                         atsFont = ATSFontFindFromName(cfFontName, kATSOptionFlagsDefault);
                         ^
devQuartz.c:715:5: warning: 'CGFontCreateWithPlatformFont' is deprecated (declared at /System/Library/Frameworks/CoreGraphics.framework/Headers/CGFont.h:61) [-Wdeprecated-declarations]
     return CGFontCreateWithPlatformFont(&atsFont);
     ^
devQuartz.c: In function 'RQuartz_Text':
devQuartz.c:997:5: warning: 'CGContextShowGlyphsWithAdvances' is deprecated (declared at /System/Library/Frameworks/CoreGraphics.framework/Headers/CGContext.h:1023) [-Wdeprecated-declarations]
     CGContextShowGlyphsWithAdvances(ctx,glyphs, g_adv, len);
     ^
make[5]: *** [devQuartz.o] Error 1
make[4]: *** [mksrc] Error 1
make[3]: *** [all] Error 2
make[2]: *** [R] Error 1
make[1]: *** [R] Error 1
make: *** [R] Error 1
Error building R.

real	4m58.277s
user	4m10.787s
sys	0m42.757s
************************************************************************
Error installing package r-3.1.2.p0
************************************************************************
Please email sage-devel (http://groups.google.com/group/sage-devel)
explaining the problem and including the relevant part of the log file
  /Users/buck/trees/mine/sage/logs/pkgs/r-3.1.2.p0.log
Describe your computer, operating system, etc.
If you want to try to fix the problem yourself, *don't* just cd to
/Users/buck/trees/mine/sage/local/var/tmp/sage/build/r-3.1.2.p0 and type 'make' or whatever is appropriate.
Instead, the following commands setup all environment variables
correctly and load a subshell for you to debug the error:
  (cd '/Users/buck/trees/mine/sage/local/var/tmp/sage/build/r-3.1.2.p0' && '/Users/buck/trees/mine/sage/sage' --sh)
When you are done debugging, you can type "exit" to leave the subshell.
************************************************************************
```



---

archive/issue_comments_320578.json:
```json
{
    "body": "<a id='comment:2'></a>\nThose are warnings, not errors. The buildbot log shows the same warnings ( http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20full/builds/42/steps/compile_1/logs/r-project). Do you have `-Werror` or something like that in CFLAGS/CXXFLAGS/...? This looks like a problem with your environment variables.",
    "created_at": "2015-04-20T03:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320578",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>
Those are warnings, not errors. The buildbot log shows the same warnings ( http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20full/builds/42/steps/compile_1/logs/r-project). Do you have `-Werror` or something like that in CFLAGS/CXXFLAGS/...? This looks like a problem with your environment variables.



---

archive/issue_comments_320579.json:
```json
{
    "body": "<a id='comment:3'></a>\n`@`vbraun: I showed all my environment above:\n\n```\n$ env\nPATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/texbin\nPWD=/Users/buck/trees/mine/sage\nHOME=/Users/buck\nSHLVL=1\n_=/usr/bin/env\n```\n\nThere's definitely an error:\n\n```\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o\nIn file included from /usr/include/Availability.h:153:0,\n                 from /usr/include/stdio.h:65,\n                 from ../../../../include/Rinternals.h:37,\n                 from ../../../include/Defn.h:80,\n                 from devQuartz.c:30:\n/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41:\nerror: expected ',' or '}' before '__attribute__'\n   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,\n                                         ^\n...\nError installing package r-3.1.2.p0\n```",
    "created_at": "2015-04-20T03:16:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320579",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:3'></a>
`@`vbraun: I showed all my environment above:

```
$ env
PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/opt/X11/bin:/usr/texbin
PWD=/Users/buck/trees/mine/sage
HOME=/Users/buck
SHLVL=1
_=/usr/bin/env
```

There's definitely an error:

```
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o
In file included from /usr/include/Availability.h:153:0,
                 from /usr/include/stdio.h:65,
                 from ../../../../include/Rinternals.h:37,
                 from ../../../include/Defn.h:80,
                 from devQuartz.c:30:
/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41:
error: expected ',' or '}' before '__attribute__'
   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,
                                         ^
...
Error installing package r-3.1.2.p0
```



---

archive/issue_comments_320580.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe error I've pointed out does not show in your buildbot log.",
    "created_at": "2015-04-20T03:20:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320580",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:4'></a>
The error I've pointed out does not show in your buildbot log.



---

archive/issue_comments_320581.json:
```json
{
    "body": "<a id='comment:5'></a>\nOn osx 10.10, `__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0)` expands to `__attribute__((availability(macosx,introduced=10.10)))`, which helps explain the error message..\n\nI expect the difference is that your buildbot is not 10.10.",
    "created_at": "2015-04-20T03:34:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320581",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:5'></a>
On osx 10.10, `__OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0)` expands to `__attribute__((availability(macosx,introduced=10.10)))`, which helps explain the error message..

I expect the difference is that your buildbot is not 10.10.



---

archive/issue_comments_320582.json:
```json
{
    "body": "<a id='comment:6'></a>\nI'm guessing that this has to do with Xcode, and in particular the fact that its most recent version is broken.",
    "created_at": "2015-04-20T05:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320582",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:6'></a>
I'm guessing that this has to do with Xcode, and in particular the fact that its most recent version is broken.



---

archive/issue_comments_320583.json:
```json
{
    "body": "<a id='comment:7'></a>\nSage sets `MACOSX_DEPLOYMENT_TARGET=10.9` on 10.10 to work around Apple's broken toolchain so the conditional should be false. Though the error is about what is **before** the `__OSX_AVAILABLE_STARTING`. What are the relevant lines in your Availability.h?\n\nI thought we had established that he is using Xcode < 6.3 on the mailinglist? With Xcode 6.3 he should't have gotten this far, the compilation pretty much dies immediately.",
    "created_at": "2015-04-20T12:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320583",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
Sage sets `MACOSX_DEPLOYMENT_TARGET=10.9` on 10.10 to work around Apple's broken toolchain so the conditional should be false. Though the error is about what is **before** the `__OSX_AVAILABLE_STARTING`. What are the relevant lines in your Availability.h?

I thought we had established that he is using Xcode < 6.3 on the mailinglist? With Xcode 6.3 he should't have gotten this far, the compilation pretty much dies immediately.



---

archive/issue_comments_320584.json:
```json
{
    "body": "<a id='comment:8'></a>\nPS: The buildbot most certainly is on OSX 10.10.3",
    "created_at": "2015-04-20T12:52:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320584",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:8'></a>
PS: The buildbot most certainly is on OSX 10.10.3



---

archive/issue_comments_320585.json:
```json
{
    "body": "<a id='comment:9'></a>\nOn a machine on which I upgraded Xcode, I run into the same problem, and that machine built Sage fine before the upgrade.",
    "created_at": "2015-04-20T14:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320585",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:9'></a>
On a machine on which I upgraded Xcode, I run into the same problem, and that machine built Sage fine before the upgrade.



---

archive/issue_comments_320586.json:
```json
{
    "body": "<a id='comment:10'></a>\nHere's the gcc version you asked for:\n\n```\n$ which gcc\n/usr/bin/gcc\n\n$ gcc --version\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 6.1.0 (clang-602.0.49) (based on LLVM 3.6.0svn)\nTarget: x86_64-apple-darwin14.3.0\nThread model: posix\n```\n\nThe XCode GUI reports \"Version 6.3 (6D570)\".",
    "created_at": "2015-04-20T15:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320586",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:10'></a>
Here's the gcc version you asked for:

```
$ which gcc
/usr/bin/gcc

$ gcc --version
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 6.1.0 (clang-602.0.49) (based on LLVM 3.6.0svn)
Target: x86_64-apple-darwin14.3.0
Thread model: posix
```

The XCode GUI reports "Version 6.3 (6D570)".



---

archive/issue_comments_320587.json:
```json
{
    "body": "Attachment [Availability.h](tarball://root/attachments/some-uuid/ticket18254/Availability.h) by buck created at 2015-04-20 15:43:46\n\nAvailability.h from Xcode 6.3",
    "created_at": "2015-04-20T15:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320587",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Attachment [Availability.h](tarball://root/attachments/some-uuid/ticket18254/Availability.h) by buck created at 2015-04-20 15:43:46

Availability.h from Xcode 6.3



---

archive/issue_comments_320588.json:
```json
{
    "body": "Attachment [AvailabilityInternal.h](tarball://root/attachments/some-uuid/ticket18254/AvailabilityInternal.h) by buck created at 2015-04-20 15:44:09\n\nAvailabilityInternal.h from Xcode 6.3",
    "created_at": "2015-04-20T15:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320588",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Attachment [AvailabilityInternal.h](tarball://root/attachments/some-uuid/ticket18254/AvailabilityInternal.h) by buck created at 2015-04-20 15:44:09

AvailabilityInternal.h from Xcode 6.3



---

archive/issue_comments_320589.json:
```json
{
    "body": "<a id='comment:11'></a>\nI've attached the entire files just in case I've gotten it wrong, but I believe these are the relevant lines.\n\nAvailability.h:\n\n```\n162 #elif defined(__MAC_OS_X_VERSION_MIN_REQUIRED)\n163     #define __OSX_AVAILABLE_STARTING(_osx, _ios) __AVAILABILITY_INTERNAL##_osx\n```\n\nAvailabilityInternal.h:\n\n```\n5513 #define __AVAILABILITY_INTERNAL__MAC_10_10\n                  __attribute__((availability(macosx,introduced=10.10)))\n```",
    "created_at": "2015-04-20T15:47:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320589",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:11'></a>
I've attached the entire files just in case I've gotten it wrong, but I believe these are the relevant lines.

Availability.h:

```
162 #elif defined(__MAC_OS_X_VERSION_MIN_REQUIRED)
163     #define __OSX_AVAILABLE_STARTING(_osx, _ios) __AVAILABILITY_INTERNAL##_osx
```

AvailabilityInternal.h:

```
5513 #define __AVAILABILITY_INTERNAL__MAC_10_10
                  __attribute__((availability(macosx,introduced=10.10)))
```



---

archive/issue_comments_320590.json:
```json
{
    "body": "<a id='comment:12'></a>\nXcode 6.3 isn't going to work (#18156). Propose to close as duplicate.",
    "created_at": "2015-04-20T15:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320590",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
Xcode 6.3 isn't going to work (#18156). Propose to close as duplicate.



---

archive/issue_events_058625.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-20T15:53:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18254#event-58625"
}
```



---

archive/issue_comments_320591.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2015-04-20T15:53:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320591",
    "user": "https://github.com/vbraun"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_320592.json:
```json
{
    "body": "<a id='comment:14'></a>\nWhile both these issues may be caused by xcode-6.3, they look like separate bugs, separate pieces of work to me.\n\nI upgraded my Xcode at the recommendation of one of the guys at sage days :(\nShall I downgrade to 6.2?",
    "created_at": "2015-04-20T16:08:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320592",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:14'></a>
While both these issues may be caused by xcode-6.3, they look like separate bugs, separate pieces of work to me.

I upgraded my Xcode at the recommendation of one of the guys at sage days :(
Shall I downgrade to 6.2?



---

archive/issue_comments_320593.json:
```json
{
    "body": "<a id='comment:15'></a>\nyes, downgrade to 6.2",
    "created_at": "2015-04-20T16:13:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320593",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>
yes, downgrade to 6.2



---

archive/issue_comments_320594.json:
```json
{
    "body": "<a id='comment:16'></a>\nI've downgraded to 6.2, with no change in behavior D:\n\n```\n$ gcc --version\nConfigured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1\nApple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn)\nTarget: x86_64-apple-darwin14.3.0\nThread model: posix\n```\n\nThe GUI reports \"Version 6.2 (6C131e)\".\n\nThe error looks exactly the same to me, but here it is, for completeness:\n\n```\n$ ./src/bin/sage-spkg\nFound local metadata for r-3.1.2.p0\nFound local sources at /Users/buck/trees/mine/sage/upstream/r-3.1.2.tar.gz\nChecksum: 93809368e5735a630611633ac1fa99010020c5d6 vs 93809368e5735a630611633ac1fa99010020c5d6\nr-3.1.2.p0\n====================================================\nSetting up build directory for r-3.1.2.p0\nFinished set up\n****************************************************\nHost system:\nDarwin MacBookPro-7831C1F266DE.local 14.3.0 Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~5/RELEASE_X86_64 x86_64\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/Users/buck/trees/mine/sage/local/libexec/gcc/x86_64-apple-darwin14.3.0/4.9.2/lto-wrapper\nTarget: x86_64-apple-darwin14.3.0\nConfigured with: ../src/configure --prefix=/Users/buck/trees/mine/sage/local --with-local-prefix=/Users/buck/trees/mine/sage/local --with-gmp=/Users\n/buck/trees/mine/sage/local --with-mpfr=/Users/buck/trees/mine/sage/local --with-mpc=/Users/buck/trees/mine/sage/local --with-system-zlib --disable-\nmultilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm --without-isl --without-cloog\nThread model: posix\ngcc version 4.9.2 (GCC)\n****************************************************\nCopying fake java and javac compiler on OS X\nConfiguring R without ATLAS for OS X\npatching file src/scripts/R.sh.in\npatching file configure\n<snip>\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -\ng -O2   -c devQuartz.c -o devQuartz.o\nIn file included from /usr/include/Availability.h:153:0,\n                 from /usr/include/stdio.h:65,\n                 from ../../../../include/Rinternals.h:37,\n                 from ../../../include/Defn.h:80,\n                 from devQuartz.c:30:\n/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attr\nibute__'\n   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,\n                                         ^\n<snip>\n```",
    "created_at": "2015-04-20T18:55:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320594",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:16'></a>
I've downgraded to 6.2, with no change in behavior D:

```
$ gcc --version
Configured with: --prefix=/Applications/Xcode.app/Contents/Developer/usr --with-gxx-include-dir=/usr/include/c++/4.2.1
Apple LLVM version 6.0 (clang-600.0.57) (based on LLVM 3.5svn)
Target: x86_64-apple-darwin14.3.0
Thread model: posix
```

The GUI reports "Version 6.2 (6C131e)".

The error looks exactly the same to me, but here it is, for completeness:

```
$ ./src/bin/sage-spkg
Found local metadata for r-3.1.2.p0
Found local sources at /Users/buck/trees/mine/sage/upstream/r-3.1.2.tar.gz
Checksum: 93809368e5735a630611633ac1fa99010020c5d6 vs 93809368e5735a630611633ac1fa99010020c5d6
r-3.1.2.p0
====================================================
Setting up build directory for r-3.1.2.p0
Finished set up
****************************************************
Host system:
Darwin MacBookPro-7831C1F266DE.local 14.3.0 Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~5/RELEASE_X86_64 x86_64
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/Users/buck/trees/mine/sage/local/libexec/gcc/x86_64-apple-darwin14.3.0/4.9.2/lto-wrapper
Target: x86_64-apple-darwin14.3.0
Configured with: ../src/configure --prefix=/Users/buck/trees/mine/sage/local --with-local-prefix=/Users/buck/trees/mine/sage/local --with-gmp=/Users
/buck/trees/mine/sage/local --with-mpfr=/Users/buck/trees/mine/sage/local --with-mpc=/Users/buck/trees/mine/sage/local --with-system-zlib --disable-
multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm --without-isl --without-cloog
Thread model: posix
gcc version 4.9.2 (GCC)
****************************************************
Copying fake java and javac compiler on OS X
Configuring R without ATLAS for OS X
patching file src/scripts/R.sh.in
patching file configure
<snip>
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib     -fPIC  -
g -O2   -c devQuartz.c -o devQuartz.o
In file included from /usr/include/Availability.h:153:0,
                 from /usr/include/stdio.h:65,
                 from ../../../../include/Rinternals.h:37,
                 from ../../../include/Defn.h:80,
                 from devQuartz.c:30:
/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attr
ibute__'
   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,
                                         ^
<snip>
```



---

archive/issue_comments_320595.json:
```json
{
    "body": "<a id='comment:17'></a>\nDid you compile from scratch (make distclean && make)?",
    "created_at": "2015-04-20T19:32:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320595",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:17'></a>
Did you compile from scratch (make distclean && make)?



---

archive/issue_comments_320596.json:
```json
{
    "body": "<a id='comment:18'></a>\nI know you weren't asking me, but a further data point: I did not compile from scratch. On one machine, I had updated to OS X 10.10.3 and the most recent Xcode, and I got this error. On a second machine, I just updated to OS X 10.10.3 but did not update Xcode, and I was able to install R (with `sage -f r`) successfully. Now on that same machine I'm also trying a build from scratch, but from the experiments so far, it really looks like a manifestation of a problem with the most recent Xcode.\n\nNote that I have not yet tried upgrading Xcode and then downgrading it.",
    "created_at": "2015-04-20T20:13:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320596",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:18'></a>
I know you weren't asking me, but a further data point: I did not compile from scratch. On one machine, I had updated to OS X 10.10.3 and the most recent Xcode, and I got this error. On a second machine, I just updated to OS X 10.10.3 but did not update Xcode, and I was able to install R (with `sage -f r`) successfully. Now on that same machine I'm also trying a build from scratch, but from the experiments so far, it really looks like a manifestation of a problem with the most recent Xcode.

Note that I have not yet tried upgrading Xcode and then downgrading it.



---

archive/issue_comments_320597.json:
```json
{
    "body": "<a id='comment:19'></a>\nI've made distclean, and still get the same dang behavior D:\n\n```\nFound local metadata for r-3.1.2.p0\nFound local sources at /Users/buck/trees/mine/sage/upstream/r-3.1.2.tar.gz\nChecksum: 93809368e5735a630611633ac1fa99010020c5d6 vs 93809368e5735a630611633ac1fa99010020c5d6\nr-3.1.2.p0\n====================================================\nSetting up build directory for r-3.1.2.p0\nFinished set up\n****************************************************\nHost system:\nDarwin 140-sfoeng50-54.clients.corp.yelpcorp.com 14.3.0 Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~\n5/RELEASE_X86_64 x86_64\n****************************************************\nC compiler: gcc\nC compiler version:\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/Users/buck/trees/mine/sage/local/libexec/gcc/x86_64-apple-darwin14.3.0/4.9.2/lto-wrapper\nTarget: x86_64-apple-darwin14.3.0\nConfigured with: ../src/configure --prefix=/Users/buck/trees/mine/sage/local --with-local-prefix=/Users/buck/trees/mine/sage/local --wit\nh-gmp=/Users/buck/trees/mine/sage/local --with-mpfr=/Users/buck/trees/mine/sage/local --with-mpc=/Users/buck/trees/mine/sage/local --wit\nh-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm --without-isl --without-cloog\nThread model: posix\ngcc version 4.9.2 (GCC)\n****************************************************\nCopying fake java and javac compiler on OS X\nConfiguring R without ATLAS for OS X\n<snip>\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib\n    -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o\nIn file included from /usr/include/Availability.h:153:0,\n                 from /usr/include/stdio.h:65,\n                 from ../../../../include/Rinternals.h:37,\n                 from ../../../include/Defn.h:80,\n                 from devQuartz.c:30:\n/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: \nerror: expected ',' or '}' before '__attribute__'\n   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,\n```",
    "created_at": "2015-04-20T22:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320597",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:19'></a>
I've made distclean, and still get the same dang behavior D:

```
Found local metadata for r-3.1.2.p0
Found local sources at /Users/buck/trees/mine/sage/upstream/r-3.1.2.tar.gz
Checksum: 93809368e5735a630611633ac1fa99010020c5d6 vs 93809368e5735a630611633ac1fa99010020c5d6
r-3.1.2.p0
====================================================
Setting up build directory for r-3.1.2.p0
Finished set up
****************************************************
Host system:
Darwin 140-sfoeng50-54.clients.corp.yelpcorp.com 14.3.0 Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~
5/RELEASE_X86_64 x86_64
****************************************************
C compiler: gcc
C compiler version:
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/Users/buck/trees/mine/sage/local/libexec/gcc/x86_64-apple-darwin14.3.0/4.9.2/lto-wrapper
Target: x86_64-apple-darwin14.3.0
Configured with: ../src/configure --prefix=/Users/buck/trees/mine/sage/local --with-local-prefix=/Users/buck/trees/mine/sage/local --wit
h-gmp=/Users/buck/trees/mine/sage/local --with-mpfr=/Users/buck/trees/mine/sage/local --with-mpc=/Users/buck/trees/mine/sage/local --wit
h-system-zlib --disable-multilib --disable-nls --enable-languages=c,c++,fortran --disable-libitm --without-isl --without-cloog
Thread model: posix
gcc version 4.9.2 (GCC)
****************************************************
Copying fake java and javac compiler on OS X
Configuring R without ATLAS for OS X
<snip>
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib
    -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o
In file included from /usr/include/Availability.h:153:0,
                 from /usr/include/stdio.h:65,
                 from ../../../../include/Rinternals.h:37,
                 from ../../../include/Defn.h:80,
                 from devQuartz.c:30:
/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: 
error: expected ',' or '}' before '__attribute__'
   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,
```



---

archive/issue_comments_320598.json:
```json
{
    "body": "<a id='comment:20'></a>\nWhereas I downloaded a fresh 6.7.beta1 tarball and built it successfully on the machine running OS X 10.10.3 and Xcode 6.2. On another machine on which I've installed Xcode 6.3, I may try downgrading that to see if I can build there.",
    "created_at": "2015-04-20T22:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320598",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:20'></a>
Whereas I downloaded a fresh 6.7.beta1 tarball and built it successfully on the machine running OS X 10.10.3 and Xcode 6.2. On another machine on which I've installed Xcode 6.3, I may try downgrading that to see if I can build there.



---

archive/issue_comments_320599.json:
```json
{
    "body": "<a id='comment:21'></a>\nI asked gcc for an expansion of the file in question and got this:\n\n```\n# 309 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\" 3\nenum {\n  kFSEventStreamEventFlagNone = 0x00000000,\n# 330 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\" 3\n  kFSEventStreamEventFlagMustScanSubDirs = 0x00000001,\n# 345 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\" 3\n  kFSEventStreamEventFlagUserDropped = 0x00000002,\n<snip>\n  kFSEventStreamEventFlagItemIsSymlink = 0x00040000,\n  kFSEventStreamEventFlagOwnEvent = 0x00080000,\n  kFSEventStreamEventFlagItemIsHardlink __attribute__((weak_import)) = 0x00100000,\n  kFSEventStreamEventFlagItemIsLastHardlink __attribute__((weak_import)) = 0x00200000,\n};\n```\n\n`@`jhpalmieri Show me what you get for this command?\n\n`gcc -E /System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h | grep kFSEventStreamEventFlagNone -B20 -A150 | grep -v '^$' | sed -n '/enum {/,/}/p'`",
    "created_at": "2015-04-20T22:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320599",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:21'></a>
I asked gcc for an expansion of the file in question and got this:

```
# 309 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h" 3
enum {
  kFSEventStreamEventFlagNone = 0x00000000,
# 330 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h" 3
  kFSEventStreamEventFlagMustScanSubDirs = 0x00000001,
# 345 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h" 3
  kFSEventStreamEventFlagUserDropped = 0x00000002,
<snip>
  kFSEventStreamEventFlagItemIsSymlink = 0x00040000,
  kFSEventStreamEventFlagOwnEvent = 0x00080000,
  kFSEventStreamEventFlagItemIsHardlink __attribute__((weak_import)) = 0x00100000,
  kFSEventStreamEventFlagItemIsLastHardlink __attribute__((weak_import)) = 0x00200000,
};
```

`@`jhpalmieri Show me what you get for this command?

`gcc -E /System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h | grep kFSEventStreamEventFlagNone -B20 -A150 | grep -v '^$' | sed -n '/enum {/,/}/p'`



---

archive/issue_comments_320600.json:
```json
{
    "body": "<a id='comment:22'></a>\nUnsetting `MACOSX_DEPLOYMENT_TARGET` makes the .o file build fine...\n\nReproduction procedure:\n\n```\ncd 'local/var/tmp/sage/build/r-3.1.2.p0' && '../../../../../../sage' --sh\ncd src/src/library/grDevices/src\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o\n#syntax error explosion\nenv | grep MACOSX\n#MACOSX_DEPLOYMENT_TARGET=10.9\nunset MACOSX_DEPLOYMENT_TARGET\nenv | grep MACOSX\n#no output\ngcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o\n#several warnings, but no error\n```",
    "created_at": "2015-04-20T23:45:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320600",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:22'></a>
Unsetting `MACOSX_DEPLOYMENT_TARGET` makes the .o file build fine...

Reproduction procedure:

```
cd 'local/var/tmp/sage/build/r-3.1.2.p0' && '../../../../../../sage' --sh
cd src/src/library/grDevices/src
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o
#syntax error explosion
env | grep MACOSX
#MACOSX_DEPLOYMENT_TARGET=10.9
unset MACOSX_DEPLOYMENT_TARGET
env | grep MACOSX
#no output
gcc -std=gnu99 -I../../../../include -DNDEBUG -I../../../include -I../../../../src/include -DHAVE_CONFIG_H -I../../../../src/extra/zlib -fPIC  -g -O2   -c devQuartz.c -o devQuartz.o
#several warnings, but no error
```



---

archive/issue_comments_320601.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [buck](#comment%3A21):\n> `@`jhpalmieri Show me what you get for this command?\n> \n> `gcc -E /System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h | grep kFSEventStreamEventFlagNone -B20 -A150 | grep -v '^$' | sed -n '/enum {/,/}/p'`\n\n\n```\nenum {\n  kFSEventStreamEventFlagNone = 0x00000000,\n# 330 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\"\n  kFSEventStreamEventFlagMustScanSubDirs = 0x00000001,\n# 345 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\"\n  kFSEventStreamEventFlagUserDropped = 0x00000002,\n  kFSEventStreamEventFlagKernelDropped = 0x00000004,\n  kFSEventStreamEventFlagEventIdsWrapped = 0x00000008,\n# 367 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\"\n  kFSEventStreamEventFlagHistoryDone = 0x00000010,\n# 380 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\"\n  kFSEventStreamEventFlagRootChanged = 0x00000020,\n# 395 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\"\n  kFSEventStreamEventFlagMount = 0x00000040,\n# 408 \"/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h\"\n  kFSEventStreamEventFlagUnmount = 0x00000080,\n  kFSEventStreamEventFlagItemCreated __attribute__((availability(macosx,introduced=10.7))) = 0x00000100,\n  kFSEventStreamEventFlagItemRemoved __attribute__((availability(macosx,introduced=10.7))) = 0x00000200,\n  kFSEventStreamEventFlagItemInodeMetaMod __attribute__((availability(macosx,introduced=10.7))) = 0x00000400,\n  kFSEventStreamEventFlagItemRenamed __attribute__((availability(macosx,introduced=10.7))) = 0x00000800,\n  kFSEventStreamEventFlagItemModified __attribute__((availability(macosx,introduced=10.7))) = 0x00001000,\n  kFSEventStreamEventFlagItemFinderInfoMod __attribute__((availability(macosx,introduced=10.7))) = 0x00002000,\n  kFSEventStreamEventFlagItemChangeOwner __attribute__((availability(macosx,introduced=10.7))) = 0x00004000,\n  kFSEventStreamEventFlagItemXattrMod __attribute__((availability(macosx,introduced=10.7))) = 0x00008000,\n  kFSEventStreamEventFlagItemIsFile __attribute__((availability(macosx,introduced=10.7))) = 0x00010000,\n  kFSEventStreamEventFlagItemIsDir __attribute__((availability(macosx,introduced=10.7))) = 0x00020000,\n  kFSEventStreamEventFlagItemIsSymlink __attribute__((availability(macosx,introduced=10.7))) = 0x00040000,\n  kFSEventStreamEventFlagOwnEvent __attribute__((availability(macosx,introduced=10.9))) = 0x00080000\n};\nenum {\n    kFSEventStreamEventIdSinceNow = 0xFFFFFFFFFFFFFFFFULL\n};\n```",
    "created_at": "2015-04-21T00:08:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320601",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'></a>
Replying to [buck](#comment%3A21):
> `@`jhpalmieri Show me what you get for this command?
> 
> `gcc -E /System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h | grep kFSEventStreamEventFlagNone -B20 -A150 | grep -v '^$' | sed -n '/enum {/,/}/p'`


```
enum {
  kFSEventStreamEventFlagNone = 0x00000000,
# 330 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h"
  kFSEventStreamEventFlagMustScanSubDirs = 0x00000001,
# 345 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h"
  kFSEventStreamEventFlagUserDropped = 0x00000002,
  kFSEventStreamEventFlagKernelDropped = 0x00000004,
  kFSEventStreamEventFlagEventIdsWrapped = 0x00000008,
# 367 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h"
  kFSEventStreamEventFlagHistoryDone = 0x00000010,
# 380 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h"
  kFSEventStreamEventFlagRootChanged = 0x00000020,
# 395 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h"
  kFSEventStreamEventFlagMount = 0x00000040,
# 408 "/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h"
  kFSEventStreamEventFlagUnmount = 0x00000080,
  kFSEventStreamEventFlagItemCreated __attribute__((availability(macosx,introduced=10.7))) = 0x00000100,
  kFSEventStreamEventFlagItemRemoved __attribute__((availability(macosx,introduced=10.7))) = 0x00000200,
  kFSEventStreamEventFlagItemInodeMetaMod __attribute__((availability(macosx,introduced=10.7))) = 0x00000400,
  kFSEventStreamEventFlagItemRenamed __attribute__((availability(macosx,introduced=10.7))) = 0x00000800,
  kFSEventStreamEventFlagItemModified __attribute__((availability(macosx,introduced=10.7))) = 0x00001000,
  kFSEventStreamEventFlagItemFinderInfoMod __attribute__((availability(macosx,introduced=10.7))) = 0x00002000,
  kFSEventStreamEventFlagItemChangeOwner __attribute__((availability(macosx,introduced=10.7))) = 0x00004000,
  kFSEventStreamEventFlagItemXattrMod __attribute__((availability(macosx,introduced=10.7))) = 0x00008000,
  kFSEventStreamEventFlagItemIsFile __attribute__((availability(macosx,introduced=10.7))) = 0x00010000,
  kFSEventStreamEventFlagItemIsDir __attribute__((availability(macosx,introduced=10.7))) = 0x00020000,
  kFSEventStreamEventFlagItemIsSymlink __attribute__((availability(macosx,introduced=10.7))) = 0x00040000,
  kFSEventStreamEventFlagOwnEvent __attribute__((availability(macosx,introduced=10.9))) = 0x00080000
};
enum {
    kFSEventStreamEventIdSinceNow = 0xFFFFFFFFFFFFFFFFULL
};
```



---

archive/issue_comments_320602.json:
```json
{
    "body": "<a id='comment:24'></a>\nReplying to [jhpalmieri](#comment%3A23):\n> Replying to [buck](#comment%3A21):\n> > `@`jhpalmieri Show me what you get for this command?\n> > \n> > `gcc -E /System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h | grep kFSEventStreamEventFlagNone -B20 -A150 | grep -v '^$' | sed -n '/enum {/,/}/p'`\n\n> {{{\n> enum {\n>   kFSEventStreamEventFlagOwnEvent __attribute__((availability(macosx,introduced=10.9))) = 0x00080000\n> };\n> }}}\n\n\nThis looks entirely different from mine. Describe this environment for me? It looks like 10.9.",
    "created_at": "2015-04-21T00:13:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320602",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:24'></a>
Replying to [jhpalmieri](#comment%3A23):
> Replying to [buck](#comment%3A21):
> > `@`jhpalmieri Show me what you get for this command?
> > 
> > `gcc -E /System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h | grep kFSEventStreamEventFlagNone -B20 -A150 | grep -v '^$' | sed -n '/enum {/,/}/p'`

> {{{
> enum {
>   kFSEventStreamEventFlagOwnEvent __attribute__((availability(macosx,introduced=10.9))) = 0x00080000
> };
> }}}


This looks entirely different from mine. Describe this environment for me? It looks like 10.9.



---

archive/issue_comments_320603.json:
```json
{
    "body": "<a id='comment:25'></a>\nIt is running 10.10, according to \"About my Mac\" and `uname`:\n\n```\n$ uname -v\nDarwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~5/RELEASE_X86_64\n```\nI have Xcode 6.2. No homebrew or anything similar. What else would you like to know?",
    "created_at": "2015-04-21T01:08:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320603",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:25'></a>
It is running 10.10, according to "About my Mac" and `uname`:

```
$ uname -v
Darwin Kernel Version 14.3.0: Mon Mar 23 11:59:05 PDT 2015; root:xnu-2782.20.48~5/RELEASE_X86_64
```
I have Xcode 6.2. No homebrew or anything similar. What else would you like to know?



---

archive/issue_comments_320604.json:
```json
{
    "body": "<a id='comment:26'></a>\nDo you have Xcode installed, or just the command line tools? Here's what happened on one machine:\n\n- I had Xcode 6.3 installed. Sage would not build and I saw the above error.\n- I downloaded the older version of the command-line tools, installed it, and tried again. Still no luck.\n- Then I deleted the Xcode app and things now work.\n\nSo try deleting the Xcode app and see if that helps.",
    "created_at": "2015-04-21T05:27:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320604",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>
Do you have Xcode installed, or just the command line tools? Here's what happened on one machine:

- I had Xcode 6.3 installed. Sage would not build and I saw the above error.
- I downloaded the older version of the command-line tools, installed it, and tried again. Still no luck.
- Then I deleted the Xcode app and things now work.

So try deleting the Xcode app and see if that helps.



---

archive/issue_comments_320605.json:
```json
{
    "body": "<a id='comment:27'></a>\nAlso note that xcode and clt (command line tools) are separate packages and you can easily have different versions installed...",
    "created_at": "2015-04-21T12:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320605",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:27'></a>
Also note that xcode and clt (command line tools) are separate packages and you can easily have different versions installed...



---

archive/issue_comments_320606.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [vbraun](#comment%3A27):\n> Also note that xcode and clt (command line tools) are separate packages and you can easily have different versions installed...\n\n\nAlthough in my case, it seems that there is some shadowing (if that is the right word) if you have Xcode 6.3 and an earlier version of the command line tools.",
    "created_at": "2015-04-21T16:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320606",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:28'></a>
Replying to [vbraun](#comment%3A27):
> Also note that xcode and clt (command line tools) are separate packages and you can easily have different versions installed...


Although in my case, it seems that there is some shadowing (if that is the right word) if you have Xcode 6.3 and an earlier version of the command line tools.



---

archive/issue_comments_320607.json:
```json
{
    "body": "<a id='comment:29'></a>\n`@`vbraun: Where's the ticket that induced you (plural) to twiddle the `MACOSX_DEPLOYMENT_TARGET` ?",
    "created_at": "2015-04-21T17:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320607",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:29'></a>
`@`vbraun: Where's the ticket that induced you (plural) to twiddle the `MACOSX_DEPLOYMENT_TARGET` ?



---

archive/issue_comments_320608.json:
```json
{
    "body": "<a id='comment:30'></a>\nIt's this one: http://trac.sagemath.org/ticket/17204\n\nThat ticket doesn't describe how to reproduce the relevant issue, or how to check my libtool version. The version I find doesn't seem to be in the same scheme as the one mentioned (2.4.3).\n\n```\n$ libtool -V\nApple Inc. version cctools-862\n```\n\nI'm interested because this patch *seems to* work, and I'm trying to see if I've thereby regressed #17204:\n\n```diff\ndiff --git a/src/bin/sage-env b/src/bin/sage-env\nindex 43f265b..8b26eda 100644\n--- a/src/bin/sage-env\n+++ b/src/bin/sage-env\n@@ -268,17 +268,10 @@ fi\n\n # Mac OS X-specific setup\n if [ `uname` = \"Darwin\" ]; then\n-    # set MACOSX_DEPLOYMENT_TARGET -- if set incorrectly, this can\n+    # unset MACOSX_DEPLOYMENT_TARGET -- if set incorrectly, this can\n     # cause lots of random \"Abort trap\" issues on OSX. see trac\n     # #7095 for an example.\n-    MACOSX_VERSION=`uname -r | awk -F. '{print $1}'`\n-    MACOSX_DEPLOYMENT_TARGET=10.$[$MACOSX_VERSION-4]\n-    if [ $MACOSX_DEPLOYMENT_TARGET = '10.10' ]; then\n-        # Workaround for the libtool version detection bug\n-        # See http://trac.sagemath.org/ticket/17204\n-        MACOSX_DEPLOYMENT_TARGET=10.9\n-    fi\n-    export MACOSX_DEPLOYMENT_TARGET\n+    unset MACOSX_DEPLOYMENT_TARGET\n fi\n\n # Compile-time path for libraries.  This is the equivalent of\n```",
    "created_at": "2015-04-21T17:24:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320608",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:30'></a>
It's this one: http://trac.sagemath.org/ticket/17204

That ticket doesn't describe how to reproduce the relevant issue, or how to check my libtool version. The version I find doesn't seem to be in the same scheme as the one mentioned (2.4.3).

```
$ libtool -V
Apple Inc. version cctools-862
```

I'm interested because this patch *seems to* work, and I'm trying to see if I've thereby regressed #17204:

```diff
diff --git a/src/bin/sage-env b/src/bin/sage-env
index 43f265b..8b26eda 100644
--- a/src/bin/sage-env
+++ b/src/bin/sage-env
@@ -268,17 +268,10 @@ fi

 # Mac OS X-specific setup
 if [ `uname` = "Darwin" ]; then
-    # set MACOSX_DEPLOYMENT_TARGET -- if set incorrectly, this can
+    # unset MACOSX_DEPLOYMENT_TARGET -- if set incorrectly, this can
     # cause lots of random "Abort trap" issues on OSX. see trac
     # #7095 for an example.
-    MACOSX_VERSION=`uname -r | awk -F. '{print $1}'`
-    MACOSX_DEPLOYMENT_TARGET=10.$[$MACOSX_VERSION-4]
-    if [ $MACOSX_DEPLOYMENT_TARGET = '10.10' ]; then
-        # Workaround for the libtool version detection bug
-        # See http://trac.sagemath.org/ticket/17204
-        MACOSX_DEPLOYMENT_TARGET=10.9
-    fi
-    export MACOSX_DEPLOYMENT_TARGET
+    unset MACOSX_DEPLOYMENT_TARGET
 fi

 # Compile-time path for libraries.  This is the equivalent of
```



---

archive/issue_comments_320609.json:
```json
{
    "body": "<a id='comment:31'></a>\nIt seems like this bug has the reproduction information I was looking for: https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63610\n\nBecause I was able to `make distclean && make` with no issues whatsoever, I think the libtool problem is gone, and the workaround should be removed, since it is the source of this bug at hand.",
    "created_at": "2015-04-21T17:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320609",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:31'></a>
It seems like this bug has the reproduction information I was looking for: https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63610

Because I was able to `make distclean && make` with no issues whatsoever, I think the libtool problem is gone, and the workaround should be removed, since it is the source of this bug at hand.



---

archive/issue_comments_320610.json:
```json
{
    "body": "<a id='comment:32'></a>\nSorry for the spam, but I keep learning things. =X\n\nEven if the libtool issue still exists, the above patch would avoid it.\nIt's an implementation of the alternative workaround suggested by gcc dev Jack Howarth at https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63610#c9",
    "created_at": "2015-04-21T17:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320610",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:32'></a>
Sorry for the spam, but I keep learning things. =X

Even if the libtool issue still exists, the above patch would avoid it.
It's an implementation of the alternative workaround suggested by gcc dev Jack Howarth at https://gcc.gnu.org/bugzilla/show_bug.cgi?id=63610#c9



---

archive/issue_comments_320611.json:
```json
{
    "body": "**Branch:** [u/buck/unset_macosx_deployment_target_18254](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/unset_macosx_deployment_target_18254)",
    "created_at": "2015-04-21T17:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320611",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

**Branch:** [u/buck/unset_macosx_deployment_target_18254](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/unset_macosx_deployment_target_18254)



---

archive/issue_comments_320612.json:
```json
{
    "body": "**Commit:** [569f12d06763baf11bf341129a9b7312a2bceb24](https://github.com/sagemath/sagetrac-mirror/commit/569f12d06763baf11bf341129a9b7312a2bceb24)",
    "created_at": "2015-04-21T17:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320612",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

**Commit:** [569f12d06763baf11bf341129a9b7312a2bceb24](https://github.com/sagemath/sagetrac-mirror/commit/569f12d06763baf11bf341129a9b7312a2bceb24)



---

archive/issue_comments_320613.json:
```json
{
    "body": "<a id='comment:33'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/569f12d06763baf11bf341129a9b7312a2bceb24\">569f12d</a></td><td><code>unset MACOSX_DEPLOYMENT_TARGET, rather than sometimes setting a bogus value</code></td></tr></table>\n",
    "created_at": "2015-04-21T17:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320613",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:33'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/569f12d06763baf11bf341129a9b7312a2bceb24">569f12d</a></td><td><code>unset MACOSX_DEPLOYMENT_TARGET, rather than sometimes setting a bogus value</code></td></tr></table>




---

archive/issue_comments_320614.json:
```json
{
    "body": "<a id='comment:34'></a>\nThere is nothing bogus about setting an earlier MACOSX_DEPLOYMENT_TARGET, its commonly used to make binaries that **in addition** run on older versions. \n\nAutotool-based projects are supposed to ship their own copy of libtool, not use the system libtool.",
    "created_at": "2015-04-21T18:34:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320614",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:34'></a>
There is nothing bogus about setting an earlier MACOSX_DEPLOYMENT_TARGET, its commonly used to make binaries that **in addition** run on older versions. 

Autotool-based projects are supposed to ship their own copy of libtool, not use the system libtool.



---

archive/issue_comments_320615.json:
```json
{
    "body": "<a id='comment:35'></a>\nWell... that patch is bogus then.\n\nIt's still mysterious that unsetting it \"solves\" this problem.",
    "created_at": "2015-04-21T18:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320615",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:35'></a>
Well... that patch is bogus then.

It's still mysterious that unsetting it "solves" this problem.



---

archive/issue_comments_320616.json:
```json
{
    "body": "**Changing commit** from \"[569f12d06763baf11bf341129a9b7312a2bceb24](https://github.com/sagemath/sagetrac-mirror/commit/569f12d06763baf11bf341129a9b7312a2bceb24)\" to \"\".",
    "created_at": "2015-04-21T18:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320616",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

**Changing commit** from "[569f12d06763baf11bf341129a9b7312a2bceb24](https://github.com/sagemath/sagetrac-mirror/commit/569f12d06763baf11bf341129a9b7312a2bceb24)" to "".



---

archive/issue_comments_320617.json:
```json
{
    "body": "**Changing branch** from \"[u/buck/unset_macosx_deployment_target_18254](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/unset_macosx_deployment_target_18254)\" to \"\".",
    "created_at": "2015-04-21T18:47:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320617",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

**Changing branch** from "[u/buck/unset_macosx_deployment_target_18254](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/unset_macosx_deployment_target_18254)" to "".



---

archive/issue_comments_320618.json:
```json
{
    "body": "<a id='comment:37'></a>\nHave you tried an earlier MACOSX_DEPLOYMENT_TARGET, maybe 10.8? We just have to find a combination that circumvents all bugs in Xcode...",
    "created_at": "2015-04-22T00:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320618",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:37'></a>
Have you tried an earlier MACOSX_DEPLOYMENT_TARGET, maybe 10.8? We just have to find a combination that circumvents all bugs in Xcode...



---

archive/issue_comments_320619.json:
```json
{
    "body": "<a id='comment:38'></a>\nI tried with `MACOSX_DEPLOYMENT_TARGET=10.10` and got a segfault, so I guess that bug is still around.\n\nWhy is `unset MACOSX_DEPLOYMENT_TARGET` a non-starter? \n\nI'll try 10.8...",
    "created_at": "2015-04-22T04:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320619",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:38'></a>
I tried with `MACOSX_DEPLOYMENT_TARGET=10.10` and got a segfault, so I guess that bug is still around.

Why is `unset MACOSX_DEPLOYMENT_TARGET` a non-starter? 

I'll try 10.8...



---

archive/issue_comments_320620.json:
```json
{
    "body": "<a id='comment:39'></a>\nI've verified that anything other than `MACOSX_DEPLOYMENT_TARGET=10.10` throws the OP error.\n\nCan I change the if-10.10 to do an unset?",
    "created_at": "2015-04-22T04:19:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320620",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:39'></a>
I've verified that anything other than `MACOSX_DEPLOYMENT_TARGET=10.10` throws the OP error.

Can I change the if-10.10 to do an unset?



---

archive/issue_comments_320621.json:
```json
{
    "body": "<a id='comment:40'></a>\nI've pared it down to this minimal reproduction:\n\n```\n$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.10 gcc -c -xc -\n(it works, no output)\n\n$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.9 gcc -c -xc -\nIn file included from /usr/include/Availability.h:153:0,\n                 from /System/Library/Frameworks/ApplicationServices.framework/Headers/ApplicationServices.h:19,\n                 from <stdin>:1:\n/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'\n   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,\n                                         ^\n```",
    "created_at": "2015-04-22T04:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320621",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:40'></a>
I've pared it down to this minimal reproduction:

```
$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.10 gcc -c -xc -
(it works, no output)

$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.9 gcc -c -xc -
In file included from /usr/include/Availability.h:153:0,
                 from /System/Library/Frameworks/ApplicationServices.framework/Headers/ApplicationServices.h:19,
                 from <stdin>:1:
/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'
   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,
                                         ^
```



---

archive/issue_comments_320622.json:
```json
{
    "body": "<a id='comment:41'></a>\nThis only reproduces with GNU gcc, not with /usr/bin/gcc.\n\ngcc bug?",
    "created_at": "2015-04-22T05:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320622",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:41'></a>
This only reproduces with GNU gcc, not with /usr/bin/gcc.

gcc bug?



---

archive/issue_comments_320623.json:
```json
{
    "body": "<a id='comment:42'></a>\nEven-more-minimal reproduction:\n\n```\n$ echo 'enum {a = 1, b __attribute__((availability(macosx,introduced=10.10))) = 1};' | /usr/bin/gcc -c -xc -\n(no output, it works)\n\n$ echo 'enum {a = 1, b __attribute__((availability(macosx,introduced=10.10))) = 1};' | gcc -c -xc -\n<stdin>:1:16: error: expected ',' or '}' before '__attribute__'\n```",
    "created_at": "2015-04-22T05:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320623",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:42'></a>
Even-more-minimal reproduction:

```
$ echo 'enum {a = 1, b __attribute__((availability(macosx,introduced=10.10))) = 1};' | /usr/bin/gcc -c -xc -
(no output, it works)

$ echo 'enum {a = 1, b __attribute__((availability(macosx,introduced=10.10))) = 1};' | gcc -c -xc -
<stdin>:1:16: error: expected ',' or '}' before '__attribute__'
```



---

archive/issue_comments_320624.json:
```json
{
    "body": "<a id='comment:43'></a>\nOn a machine running 10.10.3 and Xcode 6.2, if I use `unset MACOSX_DEPLOYMENT_TARGET`, Sage builds but I get a lot of doctest errors:\n\n```\n----------------------------------------------------------------------\nsage -t --long src/sage/plot/graphics.py  # Killed due to abort\nsage -t --long src/sage/matrix/matrix2.pyx  # Killed due to abort\nsage -t --long src/sage/schemes/elliptic_curves/height.py  # Killed due to abort\nsage -t --long src/sage/crypto/mq/sr.py  # 5 doctests failed\nsage -t --long src/sage/libs/ppl.pyx  # Killed due to abort\nsage -t --long src/sage/symbolic/integration/integral.py  # Killed due to abort\nsage -t --long src/sage/schemes/projective/projective_morphism.py  # Killed due to abort\nsage -t --long src/sage/modular/modsym/ambient.py  # Killed due to abort\nsage -t --long src/sage/schemes/elliptic_curves/ell_finite_field.py  # Killed due to abort\nsage -t --long src/sage/functions/prime_pi.pyx  # Killed due to abort\nsage -t --long src/sage/modular/modform/eisenstein_submodule.py  # Killed due to abort\nsage -t --long src/sage/tests/french_book/calculus_doctest.py  # Killed due to abort\nsage -t --long src/sage/interfaces/maxima_lib.py  # Killed due to abort\nsage -t --long src/sage/coding/code_constructions.py  # Killed due to abort\nsage -t --long src/sage/groups/generic.py  # Killed due to abort\nsage -t --long src/sage/matrix/matrix_modn_dense_template.pxi  # Killed due to abort\nsage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # 1 doctest failed\nsage -t --long src/sage/matrix/matrix_cyclo_dense.pyx  # Killed due to abort\nsage -t --long src/sage/calculus/functional.py  # Killed due to abort\nsage -t --long src/doc/en/thematic_tutorials/coding_theory.rst  # Killed due to abort\nsage -t --long src/sage/functions/min_max.py  # Killed due to abort\nsage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort\nsage -t --long src/sage/rings/algebraic_closure_finite_field.py  # Killed due to abort\nsage -t --long src/sage/functions/trig.py  # Killed due to abort\nsage -t --long src/doc/de/tutorial/tour_advanced.rst  # Killed due to abort\nsage -t --long src/doc/en/tutorial/tour_advanced.rst  # Killed due to abort\nsage -t --long src/doc/ru/tutorial/tour_advanced.rst  # Killed due to abort\nsage -t --long src/sage/modular/modsym/modsym.py  # Killed due to abort\nsage -t --long src/doc/pt/tutorial/tour_advanced.rst  # Killed due to abort\nsage -t --long src/doc/fr/tutorial/tour_advanced.rst  # Killed due to abort\nsage -t --long src/sage/modular/abvar/homology.py  # Killed due to abort\nsage -t --long src/sage/symbolic/function.pyx  # Killed due to abort\nsage -t --long src/sage/algebras/finite_dimensional_algebras/finite_dimensional_algebra.py  # Killed due to\\\n abort\nsage -t --long src/sage/tests/french_book/linalg_doctest.py  # Killed due to abort\nsage -t --long src/sage/rings/finite_rings/element_base.pyx  # Killed due to abort\n----------------------------------------------------------------------\n```\nA typical such error says\n\n```\n------------------------------------------------------------------------\nUnhandled SIGABRT: An abort() occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nSage will now terminate.\n------------------------------------------------------------------------\n```",
    "created_at": "2015-04-22T06:00:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320624",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'></a>
On a machine running 10.10.3 and Xcode 6.2, if I use `unset MACOSX_DEPLOYMENT_TARGET`, Sage builds but I get a lot of doctest errors:

```
----------------------------------------------------------------------
sage -t --long src/sage/plot/graphics.py  # Killed due to abort
sage -t --long src/sage/matrix/matrix2.pyx  # Killed due to abort
sage -t --long src/sage/schemes/elliptic_curves/height.py  # Killed due to abort
sage -t --long src/sage/crypto/mq/sr.py  # 5 doctests failed
sage -t --long src/sage/libs/ppl.pyx  # Killed due to abort
sage -t --long src/sage/symbolic/integration/integral.py  # Killed due to abort
sage -t --long src/sage/schemes/projective/projective_morphism.py  # Killed due to abort
sage -t --long src/sage/modular/modsym/ambient.py  # Killed due to abort
sage -t --long src/sage/schemes/elliptic_curves/ell_finite_field.py  # Killed due to abort
sage -t --long src/sage/functions/prime_pi.pyx  # Killed due to abort
sage -t --long src/sage/modular/modform/eisenstein_submodule.py  # Killed due to abort
sage -t --long src/sage/tests/french_book/calculus_doctest.py  # Killed due to abort
sage -t --long src/sage/interfaces/maxima_lib.py  # Killed due to abort
sage -t --long src/sage/coding/code_constructions.py  # Killed due to abort
sage -t --long src/sage/groups/generic.py  # Killed due to abort
sage -t --long src/sage/matrix/matrix_modn_dense_template.pxi  # Killed due to abort
sage -t --long src/sage/rings/polynomial/multi_polynomial_sequence.py  # 1 doctest failed
sage -t --long src/sage/matrix/matrix_cyclo_dense.pyx  # Killed due to abort
sage -t --long src/sage/calculus/functional.py  # Killed due to abort
sage -t --long src/doc/en/thematic_tutorials/coding_theory.rst  # Killed due to abort
sage -t --long src/sage/functions/min_max.py  # Killed due to abort
sage -t --long src/sage/rings/polynomial/pbori.pyx  # Killed due to abort
sage -t --long src/sage/rings/algebraic_closure_finite_field.py  # Killed due to abort
sage -t --long src/sage/functions/trig.py  # Killed due to abort
sage -t --long src/doc/de/tutorial/tour_advanced.rst  # Killed due to abort
sage -t --long src/doc/en/tutorial/tour_advanced.rst  # Killed due to abort
sage -t --long src/doc/ru/tutorial/tour_advanced.rst  # Killed due to abort
sage -t --long src/sage/modular/modsym/modsym.py  # Killed due to abort
sage -t --long src/doc/pt/tutorial/tour_advanced.rst  # Killed due to abort
sage -t --long src/doc/fr/tutorial/tour_advanced.rst  # Killed due to abort
sage -t --long src/sage/modular/abvar/homology.py  # Killed due to abort
sage -t --long src/sage/symbolic/function.pyx  # Killed due to abort
sage -t --long src/sage/algebras/finite_dimensional_algebras/finite_dimensional_algebra.py  # Killed due to\
 abort
sage -t --long src/sage/tests/french_book/linalg_doctest.py  # Killed due to abort
sage -t --long src/sage/rings/finite_rings/element_base.pyx  # Killed due to abort
----------------------------------------------------------------------
```
A typical such error says

```
------------------------------------------------------------------------
Unhandled SIGABRT: An abort() occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Sage will now terminate.
------------------------------------------------------------------------
```



---

archive/issue_comments_320625.json:
```json
{
    "body": "<a id='comment:44'></a>\n`@`jhpalmieri That looks like the abort errors mentioned in sage-env. It says to look at #7095\n\nOne workaround is to configure R with `--with-aqua=no`, but I don't know if that's acceptable. I don't know what aqua is or what R might use it for.",
    "created_at": "2015-04-22T06:13:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320625",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:44'></a>
`@`jhpalmieri That looks like the abort errors mentioned in sage-env. It says to look at #7095

One workaround is to configure R with `--with-aqua=no`, but I don't know if that's acceptable. I don't know what aqua is or what R might use it for.



---

archive/issue_comments_320626.json:
```json
{
    "body": "<a id='comment:45'></a>\nI'm pretty sure that some old libtool versions still linger in third-party tarballs, so we'll need MACOSX_DEPLOYMENT_TARGET <= 10.9 for a while.",
    "created_at": "2015-04-22T12:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320626",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:45'></a>
I'm pretty sure that some old libtool versions still linger in third-party tarballs, so we'll need MACOSX_DEPLOYMENT_TARGET <= 10.9 for a while.



---

archive/issue_comments_320627.json:
```json
{
    "body": "<a id='comment:46'></a>\nDisabling aqua (=OSX gui), at least until Apple publishes a working Xcode, is fine with me.",
    "created_at": "2015-04-22T12:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320627",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:46'></a>
Disabling aqua (=OSX gui), at least until Apple publishes a working Xcode, is fine with me.



---

archive/issue_comments_320628.json:
```json
{
    "body": "<a id='comment:47'></a>\nI'm confused about the goal here. As far as I can tell, if you have Xcode 6.3, Sage won't build, and the problem won't be with `R`, but with `gcc`. If you delete Xcode 6.3 and install version 6.2 of the command-line tools, Sage will build. Is this reproducible by anyone else? If so, what problem are we trying to solve with this ticket?",
    "created_at": "2015-04-22T17:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320628",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:47'></a>
I'm confused about the goal here. As far as I can tell, if you have Xcode 6.3, Sage won't build, and the problem won't be with `R`, but with `gcc`. If you delete Xcode 6.3 and install version 6.2 of the command-line tools, Sage will build. Is this reproducible by anyone else? If so, what problem are we trying to solve with this ticket?



---

archive/issue_comments_320629.json:
```json
{
    "body": "<a id='comment:48'></a>\nYou're mistaken. I've been running 6.2 this whole time.",
    "created_at": "2015-04-22T17:45:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320629",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:48'></a>
You're mistaken. I've been running 6.2 this whole time.



---

archive/issue_comments_320630.json:
```json
{
    "body": "<a id='comment:49'></a>\nI wish any of you were on IRC. This would all go so much more quickly.",
    "created_at": "2015-04-22T17:48:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320630",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:49'></a>
I wish any of you were on IRC. This would all go so much more quickly.



---

archive/issue_comments_320631.json:
```json
{
    "body": "Attachment [Screen Shot 2015-04-22 at 10.53.37 AM.png](tarball://root/attachments/some-uuid/ticket18254/Screen Shot 2015-04-22 at 10.53.37 AM.png) by buck created at 2015-04-22 17:54:20\n\nmy xcode and clt versions",
    "created_at": "2015-04-22T17:54:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320631",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

Attachment [Screen Shot 2015-04-22 at 10.53.37 AM.png](tarball://root/attachments/some-uuid/ticket18254/Screen Shot 2015-04-22 at 10.53.37 AM.png) by buck created at 2015-04-22 17:54:20

my xcode and clt versions



---

archive/issue_comments_320632.json:
```json
{
    "body": "<a id='comment:50'></a>\nThe next question is whether anyone else can replicate your problems. By the way, does it help to delete the Xcode app and just install the command-line tools (via the link described in the top-voted answer to http://stackoverflow.com/questions/29529455/missing-c-header-debug-after-updating-osx-command-line-tools-6-3)?\n\nEdit: you originally had installed Xcode 6.3. I wonder if there are any traces of that left somewhere?",
    "created_at": "2015-04-22T18:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320632",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:50'></a>
The next question is whether anyone else can replicate your problems. By the way, does it help to delete the Xcode app and just install the command-line tools (via the link described in the top-voted answer to http://stackoverflow.com/questions/29529455/missing-c-header-debug-after-updating-osx-command-line-tools-6-3)?

Edit: you originally had installed Xcode 6.3. I wonder if there are any traces of that left somewhere?



---

archive/issue_comments_320633.json:
```json
{
    "body": "<a id='comment:51'></a>\nWith the change\n\n```diff\ndiff --git a/build/pkgs/r/spkg-install b/build/pkgs/r/spkg-install\nindex 2bb904d..4bad9c8 100755\n--- a/build/pkgs/r/spkg-install\n+++ b/build/pkgs/r/spkg-install\n@@ -84,6 +84,13 @@ if [ \"$UNAME\" = \"Darwin\" ]; then\n     R_CONFIGURE=\"--enable-R-framework=no $R_CONFIGURE\"\n fi\n \n+# OS X 10.10 and/or Xcode 6.3 broke the R installation. See\n+# http://trac.sagemath.org/ticket/18254.\n+if { uname -sr | grep 'Darwin 14\\.' ;} &>/dev/null; then\n+    echo \"OS X 10.10: Configuring R without aqua support.\"\n+    R_CONFIGURE=\"--with-aqua=no $R_CONFIGURE\"\n+fi\n+\n if [ \"$UNAME\" = \"CYGWIN\" ]; then\n     # Cygwin libm does not provide \"long double\" functions\n     # and we do not install Cephes on Cygwin at the moment\n```\nalong with the workaround for gcc at #18156, `R` builds and passes its test suite, and Sage passes all tests, too. (This is with command line tools 6.3.1.)",
    "created_at": "2015-04-24T18:35:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320633",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:51'></a>
With the change

```diff
diff --git a/build/pkgs/r/spkg-install b/build/pkgs/r/spkg-install
index 2bb904d..4bad9c8 100755
--- a/build/pkgs/r/spkg-install
+++ b/build/pkgs/r/spkg-install
@@ -84,6 +84,13 @@ if [ "$UNAME" = "Darwin" ]; then
     R_CONFIGURE="--enable-R-framework=no $R_CONFIGURE"
 fi
 
+# OS X 10.10 and/or Xcode 6.3 broke the R installation. See
+# http://trac.sagemath.org/ticket/18254.
+if { uname -sr | grep 'Darwin 14\.' ;} &>/dev/null; then
+    echo "OS X 10.10: Configuring R without aqua support."
+    R_CONFIGURE="--with-aqua=no $R_CONFIGURE"
+fi
+
 if [ "$UNAME" = "CYGWIN" ]; then
     # Cygwin libm does not provide "long double" functions
     # and we do not install Cephes on Cygwin at the moment
```
along with the workaround for gcc at #18156, `R` builds and passes its test suite, and Sage passes all tests, too. (This is with command line tools 6.3.1.)



---

archive/issue_comments_320634.json:
```json
{
    "body": "<a id='comment:52'></a>\nThere is a new R release at #18229, does it change anything?",
    "created_at": "2015-04-24T21:58:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320634",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:52'></a>
There is a new R release at #18229, does it change anything?



---

archive/issue_comments_320635.json:
```json
{
    "body": "<a id='comment:53'></a>\nReplying to [vbraun](#comment%3A52):\n> There is a new R release at #18229, does it change anything?\n\n\nYes. Without the change here, I get the same failure. With the change here, I get a new failure:\n\n```\ngcc -std=gnu99 -I/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/include -DNDEBUG      -fPIC  -g -O2   -c init.c -o init.o\ngcc -std=gnu99 -I/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/include -DNDEBUG      -fPIC  -g -O2   -c threeDplot.c -o threeDplot.o\ngcc -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib -L/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/ -o lattice.so init.o threeDplot.o -L/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib -lR -Wl,-framework -Wl,CoreFoundation\ninstalling to /Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/library/lattice/libs\n** R\n** data\n*** moving datasets to lazyload DB\ndyld: lazy symbol binding failed: Symbol not found: _BZ2_bzReadOpen\n  Referenced from: /Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib\n  Expected in: flat namespace\n\ndyld: Symbol not found: _BZ2_bzReadOpen\n  Referenced from: /Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib\n  Expected in: flat namespace\n\n/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/bin/INSTALL: line 34:  9807 Done                    echo 'tools:::.install_packages()'\n      9808 Trace/BPT trap: 5       | R_DEFAULT_PACKAGES= LC_COLLATE=C \"${R_HOME}/bin/R\" $myArgs --slave --args ${args}\nmake[5]: *** [lattice.ts] Error 1\nmake[4]: *** [recommended-packages] Error 2\nmake[3]: *** [stamp-recommended] Error 2\nError building vignettes.\n```",
    "created_at": "2015-04-24T22:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320635",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:53'></a>
Replying to [vbraun](#comment%3A52):
> There is a new R release at #18229, does it change anything?


Yes. Without the change here, I get the same failure. With the change here, I get a new failure:

```
gcc -std=gnu99 -I/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/include -DNDEBUG      -fPIC  -g -O2   -c init.c -o init.o
gcc -std=gnu99 -I/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/include -DNDEBUG      -fPIC  -g -O2   -c threeDplot.c -o threeDplot.o
gcc -std=gnu99 -dynamiclib -Wl,-headerpad_max_install_names -undefined dynamic_lookup -single_module -multiply_defined suppress -L/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib -L/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/ -o lattice.so init.o threeDplot.o -L/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib -lR -Wl,-framework -Wl,CoreFoundation
installing to /Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/library/lattice/libs
** R
** data
*** moving datasets to lazyload DB
dyld: lazy symbol binding failed: Symbol not found: _BZ2_bzReadOpen
  Referenced from: /Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib
  Expected in: flat namespace

dyld: Symbol not found: _BZ2_bzReadOpen
  Referenced from: /Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib
  Expected in: flat namespace

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/var/tmp/sage/build/r-3.2.0.p0/src/bin/INSTALL: line 34:  9807 Done                    echo 'tools:::.install_packages()'
      9808 Trace/BPT trap: 5       | R_DEFAULT_PACKAGES= LC_COLLATE=C "${R_HOME}/bin/R" $myArgs --slave --args ${args}
make[5]: *** [lattice.ts] Error 1
make[4]: *** [recommended-packages] Error 2
make[3]: *** [stamp-recommended] Error 2
Error building vignettes.
```



---

archive/issue_comments_320636.json:
```json
{
    "body": "<a id='comment:54'></a>\nGot there too. Like in #18254 libR.dylib is underlinked but somehow R.bin linked OK.\n\n```\n otool -L /Users/fbissey/build/sage-6.6.beta5/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib\n/Users/fbissey/build/sage-6.6.beta5/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib:\n\tlibR.dylib (compatibility version 3.2.0, current version 3.2.0)\n\tlibRblas.dylib (compatibility version 0.0.0, current version 0.0.0)\n\t/Users/fbissey/build/sage-6.6.beta5/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)\n\t/Users/fbissey/build/sage-6.6.beta5/local/lib/libquadmath.0.dylib (compatibility version 1.0.0, current version 1.0.0)\n\t/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 1153.18.0)\n\t/Users/fbissey/build/sage-6.6.beta5/local/lib/libreadline.6.dylib (compatibility version 6.0.0, current version 6.3.0)\n\t/Users/fbissey/build/sage-6.6.beta5/local/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.8)\n\t/usr/lib/libicucore.A.dylib (compatibility version 1.0.0, current version 53.1.0)\n\t/usr/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)\n\t/Users/fbissey/build/sage-6.6.beta5/local/lib/libgomp.1.dylib (compatibility version 2.0.0, current version 2.0.0)\n\t/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1213.0.0)\n\t/Users/fbissey/build/sage-6.6.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)\n```\nlibbz2 is missing. A gross hack that should get us past this would be to configure with `--without-system-bzlib` to force the use of the internal copy but it is quite curious we miss that linking on some platforms.",
    "created_at": "2015-04-25T11:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320636",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:54'></a>
Got there too. Like in #18254 libR.dylib is underlinked but somehow R.bin linked OK.

```
 otool -L /Users/fbissey/build/sage-6.6.beta5/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib
/Users/fbissey/build/sage-6.6.beta5/local/var/tmp/sage/build/r-3.2.0.p0/src/lib/libR.dylib:
	libR.dylib (compatibility version 3.2.0, current version 3.2.0)
	libRblas.dylib (compatibility version 0.0.0, current version 0.0.0)
	/Users/fbissey/build/sage-6.6.beta5/local/lib/libgfortran.3.dylib (compatibility version 4.0.0, current version 4.0.0)
	/Users/fbissey/build/sage-6.6.beta5/local/lib/libquadmath.0.dylib (compatibility version 1.0.0, current version 1.0.0)
	/System/Library/Frameworks/CoreFoundation.framework/Versions/A/CoreFoundation (compatibility version 150.0.0, current version 1153.18.0)
	/Users/fbissey/build/sage-6.6.beta5/local/lib/libreadline.6.dylib (compatibility version 6.0.0, current version 6.3.0)
	/Users/fbissey/build/sage-6.6.beta5/local/lib/libz.1.dylib (compatibility version 1.0.0, current version 1.2.8)
	/usr/lib/libicucore.A.dylib (compatibility version 1.0.0, current version 53.1.0)
	/usr/lib/libiconv.2.dylib (compatibility version 7.0.0, current version 7.0.0)
	/Users/fbissey/build/sage-6.6.beta5/local/lib/libgomp.1.dylib (compatibility version 2.0.0, current version 2.0.0)
	/usr/lib/libSystem.B.dylib (compatibility version 1.0.0, current version 1213.0.0)
	/Users/fbissey/build/sage-6.6.beta5/local/lib/libgcc_s.1.dylib (compatibility version 1.0.0, current version 1.0.0)
```
libbz2 is missing. A gross hack that should get us past this would be to configure with `--without-system-bzlib` to force the use of the internal copy but it is quite curious we miss that linking on some platforms.



---

archive/issue_comments_320637.json:
```json
{
    "body": "<a id='comment:55'></a>\n`--without-system-bzlib` did the trick. I also noticed that with r-3.1.2 bzip2 was not properly detected during configuration on my mac and therefore the internal copy was used in that case too.",
    "created_at": "2015-04-25T11:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320637",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:55'></a>
`--without-system-bzlib` did the trick. I also noticed that with r-3.1.2 bzip2 was not properly detected during configuration on my mac and therefore the internal copy was used in that case too.



---

archive/issue_comments_320638.json:
```json
{
    "body": "<a id='comment:56'></a>\nThat works for me, too. All tests pass.",
    "created_at": "2015-04-25T19:33:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320638",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:56'></a>
That works for me, too. All tests pass.



---

archive/issue_comments_320639.json:
```json
{
    "body": "<a id='comment:57'></a>\nLet's make the new R version and its attendant patch a separate issue and ship the patch shown in[comment:51](#comment%3A51).",
    "created_at": "2015-04-26T03:55:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320639",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:57'></a>
Let's make the new R version and its attendant patch a separate issue and ship the patch shown in[comment:51](#comment%3A51).



---

archive/issue_comments_320640.json:
```json
{
    "body": "**Branch:** [u/buck/18254_osx_R_noaqua](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/18254_osx_R_noaqua)",
    "created_at": "2015-04-26T04:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320640",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

**Branch:** [u/buck/18254_osx_R_noaqua](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/18254_osx_R_noaqua)



---

archive/issue_comments_320641.json:
```json
{
    "body": "**Commit:** [ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48](https://github.com/sagemath/sagetrac-mirror/commit/ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48)",
    "created_at": "2015-04-26T04:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320641",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

**Commit:** [ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48](https://github.com/sagemath/sagetrac-mirror/commit/ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48)



---

archive/issue_comments_320642.json:
```json
{
    "body": "<a id='comment:58'></a>\n**New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48\">ad87162</a></td><td><code>skip R-aqua on osx 10.10. see #18254</code></td></tr></table>\n",
    "created_at": "2015-04-26T04:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320642",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:58'></a>
**New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48">ad87162</a></td><td><code>skip R-aqua on osx 10.10. see #18254</code></td></tr></table>




---

archive/issue_comments_320643.json:
```json
{
    "body": "<a id='comment:59'></a>\n**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4\">3c5cd0f</a></td><td><code>skip R-aqua on osx 10.10. see #18254</code></td></tr></table>\n",
    "created_at": "2015-04-26T04:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320643",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>
**Branch pushed to git repo; I updated commit sha1. This was a forced push.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4">3c5cd0f</a></td><td><code>skip R-aqua on osx 10.10. see #18254</code></td></tr></table>




---

archive/issue_comments_320644.json:
```json
{
    "body": "**Changing commit** from \"[ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48](https://github.com/sagemath/sagetrac-mirror/commit/ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48)\" to \"[3c5cd0f74446992a2b98f84c34043cfa181b68b4](https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4)\".",
    "created_at": "2015-04-26T04:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320644",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48](https://github.com/sagemath/sagetrac-mirror/commit/ad87162c8b4b7ccef0553ad66d9a6b2e112c8f48)" to "[3c5cd0f74446992a2b98f84c34043cfa181b68b4](https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4)".



---

archive/issue_comments_320645.json:
```json
{
    "body": "<a id='comment:60'></a>\nAs for upstream, I've gotten some good response on the osx-dev forums:\n\nhttps://devforums.apple.com/message/1128923#1128923\n\ntl;dr: Fixing this upstream involves enhancements to one of both gcc and clang:\n* clang: the macros in Availability.h need an \"ENUM\" variant (like we have for the CF and NS availability macros) to cover this case\n* gcc: implement clang's extension http://clang.llvm.org/docs/LanguageExtensions.html#attributes-on-enumerators",
    "created_at": "2015-04-26T04:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320645",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:60'></a>
As for upstream, I've gotten some good response on the osx-dev forums:

https://devforums.apple.com/message/1128923#1128923

tl;dr: Fixing this upstream involves enhancements to one of both gcc and clang:
* clang: the macros in Availability.h need an "ENUM" variant (like we have for the CF and NS availability macros) to cover this case
* gcc: implement clang's extension http://clang.llvm.org/docs/LanguageExtensions.html#attributes-on-enumerators



---

archive/issue_comments_320646.json:
```json
{
    "body": "<a id='comment:61'></a>\nApple says they don't care about GNU-gcc bugs. Is there a good reason to use gnu-gcc for all of this?\n\n```\nApple Developer Relations24-Apr-2015 02:40 PM\n \nEngineering has determined that this is an issue for a third party to resolve.\n\nWe do not support GNU gcc.\n\nIf you have questions regarding the resolution of this issue, please update your bug report with them.\n\nWe are closing this report.\n\nPlease be sure to regularly check new Apple releases for any updates that might affect this issue.\n \nBuck Golemon21-Apr-2015 10:54 PM\n \nThis is related to the fact that clang supports \"enumeration attributes\" but GNU gcc does not.\nhttp://clang.llvm.org/docs/LanguageExtensions.html#attributes-on-enumerators\nhttps://gcc.gnu.org/onlinedocs/gcc/Attribute-Syntax.html#Attribute-Syntax\n\nI've opened a public question on the matter at: http://stackoverflow.com/questions/29788547/gcc-attribute-for-enum-members\n \nBuck Golemon21-Apr-2015 10:03 PM\n \nSummary:\nUnder GNU gcc, there's a syntax error in ApplicationServices.h if $MACOSX_DEPLOYMENT_TARGET has any value less than 10.10.\n\nSteps to Reproduce:\n```\n$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.10 gcc -c -xc -\n(it works, no output)\n\n$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.9 gcc -c -xc -\nIn file included from /usr/include/Availability.h:153:0,\n                 from /System/Library/Frameworks/ApplicationServices.framework/Headers/ApplicationServices.h:19,\n                 from <stdin>:1:\n/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'\n   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,\n                                         ^\n```\n\n\nExpected Results:\nsuccessful compilation\n\nActual Results:\ncompilation fails with a syntax error\n\nVersion:\nosx 10.10.3 (14D131)\nxcode Version 6.2 (6C131e)\ngcc --version: gcc (GCC) 4.9.2\n\nNotes:\nDownstream ticket: http://trac.sagemath.org/ticket/18254\n\nConfiguration:\n\n\nAttachments:\n\n```",
    "created_at": "2015-04-26T04:50:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320646",
    "user": "https://trac.sagemath.org/admin/accounts/users/buck"
}
```

<a id='comment:61'></a>
Apple says they don't care about GNU-gcc bugs. Is there a good reason to use gnu-gcc for all of this?

```
Apple Developer Relations24-Apr-2015 02:40 PM
 
Engineering has determined that this is an issue for a third party to resolve.

We do not support GNU gcc.

If you have questions regarding the resolution of this issue, please update your bug report with them.

We are closing this report.

Please be sure to regularly check new Apple releases for any updates that might affect this issue.
 
Buck Golemon21-Apr-2015 10:54 PM
 
This is related to the fact that clang supports "enumeration attributes" but GNU gcc does not.
http://clang.llvm.org/docs/LanguageExtensions.html#attributes-on-enumerators
https://gcc.gnu.org/onlinedocs/gcc/Attribute-Syntax.html#Attribute-Syntax

I've opened a public question on the matter at: http://stackoverflow.com/questions/29788547/gcc-attribute-for-enum-members
 
Buck Golemon21-Apr-2015 10:03 PM
 
Summary:
Under GNU gcc, there's a syntax error in ApplicationServices.h if $MACOSX_DEPLOYMENT_TARGET has any value less than 10.10.

Steps to Reproduce:
```
$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.10 gcc -c -xc -
(it works, no output)

$ echo '#include <ApplicationServices/ApplicationServices.h>' | MACOSX_DEPLOYMENT_TARGET=10.9 gcc -c -xc -
In file included from /usr/include/Availability.h:153:0,
                 from /System/Library/Frameworks/ApplicationServices.framework/Headers/ApplicationServices.h:19,
                 from <stdin>:1:
/System/Library/Frameworks/CoreServices.framework/Frameworks/FSEvents.framework/Headers/FSEvents.h:486:41: error: expected ',' or '}' before '__attribute__'
   kFSEventStreamEventFlagItemIsHardlink __OSX_AVAILABLE_STARTING(__MAC_10_10, __IPHONE_9_0) = 0x00100000,
                                         ^
```


Expected Results:
successful compilation

Actual Results:
compilation fails with a syntax error

Version:
osx 10.10.3 (14D131)
xcode Version 6.2 (6C131e)
gcc --version: gcc (GCC) 4.9.2

Notes:
Downstream ticket: http://trac.sagemath.org/ticket/18254

Configuration:


Attachments:

```



---

archive/issue_comments_320647.json:
```json
{
    "body": "<a id='comment:62'></a>\nSummary of why we use gcc instead of clang.\n* We need a fortran compiler so we build gcc anyway\n* A lot of packages shipped with sage won't compile with clang\n* it is too hard to use clang for some and gcc for some other\n* some of the package broken with clang my be in the too hard basket\n\nI expect one way or another most packages in sage will eventually compile with clang. I for one will work on this once gentoo-prefix on OS X finally gets its toolchain issues sorted and default to clang.",
    "created_at": "2015-04-26T06:09:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320647",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:62'></a>
Summary of why we use gcc instead of clang.
* We need a fortran compiler so we build gcc anyway
* A lot of packages shipped with sage won't compile with clang
* it is too hard to use clang for some and gcc for some other
* some of the package broken with clang my be in the too hard basket

I expect one way or another most packages in sage will eventually compile with clang. I for one will work on this once gentoo-prefix on OS X finally gets its toolchain issues sorted and default to clang.



---

archive/issue_comments_320648.json:
```json
{
    "body": "**Reviewer:** John Palmieri, Volker Braun",
    "created_at": "2015-04-26T15:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320648",
    "user": "https://github.com/jhpalmieri"
}
```

**Reviewer:** John Palmieri, Volker Braun



---

archive/issue_comments_320649.json:
```json
{
    "body": "**Author:** Buck Evan",
    "created_at": "2015-04-26T15:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320649",
    "user": "https://github.com/jhpalmieri"
}
```

**Author:** Buck Evan



---

archive/issue_comments_320650.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2015-04-26T15:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320650",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_320651.json:
```json
{
    "body": "<a id='comment:63'></a>\nLet's merge this. The change was first suggested [in comment 44](#comment%3A44), so I've made buck the author.",
    "created_at": "2015-04-26T15:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320651",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:63'></a>
Let's merge this. The change was first suggested [in comment 44](#comment%3A44), so I've made buck the author.



---

archive/issue_comments_320652.json:
```json
{
    "body": "<a id='comment:64'></a>\nMerge or close as invalid? Can you set the milestone if you actually want to merge the branch?",
    "created_at": "2015-04-27T00:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320652",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:64'></a>
Merge or close as invalid? Can you set the milestone if you actually want to merge the branch?



---

archive/issue_comments_320653.json:
```json
{
    "body": "<a id='comment:65'></a>\nSorry. I think you set the milestone a while ago, and no one reset it to match the new branch.",
    "created_at": "2015-04-27T01:09:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320653",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:65'></a>
Sorry. I think you set the milestone a while ago, and no one reset it to match the new branch.



---

archive/issue_events_058626.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-04-27T01:09:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18254#event-58626"
}
```



---

archive/issue_events_058627.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-04-27T01:09:43Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18254#event-58627"
}
```



---

archive/issue_comments_320654.json:
```json
{
    "body": "**Changing branch** from \"[u/buck/18254_osx_R_noaqua](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/18254_osx_R_noaqua)\" to \"[3c5cd0f74446992a2b98f84c34043cfa181b68b4](https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4)\".",
    "created_at": "2015-04-27T04:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320654",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/buck/18254_osx_R_noaqua](https://github.com/sagemath/sagetrac-mirror/tree/u/buck/18254_osx_R_noaqua)" to "[3c5cd0f74446992a2b98f84c34043cfa181b68b4](https://github.com/sagemath/sagetrac-mirror/commit/3c5cd0f74446992a2b98f84c34043cfa181b68b4)".



---

archive/issue_events_058628.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-27T04:16:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18254#event-58628"
}
```



---

archive/issue_comments_320655.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2015-04-27T04:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18254",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18254#issuecomment-320655",
    "user": "https://github.com/vbraun"
}
```

**Resolution:** fixed
