# Issue 18639: New class NumberFieldZeroIdeal

archive/issues_018402.json:
```json
{
    "assignees": [],
    "body": "There are several issues with the zero ideal in number fields:\n\n```\nsage: K.<a> = NumberField(x^2-10)\nsage: K.<a> = NumberField(x^2-10)\nsage: 0/K.ideal(a)\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nSage will now terminate.\n------------------------------------------------------------------------\n```\n\n```\nsage: K.<a> = NumberField(x^2-15)\nsage: three = K.ideal(3)\nsage: zero = K(0)\nsage: three.divides(zero)\n------------------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component of Sage has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nSage will now terminate.\n------------------------------------------------------------------------\n```\n\n```\nsage: K.<a> = QuadraticField(-5) \nsage: K.ideal(0) * K.ideal(a+1,3)\n...\nPariError: incorrect type in basistoalg (t_MAT)\n```\n\n(and probably more)\n\nI propose to do some redesign and add a new class `NumberFieldZeroIdeal` for just the zero ideal. Then most methods of the current `NumberFieldIdeal` should probably be moved to either or both of `NumberFieldZeroIdeal`/`NumberFieldFractionalIdeal`.\n\nDepends on #18622\n\nCC:  @mmasdeu\n\nBranch/Commit: **[u/cremona/18639](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/18639) @ [4f60fb4](https://github.com/sagemath/sagetrac-mirror/commit/4f60fb466895fb07d9ab06e89f1f5f9510101b68)**\n\nAuthor: **John Cremona**\n\nComponent: **number fields**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18639_\n\n",
    "created_at": "2015-06-08T19:38:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.10",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "New class NumberFieldZeroIdeal",
    "type": "issue",
    "updated_at": "2021-02-02T16:50:24Z",
    "url": "https://github.com/sagemath/sage/issues/18639",
    "user": "https://github.com/JohnCremona"
}
```
There are several issues with the zero ideal in number fields:

```
sage: K.<a> = NumberField(x^2-10)
sage: K.<a> = NumberField(x^2-10)
sage: 0/K.ideal(a)
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Sage will now terminate.
------------------------------------------------------------------------
```

```
sage: K.<a> = NumberField(x^2-15)
sage: three = K.ideal(3)
sage: zero = K(0)
sage: three.divides(zero)
------------------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component of Sage has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Sage will now terminate.
------------------------------------------------------------------------
```

```
sage: K.<a> = QuadraticField(-5) 
sage: K.ideal(0) * K.ideal(a+1,3)
...
PariError: incorrect type in basistoalg (t_MAT)
```

(and probably more)

I propose to do some redesign and add a new class `NumberFieldZeroIdeal` for just the zero ideal. Then most methods of the current `NumberFieldIdeal` should probably be moved to either or both of `NumberFieldZeroIdeal`/`NumberFieldFractionalIdeal`.

Depends on #18622

CC:  @mmasdeu

Branch/Commit: **[u/cremona/18639](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/18639) @ [4f60fb4](https://github.com/sagemath/sagetrac-mirror/commit/4f60fb466895fb07d9ab06e89f1f5f9510101b68)**

Author: **John Cremona**

Component: **number fields**

_Issue created by migration from https://trac.sagemath.org/ticket/18639_





---

archive/issue_events_264910.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2015-06-08T19:38:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264910"
}
```



---

archive/issue_events_264911.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2015-06-08T19:38:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "c: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264911"
}
```



---

archive/issue_events_264912.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2015-06-08T19:38:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264912"
}
```



---

archive/issue_events_264913.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2015-06-08T19:38:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264913"
}
```



---

archive/issue_comments_259455.json:
```json
{
    "body": "Commit: **[30ca395](https://github.com/sagemath/sagetrac-mirror/commit/30ca3956b9439aba717ed73397a39dea99a26430)**",
    "created_at": "2015-06-08T19:50:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259455",
    "user": "https://github.com/JohnCremona"
}
```

Commit: **[30ca395](https://github.com/sagemath/sagetrac-mirror/commit/30ca3956b9439aba717ed73397a39dea99a26430)**



---

archive/issue_comments_259456.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/30ca3956b9439aba717ed73397a39dea99a26430\">30ca395</a></td><td><code>#18639: ideal divides 0</code></td></tr></table>\n",
    "created_at": "2015-06-08T19:50:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259456",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/30ca3956b9439aba717ed73397a39dea99a26430">30ca395</a></td><td><code>#18639: ideal divides 0</code></td></tr></table>




---

archive/issue_events_264914.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2015-06-08T19:50:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264914"
}
```



---

archive/issue_comments_259457.json:
```json
{
    "body": "Branch: **[u/cremona/18639](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/18639)**",
    "created_at": "2015-06-08T19:50:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259457",
    "user": "https://github.com/JohnCremona"
}
```

Branch: **[u/cremona/18639](https://github.com/sagemath/sagetrac-mirror/tree/u/cremona/18639)**



---

archive/issue_comments_259458.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nWouldn't the proper fix to just allow `(0) / I = (0)` for a fractional ideal `I`? Can you check if #18622 does that?",
    "created_at": "2015-06-08T21:06:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259458",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

Wouldn't the proper fix to just allow `(0) / I = (0)` for a fractional ideal `I`? Can you check if #18622 does that?



---

archive/issue_comments_259459.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nOK, I will check that.  Certainly the 0 ideal passes the is_integral() test, and that should be done anyway, as it is already p ossible to multiply the 0 idal with a nonzero (fractional) one.",
    "created_at": "2015-06-08T21:19:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259459",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:3" align="right">comment:3</div>

OK, I will check that.  Certainly the 0 ideal passes the is_integral() test, and that should be done anyway, as it is already p ossible to multiply the 0 idal with a nonzero (fractional) one.



---

archive/issue_events_264915.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-09T06:42:38Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "title_is": "(0) / I crashes for I a fractional ideal",
    "title_was": "I.divides(0) crashes for I a fractional ideal",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264915"
}
```



---

archive/issue_events_264916.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-09T06:42:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264916"
}
```



---

archive/issue_events_264917.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-09T06:42:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264917"
}
```



---

archive/issue_comments_259460.json:
```json
{
    "body": "Dependencies: **#186222**",
    "created_at": "2015-06-09T06:42:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259460",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#186222**



---

archive/issue_comments_259461.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nIt's worse with #18622: it gives a segmentation fault.\n\nIn any case, I still think that allowing `(0)/I` is the proper fix here, so I'm boldly changing the ticket to do that.",
    "created_at": "2015-06-09T06:42:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259461",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

It's worse with #18622: it gives a segmentation fault.

In any case, I still think that allowing `(0)/I` is the proper fix here, so I'm boldly changing the ticket to do that.



---

archive/issue_comments_259462.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,35 +1,12 @@\n \n ```\n sage: K.<a> = NumberField(x^2-10)\n-sage: a.divides(K(10))\n-True\n-sage: a.divides(K(0))                                                                          \n-True\n-sage: I = K.ideal(a)\n-sage: I.divides(K(10))                                                                         \n-True\n-sage: I.divides(K(0))                                                                          \n----------------------------------------------------------------------------\n-TypeError                                 Traceback (most recent call last)\n-<ipython-input-18-bfc74602576b> in <module>()\n-----> 1 I.divides(K(Integer(0)))\n-\n-/home/jec/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.pyc in divides(self, other)\n-   1753         if not isinstance(other, NumberFieldIdeal):\n-   1754             other = self.number_field().ideal(other)\n--> 1755         return (other / self).is_integral()\n-   1756 \n-   1757     def factor(self):\n-\n-TypeError: unsupported operand type(s) for /: 'NumberFieldIdeal' and 'NumberFieldFractionalIdeal'\n+sage: K.<a> = NumberField(x^2-10)\n+sage: 0/K.ideal(a)\n+------------------------------------------------------------------------\n+Unhandled SIGSEGV: A segmentation fault occurred in Sage.\n+This probably occurred because a *compiled* component of Sage has a bug\n+in it and is not properly wrapped with sig_on(), sig_off().\n+Sage will now terminate.\n+------------------------------------------------------------------------\n ```\n-This is failing because the divides method does this:\n-\n-```\n-       if not isinstance(other, NumberFieldIdeal):\n-            other = self.number_field().ideal(other)\n-        return (other / self).is_integral()\n-```\n-and the / operator does not like having the left operand the zero ideal (which is not a fractional ideal).  Similarly, I.divides(K.ideal(0)) fails.\n-\n-The simple fix is to check whether other.is_zero() first.\n``````\n",
    "created_at": "2015-06-09T06:42:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259462",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,35 +1,12 @@
 
 ```
 sage: K.<a> = NumberField(x^2-10)
-sage: a.divides(K(10))
-True
-sage: a.divides(K(0))                                                                          
-True
-sage: I = K.ideal(a)
-sage: I.divides(K(10))                                                                         
-True
-sage: I.divides(K(0))                                                                          
----------------------------------------------------------------------------
-TypeError                                 Traceback (most recent call last)
-<ipython-input-18-bfc74602576b> in <module>()
-----> 1 I.divides(K(Integer(0)))
-
-/home/jec/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.pyc in divides(self, other)
-   1753         if not isinstance(other, NumberFieldIdeal):
-   1754             other = self.number_field().ideal(other)
--> 1755         return (other / self).is_integral()
-   1756 
-   1757     def factor(self):
-
-TypeError: unsupported operand type(s) for /: 'NumberFieldIdeal' and 'NumberFieldFractionalIdeal'
+sage: K.<a> = NumberField(x^2-10)
+sage: 0/K.ideal(a)
+------------------------------------------------------------------------
+Unhandled SIGSEGV: A segmentation fault occurred in Sage.
+This probably occurred because a *compiled* component of Sage has a bug
+in it and is not properly wrapped with sig_on(), sig_off().
+Sage will now terminate.
+------------------------------------------------------------------------
 ```
-This is failing because the divides method does this:
-
-```
-       if not isinstance(other, NumberFieldIdeal):
-            other = self.number_field().ideal(other)
-        return (other / self).is_integral()
-```
-and the / operator does not like having the left operand the zero ideal (which is not a fractional ideal).  Similarly, I.divides(K.ideal(0)) fails.
-
-The simple fix is to check whether other.is_zero() first.
``````




---

archive/issue_comments_259463.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI see that #18622 has been merged but is not in the current beta, so the branch name has disappeared from that ticket, so I am hoping that schecking out rremote branch trac/u/jdemeyer/ticket/18611 is the right thing to do.",
    "created_at": "2015-06-09T08:31:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259463",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:5" align="right">comment:5</div>

I see that #18622 has been merged but is not in the current beta, so the branch name has disappeared from that ticket, so I am hoping that schecking out rremote branch trac/u/jdemeyer/ticket/18611 is the right thing to do.



---

archive/issue_comments_259464.json:
```json
{
    "body": "Changed dependencies from **#186222** to **#18622**",
    "created_at": "2015-06-09T08:31:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259464",
    "user": "https://github.com/JohnCremona"
}
```

Changed dependencies from **#186222** to **#18622**



---

archive/issue_comments_259465.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@JohnCremona](#comment:5):\n> I see that #18622 has been merged but is not in the current beta, so the branch name has disappeared from that ticket, so I am hoping that schecking out rremote branch trac/u/jdemeyer/ticket/18611 is the right thing to do.\n\nYou can always use the commit hash, that should always work:\n\n```\ngit fetch trac  # or just \"git fetch\" depending on your configuration\ngit checkout f61588ecabefc84103c4daa40e648b76e6e58828\n```",
    "created_at": "2015-06-09T09:06:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259465",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@JohnCremona](#comment:5):
> I see that #18622 has been merged but is not in the current beta, so the branch name has disappeared from that ticket, so I am hoping that schecking out rremote branch trac/u/jdemeyer/ticket/18611 is the right thing to do.

You can always use the commit hash, that should always work:

```
git fetch trac  # or just "git fetch" depending on your configuration
git checkout f61588ecabefc84103c4daa40e648b76e6e58828
```



---

archive/issue_events_264918.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-09T09:25:06Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "title_is": "Fix zero ideal in number fields",
    "title_was": "(0) / I crashes for I a fractional ideal",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264918"
}
```



---

archive/issue_comments_259466.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThere are actually many issues with the zero ideal...",
    "created_at": "2015-06-09T09:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259466",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

There are actually many issues with the zero ideal...



---

archive/issue_comments_259467.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n+There are several issues with the zero ideal in number fields:\n \n ```\n sage: K.<a> = NumberField(x^2-10)\n@@ -10,3 +11,10 @@\n Sage will now terminate.\n ------------------------------------------------------------------------\n ```\n+\n+```\n+sage: K.<a> = QuadraticField(-5) \n+sage: K.ideal(0) * K.ideal(a+1,3)\n+...\n+PariError: incorrect type in basistoalg (t_MAT)\n+```\n``````\n",
    "created_at": "2015-06-09T09:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259467",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
+There are several issues with the zero ideal in number fields:
 
 ```
 sage: K.<a> = NumberField(x^2-10)
@@ -10,3 +11,10 @@
 Sage will now terminate.
 ------------------------------------------------------------------------
 ```
+
+```
+sage: K.<a> = QuadraticField(-5) 
+sage: K.ideal(0) * K.ideal(a+1,3)
+...
+PariError: incorrect type in basistoalg (t_MAT)
+```
``````




---

archive/issue_comments_259468.json:
```json
{
    "body": "Changed commit from **[30ca395](https://github.com/sagemath/sagetrac-mirror/commit/30ca3956b9439aba717ed73397a39dea99a26430)** to **[7be3884](https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318)**",
    "created_at": "2015-06-09T09:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259468",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[30ca395](https://github.com/sagemath/sagetrac-mirror/commit/30ca3956b9439aba717ed73397a39dea99a26430)** to **[7be3884](https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318)**



---

archive/issue_comments_259469.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318\">7be3884</a></td><td><code>#18639: handle division for 0 ideal</code></td></tr></table>\n",
    "created_at": "2015-06-09T09:27:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259469",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:8"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318">7be3884</a></td><td><code>#18639: handle division for 0 ideal</code></td></tr></table>




---

archive/issue_comments_259470.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI hope you don't mind that I'm making this ticket much more general than you intended, but there is really not much point in fixing one specific method when maybe the whole approach needs to be changed.\n\nI am now thinking about the following: introduce a new class `NumberFieldZeroIdeal` to represent the zero ideal. Then inherit both `NumberFieldZeroIdeal` and `NumberFieldFractionalIdeal` from `NumberFieldIdeal` (which shouldn't have much functionality).",
    "created_at": "2015-06-09T09:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259470",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

I hope you don't mind that I'm making this ticket much more general than you intended, but there is really not much point in fixing one specific method when maybe the whole approach needs to be changed.

I am now thinking about the following: introduce a new class `NumberFieldZeroIdeal` to represent the zero ideal. Then inherit both `NumberFieldZeroIdeal` and `NumberFieldFractionalIdeal` from `NumberFieldIdeal` (which shouldn't have much functionality).



---

archive/issue_comments_259471.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@sagetrac-git](#comment:8):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318\">7be3884</a></td><td><code>#18639: handle division for 0 ideal</code></td></tr></table>\n\nSorry, but this will conflict with #18622.",
    "created_at": "2015-06-09T09:31:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259471",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@sagetrac-git](#comment:8):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318">7be3884</a></td><td><code>#18639: handle division for 0 ideal</code></td></tr></table>

Sorry, but this will conflict with #18622.



---

archive/issue_comments_259472.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI have done what was suggested.  Basically the `__div__` function is moved from NumberFieldFractionalIdeal to NumberFieldIdeal with appropriate tests.  The test from the original patch are included too, to show that the porioginal issue is resolved.  I based this on my original branch but also tested it based on #18622.\n\nI'm sure you will find something I did not do right and/or want to do more (I just saw your comment).  Feel free to take this over from me 100% as I have other things to do today.",
    "created_at": "2015-06-09T09:32:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259472",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:11" align="right">comment:11</div>

I have done what was suggested.  Basically the `__div__` function is moved from NumberFieldFractionalIdeal to NumberFieldIdeal with appropriate tests.  The test from the original patch are included too, to show that the porioginal issue is resolved.  I based this on my original branch but also tested it based on #18622.

I'm sure you will find something I did not do right and/or want to do more (I just saw your comment).  Feel free to take this over from me 100% as I have other things to do today.



---

archive/issue_comments_259473.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@JohnCremona](#comment:11):\n> but also tested it based on #18622.\n\nAre you sure? I ask because #18622 actually changes `__div__` to `_div_` so I find it hard to believe that you didn't get a conflict.\n\n> Feel free to take this over from me 100% as I have other things to do today.\n\nMe too :-)\n\nWhat do you think about the approach I propose in [comment:9]?",
    "created_at": "2015-06-09T09:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259473",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@JohnCremona](#comment:11):
> but also tested it based on #18622.

Are you sure? I ask because #18622 actually changes `__div__` to `_div_` so I find it hard to believe that you didn't get a conflict.

> Feel free to take this over from me 100% as I have other things to do today.

Me too :-)

What do you think about the approach I propose in [comment:9]?



---

archive/issue_comments_259474.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@jdemeyer](#comment:12):\n> Replying to [@JohnCremona](#comment:11):\n> > but also tested it based on #18622.\n\n> Are you sure? I ask because #18622 actually changes `__div__` to `_div_` so I find it hard to believe that you didn't get a conflict.\n> \n> > Feel free to take this over from me 100% as I have other things to do today.\n\n> Me too :-)\n\nI am sure you do!  I am in the middle of implementing Kraus's condictoins and global minimal (or almost global minimal) models for elliptic curves over number fields of class number 1, which no-one has ever done before.  Nearly finished...\n\n> \n> What do you think about the approach I propose in [comment:9]?\n\nGood idea.  I think WIlliam and I considered this way back (see line 10 of the file in question -- it was in fact 28 Jan 2008, almost my first ever Sage development session, and took place in a hotel room in New Jersey where he and I had nothing else to do all day...)",
    "created_at": "2015-06-09T09:45:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259474",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@jdemeyer](#comment:12):
> Replying to [@JohnCremona](#comment:11):
> > but also tested it based on #18622.

> Are you sure? I ask because #18622 actually changes `__div__` to `_div_` so I find it hard to believe that you didn't get a conflict.
> 
> > Feel free to take this over from me 100% as I have other things to do today.

> Me too :-)

I am sure you do!  I am in the middle of implementing Kraus's condictoins and global minimal (or almost global minimal) models for elliptic curves over number fields of class number 1, which no-one has ever done before.  Nearly finished...

> 
> What do you think about the approach I propose in [comment:9]?

Good idea.  I think WIlliam and I considered this way back (see line 10 of the file in question -- it was in fact 28 Jan 2008, almost my first ever Sage development session, and took place in a hotel room in New Jersey where he and I had nothing else to do all day...)



---

archive/issue_comments_259475.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@JohnCremona](#comment:13):\n> Good idea.  I think WIlliam and I considered this way back (see line 10 of the file in question -- it was in fact 28 Jan 2008, almost my first ever Sage development session, and took place in a hotel room in New Jersey where he and I had nothing else to do all day...)\n\nI know. The problem is that currently there is really no way to write special code for just the zero ideal. I also think that `NumberFieldZeroIdeal` is more explicit about its intentions, which is a good thing.",
    "created_at": "2015-06-09T09:49:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259475",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@JohnCremona](#comment:13):
> Good idea.  I think WIlliam and I considered this way back (see line 10 of the file in question -- it was in fact 28 Jan 2008, almost my first ever Sage development session, and took place in a hotel room in New Jersey where he and I had nothing else to do all day...)

I know. The problem is that currently there is really no way to write special code for just the zero ideal. I also think that `NumberFieldZeroIdeal` is more explicit about its intentions, which is a good thing.



---

archive/issue_comments_259476.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,3 +18,7 @@\n ...\n PariError: incorrect type in basistoalg (t_MAT)\n ```\n+\n+(and probably more)\n+\n+I propose to do some redesign and add a new class `NumberFieldZeroIdeal` for just the zero ideal. Then most methods of the current `NumberFieldIdeal` should probably be moved to either or both of `NumberFieldZeroIdeal`/`NumberFieldFractionalIdeal`.\n``````\n",
    "created_at": "2015-06-09T09:52:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259476",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,3 +18,7 @@
 ...
 PariError: incorrect type in basistoalg (t_MAT)
 ```
+
+(and probably more)
+
+I propose to do some redesign and add a new class `NumberFieldZeroIdeal` for just the zero ideal. Then most methods of the current `NumberFieldIdeal` should probably be moved to either or both of `NumberFieldZeroIdeal`/`NumberFieldFractionalIdeal`.
``````




---

archive/issue_events_264919.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-09T09:52:10Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "title_is": "New class NumberFieldZeroIdeal",
    "title_was": "Fix zero ideal in number fields",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264919"
}
```



---

archive/issue_events_264920.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-12-09T19:46:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264920"
}
```



---

archive/issue_events_264921.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-12-09T19:46:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18639#event-264921"
}
```



---

archive/issue_comments_259477.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,19 @@\n sage: K.<a> = NumberField(x^2-10)\n sage: K.<a> = NumberField(x^2-10)\n sage: 0/K.ideal(a)\n+------------------------------------------------------------------------\n+Unhandled SIGSEGV: A segmentation fault occurred in Sage.\n+This probably occurred because a *compiled* component of Sage has a bug\n+in it and is not properly wrapped with sig_on(), sig_off().\n+Sage will now terminate.\n+------------------------------------------------------------------------\n+```\n+\n+```\n+sage: K.<a> = NumberField(x^2-15)\n+sage: three = K.ideal(3)\n+sage: zero = K(0)\n+sage: three.divides(zero)\n ------------------------------------------------------------------------\n Unhandled SIGSEGV: A segmentation fault occurred in Sage.\n This probably occurred because a *compiled* component of Sage has a bug\n``````\n",
    "created_at": "2015-12-09T19:46:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259477",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,19 @@
 sage: K.<a> = NumberField(x^2-10)
 sage: K.<a> = NumberField(x^2-10)
 sage: 0/K.ideal(a)
+------------------------------------------------------------------------
+Unhandled SIGSEGV: A segmentation fault occurred in Sage.
+This probably occurred because a *compiled* component of Sage has a bug
+in it and is not properly wrapped with sig_on(), sig_off().
+Sage will now terminate.
+------------------------------------------------------------------------
+```
+
+```
+sage: K.<a> = NumberField(x^2-15)
+sage: three = K.ideal(3)
+sage: zero = K(0)
+sage: three.divides(zero)
 ------------------------------------------------------------------------
 Unhandled SIGSEGV: A segmentation fault occurred in Sage.
 This probably occurred because a *compiled* component of Sage has a bug
``````




---

archive/issue_comments_259478.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4f60fb466895fb07d9ab06e89f1f5f9510101b68\">4f60fb4</a></td><td><code>Merge branch 'develop' into 18639</code></td></tr></table>\n",
    "created_at": "2021-02-02T16:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259478",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4f60fb466895fb07d9ab06e89f1f5f9510101b68">4f60fb4</a></td><td><code>Merge branch 'develop' into 18639</code></td></tr></table>




---

archive/issue_comments_259479.json:
```json
{
    "body": "Changed commit from **[7be3884](https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318)** to **[4f60fb4](https://github.com/sagemath/sagetrac-mirror/commit/4f60fb466895fb07d9ab06e89f1f5f9510101b68)**",
    "created_at": "2021-02-02T16:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259479",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7be3884](https://github.com/sagemath/sagetrac-mirror/commit/7be38840da684f9110b4a295712a7eb212f94318)** to **[4f60fb4](https://github.com/sagemath/sagetrac-mirror/commit/4f60fb466895fb07d9ab06e89f1f5f9510101b68)**



---

archive/issue_comments_259480.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nAlthough this has become inactive, I thought it worth at least merging in the current develop branch and resolving conflicts (there were very few).",
    "created_at": "2021-02-02T16:50:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18639",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18639#issuecomment-259480",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:18" align="right">comment:18</div>

Although this has become inactive, I thought it worth at least merging in the current develop branch and resolving conflicts (there were very few).
