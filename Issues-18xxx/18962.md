# Issue 18962: Double free in ft2font

archive/issues_018725.json:
```json
{
    "body": "CC:  @kiwifb\n\nAs reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ\n\n```\nsage: import matplotlib \nsage: matplotlib.rc('text', usetex=True) \nsage: plot(sin).save('/tmp/test.svg') # works \nsage: plot(sin).save('/tmp/test.svg') # segfault \n```\nThis is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)\n\nUpdate to freetype-2.6 fixes it.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18962\n\n",
    "closed_at": "2015-07-29T14:59:56Z",
    "created_at": "2015-07-29T08:04:44Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Double free in ft2font",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18962",
    "user": "https://github.com/vbraun"
}
```
CC:  @kiwifb

As reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ

```
sage: import matplotlib 
sage: matplotlib.rc('text', usetex=True) 
sage: plot(sin).save('/tmp/test.svg') # works 
sage: plot(sin).save('/tmp/test.svg') # segfault 
```
This is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)

Update to freetype-2.6 fixes it.

Issue created by migration from https://trac.sagemath.org/ticket/18962





---

archive/issue_comments_255301.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2015-07-29T08:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255301",
    "user": "https://github.com/vbraun"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_255302.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2015-07-29T08:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255302",
    "user": "https://github.com/vbraun"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_255303.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-07-29T08:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255303",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_255304.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-07-29T08:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255304",
    "user": "https://github.com/vbraun"
}
```

New commits:



---

archive/issue_comments_255305.json:
```json
{
    "body": "Hum, I am only at 2.5.5 in sage-on-gentoo and that's not vulnerable. Hum, `spkg-install` doesn't do anything special that will need updating for that version so it should be all good.",
    "created_at": "2015-07-29T08:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255305",
    "user": "https://github.com/kiwifb"
}
```

Hum, I am only at 2.5.5 in sage-on-gentoo and that's not vulnerable. Hum, `spkg-install` doesn't do anything special that will need updating for that version so it should be all good.



---

archive/issue_comments_255306.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-07-29T08:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255306",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_255307.json:
```json
{
    "body": "Yes, 2.5.5 is also good.",
    "created_at": "2015-07-29T09:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255307",
    "user": "https://github.com/vbraun"
}
```

Yes, 2.5.5 is also good.



---

archive/issue_comments_255308.json:
```json
{
    "body": "I can confirm that it fixes original issue (made fresh build, all tests passed and saving to svg no longer segfaults)",
    "created_at": "2015-07-29T10:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255308",
    "user": "https://trac.sagemath.org/admin/accounts/users/aginiewicz"
}
```

I can confirm that it fixes original issue (made fresh build, all tests passed and saving to svg no longer segfaults)



---

archive/issue_comments_255309.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-07-29T14:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255309",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_052872.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-29T14:59:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18962#event-52872"
}
```



---

archive/issue_comments_255310.json:
```json
{
    "body": "follow up in #19089",
    "created_at": "2015-08-26T02:38:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-255310",
    "user": "https://github.com/kiwifb"
}
```

follow up in #19089
