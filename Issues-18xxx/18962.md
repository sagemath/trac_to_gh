# Issue 18962: Double free in ft2font

archive/issues_018725.json:
```json
{
    "body": "As reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ\n\n```\nsage: import matplotlib \nsage: matplotlib.rc('text', usetex=True) \nsage: plot(sin).save('/tmp/test.svg') # works \nsage: plot(sin).save('/tmp/test.svg') # segfault \n```\nThis is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)\n\nUpdate to freetype-2.6 fixes it.\n\nCC:  @kiwifb\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Volker Braun\n\nBranch: 1be3c2b15b3aa1ba78396d549bfc4ba7161cd097\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18962\n\n",
    "closed_at": "2015-07-29T14:59:56Z",
    "created_at": "2015-07-29T08:04:44Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Double free in ft2font",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18962",
    "user": "https://github.com/vbraun"
}
```
As reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ

```
sage: import matplotlib 
sage: matplotlib.rc('text', usetex=True) 
sage: plot(sin).save('/tmp/test.svg') # works 
sage: plot(sin).save('/tmp/test.svg') # segfault 
```
This is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)

Update to freetype-2.6 fixes it.

CC:  @kiwifb

Reviewer: Fran√ßois Bissey

Author: Volker Braun

Branch: 1be3c2b15b3aa1ba78396d549bfc4ba7161cd097

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18962





---

archive/issue_comments_272017.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to defect.",
    "created_at": "2015-07-29T08:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272017",
    "user": "https://github.com/vbraun"
}
```

Changing type from PLEASE CHANGE to defect.



---

archive/issue_comments_272018.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+As reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ\n \n+\\`\\`\\`\n+sage: import matplotlib \n+sage: matplotlib.rc('text', usetex=True) \n+sage: plot(sin).save('/tmp/test.svg') # works \n+sage: plot(sin).save('/tmp/test.svg') # segfault \n+\\`\\`\\`\n+This is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)\n+\n+Update to freetype-2.5.6 fixes it.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-07-29T08:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272018",
    "user": "https://github.com/vbraun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,14 @@
+As reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ
 
+\`\`\`
+sage: import matplotlib 
+sage: matplotlib.rc('text', usetex=True) 
+sage: plot(sin).save('/tmp/test.svg') # works 
+sage: plot(sin).save('/tmp/test.svg') # segfault 
+\`\`\`
+This is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)
+
+Update to freetype-2.5.6 fixes it.
 
 Comment: 1
 
```




---

archive/issue_comments_272019.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to packages: standard.",
    "created_at": "2015-07-29T08:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272019",
    "user": "https://github.com/vbraun"
}
```

Changing component from PLEASE CHANGE to packages: standard.



---

archive/issue_comments_272020.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-07-29T08:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272020",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_272021.json:
```json
{
    "body": "<a id='comment:3'></a>New commits:",
    "created_at": "2015-07-29T08:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272021",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:3'></a>New commits:



---

archive/issue_comments_272022.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,14 @@\n+As reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ\n \n+\\`\\`\\`\n+sage: import matplotlib \n+sage: matplotlib.rc('text', usetex=True) \n+sage: plot(sin).save('/tmp/test.svg') # works \n+sage: plot(sin).save('/tmp/test.svg') # segfault \n+\\`\\`\\`\n+This is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)\n+\n+Update to freetype-2.6 fixes it.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-07-29T08:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272022",
    "user": "https://github.com/kiwifb"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,14 @@
+As reported at https://groups.google.com/d/msg/sage-support/K-neaKVSGiE/YMvQqVNQCQAJ
 
+\`\`\`
+sage: import matplotlib 
+sage: matplotlib.rc('text', usetex=True) 
+sage: plot(sin).save('/tmp/test.svg') # works 
+sage: plot(sin).save('/tmp/test.svg') # segfault 
+\`\`\`
+This is a bug in freetype 2.5.2 (http://savannah.nongnu.org/bugs/?40997)
+
+Update to freetype-2.6 fixes it.
 
 Comment: 1
 
```




---

archive/issue_comments_272023.json:
```json
{
    "body": "<a id='comment:4'></a>Hum, I am only at 2.5.5 in sage-on-gentoo and that's not vulnerable. Hum, `spkg-install` doesn't do anything special that will need updating for that version so it should be all good.",
    "created_at": "2015-07-29T08:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272023",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:4'></a>Hum, I am only at 2.5.5 in sage-on-gentoo and that's not vulnerable. Hum, `spkg-install` doesn't do anything special that will need updating for that version so it should be all good.



---

archive/issue_comments_272024.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-07-29T08:25:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272024",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_272025.json:
```json
{
    "body": "<a id='comment:5'></a>Yes, 2.5.5 is also good.",
    "created_at": "2015-07-29T09:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272025",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>Yes, 2.5.5 is also good.



---

archive/issue_comments_272026.json:
```json
{
    "body": "<a id='comment:7'></a>I can confirm that it fixes original issue (made fresh build, all tests passed and saving to svg no longer segfaults)",
    "created_at": "2015-07-29T10:57:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272026",
    "user": "https://trac.sagemath.org/admin/accounts/users/aginiewicz"
}
```

<a id='comment:7'></a>I can confirm that it fixes original issue (made fresh build, all tests passed and saving to svg no longer segfaults)



---

archive/issue_comments_272027.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-07-29T14:59:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272027",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_052872.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-29T14:59:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18962#event-52872"
}
```



---

archive/issue_comments_272028.json:
```json
{
    "body": "<a id='comment:9'></a>follow up in #19089",
    "created_at": "2015-08-26T02:38:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18962",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18962#issuecomment-272028",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>follow up in #19089
