# Issue 18535: Fix Python tarball names

archive/issues_018298.json:
```json
{
    "body": "The Python packages can no longer be downloaded since #17607:\n\n```\nFound local metadata for python2-2.7.9\nAttempting to download package python2-2.7.9\nTraceback (most recent call last):\n  File \"/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file\", line 423, in <module>\n    tarball = Tarball(url)\n  File \"/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file\", line 272, in __init__\n    self._init_checksum()\n  File \"/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file\", line 308, in _init_checksum\n    with open(checksums_ini, 'rt') as f:\nIOError: [Errno 2] No such file or directory: '/home/wluebbe/sage-6.8.beta1/build/pkgs/python/checksums.ini'\nError: spkg file '/home/wluebbe/sage-6.8.beta1/upstream/python-2.7.9.tar.gz' not found.\nThis shouldn't happen, it is a bug in the sage-spkg script.\n```\n\nCC:  @ohanar @vbraun @wluebbe @nathanncohen @haraldschilly @zimmermann6\n\nReviewer: Wilfried Luebbe\n\nAuthor: Volker Braun\n\nBranch: a23e5d81f3a05139202aad3255ca0c0430d98295\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18535\n\n",
    "closed_at": "2015-05-29T19:09:37Z",
    "created_at": "2015-05-28T10:34:58Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "Fix Python tarball names",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18535",
    "user": "https://github.com/jdemeyer"
}
```
The Python packages can no longer be downloaded since #17607:

```
Found local metadata for python2-2.7.9
Attempting to download package python2-2.7.9
Traceback (most recent call last):
  File "/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file", line 423, in <module>
    tarball = Tarball(url)
  File "/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file", line 272, in __init__
    self._init_checksum()
  File "/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file", line 308, in _init_checksum
    with open(checksums_ini, 'rt') as f:
IOError: [Errno 2] No such file or directory: '/home/wluebbe/sage-6.8.beta1/build/pkgs/python/checksums.ini'
Error: spkg file '/home/wluebbe/sage-6.8.beta1/upstream/python-2.7.9.tar.gz' not found.
This shouldn't happen, it is a bug in the sage-spkg script.
```

CC:  @ohanar @vbraun @wluebbe @nathanncohen @haraldschilly @zimmermann6

Reviewer: Wilfried Luebbe

Author: Volker Braun

Branch: a23e5d81f3a05139202aad3255ca0c0430d98295

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18535





---

archive/issue_comments_320406.json:
```json
{
    "body": "<a id='comment:2'></a>\nI've copied python -> python2 and renamed Python -> python3 on the website (to be propagated to the mirrors)",
    "created_at": "2015-05-28T22:14:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320406",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>
I've copied python -> python2 and renamed Python -> python3 on the website (to be propagated to the mirrors)



---

archive/issue_comments_320407.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vbraun/fix_python_tarball_names\"",
    "created_at": "2015-05-28T22:17:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320407",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "" to "u/vbraun/fix_python_tarball_names"



---

archive/issue_comments_320408.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-05-28T22:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320408",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_320409.json:
```json
{
    "body": "<a id='comment:5'></a>\nNow the sage-download-file script no longer assumes that package name = tarball name - version\n\n---\nNew commits:\n|                                                                                                                                          |                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|\n|[f8ae30b](https://github.com/sagemath/sagetrac-mirror/commit/f8ae30b5facfd519f0522a024d079d3318bb9544)|`No longer assume that the tarball name matches the package name`|",
    "created_at": "2015-05-28T22:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320409",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:5'></a>
Now the sage-download-file script no longer assumes that package name = tarball name - version

---
New commits:
|                                                                                                                                          |                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
|[f8ae30b](https://github.com/sagemath/sagetrac-mirror/commit/f8ae30b5facfd519f0522a024d079d3318bb9544)|`No longer assume that the tarball name matches the package name`|



---

archive/issue_comments_320410.json:
```json
{
    "body": "Changing commit from \"\" to \"f8ae30b5facfd519f0522a024d079d3318bb9544\"",
    "created_at": "2015-05-28T22:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320410",
    "user": "https://github.com/vbraun"
}
```

Changing commit from "" to "f8ae30b5facfd519f0522a024d079d3318bb9544"



---

archive/issue_comments_320411.json:
```json
{
    "body": "Changing author from \"\" to \"Volker Braun\"",
    "created_at": "2015-05-28T22:19:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320411",
    "user": "https://github.com/vbraun"
}
```

Changing author from "" to "Volker Braun"



---

archive/issue_comments_320412.json:
```json
{
    "body": "Changing commit from \"f8ae30b5facfd519f0522a024d079d3318bb9544\" to \"75f09fd416be48fa47d88120514488ea510f84d0\"",
    "created_at": "2015-05-28T22:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320412",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f8ae30b5facfd519f0522a024d079d3318bb9544" to "75f09fd416be48fa47d88120514488ea510f84d0"



---

archive/issue_comments_320413.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[75f09fd](https://github.com/sagemath/sagetrac-mirror/commit/75f09fd416be48fa47d88120514488ea510f84d0)|`fix error if package not found`|",
    "created_at": "2015-05-28T22:23:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320413",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[75f09fd](https://github.com/sagemath/sagetrac-mirror/commit/75f09fd416be48fa47d88120514488ea510f84d0)|`fix error if package not found`|



---

archive/issue_comments_320414.json:
```json
{
    "body": "<a id='comment:7'></a>\nAfter pulling u/vbraun/fix_python_tarball_names I have\n\n```\nSuccessfully installed python2-2.7.9\nDeleting temporary build directory\n/home/wluebbe/sage-6.8.beta1/local/var/tmp/sage/build/python2-2.7.9\nFinished installing python2-2.7.9.spkg\n```\nbut then\n\n```\nmake[2]: Leaving directory '/home/wluebbe/sage-6.8.beta1/build'\nMakefile:565: recipe for target 'all' failed\nmake[1]: *** [all] Error 2\nmake[1]: Leaving directory '/home/wluebbe/sage-6.8.beta1/build'\n\nreal\t2m9.439s\nuser\t5m11.672s\nsys\t0m24.208s\n***************************************************************\nError building Sage.\n\nThe following package(s) may have failed to build:\n\npackage: lcalc-1.23.p14\nlog file: /home/wluebbe/sage-6.8.beta1/logs/pkgs/lcalc-1.23.p14.log\nbuild directory: /home/wluebbe/sage-6.8.beta1/local/var/tmp/sage/build/lcalc-1.23.p14\n```",
    "created_at": "2015-05-29T06:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320414",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:7'></a>
After pulling u/vbraun/fix_python_tarball_names I have

```
Successfully installed python2-2.7.9
Deleting temporary build directory
/home/wluebbe/sage-6.8.beta1/local/var/tmp/sage/build/python2-2.7.9
Finished installing python2-2.7.9.spkg
```
but then

```
make[2]: Leaving directory '/home/wluebbe/sage-6.8.beta1/build'
Makefile:565: recipe for target 'all' failed
make[1]: *** [all] Error 2
make[1]: Leaving directory '/home/wluebbe/sage-6.8.beta1/build'

real	2m9.439s
user	5m11.672s
sys	0m24.208s
***************************************************************
Error building Sage.

The following package(s) may have failed to build:

package: lcalc-1.23.p14
log file: /home/wluebbe/sage-6.8.beta1/logs/pkgs/lcalc-1.23.p14.log
build directory: /home/wluebbe/sage-6.8.beta1/local/var/tmp/sage/build/lcalc-1.23.p14
```



---

archive/issue_comments_320415.json:
```json
{
    "body": "<a id='comment:9'></a>\nI would be very surprised if this ticket would break building `lcalc`. Most likely the problem with `lcalc` is a different issue. Can you upload the log file?",
    "created_at": "2015-05-29T07:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320415",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:9'></a>
I would be very surprised if this ticket would break building `lcalc`. Most likely the problem with `lcalc` is a different issue. Can you upload the log file?



---

archive/issue_comments_320416.json:
```json
{
    "body": "<a id='comment:10'></a>\nHere it is\n\n```\nFound local metadata for lcalc-1.23.p14\nAttempting to download package lcalc-1.23.p14\nTraceback (most recent call last):\n  File \"/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file\", line 436, in <module>\n    tarball = Tarball(url)\n  File \"/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file\", line 324, in __init__\n    .format(tarball_name))\nValueError: tarball lcalc-1.23.tar.bz2 is not referenced by any Sage package\nError: spkg file '/home/wluebbe/sage-6.8.beta1/upstream/lcalc-1.23.tar.bz2' not found.\nThis shouldn't happen, it is a bug in the sage-spkg script.\n```",
    "created_at": "2015-05-29T07:51:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320416",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:10'></a>
Here it is

```
Found local metadata for lcalc-1.23.p14
Attempting to download package lcalc-1.23.p14
Traceback (most recent call last):
  File "/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file", line 436, in <module>
    tarball = Tarball(url)
  File "/home/wluebbe/sage-6.8.beta1/src/bin/sage-download-file", line 324, in __init__
    .format(tarball_name))
ValueError: tarball lcalc-1.23.tar.bz2 is not referenced by any Sage package
Error: spkg file '/home/wluebbe/sage-6.8.beta1/upstream/lcalc-1.23.tar.bz2' not found.
This shouldn't happen, it is a bug in the sage-spkg script.
```



---

archive/issue_comments_320417.json:
```json
{
    "body": "Changing commit from \"75f09fd416be48fa47d88120514488ea510f84d0\" to \"a23e5d81f3a05139202aad3255ca0c0430d98295\"",
    "created_at": "2015-05-29T08:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320417",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "75f09fd416be48fa47d88120514488ea510f84d0" to "a23e5d81f3a05139202aad3255ca0c0430d98295"



---

archive/issue_comments_320418.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|\n|[a23e5d8](https://github.com/sagemath/sagetrac-mirror/commit/a23e5d81f3a05139202aad3255ca0c0430d98295)|`Split package-version.txt into version and patchlevel`|",
    "created_at": "2015-05-29T08:33:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320418",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------|
|[a23e5d8](https://github.com/sagemath/sagetrac-mirror/commit/a23e5d81f3a05139202aad3255ca0c0430d98295)|`Split package-version.txt into version and patchlevel`|



---

archive/issue_comments_320419.json:
```json
{
    "body": "<a id='comment:12'></a>\nForgot to strip off the patchlevel, fixed now. \"make download\" works.",
    "created_at": "2015-05-29T08:46:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320419",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
Forgot to strip off the patchlevel, fixed now. "make download" works.



---

archive/issue_comments_320420.json:
```json
{
    "body": "<a id='comment:13'></a>\nWith the latest fix the build succeeded - now testing long ... \n\nWhat about going with Python 2.7.10 soon? It is available since 6 days. [https://www.python.org/ftp/python/2.7.10/Python-2.7.10.tgz](https://www.python.org/ftp/python/2.7.10/Python-2.7.10.tgz)",
    "created_at": "2015-05-29T09:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320420",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:13'></a>
With the latest fix the build succeeded - now testing long ... 

What about going with Python 2.7.10 soon? It is available since 6 days. [https://www.python.org/ftp/python/2.7.10/Python-2.7.10.tgz](https://www.python.org/ftp/python/2.7.10/Python-2.7.10.tgz)



---

archive/issue_comments_320421.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [wluebbe](#comment%3A13):\n> What about going with Python 2.7.10 soon? It is available since 6 days. \n\n\nPlease do work on it, but on a separate ticket.",
    "created_at": "2015-05-29T09:43:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320421",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>
Replying to [wluebbe](#comment%3A13):
> What about going with Python 2.7.10 soon? It is available since 6 days. 


Please do work on it, but on a separate ticket.



---

archive/issue_comments_320422.json:
```json
{
    "body": "<a id='comment:15'></a>\nI have encontered no problems building sage with this patch. I have tried both upgrading from 6.7 and a fresh install.",
    "created_at": "2015-05-29T10:39:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320422",
    "user": "https://github.com/lftabera"
}
```

<a id='comment:15'></a>
I have encontered no problems building sage with this patch. I have tried both upgrading from 6.7 and a fresh install.



---

archive/issue_comments_320423.json:
```json
{
    "body": "<a id='comment:16'></a>\n... and tests passed. Together with[comment:15](#comment%3A15) I guess it's a positive review.\n\nBut I had chosen the name of the class method different from the Python standard function `all()`  ;-)",
    "created_at": "2015-05-29T10:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320423",
    "user": "https://github.com/wluebbe"
}
```

<a id='comment:16'></a>
... and tests passed. Together with[comment:15](#comment%3A15) I guess it's a positive review.

But I had chosen the name of the class method different from the Python standard function `all()`  ;-)



---

archive/issue_comments_320424.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-05-29T10:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320424",
    "user": "https://github.com/wluebbe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_320425.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Wilfried L\u00fcbbe\"",
    "created_at": "2015-05-29T10:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320425",
    "user": "https://github.com/wluebbe"
}
```

Changing reviewer from "" to "Wilfried Lübbe"



---

archive/issue_events_067046.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-29T19:09:37Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18535#event-67046"
}
```



---

archive/issue_comments_320426.json:
```json
{
    "body": "Changing branch from \"u/vbraun/fix_python_tarball_names\" to \"a23e5d81f3a05139202aad3255ca0c0430d98295\"",
    "created_at": "2015-05-29T19:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320426",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vbraun/fix_python_tarball_names" to "a23e5d81f3a05139202aad3255ca0c0430d98295"



---

archive/issue_comments_320427.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-05-29T19:09:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320427",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_320428.json:
```json
{
    "body": "Changing reviewer from \"Wilfried L\u00fcbbe\" to \"Wilfried Luebbe\"",
    "created_at": "2015-07-26T15:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320428",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Wilfried Lübbe" to "Wilfried Luebbe"



---

archive/issue_comments_320429.json:
```json
{
    "body": "Changing commit from \"a23e5d81f3a05139202aad3255ca0c0430d98295\" to \"\"",
    "created_at": "2015-07-26T15:34:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18535",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18535#issuecomment-320429",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "a23e5d81f3a05139202aad3255ca0c0430d98295" to ""
