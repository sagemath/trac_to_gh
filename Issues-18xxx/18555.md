# Issue 18555: Pickling and otherwise enhancing global options

archive/issues_018318.json:
```json
{
    "body": "Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)\n\nIn addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it \"would be nice\" if we could implement the syntax used in the IPython configuration:\n\n```\n\n    A.options.foobar = 1\n\nin addition to\n\n    A.options(foobar=1)\n```\nThis ticket implements both of these features and, in addition, makes it possible to construct options classes dynamically.\n\nAs was also suggested on sage-dev, I have also renamed all of the global_options methods simply as options, with the global_options variants being deprecated. The \"stand-alone\" options classes such as `PartitionOoptions`, `TableauxOptions`, ... have also been deprecated and, instead, put inside their \"parent\" classes where they are accessible using the `options` method (`global_options` methods have been deprecated). This is cleaned up the code a little and it seems to speed up the sage start-up time. \n\nThe pickling is done by adding an extra `module` argument to the `GlobalOptions` that specifies the module which contains the class that the options are attached -- `name` of of the class defaults to the name of the options class but this can be explicitly set using the `options_class` argument. The options class is assumed to have an `options` method, and this is used to unpickle a pickle for an options class. `GlobalOptions` that do not arise as options methods for standard sage classes cannot be unpickled. The reason why the name of the module and class are passed, as strings, to `GlobalOptions` rather than the actual class is that this approach allows the options to be constructed during the initialisation of the (instance of the) class and, in turn, this allows the class to dynamically construct their options classes.\n\n\n\nCC:  @nathanncohen @tscrim\n\nKeywords: days78, options\n\nBranch/Commit: ba7dd9836386ed119c257d9bb42030149e091b47\n\nReviewer: Travis Scrimshaw\n\nAuthor: Andrew Mathas\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18555\n\n",
    "closed_at": "2016-07-12T07:25:18Z",
    "created_at": "2015-05-31T05:54:27Z",
    "labels": [
        "component: interfaces"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.3",
    "title": "Pickling and otherwise enhancing global options",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18555",
    "user": "https://github.com/AndrewAtLarge"
}
```
Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)

In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it "would be nice" if we could implement the syntax used in the IPython configuration:

```

    A.options.foobar = 1

in addition to

    A.options(foobar=1)
```
This ticket implements both of these features and, in addition, makes it possible to construct options classes dynamically.

As was also suggested on sage-dev, I have also renamed all of the global_options methods simply as options, with the global_options variants being deprecated. The "stand-alone" options classes such as `PartitionOoptions`, `TableauxOptions`, ... have also been deprecated and, instead, put inside their "parent" classes where they are accessible using the `options` method (`global_options` methods have been deprecated). This is cleaned up the code a little and it seems to speed up the sage start-up time. 

The pickling is done by adding an extra `module` argument to the `GlobalOptions` that specifies the module which contains the class that the options are attached -- `name` of of the class defaults to the name of the options class but this can be explicitly set using the `options_class` argument. The options class is assumed to have an `options` method, and this is used to unpickle a pickle for an options class. `GlobalOptions` that do not arise as options methods for standard sage classes cannot be unpickled. The reason why the name of the module and class are passed, as strings, to `GlobalOptions` rather than the actual class is that this approach allows the options to be constructed during the initialisation of the (instance of the) class and, in turn, this allows the class to dynamically construct their options classes.



CC:  @nathanncohen @tscrim

Keywords: days78, options

Branch/Commit: ba7dd9836386ed119c257d9bb42030149e091b47

Reviewer: Travis Scrimshaw

Author: Andrew Mathas

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18555





---

archive/issue_comments_264374.json:
```json
{
    "body": "Changing keywords from \"\" to \"options\".",
    "created_at": "2015-06-03T17:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264374",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing keywords from "" to "options".



---

archive/issue_comments_264375.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,17 @@\n+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems.\n \n+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it \"would be nice\" if we could implement the syntax used in the IPython configuration:\n+\n+```\n+\n+    A.options.foobar = 1\n+\n+in addition to\n+\n+    A.options(foobar=1)\n+```\n+\n+This (soon to be uploaded) patch will implement both of these features.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-06-03T17:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264375",
    "user": "https://github.com/AndrewAtLarge"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,17 @@
+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems.
 
+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it "would be nice" if we could implement the syntax used in the IPython configuration:
+
+```
+
+    A.options.foobar = 1
+
+in addition to
+
+    A.options(foobar=1)
+```
+
+This (soon to be uploaded) patch will implement both of these features.
 
 Comment: 1
 
```




---

archive/issue_comments_264376.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to interfaces.",
    "created_at": "2015-06-03T17:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264376",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing component from PLEASE CHANGE to interfaces.



---

archive/issue_comments_264377.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2015-06-03T17:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264377",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_264378.json:
```json
{
    "body": "<a id='comment:3'></a>As I am cleaning this up a related question comes to mind: the name `GlobalOptions` is slightly unfortunate because instances of this class are really just options for an associated family of objects. I can sort of forgive myself for using this name for the class, but in all of the instances of this class the associated \"parent\" classes have a `global_options` method that points back to its options class. This method is now being enshrined more firmly inside the code because it is exploited to allow pickling. I would be happier if these methods were simply called `options`, rather than `global_options`, even though this change would necessitate deprecating the existing `global_options` methods.\n\nThoughts?",
    "created_at": "2015-06-03T17:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264378",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:3'></a>As I am cleaning this up a related question comes to mind: the name `GlobalOptions` is slightly unfortunate because instances of this class are really just options for an associated family of objects. I can sort of forgive myself for using this name for the class, but in all of the instances of this class the associated "parent" classes have a `global_options` method that points back to its options class. This method is now being enshrined more firmly inside the code because it is exploited to allow pickling. I would be happier if these methods were simply called `options`, rather than `global_options`, even though this change would necessitate deprecating the existing `global_options` methods.

Thoughts?



---

archive/issue_comments_264379.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,18 @@\n+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)\n \n+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it \"would be nice\" if we could implement the syntax used in the IPython configuration:\n+\n+```\n+\n+    A.options.foobar = 1\n+\n+in addition to\n+\n+    A.options(foobar=1)\n+```\n+Implementing this is an enhancement, which is why this ticket is listed as an enhancement!\n+\n+This (soon to be uploaded) patch will implement both of these features.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-06-03T17:17:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264379",
    "user": "https://github.com/AndrewAtLarge"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,18 @@
+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)
 
+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it "would be nice" if we could implement the syntax used in the IPython configuration:
+
+```
+
+    A.options.foobar = 1
+
+in addition to
+
+    A.options(foobar=1)
+```
+Implementing this is an enhancement, which is why this ticket is listed as an enhancement!
+
+This (soon to be uploaded) patch will implement both of these features.
 
 Comment: 1
 
```




---

archive/issue_comments_264380.json:
```json
{
    "body": "<a id='comment:7'></a>New commits:",
    "created_at": "2015-06-03T18:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264380",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:7'></a>New commits:



---

archive/issue_comments_264381.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,18 @@\n+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)\n \n+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it \"would be nice\" if we could implement the syntax used in the IPython configuration:\n+\n+```\n+\n+    A.options.foobar = 1\n+\n+in addition to\n+\n+    A.options(foobar=1)\n+```\n+Implementing this is an enhancement, which is why this ticket is listed as an enhancement!\n+\n+The attached patch implements both of these features. There are a few failing doc-tests that I need to fix but is seems basically OK.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-06-03T18:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264381",
    "user": "https://github.com/AndrewAtLarge"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,18 @@
+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)
 
+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it "would be nice" if we could implement the syntax used in the IPython configuration:
+
+```
+
+    A.options.foobar = 1
+
+in addition to
+
+    A.options(foobar=1)
+```
+Implementing this is an enhancement, which is why this ticket is listed as an enhancement!
+
+The attached patch implements both of these features. There are a few failing doc-tests that I need to fix but is seems basically OK.
 
 Comment: 1
 
```




---

archive/issue_comments_264382.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,18 @@\n+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)\n \n+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it \"would be nice\" if we could implement the syntax used in the IPython configuration:\n+\n+```\n+\n+    A.options.foobar = 1\n+\n+in addition to\n+\n+    A.options(foobar=1)\n+```\n+Implementing this is an enhancement, and most of the work, which is why this ticket is listed as an enhancement!\n+\n+The attached patch implements both of these features. There are a few failing doc-tests that I need to fix but is seems basically OK.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-06-03T18:20:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264382",
    "user": "https://github.com/AndrewAtLarge"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,18 @@
+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)
 
+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it "would be nice" if we could implement the syntax used in the IPython configuration:
+
+```
+
+    A.options.foobar = 1
+
+in addition to
+
+    A.options(foobar=1)
+```
+Implementing this is an enhancement, and most of the work, which is why this ticket is listed as an enhancement!
+
+The attached patch implements both of these features. There are a few failing doc-tests that I need to fix but is seems basically OK.
 
 Comment: 1
 
```




---

archive/issue_comments_264383.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-06-26T10:58:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264383",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264384.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,20 @@\n+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)\n \n+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it \"would be nice\" if we could implement the syntax used in the IPython configuration:\n+\n+```\n+\n+    A.options.foobar = 1\n+\n+in addition to\n+\n+    A.options(foobar=1)\n+```\n+ This ticket implements both of these features and, in addition, makes it possible to construct options classes dynamically.\n+\n+The pickling is done by adding an extra `module` argument to the `GlobalOptions` that specifies the module which contains the class that the options are attached -- `name` of of the class defaults to the name of the options class but this can be explicitly set using the `options_class` argument. The options class is assumed to have an `options` method, and this is used to unpickle a pickle for an options class. `GlobalOptions` that do not arise as options methods for standard sage classes cannot be unpickled. The reason why the name of the module and class are passed, as strings, to `GlobalOptions` rather than the actual class is that this approach allows the options to be constructed during the initialisation of the (instance of the) class and, in turn, this allows the class to dynamically construct their options classes.\n+\n+As suggested on sage-dev I have also renamed all of the global_options methods simply as options, with the global_options variants being deprecated. The \"stand-alone\" options classes such as `PartitionOoptions`, `TableauxOptions`, ... have also been deprecated and, instead, put inside their \"parent\" classes. This is cleaned up the code a little and it seems to speed up the sage start-up time. \n \n Comment: 1\n \n```\n",
    "created_at": "2016-06-26T11:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264384",
    "user": "https://github.com/AndrewAtLarge"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,20 @@
+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)
 
+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it "would be nice" if we could implement the syntax used in the IPython configuration:
+
+```
+
+    A.options.foobar = 1
+
+in addition to
+
+    A.options(foobar=1)
+```
+ This ticket implements both of these features and, in addition, makes it possible to construct options classes dynamically.
+
+The pickling is done by adding an extra `module` argument to the `GlobalOptions` that specifies the module which contains the class that the options are attached -- `name` of of the class defaults to the name of the options class but this can be explicitly set using the `options_class` argument. The options class is assumed to have an `options` method, and this is used to unpickle a pickle for an options class. `GlobalOptions` that do not arise as options methods for standard sage classes cannot be unpickled. The reason why the name of the module and class are passed, as strings, to `GlobalOptions` rather than the actual class is that this approach allows the options to be constructed during the initialisation of the (instance of the) class and, in turn, this allows the class to dynamically construct their options classes.
+
+As suggested on sage-dev I have also renamed all of the global_options methods simply as options, with the global_options variants being deprecated. The "stand-alone" options classes such as `PartitionOoptions`, `TableauxOptions`, ... have also been deprecated and, instead, put inside their "parent" classes. This is cleaned up the code a little and it seems to speed up the sage start-up time. 
 
 Comment: 1
 
```




---

archive/issue_comments_264385.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-06-26T11:48:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264385",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264386.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:11 git]:\n\nThis was to remove 20618 from the commit tree as it shouldn't have been there...",
    "created_at": "2016-06-26T11:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264386",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:12'></a>Replying to [comment:11 git]:

This was to remove 20618 from the commit tree as it shouldn't have been there...



---

archive/issue_comments_264387.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-07-02T00:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264387",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_264388.json:
```json
{
    "body": "<a id='comment:13'></a>Okay, I fixed the doctest failures with `permutation.py`. The issue was that the `_Option` (now `Option` so it appears in the doc) did not define a `__ne__` method, and so it returned `True` for things like `opt != X` even when `opt == X`.\n\nThe other doctest failures were due to lack of conversion to `options` from `global_options`.\n\nThis is a very nice improvement over the current interface to (global) options. If the doctest pass for you and my changes are good, then you can set this to a positive review.\n\n---\nNew commits:",
    "created_at": "2016-07-02T00:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264388",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:13'></a>Okay, I fixed the doctest failures with `permutation.py`. The issue was that the `_Option` (now `Option` so it appears in the doc) did not define a `__ne__` method, and so it returned `True` for things like `opt != X` even when `opt == X`.

The other doctest failures were due to lack of conversion to `options` from `global_options`.

This is a very nice improvement over the current interface to (global) options. If the doctest pass for you and my changes are good, then you can set this to a positive review.

---
New commits:



---

archive/issue_comments_264389.json:
```json
{
    "body": "Changing keywords from \"options\" to \"days78, options\".",
    "created_at": "2016-07-02T00:58:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264389",
    "user": "https://github.com/tscrim"
}
```

Changing keywords from "options" to "days78, options".



---

archive/issue_comments_264390.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-04T15:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264390",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264391.json:
```json
{
    "body": "<a id='comment:15'></a>There's some doc issues in the `manifold.py` options: `EXAMPLES::` and everything including and after `sage: latex(f)` is over indented.",
    "created_at": "2016-07-05T07:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264391",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:15'></a>There's some doc issues in the `manifold.py` options: `EXAMPLES::` and everything including and after `sage: latex(f)` is over indented.



---

archive/issue_comments_264392.json:
```json
{
    "body": "<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-05T10:17:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264392",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264393.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,21 @@\n+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)\n+\n+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it \"would be nice\" if we could implement the syntax used in the IPython configuration:\n+\n+```\n+\n+    A.options.foobar = 1\n+\n+in addition to\n+\n+    A.options(foobar=1)\n+```\n+This ticket implements both of these features and, in addition, makes it possible to construct options classes dynamically.\n+\n+As was also suggested on sage-dev, I have also renamed all of the global_options methods simply as options, with the global_options variants being deprecated. The \"stand-alone\" options classes such as `PartitionOoptions`, `TableauxOptions`, ... have also been deprecated and, instead, put inside their \"parent\" classes where they are accessible using the `options` method (`global_options` methods have been deprecated). This is cleaned up the code a little and it seems to speed up the sage start-up time. \n+\n+The pickling is done by adding an extra `module` argument to the `GlobalOptions` that specifies the module which contains the class that the options are attached -- `name` of of the class defaults to the name of the options class but this can be explicitly set using the `options_class` argument. The options class is assumed to have an `options` method, and this is used to unpickle a pickle for an options class. `GlobalOptions` that do not arise as options methods for standard sage classes cannot be unpickled. The reason why the name of the module and class are passed, as strings, to `GlobalOptions` rather than the actual class is that this approach allows the options to be constructed during the initialisation of the (instance of the) class and, in turn, this allows the class to dynamically construct their options classes.\n+\n \n \n Comment: 1\n```\n",
    "created_at": "2016-07-05T10:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264393",
    "user": "https://github.com/AndrewAtLarge"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,21 @@
+Instances of the [GlobalOptions](http://doc.sagemath.org/html/en/reference/structure/sage/structure/global_options.html) class in `sage.structure.global_options` do not pickle, which is annoying and causes various problems. (This is a defect.)
+
+In addition, when the `GlobalOptions` class was introduced it was suggested in [sage-dev](https://groups.google.com/forum/#!searchin/sage-devel/globabloptions/sage-devel/7ApZgwBTU4U/Qe6QoeuYgvAJ) that it "would be nice" if we could implement the syntax used in the IPython configuration:
+
+```
+
+    A.options.foobar = 1
+
+in addition to
+
+    A.options(foobar=1)
+```
+This ticket implements both of these features and, in addition, makes it possible to construct options classes dynamically.
+
+As was also suggested on sage-dev, I have also renamed all of the global_options methods simply as options, with the global_options variants being deprecated. The "stand-alone" options classes such as `PartitionOoptions`, `TableauxOptions`, ... have also been deprecated and, instead, put inside their "parent" classes where they are accessible using the `options` method (`global_options` methods have been deprecated). This is cleaned up the code a little and it seems to speed up the sage start-up time. 
+
+The pickling is done by adding an extra `module` argument to the `GlobalOptions` that specifies the module which contains the class that the options are attached -- `name` of of the class defaults to the name of the options class but this can be explicitly set using the `options_class` argument. The options class is assumed to have an `options` method, and this is used to unpickle a pickle for an options class. `GlobalOptions` that do not arise as options methods for standard sage classes cannot be unpickled. The reason why the name of the module and class are passed, as strings, to `GlobalOptions` rather than the actual class is that this approach allows the options to be constructed during the initialisation of the (instance of the) class and, in turn, this allows the class to dynamically construct their options classes.
+
 
 
 Comment: 1
```




---

archive/issue_comments_264394.json:
```json
{
    "body": "<a id='comment:17'></a>Thanks Travis. Fixed. I have also cleaned up the deprecation messages, putting them in the same place, so that they will be easier to remove in future.\n\nFinally, should the `reset` method be `_reset()` or `Reset()`? Currently it is `_reset()` but it probably shouldn't be hidden.",
    "created_at": "2016-07-05T10:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264394",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:17'></a>Thanks Travis. Fixed. I have also cleaned up the deprecation messages, putting them in the same place, so that they will be easier to remove in future.

Finally, should the `reset` method be `_reset()` or `Reset()`? Currently it is `_reset()` but it probably shouldn't be hidden.



---

archive/issue_events_052148.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-07-06T08:18:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "milestone": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18555#event-52148"
}
```



---

archive/issue_comments_264395.json:
```json
{
    "body": "<a id='comment:18'></a>`Reset()` breaks python conventions, so that is a -1 from me. I think `reset()` or `_reset()` are both fine. Yet there is not so much a good general reason to go back to defaults other than for testing purposes in my mind. Hence the hidden `_reset()` is better IMO.\n\nOne last thing, you added an `__init__` method in `interval_poset.py`. Is this necessary? If so, it needs a doctest. Once this is done, this will be at a positive review.",
    "created_at": "2016-07-06T08:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264395",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:18'></a>`Reset()` breaks python conventions, so that is a -1 from me. I think `reset()` or `_reset()` are both fine. Yet there is not so much a good general reason to go back to defaults other than for testing purposes in my mind. Hence the hidden `_reset()` is better IMO.

One last thing, you added an `__init__` method in `interval_poset.py`. Is this necessary? If so, it needs a doctest. Once this is done, this will be at a positive review.



---

archive/issue_comments_264396.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-06T11:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264396",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264397.json:
```json
{
    "body": "<a id='comment:20'></a>Fixed -- not sure how that got in there. Thanks Travis!",
    "created_at": "2016-07-06T11:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264397",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:20'></a>Fixed -- not sure how that got in there. Thanks Travis!



---

archive/issue_comments_264398.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-07-06T11:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264398",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_264399.json:
```json
{
    "body": "<a id='comment:21'></a>Reviewer name is missing",
    "created_at": "2016-07-06T19:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264399",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:21'></a>Reviewer name is missing



---

archive/issue_comments_264400.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-07-06T19:56:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264400",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264401.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-07-06T21:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264401",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_264402.json:
```json
{
    "body": "<a id='comment:23'></a>Merge conflict, try next beta",
    "created_at": "2016-07-07T19:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264402",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:23'></a>Merge conflict, try next beta



---

archive/issue_comments_264403.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-07-07T19:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264403",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264404.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-08T15:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264404",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264405.json:
```json
{
    "body": "<a id='comment:25'></a>Merged into 7.3.beta7. Tests pass.",
    "created_at": "2016-07-08T15:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264405",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:25'></a>Merged into 7.3.beta7. Tests pass.



---

archive/issue_comments_264406.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-07-08T15:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264406",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_264407.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-07-09T16:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264407",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264408.json:
```json
{
    "body": "<a id='comment:26'></a>Fails on 32-bit\n\n```\nsage -t --long src/sage/structure/global_options.py\n**********************************************************************\nFile \"src/sage/structure/global_options.py\", line 599, in sage.structure.global_options.Option.__hash__\nFailed example:\n    hash( Tableaux.options.convention ) # indirect doc-test\nExpected:\n    -6673246059928475433\nGot:\n    -1691342633\n**********************************************************************\n1 item had failures:\n   1 of   2 in sage.structure.global_options.Option.__hash__\n    [135 tests, 1 failure, 0.03 s]\n```",
    "created_at": "2016-07-09T16:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264408",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:26'></a>Fails on 32-bit

```
sage -t --long src/sage/structure/global_options.py
**********************************************************************
File "src/sage/structure/global_options.py", line 599, in sage.structure.global_options.Option.__hash__
Failed example:
    hash( Tableaux.options.convention ) # indirect doc-test
Expected:
    -6673246059928475433
Got:
    -1691342633
**********************************************************************
1 item had failures:
   1 of   2 in sage.structure.global_options.Option.__hash__
    [135 tests, 1 failure, 0.03 s]
```



---

archive/issue_comments_264409.json:
```json
{
    "body": "<a id='comment:27'></a>This just needs to mark the different output as `# 32-bit` and `# 64-bit`, but I'd change the actual test to `hash(Tableaux.options.convention) == hash(Tableaux.options('convention')` (it also doesn't need the `# indirect doctest` marker). Sorry for not catching that sooner.",
    "created_at": "2016-07-09T19:04:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264409",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:27'></a>This just needs to mark the different output as `# 32-bit` and `# 64-bit`, but I'd change the actual test to `hash(Tableaux.options.convention) == hash(Tableaux.options('convention')` (it also doesn't need the `# indirect doctest` marker). Sorry for not catching that sooner.



---

archive/issue_comments_264410.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-07-11T10:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264410",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264411.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-07-11T11:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264411",
    "user": "https://github.com/AndrewAtLarge"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_264412.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:27 tscrim]:\n> This just needs to mark the different output as `# 32-bit` and `# 64-bit`, but I'd change the actual test to `hash(Tableaux.options.convention) == hash(Tableaux.options('convention')` (it also doesn't need the `# indirect doctest` marker). Sorry for not catching that sooner.\n\n\nThanks Travis! Fixed and changed back to a positive review.",
    "created_at": "2016-07-11T11:00:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264412",
    "user": "https://github.com/AndrewAtLarge"
}
```

<a id='comment:29'></a>Replying to [comment:27 tscrim]:
> This just needs to mark the different output as `# 32-bit` and `# 64-bit`, but I'd change the actual test to `hash(Tableaux.options.convention) == hash(Tableaux.options('convention')` (it also doesn't need the `# indirect doctest` marker). Sorry for not catching that sooner.


Thanks Travis! Fixed and changed back to a positive review.



---

archive/issue_comments_264413.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-07-12T07:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18555#issuecomment-264413",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_052149.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-07-12T07:25:18Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18555",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18555#event-52149"
}
```
