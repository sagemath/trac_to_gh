# Issue 18791: Matroid k-connectivity

archive/issues_018554.json:
```json
{
    "assignees": [],
    "body": "Decide if a matroid is k-connected using matroid intersection.\n\nCC:  @sagetrac-Stefan @sagetrac-yomcat @sagetrac-Rudi\n\nComponent: **matroid theory**\n\nAuthor: **Chao Xu**\n\nBranch/Commit: **[`a5ec517`](https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577)**\n\nReviewer: **Rudi Pendavingh**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18791_\n\n",
    "closed_at": "2015-07-27T15:15:40Z",
    "created_at": "2015-06-26T11:30:25Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20matroid%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Matroid k-connectivity",
    "type": "issue",
    "updated_at": "2015-07-27T15:15:40Z",
    "url": "https://github.com/sagemath/sage/issues/18791",
    "user": "https://github.com/chaoxu"
}
```
Decide if a matroid is k-connected using matroid intersection.

CC:  @sagetrac-Stefan @sagetrac-yomcat @sagetrac-Rudi

Component: **matroid theory**

Author: **Chao Xu**

Branch/Commit: **[`a5ec517`](https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577)**

Reviewer: **Rudi Pendavingh**

_Issue created by migration from https://trac.sagemath.org/ticket/18791_





---

archive/issue_events_264499.json:
```json
{
    "actor": "https://github.com/chaoxu",
    "created_at": "2015-06-26T11:30:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264499"
}
```



---

archive/issue_events_264500.json:
```json
{
    "actor": "https://github.com/chaoxu",
    "created_at": "2015-06-26T11:30:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20matroid%20theory",
    "label_color": "0000ff",
    "label_name": "c: matroid theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264500"
}
```



---

archive/issue_events_264501.json:
```json
{
    "actor": "https://github.com/chaoxu",
    "created_at": "2015-06-26T11:30:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264501"
}
```



---

archive/issue_events_264502.json:
```json
{
    "actor": "https://github.com/chaoxu",
    "created_at": "2015-06-26T11:30:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264502"
}
```



---

archive/issue_comments_262491.json:
```json
{
    "body": "Branch: **[u/chaoxu/k-connectivity-intersection](https://github.com/sagemath/sagetrac-mirror/tree/u/chaoxu/k-connectivity-intersection)**",
    "created_at": "2015-06-26T11:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262491",
    "user": "https://github.com/chaoxu"
}
```

Branch: **[u/chaoxu/k-connectivity-intersection](https://github.com/sagemath/sagetrac-mirror/tree/u/chaoxu/k-connectivity-intersection)**



---

archive/issue_comments_262492.json:
```json
{
    "body": "Commit: **[`87d7ff6`](https://github.com/sagemath/sagetrac-mirror/commit/87d7ff6812f5525c82e717290d3c25df62e5b4ad)**",
    "created_at": "2015-07-18T05:22:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262492",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`87d7ff6`](https://github.com/sagemath/sagetrac-mirror/commit/87d7ff6812f5525c82e717290d3c25df62e5b4ad)**



---

archive/issue_comments_262493.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1580f05f6920579da6028dfa34c371e7aa9167b0\"><code>1580f05</code></a></td><td><code>Merge branch 'develop' into u/chaoxu/k-connectivity-intersection</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d7e76418fd52b269ba39f1636e0a143ce05940b7\"><code>d7e7641</code></a></td><td><code>last merge problem</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d45914a13d4a31e5cc1c7075097603bb2763461b\"><code>d45914a</code></a></td><td><code>Merge branch 'develop' into u/chaoxu/k-connectivity-intersection</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/87d7ff6812f5525c82e717290d3c25df62e5b4ad\"><code>87d7ff6</code></a></td><td><code>using the linking code to compute k-connectivity</code></td></tr></table>\n",
    "created_at": "2015-07-18T05:22:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262493",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1580f05f6920579da6028dfa34c371e7aa9167b0"><code>1580f05</code></a></td><td><code>Merge branch 'develop' into u/chaoxu/k-connectivity-intersection</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d7e76418fd52b269ba39f1636e0a143ce05940b7"><code>d7e7641</code></a></td><td><code>last merge problem</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d45914a13d4a31e5cc1c7075097603bb2763461b"><code>d45914a</code></a></td><td><code>Merge branch 'develop' into u/chaoxu/k-connectivity-intersection</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/87d7ff6812f5525c82e717290d3c25df62e5b4ad"><code>87d7ff6</code></a></td><td><code>using the linking code to compute k-connectivity</code></td></tr></table>




---

archive/issue_events_264503.json:
```json
{
    "actor": "https://github.com/chaoxu",
    "created_at": "2015-07-18T05:22:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264503"
}
```



---

archive/issue_comments_262494.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHi Chao,\n\njust saw that you had finished this one. I have some comments on the code below:\n\n```\n        m = k-1\n        E = set(self.groundset())\n        w = {e:1 for e in E}\n        Q = set(list(E)[:m])\n        E = E-Q\n        for r in range(len(Q)/2):\n            for Q1 in map(set,combinations(Q, r)):\n                Q2 = Q-Q1\n                # Given Q1, Q2 partition of Q, find all extensions\n                for A in map(set,combinations(E, m - len(Q1))):\n                    T = Q1|A\n                    for B in map(set,combinations(E-A, m - len(Q2))):\n                        S = Q2|B\n                        I, _ = self._link(S, T)\n                        if(len(I) - self.full_rank() + self.rank(S) + self.rank(T) < m):\n                            if certificate:\n                                return False, I\n                            return False\n```\n- w is defined but not used\n- `I` is not the min separation, but the max connector. If you have `I, X = self._link(S, T)`, then `return False, X`. You could even do without `I` if you tested the connectivity by `if self._connectivity(X)<m:`\n- if `r == len(Q)/2`, then the unordered pair {Q1, Q2} is generated and tested twice. \n\nThe set of pairs {S,T} tested by your code is what Bixby & Cunningham describe in their paper to argue that O(n<sup>k</sup>) connectivity tests are enough. It will not be possible to attain o(n<sup>k</sup>) pairs, but the constant hidden by the O() can be significantly better. \n\nE.g. in the r-th iteration, set aside r elements R from E-Q, also split R in all possible ways R1, R2, and then put S= Q1|R1|A, T=Q2|R2|B. The A and B you need are now smaller (|A|+|B| went down by r), hence fewer possibilities. Another optimization is this: once you are done testing all A containing a given e, you have established that e must be on the other side of the separation and so you may as well fix it in B, again reducing the number of possibilities for B. And this can be iterated of course.\n\nFor a positive review, it would be enough that you fix the above three points, and that the code passes some tests I will run of course. Optimizing the number of connectivity tests is not necessary, but would be appreciated. It is actually an interesting question what is the minimum number of tests as a function of n,k here.",
    "created_at": "2015-07-19T22:22:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262494",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:5" align="right">comment:5</div>

Hi Chao,

just saw that you had finished this one. I have some comments on the code below:

```
        m = k-1
        E = set(self.groundset())
        w = {e:1 for e in E}
        Q = set(list(E)[:m])
        E = E-Q
        for r in range(len(Q)/2):
            for Q1 in map(set,combinations(Q, r)):
                Q2 = Q-Q1
                # Given Q1, Q2 partition of Q, find all extensions
                for A in map(set,combinations(E, m - len(Q1))):
                    T = Q1|A
                    for B in map(set,combinations(E-A, m - len(Q2))):
                        S = Q2|B
                        I, _ = self._link(S, T)
                        if(len(I) - self.full_rank() + self.rank(S) + self.rank(T) < m):
                            if certificate:
                                return False, I
                            return False
```
- w is defined but not used
- `I` is not the min separation, but the max connector. If you have `I, X = self._link(S, T)`, then `return False, X`. You could even do without `I` if you tested the connectivity by `if self._connectivity(X)<m:`
- if `r == len(Q)/2`, then the unordered pair {Q1, Q2} is generated and tested twice. 

The set of pairs {S,T} tested by your code is what Bixby & Cunningham describe in their paper to argue that O(n<sup>k</sup>) connectivity tests are enough. It will not be possible to attain o(n<sup>k</sup>) pairs, but the constant hidden by the O() can be significantly better. 

E.g. in the r-th iteration, set aside r elements R from E-Q, also split R in all possible ways R1, R2, and then put S= Q1|R1|A, T=Q2|R2|B. The A and B you need are now smaller (|A|+|B| went down by r), hence fewer possibilities. Another optimization is this: once you are done testing all A containing a given e, you have established that e must be on the other side of the separation and so you may as well fix it in B, again reducing the number of possibilities for B. And this can be iterated of course.

For a positive review, it would be enough that you fix the above three points, and that the code passes some tests I will run of course. Optimizing the number of connectivity tests is not necessary, but would be appreciated. It is actually an interesting question what is the minimum number of tests as a function of n,k here.



---

archive/issue_comments_262495.json:
```json
{
    "body": "Changed commit from **[`87d7ff6`](https://github.com/sagemath/sagetrac-mirror/commit/87d7ff6812f5525c82e717290d3c25df62e5b4ad)** to **[`adac591`](https://github.com/sagemath/sagetrac-mirror/commit/adac5913ad0f8b4b21bcd1a231d3f26da5913a5d)**",
    "created_at": "2015-07-22T02:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262495",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`87d7ff6`](https://github.com/sagemath/sagetrac-mirror/commit/87d7ff6812f5525c82e717290d3c25df62e5b4ad)** to **[`adac591`](https://github.com/sagemath/sagetrac-mirror/commit/adac5913ad0f8b4b21bcd1a231d3f26da5913a5d)**



---

archive/issue_comments_262496.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c1844b12e32e1387a7ddaef17af99cee4836e6a2\"><code>c1844b1</code></a></td><td><code>fixing small problems</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/885b440ad73e88392a6d7628e06d0b41a579f94c\"><code>885b440</code></a></td><td><code>optimization</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/adac5913ad0f8b4b21bcd1a231d3f26da5913a5d\"><code>adac591</code></a></td><td><code>incorporate optimization, fixed a index bug</code></td></tr></table>\n",
    "created_at": "2015-07-22T02:10:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262496",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c1844b12e32e1387a7ddaef17af99cee4836e6a2"><code>c1844b1</code></a></td><td><code>fixing small problems</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/885b440ad73e88392a6d7628e06d0b41a579f94c"><code>885b440</code></a></td><td><code>optimization</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/adac5913ad0f8b4b21bcd1a231d3f26da5913a5d"><code>adac591</code></a></td><td><code>incorporate optimization, fixed a index bug</code></td></tr></table>




---

archive/issue_comments_262497.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nMade updates incorporating your suggestions. \n\nAlso fixed a bug. `r == len(Q)/2` case never happens because I was using `range(len(Q)/2)`. I should use `range(len(Q)/2+1)` instead.",
    "created_at": "2015-07-22T05:36:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262497",
    "user": "https://github.com/chaoxu"
}
```

<div id="comment:7" align="right">comment:7</div>

Made updates incorporating your suggestions. 

Also fixed a bug. `r == len(Q)/2` case never happens because I was using `range(len(Q)/2)`. I should use `range(len(Q)/2+1)` instead.



---

archive/issue_comments_262498.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThanks Chao. \n\nI'm getting a bug now:\n\n```\nsage: M= matroids.named_matroids.ExtendedBinaryGolayCode()\nsage: M.is_kconnected(5)\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"_sage_input_6.py\", line 10, in <module>\n    exec compile(u'open(\"___code___.py\",\"w\").write(\"# -*- coding: utf-8 -*-\\\\n\" + _support_.preparse_worksheet_cell(base64.b64decode(\"TS5pc19rY29ubmVjdGVkKDUp\"),globals())+\"\\\\n\"); execfile(os.path.abspath(\"___code___.py\"))\n  File \"\", line 1, in <module>\n    \n  File \"/private/var/folders/s7/fnz1zdzd12d3v1q0fns6sdww0000gn/T/tmpyBf3z_/___code___.py\", line 3, in <module>\n    exec compile(u'M.is_kconnected(_sage_const_5 )\n  File \"\", line 1, in <module>\n    \n  File \"sage/matroids/matroid.pyx\", line 4782, in sage.matroids.matroid.Matroid.is_kconnected (/Users/rudi/Documents/Development/sage-6.7/src/build/cythonized/sage/matroids/matroid.c:38299)\n  File \"sage/matroids/matroid.pyx\", line 4879, in sage.matroids.matroid.Matroid.is_kconnected (/Users/rudi/Documents/Development/sage-6.7/src/build/cythonized/sage/matroids/matroid.c:37668)\nValueError: r must be non-negative\n```",
    "created_at": "2015-07-22T07:03:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262498",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:8" align="right">comment:8</div>

Thanks Chao. 

I'm getting a bug now:

```
sage: M= matroids.named_matroids.ExtendedBinaryGolayCode()
sage: M.is_kconnected(5)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "_sage_input_6.py", line 10, in <module>
    exec compile(u'open("___code___.py","w").write("# -*- coding: utf-8 -*-\\n" + _support_.preparse_worksheet_cell(base64.b64decode("TS5pc19rY29ubmVjdGVkKDUp"),globals())+"\\n"); execfile(os.path.abspath("___code___.py"))
  File "", line 1, in <module>
    
  File "/private/var/folders/s7/fnz1zdzd12d3v1q0fns6sdww0000gn/T/tmpyBf3z_/___code___.py", line 3, in <module>
    exec compile(u'M.is_kconnected(_sage_const_5 )
  File "", line 1, in <module>
    
  File "sage/matroids/matroid.pyx", line 4782, in sage.matroids.matroid.Matroid.is_kconnected (/Users/rudi/Documents/Development/sage-6.7/src/build/cythonized/sage/matroids/matroid.c:38299)
  File "sage/matroids/matroid.pyx", line 4879, in sage.matroids.matroid.Matroid.is_kconnected (/Users/rudi/Documents/Development/sage-6.7/src/build/cythonized/sage/matroids/matroid.c:37668)
ValueError: r must be non-negative
```



---

archive/issue_comments_262499.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nYou use `self._connectivity(X, E-X)` now, but what I meant was `self.connectivity(X)`. That one simply computes rank(X)+rank(E-X)-rank(E), the other one does the whole matroid matching thing again.",
    "created_at": "2015-07-22T07:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262499",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:9" align="right">comment:9</div>

You use `self._connectivity(X, E-X)` now, but what I meant was `self.connectivity(X)`. That one simply computes rank(X)+rank(E-X)-rank(E), the other one does the whole matroid matching thing again.



---

archive/issue_comments_262500.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577\"><code>a5ec517</code></a></td><td><code>add the case when Q1|R1 is full</code></td></tr></table>\n",
    "created_at": "2015-07-22T14:52:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262500",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577"><code>a5ec517</code></a></td><td><code>add the case when Q1|R1 is full</code></td></tr></table>




---

archive/issue_comments_262501.json:
```json
{
    "body": "Changed commit from **[`adac591`](https://github.com/sagemath/sagetrac-mirror/commit/adac5913ad0f8b4b21bcd1a231d3f26da5913a5d)** to **[`a5ec517`](https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577)**",
    "created_at": "2015-07-22T14:52:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262501",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`adac591`](https://github.com/sagemath/sagetrac-mirror/commit/adac5913ad0f8b4b21bcd1a231d3f26da5913a5d)** to **[`a5ec517`](https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577)**



---

archive/issue_comments_262502.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nFixed.\nHmm, it's easy to introduce bugs with so many variables...",
    "created_at": "2015-07-23T03:07:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262502",
    "user": "https://github.com/chaoxu"
}
```

<div id="comment:11" align="right">comment:11</div>

Fixed.
Hmm, it's easy to introduce bugs with so many variables...



---

archive/issue_comments_262503.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nCode looks good to me. It's a lot faster than before too..\n\nI tested with\n\n```\ndef matroid_with_k_separation(r,n,k):\n    if r<=k or n<=2*k:\n        return\n    A=MatrixSpace(GF(293),r,n).random_element()\n    m = ZZ.random_element(k,n/2)\n    X = set(Subsets(range(n), m).random_element())\n    Y = set(range(n))-X\n    s = ZZ.random_element(max(m-n+r,0), min(m-k, r-k)+1)\n    for i in range(s+k, r):\n        for j in X:\n            A[i,j] =0\n    for i in range(s+1):\n        for j in Y:\n            A[i,j] =0        \n    return Matroid(A),X\n```\nto get a matroid with a k-separation and \n\n```\nk=5\nfor i in range(100):\n    M, X = matroid_with_k_separation(12,24,k-1)\n    print M\n    c, X = M.is_kconnected(k,True)\n    if c or M.connectivity(X)>k-1 or min(len(X), len(M.groundset()-X))<=M.connectivity(X):\n        print '!!'\n        break\n```\nto test-drive the code on some random examples. \n\nPositive review.",
    "created_at": "2015-07-24T15:06:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262503",
    "user": "https://github.com/sagetrac-Rudi"
}
```

<div id="comment:12" align="right">comment:12</div>

Code looks good to me. It's a lot faster than before too..

I tested with

```
def matroid_with_k_separation(r,n,k):
    if r<=k or n<=2*k:
        return
    A=MatrixSpace(GF(293),r,n).random_element()
    m = ZZ.random_element(k,n/2)
    X = set(Subsets(range(n), m).random_element())
    Y = set(range(n))-X
    s = ZZ.random_element(max(m-n+r,0), min(m-k, r-k)+1)
    for i in range(s+k, r):
        for j in X:
            A[i,j] =0
    for i in range(s+1):
        for j in Y:
            A[i,j] =0        
    return Matroid(A),X
```
to get a matroid with a k-separation and 

```
k=5
for i in range(100):
    M, X = matroid_with_k_separation(12,24,k-1)
    print M
    c, X = M.is_kconnected(k,True)
    if c or M.connectivity(X)>k-1 or min(len(X), len(M.groundset()-X))<=M.connectivity(X):
        print '!!'
        break
```
to test-drive the code on some random examples. 

Positive review.



---

archive/issue_events_264504.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2015-07-24T15:06:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264504"
}
```



---

archive/issue_events_264505.json:
```json
{
    "actor": "https://github.com/sagetrac-Rudi",
    "created_at": "2015-07-24T15:06:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264505"
}
```



---

archive/issue_comments_262504.json:
```json
{
    "body": "Reviewer: **Rudi Pendavingh**",
    "created_at": "2015-07-24T15:06:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262504",
    "user": "https://github.com/sagetrac-Rudi"
}
```

Reviewer: **Rudi Pendavingh**



---

archive/issue_comments_262505.json:
```json
{
    "body": "Author: **Chao Xu**",
    "created_at": "2015-07-24T15:06:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262505",
    "user": "https://github.com/sagetrac-Rudi"
}
```

Author: **Chao Xu**



---

archive/issue_comments_262506.json:
```json
{
    "body": "Changed branch from **[u/chaoxu/k-connectivity-intersection](https://github.com/sagemath/sagetrac-mirror/tree/u/chaoxu/k-connectivity-intersection)** to **[`a5ec517`](https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577)**",
    "created_at": "2015-07-27T15:15:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18791#issuecomment-262506",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/chaoxu/k-connectivity-intersection](https://github.com/sagemath/sagetrac-mirror/tree/u/chaoxu/k-connectivity-intersection)** to **[`a5ec517`](https://github.com/sagemath/sagetrac-mirror/commit/a5ec517a99ff130dd35a1f728bf081ac121c5577)**



---

archive/issue_events_264506.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-27T15:15:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264506"
}
```



---

archive/issue_events_264507.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "be37bdb2af7dab8765c4a557def9cf3ea497c1a1",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-07-27T15:15:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18791",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18791#event-264507"
}
```
