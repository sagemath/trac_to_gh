# Issue 18393: make Expression.series return an element of SR[[]]

archive/issues_018156.json:
```json
{
    "assignees": [],
    "body": "Instead of duplicating power series functionality (existing in `rings/`) in Pynac, where there is momentarily only a skeleton implementation that does not even play nice with the rest of symbolics, the `series` method of `Expression` should return an element of `PowerSeriesRing(SR)`.\n\nIt does not necessarily mean everything will be implemented in Python,\nPynac could still compute the series as Python object.\n\nCC:  @behackl\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18393_\n\n",
    "closed_at": "2015-06-19T08:40:41Z",
    "created_at": "2015-05-10T06:57:49Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20calculus",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "make Expression.series return an element of SR[[]]",
    "type": "issue",
    "updated_at": "2023-01-08T08:40:47Z",
    "url": "https://github.com/sagemath/sage/issues/18393",
    "user": "https://github.com/rwst"
}
```
Instead of duplicating power series functionality (existing in `rings/`) in Pynac, where there is momentarily only a skeleton implementation that does not even play nice with the rest of symbolics, the `series` method of `Expression` should return an element of `PowerSeriesRing(SR)`.

It does not necessarily mean everything will be implemented in Python,
Pynac could still compute the series as Python object.

CC:  @behackl

_Issue created by migration from https://trac.sagemath.org/ticket/18393_





---

archive/issue_events_234879.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-05-10T06:57:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20calculus",
    "label_color": "0000ff",
    "label_name": "component: calculus",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234879"
}
```



---

archive/issue_events_234880.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-05-10T06:57:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234880"
}
```



---

archive/issue_events_234881.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-05-10T06:57:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234881"
}
```



---

archive/issue_comments_255670.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,4 @@\n Instead of duplicating power series functionality (existing in `rings/`) in Pynac, where there is momentarily only a skeleton implementation that does not even play nice with the rest of symbolics, the `series` method of `Expression` should return an element of `PowerSeriesRing(SR)`.\n+\n+It does not necessarily mean everything will be implemented in Python,\n+Pynac could still compute the series as Python object.\n``````\n",
    "created_at": "2015-05-10T07:08:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255670",
    "user": "https://github.com/rwst"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,4 @@
 Instead of duplicating power series functionality (existing in `rings/`) in Pynac, where there is momentarily only a skeleton implementation that does not even play nice with the rest of symbolics, the `series` method of `Expression` should return an element of `PowerSeriesRing(SR)`.
+
+It does not necessarily mean everything will be implemented in Python,
+Pynac could still compute the series as Python object.
``````




---

archive/issue_comments_255671.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\n- What's the variable of `SR[[]]`? Does it support multivariate power series?\n  - How does `f=(x<sup>2+y</sup>2+1)` coerce into `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`? Note that `f` is already an element of `SR`, so by default it would be a \"constant\" in `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`.",
    "created_at": "2015-05-10T07:46:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255671",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:2'>Comment 2:</a>
- What's the variable of `SR[[]]`? Does it support multivariate power series?
  - How does `f=(x<sup>2+y</sup>2+1)` coerce into `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`? Note that `f` is already an element of `SR`, so by default it would be a "constant" in `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`.



---

archive/issue_comments_255672.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nReplying to [@nbruin](#comment%3A2):\n> - What's the variable of `SR[[]]`?\n\nA symbolic variable is given as argument of `series`. The ring variable will have the same name and thus override it on new input from the user.\n> Does it support multivariate power series?\n\nAt the moment `series` takes one symbol.\n> - How does `f=(x<sup>2+y</sup>2+1)` coerce into `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`? Note that `f` is already an element of `SR`, so by default it would be a \"constant\" in `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`.\n\nAs above the `series` argument determines the name of the series variable, so it also determines what is being done with the expression. Already now:\n\n```\nsage: (1+x+y).series(x,5)\n(y + 1) + 1*x\n```\n(However, the `coefficient` functions don't work with \"exact\" series atm)",
    "created_at": "2015-05-10T08:14:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255672",
    "user": "https://github.com/rwst"
}
```

<a id='comment:3'>Comment 3:</a>
Replying to [@nbruin](#comment%3A2):
> - What's the variable of `SR[[]]`?

A symbolic variable is given as argument of `series`. The ring variable will have the same name and thus override it on new input from the user.
> Does it support multivariate power series?

At the moment `series` takes one symbol.
> - How does `f=(x<sup>2+y</sup>2+1)` coerce into `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`? Note that `f` is already an element of `SR`, so by default it would be a "constant" in `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`.

As above the `series` argument determines the name of the series variable, so it also determines what is being done with the expression. Already now:

```
sage: (1+x+y).series(x,5)
(y + 1) + 1*x
```
(However, the `coefficient` functions don't work with "exact" series atm)



---

archive/issue_comments_255673.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nReplying to [@rwst](#comment%3A3):\n> > - How does `f=(x<sup>2+y</sup>2+1)` coerce into `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`? Note that `f` is already an element of `SR`, so by default it would be a \"constant\" in `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`.\n\n> As above the `series` argument determines the name of the series variable, so it also determines what is being done with the expression. Already now:\n\nThat's ambiguous and not what happens by default in our current coercion:\n\n```\nsage: R=PowerSeriesRing(SR,name='x',default_prec=10)\nsage: F=1/(1-R.0)\nsage: F-x\n-x + 1 + x + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)\nsage: F-R.0\n1 + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)\n```\nYou see that SR('x') doesn't coerce to R.0 in R. You'd have to override that somehow and that will be extremely messy: where does `sin(x)` coerce?",
    "created_at": "2015-05-10T15:58:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255673",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:4'>Comment 4:</a>
Replying to [@rwst](#comment%3A3):
> > - How does `f=(x<sup>2+y</sup>2+1)` coerce into `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`? Note that `f` is already an element of `SR`, so by default it would be a "constant" in `SR[This is the Trac macro *'x'* that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#'x'-macro)`.

> As above the `series` argument determines the name of the series variable, so it also determines what is being done with the expression. Already now:

That's ambiguous and not what happens by default in our current coercion:

```
sage: R=PowerSeriesRing(SR,name='x',default_prec=10)
sage: F=1/(1-R.0)
sage: F-x
-x + 1 + x + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)
sage: F-R.0
1 + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)
```
You see that SR('x') doesn't coerce to R.0 in R. You'd have to override that somehow and that will be extremely messy: where does `sin(x)` coerce?



---

archive/issue_comments_255674.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nReplying to [@nbruin](#comment%3A4):\n> That's ambiguous and not what happens by default in our current coercion:\n> \n> ```\n> sage: R=PowerSeriesRing(SR,name='x',default_prec=10)\n> sage: F=1/(1-R.0)\n> sage: F-x\n> -x + 1 + x + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)\n> sage: F-R.0\n> 1 + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)\n> ```\n> You see that SR('x') doesn't coerce to R.0 in R. You'd have to override that somehow and that will be extremely messy: where does `sin(x)` coerce?\n\nTo `sin(R.0)`, where is the problem? Of course it would expand to\n\n```\nx - 1/6*x^3 + 1/120*x^5 - 1/5040*x^7 + 1/362880*x^9 - 1/39916800*x^11 + 1/6227020800*x^13 - 1/1307674368000*x^15 + 1/355687428096000*x^17 - 1/121645100408832000*x^19 + Order(x^20)\n```",
    "created_at": "2015-05-10T16:06:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255674",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'>Comment 5:</a>
Replying to [@nbruin](#comment%3A4):
> That's ambiguous and not what happens by default in our current coercion:
> 
> ```
> sage: R=PowerSeriesRing(SR,name='x',default_prec=10)
> sage: F=1/(1-R.0)
> sage: F-x
> -x + 1 + x + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)
> sage: F-R.0
> 1 + x^2 + x^3 + x^4 + x^5 + x^6 + x^7 + x^8 + x^9 + O(x^10)
> ```
> You see that SR('x') doesn't coerce to R.0 in R. You'd have to override that somehow and that will be extremely messy: where does `sin(x)` coerce?

To `sin(R.0)`, where is the problem? Of course it would expand to

```
x - 1/6*x^3 + 1/120*x^5 - 1/5040*x^7 + 1/362880*x^9 - 1/39916800*x^11 + 1/6227020800*x^13 - 1/1307674368000*x^15 + 1/355687428096000*x^17 - 1/121645100408832000*x^19 + Order(x^20)
```



---

archive/issue_comments_255675.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nReplying to [@rwst](#comment%3A5):\n> where does `sin(x)` coerce?\n> To `sin(R.0)`, where is the problem? Of course it would expand to\n> \n> ```\n> x - 1/6*x^3 + 1/120*x^5 - 1/5040*x^7 + 1/362880*x^9 - 1/39916800*x^11 + 1/6227020800*x^13 - 1/1307674368000*x^15 + 1/355687428096000*x^17 - 1/121645100408832000*x^19 + Order(x^20)\n> ```\n\nThat will be quite a bit of work to arrange, but that's not what I meant: What are the results of\n\n```\nSR[['x']]( sin(SR('x')) )\nSR[['x']]( sin(SR('y')) )\n```\n(the main part: how are you going to arrive at those results? I'm not saying it's impossible to come up with something satisfactory. Just that there's some non-trivial work to be done)",
    "created_at": "2015-05-10T16:19:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255675",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:6'>Comment 6:</a>
Replying to [@rwst](#comment%3A5):
> where does `sin(x)` coerce?
> To `sin(R.0)`, where is the problem? Of course it would expand to
> 
> ```
> x - 1/6*x^3 + 1/120*x^5 - 1/5040*x^7 + 1/362880*x^9 - 1/39916800*x^11 + 1/6227020800*x^13 - 1/1307674368000*x^15 + 1/355687428096000*x^17 - 1/121645100408832000*x^19 + Order(x^20)
> ```

That will be quite a bit of work to arrange, but that's not what I meant: What are the results of

```
SR[['x']]( sin(SR('x')) )
SR[['x']]( sin(SR('y')) )
```
(the main part: how are you going to arrive at those results? I'm not saying it's impossible to come up with something satisfactory. Just that there's some non-trivial work to be done)



---

archive/issue_comments_255676.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@nbruin](#comment%3A6):\n> ...how are you going to arrive at those results? I'm not saying it's impossible to come up with something satisfactory. Just that there's some non-trivial work to be done)\n\nIt's just another expression converter, isn't it? BTW, `exp(x)` already does the desired thing. Though it's not dependent the work would also benefit from #17759 which itself depends on #18255.",
    "created_at": "2015-05-11T08:22:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255676",
    "user": "https://github.com/rwst"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@nbruin](#comment%3A6):
> ...how are you going to arrive at those results? I'm not saying it's impossible to come up with something satisfactory. Just that there's some non-trivial work to be done)

It's just another expression converter, isn't it? BTW, `exp(x)` already does the desired thing. Though it's not dependent the work would also benefit from #17759 which itself depends on #18255.



---

archive/issue_comments_255677.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nAh I see, `sin(x)` needs a second order DE. But Pari is able to do `sin` easily so there must be an algorithm.",
    "created_at": "2015-05-11T14:08:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255677",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'>Comment 8:</a>
Ah I see, `sin(x)` needs a second order DE. But Pari is able to do `sin` easily so there must be an algorithm.



---

archive/issue_comments_255678.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nPower series via Pari would be #15601, but actually Pynac is more complete here. It just needs the conversion to `PowerSeries`.",
    "created_at": "2015-05-11T14:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255678",
    "user": "https://github.com/rwst"
}
```

<a id='comment:9'>Comment 9:</a>
Power series via Pari would be #15601, but actually Pynac is more complete here. It just needs the conversion to `PowerSeries`.



---

archive/issue_events_234882.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-05-13T07:17:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234882"
}
```



---

archive/issue_comments_255679.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nI think my new posting in sage-devel (https://groups.google.com/forum/?hl=en#!topic/sage-devel/XhOhwjjeLTM) makes this ticket obsolete. Maybe we just need to change Pynac so that, if an expression contains a `pseries` it will be reexpanded (making the new order the min of all orders). What do you think?\n\nSurprise.",
    "created_at": "2015-05-13T07:17:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255679",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'>Comment 10:</a>
I think my new posting in sage-devel (https://groups.google.com/forum/?hl=en#!topic/sage-devel/XhOhwjjeLTM) makes this ticket obsolete. Maybe we just need to change Pynac so that, if an expression contains a `pseries` it will be reexpanded (making the new order the min of all orders). What do you think?

Surprise.



---

archive/issue_events_234883.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2015-05-13T07:17:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234883"
}
```



---

archive/issue_comments_255680.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nI think there is also a satisfying solution to the discussed interface problem. Instead of automatically creating a `PowerSeriesRing`, with all the problems of duplicate generators, the user will do this part and give the chosen generator as argument to `series` or simply use it as part of the expression.",
    "created_at": "2015-05-24T16:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255680",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'>Comment 11:</a>
I think there is also a satisfying solution to the discussed interface problem. Instead of automatically creating a `PowerSeriesRing`, with all the problems of duplicate generators, the user will do this part and give the chosen generator as argument to `series` or simply use it as part of the expression.



---

archive/issue_events_234884.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2015-05-25T10:17:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234884"
}
```



---

archive/issue_events_234885.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2015-05-25T10:17:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234885"
}
```



---

archive/issue_comments_255681.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@rwst](#comment%3A10):\n> I think my new posting in sage-devel (https://groups.google.com/forum/?hl=en#!topic/sage-devel/XhOhwjjeLTM) makes this ticket obsolete. Maybe we just need to change Pynac so that, if an expression contains a `pseries` it will be reexpanded (making the new order the min of all orders). What do you think?\n\nI'm not too convinced: calling `series()` is a bit like calling `expand()` or `normal()`, with symbolic expressions, you don't necessarily want that to happen automatically. And (FWIW) that's also what Maple does:\n\n```\n#-->s := series(sin(x),x);\ns := series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7)\n#-->t := series(exp(x),x);\nt := series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6)\n#-->s*t;\n(series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7))*(series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6))\n#-->series(s*t,x);\nseries(1*x+1*x^2+1/3*x^3-1/30*x^5+O(x^6),x,6)\n```\nBut perhaps I misunderstood the question?\n\nIn any case, I agree that this ticket can be closed.",
    "created_at": "2015-05-25T10:17:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255681",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@rwst](#comment%3A10):
> I think my new posting in sage-devel (https://groups.google.com/forum/?hl=en#!topic/sage-devel/XhOhwjjeLTM) makes this ticket obsolete. Maybe we just need to change Pynac so that, if an expression contains a `pseries` it will be reexpanded (making the new order the min of all orders). What do you think?

I'm not too convinced: calling `series()` is a bit like calling `expand()` or `normal()`, with symbolic expressions, you don't necessarily want that to happen automatically. And (FWIW) that's also what Maple does:

```
#-->s := series(sin(x),x);
s := series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7)
#-->t := series(exp(x),x);
t := series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6)
#-->s*t;
(series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7))*(series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6))
#-->series(s*t,x);
series(1*x+1*x^2+1/3*x^3-1/30*x^5+O(x^6),x,6)
```
But perhaps I misunderstood the question?

In any case, I agree that this ticket can be closed.



---

archive/issue_comments_255682.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nReplying to [@mezzarobba](#comment%3A12):\n> ...And (FWIW) that's also what Maple does:\n> \n> ```\n> #-->s := series(sin(x),x);\n> s := series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7)\n> #-->t := series(exp(x),x);\n> t := series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6)\n> #-->s*t;\n> (series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7))*(series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6))\n> #-->series(s*t,x);\n> series(1*x+1*x^2+1/3*x^3-1/30*x^5+O(x^6),x,6)\n> ```\n> But perhaps I misunderstood the question?\n\nInteresting. But that can be considered a bug and see the sage-devel link for a bug report. I mean, what else do you expect as result when dealing with a series? But I'll open a new ticket for that.",
    "created_at": "2015-05-25T13:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255682",
    "user": "https://github.com/rwst"
}
```

<a id='comment:13'>Comment 13:</a>
Replying to [@mezzarobba](#comment%3A12):
> ...And (FWIW) that's also what Maple does:
> 
> ```
> #-->s := series(sin(x),x);
> s := series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7)
> #-->t := series(exp(x),x);
> t := series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6)
> #-->s*t;
> (series(1*x-1/6*x^3+1/120*x^5+O(x^7),x,7))*(series(1+1*x+1/2*x^2+1/6*x^3+1/24*x^4+1/120*x^5+O(x^6),x,6))
> #-->series(s*t,x);
> series(1*x+1*x^2+1/3*x^3-1/30*x^5+O(x^6),x,6)
> ```
> But perhaps I misunderstood the question?

Interesting. But that can be considered a bug and see the sage-devel link for a bug report. I mean, what else do you expect as result when dealing with a series? But I'll open a new ticket for that.



---

archive/issue_comments_255683.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nReplying to [@rwst](#comment%3A13):\n> Interesting. But that can be considered a bug and see the sage-devel link for a bug report. I mean, what else do you expect as result when dealing with a series? But I'll open a new ticket for that.\n\nThe problem is: there are SR allows expressions of such generality that series expansions aren't always possible. Consider:\n\n```\nsage: function('f')\nsage: s=series(sin(x))\nsage: f(cos(x))+g\n```\nShould that be considered a series in x?\n\nAnd then there are of course the cases with well-defined functions as ingredients where you really can't make a series expansion:\n\n```\nsage: s=series(sin(x))\nsage: exp(1/x)+s\n```\n\nThe general problem is: an element of SR (and the fundamental data type in maple) is just an expression tree. Mathematical meaning is only obtained by *what* you do with the element (it's like an untyped programming language). That means you can do algebra with objects in SR that represent a series in such a way that you get another object that can't possibly be interpreted as a series.\nmaple (and apparently pynac by default) solves that problem by not even trying: they leave it to the user to do that, trusting that he/she will take care to only do that in situations where it is possible to interpret the result as a series.",
    "created_at": "2015-05-25T14:37:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255683",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:14'>Comment 14:</a>
Replying to [@rwst](#comment%3A13):
> Interesting. But that can be considered a bug and see the sage-devel link for a bug report. I mean, what else do you expect as result when dealing with a series? But I'll open a new ticket for that.

The problem is: there are SR allows expressions of such generality that series expansions aren't always possible. Consider:

```
sage: function('f')
sage: s=series(sin(x))
sage: f(cos(x))+g
```
Should that be considered a series in x?

And then there are of course the cases with well-defined functions as ingredients where you really can't make a series expansion:

```
sage: s=series(sin(x))
sage: exp(1/x)+s
```

The general problem is: an element of SR (and the fundamental data type in maple) is just an expression tree. Mathematical meaning is only obtained by *what* you do with the element (it's like an untyped programming language). That means you can do algebra with objects in SR that represent a series in such a way that you get another object that can't possibly be interpreted as a series.
maple (and apparently pynac by default) solves that problem by not even trying: they leave it to the user to do that, trusting that he/she will take care to only do that in situations where it is possible to interpret the result as a series.



---

archive/issue_comments_255684.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@nbruin](#comment%3A14):\n> The problem is: there are SR allows expressions of such generality that series expansions aren't always possible. Consider:\n> \n> ```\n> sage: function('f')\n> sage: s=series(sin(x))\n> sage: f(cos(x))+g\n> ```\n\n(I guess `g` should be `s`?)\n\n> Should that be considered a series in x?\n\nHere Maple does (when one explicitly asks for a series expansion, of course):\n\n```\n#-->series(f(cos(x)) + sin(x), x);\nseries(f(1)+1*x+(-1/2*D(f)(1))*x^2-1/6*x^3+(1/24*D(f)(1)+1/8*`@@`(D,2)(f)(1))*x^4+1/120*x^5+O(x^6),x,6)\n```\nand I found that convenient on many occasions. But I seem to rememer that ginac can do something similar.",
    "created_at": "2015-05-25T15:16:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255684",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@nbruin](#comment%3A14):
> The problem is: there are SR allows expressions of such generality that series expansions aren't always possible. Consider:
> 
> ```
> sage: function('f')
> sage: s=series(sin(x))
> sage: f(cos(x))+g
> ```

(I guess `g` should be `s`?)

> Should that be considered a series in x?

Here Maple does (when one explicitly asks for a series expansion, of course):

```
#-->series(f(cos(x)) + sin(x), x);
series(f(1)+1*x+(-1/2*D(f)(1))*x^2-1/6*x^3+(1/24*D(f)(1)+1/8*`@@`(D,2)(f)(1))*x^4+1/120*x^5+O(x^6),x,6)
```
and I found that convenient on many occasions. But I seem to rememer that ginac can do something similar.



---

archive/issue_comments_255685.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nFollowup tickets: #18499, #18500",
    "created_at": "2015-05-25T15:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18393#issuecomment-255685",
    "user": "https://github.com/rwst"
}
```

<a id='comment:16'>Comment 16:</a>
Followup tickets: #18499, #18500



---

archive/issue_events_234886.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-19T08:40:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234886"
}
```



---

archive/issue_events_234887.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-19T08:40:41Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18393",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18393#event-234887"
}
```
