# Issue 18453: Infinite affine crystals should use extended weight lattice

archive/issues_018216.json:
```json
{
    "assignees": [],
    "body": "Infinite affine crystals should use the extended weight lattice. This would include both B(infinity) crystals and crystals of integrable representations.\n\nHere is an example.\n\n```\nsage: C = crystals.infinity.NakajimaMonomials(['A',1,1])\nsage: v=C.highest_weight_vector()\nsage: v.f(1).weight()+v.f(0).weight()\n0\n```\n\nThe answer should be `-delta`. The problem is that the extended weight lattice is not being used.\n\n\n\nCC:  @sagetrac-sage-combinat @bsalisbury1 @tscrim @anneschilling @nthiery @sagetrac-ptingley\n\nComponent: **combinatorics**\n\nKeywords: **crystals, days65**\n\nAuthor: **Ben Salisbury, Anne Schilling, Travis Scrimshaw**\n\nBranch: **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)**\n\nReviewer: **Dan Bump**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18453_\n\n",
    "closed_at": "2015-06-15T21:56:58Z",
    "created_at": "2015-05-19T16:27:36Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Infinite affine crystals should use extended weight lattice",
    "type": "issue",
    "updated_at": "2015-06-29T14:01:27Z",
    "url": "https://github.com/sagemath/sage/issues/18453",
    "user": "https://github.com/dwbump"
}
```
Infinite affine crystals should use the extended weight lattice. This would include both B(infinity) crystals and crystals of integrable representations.

Here is an example.

```
sage: C = crystals.infinity.NakajimaMonomials(['A',1,1])
sage: v=C.highest_weight_vector()
sage: v.f(1).weight()+v.f(0).weight()
0
```

The answer should be `-delta`. The problem is that the extended weight lattice is not being used.



CC:  @sagetrac-sage-combinat @bsalisbury1 @tscrim @anneschilling @nthiery @sagetrac-ptingley

Component: **combinatorics**

Keywords: **crystals, days65**

Author: **Ben Salisbury, Anne Schilling, Travis Scrimshaw**

Branch: **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)**

Reviewer: **Dan Bump**

_Issue created by migration from https://trac.sagemath.org/ticket/18453_





---

archive/issue_events_259915.json:
```json
{
    "actor": "https://github.com/dwbump",
    "created_at": "2015-05-19T16:27:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259915"
}
```



---

archive/issue_events_259916.json:
```json
{
    "actor": "https://github.com/dwbump",
    "created_at": "2015-05-19T16:27:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259916"
}
```



---

archive/issue_events_259917.json:
```json
{
    "actor": "https://github.com/dwbump",
    "created_at": "2015-05-19T16:33:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259917"
}
```



---

archive/issue_events_259918.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-05-19T18:51:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20combinatorics",
    "label_color": "0000ff",
    "label_name": "c: combinatorics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259918"
}
```



---

archive/issue_comments_254528.json:
```json
{
    "body": "Changed keywords from none to **crystals**",
    "created_at": "2015-05-19T18:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254528",
    "user": "https://github.com/tscrim"
}
```

Changed keywords from none to **crystals**



---

archive/issue_comments_254529.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nMy proposal is to change the default value for the weight lattice to be the extended version by default since it would have the proper dimension and is the more natural thing to do weight computations in. As a result, we should create a new category for U<sub>q</sub>'(g)-crystals which uses the non-extended weight lattice. This would give us:\n\n- greater flexibility long-term to implement generic methods for things like energy, R-matrices, and perfectness,\n- better support once I patch up morphisms (#15463), and\n- allow us to fix a (IMO) hack in the default plotting options of 0 arrows of not reversing them by checking if a crystal is not in the category of highest weight crystals.\n\nAt least to fix this ticket, I don't think there would be much work. However it would be a backwards-incompatible change; although I think it would be mild.",
    "created_at": "2015-05-19T18:51:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254529",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:3" align="right">comment:3</div>

My proposal is to change the default value for the weight lattice to be the extended version by default since it would have the proper dimension and is the more natural thing to do weight computations in. As a result, we should create a new category for U<sub>q</sub>'(g)-crystals which uses the non-extended weight lattice. This would give us:

- greater flexibility long-term to implement generic methods for things like energy, R-matrices, and perfectness,
- better support once I patch up morphisms (#15463), and
- allow us to fix a (IMO) hack in the default plotting options of 0 arrows of not reversing them by checking if a crystal is not in the category of highest weight crystals.

At least to fix this ticket, I don't think there would be much work. However it would be a backwards-incompatible change; although I think it would be mild.



---

archive/issue_comments_254530.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThere may be cases where one does not want the extended weight lattice. For example Kirillov-Reshetikhin crystals, I think it would complicate things if you used the extended weight lattice.\n\nThis is addressed by Travis' proposal since he would create a new category for finite crystals that use the non-extended weight lattice.\n\nThe alternative way of fixing things would be to find the places where the wrong weight lattice is created (for example in the !__classcall_private!__ method o `InfinityCrystalOfNakajimaMonomials` and add `extended=True` to the parameters of `weight_lattice`. Both ways would fix the problem.\n\nOne question is whether we more often than not want affine weight lattices to be extended. I myself do. So I would support Travis' proposal but I am pointing out that there is an alternative.",
    "created_at": "2015-05-19T19:44:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254530",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:4" align="right">comment:4</div>

There may be cases where one does not want the extended weight lattice. For example Kirillov-Reshetikhin crystals, I think it would complicate things if you used the extended weight lattice.

This is addressed by Travis' proposal since he would create a new category for finite crystals that use the non-extended weight lattice.

The alternative way of fixing things would be to find the places where the wrong weight lattice is created (for example in the !__classcall_private!__ method o `InfinityCrystalOfNakajimaMonomials` and add `extended=True` to the parameters of `weight_lattice`. Both ways would fix the problem.

One question is whether we more often than not want affine weight lattices to be extended. I myself do. So I would support Travis' proposal but I am pointing out that there is an alternative.



---

archive/issue_comments_254531.json:
```json
{
    "body": "Commit: **[`b4a7647`](https://github.com/sagemath/sagetrac-mirror/commit/b4a764743046481af4a6bb88ca353d607535d339)**",
    "created_at": "2015-06-01T01:45:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254531",
    "user": "https://github.com/tscrim"
}
```

Commit: **[`b4a7647`](https://github.com/sagemath/sagetrac-mirror/commit/b4a764743046481af4a6bb88ca353d607535d339)**



---

archive/issue_comments_254532.json:
```json
{
    "body": "Author: **Travis Scrimshaw**",
    "created_at": "2015-06-01T01:45:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254532",
    "user": "https://github.com/tscrim"
}
```

Author: **Travis Scrimshaw**



---

archive/issue_comments_254533.json:
```json
{
    "body": "Branch: **[public/combinat/fix_crystal_weight_lattice-18453](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_crystal_weight_lattice-18453)**",
    "created_at": "2015-06-01T01:45:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254533",
    "user": "https://github.com/tscrim"
}
```

Branch: **[public/combinat/fix_crystal_weight_lattice-18453](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_crystal_weight_lattice-18453)**



---

archive/issue_comments_254534.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOkay, here's a rough draft of my proposal that mostly works. I would like some feedback, in particular from Nicolas on the change of the behavior and the reorganization of the code. There also seems to be a subtle issue with subclassing and `@cached_method` (with my branch):\n\n```\nsage: P = RootSystem(['A',3,1]).weight_lattice()\nsage: P.fundamental_weight('delta')\ndelta\nsage: P.fundamental_weights()\nFinite family {0: Lambda[0], 1: Lambda[1], 2: Lambda[2], 3: Lambda[3]}\n```\nRestart Sage and do\n\n```\nsage: P = RootSystem(['A',3,1]).weight_lattice()\nsage: P.fundamental_weights()\nFinite family {0: Lambda[0], 1: Lambda[1], 2: Lambda[2], 3: Lambda[3]}\nsage: P.fundamental_weight('delta') # This is now the method of the base class!!!\n...\nValueError: delta is not in the index set\n```\nI have no idea about why this occurs, much less how to fix this.\n\nHowever it does not actually fix the problem noted on this ticket as we compute the weight by `Phi - Epsilon`. I've fixed this directly for LS paths (to which we need to be much more careful with the category) and rigged configurations. For Nakajima monomials, I'm not quite sure how to fix it. I really don't want to special case the affine types. In Kang et al., they construct B(\\infty) by the path realization, and so I think they consider it as a U'<sub>q</sub>(**g**)-crystal (and so is in the non-extended weight lattice).\n\n(Additionally, the weight function isn't correct for the Kyoto path model either, but that is a separate issue.)\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7663e78bdcbbb638818385b9d44efb6a05bdaf07\"><code>7663e78</code></a></td><td><code>Implement category of KR crystals and reorganizing (extended) weight spaces.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e0ba041ea9af34c913226cc81d47e87c5a0e58a\"><code>6e0ba04</code></a></td><td><code>Fixing my errors from the conversion.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b4a764743046481af4a6bb88ca353d607535d339\"><code>b4a7647</code></a></td><td><code>Fixing weight for LS paths and rigged configurations.</code></td></tr></table>\n",
    "created_at": "2015-06-01T01:45:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254534",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:5" align="right">comment:5</div>

Okay, here's a rough draft of my proposal that mostly works. I would like some feedback, in particular from Nicolas on the change of the behavior and the reorganization of the code. There also seems to be a subtle issue with subclassing and `@cached_method` (with my branch):

```
sage: P = RootSystem(['A',3,1]).weight_lattice()
sage: P.fundamental_weight('delta')
delta
sage: P.fundamental_weights()
Finite family {0: Lambda[0], 1: Lambda[1], 2: Lambda[2], 3: Lambda[3]}
```
Restart Sage and do

```
sage: P = RootSystem(['A',3,1]).weight_lattice()
sage: P.fundamental_weights()
Finite family {0: Lambda[0], 1: Lambda[1], 2: Lambda[2], 3: Lambda[3]}
sage: P.fundamental_weight('delta') # This is now the method of the base class!!!
...
ValueError: delta is not in the index set
```
I have no idea about why this occurs, much less how to fix this.

However it does not actually fix the problem noted on this ticket as we compute the weight by `Phi - Epsilon`. I've fixed this directly for LS paths (to which we need to be much more careful with the category) and rigged configurations. For Nakajima monomials, I'm not quite sure how to fix it. I really don't want to special case the affine types. In Kang et al., they construct B(\infty) by the path realization, and so I think they consider it as a U'<sub>q</sub>(**g**)-crystal (and so is in the non-extended weight lattice).

(Additionally, the weight function isn't correct for the Kyoto path model either, but that is a separate issue.)

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7663e78bdcbbb638818385b9d44efb6a05bdaf07"><code>7663e78</code></a></td><td><code>Implement category of KR crystals and reorganizing (extended) weight spaces.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e0ba041ea9af34c913226cc81d47e87c5a0e58a"><code>6e0ba04</code></a></td><td><code>Fixing my errors from the conversion.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b4a764743046481af4a6bb88ca353d607535d339"><code>b4a7647</code></a></td><td><code>Fixing weight for LS paths and rigged configurations.</code></td></tr></table>




---

archive/issue_comments_254535.json:
```json
{
    "body": "Changed commit from **[`b4a7647`](https://github.com/sagemath/sagetrac-mirror/commit/b4a764743046481af4a6bb88ca353d607535d339)** to **[`cbd6e19`](https://github.com/sagemath/sagetrac-mirror/commit/cbd6e19da260c9c8fea9ae4762886fd1477d330c)**",
    "created_at": "2015-06-09T21:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254535",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`b4a7647`](https://github.com/sagemath/sagetrac-mirror/commit/b4a764743046481af4a6bb88ca353d607535d339)** to **[`cbd6e19`](https://github.com/sagemath/sagetrac-mirror/commit/cbd6e19da260c9c8fea9ae4762886fd1477d330c)**



---

archive/issue_comments_254536.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cbd6e19da260c9c8fea9ae4762886fd1477d330c\"><code>cbd6e19</code></a></td><td><code>Merge branch 'develop' into public/combinat/fix_crystal_weight_lattice-18453</code></td></tr></table>\n",
    "created_at": "2015-06-09T21:18:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254536",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cbd6e19da260c9c8fea9ae4762886fd1477d330c"><code>cbd6e19</code></a></td><td><code>Merge branch 'develop' into public/combinat/fix_crystal_weight_lattice-18453</code></td></tr></table>




---

archive/issue_comments_254537.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2dc88c195302110cbde755afc6a5d7381a308616\"><code>2dc88c1</code></a></td><td><code>18453: first changes to LS paths</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ba39d02ad883db0ab8f5312c45220c9cf011e27\"><code>0ba39d0</code></a></td><td><code>18453: added doctests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/901a865ac6ca5405018dc8ca5634448aebc203c4\"><code>901a865</code></a></td><td><code>18543: fixed Weyl dimension formula</code></td></tr></table>\n",
    "created_at": "2015-06-10T15:46:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254537",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:7"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2dc88c195302110cbde755afc6a5d7381a308616"><code>2dc88c1</code></a></td><td><code>18453: first changes to LS paths</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ba39d02ad883db0ab8f5312c45220c9cf011e27"><code>0ba39d0</code></a></td><td><code>18453: added doctests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/901a865ac6ca5405018dc8ca5634448aebc203c4"><code>901a865</code></a></td><td><code>18543: fixed Weyl dimension formula</code></td></tr></table>




---

archive/issue_comments_254538.json:
```json
{
    "body": "Changed branch from **[public/combinat/fix_crystal_weight_lattice-18453](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_crystal_weight_lattice-18453)** to **[public/crystal/18453](https://github.com/sagemath/sagetrac-mirror/tree/public/crystal/18453)**",
    "created_at": "2015-06-10T15:46:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254538",
    "user": "https://github.com/anneschilling"
}
```

Changed branch from **[public/combinat/fix_crystal_weight_lattice-18453](https://github.com/sagemath/sagetrac-mirror/tree/public/combinat/fix_crystal_weight_lattice-18453)** to **[public/crystal/18453](https://github.com/sagemath/sagetrac-mirror/tree/public/crystal/18453)**



---

archive/issue_comments_254539.json:
```json
{
    "body": "Changed commit from **[`cbd6e19`](https://github.com/sagemath/sagetrac-mirror/commit/cbd6e19da260c9c8fea9ae4762886fd1477d330c)** to **[`901a865`](https://github.com/sagemath/sagetrac-mirror/commit/901a865ac6ca5405018dc8ca5634448aebc203c4)**",
    "created_at": "2015-06-10T15:46:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254539",
    "user": "https://github.com/anneschilling"
}
```

Changed commit from **[`cbd6e19`](https://github.com/sagemath/sagetrac-mirror/commit/cbd6e19da260c9c8fea9ae4762886fd1477d330c)** to **[`901a865`](https://github.com/sagemath/sagetrac-mirror/commit/901a865ac6ca5405018dc8ca5634448aebc203c4)**



---

archive/issue_comments_254540.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBen and I are going to fix this in a different way. I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space). So please check. Ben will add fixes to the other crystals, but the Littlemann paths should be fixed now.",
    "created_at": "2015-06-10T15:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254540",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:8" align="right">comment:8</div>

Ben and I are going to fix this in a different way. I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space). So please check. Ben will add fixes to the other crystals, but the Littlemann paths should be fixed now.



---

archive/issue_comments_254541.json:
```json
{
    "body": "Changed commit from **[`901a865`](https://github.com/sagemath/sagetrac-mirror/commit/901a865ac6ca5405018dc8ca5634448aebc203c4)** to **[`45ca9ee`](https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1)**",
    "created_at": "2015-06-10T16:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254541",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`901a865`](https://github.com/sagemath/sagetrac-mirror/commit/901a865ac6ca5405018dc8ca5634448aebc203c4)** to **[`45ca9ee`](https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1)**



---

archive/issue_comments_254542.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6a225eeed6f6b76db8476c2e5557b33496cc2bcd\"><code>6a225ee</code></a></td><td><code>Preliminary changes to GYW weight code.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef4867d474b9286371d4a782cf48f8ae6668902f\"><code>ef4867d</code></a></td><td><code>Merge branch 'public/crystal/18453' of git://trac.sagemath.org/sage into 18453</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f42e6d1eebade43ae420b3ff13cb91b70fc938b\"><code>5f42e6d</code></a></td><td><code>more changes to GYWs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1\"><code>45ca9ee</code></a></td><td><code>finished GYW updates</code></td></tr></table>\n",
    "created_at": "2015-06-10T16:49:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254542",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6a225eeed6f6b76db8476c2e5557b33496cc2bcd"><code>6a225ee</code></a></td><td><code>Preliminary changes to GYW weight code.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef4867d474b9286371d4a782cf48f8ae6668902f"><code>ef4867d</code></a></td><td><code>Merge branch 'public/crystal/18453' of git://trac.sagemath.org/sage into 18453</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f42e6d1eebade43ae420b3ff13cb91b70fc938b"><code>5f42e6d</code></a></td><td><code>more changes to GYWs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1"><code>45ca9ee</code></a></td><td><code>finished GYW updates</code></td></tr></table>




---

archive/issue_comments_254543.json:
```json
{
    "body": "Changed commit from **[`45ca9ee`](https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1)** to **[`9225af7`](https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651)**",
    "created_at": "2015-06-10T17:24:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254543",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`45ca9ee`](https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1)** to **[`9225af7`](https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651)**



---

archive/issue_comments_254544.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651\"><code>9225af7</code></a></td><td><code>18543: small typo fixed in generalized_young_walls</code></td></tr></table>\n",
    "created_at": "2015-06-10T17:24:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254544",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651"><code>9225af7</code></a></td><td><code>18543: small typo fixed in generalized_young_walls</code></td></tr></table>




---

archive/issue_comments_254545.json:
```json
{
    "body": "Changed author from **Travis Scrimshaw** to **Ben Salisbury, Anne Schilling, Travis Scrimshaw**",
    "created_at": "2015-06-10T17:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254545",
    "user": "https://github.com/anneschilling"
}
```

Changed author from **Travis Scrimshaw** to **Ben Salisbury, Anne Schilling, Travis Scrimshaw**



---

archive/issue_comments_254546.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6a225eeed6f6b76db8476c2e5557b33496cc2bcd\"><code>6a225ee</code></a></td><td><code>Preliminary changes to GYW weight code.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef4867d474b9286371d4a782cf48f8ae6668902f\"><code>ef4867d</code></a></td><td><code>Merge branch 'public/crystal/18453' of git://trac.sagemath.org/sage into 18453</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f42e6d1eebade43ae420b3ff13cb91b70fc938b\"><code>5f42e6d</code></a></td><td><code>more changes to GYWs</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1\"><code>45ca9ee</code></a></td><td><code>finished GYW updates</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651\"><code>9225af7</code></a></td><td><code>18543: small typo fixed in generalized_young_walls</code></td></tr></table>\n",
    "created_at": "2015-06-10T17:42:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254546",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:11"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6a225eeed6f6b76db8476c2e5557b33496cc2bcd"><code>6a225ee</code></a></td><td><code>Preliminary changes to GYW weight code.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef4867d474b9286371d4a782cf48f8ae6668902f"><code>ef4867d</code></a></td><td><code>Merge branch 'public/crystal/18453' of git://trac.sagemath.org/sage into 18453</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f42e6d1eebade43ae420b3ff13cb91b70fc938b"><code>5f42e6d</code></a></td><td><code>more changes to GYWs</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/45ca9eefc39552f1e7e7bc9ae5dd61a66c97bec1"><code>45ca9ee</code></a></td><td><code>finished GYW updates</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651"><code>9225af7</code></a></td><td><code>18543: small typo fixed in generalized_young_walls</code></td></tr></table>




---

archive/issue_comments_254547.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHi Travis,\n\nlittelmann_paths and generalized_young_walls are fixed. Ben is working on monomials to get the hyperbolic cases working. Could you fix the rigged configuration crystals by implementing the correct weight and weight_lattice_realization? In this ticket we do not want to revamp all the root_system stuff that you added in your previous patch and the category changes for KR crystals.\n\nThanks!\n\nAnne",
    "created_at": "2015-06-10T17:45:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254547",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:12" align="right">comment:12</div>

Hi Travis,

littelmann_paths and generalized_young_walls are fixed. Ben is working on monomials to get the hyperbolic cases working. Could you fix the rigged configuration crystals by implementing the correct weight and weight_lattice_realization? In this ticket we do not want to revamp all the root_system stuff that you added in your previous patch and the category changes for KR crystals.

Thanks!

Anne



---

archive/issue_comments_254548.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI'm pretty sure this will not end up fixing most of the problems and it feels like we're hacking around the problem. At the very least as a better patch, I think we could solve a host of issues by just checking if the type is affine and if the crystal is not in finite crystals to pass `extended=True`. However I will fix the RC code and test a bunch of the different models in affine type as soon as I'm able to today.",
    "created_at": "2015-06-10T17:56:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254548",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:13" align="right">comment:13</div>

I'm pretty sure this will not end up fixing most of the problems and it feels like we're hacking around the problem. At the very least as a better patch, I think we could solve a host of issues by just checking if the type is affine and if the crystal is not in finite crystals to pass `extended=True`. However I will fix the RC code and test a bunch of the different models in affine type as soon as I'm able to today.



---

archive/issue_comments_254549.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI've fixed the rigged configurations\n\n- `CrystalOfAlcovePaths` fails outright:\n\n```\nsage: C = crystals.AlcovePaths(La[0])\nsage: C\nHighest weight crystal of alcove paths of type ['A', 1, 1] and weight Lambda[0]\nsage: C.module_generators[0].f_string([0,1])\n((alpha[0], 0), (2*alpha[0] + alpha[1], 1))\nsage: _.weight()\nTypeError\n```\n- We should also explicitly implement a `weight_lattice_realization` for `DirectSumOfCrystals` similar to what we did for tensor products.\n- We have to decide what we want to do with `KyotoPathModel` and if we want to consider it as a U<sub>q</sub>'-crystal or a U<sub>q</sub>-crystal. I think the former is what we should do considering it is a tensor product of U<sub>q</sub>'-crystals. In any case, we will probably have to do something special for this.\n- We have a problem with not distinguishing between elements of the extended and non-extended affine weight lattices. In particular, this causes an issue with creating the highest weight crystals with the same weight but you accidentally first create it in the non-extended affine weight lattice.\n\n```\nsage: LaE = RootSystem(['A',2,1]).weight_space(extended=True).fundamental_weights()sage: La = RootSystem(['A',2,1]).weight_space().fundamental_weights()\nsage: B = crystals.LSPaths(La[0])\nsage: B2 = crystals.LSPaths(LaE[0])\nsage: B is B2\nTrue\n```\nI had changed `crystals.RiggedConfigurations` with inadvertantly triggered this. I don't think we want to enforce that the user must consider weights in the extended affine weight lattice as it is a valid restriction from U<sub>q</sub> to U<sub>q</sub>' (in particular, the Kyoto path model). IMO the solution would be for `__classcall__`/`__classcall_private__` to pass the weight lattice realization with the default to use the parent of the weight given. I feel this gives the user added flexibility for where they want the weights to be printed. Although part of me also thinks there should be some kind of option which could be changed in the method-input/classes/globally which specifies the weight lattice realization.\n\nI will be on skype all day today if you want to talk.",
    "created_at": "2015-06-10T19:07:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254549",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

I've fixed the rigged configurations

- `CrystalOfAlcovePaths` fails outright:

```
sage: C = crystals.AlcovePaths(La[0])
sage: C
Highest weight crystal of alcove paths of type ['A', 1, 1] and weight Lambda[0]
sage: C.module_generators[0].f_string([0,1])
((alpha[0], 0), (2*alpha[0] + alpha[1], 1))
sage: _.weight()
TypeError
```
- We should also explicitly implement a `weight_lattice_realization` for `DirectSumOfCrystals` similar to what we did for tensor products.
- We have to decide what we want to do with `KyotoPathModel` and if we want to consider it as a U<sub>q</sub>'-crystal or a U<sub>q</sub>-crystal. I think the former is what we should do considering it is a tensor product of U<sub>q</sub>'-crystals. In any case, we will probably have to do something special for this.
- We have a problem with not distinguishing between elements of the extended and non-extended affine weight lattices. In particular, this causes an issue with creating the highest weight crystals with the same weight but you accidentally first create it in the non-extended affine weight lattice.

```
sage: LaE = RootSystem(['A',2,1]).weight_space(extended=True).fundamental_weights()sage: La = RootSystem(['A',2,1]).weight_space().fundamental_weights()
sage: B = crystals.LSPaths(La[0])
sage: B2 = crystals.LSPaths(LaE[0])
sage: B is B2
True
```
I had changed `crystals.RiggedConfigurations` with inadvertantly triggered this. I don't think we want to enforce that the user must consider weights in the extended affine weight lattice as it is a valid restriction from U<sub>q</sub> to U<sub>q</sub>' (in particular, the Kyoto path model). IMO the solution would be for `__classcall__`/`__classcall_private__` to pass the weight lattice realization with the default to use the parent of the weight given. I feel this gives the user added flexibility for where they want the weights to be printed. Although part of me also thinks there should be some kind of option which could be changed in the method-input/classes/globally which specifies the weight lattice realization.

I will be on skype all day today if you want to talk.



---

archive/issue_comments_254550.json:
```json
{
    "body": "Changed commit from **[`9225af7`](https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651)** to **[`7963ea6`](https://github.com/sagemath/sagetrac-mirror/commit/7963ea6a64dc4bd1d623288fbb6702e11beae0dc)**",
    "created_at": "2015-06-10T19:07:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254550",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9225af7`](https://github.com/sagemath/sagetrac-mirror/commit/9225af71b4dbcfa6c748816c452e9824dadc3651)** to **[`7963ea6`](https://github.com/sagemath/sagetrac-mirror/commit/7963ea6a64dc4bd1d623288fbb6702e11beae0dc)**



---

archive/issue_comments_254551.json:
```json
{
    "body": "<div id=\"comment:15\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7963ea6a64dc4bd1d623288fbb6702e11beae0dc\"><code>7963ea6</code></a></td><td><code>Fixing WLR for rigged configurations.</code></td></tr></table>\n",
    "created_at": "2015-06-10T19:07:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254551",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7963ea6a64dc4bd1d623288fbb6702e11beae0dc"><code>7963ea6</code></a></td><td><code>Fixing WLR for rigged configurations.</code></td></tr></table>




---

archive/issue_comments_254552.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nReplying to [@tscrim](#comment%3A13):\n> However I will fix the RC code and test a bunch of the different models in affine type\n\nJust random thoughts: will failure be caught by TestSuite? If not could there be new _test methods catching the issue?",
    "created_at": "2015-06-10T20:17:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254552",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:16" align="right">comment:16</div>

Replying to [@tscrim](#comment%3A13):
> However I will fix the RC code and test a bunch of the different models in affine type

Just random thoughts: will failure be caught by TestSuite? If not could there be new _test methods catching the issue?



---

archive/issue_comments_254553.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@anneschilling](#comment%3A8):\n> I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space).\n\nBy Dan, if I recall correctly.",
    "created_at": "2015-06-10T20:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254553",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@anneschilling](#comment%3A8):
> I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space).

By Dan, if I recall correctly.



---

archive/issue_comments_254554.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nReplying to [@nthiery](#comment%3A16):\n> Replying to [@tscrim](#comment%3A13):\n> > However I will fix the RC code and test a bunch of the different models in affine type\n\n> \n> Just random thoughts: will failure be caught by TestSuite? If not could there be new _test methods catching the issue?\n\nI don't think we could write a `TestSuite` check for this (at least for the highest weight crystals) as the branching rule I mentioned above is valid (and so having the weights in the non-extended weight lattice still makes sense, unless I'm misunderstanding something about U<sub>q</sub>'(**g**) inside of U<sub>q</sub>(**g**)).",
    "created_at": "2015-06-10T20:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254554",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:18" align="right">comment:18</div>

Replying to [@nthiery](#comment%3A16):
> Replying to [@tscrim](#comment%3A13):
> > However I will fix the RC code and test a bunch of the different models in affine type

> 
> Just random thoughts: will failure be caught by TestSuite? If not could there be new _test methods catching the issue?

I don't think we could write a `TestSuite` check for this (at least for the highest weight crystals) as the branching rule I mentioned above is valid (and so having the weights in the non-extended weight lattice still makes sense, unless I'm misunderstanding something about U<sub>q</sub>'(**g**) inside of U<sub>q</sub>(**g**)).



---

archive/issue_comments_254555.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@nthiery](#comment%3A17):\n> Replying to [@anneschilling](#comment%3A8):\n> > I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space).\n\n> \n> By Dan, if I recall correctly.\n\n```\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  859)         def weyl_dimension(self, highest_weight):\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  860)             \"\"\"\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  861)             EXAMPLES::\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  862) \n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  863)                 sage: RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0])\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  864)                 20\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  865) \n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  866)                 sage: type(RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0]))\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  867)                 <type 'sage.rings.integer.Integer'>\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  868)             \"\"\"\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  869)             highest_weight = self(highest_weight)\nf562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  870)             if not highest_weight.is_dominant():\nf562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  871)                 raise ValueError(\"the highest weight must be dominant\")\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  872)             rho = self.rho()\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  873)             n = prod([(rho+highest_weight).dot_product(x) for x in self.positive_roots()])\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  874)             d = prod([ rho.dot_product(x) for x in self.positive_roots()])\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  875)             from sage.rings.integer import Integer\n7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  876)             return Integer(n/d)\n```\nBut in any case, someone should check!",
    "created_at": "2015-06-11T04:09:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254555",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@nthiery](#comment%3A17):
> Replying to [@anneschilling](#comment%3A8):
> > I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space).

> 
> By Dan, if I recall correctly.

```
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  859)         def weyl_dimension(self, highest_weight):
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  860)             """
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  861)             EXAMPLES::
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  862) 
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  863)                 sage: RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0])
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  864)                 20
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  865) 
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  866)                 sage: type(RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0]))
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  867)                 <type 'sage.rings.integer.Integer'>
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  868)             """
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  869)             highest_weight = self(highest_weight)
f562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  870)             if not highest_weight.is_dominant():
f562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  871)                 raise ValueError("the highest weight must be dominant")
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  872)             rho = self.rho()
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  873)             n = prod([(rho+highest_weight).dot_product(x) for x in self.positive_roots()])
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  874)             d = prod([ rho.dot_product(x) for x in self.positive_roots()])
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  875)             from sage.rings.integer import Integer
7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  876)             return Integer(n/d)
```
But in any case, someone should check!



---

archive/issue_comments_254556.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n> - `CrystalOfAlcovePaths` fails outright:\n> \n> ```\n> sage: C = crystals.AlcovePaths(La[0])\n> sage: C\n> Highest weight crystal of alcove paths of type ['A', 1, 1] and weight Lambda[0]\n> sage: C.module_generators[0].f_string([0,1])\n> ((alpha[0], 0), (2*alpha[0] + alpha[1], 1))\n> sage: _.weight()\n> TypeError\n> ```\n\nNo, it does not. You did not send how you made the weight La. I assume you used the weight_lattice and not weight_space (which you have to for this model!!)\n\n```\nsage: R = RootSystem(['A',1,1])\nsage: P = R.weight_space()\nsage: La = P.basis()\nsage: C = crystals.AlcovePaths(La[0])\nsage: b = C.module_generators[0].f(0)\nsage: b\n((alpha[0], 0),)\nsage: b.weight()\n-Lambda[0] + 2*Lambda[1]\n```\n\n> - We should also explicitly implement a `weight_lattice_realization` for `DirectSumOfCrystals` similar to what we did for tensor products.\n> - We have to decide what we want to do with `KyotoPathModel` and if we want to consider it as a U<sub>q</sub>'-crystal or a U<sub>q</sub>-crystal. I think the former is what we should do considering it is a tensor product of U<sub>q</sub>'-crystals. In any case, we will probably have to do something special for this.\n\nMathematically speaking, the Kyoto path model is a model in the category of highest weight affine crystals. It is a U_q(g)-crystal not a U_q'(g) crystal. Really what one does it take tensor products `B^{r,s} \\otimes u_\\Lambda` with `\\Lambda` of level `s`.",
    "created_at": "2015-06-11T04:33:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254556",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:20" align="right">comment:20</div>

> - `CrystalOfAlcovePaths` fails outright:
> 
> ```
> sage: C = crystals.AlcovePaths(La[0])
> sage: C
> Highest weight crystal of alcove paths of type ['A', 1, 1] and weight Lambda[0]
> sage: C.module_generators[0].f_string([0,1])
> ((alpha[0], 0), (2*alpha[0] + alpha[1], 1))
> sage: _.weight()
> TypeError
> ```

No, it does not. You did not send how you made the weight La. I assume you used the weight_lattice and not weight_space (which you have to for this model!!)

```
sage: R = RootSystem(['A',1,1])
sage: P = R.weight_space()
sage: La = P.basis()
sage: C = crystals.AlcovePaths(La[0])
sage: b = C.module_generators[0].f(0)
sage: b
((alpha[0], 0),)
sage: b.weight()
-Lambda[0] + 2*Lambda[1]
```

> - We should also explicitly implement a `weight_lattice_realization` for `DirectSumOfCrystals` similar to what we did for tensor products.
> - We have to decide what we want to do with `KyotoPathModel` and if we want to consider it as a U<sub>q</sub>'-crystal or a U<sub>q</sub>-crystal. I think the former is what we should do considering it is a tensor product of U<sub>q</sub>'-crystals. In any case, we will probably have to do something special for this.

Mathematically speaking, the Kyoto path model is a model in the category of highest weight affine crystals. It is a U_q(g)-crystal not a U_q'(g) crystal. Really what one does it take tensor products `B^{r,s} \otimes u_\Lambda` with `\Lambda` of level `s`.



---

archive/issue_comments_254557.json:
```json
{
    "body": "Changed commit from **[`7963ea6`](https://github.com/sagemath/sagetrac-mirror/commit/7963ea6a64dc4bd1d623288fbb6702e11beae0dc)** to **[`3b3c0b2`](https://github.com/sagemath/sagetrac-mirror/commit/3b3c0b2d15289a8c4a5c5c25ad2984114a856916)**",
    "created_at": "2015-06-11T16:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254557",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`7963ea6`](https://github.com/sagemath/sagetrac-mirror/commit/7963ea6a64dc4bd1d623288fbb6702e11beae0dc)** to **[`3b3c0b2`](https://github.com/sagemath/sagetrac-mirror/commit/3b3c0b2d15289a8c4a5c5c25ad2984114a856916)**



---

archive/issue_comments_254558.json:
```json
{
    "body": "<div id=\"comment:21\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3b3c0b2d15289a8c4a5c5c25ad2984114a856916\"><code>3b3c0b2</code></a></td><td><code>added weight_lattice_realization to monomial crystals</code></td></tr></table>\n",
    "created_at": "2015-06-11T16:11:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254558",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:21"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3b3c0b2d15289a8c4a5c5c25ad2984114a856916"><code>3b3c0b2</code></a></td><td><code>added weight_lattice_realization to monomial crystals</code></td></tr></table>




---

archive/issue_comments_254559.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nIt seems the original error in the monomial crystals code is due to an error in the literature about how the weight function is defined for monomial crystals.  I've checked\n\n- Kang, Kim, and Shin, *Modified Nakajima monomials and the crystal B(infinity),* J. Alg. 308 (2007), 524-535.\n\n- Kashiwara, *Realizations of crystals,* Contemporary Math. 325 (2003), 133-139.\n\n- Kim and Shin, *Nakajima monomials, Young walls, and the Kashiwara embedding,* J. Alg. 330 (2011), 234-250.\n\n- Kim, *Monomial realization of crystal graphs for Uq(An1),* Math. Ann. 332 (2005), 17-35.\n\n- ...\n\nIn none of these references is there a way to get `delta` to appear as a weight.  Perhaps I've missed a reference that does include this information, but I'm thinking about the problem now and planning to discuss it with Peter TIngley, so hopefully we will have a resolution soon.",
    "created_at": "2015-06-11T16:24:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254559",
    "user": "https://github.com/bsalisbury1"
}
```

<div id="comment:22" align="right">comment:22</div>

It seems the original error in the monomial crystals code is due to an error in the literature about how the weight function is defined for monomial crystals.  I've checked

- Kang, Kim, and Shin, *Modified Nakajima monomials and the crystal B(infinity),* J. Alg. 308 (2007), 524-535.

- Kashiwara, *Realizations of crystals,* Contemporary Math. 325 (2003), 133-139.

- Kim and Shin, *Nakajima monomials, Young walls, and the Kashiwara embedding,* J. Alg. 330 (2011), 234-250.

- Kim, *Monomial realization of crystal graphs for Uq(An1),* Math. Ann. 332 (2005), 17-35.

- ...

In none of these references is there a way to get `delta` to appear as a weight.  Perhaps I've missed a reference that does include this information, but I'm thinking about the problem now and planning to discuss it with Peter TIngley, so hopefully we will have a resolution soon.



---

archive/issue_comments_254560.json:
```json
{
    "body": "Changed keywords from **crystals** to **crystals, days65**",
    "created_at": "2015-06-11T16:24:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254560",
    "user": "https://github.com/bsalisbury1"
}
```

Changed keywords from **crystals** to **crystals, days65**



---

archive/issue_comments_254561.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@anneschilling](#comment%3A20):\n> > - `CrystalOfAlcovePaths` fails outright:\n\n> No, it does not. You did not send how you made the weight La. I assume you used the weight_lattice and not weight_space (which you have to for this model!!)\n\nAh, we do need the `weight_space`, so we should probably make it error out similar for the LS paths if we aren't in the weight space. Also it does work using the extended weight lattice:\n\n```\nsage: La = RootSystem(['A',2,1]).weight_space(extended=True).fundamental_weights()\nsage: C = crystals.AlcovePaths(La[0])\nsage: C.module_generators[0].f_string([0,1])\n((alpha[0], 0), (alpha[0] + alpha[1], 0))\nsage: _.weight()\n-Lambda[1] + 2*Lambda[2] - delta\n```\n\n> > - We should also explicitly implement a `weight_lattice_realization` for `DirectSumOfCrystals` similar to what we did for tensor products.\n> > - We have to decide what we want to do with `KyotoPathModel` and if we want to consider it as a U<sub>q</sub>'-crystal or a U<sub>q</sub>-crystal. I think the former is what we should do considering it is a tensor product of U<sub>q</sub>'-crystals. In any case, we will probably have to do something special for this.\n\n> \n> Mathematically speaking, the Kyoto path model is a model in the category of highest weight affine crystals. It is a U_q(g)-crystal not a U_q'(g) crystal. Really what one does it take tensor products `B^{r,s} \\otimes u_\\Lambda` with `\\Lambda` of level `s`.\n\nI agree that it is in highest weight affine crystals, but we don't have a way to get `\\delta` from the elements. The embedding `B(\\lambda) \\to B^{r,s} \\otimes B(\\mu)` has to be as U_q'(g)-crystals as `B^{r,s}` must be a U_q'(g)-crystal as otherwise it breaks the condition for the weight function. Also if `\\Lambda` is of level `s`, then `\\Lambda + k\\delta` is of level `s` for all `k` since `<c, \\delta> = 0`. I still don't quite see how we could figure out what the coefficient of `\\delta` is for an arbitrary element in the Kyoto path model.\n\nReplying to [@bsalisbury1](#comment%3A21):\n> It seems the original error in the monomial crystals code is due to an error in the literature about how the weight function is defined for monomial crystals.\n> ...\n> In none of these references is there a way to get delta to appear as a weight. Perhaps I've missed a reference that does include this information, but I'm thinking about the problem now and planning to discuss it with Peter Tingley, so hopefully we will have a resolution soon.\n\nI had poked around on this too when I first looked into this ticket and couldn't find anything (I also looked in *Level 0 monomial crystals* by Hernandez and Kashiwara). Expressing the monomial crystals in the `A`'s isn't a problem since we can just pull the simple roots and `\\alpha_0` is what contributes to `\\delta`. We can always brute-force this computation for highest weight crystals by taking a path to the highest weight and computing the weight from that, but that is going to be *really* slow (but it will be correct). I think the best solution is to follow Hernandez and Kashiwara and add a weight attribute to each element of the crystal, which is easy enough to compute on each application of `e` and `f`.\n\nAlso in a similar vein, I don't think we can compute `\\delta` from doing `Epsilon - Phi` as `Epsilon = \\sum_i \\epsilon_i \\Lambda_i` and similar for `\\Phi` (which comes down to the fact that `<h_i, \\delta> = 0`, where `h_i` is a simple coroot). I think we need to change this, or at least put a stopgap in affine type and the WLR is the extended weight lattice.",
    "created_at": "2015-06-11T16:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254561",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@anneschilling](#comment%3A20):
> > - `CrystalOfAlcovePaths` fails outright:

> No, it does not. You did not send how you made the weight La. I assume you used the weight_lattice and not weight_space (which you have to for this model!!)

Ah, we do need the `weight_space`, so we should probably make it error out similar for the LS paths if we aren't in the weight space. Also it does work using the extended weight lattice:

```
sage: La = RootSystem(['A',2,1]).weight_space(extended=True).fundamental_weights()
sage: C = crystals.AlcovePaths(La[0])
sage: C.module_generators[0].f_string([0,1])
((alpha[0], 0), (alpha[0] + alpha[1], 0))
sage: _.weight()
-Lambda[1] + 2*Lambda[2] - delta
```

> > - We should also explicitly implement a `weight_lattice_realization` for `DirectSumOfCrystals` similar to what we did for tensor products.
> > - We have to decide what we want to do with `KyotoPathModel` and if we want to consider it as a U<sub>q</sub>'-crystal or a U<sub>q</sub>-crystal. I think the former is what we should do considering it is a tensor product of U<sub>q</sub>'-crystals. In any case, we will probably have to do something special for this.

> 
> Mathematically speaking, the Kyoto path model is a model in the category of highest weight affine crystals. It is a U_q(g)-crystal not a U_q'(g) crystal. Really what one does it take tensor products `B^{r,s} \otimes u_\Lambda` with `\Lambda` of level `s`.

I agree that it is in highest weight affine crystals, but we don't have a way to get `\delta` from the elements. The embedding `B(\lambda) \to B^{r,s} \otimes B(\mu)` has to be as U_q'(g)-crystals as `B^{r,s}` must be a U_q'(g)-crystal as otherwise it breaks the condition for the weight function. Also if `\Lambda` is of level `s`, then `\Lambda + k\delta` is of level `s` for all `k` since `<c, \delta> = 0`. I still don't quite see how we could figure out what the coefficient of `\delta` is for an arbitrary element in the Kyoto path model.

Replying to [@bsalisbury1](#comment%3A21):
> It seems the original error in the monomial crystals code is due to an error in the literature about how the weight function is defined for monomial crystals.
> ...
> In none of these references is there a way to get delta to appear as a weight. Perhaps I've missed a reference that does include this information, but I'm thinking about the problem now and planning to discuss it with Peter Tingley, so hopefully we will have a resolution soon.

I had poked around on this too when I first looked into this ticket and couldn't find anything (I also looked in *Level 0 monomial crystals* by Hernandez and Kashiwara). Expressing the monomial crystals in the `A`'s isn't a problem since we can just pull the simple roots and `\alpha_0` is what contributes to `\delta`. We can always brute-force this computation for highest weight crystals by taking a path to the highest weight and computing the weight from that, but that is going to be *really* slow (but it will be correct). I think the best solution is to follow Hernandez and Kashiwara and add a weight attribute to each element of the crystal, which is easy enough to compute on each application of `e` and `f`.

Also in a similar vein, I don't think we can compute `\delta` from doing `Epsilon - Phi` as `Epsilon = \sum_i \epsilon_i \Lambda_i` and similar for `\Phi` (which comes down to the fact that `<h_i, \delta> = 0`, where `h_i` is a simple coroot). I think we need to change this, or at least put a stopgap in affine type and the WLR is the extended weight lattice.



---

archive/issue_comments_254562.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@tscrim](#comment%3A23):\n> Replying to [@bsalisbury1](#comment%3A21):\n> > It seems the original error in the monomial crystals code is due to an error in the literature about how the weight function is defined for monomial crystals.\n> > ...\n> > In none of these references is there a way to get delta to appear as a weight. Perhaps I've missed a reference that does include this information, but I'm thinking about the problem now and planning to discuss it with Peter Tingley, so hopefully we will have a resolution soon.\n\n> \n> I had poked around on this too when I first looked into this ticket and couldn't find anything (I also looked in *Level 0 monomial crystals* by Hernandez and Kashiwara). Expressing the monomial crystals in the `A`'s isn't a problem since we can just pull the simple roots and `\\alpha_0` is what contributes to `\\delta`. We can always brute-force this computation for highest weight crystals by taking a path to the highest weight and computing the weight from that, but that is going to be *really* slow (but it will be correct). I think the best solution is to follow Hernandez and Kashiwara and add a weight attribute to each element of the crystal, which is easy enough to compute on each application of `e` and `f`.\n\nI tried doing this using the path to the highest weight vector, but it causes a loop in Sage because of the way the crystal operators are defined in the monomial crystals model.  In particular, we need phi to compute the action of the Kashiwara operators, and phi depends on the weight in the B(infinity) model.",
    "created_at": "2015-06-11T17:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254562",
    "user": "https://github.com/bsalisbury1"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@tscrim](#comment%3A23):
> Replying to [@bsalisbury1](#comment%3A21):
> > It seems the original error in the monomial crystals code is due to an error in the literature about how the weight function is defined for monomial crystals.
> > ...
> > In none of these references is there a way to get delta to appear as a weight. Perhaps I've missed a reference that does include this information, but I'm thinking about the problem now and planning to discuss it with Peter Tingley, so hopefully we will have a resolution soon.

> 
> I had poked around on this too when I first looked into this ticket and couldn't find anything (I also looked in *Level 0 monomial crystals* by Hernandez and Kashiwara). Expressing the monomial crystals in the `A`'s isn't a problem since we can just pull the simple roots and `\alpha_0` is what contributes to `\delta`. We can always brute-force this computation for highest weight crystals by taking a path to the highest weight and computing the weight from that, but that is going to be *really* slow (but it will be correct). I think the best solution is to follow Hernandez and Kashiwara and add a weight attribute to each element of the crystal, which is easy enough to compute on each application of `e` and `f`.

I tried doing this using the path to the highest weight vector, but it causes a loop in Sage because of the way the crystal operators are defined in the monomial crystals model.  In particular, we need phi to compute the action of the Kashiwara operators, and phi depends on the weight in the B(infinity) model.



---

archive/issue_comments_254563.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@bsalisbury1](#comment%3A24):\n> Replying to [@tscrim](#comment%3A23):\n> > I had poked around on this too when I first looked into this ticket and couldn't find anything (I also looked in *Level 0 monomial crystals* by Hernandez and Kashiwara). Expressing the monomial crystals in the `A`'s isn't a problem since we can just pull the simple roots and `\\alpha_0` is what contributes to `\\delta`. We can always brute-force this computation for highest weight crystals by taking a path to the highest weight and computing the weight from that, but that is going to be *really* slow (but it will be correct). I think the best solution is to follow Hernandez and Kashiwara and add a weight attribute to each element of the crystal, which is easy enough to compute on each application of `e` and `f`.\n\n> \n> I tried doing this using the path to the highest weight vector, but it causes a loop in Sage because of the way the crystal operators are defined in the monomial crystals model.  In particular, we need phi to compute the action of the Kashiwara operators, and phi depends on the weight in the B(infinity) model.\n\nRight...I'm now fairly convinced it will be best to simply store the weight as an attribute of the elements. This might also result in a speedup as we wouldn't need to (re)compute the weight everytime we call `phi()`.",
    "created_at": "2015-06-11T17:27:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254563",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@bsalisbury1](#comment%3A24):
> Replying to [@tscrim](#comment%3A23):
> > I had poked around on this too when I first looked into this ticket and couldn't find anything (I also looked in *Level 0 monomial crystals* by Hernandez and Kashiwara). Expressing the monomial crystals in the `A`'s isn't a problem since we can just pull the simple roots and `\alpha_0` is what contributes to `\delta`. We can always brute-force this computation for highest weight crystals by taking a path to the highest weight and computing the weight from that, but that is going to be *really* slow (but it will be correct). I think the best solution is to follow Hernandez and Kashiwara and add a weight attribute to each element of the crystal, which is easy enough to compute on each application of `e` and `f`.

> 
> I tried doing this using the path to the highest weight vector, but it causes a loop in Sage because of the way the crystal operators are defined in the monomial crystals model.  In particular, we need phi to compute the action of the Kashiwara operators, and phi depends on the weight in the B(infinity) model.

Right...I'm now fairly convinced it will be best to simply store the weight as an attribute of the elements. This might also result in a speedup as we wouldn't need to (re)compute the weight everytime we call `phi()`.



---

archive/issue_comments_254564.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@anneschilling](#comment%3A19):\n\n> But in any case, someone should check!\n\nI will check it.",
    "created_at": "2015-06-11T21:14:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254564",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@anneschilling](#comment%3A19):

> But in any case, someone should check!

I will check it.



---

archive/issue_comments_254565.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\n> Right...I'm now fairly convinced it will be best to simply store the weight as an attribute of the elements. This might also result in a speedup as we wouldn't need to (re)compute the weight everytime we call `phi()`.\n\nBen and I found a different way which fixes the problem. A new commit will follow soon!",
    "created_at": "2015-06-11T21:57:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254565",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:27" align="right">comment:27</div>

> Right...I'm now fairly convinced it will be best to simply store the weight as an attribute of the elements. This might also result in a speedup as we wouldn't need to (re)compute the weight everytime we call `phi()`.

Ben and I found a different way which fixes the problem. A new commit will follow soon!



---

archive/issue_comments_254566.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0fd5597cb665cc8cf7d11e6d24e9e7dee691c57\"><code>e0fd559</code></a></td><td><code>monomial crystals weight is fixed!!!</code></td></tr></table>\n",
    "created_at": "2015-06-11T22:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254566",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0fd5597cb665cc8cf7d11e6d24e9e7dee691c57"><code>e0fd559</code></a></td><td><code>monomial crystals weight is fixed!!!</code></td></tr></table>




---

archive/issue_comments_254567.json:
```json
{
    "body": "Changed commit from **[`3b3c0b2`](https://github.com/sagemath/sagetrac-mirror/commit/3b3c0b2d15289a8c4a5c5c25ad2984114a856916)** to **[`e0fd559`](https://github.com/sagemath/sagetrac-mirror/commit/e0fd5597cb665cc8cf7d11e6d24e9e7dee691c57)**",
    "created_at": "2015-06-11T22:08:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254567",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3b3c0b2`](https://github.com/sagemath/sagetrac-mirror/commit/3b3c0b2d15289a8c4a5c5c25ad2984114a856916)** to **[`e0fd559`](https://github.com/sagemath/sagetrac-mirror/commit/e0fd5597cb665cc8cf7d11e6d24e9e7dee691c57)**



---

archive/issue_comments_254568.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nWe have the following behavior in root systems (as Travis mentioned):\n\n```\nsage: R = RootSystem(['B',2,1])\nsage: La = R.weight_space().basis()\nsage: LaE = R.weight_space(extended=True).basis()\nsage: La[0] == LaE[0]\nTrue\nsage: La[0].parent() == LaE[0].parent()\nFalse\n```\nThis yields to the behavior that LS paths labeled by extended fundamental weights and nonextended ones are considered to be the same crystal. Should we fix the weight issue or pass another (fake) argument in the init method to distinguish the crystals?\n\nNicolas, do you have an opinion on the above?",
    "created_at": "2015-06-11T22:35:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254568",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:29" align="right">comment:29</div>

We have the following behavior in root systems (as Travis mentioned):

```
sage: R = RootSystem(['B',2,1])
sage: La = R.weight_space().basis()
sage: LaE = R.weight_space(extended=True).basis()
sage: La[0] == LaE[0]
True
sage: La[0].parent() == LaE[0].parent()
False
```
This yields to the behavior that LS paths labeled by extended fundamental weights and nonextended ones are considered to be the same crystal. Should we fix the weight issue or pass another (fake) argument in the init method to distinguish the crystals?

Nicolas, do you have an opinion on the above?



---

archive/issue_comments_254569.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@dwbump](#comment%3A26):\n> Replying to [@anneschilling](#comment%3A19):\n> \n> > But in any case, someone should check!\n\n> \n> I will check it.\n\nI would if I could \u2026 I pulled the branch, built and can't run it it because of some problem with ascii_art. I'll make distclean and try again.\n\nI'm a little worried that if the changes required replacing the inner product in weyl_dimension method there could also be failures in weyl_characters.py too which also depend on the same inner product.",
    "created_at": "2015-06-12T00:59:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254569",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@dwbump](#comment%3A26):
> Replying to [@anneschilling](#comment%3A19):
> 
> > But in any case, someone should check!

> 
> I will check it.

I would if I could … I pulled the branch, built and can't run it it because of some problem with ascii_art. I'll make distclean and try again.

I'm a little worried that if the changes required replacing the inner product in weyl_dimension method there could also be failures in weyl_characters.py too which also depend on the same inner product.



---

archive/issue_comments_254570.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@dwbump](#comment%3A30):\n> Replying to [@dwbump](#comment%3A26):\n> > Replying to [@anneschilling](#comment%3A19):\n> > \n> > > But in any case, someone should check!\n\n> > \n> > I will check it.\n\n> \n> I would if I could \u2026 I pulled the branch, built and can't run it it because of some problem with ascii_art. I'll make distclean and try again.\n\nStrange. It works for both myself and Ben.\n\n> I'm a little worried that if the changes required replacing the inner product in weyl_dimension method there could also be failures in weyl_characters.py too which also depend on the same inner product.\n\nThe only problem with it was that it only worked for the ambient space and we want it for all weight lattices. If that is not an issue for weyl_character, then it hopefully does not change anything there!",
    "created_at": "2015-06-12T13:19:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254570",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@dwbump](#comment%3A30):
> Replying to [@dwbump](#comment%3A26):
> > Replying to [@anneschilling](#comment%3A19):
> > 
> > > But in any case, someone should check!

> > 
> > I will check it.

> 
> I would if I could … I pulled the branch, built and can't run it it because of some problem with ascii_art. I'll make distclean and try again.

Strange. It works for both myself and Ben.

> I'm a little worried that if the changes required replacing the inner product in weyl_dimension method there could also be failures in weyl_characters.py too which also depend on the same inner product.

The only problem with it was that it only worked for the ambient space and we want it for all weight lattices. If that is not an issue for weyl_character, then it hopefully does not change anything there!



---

archive/issue_comments_254571.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c8fd06023efa5185e302778858a99f588b4da919\"><code>c8fd060</code></a></td><td><code>Alcove paths weights are up to snuff.</code></td></tr></table>\n",
    "created_at": "2015-06-12T15:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254571",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c8fd06023efa5185e302778858a99f588b4da919"><code>c8fd060</code></a></td><td><code>Alcove paths weights are up to snuff.</code></td></tr></table>




---

archive/issue_comments_254572.json:
```json
{
    "body": "Changed commit from **[`e0fd559`](https://github.com/sagemath/sagetrac-mirror/commit/e0fd5597cb665cc8cf7d11e6d24e9e7dee691c57)** to **[`c8fd060`](https://github.com/sagemath/sagetrac-mirror/commit/c8fd06023efa5185e302778858a99f588b4da919)**",
    "created_at": "2015-06-12T15:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254572",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e0fd559`](https://github.com/sagemath/sagetrac-mirror/commit/e0fd5597cb665cc8cf7d11e6d24e9e7dee691c57)** to **[`c8fd060`](https://github.com/sagemath/sagetrac-mirror/commit/c8fd06023efa5185e302778858a99f588b4da919)**



---

archive/issue_comments_254573.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/495fa98ec8ecd009128b2a86c3e8a6ab0ed8d5ca\"><code>495fa98</code></a></td><td><code>documentation updates</code></td></tr></table>\n",
    "created_at": "2015-06-12T16:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254573",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/495fa98ec8ecd009128b2a86c3e8a6ab0ed8d5ca"><code>495fa98</code></a></td><td><code>documentation updates</code></td></tr></table>




---

archive/issue_comments_254574.json:
```json
{
    "body": "Changed commit from **[`c8fd060`](https://github.com/sagemath/sagetrac-mirror/commit/c8fd06023efa5185e302778858a99f588b4da919)** to **[`495fa98`](https://github.com/sagemath/sagetrac-mirror/commit/495fa98ec8ecd009128b2a86c3e8a6ab0ed8d5ca)**",
    "created_at": "2015-06-12T16:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254574",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c8fd060`](https://github.com/sagemath/sagetrac-mirror/commit/c8fd06023efa5185e302778858a99f588b4da919)** to **[`495fa98`](https://github.com/sagemath/sagetrac-mirror/commit/495fa98ec8ecd009128b2a86c3e8a6ab0ed8d5ca)**



---

archive/issue_comments_254575.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nIn the last commit, `weight_lattice_realization()` for `DirectSumOfCrystals` was added, too.",
    "created_at": "2015-06-12T16:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254575",
    "user": "https://github.com/bsalisbury1"
}
```

<div id="comment:34" align="right">comment:34</div>

In the last commit, `weight_lattice_realization()` for `DirectSumOfCrystals` was added, too.



---

archive/issue_comments_254576.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nAlso, original example is now fixed!\n\n```\nsage: C = crystals.infinity.NakajimaMonomials(['A',1,1])\nsage: v=C.highest_weight_vector()\nsage: v.f(1).weight()+v.f(0).weight()\n-delta\n```",
    "created_at": "2015-06-12T16:22:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254576",
    "user": "https://github.com/bsalisbury1"
}
```

<div id="comment:35" align="right">comment:35</div>

Also, original example is now fixed!

```
sage: C = crystals.infinity.NakajimaMonomials(['A',1,1])
sage: v=C.highest_weight_vector()
sage: v.f(1).weight()+v.f(0).weight()
-delta
```



---

archive/issue_comments_254577.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cb09595bc4536ae368470b3557a36e396d8b4aee\"><code>cb09595</code></a></td><td><code>18453: fixed equality of LS paths issue</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/42ed2f2cdb58a8f5383159716e9be570c779a7f3\"><code>42ed2f2</code></a></td><td><code>Merge branch 'public/crystal/18453' of git://trac.sagemath.org/sage into public/crystal/18453</code></td></tr></table>\n",
    "created_at": "2015-06-12T16:47:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254577",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:36"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cb09595bc4536ae368470b3557a36e396d8b4aee"><code>cb09595</code></a></td><td><code>18453: fixed equality of LS paths issue</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/42ed2f2cdb58a8f5383159716e9be570c779a7f3"><code>42ed2f2</code></a></td><td><code>Merge branch 'public/crystal/18453' of git://trac.sagemath.org/sage into public/crystal/18453</code></td></tr></table>




---

archive/issue_comments_254578.json:
```json
{
    "body": "Changed commit from **[`495fa98`](https://github.com/sagemath/sagetrac-mirror/commit/495fa98ec8ecd009128b2a86c3e8a6ab0ed8d5ca)** to **[`42ed2f2`](https://github.com/sagemath/sagetrac-mirror/commit/42ed2f2cdb58a8f5383159716e9be570c779a7f3)**",
    "created_at": "2015-06-12T16:47:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254578",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`495fa98`](https://github.com/sagemath/sagetrac-mirror/commit/495fa98ec8ecd009128b2a86c3e8a6ab0ed8d5ca)** to **[`42ed2f2`](https://github.com/sagemath/sagetrac-mirror/commit/42ed2f2cdb58a8f5383159716e9be570c779a7f3)**



---

archive/issue_comments_254579.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nThere are doctest failures in non_symmetric_macdonald_polynomials.py. There are quite a few but for example:\n\n```\n\nFailed example:\n\u00a0\u00a0\u00a0 for d in range(1,2):\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 # long time (41s)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 for a,b,c,d in !IntegerVectors(d,4):\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 weight = a*La![1]+b*La![2]+c*La![3]+d*La![4]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 weight0 = -a*omega![1]-b*omega![2]-c*omega![3]-d*omega![4]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 LS = crystals.ProjectedLevelZeroLSPaths(weight)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 assert E[weight0].map_coefficients(lambda !x:x.subs(t=0)) == LS.one_dimensional_configuration_sum(q)\nException raised:\n\u00a0\u00a0\u00a0 Traceback (most recent call last):\n\u00a0\u00a0\u00a0\u00a0\u00a0 File \"/home/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 self.compile_and_execute(example, compiler, test.globs)\n\u00a0\u00a0\u00a0\u00a0\u00a0 File \"/home/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 exec(compiled, globs)\n\u00a0\u00a0\u00a0\u00a0\u00a0 File \"<doctest sage.combinat.root_system.non_symmetric_macdonald_polynomials.!NonSymmetricMacdonaldPolynomials![201]>\", line 6, in <module>\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 assert E[weight0].map_coefficients(lambda !x:x.subs(t=Integer(0))) == LS.one_dimensional_configuration_sum(q)\n\u00a0\u00a0\u00a0 !AssertionError\n```",
    "created_at": "2015-06-12T16:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254579",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:37" align="right">comment:37</div>

There are doctest failures in non_symmetric_macdonald_polynomials.py. There are quite a few but for example:

```

Failed example:
    for d in range(1,2):                                  # long time (41s)
        for a,b,c,d in !IntegerVectors(d,4):
            weight = a*La![1]+b*La![2]+c*La![3]+d*La![4]
            weight0 = -a*omega![1]-b*omega![2]-c*omega![3]-d*omega![4]
            LS = crystals.ProjectedLevelZeroLSPaths(weight)
            assert E[weight0].map_coefficients(lambda !x:x.subs(t=0)) == LS.one_dimensional_configuration_sum(q)
Exception raised:
    Traceback (most recent call last):
      File "/home/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/bump/sagemath/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.combinat.root_system.non_symmetric_macdonald_polynomials.!NonSymmetricMacdonaldPolynomials![201]>", line 6, in <module>
        assert E[weight0].map_coefficients(lambda !x:x.subs(t=Integer(0))) == LS.one_dimensional_configuration_sum(q)
    !AssertionError
```



---

archive/issue_comments_254580.json:
```json
{
    "body": "Changed commit from **[`42ed2f2`](https://github.com/sagemath/sagetrac-mirror/commit/42ed2f2cdb58a8f5383159716e9be570c779a7f3)** to **[`f4955c5`](https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a)**",
    "created_at": "2015-06-12T17:02:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254580",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`42ed2f2`](https://github.com/sagemath/sagetrac-mirror/commit/42ed2f2cdb58a8f5383159716e9be570c779a7f3)** to **[`f4955c5`](https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a)**



---

archive/issue_comments_254581.json:
```json
{
    "body": "<div id=\"comment:38\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a\"><code>f4955c5</code></a></td><td><code>Fixing RC crystals for extended and non-extended weight input.</code></td></tr></table>\n",
    "created_at": "2015-06-12T17:02:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254581",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:38"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a"><code>f4955c5</code></a></td><td><code>Fixing RC crystals for extended and non-extended weight input.</code></td></tr></table>




---

archive/issue_comments_254582.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nDan,\n\nI think you are not using the latest branch! Please pull again and then try again!\n\nAnne\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a\"><code>f4955c5</code></a></td><td><code>Fixing RC crystals for extended and non-extended weight input.</code></td></tr></table>\n",
    "created_at": "2015-06-12T17:02:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254582",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:39" align="right">comment:39</div>

Dan,

I think you are not using the latest branch! Please pull again and then try again!

Anne

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a"><code>f4955c5</code></a></td><td><code>Fixing RC crystals for extended and non-extended weight input.</code></td></tr></table>




---

archive/issue_events_259919.json:
```json
{
    "actor": "https://github.com/bsalisbury1",
    "created_at": "2015-06-12T17:10:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259919"
}
```



---

archive/issue_comments_254583.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nAll tests passed on my and Anne's machine.  Travis' changes look good, too.  We think it's ready for review.  \n\nDan, would you mind reviewing the ticket?\n\nBest,\nBen",
    "created_at": "2015-06-12T17:10:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254583",
    "user": "https://github.com/bsalisbury1"
}
```

<div id="comment:40" align="right">comment:40</div>

All tests passed on my and Anne's machine.  Travis' changes look good, too.  We think it's ready for review.  

Dan, would you mind reviewing the ticket?

Best,
Ben



---

archive/issue_comments_254584.json:
```json
{
    "body": "Reviewer: **bump**",
    "created_at": "2015-06-12T17:56:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254584",
    "user": "https://github.com/dwbump"
}
```

Reviewer: **bump**



---

archive/issue_comments_254585.json:
```json
{
    "body": "Changed reviewer from **bump** to **Dan Bump**",
    "created_at": "2015-06-12T20:23:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254585",
    "user": "https://github.com/anneschilling"
}
```

Changed reviewer from **bump** to **Dan Bump**



---

archive/issue_comments_254586.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nAll tests pass with !`sage --testall`.\n\nI will look at it some more.",
    "created_at": "2015-06-12T22:00:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254586",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:43" align="right">comment:43</div>

All tests pass with !`sage --testall`.

I will look at it some more.



---

archive/issue_comments_254587.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nFrom the thematic tutorial at http://doc.sagemath.org/html/en/thematic_tutorials/lie/affine_hw_crystals.html\nwe have:\n\n```\nsage: sage: La = RootSystem(['C',3,1]).weight_space().fundamental_weights()\nsage: sage: LS = crystals.LSPaths(2*La[1]+La[2])\nsage: sage: SL = LS.subcrystal(max_depth=3)\nsage: sage: GL = LS.digraph(subset=SL)\nsage: sage: La = RootSystem(['C',3,1]).weight_lattice().fundamental_weights()\nsage: sage: M = crystals.NakajimaMonomials(['C',3,1], 2*La[1]+La[2])\nsage: sage: SM = M.subcrystal(max_depth=3)\nsage: sage: GM = M.digraph(subset=SM)\nsage: sage: GL.is_isomorphic(GM, edge_labels=True)\nTrue\n```\n\nWhy do we use weight_space for one and weight_lattice for the other? (Maybe the thematic tutorial should explain.)\n\nAfter this:\n\n```\nsage: LS.weight_lattice_realization().is_extended()\nFalse\nsage: M.weight_lattice_realization().is_extended()\nTrue\n```\n\nI think the point of the example in the tutorial is that the two crystals are isomorphic, but one uses the extended lattice and the other does not.\n\nI think that the user should be encouraged to use extended lattice for crystals of integrable representations of affine Lie algebras and therefore the example in the thematic tutorial should be changed. The tutorial goes on and shows another affine crystal in the Littelmann path model that does use the extended lattice. I think the patch is good but it would be good if some revisions to the above page in the thematic tutorial are made. Here are some suggestions for change to the tutorial that could be part of this patch.\n\n(1) Change the first example to use the extended lattice unless there is a reason not to.\n(2) Tell the user just a bit more about the issue. The following is my understanding: roughly, the extended lattice is the weight lattice of the full Kac-Moody Lie algebra and the unextended lattice is the weight lattice of the derived algebra.  If the highest weight is a nonzero dominant weight then the crystal is infinite and it is preferrable to use the extended lattice. These are the crystals of integrable representations. A contrasting situation is with Kirillov-Reshetikhin crystals where there is an advantage to working with the unextended lattice, namely that the derived algebra has a finite dimensional crystal where the full Kac-Moody Lie algebra has an infinite one. So there is an advantage in this case to using the derived Lie algebra and its weight lattice is the unextended one.\n(3) Explain why we use weight_space in the LS path model but weight_lattice in the monomial model.",
    "created_at": "2015-06-13T04:45:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254587",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:44" align="right">comment:44</div>

From the thematic tutorial at http://doc.sagemath.org/html/en/thematic_tutorials/lie/affine_hw_crystals.html
we have:

```
sage: sage: La = RootSystem(['C',3,1]).weight_space().fundamental_weights()
sage: sage: LS = crystals.LSPaths(2*La[1]+La[2])
sage: sage: SL = LS.subcrystal(max_depth=3)
sage: sage: GL = LS.digraph(subset=SL)
sage: sage: La = RootSystem(['C',3,1]).weight_lattice().fundamental_weights()
sage: sage: M = crystals.NakajimaMonomials(['C',3,1], 2*La[1]+La[2])
sage: sage: SM = M.subcrystal(max_depth=3)
sage: sage: GM = M.digraph(subset=SM)
sage: sage: GL.is_isomorphic(GM, edge_labels=True)
True
```

Why do we use weight_space for one and weight_lattice for the other? (Maybe the thematic tutorial should explain.)

After this:

```
sage: LS.weight_lattice_realization().is_extended()
False
sage: M.weight_lattice_realization().is_extended()
True
```

I think the point of the example in the tutorial is that the two crystals are isomorphic, but one uses the extended lattice and the other does not.

I think that the user should be encouraged to use extended lattice for crystals of integrable representations of affine Lie algebras and therefore the example in the thematic tutorial should be changed. The tutorial goes on and shows another affine crystal in the Littelmann path model that does use the extended lattice. I think the patch is good but it would be good if some revisions to the above page in the thematic tutorial are made. Here are some suggestions for change to the tutorial that could be part of this patch.

(1) Change the first example to use the extended lattice unless there is a reason not to.
(2) Tell the user just a bit more about the issue. The following is my understanding: roughly, the extended lattice is the weight lattice of the full Kac-Moody Lie algebra and the unextended lattice is the weight lattice of the derived algebra.  If the highest weight is a nonzero dominant weight then the crystal is infinite and it is preferrable to use the extended lattice. These are the crystals of integrable representations. A contrasting situation is with Kirillov-Reshetikhin crystals where there is an advantage to working with the unextended lattice, namely that the derived algebra has a finite dimensional crystal where the full Kac-Moody Lie algebra has an infinite one. So there is an advantage in this case to using the derived Lie algebra and its weight lattice is the unextended one.
(3) Explain why we use weight_space in the LS path model but weight_lattice in the monomial model.



---

archive/issue_comments_254588.json:
```json
{
    "body": "Changed commit from **[`f4955c5`](https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a)** to **[`9b5b9d5`](https://github.com/sagemath/sagetrac-mirror/commit/9b5b9d5e83a40a6fe55ea23d8cdf33d0f0a131c5)**",
    "created_at": "2015-06-13T23:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254588",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`f4955c5`](https://github.com/sagemath/sagetrac-mirror/commit/f4955c5f50d4f34510176acff8956f49d3b8702a)** to **[`9b5b9d5`](https://github.com/sagemath/sagetrac-mirror/commit/9b5b9d5e83a40a6fe55ea23d8cdf33d0f0a131c5)**



---

archive/issue_comments_254589.json:
```json
{
    "body": "<div id=\"comment:45\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f156803dfb27b41f5837084e0708dc4b8295985f\"><code>f156803</code></a></td><td><code>18453: small edits</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9b5b9d5e83a40a6fe55ea23d8cdf33d0f0a131c5\"><code>9b5b9d5</code></a></td><td><code>Merge branch 'develop' into public/crystal/18453</code></td></tr></table>\n",
    "created_at": "2015-06-13T23:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254589",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f156803dfb27b41f5837084e0708dc4b8295985f"><code>f156803</code></a></td><td><code>18453: small edits</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9b5b9d5e83a40a6fe55ea23d8cdf33d0f0a131c5"><code>9b5b9d5</code></a></td><td><code>Merge branch 'develop' into public/crystal/18453</code></td></tr></table>




---

archive/issue_comments_254590.json:
```json
{
    "body": "Changed commit from **[`9b5b9d5`](https://github.com/sagemath/sagetrac-mirror/commit/9b5b9d5e83a40a6fe55ea23d8cdf33d0f0a131c5)** to **[`d120397`](https://github.com/sagemath/sagetrac-mirror/commit/d120397df0e3861d7f8a876da1a62836d9cdd00b)**",
    "created_at": "2015-06-14T00:39:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254590",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9b5b9d5`](https://github.com/sagemath/sagetrac-mirror/commit/9b5b9d5e83a40a6fe55ea23d8cdf33d0f0a131c5)** to **[`d120397`](https://github.com/sagemath/sagetrac-mirror/commit/d120397df0e3861d7f8a876da1a62836d9cdd00b)**



---

archive/issue_comments_254591.json:
```json
{
    "body": "<div id=\"comment:46\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d120397df0e3861d7f8a876da1a62836d9cdd00b\"><code>d120397</code></a></td><td><code>18453: updated thematic tutorial on affine crystals</code></td></tr></table>\n",
    "created_at": "2015-06-14T00:39:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254591",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:46"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d120397df0e3861d7f8a876da1a62836d9cdd00b"><code>d120397</code></a></td><td><code>18453: updated thematic tutorial on affine crystals</code></td></tr></table>




---

archive/issue_comments_254592.json:
```json
{
    "body": "Changed commit from **[`d120397`](https://github.com/sagemath/sagetrac-mirror/commit/d120397df0e3861d7f8a876da1a62836d9cdd00b)** to **[`8e5c4cd`](https://github.com/sagemath/sagetrac-mirror/commit/8e5c4cd07daadb6479b3a6bc18b12d42254a3d74)**",
    "created_at": "2015-06-14T00:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254592",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d120397`](https://github.com/sagemath/sagetrac-mirror/commit/d120397df0e3861d7f8a876da1a62836d9cdd00b)** to **[`8e5c4cd`](https://github.com/sagemath/sagetrac-mirror/commit/8e5c4cd07daadb6479b3a6bc18b12d42254a3d74)**



---

archive/issue_comments_254593.json:
```json
{
    "body": "<div id=\"comment:47\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8e5c4cd07daadb6479b3a6bc18b12d42254a3d74\"><code>8e5c4cd</code></a></td><td><code>18453: some more additions to the thematic tutorial</code></td></tr></table>\n",
    "created_at": "2015-06-14T00:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254593",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:47"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8e5c4cd07daadb6479b3a6bc18b12d42254a3d74"><code>8e5c4cd</code></a></td><td><code>18453: some more additions to the thematic tutorial</code></td></tr></table>




---

archive/issue_comments_254594.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nHi Dan,\n\nGood points! I fixed the examples in the thematic tutorial (and also the picture since it was missing the deltas as well) and put some extra explanations.\n\nAnne\n\nPS: I also rebased on top of sage-6.5.beta4.",
    "created_at": "2015-06-14T00:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254594",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:48" align="right">comment:48</div>

Hi Dan,

Good points! I fixed the examples in the thematic tutorial (and also the picture since it was missing the deltas as well) and put some extra explanations.

Anne

PS: I also rebased on top of sage-6.5.beta4.



---

archive/issue_events_259920.json:
```json
{
    "actor": "https://github.com/dwbump",
    "created_at": "2015-06-14T03:49:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259920"
}
```



---

archive/issue_events_259921.json:
```json
{
    "actor": "https://github.com/dwbump",
    "created_at": "2015-06-14T03:49:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259921"
}
```



---

archive/issue_comments_254595.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nI gave this a positive review. Here is a (temporary) link to the revised tutorial.\n\nhttp://match.stanford.edu/thematic_tutorials/lie.html\n\nI am currently unable to run tests for some reason, but I ran sage -testall before the rebase.",
    "created_at": "2015-06-14T04:50:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254595",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:50" align="right">comment:50</div>

I gave this a positive review. Here is a (temporary) link to the revised tutorial.

http://match.stanford.edu/thematic_tutorials/lie.html

I am currently unable to run tests for some reason, but I ran sage -testall before the rebase.



---

archive/issue_comments_254596.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\n\n```\nsage -t --long src/sage/combinat/crystals/littelmann_path.py  # 3 doctests failed\nsage -t --long src/sage/combinat/crystals/tensor_product.py  # 1 doctest failed\nsage -t --long src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py  # 10 doctests failed\n```",
    "created_at": "2015-06-14T14:02:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254596",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:51" align="right">comment:51</div>


```
sage -t --long src/sage/combinat/crystals/littelmann_path.py  # 3 doctests failed
sage -t --long src/sage/combinat/crystals/tensor_product.py  # 1 doctest failed
sage -t --long src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py  # 10 doctests failed
```



---

archive/issue_events_259922.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-14T14:02:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259922"
}
```



---

archive/issue_events_259923.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-14T14:02:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259923"
}
```



---

archive/issue_comments_254597.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nHere's the problem:\n\n```\nsage: La = RootSystem(['A',2,1]).weight_space().basis()\nsage: LS = crystals.ProjectedLevelZeroLSPaths(2*La[1])\nsage: LS.weight_lattice_realization()\nWeight space over the Rational Field of the Root system of type ['A', 2, 1]\nsage: CS = LS.one_dimensional_configuration_sum()\nsage: CS\nB[-2*Lambda[1] + 2*Lambda[2]] + (q+1)*B[-Lambda[1]] + (q+1)*B[Lambda[1] - Lambda[2]] + B[2*Lambda[1]] + B[-2*Lambda[2]] + (q+1)*B[Lambda[2]]\nsage: K = crystals.KirillovReshetikhin(['A',2,1], 1,1)\nsage: T = K.tensor(K)\nsage: CSK = T.one_dimensional_configuration_sum()\nsage: CSK\nB[-2*Lambda[1] + 2*Lambda[2]] + (q+1)*B[-Lambda[1]] + (q+1)*B[Lambda[1] - Lambda[2]] + B[2*Lambda[1]] + B[-2*Lambda[2]] + (q+1)*B[Lambda[2]]\nsage: CS == CSK\nFalse\nsage: CS.parent()\nGroup algebra of the Weight space over the Rational Field of the Root system of type ['A', 2] over Univariate Polynomial Ring in q over Rational Field\nsage: CSK.parent()\nGroup algebra of the Weight lattice of the Root system of type ['A', 2] over Univariate Polynomial Ring in q over Rational Field\nsage: CS.parent().has_coerce_map_from(CSK.parent())\nFalse\n```\nThe group algebra, by its functoriality, should have a coercion when the underlying groups have a coercion:\n\n```\nsage: CS.parent()._indices.has_coerce_map_from(CSK.parent()._indices)\nTrue\n```\nThis is now #18700.",
    "created_at": "2015-06-14T15:36:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254597",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:52" align="right">comment:52</div>

Here's the problem:

```
sage: La = RootSystem(['A',2,1]).weight_space().basis()
sage: LS = crystals.ProjectedLevelZeroLSPaths(2*La[1])
sage: LS.weight_lattice_realization()
Weight space over the Rational Field of the Root system of type ['A', 2, 1]
sage: CS = LS.one_dimensional_configuration_sum()
sage: CS
B[-2*Lambda[1] + 2*Lambda[2]] + (q+1)*B[-Lambda[1]] + (q+1)*B[Lambda[1] - Lambda[2]] + B[2*Lambda[1]] + B[-2*Lambda[2]] + (q+1)*B[Lambda[2]]
sage: K = crystals.KirillovReshetikhin(['A',2,1], 1,1)
sage: T = K.tensor(K)
sage: CSK = T.one_dimensional_configuration_sum()
sage: CSK
B[-2*Lambda[1] + 2*Lambda[2]] + (q+1)*B[-Lambda[1]] + (q+1)*B[Lambda[1] - Lambda[2]] + B[2*Lambda[1]] + B[-2*Lambda[2]] + (q+1)*B[Lambda[2]]
sage: CS == CSK
False
sage: CS.parent()
Group algebra of the Weight space over the Rational Field of the Root system of type ['A', 2] over Univariate Polynomial Ring in q over Rational Field
sage: CSK.parent()
Group algebra of the Weight lattice of the Root system of type ['A', 2] over Univariate Polynomial Ring in q over Rational Field
sage: CS.parent().has_coerce_map_from(CSK.parent())
False
```
The group algebra, by its functoriality, should have a coercion when the underlying groups have a coercion:

```
sage: CS.parent()._indices.has_coerce_map_from(CSK.parent()._indices)
True
```
This is now #18700.



---

archive/issue_comments_254598.json:
```json
{
    "body": "Dependencies: **#18700**",
    "created_at": "2015-06-14T15:36:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254598",
    "user": "https://github.com/tscrim"
}
```

Dependencies: **#18700**



---

archive/issue_comments_254599.json:
```json
{
    "body": "Changed commit from **[`8e5c4cd`](https://github.com/sagemath/sagetrac-mirror/commit/8e5c4cd07daadb6479b3a6bc18b12d42254a3d74)** to **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)**",
    "created_at": "2015-06-14T15:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254599",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`8e5c4cd`](https://github.com/sagemath/sagetrac-mirror/commit/8e5c4cd07daadb6479b3a6bc18b12d42254a3d74)** to **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)**



---

archive/issue_comments_254600.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db\"><code>ee398ef</code></a></td><td><code>18453: fixed one_dimensional_configuration sum issue</code></td></tr></table>\n",
    "created_at": "2015-06-14T15:52:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254600",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db"><code>ee398ef</code></a></td><td><code>18453: fixed one_dimensional_configuration sum issue</code></td></tr></table>




---

archive/issue_comments_254601.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nThe problem is that the weight are now in the weight space rather than the weight lattice. I fixed this in one dimensional configuration sums directly, so we do not need 18700.",
    "created_at": "2015-06-14T15:54:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254601",
    "user": "https://github.com/anneschilling"
}
```

<div id="comment:54" align="right">comment:54</div>

The problem is that the weight are now in the weight space rather than the weight lattice. I fixed this in one dimensional configuration sums directly, so we do not need 18700.



---

archive/issue_comments_254602.json:
```json
{
    "body": "Changed dependencies from **#18700** to none",
    "created_at": "2015-06-14T15:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254602",
    "user": "https://github.com/anneschilling"
}
```

Changed dependencies from **#18700** to none



---

archive/issue_events_259924.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2015-06-14T15:55:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259924"
}
```



---

archive/issue_events_259925.json:
```json
{
    "actor": "https://github.com/anneschilling",
    "created_at": "2015-06-14T15:55:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259925"
}
```



---

archive/issue_comments_254603.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nI ran doctests again in /combinat and /categories and did not have any failures after Anne's changes.  In particular:\n\n```\nsage -t --warn-long 69.0 src/sage/combinat/crystals/littelmann_path.py\n    [242 tests, 5.61 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 5.7 seconds\n    cpu time: 5.6 seconds\n    cumulative wall time: 5.6 seconds\nBenBook:sage-git Ben$ sage -tp src/sage/combinat/crystals/littelmann_path.py \nRunning doctests with ID 2015-06-14-12-03-41-3453f2af.\nGit branch: t/18453/public/crystal/18453\nUsing --optional=gcc,mpir,python2,sage,scons\nDoctesting 1 file using 8 threads.\nsage -t --warn-long 68.9 src/sage/combinat/crystals/littelmann_path.py\n    [242 tests, 5.26 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 5.3 seconds\n    cpu time: 5.3 seconds\n    cumulative wall time: 5.3 seconds\nBenBook:sage-git Ben$ sage -tp src/sage/combinat/crystals/tensor_product.py \nRunning doctests with ID 2015-06-14-12-08-45-ab879d56.\nGit branch: t/18453/public/crystal/18453\nUsing --optional=gcc,mpir,python2,sage,scons\nDoctesting 1 file using 8 threads.\nsage -t --warn-long 69.0 src/sage/combinat/crystals/tensor_product.py\n    [439 tests, 2.39 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 2.5 seconds\n    cpu time: 2.4 seconds\n    cumulative wall time: 2.4 seconds\nBenBook:sage-git Ben$ sage -tp src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py \nRunning doctests with ID 2015-06-14-12-04-16-dbb764b5.\nGit branch: t/18453/public/crystal/18453\nUsing --optional=gcc,mpir,python2,sage,scons\nDoctesting 1 file using 8 threads.\nsage -t --warn-long 68.9 src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py\n    [533 tests, 8.01 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 8.1 seconds\n    cpu time: 7.9 seconds\n    cumulative wall time: 8.0 seconds\n```",
    "created_at": "2015-06-14T16:08:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254603",
    "user": "https://github.com/bsalisbury1"
}
```

<div id="comment:56" align="right">comment:56</div>

I ran doctests again in /combinat and /categories and did not have any failures after Anne's changes.  In particular:

```
sage -t --warn-long 69.0 src/sage/combinat/crystals/littelmann_path.py
    [242 tests, 5.61 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 5.7 seconds
    cpu time: 5.6 seconds
    cumulative wall time: 5.6 seconds
BenBook:sage-git Ben$ sage -tp src/sage/combinat/crystals/littelmann_path.py 
Running doctests with ID 2015-06-14-12-03-41-3453f2af.
Git branch: t/18453/public/crystal/18453
Using --optional=gcc,mpir,python2,sage,scons
Doctesting 1 file using 8 threads.
sage -t --warn-long 68.9 src/sage/combinat/crystals/littelmann_path.py
    [242 tests, 5.26 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 5.3 seconds
    cpu time: 5.3 seconds
    cumulative wall time: 5.3 seconds
BenBook:sage-git Ben$ sage -tp src/sage/combinat/crystals/tensor_product.py 
Running doctests with ID 2015-06-14-12-08-45-ab879d56.
Git branch: t/18453/public/crystal/18453
Using --optional=gcc,mpir,python2,sage,scons
Doctesting 1 file using 8 threads.
sage -t --warn-long 69.0 src/sage/combinat/crystals/tensor_product.py
    [439 tests, 2.39 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 2.5 seconds
    cpu time: 2.4 seconds
    cumulative wall time: 2.4 seconds
BenBook:sage-git Ben$ sage -tp src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py 
Running doctests with ID 2015-06-14-12-04-16-dbb764b5.
Git branch: t/18453/public/crystal/18453
Using --optional=gcc,mpir,python2,sage,scons
Doctesting 1 file using 8 threads.
sage -t --warn-long 68.9 src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py
    [533 tests, 8.01 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 8.1 seconds
    cpu time: 7.9 seconds
    cumulative wall time: 8.0 seconds
```



---

archive/issue_comments_254604.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nThese tests are marked `# long time`, so you need to run them with the `--long` option (`--warn-long` just notifies you if a test took over a certain time (the default being 1 second)).",
    "created_at": "2015-06-14T17:13:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254604",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:57" align="right">comment:57</div>

These tests are marked `# long time`, so you need to run them with the `--long` option (`--warn-long` just notifies you if a test took over a certain time (the default being 1 second)).



---

archive/issue_comments_254605.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nThanks, Travis.  Here is the updated proof of passed tests:\n\n```\nBenBook:sage-git Ben$ sage -tp --long src/sage/combinat/crystals/littelmann_path.py \nRunning doctests with ID 2015-06-14-13-18-12-ce4dd0f9.\nGit branch: t/18453/public/crystal/18453\nUsing --optional=gcc,mpir,python2,sage,scons\nDoctesting 1 file using 8 threads.\nsage -t --long --warn-long 69.0 src/sage/combinat/crystals/littelmann_path.py\n    [254 tests, 31.08 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 31.2 seconds\n    cpu time: 31.0 seconds\n    cumulative wall time: 31.1 seconds\nBenBook:sage-git Ben$ sage -tp --long src/sage/combinat/crystals/tensor_product.py \nRunning doctests with ID 2015-06-14-13-19-01-4e6d8c8e.\nGit branch: t/18453/public/crystal/18453\nUsing --optional=gcc,mpir,python2,sage,scons\nDoctesting 1 file using 8 threads.\nsage -t --long --warn-long 69.1 src/sage/combinat/crystals/tensor_product.py\n    [441 tests, 3.40 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 3.5 seconds\n    cpu time: 3.4 seconds\n    cumulative wall time: 3.4 seconds\nBenBook:sage-git Ben$ sage -tp --long src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py \nRunning doctests with ID 2015-06-14-13-19-21-7bd8f158.\nGit branch: t/18453/public/crystal/18453\nUsing --optional=gcc,mpir,python2,sage,scons\nDoctesting 1 file using 8 threads.\nsage -t --long --warn-long 69.1 src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py\n**********************************************************************\nFile \"src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py\", line 695, in sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials\nWarning, slow doctest:\n    E[-2*omega[1]-omega[2]].map_coefficients(lambda x:x.subs(t=0)) == LS.one_dimensional_configuration_sum(q) # long time\nTest ran for 84.13 s\n    [562 tests, 149.57 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\nTotal time for all tests: 149.7 seconds\n    cpu time: 149.4 seconds\n    cumulative wall time: 149.6 seconds\n```",
    "created_at": "2015-06-14T18:01:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254605",
    "user": "https://github.com/bsalisbury1"
}
```

<div id="comment:58" align="right">comment:58</div>

Thanks, Travis.  Here is the updated proof of passed tests:

```
BenBook:sage-git Ben$ sage -tp --long src/sage/combinat/crystals/littelmann_path.py 
Running doctests with ID 2015-06-14-13-18-12-ce4dd0f9.
Git branch: t/18453/public/crystal/18453
Using --optional=gcc,mpir,python2,sage,scons
Doctesting 1 file using 8 threads.
sage -t --long --warn-long 69.0 src/sage/combinat/crystals/littelmann_path.py
    [254 tests, 31.08 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 31.2 seconds
    cpu time: 31.0 seconds
    cumulative wall time: 31.1 seconds
BenBook:sage-git Ben$ sage -tp --long src/sage/combinat/crystals/tensor_product.py 
Running doctests with ID 2015-06-14-13-19-01-4e6d8c8e.
Git branch: t/18453/public/crystal/18453
Using --optional=gcc,mpir,python2,sage,scons
Doctesting 1 file using 8 threads.
sage -t --long --warn-long 69.1 src/sage/combinat/crystals/tensor_product.py
    [441 tests, 3.40 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 3.5 seconds
    cpu time: 3.4 seconds
    cumulative wall time: 3.4 seconds
BenBook:sage-git Ben$ sage -tp --long src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py 
Running doctests with ID 2015-06-14-13-19-21-7bd8f158.
Git branch: t/18453/public/crystal/18453
Using --optional=gcc,mpir,python2,sage,scons
Doctesting 1 file using 8 threads.
sage -t --long --warn-long 69.1 src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py
**********************************************************************
File "src/sage/combinat/root_system/non_symmetric_macdonald_polynomials.py", line 695, in sage.combinat.root_system.non_symmetric_macdonald_polynomials.NonSymmetricMacdonaldPolynomials
Warning, slow doctest:
    E[-2*omega[1]-omega[2]].map_coefficients(lambda x:x.subs(t=0)) == LS.one_dimensional_configuration_sum(q) # long time
Test ran for 84.13 s
    [562 tests, 149.57 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
Total time for all tests: 149.7 seconds
    cpu time: 149.4 seconds
    cumulative wall time: 149.6 seconds
```



---

archive/issue_events_259926.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-06-15T05:16:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259926"
}
```



---

archive/issue_events_259927.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-06-15T05:16:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259927"
}
```



---

archive/issue_comments_254606.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThis change is okay.",
    "created_at": "2015-06-15T05:16:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254606",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:59" align="right">comment:59</div>

This change is okay.



---

archive/issue_comments_254607.json:
```json
{
    "body": "Changed branch from **[public/crystal/18453](https://github.com/sagemath/sagetrac-mirror/tree/public/crystal/18453)** to **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)**",
    "created_at": "2015-06-15T21:56:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254607",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/crystal/18453](https://github.com/sagemath/sagetrac-mirror/tree/public/crystal/18453)** to **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)**



---

archive/issue_events_259928.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-15T21:56:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259928"
}
```



---

archive/issue_events_259929.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "63b5b4dabf429d5efaf766da3c7c9ae462dd442b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-15T21:56:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18453#event-259929"
}
```



---

archive/issue_comments_254608.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nReplying to [@anneschilling](#comment%3A19):\n> Replying to [@nthiery](#comment%3A17):\n> > Replying to [@anneschilling](#comment%3A8):\n> > > I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space).\n\n> > \n> > By Dan, if I recall correctly.\n\n> \n> ```\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  859)         def weyl_dimension(self, highest_weight):\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  860)             \"\"\"\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  861)             EXAMPLES::\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  862) \n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  863)                 sage: RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0])\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  864)                 20\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  865) \n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  866)                 sage: type(RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0]))\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  867)                 <type 'sage.rings.integer.Integer'>\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  868)             \"\"\"\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  869)             highest_weight = self(highest_weight)\n> f562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  870)             if not highest_weight.is_dominant():\n> f562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  871)                 raise ValueError(\"the highest weight must be dominant\")\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  872)             rho = self.rho()\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  873)             n = prod([(rho+highest_weight).dot_product(x) for x in self.positive_roots()])\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  874)             d = prod([ rho.dot_product(x) for x in self.positive_roots()])\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  875)             from sage.rings.integer import Integer\n> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  876)             return Integer(n/d)\n> ```\n\nThis got me curious about my memory failing. Digging back in history ended up in a mercurial patch from early 2008 from which one can't extract the author. As far as I remember, I refactored this code at different occasions (in the above to move it from\nweight_lattice_realization to weight_lattice_realizations when\ncreating the categories), but the original code was by Dan in the `WeylDim` function. Anyway just ranting this has no relevance.",
    "created_at": "2015-06-17T17:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254608",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:61" align="right">comment:61</div>

Replying to [@anneschilling](#comment%3A19):
> Replying to [@nthiery](#comment%3A17):
> > Replying to [@anneschilling](#comment%3A8):
> > > I had to fix the Weyl dimension formula (which I guess was written by Nicolas and only worked in the ambient space).

> > 
> > By Dan, if I recall correctly.

> 
> ```
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  859)         def weyl_dimension(self, highest_weight):
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  860)             """
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  861)             EXAMPLES::
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  862) 
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  863)                 sage: RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0])
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  864)                 20
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  865) 
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  866)                 sage: type(RootSystem(['A',3]).ambient_lattice().weyl_dimension([2,1,0,0]))
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  867)                 <type 'sage.rings.integer.Integer'>
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  868)             """
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  869)             highest_weight = self(highest_weight)
> f562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  870)             if not highest_weight.is_dominant():
> f562ca2b (Travis Scrimshaw  2014-10-01 17:16:31 -0700  871)                 raise ValueError("the highest weight must be dominant")
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  872)             rho = self.rho()
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  873)             n = prod([(rho+highest_weight).dot_product(x) for x in self.positive_roots()])
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  874)             d = prod([ rho.dot_product(x) for x in self.positive_roots()])
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  875)             from sage.rings.integer import Integer
> 7d693534 (Nicolas M. Thiery 2012-03-19 21:38:26 +0100  876)             return Integer(n/d)
> ```

This got me curious about my memory failing. Digging back in history ended up in a mercurial patch from early 2008 from which one can't extract the author. As far as I remember, I refactored this code at different occasions (in the above to move it from
weight_lattice_realization to weight_lattice_realizations when
creating the categories), but the original code was by Dan in the `WeylDim` function. Anyway just ranting this has no relevance.



---

archive/issue_comments_254609.json:
```json
{
    "body": "Changed commit from **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)** to none",
    "created_at": "2015-06-17T17:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254609",
    "user": "https://github.com/nthiery"
}
```

Changed commit from **[`ee398ef`](https://github.com/sagemath/sagetrac-mirror/commit/ee398efc22755947ea98f0a8250333d21352f2db)** to none



---

archive/issue_comments_254610.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nThis agrees with my recollection.\n\n> As far as I remember, I refactored this code at different occasions (in the above to move it from weight_lattice_realization to weight_lattice_realizations when creating the categories), but the original code was by Dan in the WeylDim function.",
    "created_at": "2015-06-29T14:01:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18453",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18453#issuecomment-254610",
    "user": "https://github.com/dwbump"
}
```

<div id="comment:62" align="right">comment:62</div>

This agrees with my recollection.

> As far as I remember, I refactored this code at different occasions (in the above to move it from weight_lattice_realization to weight_lattice_realizations when creating the categories), but the original code was by Dan in the WeylDim function.
