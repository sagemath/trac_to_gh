# Issue 18356: special resultants ``composed_sum`` and ``composed_product``

archive/issues_018119.json:
```json
{
    "assignees": [],
    "body": "Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division of two polynomias. That is the polynomial whose roots are the sum (resp. difference, product, division) of the roots of the two polynomials.\n\nTwo implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. For the latter algorithm, only polynomial with coefficient in `ZZ` or `QQ` are supported. However, this algorithm is asymptotically faster than using the `resultant` method.\n\nFor instance\n\n```\nsage: p1 = minpoly(cos(pi/43))\nsage: p2 = minpoly(cos(pi/47))\nsage: time r1 = p1.composed_op(p2, operator.add)\nCPU times: user 108 ms, sys: 4 ms, total: 112 ms\nWall time: 111 ms\nsage: time r2 = p1.composed_op(p2, operator.add, algorithm=\"resultant\")\nCPU times: user 47.1 s, sys: 0 ns, total: 47.1 s\nWall time: 47.1 s\nsage: r1 == r2\nTrue\nsage: r1.is_irreducible()\nTrue\n```\nIn the example above, `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`\n\nReference:\n\n [BFSS] A. Bostan, P. Flajolet, B. Salvy and E. Schost, \"Fast Computation of special resultants\", Journal of Symbolic Computation 41 (2006), 1-29\n\nBranch: **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)**\n\nReviewer: **Vincent Delecroix, Marc Mezzarobba**\n\nAuthor: **Mario Pernici, Vincent Delecroix**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18356_\n\n",
    "closed_at": "2016-05-19T22:39:02Z",
    "created_at": "2015-05-03T17:41:29Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "special resultants ``composed_sum`` and ``composed_product``",
    "type": "issue",
    "updated_at": "2016-07-14T07:59:36Z",
    "url": "https://github.com/sagemath/sage/issues/18356",
    "user": "https://github.com/sagetrac-pernici"
}
```
Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division of two polynomias. That is the polynomial whose roots are the sum (resp. difference, product, division) of the roots of the two polynomials.

Two implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. For the latter algorithm, only polynomial with coefficient in `ZZ` or `QQ` are supported. However, this algorithm is asymptotically faster than using the `resultant` method.

For instance

```
sage: p1 = minpoly(cos(pi/43))
sage: p2 = minpoly(cos(pi/47))
sage: time r1 = p1.composed_op(p2, operator.add)
CPU times: user 108 ms, sys: 4 ms, total: 112 ms
Wall time: 111 ms
sage: time r2 = p1.composed_op(p2, operator.add, algorithm="resultant")
CPU times: user 47.1 s, sys: 0 ns, total: 47.1 s
Wall time: 47.1 s
sage: r1 == r2
True
sage: r1.is_irreducible()
True
```
In the example above, `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`

Reference:

 [BFSS] A. Bostan, P. Flajolet, B. Salvy and E. Schost, "Fast Computation of special resultants", Journal of Symbolic Computation 41 (2006), 1-29

Branch: **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)**

Reviewer: **Vincent Delecroix, Marc Mezzarobba**

Author: **Mario Pernici, Vincent Delecroix**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/18356_





---

archive/issue_events_258529.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-03T17:41:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258529"
}
```



---

archive/issue_events_258530.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-03T17:41:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258530"
}
```



---

archive/issue_events_258531.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-03T17:41:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258531"
}
```



---

archive/issue_events_258532.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-03T17:41:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258532"
}
```



---

archive/issue_comments_252360.json:
```json
{
    "body": "Branch: **[u/pernici/ticket/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/18356)**",
    "created_at": "2015-05-03T17:42:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252360",
    "user": "https://github.com/sagetrac-pernici"
}
```

Branch: **[u/pernici/ticket/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/18356)**



---

archive/issue_comments_252361.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nHere is a benchmark\n\n```\ndef bench(p, op, n):\n    print 'p=', p\n    for n in range(1, n):\n        q = p^n\n        p1 = q*(q + 1)\n        p2 = (q + 2)*(q + 3)\n        f = getattr(p1, 'composed_sum') if op == '+' else getattr(p1, 'composed_product')\n        t0 = time(); r1 = f(p2, \"resultant\",op)\n        t1 = time(); r2 = f(p2, \"BFSS\", op)\n        t2 = time()\n        assert r1.monic() == r2\n        print 'op = %s n=%d resultant:%.4f BFSS:%.4f' %(op, n,t1-t0,t2-t1)\n\n```\nHere are some results; in the case of sparse polynomials the resultant performs\nbetter than in the case of dense polynomials\n\n```\np= x^4\nop = + n=1 resultant:0.0020 BFSS:0.0141\nop = + n=2 resultant:0.0146 BFSS:0.0350\nop = + n=3 resultant:0.0790 BFSS:0.1117\nop = + n=4 resultant:0.2977 BFSS:0.2673\nop = + n=5 resultant:0.9597 BFSS:0.5701\nop = + n=6 resultant:2.7090 BFSS:1.1049\nop = + n=7 resultant:7.3010 BFSS:2.0877\n\np= x^4 + 7*x^3 + 3*x^2 + 9*x + 11\nop = + n=1 resultant:0.0171 BFSS:0.0170\nop = + n=2 resultant:1.0814 BFSS:0.0852\nop = + n=3 resultant:22.6607 BFSS:0.3979\n```",
    "created_at": "2015-05-03T18:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252361",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:2" align="right">comment:2</div>

Here is a benchmark

```
def bench(p, op, n):
    print 'p=', p
    for n in range(1, n):
        q = p^n
        p1 = q*(q + 1)
        p2 = (q + 2)*(q + 3)
        f = getattr(p1, 'composed_sum') if op == '+' else getattr(p1, 'composed_product')
        t0 = time(); r1 = f(p2, "resultant",op)
        t1 = time(); r2 = f(p2, "BFSS", op)
        t2 = time()
        assert r1.monic() == r2
        print 'op = %s n=%d resultant:%.4f BFSS:%.4f' %(op, n,t1-t0,t2-t1)

```
Here are some results; in the case of sparse polynomials the resultant performs
better than in the case of dense polynomials

```
p= x^4
op = + n=1 resultant:0.0020 BFSS:0.0141
op = + n=2 resultant:0.0146 BFSS:0.0350
op = + n=3 resultant:0.0790 BFSS:0.1117
op = + n=4 resultant:0.2977 BFSS:0.2673
op = + n=5 resultant:0.9597 BFSS:0.5701
op = + n=6 resultant:2.7090 BFSS:1.1049
op = + n=7 resultant:7.3010 BFSS:2.0877

p= x^4 + 7*x^3 + 3*x^2 + 9*x + 11
op = + n=1 resultant:0.0171 BFSS:0.0170
op = + n=2 resultant:1.0814 BFSS:0.0852
op = + n=3 resultant:22.6607 BFSS:0.3979
```



---

archive/issue_comments_252362.json:
```json
{
    "body": "Commit: **[`3806e84`](https://github.com/sagemath/sagetrac-mirror/commit/3806e8403764abf4d391161f836f0ec422201cc5)**",
    "created_at": "2015-05-03T18:04:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252362",
    "user": "https://github.com/sagetrac-pernici"
}
```

Commit: **[`3806e84`](https://github.com/sagemath/sagetrac-mirror/commit/3806e8403764abf4d391161f836f0ec422201cc5)**



---

archive/issue_events_258533.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-03T18:05:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258533"
}
```



---

archive/issue_comments_252363.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nHi,\n\nIf you look at the branch field in the ticket description you will see that it is red. It means that there is a merge conflict with the last beta. What you have to do is not to start from the stable release but from the development release (the name of the branch on the server is \"develop\"). Do you know how to do that?\n\nVincent",
    "created_at": "2015-05-03T18:55:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252363",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">comment:4</div>

Hi,

If you look at the branch field in the ticket description you will see that it is red. It means that there is a merge conflict with the last beta. What you have to do is not to start from the stable release but from the development release (the name of the branch on the server is "develop"). Do you know how to do that?

Vincent



---

archive/issue_events_258534.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-03T18:55:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258534"
}
```



---

archive/issue_events_258535.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-03T18:55:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258535"
}
```



---

archive/issue_comments_252364.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI had a look at the branch, just some comment\n\n1. It is better to use `Return XYZ` rather than `Compute XYZ` in the one line description of functions. What the function is internally doing is mostly a technical question. What you want to know when reading the documentation is what does the function return.\n\n2. This is old cython\n\n```\ncdef int i\nfor i from 0 <= i <= n:\n    ...\n```\n  you can just write\n\n```\ncdef int i\nfor i in range(n):\n    ...\n```\n  this will be transformed into a C loop by Cython.\n \n3. In `hadamard_product` I would defined precisely what is the pointwise product. If you have a naive look to wikipedia, the pointwise product of two functions `f` and `g` is just `x -> f(x)g(x)`.\n\nVincent",
    "created_at": "2015-05-03T19:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252364",
    "user": "https://github.com/videlec"
}
```

<div id="comment:5" align="right">comment:5</div>

I had a look at the branch, just some comment

1. It is better to use `Return XYZ` rather than `Compute XYZ` in the one line description of functions. What the function is internally doing is mostly a technical question. What you want to know when reading the documentation is what does the function return.

2. This is old cython

```
cdef int i
for i from 0 <= i <= n:
    ...
```
  you can just write

```
cdef int i
for i in range(n):
    ...
```
  this will be transformed into a C loop by Cython.
 
3. In `hadamard_product` I would defined precisely what is the pointwise product. If you have a naive look to wikipedia, the pointwise product of two functions `f` and `g` is just `x -> f(x)g(x)`.

Vincent



---

archive/issue_comments_252365.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nHi Vincent,\n  I opened  #18373 based on the development branch, replacing this ticket.\n  I followed your suggestions here and in #18242 :\n\n    In `newton_sum` the ring `R` is added as an argument\n\n    Avoided using fraction fields (apart from ``R(QQ(1)/p1)`` there was also a division by `x`).\n\n    Eliminated duplicate code, merging `composed_add` and `composed_product`.\n\n    I did some benchmark; there is a strong dependence on the sparseness of the polynomials.\n    The resultant algorithm is faster with some polynomials with few coefficients and high degree.\n    By default `composed_op` selects which algorithm to use, based on the degree and the number\n    of nonvanishing coefficients.\n    The dependence on the size of the coefficients does not seem to make much difference.\n\n    I eliminated `hadamard_product`.",
    "created_at": "2015-05-06T17:23:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252365",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:6" align="right">comment:6</div>

Hi Vincent,
  I opened  #18373 based on the development branch, replacing this ticket.
  I followed your suggestions here and in #18242 :

    In `newton_sum` the ring `R` is added as an argument

    Avoided using fraction fields (apart from ``R(QQ(1)/p1)`` there was also a division by `x`).

    Eliminated duplicate code, merging `composed_add` and `composed_product`.

    I did some benchmark; there is a strong dependence on the sparseness of the polynomials.
    The resultant algorithm is faster with some polynomials with few coefficients and high degree.
    By default `composed_op` selects which algorithm to use, based on the degree and the number
    of nonvanishing coefficients.
    The dependence on the size of the coefficients does not seem to make much difference.

    I eliminated `hadamard_product`.



---

archive/issue_comments_252366.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHello,\n\nYou should **not** open a new ticket each time you create a branch. Now we have three duplicated tickets!! Delete #18373 (i.e. remove the branch field and set the milestone to `sage-duplicate/invalid/won't fix`) and simply modify the branch of this ticket.\n\nVincent",
    "created_at": "2015-05-07T08:28:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252366",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">comment:7</div>

Hello,

You should **not** open a new ticket each time you create a branch. Now we have three duplicated tickets!! Delete #18373 (i.e. remove the branch field and set the milestone to `sage-duplicate/invalid/won't fix`) and simply modify the branch of this ticket.

Vincent



---

archive/issue_comments_252367.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nSorry for this mess.\n\nFor this ticket I worked with the stable release. Then I downloaded the development release,\nmade a branch there, and tried to modify this ticket with\n`./sage -dev push --ticket 18356` but I got an error message\n\n```\nNot pushing your changes because they would discard some of the commits on the\nremote branch \"u/pernici/ticket/18356\".\n```\nand did not know how to proceed, so I opened #18373 .\nCan I delete this ticked and keep #18373 ?",
    "created_at": "2015-05-07T09:51:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252367",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:8" align="right">comment:8</div>

Sorry for this mess.

For this ticket I worked with the stable release. Then I downloaded the development release,
made a branch there, and tried to modify this ticket with
`./sage -dev push --ticket 18356` but I got an error message

```
Not pushing your changes because they would discard some of the commits on the
remote branch "u/pernici/ticket/18356".
```
and did not know how to proceed, so I opened #18373 .
Can I delete this ticked and keep #18373 ?



---

archive/issue_comments_252368.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@sagetrac-pernici](#comment:8):\n> For this ticket I worked with the stable release. Then I downloaded the development release,\n> made a branch there, and tried to modify this ticket with\n> `./sage -dev push --ticket 18356` but I got an error message\n> \n> ```\n> Not pushing your changes because they would discard some of the commits on the\n> remote branch \"u/pernici/ticket/18356\".\n> ```\n> and did not know how to proceed, so I opened #18373 .\n\nYou should have asked.\n\n> Can I delete this ticked and keep #18373 ?\n\nIf you want me to review it, no. There are comments here that are precious for the history. Moreover, if you do not know how to properly pull and push with git, choosing your solution will not help you.\n\nYou should first stop using the sage dev scripts which are deprecated since at least two version of sage. Then you can read the [manual](http://sagemath.org/doc/developer/) and start either using the `git trac` command or using `git` by itself. Everything is explained in details.\n\nVincent",
    "created_at": "2015-05-07T10:03:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252368",
    "user": "https://github.com/videlec"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@sagetrac-pernici](#comment:8):
> For this ticket I worked with the stable release. Then I downloaded the development release,
> made a branch there, and tried to modify this ticket with
> `./sage -dev push --ticket 18356` but I got an error message
> 
> ```
> Not pushing your changes because they would discard some of the commits on the
> remote branch "u/pernici/ticket/18356".
> ```
> and did not know how to proceed, so I opened #18373 .

You should have asked.

> Can I delete this ticked and keep #18373 ?

If you want me to review it, no. There are comments here that are precious for the history. Moreover, if you do not know how to properly pull and push with git, choosing your solution will not help you.

You should first stop using the sage dev scripts which are deprecated since at least two version of sage. Then you can read the [manual](http://sagemath.org/doc/developer/) and start either using the `git trac` command or using `git` by itself. Everything is explained in details.

Vincent



---

archive/issue_comments_252369.json:
```json
{
    "body": "Changed commit from **[`3806e84`](https://github.com/sagemath/sagetrac-mirror/commit/3806e8403764abf4d391161f836f0ec422201cc5)** to **[`1898678`](https://github.com/sagemath/sagetrac-mirror/commit/1898678cfccd18df76b57a015c03d96fb44542ae)**",
    "created_at": "2015-05-08T09:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252369",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3806e84`](https://github.com/sagemath/sagetrac-mirror/commit/3806e8403764abf4d391161f836f0ec422201cc5)** to **[`1898678`](https://github.com/sagemath/sagetrac-mirror/commit/1898678cfccd18df76b57a015c03d96fb44542ae)**



---

archive/issue_comments_252370.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/428c46cb691e0caad792822906386e5178a84afe\"><code>428c46c</code></a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into mp1a</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1898678cfccd18df76b57a015c03d96fb44542ae\"><code>1898678</code></a></td><td><code>Added `composed_op` replacing `composed_sum` and `composed_product`.</code></td></tr></table>\n",
    "created_at": "2015-05-08T09:54:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252370",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/428c46cb691e0caad792822906386e5178a84afe"><code>428c46c</code></a></td><td><code>Merge branch 'develop' of git://trac.sagemath.org/sage into mp1a</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1898678cfccd18df76b57a015c03d96fb44542ae"><code>1898678</code></a></td><td><code>Added `composed_op` replacing `composed_sum` and `composed_product`.</code></td></tr></table>




---

archive/issue_comments_252371.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,23 @@\n-Added ``composed_sum`` and ``composed_product``, implementing\n+Added `composed_op` to compute the composed sum and the composed product, implementing\n the algorithm in A. Bostan, P. Flajolet, B. Salvy and E. Schost,\n \"Fast Computation of special resultants\",\n Journal of Symbolic Computation 41 (2006), 1-29\n in the case of polynomials on integer or rational ring.\n-This algorithm is asymptotically faster than using the ``resultant``\n-method.\n+This algorithm is asymptotically faster than using the `resultant` method.\n+\n+For instance\n+\n+```\n+sage: p1 = minpoly(cos(pi/43))\n+sage: p2 = minpoly(cos(pi/47))\n+sage: time r1 = p1.composed_op(p2, '+')\n+Wall time: 105 ms\n+sage: time r2 = p1.composed_op(p2, '+', algorithm=\"resultant\")\n+Wall time: 53.4 s\n+sage: r1 == r2.monic()\n+sage: r1.is_irreducible()\n+True\n+```\n+\n+so `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`\n+\n``````\n",
    "created_at": "2015-05-08T10:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252371",
    "user": "https://github.com/sagetrac-pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,23 @@
-Added ``composed_sum`` and ``composed_product``, implementing
+Added `composed_op` to compute the composed sum and the composed product, implementing
 the algorithm in A. Bostan, P. Flajolet, B. Salvy and E. Schost,
 "Fast Computation of special resultants",
 Journal of Symbolic Computation 41 (2006), 1-29
 in the case of polynomials on integer or rational ring.
-This algorithm is asymptotically faster than using the ``resultant``
-method.
+This algorithm is asymptotically faster than using the `resultant` method.
+
+For instance
+
+```
+sage: p1 = minpoly(cos(pi/43))
+sage: p2 = minpoly(cos(pi/47))
+sage: time r1 = p1.composed_op(p2, '+')
+Wall time: 105 ms
+sage: time r2 = p1.composed_op(p2, '+', algorithm="resultant")
+Wall time: 53.4 s
+sage: r1 == r2.monic()
+sage: r1.is_irreducible()
+True
+```
+
+so `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`
+
``````




---

archive/issue_events_258536.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-08T10:29:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258536"
}
```



---

archive/issue_events_258537.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-08T10:29:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258537"
}
```



---

archive/issue_comments_252372.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHello,\n\nThanks for using this ticket.\n\n4. In the description of the function you wrote a very precise definition. But then, in the `NOTE`, you claim that the two algorithms might behave differently...\n\n5. Why do you only check the parent for `p1`?\n\n```\nif p1.parent().base_ring() not in (ZZ, QQ):\n    raise ValueError('implemented only for polynomials on\n                       integer or rational ring')\n```\n  Moreover, why is it only in the case of `BFSS`?\n\n6. What is this argument `_cached_QQ`!? You can certainly not use that. Note that in `sage.rings.qqbar` there is already `QQxy`, `QQxy_x` and `QQxy_y` defined. So either it is time critical in which case you could create a function like\n\n```\n_QQxy = None\ndef QQxy_with_gens():\n    global _QQxy\n    if _QQxy is None:\n        from sage.rings.rational_field import QQ\n        R = QQ['x', 'y']\n        _QQxy = (R, R.gen(0), R.gen(1))\n    return _QQxy\n```\n  and move it near the `PolynomialRing` function. Then this function should be also used in `sage.ring.qqbar`. You can also try to see why calling `PolynomialRing` is so slow.\n\n7. It would be more natural to me if `op` would be an operator and not a string. In other words, one of\n\n```\nsage: import operator\nsage: operator.add\n<built-in function add>\nsage: operator.sub\n<built-in function sub>\nsage: operator.mul\n<built-in function mul>\nsage: operator.div\n<built-in function div>\n```\n  It can be checked in the method with\n\n```\nif op is operator.add:\n    ...\nelif op is operator.sub:\n    ...\n```\n  It is a very personal feeling, what do you think?\n\n8. This takes time\n\n```\nfrom sage.rings.power_series_ring import PowerSeriesRing\nfrom sage.rings.big_oh import O as big_O\n```\n  so you would better move it where it is used, i.e. in the case where `algorithm=BFSS`. Similarly, in `newton_sum` you should move `from sage.rings.power_series_ring import PowerSeriesRing`\n\n9. You can use the fact that bool is a subtype of int when you decide the algorithm\n\n```\nsage: sum(bool(i) for i in [0,1,3,0,2,0,4])\n4\n```\n\n9. In `newton_sum` the argument `prec` and `R` are redundant. But I do not know how to do better.",
    "created_at": "2015-05-08T10:53:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252372",
    "user": "https://github.com/videlec"
}
```

<div id="comment:13" align="right">comment:13</div>

Hello,

Thanks for using this ticket.

4. In the description of the function you wrote a very precise definition. But then, in the `NOTE`, you claim that the two algorithms might behave differently...

5. Why do you only check the parent for `p1`?

```
if p1.parent().base_ring() not in (ZZ, QQ):
    raise ValueError('implemented only for polynomials on
                       integer or rational ring')
```
  Moreover, why is it only in the case of `BFSS`?

6. What is this argument `_cached_QQ`!? You can certainly not use that. Note that in `sage.rings.qqbar` there is already `QQxy`, `QQxy_x` and `QQxy_y` defined. So either it is time critical in which case you could create a function like

```
_QQxy = None
def QQxy_with_gens():
    global _QQxy
    if _QQxy is None:
        from sage.rings.rational_field import QQ
        R = QQ['x', 'y']
        _QQxy = (R, R.gen(0), R.gen(1))
    return _QQxy
```
  and move it near the `PolynomialRing` function. Then this function should be also used in `sage.ring.qqbar`. You can also try to see why calling `PolynomialRing` is so slow.

7. It would be more natural to me if `op` would be an operator and not a string. In other words, one of

```
sage: import operator
sage: operator.add
<built-in function add>
sage: operator.sub
<built-in function sub>
sage: operator.mul
<built-in function mul>
sage: operator.div
<built-in function div>
```
  It can be checked in the method with

```
if op is operator.add:
    ...
elif op is operator.sub:
    ...
```
  It is a very personal feeling, what do you think?

8. This takes time

```
from sage.rings.power_series_ring import PowerSeriesRing
from sage.rings.big_oh import O as big_O
```
  so you would better move it where it is used, i.e. in the case where `algorithm=BFSS`. Similarly, in `newton_sum` you should move `from sage.rings.power_series_ring import PowerSeriesRing`

9. You can use the fact that bool is a subtype of int when you decide the algorithm

```
sage: sum(bool(i) for i in [0,1,3,0,2,0,4])
4
```

9. In `newton_sum` the argument `prec` and `R` are redundant. But I do not know how to do better.



---

archive/issue_events_258538.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T10:53:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258538"
}
```



---

archive/issue_events_258539.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T10:53:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258539"
}
```



---

archive/issue_comments_252373.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/23f379fe030f522f19b26f2866ec3160739845be\"><code>23f379f</code></a></td><td><code>Added `QQxy_with_gens`; taken the `prec` argument out of `newton_sum`;</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1cb8ac6646694b81151c49f220c98fdbb63258c3\"><code>1cb8ac6</code></a></td><td><code>Eliminated call to big_O</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/aafe62ee7fc61553a9396b8d51e3c6ae36f4ac27\"><code>aafe62e</code></a></td><td><code>Used `operator.add` instead of `+`.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5f888c83095eab89acbd96ee09e067918a60c258\"><code>5f888c8</code></a></td><td><code>Added checks on the input polynomials.</code></td></tr></table>\n",
    "created_at": "2015-05-12T15:54:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252373",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/23f379fe030f522f19b26f2866ec3160739845be"><code>23f379f</code></a></td><td><code>Added `QQxy_with_gens`; taken the `prec` argument out of `newton_sum`;</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1cb8ac6646694b81151c49f220c98fdbb63258c3"><code>1cb8ac6</code></a></td><td><code>Eliminated call to big_O</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/aafe62ee7fc61553a9396b8d51e3c6ae36f4ac27"><code>aafe62e</code></a></td><td><code>Used `operator.add` instead of `+`.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5f888c83095eab89acbd96ee09e067918a60c258"><code>5f888c8</code></a></td><td><code>Added checks on the input polynomials.</code></td></tr></table>




---

archive/issue_comments_252374.json:
```json
{
    "body": "Changed commit from **[`1898678`](https://github.com/sagemath/sagetrac-mirror/commit/1898678cfccd18df76b57a015c03d96fb44542ae)** to **[`5f888c8`](https://github.com/sagemath/sagetrac-mirror/commit/5f888c83095eab89acbd96ee09e067918a60c258)**",
    "created_at": "2015-05-12T15:54:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252374",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1898678`](https://github.com/sagemath/sagetrac-mirror/commit/1898678cfccd18df76b57a015c03d96fb44542ae)** to **[`5f888c8`](https://github.com/sagemath/sagetrac-mirror/commit/5f888c83095eab89acbd96ee09e067918a60c258)**



---

archive/issue_comments_252375.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nHello,\n\nI made changes according to your comments:\n\n4. The description corresponds to the monic form; now by default\n   the result of `composed_op` is in monic form.\n\n5. Added the check that `p1` and `p2` are on the same polynomial ring.\n\n6. Put `QQxy_with_gens` in place of `cached_QQ`.\n\n7. Used `operator.add`, etc. \n\n8. Moved the import statements.\n\n9. Used `bool`.\n\n10. Eliminated the `prec` argument in `newton_sum`.\n\nOther changes:\n\n  previously `composed_op` returned a polynomial in `x` regardless\n  of the variable name of the input polynomials; fixing this gave\n  a speed-up of the \"resultant\" algorithm for small polynomials.\n\n  added some more checks on the input polynomials\n\n  eliminated the call to `integral` in the case of `operator.add`",
    "created_at": "2015-05-12T16:01:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252375",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:15" align="right">comment:15</div>

Hello,

I made changes according to your comments:

4. The description corresponds to the monic form; now by default
   the result of `composed_op` is in monic form.

5. Added the check that `p1` and `p2` are on the same polynomial ring.

6. Put `QQxy_with_gens` in place of `cached_QQ`.

7. Used `operator.add`, etc. 

8. Moved the import statements.

9. Used `bool`.

10. Eliminated the `prec` argument in `newton_sum`.

Other changes:

  previously `composed_op` returned a polynomial in `x` regardless
  of the variable name of the input polynomials; fixing this gave
  a speed-up of the "resultant" algorithm for small polynomials.

  added some more checks on the input polynomials

  eliminated the call to `integral` in the case of `operator.add`



---

archive/issue_comments_252376.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,11 +10,11 @@\n ```\n sage: p1 = minpoly(cos(pi/43))\n sage: p2 = minpoly(cos(pi/47))\n-sage: time r1 = p1.composed_op(p2, '+')\n+sage: time r1 = p1.composed_op(p2, operator.add)\n Wall time: 105 ms\n-sage: time r2 = p1.composed_op(p2, '+', algorithm=\"resultant\")\n+sage: time r2 = p1.composed_op(p2, operator.add, algorithm=\"resultant\")\n Wall time: 53.4 s\n-sage: r1 == r2.monic()\n+sage: r1 == r2\n sage: r1.is_irreducible()\n True\n ```\n``````\n",
    "created_at": "2015-05-12T16:07:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252376",
    "user": "https://github.com/sagetrac-pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,11 +10,11 @@
 ```
 sage: p1 = minpoly(cos(pi/43))
 sage: p2 = minpoly(cos(pi/47))
-sage: time r1 = p1.composed_op(p2, '+')
+sage: time r1 = p1.composed_op(p2, operator.add)
 Wall time: 105 ms
-sage: time r2 = p1.composed_op(p2, '+', algorithm="resultant")
+sage: time r2 = p1.composed_op(p2, operator.add, algorithm="resultant")
 Wall time: 53.4 s
-sage: r1 == r2.monic()
+sage: r1 == r2
 sage: r1.is_irreducible()
 True
 ```
``````




---

archive/issue_comments_252377.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,7 @@\n the algorithm in A. Bostan, P. Flajolet, B. Salvy and E. Schost,\n \"Fast Computation of special resultants\",\n Journal of Symbolic Computation 41 (2006), 1-29\n-in the case of polynomials on integer or rational ring.\n+in the case of polynomials on the rational ring.\n This algorithm is asymptotically faster than using the `resultant` method.\n \n For instance\n``````\n",
    "created_at": "2015-05-12T16:08:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252377",
    "user": "https://github.com/sagetrac-pernici"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,7 @@
 the algorithm in A. Bostan, P. Flajolet, B. Salvy and E. Schost,
 "Fast Computation of special resultants",
 Journal of Symbolic Computation 41 (2006), 1-29
-in the case of polynomials on integer or rational ring.
+in the case of polynomials on the rational ring.
 This algorithm is asymptotically faster than using the `resultant` method.
 
 For instance
``````




---

archive/issue_events_258540.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-12T16:08:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258540"
}
```



---

archive/issue_events_258541.json:
```json
{
    "actor": "https://github.com/sagetrac-pernici",
    "created_at": "2015-05-12T16:08:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258541"
}
```



---

archive/issue_comments_252378.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe algorithm for `newton_sum` is not the one from BFSS. It is the Schoenage formula. Isn't it? There is no inversion in BFSS.\n\nVincent",
    "created_at": "2015-05-14T13:12:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252378",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">comment:18</div>

The algorithm for `newton_sum` is not the one from BFSS. It is the Schoenage formula. Isn't it? There is no inversion in BFSS.

Vincent



---

archive/issue_events_258542.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-14T13:12:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258542"
}
```



---

archive/issue_events_258543.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-14T13:12:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258543"
}
```



---

archive/issue_comments_252379.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThe algorithm for `newton_sum` is slightly changed with respect to the one written in BFSS, Lemma 1.\nI will change it to the latter form, which is simpler and slightly faster.\nIn either case there is no inversion, there is reversion though.\n\nLemma 1 comes from Schoenage, who used it in a numerical context. Should I put the reference to\nSchoenage's paper, or is it sufficient to write \"See [BFSS] and references within.\" ?",
    "created_at": "2015-05-14T18:03:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252379",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:19" align="right">comment:19</div>

The algorithm for `newton_sum` is slightly changed with respect to the one written in BFSS, Lemma 1.
I will change it to the latter form, which is simpler and slightly faster.
In either case there is no inversion, there is reversion though.

Lemma 1 comes from Schoenage, who used it in a numerical context. Should I put the reference to
Schoenage's paper, or is it sufficient to write "See [BFSS] and references within." ?



---

archive/issue_comments_252380.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@sagetrac-pernici](#comment:19):\n> The algorithm for `newton_sum` is slightly changed with respect to the one written in BFSS, Lemma 1.\n> I will change it to the latter form, which is simpler and slightly faster.\n> In either case there is no inversion, there is reversion though.\n\nAs far as I understand Lemma 1 is precisely Schoenage formula (but I did not open the relevant paper). The algorithm of BFSS is Proposition 1. The inversion is only computed up to the degree of the polynomial. Then there are some iterations that depends on `prec`. Am I wrong?\n\n> Lemma 1 comes from Schoenage, who used it in a numerical context. Should I put the reference to\n> Schoenage's paper, or is it sufficient to write \"See [BFSS] and references within.\" ?\n\nI think it would make sense.\n\nAbout the name, what do you think about `newton_series` instead? It would make the result clearer. And please, add the mathematical definition in the function.\n\nVincent",
    "created_at": "2015-05-14T18:12:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252380",
    "user": "https://github.com/videlec"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@sagetrac-pernici](#comment:19):
> The algorithm for `newton_sum` is slightly changed with respect to the one written in BFSS, Lemma 1.
> I will change it to the latter form, which is simpler and slightly faster.
> In either case there is no inversion, there is reversion though.

As far as I understand Lemma 1 is precisely Schoenage formula (but I did not open the relevant paper). The algorithm of BFSS is Proposition 1. The inversion is only computed up to the degree of the polynomial. Then there are some iterations that depends on `prec`. Am I wrong?

> Lemma 1 comes from Schoenage, who used it in a numerical context. Should I put the reference to
> Schoenage's paper, or is it sufficient to write "See [BFSS] and references within." ?

I think it would make sense.

About the name, what do you think about `newton_series` instead? It would make the result clearer. And please, add the mathematical definition in the function.

Vincent



---

archive/issue_comments_252381.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@videlec](#comment:20):\n> Replying to [@sagetrac-pernici](#comment:19):\n> > The algorithm for `newton_sum` is slightly changed with respect to the one written in BFSS, Lemma 1.\n> > I will change it to the latter form, which is simpler and slightly faster.\n> > In either case there is no inversion, there is reversion though.\n\n> As far as I understand Lemma 1 is precisely Schoenage formula (but I did not open the relevant paper). The algorithm of BFSS is Proposition 1. The inversion is only computed up to the degree of the polynomial. Then there are some iterations that depends on `prec`. Am I wrong?\n\nYou are right. I used that formula, not the algorithm following it.\n\n> > Lemma 1 comes from Schoenage, who used it in a numerical context. Should I put the reference to\n> > Schoenage's paper, or is it sufficient to write \"See [BFSS] and references within.\" ?\n\n> \n> I think it would make sense.\n> \n> About the name, what do you think about `newton_series` instead? It would make the result clearer. And please, add the mathematical definition in the function.\n\n \nA problem with calling it `newton_series` is that `newton_sum` returns a polynomial, not a series.",
    "created_at": "2015-05-14T19:20:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252381",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@videlec](#comment:20):
> Replying to [@sagetrac-pernici](#comment:19):
> > The algorithm for `newton_sum` is slightly changed with respect to the one written in BFSS, Lemma 1.
> > I will change it to the latter form, which is simpler and slightly faster.
> > In either case there is no inversion, there is reversion though.

> As far as I understand Lemma 1 is precisely Schoenage formula (but I did not open the relevant paper). The algorithm of BFSS is Proposition 1. The inversion is only computed up to the degree of the polynomial. Then there are some iterations that depends on `prec`. Am I wrong?

You are right. I used that formula, not the algorithm following it.

> > Lemma 1 comes from Schoenage, who used it in a numerical context. Should I put the reference to
> > Schoenage's paper, or is it sufficient to write "See [BFSS] and references within." ?

> 
> I think it would make sense.
> 
> About the name, what do you think about `newton_series` instead? It would make the result clearer. And please, add the mathematical definition in the function.

 
A problem with calling it `newton_series` is that `newton_sum` returns a polynomial, not a series.



---

archive/issue_comments_252382.json:
```json
{
    "body": "Changed commit from **[`5f888c8`](https://github.com/sagemath/sagetrac-mirror/commit/5f888c83095eab89acbd96ee09e067918a60c258)** to **[`1fe9b05`](https://github.com/sagemath/sagetrac-mirror/commit/1fe9b052c8f1e49f9b0480f40dfa1937ef9f8dcf)**",
    "created_at": "2015-05-15T09:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252382",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`5f888c8`](https://github.com/sagemath/sagetrac-mirror/commit/5f888c83095eab89acbd96ee09e067918a60c258)** to **[`1fe9b05`](https://github.com/sagemath/sagetrac-mirror/commit/1fe9b052c8f1e49f9b0480f40dfa1937ef9f8dcf)**



---

archive/issue_comments_252383.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fe9b052c8f1e49f9b0480f40dfa1937ef9f8dcf\"><code>1fe9b05</code></a></td><td><code>eliminated `newton_sum`</code></td></tr></table>\n",
    "created_at": "2015-05-15T09:18:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252383",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fe9b052c8f1e49f9b0480f40dfa1937ef9f8dcf"><code>1fe9b05</code></a></td><td><code>eliminated `newton_sum`</code></td></tr></table>




---

archive/issue_comments_252384.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nI eliminated `newton_sum`, since it can be inlined, and it is not yet clear to me which arguments\n`newton_sum` should have (`prec` or `R`), nor what it should return (a polynomial or a series).\n\nImplementing `composed_op` using `flint` would be faster. For instance in sage it is not\nimplemented `mullow`, present in `flint` `nmod_poly`, so that one has to compute the product of the\npolynomials and then truncate.",
    "created_at": "2015-05-15T09:40:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252384",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:23" align="right">comment:23</div>

I eliminated `newton_sum`, since it can be inlined, and it is not yet clear to me which arguments
`newton_sum` should have (`prec` or `R`), nor what it should return (a polynomial or a series).

Implementing `composed_op` using `flint` would be faster. For instance in sage it is not
implemented `mullow`, present in `flint` `nmod_poly`, so that one has to compute the product of the
polynomials and then truncate.



---

archive/issue_comments_252385.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@sagetrac-pernici](#comment:23):\n> I eliminated `newton_sum`, since it can be inlined, and it is not yet clear to me which arguments\n> `newton_sum` should have (`prec` or `R`), nor what it should return (a polynomial or a series).\n\nindeed\n\n> Implementing `composed_op` using `flint` would be faster. For instance in sage it is not\n> implemented `mullow`, present in `flint` `nmod_poly`, so that one has to compute the product of the\n> polynomials and then truncate.\n\nsee #18420 (needs review)",
    "created_at": "2015-05-15T09:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252385",
    "user": "https://github.com/videlec"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@sagetrac-pernici](#comment:23):
> I eliminated `newton_sum`, since it can be inlined, and it is not yet clear to me which arguments
> `newton_sum` should have (`prec` or `R`), nor what it should return (a polynomial or a series).

indeed

> Implementing `composed_op` using `flint` would be faster. For instance in sage it is not
> implemented `mullow`, present in `flint` `nmod_poly`, so that one has to compute the product of the
> polynomials and then truncate.

see #18420 (needs review)



---

archive/issue_comments_252386.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI will try to implement `composed_op` in `polynomial_rational_flint.pyx`; for the moment I have an\nimplementation of `composed_mul`; for small polynomials (degree 2) it is a few times faster than the resultant algorithm, 20x faster than the previous implementation of the BFSS algorithm. \n\nTherefore the resultant algorithm will be taken away. \n\nFor large polynomials the implementation in `polynomial_rational_flint.pyx`\nis currently slow; the reason is that there is no `hadamard_product` for polynomials in Flint,\nand my implementation is very slow. I have to study something of Flint to do better.\nOnce I fix this I expect that the two implementations of BFSS will be equally fast for large polynomials.",
    "created_at": "2015-05-18T12:08:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252386",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:25" align="right">comment:25</div>

I will try to implement `composed_op` in `polynomial_rational_flint.pyx`; for the moment I have an
implementation of `composed_mul`; for small polynomials (degree 2) it is a few times faster than the resultant algorithm, 20x faster than the previous implementation of the BFSS algorithm. 

Therefore the resultant algorithm will be taken away. 

For large polynomials the implementation in `polynomial_rational_flint.pyx`
is currently slow; the reason is that there is no `hadamard_product` for polynomials in Flint,
and my implementation is very slow. I have to study something of Flint to do better.
Once I fix this I expect that the two implementations of BFSS will be equally fast for large polynomials.



---

archive/issue_comments_252387.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@sagetrac-pernici](#comment:25):\n> I will try to implement `composed_op` in `polynomial_rational_flint.pyx`; for the moment I have an\n> implementation of `composed_mul`; for small polynomials (degree 2) it is a few times faster than the resultant algorithm, 20x faster than the previous implementation of the BFSS algorithm. \n\nDid you have a look at #18420 that I already mentioned in [comment:23](#comment:23)?! There is no need to implement your methods in `polynomial_rational_flint.pyx`. Just use `_mul_trunc_` that is implemented in #18420.\n\nVincent",
    "created_at": "2015-05-18T12:13:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252387",
    "user": "https://github.com/videlec"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@sagetrac-pernici](#comment:25):
> I will try to implement `composed_op` in `polynomial_rational_flint.pyx`; for the moment I have an
> implementation of `composed_mul`; for small polynomials (degree 2) it is a few times faster than the resultant algorithm, 20x faster than the previous implementation of the BFSS algorithm. 

Did you have a look at #18420 that I already mentioned in [comment:23](#comment:23)?! There is no need to implement your methods in `polynomial_rational_flint.pyx`. Just use `_mul_trunc_` that is implemented in #18420.

Vincent



---

archive/issue_comments_252388.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI tried some benchmark with some small polynomials in #18420; \nI find that `p1._mul_trunc_(p2, prec)`\nis slightly faster than `(p1*p2).truncate(prec)`, with polynomials of degree `prec-1`.\n\nI will look further at #18420, but it is not the way to speed up `composed_op`,\nas the following benchmark shows.\n\n```\ndef test2():\n    K.<x> = QQ[]\n    p1 = x^2 - 2\n    p2 = x^2 - 3\n    t0 = time()\n    r = p1.composed_op(p2, operator.mul, algorithm='BFSS')\n    #r = p1.composed_mul(p2)\n    t1 = time()\n    print 'r=', r\n    print '%.6f' %(t1 - t0)\n```\n\nHere are the results for the best out of 10 runs:\n\ncomposed_op 'BFSS':\nup to PowerSeriesRing(...) included: 0.000524 \nnewton_sums: 0.001369 \nhadamard prod: 0.000030 \nintegral: 0.000073 \nexp: 0.001195 \nreverse: 0.000002\ntotal: 0.003264\n\nOnly the newton sums could use `_mul_trunc_`, although it is not clear to me how\nto do it best; anyway it would make it only slightly faster. But even if the newton sums\ntook zero time, this algorithm would be slower than the resultant algorithm and much\nslower than `composed_mul`\n\n`composed_op` 'resultant': 0.000584\n\n`composed_mul`: 0.000026",
    "created_at": "2015-05-18T16:18:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252388",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:27" align="right">comment:27</div>

I tried some benchmark with some small polynomials in #18420; 
I find that `p1._mul_trunc_(p2, prec)`
is slightly faster than `(p1*p2).truncate(prec)`, with polynomials of degree `prec-1`.

I will look further at #18420, but it is not the way to speed up `composed_op`,
as the following benchmark shows.

```
def test2():
    K.<x> = QQ[]
    p1 = x^2 - 2
    p2 = x^2 - 3
    t0 = time()
    r = p1.composed_op(p2, operator.mul, algorithm='BFSS')
    #r = p1.composed_mul(p2)
    t1 = time()
    print 'r=', r
    print '%.6f' %(t1 - t0)
```

Here are the results for the best out of 10 runs:

composed_op 'BFSS':
up to PowerSeriesRing(...) included: 0.000524 
newton_sums: 0.001369 
hadamard prod: 0.000030 
integral: 0.000073 
exp: 0.001195 
reverse: 0.000002
total: 0.003264

Only the newton sums could use `_mul_trunc_`, although it is not clear to me how
to do it best; anyway it would make it only slightly faster. But even if the newton sums
took zero time, this algorithm would be slower than the resultant algorithm and much
slower than `composed_mul`

`composed_op` 'resultant': 0.000584

`composed_mul`: 0.000026



---

archive/issue_comments_252389.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nHi,\n\nDid you completely avoid the power series ring? We should provide more methods to polynomial like:\n- `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial\nAs FLINT has some native implementation, we should use it where it makes sense. But this should be done in another ticket.\n\nIn all your code, you know in advance the precision needed. Right?\n\nVincent",
    "created_at": "2015-05-18T19:52:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252389",
    "user": "https://github.com/videlec"
}
```

<div id="comment:28" align="right">comment:28</div>

Hi,

Did you completely avoid the power series ring? We should provide more methods to polynomial like:
- `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial
As FLINT has some native implementation, we should use it where it makes sense. But this should be done in another ticket.

In all your code, you know in advance the precision needed. Right?

Vincent



---

archive/issue_comments_252390.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@videlec](#comment:28):\n> Hi,\n> \n> Did you completely avoid the power series ring? We should provide more methods to polynomial like:\n> - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial\n\nYes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.\n\n> As FLINT has some native implementation, we should use it where it makes sense. But this should be done in another ticket.\n> \n> In all your code, you know in advance the precision needed. Right?\n> \n\nYes.",
    "created_at": "2015-05-18T21:58:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252390",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@videlec](#comment:28):
> Hi,
> 
> Did you completely avoid the power series ring? We should provide more methods to polynomial like:
> - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial

Yes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.

> As FLINT has some native implementation, we should use it where it makes sense. But this should be done in another ticket.
> 
> In all your code, you know in advance the precision needed. Right?
> 

Yes.



---

archive/issue_comments_252391.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@sagetrac-pernici](#comment:29):\n> Replying to [@videlec](#comment:28):\n> > Hi,\n> > \n> > Did you completely avoid the power series ring? We should provide more methods to polynomial like:\n> > - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial\n\n> \n> Yes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.\n\nI think this is bad. This will make your code specific over Q. You might consider implementing (in an other ticket) an `inverse_series` and an `exp_series` method on polynoms that handle the option of returning a polynom. This method would have a default implementation in `polynomial_element.pyx` and specialized one for the FLINT classes.",
    "created_at": "2015-05-19T06:46:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252391",
    "user": "https://github.com/videlec"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@sagetrac-pernici](#comment:29):
> Replying to [@videlec](#comment:28):
> > Hi,
> > 
> > Did you completely avoid the power series ring? We should provide more methods to polynomial like:
> > - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial

> 
> Yes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.

I think this is bad. This will make your code specific over Q. You might consider implementing (in an other ticket) an `inverse_series` and an `exp_series` method on polynoms that handle the option of returning a polynom. This method would have a default implementation in `polynomial_element.pyx` and specialized one for the FLINT classes.



---

archive/issue_comments_252392.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@videlec](#comment:30):\n> Replying to [@sagetrac-pernici](#comment:29):\n> > Replying to [@videlec](#comment:28):\n> > > Hi,\n> > > \n> > > Did you completely avoid the power series ring? We should provide more methods to polynomial like:\n> > > - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial\n\n> > \n> > Yes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.\n\n> \n> I think this is bad. This will make your code specific over Q. You might consider implementing (in an other ticket) an `inverse_series` and an `exp_series` method on polynoms that handle the option of returning a polynom. This method would have a default implementation in `polynomial_element.pyx` and specialized one for the FLINT classes.\n\nI have rewritten `composed_op` using `inverse_series`, `exp_series`, methods in `polynomial_element.pyx`\n(without default implementation yet), using `_mul_trunc_` in #18420 as a template.\nIt is faster than the \"resultant\" algorithm in all the cases tested.\n\nI think that `inverse_series`, `exp_series`, etc. in `polynomial_element.pyx`\nshould always return a polynomial.\n\nI could open a ticket on implementing these methods, depending on #18420.\nDo you think that it is ok?",
    "created_at": "2015-05-19T11:17:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252392",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@videlec](#comment:30):
> Replying to [@sagetrac-pernici](#comment:29):
> > Replying to [@videlec](#comment:28):
> > > Hi,
> > > 
> > > Did you completely avoid the power series ring? We should provide more methods to polynomial like:
> > > - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial

> > 
> > Yes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.

> 
> I think this is bad. This will make your code specific over Q. You might consider implementing (in an other ticket) an `inverse_series` and an `exp_series` method on polynoms that handle the option of returning a polynom. This method would have a default implementation in `polynomial_element.pyx` and specialized one for the FLINT classes.

I have rewritten `composed_op` using `inverse_series`, `exp_series`, methods in `polynomial_element.pyx`
(without default implementation yet), using `_mul_trunc_` in #18420 as a template.
It is faster than the "resultant" algorithm in all the cases tested.

I think that `inverse_series`, `exp_series`, etc. in `polynomial_element.pyx`
should always return a polynomial.

I could open a ticket on implementing these methods, depending on #18420.
Do you think that it is ok?



---

archive/issue_comments_252393.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@sagetrac-pernici](#comment:31):\n> Replying to [@videlec](#comment:30):\n> > Replying to [@sagetrac-pernici](#comment:29):\n> > > Replying to [@videlec](#comment:28):\n> > > > Hi,\n> > > > \n> > > > Did you completely avoid the power series ring? We should provide more methods to polynomial like:\n> > > > - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial\n\n> > > \n> > > Yes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.\n\n> > \n> > I think this is bad. This will make your code specific over Q. You might consider implementing (in an other ticket) an `inverse_series` and an `exp_series` method on polynoms that handle the option of returning a polynom. This method would have a default implementation in `polynomial_element.pyx` and specialized one for the FLINT classes.\n\n> \n> I have rewritten `composed_op` using `inverse_series`, `exp_series`, methods in `polynomial_element.pyx`\n> (without default implementation yet), using `_mul_trunc_` in #18420 as a template.\n> It is faster than the \"resultant\" algorithm in all the cases tested.\n> \n> I think that `inverse_series`, `exp_series`, etc. in `polynomial_element.pyx`\n> should always return a polynomial.\n\nFor a programmer this is clear. But not a user. If you ask `inverse_series` you expect a series... but I do not have a strong opinion. A possible alternative is to write:\n\n- one global `def inverse_series(self, prec, as_polynomial=False)` in `polynomial_element.pyx`\n  that would use\n- several `cpdef Polynomial _inverse_series(self, long prec)` that return polynomials.\n\n> I could open a ticket on implementing these methods, depending on #18420.\n> Do you think that it is ok?\n\nI think it would be good. Power series are by far too slow to be usable. Please put me in cc.\n\nVincent",
    "created_at": "2015-05-19T13:39:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252393",
    "user": "https://github.com/videlec"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@sagetrac-pernici](#comment:31):
> Replying to [@videlec](#comment:30):
> > Replying to [@sagetrac-pernici](#comment:29):
> > > Replying to [@videlec](#comment:28):
> > > > Hi,
> > > > 
> > > > Did you completely avoid the power series ring? We should provide more methods to polynomial like:
> > > > - `inverse_series(self, prec, as_polynomial=False)`: return the inverse series and if `as_polynomial` is true returns it as a polynomial

> > > 
> > > Yes, I used `fmpq_poly_inv_series`, `fmpq_poly_exp_series`, so the power series ring is not used.

> > 
> > I think this is bad. This will make your code specific over Q. You might consider implementing (in an other ticket) an `inverse_series` and an `exp_series` method on polynoms that handle the option of returning a polynom. This method would have a default implementation in `polynomial_element.pyx` and specialized one for the FLINT classes.

> 
> I have rewritten `composed_op` using `inverse_series`, `exp_series`, methods in `polynomial_element.pyx`
> (without default implementation yet), using `_mul_trunc_` in #18420 as a template.
> It is faster than the "resultant" algorithm in all the cases tested.
> 
> I think that `inverse_series`, `exp_series`, etc. in `polynomial_element.pyx`
> should always return a polynomial.

For a programmer this is clear. But not a user. If you ask `inverse_series` you expect a series... but I do not have a strong opinion. A possible alternative is to write:

- one global `def inverse_series(self, prec, as_polynomial=False)` in `polynomial_element.pyx`
  that would use
- several `cpdef Polynomial _inverse_series(self, long prec)` that return polynomials.

> I could open a ticket on implementing these methods, depending on #18420.
> Do you think that it is ok?

I think it would be good. Power series are by far too slow to be usable. Please put me in cc.

Vincent



---

archive/issue_comments_252394.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dcb3748ffdc3748b6968cf91c188f8ab266ab626\"><code>dcb3748</code></a></td><td><code>Eliminated `QQxy_with_gens`; added some doctests.</code></td></tr></table>\n",
    "created_at": "2015-05-23T10:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252394",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dcb3748ffdc3748b6968cf91c188f8ab266ab626"><code>dcb3748</code></a></td><td><code>Eliminated `QQxy_with_gens`; added some doctests.</code></td></tr></table>




---

archive/issue_comments_252395.json:
```json
{
    "body": "Changed commit from **[`1fe9b05`](https://github.com/sagemath/sagetrac-mirror/commit/1fe9b052c8f1e49f9b0480f40dfa1937ef9f8dcf)** to **[`dcb3748`](https://github.com/sagemath/sagetrac-mirror/commit/dcb3748ffdc3748b6968cf91c188f8ab266ab626)**",
    "created_at": "2015-05-23T10:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252395",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1fe9b05`](https://github.com/sagemath/sagetrac-mirror/commit/1fe9b052c8f1e49f9b0480f40dfa1937ef9f8dcf)** to **[`dcb3748`](https://github.com/sagemath/sagetrac-mirror/commit/dcb3748ffdc3748b6968cf91c188f8ab266ab626)**



---

archive/issue_comments_252396.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nEliminated `QQxy_with_gens`, used to optimize the \"resultant\" algorithm, since the latter will\nnot be used anyway after introducing `inverse_series`, `exp_series` in the \"BFSS\" algorithm.",
    "created_at": "2015-05-23T10:35:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252396",
    "user": "https://github.com/sagetrac-pernici"
}
```

<div id="comment:34" align="right">comment:34</div>

Eliminated `QQxy_with_gens`, used to optimize the "resultant" algorithm, since the latter will
not be used anyway after introducing `inverse_series`, `exp_series` in the "BFSS" algorithm.



---

archive/issue_comments_252397.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nSee #19005 and #19006 for respectively `inverse_series` and `exp_series`.",
    "created_at": "2015-08-09T17:06:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252397",
    "user": "https://github.com/videlec"
}
```

<div id="comment:35" align="right">comment:35</div>

See #19005 and #19006 for respectively `inverse_series` and `exp_series`.



---

archive/issue_events_258544.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T19:13:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258544"
}
```



---

archive/issue_events_258545.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T19:13:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258545"
}
```



---

archive/issue_comments_252398.json:
```json
{
    "body": "<div id=\"comment:36\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51a383569dd40e300aef748a847ae3ddeb101885\"><code>51a3835</code></a></td><td><code>Trac 18356: composed_sum and composed_product for polynomials</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8c609a8a1c7cfbc34fe08984d2df82c862b006eb\"><code>8c609a8</code></a></td><td><code>Added `composed_op` replacing `composed_sum` and `composed_product`.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/830d9a751b2fb4378ea841abfccfb273bfdffcb4\"><code>830d9a7</code></a></td><td><code>Trac 18356: various improvements and bug fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bef78f51e6d029356dcc4187f9e1a010e4bce3fe\"><code>bef78f5</code></a></td><td><code>Eliminated call to big_O</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8fcbb1aa00349be3048fdf78c6dac4aba038c07c\"><code>8fcbb1a</code></a></td><td><code>Used `operator.add` instead of `+`.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/896f9bdcff469a2bc86847ac38e59fb408bcc9a2\"><code>896f9bd</code></a></td><td><code>Added checks on the input polynomials.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81ec213e52d4b04a6d752d23d66eaa8bcd4941d1\"><code>81ec213</code></a></td><td><code>eliminated `newton_sum`</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f720b8bab4b30d9db69f66a13ca5822aa9514d1d\"><code>f720b8b</code></a></td><td><code>Trac 18356: Eliminated `QQxy_with_gens`; added some doctests.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/de9f0473c60325e54f53d112bd587790f646ecff\"><code>de9f047</code></a></td><td><code>Trac 18356: fix documentation</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/885eb5d695818eeeed34362e37e5271960896c8b\"><code>885eb5d</code></a></td><td><code>Trac 18356: do not use power series ring</code></td></tr></table>\n",
    "created_at": "2016-01-18T19:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252398",
    "user": "https://github.com/videlec"
}
```

<div id="comment:36"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51a383569dd40e300aef748a847ae3ddeb101885"><code>51a3835</code></a></td><td><code>Trac 18356: composed_sum and composed_product for polynomials</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8c609a8a1c7cfbc34fe08984d2df82c862b006eb"><code>8c609a8</code></a></td><td><code>Added `composed_op` replacing `composed_sum` and `composed_product`.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/830d9a751b2fb4378ea841abfccfb273bfdffcb4"><code>830d9a7</code></a></td><td><code>Trac 18356: various improvements and bug fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bef78f51e6d029356dcc4187f9e1a010e4bce3fe"><code>bef78f5</code></a></td><td><code>Eliminated call to big_O</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8fcbb1aa00349be3048fdf78c6dac4aba038c07c"><code>8fcbb1a</code></a></td><td><code>Used `operator.add` instead of `+`.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/896f9bdcff469a2bc86847ac38e59fb408bcc9a2"><code>896f9bd</code></a></td><td><code>Added checks on the input polynomials.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81ec213e52d4b04a6d752d23d66eaa8bcd4941d1"><code>81ec213</code></a></td><td><code>eliminated `newton_sum`</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f720b8bab4b30d9db69f66a13ca5822aa9514d1d"><code>f720b8b</code></a></td><td><code>Trac 18356: Eliminated `QQxy_with_gens`; added some doctests.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/de9f0473c60325e54f53d112bd587790f646ecff"><code>de9f047</code></a></td><td><code>Trac 18356: fix documentation</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/885eb5d695818eeeed34362e37e5271960896c8b"><code>885eb5d</code></a></td><td><code>Trac 18356: do not use power series ring</code></td></tr></table>




---

archive/issue_comments_252399.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,4 @@\n-Added `composed_op` to compute the composed sum and the composed product, implementing\n-the algorithm in A. Bostan, P. Flajolet, B. Salvy and E. Schost,\n-\"Fast Computation of special resultants\",\n-Journal of Symbolic Computation 41 (2006), 1-29\n-in the case of polynomials on the rational ring.\n-This algorithm is asymptotically faster than using the `resultant` method.\n+Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division. Two implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. Currently, only polynomial with coefficient in `QQ` are supported. This algorithm is asymptotically faster than using the `resultant` method.\n \n For instance\n \n@@ -11,13 +6,18 @@\n sage: p1 = minpoly(cos(pi/43))\n sage: p2 = minpoly(cos(pi/47))\n sage: time r1 = p1.composed_op(p2, operator.add)\n-Wall time: 105 ms\n+CPU times: user 108 ms, sys: 4 ms, total: 112 ms\n+Wall time: 111 ms\n sage: time r2 = p1.composed_op(p2, operator.add, algorithm=\"resultant\")\n-Wall time: 53.4 s\n+CPU times: user 47.1 s, sys: 0 ns, total: 47.1 s\n+Wall time: 47.1 s\n sage: r1 == r2\n+True\n sage: r1.is_irreducible()\n True\n ```\n+In the example above, `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`\n \n-so `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`\n+Reference:\n \n+ [BFSS] A. Bostan, P. Flajolet, B. Salvy and E. Schost, \"Fast Computation of special resultants\", Journal of Symbolic Computation 41 (2006), 1-29\n``````\n",
    "created_at": "2016-01-18T19:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252399",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,4 @@
-Added `composed_op` to compute the composed sum and the composed product, implementing
-the algorithm in A. Bostan, P. Flajolet, B. Salvy and E. Schost,
-"Fast Computation of special resultants",
-Journal of Symbolic Computation 41 (2006), 1-29
-in the case of polynomials on the rational ring.
-This algorithm is asymptotically faster than using the `resultant` method.
+Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division. Two implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. Currently, only polynomial with coefficient in `QQ` are supported. This algorithm is asymptotically faster than using the `resultant` method.
 
 For instance
 
@@ -11,13 +6,18 @@
 sage: p1 = minpoly(cos(pi/43))
 sage: p2 = minpoly(cos(pi/47))
 sage: time r1 = p1.composed_op(p2, operator.add)
-Wall time: 105 ms
+CPU times: user 108 ms, sys: 4 ms, total: 112 ms
+Wall time: 111 ms
 sage: time r2 = p1.composed_op(p2, operator.add, algorithm="resultant")
-Wall time: 53.4 s
+CPU times: user 47.1 s, sys: 0 ns, total: 47.1 s
+Wall time: 47.1 s
 sage: r1 == r2
+True
 sage: r1.is_irreducible()
 True
 ```
+In the example above, `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`
 
-so `r1` is the minimal polynomial of `cos(pi/43) + cos(pi/47)`
+Reference:
 
+ [BFSS] A. Bostan, P. Flajolet, B. Salvy and E. Schost, "Fast Computation of special resultants", Journal of Symbolic Computation 41 (2006), 1-29
``````




---

archive/issue_comments_252400.json:
```json
{
    "body": "Changed commit from **[`dcb3748`](https://github.com/sagemath/sagetrac-mirror/commit/dcb3748ffdc3748b6968cf91c188f8ab266ab626)** to **[`885eb5d`](https://github.com/sagemath/sagetrac-mirror/commit/885eb5d695818eeeed34362e37e5271960896c8b)**",
    "created_at": "2016-01-18T19:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252400",
    "user": "https://github.com/videlec"
}
```

Changed commit from **[`dcb3748`](https://github.com/sagemath/sagetrac-mirror/commit/dcb3748ffdc3748b6968cf91c188f8ab266ab626)** to **[`885eb5d`](https://github.com/sagemath/sagetrac-mirror/commit/885eb5d695818eeeed34362e37e5271960896c8b)**



---

archive/issue_comments_252401.json:
```json
{
    "body": "Author: **Marco Pernici, Vincent Delecroix**",
    "created_at": "2016-01-18T19:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252401",
    "user": "https://github.com/videlec"
}
```

Author: **Marco Pernici, Vincent Delecroix**



---

archive/issue_comments_252402.json:
```json
{
    "body": "Changed branch from **[u/pernici/ticket/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/18356)** to **[u/vdelecroix/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18356)**",
    "created_at": "2016-01-18T19:13:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252402",
    "user": "https://github.com/videlec"
}
```

Changed branch from **[u/pernici/ticket/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/pernici/ticket/18356)** to **[u/vdelecroix/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18356)**



---

archive/issue_events_258546.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T19:13:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258546"
}
```



---

archive/issue_events_258547.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-01-18T19:13:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258547"
}
```



---

archive/issue_comments_252403.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nI cherry picked the commit of the old branch and added to commits on top of it:\n- `de9f047`: documentation improvements\n- `\u200b885eb5d`: avoid `PowerSeriesRing` (using #19005 and #19006) and some more cdef declarations",
    "created_at": "2016-01-18T19:14:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252403",
    "user": "https://github.com/videlec"
}
```

<div id="comment:37" align="right">comment:37</div>

I cherry picked the commit of the old branch and added to commits on top of it:
- `de9f047`: documentation improvements
- `885eb5d`: avoid `PowerSeriesRing` (using #19005 and #19006) and some more cdef declarations



---

archive/issue_comments_252404.json:
```json
{
    "body": "Utils for benchmarks between BFSS and resultant",
    "created_at": "2016-01-18T20:18:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252404",
    "user": "https://github.com/videlec"
}
```

Utils for benchmarks between BFSS and resultant



---

archive/issue_comments_252405.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nAttachment: **[composed_op_benchmark.py.gz](https://github.com/sagemath/sage/files/ticket18356/composed_op_benchmark.py.gz)**\n\nSome benchmarks (see [attachment: composed_op_benchmark.py](https://github.com/sagemath/sage/files/ticket18356/composed_op_benchmark.py.gz)) that shows that the threshold between the algorithms should depend on the operator\n\n```\np1 = x^3 - x^2 - x - 1\np2 = x^3 + x^2 + x + 1\noperation     BFSS      resultant  better\noperator.add  0.199ms   0.188ms    resultant x1.06\noperator.sub  0.129ms   0.184ms    BFSS x1.43\noperator.mul  0.102ms   0.187ms    BFSS x1.82\noperator.div  0.106ms   0.177ms    BFSS x1.67\n\np1 = x^4 - x^2 - 1\np2 = x^4 - x^2 - 3\noperation     BFSS      resultant  better\noperator.add  0.254ms   0.174ms    resultant x1.46\noperator.sub  0.194ms   0.176ms    resultant x1.11\noperator.mul  0.127ms   0.167ms    BFSS x1.32\noperator.div  0.145ms   0.170ms    BFSS x1.17\n\np1 = x^8 - x - 1\np2 = x^8 - x^2 - 3\noperation     BFSS      resultant  better\noperator.add  0.992ms   2.647ms    BFSS x2.67\noperator.sub  0.908ms   2.632ms    BFSS x2.90\noperator.mul  0.350ms   0.271ms    resultant x1.29\noperator.div  0.408ms   0.214ms    resultant x1.91\n\np1 = x^8 - 3*x - 1\np2 = x^2 - 3\noperation     BFSS      resultant  better\noperator.add  0.274ms   0.177ms    resultant x1.55\noperator.sub  0.186ms   0.185ms    resultant x1.01\noperator.mul  0.106ms   0.170ms    BFSS x1.61\noperator.div  0.125ms   0.168ms    BFSS x1.35\n```",
    "created_at": "2016-01-18T20:25:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252405",
    "user": "https://github.com/videlec"
}
```

<div id="comment:38" align="right">comment:38</div>

Attachment: **[composed_op_benchmark.py.gz](https://github.com/sagemath/sage/files/ticket18356/composed_op_benchmark.py.gz)**

Some benchmarks (see [attachment: composed_op_benchmark.py](https://github.com/sagemath/sage/files/ticket18356/composed_op_benchmark.py.gz)) that shows that the threshold between the algorithms should depend on the operator

```
p1 = x^3 - x^2 - x - 1
p2 = x^3 + x^2 + x + 1
operation     BFSS      resultant  better
operator.add  0.199ms   0.188ms    resultant x1.06
operator.sub  0.129ms   0.184ms    BFSS x1.43
operator.mul  0.102ms   0.187ms    BFSS x1.82
operator.div  0.106ms   0.177ms    BFSS x1.67

p1 = x^4 - x^2 - 1
p2 = x^4 - x^2 - 3
operation     BFSS      resultant  better
operator.add  0.254ms   0.174ms    resultant x1.46
operator.sub  0.194ms   0.176ms    resultant x1.11
operator.mul  0.127ms   0.167ms    BFSS x1.32
operator.div  0.145ms   0.170ms    BFSS x1.17

p1 = x^8 - x - 1
p2 = x^8 - x^2 - 3
operation     BFSS      resultant  better
operator.add  0.992ms   2.647ms    BFSS x2.67
operator.sub  0.908ms   2.632ms    BFSS x2.90
operator.mul  0.350ms   0.271ms    resultant x1.29
operator.div  0.408ms   0.214ms    resultant x1.91

p1 = x^8 - 3*x - 1
p2 = x^2 - 3
operation     BFSS      resultant  better
operator.add  0.274ms   0.177ms    resultant x1.55
operator.sub  0.186ms   0.185ms    resultant x1.01
operator.mul  0.106ms   0.170ms    BFSS x1.61
operator.div  0.125ms   0.168ms    BFSS x1.35
```



---

archive/issue_comments_252406.json:
```json
{
    "body": "<div id=\"comment:39\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1ec84bb78d9e3a5a1e1c966d78e1797ec70afac0\"><code>1ec84bb</code></a></td><td><code>Trac 18356: use `_mul_trunc_` when possible</code></td></tr></table>\n",
    "created_at": "2016-01-19T12:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252406",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1ec84bb78d9e3a5a1e1c966d78e1797ec70afac0"><code>1ec84bb</code></a></td><td><code>Trac 18356: use `_mul_trunc_` when possible</code></td></tr></table>




---

archive/issue_comments_252407.json:
```json
{
    "body": "Changed commit from **[`885eb5d`](https://github.com/sagemath/sagetrac-mirror/commit/885eb5d695818eeeed34362e37e5271960896c8b)** to **[`1ec84bb`](https://github.com/sagemath/sagetrac-mirror/commit/1ec84bb78d9e3a5a1e1c966d78e1797ec70afac0)**",
    "created_at": "2016-01-19T12:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252407",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`885eb5d`](https://github.com/sagemath/sagetrac-mirror/commit/885eb5d695818eeeed34362e37e5271960896c8b)** to **[`1ec84bb`](https://github.com/sagemath/sagetrac-mirror/commit/1ec84bb78d9e3a5a1e1c966d78e1797ec70afac0)**



---

archive/issue_comments_252408.json:
```json
{
    "body": "Changed commit from **[`1ec84bb`](https://github.com/sagemath/sagetrac-mirror/commit/1ec84bb78d9e3a5a1e1c966d78e1797ec70afac0)** to **[`bfb6379`](https://github.com/sagemath/sagetrac-mirror/commit/bfb6379a8ab8b59d37cb99204f40322b911fab90)**",
    "created_at": "2016-01-25T04:14:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252408",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`1ec84bb`](https://github.com/sagemath/sagetrac-mirror/commit/1ec84bb78d9e3a5a1e1c966d78e1797ec70afac0)** to **[`bfb6379`](https://github.com/sagemath/sagetrac-mirror/commit/bfb6379a8ab8b59d37cb99204f40322b911fab90)**



---

archive/issue_comments_252409.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bfb6379a8ab8b59d37cb99204f40322b911fab90\"><code>bfb6379</code></a></td><td><code>Trac 18356: composed_op for any field</code></td></tr></table>\n",
    "created_at": "2016-01-25T04:14:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252409",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bfb6379a8ab8b59d37cb99204f40322b911fab90"><code>bfb6379</code></a></td><td><code>Trac 18356: composed_op for any field</code></td></tr></table>




---

archive/issue_comments_252410.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n-Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division. Two implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. Currently, only polynomial with coefficient in `QQ` are supported. This algorithm is asymptotically faster than using the `resultant` method.\n+Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division of two polynomias. That is the polynomial whose roots are the sum (resp. difference, product, division) of the roots of the two polynomials.\n+\n+Two implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. For the latter algorithm, only polynomial with coefficient in `ZZ` or `QQ` are supported. However, this algorithm is asymptotically faster than using the `resultant` method.\n \n For instance\n \n``````\n",
    "created_at": "2016-01-25T04:16:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252410",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
-Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division. Two implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. Currently, only polynomial with coefficient in `QQ` are supported. This algorithm is asymptotically faster than using the `resultant` method.
+Add a new operation `composed_op` on polynomials to compute the composed sum, difference, product and division of two polynomias. That is the polynomial whose roots are the sum (resp. difference, product, division) of the roots of the two polynomials.
+
+Two implementations are proposed. The straightforward one using resultants and the algorithm from [BFSS]. For the latter algorithm, only polynomial with coefficient in `ZZ` or `QQ` are supported. However, this algorithm is asymptotically faster than using the `resultant` method.
 
 For instance
 
``````




---

archive/issue_events_258548.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2016-05-18T13:03:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "milestone_number": null,
    "milestone_title": "sage-7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258548"
}
```



---

archive/issue_events_258549.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2016-05-18T13:03:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258549"
}
```



---

archive/issue_comments_252411.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18356)** to **[public/ticket/18356-composed-op](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/18356-composed-op)**",
    "created_at": "2016-05-18T13:03:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252411",
    "user": "https://github.com/mezzarobba"
}
```

Changed branch from **[u/vdelecroix/18356](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18356)** to **[public/ticket/18356-composed-op](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/18356-composed-op)**



---

archive/issue_comments_252412.json:
```json
{
    "body": "Changed commit from **[`bfb6379`](https://github.com/sagemath/sagetrac-mirror/commit/bfb6379a8ab8b59d37cb99204f40322b911fab90)** to **[`a4d2df6`](https://github.com/sagemath/sagetrac-mirror/commit/a4d2df69e9dae4715093d18c991f0427b7f16bf9)**",
    "created_at": "2016-05-18T13:03:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252412",
    "user": "https://github.com/mezzarobba"
}
```

Changed commit from **[`bfb6379`](https://github.com/sagemath/sagetrac-mirror/commit/bfb6379a8ab8b59d37cb99204f40322b911fab90)** to **[`a4d2df6`](https://github.com/sagemath/sagetrac-mirror/commit/a4d2df69e9dae4715093d18c991f0427b7f16bf9)**



---

archive/issue_comments_252413.json:
```json
{
    "body": "Reviewer: **Vincent Delecroix, Marc Mezzarobba**",
    "created_at": "2016-05-18T13:03:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252413",
    "user": "https://github.com/mezzarobba"
}
```

Reviewer: **Vincent Delecroix, Marc Mezzarobba**



---

archive/issue_comments_252414.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nI think that the code is good to go except for a few details which I tried to fix. Please set the ticket to positive_review if you are okay with my changes.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d8474c9e0885b677d9839c7478e4c371ce194cbd\"><code>d8474c9</code></a></td><td><code>Merge branch 'develop' into review/composed</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66ae0a0385af66d1dbcb192e6001f21ae5f8c172\"><code>66ae0a0</code></a></td><td><code>#18356 fix doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8fa5d3b98d2e615dfc49dd71dda1478ac459ed69\"><code>8fa5d3b</code></a></td><td><code>#18356 improve docstring of Polynomial.composed_op()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4d2df69e9dae4715093d18c991f0427b7f16bf9\"><code>a4d2df6</code></a></td><td><code>#18536 minor improvements to Polynmomial.composed_op()</code></td></tr></table>\n",
    "created_at": "2016-05-18T13:03:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252414",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:42" align="right">comment:42</div>

I think that the code is good to go except for a few details which I tried to fix. Please set the ticket to positive_review if you are okay with my changes.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d8474c9e0885b677d9839c7478e4c371ce194cbd"><code>d8474c9</code></a></td><td><code>Merge branch 'develop' into review/composed</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66ae0a0385af66d1dbcb192e6001f21ae5f8c172"><code>66ae0a0</code></a></td><td><code>#18356 fix doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8fa5d3b98d2e615dfc49dd71dda1478ac459ed69"><code>8fa5d3b</code></a></td><td><code>#18356 improve docstring of Polynomial.composed_op()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4d2df69e9dae4715093d18c991f0427b7f16bf9"><code>a4d2df6</code></a></td><td><code>#18536 minor improvements to Polynmomial.composed_op()</code></td></tr></table>




---

archive/issue_comments_252415.json:
```json
{
    "body": "Changed commit from **[`a4d2df6`](https://github.com/sagemath/sagetrac-mirror/commit/a4d2df69e9dae4715093d18c991f0427b7f16bf9)** to **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)**",
    "created_at": "2016-05-18T13:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252415",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a4d2df6`](https://github.com/sagemath/sagetrac-mirror/commit/a4d2df69e9dae4715093d18c991f0427b7f16bf9)** to **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)**



---

archive/issue_comments_252416.json:
```json
{
    "body": "<div id=\"comment:43\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b339d44fa7ce5ea057a83d7552989df7c6a92e95\"><code>b339d44</code></a></td><td><code>#18356 improve docstring of Polynomial.composed_op()</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0\"><code>c6b1c35</code></a></td><td><code>#18536 minor improvements to Polynmomial.composed_op()</code></td></tr></table>\n",
    "created_at": "2016-05-18T13:05:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252416",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:43"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b339d44fa7ce5ea057a83d7552989df7c6a92e95"><code>b339d44</code></a></td><td><code>#18356 improve docstring of Polynomial.composed_op()</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0"><code>c6b1c35</code></a></td><td><code>#18536 minor improvements to Polynmomial.composed_op()</code></td></tr></table>




---

archive/issue_comments_252417.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nCool! Thank you!",
    "created_at": "2016-05-18T13:24:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252417",
    "user": "https://github.com/videlec"
}
```

<div id="comment:44" align="right">comment:44</div>

Cool! Thank you!



---

archive/issue_events_258550.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-05-18T13:24:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258550"
}
```



---

archive/issue_events_258551.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-05-18T13:24:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258551"
}
```



---

archive/issue_comments_252418.json:
```json
{
    "body": "Changed branch from **[public/ticket/18356-composed-op](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/18356-composed-op)** to **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)**",
    "created_at": "2016-05-19T22:39:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252418",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/ticket/18356-composed-op](https://github.com/sagemath/sagetrac-mirror/tree/public/ticket/18356-composed-op)** to **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)**



---

archive/issue_events_258552.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-19T22:39:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258552"
}
```



---

archive/issue_events_258553.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "abe5af60195687205265410123fc657db7f425e6",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-05-19T22:39:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18356#event-258553"
}
```



---

archive/issue_comments_252419.json:
```json
{
    "body": "Changed commit from **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)** to none",
    "created_at": "2016-07-14T07:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252419",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`c6b1c35`](https://github.com/sagemath/sagetrac-mirror/commit/c6b1c35de85957fc501d6f34b4de6b8def0a8ea0)** to none



---

archive/issue_comments_252420.json:
```json
{
    "body": "Changed author from **Marco Pernici, Vincent Delecroix** to **Mario Pernici, Vincent Delecroix**",
    "created_at": "2016-07-14T07:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18356",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18356#issuecomment-252420",
    "user": "https://github.com/fchapoton"
}
```

Changed author from **Marco Pernici, Vincent Delecroix** to **Mario Pernici, Vincent Delecroix**
