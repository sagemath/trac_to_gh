# Issue 18442: Implement the barycentric subdivision of the boundary of a polytope

archive/issues_018205.json:
```json
{
    "body": "The boundary of a polytope is a CW-complex for which we compute a geometric realization of its barycentric subdivision as follows:\n\nA complete flag of faces `F_0,F_1,...,F_{d-1},F_{d`} is a nested sequence of faces starting with a vertex `F_0` and ending with the full `d`-dimensional polytope `P` such that the dimension of `F_i` is `i`.\n\nTo each complete flag of faces we can assign a simplex whose vertices are the geometric barycenter of the `d+1` faces in the complete flag. This gives a subdivision of the polytope into simplices. The number of simplices is equal to the number of complete chains in the face lattice.\n\nSimilarly, it is possible to define the barycentric subdivision of the boundary of a compact polytope by taking only the complete flag of faces up to `d-1`-dimensional faces. The simplicial complex realizing this barycentric subdivision can be realized convexly by pulling the barycenters to the outside of the polytope with a convenient factor.\n\nThe result of such a process is a polytope whose facets correspond to complete flags of faces of the original polytope.\n\nThis method computes a geometric realization of the barycentric subdivision of the boundary of a compact polyhedron.\n\nSee also https://en.wikipedia.org/wiki/Barycentric_subdivision#Barycentric_subdivision_of_a_convex_polytope\n\nCC:  @vbraun mhampton @mo271 @fchapoton\n\nKeywords: polytope, barycentric subdivision\n\nBranch/Commit: 940c79f96d489b44bd25b0f24937a5bd3f839a97\n\nReviewer: Dima Pasechnik\n\nAuthor: Jean-Philippe Labb\u00e9\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18442\n\n",
    "closed_at": "2015-11-25T23:29:39Z",
    "created_at": "2015-05-18T15:52:58Z",
    "labels": [
        "component: geometry"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "Implement the barycentric subdivision of the boundary of a polytope",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18442",
    "user": "https://github.com/jplab"
}
```
The boundary of a polytope is a CW-complex for which we compute a geometric realization of its barycentric subdivision as follows:

A complete flag of faces `F_0,F_1,...,F_{d-1},F_{d`} is a nested sequence of faces starting with a vertex `F_0` and ending with the full `d`-dimensional polytope `P` such that the dimension of `F_i` is `i`.

To each complete flag of faces we can assign a simplex whose vertices are the geometric barycenter of the `d+1` faces in the complete flag. This gives a subdivision of the polytope into simplices. The number of simplices is equal to the number of complete chains in the face lattice.

Similarly, it is possible to define the barycentric subdivision of the boundary of a compact polytope by taking only the complete flag of faces up to `d-1`-dimensional faces. The simplicial complex realizing this barycentric subdivision can be realized convexly by pulling the barycenters to the outside of the polytope with a convenient factor.

The result of such a process is a polytope whose facets correspond to complete flags of faces of the original polytope.

This method computes a geometric realization of the barycentric subdivision of the boundary of a compact polyhedron.

See also https://en.wikipedia.org/wiki/Barycentric_subdivision#Barycentric_subdivision_of_a_convex_polytope

CC:  @vbraun mhampton @mo271 @fchapoton

Keywords: polytope, barycentric subdivision

Branch/Commit: 940c79f96d489b44bd25b0f24937a5bd3f839a97

Reviewer: Dima Pasechnik

Author: Jean-Philippe Labb√©

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18442





---

archive/issue_comments_261482.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2015-05-18T15:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261482",
    "user": "https://github.com/jplab"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_261483.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-05-18T15:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261483",
    "user": "https://github.com/jplab"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_261484.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-20T09:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261484",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_261485.json:
```json
{
    "body": "<a id='comment:4'></a>The current code only works for simplicial polytopes. I have to correct the code for more general cases.",
    "created_at": "2015-05-20T09:21:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261485",
    "user": "https://github.com/jplab"
}
```

<a id='comment:4'></a>The current code only works for simplicial polytopes. I have to correct the code for more general cases.



---

archive/issue_comments_261486.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-20T15:58:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261486",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261487.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-21T11:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261487",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261488.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-07T10:38:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261488",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_261489.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-08T11:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261489",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_261490.json:
```json
{
    "body": "<a id='comment:8'></a>* the doc does not build, Seems to be some indentation error\n\n* do not use assert to check the input. Rather raise `ValueError('text')` or `TypeError('text')`",
    "created_at": "2015-06-08T11:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261490",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:8'></a>* the doc does not build, Seems to be some indentation error

* do not use assert to check the input. Rather raise `ValueError('text')` or `TypeError('text')`



---

archive/issue_events_051930.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-06-08T11:58:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18442#event-51930"
}
```



---

archive/issue_comments_261491.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-09T08:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261491",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261492.json:
```json
{
    "body": "<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-09T08:29:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261492",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261493.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-09T08:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261493",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261494.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-09T08:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261494",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_261495.json:
```json
{
    "body": "<a id='comment:14'></a>I have made a first review.\n\nDo you really need to build a polyhedron so many times ?\n\nThe doctest with pentagon in AA was very slow. I replaced AA by RDF and it failed.\n\n---\nNew commits:",
    "created_at": "2015-06-13T13:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261495",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>I have made a first review.

Do you really need to build a polyhedron so many times ?

The doctest with pentagon in AA was very slow. I replaced AA by RDF and it failed.

---
New commits:



---

archive/issue_comments_261496.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-13T13:02:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261496",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_261497.json:
```json
{
    "body": "<a id='comment:15'></a>Hi Fr\u00e9d\u00e9ric,\n\nYes, I was wondering if it was absolutely necessary to use all these intermediate polyhedra. It is very costly indeed. I have to think how to improve this.",
    "created_at": "2015-06-25T13:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261497",
    "user": "https://github.com/jplab"
}
```

<a id='comment:15'></a>Hi Fr√©d√©ric,

Yes, I was wondering if it was absolutely necessary to use all these intermediate polyhedra. It is very costly indeed. I have to think how to improve this.



---

archive/issue_comments_261498.json:
```json
{
    "body": "<a id='comment:16'></a>Hi again,\n\nSo, I looked at bit at the literature, maybe I'm missing some efficient way to compute it...\n\nSuppose we have a very round polytope and we want to do the barycentric subdivision of it. To do it, I used the face fan of the polar (which is the normal fan of the original) for the implementation since cutting by an hyperplane was algorithmically easier than adding a vertex (as I saw it...).\n\nWe need to start with adding a vertex at the barycenter of all the facets. This is done dually by chopping every vertex of the polar polytope. The \"chopping height\" is determined by the location of the vertices of the polytope: we cut 1/3 of the shortest edge touching this vertex in the direction of the normal of the hyperplane.\n\nOnce all the facets are done, we really need (I believe) to compute an intermediate polytope to proceed to the ridges and lower dimensional faces to subdivide, since the location of the next cuts will depend on the location of the newly created vertices (remember that the polytope is assumed very round so the interval in which we can put the next vertices depend highly on the previous ones).\n\nTopologically, this is not necessary, but to realize the barycentric subdivision convexly I'm afraid this is necessary.\n\nIn any case, I believe that the barycentric subdivision is known to be very costly (counting flags in a lattice grows exponentially...) so it is to be expected that it gets slow very fast. Of course, it also depends in which ring the computation is done.\n\nDoes the way I used make sense at all?",
    "created_at": "2015-06-28T08:49:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261498",
    "user": "https://github.com/jplab"
}
```

<a id='comment:16'></a>Hi again,

So, I looked at bit at the literature, maybe I'm missing some efficient way to compute it...

Suppose we have a very round polytope and we want to do the barycentric subdivision of it. To do it, I used the face fan of the polar (which is the normal fan of the original) for the implementation since cutting by an hyperplane was algorithmically easier than adding a vertex (as I saw it...).

We need to start with adding a vertex at the barycenter of all the facets. This is done dually by chopping every vertex of the polar polytope. The "chopping height" is determined by the location of the vertices of the polytope: we cut 1/3 of the shortest edge touching this vertex in the direction of the normal of the hyperplane.

Once all the facets are done, we really need (I believe) to compute an intermediate polytope to proceed to the ridges and lower dimensional faces to subdivide, since the location of the next cuts will depend on the location of the newly created vertices (remember that the polytope is assumed very round so the interval in which we can put the next vertices depend highly on the previous ones).

Topologically, this is not necessary, but to realize the barycentric subdivision convexly I'm afraid this is necessary.

In any case, I believe that the barycentric subdivision is known to be very costly (counting flags in a lattice grows exponentially...) so it is to be expected that it gets slow very fast. Of course, it also depends in which ring the computation is done.

Does the way I used make sense at all?



---

archive/issue_comments_261499.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-28T08:51:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261499",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261500.json:
```json
{
    "body": "<a id='comment:19'></a>The problem pointed out is created by the following behavior:\n\nsage: P = polytopes.regular_polygon(5)\nsage: a_vertex = P.vertices()[0]\nsage: for facet in P.Hrepresentation():\n    print facet.contains(a_vertex), facet.interior_contains(a_vertex)\nTrue False\nTrue True\nTrue False\nTrue True\nTrue True\nsage: P = polytopes.regular_polygon(5, base_ring=RDF)\nsage: a_vertex = P.vertices()[0]\nsage: for facet in P.Hrepresentation():\n    print facet.contains(a_vertex), facet.interior_contains(a_vertex)  \nTrue True\nTrue True\nTrue True\nTrue True\nTrue True\n\nThe last behavior is indeed problematic since we can not recognize the vertices by the containment using the specific methods. Is this a bug?\n\nBasically, I would never really do computation in RDF using polytopes or do it in very specific contexts. In the context of barycentric subdivision also.\n\nFor the sake of this patch, perhaps taking a regular pentagon is not ideal, although it aloud to show this problem.\n\nI could simply replace this example with a square.",
    "created_at": "2015-10-12T15:40:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261500",
    "user": "https://github.com/jplab"
}
```

<a id='comment:19'></a>The problem pointed out is created by the following behavior:

sage: P = polytopes.regular_polygon(5)
sage: a_vertex = P.vertices()[0]
sage: for facet in P.Hrepresentation():
    print facet.contains(a_vertex), facet.interior_contains(a_vertex)
True False
True True
True False
True True
True True
sage: P = polytopes.regular_polygon(5, base_ring=RDF)
sage: a_vertex = P.vertices()[0]
sage: for facet in P.Hrepresentation():
    print facet.contains(a_vertex), facet.interior_contains(a_vertex)  
True True
True True
True True
True True
True True

The last behavior is indeed problematic since we can not recognize the vertices by the containment using the specific methods. Is this a bug?

Basically, I would never really do computation in RDF using polytopes or do it in very specific contexts. In the context of barycentric subdivision also.

For the sake of this patch, perhaps taking a regular pentagon is not ideal, although it aloud to show this problem.

I could simply replace this example with a square.



---

archive/issue_comments_261501.json:
```json
{
    "body": "<a id='comment:20'></a>I do not understand the ticket description. A subdivision of a polytope is not a polytope, at least if by subdivision you mean a partition into polytopes with non-intersecting interiors.",
    "created_at": "2015-10-13T16:15:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261501",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:20'></a>I do not understand the ticket description. A subdivision of a polytope is not a polytope, at least if by subdivision you mean a partition into polytopes with non-intersecting interiors.



---

archive/issue_comments_261502.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n-The barycentric subdivision of a compact polytope is a new polytope obtained by subdividing every face of the polytope by a vertex. Its faces are in bijection with flags of faces of the input polytope.\n+The barycentric subdivision of a compact polytope P is obtained as follows:\n+\n+A complete flag of faces `F_0,F_1,...,F_{d-1},F_{d`} is a nested sequence of faces starting with a vertex `F_0` and ending with the full `d`-dimensional polytope `P` such that the dimension of `F_i` is `i`.\n+\n+To each complete flag of faces we can assign a simplex whose vertices are the geometric barycenter of the `d+1` faces in the complete flag. This gives a subdivision of the polytope into simplices. The number of simplices is equal to the number of complete chains in the face lattice.\n+\n+Similarly, it is possible to define the barycentric subdivision of the boundary of a compact polytope by taking only the complete flag of faces up to `d-1`-dimensional faces. The simplicial complex realizing this barycentric subdivision can be realized convexly by pulling the barycenters to the outside of the polytope with a convenient factor.\n+\n+The result of such a process is a polytope whose facets correspond to complete flags of faces of the original polytope.\n+\n+This method computes the barycentric subdivision of the boundary of a compact polyhedron.\n+\n+See also https://en.wikipedia.org/wiki/Barycentric_subdivision#Barycentric_subdivision_of_a_convex_polytope\n \n Author: Jean-Philippe Labb\u00e9\n \n``````\n",
    "created_at": "2015-10-13T16:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261502",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,16 @@
-The barycentric subdivision of a compact polytope is a new polytope obtained by subdividing every face of the polytope by a vertex. Its faces are in bijection with flags of faces of the input polytope.
+The barycentric subdivision of a compact polytope P is obtained as follows:
+
+A complete flag of faces `F_0,F_1,...,F_{d-1},F_{d`} is a nested sequence of faces starting with a vertex `F_0` and ending with the full `d`-dimensional polytope `P` such that the dimension of `F_i` is `i`.
+
+To each complete flag of faces we can assign a simplex whose vertices are the geometric barycenter of the `d+1` faces in the complete flag. This gives a subdivision of the polytope into simplices. The number of simplices is equal to the number of complete chains in the face lattice.
+
+Similarly, it is possible to define the barycentric subdivision of the boundary of a compact polytope by taking only the complete flag of faces up to `d-1`-dimensional faces. The simplicial complex realizing this barycentric subdivision can be realized convexly by pulling the barycenters to the outside of the polytope with a convenient factor.
+
+The result of such a process is a polytope whose facets correspond to complete flags of faces of the original polytope.
+
+This method computes the barycentric subdivision of the boundary of a compact polyhedron.
+
+See also https://en.wikipedia.org/wiki/Barycentric_subdivision#Barycentric_subdivision_of_a_convex_polytope
 
 Author: Jean-Philippe Labb√©
 
``````




---

archive/issue_comments_261503.json:
```json
{
    "body": "<a id='comment:22'></a>Hmm, now the title says you subdivide the boundary only, while you still have  `barycentric_subdivision()` subdividing the whole polytope, no?",
    "created_at": "2015-10-13T17:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261503",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:22'></a>Hmm, now the title says you subdivide the boundary only, while you still have  `barycentric_subdivision()` subdividing the whole polytope, no?



---

archive/issue_comments_261504.json:
```json
{
    "body": "<a id='comment:23'></a>and what is \"compact polyhedron\"? I can think of two quite different meanings...",
    "created_at": "2015-10-13T17:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261504",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:23'></a>and what is "compact polyhedron"? I can think of two quite different meanings...



---

archive/issue_comments_261505.json:
```json
{
    "body": "<a id='comment:24'></a>Yes, I guess I should change the name of the method too then.\n\nThere is a method in polyhedron called .is_compact() which verifies for boundedness. This is the definition I use for compact polyhedron.",
    "created_at": "2015-10-13T17:45:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261505",
    "user": "https://github.com/jplab"
}
```

<a id='comment:24'></a>Yes, I guess I should change the name of the method too then.

There is a method in polyhedron called .is_compact() which verifies for boundedness. This is the definition I use for compact polyhedron.



---

archive/issue_comments_261506.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 jipilab]:\n> Yes, I guess I should change the name of the method too then.\n> \n> There is a method in polyhedron called .is_compact() which verifies for boundedness. This is the definition I use for compact polyhedron.\n\n\nDoes this mean that your compact polyhedra are polytopes, or not?",
    "created_at": "2015-10-13T18:06:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261506",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'></a>Replying to [comment:24 jipilab]:
> Yes, I guess I should change the name of the method too then.
> 
> There is a method in polyhedron called .is_compact() which verifies for boundedness. This is the definition I use for compact polyhedron.


Does this mean that your compact polyhedra are polytopes, or not?



---

archive/issue_comments_261507.json:
```json
{
    "body": "<a id='comment:26'></a>Yes. This is the definition of a polytope: a bounded polyhedron.\n\nBasically the notion of polytope is subsumed in Sage by the class Polyhedron.\n\nTheorically a polyhedron (with H representation) is always decomposed as the sum of a polyhedral cone and a convex polytope, therefore polytopes are considered in the class polyhedron simply where the cone is a point, and the way to detect them is by checking compactness.\n\nThe description uses polyhedron simply because polytope is more or less absent from the nomenclature in sage apart from the database of polytopes...",
    "created_at": "2015-10-13T18:11:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261507",
    "user": "https://github.com/jplab"
}
```

<a id='comment:26'></a>Yes. This is the definition of a polytope: a bounded polyhedron.

Basically the notion of polytope is subsumed in Sage by the class Polyhedron.

Theorically a polyhedron (with H representation) is always decomposed as the sum of a polyhedral cone and a convex polytope, therefore polytopes are considered in the class polyhedron simply where the cone is a point, and the way to detect them is by checking compactness.

The description uses polyhedron simply because polytope is more or less absent from the nomenclature in sage apart from the database of polytopes...



---

archive/issue_comments_261508.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 jipilab]:\n> Yes. This is the definition of a polytope: a bounded polyhedron.\n\n\nyou might also find definitions of polyheda, as finite unions of convex polyhedra.\nThat is, convexity is not always assumed.\n\n> \n> Basically the notion of polytope is subsumed in Sage by the class Polyhedron.\n> \n> Theorically a polyhedron (with H representation) is always decomposed as the sum of a polyhedral cone and a convex polytope, therefore polytopes are considered in the class polyhedron simply where the cone is a point, and the way to detect them is by checking compactness.\n> \n> The description uses polyhedron simply because polytope is more or less absent from the nomenclature in sage apart from the database of polytopes.\n> \n\nhmm, and what do you compute then? The boundary of a polyhedron is not convex...",
    "created_at": "2015-10-13T18:40:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261508",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'></a>Replying to [comment:26 jipilab]:
> Yes. This is the definition of a polytope: a bounded polyhedron.


you might also find definitions of polyheda, as finite unions of convex polyhedra.
That is, convexity is not always assumed.

> 
> Basically the notion of polytope is subsumed in Sage by the class Polyhedron.
> 
> Theorically a polyhedron (with H representation) is always decomposed as the sum of a polyhedral cone and a convex polytope, therefore polytopes are considered in the class polyhedron simply where the cone is a point, and the way to detect them is by checking compactness.
> 
> The description uses polyhedron simply because polytope is more or less absent from the nomenclature in sage apart from the database of polytopes.
> 

hmm, and what do you compute then? The boundary of a polyhedron is not convex...



---

archive/issue_comments_261509.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,16 @@\n+The boundary of a polytope is a CW-complex for which we compute a geometric realization of its barycentric subdivision as follows:\n \n+A complete flag of faces `F_0,F_1,...,F_{d-1},F_{d`} is a nested sequence of faces starting with a vertex `F_0` and ending with the full `d`-dimensional polytope `P` such that the dimension of `F_i` is `i`.\n+\n+To each complete flag of faces we can assign a simplex whose vertices are the geometric barycenter of the `d+1` faces in the complete flag. This gives a subdivision of the polytope into simplices. The number of simplices is equal to the number of complete chains in the face lattice.\n+\n+Similarly, it is possible to define the barycentric subdivision of the boundary of a compact polytope by taking only the complete flag of faces up to `d-1`-dimensional faces. The simplicial complex realizing this barycentric subdivision can be realized convexly by pulling the barycenters to the outside of the polytope with a convenient factor.\n+\n+The result of such a process is a polytope whose facets correspond to complete flags of faces of the original polytope.\n+\n+This method computes a geometric realization of the barycentric subdivision of the boundary of a compact polyhedron.\n+\n+See also https://en.wikipedia.org/wiki/Barycentric_subdivision#Barycentric_subdivision_of_a_convex_polytope\n \n Author: Jean-Philippe Labb\u00e9\n \n``````\n",
    "created_at": "2015-10-14T06:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261509",
    "user": "https://github.com/jplab"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,16 @@
+The boundary of a polytope is a CW-complex for which we compute a geometric realization of its barycentric subdivision as follows:
 
+A complete flag of faces `F_0,F_1,...,F_{d-1},F_{d`} is a nested sequence of faces starting with a vertex `F_0` and ending with the full `d`-dimensional polytope `P` such that the dimension of `F_i` is `i`.
+
+To each complete flag of faces we can assign a simplex whose vertices are the geometric barycenter of the `d+1` faces in the complete flag. This gives a subdivision of the polytope into simplices. The number of simplices is equal to the number of complete chains in the face lattice.
+
+Similarly, it is possible to define the barycentric subdivision of the boundary of a compact polytope by taking only the complete flag of faces up to `d-1`-dimensional faces. The simplicial complex realizing this barycentric subdivision can be realized convexly by pulling the barycenters to the outside of the polytope with a convenient factor.
+
+The result of such a process is a polytope whose facets correspond to complete flags of faces of the original polytope.
+
+This method computes a geometric realization of the barycentric subdivision of the boundary of a compact polyhedron.
+
+See also https://en.wikipedia.org/wiki/Barycentric_subdivision#Barycentric_subdivision_of_a_convex_polytope
 
 Author: Jean-Philippe Labb√©
 
``````




---

archive/issue_comments_261510.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:27 dimpase]:\n> Replying to [comment:26 jipilab]:\n> > Yes. This is the definition of a polytope: a bounded polyhedron.\n  \n> \n> you might also find definitions of polyheda, as finite unions of convex polyhedra.\n> That is, convexity is not always assumed.\n\n\nThis is true, for example in rigidity theory. As far as I know, the Polyhedron class in Sage deals only with convex polyhedra. In this case, it is assumed that it is convex.\n\n> \n> > \n> > Basically the notion of polytope is subsumed in Sage by the class Polyhedron.\n> > \n> > Theorically a polyhedron (with H representation) is always decomposed as the sum of a polyhedral cone and a convex polytope, therefore polytopes are considered in the class polyhedron simply where the cone is a point, and the way to detect them is by checking compactness.\n> > \n> > The description uses polyhedron simply because polytope is more or less absent from the nomenclature in sage apart from the database of polytopes.\n> > \n\n> hmm, and what do you compute then? The boundary of a polyhedron is not convex...\n\nThe boundary of a polytope is a CW-complex for which we compute a geometric realization of its barycentric subdivision.",
    "created_at": "2015-10-14T06:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261510",
    "user": "https://github.com/jplab"
}
```

<a id='comment:28'></a>Replying to [comment:27 dimpase]:
> Replying to [comment:26 jipilab]:
> > Yes. This is the definition of a polytope: a bounded polyhedron.
  
> 
> you might also find definitions of polyheda, as finite unions of convex polyhedra.
> That is, convexity is not always assumed.


This is true, for example in rigidity theory. As far as I know, the Polyhedron class in Sage deals only with convex polyhedra. In this case, it is assumed that it is convex.

> 
> > 
> > Basically the notion of polytope is subsumed in Sage by the class Polyhedron.
> > 
> > Theorically a polyhedron (with H representation) is always decomposed as the sum of a polyhedral cone and a convex polytope, therefore polytopes are considered in the class polyhedron simply where the cone is a point, and the way to detect them is by checking compactness.
> > 
> > The description uses polyhedron simply because polytope is more or less absent from the nomenclature in sage apart from the database of polytopes.
> > 

> hmm, and what do you compute then? The boundary of a polyhedron is not convex...

The boundary of a polytope is a CW-complex for which we compute a geometric realization of its barycentric subdivision.



---

archive/issue_comments_261511.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-10-21T12:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261511",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261512.json:
```json
{
    "body": "<a id='comment:30'></a>The discussion on sage-devel available here:\n\nhttps://groups.google.com/forum/#!searchin/sage-devel/barycentric/sage-devel/HubsPplvkE4/gw0avDkWCQAJ\n\nLed me to only test for rational polytopes. The barycentric subdivision is fast enough on the rationals and will ultimately lead to problems in RDF in any case, therefore I would say it is not necessary to test it.\n\nI would say it is also not necessary to warn the user, as the user should know that doing such computations in RDF will lead to errors.\n\nIs that reasonable?\n\nThe current last commit made test pass on sage-6.9.",
    "created_at": "2015-10-21T12:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261512",
    "user": "https://github.com/jplab"
}
```

<a id='comment:30'></a>The discussion on sage-devel available here:

https://groups.google.com/forum/#!searchin/sage-devel/barycentric/sage-devel/HubsPplvkE4/gw0avDkWCQAJ

Led me to only test for rational polytopes. The barycentric subdivision is fast enough on the rationals and will ultimately lead to problems in RDF in any case, therefore I would say it is not necessary to test it.

I would say it is also not necessary to warn the user, as the user should know that doing such computations in RDF will lead to errors.

Is that reasonable?

The current last commit made test pass on sage-6.9.



---

archive/issue_comments_261513.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-21T12:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261513",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_261514.json:
```json
{
    "body": "<a id='comment:31'></a>Replying to [comment:30 jipilab]:\n> The discussion on sage-devel available here:\n> \n> https://groups.google.com/forum/#!searchin/sage-devel/barycentric/sage-devel/HubsPplvkE4/gw0avDkWCQAJ\n> \n> Led me to only test for rational polytopes. The barycentric subdivision is fast enough on the rationals and will ultimately lead to problems in RDF in any case, therefore I would say it is not necessary to test it.\n> \n> I would say it is also not necessary to warn the user, as the user should know that doing such computations in RDF will lead to errors.\n> \n> Is that reasonable?\n> \n> The current last commit made test pass on sage-6.9.\n\n\nthere is also a backend to work with real algebraic numbers.\n(`Polyhedron(...., backend='field'...)`)\nI think your code needs to be tested with it, too...",
    "created_at": "2015-10-30T16:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261514",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:31'></a>Replying to [comment:30 jipilab]:
> The discussion on sage-devel available here:
> 
> https://groups.google.com/forum/#!searchin/sage-devel/barycentric/sage-devel/HubsPplvkE4/gw0avDkWCQAJ
> 
> Led me to only test for rational polytopes. The barycentric subdivision is fast enough on the rationals and will ultimately lead to problems in RDF in any case, therefore I would say it is not necessary to test it.
> 
> I would say it is also not necessary to warn the user, as the user should know that doing such computations in RDF will lead to errors.
> 
> Is that reasonable?
> 
> The current last commit made test pass on sage-6.9.


there is also a backend to work with real algebraic numbers.
(`Polyhedron(...., backend='field'...)`)
I think your code needs to be tested with it, too...



---

archive/issue_comments_261515.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-25T08:54:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261515",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_261516.json:
```json
{
    "body": "<a id='comment:33'></a>I added a test for the field backend.\n\nAll test passed on sage-6.10.beta2. The bot should be fine with beta5 I guess.\n\nNeeds review!",
    "created_at": "2015-11-25T08:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261516",
    "user": "https://github.com/jplab"
}
```

<a id='comment:33'></a>I added a test for the field backend.

All test passed on sage-6.10.beta2. The bot should be fine with beta5 I guess.

Needs review!



---

archive/issue_comments_261517.json:
```json
{
    "body": "<a id='comment:34'></a>looks good to me; I even tried\n\n```\nsage: P = Polyhedron(vertices=[[0,0,0],[0,AA(sqrt(2)),0],[1,0,0],[0,0,1]], backend='field')\nsage: P.barycentric_subdivision(1/AA(sqrt(5)))\nA 3-dimensional polyhedron in AA^3 defined as the convex hull of 14 vertices\n```\nslow, but works...",
    "created_at": "2015-11-25T12:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261517",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:34'></a>looks good to me; I even tried

```
sage: P = Polyhedron(vertices=[[0,0,0],[0,AA(sqrt(2)),0],[1,0,0],[0,0,1]], backend='field')
sage: P.barycentric_subdivision(1/AA(sqrt(5)))
A 3-dimensional polyhedron in AA^3 defined as the convex hull of 14 vertices
```
slow, but works...



---

archive/issue_comments_261518.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-11-25T12:24:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261518",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_051931.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-11-25T23:29:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18442#event-51931"
}
```



---

archive/issue_comments_261519.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-11-25T23:29:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18442",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18442#issuecomment-261519",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
