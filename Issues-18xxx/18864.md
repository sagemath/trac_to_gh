# Issue 18864: New method for the eccentricity of undirected graphs

archive/issues_018627.json:
```json
{
    "body": "This patch implements the algorithm proposed in [1] for computing the eccentricity of all vertices of a connected undirected unweighted graph. It can be faster than the standard algorithm.\n\n```\nsage: from sage.graphs.distances_all_pairs import eccentricity\nsage: G = graphs.PetersenGraph()\nsage: %time _= eccentricity(G, method='standard')\nCPU times: user 299 \u00b5s, sys: 75 \u00b5s, total: 374 \u00b5s\nWall time: 361 \u00b5s\nsage: %time _= eccentricity(G, method='bounds')\nCPU times: user 218 \u00b5s, sys: 29 \u00b5s, total: 247 \u00b5s\nWall time: 235 \u00b5s\nsage: G = graphs.RandomBarabasiAlbert(10000,2)\nsage: %time _= eccentricity(G, method='standard')\nCPU times: user 2.78 s, sys: 7.8 ms, total: 2.78 s\nWall time: 2.79 s\nsage: %time _= eccentricity(G, method='bounds')\nCPU times: user 1.66 s, sys: 8.06 ms, total: 1.67 s\nWall time: 1.67 s\n```\n\nSimilar method for directed graphs and weighted (di)graphs can be the object of future tickets.\n\n---\n[1] F. W. Takes and W. A. Kosters. Computing the eccentricity distribution of large graphs. *Algorithms* 6:100-118 (2013) http://dx.doi.org/10.3390/a6010100\n\nCC:  @nathanncohen borassi\n\nBranch/Commit: [ce9d26556e5b1a69002e1a5165933e51ddfc7c05](https://github.com/sagemath/sagetrac-mirror/commit/ce9d26556e5b1a69002e1a5165933e51ddfc7c05)\n\nReviewer: Michele Borassi\n\nAuthor: David Coudert\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18864\n\n",
    "closed_at": "2015-07-27T15:15:39Z",
    "created_at": "2015-07-07T22:38:35Z",
    "labels": [
        "component: graph theory",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "New method for the eccentricity of undirected graphs",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18864",
    "user": "https://github.com/dcoudert"
}
```
This patch implements the algorithm proposed in [1] for computing the eccentricity of all vertices of a connected undirected unweighted graph. It can be faster than the standard algorithm.

```
sage: from sage.graphs.distances_all_pairs import eccentricity
sage: G = graphs.PetersenGraph()
sage: %time _= eccentricity(G, method='standard')
CPU times: user 299 µs, sys: 75 µs, total: 374 µs
Wall time: 361 µs
sage: %time _= eccentricity(G, method='bounds')
CPU times: user 218 µs, sys: 29 µs, total: 247 µs
Wall time: 235 µs
sage: G = graphs.RandomBarabasiAlbert(10000,2)
sage: %time _= eccentricity(G, method='standard')
CPU times: user 2.78 s, sys: 7.8 ms, total: 2.78 s
Wall time: 2.79 s
sage: %time _= eccentricity(G, method='bounds')
CPU times: user 1.66 s, sys: 8.06 ms, total: 1.67 s
Wall time: 1.67 s
```

Similar method for directed graphs and weighted (di)graphs can be the object of future tickets.

---
[1] F. W. Takes and W. A. Kosters. Computing the eccentricity distribution of large graphs. *Algorithms* 6:100-118 (2013) http://dx.doi.org/10.3390/a6010100

CC:  @nathanncohen borassi

Branch/Commit: [ce9d26556e5b1a69002e1a5165933e51ddfc7c05](https://github.com/sagemath/sagetrac-mirror/commit/ce9d26556e5b1a69002e1a5165933e51ddfc7c05)

Reviewer: Michele Borassi

Author: David Coudert

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18864





---

archive/issue_comments_337038.json:
```json
{
    "body": "Changing branch from \"\" to \"public/18864\"",
    "created_at": "2015-07-07T22:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337038",
    "user": "https://github.com/dcoudert"
}
```

Changing branch from "" to "public/18864"



---

archive/issue_comments_337039.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                             |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|\n|[bb2dd5c](https://github.com/sagemath/sagetrac-mirror/commit/bb2dd5c3860d47e59bb1258df91465f9c22d1281)|`trac #18864: new method for the eccenticity`|",
    "created_at": "2015-07-07T22:40:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337039",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                             |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------|
|[bb2dd5c](https://github.com/sagemath/sagetrac-mirror/commit/bb2dd5c3860d47e59bb1258df91465f9c22d1281)|`trac #18864: new method for the eccenticity`|



---

archive/issue_comments_337040.json:
```json
{
    "body": "Changing commit from \"\" to \"bb2dd5c3860d47e59bb1258df91465f9c22d1281\"",
    "created_at": "2015-07-07T22:40:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337040",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "bb2dd5c3860d47e59bb1258df91465f9c22d1281"



---

archive/issue_comments_337041.json:
```json
{
    "body": "<a id='comment:3'></a>\nLet me know if you like it.\nDavid.",
    "created_at": "2015-07-07T22:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337041",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:3'></a>
Let me know if you like it.
David.



---

archive/issue_comments_337042.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-07-07T22:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337042",
    "user": "https://github.com/dcoudert"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_337043.json:
```json
{
    "body": "<a id='comment:4'></a>\nHello!\n\nCool! Takes and Kosters algorithm! I really like the way it works (since it is also the base of one of my algorithms [1,2]) :)\n\nI have a few doubts about the code:\n\n* if I understood well your code, the starting vertices of the BFSes are chosen in decreasing order of degree. This way, upper bounds are quite good, but lower bounds are not very good, and the running time does not decrease much. Instead, you should alternate between vertices where UB is high and vertices where LB is low (if you want, you can also use degrees as tie-break).\n* do you really need to store vector ecc? Can't it be replaced by LB or UB?\n* I think you should handle separately the case when the graph is not connected. Otherwise, the first visits will start from the giant component, and for each vertex in the giant component the lower bound will be `ecc[v] - distances[w]=INT32_MAX-distances[w]`, and the upper bound will be `INT32_MAX`, so you will need a lot of BFSes, probably, instead of simply returning an array of `INT32_MAX` after the first BFS.\n* `ecc[v] = INT32_MAX if tmp>n else tmp`: I think it is better to use an integer variable named `eccv`, since you use it O(n) times later.\n* you return a vector `ecc` of length `3n`: why don't you use two different vectors for `LB` and `UB`, so that they are freed when the function returns?\n* for i in range(n): UB[i] = INT32_MAX: can't you use memset?\n\nOther, more general, remarks:\n\n* this algorithm can be used to compute the radius (resp. diameter), by stopping as soon as LB is big enough (resp. UB is small enough). I think you could add a flag to stop the execution before, in case only the radius or the diameter is needed.\n* maybe you could add this algorithm to the list of diameter algorithms (see previous remark).\n\n[1] http://www.sciencedirect.com/science/article/pii/S0304397515001644\n\n[2] !http://link.springer.com/chapter/10.1007%2F978-3-319-07890-8_5",
    "created_at": "2015-07-08T17:17:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337043",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:4'></a>
Hello!

Cool! Takes and Kosters algorithm! I really like the way it works (since it is also the base of one of my algorithms [1,2]) :)

I have a few doubts about the code:

* if I understood well your code, the starting vertices of the BFSes are chosen in decreasing order of degree. This way, upper bounds are quite good, but lower bounds are not very good, and the running time does not decrease much. Instead, you should alternate between vertices where UB is high and vertices where LB is low (if you want, you can also use degrees as tie-break).
* do you really need to store vector ecc? Can't it be replaced by LB or UB?
* I think you should handle separately the case when the graph is not connected. Otherwise, the first visits will start from the giant component, and for each vertex in the giant component the lower bound will be `ecc[v] - distances[w]=INT32_MAX-distances[w]`, and the upper bound will be `INT32_MAX`, so you will need a lot of BFSes, probably, instead of simply returning an array of `INT32_MAX` after the first BFS.
* `ecc[v] = INT32_MAX if tmp>n else tmp`: I think it is better to use an integer variable named `eccv`, since you use it O(n) times later.
* you return a vector `ecc` of length `3n`: why don't you use two different vectors for `LB` and `UB`, so that they are freed when the function returns?
* for i in range(n): UB[i] = INT32_MAX: can't you use memset?

Other, more general, remarks:

* this algorithm can be used to compute the radius (resp. diameter), by stopping as soon as LB is big enough (resp. UB is small enough). I think you could add a flag to stop the execution before, in case only the radius or the diameter is needed.
* maybe you could add this algorithm to the list of diameter algorithms (see previous remark).

[1] http://www.sciencedirect.com/science/article/pii/S0304397515001644

[2] !http://link.springer.com/chapter/10.1007%2F978-3-319-07890-8_5



---

archive/issue_comments_337044.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[41a2c87](https://github.com/sagemath/sagetrac-mirror/commit/41a2c879b68e06fd0ab84411f72a4a88b6b183b4)|`trac #18864: implement some reviewers suggestions`|\n|[003b73e](https://github.com/sagemath/sagetrac-mirror/commit/003b73ee0cb4493614412de568aa9f2fb0e58ac8)|`trac #18864: unify types for eccentricity`|",
    "created_at": "2015-07-08T22:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337044",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[41a2c87](https://github.com/sagemath/sagetrac-mirror/commit/41a2c879b68e06fd0ab84411f72a4a88b6b183b4)|`trac #18864: implement some reviewers suggestions`|
|[003b73e](https://github.com/sagemath/sagetrac-mirror/commit/003b73ee0cb4493614412de568aa9f2fb0e58ac8)|`trac #18864: unify types for eccentricity`|



---

archive/issue_comments_337045.json:
```json
{
    "body": "Changing commit from \"bb2dd5c3860d47e59bb1258df91465f9c22d1281\" to \"003b73ee0cb4493614412de568aa9f2fb0e58ac8\"",
    "created_at": "2015-07-08T22:35:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337045",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "bb2dd5c3860d47e59bb1258df91465f9c22d1281" to "003b73ee0cb4493614412de568aa9f2fb0e58ac8"



---

archive/issue_comments_337046.json:
```json
{
    "body": "<a id='comment:6'></a>\n>  * if I understood well your code, the starting vertices of the BFSes are chosen in decreasing order of degree. This way, upper bounds are quite good, but lower bounds are not very good, and the running time does not decrease much. Instead, you should alternate between vertices where UB is high and vertices where LB is low (if you want, you can also use degrees as tie-break).\n \nThis is true, but so far I don't know how to do this efficiently. Any guess?\n \n>  * do you really need to store vector ecc? Can't it be replaced by LB or UB?\n \nDone\n \n>  * I think you should handle separately the case when the graph is not connected. Otherwise, the first visits will start from the giant component, and for each vertex in the giant component the lower bound will be `ecc[v] - distances[w]=INT32_MAX-distances[w]`, and the upper bound will be `INT32_MAX`, so you will need a lot of BFSes, probably, instead of simply returning an array of `INT32_MAX` after the first BFS.\n \nThis is now handled directly in method `eccentricity`, plus I have some easy test in method `c_eccentricity_bounds`.\n \n>  * `ecc[v] = INT32_MAX if tmp>n else tmp`: I think it is better to use an integer variable named `eccv`, since you use it O(n) times later.\n \nSomehow done\n \n>  * you return a vector `ecc` of length `3n`: why don't you use two different vectors for `LB` and `UB`, so that they are freed when the function returns?\n \nNow returning `LB` of length `n`.\n \n>  * for i in range(n): UB[i] = INT32_MAX: can't you use memset?\n \nNow yes since I changed types to uint32_t.\n \n> Other, more general, remarks:\n> \n> * this algorithm can be used to compute the radius (resp. diameter), by stopping as soon as LB is big enough (resp. UB is small enough). I think you could add a flag to stop the execution before, in case only the radius or the diameter is needed.\n> * maybe you could add this algorithm to the list of diameter algorithms (see previous remark).\n\nIs it correct for both graphs and digraphs?\n\nThanks for all the comments.\nDavid.",
    "created_at": "2015-07-08T22:44:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337046",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>
>  * if I understood well your code, the starting vertices of the BFSes are chosen in decreasing order of degree. This way, upper bounds are quite good, but lower bounds are not very good, and the running time does not decrease much. Instead, you should alternate between vertices where UB is high and vertices where LB is low (if you want, you can also use degrees as tie-break).
 
This is true, but so far I don't know how to do this efficiently. Any guess?
 
>  * do you really need to store vector ecc? Can't it be replaced by LB or UB?
 
Done
 
>  * I think you should handle separately the case when the graph is not connected. Otherwise, the first visits will start from the giant component, and for each vertex in the giant component the lower bound will be `ecc[v] - distances[w]=INT32_MAX-distances[w]`, and the upper bound will be `INT32_MAX`, so you will need a lot of BFSes, probably, instead of simply returning an array of `INT32_MAX` after the first BFS.
 
This is now handled directly in method `eccentricity`, plus I have some easy test in method `c_eccentricity_bounds`.
 
>  * `ecc[v] = INT32_MAX if tmp>n else tmp`: I think it is better to use an integer variable named `eccv`, since you use it O(n) times later.
 
Somehow done
 
>  * you return a vector `ecc` of length `3n`: why don't you use two different vectors for `LB` and `UB`, so that they are freed when the function returns?
 
Now returning `LB` of length `n`.
 
>  * for i in range(n): UB[i] = INT32_MAX: can't you use memset?
 
Now yes since I changed types to uint32_t.
 
> Other, more general, remarks:
> 
> * this algorithm can be used to compute the radius (resp. diameter), by stopping as soon as LB is big enough (resp. UB is small enough). I think you could add a flag to stop the execution before, in case only the radius or the diameter is needed.
> * maybe you could add this algorithm to the list of diameter algorithms (see previous remark).

Is it correct for both graphs and digraphs?

Thanks for all the comments.
David.



---

archive/issue_comments_337047.json:
```json
{
    "body": "<a id='comment:7'></a>\n> > * if I understood well your code, the starting vertices of the BFSes are chosen in decreasing order of degree. This way, upper bounds are quite good, but lower bounds are not very good, and the running time does not decrease much. Instead, you should alternate between vertices where UB is high and vertices where LB is low (if you want, you can also use degrees as tie-break).\n> > \n> > \n> > \n> > \n \n> This is true, but so far I don't know how to do this efficiently. Any guess?\n\nYou don't need to. This operation is done at each loop, and each loop performs a BFS (that needs time O(m)), so you can afford to spend time O(n) to find the right vertex. You can do it either when you update bounds, or in a new line, for instance:\n\n```\ncdef uint_32 next = UINT32_MAX\nfor w in W:\n    LB[w] = max(LB[w], max(LB[v] - distances[w], distances[w]))\n    UB[w] = min(UB[w], LB[v] + distances[w])\n    if LB[w]==UB[w]:\n        W.remove(w)\n    else:\n        if next == UINT32_MAX or (iter % 2 == 0 and LB[w] < LB[next]) or (iter % 2 == 1 and UB[w] > UB[next]):\n            next = w\n\n```\nObviously, then you need to replace v = W.pop() with v = next, you need to set next at the beginning (for instance, as the maximum degree vertex), and you have to remove the line where you sort W.\n\n> > Other, more general, remarks:\n> > \n> > * this algorithm can be used to compute the radius (resp. diameter), by stopping as soon as LB is big enough (resp. UB is small enough). I think you could add a flag to stop the execution before, in case only the radius or the diameter is needed.\n> > * maybe you could add this algorithm to the list of diameter algorithms (see previous remark).\n> > \n> > \n> > \n> > \n \n> Is it correct for both graphs and digraphs?\n\nNo, this algorithm only works for graphs. For digraphs, you need [1] in the case of strongly connected digraphs, [2] in general (anyway, if you define the eccentricity of a vertex to be infinite if it cannot reach all other vertices, the general case is easily solvable from the strongly connected case).\n\nIn any case, before running the algorithm, you need to check that the graph is undirected.\n\n> Thanks for all the comments.\n\n\nYou are welcome! Thank you for implementing this nice algorithm!\n\n![1] [\u200bhttp://www.sciencedirect.com/science/article/pii/S0304397515001644](http://www.sciencedirect.com/science/article/pii/S0304397515001644)\n\n![2] !http://link.springer.com/chapter/10.1007%2F978-3-319-07890-8_5",
    "created_at": "2015-07-09T08:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337047",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:7'></a>
> > * if I understood well your code, the starting vertices of the BFSes are chosen in decreasing order of degree. This way, upper bounds are quite good, but lower bounds are not very good, and the running time does not decrease much. Instead, you should alternate between vertices where UB is high and vertices where LB is low (if you want, you can also use degrees as tie-break).
> > 
> > 
> > 
> > 
 
> This is true, but so far I don't know how to do this efficiently. Any guess?

You don't need to. This operation is done at each loop, and each loop performs a BFS (that needs time O(m)), so you can afford to spend time O(n) to find the right vertex. You can do it either when you update bounds, or in a new line, for instance:

```
cdef uint_32 next = UINT32_MAX
for w in W:
    LB[w] = max(LB[w], max(LB[v] - distances[w], distances[w]))
    UB[w] = min(UB[w], LB[v] + distances[w])
    if LB[w]==UB[w]:
        W.remove(w)
    else:
        if next == UINT32_MAX or (iter % 2 == 0 and LB[w] < LB[next]) or (iter % 2 == 1 and UB[w] > UB[next]):
            next = w

```
Obviously, then you need to replace v = W.pop() with v = next, you need to set next at the beginning (for instance, as the maximum degree vertex), and you have to remove the line where you sort W.

> > Other, more general, remarks:
> > 
> > * this algorithm can be used to compute the radius (resp. diameter), by stopping as soon as LB is big enough (resp. UB is small enough). I think you could add a flag to stop the execution before, in case only the radius or the diameter is needed.
> > * maybe you could add this algorithm to the list of diameter algorithms (see previous remark).
> > 
> > 
> > 
> > 
 
> Is it correct for both graphs and digraphs?

No, this algorithm only works for graphs. For digraphs, you need [1] in the case of strongly connected digraphs, [2] in general (anyway, if you define the eccentricity of a vertex to be infinite if it cannot reach all other vertices, the general case is easily solvable from the strongly connected case).

In any case, before running the algorithm, you need to check that the graph is undirected.

> Thanks for all the comments.


You are welcome! Thank you for implementing this nice algorithm!

![1] [​http://www.sciencedirect.com/science/article/pii/S0304397515001644](http://www.sciencedirect.com/science/article/pii/S0304397515001644)

![2] !http://link.springer.com/chapter/10.1007%2F978-3-319-07890-8_5



---

archive/issue_comments_337048.json:
```json
{
    "body": "<a id='comment:8'></a>\nI have implemented a new version of the next node selection.\n\nConcerning the possible use for diameter and centers computation, since I don't know yet how to do it, I prefer to let it for another patch. Also, so far the eccentricity of all the vertices of non (strongly) connected (di)graphs is set to infinity.",
    "created_at": "2015-07-10T09:25:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337048",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>
I have implemented a new version of the next node selection.

Concerning the possible use for diameter and centers computation, since I don't know yet how to do it, I prefer to let it for another patch. Also, so far the eccentricity of all the vertices of non (strongly) connected (di)graphs is set to infinity.



---

archive/issue_comments_337049.json:
```json
{
    "body": "Changing commit from \"003b73ee0cb4493614412de568aa9f2fb0e58ac8\" to \"873f62d1113634784413c7995e6f78cc7221d702\"",
    "created_at": "2015-07-10T09:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337049",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "003b73ee0cb4493614412de568aa9f2fb0e58ac8" to "873f62d1113634784413c7995e6f78cc7221d702"



---

archive/issue_comments_337050.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|\n|[873f62d](https://github.com/sagemath/sagetrac-mirror/commit/873f62d1113634784413c7995e6f78cc7221d702)|`trac #18864: new next vertex selection process`|",
    "created_at": "2015-07-10T09:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337050",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------|
|[873f62d](https://github.com/sagemath/sagetrac-mirror/commit/873f62d1113634784413c7995e6f78cc7221d702)|`trac #18864: new next vertex selection process`|



---

archive/issue_comments_337051.json:
```json
{
    "body": "<a id='comment:10'></a>\nHellooooo!\n\nGreat, now the algorithm should be much faster!\n\nI think there is still a problem with directed graphs: the Takes-Kosters algorithm works only on undirected graphs, so I think you should add a `ValueError` if the user asks the Takes-Kosters algorithm on directed graphs. I would add at the top of c_eccentricity_bounding\n\n```\nif G.is_directed():\n    raise ValueError(\"The bounds method only works on undirected graphs.\")\n\n```\nAfter you correct this, I will try to perform a more extensive testing, and I will provide a positive review!",
    "created_at": "2015-07-10T09:40:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337051",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:10'></a>
Hellooooo!

Great, now the algorithm should be much faster!

I think there is still a problem with directed graphs: the Takes-Kosters algorithm works only on undirected graphs, so I think you should add a `ValueError` if the user asks the Takes-Kosters algorithm on directed graphs. I would add at the top of c_eccentricity_bounding

```
if G.is_directed():
    raise ValueError("The bounds method only works on undirected graphs.")

```
After you correct this, I will try to perform a more extensive testing, and I will provide a positive review!



---

archive/issue_comments_337052.json:
```json
{
    "body": "Changing commit from \"873f62d1113634784413c7995e6f78cc7221d702\" to \"da0260dca9b43d96b47bcae2ba79a2b8819896ec\"",
    "created_at": "2015-07-10T11:41:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337052",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "873f62d1113634784413c7995e6f78cc7221d702" to "da0260dca9b43d96b47bcae2ba79a2b8819896ec"



---

archive/issue_comments_337053.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[da7bad7](https://github.com/sagemath/sagetrac-mirror/commit/da7bad709841e6d77dc089524178011f35ee931e)|`trac #18864: Merged with 6.8.beta8`|\n|[da0260d](https://github.com/sagemath/sagetrac-mirror/commit/da0260dca9b43d96b47bcae2ba79a2b8819896ec)|`trac #18864: prevent using the Takes-Kosters algorithm on digraphs`|",
    "created_at": "2015-07-10T11:41:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337053",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[da7bad7](https://github.com/sagemath/sagetrac-mirror/commit/da7bad709841e6d77dc089524178011f35ee931e)|`trac #18864: Merged with 6.8.beta8`|
|[da0260d](https://github.com/sagemath/sagetrac-mirror/commit/da0260dca9b43d96b47bcae2ba79a2b8819896ec)|`trac #18864: prevent using the Takes-Kosters algorithm on digraphs`|



---

archive/issue_comments_337054.json:
```json
{
    "body": "<a id='comment:12'></a>\nShould be OK now.\nDo you know similar algorithm for digraphs?",
    "created_at": "2015-07-10T11:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337054",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:12'></a>
Should be OK now.
Do you know similar algorithm for digraphs?



---

archive/issue_comments_337055.json:
```json
{
    "body": "<a id='comment:13'></a>\nLittle bug: you set `next_v = W[0]` before computing bounds, but then `W[0]` might be eliminated from `W`, and you end up with a non-existing `next_v`. Example:\n\n```\nsage: from sage.graphs.distances_all_pairs import eccentricity\nsage: tmp = eccentricity(graphs.PathGraph(50), method='bounds')\n---------------------------------------------------------------------------\nValueError\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 Traceback (most recent call last)\n<ipython-input-3-98d52329e964> in <module>()\n----> 1 tmp = eccentricity(g, method='bounds')\n\n/home/michele/Programmi/sage/src/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.eccentricity (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:11580)()\n\u00a0\u00a0\u00a0 891\u00a0\u00a0\u00a0\u00a0 cdef uint32_t * ecc\n\u00a0\u00a0\u00a0 892\u00a0\u00a0\u00a0\u00a0 if method==\"bounds\":\n--> 893\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ecc = c_eccentricity_bounding(G)\n\u00a0\u00a0\u00a0 894\u00a0\u00a0\u00a0\u00a0 elif method==\"standard\":\n\u00a0\u00a0\u00a0 895\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ecc = c_eccentricity(G)\n\n/home/michele/Programmi/sage/src/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.c_eccentricity_bounding (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:10862)()\n\u00a0\u00a0\u00a0 787 \n\u00a0\u00a0\u00a0 788\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 v = next_v\n--> 789\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 W.remove(v)\n\u00a0\u00a0\u00a0 790\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 cpt += 1\n\u00a0\u00a0\u00a0 791 \n\nValueError: list.remove(x): x not in list\n\n```\nMoreover, I don't like that if you ask for the eccentricity of a directed graph, then the default algorithm does not work.\n\n```\nsage: tmp = eccentricity(digraphs.Path(10))\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n<ipython-input-5-f1441926fc79> in <module>()\n----> 1 tmp = eccentricity(digraphs.Path(Integer(10)))\n\n/home/michele/Programmi/sage/src/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.eccentricity (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:11449)()\n    883     elif G.is_directed():\n    884         if method=='bounds':\n--> 885             raise ValueError(\"The 'bounds' method only works on undirected graphs.\")\n    886         elif not G.is_strongly_connected():\n    887             return [Infinity]*n\n\nValueError: The 'bounds' method only works on undirected graphs.\n\n```\nApart from these, build is OK, documentation is OK, and I still have to perform all tests (tests from this package are OK).\n\nHave fuuuuuuuuuuuun!\n\nMichele",
    "created_at": "2015-07-10T14:07:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337055",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:13'></a>
Little bug: you set `next_v = W[0]` before computing bounds, but then `W[0]` might be eliminated from `W`, and you end up with a non-existing `next_v`. Example:

```
sage: from sage.graphs.distances_all_pairs import eccentricity
sage: tmp = eccentricity(graphs.PathGraph(50), method='bounds')
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-3-98d52329e964> in <module>()
----> 1 tmp = eccentricity(g, method='bounds')

/home/michele/Programmi/sage/src/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.eccentricity (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:11580)()
    891     cdef uint32_t * ecc
    892     if method=="bounds":
--> 893         ecc = c_eccentricity_bounding(G)
    894     elif method=="standard":
    895         ecc = c_eccentricity(G)

/home/michele/Programmi/sage/src/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.c_eccentricity_bounding (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:10862)()
    787 
    788         v = next_v
--> 789         W.remove(v)
    790         cpt += 1
    791 

ValueError: list.remove(x): x not in list

```
Moreover, I don't like that if you ask for the eccentricity of a directed graph, then the default algorithm does not work.

```
sage: tmp = eccentricity(digraphs.Path(10))
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
<ipython-input-5-f1441926fc79> in <module>()
----> 1 tmp = eccentricity(digraphs.Path(Integer(10)))

/home/michele/Programmi/sage/src/sage/graphs/distances_all_pairs.pyx in sage.graphs.distances_all_pairs.eccentricity (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:11449)()
    883     elif G.is_directed():
    884         if method=='bounds':
--> 885             raise ValueError("The 'bounds' method only works on undirected graphs.")
    886         elif not G.is_strongly_connected():
    887             return [Infinity]*n

ValueError: The 'bounds' method only works on undirected graphs.

```
Apart from these, build is OK, documentation is OK, and I still have to perform all tests (tests from this package are OK).

Have fuuuuuuuuuuuun!

Michele



---

archive/issue_comments_337056.json:
```json
{
    "body": "<a id='comment:14'></a>\nSorry, I forgot a few things:\n\n```\nsage: eccentricity(digraphs.Path(2), method='standard')\n[+Infinity, +Infinity]\n\n```\nI think that the eccentricity of the first vertex should be 1.\n\n> Do you know similar algorithm for digraphs?\n\n\nYep, the papers [1,2] from previous comments generalize this method to directed graphs (actually, they stop the computation as soon as diameter and radius are found, but they work also to compute all eccentricities). Intuitively, if the directed graph is strongly connected, you keep forward and backward eccentricities for all vertices (backward eccentricity means eccentricity in the reverse graph). Then, you need four bounds (UF, LF, UB, LB for forward and backward eccentricity, respectively), and at each step you perform a forward and backward visit from v. Then, you bound\n\nUF[w] = d(w,v)+eccF(v)\n\nLF[w] = max(d(w,v), eccF(v)-d(v, w))\n\nUB[w] = eccB(v)+d(v,w)\n\nLB[w] = max(d(w,v), eccB(v)-d(w,v)).\n\nThe remainder of the algorithm is quite similar to the existing one.\n\nIf you want to implement also the directed algorithm, or if this \"intuitive idea\" is not clear, please ask and I will provide more details.",
    "created_at": "2015-07-10T14:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337056",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:14'></a>
Sorry, I forgot a few things:

```
sage: eccentricity(digraphs.Path(2), method='standard')
[+Infinity, +Infinity]

```
I think that the eccentricity of the first vertex should be 1.

> Do you know similar algorithm for digraphs?


Yep, the papers [1,2] from previous comments generalize this method to directed graphs (actually, they stop the computation as soon as diameter and radius are found, but they work also to compute all eccentricities). Intuitively, if the directed graph is strongly connected, you keep forward and backward eccentricities for all vertices (backward eccentricity means eccentricity in the reverse graph). Then, you need four bounds (UF, LF, UB, LB for forward and backward eccentricity, respectively), and at each step you perform a forward and backward visit from v. Then, you bound

UF[w] = d(w,v)+eccF(v)

LF[w] = max(d(w,v), eccF(v)-d(v, w))

UB[w] = eccB(v)+d(v,w)

LB[w] = max(d(w,v), eccB(v)-d(w,v)).

The remainder of the algorithm is quite similar to the existing one.

If you want to implement also the directed algorithm, or if this "intuitive idea" is not clear, please ask and I will provide more details.



---

archive/issue_comments_337057.json:
```json
{
    "body": "Changing commit from \"da0260dca9b43d96b47bcae2ba79a2b8819896ec\" to \"554c5099f8b47cef74a13cd968223c9288264424\"",
    "created_at": "2015-07-10T14:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337057",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "da0260dca9b43d96b47bcae2ba79a2b8819896ec" to "554c5099f8b47cef74a13cd968223c9288264424"



---

archive/issue_comments_337058.json:
```json
{
    "body": "<a id='comment:15'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[554c509](https://github.com/sagemath/sagetrac-mirror/commit/554c5099f8b47cef74a13cd968223c9288264424)|`trac #18864: implement reviewer's comments`|",
    "created_at": "2015-07-10T14:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337058",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[554c509](https://github.com/sagemath/sagetrac-mirror/commit/554c5099f8b47cef74a13cd968223c9288264424)|`trac #18864: implement reviewer's comments`|



---

archive/issue_comments_337059.json:
```json
{
    "body": "Changing commit from \"554c5099f8b47cef74a13cd968223c9288264424\" to \"f48a33e012a0187ceea3b3011909342dc5cb1375\"",
    "created_at": "2015-07-10T15:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337059",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "554c5099f8b47cef74a13cd968223c9288264424" to "f48a33e012a0187ceea3b3011909342dc5cb1375"



---

archive/issue_comments_337060.json:
```json
{
    "body": "<a id='comment:16'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[f48a33e](https://github.com/sagemath/sagetrac-mirror/commit/f48a33e012a0187ceea3b3011909342dc5cb1375)|`trac #18864: minor corrections`|",
    "created_at": "2015-07-10T15:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337060",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[f48a33e](https://github.com/sagemath/sagetrac-mirror/commit/f48a33e012a0187ceea3b3011909342dc5cb1375)|`trac #18864: minor corrections`|



---

archive/issue_comments_337061.json:
```json
{
    "body": "Changing commit from \"f48a33e012a0187ceea3b3011909342dc5cb1375\" to \"a3717b73c811ff702345a186b679df4b99e725fa\"",
    "created_at": "2015-07-10T15:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337061",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f48a33e012a0187ceea3b3011909342dc5cb1375" to "a3717b73c811ff702345a186b679df4b99e725fa"



---

archive/issue_comments_337062.json:
```json
{
    "body": "<a id='comment:17'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|\n|[a3717b7](https://github.com/sagemath/sagetrac-mirror/commit/a3717b73c811ff702345a186b679df4b99e725fa)|`trac #18864: improve behavior with directed graphs`|",
    "created_at": "2015-07-10T15:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337062",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------|
|[a3717b7](https://github.com/sagemath/sagetrac-mirror/commit/a3717b73c811ff702345a186b679df4b99e725fa)|`trac #18864: improve behavior with directed graphs`|



---

archive/issue_events_059928.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "rename": {
        "from": "New method for the eccentricity",
        "to": "New method for the eccentricity of undirected graphs"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18864#event-59928"
}
```



---

archive/issue_comments_337063.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-This patch implements the algorithm proposed in [1] for computing the eccentricity of all vertices. It can be faster than the standard algorithm.\n+This patch implements the algorithm proposed in [1] for computing the eccentricity of all vertices of a connected undirected unweighted graph. It can be faster than the standard algorithm.\n \n ```\n sage: from sage.graphs.distances_all_pairs import eccentricity\n@@ -18,5 +18,7 @@\n Wall time: 1.67 s\n ```\n \n+Similar method for directed graphs and weighted (di)graphs can be the object of future tickets.\n \n+---\n [1] F. W. Takes and W. A. Kosters. Computing the eccentricity distribution of large graphs. *Algorithms* 6:100-118 (2013) http://dx.doi.org/10.3390/a6010100\n``````\n",
    "created_at": "2015-07-10T15:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337063",
    "user": "https://github.com/dcoudert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-This patch implements the algorithm proposed in [1] for computing the eccentricity of all vertices. It can be faster than the standard algorithm.
+This patch implements the algorithm proposed in [1] for computing the eccentricity of all vertices of a connected undirected unweighted graph. It can be faster than the standard algorithm.
 
 ```
 sage: from sage.graphs.distances_all_pairs import eccentricity
@@ -18,5 +18,7 @@
 Wall time: 1.67 s
 ```
 
+Similar method for directed graphs and weighted (di)graphs can be the object of future tickets.
 
+---
 [1] F. W. Takes and W. A. Kosters. Computing the eccentricity distribution of large graphs. *Algorithms* 6:100-118 (2013) http://dx.doi.org/10.3390/a6010100
``````




---

archive/issue_comments_337064.json:
```json
{
    "body": "<a id='comment:18'></a>\nI have implemented requested changes.\nHowever, I propose to restrict this patch to undirected graph and to consider directed graphs in another ticket.\nBest,\nDavid.",
    "created_at": "2015-07-10T15:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337064",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:18'></a>
I have implemented requested changes.
However, I propose to restrict this patch to undirected graph and to consider directed graphs in another ticket.
Best,
David.



---

archive/issue_comments_337065.json:
```json
{
    "body": "<a id='comment:19'></a>\nI absolutely agree to put the directed case in another ticket, because it is much more complicated.\n\nUnfortunately, there is still a bug... When you iterate over W (line 807), inside the loop you modify W, and the loop does not work, anymore. For instance:\n\n```\n17:57:03 michele@Lena:~/Programmi/sage$ ./sage -t src/sage/graphs/generic_graph.py\ntoo many failed tests, not using stored timings\nRunning doctests with ID 2015-07-12-17-57-08-078c3900.\nGit branch: t/18864/public/18864\nUsing --optional=mpir,python2,sage,scons\nDoctesting 1 file.\nsage -t src/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 12685, in sage.graphs.generic_graph.GenericGraph.eccentricity\nFailed example:\n    G.eccentricity()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/michele/Programmi/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/michele/Programmi/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.graphs.generic_graph.GenericGraph.eccentricity[1]>\", line 1, in <module>\n        G.eccentricity()\n      File \"/home/michele/Programmi/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py\", line 12712, in eccentricity\n        return eccentricity(self, method='standard' if self.is_directed() else 'bounds')\n      File \"sage/graphs/distances_all_pairs.pyx\", line 899, in sage.graphs.distances_all_pairs.eccentricity (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:11517)\n        ecc = c_eccentricity_bounding(G)\n      File \"sage/graphs/distances_all_pairs.pyx\", line 789, in sage.graphs.distances_all_pairs.c_eccentricity_bounding (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:10860)\n        W.remove(v)\n    ValueError: list.remove(x): x not in list\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 12704, in sage.graphs.generic_graph.GenericGraph.eccentricity\nFailed example:\n    sig_on_count() # check sig_on/off pairings (virtual doctest)\nExpected:\n    0\nGot:\n    1\n**********************************************************************\n1 item had failures:\n   2 of  13 in sage.graphs.generic_graph.GenericGraph.eccentricity\n    [2666 tests, 2 failures, 18.28 s]\n----------------------------------------------------------------------\nsage -t src/sage/graphs/generic_graph.py  # 2 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 18.9 seconds\n    cpu time: 16.9 seconds\n    cumulative wall time: 18.3 seconds\n\n```\nAnother correction in the documentation:\n\n```\n\u00a0\u00a0\u00a0 INPUT:\n\n\u00a0\u00a0\u00a0 - ``G`` -- a Graph or a DiGraph.\n\n\u00a0\u00a0\u00a0 - ``method`` -- (default: 'standard') name of the method used to compute the\n\u00a0\u00a0\u00a0\u00a0\u00a0 eccentricity of the vertices. Available methods are `'standard'` which\n\u00a0\u00a0\u00a0\u00a0\u00a0 performs a BFS from each vertex and `'bounds'` which uses the fast\n\u00a0\u00a0\u00a0\u00a0\u00a0 algorithm proposed in [TK13]_ for undirected graphs.\n\n\u00a0\u00a0\u00a0 EXAMPLE:\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sage: from sage.graphs.distances_all_pairs import eccentricity\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sage: g = graphs.PetersenGraph()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sage: eccentricity(g)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 [2, 2, 2, 2, 2, 2, 2, 2, 2, 2]\n\n```\nI think you should write `EXAMPLE::` instead of `EXAMPLE:`. Since we are already here, I would also add ```` instead of ``` in the name of the possible methods (standard, bounds). The modification should be as follows.\n\n```\n``method`` -- (default: ``'standard'``) name of the method used to compute the\n\u00a0\u00a0\u00a0\u00a0\u00a0 eccentricity of the vertices. Available methods are ``'standard'`` which\n\u00a0\u00a0\u00a0\u00a0\u00a0 performs a BFS from each vertex and ``'bounds'`` which uses the fast\n\u00a0\u00a0\u00a0\u00a0\u00a0 algorithm proposed in [TK13]_ for undirected graphs.\n```",
    "created_at": "2015-07-12T15:59:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337065",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:19'></a>
I absolutely agree to put the directed case in another ticket, because it is much more complicated.

Unfortunately, there is still a bug... When you iterate over W (line 807), inside the loop you modify W, and the loop does not work, anymore. For instance:

```
17:57:03 michele@Lena:~/Programmi/sage$ ./sage -t src/sage/graphs/generic_graph.py
too many failed tests, not using stored timings
Running doctests with ID 2015-07-12-17-57-08-078c3900.
Git branch: t/18864/public/18864
Using --optional=mpir,python2,sage,scons
Doctesting 1 file.
sage -t src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 12685, in sage.graphs.generic_graph.GenericGraph.eccentricity
Failed example:
    G.eccentricity()
Exception raised:
    Traceback (most recent call last):
      File "/home/michele/Programmi/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/michele/Programmi/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.graphs.generic_graph.GenericGraph.eccentricity[1]>", line 1, in <module>
        G.eccentricity()
      File "/home/michele/Programmi/sage/local/lib/python2.7/site-packages/sage/graphs/generic_graph.py", line 12712, in eccentricity
        return eccentricity(self, method='standard' if self.is_directed() else 'bounds')
      File "sage/graphs/distances_all_pairs.pyx", line 899, in sage.graphs.distances_all_pairs.eccentricity (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:11517)
        ecc = c_eccentricity_bounding(G)
      File "sage/graphs/distances_all_pairs.pyx", line 789, in sage.graphs.distances_all_pairs.c_eccentricity_bounding (/home/michele/Programmi/sage/src/build/cythonized/sage/graphs/distances_all_pairs.c:10860)
        W.remove(v)
    ValueError: list.remove(x): x not in list
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 12704, in sage.graphs.generic_graph.GenericGraph.eccentricity
Failed example:
    sig_on_count() # check sig_on/off pairings (virtual doctest)
Expected:
    0
Got:
    1
**********************************************************************
1 item had failures:
   2 of  13 in sage.graphs.generic_graph.GenericGraph.eccentricity
    [2666 tests, 2 failures, 18.28 s]
----------------------------------------------------------------------
sage -t src/sage/graphs/generic_graph.py  # 2 doctests failed
----------------------------------------------------------------------
Total time for all tests: 18.9 seconds
    cpu time: 16.9 seconds
    cumulative wall time: 18.3 seconds

```
Another correction in the documentation:

```
    INPUT:

    - ``G`` -- a Graph or a DiGraph.

    - ``method`` -- (default: 'standard') name of the method used to compute the
      eccentricity of the vertices. Available methods are `'standard'` which
      performs a BFS from each vertex and `'bounds'` which uses the fast
      algorithm proposed in [TK13]_ for undirected graphs.

    EXAMPLE:

        sage: from sage.graphs.distances_all_pairs import eccentricity
        sage: g = graphs.PetersenGraph()
        sage: eccentricity(g)
        [2, 2, 2, 2, 2, 2, 2, 2, 2, 2]

```
I think you should write `EXAMPLE::` instead of `EXAMPLE:`. Since we are already here, I would also add ```` instead of ``` in the name of the possible methods (standard, bounds). The modification should be as follows.

```
``method`` -- (default: ``'standard'``) name of the method used to compute the
      eccentricity of the vertices. Available methods are ``'standard'`` which
      performs a BFS from each vertex and ``'bounds'`` which uses the fast
      algorithm proposed in [TK13]_ for undirected graphs.
```



---

archive/issue_comments_337066.json:
```json
{
    "body": "<a id='comment:20'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|\n|[f621777](https://github.com/sagemath/sagetrac-mirror/commit/f621777db49299ce66bf8663795ad79453d4e43e)|`trac #18864: corrections and improved doc`|",
    "created_at": "2015-07-13T08:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337066",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:20'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------|
|[f621777](https://github.com/sagemath/sagetrac-mirror/commit/f621777db49299ce66bf8663795ad79453d4e43e)|`trac #18864: corrections and improved doc`|



---

archive/issue_comments_337067.json:
```json
{
    "body": "Changing commit from \"a3717b73c811ff702345a186b679df4b99e725fa\" to \"f621777db49299ce66bf8663795ad79453d4e43e\"",
    "created_at": "2015-07-13T08:35:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337067",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "a3717b73c811ff702345a186b679df4b99e725fa" to "f621777db49299ce66bf8663795ad79453d4e43e"



---

archive/issue_comments_337068.json:
```json
{
    "body": "<a id='comment:21'></a>\nHello Michele,\n\nI have implemented your suggestions. In particular I'm no longer using list W but a bitset instead.\n\nBest.",
    "created_at": "2015-07-13T08:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337068",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:21'></a>
Hello Michele,

I have implemented your suggestions. In particular I'm no longer using list W but a bitset instead.

Best.



---

archive/issue_comments_337069.json:
```json
{
    "body": "<a id='comment:22'></a>\nHello!\n\nI am a bit puzzled by the use of bitset (probably because I know very little about it). You use the same bitset both for the BFS and to keep track of vertices in W. Hence, if the graph is connected, when you perform `while w!=-1:` the bitset contains everything and you iterate over all vertices. Why don't you simply use `for w in range(n):`? You can then replace the outer while loop with `while next_v!=UINT32_MAX:`, I think.\n\nOtherwise, maybe you should use two different bitsets.\n\nAm I missing something?\n\nMichele",
    "created_at": "2015-07-13T09:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337069",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:22'></a>
Hello!

I am a bit puzzled by the use of bitset (probably because I know very little about it). You use the same bitset both for the BFS and to keep track of vertices in W. Hence, if the graph is connected, when you perform `while w!=-1:` the bitset contains everything and you iterate over all vertices. Why don't you simply use `for w in range(n):`? You can then replace the outer while loop with `while next_v!=UINT32_MAX:`, I think.

Otherwise, maybe you should use two different bitsets.

Am I missing something?

Michele



---

archive/issue_comments_337070.json:
```json
{
    "body": "Changing commit from \"f621777db49299ce66bf8663795ad79453d4e43e\" to \"80cb89935d8eb8288d6659d7c73d8c05ee1c9411\"",
    "created_at": "2015-07-13T09:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337070",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "f621777db49299ce66bf8663795ad79453d4e43e" to "80cb89935d8eb8288d6659d7c73d8c05ee1c9411"



---

archive/issue_comments_337071.json:
```json
{
    "body": "<a id='comment:23'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n|[80cb899](https://github.com/sagemath/sagetrac-mirror/commit/80cb89935d8eb8288d6659d7c73d8c05ee1c9411)|`trac #18864: correct version`|",
    "created_at": "2015-07-13T09:39:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337071",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                              |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
|[80cb899](https://github.com/sagemath/sagetrac-mirror/commit/80cb89935d8eb8288d6659d7c73d8c05ee1c9411)|`trac #18864: correct version`|



---

archive/issue_comments_337072.json:
```json
{
    "body": "<a id='comment:24'></a>\nYou are perfectly right. Not well awaken today...",
    "created_at": "2015-07-13T09:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337072",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:24'></a>
You are perfectly right. Not well awaken today...



---

archive/issue_comments_337073.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-07-13T15:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337073",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_337074.json:
```json
{
    "body": "<a id='comment:25'></a>\nOk, for me now the patch is good to go.\n\nI have run the doctest for the whole Sage, and I got an error, but it is probably not related to this ticket.\n\n```\nsage -t --long src/sage/interfaces/expect.py\n**********************************************************************\nFile \"src/sage/interfaces/expect.py\", line 825, in sage.interfaces.expect.Expect._eval_line\nFailed example:\n\u00a0\u00a0\u00a0 singular.interrupt(timeout=3)\u00a0 # sometimes very slow (up to 60s on sage.math, 2012)\nExpected:\n\u00a0\u00a0\u00a0 False\nGot:\n\u00a0\u00a0\u00a0 True\n**********************************************************************\n\n```\nIndeed, I run again the same doctest and it worked.\n\nLast thing: if you have time, you just wrote\n\n```\nif LB[w]==UB[w]:\n\u00a0\u00a0\u00a0 continue\nelif ...\n    do something\n```\nMaybe it is better to write\n\n```\nif LB[w]==UB[w] and (...):\n\u00a0\u00a0\u00a0 do something\n\n```\nAnyway, I think you can also leave it as it is.\n\nThank you very much, David!",
    "created_at": "2015-07-13T15:03:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337074",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:25'></a>
Ok, for me now the patch is good to go.

I have run the doctest for the whole Sage, and I got an error, but it is probably not related to this ticket.

```
sage -t --long src/sage/interfaces/expect.py
**********************************************************************
File "src/sage/interfaces/expect.py", line 825, in sage.interfaces.expect.Expect._eval_line
Failed example:
    singular.interrupt(timeout=3)  # sometimes very slow (up to 60s on sage.math, 2012)
Expected:
    False
Got:
    True
**********************************************************************

```
Indeed, I run again the same doctest and it worked.

Last thing: if you have time, you just wrote

```
if LB[w]==UB[w]:
    continue
elif ...
    do something
```
Maybe it is better to write

```
if LB[w]==UB[w] and (...):
    do something

```
Anyway, I think you can also leave it as it is.

Thank you very much, David!



---

archive/issue_comments_337075.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Michele Borassi\"",
    "created_at": "2015-07-13T15:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337075",
    "user": "https://github.com/dcoudert"
}
```

Changing reviewer from "" to "Michele Borassi"



---

archive/issue_comments_337076.json:
```json
{
    "body": "<a id='comment:26'></a>\nThanks for the review.\nI have added your name as a reviewer (mandatory).\n\nWhen `LB[w]==UB[w]`, we don't want to change `next_v`. So the `continue` statement seems appropriate. The alternative is to have `if LB[w]!=UB[w] and (next_v==UINT32_MAX or (cpt%2==0 and LB[w]<LB[next_v]) or (cpt%2==1 and UB[w]>UB[next_v])):` which is harder to read.",
    "created_at": "2015-07-13T15:18:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337076",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:26'></a>
Thanks for the review.
I have added your name as a reviewer (mandatory).

When `LB[w]==UB[w]`, we don't want to change `next_v`. So the `continue` statement seems appropriate. The alternative is to have `if LB[w]!=UB[w] and (next_v==UINT32_MAX or (cpt%2==0 and LB[w]<LB[next_v]) or (cpt%2==1 and UB[w]>UB[next_v])):` which is harder to read.



---

archive/issue_comments_337077.json:
```json
{
    "body": "<a id='comment:27'></a>\nCan you guys settle on a pattern where you return Sage integers everywhere? Not only would that then work on 32-bit as well, it would also give Sage a consistent user interface. `graph.radius().factor()` should just work.\n\n```\nsage -t --long src/sage/graphs/distances_all_pairs.pyx\n**********************************************************************\nFile \"src/sage/graphs/distances_all_pairs.pyx\", line 835, in sage.graphs.distances_all_pairs.eccentricity\nFailed example:\n    eccentricity(g)\nExpected:\n    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2]\nGot:\n    [2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L]\n**********************************************************************\nFile \"src/sage/graphs/distances_all_pairs.pyx\", line 854, in sage.graphs.distances_all_pairs.eccentricity\nFailed example:\n    eccentricity(g, method='standard')\nExpected:\n    [2, +Infinity, +Infinity]\nGot:\n    [2L, +Infinity, +Infinity]\n**********************************************************************\n1 item had failures:\n   2 of  18 in sage.graphs.distances_all_pairs.eccentricity\n    [82 tests, 2 failures, 0.20 s]\nsage -t --long src/sage/graphs/dot2tex_utils.py\n    [4 tests, 0.06 s]\nsage -t --long src/sage/graphs/generators/__init__.py\n    [0 tests, 0.00 s]\nsage -t --long src/sage/graphs/generators/basic.py\n**********************************************************************\nFile \"src/sage/graphs/generators/basic.py\", line 60, in sage.graphs.generators.basic.BullGraph\nFailed example:\n    g.radius(); g.diameter(); g.girth()\nExpected:\n    2\n    3\n    3\nGot:\n    2L\n    3\n    3\n**********************************************************************\nFile \"src/sage/graphs/generators/basic.py\", line 130, in sage.graphs.generators.basic.ButterflyGraph\nFailed example:\n    G.radius()\nExpected:\n    1\nGot:\n    1L\n**********************************************************************\n2 items had failures:\n   1 of  14 in sage.graphs.generators.basic.BullGraph\n   1 of  11 in sage.graphs.generators.basic.ButterflyGraph\n    [191 tests, 2 failures, 16.25 s]\nsage -t --long src/sage/graphs/digraph_generators.py\n    [81 tests, 5.09 s]\nsage -t --long src/sage/graphs/generators/chessboard.py\n    [44 tests, 1.04 s]\nsage -t --long src/sage/graphs/generators/degree_sequence.py\n    [23 tests, 1.11 s]\nsage -t --long src/sage/geometry/triangulation/point_configuration.py\n    [202 tests, 23.07 s]\nsage -t --long src/sage/graphs/generators/intersection.py\n    [71 tests, 0.35 s]\nsage -t --long src/sage/graphs/generators/platonic_solids.py\n    [44 tests, 4.55 s]\nsage -t --long src/sage/graphs/generators/families.py\n**********************************************************************\nFile \"src/sage/graphs/generators/families.py\", line 815, in sage.graphs.generators.families.FriendshipGraph\nFailed example:\n    G.radius()\nExpected:\n    1\nGot:\n    1L\n**********************************************************************\n1 item had failures:\n   1 of  22 in sage.graphs.generators.families.FriendshipGraph\n    [250 tests, 1 failure, 22.30 s]\nsage -t --long src/sage/geometry/triangulation/base.pyx\n    [171 tests, 35.66 s]\nsage -t --long src/sage/graphs/generators/world_map.py\n    [4 tests, 0.01 s]\nsage -t --long src/sage/graphs/generators/random.py\n    [71 tests, 5.22 s]\nsage -t --long src/sage/graphs/generic_graph_pyx.pxd\n    [0 tests, 0.00 s]\nsage -t --long src/sage/graphs/generic_graph_pyx.pyx\n    [79 tests, 2.49 s]\nsage -t --long src/sage/graphs/generators/smallgraphs.py\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 1302, in sage.graphs.generators.smallgraphs.BrinkmannGraph\nFailed example:\n    G.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 1650, in sage.graphs.generators.smallgraphs.MeredithGraph\nFailed example:\n    g.radius()\nExpected:\n    7\nGot:\n    7L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 1701, in sage.graphs.generators.smallgraphs.KittellGraph\nFailed example:\n    g.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 1808, in sage.graphs.generators.smallgraphs.ChvatalGraph\nFailed example:\n    G.radius(); G.diameter(); G.girth()\nExpected:\n    2\n    2\n    4\nGot:\n    2L\n    2\n    4\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 2058, in sage.graphs.generators.smallgraphs.DyckGraph\nFailed example:\n    G.radius()\nExpected:\n    5\nGot:\n    5L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 2129, in sage.graphs.generators.smallgraphs.HortonGraph\nFailed example:\n    g.radius()\nExpected:\n    10\nGot:\n    10L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 2372, in sage.graphs.generators.smallgraphs.ErreraGraph\nFailed example:\n    G.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 2581, in sage.graphs.generators.smallgraphs.FranklinGraph\nFailed example:\n    G.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 2697, in sage.graphs.generators.smallgraphs.GoldnerHararyGraph\nFailed example:\n    G.radius()\nExpected:\n    2\nGot:\n    2L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 2821, in sage.graphs.generators.smallgraphs.GrotzschGraph\nFailed example:\n    G.radius()\nExpected:\n    2\nGot:\n    2L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 2943, in sage.graphs.generators.smallgraphs.HerschelGraph\nFailed example:\n    G.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 3257, in sage.graphs.generators.smallgraphs.HoffmanGraph\nFailed example:\n    g.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 3306, in sage.graphs.generators.smallgraphs.HoltGraph\nFailed example:\n    g.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 3835, in sage.graphs.generators.smallgraphs.MoserSpindle\nFailed example:\n    G.radius()\nExpected:\n    2\nGot:\n    2L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 4150, in sage.graphs.generators.smallgraphs.ShrikhandeGraph\nFailed example:\n    G.radius()\nExpected:\n    2\nGot:\n    2L\n**********************************************************************\nFile \"src/sage/graphs/generators/smallgraphs.py\", line 4294, in sage.graphs.generators.smallgraphs.SousselierGraph\nFailed example:\n    g.radius()\nExpected:\n    2\nGot:\n    2L\n**********************************************************************\n16 items had failures:\n   1 of  14 in sage.graphs.generators.smallgraphs.BrinkmannGraph\n   1 of   9 in sage.graphs.generators.smallgraphs.ChvatalGraph\n   1 of  15 in sage.graphs.generators.smallgraphs.DyckGraph\n   1 of  14 in sage.graphs.generators.smallgraphs.ErreraGraph\n   1 of  13 in sage.graphs.generators.smallgraphs.FranklinGraph\n   1 of  12 in sage.graphs.generators.smallgraphs.GoldnerHararyGraph\n   1 of  12 in sage.graphs.generators.smallgraphs.GrotzschGraph\n   1 of  13 in sage.graphs.generators.smallgraphs.HerschelGraph\n   1 of   7 in sage.graphs.generators.smallgraphs.HoffmanGraph\n   1 of  10 in sage.graphs.generators.smallgraphs.HoltGraph\n   1 of   9 in sage.graphs.generators.smallgraphs.HortonGraph\n   1 of   8 in sage.graphs.generators.smallgraphs.KittellGraph\n   1 of  10 in sage.graphs.generators.smallgraphs.MeredithGraph\n   1 of  12 in sage.graphs.generators.smallgraphs.MoserSpindle\n   1 of  15 in sage.graphs.generators.smallgraphs.ShrikhandeGraph\n   1 of  10 in sage.graphs.generators.smallgraphs.SousselierGraph\n    [541 tests, 16 failures, 25.01 s]\nsage -t --long src/sage/graphs/genus.pyx\n    [52 tests, 13.20 s]\nsage -t --long src/sage/graphs/graph_coloring.py\n    [75 tests, 3.86 s]\nsage -t --long src/sage/graphs/graph_database.py\n    [56 tests, 0.16 s]\nsage -t --long src/sage/graphs/graph_decompositions/__init__.py\n    [0 tests, 0.00 s]\nsage -t --long src/sage/graphs/graph_decompositions/bandwidth.pyx\n    [14 tests, 0.07 s]\nsage -t --long src/sage/graphs/graph.py\n    [669 tests, 13.92 s]\nsage -t --long src/sage/graphs/graph_decompositions/fast_digraph.pxd\n    [0 tests, 0.00 s]\nsage -t --long src/sage/graphs/graph_decompositions/fast_digraph.pyx\n    [1 test, 0.00 s]\nsage -t --long src/sage/graphs/graph_decompositions/graph_products.pyx\n    [15 tests, 0.07 s]\nsage -t --long src/sage/graphs/graph_decompositions/rankwidth.pxd\n    [0 tests, 0.00 s]\nsage -t --long src/sage/graphs/graph_decompositions/rankwidth.pyx\n    [23 tests, 0.03 s]\nsage -t --long src/sage/graphs/graph_decompositions/vertex_separation.pxd\n    [0 tests, 0.00 s]\nsage -t --long src/sage/graphs/generic_graph.py\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 12686, in sage.graphs.generic_graph.GenericGraph.eccentricity\nFailed example:\n    G.eccentricity()\nExpected:\n    [4, 4, 4, 4, 4, 3, 3, 2, 3, 4]\nGot:\n    [4L, 4L, 4L, 4L, 4L, 3L, 3L, 2L, 3L, 4L]\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 12700, in sage.graphs.generic_graph.GenericGraph.eccentricity\nFailed example:\n    G.eccentricity(with_labels=True)\nExpected:\n    {0: 0}\nGot:\n    {0: 0L}\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 12753, in sage.graphs.generic_graph.GenericGraph.radius\nFailed example:\n    G.radius()\nExpected:\n    3\nGot:\n    3L\n**********************************************************************\nFile \"src/sage/graphs/generic_graph.py\", line 12761, in sage.graphs.generic_graph.GenericGraph.radius\nFailed example:\n    G.radius()\nExpected:\n    2\nGot:\n    2L\n**********************************************************************\n2 items had failures:\n   2 of  13 in sage.graphs.generic_graph.GenericGraph.eccentricity\n   2 of   9 in sage.graphs.generic_graph.GenericGraph.radius\n    [2707 tests, 4 failures, 52.37 s]\n```",
    "created_at": "2015-07-14T07:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337077",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:27'></a>
Can you guys settle on a pattern where you return Sage integers everywhere? Not only would that then work on 32-bit as well, it would also give Sage a consistent user interface. `graph.radius().factor()` should just work.

```
sage -t --long src/sage/graphs/distances_all_pairs.pyx
**********************************************************************
File "src/sage/graphs/distances_all_pairs.pyx", line 835, in sage.graphs.distances_all_pairs.eccentricity
Failed example:
    eccentricity(g)
Expected:
    [2, 2, 2, 2, 2, 2, 2, 2, 2, 2]
Got:
    [2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L, 2L]
**********************************************************************
File "src/sage/graphs/distances_all_pairs.pyx", line 854, in sage.graphs.distances_all_pairs.eccentricity
Failed example:
    eccentricity(g, method='standard')
Expected:
    [2, +Infinity, +Infinity]
Got:
    [2L, +Infinity, +Infinity]
**********************************************************************
1 item had failures:
   2 of  18 in sage.graphs.distances_all_pairs.eccentricity
    [82 tests, 2 failures, 0.20 s]
sage -t --long src/sage/graphs/dot2tex_utils.py
    [4 tests, 0.06 s]
sage -t --long src/sage/graphs/generators/__init__.py
    [0 tests, 0.00 s]
sage -t --long src/sage/graphs/generators/basic.py
**********************************************************************
File "src/sage/graphs/generators/basic.py", line 60, in sage.graphs.generators.basic.BullGraph
Failed example:
    g.radius(); g.diameter(); g.girth()
Expected:
    2
    3
    3
Got:
    2L
    3
    3
**********************************************************************
File "src/sage/graphs/generators/basic.py", line 130, in sage.graphs.generators.basic.ButterflyGraph
Failed example:
    G.radius()
Expected:
    1
Got:
    1L
**********************************************************************
2 items had failures:
   1 of  14 in sage.graphs.generators.basic.BullGraph
   1 of  11 in sage.graphs.generators.basic.ButterflyGraph
    [191 tests, 2 failures, 16.25 s]
sage -t --long src/sage/graphs/digraph_generators.py
    [81 tests, 5.09 s]
sage -t --long src/sage/graphs/generators/chessboard.py
    [44 tests, 1.04 s]
sage -t --long src/sage/graphs/generators/degree_sequence.py
    [23 tests, 1.11 s]
sage -t --long src/sage/geometry/triangulation/point_configuration.py
    [202 tests, 23.07 s]
sage -t --long src/sage/graphs/generators/intersection.py
    [71 tests, 0.35 s]
sage -t --long src/sage/graphs/generators/platonic_solids.py
    [44 tests, 4.55 s]
sage -t --long src/sage/graphs/generators/families.py
**********************************************************************
File "src/sage/graphs/generators/families.py", line 815, in sage.graphs.generators.families.FriendshipGraph
Failed example:
    G.radius()
Expected:
    1
Got:
    1L
**********************************************************************
1 item had failures:
   1 of  22 in sage.graphs.generators.families.FriendshipGraph
    [250 tests, 1 failure, 22.30 s]
sage -t --long src/sage/geometry/triangulation/base.pyx
    [171 tests, 35.66 s]
sage -t --long src/sage/graphs/generators/world_map.py
    [4 tests, 0.01 s]
sage -t --long src/sage/graphs/generators/random.py
    [71 tests, 5.22 s]
sage -t --long src/sage/graphs/generic_graph_pyx.pxd
    [0 tests, 0.00 s]
sage -t --long src/sage/graphs/generic_graph_pyx.pyx
    [79 tests, 2.49 s]
sage -t --long src/sage/graphs/generators/smallgraphs.py
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 1302, in sage.graphs.generators.smallgraphs.BrinkmannGraph
Failed example:
    G.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 1650, in sage.graphs.generators.smallgraphs.MeredithGraph
Failed example:
    g.radius()
Expected:
    7
Got:
    7L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 1701, in sage.graphs.generators.smallgraphs.KittellGraph
Failed example:
    g.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 1808, in sage.graphs.generators.smallgraphs.ChvatalGraph
Failed example:
    G.radius(); G.diameter(); G.girth()
Expected:
    2
    2
    4
Got:
    2L
    2
    4
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 2058, in sage.graphs.generators.smallgraphs.DyckGraph
Failed example:
    G.radius()
Expected:
    5
Got:
    5L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 2129, in sage.graphs.generators.smallgraphs.HortonGraph
Failed example:
    g.radius()
Expected:
    10
Got:
    10L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 2372, in sage.graphs.generators.smallgraphs.ErreraGraph
Failed example:
    G.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 2581, in sage.graphs.generators.smallgraphs.FranklinGraph
Failed example:
    G.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 2697, in sage.graphs.generators.smallgraphs.GoldnerHararyGraph
Failed example:
    G.radius()
Expected:
    2
Got:
    2L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 2821, in sage.graphs.generators.smallgraphs.GrotzschGraph
Failed example:
    G.radius()
Expected:
    2
Got:
    2L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 2943, in sage.graphs.generators.smallgraphs.HerschelGraph
Failed example:
    G.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 3257, in sage.graphs.generators.smallgraphs.HoffmanGraph
Failed example:
    g.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 3306, in sage.graphs.generators.smallgraphs.HoltGraph
Failed example:
    g.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 3835, in sage.graphs.generators.smallgraphs.MoserSpindle
Failed example:
    G.radius()
Expected:
    2
Got:
    2L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 4150, in sage.graphs.generators.smallgraphs.ShrikhandeGraph
Failed example:
    G.radius()
Expected:
    2
Got:
    2L
**********************************************************************
File "src/sage/graphs/generators/smallgraphs.py", line 4294, in sage.graphs.generators.smallgraphs.SousselierGraph
Failed example:
    g.radius()
Expected:
    2
Got:
    2L
**********************************************************************
16 items had failures:
   1 of  14 in sage.graphs.generators.smallgraphs.BrinkmannGraph
   1 of   9 in sage.graphs.generators.smallgraphs.ChvatalGraph
   1 of  15 in sage.graphs.generators.smallgraphs.DyckGraph
   1 of  14 in sage.graphs.generators.smallgraphs.ErreraGraph
   1 of  13 in sage.graphs.generators.smallgraphs.FranklinGraph
   1 of  12 in sage.graphs.generators.smallgraphs.GoldnerHararyGraph
   1 of  12 in sage.graphs.generators.smallgraphs.GrotzschGraph
   1 of  13 in sage.graphs.generators.smallgraphs.HerschelGraph
   1 of   7 in sage.graphs.generators.smallgraphs.HoffmanGraph
   1 of  10 in sage.graphs.generators.smallgraphs.HoltGraph
   1 of   9 in sage.graphs.generators.smallgraphs.HortonGraph
   1 of   8 in sage.graphs.generators.smallgraphs.KittellGraph
   1 of  10 in sage.graphs.generators.smallgraphs.MeredithGraph
   1 of  12 in sage.graphs.generators.smallgraphs.MoserSpindle
   1 of  15 in sage.graphs.generators.smallgraphs.ShrikhandeGraph
   1 of  10 in sage.graphs.generators.smallgraphs.SousselierGraph
    [541 tests, 16 failures, 25.01 s]
sage -t --long src/sage/graphs/genus.pyx
    [52 tests, 13.20 s]
sage -t --long src/sage/graphs/graph_coloring.py
    [75 tests, 3.86 s]
sage -t --long src/sage/graphs/graph_database.py
    [56 tests, 0.16 s]
sage -t --long src/sage/graphs/graph_decompositions/__init__.py
    [0 tests, 0.00 s]
sage -t --long src/sage/graphs/graph_decompositions/bandwidth.pyx
    [14 tests, 0.07 s]
sage -t --long src/sage/graphs/graph.py
    [669 tests, 13.92 s]
sage -t --long src/sage/graphs/graph_decompositions/fast_digraph.pxd
    [0 tests, 0.00 s]
sage -t --long src/sage/graphs/graph_decompositions/fast_digraph.pyx
    [1 test, 0.00 s]
sage -t --long src/sage/graphs/graph_decompositions/graph_products.pyx
    [15 tests, 0.07 s]
sage -t --long src/sage/graphs/graph_decompositions/rankwidth.pxd
    [0 tests, 0.00 s]
sage -t --long src/sage/graphs/graph_decompositions/rankwidth.pyx
    [23 tests, 0.03 s]
sage -t --long src/sage/graphs/graph_decompositions/vertex_separation.pxd
    [0 tests, 0.00 s]
sage -t --long src/sage/graphs/generic_graph.py
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 12686, in sage.graphs.generic_graph.GenericGraph.eccentricity
Failed example:
    G.eccentricity()
Expected:
    [4, 4, 4, 4, 4, 3, 3, 2, 3, 4]
Got:
    [4L, 4L, 4L, 4L, 4L, 3L, 3L, 2L, 3L, 4L]
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 12700, in sage.graphs.generic_graph.GenericGraph.eccentricity
Failed example:
    G.eccentricity(with_labels=True)
Expected:
    {0: 0}
Got:
    {0: 0L}
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 12753, in sage.graphs.generic_graph.GenericGraph.radius
Failed example:
    G.radius()
Expected:
    3
Got:
    3L
**********************************************************************
File "src/sage/graphs/generic_graph.py", line 12761, in sage.graphs.generic_graph.GenericGraph.radius
Failed example:
    G.radius()
Expected:
    2
Got:
    2L
**********************************************************************
2 items had failures:
   2 of  13 in sage.graphs.generic_graph.GenericGraph.eccentricity
   2 of   9 in sage.graphs.generic_graph.GenericGraph.radius
    [2707 tests, 4 failures, 52.37 s]
```



---

archive/issue_comments_337078.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-07-14T07:34:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337078",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_337079.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n|[ce9d265](https://github.com/sagemath/sagetrac-mirror/commit/ce9d26556e5b1a69002e1a5165933e51ddfc7c05)|`trac #18864: return Sage integers`|",
    "created_at": "2015-07-14T09:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337079",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
|[ce9d265](https://github.com/sagemath/sagetrac-mirror/commit/ce9d26556e5b1a69002e1a5165933e51ddfc7c05)|`trac #18864: return Sage integers`|



---

archive/issue_comments_337080.json:
```json
{
    "body": "Changing commit from \"80cb89935d8eb8288d6659d7c73d8c05ee1c9411\" to \"ce9d26556e5b1a69002e1a5165933e51ddfc7c05\"",
    "created_at": "2015-07-14T09:00:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337080",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "80cb89935d8eb8288d6659d7c73d8c05ee1c9411" to "ce9d26556e5b1a69002e1a5165933e51ddfc7c05"



---

archive/issue_comments_337081.json:
```json
{
    "body": "<a id='comment:29'></a>\nThis should work.",
    "created_at": "2015-07-14T09:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337081",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:29'></a>
This should work.



---

archive/issue_comments_337082.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-14T09:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337082",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_337083.json:
```json
{
    "body": "<a id='comment:30'></a>\nNo idea how to test it, but I am quite sure this should work!",
    "created_at": "2015-07-15T09:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337083",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:30'></a>
No idea how to test it, but I am quite sure this should work!



---

archive/issue_comments_337084.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-07-15T09:14:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337084",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_337085.json:
```json
{
    "body": "<a id='comment:31'></a>\nI have tested it using an old computer with 32bits system and it solves the issue.\nThanks.",
    "created_at": "2015-07-15T09:55:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337085",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:31'></a>
I have tested it using an old computer with 32bits system and it solves the issue.
Thanks.



---

archive/issue_comments_337086.json:
```json
{
    "body": "Changing branch from \"public/18864\" to \"ce9d26556e5b1a69002e1a5165933e51ddfc7c05\"",
    "created_at": "2015-07-27T15:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337086",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/18864" to "ce9d26556e5b1a69002e1a5165933e51ddfc7c05"



---

archive/issue_comments_337087.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-07-27T15:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18864#issuecomment-337087",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_059929.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-27T15:15:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18864",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18864#event-59929"
}
```
