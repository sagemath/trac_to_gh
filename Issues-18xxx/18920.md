# Issue 18920: upgrade Maxima  to version >= 5.39

archive/issues_018683.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nthis would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).\n\n* get Maxima 5.39.0 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nCC:  @rwst @jpflori @kcrisman @nbruin @jdemeyer @vbraun @EmmanuelCharpentier\n\nComponent: **symbolics**\n\nAuthor: **Dima Pasechnik**\n\nBranch/Commit: **[`a6c51e6`](https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14)**\n\nReviewer: **Travis Scrimshaw, Emmanuel Charpentier, Fran\u00e7ois Bissey, Jeroen Demeyer, Nils Bruin**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18920_\n\n",
    "closed_at": "2017-01-28T17:03:58Z",
    "created_at": "2015-07-18T09:54:10Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "upgrade Maxima  to version >= 5.39",
    "type": "issue",
    "updated_at": "2017-01-28T17:03:58Z",
    "url": "https://github.com/sagemath/sage/issues/18920",
    "user": "https://github.com/dimpase"
}
```
<div id="comment:0"></div>

this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).

* get Maxima 5.39.0 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)

Upstream: **Fixed upstream, in a later stable release.**

CC:  @rwst @jpflori @kcrisman @nbruin @jdemeyer @vbraun @EmmanuelCharpentier

Component: **symbolics**

Author: **Dima Pasechnik**

Branch/Commit: **[`a6c51e6`](https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14)**

Reviewer: **Travis Scrimshaw, Emmanuel Charpentier, Fran√ßois Bissey, Jeroen Demeyer, Nils Bruin**

_Issue created by migration from https://trac.sagemath.org/ticket/18920_





---

archive/issue_events_266143.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-18T09:54:10Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266143"
}
```



---

archive/issue_events_266144.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-18T09:54:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266144"
}
```



---

archive/issue_events_266145.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-18T09:54:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266145"
}
```



---

archive/issue_events_266146.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-18T09:54:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266146"
}
```



---

archive/issue_comments_265082.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,5 @@\n this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).\n \n-* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`) and\n-* ECL [here](https://gitlab.com/embeddable-common-lisp/ecl.git).\n+* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); sf.net with tarballs is down...\n+* ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball\n+  can be obtained [there https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7], too.\n``````\n",
    "created_at": "2015-07-18T11:18:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265082",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,5 @@
 this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).
 
-* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`) and
-* ECL [here](https://gitlab.com/embeddable-common-lisp/ecl.git).
+* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); sf.net with tarballs is down...
+* ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball
+  can be obtained [there https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7], too.
``````




---

archive/issue_comments_265083.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,4 @@\n \n * get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); sf.net with tarballs is down...\n * ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball\n-  can be obtained [there https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7], too.\n+  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too.\n``````\n",
    "created_at": "2015-07-18T11:18:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265083",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,4 @@
 
 * get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); sf.net with tarballs is down...
 * ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball
-  can be obtained [there https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7], too.
+  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too.
``````




---

archive/issue_comments_265084.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).\n \n-* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); sf.net with tarballs is down...\n+* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...\n * ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball\n   can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too.\n``````\n",
    "created_at": "2015-07-18T11:21:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265084",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).
 
-* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); sf.net with tarballs is down...
+* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...
 * ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball
   can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too.
``````




---

archive/issue_comments_265085.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nFor info, I have been using ecl 15.3.7 for a while in sage-on-gentoo. That part is a straight upgrade as far as I can see. I do not remember having tried a newer maxima but it usually breaks a lest a couple of doctest.",
    "created_at": "2015-07-18T21:54:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265085",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:4" align="right">comment:4</div>

For info, I have been using ecl 15.3.7 for a while in sage-on-gentoo. That part is a straight upgrade as far as I can see. I do not remember having tried a newer maxima but it usually breaks a lest a couple of doctest.



---

archive/issue_comments_265086.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI tried maxima 5.36.0 and reverted (that was with ecl 15.3.7) , not tried 5.36.1 (5.36.0.1 whatever the version number is actually).\n\n```\n     Wed Apr 29 11:14:49 2015 >>> sci-mathematics/maxima-5.35.1-r2\n       merge time: 5 minutes and 6 seconds.\n\n     Fri May  1 10:33:58 2015 >>> sci-mathematics/maxima-5.36.0\n       merge time: 4 minutes and 52 seconds.\n\n     Fri May  1 10:42:03 2015 >>> sci-mathematics/maxima-5.35.1-r2\n       merge time: 5 minutes and 8 seconds.\n```",
    "created_at": "2015-07-18T22:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265086",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:5" align="right">comment:5</div>

I tried maxima 5.36.0 and reverted (that was with ecl 15.3.7) , not tried 5.36.1 (5.36.0.1 whatever the version number is actually).

```
     Wed Apr 29 11:14:49 2015 >>> sci-mathematics/maxima-5.35.1-r2
       merge time: 5 minutes and 6 seconds.

     Fri May  1 10:33:58 2015 >>> sci-mathematics/maxima-5.36.0
       merge time: 4 minutes and 52 seconds.

     Fri May  1 10:42:03 2015 >>> sci-mathematics/maxima-5.35.1-r2
       merge time: 5 minutes and 8 seconds.
```



---

archive/issue_comments_265087.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n \n * get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...\n * ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball\n-  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too.\n+  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too. But it is not useful without renaming, etc.\n+\n+ecl tarball to use is [here](http://users.ox.ac.uk/~coml0531/sage/ecl-15.3.7.tar.bz2)\n``````\n",
    "created_at": "2015-07-18T23:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265087",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 
 * get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...
 * ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball
-  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too.
+  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too. But it is not useful without renaming, etc.
+
+ecl tarball to use is [here](http://users.ox.ac.uk/~coml0531/sage/ecl-15.3.7.tar.bz2)
``````




---

archive/issue_comments_265088.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe branch is currently not working; to build the new ecl pkg, one has to move `patches/implib.patch` out of the way; I tried porting the latter patch to the new ecl, but it produces a makefile error that I don't understand; anyway, it is cygwin-specific.\n\nI cc its author now. J.-P., any ideas?",
    "created_at": "2015-07-18T23:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265088",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:6" align="right">comment:6</div>

The branch is currently not working; to build the new ecl pkg, one has to move `patches/implib.patch` out of the way; I tried porting the latter patch to the new ecl, but it produces a makefile error that I don't understand; anyway, it is cygwin-specific.

I cc its author now. J.-P., any ideas?



---

archive/issue_comments_265089.json:
```json
{
    "body": "Commit: **[`045d21e`](https://github.com/sagemath/sagetrac-mirror/commit/045d21eeb356b04102696d1aa51776b1330c635a)**",
    "created_at": "2015-07-18T23:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265089",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`045d21e`](https://github.com/sagemath/sagetrac-mirror/commit/045d21eeb356b04102696d1aa51776b1330c635a)**



---

archive/issue_comments_265090.json:
```json
{
    "body": "Branch: **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)**",
    "created_at": "2015-07-18T23:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265090",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)**



---

archive/issue_comments_265091.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nfor the record, I get\n\n```\n...\nconfig.status: creating ecl/config.h\nConfiguration complete. To build ECL, issue make in this directory.\ncd build; make -j1\nmake[1]: Entering directory `/home/dima/software/sage/local/var/tmp/sage/build/ecl-15.3.7.p0/src/build'\nMakefile:192: *** commands commence before first target.  Stop.\nmake[1]: Leaving directory `/home/dima/software/sage/local/var/tmp/sage/build/ecl-15.3.7.p0/src/build'\nmake: *** [all] Error 2\nError - Failed to build ECL ... exiting\n```",
    "created_at": "2015-07-18T23:37:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265091",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

for the record, I get

```
...
config.status: creating ecl/config.h
Configuration complete. To build ECL, issue make in this directory.
cd build; make -j1
make[1]: Entering directory `/home/dima/software/sage/local/var/tmp/sage/build/ecl-15.3.7.p0/src/build'
Makefile:192: *** commands commence before first target.  Stop.
make[1]: Leaving directory `/home/dima/software/sage/local/var/tmp/sage/build/ecl-15.3.7.p0/src/build'
make: *** [all] Error 2
Error - Failed to build ECL ... exiting
```



---

archive/issue_comments_265092.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nWhat I don't understand is whether some patches are in fact results of running autoconf/automake/aclocal on patched configure.ac, Makefile.in, etc. \n\nIf yes, then these should be split from the \"real\" ones to allow for fully automatic creation (and commands needed to run autotools need to be spelled out somewhere in the pkg docs). If no, then I don't see the point of patching configure.ac, Makefile.in, etc in the first place.",
    "created_at": "2015-07-19T09:51:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265092",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:8" align="right">comment:8</div>

What I don't understand is whether some patches are in fact results of running autoconf/automake/aclocal on patched configure.ac, Makefile.in, etc. 

If yes, then these should be split from the "real" ones to allow for fully automatic creation (and commands needed to run autotools need to be spelled out somewhere in the pkg docs). If no, then I don't see the point of patching configure.ac, Makefile.in, etc in the first place.



---

archive/issue_comments_265093.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nLook at spkg_src. autotools are not run. But may be the impl platch was copied from an autotool run. The gmp patch deals with the removal of gmp sources from the upstream tarball (the configure script of ecl checks for stuff in that subdirectory so those checks have to be diverted). the impl patch deals with cygwin stuff.\n\nGetting real autoconf patch and running autotools wouldn't be a bad idea but that means you will need to have autotools installed to run spkg-src. spkg-src will need to be amended accordingly.",
    "created_at": "2015-07-19T10:06:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265093",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:9" align="right">comment:9</div>

Look at spkg_src. autotools are not run. But may be the impl platch was copied from an autotool run. The gmp patch deals with the removal of gmp sources from the upstream tarball (the configure script of ecl checks for stuff in that subdirectory so those checks have to be diverted). the impl patch deals with cygwin stuff.

Getting real autoconf patch and running autotools wouldn't be a bad idea but that means you will need to have autotools installed to run spkg-src. spkg-src will need to be amended accordingly.



---

archive/issue_comments_265094.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nI notice that the gmp patch is against `configure.ac` while implib is against `configure.in` the last one is probably wrong.",
    "created_at": "2015-07-19T10:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265094",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:10" align="right">comment:10</div>

I notice that the gmp patch is against `configure.ac` while implib is against `configure.in` the last one is probably wrong.



---

archive/issue_comments_265095.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@kiwifb](#comment%3A10):\n> I notice that the gmp patch is against `configure.ac` while implib is against `configure.in` the last one is probably wrong.\n\nthe name has changed in version 15.3.7.",
    "created_at": "2015-07-19T10:25:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265095",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@kiwifb](#comment%3A10):
> I notice that the gmp patch is against `configure.ac` while implib is against `configure.in` the last one is probably wrong.

the name has changed in version 15.3.7.



---

archive/issue_comments_265096.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI am trying to read the stuff from the git commit and of course it is patch of patch, it is not readable as this, you changed it already I see.",
    "created_at": "2015-07-19T10:28:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265096",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:12" align="right">comment:12</div>

I am trying to read the stuff from the git commit and of course it is patch of patch, it is not readable as this, you changed it already I see.



---

archive/issue_comments_265097.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@kiwifb](#comment%3A9):\n> Look at spkg_src. autotools are not run. But may be the impl platch was copied from an autotool run. The gmp patch deals with the removal of gmp sources from the upstream tarball (the configure script of ecl checks for stuff in that subdirectory so those checks have to be diverted). the impl patch deals with cygwin stuff.\n> \n> Getting real autoconf patch and running autotools wouldn't be a bad idea but that means you will need to have autotools installed to run spkg-src. spkg-src will need to be amended accordingly.\n\nspkg-src is outdated anyway.",
    "created_at": "2015-07-19T10:34:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265097",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@kiwifb](#comment%3A9):
> Look at spkg_src. autotools are not run. But may be the impl platch was copied from an autotool run. The gmp patch deals with the removal of gmp sources from the upstream tarball (the configure script of ecl checks for stuff in that subdirectory so those checks have to be diverted). the impl patch deals with cygwin stuff.
> 
> Getting real autoconf patch and running autotools wouldn't be a bad idea but that means you will need to have autotools installed to run spkg-src. spkg-src will need to be amended accordingly.

spkg-src is outdated anyway.



---

archive/issue_comments_265098.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@kiwifb](#comment%3A12):\n> I am trying to read the stuff from the git commit and of course it is patch of patch, it is not readable as this, you changed it already I see.\n\nhere they are in a more readable way: https://github.com/dimpase/ecl/commits/sagepatches",
    "created_at": "2015-07-19T10:44:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265098",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@kiwifb](#comment%3A12):
> I am trying to read the stuff from the git commit and of course it is patch of patch, it is not readable as this, you changed it already I see.

here they are in a more readable way: https://github.com/dimpase/ecl/commits/sagepatches



---

archive/issue_comments_265099.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@dimpase](#comment%3A13):\n> Replying to [@kiwifb](#comment%3A9):\n> > Look at spkg_src. autotools are not run. But may be the impl platch was copied from an autotool run. The gmp patch deals with the removal of gmp sources from the upstream tarball (the configure script of ecl checks for stuff in that subdirectory so those checks have to be diverted). the impl patch deals with cygwin stuff.\n\n\nNo, I mean that it is silly and error-prone to rebase by hand patches that are better obtained directly from diffs to output of autoconf/automake/aclocal.\n\nThe latter should not be bundled together with the \"real\" one.",
    "created_at": "2015-07-19T10:49:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265099",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@dimpase](#comment%3A13):
> Replying to [@kiwifb](#comment%3A9):
> > Look at spkg_src. autotools are not run. But may be the impl platch was copied from an autotool run. The gmp patch deals with the removal of gmp sources from the upstream tarball (the configure script of ecl checks for stuff in that subdirectory so those checks have to be diverted). the impl patch deals with cygwin stuff.


No, I mean that it is silly and error-prone to rebase by hand patches that are better obtained directly from diffs to output of autoconf/automake/aclocal.

The latter should not be bundled together with the "real" one.



---

archive/issue_comments_265100.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI have opened https://gitlab.com/embeddable-common-lisp/ecl/issues/93\n\nto hopefully sort out the ECL autotools mess.",
    "created_at": "2015-07-20T08:10:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265100",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:16" align="right">comment:16</div>

I have opened https://gitlab.com/embeddable-common-lisp/ecl/issues/93

to hopefully sort out the ECL autotools mess.



---

archive/issue_comments_265101.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nSorry I have been too busy today to look further into this. I can reproduce your problem with your branch on my mac. I haven't quite identified yet the guilty makefile. I think the problem is not in the top makefile but in one of the subfolders but I haven't identified which one yet.",
    "created_at": "2015-07-20T08:17:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265101",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:17" align="right">comment:17</div>

Sorry I have been too busy today to look further into this. I can reproduce your problem with your branch on my mac. I haven't quite identified yet the guilty makefile. I think the problem is not in the top makefile but in one of the subfolders but I haven't identified which one yet.



---

archive/issue_comments_265102.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nTo complete the answer you got from upstream: automake is not used (not a crime) but ecl also ship some of its dependencies in the pristine tarball and those come with their own build systems which can use automake. Apart from `ffi` we don't want to care about these I think.",
    "created_at": "2015-07-20T08:37:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265102",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:18" align="right">comment:18</div>

To complete the answer you got from upstream: automake is not used (not a crime) but ecl also ship some of its dependencies in the pristine tarball and those come with their own build systems which can use automake. Apart from `ffi` we don't want to care about these I think.



---

archive/issue_comments_265103.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\narrghh, that was me mixing of tabs and spaces in `src/Makefile.in` patch...\nNow all seems to work. I'll post an update soon.\n\nOK, and for the record, `src/configure` is generated by autoreconf, that is, one does not need to rebase the corresponding patch manually.",
    "created_at": "2015-07-20T11:27:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265103",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

arrghh, that was me mixing of tabs and spaces in `src/Makefile.in` patch...
Now all seems to work. I'll post an update soon.

OK, and for the record, `src/configure` is generated by autoreconf, that is, one does not need to rebase the corresponding patch manually.



---

archive/issue_comments_265104.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9fc27ca7ba877a83443c61d22542e49d65096404\"><code>9fc27ca</code></a></td><td><code>fixed broken Makefile.in patch (spaces and tabs don't mix), reorganised patches.</code></td></tr></table>\n",
    "created_at": "2015-07-20T12:09:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265104",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9fc27ca7ba877a83443c61d22542e49d65096404"><code>9fc27ca</code></a></td><td><code>fixed broken Makefile.in patch (spaces and tabs don't mix), reorganised patches.</code></td></tr></table>




---

archive/issue_comments_265105.json:
```json
{
    "body": "Changed commit from **[`045d21e`](https://github.com/sagemath/sagetrac-mirror/commit/045d21eeb356b04102696d1aa51776b1330c635a)** to **[`9fc27ca`](https://github.com/sagemath/sagetrac-mirror/commit/9fc27ca7ba877a83443c61d22542e49d65096404)**",
    "created_at": "2015-07-20T12:09:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265105",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`045d21e`](https://github.com/sagemath/sagetrac-mirror/commit/045d21eeb356b04102696d1aa51776b1330c635a)** to **[`9fc27ca`](https://github.com/sagemath/sagetrac-mirror/commit/9fc27ca7ba877a83443c61d22542e49d65096404)**



---

archive/issue_comments_265106.json:
```json
{
    "body": "Changed commit from **[`9fc27ca`](https://github.com/sagemath/sagetrac-mirror/commit/9fc27ca7ba877a83443c61d22542e49d65096404)** to **[`82fdf0e`](https://github.com/sagemath/sagetrac-mirror/commit/82fdf0eaa092b63cc98d97b418721795ea6b5081)**",
    "created_at": "2015-07-25T19:39:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265106",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9fc27ca`](https://github.com/sagemath/sagetrac-mirror/commit/9fc27ca7ba877a83443c61d22542e49d65096404)** to **[`82fdf0e`](https://github.com/sagemath/sagetrac-mirror/commit/82fdf0eaa092b63cc98d97b418721795ea6b5081)**



---

archive/issue_comments_265107.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/82fdf0eaa092b63cc98d97b418721795ea6b5081\"><code>82fdf0e</code></a></td><td><code>ported maxima patches; tarball needs bootstrapping; trivial doctests fix</code></td></tr></table>\n",
    "created_at": "2015-07-25T19:39:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265107",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/82fdf0eaa092b63cc98d97b418721795ea6b5081"><code>82fdf0e</code></a></td><td><code>ported maxima patches; tarball needs bootstrapping; trivial doctests fix</code></td></tr></table>




---

archive/issue_comments_265108.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nNew Maxima output sometimes breaks Sage parser, e.g.\n\n```\nsage -t src/sage/calculus/calculus.py\n**********************************************************************\nFile \"src/sage/calculus/calculus.py\", line 373, in sage.calculus.calculus\nFailed example:\n    taylor(gamma(1/3+x),x,0,3)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.calculus.calculus[100]>\", line 1, in <module>\n        taylor(gamma(Integer(1)/Integer(3)+x),x,Integer(0),Integer(3))\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/calculus/functional.py\", line 378, in taylor\n        return f.taylor(*args)\n      File \"sage/symbolic/expression.pyx\", line 4038, in sage.symbolic.expression.Expression.taylor (/home/dima/software/sage/src/build/cythonized/sage/symbolic/expression.cpp:23671)\n        return self.parent()(l)\n      File \"sage/structure/parent.pyx\", line 1097, in sage.structure.parent.Parent.__call__ (/home/dima/software/sage/src/build/cythonized/sage/structure/parent.c:9546)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 237, in sage.structure.coerce_maps.NamedConvertMap._call_ (/home/dima/software/sage/src/build/cythonized/sage/structure/coerce_maps.c:5756)\n        cdef Element e = method(C)\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py\", line 1251, in _symbolic_\n        return R(self._sage_())\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py\", line 1226, in _sage_\n        maxima=self.parent())\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/calculus/calculus.py\", line 1901, in symbolic_expression_from_maxima_string\n        raise TypeError(\"unable to make sense of Maxima expression '%s' in Sage\"%s)\n    TypeError: unable to make sense of Maxima expression '(1/432)*(72*gamma(1/3)*(psi[2])(1/3)+((-72)*euler_gamma^3+((-36)*pi*3^(1/2)+(-324)*log(3))*euler_gamma^2+((-108)*log(3)*pi*3^(1/2)+(-18)*pi^2+(-486)*log(3)^2+(-216)*(psi[1])(1/3))*euler_gamma+((-1)*pi^3+((-81)*log(3)^2+(-36)*(psi[1])(1/3))*pi)*3^(1/2)+(-27)*log(3)*pi^2+(-243)*log(3)^3+(-324)*(psi[1])(1/3)*log(3))*gamma(1/3))*_SAGE_VAR_x^3+(1/24)*((12*euler_gamma^2+(4*pi*3^(1/2)+36*log(3))*euler_gamma+6*log(3)*pi*3^(1/2)+pi^2+27*log(3)^2+12*(psi[1])(1/3))*gamma(1/3))*_SAGE_VAR_x^2+((-1)/6)*((6*euler_gamma+pi*3^(1/2)+9*log(3))*gamma(1/3))*_SAGE_VAR_x+gamma(1/3)' in Sage\n```\nand\n\n```\nFile \"src/sage/calculus/calculus.py\", line 1746, in sage.calculus.calculus.symbolic_expression_from_maxima_string\nFailed example:\n    maxima('3*li[2](u)+8*li[33](exp(u))').sage()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.calculus.calculus.symbolic_expression_from_maxima_string[6]>\", line 1, in <module>\n        maxima('3*li[2](u)+8*li[33](exp(u))').sage()\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py\", line 1016, in sage\n        return self._sage_(*args, **kwds)\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py\", line 1226, in _sage_\n        maxima=self.parent())\n      File \"/home/dima/software/sage/local/lib/python2.7/site-packages/sage/calculus/calculus.py\", line 1901, in symbolic_expression_from_maxima_string\n        raise TypeError(\"unable to make sense of Maxima expression '%s' in Sage\"%s)\n    TypeError: unable to make sense of Maxima expression '8*(li[33])(e^u)+3*(li[2])(u)' in Sage\n```\n\nIs it easy to fix?",
    "created_at": "2015-07-25T22:03:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265108",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:23" align="right">comment:23</div>

New Maxima output sometimes breaks Sage parser, e.g.

```
sage -t src/sage/calculus/calculus.py
**********************************************************************
File "src/sage/calculus/calculus.py", line 373, in sage.calculus.calculus
Failed example:
    taylor(gamma(1/3+x),x,0,3)
Exception raised:
    Traceback (most recent call last):
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.calculus.calculus[100]>", line 1, in <module>
        taylor(gamma(Integer(1)/Integer(3)+x),x,Integer(0),Integer(3))
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/calculus/functional.py", line 378, in taylor
        return f.taylor(*args)
      File "sage/symbolic/expression.pyx", line 4038, in sage.symbolic.expression.Expression.taylor (/home/dima/software/sage/src/build/cythonized/sage/symbolic/expression.cpp:23671)
        return self.parent()(l)
      File "sage/structure/parent.pyx", line 1097, in sage.structure.parent.Parent.__call__ (/home/dima/software/sage/src/build/cythonized/sage/structure/parent.c:9546)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 237, in sage.structure.coerce_maps.NamedConvertMap._call_ (/home/dima/software/sage/src/build/cythonized/sage/structure/coerce_maps.c:5756)
        cdef Element e = method(C)
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py", line 1251, in _symbolic_
        return R(self._sage_())
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py", line 1226, in _sage_
        maxima=self.parent())
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/calculus/calculus.py", line 1901, in symbolic_expression_from_maxima_string
        raise TypeError("unable to make sense of Maxima expression '%s' in Sage"%s)
    TypeError: unable to make sense of Maxima expression '(1/432)*(72*gamma(1/3)*(psi[2])(1/3)+((-72)*euler_gamma^3+((-36)*pi*3^(1/2)+(-324)*log(3))*euler_gamma^2+((-108)*log(3)*pi*3^(1/2)+(-18)*pi^2+(-486)*log(3)^2+(-216)*(psi[1])(1/3))*euler_gamma+((-1)*pi^3+((-81)*log(3)^2+(-36)*(psi[1])(1/3))*pi)*3^(1/2)+(-27)*log(3)*pi^2+(-243)*log(3)^3+(-324)*(psi[1])(1/3)*log(3))*gamma(1/3))*_SAGE_VAR_x^3+(1/24)*((12*euler_gamma^2+(4*pi*3^(1/2)+36*log(3))*euler_gamma+6*log(3)*pi*3^(1/2)+pi^2+27*log(3)^2+12*(psi[1])(1/3))*gamma(1/3))*_SAGE_VAR_x^2+((-1)/6)*((6*euler_gamma+pi*3^(1/2)+9*log(3))*gamma(1/3))*_SAGE_VAR_x+gamma(1/3)' in Sage
```
and

```
File "src/sage/calculus/calculus.py", line 1746, in sage.calculus.calculus.symbolic_expression_from_maxima_string
Failed example:
    maxima('3*li[2](u)+8*li[33](exp(u))').sage()
Exception raised:
    Traceback (most recent call last):
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.calculus.calculus.symbolic_expression_from_maxima_string[6]>", line 1, in <module>
        maxima('3*li[2](u)+8*li[33](exp(u))').sage()
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/interface.py", line 1016, in sage
        return self._sage_(*args, **kwds)
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py", line 1226, in _sage_
        maxima=self.parent())
      File "/home/dima/software/sage/local/lib/python2.7/site-packages/sage/calculus/calculus.py", line 1901, in symbolic_expression_from_maxima_string
        raise TypeError("unable to make sense of Maxima expression '%s' in Sage"%s)
    TypeError: unable to make sense of Maxima expression '8*(li[33])(e^u)+3*(li[2])(u)' in Sage
```

Is it easy to fix?



---

archive/issue_comments_265109.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@dimpase](#comment%3A23):\n> \n> ```\n>     TypeError: unable to make sense of Maxima expression '(1/432)*(72*gamma(1/3)*(psi[2])(1/3)+((-72)*euler_gamma^3+((-36)*pi*3^(1/2)+(-324)*log(3))*euler_gamma^2+((-108)*log(3)*pi*3^(1/2)+(-18)*pi^2+(-486)*log(3)^2+(-216)*(psi[1])(1/3))*euler_gamma+((-1)*pi^3+((-81)*log(3)^2+(-36)*(psi[1])(1/3))*pi)*3^(1/2)+(-27)*log(3)*pi^2+(-243)*log(3)^3+(-324)*(psi[1])(1/3)*log(3))*gamma(1/3))*_SAGE_VAR_x^3+(1/24)*((12*euler_gamma^2+(4*pi*3^(1/2)+36*log(3))*euler_gamma+6*log(3)*pi*3^(1/2)+pi^2+27*log(3)^2+12*(psi[1])(1/3))*gamma(1/3))*_SAGE_VAR_x^2+((-1)/6)*((6*euler_gamma+pi*3^(1/2)+9*log(3))*gamma(1/3))*_SAGE_VAR_x+gamma(1/3)' in Sage\n> ```\n> and\n> \n> ```\n>     TypeError: unable to make sense of Maxima expression '8*(li[33])(e^u)+3*(li[2])(u)' in Sage\n> ```\n\nNo, it is not very easy to fix. We rewrite `li[n](` to `polylog(n,` and the same for `psi[n](` to `psi(n,`. This string matching obviously completely breaks if maxima starts spelling this as `(li[n])(x)`. Quite frankly, that's an insane spelling, so perhaps the preferred approach is to clarify with the maxima folks if they really intend this. It might be an unforeseen byproduct of some other change that they prefer to fix themselves, in which case we shouldn't waste time.\n\nIf they insist this is a reasonable spelling, I think we can work around it, but it'll be a bit of real work. Note that we can handle calls to parenthesized functions:\n\n```\nsage: from sage.calculus.calculus import symbolic_expression_from_maxima_string as sefms\nsage: sefms('(sin)(x)')\nsin(x)\n```\nso as long as we ensure that expressions like `li[n]` and `psi[n]` themselves get parsed to callable functions, we should be OK. Something like this would be OK:\n\n```\nsage: sefms('li[n]')\ncurried_polylog(n)\nsage: sefms('li[n]')(x)\npolylog(n,x)\nsage: sefms('(li[n])(x)')\npolylog(n,x)\n```\nSince we cannot really handle square brackets, we'd need to do the `li[n]`->`curried_polylog(n)` via a string substitution, but that should be OK. The `curried_polylog(n)` would just create a symbolic function that, when called with a single argument, would create the appropriate polylog.\n\nThe binary conversion `sr_to_max` in `maxima_lib.py`  shouldn't be affected, unless they have changed their internal representation of polylogarithms.",
    "created_at": "2015-07-25T23:13:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265109",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@dimpase](#comment%3A23):
> 
> ```
>     TypeError: unable to make sense of Maxima expression '(1/432)*(72*gamma(1/3)*(psi[2])(1/3)+((-72)*euler_gamma^3+((-36)*pi*3^(1/2)+(-324)*log(3))*euler_gamma^2+((-108)*log(3)*pi*3^(1/2)+(-18)*pi^2+(-486)*log(3)^2+(-216)*(psi[1])(1/3))*euler_gamma+((-1)*pi^3+((-81)*log(3)^2+(-36)*(psi[1])(1/3))*pi)*3^(1/2)+(-27)*log(3)*pi^2+(-243)*log(3)^3+(-324)*(psi[1])(1/3)*log(3))*gamma(1/3))*_SAGE_VAR_x^3+(1/24)*((12*euler_gamma^2+(4*pi*3^(1/2)+36*log(3))*euler_gamma+6*log(3)*pi*3^(1/2)+pi^2+27*log(3)^2+12*(psi[1])(1/3))*gamma(1/3))*_SAGE_VAR_x^2+((-1)/6)*((6*euler_gamma+pi*3^(1/2)+9*log(3))*gamma(1/3))*_SAGE_VAR_x+gamma(1/3)' in Sage
> ```
> and
> 
> ```
>     TypeError: unable to make sense of Maxima expression '8*(li[33])(e^u)+3*(li[2])(u)' in Sage
> ```

No, it is not very easy to fix. We rewrite `li[n](` to `polylog(n,` and the same for `psi[n](` to `psi(n,`. This string matching obviously completely breaks if maxima starts spelling this as `(li[n])(x)`. Quite frankly, that's an insane spelling, so perhaps the preferred approach is to clarify with the maxima folks if they really intend this. It might be an unforeseen byproduct of some other change that they prefer to fix themselves, in which case we shouldn't waste time.

If they insist this is a reasonable spelling, I think we can work around it, but it'll be a bit of real work. Note that we can handle calls to parenthesized functions:

```
sage: from sage.calculus.calculus import symbolic_expression_from_maxima_string as sefms
sage: sefms('(sin)(x)')
sin(x)
```
so as long as we ensure that expressions like `li[n]` and `psi[n]` themselves get parsed to callable functions, we should be OK. Something like this would be OK:

```
sage: sefms('li[n]')
curried_polylog(n)
sage: sefms('li[n]')(x)
polylog(n,x)
sage: sefms('(li[n])(x)')
polylog(n,x)
```
Since we cannot really handle square brackets, we'd need to do the `li[n]`->`curried_polylog(n)` via a string substitution, but that should be OK. The `curried_polylog(n)` would just create a symbolic function that, when called with a single argument, would create the appropriate polylog.

The binary conversion `sr_to_max` in `maxima_lib.py`  shouldn't be affected, unless they have changed their internal representation of polylogarithms.



---

archive/issue_comments_265110.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI opened https://sourceforge.net/p/maxima/bugs/2998/ to ask about these extra ()...",
    "created_at": "2015-07-26T07:23:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265110",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:25" align="right">comment:25</div>

I opened https://sourceforge.net/p/maxima/bugs/2998/ to ask about these extra ()...



---

archive/issue_comments_265111.json:
```json
{
    "body": "Changed commit from **[`82fdf0e`](https://github.com/sagemath/sagetrac-mirror/commit/82fdf0eaa092b63cc98d97b418721795ea6b5081)** to **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)**",
    "created_at": "2015-07-26T12:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265111",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`82fdf0e`](https://github.com/sagemath/sagetrac-mirror/commit/82fdf0eaa092b63cc98d97b418721795ea6b5081)** to **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)**



---

archive/issue_comments_265112.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad\"><code>0d0649a</code></a></td><td><code>some easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2015-07-26T12:24:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265112",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad"><code>0d0649a</code></a></td><td><code>some easy doctest fixes</code></td></tr></table>




---

archive/issue_comments_265113.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThis is bad:\n\n```diff\ndiff --git a/build/pkgs/maxima/spkg-install b/build/pkgs/maxima/spkg-install\nindex 3c80e5c..b08d0d7 100755\n--- a/build/pkgs/maxima/spkg-install\n+++ b/build/pkgs/maxima/spkg-install\n@@ -47,6 +47,7 @@ done\n echo\n echo \"Now configuring Maxima...\"\n+./bootstrap\n ./configure --prefix=\"$SAGE_LOCAL\" --libdir=\"$SAGE_LOCAL/lib\" --enable-ecl git_found=false\n check_error \"Failed to configure Maxima.\"\n```\n\nBootstrapping should ideally be done by upstream. Alternatively, it should be done in `spkg-src`, but certainly not in `spkg-install`. Autotools are not a Sage prerequisite.",
    "created_at": "2015-07-26T12:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265113",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

This is bad:

```diff
diff --git a/build/pkgs/maxima/spkg-install b/build/pkgs/maxima/spkg-install
index 3c80e5c..b08d0d7 100755
--- a/build/pkgs/maxima/spkg-install
+++ b/build/pkgs/maxima/spkg-install
@@ -47,6 +47,7 @@ done
 echo
 echo "Now configuring Maxima..."
+./bootstrap
 ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" --enable-ecl git_found=false
 check_error "Failed to configure Maxima."
```

Bootstrapping should ideally be done by upstream. Alternatively, it should be done in `spkg-src`, but certainly not in `spkg-install`. Autotools are not a Sage prerequisite.



---

archive/issue_comments_265114.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@dimpase](#comment%3A13):\n> spkg-src is outdated anyway.\n\n[citation needed]",
    "created_at": "2015-07-26T12:53:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265114",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@dimpase](#comment%3A13):
> spkg-src is outdated anyway.

[citation needed]



---

archive/issue_comments_265115.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@jdemeyer](#comment%3A27):\n> This is bad:\n> \n> ```diff\n> diff --git a/build/pkgs/maxima/spkg-install b/build/pkgs/maxima/spkg-install\n> index 3c80e5c..b08d0d7 100755\n> --- a/build/pkgs/maxima/spkg-install\n> +++ b/build/pkgs/maxima/spkg-install\n> @@ -47,6 +47,7 @@ done\n>  echo\n>  echo \"Now configuring Maxima...\"\n> +./bootstrap\n>  ./configure --prefix=\"$SAGE_LOCAL\" --libdir=\"$SAGE_LOCAL/lib\" --enable-ecl git_found=false\n>  check_error \"Failed to configure Maxima.\"\n> ```\n> \n> Bootstrapping should ideally be done by upstream. Alternatively, it should be done in `spkg-src`, but certainly not in `spkg-install`. Autotools are not a Sage prerequisite.\n\nI am acutely aware of this; upstream is not doing bootstrapping in the release in question.\nAlso, note that the ticket status is \"new\". I'll sort this out after the bigger issues are fixed.",
    "created_at": "2015-07-26T16:35:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265115",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@jdemeyer](#comment%3A27):
> This is bad:
> 
> ```diff
> diff --git a/build/pkgs/maxima/spkg-install b/build/pkgs/maxima/spkg-install
> index 3c80e5c..b08d0d7 100755
> --- a/build/pkgs/maxima/spkg-install
> +++ b/build/pkgs/maxima/spkg-install
> @@ -47,6 +47,7 @@ done
>  echo
>  echo "Now configuring Maxima..."
> +./bootstrap
>  ./configure --prefix="$SAGE_LOCAL" --libdir="$SAGE_LOCAL/lib" --enable-ecl git_found=false
>  check_error "Failed to configure Maxima."
> ```
> 
> Bootstrapping should ideally be done by upstream. Alternatively, it should be done in `spkg-src`, but certainly not in `spkg-install`. Autotools are not a Sage prerequisite.

I am acutely aware of this; upstream is not doing bootstrapping in the release in question.
Also, note that the ticket status is "new". I'll sort this out after the bigger issues are fixed.



---

archive/issue_comments_265116.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@jdemeyer](#comment%3A28):\n> Replying to [@dimpase](#comment%3A13):\n> > spkg-src is outdated anyway.\n> \n> \n> [citation needed]\n\nI meant to say that parts of this spkg-src need an update.",
    "created_at": "2015-07-27T08:47:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265116",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@jdemeyer](#comment%3A28):
> Replying to [@dimpase](#comment%3A13):
> > spkg-src is outdated anyway.
> 
> 
> [citation needed]

I meant to say that parts of this spkg-src need an update.



---

archive/issue_comments_265117.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nwith sf.net back online, one finds there version 5.36.1. Not sure yet how much different it is from 5.36.0.1, which is not official...\n\n5.36.1 has the same issue with too many ()...",
    "created_at": "2015-07-28T15:40:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265117",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:31" align="right">comment:31</div>

with sf.net back online, one finds there version 5.36.1. Not sure yet how much different it is from 5.36.0.1, which is not official...

5.36.1 has the same issue with too many ()...



---

archive/issue_comments_265118.json:
```json
{
    "body": "Changed branch from **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)** to **[u/dimpase/updateecl](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/updateecl)**",
    "created_at": "2015-07-28T21:29:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265118",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)** to **[u/dimpase/updateecl](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/updateecl)**



---

archive/issue_comments_265119.json:
```json
{
    "body": "Changed commit from **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)** to **[`b669a43`](https://github.com/sagemath/sagetrac-mirror/commit/b669a434bdf2f91d21254ccf186bc86396dd4909)**",
    "created_at": "2015-07-28T21:29:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265119",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)** to **[`b669a43`](https://github.com/sagemath/sagetrac-mirror/commit/b669a434bdf2f91d21254ccf186bc86396dd4909)**



---

archive/issue_comments_265120.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1a0e5c9148fb20c19374d0c761cc9c10b9027e3a\"><code>1a0e5c9</code></a></td><td><code>initial update; implib.patch is problematic</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b669a434bdf2f91d21254ccf186bc86396dd4909\"><code>b669a43</code></a></td><td><code>fixed broken Makefile.in patch (spaces and tabs don't mix), reorganised patches.</code></td></tr></table>\n",
    "created_at": "2015-07-28T21:29:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265120",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1a0e5c9148fb20c19374d0c761cc9c10b9027e3a"><code>1a0e5c9</code></a></td><td><code>initial update; implib.patch is problematic</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b669a434bdf2f91d21254ccf186bc86396dd4909"><code>b669a43</code></a></td><td><code>fixed broken Makefile.in patch (spaces and tabs don't mix), reorganised patches.</code></td></tr></table>




---

archive/issue_events_266147.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-28T22:26:27Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "title_is": "upgrade Maxima  to 5.36.1",
    "title_was": "upgrade Maxima and ECL to 5.36.0.1 and 15.3.7, respectively",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266147"
}
```



---

archive/issue_comments_265121.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI've split the update of ECL to a separate ticket #18961, as it is ready.",
    "created_at": "2015-07-28T22:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265121",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:33" align="right">comment:33</div>

I've split the update of ECL to a separate ticket #18961, as it is ready.



---

archive/issue_comments_265122.json:
```json
{
    "body": "Changed branch from **[u/dimpase/updateecl](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/updateecl)** to **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)**",
    "created_at": "2015-07-28T22:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265122",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/dimpase/updateecl](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/updateecl)** to **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)**



---

archive/issue_comments_265123.json:
```json
{
    "body": "Dependencies: **#18961**",
    "created_at": "2015-07-28T22:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265123",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#18961**



---

archive/issue_comments_265124.json:
```json
{
    "body": "Changed commit from **[`b669a43`](https://github.com/sagemath/sagetrac-mirror/commit/b669a434bdf2f91d21254ccf186bc86396dd4909)** to **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)**",
    "created_at": "2015-07-28T22:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265124",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`b669a43`](https://github.com/sagemath/sagetrac-mirror/commit/b669a434bdf2f91d21254ccf186bc86396dd4909)** to **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)**



---

archive/issue_comments_265125.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,7 +1,5 @@\n this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).\n \n * get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...\n-* ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball\n-  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too. But it is not useful without renaming, etc.\n \n-ecl tarball to use is [here](http://users.ox.ac.uk/~coml0531/sage/ecl-15.3.7.tar.bz2)\n+ECL is updated on #18961\n``````\n",
    "created_at": "2015-07-28T22:26:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265125",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,7 +1,5 @@
 this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).
 
 * get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...
-* ECL git [here](https://gitlab.com/embeddable-common-lisp/ecl.git) and apparently the tarball
-  can be obtained [there](https://gitlab.com/embeddable-common-lisp/ecl/repository/archive.tar.gz?ref=ECL.15.3.7), too. But it is not useful without renaming, etc.
 
-ecl tarball to use is [here](http://users.ox.ac.uk/~coml0531/sage/ecl-15.3.7.tar.bz2)
+ECL is updated on #18961
``````




---

archive/issue_comments_265126.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@nbruin](#comment%3A24):\n> Replying to [@dimpase](#comment%3A23):\n\n \n> The binary conversion `sr_to_max` in `maxima_lib.py`  shouldn't be affected, unless they have changed their internal representation of polylogarithms.\n\nThey say the change is a [by-product to fix another bug](http://sourceforge.net/p/maxima/bugs/2998/#09b6). Obviously it is a low priority for them to make the output backwards compatible. I wonder if we should just fully switch to `maxima_lib.py` and do not try to deal with this in some other way?",
    "created_at": "2015-08-01T08:50:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265126",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@nbruin](#comment%3A24):
> Replying to [@dimpase](#comment%3A23):

 
> The binary conversion `sr_to_max` in `maxima_lib.py`  shouldn't be affected, unless they have changed their internal representation of polylogarithms.

They say the change is a [by-product to fix another bug](http://sourceforge.net/p/maxima/bugs/2998/#09b6). Obviously it is a low priority for them to make the output backwards compatible. I wonder if we should just fully switch to `maxima_lib.py` and do not try to deal with this in some other way?



---

archive/issue_comments_265127.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@dimpase](#comment%3A34):\n> They say the change is a [by-product to fix another bug](http://sourceforge.net/p/maxima/bugs/2998/#09b6). Obviously it is a low priority for them to make the output backwards compatible. I wonder if we should just fully switch to `maxima_lib.py` and do not try to deal with this in some other way?\n\nRobert isn't making any statement there about priority. I would not think it's a very low priority, because the current behaviour is tantamount to writing `(sin)(x)`, which is silly. I would not be surprised if in the next couple of weeks, when he has had a chance to think about a solution, he will have a fix. I'm sure it's not hard to fix. It just needs some thought to fix it properly and efficiently.\n\nIn terms of total amount of work, I would think introducing \"curried\" poylog and psi will be less work than eliminating any dependence on string parsing from maxima.\n\nFor calculus use, we're already moved entirely to maxima_lib. The library instance just allows two interfaces back and forth: a strings-based one and the binary `sr_to_max` and `max_to_sr` one.\nMoving calculus entirely to `sr_to_max` is a nice idea in general, and that's a worthwhile project that should be quite doable (we're halfway there already and it didn't take much work to do that).\nIt would mean identifying all remaining places where calculus triggers string conversions and replace those sites with mechanisms comparable to sr_integral, sr_limit, sr_sum etc.\n\nI think it's worthwhile if somehow we do maintain the pexpect interface to maxima as well, even if we don't need it for the calculus functionality in sage proper (and since the strings-based interface in maxima_lib shares nearly all its code with that, we might as well keep that too). Having the pexpect interfaces in sage is a useful feature for communicating with other computer algebra systems.",
    "created_at": "2015-08-01T20:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265127",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@dimpase](#comment%3A34):
> They say the change is a [by-product to fix another bug](http://sourceforge.net/p/maxima/bugs/2998/#09b6). Obviously it is a low priority for them to make the output backwards compatible. I wonder if we should just fully switch to `maxima_lib.py` and do not try to deal with this in some other way?

Robert isn't making any statement there about priority. I would not think it's a very low priority, because the current behaviour is tantamount to writing `(sin)(x)`, which is silly. I would not be surprised if in the next couple of weeks, when he has had a chance to think about a solution, he will have a fix. I'm sure it's not hard to fix. It just needs some thought to fix it properly and efficiently.

In terms of total amount of work, I would think introducing "curried" poylog and psi will be less work than eliminating any dependence on string parsing from maxima.

For calculus use, we're already moved entirely to maxima_lib. The library instance just allows two interfaces back and forth: a strings-based one and the binary `sr_to_max` and `max_to_sr` one.
Moving calculus entirely to `sr_to_max` is a nice idea in general, and that's a worthwhile project that should be quite doable (we're halfway there already and it didn't take much work to do that).
It would mean identifying all remaining places where calculus triggers string conversions and replace those sites with mechanisms comparable to sr_integral, sr_limit, sr_sum etc.

I think it's worthwhile if somehow we do maintain the pexpect interface to maxima as well, even if we don't need it for the calculus functionality in sage proper (and since the strings-based interface in maxima_lib shares nearly all its code with that, we might as well keep that too). Having the pexpect interfaces in sage is a useful feature for communicating with other computer algebra systems.



---

archive/issue_comments_265128.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@nbruin](#comment%3A35):\n> Replying to [@dimpase](#comment%3A34):\n> > They say the change is a [by-product to fix another bug](http://sourceforge.net/p/maxima/bugs/2998/#09b6). Obviously it is a low priority for them to make the output backwards compatible. I wonder if we should just fully switch to `maxima_lib.py` and do not try to deal with this in some other way?\n> \n> \n> Robert isn't making any statement there about priority. I would not think it's a very low priority, because the current behaviour is tantamount to writing `(sin)(x)`, which is silly. I would not be surprised if in the next couple of weeks, when he has had a chance to think about a solution, he will have a fix. I'm sure it's not hard to fix. It just needs some thought to fix it properly and efficiently.\n> \n\nhe replied, saying that he does not see a way to fix this, and that Sage has to put up with this for the time being. \n\nI'd rather see this fixed im maxima, of course, but this is probably a nontrivial job for a Lisp hacker we don't have...",
    "created_at": "2015-08-04T08:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265128",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@nbruin](#comment%3A35):
> Replying to [@dimpase](#comment%3A34):
> > They say the change is a [by-product to fix another bug](http://sourceforge.net/p/maxima/bugs/2998/#09b6). Obviously it is a low priority for them to make the output backwards compatible. I wonder if we should just fully switch to `maxima_lib.py` and do not try to deal with this in some other way?
> 
> 
> Robert isn't making any statement there about priority. I would not think it's a very low priority, because the current behaviour is tantamount to writing `(sin)(x)`, which is silly. I would not be surprised if in the next couple of weeks, when he has had a chance to think about a solution, he will have a fix. I'm sure it's not hard to fix. It just needs some thought to fix it properly and efficiently.
> 

he replied, saying that he does not see a way to fix this, and that Sage has to put up with this for the time being. 

I'd rather see this fixed im maxima, of course, but this is probably a nontrivial job for a Lisp hacker we don't have...



---

archive/issue_comments_265129.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nQuick workaround:\n\n```\necl_eval(\"(defprop $LI 210 rbp)\")\necl_eval(\"(defprop $PSI 210 rbp)\")\n```\nit certainly avoids the extra parentheses around `li` and `psi` invocations. I've reported this workaround on the maxima bugtracker too. Hopefully Robert will comment there about any possible adverse effects. Including these statements in the maxima_calculus initialization in `maxima_lib.py` might do the trick (and possibly the change is accepted upstream!)\n\n**EDIT:** A better and more universal change is probably:\n\n```\necl_eval(\"(defprop MFUNCTION 190 lbp)\")\n```\nThis way it applies to all \"MQAPPLY\" calls. That could be problematic, of course, but it doesn't seem to be, probably because 190 is still high enough. Things go wrong if you go too low:\n\n```\nsage: maxima_calculus(\"(a+b)(t)\")\n(b+a)(t)\nsage: ecl_eval(\"(defprop MFUNCTION 1 lbp)\")\n<ECL: 1>\nsage: maxima_calculus(\"(a+b)(t)\")\nb+a(t)\n```",
    "created_at": "2015-08-04T23:35:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265129",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:37" align="right">comment:37</div>

Quick workaround:

```
ecl_eval("(defprop $LI 210 rbp)")
ecl_eval("(defprop $PSI 210 rbp)")
```
it certainly avoids the extra parentheses around `li` and `psi` invocations. I've reported this workaround on the maxima bugtracker too. Hopefully Robert will comment there about any possible adverse effects. Including these statements in the maxima_calculus initialization in `maxima_lib.py` might do the trick (and possibly the change is accepted upstream!)

**EDIT:** A better and more universal change is probably:

```
ecl_eval("(defprop MFUNCTION 190 lbp)")
```
This way it applies to all "MQAPPLY" calls. That could be problematic, of course, but it doesn't seem to be, probably because 190 is still high enough. Things go wrong if you go too low:

```
sage: maxima_calculus("(a+b)(t)")
(b+a)(t)
sage: ecl_eval("(defprop MFUNCTION 1 lbp)")
<ECL: 1>
sage: maxima_calculus("(a+b)(t)")
b+a(t)
```



---

archive/issue_comments_265130.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nOf course, the expression type that gets constructed for `li` and `psi` is more general:\n\n```\nsage: maxima_calculus(\"a[1](x)\")\na[1](x)\nsage: maxima_calculus(\"a[1](x)\").ecl()\n<ECL: ((MQAPPLY SIMP) (($A SIMP ARRAY) 1) $X)>\n```\nbut we already fail with that (because we carefully only convert `li[` and `psi[`):\n\n```\nsage: SR(maxima_calculus(\"a[1](x)\"))\nTypeError: unable to make sense of Maxima expression 'a[1](x)' in Sage\n```\nSince square brackets are really part of Maxima's expression syntax, the proper solution would be to have a parser that can handle them. The following seems valid maxima:\n\n```\nsage: maxima_calculus(\"(sin(x)+cos(y))[tan(u)[3/(a+b)]+log(w)](t)\")\n(cos(y)+sin(x))[log(w)+tan(u)[3/(b+a)]](t)\n```\nand parsing that with anything less than parser support for `[` will be. Of course, without `[]` support on the side of pynac, we'd have to parse `a[n]` to something like `get_item(a,n)` but that would be fine (and then `get_item` can have the right logic to actually resolve in relevant cases, but this would be more an extension of our symbolic expressions before it's a parsing issue for maxima)",
    "created_at": "2015-08-05T20:14:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265130",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:38" align="right">comment:38</div>

Of course, the expression type that gets constructed for `li` and `psi` is more general:

```
sage: maxima_calculus("a[1](x)")
a[1](x)
sage: maxima_calculus("a[1](x)").ecl()
<ECL: ((MQAPPLY SIMP) (($A SIMP ARRAY) 1) $X)>
```
but we already fail with that (because we carefully only convert `li[` and `psi[`):

```
sage: SR(maxima_calculus("a[1](x)"))
TypeError: unable to make sense of Maxima expression 'a[1](x)' in Sage
```
Since square brackets are really part of Maxima's expression syntax, the proper solution would be to have a parser that can handle them. The following seems valid maxima:

```
sage: maxima_calculus("(sin(x)+cos(y))[tan(u)[3/(a+b)]+log(w)](t)")
(cos(y)+sin(x))[log(w)+tan(u)[3/(b+a)]](t)
```
and parsing that with anything less than parser support for `[` will be. Of course, without `[]` support on the side of pynac, we'd have to parse `a[n]` to something like `get_item(a,n)` but that would be fine (and then `get_item` can have the right logic to actually resolve in relevant cases, but this would be more an extension of our symbolic expressions before it's a parsing issue for maxima)



---

archive/issue_comments_265131.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nThe maxima ticket [https://sourceforge.net/p/maxima/bugs/2998/](https://sourceforge.net/p/maxima/bugs/2998/) is now marked as resolved, so with any luck, the extra parentheses issue will not occur with the new maxima release.\n\nThe fix implemented is indeed `ecl_eval(\"(defprop MFUNCTION 190 lbp)\")`, so if you do not want to wait for the next maxima release, just put this command in the initialization section of `maxima_lib`.",
    "created_at": "2015-08-11T19:54:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265131",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:39" align="right">comment:39</div>

The maxima ticket [https://sourceforge.net/p/maxima/bugs/2998/](https://sourceforge.net/p/maxima/bugs/2998/) is now marked as resolved, so with any luck, the extra parentheses issue will not occur with the new maxima release.

The fix implemented is indeed `ecl_eval("(defprop MFUNCTION 190 lbp)")`, so if you do not want to wait for the next maxima release, just put this command in the initialization section of `maxima_lib`.



---

archive/issue_comments_265132.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nI tried upgrading to Maxima 5.37.0 (released 17 August).  The formatting problem is fixed, although some of the output still looks slightly different (more/fewer parentheses, different ordering of terms in some polynomials).\n\nHowever, there is a serious bug in the function `eigenvectors` causing too few eigenvectors to be returned:\n\n```\n(%i1) M: matrix([1, 1, 0], [0, 1, 0], [0, 0, 2]);\n                                  [ 1  1  0 ]\n                                  [         ]\n(%o1)                             [ 0  1  0 ]\n                                  [         ]\n                                  [ 0  0  2 ]\n```\nMaxima 5.35.1 computes the eigenvalues and eigenvectors correctly:\n\n```\n(%i2) eigenvectors(M);\n(%o2)           [[[1, 2], [2, 1]], [[[1, 0, 0]], [[0, 0, 1]]]]\n```\nIn Maxima 5.37.0, the eigenvector `[0, 0, 1]` is missing:\n\n```\n(%i2) eigenvectors(M);\n(%o2)                  [[[1, 2], [2, 1]], [[[1, 0, 0]]]]\n```\nI found this out through several doctest failures in Sage.",
    "created_at": "2015-08-28T21:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265132",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:40" align="right">comment:40</div>

I tried upgrading to Maxima 5.37.0 (released 17 August).  The formatting problem is fixed, although some of the output still looks slightly different (more/fewer parentheses, different ordering of terms in some polynomials).

However, there is a serious bug in the function `eigenvectors` causing too few eigenvectors to be returned:

```
(%i1) M: matrix([1, 1, 0], [0, 1, 0], [0, 0, 2]);
                                  [ 1  1  0 ]
                                  [         ]
(%o1)                             [ 0  1  0 ]
                                  [         ]
                                  [ 0  0  2 ]
```
Maxima 5.35.1 computes the eigenvalues and eigenvectors correctly:

```
(%i2) eigenvectors(M);
(%o2)           [[[1, 2], [2, 1]], [[[1, 0, 0]], [[0, 0, 1]]]]
```
In Maxima 5.37.0, the eigenvector `[0, 0, 1]` is missing:

```
(%i2) eigenvectors(M);
(%o2)                  [[[1, 2], [2, 1]], [[[1, 0, 0]]]]
```
I found this out through several doctest failures in Sage.



---

archive/issue_comments_265133.json:
```json
{
    "body": "Upstream: **Not yet reported upstream; Will do shortly.**",
    "created_at": "2015-08-28T21:50:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265133",
    "user": "https://github.com/pjbruin"
}
```

Upstream: **Not yet reported upstream; Will do shortly.**



---

archive/issue_comments_265134.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nUpstream bug report: https://sourceforge.net/p/maxima/bugs/3008/",
    "created_at": "2015-08-28T22:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265134",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:41" align="right">comment:41</div>

Upstream bug report: https://sourceforge.net/p/maxima/bugs/3008/



---

archive/issue_comments_265135.json:
```json
{
    "body": "Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**",
    "created_at": "2015-08-28T22:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265135",
    "user": "https://github.com/pjbruin"
}
```

Changed upstream from **Not yet reported upstream; Will do shortly.** to **Reported upstream. No feedback yet.**



---

archive/issue_comments_265136.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nIt seems that version 5.38 was released a few months ago, and we are currently at 5.35.1. I think we can upgrade now since the reported bug was fixed.",
    "created_at": "2016-07-02T18:37:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265136",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:42" align="right">comment:42</div>

It seems that version 5.38 was released a few months ago, and we are currently at 5.35.1. I think we can upgrade now since the reported bug was fixed.



---

archive/issue_events_266148.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-07-02T18:38:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266148"
}
```



---

archive/issue_events_266149.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2016-07-02T18:38:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266149"
}
```



---

archive/issue_comments_265137.json:
```json
{
    "body": "Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2016-07-02T18:38:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265137",
    "user": "https://github.com/tscrim"
}
```

Changed upstream from **Reported upstream. No feedback yet.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_265138.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@tscrim](#comment%3A42):\n> It seems that version 5.38 was released a few months ago, and we are currently at 5.35.1. I think we can upgrade now since the reported bug was fixed.\n\nNote that the bug fix is only in the development branch, not in 5.38.1.  We can of course add the relevant upstream commit (3e4e107) as a patch.",
    "created_at": "2016-07-04T08:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265138",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@tscrim](#comment%3A42):
> It seems that version 5.38 was released a few months ago, and we are currently at 5.35.1. I think we can upgrade now since the reported bug was fixed.

Note that the bug fix is only in the development branch, not in 5.38.1.  We can of course add the relevant upstream commit (3e4e107) as a patch.



---

archive/issue_comments_265139.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nShall we then move forward then with upgrading to 5.38.1 with backporting 3e4e107 as a patch? Or should we ask the Maxima team to see how close they are to cutting a 5.38.2?",
    "created_at": "2016-08-26T20:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265139",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:45" align="right">comment:45</div>

Shall we then move forward then with upgrading to 5.38.1 with backporting 3e4e107 as a patch? Or should we ask the Maxima team to see how close they are to cutting a 5.38.2?



---

archive/issue_comments_265140.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nit's about time. Should I have a go at it?",
    "created_at": "2016-08-29T10:06:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265140",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:46" align="right">comment:46</div>

it's about time. Should I have a go at it?



---

archive/issue_events_266150.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-08-29T10:06:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-7.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266150"
}
```



---

archive/issue_events_266151.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-08-29T10:06:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266151"
}
```



---

archive/issue_events_266152.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-08-29T10:06:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "title_is": "upgrade Maxima  to version >= 5.38.1",
    "title_was": "upgrade Maxima  to 5.36.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266152"
}
```



---

archive/issue_comments_265141.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nPlease do. We have to make sagemath 7.4 work with maxima 5.38.1 in Debian and it would help if we had a patch that we could backport.",
    "created_at": "2016-10-27T12:36:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265141",
    "user": "https://github.com/tobihan"
}
```

<div id="comment:47" align="right">comment:47</div>

Please do. We have to make sagemath 7.4 work with maxima 5.38.1 in Debian and it would help if we had a patch that we could backport.



---

archive/issue_comments_265142.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nDima, can you rebase your branch?",
    "created_at": "2016-10-27T21:26:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265142",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:48" align="right">comment:48</div>

Dima, can you rebase your branch?



---

archive/issue_comments_265143.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nWill try later today.",
    "created_at": "2016-10-27T21:29:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265143",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:49" align="right">comment:49</div>

Will try later today.



---

archive/issue_comments_265144.json:
```json
{
    "body": "Changed branch from **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)** to **[public/t18920](https://github.com/sagemath/sagetrac-mirror/tree/public/t18920)**",
    "created_at": "2016-10-27T23:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265144",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[u/dimpase/eclupdate](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/eclupdate)** to **[public/t18920](https://github.com/sagemath/sagetrac-mirror/tree/public/t18920)**



---

archive/issue_comments_265145.json:
```json
{
    "body": "Changed dependencies from **#18961** to none",
    "created_at": "2016-10-27T23:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265145",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#18961** to none



---

archive/issue_comments_265146.json:
```json
{
    "body": "Changed commit from **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)** to **[`2310020`](https://github.com/sagemath/sagetrac-mirror/commit/231002039aeed3f1926ec58804bd538b5ec9385d)**",
    "created_at": "2016-10-27T23:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265146",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`0d0649a`](https://github.com/sagemath/sagetrac-mirror/commit/0d0649ad925808a308084b04253d7eb5c3fe2fad)** to **[`2310020`](https://github.com/sagemath/sagetrac-mirror/commit/231002039aeed3f1926ec58804bd538b5ec9385d)**



---

archive/issue_comments_265147.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nrebased the relevant patches\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee327bc0644fef99791776269bda2d15f59af6e2\"><code>ee327bc</code></a></td><td><code>ported maxima patches; tarball needs bootstrapping; trivial doctests fix</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/231002039aeed3f1926ec58804bd538b5ec9385d\"><code>2310020</code></a></td><td><code>some easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2016-10-27T23:58:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265147",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:50" align="right">comment:50</div>

rebased the relevant patches

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee327bc0644fef99791776269bda2d15f59af6e2"><code>ee327bc</code></a></td><td><code>ported maxima patches; tarball needs bootstrapping; trivial doctests fix</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/231002039aeed3f1926ec58804bd538b5ec9385d"><code>2310020</code></a></td><td><code>some easy doctest fixes</code></td></tr></table>




---

archive/issue_comments_265148.json:
```json
{
    "body": "Work Issues: **rebase the rest of Maxima patches**",
    "created_at": "2016-10-28T00:17:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265148",
    "user": "https://github.com/dimpase"
}
```

Work Issues: **rebase the rest of Maxima patches**



---

archive/issue_comments_265149.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nSo far, only the relevant commits from the old branch are rebased. I still have to fix patches to Maxima sources -- they don't apply cleanly.",
    "created_at": "2016-10-28T00:17:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265149",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:51" align="right">comment:51</div>

So far, only the relevant commits from the old branch are rebased. I still have to fix patches to Maxima sources -- they don't apply cleanly.



---

archive/issue_comments_265150.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nWe'll also want to move to maxima 5.38.1 at least.",
    "created_at": "2016-10-28T01:34:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265150",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:52" align="right">comment:52</div>

We'll also want to move to maxima 5.38.1 at least.



---

archive/issue_comments_265151.json:
```json
{
    "body": "Changed commit from **[`2310020`](https://github.com/sagemath/sagetrac-mirror/commit/231002039aeed3f1926ec58804bd538b5ec9385d)** to **[`a4bf716`](https://github.com/sagemath/sagetrac-mirror/commit/a4bf7166892c6dae760cd2cd1c84f5cb9675ef15)**",
    "created_at": "2016-10-28T02:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265151",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`2310020`](https://github.com/sagemath/sagetrac-mirror/commit/231002039aeed3f1926ec58804bd538b5ec9385d)** to **[`a4bf716`](https://github.com/sagemath/sagetrac-mirror/commit/a4bf7166892c6dae760cd2cd1c84f5cb9675ef15)**



---

archive/issue_comments_265152.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a4bf7166892c6dae760cd2cd1c84f5cb9675ef15\"><code>a4bf716</code></a></td><td><code>rebased patches, added eigenvectors patch too</code></td></tr></table>\n",
    "created_at": "2016-10-28T02:57:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265152",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a4bf7166892c6dae760cd2cd1c84f5cb9675ef15"><code>a4bf716</code></a></td><td><code>rebased patches, added eigenvectors patch too</code></td></tr></table>




---

archive/issue_comments_265153.json:
```json
{
    "body": "Changed work issues from **rebase the rest of Maxima patches** to **fix doctests, if any.**",
    "created_at": "2016-10-28T03:01:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265153",
    "user": "https://github.com/dimpase"
}
```

Changed work issues from **rebase the rest of Maxima patches** to **fix doctests, if any.**



---

archive/issue_comments_265154.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,3 @@\n this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).\n \n-* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...\n-\n-ECL is updated on #18961\n+* get Maxima 5.38.1 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)\n``````\n",
    "created_at": "2016-10-28T03:01:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265154",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,3 @@
 this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).
 
-* get Maxima [here](https://github.com/andrejv/maxima) (then `git checkout 5.36.0.1`); the [tarball](https://github.com/andrejv/maxima/archive/5.36.0.1.tar.gz); note that sf.net with tarballs is down...
-
-ECL is updated on #18961
+* get Maxima 5.38.1 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)
``````




---

archive/issue_comments_265155.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2016-10-28T03:01:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265155",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_events_266153.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-10-28T03:01:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-7.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266153"
}
```



---

archive/issue_events_266154.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-10-28T03:01:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266154"
}
```



---

archive/issue_comments_265156.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nthis seems to be a change:\n\n```\nFile \"src/sage/interfaces/maxima.py\", line 210, in sage.interfaces.maxima\nFailed example:\n    g.taylor('x', 0, 3)\nExpected:\n    x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152\nGot:\n    f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945\n```\nthere `f` is defined as <code>f=maxima(\\`1/x^2\\`)</code>, so this no longer works, defining maxima\nfunctions this way.\n\nAnyhow, I'm pushing the other doctest changes for this file, and few other.",
    "created_at": "2016-10-28T05:05:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265156",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:55" align="right">comment:55</div>

this seems to be a change:

```
File "src/sage/interfaces/maxima.py", line 210, in sage.interfaces.maxima
Failed example:
    g.taylor('x', 0, 3)
Expected:
    x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152
Got:
    f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945
```
there `f` is defined as <code>f=maxima(\`1/x^2\`)</code>, so this no longer works, defining maxima
functions this way.

Anyhow, I'm pushing the other doctest changes for this file, and few other.



---

archive/issue_comments_265157.json:
```json
{
    "body": "Changed commit from **[`a4bf716`](https://github.com/sagemath/sagetrac-mirror/commit/a4bf7166892c6dae760cd2cd1c84f5cb9675ef15)** to **[`62b5825`](https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752)**",
    "created_at": "2016-10-28T05:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265157",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`a4bf716`](https://github.com/sagemath/sagetrac-mirror/commit/a4bf7166892c6dae760cd2cd1c84f5cb9675ef15)** to **[`62b5825`](https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752)**



---

archive/issue_comments_265158.json:
```json
{
    "body": "<div id=\"comment:56\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752\"><code>62b5825</code></a></td><td><code>some more easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2016-10-28T05:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265158",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:56"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752"><code>62b5825</code></a></td><td><code>some more easy doctest fixes</code></td></tr></table>




---

archive/issue_comments_265159.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nthe following looks to me like a regression (or perhaps it's not really, as if one picked the right branches of the corresponding complex variable functions, it would be correct) :\n\n```\nFile \"src/sage/calculus/tests.py\", line 107, in sage.calculus.tests\nFailed example:\n    integrate(log(1-x^2)/x, x)\nExpected:\n    1/2*log(x^2)*log(-x^2 + 1) + 1/2*polylog(2, -x^2 + 1)\nGot:\n    log(-x)*log(x + 1) + log(x)*log(-x + 1) + polylog(2, x + 1) + polylog(2, -x + 1)\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752\"><code>62b5825</code></a></td><td><code>some more easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2016-10-28T13:01:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265159",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:57" align="right">comment:57</div>

the following looks to me like a regression (or perhaps it's not really, as if one picked the right branches of the corresponding complex variable functions, it would be correct) :

```
File "src/sage/calculus/tests.py", line 107, in sage.calculus.tests
Failed example:
    integrate(log(1-x^2)/x, x)
Expected:
    1/2*log(x^2)*log(-x^2 + 1) + 1/2*polylog(2, -x^2 + 1)
Got:
    log(-x)*log(x + 1) + log(x)*log(-x + 1) + polylog(2, x + 1) + polylog(2, -x + 1)
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752"><code>62b5825</code></a></td><td><code>some more easy doctest fixes</code></td></tr></table>




---

archive/issue_comments_265160.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nand another regression of sorts: despite `besselexpand` set to False, one gets\n\n```\nFile \"src/sage/interfaces/maxima_lib.py\", line 66, in sage.interfaces.maxima_lib\nFailed example:\n    sum((-x)^n/(factorial(n)*factorial(n+3/2)),n,0,oo)\nExpected:\n    bessel_J(3/2, 2*sqrt(x))/x^(3/4)\nGot:\n    -1/2*(2*x*cos(2*sqrt(x)) - sqrt(x)*sin(2*sqrt(x)))/(sqrt(pi)*x^2)\n```\n\nPerhaps it's a deficiency of our test, which is too simple for `besselexpand` to kick in.",
    "created_at": "2016-10-28T13:13:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265160",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:58" align="right">comment:58</div>

and another regression of sorts: despite `besselexpand` set to False, one gets

```
File "src/sage/interfaces/maxima_lib.py", line 66, in sage.interfaces.maxima_lib
Failed example:
    sum((-x)^n/(factorial(n)*factorial(n+3/2)),n,0,oo)
Expected:
    bessel_J(3/2, 2*sqrt(x))/x^(3/4)
Got:
    -1/2*(2*x*cos(2*sqrt(x)) - sqrt(x)*sin(2*sqrt(x)))/(sqrt(pi)*x^2)
```

Perhaps it's a deficiency of our test, which is too simple for `besselexpand` to kick in.



---

archive/issue_comments_265161.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nthis one needs work:\n\n```\nFile \"src/sage/interfaces/maxima_lib.py\", line 724, in sage.interfaces.maxima_lib.Ma\nximaLib.sr_integral\nFailed example:\n    integrate(1 / (1 + abs(x-5)), x, -5, 6)\nException raised:\n    Traceback (most recent call last):\n    ...\n    TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage\n```",
    "created_at": "2016-10-28T13:25:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265161",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:59" align="right">comment:59</div>

this one needs work:

```
File "src/sage/interfaces/maxima_lib.py", line 724, in sage.interfaces.maxima_lib.Ma
ximaLib.sr_integral
Failed example:
    integrate(1 / (1 + abs(x-5)), x, -5, 6)
Exception raised:
    Traceback (most recent call last):
    ...
    TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage
```



---

archive/issue_comments_265162.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nand this one is puzzling on the Sage side:\n\n```\nFile \"src/sage/misc/functional.py\", line 658, in sage.misc.functional.integral\nFailed example:\n    _ = integrate(y, x, -1000, 1000)\nException raised:\n...\n    FloatingPointError: Floating point exception\n```\nand comes from a regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).\n\n```\nMaxima 5.38.1 http://maxima.sourceforge.net\nusing Lisp ECL 16.1.2\nDistributed under the GNU Public License. See the file COPYING.\nDedicated to the memory of William Schelter.\nThe function bug_report() provides bug reporting information.\n(%i1) integrate((x^2)*exp(x) / (1 + exp(x))^2,x,-1000,1000);\n\nMaxima encountered a Lisp error:\n\n #<a ARITHMETIC-ERROR>\n\nAutomatically continuing.\nTo enable the Lisp debugger set *debugger-hook* to nil.\n```",
    "created_at": "2016-10-28T13:31:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265162",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:60" align="right">comment:60</div>

and this one is puzzling on the Sage side:

```
File "src/sage/misc/functional.py", line 658, in sage.misc.functional.integral
Failed example:
    _ = integrate(y, x, -1000, 1000)
Exception raised:
...
    FloatingPointError: Floating point exception
```
and comes from a regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).

```
Maxima 5.38.1 http://maxima.sourceforge.net
using Lisp ECL 16.1.2
Distributed under the GNU Public License. See the file COPYING.
Dedicated to the memory of William Schelter.
The function bug_report() provides bug reporting information.
(%i1) integrate((x^2)*exp(x) / (1 + exp(x))^2,x,-1000,1000);

Maxima encountered a Lisp error:

 #<a ARITHMETIC-ERROR>

Automatically continuing.
To enable the Lisp debugger set *debugger-hook* to nil.
```



---

archive/issue_comments_265163.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nthis one needs an expert opinion:\n\n```\nFile \"src/sage/schemes/projective/projective_morphism.py\", line 853, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.dynatomic_polynomial\nFailed example:\n    f.dynatomic_polynomial(2)\nExpected:\n    0.666666666666667*x^2 + 0.333333333333333*y^2\nGot:\n    2.00000000000000*x^2 + 0.999999999999999*y^2\n```\nThe output is clearly different, but perhaps it's OK, I don't know---I suspect it's OK, as we must be interested in the projective points where it vanishes(?) - documentation talks about \"roots\" though, and these, projectively, remain the same.",
    "created_at": "2016-10-28T13:34:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265163",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:61" align="right">comment:61</div>

this one needs an expert opinion:

```
File "src/sage/schemes/projective/projective_morphism.py", line 853, in sage.schemes.projective.projective_morphism.SchemeMorphism_polynomial_projective_space.dynatomic_polynomial
Failed example:
    f.dynatomic_polynomial(2)
Expected:
    0.666666666666667*x^2 + 0.333333333333333*y^2
Got:
    2.00000000000000*x^2 + 0.999999999999999*y^2
```
The output is clearly different, but perhaps it's OK, I don't know---I suspect it's OK, as we must be interested in the projective points where it vanishes(?) - documentation talks about "roots" though, and these, projectively, remain the same.



---

archive/issue_comments_265164.json:
```json
{
    "body": "Changed commit from **[`62b5825`](https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752)** to **[`9ef994d`](https://github.com/sagemath/sagetrac-mirror/commit/9ef994d79cfe0af28d17d0951b709576647a4231)**",
    "created_at": "2016-10-28T13:44:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265164",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`62b5825`](https://github.com/sagemath/sagetrac-mirror/commit/62b5825544b467e481c7a752604b8d45c64d9752)** to **[`9ef994d`](https://github.com/sagemath/sagetrac-mirror/commit/9ef994d79cfe0af28d17d0951b709576647a4231)**



---

archive/issue_comments_265165.json:
```json
{
    "body": "<div id=\"comment:62\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9ef994d79cfe0af28d17d0951b709576647a4231\"><code>9ef994d</code></a></td><td><code>more easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2016-10-28T13:44:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265165",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:62"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9ef994d79cfe0af28d17d0951b709576647a4231"><code>9ef994d</code></a></td><td><code>more easy doctest fixes</code></td></tr></table>




---

archive/issue_events_266155.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-10-28T13:50:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266155"
}
```



---

archive/issue_comments_265166.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nsetting this to \"needs review\", so that the issues I raised in comments can be discussed.\n\nThere are still few easy doctest fixes to be done, I'll do them.",
    "created_at": "2016-10-28T13:50:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265166",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:63" align="right">comment:63</div>

setting this to "needs review", so that the issues I raised in comments can be discussed.

There are still few easy doctest fixes to be done, I'll do them.



---

archive/issue_comments_265167.json:
```json
{
    "body": "Changed commit from **[`9ef994d`](https://github.com/sagemath/sagetrac-mirror/commit/9ef994d79cfe0af28d17d0951b709576647a4231)** to **[`3c28022`](https://github.com/sagemath/sagetrac-mirror/commit/3c280228256c02dcba6e6a8df2bcb98625031613)**",
    "created_at": "2016-10-28T15:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265167",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9ef994d`](https://github.com/sagemath/sagetrac-mirror/commit/9ef994d79cfe0af28d17d0951b709576647a4231)** to **[`3c28022`](https://github.com/sagemath/sagetrac-mirror/commit/3c280228256c02dcba6e6a8df2bcb98625031613)**



---

archive/issue_comments_265168.json:
```json
{
    "body": "<div id=\"comment:64\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3c280228256c02dcba6e6a8df2bcb98625031613\"><code>3c28022</code></a></td><td><code>more easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2016-10-28T15:34:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265168",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:64"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3c280228256c02dcba6e6a8df2bcb98625031613"><code>3c28022</code></a></td><td><code>more easy doctest fixes</code></td></tr></table>




---

archive/issue_comments_265169.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@dimpase](#comment%3A60):\n\n>  regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).\n\nI opened https://sourceforge.net/p/maxima/bugs/3235/",
    "created_at": "2016-10-29T00:06:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265169",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@dimpase](#comment%3A60):

>  regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).

I opened https://sourceforge.net/p/maxima/bugs/3235/



---

archive/issue_comments_265170.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nReplying to [@dimpase](#comment%3A65):\n> Replying to [@dimpase](#comment%3A60):\n> \n> >  regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).\n> \n> \n> I opened https://sourceforge.net/p/maxima/bugs/3235/\n\nRobert Dodier has traced this down to a problem with ECL, see\nhttps://gitlab.com/embeddable-common-lisp/ecl/issues/299\n\nECL has a problem comparing their own (there is no Common Lisp standard for this)\ninfinity constants with 1/1000000...",
    "created_at": "2016-10-30T18:20:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265170",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:66" align="right">comment:66</div>

Replying to [@dimpase](#comment%3A65):
> Replying to [@dimpase](#comment%3A60):
> 
> >  regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).
> 
> 
> I opened https://sourceforge.net/p/maxima/bugs/3235/

Robert Dodier has traced this down to a problem with ECL, see
https://gitlab.com/embeddable-common-lisp/ecl/issues/299

ECL has a problem comparing their own (there is no Common Lisp standard for this)
infinity constants with 1/1000000...



---

archive/issue_comments_265171.json:
```json
{
    "body": "<div id=\"comment:67\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d864132139af098f417debdf28c2e4c83cd1d75\"><code>5d86413</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into max5381</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786\"><code>100d9d6</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr></table>\n",
    "created_at": "2016-11-03T17:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265171",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:67"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d864132139af098f417debdf28c2e4c83cd1d75"><code>5d86413</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into max5381</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786"><code>100d9d6</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr></table>




---

archive/issue_comments_265172.json:
```json
{
    "body": "Changed commit from **[`3c28022`](https://github.com/sagemath/sagetrac-mirror/commit/3c280228256c02dcba6e6a8df2bcb98625031613)** to **[`100d9d6`](https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786)**",
    "created_at": "2016-11-03T17:19:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265172",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3c28022`](https://github.com/sagemath/sagetrac-mirror/commit/3c280228256c02dcba6e6a8df2bcb98625031613)** to **[`100d9d6`](https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786)**



---

archive/issue_comments_265173.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@dimpase](#comment%3A66):\n> Replying to [@dimpase](#comment%3A65):\n> > Replying to [@dimpase](#comment%3A60):\n> > \n> > >  regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).\n> > \n> > \n> > I opened https://sourceforge.net/p/maxima/bugs/3235/\n> \n> Robert Dodier has traced this down to a problem with ECL, see\n> https://gitlab.com/embeddable-common-lisp/ecl/issues/299\n> \n> ECL has a problem comparing their own (there is no Common Lisp standard for this)\n> infinity constants with 1/1000000...\n> \n\nthis is fixed by Maxima people, and in the latest commit 100d9d6",
    "created_at": "2016-11-03T17:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265173",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@dimpase](#comment%3A66):
> Replying to [@dimpase](#comment%3A65):
> > Replying to [@dimpase](#comment%3A60):
> > 
> > >  regression in Maxima/ECL version combo (I did check that with Maxima 5.38.1 running on SBCL 1.3.6 this integral computes just fine).
> > 
> > 
> > I opened https://sourceforge.net/p/maxima/bugs/3235/
> 
> Robert Dodier has traced this down to a problem with ECL, see
> https://gitlab.com/embeddable-common-lisp/ecl/issues/299
> 
> ECL has a problem comparing their own (there is no Common Lisp standard for this)
> infinity constants with 1/1000000...
> 

this is fixed by Maxima people, and in the latest commit 100d9d6



---

archive/issue_comments_265174.json:
```json
{
    "body": "<div id=\"comment:69\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/79eb82fe1db9479550ca27f37571291c18df0884\"><code>79eb82f</code></a></td><td><code>fix for maxima bug #3236</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/814e8edc2eb51ba9706c122a39bf75d3c77e141c\"><code>814e8ed</code></a></td><td><code>reflect patch's dependence on an earlier maxima tree commit</code></td></tr></table>\n",
    "created_at": "2016-11-06T22:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265174",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:69"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/79eb82fe1db9479550ca27f37571291c18df0884"><code>79eb82f</code></a></td><td><code>fix for maxima bug #3236</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/814e8edc2eb51ba9706c122a39bf75d3c77e141c"><code>814e8ed</code></a></td><td><code>reflect patch's dependence on an earlier maxima tree commit</code></td></tr></table>




---

archive/issue_comments_265175.json:
```json
{
    "body": "Changed commit from **[`100d9d6`](https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786)** to **[`814e8ed`](https://github.com/sagemath/sagetrac-mirror/commit/814e8edc2eb51ba9706c122a39bf75d3c77e141c)**",
    "created_at": "2016-11-06T22:28:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265175",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`100d9d6`](https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786)** to **[`814e8ed`](https://github.com/sagemath/sagetrac-mirror/commit/814e8edc2eb51ba9706c122a39bf75d3c77e141c)**



---

archive/issue_comments_265176.json:
```json
{
    "body": "<div id=\"comment:70\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af7e5ff2e30dfed8bcb4c597403a6a23eb93b86a\"><code>af7e5ff</code></a></td><td><code>new scaling of dynatomic polynomial</code></td></tr></table>\n",
    "created_at": "2016-11-07T00:22:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265176",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:70"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af7e5ff2e30dfed8bcb4c597403a6a23eb93b86a"><code>af7e5ff</code></a></td><td><code>new scaling of dynatomic polynomial</code></td></tr></table>




---

archive/issue_comments_265177.json:
```json
{
    "body": "Changed commit from **[`814e8ed`](https://github.com/sagemath/sagetrac-mirror/commit/814e8edc2eb51ba9706c122a39bf75d3c77e141c)** to **[`af7e5ff`](https://github.com/sagemath/sagetrac-mirror/commit/af7e5ff2e30dfed8bcb4c597403a6a23eb93b86a)**",
    "created_at": "2016-11-07T00:22:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265177",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`814e8ed`](https://github.com/sagemath/sagetrac-mirror/commit/814e8edc2eb51ba9706c122a39bf75d3c77e141c)** to **[`af7e5ff`](https://github.com/sagemath/sagetrac-mirror/commit/af7e5ff2e30dfed8bcb4c597403a6a23eb93b86a)**



---

archive/issue_comments_265178.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@sagetrac-git](#comment%3A67):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d864132139af098f417debdf28c2e4c83cd1d75\"><code>5d86413</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into max5381</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786\"><code>100d9d6</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr></table>\n\nthis workaround turned out to be buggy, and anyway ECL has released a fix for this problem, making the workaround not necessary. (But it would need an update of our ECL package, as it does depend upon a number of changes, see https://gitlab.com/embeddable-common-lisp/ecl/issues/299; they promise a new release by the end of the year). \n\nShould we wait, or should we proceed?",
    "created_at": "2016-11-08T13:00:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265178",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@sagetrac-git](#comment%3A67):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d864132139af098f417debdf28c2e4c83cd1d75"><code>5d86413</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into max5381</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/100d9d6516e4bcfbb93ee979f086f52072ace786"><code>100d9d6</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr></table>

this workaround turned out to be buggy, and anyway ECL has released a fix for this problem, making the workaround not necessary. (But it would need an update of our ECL package, as it does depend upon a number of changes, see https://gitlab.com/embeddable-common-lisp/ecl/issues/299; they promise a new release by the end of the year). 

Should we wait, or should we proceed?



---

archive/issue_comments_265179.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nI think we should either backport the fix as a patch to ECL or perhaps take a development cut.",
    "created_at": "2016-11-08T15:09:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265179",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:72" align="right">comment:72</div>

I think we should either backport the fix as a patch to ECL or perhaps take a development cut.



---

archive/issue_comments_265180.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nI would go for the first option which looks easier: just put the ECL patch into `build/pkgs/ecl/patches`.",
    "created_at": "2016-11-08T15:12:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265180",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:73" align="right">comment:73</div>

I would go for the first option which looks easier: just put the ECL patch into `build/pkgs/ecl/patches`.



---

archive/issue_comments_265181.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nThere is the issue that you have to force an ECL rebuild. Add a `p(n+1)` suffix in `package-version.txt`?",
    "created_at": "2016-11-08T15:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265181",
    "user": "https://github.com/jpflori"
}
```

<div id="comment:74" align="right">comment:74</div>

There is the issue that you have to force an ECL rebuild. Add a `p(n+1)` suffix in `package-version.txt`?



---

archive/issue_comments_265182.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@jpflori](#comment%3A73):\n> I would go for the first option which looks easier: just put the ECL patch into `build/pkgs/ecl/patches`.\n\na single patch is not  enough. In fact, it hangs the ECL build if I do this. ECL people say the have worked on a number of related things, that is support of IEEE floats, since the release, so the latest fix relies on these. A proper ECL update is the only way I think.",
    "created_at": "2016-11-08T15:32:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265182",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@jpflori](#comment%3A73):
> I would go for the first option which looks easier: just put the ECL patch into `build/pkgs/ecl/patches`.

a single patch is not  enough. In fact, it hangs the ECL build if I do this. ECL people say the have worked on a number of related things, that is support of IEEE floats, since the release, so the latest fix relies on these. A proper ECL update is the only way I think.



---

archive/issue_comments_265183.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nWe may have to wait. I could try a git snapshot in sage-on-gentoo to see how things are going but I am overloaded as it is. I have to draw the line somewhere.",
    "created_at": "2016-11-08T22:29:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265183",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:76" align="right">comment:76</div>

We may have to wait. I could try a git snapshot in sage-on-gentoo to see how things are going but I am overloaded as it is. I have to draw the line somewhere.



---

archive/issue_comments_265184.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nHi, we're following this ticket very closely in Debian. I notice that the following two patches are still applicable to 5.38.1:\n\n* https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/0001-taylor2-Avoid-blowing-the-stack-when-diff-expand-isn.patch\n* https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/matrixexp.patch\n\nHave these patches been forwarded upstream yet? Would they be suitable for other users of Maxima, or are they only useful for Sage?",
    "created_at": "2016-11-12T19:26:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265184",
    "user": "https://github.com/infinity0"
}
```

<div id="comment:77" align="right">comment:77</div>

Hi, we're following this ticket very closely in Debian. I notice that the following two patches are still applicable to 5.38.1:

* https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/0001-taylor2-Avoid-blowing-the-stack-when-diff-expand-isn.patch
* https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/matrixexp.patch

Have these patches been forwarded upstream yet? Would they be suitable for other users of Maxima, or are they only useful for Sage?



---

archive/issue_comments_265185.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nReplying to [@infinity0](#comment%3A77):\n> Hi, we're following this ticket very closely in Debian. I notice that the following two patches are still applicable to 5.38.1:\n> \n> * https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/0001-taylor2-Avoid-blowing-the-stack-when-diff-expand-isn.patch\n\nthis one comes from upstream, from here: https://sourceforge.net/p/maxima/bugs/2520/#e3a5\n(so it's sort of unfinished digging on the maxima side; it's definitely useful outside of Sage)\n\n\n\n> * https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/matrixexp.patch\n> \n\nthis is also from upstream (updated somewhat):\nhttps://sourceforge.net/p/maxima/bugs/2596/\n\nagain, upstream still has it open.",
    "created_at": "2016-11-13T22:43:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265185",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:78" align="right">comment:78</div>

Replying to [@infinity0](#comment%3A77):
> Hi, we're following this ticket very closely in Debian. I notice that the following two patches are still applicable to 5.38.1:
> 
> * https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/0001-taylor2-Avoid-blowing-the-stack-when-diff-expand-isn.patch

this one comes from upstream, from here: https://sourceforge.net/p/maxima/bugs/2520/#e3a5
(so it's sort of unfinished digging on the maxima side; it's definitely useful outside of Sage)



> * https://github.com/sagemath/sagetrac-mirror/blob/develop/build/pkgs/maxima/patches/matrixexp.patch
> 

this is also from upstream (updated somewhat):
https://sourceforge.net/p/maxima/bugs/2596/

again, upstream still has it open.



---

archive/issue_comments_265186.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\n\n```\nsage -t --long src/sage/interfaces/maxima.py\n**********************************************************************\nFile \"src/sage/interfaces/maxima.py\", line 210, in sage.interfaces.maxima\nFailed example:\n    g.taylor('x', 0, 3)\nExpected:\n    x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152\nGot:\n    f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945\n**********************************************************************\n1 item had failures:\n   1 of  96 in sage.interfaces.maxima\n    [182 tests, 1 failure, 10.65 s]\nsage -t --long src/sage/symbolic/expression_conversions.py\n**********************************************************************\nFile \"src/sage/symbolic/expression_conversions.py\", line 535, in sage.symbolic.expression_conversions.InterfaceInit.derivative\nFailed example:\n    b = maxima(a); b\nExpected:\n    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=%e^_SAGE_VAR_x])\nGot:\n    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),_SAGE_VAR_t0=%e^_SAGE_VAR_x)\n**********************************************************************\nFile \"src/sage/symbolic/expression_conversions.py\", line 544, in sage.symbolic.expression_conversions.InterfaceInit.derivative\nFailed example:\n    b = maxima(a); b\nExpected:\n    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=4])\nGot:\n    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),_SAGE_VAR_t0=4)\n**********************************************************************\nFile \"src/sage/symbolic/expression_conversions.py\", line 564, in sage.symbolic.expression_conversions.InterfaceInit.derivative\nFailed example:\n    b = maxima(a); b\nExpected:\n    %at('diff('f(_SAGE_VAR_t0,_SAGE_VAR_t1),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=4,_SAGE_VAR_t1=_SAGE_VAR_y])\nGot:\n    %at('diff('f(_SAGE_VAR_t0,_SAGE_VAR_y),_SAGE_VAR_t0,1),_SAGE_VAR_t0=4)\n**********************************************************************\nFile \"src/sage/symbolic/expression_conversions.py\", line 573, in sage.symbolic.expression_conversions.InterfaceInit.derivative\nFailed example:\n    b = maxima(a); b\nExpected:\n    %at('diff('f(_SAGE_VAR_t0,_SAGE_VAR_t1),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=4,_SAGE_VAR_t1=8])\nGot:\n    %at('diff('f(_SAGE_VAR_t0,8),_SAGE_VAR_t0,1),_SAGE_VAR_t0=4)\n**********************************************************************\n1 item had failures:\n   4 of  37 in sage.symbolic.expression_conversions.InterfaceInit.derivative\n    [462 tests, 4 failures, 5.14 s]\nsage -t --long src/sage/calculus/tests.py\n**********************************************************************\nFile \"src/sage/calculus/tests.py\", line 107, in sage.calculus.tests\nFailed example:\n    integrate(log(1-x^2)/x, x)\nExpected:\n    1/2*log(x^2)*log(-x^2 + 1) + 1/2*polylog(2, -x^2 + 1)\nGot:\n    log(-x)*log(x + 1) + log(x)*log(-x + 1) + polylog(2, x + 1) + polylog(2, -x + 1)\n**********************************************************************\n1 item had failures:\n   1 of  83 in sage.calculus.tests\n    [82 tests, 1 failure, 8.56 s]\nsage -t --long src/sage/interfaces/maxima_lib.py\n**********************************************************************\nFile \"src/sage/interfaces/maxima_lib.py\", line 66, in sage.interfaces.maxima_lib\nFailed example:\n    sum((-x)^n/(factorial(n)*factorial(n+3/2)),n,0,oo)\nExpected:\n    bessel_J(3/2, 2*sqrt(x))/x^(3/4)\nGot:\n    -1/2*(2*x*cos(2*sqrt(x)) - sqrt(x)*sin(2*sqrt(x)))/(sqrt(pi)*x^2)\n**********************************************************************\nFile \"src/sage/interfaces/maxima_lib.py\", line 724, in sage.interfaces.maxima_lib.MaximaLib.sr_integral\nFailed example:\n    integrate(1 / (1 + abs(x-5)), x, -5, 6)\nException raised:\n    Traceback (most recent call last):\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.interfaces.maxima_lib.MaximaLib.sr_integral[12]>\", line 1, in <module>\n        integrate(Integer(1) / (Integer(1) + abs(x-Integer(5))), x, -Integer(5), Integer(6))\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/functional.py\", line 662, in integral\n        return x.integral(*args, **kwds)\n      File \"sage/symbolic/expression.pyx\", line 11624, in sage.symbolic.expression.Expression.integral (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/expression.cpp:64315)\n        return integral(self, *args, **kwds)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py\", line 777, in integrate\n        return definite_integral(expression, v, a, b, hold=hold)\n      File \"sage/symbolic/function.pyx\", line 995, in sage.symbolic.function.BuiltinFunction.__call__ (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/function.cpp:11329)\n        res = super(BuiltinFunction, self).__call__(\n      File \"sage/symbolic/function.pyx\", line 485, in sage.symbolic.function.Function.__call__ (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/function.cpp:6372)\n        res = g_function_evalv(self._serial, vec, hold)\n      File \"sage/symbolic/function.pyx\", line 1084, in sage.symbolic.function.BuiltinFunction._evalf_or_eval_ (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/function.cpp:12689)\n        return self._eval0_(*args)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py\", line 178, in _eval_\n        return integrator(*args)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py\", line 24, in maxima_integrator\n        result = maxima.sr_integral(expression, v, a, b)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 799, in sr_integral\n        return max_to_sr(maxima_eval(([max_integrate],[sr_to_max(SR(a)) for a in args])))\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 1672, in max_to_sr\n        args=[max_to_sr(a) for a in max_args]\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 1672, in max_to_sr\n        args=[max_to_sr(a) for a in max_args]\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py\", line 1663, in max_to_sr\n        sage_expr=SR(maxima(expr))\n      File \"sage/structure/parent.pyx\", line 953, in sage.structure.parent.Parent.__call__ (/usr/local/src/sage-config/src/build/cythonized/sage/structure/parent.c:9849)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 238, in sage.structure.coerce_maps.NamedConvertMap._call_ (/usr/local/src/sage-config/src/build/cythonized/sage/structure/coerce_maps.c:6388)\n        cdef Element e = method(C)\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py\", line 1255, in _symbolic_\n        return R(self._sage_())\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py\", line 1230, in _sage_\n        maxima=self.parent())\n      File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/calculus/calculus.py\", line 1897, in symbolic_expression_from_maxima_string\n        raise TypeError(\"unable to make sense of Maxima expression '%s' in Sage\"%s)\n    TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage\n**********************************************************************\n```",
    "created_at": "2016-11-14T07:09:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265186",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:79" align="right">comment:79</div>


```
sage -t --long src/sage/interfaces/maxima.py
**********************************************************************
File "src/sage/interfaces/maxima.py", line 210, in sage.interfaces.maxima
Failed example:
    g.taylor('x', 0, 3)
Expected:
    x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152
Got:
    f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945
**********************************************************************
1 item had failures:
   1 of  96 in sage.interfaces.maxima
    [182 tests, 1 failure, 10.65 s]
sage -t --long src/sage/symbolic/expression_conversions.py
**********************************************************************
File "src/sage/symbolic/expression_conversions.py", line 535, in sage.symbolic.expression_conversions.InterfaceInit.derivative
Failed example:
    b = maxima(a); b
Expected:
    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=%e^_SAGE_VAR_x])
Got:
    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),_SAGE_VAR_t0=%e^_SAGE_VAR_x)
**********************************************************************
File "src/sage/symbolic/expression_conversions.py", line 544, in sage.symbolic.expression_conversions.InterfaceInit.derivative
Failed example:
    b = maxima(a); b
Expected:
    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=4])
Got:
    %at('diff('f(_SAGE_VAR_t0),_SAGE_VAR_t0,1),_SAGE_VAR_t0=4)
**********************************************************************
File "src/sage/symbolic/expression_conversions.py", line 564, in sage.symbolic.expression_conversions.InterfaceInit.derivative
Failed example:
    b = maxima(a); b
Expected:
    %at('diff('f(_SAGE_VAR_t0,_SAGE_VAR_t1),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=4,_SAGE_VAR_t1=_SAGE_VAR_y])
Got:
    %at('diff('f(_SAGE_VAR_t0,_SAGE_VAR_y),_SAGE_VAR_t0,1),_SAGE_VAR_t0=4)
**********************************************************************
File "src/sage/symbolic/expression_conversions.py", line 573, in sage.symbolic.expression_conversions.InterfaceInit.derivative
Failed example:
    b = maxima(a); b
Expected:
    %at('diff('f(_SAGE_VAR_t0,_SAGE_VAR_t1),_SAGE_VAR_t0,1),[_SAGE_VAR_t0=4,_SAGE_VAR_t1=8])
Got:
    %at('diff('f(_SAGE_VAR_t0,8),_SAGE_VAR_t0,1),_SAGE_VAR_t0=4)
**********************************************************************
1 item had failures:
   4 of  37 in sage.symbolic.expression_conversions.InterfaceInit.derivative
    [462 tests, 4 failures, 5.14 s]
sage -t --long src/sage/calculus/tests.py
**********************************************************************
File "src/sage/calculus/tests.py", line 107, in sage.calculus.tests
Failed example:
    integrate(log(1-x^2)/x, x)
Expected:
    1/2*log(x^2)*log(-x^2 + 1) + 1/2*polylog(2, -x^2 + 1)
Got:
    log(-x)*log(x + 1) + log(x)*log(-x + 1) + polylog(2, x + 1) + polylog(2, -x + 1)
**********************************************************************
1 item had failures:
   1 of  83 in sage.calculus.tests
    [82 tests, 1 failure, 8.56 s]
sage -t --long src/sage/interfaces/maxima_lib.py
**********************************************************************
File "src/sage/interfaces/maxima_lib.py", line 66, in sage.interfaces.maxima_lib
Failed example:
    sum((-x)^n/(factorial(n)*factorial(n+3/2)),n,0,oo)
Expected:
    bessel_J(3/2, 2*sqrt(x))/x^(3/4)
Got:
    -1/2*(2*x*cos(2*sqrt(x)) - sqrt(x)*sin(2*sqrt(x)))/(sqrt(pi)*x^2)
**********************************************************************
File "src/sage/interfaces/maxima_lib.py", line 724, in sage.interfaces.maxima_lib.MaximaLib.sr_integral
Failed example:
    integrate(1 / (1 + abs(x-5)), x, -5, 6)
Exception raised:
    Traceback (most recent call last):
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.interfaces.maxima_lib.MaximaLib.sr_integral[12]>", line 1, in <module>
        integrate(Integer(1) / (Integer(1) + abs(x-Integer(5))), x, -Integer(5), Integer(6))
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/functional.py", line 662, in integral
        return x.integral(*args, **kwds)
      File "sage/symbolic/expression.pyx", line 11624, in sage.symbolic.expression.Expression.integral (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/expression.cpp:64315)
        return integral(self, *args, **kwds)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py", line 777, in integrate
        return definite_integral(expression, v, a, b, hold=hold)
      File "sage/symbolic/function.pyx", line 995, in sage.symbolic.function.BuiltinFunction.__call__ (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/function.cpp:11329)
        res = super(BuiltinFunction, self).__call__(
      File "sage/symbolic/function.pyx", line 485, in sage.symbolic.function.Function.__call__ (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/function.cpp:6372)
        res = g_function_evalv(self._serial, vec, hold)
      File "sage/symbolic/function.pyx", line 1084, in sage.symbolic.function.BuiltinFunction._evalf_or_eval_ (/usr/local/src/sage-config/src/build/cythonized/sage/symbolic/function.cpp:12689)
        return self._eval0_(*args)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/integration/integral.py", line 178, in _eval_
        return integrator(*args)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/symbolic/integration/external.py", line 24, in maxima_integrator
        result = maxima.sr_integral(expression, v, a, b)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 799, in sr_integral
        return max_to_sr(maxima_eval(([max_integrate],[sr_to_max(SR(a)) for a in args])))
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 1672, in max_to_sr
        args=[max_to_sr(a) for a in max_args]
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 1672, in max_to_sr
        args=[max_to_sr(a) for a in max_args]
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_lib.py", line 1663, in max_to_sr
        sage_expr=SR(maxima(expr))
      File "sage/structure/parent.pyx", line 953, in sage.structure.parent.Parent.__call__ (/usr/local/src/sage-config/src/build/cythonized/sage/structure/parent.c:9849)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 238, in sage.structure.coerce_maps.NamedConvertMap._call_ (/usr/local/src/sage-config/src/build/cythonized/sage/structure/coerce_maps.c:6388)
        cdef Element e = method(C)
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py", line 1255, in _symbolic_
        return R(self._sage_())
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/interfaces/maxima_abstract.py", line 1230, in _sage_
        maxima=self.parent())
      File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/calculus/calculus.py", line 1897, in symbolic_expression_from_maxima_string
        raise TypeError("unable to make sense of Maxima expression '%s' in Sage"%s)
    TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage
**********************************************************************
```



---

archive/issue_comments_265187.json:
```json
{
    "body": "Changed work issues from **fix doctests, if any.** to **fix doctests**",
    "created_at": "2016-11-14T07:09:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265187",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **fix doctests, if any.** to **fix doctests**



---

archive/issue_events_266156.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-14T07:09:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266156"
}
```



---

archive/issue_events_266157.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2016-11-14T07:09:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266157"
}
```



---

archive/issue_comments_265188.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nSome of these doctests are solely Maxima's regressions, one is fixable via a ECL update.\nI can just mark them appropriately and proceed, if this is acceptable.",
    "created_at": "2016-11-14T10:15:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265188",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:80" align="right">comment:80</div>

Some of these doctests are solely Maxima's regressions, one is fixable via a ECL update.
I can just mark them appropriately and proceed, if this is acceptable.



---

archive/issue_comments_265189.json:
```json
{
    "body": "<div id=\"comment:81\" align=\"right\">comment:81</div>\n\nReplying to [@jdemeyer](#comment%3A79):\n> \n> ```\n> File \"src/sage/interfaces/maxima_lib.py\", line 724, in sage.interfaces.maxima_lib.MaximaLib.sr_integral\n> Failed example:\n>     integrate(1 / (1 + abs(x-5)), x, -5, 6)\n> Exception raised:\n>     Traceback (most recent call last):\n> ...\n>       File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/calculus/calculus.py\", line 1897, in symbolic_expression_from_maxima_string\n>         raise TypeError(\"unable to make sense of Maxima expression '%s' in Sage\"%s)\n>     TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage\n> **********************************************************************\n> ```\n\nThis is both #17892 and #20191, because the result changed, presumably to something more correct that needs these symbolic functions we don't have atm.",
    "created_at": "2016-11-14T13:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265189",
    "user": "https://github.com/rwst"
}
```

<div id="comment:81" align="right">comment:81</div>

Replying to [@jdemeyer](#comment%3A79):
> 
> ```
> File "src/sage/interfaces/maxima_lib.py", line 724, in sage.interfaces.maxima_lib.MaximaLib.sr_integral
> Failed example:
>     integrate(1 / (1 + abs(x-5)), x, -5, 6)
> Exception raised:
>     Traceback (most recent call last):
> ...
>       File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/calculus/calculus.py", line 1897, in symbolic_expression_from_maxima_string
>         raise TypeError("unable to make sense of Maxima expression '%s' in Sage"%s)
>     TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage
> **********************************************************************
> ```

This is both #17892 and #20191, because the result changed, presumably to something more correct that needs these symbolic functions we don't have atm.



---

archive/issue_comments_265190.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@rwst](#comment%3A81):\n> Replying to [@jdemeyer](#comment%3A79):\n> > \n> > ```\n> > File \"src/sage/interfaces/maxima_lib.py\", line 724, in sage.interfaces.maxima_lib.MaximaLib.sr_integral\n> > Failed example:\n> >     integrate(1 / (1 + abs(x-5)), x, -5, 6)\n> > Exception raised:\n> >     Traceback (most recent call last):\n> > ...\n> >       File \"/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/calculus/calculus.py\", line 1897, in symbolic_expression_from_maxima_string\n> >         raise TypeError(\"unable to make sense of Maxima expression '%s' in Sage\"%s)\n> >     TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage\n> > **********************************************************************\n> > ```\n> \n> This is both #17892 and #20191, because the result changed, presumably to something more correct that needs these symbolic functions we don't have atm.\n\nI think this one is a new Maxima bug: \nhttps://sourceforge.net/p/maxima/bugs/3237/ - still under investigation by Maxima people.",
    "created_at": "2016-11-14T14:00:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265190",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@rwst](#comment%3A81):
> Replying to [@jdemeyer](#comment%3A79):
> > 
> > ```
> > File "src/sage/interfaces/maxima_lib.py", line 724, in sage.interfaces.maxima_lib.MaximaLib.sr_integral
> > Failed example:
> >     integrate(1 / (1 + abs(x-5)), x, -5, 6)
> > Exception raised:
> >     Traceback (most recent call last):
> > ...
> >       File "/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/calculus/calculus.py", line 1897, in symbolic_expression_from_maxima_string
> >         raise TypeError("unable to make sense of Maxima expression '%s' in Sage"%s)
> >     TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage
> > **********************************************************************
> > ```
> 
> This is both #17892 and #20191, because the result changed, presumably to something more correct that needs these symbolic functions we don't have atm.

I think this one is a new Maxima bug: 
https://sourceforge.net/p/maxima/bugs/3237/ - still under investigation by Maxima people.



---

archive/issue_comments_265191.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nReplying to [@jdemeyer](#comment%3A79):\n> \n> ```\n> sage -t --long src/sage/interfaces/maxima.py\n> **********************************************************************\n> File \"src/sage/interfaces/maxima.py\", line 210, in sage.interfaces.maxima\n> Failed example:\n>     g.taylor('x', 0, 3)\n> Expected:\n>     x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152\n> Got:\n>     f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945\n> ```\n\nThat's odd. The doctest skipped to the next result line which is of course different.\n\n> I think this one is a new Maxima bug: \u200bhttps://sourceforge.net/p/maxima/bugs/3237/ - still under investigation by Maxima people.\n\nLooking more closely, I agree.",
    "created_at": "2016-11-14T14:09:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265191",
    "user": "https://github.com/rwst"
}
```

<div id="comment:83" align="right">comment:83</div>

Replying to [@jdemeyer](#comment%3A79):
> 
> ```
> sage -t --long src/sage/interfaces/maxima.py
> **********************************************************************
> File "src/sage/interfaces/maxima.py", line 210, in sage.interfaces.maxima
> Failed example:
>     g.taylor('x', 0, 3)
> Expected:
>     x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152
> Got:
>     f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945
> ```

That's odd. The doctest skipped to the next result line which is of course different.

> I think this one is a new Maxima bug: ‚Äãhttps://sourceforge.net/p/maxima/bugs/3237/ - still under investigation by Maxima people.

Looking more closely, I agree.



---

archive/issue_comments_265192.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\n`ecl` 16.1.3 is out. I haven't checked yet if all we want is in there but I will look int it.",
    "created_at": "2016-12-20T03:59:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265192",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:85" align="right">comment:85</div>

`ecl` 16.1.3 is out. I haven't checked yet if all we want is in there but I will look int it.



---

archive/issue_comments_265193.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\nIf possible, do the ECL upgrade in a new ticket.",
    "created_at": "2016-12-20T07:21:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265193",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:86" align="right">comment:86</div>

If possible, do the ECL upgrade in a new ticket.



---

archive/issue_comments_265194.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nConsidering the havoc it wrecks in the building of the documentation it deserves its own ticket. Surprisingly, I haven't spotted `libecl` in the numerous backtraces produced before the build petered out. But that's the only thing I changed from one successful build to this one.",
    "created_at": "2016-12-20T08:25:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265194",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:87" align="right">comment:87</div>

Considering the havoc it wrecks in the building of the documentation it deserves its own ticket. Surprisingly, I haven't spotted `libecl` in the numerous backtraces produced before the build petered out. But that's the only thing I changed from one successful build to this one.



---

archive/issue_events_266158.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-12T15:52:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-7.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266158"
}
```



---

archive/issue_events_266159.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-12T15:52:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "milestone_number": null,
    "milestone_title": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266159"
}
```



---

archive/issue_comments_265195.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nmaxima 5.39.0 has been released. ECL upgrade is happening on #22191.",
    "created_at": "2017-01-16T14:39:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265195",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:89" align="right">comment:89</div>

maxima 5.39.0 has been released. ECL upgrade is happening on #22191.



---

archive/issue_comments_265196.json:
```json
{
    "body": "Dependencies: **#22191**",
    "created_at": "2017-01-16T14:39:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265196",
    "user": "https://github.com/dimpase"
}
```

Dependencies: **#22191**



---

archive/issue_events_266160.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-16T14:39:06Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "title_is": "upgrade Maxima  to version >= 5.39",
    "title_was": "upgrade Maxima  to version >= 5.38.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266160"
}
```



---

archive/issue_comments_265197.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).\n \n-* get Maxima 5.38.1 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)\n+* get Maxima 5.39.0 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)\n``````\n",
    "created_at": "2017-01-16T14:39:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265197",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 this would fix some bugs, e.g. as reported [here](https://groups.google.com/d/msg/sage-support/OJAN4pk4dwQ/FJRxra67EbwJ).
 
-* get Maxima 5.38.1 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)
+* get Maxima 5.39.0 tarball [here](https://sourceforge.net/projects/maxima/files/Maxima-source/)
``````




---

archive/issue_comments_265198.json:
```json
{
    "body": "<div id=\"comment:90\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/eff60815383ca3b3120a7a26e98e1712072c70ac\"><code>eff6081</code></a></td><td><code>update ECL to 16.1.3 - most of our patches are obsolete</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68da1e44b83e21dc5673e66b5f4af8f27a91181b\"><code>68da1e4</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into ecl1613</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6bae4b1c1c95c08233c8b36a62baaff1bbc9a428\"><code>6bae4b1</code></a></td><td><code>bumped up for 5.39.0. Sage builds (with ecl 16.1.3)</code></td></tr></table>\n",
    "created_at": "2017-01-16T15:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265198",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:90"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/eff60815383ca3b3120a7a26e98e1712072c70ac"><code>eff6081</code></a></td><td><code>update ECL to 16.1.3 - most of our patches are obsolete</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68da1e44b83e21dc5673e66b5f4af8f27a91181b"><code>68da1e4</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into ecl1613</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6bae4b1c1c95c08233c8b36a62baaff1bbc9a428"><code>6bae4b1</code></a></td><td><code>bumped up for 5.39.0. Sage builds (with ecl 16.1.3)</code></td></tr></table>




---

archive/issue_comments_265199.json:
```json
{
    "body": "Changed commit from **[`af7e5ff`](https://github.com/sagemath/sagetrac-mirror/commit/af7e5ff2e30dfed8bcb4c597403a6a23eb93b86a)** to **[`6bae4b1`](https://github.com/sagemath/sagetrac-mirror/commit/6bae4b1c1c95c08233c8b36a62baaff1bbc9a428)**",
    "created_at": "2017-01-16T15:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265199",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`af7e5ff`](https://github.com/sagemath/sagetrac-mirror/commit/af7e5ff2e30dfed8bcb4c597403a6a23eb93b86a)** to **[`6bae4b1`](https://github.com/sagemath/sagetrac-mirror/commit/6bae4b1c1c95c08233c8b36a62baaff1bbc9a428)**



---

archive/issue_comments_265200.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nOn this branch, the following works at the prompt:\n\n```\nsage: K.<i> = NumberField(x^2+1)\nsage: (6*i + 6).factor()\n(-i) * (i + 1)^3 * 3\n```\nbut crashes in testing:\n\n```\nUsing --optional=mpir,python2,sage\nDoctesting 1 file using 8 threads.\nsage -t src/sage/rings/number_field/number_field_element.pyx\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field_element.pyx\", line 1752, in sage.rings.number_field.number_field_element.NumberFieldElement.factor\nFailed example:\n    (6*i + 6).factor()\nException raised:\n    Traceback (most recent call last):\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.number_field.number_field_element.NumberFieldElement.factor[1]>\", line 1, in <module>\n        (Integer(6)*i + Integer(6)).factor()\n      File \"sage/rings/number_field/number_field_element.pyx\", line 1782, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:19881)\n        if not P.is_principal():\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py\", line 1115, in is_principal\n        self._cache_bnfisprincipal(proof)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py\", line 1058, in _cache_bnfisprincipal\n        bnf = self.number_field().pari_bnf(proof)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py\", line 3603, in pari_bnf\n        self._pari_bnf = f.bnfinit(1)\n      File \"sage/libs/cypari2/auto_gen.pxi\", line 2984, in sage.libs.cypari2.gen.gen_auto.bnfinit (build/cythonized/sage/libs/cypari2/gen.c:17894)\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 105, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1519)\n    FloatingPointError: Floating point exception\n**********************************************************************\n1 item had failures:\n   1 of   8 in sage.rings.number_field.number_field_element.NumberFieldElement.factor\n    [1051 tests, 1 failure, 10.88 s]\n----------------------------------------------------------------------\nsage -t src/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed\n```\n\nLooks like the testing environment is a bit shot, but I cannot figure out why.",
    "created_at": "2017-01-16T15:40:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265200",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:91" align="right">comment:91</div>

On this branch, the following works at the prompt:

```
sage: K.<i> = NumberField(x^2+1)
sage: (6*i + 6).factor()
(-i) * (i + 1)^3 * 3
```
but crashes in testing:

```
Using --optional=mpir,python2,sage
Doctesting 1 file using 8 threads.
sage -t src/sage/rings/number_field/number_field_element.pyx
**********************************************************************
File "src/sage/rings/number_field/number_field_element.pyx", line 1752, in sage.rings.number_field.number_field_element.NumberFieldElement.factor
Failed example:
    (6*i + 6).factor()
Exception raised:
    Traceback (most recent call last):
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.number_field.number_field_element.NumberFieldElement.factor[1]>", line 1, in <module>
        (Integer(6)*i + Integer(6)).factor()
      File "sage/rings/number_field/number_field_element.pyx", line 1782, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:19881)
        if not P.is_principal():
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py", line 1115, in is_principal
        self._cache_bnfisprincipal(proof)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py", line 1058, in _cache_bnfisprincipal
        bnf = self.number_field().pari_bnf(proof)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py", line 3603, in pari_bnf
        self._pari_bnf = f.bnfinit(1)
      File "sage/libs/cypari2/auto_gen.pxi", line 2984, in sage.libs.cypari2.gen.gen_auto.bnfinit (build/cythonized/sage/libs/cypari2/gen.c:17894)
        sig_on()
      File "src/cysignals/signals.pyx", line 105, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1519)
    FloatingPointError: Floating point exception
**********************************************************************
1 item had failures:
   1 of   8 in sage.rings.number_field.number_field_element.NumberFieldElement.factor
    [1051 tests, 1 failure, 10.88 s]
----------------------------------------------------------------------
sage -t src/sage/rings/number_field/number_field_element.pyx  # 1 doctest failed
```

Looks like the testing environment is a bit shot, but I cannot figure out why.



---

archive/issue_comments_265201.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\nhere we get fp exception instead of `ArithmeticError`\n\n```\nFile \"src/sage/arith/misc.py\", line 2696, in sage.arith.misc.is_squarefree\nFailed example:\n    is_squarefree(a - 3)\nExpected:\n    Traceback (most recent call last):\n    ...\n    ArithmeticError: non-principal ideal in factorization\nGot:\n    <BLANKLINE>\n    Traceback (most recent call last):\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.arith.misc.is_squarefree[13]>\", line 1, in <module>\n        is_squarefree(a - Integer(3))\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/arith/misc.py\", line 2711, in is_squarefree\n        return all(r[1] == 1 for r in factor(n))\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/arith/misc.py\", line 2479, in factor\n        return n.factor(**kwds)\n      File \"sage/rings/number_field/number_field_element.pyx\", line 1782, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:19881)\n        if not P.is_principal():\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py\", line 1115, in is_principal\n        self._cache_bnfisprincipal(proof)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py\", line 1058, in _cache_bnfisprincipal\n        bnf = self.number_field().pari_bnf(proof)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py\", line 3603, in pari_bnf\n        self._pari_bnf = f.bnfinit(1)\n      File \"sage/libs/cypari2/auto_gen.pxi\", line 2984, in sage.libs.cypari2.gen.gen_auto.bnfinit (build/cythonized/sage/libs/cypari2/gen.c:17894)\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 105, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1519)\n    FloatingPointError: Floating point exception\n```",
    "created_at": "2017-01-16T15:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265201",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:92" align="right">comment:92</div>

here we get fp exception instead of `ArithmeticError`

```
File "src/sage/arith/misc.py", line 2696, in sage.arith.misc.is_squarefree
Failed example:
    is_squarefree(a - 3)
Expected:
    Traceback (most recent call last):
    ...
    ArithmeticError: non-principal ideal in factorization
Got:
    <BLANKLINE>
    Traceback (most recent call last):
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.arith.misc.is_squarefree[13]>", line 1, in <module>
        is_squarefree(a - Integer(3))
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/arith/misc.py", line 2711, in is_squarefree
        return all(r[1] == 1 for r in factor(n))
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/arith/misc.py", line 2479, in factor
        return n.factor(**kwds)
      File "sage/rings/number_field/number_field_element.pyx", line 1782, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:19881)
        if not P.is_principal():
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py", line 1115, in is_principal
        self._cache_bnfisprincipal(proof)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py", line 1058, in _cache_bnfisprincipal
        bnf = self.number_field().pari_bnf(proof)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py", line 3603, in pari_bnf
        self._pari_bnf = f.bnfinit(1)
      File "sage/libs/cypari2/auto_gen.pxi", line 2984, in sage.libs.cypari2.gen.gen_auto.bnfinit (build/cythonized/sage/libs/cypari2/gen.c:17894)
        sig_on()
      File "src/cysignals/signals.pyx", line 105, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1519)
    FloatingPointError: Floating point exception
```



---

archive/issue_comments_265202.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nIs the following a regression in Maxima?:\n\n```\nsage -t --warn-long 87.4 src/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"src/sage/symbolic/expression.pyx\", line 10600, in sage.symbolic.expression.Expression.solve\nFailed example:\n    solve(Q*sqrt(Q^2 + 2) - 1, Q, to_poly_solve=True)\nExpected:\n    [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]\nGot:\n    [Q == -sqrt(-sqrt(2) - 1)]\n```",
    "created_at": "2017-01-16T16:08:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265202",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:93" align="right">comment:93</div>

Is the following a regression in Maxima?:

```
sage -t --warn-long 87.4 src/sage/symbolic/expression.pyx
**********************************************************************
File "src/sage/symbolic/expression.pyx", line 10600, in sage.symbolic.expression.Expression.solve
Failed example:
    solve(Q*sqrt(Q^2 + 2) - 1, Q, to_poly_solve=True)
Expected:
    [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]
Got:
    [Q == -sqrt(-sqrt(2) - 1)]
```



---

archive/issue_comments_265203.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\nThe following works at the prompt:\n\n```\nsage: F.<omega> = NumberField(x^2+x+1)\nsage: xx = polygen(F)\nsage: ps = [p for p, _ in F(7).factor()]\nsage: ps\n[-3*omega - 2, 3*omega + 1]\n```\nbut crashes in testing:\n\n```\nsage -t --warn-long 87.4 src/sage/rings/number_field/number_field.py\n**********************************************************************\nFile \"src/sage/rings/number_field/number_field.py\", line 1246, in sage.rings.number_field.number_field.NumberField_generic\nFailed example:\n    ps = [p for p, _ in F(7).factor()]\nException raised:\n    Traceback (most recent call last):\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 498, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 861, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.rings.number_field.number_field.NumberField_generic[43]>\", line 1, in <module>\n        ps = [p for p, _ in F(Integer(7)).factor()]\n      File \"sage/rings/number_field/number_field_element.pyx\", line 1782, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:19881)\n        if not P.is_principal():\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py\", line 1115, in is_principal\n        self._cache_bnfisprincipal(proof)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py\", line 1058, in _cache_bnfisprincipal\n        bnf = self.number_field().pari_bnf(proof)\n      File \"/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py\", line 3603, in pari_bnf\n        self._pari_bnf = f.bnfinit(1)\n      File \"sage/libs/cypari2/auto_gen.pxi\", line 2984, in sage.libs.cypari2.gen.gen_auto.bnfinit (build/cythonized/sage/libs/cypari2/gen.c:17894)\n        sig_on()\n      File \"src/cysignals/signals.pyx\", line 105, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1519)\n    FloatingPointError: Floating point exception\n```",
    "created_at": "2017-01-16T16:14:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265203",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:94" align="right">comment:94</div>

The following works at the prompt:

```
sage: F.<omega> = NumberField(x^2+x+1)
sage: xx = polygen(F)
sage: ps = [p for p, _ in F(7).factor()]
sage: ps
[-3*omega - 2, 3*omega + 1]
```
but crashes in testing:

```
sage -t --warn-long 87.4 src/sage/rings/number_field/number_field.py
**********************************************************************
File "src/sage/rings/number_field/number_field.py", line 1246, in sage.rings.number_field.number_field.NumberField_generic
Failed example:
    ps = [p for p, _ in F(7).factor()]
Exception raised:
    Traceback (most recent call last):
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 498, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 861, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.rings.number_field.number_field.NumberField_generic[43]>", line 1, in <module>
        ps = [p for p, _ in F(Integer(7)).factor()]
      File "sage/rings/number_field/number_field_element.pyx", line 1782, in sage.rings.number_field.number_field_element.NumberFieldElement.factor (build/cythonized/sage/rings/number_field/number_field_element.cpp:19881)
        if not P.is_principal():
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py", line 1115, in is_principal
        self._cache_bnfisprincipal(proof)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field_ideal.py", line 1058, in _cache_bnfisprincipal
        bnf = self.number_field().pari_bnf(proof)
      File "/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/number_field/number_field.py", line 3603, in pari_bnf
        self._pari_bnf = f.bnfinit(1)
      File "sage/libs/cypari2/auto_gen.pxi", line 2984, in sage.libs.cypari2.gen.gen_auto.bnfinit (build/cythonized/sage/libs/cypari2/gen.c:17894)
        sig_on()
      File "src/cysignals/signals.pyx", line 105, in cysignals.signals.sig_raise_exception (build/src/cysignals/signals.c:1519)
    FloatingPointError: Floating point exception
```



---

archive/issue_comments_265204.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nThis works at the prompt (with a good plot, too):\n\n```\nsage: plot(bessel_Y(1,x), (x,0,5), color='blue')\nLaunched png viewer for Graphics object consisting of 1 graphics primitive\n```\nbut dumps core in testing:\n\n```\nsage -t src/sage/functions/bessel.py\n...\n\nsage: plot(bessel_Y(1,x), (x,0,5), color='blue') ## line 513 ##\n------------------------------------------------------------------------\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x4495)[0x7f677f921495]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x44e5)[0x7f677f9214e5]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x7e38)[0x7f677f924e38]\n/lib64/libpthread.so.0(+0x10a00)[0x7f678c3d2a00]\n/home/scratch/dimpase/sage/sage/local/lib/libmpfr.so.4(mpfr_get_d+0x217)[0x7f6774bafd97]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/real_mpfr.so(+0x11bd7)[0x7f6578157bd7]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyNumber_Float+0x2b)[0x7f678c6335cb]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x82ed5)[0x7f678c662ed5]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xbeae3)[0x7f678c69eae3]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so(+0x765e)[0x7f6577a9265e]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so(+0xe0ee)[0x7f6577a990ee]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7ce1)[0x7f678c6ec461]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x65f7c)[0x7f678c645f7c]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0xad3f)[0x7f655d2b8d3f]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0x23cd1)[0x7f655d2d1cd1]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0xad3f)[0x7f655d2b8d3f]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0x2a868)[0x7f655d2d8868]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_CallObjectWithKeywords+0x47)[0x7f678c6e4187]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/ext/interpreters/wrapper_py.so(interp_py+0x398)[0x7f654092e1a8]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/ext/interpreters/wrapper_py.so(+0x391b)[0x7f654091e91b]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56da)[0x7f678c6e9e5a]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x18aa)[0x7f678c6e602a]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x18aa)[0x7f678c6e602a]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/expression.so(+0x1a03f)[0x7f655dde203f]\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/expression.so(+0x343de)[0x7f655ddfc3de]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x625b)[0x7f678c6ea9db]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x18aa)[0x7f678c6e602a]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7f678c6ee139]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7428)[0x7f678c6ebba8]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85d7c)[0x7f678c665d7c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x65f7c)[0x7f678c645f7c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xc20b5)[0x7f678c6a20b5]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56da)[0x7f678c6e9e5a]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8271)[0x7f678c6ec9f1]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85d7c)[0x7f678c665d7c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x65f7c)[0x7f678c645f7c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xc24fd)[0x7f678c6a24fd]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xbeb2f)[0x7f678c69eb2f]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56da)[0x7f678c6e9e5a]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8271)[0x7f678c6ec9f1]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7f678c6ee139]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x8a)[0x7f678c7121da]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xd7)[0x7f678c713587]\n/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(Py_Main+0xc3e)[0x7f678c729c4e]\n/lib64/libc.so.6(__libc_start_main+0xf0)[0x7f678b918580]\npython(_start+0x29)[0x400759]\n------------------------------------------------------------------------\nAttaching gdb to process id 25288.\n\nSaved trace to /home/scratch/dimpase/.sage/crash_logs/crash_vEDCJn.log\n------------------------------------------------------------------------\nUnhandled SIGFPE: An unhandled floating point exception occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n------------------------------------------------------------------------\n\n**********************************************************************\n----------------------------------------------------------------------\nsage -t src/sage/functions/bessel.py  # Killed due to floating point exception\n```",
    "created_at": "2017-01-16T16:23:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265204",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:95" align="right">comment:95</div>

This works at the prompt (with a good plot, too):

```
sage: plot(bessel_Y(1,x), (x,0,5), color='blue')
Launched png viewer for Graphics object consisting of 1 graphics primitive
```
but dumps core in testing:

```
sage -t src/sage/functions/bessel.py
...

sage: plot(bessel_Y(1,x), (x,0,5), color='blue') ## line 513 ##
------------------------------------------------------------------------
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x4495)[0x7f677f921495]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x44e5)[0x7f677f9214e5]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x7e38)[0x7f677f924e38]
/lib64/libpthread.so.0(+0x10a00)[0x7f678c3d2a00]
/home/scratch/dimpase/sage/sage/local/lib/libmpfr.so.4(mpfr_get_d+0x217)[0x7f6774bafd97]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/rings/real_mpfr.so(+0x11bd7)[0x7f6578157bd7]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyNumber_Float+0x2b)[0x7f678c6335cb]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x82ed5)[0x7f678c662ed5]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xbeae3)[0x7f678c69eae3]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so(+0x765e)[0x7f6577a9265e]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so(+0xe0ee)[0x7f6577a990ee]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7ce1)[0x7f678c6ec461]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x65f7c)[0x7f678c645f7c]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0xad3f)[0x7f655d2b8d3f]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0x23cd1)[0x7f655d2d1cd1]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0xad3f)[0x7f655d2b8d3f]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/function.so(+0x2a868)[0x7f655d2d8868]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_CallObjectWithKeywords+0x47)[0x7f678c6e4187]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/ext/interpreters/wrapper_py.so(interp_py+0x398)[0x7f654092e1a8]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/ext/interpreters/wrapper_py.so(+0x391b)[0x7f654091e91b]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56da)[0x7f678c6e9e5a]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x18aa)[0x7f678c6e602a]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x18aa)[0x7f678c6e602a]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/expression.so(+0x1a03f)[0x7f655dde203f]
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/sage/symbolic/expression.so(+0x343de)[0x7f655ddfc3de]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x625b)[0x7f678c6ea9db]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85e4d)[0x7f678c665e4d]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x18aa)[0x7f678c6e602a]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7f678c6ee139]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x7428)[0x7f678c6ebba8]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85d7c)[0x7f678c665d7c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x65f7c)[0x7f678c645f7c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xc20b5)[0x7f678c6a20b5]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56da)[0x7f678c6e9e5a]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8271)[0x7f678c6ec9f1]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x85d7c)[0x7f678c665d7c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0x65f7c)[0x7f678c645f7c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xc24fd)[0x7f678c6a24fd]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(+0xbeb2f)[0x7f678c69eb2f]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyObject_Call+0x43)[0x7f678c634c13]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x56da)[0x7f678c6e9e5a]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8271)[0x7f678c6ec9f1]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalFrameEx+0x8020)[0x7f678c6ec7a0]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCodeEx+0x81c)[0x7f678c6ee01c]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyEval_EvalCode+0x19)[0x7f678c6ee139]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyRun_FileExFlags+0x8a)[0x7f678c7121da]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(PyRun_SimpleFileExFlags+0xd7)[0x7f678c713587]
/home/scratch/dimpase/sage/sage/local/lib/libpython2.7.so.1.0(Py_Main+0xc3e)[0x7f678c729c4e]
/lib64/libc.so.6(__libc_start_main+0xf0)[0x7f678b918580]
python(_start+0x29)[0x400759]
------------------------------------------------------------------------
Attaching gdb to process id 25288.

Saved trace to /home/scratch/dimpase/.sage/crash_logs/crash_vEDCJn.log
------------------------------------------------------------------------
Unhandled SIGFPE: An unhandled floating point exception occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
------------------------------------------------------------------------

**********************************************************************
----------------------------------------------------------------------
sage -t src/sage/functions/bessel.py  # Killed due to floating point exception
```



---

archive/issue_events_266161.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-16T16:25:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266161"
}
```



---

archive/issue_events_266162.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-16T16:25:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266162"
}
```



---

archive/issue_comments_265205.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nI think I need an idea what's wrong here, before being able to go forward. This discrepancy between testsuite vs prompt is really odd.",
    "created_at": "2017-01-16T16:25:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265205",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:96" align="right">comment:96</div>

I think I need an idea what's wrong here, before being able to go forward. This discrepancy between testsuite vs prompt is really odd.



---

archive/issue_comments_265206.json:
```json
{
    "body": "<div id=\"comment:97\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e\"><code>44da831</code></a></td><td><code>version number in tests</code></td></tr></table>\n",
    "created_at": "2017-01-16T17:09:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265206",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:97"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e"><code>44da831</code></a></td><td><code>version number in tests</code></td></tr></table>




---

archive/issue_comments_265207.json:
```json
{
    "body": "Changed commit from **[`6bae4b1`](https://github.com/sagemath/sagetrac-mirror/commit/6bae4b1c1c95c08233c8b36a62baaff1bbc9a428)** to **[`44da831`](https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e)**",
    "created_at": "2017-01-16T17:09:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265207",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6bae4b1`](https://github.com/sagemath/sagetrac-mirror/commit/6bae4b1c1c95c08233c8b36a62baaff1bbc9a428)** to **[`44da831`](https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e)**



---

archive/issue_comments_265208.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nhere is a bad one - reproducible on two different systems;\nI don't understand what's going on here; it appears that computing `g(x)`,\nthe Taylor expansion of `log(x)`, breaks `log(x)` plotting (in case the leftmost\ninterval point is 0).\n\nProbably this initialises some symbolics, breaking handling of infinity in the\nprocess...\n\n```\nsage: plot(log(x),(x,0,2))\nLaunched png viewer for Graphics object consisting of 1 graphics primitive\nsage: g(x)=taylor(log(x),x,1,6); g\nx |--> -1/6*(x - 1)^6 + 1/5*(x - 1)^5 - 1/4*(x - 1)^4 + 1/3*(x - 1)^3 - 1/2*(x - 1)^2 + x - 1\nsage: plot(log(x),(x,0,2))\n------------------------------------------------------------------------\n/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x4495)[0x7f5dbb0d9495]\n[...]\n------------------------------------------------------------------------\nUnhandled SIGFPE: An unhandled floating point exception occurred.\nThis probably occurred because a *compiled* module has a bug\nin it and is not properly wrapped with sig_on(), sig_off().\nPython will now terminate.\n```\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e\"><code>44da831</code></a></td><td><code>version number in tests</code></td></tr></table>\n",
    "created_at": "2017-01-16T17:32:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265208",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:98" align="right">comment:98</div>

here is a bad one - reproducible on two different systems;
I don't understand what's going on here; it appears that computing `g(x)`,
the Taylor expansion of `log(x)`, breaks `log(x)` plotting (in case the leftmost
interval point is 0).

Probably this initialises some symbolics, breaking handling of infinity in the
process...

```
sage: plot(log(x),(x,0,2))
Launched png viewer for Graphics object consisting of 1 graphics primitive
sage: g(x)=taylor(log(x),x,1,6); g
x |--> -1/6*(x - 1)^6 + 1/5*(x - 1)^5 - 1/4*(x - 1)^4 + 1/3*(x - 1)^3 - 1/2*(x - 1)^2 + x - 1
sage: plot(log(x),(x,0,2))
------------------------------------------------------------------------
/home/scratch/dimpase/sage/sage/local/lib/python2.7/site-packages/cysignals/signals.so(+0x4495)[0x7f5dbb0d9495]
[...]
------------------------------------------------------------------------
Unhandled SIGFPE: An unhandled floating point exception occurred.
This probably occurred because a *compiled* module has a bug
in it and is not properly wrapped with sig_on(), sig_off().
Python will now terminate.
```

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e"><code>44da831</code></a></td><td><code>version number in tests</code></td></tr></table>




---

archive/issue_comments_265209.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nReplying to [@dimpase](#comment%3A98):\n> here is a bad one - reproducible on two different systems;\n> I don't understand what's going on here; it appears that computing `g(x)`,\n> the Taylor expansion of `log(x)`, breaks `log(x)` plotting (in case the leftmost\n> interval point is 0).\n> \n> Probably this initialises some symbolics, breaking handling of infinity in the\n> process...\n\nFurther entry point - the crash does not happen if I revert back to ECL 16.1.2.\n(and keep new Maxima version).\nThat is, it seems that the call to `taylor` loads ecl+maxima, and sets up some stuff\nthat is responsible for handling infinities.",
    "created_at": "2017-01-16T22:44:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265209",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:99" align="right">comment:99</div>

Replying to [@dimpase](#comment%3A98):
> here is a bad one - reproducible on two different systems;
> I don't understand what's going on here; it appears that computing `g(x)`,
> the Taylor expansion of `log(x)`, breaks `log(x)` plotting (in case the leftmost
> interval point is 0).
> 
> Probably this initialises some symbolics, breaking handling of infinity in the
> process...

Further entry point - the crash does not happen if I revert back to ECL 16.1.2.
(and keep new Maxima version).
That is, it seems that the call to `taylor` loads ecl+maxima, and sets up some stuff
that is responsible for handling infinities.



---

archive/issue_comments_265210.json:
```json
{
    "body": "<div id=\"comment:100\" align=\"right\">comment:100</div>\n\nI think a number of things point back to `ecl-16.1.3` so it may belong to #22191. I remember having a lot of similar stuff when changing just `ecl` without change `maxima` (still need a rebuild though) in sage-on-gentoo. Right now I am just locked on 16.1.2.",
    "created_at": "2017-01-16T22:53:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265210",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:100" align="right">comment:100</div>

I think a number of things point back to `ecl-16.1.3` so it may belong to #22191. I remember having a lot of similar stuff when changing just `ecl` without change `maxima` (still need a rebuild though) in sage-on-gentoo. Right now I am just locked on 16.1.2.



---

archive/issue_comments_265211.json:
```json
{
    "body": "Changed commit from **[`44da831`](https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e)** to **[`530a89e`](https://github.com/sagemath/sagetrac-mirror/commit/530a89ec77171bb371e5244974187204a72eba32)**",
    "created_at": "2017-01-17T10:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265211",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`44da831`](https://github.com/sagemath/sagetrac-mirror/commit/44da831e63daba36b44eedb719044ea67f5f362e)** to **[`530a89e`](https://github.com/sagemath/sagetrac-mirror/commit/530a89ec77171bb371e5244974187204a72eba32)**



---

archive/issue_comments_265212.json:
```json
{
    "body": "<div id=\"comment:101\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ac8348c462b11a67ee22f77e265afc0ce0572620\"><code>ac8348c</code></a></td><td><code>disable SIGFPE traps</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/530a89ec77171bb371e5244974187204a72eba32\"><code>530a89e</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into ecl1613</code></td></tr></table>\n",
    "created_at": "2017-01-17T10:21:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265212",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:101"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ac8348c462b11a67ee22f77e265afc0ce0572620"><code>ac8348c</code></a></td><td><code>disable SIGFPE traps</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/530a89ec77171bb371e5244974187204a72eba32"><code>530a89e</code></a></td><td><code>Merge branch 'public/t18920' of trac.sagemath.org:sage into ecl1613</code></td></tr></table>




---

archive/issue_comments_265213.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nthe last commit appears to fix the SIGFPE problem. More testing...",
    "created_at": "2017-01-17T10:22:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265213",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:102" align="right">comment:102</div>

the last commit appears to fix the SIGFPE problem. More testing...



---

archive/issue_comments_265214.json:
```json
{
    "body": "Changed commit from **[`530a89e`](https://github.com/sagemath/sagetrac-mirror/commit/530a89ec77171bb371e5244974187204a72eba32)** to **[`1b821c4`](https://github.com/sagemath/sagetrac-mirror/commit/1b821c4d8c75c5a5e33564c23753e89c72643bee)**",
    "created_at": "2017-01-17T11:41:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265214",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`530a89e`](https://github.com/sagemath/sagetrac-mirror/commit/530a89ec77171bb371e5244974187204a72eba32)** to **[`1b821c4`](https://github.com/sagemath/sagetrac-mirror/commit/1b821c4d8c75c5a5e33564c23753e89c72643bee)**



---

archive/issue_comments_265215.json:
```json
{
    "body": "<div id=\"comment:103\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b821c4d8c75c5a5e33564c23753e89c72643bee\"><code>1b821c4</code></a></td><td><code>easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2017-01-17T11:41:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265215",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:103"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b821c4d8c75c5a5e33564c23753e89c72643bee"><code>1b821c4</code></a></td><td><code>easy doctest fixes</code></td></tr></table>




---

archive/issue_events_266163.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-17T11:44:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266163"
}
```



---

archive/issue_events_266164.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-17T11:44:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266164"
}
```



---

archive/issue_comments_265216.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nstill a couple of SIGFPEs to figure out, but otherwise does not look too bad. I'll post ptestlong results later today.",
    "created_at": "2017-01-17T11:44:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265216",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:104" align="right">comment:104</div>

still a couple of SIGFPEs to figure out, but otherwise does not look too bad. I'll post ptestlong results later today.



---

archive/issue_comments_265217.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nSIGFPEs are of the same sort as above:\n\n```\nsage: g(x)=taylor(log(x),x,1,6) # this initialises ECL/Maxima\nsage: q = (2^53) * 2^971/1\nsage: float(q) # boom, instead of \"inf\" as the answer.\n...\nUnhandled SIGFPE: An unhandled floating point exception occurred.\n...\n```\nwhich I traced down to the call to `ldexp` at `sage/rings/rational.pyx:3799`.\nNote that this is with `\u200bac8348c\t` commit already in (and so `ECL_OPT_TRAP_SIGFPE` = 0), so there is more of the same kind of story as above, but harder. I don't see what's going wrong here now.\n\nThis is a different to division by 0 kind of FPE, so this is perhaps the reason.",
    "created_at": "2017-01-17T16:00:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265217",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:105" align="right">comment:105</div>

SIGFPEs are of the same sort as above:

```
sage: g(x)=taylor(log(x),x,1,6) # this initialises ECL/Maxima
sage: q = (2^53) * 2^971/1
sage: float(q) # boom, instead of "inf" as the answer.
...
Unhandled SIGFPE: An unhandled floating point exception occurred.
...
```
which I traced down to the call to `ldexp` at `sage/rings/rational.pyx:3799`.
Note that this is with `‚Äãac8348c	` commit already in (and so `ECL_OPT_TRAP_SIGFPE` = 0), so there is more of the same kind of story as above, but harder. I don't see what's going wrong here now.

This is a different to division by 0 kind of FPE, so this is perhaps the reason.



---

archive/issue_comments_265218.json:
```json
{
    "body": "ecl-16.1.3+Maxima 5.39.0",
    "created_at": "2017-01-17T16:02:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265218",
    "user": "https://github.com/dimpase"
}
```

ecl-16.1.3+Maxima 5.39.0



---

archive/issue_comments_265219.json:
```json
{
    "body": "<div id=\"comment:106\" align=\"right\">comment:106</div>\n\nAttachment: **[ptestlong.log](https://github.com/sagemath/sage/files/ticket18920/ptestlong.log)**\n\nI've decided to stick to ECL 16.1.2 for this ticket. (ECL 16.1.3 has a problem that cannot be fixed quickly, and benefits of using it here are pretty minimal).\n\n---\nLast 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4163ef82f8d39134784ad4f1d94eb3cf755e17d1\"><code>4163ef8</code></a></td><td><code>rebased patches, added eigenvectors patch too</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5b9a7afeb063b2da7439734967b6b00e2af5927d\"><code>5b9a7af</code></a></td><td><code>some more easy doctest fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/da15a6da151c1d7dd76f4d8796d89692c241744e\"><code>da15a6d</code></a></td><td><code>more easy doctest fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4ea0e8ea81cee3eba6c383f9cd7957dcc22aad52\"><code>4ea0e8e</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7c7a0f3edd8fd5d38d7c8cdd9a28dafc0b555336\"><code>7c7a0f3</code></a></td><td><code>fix for maxima bug #3236</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4377282f681773b3a308e5446c3af344d7e3b6ba\"><code>4377282</code></a></td><td><code>reflect patch's dependence on an earlier maxima tree commit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/29f595a29eab34d992ec59518520faad202529e1\"><code>29f595a</code></a></td><td><code>new scaling of dynatomic polynomial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7577f8648af5445c3eb587901311c2e518269b98\"><code>7577f86</code></a></td><td><code>bumped up for 5.39.0. Sage builds (with ecl 16.1.3)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/759104a9c5e2522665c4b8d85dc3944bd9959e43\"><code>759104a</code></a></td><td><code>version number in tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/945086147176055ab0a35d41425cfb10783aeb51\"><code>9450861</code></a></td><td><code>easy doctest fixes</code></td></tr></table>\n",
    "created_at": "2017-01-17T22:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265219",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:106" align="right">comment:106</div>

Attachment: **[ptestlong.log](https://github.com/sagemath/sage/files/ticket18920/ptestlong.log)**

I've decided to stick to ECL 16.1.2 for this ticket. (ECL 16.1.3 has a problem that cannot be fixed quickly, and benefits of using it here are pretty minimal).

---
Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4163ef82f8d39134784ad4f1d94eb3cf755e17d1"><code>4163ef8</code></a></td><td><code>rebased patches, added eigenvectors patch too</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5b9a7afeb063b2da7439734967b6b00e2af5927d"><code>5b9a7af</code></a></td><td><code>some more easy doctest fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/da15a6da151c1d7dd76f4d8796d89692c241744e"><code>da15a6d</code></a></td><td><code>more easy doctest fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4ea0e8ea81cee3eba6c383f9cd7957dcc22aad52"><code>4ea0e8e</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7c7a0f3edd8fd5d38d7c8cdd9a28dafc0b555336"><code>7c7a0f3</code></a></td><td><code>fix for maxima bug #3236</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4377282f681773b3a308e5446c3af344d7e3b6ba"><code>4377282</code></a></td><td><code>reflect patch's dependence on an earlier maxima tree commit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/29f595a29eab34d992ec59518520faad202529e1"><code>29f595a</code></a></td><td><code>new scaling of dynatomic polynomial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7577f8648af5445c3eb587901311c2e518269b98"><code>7577f86</code></a></td><td><code>bumped up for 5.39.0. Sage builds (with ecl 16.1.3)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/759104a9c5e2522665c4b8d85dc3944bd9959e43"><code>759104a</code></a></td><td><code>version number in tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/945086147176055ab0a35d41425cfb10783aeb51"><code>9450861</code></a></td><td><code>easy doctest fixes</code></td></tr></table>




---

archive/issue_comments_265220.json:
```json
{
    "body": "Changed branch from **[public/t18920](https://github.com/sagemath/sagetrac-mirror/tree/public/t18920)** to **[public/maxima5390](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390)**",
    "created_at": "2017-01-17T22:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265220",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[public/t18920](https://github.com/sagemath/sagetrac-mirror/tree/public/t18920)** to **[public/maxima5390](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390)**



---

archive/issue_comments_265221.json:
```json
{
    "body": "Changed dependencies from **#22191** to none",
    "created_at": "2017-01-17T22:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265221",
    "user": "https://github.com/dimpase"
}
```

Changed dependencies from **#22191** to none



---

archive/issue_comments_265222.json:
```json
{
    "body": "Changed commit from **[`1b821c4`](https://github.com/sagemath/sagetrac-mirror/commit/1b821c4d8c75c5a5e33564c23753e89c72643bee)** to **[`9450861`](https://github.com/sagemath/sagetrac-mirror/commit/945086147176055ab0a35d41425cfb10783aeb51)**",
    "created_at": "2017-01-17T22:28:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265222",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[`1b821c4`](https://github.com/sagemath/sagetrac-mirror/commit/1b821c4d8c75c5a5e33564c23753e89c72643bee)** to **[`9450861`](https://github.com/sagemath/sagetrac-mirror/commit/945086147176055ab0a35d41425cfb10783aeb51)**



---

archive/issue_comments_265223.json:
```json
{
    "body": "<div id=\"comment:107\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3e1dcefdd891434a777c426dc0f784c7091219af\"><code>3e1dcef</code></a></td><td><code>few more easy fixes</code></td></tr></table>\n",
    "created_at": "2017-01-17T22:43:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265223",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:107"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3e1dcefdd891434a777c426dc0f784c7091219af"><code>3e1dcef</code></a></td><td><code>few more easy fixes</code></td></tr></table>




---

archive/issue_comments_265224.json:
```json
{
    "body": "Changed commit from **[`9450861`](https://github.com/sagemath/sagetrac-mirror/commit/945086147176055ab0a35d41425cfb10783aeb51)** to **[`3e1dcef`](https://github.com/sagemath/sagetrac-mirror/commit/3e1dcefdd891434a777c426dc0f784c7091219af)**",
    "created_at": "2017-01-17T22:43:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265224",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9450861`](https://github.com/sagemath/sagetrac-mirror/commit/945086147176055ab0a35d41425cfb10783aeb51)** to **[`3e1dcef`](https://github.com/sagemath/sagetrac-mirror/commit/3e1dcefdd891434a777c426dc0f784c7091219af)**



---

archive/issue_comments_265225.json:
```json
{
    "body": "<div id=\"comment:108\" align=\"right\">comment:108</div>\n\nWith this branch, the following remains to be fixed (or marked as known bugs):\n\n1) this appears to be a Maxima regression [bug report](https://sourceforge.net/p/maxima/bugs/3276/):\n\n```\nsage -t src/sage/symbolic/expression.pyx\n******************************************************************\n****\nFile \"src/sage/symbolic/expression.pyx\", line 10600, in sage.symbo\nlic.expression.Expression.solve\nFailed example:\n    solve(Q*sqrt(Q^2 + 2) - 1, Q, to_poly_solve=True)\nExpected:\n    [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]\nGot:\n    [Q == -sqrt(-sqrt(2) - 1)]\n```\n\n2) this is weird (sage interface problem?) --- scratch this, it's a typo!\n\n```\nsage -t src/sage/interfaces/maxima.py\n******************************************************************\n****\nFile \"src/sage/interfaces/maxima.py\", line 210, in sage.interfaces\n.maxima\nFailed example:\n    g.taylor('x', 0, 3)\nExpected:\n    x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152\nGot:\n    f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945\n**********************************************************************\n```\n\n3) this looks like a maxima regression [bug report](https://sourceforge.net/p/maxima/bugs/3275/):\n\n```\nsage -t src/sage/calculus/tests.py\n**********************************************************************\nFile \"src/sage/calculus/tests.py\", line 107, in sage.calculus.tests\nFailed example:\n    integrate(log(1-x^2)/x, x)\nExpected:\n    1/2*log(x^2)*log(-x^2 + 1) + 1/2*dilog(-x^2 + 1)\nGot:\n    log(-x)*log(x + 1) + log(x)*log(-x + 1) + dilog(x + 1) + dilog(-x + 1)\n```\n\n4) this is a known Maxima issue [bug report](https://sourceforge.net/p/maxima/bugs/3237/):\n\n```\nsage -t src/sage/interfaces/maxima_lib.py\n******************************************************************\n****\nFile \"src/sage/interfaces/maxima_lib.py\", line 724, in sage.interf\naces.maxima_lib.MaximaLib.sr_integral\nFailed example:\n    integrate(1 / (1 + abs(x-5)), x, -5, 6)\nException raised:\n...\n    TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage\n**********************************************************************\n```",
    "created_at": "2017-01-17T22:52:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265225",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:108" align="right">comment:108</div>

With this branch, the following remains to be fixed (or marked as known bugs):

1) this appears to be a Maxima regression [bug report](https://sourceforge.net/p/maxima/bugs/3276/):

```
sage -t src/sage/symbolic/expression.pyx
******************************************************************
****
File "src/sage/symbolic/expression.pyx", line 10600, in sage.symbo
lic.expression.Expression.solve
Failed example:
    solve(Q*sqrt(Q^2 + 2) - 1, Q, to_poly_solve=True)
Expected:
    [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]
Got:
    [Q == -sqrt(-sqrt(2) - 1)]
```

2) this is weird (sage interface problem?) --- scratch this, it's a typo!

```
sage -t src/sage/interfaces/maxima.py
******************************************************************
****
File "src/sage/interfaces/maxima.py", line 210, in sage.interfaces
.maxima
Failed example:
    g.taylor('x', 0, 3)
Expected:
    x+x^3/6+(3*x^5)/40+(5*x^7)/112+(35*x^9)/1152
Got:
    f/(k^4*x^4)-(2*f)/((3*k^2)*x^2)+(11*f)/45-((62*k^2*f)*x^2)/945
**********************************************************************
```

3) this looks like a maxima regression [bug report](https://sourceforge.net/p/maxima/bugs/3275/):

```
sage -t src/sage/calculus/tests.py
**********************************************************************
File "src/sage/calculus/tests.py", line 107, in sage.calculus.tests
Failed example:
    integrate(log(1-x^2)/x, x)
Expected:
    1/2*log(x^2)*log(-x^2 + 1) + 1/2*dilog(-x^2 + 1)
Got:
    log(-x)*log(x + 1) + log(x)*log(-x + 1) + dilog(x + 1) + dilog(-x + 1)
```

4) this is a known Maxima issue [bug report](https://sourceforge.net/p/maxima/bugs/3237/):

```
sage -t src/sage/interfaces/maxima_lib.py
******************************************************************
****
File "src/sage/interfaces/maxima_lib.py", line 724, in sage.interf
aces.maxima_lib.MaximaLib.sr_integral
Failed example:
    integrate(1 / (1 + abs(x-5)), x, -5, 6)
Exception raised:
...
    TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage
**********************************************************************
```



---

archive/issue_comments_265226.json:
```json
{
    "body": "Changed commit from **[`3e1dcef`](https://github.com/sagemath/sagetrac-mirror/commit/3e1dcefdd891434a777c426dc0f784c7091219af)** to **[`941b62c`](https://github.com/sagemath/sagetrac-mirror/commit/941b62c41b9266ddd6bceb5a82d228432b2ae2ce)**",
    "created_at": "2017-01-17T23:43:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265226",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3e1dcef`](https://github.com/sagemath/sagetrac-mirror/commit/3e1dcefdd891434a777c426dc0f784c7091219af)** to **[`941b62c`](https://github.com/sagemath/sagetrac-mirror/commit/941b62c41b9266ddd6bceb5a82d228432b2ae2ce)**



---

archive/issue_comments_265227.json:
```json
{
    "body": "<div id=\"comment:109\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7448efd301ceb28540a9d0a14afa2d2eaab30ab\"><code>f7448ef</code></a></td><td><code>some more easy doctest fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/81463e211173d3dbdc39fde3e4ebdf64ec6b8bba\"><code>81463e2</code></a></td><td><code>more easy doctest fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/386e27611981ae5aba27f7446e4e230fdbe37633\"><code>386e276</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a0cd5d46b7f8ccbcd46eab42bcf82fe3bf309e67\"><code>a0cd5d4</code></a></td><td><code>fix for maxima bug #3236</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/55943107fb18e2cf663a53f60cbe53b320f808fc\"><code>5594310</code></a></td><td><code>reflect patch's dependence on an earlier maxima tree commit</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c5358b4e98d04981eb0b8e97b910014636895f8d\"><code>c5358b4</code></a></td><td><code>new scaling of dynatomic polynomial</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/92d1c59338d96779e894d265f40481c7db2e56e0\"><code>92d1c59</code></a></td><td><code>bumped up for 5.39.0. Sage builds (with ecl 16.1.3)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2dbe3cffc31bb9a4e51c37764ed7237970430398\"><code>2dbe3cf</code></a></td><td><code>version number in tests</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/efe98482176ba6332862a5721638370e08fb6379\"><code>efe9848</code></a></td><td><code>easy doctest fixes</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/941b62c41b9266ddd6bceb5a82d228432b2ae2ce\"><code>941b62c</code></a></td><td><code>few more easy fixes</code></td></tr></table>\n",
    "created_at": "2017-01-17T23:43:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265227",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:109"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7448efd301ceb28540a9d0a14afa2d2eaab30ab"><code>f7448ef</code></a></td><td><code>some more easy doctest fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/81463e211173d3dbdc39fde3e4ebdf64ec6b8bba"><code>81463e2</code></a></td><td><code>more easy doctest fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/386e27611981ae5aba27f7446e4e230fdbe37633"><code>386e276</code></a></td><td><code>workaround for #<a ARITHMETIC-ERROR> (18920#comment:60</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a0cd5d46b7f8ccbcd46eab42bcf82fe3bf309e67"><code>a0cd5d4</code></a></td><td><code>fix for maxima bug #3236</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/55943107fb18e2cf663a53f60cbe53b320f808fc"><code>5594310</code></a></td><td><code>reflect patch's dependence on an earlier maxima tree commit</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c5358b4e98d04981eb0b8e97b910014636895f8d"><code>c5358b4</code></a></td><td><code>new scaling of dynatomic polynomial</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/92d1c59338d96779e894d265f40481c7db2e56e0"><code>92d1c59</code></a></td><td><code>bumped up for 5.39.0. Sage builds (with ecl 16.1.3)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2dbe3cffc31bb9a4e51c37764ed7237970430398"><code>2dbe3cf</code></a></td><td><code>version number in tests</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/efe98482176ba6332862a5721638370e08fb6379"><code>efe9848</code></a></td><td><code>easy doctest fixes</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/941b62c41b9266ddd6bceb5a82d228432b2ae2ce"><code>941b62c</code></a></td><td><code>few more easy fixes</code></td></tr></table>




---

archive/issue_comments_265228.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">comment:110</div>\n\ncleaned up the branch",
    "created_at": "2017-01-17T23:44:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265228",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:110" align="right">comment:110</div>

cleaned up the branch



---

archive/issue_comments_265229.json:
```json
{
    "body": "Changed commit from **[`941b62c`](https://github.com/sagemath/sagetrac-mirror/commit/941b62c41b9266ddd6bceb5a82d228432b2ae2ce)** to **[`fbc2293`](https://github.com/sagemath/sagetrac-mirror/commit/fbc2293bfca9bd1a8612a48b13fcc38e012c3a31)**",
    "created_at": "2017-01-18T00:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265229",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`941b62c`](https://github.com/sagemath/sagetrac-mirror/commit/941b62c41b9266ddd6bceb5a82d228432b2ae2ce)** to **[`fbc2293`](https://github.com/sagemath/sagetrac-mirror/commit/fbc2293bfca9bd1a8612a48b13fcc38e012c3a31)**



---

archive/issue_comments_265230.json:
```json
{
    "body": "<div id=\"comment:111\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fbc2293bfca9bd1a8612a48b13fcc38e012c3a31\"><code>fbc2293</code></a></td><td><code>marked Maxima regressions: #18920, comment 108</code></td></tr></table>\n",
    "created_at": "2017-01-18T00:13:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265230",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:111"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fbc2293bfca9bd1a8612a48b13fcc38e012c3a31"><code>fbc2293</code></a></td><td><code>marked Maxima regressions: #18920, comment 108</code></td></tr></table>




---

archive/issue_comments_265231.json:
```json
{
    "body": "<div id=\"comment:112\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68a0ab241a065f9f133a8915cc2141b9f514892c\"><code>68a0ab2</code></a></td><td><code>one more format output change</code></td></tr></table>\n",
    "created_at": "2017-01-18T11:50:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265231",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:112"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68a0ab241a065f9f133a8915cc2141b9f514892c"><code>68a0ab2</code></a></td><td><code>one more format output change</code></td></tr></table>




---

archive/issue_comments_265232.json:
```json
{
    "body": "Changed commit from **[`fbc2293`](https://github.com/sagemath/sagetrac-mirror/commit/fbc2293bfca9bd1a8612a48b13fcc38e012c3a31)** to **[`68a0ab2`](https://github.com/sagemath/sagetrac-mirror/commit/68a0ab241a065f9f133a8915cc2141b9f514892c)**",
    "created_at": "2017-01-18T11:50:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265232",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`fbc2293`](https://github.com/sagemath/sagetrac-mirror/commit/fbc2293bfca9bd1a8612a48b13fcc38e012c3a31)** to **[`68a0ab2`](https://github.com/sagemath/sagetrac-mirror/commit/68a0ab241a065f9f133a8915cc2141b9f514892c)**



---

archive/issue_comments_265233.json:
```json
{
    "body": "<div id=\"comment:113\" align=\"right\">comment:113</div>\n\nOK, all done, ready for review, at last.",
    "created_at": "2017-01-18T12:29:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265233",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:113" align="right">comment:113</div>

OK, all done, ready for review, at last.



---

archive/issue_events_266165.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-18T12:29:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266165"
}
```



---

archive/issue_events_266166.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-18T12:29:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266166"
}
```



---

archive/issue_comments_265234.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">comment:114</div>\n\nInstead of removing this doctest:\n\n```diff\ndiff --git a/src/sage/symbolic/expression.pyx b/src/sage/symbolic/expression.pyx\nindex 80c7149..0ca7904 100644\n--- a/src/sage/symbolic/expression.pyx\n+++ b/src/sage/symbolic/expression.pyx\n@@ -10597,8 +10597,13 @@ cdef class Expression(CommutativeRingElement):\n             Q\n             sage: solve(Q*sqrt(Q^2 + 2) - 1, Q)\n             [Q == 1/sqrt(Q^2 + 2)]\n+\n+        The following example is a regression in Maxima 5.39.0,\n+        it used to be possible to get 2 solutions here, see\n+        https://sourceforge.net/p/maxima/bugs/3276/::\n+\n             sage: solve(Q*sqrt(Q^2 + 2) - 1, Q, to_poly_solve=True)\n-            [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]\n+            [Q == -sqrt(-sqrt(2) - 1)]\n \n         In some cases there may be infinitely many solutions indexed\n         by a dummy variable.  If it begins with ``z``, it is implicitly\n```\nI would instead mark the previous solution as `# known bug` or at least keep the solution. Same in `calculus/tests.py`.",
    "created_at": "2017-01-18T16:14:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265234",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:114" align="right">comment:114</div>

Instead of removing this doctest:

```diff
diff --git a/src/sage/symbolic/expression.pyx b/src/sage/symbolic/expression.pyx
index 80c7149..0ca7904 100644
--- a/src/sage/symbolic/expression.pyx
+++ b/src/sage/symbolic/expression.pyx
@@ -10597,8 +10597,13 @@ cdef class Expression(CommutativeRingElement):
             Q
             sage: solve(Q*sqrt(Q^2 + 2) - 1, Q)
             [Q == 1/sqrt(Q^2 + 2)]
+
+        The following example is a regression in Maxima 5.39.0,
+        it used to be possible to get 2 solutions here, see
+        https://sourceforge.net/p/maxima/bugs/3276/::
+
             sage: solve(Q*sqrt(Q^2 + 2) - 1, Q, to_poly_solve=True)
-            [Q == 1/sqrt(-sqrt(2) + 1), Q == 1/sqrt(sqrt(2) + 1)]
+            [Q == -sqrt(-sqrt(2) - 1)]
 
         In some cases there may be infinitely many solutions indexed
         by a dummy variable.  If it begins with ``z``, it is implicitly
```
I would instead mark the previous solution as `# known bug` or at least keep the solution. Same in `calculus/tests.py`.



---

archive/issue_comments_265235.json:
```json
{
    "body": "<div id=\"comment:115\" align=\"right\">comment:115</div>\n\nOn Debian testing (Core i7 + 16 GB Ram), on a branch where R 3.2.2 is merged with the latest released Sage, a parallel test (`MAKE=\"make -j8\"`) gives :\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 114.8 src/sage/tests/cmdline.py  # 2 doctests failed\nsage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\nsage -t --long --warn-long 114.8 src/sage/interfaces/tests.py  # 1 doctest failed\nsage -t --long --warn-long 114.8 src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t --long --warn-long 114.8 src/sage/modules/free_module_element.pyx  # Timed out\n----------------------------------------------------------------------\n```\n\n4 of these five are transient, and pass when run sandalone.\n\nHowever:\n\n```\ncharpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py\nRunning doctests with ID 2017-01-18-16-59-41-26a3a809.\nGit branch: testR\nUsing --optional=database_gap,giacpy_sage,mpir,python2,sage,xz\nDoctesting 1 file.\nsage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py\n**********************************************************************\nFile \"src/sage/rings/polynomial/multi_polynomial_ideal.py\", line 3532, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_basis\nFailed example:\n    ideal(J.transformed_basis()).change_ring(P).interreduced_basis()  # optional - giacpy_sage\nExpected:\n    [a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]\nGot:\n    [7*a - 420*c^3 + 158*c^2 + 8*c - 7, 7*b + 210*c^3 - 79*c^2 + 3*c, 84*c^4 - 40*c^3 + c^2 + c]\n**********************************************************************\n1 item had failures:\n   1 of  67 in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_basis\n    [727 tests, 1 failure, 9.29 s]\n----------------------------------------------------------------------\nsage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 9.4 seconds\n    cpu time: 15.5 seconds\n    cumulative wall time: 9.3 seconds\n```\n\nThis latter bug is known, not really a bug and has its own ticket.\n\nFurthermore, Maxima 5.38.1 (Debian testing current version) fixes one of my pet peeves :\n\n```\ncharpent@SAP5057241:~$ maxima\n\nMaxima 5.38.1 http://maxima.sourceforge.net\nusing Lisp GNU Common Lisp (GCL) GCL 2.6.12\nDistributed under the GNU Public License. See the file COPYING.\nDedicated to the memory of William Schelter.\nThe function bug_report() provides bug reporting information.\n(%i1) display2d:false;\n\n(%o1) false\n(%i2) integrate(f(x),x);\n\n(%o2) 'integrate(f(x),x)\n(%i3) taylor(integrate(f(x),x),x,x_0,2);\n\n(%o3) 'at('integrate(f(x),x),x = x_0)+f(x_0)*(x-x_0)\n                                     +(('at('diff(f(x),x,1),x = x_0))\n                                      *(x-x_0)^2)\n                                      /2\n```\n\nWhereas Sage's Maxima gives :\n\n```\ncharpent@SAP5057241:~$ sage -maxima\n;;; Loading #P\"/usr/local/sage-7/local/lib/ecl/sb-bsd-sockets.fas\"\n;;; Loading #P\"/usr/local/sage-7/local/lib/ecl/sockets.fas\"\n;;; Loading #P\"/usr/local/sage-7/local/lib/ecl/defsystem.fas\"\n;;; Loading #P\"/usr/local/sage-7/local/lib/ecl/cmp.fas\"\nMaxima 5.39.0 http://maxima.sourceforge.net\nusing Lisp ECL 16.1.2\nDistributed under the GNU Public License. See the file COPYING.\nDedicated to the memory of William Schelter.\nThe function bug_report() provides bug reporting information.\n(%i1) display2d:false;\n\n(%o1) false\n(%i2) integrate(f(x),x);         \n\n(%o2) 'integrate(f(x),x)\n(%i3) taylor(integrate(f(x),x),x,x_0,2);\n\ntaylor: unable to expand at a point specified in:\n'integrate(f(x),x)\n -- an error. To debug this try: debugmode(true);\n```\n\nSo, we have :\n* already known problems with parallel testing ;\n* one already reported and ticketed test failure ;\n* one not already reported problem, that continues the previous behaviour of Maxima-in-Sage, whereas this behavior has been fixed in 5.38.1.\n\nNone of these seem to impede giving this ticket a `positive_review`. Which I'd do unless you think that the behavior of the `taylor(integrate(...)...)` should/could be fixed with this issue.\n\nHowever, I think the objection of Thierry Scrim (?) valid, and I think it is more important, since it points out a case where Maxima's answer is incomplete. Hence ==>`needs_work`.",
    "created_at": "2017-01-18T16:25:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265235",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:115" align="right">comment:115</div>

On Debian testing (Core i7 + 16 GB Ram), on a branch where R 3.2.2 is merged with the latest released Sage, a parallel test (`MAKE="make -j8"`) gives :

```
----------------------------------------------------------------------
sage -t --long --warn-long 114.8 src/sage/tests/cmdline.py  # 2 doctests failed
sage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
sage -t --long --warn-long 114.8 src/sage/interfaces/tests.py  # 1 doctest failed
sage -t --long --warn-long 114.8 src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t --long --warn-long 114.8 src/sage/modules/free_module_element.pyx  # Timed out
----------------------------------------------------------------------
```

4 of these five are transient, and pass when run sandalone.

However:

```
charpent@asus16-ec:/usr/local/sage-7$ sage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py
Running doctests with ID 2017-01-18-16-59-41-26a3a809.
Git branch: testR
Using --optional=database_gap,giacpy_sage,mpir,python2,sage,xz
Doctesting 1 file.
sage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py
**********************************************************************
File "src/sage/rings/polynomial/multi_polynomial_ideal.py", line 3532, in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_basis
Failed example:
    ideal(J.transformed_basis()).change_ring(P).interreduced_basis()  # optional - giacpy_sage
Expected:
    [a - 60*c^3 + 158/7*c^2 + 8/7*c - 1, b + 30*c^3 - 79/7*c^2 + 3/7*c, c^4 - 10/21*c^3 + 1/84*c^2 + 1/84*c]
Got:
    [7*a - 420*c^3 + 158*c^2 + 8*c - 7, 7*b + 210*c^3 - 79*c^2 + 3*c, 84*c^4 - 40*c^3 + c^2 + c]
**********************************************************************
1 item had failures:
   1 of  67 in sage.rings.polynomial.multi_polynomial_ideal.NCPolynomialIdeal.groebner_basis
    [727 tests, 1 failure, 9.29 s]
----------------------------------------------------------------------
sage -t --long --warn-long 114.8 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 9.4 seconds
    cpu time: 15.5 seconds
    cumulative wall time: 9.3 seconds
```

This latter bug is known, not really a bug and has its own ticket.

Furthermore, Maxima 5.38.1 (Debian testing current version) fixes one of my pet peeves :

```
charpent@SAP5057241:~$ maxima

Maxima 5.38.1 http://maxima.sourceforge.net
using Lisp GNU Common Lisp (GCL) GCL 2.6.12
Distributed under the GNU Public License. See the file COPYING.
Dedicated to the memory of William Schelter.
The function bug_report() provides bug reporting information.
(%i1) display2d:false;

(%o1) false
(%i2) integrate(f(x),x);

(%o2) 'integrate(f(x),x)
(%i3) taylor(integrate(f(x),x),x,x_0,2);

(%o3) 'at('integrate(f(x),x),x = x_0)+f(x_0)*(x-x_0)
                                     +(('at('diff(f(x),x,1),x = x_0))
                                      *(x-x_0)^2)
                                      /2
```

Whereas Sage's Maxima gives :

```
charpent@SAP5057241:~$ sage -maxima
;;; Loading #P"/usr/local/sage-7/local/lib/ecl/sb-bsd-sockets.fas"
;;; Loading #P"/usr/local/sage-7/local/lib/ecl/sockets.fas"
;;; Loading #P"/usr/local/sage-7/local/lib/ecl/defsystem.fas"
;;; Loading #P"/usr/local/sage-7/local/lib/ecl/cmp.fas"
Maxima 5.39.0 http://maxima.sourceforge.net
using Lisp ECL 16.1.2
Distributed under the GNU Public License. See the file COPYING.
Dedicated to the memory of William Schelter.
The function bug_report() provides bug reporting information.
(%i1) display2d:false;

(%o1) false
(%i2) integrate(f(x),x);         

(%o2) 'integrate(f(x),x)
(%i3) taylor(integrate(f(x),x),x,x_0,2);

taylor: unable to expand at a point specified in:
'integrate(f(x),x)
 -- an error. To debug this try: debugmode(true);
```

So, we have :
* already known problems with parallel testing ;
* one already reported and ticketed test failure ;
* one not already reported problem, that continues the previous behaviour of Maxima-in-Sage, whereas this behavior has been fixed in 5.38.1.

None of these seem to impede giving this ticket a `positive_review`. Which I'd do unless you think that the behavior of the `taylor(integrate(...)...)` should/could be fixed with this issue.

However, I think the objection of Thierry Scrim (?) valid, and I think it is more important, since it points out a case where Maxima's answer is incomplete. Hence ==>`needs_work`.



---

archive/issue_events_266167.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-01-18T16:25:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266167"
}
```



---

archive/issue_events_266168.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-01-18T16:25:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266168"
}
```



---

archive/issue_comments_265236.json:
```json
{
    "body": "<div id=\"comment:116\" align=\"right\">comment:116</div>\n\nReplying to [@dimpase](#comment%3A108):\n> 4) this is a known Maxima issue [bug report](https://sourceforge.net/p/maxima/bugs/3237/):\n> \n> ```\n> sage -t src/sage/interfaces/maxima_lib.py\n> ******************************************************************\n> ****\n> File \"src/sage/interfaces/maxima_lib.py\", line 724, in sage.interf\n> aces.maxima_lib.MaximaLib.sr_integral\n> Failed example:\n>     integrate(1 / (1 + abs(x-5)), x, -5, 6)\n> Exception raised:\n> ...\n>     TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage\n> **********************************************************************\n> ```\n\nActually I believe Maxima is not to blame here, and in the bug report the dev says \"not technically incorrect\". See #17892 for our symbolic limit ticket.",
    "created_at": "2017-01-18T16:44:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265236",
    "user": "https://github.com/rwst"
}
```

<div id="comment:116" align="right">comment:116</div>

Replying to [@dimpase](#comment%3A108):
> 4) this is a known Maxima issue [bug report](https://sourceforge.net/p/maxima/bugs/3237/):
> 
> ```
> sage -t src/sage/interfaces/maxima_lib.py
> ******************************************************************
> ****
> File "src/sage/interfaces/maxima_lib.py", line 724, in sage.interf
> aces.maxima_lib.MaximaLib.sr_integral
> Failed example:
>     integrate(1 / (1 + abs(x-5)), x, -5, 6)
> Exception raised:
> ...
>     TypeError: unable to make sense of Maxima expression 'limit(if(-(_SAGE_VAR_x-5)>0,-log(6-_SAGE_VAR_x),log(abs(_SAGE_VAR_x-4))),_SAGE_VAR_x,-5,plus)' in Sage
> **********************************************************************
> ```

Actually I believe Maxima is not to blame here, and in the bug report the dev says "not technically incorrect". See #17892 for our symbolic limit ticket.



---

archive/issue_comments_265237.json:
```json
{
    "body": "Changed commit from **[`68a0ab2`](https://github.com/sagemath/sagetrac-mirror/commit/68a0ab241a065f9f133a8915cc2141b9f514892c)** to **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)**",
    "created_at": "2017-01-18T18:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265237",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`68a0ab2`](https://github.com/sagemath/sagetrac-mirror/commit/68a0ab241a065f9f133a8915cc2141b9f514892c)** to **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)**



---

archive/issue_comments_265238.json:
```json
{
    "body": "<div id=\"comment:117\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8\"><code>0f2acfe</code></a></td><td><code>addressed the reviewers' concerns.</code></td></tr></table>\n",
    "created_at": "2017-01-18T18:22:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265238",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:117"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8"><code>0f2acfe</code></a></td><td><code>addressed the reviewers' concerns.</code></td></tr></table>




---

archive/issue_events_266169.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-18T18:23:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266169"
}
```



---

archive/issue_events_266170.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-18T18:23:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266170"
}
```



---

archive/issue_comments_265239.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nAs a minor point, when reviewing documentation tickets I always ask that lines be kept to about the same length. I would appreciate if you could break the long lines here, especially in the tutorials. Thanks.",
    "created_at": "2017-01-18T21:46:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265239",
    "user": "https://github.com/paulmasson"
}
```

<div id="comment:119" align="right">comment:119</div>

As a minor point, when reviewing documentation tickets I always ask that lines be kept to about the same length. I would appreciate if you could break the long lines here, especially in the tutorials. Thanks.



---

archive/issue_comments_265240.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nThis time, three failures in a parallel `ptestlong` :\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 110.0 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed\nsage -t --long --warn-long 110.0 src/sage/homology/simplicial_complex.py  # 1 doctest failed\nsage -t --long --warn-long 110.0 src/sage/graphs/generators/smallgraphs.py  # Timed out\n----------------------------------------------------------------------\n```\n\nOlny the firs one persists when run standalone, and is our old aquaintance... The other two are transient (race conditions ?)\n\nSince the explanation given in #22191 show that the problem I signaled before is in ECL's realm, not Maxima's, there is no reason not to give this a `positive_review`.\n\nAaaaahhhhh !",
    "created_at": "2017-01-18T23:03:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265240",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:120" align="right">comment:120</div>

This time, three failures in a parallel `ptestlong` :

```
----------------------------------------------------------------------
sage -t --long --warn-long 110.0 src/sage/rings/polynomial/multi_polynomial_ideal.py  # 1 doctest failed
sage -t --long --warn-long 110.0 src/sage/homology/simplicial_complex.py  # 1 doctest failed
sage -t --long --warn-long 110.0 src/sage/graphs/generators/smallgraphs.py  # Timed out
----------------------------------------------------------------------
```

Olny the firs one persists when run standalone, and is our old aquaintance... The other two are transient (race conditions ?)

Since the explanation given in #22191 show that the problem I signaled before is in ECL's realm, not Maxima's, there is no reason not to give this a `positive_review`.

Aaaaahhhhh !



---

archive/issue_events_266171.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-01-18T23:03:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266171"
}
```



---

archive/issue_events_266172.json:
```json
{
    "actor": "https://github.com/EmmanuelCharpentier",
    "created_at": "2017-01-18T23:03:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266172"
}
```



---

archive/issue_comments_265241.json:
```json
{
    "body": "<div id=\"comment:121\" align=\"right\">comment:121</div>\n\nReviewer name missing",
    "created_at": "2017-01-18T23:17:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265241",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:121" align="right">comment:121</div>

Reviewer name missing



---

archive/issue_events_266173.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-18T23:17:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266173"
}
```



---

archive/issue_events_266174.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-18T23:17:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266174"
}
```



---

archive/issue_comments_265242.json:
```json
{
    "body": "Reviewer: **Travis Scrimshaw, Emmanuel Charpentier**",
    "created_at": "2017-01-18T23:20:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265242",
    "user": "https://github.com/tscrim"
}
```

Reviewer: **Travis Scrimshaw, Emmanuel Charpentier**



---

archive/issue_events_266175.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-01-18T23:20:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266175"
}
```



---

archive/issue_events_266176.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2017-01-18T23:20:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266176"
}
```



---

archive/issue_comments_265243.json:
```json
{
    "body": "Changed work issues from **fix doctests** to none",
    "created_at": "2017-01-18T23:20:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265243",
    "user": "https://github.com/tscrim"
}
```

Changed work issues from **fix doctests** to none



---

archive/issue_comments_265244.json:
```json
{
    "body": "Changed reviewer from **Travis Scrimshaw, Emmanuel Charpentier** to **Travis Scrimshaw, Emmanuel Charpentier, Fran\u00e7ois Bissey, Jeroen Demeyer, Nils Bruin**",
    "created_at": "2017-01-18T23:26:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265244",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Travis Scrimshaw, Emmanuel Charpentier** to **Travis Scrimshaw, Emmanuel Charpentier, Fran√ßois Bissey, Jeroen Demeyer, Nils Bruin**



---

archive/issue_comments_265245.json:
```json
{
    "body": "<div id=\"comment:123\" align=\"right\">comment:123</div>\n\nAdding some other people who I recall contributing comments, but may not be comprehensive or conservative (i.e., add/subtract your name).",
    "created_at": "2017-01-18T23:26:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265245",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:123" align="right">comment:123</div>

Adding some other people who I recall contributing comments, but may not be comprehensive or conservative (i.e., add/subtract your name).



---

archive/issue_comments_265246.json:
```json
{
    "body": "<div id=\"comment:124\" align=\"right\">comment:124</div>\n\npublic/maxima5390 doesn't exist... typo?",
    "created_at": "2017-01-21T17:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265246",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:124" align="right">comment:124</div>

public/maxima5390 doesn't exist... typo?



---

archive/issue_events_266177.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-21T17:57:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266177"
}
```



---

archive/issue_events_266178.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-21T17:57:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266178"
}
```



---

archive/issue_comments_265247.json:
```json
{
    "body": "Changed commit from **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)** to none",
    "created_at": "2017-01-21T17:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265247",
    "user": "https://github.com/vbraun"
}
```

Changed commit from **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)** to none



---

archive/issue_comments_265248.json:
```json
{
    "body": "<div id=\"comment:125\" align=\"right\">comment:125</div>\n\nwhat? so it did quietly vanish? IMHO the whole git tree is fcked:\n\n```\n$ git push trac HEAD:public/maxima5390bis \nerror: unable to push to unqualified destination: public/maxima5390bis\nThe destination refspec neither matches an existing ref on the remote nor\nbegins with refs/, and we are unable to guess a prefix based on the source ref.\nerror: failed to push some refs to 'git@trac.sagemath.org:sage.git'\n```\n\nEDIT: this went through on a 3rd attempt",
    "created_at": "2017-01-21T18:09:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265248",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:125" align="right">comment:125</div>

what? so it did quietly vanish? IMHO the whole git tree is fcked:

```
$ git push trac HEAD:public/maxima5390bis 
error: unable to push to unqualified destination: public/maxima5390bis
The destination refspec neither matches an existing ref on the remote nor
begins with refs/, and we are unable to guess a prefix based on the source ref.
error: failed to push some refs to 'git@trac.sagemath.org:sage.git'
```

EDIT: this went through on a 3rd attempt



---

archive/issue_events_266179.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-21T18:19:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266179"
}
```



---

archive/issue_events_266180.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-21T18:19:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266180"
}
```



---

archive/issue_comments_265249.json:
```json
{
    "body": "Changed branch from **[public/maxima5390](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390)** to **[public/maxima5390bis](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390bis)**",
    "created_at": "2017-01-21T18:19:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265249",
    "user": "https://github.com/dimpase"
}
```

Changed branch from **[public/maxima5390](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390)** to **[public/maxima5390bis](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390bis)**



---

archive/issue_comments_265250.json:
```json
{
    "body": "Commit: **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)**",
    "created_at": "2017-01-21T18:19:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265250",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)**



---

archive/issue_comments_265251.json:
```json
{
    "body": "<div id=\"comment:127\" align=\"right\">comment:127</div>\n\nCould please a reviewer compare the new branch with the old one he has locally? E.g. as follows:\n\n```\ngit fetch trac public/maxima5390bis\ngit diff FETCH_HEAD trac/public/maxima5390\n```\nif this `diff` returns nothing we're good to go.",
    "created_at": "2017-01-21T18:23:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265251",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:127" align="right">comment:127</div>

Could please a reviewer compare the new branch with the old one he has locally? E.g. as follows:

```
git fetch trac public/maxima5390bis
git diff FETCH_HEAD trac/public/maxima5390
```
if this `diff` returns nothing we're good to go.



---

archive/issue_comments_265252.json:
```json
{
    "body": "<div id=\"comment:128\" align=\"right\">comment:128</div>\n\nI use git-trac (nice !...), so I did :\n\n```\ncharpent@asus16-ec:/usr/local/sage-7$ git fetch trac public/maxima5390bis\nDepuis git://trac.sagemath.org/sage\n * branch                  public/maxima5390bis -> FETCH_HEAD\ncharpent@asus16-ec:/usr/local/sage-7$ git diff FETCH_HEAD t/18920/public/maxima5390 \ncharpent@asus16-ec:/usr/local/sage-7$ \n```\nSo, unless I'm mistaken, \"we're good to go\"...\n\nHTH,",
    "created_at": "2017-01-21T19:01:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265252",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:128" align="right">comment:128</div>

I use git-trac (nice !...), so I did :

```
charpent@asus16-ec:/usr/local/sage-7$ git fetch trac public/maxima5390bis
Depuis git://trac.sagemath.org/sage
 * branch                  public/maxima5390bis -> FETCH_HEAD
charpent@asus16-ec:/usr/local/sage-7$ git diff FETCH_HEAD t/18920/public/maxima5390 
charpent@asus16-ec:/usr/local/sage-7$ 
```
So, unless I'm mistaken, "we're good to go"...

HTH,



---

archive/issue_events_266181.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-21T19:07:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266181"
}
```



---

archive/issue_events_266182.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-21T19:07:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266182"
}
```



---

archive/issue_comments_265253.json:
```json
{
    "body": "<div id=\"comment:130\" align=\"right\">comment:130</div>\n\nThanks. Hope the branch will not be cut again...",
    "created_at": "2017-01-21T21:25:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265253",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:130" align="right">comment:130</div>

Thanks. Hope the branch will not be cut again...



---

archive/issue_events_266183.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-22T09:49:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266183"
}
```



---

archive/issue_events_266184.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-22T09:49:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266184"
}
```



---

archive/issue_comments_265254.json:
```json
{
    "body": "<div id=\"comment:131\" align=\"right\">comment:131</div>\n\nFails to build, e.g. http://build.sagedev.org/#/builders/16/builds/8/steps/5/logs/maxima",
    "created_at": "2017-01-22T09:49:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265254",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:131" align="right">comment:131</div>

Fails to build, e.g. http://build.sagedev.org/#/builders/16/builds/8/steps/5/logs/maxima



---

archive/issue_comments_265255.json:
```json
{
    "body": "<div id=\"comment:132\" align=\"right\">comment:132</div>\n\nIt says `makeinfo not found`. Great, we always had a few for maxima's documentation but I thought `makeinfo` was a requisite.",
    "created_at": "2017-01-22T09:52:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265255",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:132" align="right">comment:132</div>

It says `makeinfo not found`. Great, we always had a few for maxima's documentation but I thought `makeinfo` was a requisite.



---

archive/issue_comments_265256.json:
```json
{
    "body": "<div id=\"comment:133\" align=\"right\">comment:133</div>\n\nMaybe there is a make target that doesn't build the texinfo docs?",
    "created_at": "2017-01-22T09:59:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265256",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:133" align="right">comment:133</div>

Maybe there is a make target that doesn't build the texinfo docs?



---

archive/issue_comments_265257.json:
```json
{
    "body": "<div id=\"comment:134\" align=\"right\">comment:134</div>\n\nReplying to [@vbraun](#comment%3A131):\n> Fails to build, e.g. http://build.sagedev.org/#/builders/16/builds/8/steps/5/logs/maxima\n\nI cannot find anything there, the interface is pretty impossible to use for me.\nCan I have a link to the log file I can download?",
    "created_at": "2017-01-22T10:00:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265257",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:134" align="right">comment:134</div>

Replying to [@vbraun](#comment%3A131):
> Fails to build, e.g. http://build.sagedev.org/#/builders/16/builds/8/steps/5/logs/maxima

I cannot find anything there, the interface is pretty impossible to use for me.
Can I have a link to the log file I can download?



---

archive/issue_comments_265258.json:
```json
{
    "body": "<div id=\"comment:135\" align=\"right\">comment:135</div>\n\nReplying to [@vbraun](#comment%3A133):\n> Maybe there is a make target that doesn't build the texinfo docs?\n\nI'd say, just add `makeinfo` to the list of pre-reqs.\nIt has been necessary to have it to build Maxima \nfor years, see e.g. https://sourceforge.net/p/maxima/bugs/2878/\n\nAnd it looks like the latter Maxima ticket did not fix anything :-)",
    "created_at": "2017-01-22T10:09:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265258",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:135" align="right">comment:135</div>

Replying to [@vbraun](#comment%3A133):
> Maybe there is a make target that doesn't build the texinfo docs?

I'd say, just add `makeinfo` to the list of pre-reqs.
It has been necessary to have it to build Maxima 
for years, see e.g. https://sourceforge.net/p/maxima/bugs/2878/

And it looks like the latter Maxima ticket did not fix anything :-)



---

archive/issue_comments_265259.json:
```json
{
    "body": "<div id=\"comment:136\" align=\"right\">comment:136</div>\n\nsomething that has been a problem since Maxima 5.23 should not stop this ticket...",
    "created_at": "2017-01-22T10:12:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265259",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:136" align="right">comment:136</div>

something that has been a problem since Maxima 5.23 should not stop this ticket...



---

archive/issue_events_266185.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-22T10:12:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266185"
}
```



---

archive/issue_events_266186.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-22T10:12:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266186"
}
```



---

archive/issue_comments_265260.json:
```json
{
    "body": "<div id=\"comment:137\" align=\"right\">comment:137</div>\n\nI think we may have some workaround by touching the right file. It is not in the current spkg-install, so we have dropped it at some point. You are right to point to upstream that they have a regression. For info:\nhttps://github.com/sagemath/sage/commit/6656b7b171d83078bd55c3cceea0f45da517ded0",
    "created_at": "2017-01-22T10:17:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265260",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:137" align="right">comment:137</div>

I think we may have some workaround by touching the right file. It is not in the current spkg-install, so we have dropped it at some point. You are right to point to upstream that they have a regression. For info:
https://github.com/sagemath/sage/commit/6656b7b171d83078bd55c3cceea0f45da517ded0



---

archive/issue_comments_265261.json:
```json
{
    "body": "<div id=\"comment:138\" align=\"right\">comment:138</div>\n\nSeriously, the buildbots don't have makeinfo installed",
    "created_at": "2017-01-22T11:04:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265261",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:138" align="right">comment:138</div>

Seriously, the buildbots don't have makeinfo installed



---

archive/issue_events_266187.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-22T11:04:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266187"
}
```



---

archive/issue_events_266188.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-22T11:04:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266188"
}
```



---

archive/issue_comments_265262.json:
```json
{
    "body": "<div id=\"comment:139\" align=\"right\">comment:139</div>\n\nReplying to [@kiwifb](#comment%3A137):\n> I think we may have some workaround by touching the right file. It is not in the current spkg-install, so we have dropped it at some point. You are right to point to upstream that they have a regression. For info:\n> https://github.com/sagemath/sage/commit/6656b7b171d83078bd55c3cceea0f45da517ded0\n\nperhaps our workound + Maxima's workarond + no makeinfo == error... :)\n\nI'll check this.",
    "created_at": "2017-01-22T11:33:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265262",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:139" align="right">comment:139</div>

Replying to [@kiwifb](#comment%3A137):
> I think we may have some workaround by touching the right file. It is not in the current spkg-install, so we have dropped it at some point. You are right to point to upstream that they have a regression. For info:
> https://github.com/sagemath/sage/commit/6656b7b171d83078bd55c3cceea0f45da517ded0

perhaps our workound + Maxima's workarond + no makeinfo == error... :)

I'll check this.



---

archive/issue_events_266189.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-22T15:36:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266189"
}
```



---

archive/issue_events_266190.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2017-01-22T15:36:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266190"
}
```



---

archive/issue_comments_265263.json:
```json
{
    "body": "<div id=\"comment:140\" align=\"right\">comment:140</div>\n\nI am not convinced whether it's at all possible to build Maxima 5.39.0 and its docs without `makeinfo`. We are on our own here, as the official upstream pre-req for the build includes autotools.\n\nInstead of wasting time on this academic issue, I'd like to rather include `makeinfo` into Sage pre-reqs.",
    "created_at": "2017-01-22T15:36:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265263",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:140" align="right">comment:140</div>

I am not convinced whether it's at all possible to build Maxima 5.39.0 and its docs without `makeinfo`. We are on our own here, as the official upstream pre-req for the build includes autotools.

Instead of wasting time on this academic issue, I'd like to rather include `makeinfo` into Sage pre-reqs.



---

archive/issue_comments_265264.json:
```json
{
    "body": "<div id=\"comment:141\" align=\"right\">comment:141</div>\n\nI have opened a new [Maxima ticket](https://sourceforge.net/p/maxima/bugs/3278/) on the `makeinfo` question.",
    "created_at": "2017-01-22T15:52:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265264",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:141" align="right">comment:141</div>

I have opened a new [Maxima ticket](https://sourceforge.net/p/maxima/bugs/3278/) on the `makeinfo` question.



---

archive/issue_comments_265265.json:
```json
{
    "body": "<div id=\"comment:142\" align=\"right\">comment:142</div>\n\nReplying to [@dimpase](#comment%3A140):\n> I am not convinced whether it's at all possible to build Maxima 5.39.0 and its docs without `makeinfo`. We are on our own here, as the official upstream pre-req for the build includes autotools.\n> \n> Instead of wasting time on this academic issue, I'd like to rather include `makeinfo` into Sage pre-reqs.\n> \n\nSeconded, on basic principles :\n\n[ The following rant is not gratuitous. It's just a lemma. Bear with me for a while... ]\n\nOur \"batteries included\" so-called philosophy has pushed us to include more and more software of peripheral interest at best up to the point where Sage is now a small-scale, highly specialized Linux distribution.\n\nThis distribution is of great interest to sage **builders** (i. e. potential developpers). It is at best an hindrance (read \"pain in the *ss\") to what should be one of our primary targets : the potential **users** of Sage. And no, this cannot be restricted to research mathematicians specializing in number theory...\n\nFor example, going to the pain to build our own GCC collection seems to me pushing consistency exigences a bit too far. Requiring from an *installer* (i. e. potential developper) to take the pain to install a matching set of decently recent compilers does not sound too much to me.\n\nCorollary : our **binary** tarballs/packages should be sound enough to satisfy the largest possible number of potential **users**. That means that our users should not be requested to install and manage a virtual machine setup, nor a complicated installation on \"exotic\" platforms. An undergraduate or even high school student, a practising engineer, etc... should be able to install a precompiled binary and go use Sage as he uses a word processor, without having to install a $#!+load of tools he/she'll never use for anything else.\n\nTherefore, if we need autotools to build Maxima, let's use existing autotools distributions, and do not try to avoid it. Or maintaining our own port. Maintaining our ports should be limited to the cases where there is a mathematical reason to do so.\n\n[ End of rant. Now for its consequences : ]\n\nTherefore, I think that wiggling away from one more tool to build Sage amounts to trying to alleviate the load of **developers**. Which is the wrong target. Our primary goal should be to alleviate the load  imposed on **users**.\n\nThose two sets were largely overlapping in the begionning of Sage, which as long been targeted on a certain research community. This is no longer the case. Sage now needs a lot of **users**, able to report problems, if we want to be able to fix them.\n\nSo, in the present case, if autotools is needed to build Maxima, let's depend on it **for building Sage**. But users of a binary distribution of Sage should not have to bother themselves with that.\n\nIn other (shorter) words : I'm not bothered by one more build dependency, if I can lighten the run dependencies... This seems the case here.\n\nCorollary : the time spent on arguing and nitpicking over autotools would have been better spent helping Eric Bray's Cygwin port *cum* Windows installer, which opens us a quite large pool of potential users...",
    "created_at": "2017-01-22T16:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265265",
    "user": "https://github.com/EmmanuelCharpentier"
}
```

<div id="comment:142" align="right">comment:142</div>

Replying to [@dimpase](#comment%3A140):
> I am not convinced whether it's at all possible to build Maxima 5.39.0 and its docs without `makeinfo`. We are on our own here, as the official upstream pre-req for the build includes autotools.
> 
> Instead of wasting time on this academic issue, I'd like to rather include `makeinfo` into Sage pre-reqs.
> 

Seconded, on basic principles :

[ The following rant is not gratuitous. It's just a lemma. Bear with me for a while... ]

Our "batteries included" so-called philosophy has pushed us to include more and more software of peripheral interest at best up to the point where Sage is now a small-scale, highly specialized Linux distribution.

This distribution is of great interest to sage **builders** (i. e. potential developpers). It is at best an hindrance (read "pain in the *ss") to what should be one of our primary targets : the potential **users** of Sage. And no, this cannot be restricted to research mathematicians specializing in number theory...

For example, going to the pain to build our own GCC collection seems to me pushing consistency exigences a bit too far. Requiring from an *installer* (i. e. potential developper) to take the pain to install a matching set of decently recent compilers does not sound too much to me.

Corollary : our **binary** tarballs/packages should be sound enough to satisfy the largest possible number of potential **users**. That means that our users should not be requested to install and manage a virtual machine setup, nor a complicated installation on "exotic" platforms. An undergraduate or even high school student, a practising engineer, etc... should be able to install a precompiled binary and go use Sage as he uses a word processor, without having to install a $#!+load of tools he/she'll never use for anything else.

Therefore, if we need autotools to build Maxima, let's use existing autotools distributions, and do not try to avoid it. Or maintaining our own port. Maintaining our ports should be limited to the cases where there is a mathematical reason to do so.

[ End of rant. Now for its consequences : ]

Therefore, I think that wiggling away from one more tool to build Sage amounts to trying to alleviate the load of **developers**. Which is the wrong target. Our primary goal should be to alleviate the load  imposed on **users**.

Those two sets were largely overlapping in the begionning of Sage, which as long been targeted on a certain research community. This is no longer the case. Sage now needs a lot of **users**, able to report problems, if we want to be able to fix them.

So, in the present case, if autotools is needed to build Maxima, let's depend on it **for building Sage**. But users of a binary distribution of Sage should not have to bother themselves with that.

In other (shorter) words : I'm not bothered by one more build dependency, if I can lighten the run dependencies... This seems the case here.

Corollary : the time spent on arguing and nitpicking over autotools would have been better spent helping Eric Bray's Cygwin port *cum* Windows installer, which opens us a quite large pool of potential users...



---

archive/issue_comments_265266.json:
```json
{
    "body": "<div id=\"comment:143\" align=\"right\">comment:143</div>\n\nautotools are not needed to build Maxima, but makeinfo apparently is. \n\nPerhaps one can build Maxima without makeinfo if autotools are available, I didn't check, for this is even more academic question...\n \nmakeinfo is a very easy pre-req, as it is available on every system we build Sage on, and included in XCode too.",
    "created_at": "2017-01-22T17:53:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265266",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:143" align="right">comment:143</div>

autotools are not needed to build Maxima, but makeinfo apparently is. 

Perhaps one can build Maxima without makeinfo if autotools are available, I didn't check, for this is even more academic question...
 
makeinfo is a very easy pre-req, as it is available on every system we build Sage on, and included in XCode too.



---

archive/issue_comments_265267.json:
```json
{
    "body": "Changed commit from **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)** to **[`0ee645a`](https://github.com/sagemath/sagetrac-mirror/commit/0ee645af1e93d1c2b74da7848d07157f0181f2a2)**",
    "created_at": "2017-01-22T19:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265267",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0f2acfe`](https://github.com/sagemath/sagetrac-mirror/commit/0f2acfee0045d5179c805333c06061c2a4fe8ae8)** to **[`0ee645a`](https://github.com/sagemath/sagetrac-mirror/commit/0ee645af1e93d1c2b74da7848d07157f0181f2a2)**



---

archive/issue_comments_265268.json:
```json
{
    "body": "<div id=\"comment:144\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/0ee645af1e93d1c2b74da7848d07157f0181f2a2\"><code>0ee645a</code></a></td><td><code>Re-introduce the makeinfo workaround until upstream fix it again</code></td></tr></table>\n",
    "created_at": "2017-01-22T19:01:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265268",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:144"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/0ee645af1e93d1c2b74da7848d07157f0181f2a2"><code>0ee645a</code></a></td><td><code>Re-introduce the makeinfo workaround until upstream fix it again</code></td></tr></table>




---

archive/issue_events_266191.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-01-22T19:07:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266191"
}
```



---

archive/issue_events_266192.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-01-22T19:07:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266192"
}
```



---

archive/issue_comments_265269.json:
```json
{
    "body": "<div id=\"comment:145\" align=\"right\">comment:145</div>\n\nI think this is enough. \n\nI have now re-introduced the `makeinfo` workaround and my logs says it is safe to use on a `makeinfo`-less system.\n\nI appreciate the feeling Emmanuel but the place for it is sage-devel - of course nothing is likely to happen for it in the short term. The reality is now there are plenty of \"user space\" package management solution around (not so many when sage was started) and most of them do a better job than the sage packaging system. The other reality is those other packaging system usually don't play well with sage. We pick problems regularly from users with a default installation of brew on OS X for example.",
    "created_at": "2017-01-22T19:07:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265269",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:145" align="right">comment:145</div>

I think this is enough. 

I have now re-introduced the `makeinfo` workaround and my logs says it is safe to use on a `makeinfo`-less system.

I appreciate the feeling Emmanuel but the place for it is sage-devel - of course nothing is likely to happen for it in the short term. The reality is now there are plenty of "user space" package management solution around (not so many when sage was started) and most of them do a better job than the sage packaging system. The other reality is those other packaging system usually don't play well with sage. We pick problems regularly from users with a default installation of brew on OS X for example.



---

archive/issue_comments_265270.json:
```json
{
    "body": "<div id=\"comment:146\" align=\"right\">comment:146</div>\n\nReplying to [@EmmanuelCharpentier](#comment%3A142):\n> So, in the present case, if autotools is needed to build Maxima, let's depend on it **for building Sage**. But users of a binary distribution of Sage should not have to bother themselves with that.\n> \n> In other (shorter) words : I'm not bothered by one more build dependency, if I can lighten the run dependencies... This seems the case here.\n\nUsers of binary distributions of Sage should still be able to install optional and experimental packages. Since there is no binary distribution of optional packages, build-time tools need to be included.\n\nI would propose to add a standard package that includes (a current version of) texinfo (which provides makeinfo). Note that our autotools spkg packages only an ancient version of texinfo (4.13) (see #21196 for a discussion).",
    "created_at": "2017-01-22T19:09:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265270",
    "user": "https://github.com/mkoeppe"
}
```

<div id="comment:146" align="right">comment:146</div>

Replying to [@EmmanuelCharpentier](#comment%3A142):
> So, in the present case, if autotools is needed to build Maxima, let's depend on it **for building Sage**. But users of a binary distribution of Sage should not have to bother themselves with that.
> 
> In other (shorter) words : I'm not bothered by one more build dependency, if I can lighten the run dependencies... This seems the case here.

Users of binary distributions of Sage should still be able to install optional and experimental packages. Since there is no binary distribution of optional packages, build-time tools need to be included.

I would propose to add a standard package that includes (a current version of) texinfo (which provides makeinfo). Note that our autotools spkg packages only an ancient version of texinfo (4.13) (see #21196 for a discussion).



---

archive/issue_comments_265271.json:
```json
{
    "body": "<div id=\"comment:147\" align=\"right\">comment:147</div>\n\nReplying to [@dimpase](#comment%3A143):\n> autotools are not needed to build Maxima, but makeinfo apparently is. \n\nIt should not be; the bug is that the necessary TeX files are not included in the tarball.  Even if the user does not have makeinfo, there should be no problem because the configure script will set $(MAKEINFO) to a command that does nothing.  There is at least one place where a Maxima makefile uses `makeinfo` instead of `$(MAKEINFO)`.  In #17514 I fixed this specific one, but I seem to remember another problem of this kind in newer Maxima versions.  Anyway, the only way to really fix this is if the Maxima developers make sure that all TeX files are in the distribution.",
    "created_at": "2017-01-23T07:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265271",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:147" align="right">comment:147</div>

Replying to [@dimpase](#comment%3A143):
> autotools are not needed to build Maxima, but makeinfo apparently is. 

It should not be; the bug is that the necessary TeX files are not included in the tarball.  Even if the user does not have makeinfo, there should be no problem because the configure script will set $(MAKEINFO) to a command that does nothing.  There is at least one place where a Maxima makefile uses `makeinfo` instead of `$(MAKEINFO)`.  In #17514 I fixed this specific one, but I seem to remember another problem of this kind in newer Maxima versions.  Anyway, the only way to really fix this is if the Maxima developers make sure that all TeX files are in the distribution.



---

archive/issue_comments_265272.json:
```json
{
    "body": "<div id=\"comment:149\" align=\"right\">comment:149</div>\n\nI have got a funny failing doctest in sage-on-gentoo but I am not completely sure this ticket is responsible (I am testing from the current develop branch of Volker's fork where he is testing this now)\n\n```\nsage -t --long /usr/lib64/python2.7/site-packages/sage/functions/special.py\n**********************************************************************\nFile \"/usr/lib64/python2.7/site-packages/sage/functions/special.py\", line 232, in sage.functions.special.SphericalHarmonic._eval_\nFailed example:\n    spherical_harmonic(3,2,1,2*pi/3)\nExpected:\n    1/240*sqrt(30)*(-15*I*sqrt(7)*sqrt(3)\n     - 15*sqrt(7))*cos(1)*sin(1)^2/sqrt(pi)\nGot:\n    -1/240*sqrt(30)*(15*I*sqrt(7)*sqrt(3) + 15*sqrt(7))*cos(1)*sin(1)^2/sqrt(pi)\n**********************************************************************\n```\nAs you can see they are actually identical...",
    "created_at": "2017-01-24T19:14:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265272",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:149" align="right">comment:149</div>

I have got a funny failing doctest in sage-on-gentoo but I am not completely sure this ticket is responsible (I am testing from the current develop branch of Volker's fork where he is testing this now)

```
sage -t --long /usr/lib64/python2.7/site-packages/sage/functions/special.py
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/functions/special.py", line 232, in sage.functions.special.SphericalHarmonic._eval_
Failed example:
    spherical_harmonic(3,2,1,2*pi/3)
Expected:
    1/240*sqrt(30)*(-15*I*sqrt(7)*sqrt(3)
     - 15*sqrt(7))*cos(1)*sin(1)^2/sqrt(pi)
Got:
    -1/240*sqrt(30)*(15*I*sqrt(7)*sqrt(3) + 15*sqrt(7))*cos(1)*sin(1)^2/sqrt(pi)
**********************************************************************
```
As you can see they are actually identical...



---

archive/issue_comments_265273.json:
```json
{
    "body": "<div id=\"comment:150\" align=\"right\">comment:150</div>\n\nI get the same on the buildbot....",
    "created_at": "2017-01-24T23:38:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265273",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:150" align="right">comment:150</div>

I get the same on the buildbot....



---

archive/issue_events_266193.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-24T23:38:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266193"
}
```



---

archive/issue_events_266194.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-24T23:38:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266194"
}
```



---

archive/issue_comments_265274.json:
```json
{
    "body": "<div id=\"comment:151\" align=\"right\">comment:151</div>\n\nAll bots or a mixture?",
    "created_at": "2017-01-25T03:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265274",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:151" align="right">comment:151</div>

All bots or a mixture?



---

archive/issue_comments_265275.json:
```json
{
    "body": "<div id=\"comment:152\" align=\"right\">comment:152</div>\n\nall",
    "created_at": "2017-01-25T08:01:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265275",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:152" align="right">comment:152</div>

all



---

archive/issue_comments_265276.json:
```json
{
    "body": "<div id=\"comment:153\" align=\"right\">comment:153</div>\n\nDoctest introduced by #20939 merged in 7.6.beta0, that's why it was missed. The branch needs re-basing before it can be fixed. Incoming.",
    "created_at": "2017-01-25T08:37:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265276",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:153" align="right">comment:153</div>

Doctest introduced by #20939 merged in 7.6.beta0, that's why it was missed. The branch needs re-basing before it can be fixed. Incoming.



---

archive/issue_comments_265277.json:
```json
{
    "body": "<div id=\"comment:154\" align=\"right\">comment:154</div>\n\nPlease go on with this. I have negative amount of time available till the end of the week.",
    "created_at": "2017-01-25T08:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265277",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:154" align="right">comment:154</div>

Please go on with this. I have negative amount of time available till the end of the week.



---

archive/issue_comments_265278.json:
```json
{
    "body": "Changed commit from **[`0ee645a`](https://github.com/sagemath/sagetrac-mirror/commit/0ee645af1e93d1c2b74da7848d07157f0181f2a2)** to **[`a6c51e6`](https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14)**",
    "created_at": "2017-01-25T08:44:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265278",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`0ee645a`](https://github.com/sagemath/sagetrac-mirror/commit/0ee645af1e93d1c2b74da7848d07157f0181f2a2)** to **[`a6c51e6`](https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14)**



---

archive/issue_comments_265279.json:
```json
{
    "body": "<div id=\"comment:155\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/71c0cea708889fa46e14951117e1f49e83b9f918\"><code>71c0cea</code></a></td><td><code>Merge branch 'develop' into maxima5390bis</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14\"><code>a6c51e6</code></a></td><td><code>fix failing doctest introduced by #20939</code></td></tr></table>\n",
    "created_at": "2017-01-25T08:44:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265279",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:155"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/71c0cea708889fa46e14951117e1f49e83b9f918"><code>71c0cea</code></a></td><td><code>Merge branch 'develop' into maxima5390bis</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14"><code>a6c51e6</code></a></td><td><code>fix failing doctest introduced by #20939</code></td></tr></table>




---

archive/issue_events_266195.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-01-25T08:45:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266195"
}
```



---

archive/issue_events_266196.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2017-01-25T08:45:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266196"
}
```



---

archive/issue_comments_265280.json:
```json
{
    "body": "<div id=\"comment:156\" align=\"right\">comment:156</div>\n\nDefinitely, not waiting for you. Here we go again, straight to positive review.",
    "created_at": "2017-01-25T08:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265280",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:156" align="right">comment:156</div>

Definitely, not waiting for you. Here we go again, straight to positive review.



---

archive/issue_comments_265281.json:
```json
{
    "body": "Changed branch from **[public/maxima5390bis](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390bis)** to **[`a6c51e6`](https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14)**",
    "created_at": "2017-01-28T17:03:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18920#issuecomment-265281",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/maxima5390bis](https://github.com/sagemath/sagetrac-mirror/tree/public/maxima5390bis)** to **[`a6c51e6`](https://github.com/sagemath/sagetrac-mirror/commit/a6c51e6d71ceec22b0f08c28f9a1c29078fe5b14)**



---

archive/issue_events_266197.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-01-28T17:03:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266197"
}
```



---

archive/issue_events_266198.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "3ade0987c652c4d4a15a6c1e1b357a92ab4030ff",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2017-01-28T17:03:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18920",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18920#event-266198"
}
```
