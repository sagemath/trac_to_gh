# Issue 18152: Universal Cyclotomic Field implementation using libgap

archive/issues_017915.json:
```json
{
    "body": "Sage ships an implementation of the Universal Cyclotomic Field (in `sage.rings.universal_cyclotomic_field.*`) that is slower and less reliable than what is in gap. We propose in this ticket an implementation based on libgap.\n\nIt fixes some issues about the old implementation:\n- #14240:  Universal cyclotomic field breaks for moderate order\n- #16631: Universal Cyclotomic Field doesn't handle int and Integer the same\n- #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse\n- #17117: UniversalCyclotomicField elements considered real\n\nAnd is about 10x faster (see [comment:10](#comment%3A10)) except for operations on very sparse elements with very large conductors (see e.g. [comment:23](#comment%3A23), [comment:27](#comment%3A27) and [comment:28](#comment%3A28)). \n\nPossible follow up:\n- switch to Cython\n- implement dense matrices by wrapping libgap matrices (see also #16116)\n- slowness in conjugation? #18207 (see also [comment:28](#comment%3A28), this is unavoidable because gap uses a dense representation of elements)\n- interface with libgap polynomials (#18266)\n\nCC:  @nthiery stumpc5 @tscrim @vbraun\n\nBranch/Commit: b818c83bc329581c6af225dcf7b54d120e6e1e7c\n\nReviewer: Jean-Philippe Labb\u00e9\n\nAuthor: Vincent Delecroix\n\nDependencies: #18153\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18152\n\n",
    "closed_at": "2015-05-06T23:57:45Z",
    "created_at": "2015-04-09T21:41:20Z",
    "labels": [
        "component: number fields"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "Universal Cyclotomic Field implementation using libgap",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18152",
    "user": "https://github.com/videlec"
}
```
Sage ships an implementation of the Universal Cyclotomic Field (in `sage.rings.universal_cyclotomic_field.*`) that is slower and less reliable than what is in gap. We propose in this ticket an implementation based on libgap.

It fixes some issues about the old implementation:
- #14240:  Universal cyclotomic field breaks for moderate order
- #16631: Universal Cyclotomic Field doesn't handle int and Integer the same
- #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse
- #17117: UniversalCyclotomicField elements considered real

And is about 10x faster (see [comment:10](#comment%3A10)) except for operations on very sparse elements with very large conductors (see e.g. [comment:23](#comment%3A23), [comment:27](#comment%3A27) and [comment:28](#comment%3A28)). 

Possible follow up:
- switch to Cython
- implement dense matrices by wrapping libgap matrices (see also #16116)
- slowness in conjugation? #18207 (see also [comment:28](#comment%3A28), this is unavoidable because gap uses a dense representation of elements)
- interface with libgap polynomials (#18266)

CC:  @nthiery stumpc5 @tscrim @vbraun

Branch/Commit: b818c83bc329581c6af225dcf7b54d120e6e1e7c

Reviewer: Jean-Philippe Labbé

Author: Vincent Delecroix

Dependencies: #18153

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18152





---

archive/issue_comments_309669.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,7 @@\n - #14240:  Universal cyclotomic field breaks for moderate order\n - #16631: Universal Cyclotomic Field doesn't handle int and Integer the same\n - #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse\n+- #17117: UniversalCyclotomicField elements considered real\n \n Possible follow up:\n - switch to Cython\n``````\n",
    "created_at": "2015-04-09T21:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309669",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,7 @@
 - #14240:  Universal cyclotomic field breaks for moderate order
 - #16631: Universal Cyclotomic Field doesn't handle int and Integer the same
 - #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse
+- #17117: UniversalCyclotomicField elements considered real
 
 Possible follow up:
 - switch to Cython
``````




---

archive/issue_comments_309670.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#18153\"",
    "created_at": "2015-04-09T22:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309670",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "" to "#18153"



---

archive/issue_comments_309671.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/18152\"",
    "created_at": "2015-04-09T22:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309671",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/18152"



---

archive/issue_comments_309672.json:
```json
{
    "body": "Changing commit from \"\" to \"7d957347ccfeaba97438c92f6c04cbf79180f0fc\"",
    "created_at": "2015-04-09T22:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309672",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "" to "7d957347ccfeaba97438c92f6c04cbf79180f0fc"



---

archive/issue_comments_309673.json:
```json
{
    "body": "<a id='comment:3'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[31385f3](https://github.com/sagemath/sagetrac-mirror/commit/31385f3e7c8c8b5d0c856fc01bb99d50b4b7aa87)|`Trac 18153: int and infinity from libgap`|\n|[23eb30c](https://github.com/sagemath/sagetrac-mirror/commit/23eb30ccad2bb47f20e22810176733660d3c6a85)|`Trac 18152: implementation of UCF using libgap`|\n|[99c8d80](https://github.com/sagemath/sagetrac-mirror/commit/99c8d80c5f32090bbc63cfbdc63695602975f477)|`Trac 18152: remove the old implementation`|\n|[7d95734](https://github.com/sagemath/sagetrac-mirror/commit/7d957347ccfeaba97438c92f6c04cbf79180f0fc)|`Trac 18152: Fix coxeter group import`|",
    "created_at": "2015-04-09T22:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309673",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[31385f3](https://github.com/sagemath/sagetrac-mirror/commit/31385f3e7c8c8b5d0c856fc01bb99d50b4b7aa87)|`Trac 18153: int and infinity from libgap`|
|[23eb30c](https://github.com/sagemath/sagetrac-mirror/commit/23eb30ccad2bb47f20e22810176733660d3c6a85)|`Trac 18152: implementation of UCF using libgap`|
|[99c8d80](https://github.com/sagemath/sagetrac-mirror/commit/99c8d80c5f32090bbc63cfbdc63695602975f477)|`Trac 18152: remove the old implementation`|
|[7d95734](https://github.com/sagemath/sagetrac-mirror/commit/7d957347ccfeaba97438c92f6c04cbf79180f0fc)|`Trac 18152: Fix coxeter group import`|



---

archive/issue_comments_309674.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-09T22:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309674",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_309675.json:
```json
{
    "body": "<a id='comment:4'></a>\nNew commits:\n|                                                                                                                                          |                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|\n|[31385f3](https://github.com/sagemath/sagetrac-mirror/commit/31385f3e7c8c8b5d0c856fc01bb99d50b4b7aa87)|`Trac 18153: int and infinity from libgap`|\n|[23eb30c](https://github.com/sagemath/sagetrac-mirror/commit/23eb30ccad2bb47f20e22810176733660d3c6a85)|`Trac 18152: implementation of UCF using libgap`|\n|[99c8d80](https://github.com/sagemath/sagetrac-mirror/commit/99c8d80c5f32090bbc63cfbdc63695602975f477)|`Trac 18152: remove the old implementation`|\n|[7d95734](https://github.com/sagemath/sagetrac-mirror/commit/7d957347ccfeaba97438c92f6c04cbf79180f0fc)|`Trac 18152: Fix coxeter group import`|",
    "created_at": "2015-04-09T22:26:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309675",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>
New commits:
|                                                                                                                                          |                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------|
|[31385f3](https://github.com/sagemath/sagetrac-mirror/commit/31385f3e7c8c8b5d0c856fc01bb99d50b4b7aa87)|`Trac 18153: int and infinity from libgap`|
|[23eb30c](https://github.com/sagemath/sagetrac-mirror/commit/23eb30ccad2bb47f20e22810176733660d3c6a85)|`Trac 18152: implementation of UCF using libgap`|
|[99c8d80](https://github.com/sagemath/sagetrac-mirror/commit/99c8d80c5f32090bbc63cfbdc63695602975f477)|`Trac 18152: remove the old implementation`|
|[7d95734](https://github.com/sagemath/sagetrac-mirror/commit/7d957347ccfeaba97438c92f6c04cbf79180f0fc)|`Trac 18152: Fix coxeter group import`|



---

archive/issue_comments_309676.json:
```json
{
    "body": "Description changed:\n``````diff\n\n``````\n",
    "created_at": "2015-04-09T22:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309676",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff

``````




---

archive/issue_comments_309677.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                          |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|\n|[36fb6e5](https://github.com/sagemath/sagetrac-mirror/commit/36fb6e5fdf3bb7879e7b67c8c40cf69a045ac144)|`Trac 18153: better __int__ and add support for -infinity`|\n|[e34e9ca](https://github.com/sagemath/sagetrac-mirror/commit/e34e9ca6da48db87eb7ec594e6cc56e940a9aff2)|`Trac 18152: fix documentation`|",
    "created_at": "2015-04-10T04:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309677",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------|
|[36fb6e5](https://github.com/sagemath/sagetrac-mirror/commit/36fb6e5fdf3bb7879e7b67c8c40cf69a045ac144)|`Trac 18153: better __int__ and add support for -infinity`|
|[e34e9ca](https://github.com/sagemath/sagetrac-mirror/commit/e34e9ca6da48db87eb7ec594e6cc56e940a9aff2)|`Trac 18152: fix documentation`|



---

archive/issue_comments_309678.json:
```json
{
    "body": "Changing commit from \"7d957347ccfeaba97438c92f6c04cbf79180f0fc\" to \"e34e9ca6da48db87eb7ec594e6cc56e940a9aff2\"",
    "created_at": "2015-04-10T04:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309678",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7d957347ccfeaba97438c92f6c04cbf79180f0fc" to "e34e9ca6da48db87eb7ec594e6cc56e940a9aff2"



---

archive/issue_comments_309679.json:
```json
{
    "body": "Changing commit from \"e34e9ca6da48db87eb7ec594e6cc56e940a9aff2\" to \"376bcc2dd953ebe96ed5594d99ce4155ccbd883c\"",
    "created_at": "2015-04-10T06:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309679",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e34e9ca6da48db87eb7ec594e6cc56e940a9aff2" to "376bcc2dd953ebe96ed5594d99ce4155ccbd883c"



---

archive/issue_comments_309680.json:
```json
{
    "body": "<a id='comment:7'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|\n|[376bcc2](https://github.com/sagemath/sagetrac-mirror/commit/376bcc2dd953ebe96ed5594d99ce4155ccbd883c)|`Trac 18152: fix constructor in rings.number_field.number_field`|",
    "created_at": "2015-04-10T06:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309680",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|
|[376bcc2](https://github.com/sagemath/sagetrac-mirror/commit/376bcc2dd953ebe96ed5594d99ce4155ccbd883c)|`Trac 18152: fix constructor in rings.number_field.number_field`|



---

archive/issue_comments_309681.json:
```json
{
    "body": "<a id='comment:8'></a>\nNow all test pass!",
    "created_at": "2015-04-10T07:14:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309681",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>
Now all test pass!



---

archive/issue_comments_309682.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|\n|[e968468](https://github.com/sagemath/sagetrac-mirror/commit/e96846846f65b0a914d276f34725f97bfd974f4a)|`Trac 18152: better cmp + 32 vs 64 bits in doctest`|",
    "created_at": "2015-04-10T11:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309682",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------|
|[e968468](https://github.com/sagemath/sagetrac-mirror/commit/e96846846f65b0a914d276f34725f97bfd974f4a)|`Trac 18152: better cmp + 32 vs 64 bits in doctest`|



---

archive/issue_comments_309683.json:
```json
{
    "body": "Changing commit from \"376bcc2dd953ebe96ed5594d99ce4155ccbd883c\" to \"e96846846f65b0a914d276f34725f97bfd974f4a\"",
    "created_at": "2015-04-10T11:26:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309683",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "376bcc2dd953ebe96ed5594d99ce4155ccbd883c" to "e96846846f65b0a914d276f34725f97bfd974f4a"



---

archive/issue_comments_309684.json:
```json
{
    "body": "A test file to compare timings",
    "created_at": "2015-04-10T15:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309684",
    "user": "https://github.com/videlec"
}
```

A test file to compare timings



---

archive/issue_comments_309685.json:
```json
{
    "body": "<a id='comment:10'></a>\nAttachment [ucf_test.py](tarball://root/attachments/some-uuid/ticket18152/ucf_test.py) by @videlec created at 2015-04-10 15:12:20\n\nI did some concrete timings and the conclusion is that in all cases the new implementation is faster by a factor of at least x8 (and it can be up to x20).",
    "created_at": "2015-04-10T15:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309685",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>
Attachment [ucf_test.py](tarball://root/attachments/some-uuid/ticket18152/ucf_test.py) by @videlec created at 2015-04-10 15:12:20

I did some concrete timings and the conclusion is that in all cases the new implementation is faster by a factor of at least x8 (and it can be up to x20).



---

archive/issue_comments_309686.json:
```json
{
    "body": "<a id='comment:11'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[9dd7433](https://github.com/sagemath/sagetrac-mirror/commit/9dd74336bd11d44758340905055c37d04749051b)|`Trac 12158: add a _sub_ method`|",
    "created_at": "2015-04-10T15:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309686",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:11'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[9dd7433](https://github.com/sagemath/sagetrac-mirror/commit/9dd74336bd11d44758340905055c37d04749051b)|`Trac 12158: add a _sub_ method`|



---

archive/issue_comments_309687.json:
```json
{
    "body": "Changing commit from \"e96846846f65b0a914d276f34725f97bfd974f4a\" to \"9dd74336bd11d44758340905055c37d04749051b\"",
    "created_at": "2015-04-10T15:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309687",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e96846846f65b0a914d276f34725f97bfd974f4a" to "9dd74336bd11d44758340905055c37d04749051b"



---

archive/issue_comments_309688.json:
```json
{
    "body": "Changing commit from \"9dd74336bd11d44758340905055c37d04749051b\" to \"e58f75501bdd8dfd4b20bc751a6040e5b10f0844\"",
    "created_at": "2015-04-10T15:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309688",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9dd74336bd11d44758340905055c37d04749051b" to "e58f75501bdd8dfd4b20bc751a6040e5b10f0844"



---

archive/issue_comments_309689.json:
```json
{
    "body": "<a id='comment:12'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|\n|[e58f755](https://github.com/sagemath/sagetrac-mirror/commit/e58f75501bdd8dfd4b20bc751a6040e5b10f0844)|`Trac 18152: add a _sub_ method`|",
    "created_at": "2015-04-10T15:21:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309689",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------|
|[e58f755](https://github.com/sagemath/sagetrac-mirror/commit/e58f75501bdd8dfd4b20bc751a6040e5b10f0844)|`Trac 18152: add a _sub_ method`|



---

archive/issue_comments_309690.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[e4a3524](https://github.com/sagemath/sagetrac-mirror/commit/e4a352468cf9c018b9bdf148a3de03793a111b9e)|`Trac 18152: speedup (use X._add_(Y) instead of X+Y)`|",
    "created_at": "2015-04-10T18:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309690",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[e4a3524](https://github.com/sagemath/sagetrac-mirror/commit/e4a352468cf9c018b9bdf148a3de03793a111b9e)|`Trac 18152: speedup (use X._add_(Y) instead of X+Y)`|



---

archive/issue_comments_309691.json:
```json
{
    "body": "Changing commit from \"e58f75501bdd8dfd4b20bc751a6040e5b10f0844\" to \"e4a352468cf9c018b9bdf148a3de03793a111b9e\"",
    "created_at": "2015-04-10T18:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309691",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e58f75501bdd8dfd4b20bc751a6040e5b10f0844" to "e4a352468cf9c018b9bdf148a3de03793a111b9e"



---

archive/issue_comments_309692.json:
```json
{
    "body": "<a id='comment:14'></a>\nHi!\n\nDid you have a look at #16116? Does it improve also the multiplication of generic cyclotomic matrices?\n\nJean-Philippe",
    "created_at": "2015-04-11T06:13:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309692",
    "user": "https://github.com/jplab"
}
```

<a id='comment:14'></a>
Hi!

Did you have a look at #16116? Does it improve also the multiplication of generic cyclotomic matrices?

Jean-Philippe



---

archive/issue_comments_309693.json:
```json
{
    "body": "<a id='comment:15'></a>\nHello Jean-Philippe,\n\nReplying to [jipilab](#comment%3A14):\n> Did you have a look at #16116? Does it improve also the multiplication of generic cyclotomic matrices?\n\n\nI guess so. Should be ten times faster. But I copied-pasted the GAP documentation in the top of the file:\n\n```\nArithmetical operations are quite expensive, so the use of\ninternally represented cyclotomics is not recommended for doing\narithmetic over number fields, such as calculations with matrices\nof cyclotomics.\n```\n\nBest,\nVincent",
    "created_at": "2015-04-11T08:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309693",
    "user": "https://github.com/videlec"
}
```

<a id='comment:15'></a>
Hello Jean-Philippe,

Replying to [jipilab](#comment%3A14):
> Did you have a look at #16116? Does it improve also the multiplication of generic cyclotomic matrices?


I guess so. Should be ten times faster. But I copied-pasted the GAP documentation in the top of the file:

```
Arithmetical operations are quite expensive, so the use of
internally represented cyclotomics is not recommended for doing
arithmetic over number fields, such as calculations with matrices
of cyclotomics.
```

Best,
Vincent



---

archive/issue_comments_309694.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,6 +6,8 @@\n - #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse\n - #17117: UniversalCyclotomicField elements considered real\n \n+And is about 10x faster (see [comment:10](#comment%3A10)).\n+\n Possible follow up:\n - switch to Cython\n-- implement dense matrices by wrapping libgap matrices\n+- implement dense matrices by wrapping libgap matrices (see also #16116)\n``````\n",
    "created_at": "2015-04-11T17:46:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309694",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,6 +6,8 @@
 - #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse
 - #17117: UniversalCyclotomicField elements considered real
 
+And is about 10x faster (see [comment:10](#comment%3A10)).
+
 Possible follow up:
 - switch to Cython
-- implement dense matrices by wrapping libgap matrices
+- implement dense matrices by wrapping libgap matrices (see also #16116)
``````




---

archive/issue_events_066207.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/stumpc5",
    "created_at": "2015-04-15T10:37:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18152#event-66207"
}
```



---

archive/issue_comments_309695.json:
```json
{
    "body": "<a id='comment:18'></a>\nHi there!\n\nI kind of feel bad that you plan to remove that much code I wrote in weeks of work -- but I guess that's the way it goes if there is something better...\n\nAnyway my first question would be whether it is really desired to remove an algorithm from Sage and instead use the same algorithm from Gap? Don't you think that working on the cython part of my implementation (maybe even moving to plain C of some core functionality) could get it beyond the speed of the black box (from a Sage point of view) Gap implementation?\n\nSecondly, I remember that I did quite some tests back when I implemented the UCF. And that in the end, the Sage implementation was slower on some parts, while faster on others (one I remember where Sage was quicker was the computation of the Galois conjugates of big elements, in case you want to test, one example might be `E( 2^11 * 3^4 )`). I would really like to redo these tests, but haven't yet been able to get your branch running on my computer. I will get back once that worked out.\n\nI also remember to have found a few bugs in the Gap implementation while implementing UCFs in Sage. That would also not be possible anymore when only relying on the implementation in Gap.\n\n\n\nCheers, Christian",
    "created_at": "2015-04-15T11:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309695",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:18'></a>
Hi there!

I kind of feel bad that you plan to remove that much code I wrote in weeks of work -- but I guess that's the way it goes if there is something better...

Anyway my first question would be whether it is really desired to remove an algorithm from Sage and instead use the same algorithm from Gap? Don't you think that working on the cython part of my implementation (maybe even moving to plain C of some core functionality) could get it beyond the speed of the black box (from a Sage point of view) Gap implementation?

Secondly, I remember that I did quite some tests back when I implemented the UCF. And that in the end, the Sage implementation was slower on some parts, while faster on others (one I remember where Sage was quicker was the computation of the Galois conjugates of big elements, in case you want to test, one example might be `E( 2^11 * 3^4 )`). I would really like to redo these tests, but haven't yet been able to get your branch running on my computer. I will get back once that worked out.

I also remember to have found a few bugs in the Gap implementation while implementing UCFs in Sage. That would also not be possible anymore when only relying on the implementation in Gap.



Cheers, Christian



---

archive/issue_comments_309696.json:
```json
{
    "body": "<a id='comment:19'></a>\nHello Christian,\n\nThanks for having a look!\n\nReplying to [stumpc5](#comment%3A18):\n> I kind of feel bad that you plan to remove that much code I wrote in weeks of work -- but I guess that's the way it goes if there is something better...\n\n\nMe too. I wondered if something were better with your code. But except the documentation I did not find any case were it was faster.\n\n> Anyway my first question would be whether it is really desired to remove an algorithm from Sage and instead use the same algorithm from Gap?\n\n\nSage should not reinvent the wheel. Gap is now interfaced as a fairly good level and we should try to maximize its usage at what it is good for.\n\nThat being said, it would makes sense to keep your implementation somewhere with more comparisons to the libgap implementation. Especially if you found that the Gap implementation has some bug! But I did not find any relevant example since all tests pass with my branch applied.\n\n> Don't you think that working on the cython part of my implementation (maybe even moving to plain C of some core functionality) could get it beyond the speed of the black box (from a Sage point of view) Gap implementation?\n\n\nNo idea. And I will not try. It is much more work than proposing what I did. And if you ask me what I would do if I want even more speed, I would link to Gap at an even lower level.\n\n> Secondly, I remember that I did quite some tests back when I implemented the UCF. And that in the end, the Sage implementation was slower on some parts, while faster on others (one I remember were Sage was quicker was the computation of the Galois conjugates of big elements, in case you want to test, one example might be `E( 2^11 * 3^4 )`). I would really like to redo these tests, but haven't yet been able to get your branch running on my computer. I will get back once that worked out.\n\n\nGreat! I will add this to the `ucf_test.py` that I wrote. If you have other examples in mind, please propose. I am not sure it will make a difference now since big numbers with pexpect implies a lot of parsing and computation. With libgap it is not the case anymore.\n\n> I also remember to have found a few bugs in the Gap implementation while implementing UCFs in Sage. That would also not be possible anymore when only relying on the implementation in Gap.\n\n\nYou do not remember what they are? Did you report them to Gap? \n\nCheers\nVincent",
    "created_at": "2015-04-15T11:36:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309696",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>
Hello Christian,

Thanks for having a look!

Replying to [stumpc5](#comment%3A18):
> I kind of feel bad that you plan to remove that much code I wrote in weeks of work -- but I guess that's the way it goes if there is something better...


Me too. I wondered if something were better with your code. But except the documentation I did not find any case were it was faster.

> Anyway my first question would be whether it is really desired to remove an algorithm from Sage and instead use the same algorithm from Gap?


Sage should not reinvent the wheel. Gap is now interfaced as a fairly good level and we should try to maximize its usage at what it is good for.

That being said, it would makes sense to keep your implementation somewhere with more comparisons to the libgap implementation. Especially if you found that the Gap implementation has some bug! But I did not find any relevant example since all tests pass with my branch applied.

> Don't you think that working on the cython part of my implementation (maybe even moving to plain C of some core functionality) could get it beyond the speed of the black box (from a Sage point of view) Gap implementation?


No idea. And I will not try. It is much more work than proposing what I did. And if you ask me what I would do if I want even more speed, I would link to Gap at an even lower level.

> Secondly, I remember that I did quite some tests back when I implemented the UCF. And that in the end, the Sage implementation was slower on some parts, while faster on others (one I remember were Sage was quicker was the computation of the Galois conjugates of big elements, in case you want to test, one example might be `E( 2^11 * 3^4 )`). I would really like to redo these tests, but haven't yet been able to get your branch running on my computer. I will get back once that worked out.


Great! I will add this to the `ucf_test.py` that I wrote. If you have other examples in mind, please propose. I am not sure it will make a difference now since big numbers with pexpect implies a lot of parsing and computation. With libgap it is not the case anymore.

> I also remember to have found a few bugs in the Gap implementation while implementing UCFs in Sage. That would also not be possible anymore when only relying on the implementation in Gap.


You do not remember what they are? Did you report them to Gap? 

Cheers
Vincent



---

archive/issue_comments_309697.json:
```json
{
    "body": "<a id='comment:20'></a>\nHi Vincent,\n\nReplying to [vdelecroix](#comment%3A19):\n> Me too. I wondered if something were better with your code. But except the documentation I did not find any case were it was faster.\n\n\nDid you already redo the Galois conjugate test which I remember was slower in Gap back then?\n\n> Great! I will add this to the `ucf_test.py` that I wrote. If you have other examples in mind, please propose. I am not sure it will make a difference now since big numbers with pexpect implies a lot of parsing and computation. With libgap it is not the case anymore.\n\n\nI just did\n\n```\nsage: a = E( 2^11 * 3^4 )\nsage: %time x = a.galois_conjugates()\nCPU times: user 5.52 s, sys: 159 ms, total: 5.68 s\nWall time: 5.66 s\nsage: %time x = a.galois_conjugates()\nCPU times: user 6.81 s, sys: 170 ms, total: 6.98 s\nWall time: 6.99 s\n```\n\nand compared it to\n\n```\ngap> a := E( 2^11 * 3^4 );;\ngap> L := PrimeResidues(165888);;\ngap> for i in L do\n> x := GaloisCyc(a,i);\n> od;\n```\nwhich I had running for 30 sec before I ctrc-c'ed it. (I also believe that in Sage, a big portion of the time is spend of computing the list of coprimes.)\n\n> You do not remember what they are? Did you report them to Gap?\n\n\nI did report them, and they were fixed.\n\nOnce I get your branch running, I try to get back other tests I did.\n\nCheers, Christian",
    "created_at": "2015-04-15T11:51:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309697",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:20'></a>
Hi Vincent,

Replying to [vdelecroix](#comment%3A19):
> Me too. I wondered if something were better with your code. But except the documentation I did not find any case were it was faster.


Did you already redo the Galois conjugate test which I remember was slower in Gap back then?

> Great! I will add this to the `ucf_test.py` that I wrote. If you have other examples in mind, please propose. I am not sure it will make a difference now since big numbers with pexpect implies a lot of parsing and computation. With libgap it is not the case anymore.


I just did

```
sage: a = E( 2^11 * 3^4 )
sage: %time x = a.galois_conjugates()
CPU times: user 5.52 s, sys: 159 ms, total: 5.68 s
Wall time: 5.66 s
sage: %time x = a.galois_conjugates()
CPU times: user 6.81 s, sys: 170 ms, total: 6.98 s
Wall time: 6.99 s
```

and compared it to

```
gap> a := E( 2^11 * 3^4 );;
gap> L := PrimeResidues(165888);;
gap> for i in L do
> x := GaloisCyc(a,i);
> od;
```
which I had running for 30 sec before I ctrc-c'ed it. (I also believe that in Sage, a big portion of the time is spend of computing the list of coprimes.)

> You do not remember what they are? Did you report them to Gap?


I did report them, and they were fixed.

Once I get your branch running, I try to get back other tests I did.

Cheers, Christian



---

archive/issue_comments_309698.json:
```json
{
    "body": "<a id='comment:21'></a>\nHi there!\n\nI will also do some tests on the ticket and let you know.\n\nOne thing not to forget is also the number of tickets repaired by this new implementation. If the ticket repairs them and is faster... It's difficult to say no to that.\n\nGr\u00fcsse,\nJP",
    "created_at": "2015-04-15T12:55:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309698",
    "user": "https://github.com/jplab"
}
```

<a id='comment:21'></a>
Hi there!

I will also do some tests on the ticket and let you know.

One thing not to forget is also the number of tickets repaired by this new implementation. If the ticket repairs them and is faster... It's difficult to say no to that.

Grüsse,
JP



---

archive/issue_comments_309699.json:
```json
{
    "body": "<a id='comment:22'></a>\nHello,\n\nI pushed an experimental branch with both implementations at `public/18152`. It is certain that most doctest fail but it is not the purpose. With it you can do\n\n```\nsage: UCF_native.<E_native> = UniversalCyclotomicField_native()\nsage: UCF_libgap.<E_libgap> = UniversalCyclotomicField_libgap()\nsage: UCF_native\nUniversal Cyclotomic Field (native)\nsage: UCF_libgap\nUniversal Cyclotomic Field (libgap)\n```\nand play around with both implementations.\n\n\nReplying to [comment:20]: it is true that `GaloisCyc` is slow in GAP (and it is not `PrimeResidues` which takes time). I got with a little bit smaller example\n\n```\nsage: a = E_libgap( 2^9 * 3^4 )\nsage: b = E_native( 2^9 * 3^4 )\nsage: %time l = a.galois_conjugates()\nCPU times: user 6.92 s, sys: 4 ms, total: 6.92 s\nWall time: 6.9 s\nsage: %time l = b.galois_conjugates()\nCPU times: user 352 ms, sys: 52 ms, total: 404 ms\nWall time: 387 ms\n```\n\nReplying to [comment:21]: I do not think that the issues in the four tickets mentioned in the description are that big (and one of them has a fix).\n\nVincent",
    "created_at": "2015-04-15T15:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309699",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>
Hello,

I pushed an experimental branch with both implementations at `public/18152`. It is certain that most doctest fail but it is not the purpose. With it you can do

```
sage: UCF_native.<E_native> = UniversalCyclotomicField_native()
sage: UCF_libgap.<E_libgap> = UniversalCyclotomicField_libgap()
sage: UCF_native
Universal Cyclotomic Field (native)
sage: UCF_libgap
Universal Cyclotomic Field (libgap)
```
and play around with both implementations.


Replying to [comment:20]: it is true that `GaloisCyc` is slow in GAP (and it is not `PrimeResidues` which takes time). I got with a little bit smaller example

```
sage: a = E_libgap( 2^9 * 3^4 )
sage: b = E_native( 2^9 * 3^4 )
sage: %time l = a.galois_conjugates()
CPU times: user 6.92 s, sys: 4 ms, total: 6.92 s
Wall time: 6.9 s
sage: %time l = b.galois_conjugates()
CPU times: user 352 ms, sys: 52 ms, total: 404 ms
Wall time: 387 ms
```

Replying to [comment:21]: I do not think that the issues in the four tickets mentioned in the description are that big (and one of them has a fix).

Vincent



---

archive/issue_comments_309700.json:
```json
{
    "body": "<a id='comment:23'></a>\nthe branch runs now...\n\nOne issue I see is that it would if my code would not break because a few methods disappeared (such as `field_order` and `min_poly`. But this problem is minor and easy to fix -- worst case is I update my code.\n\nRedoing the following tests `Sage` vs. `libgap`:\n1.\n\n```\nsage: a = E(5)\nsage: %timeit a.conjugate()\n10000 loops, best of 3: 62.4 \u00b5s per loop\n```\nvs.\n\n```\nsage: a = E(5)\nsage: %timeit a.conjugate()\n10000 loops, best of 3: 39.9 \u00b5s per loop\n```\n2.\n\n```\nsage: a = E( 2^10 )\nsage: %timeit a.conjugate()\n10000 loops, best of 3: 69.1 \u00b5s per loop\n```\nvs.\n\n```\nsage: sage: a = E( 2^10 )\nsage: sage: %timeit a.conjugate()\n10000 loops, best of 3: 75.1 \u00b5s per loop\n```\n3.\n\n```\nsage: a = E( 2^11 * 3^4 )\nsage: %timeit a.conjugate()\n10000 loops, best of 3: 118 \u00b5s per loop\n```\nvs.\n\n```\nsage: a = E( 2^11 * 3^4 )\nsage: sage: %timeit a.conjugate()\n100 loops, best of 3: 9.15 ms per loop\n```\nFor the Galois conjugation, the `libgap` implementation doesn't finish in very finite time, see also your example above.",
    "created_at": "2015-04-15T15:42:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309700",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:23'></a>
the branch runs now...

One issue I see is that it would if my code would not break because a few methods disappeared (such as `field_order` and `min_poly`. But this problem is minor and easy to fix -- worst case is I update my code.

Redoing the following tests `Sage` vs. `libgap`:
1.

```
sage: a = E(5)
sage: %timeit a.conjugate()
10000 loops, best of 3: 62.4 µs per loop
```
vs.

```
sage: a = E(5)
sage: %timeit a.conjugate()
10000 loops, best of 3: 39.9 µs per loop
```
2.

```
sage: a = E( 2^10 )
sage: %timeit a.conjugate()
10000 loops, best of 3: 69.1 µs per loop
```
vs.

```
sage: sage: a = E( 2^10 )
sage: sage: %timeit a.conjugate()
10000 loops, best of 3: 75.1 µs per loop
```
3.

```
sage: a = E( 2^11 * 3^4 )
sage: %timeit a.conjugate()
10000 loops, best of 3: 118 µs per loop
```
vs.

```
sage: a = E( 2^11 * 3^4 )
sage: sage: %timeit a.conjugate()
100 loops, best of 3: 9.15 ms per loop
```
For the Galois conjugation, the `libgap` implementation doesn't finish in very finite time, see also your example above.



---

archive/issue_comments_309701.json:
```json
{
    "body": "<a id='comment:24'></a>\n`conjugate` actually uses `GaloisCyc` as in http://www.math.rwth-aachen.de/~Greg.Gamble/gap4r3/doc/htm/ref/CHAP058.htm#SSEC002.4.",
    "created_at": "2015-04-15T15:46:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309701",
    "user": "https://trac.sagemath.org/admin/accounts/users/stumpc5"
}
```

<a id='comment:24'></a>
`conjugate` actually uses `GaloisCyc` as in http://www.math.rwth-aachen.de/~Greg.Gamble/gap4r3/doc/htm/ref/CHAP058.htm#SSEC002.4.



---

archive/issue_comments_309702.json:
```json
{
    "body": "<a id='comment:25'></a>\nI opened #18207 for this slowness.",
    "created_at": "2015-04-15T15:57:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309702",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>
I opened #18207 for this slowness.



---

archive/issue_comments_309703.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [vdelecroix](#comment%3A25):\n> I opened #18207 for this slowness.\n\n\n(most time seems to be spent in the function `ConvertToBase` in `cyclotom.c`)",
    "created_at": "2015-04-15T15:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309703",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>
Replying to [vdelecroix](#comment%3A25):
> I opened #18207 for this slowness.


(most time seems to be spent in the function `ConvertToBase` in `cyclotom.c`)



---

archive/issue_comments_309704.json:
```json
{
    "body": "<a id='comment:27'></a>\nOn the other hand your code becomes slower when the element is more complicated\n\n```\nsage: a = sum(E_libgap( 2^8 * 3^4, i) for i in range(0, 2**12, 37))\nsage: b = sum(E_native( 2^8 * 3^4, i) for i in range(0, 2**12, 37))\nsage: %timeit _ = a.conjugate()\n1000 loops, best of 3: 262 \u00b5s per loop\nsage: %timeit _ = b.conjugate()\n1000 loops, best of 3: 793 \u00b5s per loop\n```\nSo I would not say that `conjugate` is slower.",
    "created_at": "2015-04-15T16:05:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309704",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>
On the other hand your code becomes slower when the element is more complicated

```
sage: a = sum(E_libgap( 2^8 * 3^4, i) for i in range(0, 2**12, 37))
sage: b = sum(E_native( 2^8 * 3^4, i) for i in range(0, 2**12, 37))
sage: %timeit _ = a.conjugate()
1000 loops, best of 3: 262 µs per loop
sage: %timeit _ = b.conjugate()
1000 loops, best of 3: 793 µs per loop
```
So I would not say that `conjugate` is slower.



---

archive/issue_comments_309705.json:
```json
{
    "body": "<a id='comment:28'></a>\nOk. The whole thing about conjugation just reflects the fact that Gap is using a dense representation where yours is sparse. In `a.conjugate()` Gap just run through **all** coefficients, looking for the nonzero ones. For cyclotomic elements with large conductor **and** few nonzero coefficients, it makes a big difference.\n\nIs there a use case for sparse cyclotomic elements with large conductor?",
    "created_at": "2015-04-15T16:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309705",
    "user": "https://github.com/videlec"
}
```

<a id='comment:28'></a>
Ok. The whole thing about conjugation just reflects the fact that Gap is using a dense representation where yours is sparse. In `a.conjugate()` Gap just run through **all** coefficients, looking for the nonzero ones. For cyclotomic elements with large conductor **and** few nonzero coefficients, it makes a big difference.

Is there a use case for sparse cyclotomic elements with large conductor?



---

archive/issue_comments_309706.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/18152\" to \"u/jipilab/18152\"",
    "created_at": "2015-04-21T11:54:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309706",
    "user": "https://github.com/jplab"
}
```

Changing branch from "u/vdelecroix/18152" to "u/jipilab/18152"



---

archive/issue_comments_309707.json:
```json
{
    "body": "<a id='comment:30'></a>\nHi,\n\nSo, all test pass on my 6.6.rc3. I went through the files and removed some trailing spaces and blank lines.\n\nReplying to [28](#comment%3A28): I do not have a use case for sparse cyclotomic out of my head. It is also difficult to guess for the use I have in mind (mainly representation of Coxeter groups). Nonetheless, the matrices will not have large conductor. Thus I would say it is not too bad as it is for the purpose of Coxeter groups.\n\nGoing through the discussion, the current state of affairs is:\n\nThe following tickets are fixed:\n#14240, #16130, #16631, #17117\n\nThe following tickets are follow-ups:\n#16116,#18207\n\nThe ticket looks good to me. It is well doctested with many examples. I would put positive review, nevertheless it would be good if someone else also go over the ticket too, Christian?\n\nBest,\nJP\n\n---\nNew commits:\n|                                                                                                                                          |                                        |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n|[591409b](https://github.com/sagemath/sagetrac-mirror/commit/591409b3d074fff8bff7dad14be97ce02851ca94)|`Merge branch 'develop' into cyclotomic`|\n|[29cb0a7](https://github.com/sagemath/sagetrac-mirror/commit/29cb0a7663d9303022ce9251534e53a66fac11ec)|`Corrected some blank lines and trailing spaces`|",
    "created_at": "2015-04-21T12:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309707",
    "user": "https://github.com/jplab"
}
```

<a id='comment:30'></a>
Hi,

So, all test pass on my 6.6.rc3. I went through the files and removed some trailing spaces and blank lines.

Replying to [28](#comment%3A28): I do not have a use case for sparse cyclotomic out of my head. It is also difficult to guess for the use I have in mind (mainly representation of Coxeter groups). Nonetheless, the matrices will not have large conductor. Thus I would say it is not too bad as it is for the purpose of Coxeter groups.

Going through the discussion, the current state of affairs is:

The following tickets are fixed:
#14240, #16130, #16631, #17117

The following tickets are follow-ups:
#16116,#18207

The ticket looks good to me. It is well doctested with many examples. I would put positive review, nevertheless it would be good if someone else also go over the ticket too, Christian?

Best,
JP

---
New commits:
|                                                                                                                                          |                                        |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
|[591409b](https://github.com/sagemath/sagetrac-mirror/commit/591409b3d074fff8bff7dad14be97ce02851ca94)|`Merge branch 'develop' into cyclotomic`|
|[29cb0a7](https://github.com/sagemath/sagetrac-mirror/commit/29cb0a7663d9303022ce9251534e53a66fac11ec)|`Corrected some blank lines and trailing spaces`|



---

archive/issue_comments_309708.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jean-Philippe Labb\u00e9\"",
    "created_at": "2015-04-21T12:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309708",
    "user": "https://github.com/jplab"
}
```

Changing reviewer from "" to "Jean-Philippe Labbé"



---

archive/issue_comments_309709.json:
```json
{
    "body": "Changing commit from \"e4a352468cf9c018b9bdf148a3de03793a111b9e\" to \"29cb0a7663d9303022ce9251534e53a66fac11ec\"",
    "created_at": "2015-04-21T12:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309709",
    "user": "https://github.com/jplab"
}
```

Changing commit from "e4a352468cf9c018b9bdf148a3de03793a111b9e" to "29cb0a7663d9303022ce9251534e53a66fac11ec"



---

archive/issue_comments_309710.json:
```json
{
    "body": "<a id='comment:31'></a>\nThere are merged conflicts on the last beta... Wait a minute, I am doing a rebase. I am doing a rebase.",
    "created_at": "2015-04-21T12:20:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309710",
    "user": "https://github.com/videlec"
}
```

<a id='comment:31'></a>
There are merged conflicts on the last beta... Wait a minute, I am doing a rebase. I am doing a rebase.



---

archive/issue_comments_309711.json:
```json
{
    "body": "<a id='comment:32'></a>\nOops, my bad... Should have done it with the 6.6 ...",
    "created_at": "2015-04-21T12:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309711",
    "user": "https://github.com/jplab"
}
```

<a id='comment:32'></a>
Oops, my bad... Should have done it with the 6.6 ...



---

archive/issue_comments_309712.json:
```json
{
    "body": "Changing commit from \"29cb0a7663d9303022ce9251534e53a66fac11ec\" to \"b8e369b03f2f444c6af07b77038610e43e625db8\"",
    "created_at": "2015-04-21T13:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309712",
    "user": "https://github.com/videlec"
}
```

Changing commit from "29cb0a7663d9303022ce9251534e53a66fac11ec" to "b8e369b03f2f444c6af07b77038610e43e625db8"



---

archive/issue_comments_309713.json:
```json
{
    "body": "Changing branch from \"u/jipilab/18152\" to \"u/vdelecroix/18152\"",
    "created_at": "2015-04-21T13:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309713",
    "user": "https://github.com/videlec"
}
```

Changing branch from "u/jipilab/18152" to "u/vdelecroix/18152"



---

archive/issue_comments_309714.json:
```json
{
    "body": "<a id='comment:33'></a>\nSalut Jean-Phillippe,\n\nThanks for your corrections! The branch is a fast forward. So you have to delete your previous branch. Your commit is preserved (it is now 08df5b4). I added three commits for better compatibility with the previous version:\n- adding a `minpoly` and `field_order` methods as it was requested in [comment:23](#comment%3A23) (see also #18266 for a potential improvement)\n- adding a `__neg__` (it is now faster to do `-E(3)`)\n\nVincent\n\n---\nNew commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[0c8af9b](https://github.com/sagemath/sagetrac-mirror/commit/0c8af9b33e2e51e5515325529ea4f419ecd8a894)|`Trac 18152: universal cyclotomic field using libgap`|\n|[509acf7](https://github.com/sagemath/sagetrac-mirror/commit/509acf7d0c129da220729e914b50d895316f300f)|`Trac 18152: remove the old implementation`|\n|[519dc00](https://github.com/sagemath/sagetrac-mirror/commit/519dc00a585ca5f9ac000557e6151c5eec990e12)|`Trac 18152: Fix coxeter group import`|\n|[08df5b4](https://github.com/sagemath/sagetrac-mirror/commit/08df5b48a236a18a3b37faf513e93d16df4145b9)|`Corrected some blank lines and trailing spaces`|\n|[890151f](https://github.com/sagemath/sagetrac-mirror/commit/890151f42c0073f067724c42378969aa9d589723)|`Trac 18152: add a minpoly method to UCF elements`|\n|[70f7895](https://github.com/sagemath/sagetrac-mirror/commit/70f78956a802b89c22dafebf02ca5016856baca5)|`Trac 18152: field_order as a deprecated alias of conductor`|\n|[b8e369b](https://github.com/sagemath/sagetrac-mirror/commit/b8e369b03f2f444c6af07b77038610e43e625db8)|`Trac 18152: __neg__ for UCF elements`|",
    "created_at": "2015-04-21T13:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309714",
    "user": "https://github.com/videlec"
}
```

<a id='comment:33'></a>
Salut Jean-Phillippe,

Thanks for your corrections! The branch is a fast forward. So you have to delete your previous branch. Your commit is preserved (it is now 08df5b4). I added three commits for better compatibility with the previous version:
- adding a `minpoly` and `field_order` methods as it was requested in [comment:23](#comment%3A23) (see also #18266 for a potential improvement)
- adding a `__neg__` (it is now faster to do `-E(3)`)

Vincent

---
New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[0c8af9b](https://github.com/sagemath/sagetrac-mirror/commit/0c8af9b33e2e51e5515325529ea4f419ecd8a894)|`Trac 18152: universal cyclotomic field using libgap`|
|[509acf7](https://github.com/sagemath/sagetrac-mirror/commit/509acf7d0c129da220729e914b50d895316f300f)|`Trac 18152: remove the old implementation`|
|[519dc00](https://github.com/sagemath/sagetrac-mirror/commit/519dc00a585ca5f9ac000557e6151c5eec990e12)|`Trac 18152: Fix coxeter group import`|
|[08df5b4](https://github.com/sagemath/sagetrac-mirror/commit/08df5b48a236a18a3b37faf513e93d16df4145b9)|`Corrected some blank lines and trailing spaces`|
|[890151f](https://github.com/sagemath/sagetrac-mirror/commit/890151f42c0073f067724c42378969aa9d589723)|`Trac 18152: add a minpoly method to UCF elements`|
|[70f7895](https://github.com/sagemath/sagetrac-mirror/commit/70f78956a802b89c22dafebf02ca5016856baca5)|`Trac 18152: field_order as a deprecated alias of conductor`|
|[b8e369b](https://github.com/sagemath/sagetrac-mirror/commit/b8e369b03f2f444c6af07b77038610e43e625db8)|`Trac 18152: __neg__ for UCF elements`|



---

archive/issue_comments_309715.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,8 +6,10 @@\n - #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse\n - #17117: UniversalCyclotomicField elements considered real\n \n-And is about 10x faster (see [comment:10](#comment%3A10)).\n+And is about 10x faster (see [comment:10](#comment%3A10)) except for operations on very sparse elements with very large conductors (see e.g. [comment:23](#comment%3A23), [comment:27](#comment%3A27) and [comment:28](#comment%3A28)). \n \n Possible follow up:\n - switch to Cython\n - implement dense matrices by wrapping libgap matrices (see also #16116)\n+- slowness in conjugation? #18207 (see also [comment:28](#comment%3A28), this is unavoidable because gap uses a dense representation of elements)\n+- interface with libgap polynomials (#18266)\n``````\n",
    "created_at": "2015-04-21T13:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309715",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,8 +6,10 @@
 - #16130: Matrices over Universal Cyclotomic field failing to echelonize/inverse
 - #17117: UniversalCyclotomicField elements considered real
 
-And is about 10x faster (see [comment:10](#comment%3A10)).
+And is about 10x faster (see [comment:10](#comment%3A10)) except for operations on very sparse elements with very large conductors (see e.g. [comment:23](#comment%3A23), [comment:27](#comment%3A27) and [comment:28](#comment%3A28)). 
 
 Possible follow up:
 - switch to Cython
 - implement dense matrices by wrapping libgap matrices (see also #16116)
+- slowness in conjugation? #18207 (see also [comment:28](#comment%3A28), this is unavoidable because gap uses a dense representation of elements)
+- interface with libgap polynomials (#18266)
``````




---

archive/issue_comments_309716.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [jipilab](#comment%3A30):\n> The following tickets are fixed:\n> #14240, #16130, #16631, #17117\n\n\nAnd actually, doctests are already there! So these should be closed as soon as this one gets positively reviewed.\n\nVincent",
    "created_at": "2015-04-21T13:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309716",
    "user": "https://github.com/videlec"
}
```

<a id='comment:35'></a>
Replying to [jipilab](#comment%3A30):
> The following tickets are fixed:
> #14240, #16130, #16631, #17117


And actually, doctests are already there! So these should be closed as soon as this one gets positively reviewed.

Vincent



---

archive/issue_comments_309717.json:
```json
{
    "body": "<a id='comment:36'></a>\nBut there is still the most important question: do we keep both versions (one being sparse the other being dense)?\n\nVincent",
    "created_at": "2015-04-21T13:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309717",
    "user": "https://github.com/videlec"
}
```

<a id='comment:36'></a>
But there is still the most important question: do we keep both versions (one being sparse the other being dense)?

Vincent



---

archive/issue_comments_309718.json:
```json
{
    "body": "Changing commit from \"b8e369b03f2f444c6af07b77038610e43e625db8\" to \"28c23ce280985112ea43f0bea36a76952a64ff8e\"",
    "created_at": "2015-04-21T15:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309718",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "b8e369b03f2f444c6af07b77038610e43e625db8" to "28c23ce280985112ea43f0bea36a76952a64ff8e"



---

archive/issue_comments_309719.json:
```json
{
    "body": "<a id='comment:37'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[ccfc26e](https://github.com/sagemath/sagetrac-mirror/commit/ccfc26e48275b8579b3acb06e7777c8551ccd14a)|`Trac 18152: universal cyclotomic field using libgap`|\n|[1b2d04a](https://github.com/sagemath/sagetrac-mirror/commit/1b2d04a5ef626e1f492bcfcb7505202f5ecdf54e)|`Trac 18152: remove the old implementation`|\n|[f3ef31a](https://github.com/sagemath/sagetrac-mirror/commit/f3ef31ac655912f01cc29ba4668301e1f4761251)|`Trac 18152: Fix coxeter group import`|\n|[bb42614](https://github.com/sagemath/sagetrac-mirror/commit/bb42614d09c6cb6c115084d8f968b121fe55e1d1)|`Corrected some blank lines and trailing spaces`|\n|[e3f714e](https://github.com/sagemath/sagetrac-mirror/commit/e3f714efbb90e9f664c7f19737c3f5a51a7abcd7)|`Trac 18152: add a minpoly method to UCF elements`|\n|[8149677](https://github.com/sagemath/sagetrac-mirror/commit/814967784ecc8de36d80615ec97ed4577f1a29e3)|`Trac 18152: field_order as a deprecated alias of conductor`|\n|[28c23ce](https://github.com/sagemath/sagetrac-mirror/commit/28c23ce280985112ea43f0bea36a76952a64ff8e)|`Trac 18152: __neg__ for UCF elements`|",
    "created_at": "2015-04-21T15:31:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309719",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[ccfc26e](https://github.com/sagemath/sagetrac-mirror/commit/ccfc26e48275b8579b3acb06e7777c8551ccd14a)|`Trac 18152: universal cyclotomic field using libgap`|
|[1b2d04a](https://github.com/sagemath/sagetrac-mirror/commit/1b2d04a5ef626e1f492bcfcb7505202f5ecdf54e)|`Trac 18152: remove the old implementation`|
|[f3ef31a](https://github.com/sagemath/sagetrac-mirror/commit/f3ef31ac655912f01cc29ba4668301e1f4761251)|`Trac 18152: Fix coxeter group import`|
|[bb42614](https://github.com/sagemath/sagetrac-mirror/commit/bb42614d09c6cb6c115084d8f968b121fe55e1d1)|`Corrected some blank lines and trailing spaces`|
|[e3f714e](https://github.com/sagemath/sagetrac-mirror/commit/e3f714efbb90e9f664c7f19737c3f5a51a7abcd7)|`Trac 18152: add a minpoly method to UCF elements`|
|[8149677](https://github.com/sagemath/sagetrac-mirror/commit/814967784ecc8de36d80615ec97ed4577f1a29e3)|`Trac 18152: field_order as a deprecated alias of conductor`|
|[28c23ce](https://github.com/sagemath/sagetrac-mirror/commit/28c23ce280985112ea43f0bea36a76952a64ff8e)|`Trac 18152: __neg__ for UCF elements`|



---

archive/issue_comments_309720.json:
```json
{
    "body": "<a id='comment:38'></a>\nAll right. Updated on the very last 6.7.beta2!",
    "created_at": "2015-04-21T15:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309720",
    "user": "https://github.com/videlec"
}
```

<a id='comment:38'></a>
All right. Updated on the very last 6.7.beta2!



---

archive/issue_comments_309721.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [vdelecroix](#comment%3A36):\n> But there is still the most important question: do we keep both versions (one being sparse the other being dense)?\n\n\nIMO, we should keep both with the default being the dense.",
    "created_at": "2015-04-21T16:01:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309721",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:39'></a>
Replying to [vdelecroix](#comment%3A36):
> But there is still the most important question: do we keep both versions (one being sparse the other being dense)?


IMO, we should keep both with the default being the dense.



---

archive/issue_comments_309722.json:
```json
{
    "body": "<a id='comment:40'></a>\nReplying to [tscrim](#comment%3A39):\n> Replying to [vdelecroix](#comment%3A36):\n> > But there is still the most important question: do we keep both versions (one being sparse the other being dense)?\n\n> \n> IMO, we should keep both with the default being the dense.\n\n\nI was implictely requiring arguments. We will not keep it just because you think it has to ;-) I do have arguments for both sides, but as I am the ticket author I better not participate.",
    "created_at": "2015-04-21T16:05:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309722",
    "user": "https://github.com/videlec"
}
```

<a id='comment:40'></a>
Replying to [tscrim](#comment%3A39):
> Replying to [vdelecroix](#comment%3A36):
> > But there is still the most important question: do we keep both versions (one being sparse the other being dense)?

> 
> IMO, we should keep both with the default being the dense.


I was implictely requiring arguments. We will not keep it just because you think it has to ;-) I do have arguments for both sides, but as I am the ticket author I better not participate.



---

archive/issue_comments_309723.json:
```json
{
    "body": "<a id='comment:41'></a>\nThe main argument I could see for keeping the code around is as follow: The speed balance may evolve in the future, typically if free modules in Sage get optimized, or if new use cases emerge. Of course we could always revive the code then, but it would probably have rotten in the mean time, and we may have completely forgotten about it. It also can be used for testing purposes for comparing two independent implementations of UCF. \n\nThose are not super strong arguments.\n\nThe main argument for not keeping it is that we would not want is wasting time maintaining it. \n\nA sensible approach might be to write a brief comment at the beginning of the file / class stating something like: \"at this point this code is not used much (see ...). If maintaining it becomes a bother in the future, it's ok to discard it\".",
    "created_at": "2015-04-22T09:18:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309723",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:41'></a>
The main argument I could see for keeping the code around is as follow: The speed balance may evolve in the future, typically if free modules in Sage get optimized, or if new use cases emerge. Of course we could always revive the code then, but it would probably have rotten in the mean time, and we may have completely forgotten about it. It also can be used for testing purposes for comparing two independent implementations of UCF. 

Those are not super strong arguments.

The main argument for not keeping it is that we would not want is wasting time maintaining it. 

A sensible approach might be to write a brief comment at the beginning of the file / class stating something like: "at this point this code is not used much (see ...). If maintaining it becomes a bother in the future, it's ok to discard it".



---

archive/issue_comments_309724.json:
```json
{
    "body": "<a id='comment:42'></a>\nPerhaps one could add a comment/warning in the beginning of the file also to mention that GAP uses a dense representation and a link to the current ticket.\n\nIf there is a use case popping up in the future we could revive the code as Nicolas mentioned.\n\n`@`Christian: In your actual usage (not tests), is sparse faster than the current dense representation of GAP?\n\nAlso: I just updated to 6.7.beta3 on my computer and pulled the ticket. There was a small conflict in the file\n\nsrc/doc/en/reference/rings_standard/index.rst\n\nShould I push the resolution of the conflict here?",
    "created_at": "2015-04-29T09:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309724",
    "user": "https://github.com/jplab"
}
```

<a id='comment:42'></a>
Perhaps one could add a comment/warning in the beginning of the file also to mention that GAP uses a dense representation and a link to the current ticket.

If there is a use case popping up in the future we could revive the code as Nicolas mentioned.

`@`Christian: In your actual usage (not tests), is sparse faster than the current dense representation of GAP?

Also: I just updated to 6.7.beta3 on my computer and pulled the ticket. There was a small conflict in the file

src/doc/en/reference/rings_standard/index.rst

Should I push the resolution of the conflict here?



---

archive/issue_comments_309725.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [jipilab](#comment%3A42):\n> Also: I just updated to 6.7.beta3 on my computer and pulled the ticket. There was a small conflict in the file\n> \n> src/doc/en/reference/rings_standard/index.rst\n> \n> Should I push the resolution of the conflict here?\n\n\nYes please.",
    "created_at": "2015-04-29T09:29:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309725",
    "user": "https://github.com/videlec"
}
```

<a id='comment:43'></a>
Replying to [jipilab](#comment%3A42):
> Also: I just updated to 6.7.beta3 on my computer and pulled the ticket. There was a small conflict in the file
> 
> src/doc/en/reference/rings_standard/index.rst
> 
> Should I push the resolution of the conflict here?


Yes please.



---

archive/issue_comments_309726.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/18152\" to \"u/jipilab/18152\"",
    "created_at": "2015-04-29T16:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309726",
    "user": "https://github.com/jplab"
}
```

Changing branch from "u/vdelecroix/18152" to "u/jipilab/18152"



---

archive/issue_comments_309727.json:
```json
{
    "body": "Changing commit from \"28c23ce280985112ea43f0bea36a76952a64ff8e\" to \"dc3de84809792bde5e2cde8c8c579f42496e0647\"",
    "created_at": "2015-04-29T16:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309727",
    "user": "https://github.com/jplab"
}
```

Changing commit from "28c23ce280985112ea43f0bea36a76952a64ff8e" to "dc3de84809792bde5e2cde8c8c579f42496e0647"



---

archive/issue_comments_309728.json:
```json
{
    "body": "<a id='comment:45'></a>\nEt voil\u00e0!\n\n---\nNew commits:\n|                                                                                                                                          |                                                                                 |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|\n|[dc3de84](https://github.com/sagemath/sagetrac-mirror/commit/dc3de84809792bde5e2cde8c8c579f42496e0647)|`Merge branch 'u/vdelecroix/18152' of trac.sagemath.org:sage into SageMath6.7.b3`|",
    "created_at": "2015-04-29T16:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309728",
    "user": "https://github.com/jplab"
}
```

<a id='comment:45'></a>
Et voilà!

---
New commits:
|                                                                                                                                          |                                                                                 |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------|
|[dc3de84](https://github.com/sagemath/sagetrac-mirror/commit/dc3de84809792bde5e2cde8c8c579f42496e0647)|`Merge branch 'u/vdelecroix/18152' of trac.sagemath.org:sage into SageMath6.7.b3`|



---

archive/issue_comments_309729.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-30T08:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309729",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_309730.json:
```json
{
    "body": "<a id='comment:46'></a>\nHi,\n\nAll test passed on 6.7.beta3!\n\nCould you add a comment/warning at the beginning of the file mentioning the old implementation and a link to the ticket?\n\nPerhaps it would be good to mention this in the documentation as well?",
    "created_at": "2015-04-30T08:00:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309730",
    "user": "https://github.com/jplab"
}
```

<a id='comment:46'></a>
Hi,

All test passed on 6.7.beta3!

Could you add a comment/warning at the beginning of the file mentioning the old implementation and a link to the ticket?

Perhaps it would be good to mention this in the documentation as well?



---

archive/issue_comments_309731.json:
```json
{
    "body": "Changing commit from \"dc3de84809792bde5e2cde8c8c579f42496e0647\" to \"b818c83bc329581c6af225dcf7b54d120e6e1e7c\"",
    "created_at": "2015-04-30T12:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309731",
    "user": "https://github.com/videlec"
}
```

Changing commit from "dc3de84809792bde5e2cde8c8c579f42496e0647" to "b818c83bc329581c6af225dcf7b54d120e6e1e7c"



---

archive/issue_comments_309732.json:
```json
{
    "body": "Changing branch from \"u/jipilab/18152\" to \"u/vdelecroix/18152\"",
    "created_at": "2015-04-30T12:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309732",
    "user": "https://github.com/videlec"
}
```

Changing branch from "u/jipilab/18152" to "u/vdelecroix/18152"



---

archive/issue_comments_309733.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-30T12:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309733",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_309734.json:
```json
{
    "body": "<a id='comment:47'></a>\nDone. I also simplified some imports.\n  \n---\nNew commits:\n|                                                                                                                                          |                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|\n|[ba5ed57](https://github.com/sagemath/sagetrac-mirror/commit/ba5ed57914e701a2ed055f03d10ec039017a1347)|`Trac 18152: add a note about the change of implementation`|\n|[b818c83](https://github.com/sagemath/sagetrac-mirror/commit/b818c83bc329581c6af225dcf7b54d120e6e1e7c)|`Trac 18152: remove and simplify some imports`|",
    "created_at": "2015-04-30T12:20:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309734",
    "user": "https://github.com/videlec"
}
```

<a id='comment:47'></a>
Done. I also simplified some imports.
  
---
New commits:
|                                                                                                                                          |                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|
|[ba5ed57](https://github.com/sagemath/sagetrac-mirror/commit/ba5ed57914e701a2ed055f03d10ec039017a1347)|`Trac 18152: add a note about the change of implementation`|
|[b818c83](https://github.com/sagemath/sagetrac-mirror/commit/b818c83bc329581c6af225dcf7b54d120e6e1e7c)|`Trac 18152: remove and simplify some imports`|



---

archive/issue_comments_309735.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-05-06T09:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309735",
    "user": "https://github.com/jplab"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_309736.json:
```json
{
    "body": "<a id='comment:48'></a>\nHi,\n\nThis looks good to go as I see it.\n\nI set it to positive review.",
    "created_at": "2015-05-06T09:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309736",
    "user": "https://github.com/jplab"
}
```

<a id='comment:48'></a>
Hi,

This looks good to go as I see it.

I set it to positive review.



---

archive/issue_comments_309737.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/18152\" to \"b818c83bc329581c6af225dcf7b54d120e6e1e7c\"",
    "created_at": "2015-05-06T23:57:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309737",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/18152" to "b818c83bc329581c6af225dcf7b54d120e6e1e7c"



---

archive/issue_events_066208.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-06T23:57:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18152#event-66208"
}
```



---

archive/issue_comments_309738.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-05-06T23:57:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18152",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18152#issuecomment-309738",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
