# Issue 18940: Simplify __getitem__ for polynomials and deprecate slicing

archive/issues_018703.json:
```json
{
    "assignees": [],
    "body": "For polynomials, we implement a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).\n\nThis fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.\n\nBranch: **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)**\n\nReviewer: **Ralf Stephan**\n\nAuthor: **Peter Bruin, Jeroen Demeyer**\n\nComponent: **algebra**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18940_\n\n",
    "closed_at": "2016-01-20T10:20:06Z",
    "created_at": "2015-07-22T20:28:09Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Simplify __getitem__ for polynomials and deprecate slicing",
    "type": "issue",
    "updated_at": "2017-06-12T10:00:56Z",
    "url": "https://github.com/sagemath/sage/issues/18940",
    "user": "https://github.com/pjbruin"
}
```
For polynomials, we implement a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).

This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.

Branch: **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)**

Reviewer: **Ralf Stephan**

Author: **Peter Bruin, Jeroen Demeyer**

Component: **algebra**

_Issue created by migration from https://trac.sagemath.org/ticket/18940_





---

archive/issue_events_268877.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-07-22T20:28:09Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268877"
}
```



---

archive/issue_events_268878.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-07-22T20:28:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "c: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268878"
}
```



---

archive/issue_events_268879.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-07-22T20:28:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268879"
}
```



---

archive/issue_events_268880.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-07-22T20:28:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268880"
}
```



---

archive/issue_comments_265963.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nFixing this for all polynomials is somewhat involved because every polynomial class defines its own `__getitem__()` method.  The following 14 methods are relevant (line numbers for SageMath 6.8.rc0):\n\n```\nlaurent_polynomial.pyx:321:    def __getitem__(self, i):\npadics/polynomial_padic_capped_relative_dense.py:381:    def __getitem__(self, n):\npolynomial_element_generic.py:300:    def __getitem__(self,n):\npolynomial_element.pyx:7608:    def __getitem__(self, n):\npolynomial_gf2x.pyx:64:    def __getitem__(self, i):\npolynomial_integer_dense_flint.pyx:415:    def __getitem__(self, n):\npolynomial_integer_dense_ntl.pyx:284:    def __getitem__(self, n):\npolynomial_modn_dense_ntl.pyx:180:    def __getitem__(self, n):\npolynomial_modn_dense_ntl.pyx:658:    def __getitem__(self, n):\npolynomial_modn_dense_ntl.pyx:1223:    def __getitem__(self, n):\npolynomial_rational_flint.pyx:379:    def __getitem__(self, n):\npolynomial_real_mpfr_dense.pyx:183:    def __getitem__(self, ix):\npolynomial_zmod_flint.pyx:231:    def __getitem__(self, i):\npolynomial_zz_pex.pyx:151:    def __getitem__(self,i):\n```",
    "created_at": "2015-07-22T21:49:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265963",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:1" align="right">comment:1</div>

Fixing this for all polynomials is somewhat involved because every polynomial class defines its own `__getitem__()` method.  The following 14 methods are relevant (line numbers for SageMath 6.8.rc0):

```
laurent_polynomial.pyx:321:    def __getitem__(self, i):
padics/polynomial_padic_capped_relative_dense.py:381:    def __getitem__(self, n):
polynomial_element_generic.py:300:    def __getitem__(self,n):
polynomial_element.pyx:7608:    def __getitem__(self, n):
polynomial_gf2x.pyx:64:    def __getitem__(self, i):
polynomial_integer_dense_flint.pyx:415:    def __getitem__(self, n):
polynomial_integer_dense_ntl.pyx:284:    def __getitem__(self, n):
polynomial_modn_dense_ntl.pyx:180:    def __getitem__(self, n):
polynomial_modn_dense_ntl.pyx:658:    def __getitem__(self, n):
polynomial_modn_dense_ntl.pyx:1223:    def __getitem__(self, n):
polynomial_rational_flint.pyx:379:    def __getitem__(self, n):
polynomial_real_mpfr_dense.pyx:183:    def __getitem__(self, ix):
polynomial_zmod_flint.pyx:231:    def __getitem__(self, i):
polynomial_zz_pex.pyx:151:    def __getitem__(self,i):
```



---

archive/issue_comments_265964.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nFor matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.",
    "created_at": "2015-07-23T08:03:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265964",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:2" align="right">comment:2</div>

For matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.



---

archive/issue_comments_265965.json:
```json
{
    "body": "Dependencies: **#19409**",
    "created_at": "2015-10-14T20:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265965",
    "user": "https://github.com/pjbruin"
}
```

Dependencies: **#19409**



---

archive/issue_comments_265966.json:
```json
{
    "body": "Author: **Peter Bruin**",
    "created_at": "2015-10-14T20:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265966",
    "user": "https://github.com/pjbruin"
}
```

Author: **Peter Bruin**



---

archive/issue_comments_265967.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nReplying to [@jdemeyer](#comment:2):\n> For matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.\n\nI implemented this suggestion, now testing.",
    "created_at": "2015-10-14T20:50:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265967",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:3" align="right">comment:3</div>

Replying to [@jdemeyer](#comment:2):
> For matrices and vectors, this is done using `get_unsafe()` which is the implementation of `a[i]` for one index `i`. Then the slicing is done by a generic `__getitem__` function.

I implemented this suggestion, now testing.



---

archive/issue_comments_265968.json:
```json
{
    "body": "Branch: **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)**",
    "created_at": "2015-10-14T21:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265968",
    "user": "https://github.com/pjbruin"
}
```

Branch: **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)**



---

archive/issue_comments_265969.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,6 @@\n sage: f[-2:4:2]\n x^3 + x^2 + x + 1  # should be x^2 + 1\n ```\n+We fix this for most classes by implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  It is conceivable that there is a small performance loss (I have not tested this), but it is unlikely that there is any speed-critical code that heavily depends on `__getitem__()` with a slice argument.  For the remaining affected classes (Python classes, sparse polynomials), we fix `__getitem__()` in a similar way.\n \n+This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.\n``````\n",
    "created_at": "2015-10-14T21:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265969",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,6 @@
 sage: f[-2:4:2]
 x^3 + x^2 + x + 1  # should be x^2 + 1
 ```
+We fix this for most classes by implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  It is conceivable that there is a small performance loss (I have not tested this), but it is unlikely that there is any speed-critical code that heavily depends on `__getitem__()` with a slice argument.  For the remaining affected classes (Python classes, sparse polynomials), we fix `__getitem__()` in a similar way.
 
+This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.
``````




---

archive/issue_comments_265970.json:
```json
{
    "body": "Commit: **[97f9582](https://github.com/sagemath/sagetrac-mirror/commit/97f95822da2ae740aa9a19bcc75f73c216879aeb)**",
    "created_at": "2015-10-14T21:19:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265970",
    "user": "https://github.com/pjbruin"
}
```

Commit: **[97f9582](https://github.com/sagemath/sagetrac-mirror/commit/97f95822da2ae740aa9a19bcc75f73c216879aeb)**



---

archive/issue_events_268881.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-10-14T21:20:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268881"
}
```



---

archive/issue_comments_265971.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI might review this once the dependency is merged.",
    "created_at": "2015-10-16T11:31:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265971",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

I might review this once the dependency is merged.



---

archive/issue_comments_265972.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nJust a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)? That might be used to avoid slice arithmetic like\n\n```diff\n+            start, stop, step = n.start, n.stop, n.step\n+            if step is None:\n+                step = 1\n+            if start is None:\n+                start = 0\n+            elif start < 0:\n+                start %= step\n+            if stop is None or stop > d:\n+                stop = d\n```",
    "created_at": "2015-10-16T11:41:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265972",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)? That might be used to avoid slice arithmetic like

```diff
+            start, stop, step = n.start, n.stop, n.step
+            if step is None:
+                step = 1
+            if start is None:
+                start = 0
+            elif start < 0:
+                start %= step
+            if stop is None or stop > d:
+                stop = d
```



---

archive/issue_comments_265973.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jdemeyer](#comment:7):\n> Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?\n\nI tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.",
    "created_at": "2015-10-16T12:01:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265973",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jdemeyer](#comment:7):
> Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?

I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.



---

archive/issue_comments_265974.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@pjbruin](#comment:8):\n> Replying to [@jdemeyer](#comment:7):\n> > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?\n\n> I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.\n\nI think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.",
    "created_at": "2015-10-26T13:54:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265974",
    "user": "https://github.com/bgrenet"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@pjbruin](#comment:8):
> Replying to [@jdemeyer](#comment:7):
> > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?

> I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.

I think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.



---

archive/issue_events_268882.json:
```json
{
    "actor": "https://github.com/bgrenet",
    "created_at": "2015-10-26T13:55:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268882"
}
```



---

archive/issue_events_268883.json:
```json
{
    "actor": "https://github.com/bgrenet",
    "created_at": "2015-10-26T13:55:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268883"
}
```



---

archive/issue_comments_265975.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b12ea0b0dc0ac78951cae2d4fc8881d4a5fe9133\">b12ea0b</a></td><td><code>Trac 18940: document behaviour of `__getitem__` for polynomials vs. lists</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e70430a5959274c7163ffc347529a54c9ef03648\">e70430a</a></td><td><code>Trac 18940: forbid step < 0 in Polynomial.__getitem__()</code></td></tr></table>\n",
    "created_at": "2015-10-27T16:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265975",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b12ea0b0dc0ac78951cae2d4fc8881d4a5fe9133">b12ea0b</a></td><td><code>Trac 18940: document behaviour of `__getitem__` for polynomials vs. lists</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e70430a5959274c7163ffc347529a54c9ef03648">e70430a</a></td><td><code>Trac 18940: forbid step < 0 in Polynomial.__getitem__()</code></td></tr></table>




---

archive/issue_comments_265976.json:
```json
{
    "body": "Changed commit from **[97f9582](https://github.com/sagemath/sagetrac-mirror/commit/97f95822da2ae740aa9a19bcc75f73c216879aeb)** to **[e70430a](https://github.com/sagemath/sagetrac-mirror/commit/e70430a5959274c7163ffc347529a54c9ef03648)**",
    "created_at": "2015-10-27T16:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265976",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[97f9582](https://github.com/sagemath/sagetrac-mirror/commit/97f95822da2ae740aa9a19bcc75f73c216879aeb)** to **[e70430a](https://github.com/sagemath/sagetrac-mirror/commit/e70430a5959274c7163ffc347529a54c9ef03648)**



---

archive/issue_comments_265977.json:
```json
{
    "body": "Changed commit from **[e70430a](https://github.com/sagemath/sagetrac-mirror/commit/e70430a5959274c7163ffc347529a54c9ef03648)** to **[6842d86](https://github.com/sagemath/sagetrac-mirror/commit/6842d868a0b7c995f7a3d396deacdcdec6913ce6)**",
    "created_at": "2015-10-27T17:01:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265977",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e70430a](https://github.com/sagemath/sagetrac-mirror/commit/e70430a5959274c7163ffc347529a54c9ef03648)** to **[6842d86](https://github.com/sagemath/sagetrac-mirror/commit/6842d868a0b7c995f7a3d396deacdcdec6913ce6)**



---

archive/issue_comments_265978.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6842d868a0b7c995f7a3d396deacdcdec6913ce6\">6842d86</a></td><td><code>Trac 18940: forbid step < 0 in Polynomial.__getitem__()</code></td></tr></table>\n",
    "created_at": "2015-10-27T17:01:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265978",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6842d868a0b7c995f7a3d396deacdcdec6913ce6">6842d86</a></td><td><code>Trac 18940: forbid step < 0 in Polynomial.__getitem__()</code></td></tr></table>




---

archive/issue_events_268884.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-10-27T17:03:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268884"
}
```



---

archive/issue_events_268885.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-10-27T17:03:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268885"
}
```



---

archive/issue_comments_265979.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@bgrenet](#comment:9):\n> Replying to [@pjbruin](#comment:8):\n> > Replying to [@jdemeyer](#comment:7):\n> > > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?\n\n> > I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.\n\n> \n> I think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.\n\nOK, I added a warning and an example for this.\n\nAlso, in the meantime I realised that `step <= 0` is (1) not necessarily well-defined, and (2) may cause Sage to crash with the current implementation.  I added a few lines to detect this case and raise an `IndexError`.",
    "created_at": "2015-10-27T17:03:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265979",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@bgrenet](#comment:9):
> Replying to [@pjbruin](#comment:8):
> > Replying to [@jdemeyer](#comment:7):
> > > Just a remark: did you have a look at [PySlice_GetIndicesEx](https://docs.python.org/2/c-api/slice.html#c.PySlice_GetIndicesEx)?

> > I tried this, but unfortunately it does not return the correct indices for polynomials.  For example, it wraps around negative `start` values (as in the Python convention that `L[-1]` with `L` a list returns the last item in `L`); this is incompatible with Sage's convention that `P[n]` returns 0 if `P` is a polynomial and `n < 0`.

> 
> I think this behavior should be documented: I'd add a `Warning` block to the documentation to specify that it doesn't (and cannot!) respect Python convention. This may be obvious for Laurent polynomials, but it is not clear for polynomials.

OK, I added a warning and an example for this.

Also, in the meantime I realised that `step <= 0` is (1) not necessarily well-defined, and (2) may cause Sage to crash with the current implementation.  I added a few lines to detect this case and raise an `IndexError`.



---

archive/issue_comments_265980.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1c56779b3140d12fbe5d0973cdcad0ac9dbb8054\">1c56779</a></td><td><code>Merge branch 'develop' into ticket/18940-getitem_step</code></td></tr></table>\n",
    "created_at": "2015-10-30T14:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265980",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1c56779b3140d12fbe5d0973cdcad0ac9dbb8054">1c56779</a></td><td><code>Merge branch 'develop' into ticket/18940-getitem_step</code></td></tr></table>




---

archive/issue_comments_265981.json:
```json
{
    "body": "Changed commit from **[6842d86](https://github.com/sagemath/sagetrac-mirror/commit/6842d868a0b7c995f7a3d396deacdcdec6913ce6)** to **[1c56779](https://github.com/sagemath/sagetrac-mirror/commit/1c56779b3140d12fbe5d0973cdcad0ac9dbb8054)**",
    "created_at": "2015-10-30T14:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265981",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[6842d86](https://github.com/sagemath/sagetrac-mirror/commit/6842d868a0b7c995f7a3d396deacdcdec6913ce6)** to **[1c56779](https://github.com/sagemath/sagetrac-mirror/commit/1c56779b3140d12fbe5d0973cdcad0ac9dbb8054)**



---

archive/issue_comments_265982.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nFor some classes, you still reimplement `__getitem__` for slices. Why is that? Why cannot you always use the generic implementation for slicing?",
    "created_at": "2015-11-02T09:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265982",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:15" align="right">comment:15</div>

For some classes, you still reimplement `__getitem__` for slices. Why is that? Why cannot you always use the generic implementation for slicing?



---

archive/issue_comments_265983.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nWhy not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.",
    "created_at": "2015-11-02T09:14:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265983",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:16" align="right">comment:16</div>

Why not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.



---

archive/issue_events_268886.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-02T09:43:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268886"
}
```



---

archive/issue_events_268887.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-02T09:43:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268887"
}
```



---

archive/issue_events_268888.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-02T09:43:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268888"
}
```



---

archive/issue_events_268889.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-02T09:43:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268889"
}
```



---

archive/issue_comments_265984.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nAre you sure that the current behaviour is really what we want?\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol\n9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x\nsage: pol[2:]\n9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n```\nI would have expected\n\n```\nsage: pol[2:]\n9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2\n```\n\nI know that this branch just extends the current behaviour. However, I think we need to step back and define mathematically what should be returned when asking for `pol[a:b:c]`. The current definition is not very useful.\n\nI think that `list(pol[a:b:c])` should be the same as `list(pol)[a:b:c]`, except for different rules when the range is outside of `0 ... pol.degree()`.",
    "created_at": "2015-11-02T09:43:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265984",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">comment:17</div>

Are you sure that the current behaviour is really what we want?

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol
9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x
sage: pol[2:]
9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
```
I would have expected

```
sage: pol[2:]
9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2
```

I know that this branch just extends the current behaviour. However, I think we need to step back and define mathematically what should be returned when asking for `pol[a:b:c]`. The current definition is not very useful.

I think that `list(pol[a:b:c])` should be the same as `list(pol)[a:b:c]`, except for different rules when the range is outside of `0 ... pol.degree()`.



---

archive/issue_comments_265985.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nPeter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?",
    "created_at": "2015-11-02T09:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265985",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?



---

archive/issue_comments_265986.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nFor the record, the current definition of `pol[a:b]` was introduced with\n\n```\ncommit ff63a1c2b5798a777dcef6a4366a43dc60a6bebd\nAuthor: William Stein <wstein@gmail.com>\nDate:   Fri Jan 26 02:42:10 2007 -0800\n\n    A huge amount -- starting with writing tons of doctests for power series, pyrex integer_ring, etc.\n    \n        * changed before of polynomial and power series slicing to return objects of the same type,\n          which is much more consistent.\n        * optimized integer constructor\n        * improved random number generation (e.g., ZZ.random_element()) ten times faster and more\n          flexible.\n        * separated out pmem_malloc\n```",
    "created_at": "2015-11-02T10:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265986",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

For the record, the current definition of `pol[a:b]` was introduced with

```
commit ff63a1c2b5798a777dcef6a4366a43dc60a6bebd
Author: William Stein <wstein@gmail.com>
Date:   Fri Jan 26 02:42:10 2007 -0800

    A huge amount -- starting with writing tons of doctests for power series, pyrex integer_ring, etc.
    
        * changed before of polynomial and power series slicing to return objects of the same type,
          which is much more consistent.
        * optimized integer constructor
        * improved random number generation (e.g., ZZ.random_element()) ten times faster and more
          flexible.
        * separated out pmem_malloc
```



---

archive/issue_comments_265987.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nWe currently have\n\n```\nsage: R.<x> = QQ[]\nsage: p = R.random_element((-1, 10)); p\n-2/3*x^10 + 3/2*x^9 - 1/2*x^8 + 10*x^7 + x^6 + 3/2*x^5 + 1/3*x^4 + 5/2*x^3 - x^2 + 29*x - 1\nsage: list(p)\n[-1, 29, -1, 5/2, 1/3, 3/2, 1, 10, -1/2, 3/2, -2/3]\n```\nSo `list` does go low to high and the current behavior is consistent with converting to a list.\n\n+1 for supporting negative steps.",
    "created_at": "2015-11-02T16:09:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265987",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:20" align="right">comment:20</div>

We currently have

```
sage: R.<x> = QQ[]
sage: p = R.random_element((-1, 10)); p
-2/3*x^10 + 3/2*x^9 - 1/2*x^8 + 10*x^7 + x^6 + 3/2*x^5 + 1/3*x^4 + 5/2*x^3 - x^2 + 29*x - 1
sage: list(p)
[-1, 29, -1, 5/2, 1/3, 3/2, 1, 10, -1/2, 3/2, -2/3]
```
So `list` does go low to high and the current behavior is consistent with converting to a list.

+1 for supporting negative steps.



---

archive/issue_comments_265988.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@tscrim](#comment:20):\n> the current behavior is consistent with converting to a list.\n\nWhat do you mean? I think that these two outputs should be equal:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: list(pol[5:])\n[0, 0, 0, 0, 0, 5, 6, 7, 8, 9]\nsage: list(pol)[5:]\n[5, 6, 7, 8, 9]\n```",
    "created_at": "2015-11-02T16:14:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265988",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@tscrim](#comment:20):
> the current behavior is consistent with converting to a list.

What do you mean? I think that these two outputs should be equal:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: list(pol[5:])
[0, 0, 0, 0, 0, 5, 6, 7, 8, 9]
sage: list(pol)[5:]
[5, 6, 7, 8, 9]
```



---

archive/issue_comments_265989.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAh, I see what you mean. I'm sorry, I didn't read your example closely enough and though you were truncating off the 2 leading terms.\n\nHowever, list and slice already don't commute because of the python wrap around, so I'm not so sure on how much we should enforce the exact same behavior (granted, an error gets raised in the polynomial case). I personally would find that the degree was lowered more surprising if we still wanted slices to return polynomials as opposed to a list of the coefficients. Yet I don't really have much invested in this.",
    "created_at": "2015-11-02T17:54:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265989",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:22" align="right">comment:22</div>

Ah, I see what you mean. I'm sorry, I didn't read your example closely enough and though you were truncating off the 2 leading terms.

However, list and slice already don't commute because of the python wrap around, so I'm not so sure on how much we should enforce the exact same behavior (granted, an error gets raised in the polynomial case). I personally would find that the degree was lowered more surprising if we still wanted slices to return polynomials as opposed to a list of the coefficients. Yet I don't really have much invested in this.



---

archive/issue_comments_265990.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@tscrim](#comment:22):\n> I personally would find that the degree was lowered more surprising\n\nSo what's in your opinion the correct answer for\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: list(pol[2::2])\n```\n\nIf we cannot agree on a \"natural\" definition for `pol[a:b:c]`, perhaps the best compromise is simply\n\n```\nif isinstance(i, slice):\n    raise NotImplementedError(\"polynomial slicing is not defined\")\n```",
    "created_at": "2015-11-02T18:14:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265990",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@tscrim](#comment:22):
> I personally would find that the degree was lowered more surprising

So what's in your opinion the correct answer for

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: list(pol[2::2])
```

If we cannot agree on a "natural" definition for `pol[a:b:c]`, perhaps the best compromise is simply

```
if isinstance(i, slice):
    raise NotImplementedError("polynomial slicing is not defined")
```



---

archive/issue_comments_265991.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@jdemeyer](#comment:23):\n> Replying to [@tscrim](#comment:22):\n> > I personally would find that the degree was lowered more surprising\n\n> So what's in your opinion the correct answer for\n> \n> ```\n> sage: pol = PolynomialRing(QQ, 'x')(range(10))\n> sage: list(pol[2::2])\n> ```\n\nThat depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.\n\n> If we cannot agree on a \"natural\" definition for `pol[a:b:c]`, perhaps the best compromise is simply\n> \n> ```\n> if isinstance(i, slice):\n>     raise NotImplementedError(\"polynomial slicing is not defined\")\n> ```\n\nThis would be okay with me as well, but I don't think my opinion here should weigh very much here because I am mostly ambivalent about this behavior since I don't have a use for it.",
    "created_at": "2015-11-02T18:35:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265991",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@jdemeyer](#comment:23):
> Replying to [@tscrim](#comment:22):
> > I personally would find that the degree was lowered more surprising

> So what's in your opinion the correct answer for
> 
> ```
> sage: pol = PolynomialRing(QQ, 'x')(range(10))
> sage: list(pol[2::2])
> ```

That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.

> If we cannot agree on a "natural" definition for `pol[a:b:c]`, perhaps the best compromise is simply
> 
> ```
> if isinstance(i, slice):
>     raise NotImplementedError("polynomial slicing is not defined")
> ```

This would be okay with me as well, but I don't think my opinion here should weigh very much here because I am mostly ambivalent about this behavior since I don't have a use for it.



---

archive/issue_comments_265992.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@tscrim](#comment:24):\n> That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.\n\nSorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(1,10))\nsage: list(pol[3::2])\n```",
    "created_at": "2015-11-02T18:41:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265992",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@tscrim](#comment:24):
> That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.

Sorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:

```
sage: pol = PolynomialRing(QQ, 'x')(range(1,10))
sage: list(pol[3::2])
```



---

archive/issue_comments_265993.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jdemeyer](#comment:25):\n> Replying to [@tscrim](#comment:24):\n> > That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.\n\n> \n> Sorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:\n> \n> ```\n> sage: pol = PolynomialRing(QQ, 'x')(range(1,10))\n> sage: list(pol[3::2])\n> ```\n\nI would want this:\n\n```\nsage: list(pol[3::2])\n[0, 0, 0, 4, 0, 6, 0, 8]\n```\nActually, my answer above was wrong and shouw be `[0, 0, 2, 0, 4, 0, 6, 0, 8]`. [Edit - Some changes due to me not thinking things completely through]\n\nHowever, when trying to think about how this would work for Laurent polynomials, we currently have this behavior for `list`:\n\n```\nsage: R.<x> = LaurentPolynomialRing(QQ)\nsage: p = ~x + 2 + 3*x + 4*x^2\nsage: list(p)\n[1, 2, 3, 4]\nsage: p = 3*x + 4*x^2\nsage: list(p)\n[3, 4]\n```\nIn some ways I would say the iterator for polynomials should be changed to agree with that of Laurent polynomials, in that it starts from the lowest degree. Although I understand there are many (good) reasons why we do not want that behavior. I feel that at some point we just have to choose the least bad of all options and then put up warning messages about our choices.",
    "created_at": "2015-11-02T18:52:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265993",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jdemeyer](#comment:25):
> Replying to [@tscrim](#comment:24):
> > That depends on if we want a slice of a polynomial returns a polynomial or a simple list of the coefficients. I am (very) slightly in favor of returning a polynomial, so with that `[0, 2, 4, 6, 8]`.

> 
> Sorry, I asked a bad question so I cannot interpret your answer. Please try again with this question:
> 
> ```
> sage: pol = PolynomialRing(QQ, 'x')(range(1,10))
> sage: list(pol[3::2])
> ```

I would want this:

```
sage: list(pol[3::2])
[0, 0, 0, 4, 0, 6, 0, 8]
```
Actually, my answer above was wrong and shouw be `[0, 0, 2, 0, 4, 0, 6, 0, 8]`. [Edit - Some changes due to me not thinking things completely through]

However, when trying to think about how this would work for Laurent polynomials, we currently have this behavior for `list`:

```
sage: R.<x> = LaurentPolynomialRing(QQ)
sage: p = ~x + 2 + 3*x + 4*x^2
sage: list(p)
[1, 2, 3, 4]
sage: p = 3*x + 4*x^2
sage: list(p)
[3, 4]
```
In some ways I would say the iterator for polynomials should be changed to agree with that of Laurent polynomials, in that it starts from the lowest degree. Although I understand there are many (good) reasons why we do not want that behavior. I feel that at some point we just have to choose the least bad of all options and then put up warning messages about our choices.



---

archive/issue_comments_265994.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@tscrim](#comment:26):\n> I would want this:\n> \n> ```\n> sage: list(pol[3::2])\n> [0, 0, 0, 4, 0, 6, 0, 8]\n> ```\n\nInteresting. This is indeed what this branch does, but it doesn't correspond with my intuition about what it should do (I would expect `[4, 6, 8]`).",
    "created_at": "2015-11-02T19:02:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265994",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@tscrim](#comment:26):
> I would want this:
> 
> ```
> sage: list(pol[3::2])
> [0, 0, 0, 4, 0, 6, 0, 8]
> ```

Interesting. This is indeed what this branch does, but it doesn't correspond with my intuition about what it should do (I would expect `[4, 6, 8]`).



---

archive/issue_comments_265995.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jdemeyer](#comment:18):\n> Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?\n\nBecause of comments 22, 25 and 26 on ticket #15601.",
    "created_at": "2015-11-02T19:45:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265995",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jdemeyer](#comment:18):
> Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?

Because of comments 22, 25 and 26 on ticket #15601.



---

archive/issue_comments_265996.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@jdemeyer](#comment:17):\n> Are you sure that the current behaviour is really what we want?\n> \n> ```\n> sage: pol = PolynomialRing(QQ, 'x')(range(10))\n> sage: pol\n> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x\n> sage: pol[2:]\n> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n> ```\n\nYes.  The fact that polynomials are usually written with decreasing exponents is just a historical convention.  I think it is absolutely reasonable that `pol[2:]` should return the monomials of degree 2 and higher, whether as a polynomial or as a list.  And in fact\n\n```\nsage: list(pol)\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n```\nso doing `list(pol)[2:]` also extracts the coefficients of the monomials of degree at least 2.\n\nSimilarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.",
    "created_at": "2015-11-02T19:53:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265996",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@jdemeyer](#comment:17):
> Are you sure that the current behaviour is really what we want?
> 
> ```
> sage: pol = PolynomialRing(QQ, 'x')(range(10))
> sage: pol
> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2 + x
> sage: pol[2:]
> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
> ```

Yes.  The fact that polynomials are usually written with decreasing exponents is just a historical convention.  I think it is absolutely reasonable that `pol[2:]` should return the monomials of degree 2 and higher, whether as a polynomial or as a list.  And in fact

```
sage: list(pol)
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
```
so doing `list(pol)[2:]` also extracts the coefficients of the monomials of degree at least 2.

Similarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.



---

archive/issue_comments_265997.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@jdemeyer](#comment:21):\n> Replying to [@tscrim](#comment:20):\n> > the current behavior is consistent with converting to a list.\n\n> \n> What do you mean? I think that these two outputs should be equal:\n> \n> ```\n> sage: pol = PolynomialRing(QQ, 'x')(range(10))\n> sage: list(pol[5:])\n> [0, 0, 0, 0, 0, 5, 6, 7, 8, 9]\n> sage: list(pol)[5:]\n> [5, 6, 7, 8, 9]\n> ```\n\nWhat would you want the output of `pol[5:]` itself to be?",
    "created_at": "2015-11-02T19:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265997",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@jdemeyer](#comment:21):
> Replying to [@tscrim](#comment:20):
> > the current behavior is consistent with converting to a list.

> 
> What do you mean? I think that these two outputs should be equal:
> 
> ```
> sage: pol = PolynomialRing(QQ, 'x')(range(10))
> sage: list(pol[5:])
> [0, 0, 0, 0, 0, 5, 6, 7, 8, 9]
> sage: list(pol)[5:]
> [5, 6, 7, 8, 9]
> ```

What would you want the output of `pol[5:]` itself to be?



---

archive/issue_comments_265998.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@jdemeyer](#comment:16):\n> Why not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.\n\nWe already have the `reverse()` method for that.  I can think of two possible results for `pol[a:b:-1]`, one of which would be the `reverse()` of the other.  I am afraid allowing `step = -1` would only create confusion...",
    "created_at": "2015-11-02T19:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265998",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@jdemeyer](#comment:16):
> Why not allow `step < 0`? Actually, I think that `step = -1` might be the most mathematically useful value of `step`.

We already have the `reverse()` method for that.  I can think of two possible results for `pol[a:b:-1]`, one of which would be the `reverse()` of the other.  I am afraid allowing `step = -1` would only create confusion...



---

archive/issue_comments_265999.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nMathematically, I can certainly imagine wanting the part of the polynomial between degrees 2 and 5: I might want this:\n\n```\nsage: f\n-10*x^6 + 1/2*x^5 - x^4 + 7*x^3 - 2*x^2 + x - 3\nsage: f[2:6]\n1/2*x^5 - x^4 + 7*x^3 - 2*x^2\n```\nI don't know if I would ever want `f[2:6]` to return the polynomial with same coefficients but translated down in degree (i.e., `1/2*x^3 - x^2 + 7*x - 2`). Computationally, though, if I have that second result, I can easily get back to the first one by multiplying by `x^2`. If I have the first, I can get to the second by dividing, but that puts the result in the fraction field, which is probably not what I want. Alternatively, I can also get to the second by creating a polynomial from `list(f)[2:6]`, which is not as intuitive, but not too hard.\n\nSurely different mathematicians will have different points of view on this.\n\nI think this is the issue for me: do we want\n\n```\nsage: list(pol[5:]) == list(pol)[5:]\nTrue\n```\nor do we want\n\n```\nsage: pol[:5] + pol[5:] == pol\nTrue\n```\nWe can't have both, right? I prefer the second. That is, I tend to think of polynomials as graded objects and slicing is returning some of their homogeneous components, and it seems most natural to do this without regrading the result: if a term is in degree 3 in the original polynomial, it should still be in degree 3 after slicing. I would also like this:\n\n```\nsage: pol[0:10:2] + pol[1:10:2] == pol[0:10]\nTrue\n```\nAdding the even terms to the odd terms should yield the original polynomial.\n\nA related question: should `f[2]` return `-2` or `-2 * x^2`?\n\n---\n\nWhen it comes down to it, I'm not sure I care which option is implemented as `__getitem__`, but perhaps both should be implemented as methods which are visible via tab-completion, or as a single method with a keyword which determines which option to use.",
    "created_at": "2015-11-02T21:40:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-265999",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

Mathematically, I can certainly imagine wanting the part of the polynomial between degrees 2 and 5: I might want this:

```
sage: f
-10*x^6 + 1/2*x^5 - x^4 + 7*x^3 - 2*x^2 + x - 3
sage: f[2:6]
1/2*x^5 - x^4 + 7*x^3 - 2*x^2
```
I don't know if I would ever want `f[2:6]` to return the polynomial with same coefficients but translated down in degree (i.e., `1/2*x^3 - x^2 + 7*x - 2`). Computationally, though, if I have that second result, I can easily get back to the first one by multiplying by `x^2`. If I have the first, I can get to the second by dividing, but that puts the result in the fraction field, which is probably not what I want. Alternatively, I can also get to the second by creating a polynomial from `list(f)[2:6]`, which is not as intuitive, but not too hard.

Surely different mathematicians will have different points of view on this.

I think this is the issue for me: do we want

```
sage: list(pol[5:]) == list(pol)[5:]
True
```
or do we want

```
sage: pol[:5] + pol[5:] == pol
True
```
We can't have both, right? I prefer the second. That is, I tend to think of polynomials as graded objects and slicing is returning some of their homogeneous components, and it seems most natural to do this without regrading the result: if a term is in degree 3 in the original polynomial, it should still be in degree 3 after slicing. I would also like this:

```
sage: pol[0:10:2] + pol[1:10:2] == pol[0:10]
True
```
Adding the even terms to the odd terms should yield the original polynomial.

A related question: should `f[2]` return `-2` or `-2 * x^2`?

---

When it comes down to it, I'm not sure I care which option is implemented as `__getitem__`, but perhaps both should be implemented as methods which are visible via tab-completion, or as a single method with a keyword which determines which option to use.



---

archive/issue_comments_266000.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@pjbruin](#comment:28):\n> Replying to [@jdemeyer](#comment:18):\n> > Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?\n\n> Because of comments 22, 25 and 26 on ticket #15601.\n\nYou're just justifying a dubious use-case with a different dubious use-case.",
    "created_at": "2015-11-02T21:41:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266000",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@pjbruin](#comment:28):
> Replying to [@jdemeyer](#comment:18):
> > Peter, what's your use-case for `pol[a:b:c]`, i.e. why did you create this ticket?

> Because of comments 22, 25 and 26 on ticket #15601.

You're just justifying a dubious use-case with a different dubious use-case.



---

archive/issue_comments_266001.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@pjbruin](#comment:29):\n> Similarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.\n\nI think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.\n\nIt's about\n\n```\n9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n```\nversus\n\n```\n9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2\n```",
    "created_at": "2015-11-02T22:01:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266001",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@pjbruin](#comment:29):
> Similarly, in PARI, my experience is that `Vecrev` (which does the equivalent of `list` above) is more useful than `Vec` to extract the list of coefficients of a polynomial.

I think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.

It's about

```
9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
```
versus

```
9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2
```



---

archive/issue_comments_266002.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@pjbruin](#comment:30):\n> What would you want the output of `pol[5:]` itself to be?\n\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[5:]\n9*x^4 + 8*x^3 + 7*x^2 + 6*x + 5\n```\n(although, I don't really *want* it to be this, but this is what I would *expect*)",
    "created_at": "2015-11-02T22:02:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266002",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@pjbruin](#comment:30):
> What would you want the output of `pol[5:]` itself to be?


```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[5:]
9*x^4 + 8*x^3 + 7*x^2 + 6*x + 5
```
(although, I don't really *want* it to be this, but this is what I would *expect*)



---

archive/issue_comments_266003.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nWhat I **really** want is probably\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[5:]\nDeprecationWarning: slicing polynomials is deprecated...\n```",
    "created_at": "2015-11-02T22:19:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266003",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

What I **really** want is probably

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[5:]
DeprecationWarning: slicing polynomials is deprecated...
```



---

archive/issue_comments_266004.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nIn the Sage library, there are use cases for `pol[:n]` (i.e. truncation) and that's also the only case (I think) where both definitions agree.",
    "created_at": "2015-11-02T22:29:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266004",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:37" align="right">comment:37</div>

In the Sage library, there are use cases for `pol[:n]` (i.e. truncation) and that's also the only case (I think) where both definitions agree.



---

archive/issue_comments_266005.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nSo deprecate slicing unless it's a truncation?",
    "created_at": "2015-11-02T22:34:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266005",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:38" align="right">comment:38</div>

So deprecate slicing unless it's a truncation?



---

archive/issue_comments_266006.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nOne more thought. Let's call this **degree-keeping slicing**:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[3::2]\n9*x^9 + 7*x^7 + 5*x^5 + 3*x^3\n```\nand let's call this **degree-reducing slicing**:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[3::2]\n9*x^3 + 7*x^2 + 5*x + 3\n```\n\nThe implementation of certain divide-and-conquer algorithms (e.g. Karatsuba multiplication and FFT) can be expressed very easily using degree-reducing slicing.\n\nI'm not saying that this is a particularly strong argument for degree-reducing slicing, since most likely you'd implement those algorithms using lists instead of polynomials anyway.",
    "created_at": "2015-11-03T07:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266006",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">comment:39</div>

One more thought. Let's call this **degree-keeping slicing**:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[3::2]
9*x^9 + 7*x^7 + 5*x^5 + 3*x^3
```
and let's call this **degree-reducing slicing**:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[3::2]
9*x^3 + 7*x^2 + 5*x + 3
```

The implementation of certain divide-and-conquer algorithms (e.g. Karatsuba multiplication and FFT) can be expressed very easily using degree-reducing slicing.

I'm not saying that this is a particularly strong argument for degree-reducing slicing, since most likely you'd implement those algorithms using lists instead of polynomials anyway.



---

archive/issue_comments_266007.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nA new idea, let's call it **double slicing**. The argument to `__getitem__` can be a pair of slices `i, j`, where the slice `i` is used to define the coefficients and the second slice `j` is used to define the exponents. It would allow for example:\n\n```\nsage: pol = PolynomialRing(QQ, 'x')(range(10))\nsage: pol[:, ::2]\n9*x^18 + 8*x^16 + 7*x^14 + 6*x^12 + 5*x^10 + 4*x^8 + 3*x^6 + 2*x^4 + x^2\nsage: pol[:5, 100:]\n4*x^104 + 3*x^103 + 2*x^102 + x^101\n```\n\nWe could define shorthands `pol[i]` equivalent to `pol[i, i]` for degree-keeping slicing and `pol[i,]` equivalent to `pol[i, :]` for degree-reducing slicing.\n\nThis would be very general and cover all possible use-cases. The question is: is it over-engineered? Do we really need this?",
    "created_at": "2015-11-03T08:38:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266007",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">comment:40</div>

A new idea, let's call it **double slicing**. The argument to `__getitem__` can be a pair of slices `i, j`, where the slice `i` is used to define the coefficients and the second slice `j` is used to define the exponents. It would allow for example:

```
sage: pol = PolynomialRing(QQ, 'x')(range(10))
sage: pol[:, ::2]
9*x^18 + 8*x^16 + 7*x^14 + 6*x^12 + 5*x^10 + 4*x^8 + 3*x^6 + 2*x^4 + x^2
sage: pol[:5, 100:]
4*x^104 + 3*x^103 + 2*x^102 + x^101
```

We could define shorthands `pol[i]` equivalent to `pol[i, i]` for degree-keeping slicing and `pol[i,]` equivalent to `pol[i, :]` for degree-reducing slicing.

This would be very general and cover all possible use-cases. The question is: is it over-engineered? Do we really need this?



---

archive/issue_comments_266008.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding\n\n```\nif start or step is not None:\n    raise NotImplementedError\n```\nto the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.",
    "created_at": "2015-11-03T11:10:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266008",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:41" align="right">comment:41</div>

I can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding

```
if start or step is not None:
    raise NotImplementedError
```
to the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.



---

archive/issue_comments_266009.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nReplying to [@jdemeyer](#comment:34):\n> Replying to [@pjbruin](#comment:29):\n> I think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.\n> \n> It's about\n> \n> ```\n> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2\n> ```\n> versus\n> \n> ```\n> 9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2\n> ```\n\nOK, I see.  As you can guess from how I interpreted your proposal, for me this is not the expected answer at all.\n\nI would personally be quite happy with just deprecating the `start` and `stop` parameters and allowing polynomial slicing only for `pol[:n]`, i.e. truncation.  I think users can easily implement other forms of slicing via lists.",
    "created_at": "2015-11-03T14:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266009",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:42" align="right">comment:42</div>

Replying to [@jdemeyer](#comment:34):
> Replying to [@pjbruin](#comment:29):
> I think you are totally misunderstanding me. This is not at all about in *which order* the monomials are extracted. Obviously, PARI's `Vecrev()` is the right thing, I'm not arguing against that.
> 
> It's about
> 
> ```
> 9*x^9 + 8*x^8 + 7*x^7 + 6*x^6 + 5*x^5 + 4*x^4 + 3*x^3 + 2*x^2
> ```
> versus
> 
> ```
> 9*x^7 + 8*x^6 + 7*x^5 + 6*x^4 + 5*x^3 + 4*x^2 + 3*x + 2
> ```

OK, I see.  As you can guess from how I interpreted your proposal, for me this is not the expected answer at all.

I would personally be quite happy with just deprecating the `start` and `stop` parameters and allowing polynomial slicing only for `pol[:n]`, i.e. truncation.  I think users can easily implement other forms of slicing via lists.



---

archive/issue_comments_266010.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI think the double-slicing is probably something we don't really need. So I'm also for deprecating the (non-zero?) `start` and `step` conditions.",
    "created_at": "2015-11-03T15:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266010",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:43" align="right">comment:43</div>

I think the double-slicing is probably something we don't really need. So I'm also for deprecating the (non-zero?) `start` and `step` conditions.



---

archive/issue_comments_266011.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nIf we deprecate general slicing, shouldn't we deprecate all kinds of slicing, including `pol[:n]` in favour of the `truncate()` method?",
    "created_at": "2015-11-03T17:21:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266011",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

If we deprecate general slicing, shouldn't we deprecate all kinds of slicing, including `pol[:n]` in favour of the `truncate()` method?



---

archive/issue_events_268890.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-03T17:29:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268890"
}
```



---

archive/issue_events_268891.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-03T17:29:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268891"
}
```



---

archive/issue_comments_266012.json:
```json
{
    "body": "Changed author from **Peter Bruin** to **Peter Bruin, Jeroen Demeyer**",
    "created_at": "2015-11-03T17:29:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266012",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Peter Bruin** to **Peter Bruin, Jeroen Demeyer**



---

archive/issue_events_268892.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-03T17:29:01Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "title_is": "Simplify __getitem__ for polynomials and deprecate slicing",
    "title_was": "Polynomials ignore the step argument in __getitem__",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268892"
}
```



---

archive/issue_comments_266013.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,13 +1,3 @@\n-Sage should support a `step` different from 1 in the `__getitem__()` method of polynomials:\n-\n-```\n-sage: R.<x> = ZZ[]\n-sage: f = sum(x^j for j in range(5))\n-sage: f\n-x^4 + x^3 + x^2 + x + 1\n-sage: f[-2:4:2]\n-x^3 + x^2 + x + 1  # should be x^2 + 1\n-```\n-We fix this for most classes by implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  It is conceivable that there is a small performance loss (I have not tested this), but it is unlikely that there is any speed-critical code that heavily depends on `__getitem__()` with a slice argument.  For the remaining affected classes (Python classes, sparse polynomials), we fix `__getitem__()` in a similar way.\n+For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).\n \n This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.\n``````\n",
    "created_at": "2015-11-03T17:29:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266013",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,13 +1,3 @@
-Sage should support a `step` different from 1 in the `__getitem__()` method of polynomials:
-
-```
-sage: R.<x> = ZZ[]
-sage: f = sum(x^j for j in range(5))
-sage: f
-x^4 + x^3 + x^2 + x + 1
-sage: f[-2:4:2]
-x^3 + x^2 + x + 1  # should be x^2 + 1
-```
-We fix this for most classes by implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  It is conceivable that there is a small performance loss (I have not tested this), but it is unlikely that there is any speed-critical code that heavily depends on `__getitem__()` with a slice argument.  For the remaining affected classes (Python classes, sparse polynomials), we fix `__getitem__()` in a similar way.
+For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).
 
 This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.
``````




---

archive/issue_comments_266014.json:
```json
{
    "body": "Changed dependencies from **#19409** to none",
    "created_at": "2015-11-03T17:29:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266014",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#19409** to none



---

archive/issue_comments_266015.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nTruncation is actually implemented using slicing, so we cannot easily deprecate that.\n\nI am working on a patch.",
    "created_at": "2015-11-03T19:22:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266015",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

Truncation is actually implemented using slicing, so we cannot easily deprecate that.

I am working on a patch.



---

archive/issue_comments_266016.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).\n+For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).\n \n This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.\n``````\n",
    "created_at": "2015-11-03T19:22:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266016",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).
+For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).
 
 This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.
``````




---

archive/issue_comments_266017.json:
```json
{
    "body": "Changed branch from **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)** to **[u/jdemeyer/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/18940-getitem_step)**",
    "created_at": "2015-11-03T19:43:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266017",
    "user": "https://github.com/jdemeyer"
}
```

Changed branch from **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)** to **[u/jdemeyer/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/18940-getitem_step)**



---

archive/issue_comments_266018.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94784864094bc84e7eb8c977fd1cf8efc4aa9b6e\">9478486</a></td><td><code>Deprecate slicing with start index</code></td></tr></table>\n",
    "created_at": "2015-11-04T13:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266018",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94784864094bc84e7eb8c977fd1cf8efc4aa9b6e">9478486</a></td><td><code>Deprecate slicing with start index</code></td></tr></table>




---

archive/issue_comments_266019.json:
```json
{
    "body": "Changed commit from **[1c56779](https://github.com/sagemath/sagetrac-mirror/commit/1c56779b3140d12fbe5d0973cdcad0ac9dbb8054)** to **[9478486](https://github.com/sagemath/sagetrac-mirror/commit/94784864094bc84e7eb8c977fd1cf8efc4aa9b6e)**",
    "created_at": "2015-11-04T13:12:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266019",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[1c56779](https://github.com/sagemath/sagetrac-mirror/commit/1c56779b3140d12fbe5d0973cdcad0ac9dbb8054)** to **[9478486](https://github.com/sagemath/sagetrac-mirror/commit/94784864094bc84e7eb8c977fd1cf8efc4aa9b6e)**



---

archive/issue_events_268893.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-04T13:22:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268893"
}
```



---

archive/issue_events_268894.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-04T13:22:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268894"
}
```



---

archive/issue_comments_266020.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nSorry, forgot `src/sage/rings/polynomial/padics/polynomial_padic_capped_relative_dense.py`",
    "created_at": "2015-11-04T13:24:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266020",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">comment:51</div>

Sorry, forgot `src/sage/rings/polynomial/padics/polynomial_padic_capped_relative_dense.py`



---

archive/issue_events_268895.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-04T13:24:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268895"
}
```



---

archive/issue_events_268896.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-04T13:24:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268896"
}
```



---

archive/issue_comments_266021.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n-For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).\n+For polynomials, we implement a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).\n \n This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.\n``````\n",
    "created_at": "2015-11-04T13:34:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266021",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
-For polynomials, we implementing a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).
+For polynomials, we implement a generic `__getitem__()` method, which depends on a new Cython method `get_unsafe()` to get single coefficients.  Overall, this greatly simplifies the code.  Except for truncation `pol[:n]`, slicing for polynomials is deprecated, since there is no clear use case and it is not mathematically well-defined what the answer should be (see also comment [comment:39] and further below).
 
 This fix allows us to simplify the method `PowerSeries_poly.__getitem__()`.  Also, the patch corrects some (previously wrong) slice bounds in `LaurentPolynomial_univariate.__getitem__()`.
``````




---

archive/issue_comments_266022.json:
```json
{
    "body": "<div id=\"comment:53\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b559028dc52ec660452dcc1b3f7cae70bf22f6da\">b559028</a></td><td><code>Use `__new__` to create an empty RealNumber</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44cca40e3e264811e40e51ae1136019b1f1b713e\">44cca40</a></td><td><code>Deprecate slicing with start index also in padics</code></td></tr></table>\n",
    "created_at": "2015-11-04T13:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266022",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:53"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b559028dc52ec660452dcc1b3f7cae70bf22f6da">b559028</a></td><td><code>Use `__new__` to create an empty RealNumber</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44cca40e3e264811e40e51ae1136019b1f1b713e">44cca40</a></td><td><code>Deprecate slicing with start index also in padics</code></td></tr></table>




---

archive/issue_comments_266023.json:
```json
{
    "body": "Changed commit from **[9478486](https://github.com/sagemath/sagetrac-mirror/commit/94784864094bc84e7eb8c977fd1cf8efc4aa9b6e)** to **[44cca40](https://github.com/sagemath/sagetrac-mirror/commit/44cca40e3e264811e40e51ae1136019b1f1b713e)**",
    "created_at": "2015-11-04T13:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266023",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9478486](https://github.com/sagemath/sagetrac-mirror/commit/94784864094bc84e7eb8c977fd1cf8efc4aa9b6e)** to **[44cca40](https://github.com/sagemath/sagetrac-mirror/commit/44cca40e3e264811e40e51ae1136019b1f1b713e)**



---

archive/issue_events_268897.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-04T13:48:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268897"
}
```



---

archive/issue_events_268898.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-11-04T13:48:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268898"
}
```



---

archive/issue_comments_266024.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nFWIW, I think I have personal code that uses (\u201cdegree-keeping\u201d) slicing of the form `pol[n:]`. I can port it, but I may not be alone...",
    "created_at": "2015-11-10T12:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266024",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:55" align="right">comment:55</div>

FWIW, I think I have personal code that uses (“degree-keeping”) slicing of the form `pol[n:]`. I can port it, but I may not be alone...



---

archive/issue_comments_266025.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nCool, what's your use case? I'm curious because I couldn't think of any.",
    "created_at": "2015-11-10T15:01:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266025",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Cool, what's your use case? I'm curious because I couldn't think of any.



---

archive/issue_comments_266026.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@jdemeyer](#comment:56):\n> Cool, what's your use case? I'm curious because I couldn't think of any.\n\nSplitting polynomials that actually represent power series expansions into an \u201capproximation\u201d and a \u201cremainder\u201c; removing the constant term of a polynomial; removing low-order terms that are know to be zero mathematically but are computed as intervals containing zero from a residual \u03a6(pol) where \u03a6 is an operator and pol is a polynomial close to a zero of \u03a6.",
    "created_at": "2015-11-10T17:26:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266026",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@jdemeyer](#comment:56):
> Cool, what's your use case? I'm curious because I couldn't think of any.

Splitting polynomials that actually represent power series expansions into an “approximation” and a “remainder“; removing the constant term of a polynomial; removing low-order terms that are know to be zero mathematically but are computed as intervals containing zero from a residual Φ(pol) where Φ is an operator and pol is a polynomial close to a zero of Φ.



---

archive/issue_comments_266027.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\n@mezzarobba: what is your opinion on [comment:40]?",
    "created_at": "2015-11-11T20:57:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266027",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">comment:58</div>

@mezzarobba: what is your opinion on [comment:40]?



---

archive/issue_comments_266028.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nReplying to [@jdemeyer](#comment:58):\n> @mezzarobba: what is your opinion on [comment:40]?\n\nI don't think I'd need it\u2014any of the two basic forms of slicing (either \u201cdegree-keeping\u201d or \u201cdegree-reducing\u201d) is enough for me. Regardless whether \u201cdouble slicing\u201d is implemented, I'd prefer `pol[i:]` to keep working (with one of the two basic meanings, I don't really care which, though I find the \u201cdegree-keeping\u201d version more intuitive with polynomials). It wouldn't be a big effort to change my code to work without slicing in any case.",
    "created_at": "2015-11-11T21:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266028",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:59" align="right">comment:59</div>

Replying to [@jdemeyer](#comment:58):
> @mezzarobba: what is your opinion on [comment:40]?

I don't think I'd need it—any of the two basic forms of slicing (either “degree-keeping” or “degree-reducing”) is enough for me. Regardless whether “double slicing” is implemented, I'd prefer `pol[i:]` to keep working (with one of the two basic meanings, I don't really care which, though I find the “degree-keeping” version more intuitive with polynomials). It wouldn't be a big effort to change my code to work without slicing in any case.



---

archive/issue_comments_266029.json:
```json
{
    "body": "Changed commit from **[44cca40](https://github.com/sagemath/sagetrac-mirror/commit/44cca40e3e264811e40e51ae1136019b1f1b713e)** to **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)**",
    "created_at": "2016-01-13T14:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266029",
    "user": "https://github.com/pjbruin"
}
```

Changed commit from **[44cca40](https://github.com/sagemath/sagetrac-mirror/commit/44cca40e3e264811e40e51ae1136019b1f1b713e)** to **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)**



---

archive/issue_comments_266030.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nFixed a merge conflict.",
    "created_at": "2016-01-13T14:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266030",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:60" align="right">comment:60</div>

Fixed a merge conflict.



---

archive/issue_comments_266031.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/18940-getitem_step)** to **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)**",
    "created_at": "2016-01-13T14:58:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266031",
    "user": "https://github.com/pjbruin"
}
```

Changed branch from **[u/jdemeyer/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/18940-getitem_step)** to **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)**



---

archive/issue_events_268899.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-01-18T08:05:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "milestone_number": null,
    "milestone_title": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268899"
}
```



---

archive/issue_events_268900.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-01-18T08:05:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "milestone_number": null,
    "milestone_title": "sage-7.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268900"
}
```



---

archive/issue_comments_266032.json:
```json
{
    "body": "Reviewer: **Ralf Stephan**",
    "created_at": "2016-01-18T08:05:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266032",
    "user": "https://github.com/rwst"
}
```

Reviewer: **Ralf Stephan**



---

archive/issue_events_268901.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-01-18T08:05:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268901"
}
```



---

archive/issue_events_268902.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2016-01-18T08:05:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268902"
}
```



---

archive/issue_comments_266033.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nThis is one of those enhancements I like to do myself. It is also thoroughly done. Since patchbot is happy too, I feel confident to set it positive.",
    "created_at": "2016-01-18T08:05:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266033",
    "user": "https://github.com/rwst"
}
```

<div id="comment:61" align="right">comment:61</div>

This is one of those enhancements I like to do myself. It is also thoroughly done. Since patchbot is happy too, I feel confident to set it positive.



---

archive/issue_comments_266034.json:
```json
{
    "body": "Changed branch from **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)** to **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)**",
    "created_at": "2016-01-20T10:20:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266034",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/pbruin/18940-getitem_step](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/18940-getitem_step)** to **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)**



---

archive/issue_events_268903.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-20T10:20:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268903"
}
```



---

archive/issue_events_268904.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "ba6c3e52a42c4a44a8b0267f5e804815b9c82c3b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-01-20T10:20:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18940#event-268904"
}
```



---

archive/issue_comments_266035.json:
```json
{
    "body": "Changed commit from **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)** to none",
    "created_at": "2017-06-11T22:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266035",
    "user": "https://github.com/roed314"
}
```

Changed commit from **[a0600bc](https://github.com/sagemath/sagetrac-mirror/commit/a0600bc0148f3a836cf78f7f81861c150d2c87f0)** to none



---

archive/issue_comments_266036.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@jdemeyer](#comment:41):\n> I can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding\n> \n> ```\n> if start or step is not None:\n>     raise NotImplementedError\n> ```\n> to the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.\n\nFor a use case where deprecating `pol[n:]` is annoying, if you have an Eisenstein polynomial `pol` and want to compute `p/x^n` modulo `pol`, it's natural to express it as `-(pol[n:] >> n) / (pol[:n] // p)`, where the division is taken modulo `pol`.  Obviously, this is doable with lists.",
    "created_at": "2017-06-11T22:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266036",
    "user": "https://github.com/roed314"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@jdemeyer](#comment:41):
> I can confirm that the Sage library doesn't use any polynomial slicing except for truncation `pol[:n]`. After adding
> 
> ```
> if start or step is not None:
>     raise NotImplementedError
> ```
> to the `__getitem__` methods, the only doctest failures were with slicing in the actual doctest example.

For a use case where deprecating `pol[n:]` is annoying, if you have an Eisenstein polynomial `pol` and want to compute `p/x^n` modulo `pol`, it's natural to express it as `-(pol[n:] >> n) / (pol[:n] // p)`, where the division is taken modulo `pol`.  Obviously, this is doable with lists.



---

archive/issue_comments_266037.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nMaybe a different solution would be to re-introduce the slicing but with a different interface (not `__getitem__` but an explicit method).",
    "created_at": "2017-06-12T10:00:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18940",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18940#issuecomment-266037",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:64" align="right">comment:64</div>

Maybe a different solution would be to re-introduce the slicing but with a different interface (not `__getitem__` but an explicit method).
