# Issue 18240: fix MPIR's compliance with c++

archive/issues_018003.json:
```json
{
    "assignees": [],
    "body": "with gcc 4.9.2, we hit this bug:\n\n[Header <cstddef> changes](https://gcc.gnu.org/gcc-4.9/porting_to.html)\nThe <cstddef> header was updated for C++11 support and this breaks some libraries which misuse macros meant for internal use by GCC only. For instance with GMP versions up to 5.1.3, you may see:\n\n```\n/usr/include/c++/4.9.0/cstddef:51:11: error: \u2018::max_align_t\u2019 has not been declared\n   using ::max_align_t;\n```\n\nThis has hit here: #18198, see also [sage-devel thread](https://groups.google.com/d/msg/sage-devel/Tu-egDn-zLw/0S5ouau2J1AJ)\n\nThe workaround suggested by the gcc people appears to work. \n\nCC:  @vbraun @nexttime wbhart\n\nBranch: **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nReviewer: **Jakob Kroeker, Leif Leonhardy**\n\nAuthor: **Dima Pasechnik**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18240_\n\n",
    "closed_at": "2015-04-26T02:21:48Z",
    "created_at": "2015-04-17T14:12:32Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.7",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "fix MPIR's compliance with c++",
    "type": "issue",
    "updated_at": "2015-06-10T09:20:28Z",
    "url": "https://github.com/sagemath/sage/issues/18240",
    "user": "https://github.com/dimpase"
}
```
with gcc 4.9.2, we hit this bug:

[Header <cstddef> changes](https://gcc.gnu.org/gcc-4.9/porting_to.html)
The <cstddef> header was updated for C++11 support and this breaks some libraries which misuse macros meant for internal use by GCC only. For instance with GMP versions up to 5.1.3, you may see:

```
/usr/include/c++/4.9.0/cstddef:51:11: error: ‘::max_align_t’ has not been declared
   using ::max_align_t;
```

This has hit here: #18198, see also [sage-devel thread](https://groups.google.com/d/msg/sage-devel/Tu-egDn-zLw/0S5ouau2J1AJ)

The workaround suggested by the gcc people appears to work. 

CC:  @vbraun @nexttime wbhart

Branch: **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)**

Upstream: **Fixed upstream, in a later stable release.**

Reviewer: **Jakob Kroeker, Leif Leonhardy**

Author: **Dima Pasechnik**

_Issue created by migration from https://trac.sagemath.org/ticket/18240_





---

archive/issue_events_232899.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-17T14:12:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232899"
}
```



---

archive/issue_events_232900.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-17T14:12:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232900"
}
```



---

archive/issue_events_232901.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-17T14:12:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232901"
}
```



---

archive/issue_events_232902.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-17T14:12:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232902"
}
```



---

archive/issue_comments_252504.json:
```json
{
    "body": "Branch: **[u/dimpase/18240](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/18240)**",
    "created_at": "2015-04-17T18:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252504",
    "user": "https://github.com/dimpase"
}
```

Branch: **[u/dimpase/18240](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/18240)**



---

archive/issue_comments_252505.json:
```json
{
    "body": "Commit: **[d358636](https://github.com/sagemath/sagetrac-mirror/commit/d358636766bf0abae69bb07f154053180bd14a8a)**",
    "created_at": "2015-04-17T18:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252505",
    "user": "https://github.com/dimpase"
}
```

Commit: **[d358636](https://github.com/sagemath/sagetrac-mirror/commit/d358636766bf0abae69bb07f154053180bd14a8a)**



---

archive/issue_comments_252506.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2015-04-17T18:10:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252506",
    "user": "https://github.com/dimpase"
}
```

Author: **Dima Pasechnik**



---

archive/issue_events_232903.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-17T18:10:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232903"
}
```



---

archive/issue_comments_252507.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,4 +10,4 @@\n \n This has hit here: #18198, see also [sage-devel thread](https://gcc.gnu.org/gcc-4.9/porting_to.html)\n \n-The workaround suggested appears to work. A patch follows shortly.\n+The workaround suggested by the gcc people appears to work. \n``````\n",
    "created_at": "2015-04-17T18:11:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252507",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,4 +10,4 @@
 
 This has hit here: #18198, see also [sage-devel thread](https://gcc.gnu.org/gcc-4.9/porting_to.html)
 
-The workaround suggested appears to work. A patch follows shortly.
+The workaround suggested by the gcc people appears to work. 
``````




---

archive/issue_events_232904.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-17T18:11:45Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "title_is": "fix MIPR's compliance with c++",
    "title_was": "fix MIPRs compliance with c++",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232904"
}
```



---

archive/issue_events_232905.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-17T18:12:03Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "title_is": "fix MPIR's compliance with c++",
    "title_was": "fix MIPR's compliance with c++",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232905"
}
```



---

archive/issue_comments_252508.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nneedless to say, after pulling in the change, one has to `sage -f mpir` (ideally followed up by `make` -  but this will rebuild half of Sage for nothing, apart from an extra check).",
    "created_at": "2015-04-17T18:16:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252508",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:5'>Comment 5:</a>
needless to say, after pulling in the change, one has to `sage -f mpir` (ideally followed up by `make` -  but this will rebuild half of Sage for nothing, apart from an extra check).



---

archive/issue_events_232906.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-04-19T15:35:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20theory",
    "label_color": "0000ff",
    "label_name": "component: number theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232906"
}
```



---

archive/issue_events_232907.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2015-04-19T15:35:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "000080",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232907"
}
```



---

archive/issue_comments_252509.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nIs that known upstream?\n\n(I recall we had related discussions, but I don't know whether there's already a similar fix.)",
    "created_at": "2015-04-19T15:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252509",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'>Comment 7:</a>
Is that known upstream?

(I recall we had related discussions, but I don't know whether there's already a similar fix.)



---

archive/issue_comments_252510.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nReplying to [@nexttime](#comment%3A7):\n> Is that known upstream?\n\nOoops, saw the \"reported upstream\" too late.\n\nBut isn't there already an upstream patch (or at least an issue on github)?",
    "created_at": "2015-04-19T15:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252510",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'>Comment 8:</a>
Replying to [@nexttime](#comment%3A7):
> Is that known upstream?

Ooops, saw the "reported upstream" too late.

But isn't there already an upstream patch (or at least an issue on github)?



---

archive/issue_comments_252511.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,6 +8,6 @@\n    using ::max_align_t;\n ```\n \n-This has hit here: #18198, see also [sage-devel thread](https://gcc.gnu.org/gcc-4.9/porting_to.html)\n+This has hit here: #18198, see also [sage-devel thread](https://groups.google.com/d/msg/sage-devel/Tu-egDn-zLw/0S5ouau2J1AJ)\n \n The workaround suggested by the gcc people appears to work. \n``````\n",
    "created_at": "2015-04-19T18:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252511",
    "user": "https://github.com/dimpase"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,6 +8,6 @@
    using ::max_align_t;
 ```
 
-This has hit here: #18198, see also [sage-devel thread](https://gcc.gnu.org/gcc-4.9/porting_to.html)
+This has hit here: #18198, see also [sage-devel thread](https://groups.google.com/d/msg/sage-devel/Tu-egDn-zLw/0S5ouau2J1AJ)
 
 The workaround suggested by the gcc people appears to work. 
``````




---

archive/issue_comments_252512.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\n(fixed the link to sage-devel)\n\nmy understanding is that upstream is not in hurry to fix this properly, as it's not easy.",
    "created_at": "2015-04-19T18:27:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252512",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'>Comment 9:</a>
(fixed the link to sage-devel)

my understanding is that upstream is not in hurry to fix this properly, as it's not easy.



---

archive/issue_comments_252513.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nHmmm, I at least haven't found any reply from Bill on mpir-devel, nor any related (open or closed) issue on github (wbhart/mpir).\n\nSo you should probably send some fix upstream as well (and/or open a new issue on github).\n\n(\"Developers acknowledge bug\" -- I'm not sure upstream is really aware of it such that it'll get fixed in the next release.  Bill's pretty busy and there are lots of things he wanted or has to do for the next release IIRC.)\n\n\n\n\nAs `mpirxx.h` includes `mpir.h`, is it really necessary to touch the former as well?",
    "created_at": "2015-04-19T18:42:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252513",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'>Comment 10:</a>
Hmmm, I at least haven't found any reply from Bill on mpir-devel, nor any related (open or closed) issue on github (wbhart/mpir).

So you should probably send some fix upstream as well (and/or open a new issue on github).

("Developers acknowledge bug" -- I'm not sure upstream is really aware of it such that it'll get fixed in the next release.  Bill's pretty busy and there are lots of things he wanted or has to do for the next release IIRC.)




As `mpirxx.h` includes `mpir.h`, is it really necessary to touch the former as well?



---

archive/issue_comments_252514.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nReplying to [@nexttime](#comment%3A10):\n> Hmmm, I at least haven't found any reply from Bill on mpir-devel, nor any related (open or closed) issue on github (wbhart/mpir).\n\nthere is a post: https://groups.google.com/d/msg/mpir-devel/78Hb2-sGrjQ/1VohfbjBmgUJ\n(I suppose that no denial means an acknowledgement)\n\nI just opened an issue on github, too: https://github.com/wbhart/mpir/issues/153\n\n> \n> So you should probably send some fix upstream as well (and/or open a new issue on github).\n> \n> (\"Developers acknowledge bug\" -- I'm not sure upstream is really aware of it such that it'll get fixed in the next release.  Bill's pretty busy and there are lots of things he wanted or has to do for the next release IIRC.)\n> \n> \n> As `mpirxx.h` includes `mpir.h`, is it really necessary to touch the former as well?\n\nthe former need to be touched as `<cstddef>` must be the very 1st include!",
    "created_at": "2015-04-19T18:48:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252514",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:11'>Comment 11:</a>
Replying to [@nexttime](#comment%3A10):
> Hmmm, I at least haven't found any reply from Bill on mpir-devel, nor any related (open or closed) issue on github (wbhart/mpir).

there is a post: https://groups.google.com/d/msg/mpir-devel/78Hb2-sGrjQ/1VohfbjBmgUJ
(I suppose that no denial means an acknowledgement)

I just opened an issue on github, too: https://github.com/wbhart/mpir/issues/153

> 
> So you should probably send some fix upstream as well (and/or open a new issue on github).
> 
> ("Developers acknowledge bug" -- I'm not sure upstream is really aware of it such that it'll get fixed in the next release.  Bill's pretty busy and there are lots of things he wanted or has to do for the next release IIRC.)
> 
> 
> As `mpirxx.h` includes `mpir.h`, is it really necessary to touch the former as well?

the former need to be touched as `<cstddef>` must be the very 1st include!



---

archive/issue_comments_252515.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nReplying to [@dimpase](#comment%3A11):\n> Replying to [@nexttime](#comment%3A10):\n> > Hmmm, I at least haven't found any reply from Bill on mpir-devel, nor any related (open or closed) issue on github (wbhart/mpir).\n\n> \n> there is a post: https://groups.google.com/d/msg/mpir-devel/78Hb2-sGrjQ/1VohfbjBmgUJ\n> (I suppose that no denial means an acknowledgement)\n\n:-)  So this ticket will set itself to \"positive review\" after a while as well...\n\n> I just opened an issue on github, too: https://github.com/wbhart/mpir/issues/153\n\nOk.\n\n\n\n\n> > As `mpirxx.h` includes `mpir.h`, is it really necessary to touch the former as well?\n\n> \n> the former need to be touched as `<cstddef>` must be the very 1st include!\n\nOk, the real problem is that **mpirxx.h** includes mpir.h too late, but it's not the purpose of this ticket to optimize the order of inclusions in MPIR's headers.\n\nStill, I'd remove the `/* for size_t */` when including `cstddef`.  Otherwise looks ok to me, but I can't test this right now.",
    "created_at": "2015-04-19T19:37:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252515",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:12'>Comment 12:</a>
Replying to [@dimpase](#comment%3A11):
> Replying to [@nexttime](#comment%3A10):
> > Hmmm, I at least haven't found any reply from Bill on mpir-devel, nor any related (open or closed) issue on github (wbhart/mpir).

> 
> there is a post: https://groups.google.com/d/msg/mpir-devel/78Hb2-sGrjQ/1VohfbjBmgUJ
> (I suppose that no denial means an acknowledgement)

:-)  So this ticket will set itself to "positive review" after a while as well...

> I just opened an issue on github, too: https://github.com/wbhart/mpir/issues/153

Ok.




> > As `mpirxx.h` includes `mpir.h`, is it really necessary to touch the former as well?

> 
> the former need to be touched as `<cstddef>` must be the very 1st include!

Ok, the real problem is that **mpirxx.h** includes mpir.h too late, but it's not the purpose of this ticket to optimize the order of inclusions in MPIR's headers.

Still, I'd remove the `/* for size_t */` when including `cstddef`.  Otherwise looks ok to me, but I can't test this right now.



---

archive/issue_comments_252516.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nP.S.:  I'd also like to see the patches to both files in a single patch with the issue in its filename, especially since `SPKG.txt` apparently no longer gets updated.",
    "created_at": "2015-04-19T20:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252516",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'>Comment 13:</a>
P.S.:  I'd also like to see the patches to both files in a single patch with the issue in its filename, especially since `SPKG.txt` apparently no longer gets updated.



---

archive/issue_comments_252517.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nOh, this is weird:\n\nWhile with the patches to MPIR 4ti2-1.6.2 now \"finds\" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).\n\nIn the failing builds, GCC complains about\n\n```\n../../src/groebner/VectorArrayAPI.h:144:1: error: redefinition of 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]'\n VectorArrayAPI::convert(const mpz_class& v1, _4ti2_int64_t& v2)\n ^\n../../src/groebner/VectorArrayAPI.h:130:1: error: 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]' previously declared here\n VectorArrayAPI::convert(const mpz_class& v1, long int& v2)\n ^\n```\nmultiple times, where apparently only the last is fatal (= not ignored through Make rules); after the first error other things get built and installed.\n\nThis **might** be related to MPIR as well, but I'm not sure, and I guess you also tested with GCC 4.9.2, so I'm a bit puzzled.",
    "created_at": "2015-04-19T21:45:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252517",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'>Comment 14:</a>
Oh, this is weird:

While with the patches to MPIR 4ti2-1.6.2 now "finds" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).

In the failing builds, GCC complains about

```
../../src/groebner/VectorArrayAPI.h:144:1: error: redefinition of 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]'
 VectorArrayAPI::convert(const mpz_class& v1, _4ti2_int64_t& v2)
 ^
../../src/groebner/VectorArrayAPI.h:130:1: error: 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]' previously declared here
 VectorArrayAPI::convert(const mpz_class& v1, long int& v2)
 ^
```
multiple times, where apparently only the last is fatal (= not ignored through Make rules); after the first error other things get built and installed.

This **might** be related to MPIR as well, but I'm not sure, and I guess you also tested with GCC 4.9.2, so I'm a bit puzzled.



---

archive/issue_comments_252518.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@nexttime](#comment%3A14):\n> Oh, this is weird:\n> \n> While with the patches to MPIR 4ti2-1.6.2 now \"finds\" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).\n\nsorry, what is the compiler you are using?",
    "created_at": "2015-04-19T23:05:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252518",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@nexttime](#comment%3A14):
> Oh, this is weird:
> 
> While with the patches to MPIR 4ti2-1.6.2 now "finds" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).

sorry, what is the compiler you are using?



---

archive/issue_comments_252519.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nThe patch/patches should be documented in the header (free-form text before the first chunk). Not in the filesystem metadata, and not in other files (like SPKG.txt)",
    "created_at": "2015-04-19T23:14:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252519",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:16'>Comment 16:</a>
The patch/patches should be documented in the header (free-form text before the first chunk). Not in the filesystem metadata, and not in other files (like SPKG.txt)



---

archive/issue_comments_252520.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [@dimpase](#comment%3A15):\n> Replying to [@nexttime](#comment%3A14):\n> > Oh, this is weird:\n> > \n> > While with the patches to MPIR 4ti2-1.6.2 now \"finds\" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).\n\n> \n> sorry, what is the compiler you are using?\n\nFSF GCC 4.8.4, FSF GCC 4.9.2, and the first release candidate of FSF GCC 5.0.1, i.e., no versions from distros / all vanilla.",
    "created_at": "2015-04-19T23:15:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252520",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [@dimpase](#comment%3A15):
> Replying to [@nexttime](#comment%3A14):
> > Oh, this is weird:
> > 
> > While with the patches to MPIR 4ti2-1.6.2 now "finds" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).

> 
> sorry, what is the compiler you are using?

FSF GCC 4.8.4, FSF GCC 4.9.2, and the first release candidate of FSF GCC 5.0.1, i.e., no versions from distros / all vanilla.



---

archive/issue_comments_252521.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nReplying to [@vbraun](#comment%3A16):\n> Not in the filesystem metadata, and not in other files (like SPKG.txt)\n\nWell, a \"verbose\" filename *in addition* is also helpful; *which files* get patched can easily be extracted from the patch, and other patches may modify the same file(s).",
    "created_at": "2015-04-19T23:20:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252521",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'>Comment 18:</a>
Replying to [@vbraun](#comment%3A16):
> Not in the filesystem metadata, and not in other files (like SPKG.txt)

Well, a "verbose" filename *in addition* is also helpful; *which files* get patched can easily be extracted from the patch, and other patches may modify the same file(s).



---

archive/issue_comments_252522.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [@nexttime](#comment%3A14):\n> Oh, this is weird:\n> \n> While with the patches to MPIR 4ti2-1.6.2 now \"finds\" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).\n> \n> In the failing builds, GCC complains about\n> \n> ```\n> ../../src/groebner/VectorArrayAPI.h:144:1: error: redefinition of 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]'\n>  VectorArrayAPI::convert(const mpz_class& v1, _4ti2_int64_t& v2)\n>  ^\n> ../../src/groebner/VectorArrayAPI.h:130:1: error: 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]' previously declared here\n>  VectorArrayAPI::convert(const mpz_class& v1, long int& v2)\n>  ^\n> ```\n> multiple times, where apparently only the last is fatal (= not ignored through Make rules); after the first error other things get built and installed.\n> \n> This **might** be related to MPIR as well, but I'm not sure, and I guess you also tested with GCC 4.9.2, so I'm a bit puzzled.\n> \n\nI don't see any errors in my `logs/pkg/4ti2.log` with Sage's gcc 4.9.2 (neither on several versions of Linux x64 or i386, nor on OSX 10.10.3). Unless you can explain how to reproduce your problem, I don't think I can do anything with this.",
    "created_at": "2015-04-20T07:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252522",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [@nexttime](#comment%3A14):
> Oh, this is weird:
> 
> While with the patches to MPIR 4ti2-1.6.2 now "finds" GMP (i.e., MPIR), it doesn't build for me (on Sage 6.6) with GCC 4.8.4 nor 4.9.2, but 5.0.1 (RC1).
> 
> In the failing builds, GCC complains about
> 
> ```
> ../../src/groebner/VectorArrayAPI.h:144:1: error: redefinition of 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]'
>  VectorArrayAPI::convert(const mpz_class& v1, _4ti2_int64_t& v2)
>  ^
> ../../src/groebner/VectorArrayAPI.h:130:1: error: 'static void _4ti2_::VectorArrayAPI::convert(const T1&, T2&) [with T1 = __gmp_expr<__mpz_struct [1], __mpz_struct [1]>; T2 = long int]' previously declared here
>  VectorArrayAPI::convert(const mpz_class& v1, long int& v2)
>  ^
> ```
> multiple times, where apparently only the last is fatal (= not ignored through Make rules); after the first error other things get built and installed.
> 
> This **might** be related to MPIR as well, but I'm not sure, and I guess you also tested with GCC 4.9.2, so I'm a bit puzzled.
> 

I don't see any errors in my `logs/pkg/4ti2.log` with Sage's gcc 4.9.2 (neither on several versions of Linux x64 or i386, nor on OSX 10.10.3). Unless you can explain how to reproduce your problem, I don't think I can do anything with this.



---

archive/issue_comments_252523.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nI don't think either that this is connected with MPIR\n\nofftopic:\nI see the same redefinition error as above when trying to build recent Macaulay2 on Fedora21 64 bit\n\nIt must be the case that '_4ti2_HAVE_MPZ_INT64_CONVERSION' for whatever reasons is not defined\n(and '_4ti2_int64_t' is probably the same as a 'long int' on a 64 bit, causing the redefinition error)",
    "created_at": "2015-04-24T23:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252523",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<a id='comment:20'>Comment 20:</a>
I don't think either that this is connected with MPIR

offtopic:
I see the same redefinition error as above when trying to build recent Macaulay2 on Fedora21 64 bit

It must be the case that '_4ti2_HAVE_MPZ_INT64_CONVERSION' for whatever reasons is not defined
(and '_4ti2_int64_t' is probably the same as a 'long int' on a 64 bit, causing the redefinition error)



---

archive/issue_comments_252524.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\nReplying to [jakobkroeker](#comment%3A20):\n> I don't think either that this is connected with MPIR\n\n\"either\"? Which comment are you replying to? It's not clear to me, sorry...",
    "created_at": "2015-04-25T00:18:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252524",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:21'>Comment 21:</a>
Replying to [jakobkroeker](#comment%3A20):
> I don't think either that this is connected with MPIR

"either"? Which comment are you replying to? It's not clear to me, sorry...



---

archive/issue_comments_252525.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\n> \"either\"? Which comment are you replying to? It's not clear to me, sorry...\n\n I just misreaded comment 19, it is probably too late for me, sorry. Drop 'either'.\n\n@nexttime\nit seems that the HAVE_MPZ_INT64_CONVERSION check by the configure script fails in case \ng++ is used without enabling c++ 2011 standard. When using g++ with '-std=c++11'  flag (or similar), the  HAVE_MPZ_INT64_CONVERSION check should succeed and define '_4ti2_HAVE_MPZ_INT64_CONVERSION'.\nPlease check if that is indeed the case.",
    "created_at": "2015-04-25T00:31:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252525",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

<a id='comment:22'>Comment 22:</a>
> "either"? Which comment are you replying to? It's not clear to me, sorry...

 I just misreaded comment 19, it is probably too late for me, sorry. Drop 'either'.

@nexttime
it seems that the HAVE_MPZ_INT64_CONVERSION check by the configure script fails in case 
g++ is used without enabling c++ 2011 standard. When using g++ with '-std=c++11'  flag (or similar), the  HAVE_MPZ_INT64_CONVERSION check should succeed and define '_4ti2_HAVE_MPZ_INT64_CONVERSION'.
Please check if that is indeed the case.



---

archive/issue_comments_252526.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967\">933c5c5</a></td><td><code>merged patch files, renamed...</code></td></tr></table>\n",
    "created_at": "2015-04-25T00:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252526",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:23'>Comment 23:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967">933c5c5</a></td><td><code>merged patch files, renamed...</code></td></tr></table>




---

archive/issue_comments_252527.json:
```json
{
    "body": "Changed commit from **[d358636](https://github.com/sagemath/sagetrac-mirror/commit/d358636766bf0abae69bb07f154053180bd14a8a)** to **[933c5c5](https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967)**",
    "created_at": "2015-04-25T00:36:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252527",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d358636](https://github.com/sagemath/sagetrac-mirror/commit/d358636766bf0abae69bb07f154053180bd14a8a)** to **[933c5c5](https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967)**



---

archive/issue_events_232908.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-25T00:46:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232908"
}
```



---

archive/issue_events_232909.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-25T00:46:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232909"
}
```



---

archive/issue_comments_252528.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nReplying to [git](#comment%3A23):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967\">933c5c5</a></td><td><code>merged patch files, renamed...</code></td></tr></table>\n\noops, I messed up.",
    "created_at": "2015-04-25T00:46:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252528",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:24'>Comment 24:</a>
Replying to [git](#comment%3A23):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967">933c5c5</a></td><td><code>merged patch files, renamed...</code></td></tr></table>

oops, I messed up.



---

archive/issue_comments_252529.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967\">933c5c5</a></td><td><code>merged patch files, renamed...</code></td></tr></table>\n",
    "created_at": "2015-04-25T05:54:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252529",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:25'>Comment 25:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967">933c5c5</a></td><td><code>merged patch files, renamed...</code></td></tr></table>




---

archive/issue_comments_252530.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47\">6785ef2</a></td><td><code>restored wrongly removed file, and deleted one that should have gone</code></td></tr></table>\n",
    "created_at": "2015-04-25T06:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252530",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:26'>Comment 26:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47">6785ef2</a></td><td><code>restored wrongly removed file, and deleted one that should have gone</code></td></tr></table>




---

archive/issue_comments_252531.json:
```json
{
    "body": "Changed commit from **[933c5c5](https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967)** to **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)**",
    "created_at": "2015-04-25T06:04:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252531",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[933c5c5](https://github.com/sagemath/sagetrac-mirror/commit/933c5c587943027944e226bc3b3b80181f22e967)** to **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)**



---

archive/issue_comments_252532.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nfixed the error in the previous commit. Ready for review now.",
    "created_at": "2015-04-25T06:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252532",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:27'>Comment 27:</a>
fixed the error in the previous commit. Ready for review now.



---

archive/issue_events_232910.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-25T06:08:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232910"
}
```



---

archive/issue_events_232911.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-25T06:08:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232911"
}
```



---

archive/issue_comments_252533.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nReplying to [jakobkroeker](#comment%3A22):\n> @nexttime\n> it seems that the HAVE_MPZ_INT64_CONVERSION check by the configure script fails in case \n> g++ is used without enabling c++ 2011 standard. When using g++ with '-std=c++11'  flag (or similar), the  HAVE_MPZ_INT64_CONVERSION check should succeed and define '_4ti2_HAVE_MPZ_INT64_CONVERSION'.\n> Please check if that is indeed the case.\n\nFWIW, **without** setting any `CXXFLAGS` (just from the logs),\n\nwith GCC 4.8:\n\n```\n...\nchecking whether C++ compiler accepts -std=c++0x... yes\nchecking whether C++ compiler accepts -ftrapv... yes\nchecking whether -ftrapv actually seems to work for int... no\nchecking whether -ftrapv actually seems to work for long long... no\n...\nchecking whether we can use the int32_t and int64_t types... yes\nchecking whether we can convert between int32_t and mpz_class... no\nchecking whether we can convert between int64_t and mpz_class... no\n...\n```\n\nWith GCC 4.9:\n\n```\n...\nchecking whether C++ compiler accepts -std=c++0x... yes\nchecking whether C++ compiler accepts -ftrapv... yes\nchecking whether -ftrapv actually seems to work for int... no\nchecking whether -ftrapv actually seems to work for long long... no\n...\nchecking whether we can use the int32_t and int64_t types... yes\nchecking whether we can convert between int32_t and mpz_class... no\nchecking whether we can convert between int64_t and mpz_class... no\n...\n```\n\nWith GCC 5.1:\n\n```\n...\nchecking whether C++ compiler accepts -std=c++0x... yes\nchecking whether C++ compiler accepts -ftrapv... yes\nchecking whether -ftrapv actually seems to work for int... yes\nchecking whether -ftrapv actually seems to work for long long... no\n...\nchecking whether we can use the int32_t and int64_t types... yes\nchecking whether we can convert between int32_t and mpz_class... yes\nchecking whether we can convert between int64_t and mpz_class... yes\n...\n```\n\nIn all cases, the C++ sources are compiled with `-std=c++0x` by the way, and\n\n```sh\n$ for v in 4.4 4.8 4.9 5.0 5.1; do echo -n \"g++ $v:  \"; g++-$v -E -dM -x c++ -std=c++0x /dev/null | grep __cplusplus; done\ng++ 4.4:  #define __cplusplus 1\ng++ 4.8:  #define __cplusplus 201103L\ng++ 4.9:  #define __cplusplus 201103L\ng++ 5.0:  #define __cplusplus 201103L\ng++ 5.1:  #define __cplusplus 201103L\n```\nso there doesn't seem to be any difference (in case the version is checked in the source files).\n\n\n\n\nHaven't digged deeper yet.  (Should take a look at the `config.log`s, and `configure`.)",
    "created_at": "2015-04-25T15:34:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252533",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:28'>Comment 28:</a>
Replying to [jakobkroeker](#comment%3A22):
> @nexttime
> it seems that the HAVE_MPZ_INT64_CONVERSION check by the configure script fails in case 
> g++ is used without enabling c++ 2011 standard. When using g++ with '-std=c++11'  flag (or similar), the  HAVE_MPZ_INT64_CONVERSION check should succeed and define '_4ti2_HAVE_MPZ_INT64_CONVERSION'.
> Please check if that is indeed the case.

FWIW, **without** setting any `CXXFLAGS` (just from the logs),

with GCC 4.8:

```
...
checking whether C++ compiler accepts -std=c++0x... yes
checking whether C++ compiler accepts -ftrapv... yes
checking whether -ftrapv actually seems to work for int... no
checking whether -ftrapv actually seems to work for long long... no
...
checking whether we can use the int32_t and int64_t types... yes
checking whether we can convert between int32_t and mpz_class... no
checking whether we can convert between int64_t and mpz_class... no
...
```

With GCC 4.9:

```
...
checking whether C++ compiler accepts -std=c++0x... yes
checking whether C++ compiler accepts -ftrapv... yes
checking whether -ftrapv actually seems to work for int... no
checking whether -ftrapv actually seems to work for long long... no
...
checking whether we can use the int32_t and int64_t types... yes
checking whether we can convert between int32_t and mpz_class... no
checking whether we can convert between int64_t and mpz_class... no
...
```

With GCC 5.1:

```
...
checking whether C++ compiler accepts -std=c++0x... yes
checking whether C++ compiler accepts -ftrapv... yes
checking whether -ftrapv actually seems to work for int... yes
checking whether -ftrapv actually seems to work for long long... no
...
checking whether we can use the int32_t and int64_t types... yes
checking whether we can convert between int32_t and mpz_class... yes
checking whether we can convert between int64_t and mpz_class... yes
...
```

In all cases, the C++ sources are compiled with `-std=c++0x` by the way, and

```sh
$ for v in 4.4 4.8 4.9 5.0 5.1; do echo -n "g++ $v:  "; g++-$v -E -dM -x c++ -std=c++0x /dev/null | grep __cplusplus; done
g++ 4.4:  #define __cplusplus 1
g++ 4.8:  #define __cplusplus 201103L
g++ 4.9:  #define __cplusplus 201103L
g++ 5.0:  #define __cplusplus 201103L
g++ 5.1:  #define __cplusplus 201103L
```
so there doesn't seem to be any difference (in case the version is checked in the source files).




Haven't digged deeper yet.  (Should take a look at the `config.log`s, and `configure`.)



---

archive/issue_comments_252534.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nReplying to [@nexttime](#comment%3A28):\n> Replying to [jakobkroeker](#comment%3A22):\n> > it seems that the HAVE_MPZ_INT64_CONVERSION check by the configure script fails in case \n> > g++ is used without enabling c++ 2011 standard. When using g++ with '-std=c++11'  flag (or similar), the  HAVE_MPZ_INT64_CONVERSION check should succeed and define '_4ti2_HAVE_MPZ_INT64_CONVERSION'.\n\nAs posted, they fail, but for a different reason... (see below)\n\n> Haven't digged deeper yet.  (Should take a look at the `config.log`s, and `configure`.)\n\nOk, sorry, my bad:  I had only rebuilt MPIR with GCC 5.1, and so 4ti2's conversion checks failed with the earlier versions (4.8.4 and 4.9.2) due to a rather unrelated linker error.\n\n\n\n\nDima, if nobody objects, I think you can set the ticket to positive review.  (Although \"GCC 4.9 work-around\" stills seems a bit misleading, as it's not a compiler bug. ;-) )",
    "created_at": "2015-04-25T16:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252534",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:29'>Comment 29:</a>
Replying to [@nexttime](#comment%3A28):
> Replying to [jakobkroeker](#comment%3A22):
> > it seems that the HAVE_MPZ_INT64_CONVERSION check by the configure script fails in case 
> > g++ is used without enabling c++ 2011 standard. When using g++ with '-std=c++11'  flag (or similar), the  HAVE_MPZ_INT64_CONVERSION check should succeed and define '_4ti2_HAVE_MPZ_INT64_CONVERSION'.

As posted, they fail, but for a different reason... (see below)

> Haven't digged deeper yet.  (Should take a look at the `config.log`s, and `configure`.)

Ok, sorry, my bad:  I had only rebuilt MPIR with GCC 5.1, and so 4ti2's conversion checks failed with the earlier versions (4.8.4 and 4.9.2) due to a rather unrelated linker error.




Dima, if nobody objects, I think you can set the ticket to positive review.  (Although "GCC 4.9 work-around" stills seems a bit misleading, as it's not a compiler bug. ;-) )



---

archive/issue_comments_252535.json:
```json
{
    "body": "Reviewer: **Jakob Kroeker, Leif Leonhardy**",
    "created_at": "2015-04-25T16:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252535",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **Jakob Kroeker, Leif Leonhardy**



---

archive/issue_events_232912.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-25T19:39:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232912"
}
```



---

archive/issue_events_232913.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-04-25T19:39:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232913"
}
```



---

archive/issue_comments_252536.json:
```json
{
    "body": "Changed branch from **[u/dimpase/18240](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/18240)** to **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)**",
    "created_at": "2015-04-26T02:21:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252536",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/dimpase/18240](https://github.com/sagemath/sagetrac-mirror/tree/u/dimpase/18240)** to **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)**



---

archive/issue_events_232914.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-26T02:21:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232914"
}
```



---

archive/issue_events_232915.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "5b5a4c0d4d0ea81489406cf284b1c707c1cc6572",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-04-26T02:21:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18240#event-232915"
}
```



---

archive/issue_comments_252537.json:
```json
{
    "body": "Changed commit from **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)** to none",
    "created_at": "2015-06-10T09:20:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252537",
    "user": "https://github.com/dimpase"
}
```

Changed commit from **[6785ef2](https://github.com/sagemath/sagetrac-mirror/commit/6785ef2000d220f511fcf3e9830b05099500ef47)** to none



---

archive/issue_comments_252538.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nplease see an update on https://github.com/wbhart/mpir/issues/153",
    "created_at": "2015-06-10T09:20:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252538",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:32'>Comment 32:</a>
please see an update on https://github.com/wbhart/mpir/issues/153



---

archive/issue_comments_252539.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2015-06-10T09:20:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18240",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18240#issuecomment-252539",
    "user": "https://github.com/dimpase"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, in a later stable release.**
