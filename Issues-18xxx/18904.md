# Issue 18904: Automatically test optional non-packages (CPLEX, Gurobi, Maple?, ..)

archive/issues_018667.json:
```json
{
    "assignees": [],
    "body": "With this branch, the default value of `--optional` in `sage -t` is larger than the list of installed new-style optional packages.\n\nIn particular, `cplex` and `gurobi` (which are not optional packages as they are proprietary) are added to the list (some tests are too slow to be run with glpk, e.g. #18871).\n\nMore can be added to that list. If you know a better way to implement it, I am all ears.\n\nNathann\n\nsage-devel thread: https://groups.google.com/d/topic/sage-devel/M98nD7833KM/discussion\n\n\n**Currently handles** Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.\n\n(mathematica cannot be included before #18908 is fixed)\n\nCC:  @vbraun @jdemeyer @dcoudert\n\nBranch/Commit: **[public/18904](https://github.com/sagemath/sagetrac-mirror/tree/public/18904) @ [`b7213ef`](https://github.com/sagemath/sagetrac-mirror/commit/b7213efaf806139f42c9f6b8d3b354c4dbf05047)**\n\nReviewer: **Kwankyu Lee**\n\nAuthor: **Nathann Cohen**\n\nComponent: **doctest framework**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18904_\n\n",
    "closed_at": "2016-06-12T12:02:30Z",
    "created_at": "2015-07-15T09:36:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/invalid"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Automatically test optional non-packages (CPLEX, Gurobi, Maple?, ..)",
    "type": "issue",
    "updated_at": "2016-06-12T12:02:30Z",
    "url": "https://github.com/sagemath/sage/issues/18904",
    "user": "https://github.com/nathanncohen"
}
```
With this branch, the default value of `--optional` in `sage -t` is larger than the list of installed new-style optional packages.

In particular, `cplex` and `gurobi` (which are not optional packages as they are proprietary) are added to the list (some tests are too slow to be run with glpk, e.g. #18871).

More can be added to that list. If you know a better way to implement it, I am all ears.

Nathann

sage-devel thread: https://groups.google.com/d/topic/sage-devel/M98nD7833KM/discussion


**Currently handles** Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.

(mathematica cannot be included before #18908 is fixed)

CC:  @vbraun @jdemeyer @dcoudert

Branch/Commit: **[public/18904](https://github.com/sagemath/sagetrac-mirror/tree/public/18904) @ [`b7213ef`](https://github.com/sagemath/sagetrac-mirror/commit/b7213efaf806139f42c9f6b8d3b354c4dbf05047)**

Reviewer: **Kwankyu Lee**

Author: **Nathann Cohen**

Component: **doctest framework**

_Issue created by migration from https://trac.sagemath.org/ticket/18904_





---

archive/issue_events_268350.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-15T09:36:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268350"
}
```



---

archive/issue_events_268351.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-15T09:36:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20doctest%20framework",
    "label_color": "000080",
    "label_name": "c: doctest framework",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268351"
}
```



---

archive/issue_events_268352.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-15T09:36:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268352"
}
```



---

archive/issue_events_268353.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-15T09:36:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268353"
}
```



---

archive/issue_comments_264776.json:
```json
{
    "body": "Branch: **[public/18904](https://github.com/sagemath/sagetrac-mirror/tree/public/18904)**",
    "created_at": "2015-07-15T09:36:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264776",
    "user": "https://github.com/nathanncohen"
}
```

Branch: **[public/18904](https://github.com/sagemath/sagetrac-mirror/tree/public/18904)**



---

archive/issue_comments_264777.json:
```json
{
    "body": "Commit: **[`ef53635`](https://github.com/sagemath/sagetrac-mirror/commit/ef53635ae85dbc5afdfd2128c7238bd404321d97)**",
    "created_at": "2015-07-15T09:36:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264777",
    "user": "https://github.com/nathanncohen"
}
```

Commit: **[`ef53635`](https://github.com/sagemath/sagetrac-mirror/commit/ef53635ae85dbc5afdfd2128c7238bd404321d97)**



---

archive/issue_events_268354.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-15T09:36:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268354"
}
```



---

archive/issue_comments_264778.json:
```json
{
    "body": "<div id=\"comment:1\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ef53635ae85dbc5afdfd2128c7238bd404321d97\"><code>ef53635</code></a></td><td><code>trac #18904: Automatically test optional non-packages (CPLEX, Gurobi, Maple?, ..)</code></td></tr></table>\n",
    "created_at": "2015-07-15T09:36:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264778",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:1"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ef53635ae85dbc5afdfd2128c7238bd404321d97"><code>ef53635</code></a></td><td><code>trac #18904: Automatically test optional non-packages (CPLEX, Gurobi, Maple?, ..)</code></td></tr></table>




---

archive/issue_comments_264779.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIMHO you should have to explicitly specify the optional packages that we don't distribute (and, therefore, don't know whether they are of a suitable version or working at all, or that the user has a license to start them, etc).",
    "created_at": "2015-07-15T09:40:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264779",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:2" align="right">comment:2</div>

IMHO you should have to explicitly specify the optional packages that we don't distribute (and, therefore, don't know whether they are of a suitable version or working at all, or that the user has a license to start them, etc).



---

archive/issue_comments_264780.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\n> IMHO you should have to explicitly specify the optional packages that we don't distribute (and, therefore, don't know whether they are of a suitable version or working at all, or that the user has a license to start them, etc). \n\nI am not sure that I understand what you propose. Do you want to have somewhere a list of the packages that we do nto distribute, along with a list of functions testing if they can be used (e.g. detect licenses)? In which file, and how?\n\nFor CPLEX and Gurobi, the tests I used handle the case when the license is wrong.\n\n```\nsage: MixedIntegerLinearProgram(solver='gurobi')\n...\nMIPSolverException: 'Gurobi: HostID mismatch (licensed to 52332a80, hostid is 230063bf) (GRB_ERROR_NO_LICENSE)'\n```\n\nNathann",
    "created_at": "2015-07-15T09:47:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264780",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:3" align="right">comment:3</div>

> IMHO you should have to explicitly specify the optional packages that we don't distribute (and, therefore, don't know whether they are of a suitable version or working at all, or that the user has a license to start them, etc). 

I am not sure that I understand what you propose. Do you want to have somewhere a list of the packages that we do nto distribute, along with a list of functions testing if they can be used (e.g. detect licenses)? In which file, and how?

For CPLEX and Gurobi, the tests I used handle the case when the license is wrong.

```
sage: MixedIntegerLinearProgram(solver='gurobi')
...
MIPSolverException: 'Gurobi: HostID mismatch (licensed to 52332a80, hostid is 230063bf) (GRB_ERROR_NO_LICENSE)'
```

Nathann



---

archive/issue_comments_264781.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nsay **NO** to blind copy/paste! Do\n\n```\n           for sol in [\"cplex\", \"gurobi\"]:\n                try:\n                    MixedIntegerLinearProgram(solver=sol)\n                        options.optional.add(sol)\n                    except:\n                        pass\n```",
    "created_at": "2015-07-15T10:25:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264781",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

say **NO** to blind copy/paste! Do

```
           for sol in ["cplex", "gurobi"]:
                try:
                    MixedIntegerLinearProgram(solver=sol)
                        options.optional.add(sol)
                    except:
                        pass
```



---

archive/issue_comments_264782.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n> say **NO** to blind copy/paste! Do\n\nProposing a commit is the trendy way to say *I care*.",
    "created_at": "2015-07-15T10:26:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264782",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:5" align="right">comment:5</div>

> say **NO** to blind copy/paste! Do

Proposing a commit is the trendy way to say *I care*.



---

archive/issue_comments_264783.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nEr... I could have done better: \"Nothing says 'I care' like 'here is a commit'\".",
    "created_at": "2015-07-15T10:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264783",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:6" align="right">comment:6</div>

Er... I could have done better: "Nothing says 'I care' like 'here is a commit'".



---

archive/issue_comments_264784.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nBut I'd need write access to your brain then...",
    "created_at": "2015-07-15T10:33:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264784",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

But I'd need write access to your brain then...



---

archive/issue_comments_264785.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\n> But I'd need write access to your brain then...\n\nI am sure that you can manage with a write access to public/*.",
    "created_at": "2015-07-15T10:35:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264785",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:8" align="right">comment:8</div>

> But I'd need write access to your brain then...

I am sure that you can manage with a write access to public/*.



---

archive/issue_comments_264786.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@nathanncohen](#comment:8):\n> > But I'd need write access to your brain then...\n\n> \n> I am sure that you can manage with a write access to public/*.\n\ndo you pull from public opinion at all?",
    "created_at": "2015-07-15T11:28:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264786",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@nathanncohen](#comment:8):
> > But I'd need write access to your brain then...

> 
> I am sure that you can manage with a write access to public/*.

do you pull from public opinion at all?



---

archive/issue_comments_264787.json:
```json
{
    "body": "Changed commit from **[`ef53635`](https://github.com/sagemath/sagetrac-mirror/commit/ef53635ae85dbc5afdfd2128c7238bd404321d97)** to **[`091ed73`](https://github.com/sagemath/sagetrac-mirror/commit/091ed73139ddc886260854e59499eb0e5eca9e91)**",
    "created_at": "2015-07-15T13:17:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264787",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`ef53635`](https://github.com/sagemath/sagetrac-mirror/commit/ef53635ae85dbc5afdfd2128c7238bd404321d97)** to **[`091ed73`](https://github.com/sagemath/sagetrac-mirror/commit/091ed73139ddc886260854e59499eb0e5eca9e91)**



---

archive/issue_comments_264788.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/091ed73139ddc886260854e59499eb0e5eca9e91\"><code>091ed73</code></a></td><td><code>trac #18904: More optional softwares</code></td></tr></table>\n",
    "created_at": "2015-07-15T13:17:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264788",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/091ed73139ddc886260854e59499eb0e5eca9e91"><code>091ed73</code></a></td><td><code>trac #18904: More optional softwares</code></td></tr></table>




---

archive/issue_comments_264789.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nMore interfaces. As I needed a loop for the others, I also converted the MILP test as a loop.\n\nStill ugly, so if somebody has a nice idea to rewrite it better.. `:-/`\n\nNathann",
    "created_at": "2015-07-15T13:18:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264789",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:11" align="right">comment:11</div>

More interfaces. As I needed a loop for the others, I also converted the MILP test as a loop.

Still ugly, so if somebody has a nice idea to rewrite it better.. `:-/`

Nathann



---

archive/issue_comments_264790.json:
```json
{
    "body": "Changed commit from **[`091ed73`](https://github.com/sagemath/sagetrac-mirror/commit/091ed73139ddc886260854e59499eb0e5eca9e91)** to **[`9a011eb`](https://github.com/sagemath/sagetrac-mirror/commit/9a011eb0a49a3041ae8574e9ce760a8556516417)**",
    "created_at": "2015-07-15T13:21:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264790",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`091ed73`](https://github.com/sagemath/sagetrac-mirror/commit/091ed73139ddc886260854e59499eb0e5eca9e91)** to **[`9a011eb`](https://github.com/sagemath/sagetrac-mirror/commit/9a011eb0a49a3041ae8574e9ce760a8556516417)**



---

archive/issue_comments_264791.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a011eb0a49a3041ae8574e9ce760a8556516417\"><code>9a011eb</code></a></td><td><code>trac #18904: More optional softwares</code></td></tr></table>\n",
    "created_at": "2015-07-15T13:21:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264791",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a011eb0a49a3041ae8574e9ce760a8556516417"><code>9a011eb</code></a></td><td><code>trac #18904: More optional softwares</code></td></tr></table>




---

archive/issue_comments_264792.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@nathanncohen](#comment:11):\n> More interfaces. As I needed a loop for the others, I also converted the MILP test as a loop.\n> \n> Still ugly, so if somebody has a nice idea to rewrite it better.. `:-/`\n\nnot tested (don't know how to test that script in `sage/doctests`):\n\n```python\n        def tryer(s):\n            exec('from sage.interfaces.'+s+' import '+s)\n            try:\n                eval(s+'(1)')\n                options.optional.add(s)\n            except:\n                pass\n\n        for stuff in ['matlab', 'maple', 'macaulay2', 'octave', 'scilab']:\n            tryer(stuff)\n```",
    "created_at": "2015-07-15T13:51:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264792",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@nathanncohen](#comment:11):
> More interfaces. As I needed a loop for the others, I also converted the MILP test as a loop.
> 
> Still ugly, so if somebody has a nice idea to rewrite it better.. `:-/`

not tested (don't know how to test that script in `sage/doctests`):

```python
        def tryer(s):
            exec('from sage.interfaces.'+s+' import '+s)
            try:
                eval(s+'(1)')
                options.optional.add(s)
            except:
                pass

        for stuff in ['matlab', 'maple', 'macaulay2', 'octave', 'scilab']:
            tryer(stuff)
```



---

archive/issue_comments_264793.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n> not tested (don't know how to test that script in `sage/doctests`):\n\nI thought that I would be hung if I attempted something like that.\n\nNathann",
    "created_at": "2015-07-15T13:52:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264793",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:14" align="right">comment:14</div>

> not tested (don't know how to test that script in `sage/doctests`):

I thought that I would be hung if I attempted something like that.

Nathann



---

archive/issue_comments_264794.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@nathanncohen](#comment:14):\n> > not tested (don't know how to test that script in `sage/doctests`):\n\n> \n> I thought that I would be hung if I attempted something like that.\n\nno, to the contrary - cool programmers don't write runnable code, they write code that writes runnable code :-)",
    "created_at": "2015-07-15T14:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264794",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@nathanncohen](#comment:14):
> > not tested (don't know how to test that script in `sage/doctests`):

> 
> I thought that I would be hung if I attempted something like that.

no, to the contrary - cool programmers don't write runnable code, they write code that writes runnable code :-)



---

archive/issue_comments_264795.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n> no, to the contrary - cool programmers don't write runnable code, they write code that writes runnable code :-)\n\nWell, considering how ugly my version is, perhaps it is comparatively better. Let's see what Jeroen and Volker think of it.\n\nNathann",
    "created_at": "2015-07-15T14:04:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264795",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:16" align="right">comment:16</div>

> no, to the contrary - cool programmers don't write runnable code, they write code that writes runnable code :-)

Well, considering how ugly my version is, perhaps it is comparatively better. Let's see what Jeroen and Volker think of it.

Nathann



---

archive/issue_comments_264796.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,3 +5,5 @@\n More can be added to that list. If you know a better way to implement it, I am all ears.\n \n Nathann\n+\n+Current softwares handled: Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.\n``````\n",
    "created_at": "2015-07-15T14:19:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264796",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,3 +5,5 @@
 More can be added to that list. If you know a better way to implement it, I am all ears.
 
 Nathann
+
+Current softwares handled: Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.
``````




---

archive/issue_comments_264797.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,6 @@\n \n Nathann\n \n-Current softwares handled: Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.\n+**Currently handles** Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.\n+\n+(mathematica cannot be included before #18908 is fixed)\n``````\n",
    "created_at": "2015-07-15T15:27:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264797",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,6 @@
 
 Nathann
 
-Current softwares handled: Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.
+**Currently handles** Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.
+
+(mathematica cannot be included before #18908 is fixed)
``````




---

archive/issue_events_268355.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T09:11:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268355"
}
```



---

archive/issue_events_268356.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T09:11:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268356"
}
```



---

archive/issue_comments_264798.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nAre we sure that we actually *want* to do this? We have no control over those external packages. What if somebody has `magma` but with a version that is not fully compatible with Sage? With Sage's optional packages, that issue does not occur since we have full control over those packages.\n\nA few comments on the code:\n1. Never use `except:`. Use `except Exception:` or some other specific exception class.\n2. Code structure: can we please move all this detect-optional-packages code to a separate function?\n3. Performance: how much time does it take to run all those tests? Note that #13540 has a system for \"lazy\" checking of optional dependencies: the check for a given package is only done if we are actually running a test involving that package.",
    "created_at": "2015-07-16T09:11:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264798",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

Are we sure that we actually *want* to do this? We have no control over those external packages. What if somebody has `magma` but with a version that is not fully compatible with Sage? With Sage's optional packages, that issue does not occur since we have full control over those packages.

A few comments on the code:
1. Never use `except:`. Use `except Exception:` or some other specific exception class.
2. Code structure: can we please move all this detect-optional-packages code to a separate function?
3. Performance: how much time does it take to run all those tests? Note that #13540 has a system for "lazy" checking of optional dependencies: the check for a given package is only done if we are actually running a test involving that package.



---

archive/issue_comments_264799.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n> Are we sure that we actually *want* to do this?\n\nIf you oppose the changes involving `Maple/Matlab` and others then I do not mind removing them for you. We can keep Gurobi and CPLEX for they are only used by Sage if the user explicitly linked them with it.\n\n> 1. Never use `except:`. Use `except Exception:` or some other specific exception class.\n\nI thought that here it was pretty safe: I do not want this test to ever break, and if there is something wrong with the mathematica/maple/... interface, then other doctests will have to report it.\n\n> 2. Code structure: can we please move all this detect-optional-packages code to a separate function?\n\nI will add a commit.\n\n> 3. Performance: how much time does it take to run all those tests?\n\nAlmost nothing, give it a try. That's clearly negligible against the time it takes to run the `sage -b` part of `sage -btp`.\n\n> Note that #13540 has a system for \"lazy\" checking of optional dependencies\n\nI do not see a need for that given the time it takes to run those tests. Especially, if you want the maple/matlab/others to be removed from the list.\n\nNathann",
    "created_at": "2015-07-16T09:16:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264799",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:20" align="right">comment:20</div>

> Are we sure that we actually *want* to do this?

If you oppose the changes involving `Maple/Matlab` and others then I do not mind removing them for you. We can keep Gurobi and CPLEX for they are only used by Sage if the user explicitly linked them with it.

> 1. Never use `except:`. Use `except Exception:` or some other specific exception class.

I thought that here it was pretty safe: I do not want this test to ever break, and if there is something wrong with the mathematica/maple/... interface, then other doctests will have to report it.

> 2. Code structure: can we please move all this detect-optional-packages code to a separate function?

I will add a commit.

> 3. Performance: how much time does it take to run all those tests?

Almost nothing, give it a try. That's clearly negligible against the time it takes to run the `sage -b` part of `sage -btp`.

> Note that #13540 has a system for "lazy" checking of optional dependencies

I do not see a need for that given the time it takes to run those tests. Especially, if you want the maple/matlab/others to be removed from the list.

Nathann



---

archive/issue_comments_264800.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAlso, do you object my removing the code that checks that the installed version of an optional package is indeed the latest? Now that they are automatically updated, that's rather useless.",
    "created_at": "2015-07-16T09:18:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264800",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:21" align="right">comment:21</div>

Also, do you object my removing the code that checks that the installed version of an optional package is indeed the latest? Now that they are automatically updated, that's rather useless.



---

archive/issue_comments_264801.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/698ebe958d528ac279601e0acbbf0c16f00350de\"><code>698ebe9</code></a></td><td><code>trac #18904: Automatically test optional non-packages (CPLEX, Gurobi, Maple?, ..)</code></td></tr></table>\n",
    "created_at": "2015-07-16T09:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264801",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/698ebe958d528ac279601e0acbbf0c16f00350de"><code>698ebe9</code></a></td><td><code>trac #18904: Automatically test optional non-packages (CPLEX, Gurobi, Maple?, ..)</code></td></tr></table>




---

archive/issue_comments_264802.json:
```json
{
    "body": "Changed commit from **[`9a011eb`](https://github.com/sagemath/sagetrac-mirror/commit/9a011eb0a49a3041ae8574e9ce760a8556516417)** to **[`698ebe9`](https://github.com/sagemath/sagetrac-mirror/commit/698ebe958d528ac279601e0acbbf0c16f00350de)**",
    "created_at": "2015-07-16T09:36:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264802",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`9a011eb`](https://github.com/sagemath/sagetrac-mirror/commit/9a011eb0a49a3041ae8574e9ce760a8556516417)** to **[`698ebe9`](https://github.com/sagemath/sagetrac-mirror/commit/698ebe958d528ac279601e0acbbf0c16f00350de)**



---

archive/issue_comments_264803.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nhow about making this ticket depend on #18908  and include mathematica in the list?",
    "created_at": "2015-07-16T09:39:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264803",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:23" align="right">comment:23</div>

how about making this ticket depend on #18908  and include mathematica in the list?



---

archive/issue_events_268357.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-16T09:43:18Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268357"
}
```



---

archive/issue_events_268358.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-16T09:43:18Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268358"
}
```



---

archive/issue_comments_264804.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI rewrote this branch by moving everything to a new function, and added a 'Exception'. In this commit all `Maple/Matlab/others` are tested for I believe that we should test them.\n\nIf you object to that and are interested in other's opinion about it (on top of mine), perhaps you should write to sage-devel in the same thread or in a new one. If you oppose it, add a commit to remove the lines (I am tired of fighting endlessly). \n\nI am waiting for your answer to [comment:21] to simplify a couple of lines in the code.\n\n> how about making this ticket depend on #18908 and include mathematica in the list?\n\nGiven that Jeroen seems to doubts the wisdom of testing mathematica/maple/..., it seems a bit early to do that. Also, there is nothing inherently wrong in having #18908 add a couple of lines to `control.py` if this ticket is merged first.\n\nNathann",
    "created_at": "2015-07-16T09:43:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264804",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:24" align="right">comment:24</div>

I rewrote this branch by moving everything to a new function, and added a 'Exception'. In this commit all `Maple/Matlab/others` are tested for I believe that we should test them.

If you object to that and are interested in other's opinion about it (on top of mine), perhaps you should write to sage-devel in the same thread or in a new one. If you oppose it, add a commit to remove the lines (I am tired of fighting endlessly). 

I am waiting for your answer to [comment:21] to simplify a couple of lines in the code.

> how about making this ticket depend on #18908 and include mathematica in the list?

Given that Jeroen seems to doubts the wisdom of testing mathematica/maple/..., it seems a bit early to do that. Also, there is nothing inherently wrong in having #18908 add a couple of lines to `control.py` if this ticket is merged first.

Nathann



---

archive/issue_comments_264805.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nCan we move the whole rummaging-in-external-interfaces part into a separate file? Right now its in the middle of a function thats already too long and has absolutely nothing to do with external interfaces. Though perhaps this ticket is about code golfing the most fugly solution, in that case go ahead ;-)",
    "created_at": "2015-07-16T09:45:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264805",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:25" align="right">comment:25</div>

Can we move the whole rummaging-in-external-interfaces part into a separate file? Right now its in the middle of a function thats already too long and has absolutely nothing to do with external interfaces. Though perhaps this ticket is about code golfing the most fugly solution, in that case go ahead ;-)



---

archive/issue_comments_264806.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n> Can we move the whole rummaging-in-external-interfaces part into a separate file?\n\nRight now the function takes 40 lines and I am still waiting for Jeroen's advice on whether we should cut 20 lines out of it. It is not that I do not enjoy moving this code around every time somebody asks, but I don't see the point of creating a new file for a 20 lines function (10 of which is documentation).\n\nAs reviewers, please settle on what exactly you want to see changed, and I will get to it.\n\nNathann",
    "created_at": "2015-07-16T09:49:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264806",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:26" align="right">comment:26</div>

> Can we move the whole rummaging-in-external-interfaces part into a separate file?

Right now the function takes 40 lines and I am still waiting for Jeroen's advice on whether we should cut 20 lines out of it. It is not that I do not enjoy moving this code around every time somebody asks, but I don't see the point of creating a new file for a 20 lines function (10 of which is documentation).

As reviewers, please settle on what exactly you want to see changed, and I will get to it.

Nathann



---

archive/issue_comments_264807.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nWell, is there currently a way to mix automatic and manual management of `--optional` argument to the doctests? If one can do something like `make ptest OPTIONAL+=...` or 'sage -t --optional_extra=...`, with `optional_extra` appending to `--optional` list...",
    "created_at": "2015-07-16T09:51:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264807",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:27" align="right">comment:27</div>

Well, is there currently a way to mix automatic and manual management of `--optional` argument to the doctests? If one can do something like `make ptest OPTIONAL+=...` or 'sage -t --optional_extra=...`, with `optional_extra` appending to `--optional` list...



---

archive/issue_comments_264808.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n> Well, is there currently a way to mix automatic and manual management of `--optional` argument to the doctests?\n\n```\n(tmp|\u2026)~/sage/graphs$ sage -btp --optional=sage,optional,Hey .\n...\nUsing --optional=bliss,cbc,ccache,cplex,...,hey\n```",
    "created_at": "2015-07-16T09:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264808",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:28" align="right">comment:28</div>

> Well, is there currently a way to mix automatic and manual management of `--optional` argument to the doctests?

```
(tmp|…)~/sage/graphs$ sage -btp --optional=sage,optional,Hey .
...
Using --optional=bliss,cbc,ccache,cplex,...,hey
```



---

archive/issue_comments_264809.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@nathanncohen](#comment:21):\n> Also, do you object my removing the code that checks that the installed version of an optional package is indeed the latest? Now that they are automatically updated, that's rather useless.\n\nFor me, you can remove the code.",
    "created_at": "2015-07-16T09:58:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264809",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@nathanncohen](#comment:21):
> Also, do you object my removing the code that checks that the installed version of an optional package is indeed the latest? Now that they are automatically updated, that's rather useless.

For me, you can remove the code.



---

archive/issue_comments_264810.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@nathanncohen](#comment:20):\n> We can keep Gurobi and CPLEX for they are only used by Sage if the user explicitly linked them with it.\n\nCan you elaborate what you mean with this?",
    "created_at": "2015-07-16T10:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264810",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@nathanncohen](#comment:20):
> We can keep Gurobi and CPLEX for they are only used by Sage if the user explicitly linked them with it.

Can you elaborate what you mean with this?



---

archive/issue_comments_264811.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nReplying to [@nathanncohen](#comment:20):\n> Almost nothing, give it a try.\n\nI don't have those non-open-source packages installed. Ideally it should be tested by people *having the packages installed*. And the fact that it takes time than `./sage -b` is irrelevant. I often just do `./sage -tp` without the `./sage -b` when I'm writing doctests.",
    "created_at": "2015-07-16T10:02:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264811",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">comment:31</div>

Replying to [@nathanncohen](#comment:20):
> Almost nothing, give it a try.

I don't have those non-open-source packages installed. Ideally it should be tested by people *having the packages installed*. And the fact that it takes time than `./sage -b` is irrelevant. I often just do `./sage -tp` without the `./sage -b` when I'm writing doctests.



---

archive/issue_comments_264812.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\n> Can you elaborate what you mean with this?\n\nI mean that CPLEX and Gurobi are not auto-detected from `$PATH` or `$LD_LIBRARY_PATH`. The corresponding cython modules are only built if those instructions are followed:\nhttp://doc.sagemath.org/html/en/thematic_tutorials/linear_programming.html#using-cplex-or-gurobi-through-sage\n\nThus, I believe that it is safe to assume that if Sage can use CPLEX/Gurobi then it means that the user wants it to be linked with Sage. The situation is different when you install Sage on a machine that already has mathematica installed, for it is automatically detected even though the user may not want to use mathematica from Sage.\n\nIf I understood your objections to having automatic tests with mathematica/maple, they do not apply to CPLEX/Gurobi because of this installation procedure.\n\nNathann",
    "created_at": "2015-07-16T10:04:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264812",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:32" align="right">comment:32</div>

> Can you elaborate what you mean with this?

I mean that CPLEX and Gurobi are not auto-detected from `$PATH` or `$LD_LIBRARY_PATH`. The corresponding cython modules are only built if those instructions are followed:
http://doc.sagemath.org/html/en/thematic_tutorials/linear_programming.html#using-cplex-or-gurobi-through-sage

Thus, I believe that it is safe to assume that if Sage can use CPLEX/Gurobi then it means that the user wants it to be linked with Sage. The situation is different when you install Sage on a machine that already has mathematica installed, for it is automatically detected even though the user may not want to use mathematica from Sage.

If I understood your objections to having automatic tests with mathematica/maple, they do not apply to CPLEX/Gurobi because of this installation procedure.

Nathann



---

archive/issue_comments_264813.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\n> > Almost nothing, give it a try.\n\n\n```\nsage: %time _=DC._default_optional_tags()\nCPU times: user 8 ms, sys: 28 ms, total: 36 ms\nWall time: 350 ms\n```\n\nThat's how long you lose. Compare it with the time it takes to doctest control.py (which is not a 'hard' file by any standard)\n\n```\n(tmp|\u2026)~/sage/doctest$ time sage -tp control.py\n...\nsage -tp control.py  2.94s user 0.45s system 74% cpu 4.530 total\n```\n\nAnd of course this become totally negligible if you test several files, a folder, or the whole of Sage.\n\n> I don't have those non-open-source packages installed. Ideally it should be tested by people *having the packages installed*.\n\nIf you are talking about CPLEX and Gurobi, then the time it takes to test whether they are present is *REALLY* negligible compared to the time it takes to test for `maple/mathematica/others`. It is more or less equivalent to load a module and interpret the 'nameerror' if the (cython) module does not exist. This is done twice, so the cost is very very small.\n\nFor the interface.* guys, I personally don't have them on my computer but I consider the time it takes to run the tests to be non-important. If you want to use this argument to claim on sage-devel that they should not be tested, however, you are of course allowed to.\n\nOverall, I think that maple/matlab and others should be included in our tests, for otherwise they will break forever. Paying `0.5s` in a `ptestlong` does not stop me. On the other hand I know that it is useless to argue with you when you do not want to hear something, so I am quite ready to sacrifice it if you but ask. Just decide something and explain the outcome to people on sage-devel who would want this to be tested. I did my part.\n\nNathann",
    "created_at": "2015-07-16T10:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264813",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:33" align="right">comment:33</div>

> > Almost nothing, give it a try.


```
sage: %time _=DC._default_optional_tags()
CPU times: user 8 ms, sys: 28 ms, total: 36 ms
Wall time: 350 ms
```

That's how long you lose. Compare it with the time it takes to doctest control.py (which is not a 'hard' file by any standard)

```
(tmp|…)~/sage/doctest$ time sage -tp control.py
...
sage -tp control.py  2.94s user 0.45s system 74% cpu 4.530 total
```

And of course this become totally negligible if you test several files, a folder, or the whole of Sage.

> I don't have those non-open-source packages installed. Ideally it should be tested by people *having the packages installed*.

If you are talking about CPLEX and Gurobi, then the time it takes to test whether they are present is *REALLY* negligible compared to the time it takes to test for `maple/mathematica/others`. It is more or less equivalent to load a module and interpret the 'nameerror' if the (cython) module does not exist. This is done twice, so the cost is very very small.

For the interface.* guys, I personally don't have them on my computer but I consider the time it takes to run the tests to be non-important. If you want to use this argument to claim on sage-devel that they should not be tested, however, you are of course allowed to.

Overall, I think that maple/matlab and others should be included in our tests, for otherwise they will break forever. Paying `0.5s` in a `ptestlong` does not stop me. On the other hand I know that it is useless to argue with you when you do not want to hear something, so I am quite ready to sacrifice it if you but ask. Just decide something and explain the outcome to people on sage-devel who would want this to be tested. I did my part.

Nathann



---

archive/issue_comments_264814.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nthe more tests are actually being run, the better. If something breaks for someone who has an unblessed by Sage install of a MMA member, it's OK, a good warning...",
    "created_at": "2015-07-16T10:17:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264814",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

the more tests are actually being run, the better. If something breaks for someone who has an unblessed by Sage install of a MMA member, it's OK, a good warning...



---

archive/issue_comments_264815.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\n> the more tests are actually being run, the better. If something breaks for someone who has an unblessed by Sage install of a MMA member, it's OK, a good warning...\n\nAnd that's the only way for us to learn in how many ways such installs can be broken, and act upon it by fixing our interfaces.\n\nBesides, in the case where you really don't have those external softwares installed, checking whether they can be run should be as fast as detecting that the executable cannot be found. So we can also improve that, if we find it too slow.\n\nNathann",
    "created_at": "2015-07-16T10:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264815",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:35" align="right">comment:35</div>

> the more tests are actually being run, the better. If something breaks for someone who has an unblessed by Sage install of a MMA member, it's OK, a good warning...

And that's the only way for us to learn in how many ways such installs can be broken, and act upon it by fixing our interfaces.

Besides, in the case where you really don't have those external softwares installed, checking whether they can be run should be as fast as detecting that the executable cannot be found. So we can also improve that, if we find it too slow.

Nathann



---

archive/issue_comments_264816.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@nathanncohen](#comment:32):\n> If I understood your objections to having automatic tests with mathematica/maple, they do not apply to CPLEX/Gurobi because of this installation procedure.\n\nAgreed.",
    "created_at": "2015-07-16T10:27:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264816",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@nathanncohen](#comment:32):
> If I understood your objections to having automatic tests with mathematica/maple, they do not apply to CPLEX/Gurobi because of this installation procedure.

Agreed.



---

archive/issue_comments_264817.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nI am waiting for your answer to [comment:21] to simplify a couple of lines in the code.",
    "created_at": "2015-07-16T10:33:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264817",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:37" align="right">comment:37</div>

I am waiting for your answer to [comment:21] to simplify a couple of lines in the code.



---

archive/issue_comments_264818.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@nathanncohen](#comment:37):\n> I am waiting for your answer to [comment:21] to simplify a couple of lines in the code.\n\nSee [comment:29]: yes you can remove that code.",
    "created_at": "2015-07-16T10:35:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264818",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@nathanncohen](#comment:37):
> I am waiting for your answer to [comment:21] to simplify a couple of lines in the code.

See [comment:29]: yes you can remove that code.



---

archive/issue_comments_264819.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\n> See [comment:29]: yes you can remove that code.\n\nI received two emails at once, and only noticed the last one. It would be easier to handle your comments if you were giving them all at once. Thanks for your answer though, I'll update it in a second.\n\nNathann",
    "created_at": "2015-07-16T11:05:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264819",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:39" align="right">comment:39</div>

> See [comment:29]: yes you can remove that code.

I received two emails at once, and only noticed the last one. It would be easier to handle your comments if you were giving them all at once. Thanks for your answer though, I'll update it in a second.

Nathann



---

archive/issue_comments_264820.json:
```json
{
    "body": "<div id=\"comment:40\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/44dd24195f94413afd072ef20d03d5491b8b5f2d\"><code>44dd241</code></a></td><td><code>trac #18904: Simplify the listing of installed optional new-style packages</code></td></tr></table>\n",
    "created_at": "2015-07-16T11:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264820",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:40"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/44dd24195f94413afd072ef20d03d5491b8b5f2d"><code>44dd241</code></a></td><td><code>trac #18904: Simplify the listing of installed optional new-style packages</code></td></tr></table>




---

archive/issue_comments_264821.json:
```json
{
    "body": "Changed commit from **[`698ebe9`](https://github.com/sagemath/sagetrac-mirror/commit/698ebe958d528ac279601e0acbbf0c16f00350de)** to **[`44dd241`](https://github.com/sagemath/sagetrac-mirror/commit/44dd24195f94413afd072ef20d03d5491b8b5f2d)**",
    "created_at": "2015-07-16T11:08:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264821",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`698ebe9`](https://github.com/sagemath/sagetrac-mirror/commit/698ebe958d528ac279601e0acbbf0c16f00350de)** to **[`44dd241`](https://github.com/sagemath/sagetrac-mirror/commit/44dd24195f94413afd072ef20d03d5491b8b5f2d)**



---

archive/issue_events_268359.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T14:34:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268359"
}
```



---

archive/issue_events_268360.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T14:34:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268360"
}
```



---

archive/issue_comments_264822.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\n> `mathematica(1)` is just the way I used to detect whether the software\n> is installed. If we need something more reliable, we can have a\n> `is_mathematica_available()` function somewhere that checks it\n> properly.\n\nGood idea!\n\nI'm still thinking if that would be a sufficient solution, but I think you really should introduce functions like that. And I agree with Volker to move these detecting-optional-tags functions to a new file.",
    "created_at": "2015-07-16T14:34:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264822",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:41" align="right">comment:41</div>

> `mathematica(1)` is just the way I used to detect whether the software
> is installed. If we need something more reliable, we can have a
> `is_mathematica_available()` function somewhere that checks it
> properly.

Good idea!

I'm still thinking if that would be a sufficient solution, but I think you really should introduce functions like that. And I agree with Volker to move these detecting-optional-tags functions to a new file.



---

archive/issue_comments_264823.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\n> Good idea!\n\nThis branch does nothing with mathematica, however.\n\n> I'm still thinking if that would be a sufficient solution, but I think you really should introduce functions like that.\n\nI will not do it, that's for sure. You can add a commit, though.\n\n> And I agree with Volker to move these detecting-optional-tags functions to a new file.\n\nI would like to understand what you have in mind, first. The function that this branch adds is 40 lines long, and it does not seem justified to create a file for that. Or please explain what you think this file should contain and do. If you want `is_X_installed` functions, then I expect that those should be in the interface.* files, and not centralized in a doctest code.\n\nNathann",
    "created_at": "2015-07-16T14:38:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264823",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:42" align="right">comment:42</div>

> Good idea!

This branch does nothing with mathematica, however.

> I'm still thinking if that would be a sufficient solution, but I think you really should introduce functions like that.

I will not do it, that's for sure. You can add a commit, though.

> And I agree with Volker to move these detecting-optional-tags functions to a new file.

I would like to understand what you have in mind, first. The function that this branch adds is 40 lines long, and it does not seem justified to create a file for that. Or please explain what you think this file should contain and do. If you want `is_X_installed` functions, then I expect that those should be in the interface.* files, and not centralized in a doctest code.

Nathann



---

archive/issue_comments_264824.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nReplying to [@nathanncohen](#comment:42):\n> If you want `is_X_installed`\n\nIt's not really `is_X_installed`, it's more like `is_the_version_of_X_which_is_installed_sufficient_for_the_doctests`? So, it is very much related to the doctests.",
    "created_at": "2015-07-16T14:49:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264824",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:43" align="right">comment:43</div>

Replying to [@nathanncohen](#comment:42):
> If you want `is_X_installed`

It's not really `is_X_installed`, it's more like `is_the_version_of_X_which_is_installed_sufficient_for_the_doctests`? So, it is very much related to the doctests.



---

archive/issue_comments_264825.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\n> It's not really `is_X_installed`, it's more like `is_the_version_of_X_which_is_installed_sufficient_for_the_doctests`? So, it is very much related to the doctests.\n\nTo me it would make more sense to have a `version()` function in sage/interfaces/mathematica.py that would return the version. This can then be analyzed all you want in the doctest code. By the way, do you have any idea of which version should be kept and which ones should be discarded? Or do you only want to make my job more complicated?\n\nNathann",
    "created_at": "2015-07-16T14:50:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264825",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:44" align="right">comment:44</div>

> It's not really `is_X_installed`, it's more like `is_the_version_of_X_which_is_installed_sufficient_for_the_doctests`? So, it is very much related to the doctests.

To me it would make more sense to have a `version()` function in sage/interfaces/mathematica.py that would return the version. This can then be analyzed all you want in the doctest code. By the way, do you have any idea of which version should be kept and which ones should be discarded? Or do you only want to make my job more complicated?

Nathann



---

archive/issue_events_268361.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-16T14:57:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268361"
}
```



---

archive/issue_events_268362.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-16T14:57:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268362"
}
```



---

archive/issue_comments_264826.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nUntil somebody can explain why this 40-lines code *must* be moved to a (yet unnamed) new module, or what exactly should be checked if it is not 'magma(1)', ...",
    "created_at": "2015-07-16T14:57:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264826",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:45" align="right">comment:45</div>

Until somebody can explain why this 40-lines code *must* be moved to a (yet unnamed) new module, or what exactly should be checked if it is not 'magma(1)', ...



---

archive/issue_comments_264827.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@nathanncohen](#comment:44):\n> > It's not really `is_X_installed`, it's more like `is_the_version_of_X_which_is_installed_sufficient_for_the_doctests`? So, it is very much related to the doctests.\n\n> \n> To me it would make more sense to have a `version()` function in sage/interfaces/mathematica.py that would return the version.\n\nI would let .version() return -1000 if there is no program available, instead of a separate\nfunction...",
    "created_at": "2015-07-16T15:03:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264827",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@nathanncohen](#comment:44):
> > It's not really `is_X_installed`, it's more like `is_the_version_of_X_which_is_installed_sufficient_for_the_doctests`? So, it is very much related to the doctests.

> 
> To me it would make more sense to have a `version()` function in sage/interfaces/mathematica.py that would return the version.

I would let .version() return -1000 if there is no program available, instead of a separate
function...



---

archive/issue_comments_264828.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\n> I would let .version() return -1000 if there is no program available, instead of a separate\n> function...\n\n+1.",
    "created_at": "2015-07-16T15:05:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264828",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:47" align="right">comment:47</div>

> I would let .version() return -1000 if there is no program available, instead of a separate
> function...

+1.



---

archive/issue_comments_264829.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@nathanncohen](#comment:45):\n> Until somebody can explain why this 40-lines code *must* be moved to a (yet unnamed) new module\n\nhttps://en.wikipedia.org/wiki/Single_responsibility_principle\n\nIs the doctest controller responsible for third-party interfaces?\n\nE.g. page 34 of http://vitoex.googlecode.com/svn/trunk/Read/Clean%20Code.pdf recommends:\n\n\"The first rule of functions is that they should be small. The second rule of functions is that\nthey should be smaller than that. [...] Functions should not be 100 lines long. Functions should hardly ever be 20 lines long.\"",
    "created_at": "2015-07-16T17:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264829",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@nathanncohen](#comment:45):
> Until somebody can explain why this 40-lines code *must* be moved to a (yet unnamed) new module

https://en.wikipedia.org/wiki/Single_responsibility_principle

Is the doctest controller responsible for third-party interfaces?

E.g. page 34 of http://vitoex.googlecode.com/svn/trunk/Read/Clean%20Code.pdf recommends:

"The first rule of functions is that they should be small. The second rule of functions is that
they should be smaller than that. [...] Functions should not be 100 lines long. Functions should hardly ever be 20 lines long."



---

archive/issue_comments_264830.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\n> Is the doctest controller responsible for third-party interfaces?\n\nWhere else do you expect to see the code which decides which third-party interfaces should be tested? Are third-party interfaces responsible for doctesting? Be serious.\n\n> E.g. page 34 of http://vitoex.googlecode.com/svn/trunk/Read/Clean%20Code.pdf recommends:\n> \n> \"The first rule of functions is that they should be small. The second rule of functions is that\n> they should be smaller than that. [...] Functions should not be 100 lines long. Functions should hardly ever be 20 lines long.\"\n\nThat a fortunate coincidence, for my function has around 26 lines of code (the rest is documentation). So I pass this test. Shoud I write myself to sage-devel to ask whether we should enforce a hard line limit of 20 lines per function?\n\nThe other good news for me is that I do not see anything about creating a new file for functions of 20< x < 30 lines.\n\nSo it's still up for review.\n\nI think that you are officially splitting hairs.\n\nNathann",
    "created_at": "2015-07-16T17:20:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264830",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:49" align="right">comment:49</div>

> Is the doctest controller responsible for third-party interfaces?

Where else do you expect to see the code which decides which third-party interfaces should be tested? Are third-party interfaces responsible for doctesting? Be serious.

> E.g. page 34 of http://vitoex.googlecode.com/svn/trunk/Read/Clean%20Code.pdf recommends:
> 
> "The first rule of functions is that they should be small. The second rule of functions is that
> they should be smaller than that. [...] Functions should not be 100 lines long. Functions should hardly ever be 20 lines long."

That a fortunate coincidence, for my function has around 26 lines of code (the rest is documentation). So I pass this test. Shoud I write myself to sage-devel to ask whether we should enforce a hard line limit of 20 lines per function?

The other good news for me is that I do not see anything about creating a new file for functions of 20< x < 30 lines.

So it's still up for review.

I think that you are officially splitting hairs.

Nathann



---

archive/issue_comments_264831.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nReplying to [@nathanncohen](#comment:49):\n> > Is the doctest controller responsible for third-party interfaces?\n\n> Where else do you expect to see the code which decides which third-party interfaces should be tested?\n\nIf you can't figure out an existing place that is responsible then your instinct should be to create a new one.",
    "created_at": "2015-07-16T17:40:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264831",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:50" align="right">comment:50</div>

Replying to [@nathanncohen](#comment:49):
> > Is the doctest controller responsible for third-party interfaces?

> Where else do you expect to see the code which decides which third-party interfaces should be tested?

If you can't figure out an existing place that is responsible then your instinct should be to create a new one.



---

archive/issue_comments_264832.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\n> If you can't figure out an existing place that is responsible then your instinct should be to create a new one.\n\nI have no problem figuring this out. There is a place in the doctest code where we define the default list of optional packages that we should test. It is done in the `DoctestController` class defined in `doctest.py`, and I don't see a better place to write the code that builds this list.\n\nNathann",
    "created_at": "2015-07-16T17:41:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264832",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:51" align="right">comment:51</div>

> If you can't figure out an existing place that is responsible then your instinct should be to create a new one.

I have no problem figuring this out. There is a place in the doctest code where we define the default list of optional packages that we should test. It is done in the `DoctestController` class defined in `doctest.py`, and I don't see a better place to write the code that builds this list.

Nathann



---

archive/issue_comments_264833.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nWhat is the `DoctestController` responsible for?",
    "created_at": "2015-07-16T17:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264833",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:52" align="right">comment:52</div>

What is the `DoctestController` responsible for?



---

archive/issue_comments_264834.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\n> What is the `DoctestController` responsible for?\n\nVolker, I do not know what you are trying to achieve on this ticket. What I know is that my goal here is to improve Sage's tests, so that less code gets broken.\n\nThe way we proceed is through a code review (which IIRC never involved a lot of Zen questioning): if you see something wrong with the code, you say what you think needs to be changed and why, so that we can discuss it. The 20lines limit for functions, I'm ashamed to say, it not in this ticket's scope (discuss it on sage-devel).\n\nI now have really important things that I must see to, like tonight's tomato sauce with heaps of basil.\n\nNathann",
    "created_at": "2015-07-16T18:07:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264834",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:53" align="right">comment:53</div>

> What is the `DoctestController` responsible for?

Volker, I do not know what you are trying to achieve on this ticket. What I know is that my goal here is to improve Sage's tests, so that less code gets broken.

The way we proceed is through a code review (which IIRC never involved a lot of Zen questioning): if you see something wrong with the code, you say what you think needs to be changed and why, so that we can discuss it. The 20lines limit for functions, I'm ashamed to say, it not in this ticket's scope (discuss it on sage-devel).

I now have really important things that I must see to, like tonight's tomato sauce with heaps of basil.

Nathann



---

archive/issue_comments_264835.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,6 +6,9 @@\n \n Nathann\n \n+sage-devel thread: https://groups.google.com/d/topic/sage-devel/M98nD7833KM/discussion\n+\n+\n **Currently handles** Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.\n \n (mathematica cannot be included before #18908 is fixed)\n``````\n",
    "created_at": "2015-07-16T18:10:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264835",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,6 +6,9 @@
 
 Nathann
 
+sage-devel thread: https://groups.google.com/d/topic/sage-devel/M98nD7833KM/discussion
+
+
 **Currently handles** Gurobi, Cplex, Maple, Matlab, Macaulay2, Octave, Scilab.
 
 (mathematica cannot be included before #18908 is fixed)
``````




---

archive/issue_comments_264836.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nReplying to [@nathanncohen](#comment:53):\n> if you see something wrong with the code, you say what you think needs to be changed and why, so that we can discuss it.\n\nI said it already, but let me repeat: Move the logic for detecting installed / compatible third-party packages to a separate module. This new module shall only be responsible for that one thing.",
    "created_at": "2015-07-16T18:30:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264836",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:55" align="right">comment:55</div>

Replying to [@nathanncohen](#comment:53):
> if you see something wrong with the code, you say what you think needs to be changed and why, so that we can discuss it.

I said it already, but let me repeat: Move the logic for detecting installed / compatible third-party packages to a separate module. This new module shall only be responsible for that one thing.



---

archive/issue_comments_264837.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\n> I said it already, but let me repeat: Move the logic for detecting installed / compatible third-party packages to a separate module. This new module shall only be responsible for that one thing.\n\nIt would be a module containing a 40 lines function only. I do not think that it makes much sense, unless you have more code to move there.\n\nNathann",
    "created_at": "2015-07-16T18:32:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264837",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:56" align="right">comment:56</div>

> I said it already, but let me repeat: Move the logic for detecting installed / compatible third-party packages to a separate module. This new module shall only be responsible for that one thing.

It would be a module containing a 40 lines function only. I do not think that it makes much sense, unless you have more code to move there.

Nathann



---

archive/issue_comments_264838.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nMoreover, please note that the code which builds the list of optional packages was already there. Before I was asked to turn this into an independent function, all that this patch did is add 10 lines of code right after other lines that already did a very similar job. So it is a bit surprising to me that all of a sudden this needs to be changed.",
    "created_at": "2015-07-16T18:35:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264838",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:57" align="right">comment:57</div>

Moreover, please note that the code which builds the list of optional packages was already there. Before I was asked to turn this into an independent function, all that this patch did is add 10 lines of code right after other lines that already did a very similar job. So it is a bit surprising to me that all of a sudden this needs to be changed.



---

archive/issue_comments_264839.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nI just had an idea: I'm done working on this patch. Whoever wants to see those packages tested can do whatever he likes, for as long as this ticket's original purpose (test Gurobi+CPLEX) works.\n\nHave fun without me.\n\nNathann",
    "created_at": "2015-07-16T18:39:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264839",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:58" align="right">comment:58</div>

I just had an idea: I'm done working on this patch. Whoever wants to see those packages tested can do whatever he likes, for as long as this ticket's original purpose (test Gurobi+CPLEX) works.

Have fun without me.

Nathann



---

archive/issue_comments_264840.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nby now, Mathematica can be added to the list. How about instead of using `--optional` make another parameter, say `--optionalplus`. Then most of the issues raised here will be gone.",
    "created_at": "2015-07-31T13:13:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264840",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:59" align="right">comment:59</div>

by now, Mathematica can be added to the list. How about instead of using `--optional` make another parameter, say `--optionalplus`. Then most of the issues raised here will be gone.



---

archive/issue_comments_264841.json:
```json
{
    "body": "<div id=\"comment:60\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b7213efaf806139f42c9f6b8d3b354c4dbf05047\"><code>b7213ef</code></a></td><td><code>trac #18904: Merged with 6.9.beta6</code></td></tr></table>\n",
    "created_at": "2015-09-12T12:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264841",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:60"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b7213efaf806139f42c9f6b8d3b354c4dbf05047"><code>b7213ef</code></a></td><td><code>trac #18904: Merged with 6.9.beta6</code></td></tr></table>




---

archive/issue_comments_264842.json:
```json
{
    "body": "Changed commit from **[`44dd241`](https://github.com/sagemath/sagetrac-mirror/commit/44dd24195f94413afd072ef20d03d5491b8b5f2d)** to **[`b7213ef`](https://github.com/sagemath/sagetrac-mirror/commit/b7213efaf806139f42c9f6b8d3b354c4dbf05047)**",
    "created_at": "2015-09-12T12:57:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264842",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`44dd241`](https://github.com/sagemath/sagetrac-mirror/commit/44dd24195f94413afd072ef20d03d5491b8b5f2d)** to **[`b7213ef`](https://github.com/sagemath/sagetrac-mirror/commit/b7213efaf806139f42c9f6b8d3b354c4dbf05047)**



---

archive/issue_comments_264843.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nReplying to [@dimpase](#comment:59):\n> by now, Mathematica can be added to the list. How about instead of using `--optional` make another parameter, say `--optionalplus`. Then most of the issues raised here will be gone.\n\n+1 (--external? or --thirdparty?)",
    "created_at": "2015-10-31T08:32:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264843",
    "user": "https://github.com/jjermann"
}
```

<div id="comment:61" align="right">comment:61</div>

Replying to [@dimpase](#comment:59):
> by now, Mathematica can be added to the list. How about instead of using `--optional` make another parameter, say `--optionalplus`. Then most of the issues raised here will be gone.

+1 (--external? or --thirdparty?)



---

archive/issue_comments_264844.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\n`optional=internet` seems useful too, fwiw, see https://groups.google.com/forum/#!topic/sage-devel/qP_3jjVqb5U",
    "created_at": "2015-11-01T00:53:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264844",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:62" align="right">comment:62</div>

`optional=internet` seems useful too, fwiw, see https://groups.google.com/forum/#!topic/sage-devel/qP_3jjVqb5U



---

archive/issue_comments_264845.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nIn #20182, I started a rewrite of this ticket. Check and modify it!",
    "created_at": "2016-03-09T15:56:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264845",
    "user": "https://github.com/kwankyu"
}
```

<div id="comment:63" align="right">comment:63</div>

In #20182, I started a rewrite of this ticket. Check and modify it!



---

archive/issue_comments_264846.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nSo is this now a wontfix or duplicate?",
    "created_at": "2016-03-09T16:04:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264846",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:64" align="right">comment:64</div>

So is this now a wontfix or duplicate?



---

archive/issue_comments_264847.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nLet's wait until #20182 is merged.",
    "created_at": "2016-03-09T16:12:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264847",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:65" align="right">comment:65</div>

Let's wait until #20182 is merged.



---

archive/issue_events_268363.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-04-27T04:21:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268363"
}
```



---

archive/issue_events_268364.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-04-27T04:21:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268364"
}
```



---

archive/issue_events_268365.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-04-27T04:21:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268365"
}
```



---

archive/issue_events_268366.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-04-27T04:21:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268366"
}
```



---

archive/issue_events_268367.json:
```json
{
    "actor": "https://github.com/kwankyu",
    "created_at": "2016-04-27T04:21:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268367"
}
```



---

archive/issue_comments_264848.json:
```json
{
    "body": "Reviewer: **Kwankyu Lee**",
    "created_at": "2016-04-27T04:21:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18904#issuecomment-264848",
    "user": "https://github.com/kwankyu"
}
```

Reviewer: **Kwankyu Lee**



---

archive/issue_events_268368.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-12T12:02:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268368"
}
```



---

archive/issue_events_268369.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-06-12T12:02:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18904",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18904#event-268369"
}
```
