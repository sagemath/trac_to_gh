# Issue 18305: Element comparison for Python classes

archive/issues_018068.json:
```json
{
    "body": "In #17890 the comparison of elements (i.e. `Element.__cmp__`) and rich comparison of elements (i.e. `Element.__richcmp__`) have been simplified. \n\n1 .If coercion has to be involved then the Python elements should implement:\n- `_richcmp_(left, right, op)` for rich comparisons (i.e. operators `<`, `<=`, `==`, `!=`, `>=` and `>=`)\n- `_cmp_(left, right)` for comparisons (i.e. when calling `cmp(x,y)`)\n  In these two methods, it can be assumed that both arguments `left` and `right` are subclasses of `Element` with the same parent. If `_cmp_` makes sense it is possible to implement it only. If an element wants to implement `==` and `!=` only, then it should just raise a `NotImplementedError` for other operators in `_richcmp_(left,right,op)`.\n\n2 . If comparison needs to not avoid coercion, then:\n- rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)\n- comparison is possible via `__cmp__`\n\nWith the current branch:\n- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE`, `op_GT` in `sage.structure.sage_object`\n- six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)\n\nPotentially to discuss:\n- decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)\n- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion\n\nCC:  @jdemeyer jpflori\n\nBranch/Commit: 0ee1f3a96c0db1834efe22def0c2556b9e83355b\n\nReviewer: Jeroen Demeyer\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18305\n\n",
    "closed_at": "2015-09-18T13:03:22Z",
    "created_at": "2015-04-26T19:11:18Z",
    "labels": [
        "component: coercion"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Element comparison for Python classes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18305",
    "user": "https://github.com/videlec"
}
```
In #17890 the comparison of elements (i.e. `Element.__cmp__`) and rich comparison of elements (i.e. `Element.__richcmp__`) have been simplified. 

1 .If coercion has to be involved then the Python elements should implement:
- `_richcmp_(left, right, op)` for rich comparisons (i.e. operators `<`, `<=`, `==`, `!=`, `>=` and `>=`)
- `_cmp_(left, right)` for comparisons (i.e. when calling `cmp(x,y)`)
  In these two methods, it can be assumed that both arguments `left` and `right` are subclasses of `Element` with the same parent. If `_cmp_` makes sense it is possible to implement it only. If an element wants to implement `==` and `!=` only, then it should just raise a `NotImplementedError` for other operators in `_richcmp_(left,right,op)`.

2 . If comparison needs to not avoid coercion, then:
- rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)
- comparison is possible via `__cmp__`

With the current branch:
- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE`, `op_GT` in `sage.structure.sage_object`
- six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)

Potentially to discuss:
- decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)
- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion

CC:  @jdemeyer jpflori

Branch/Commit: 0ee1f3a96c0db1834efe22def0c2556b9e83355b

Reviewer: Jeroen Demeyer

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18305





---

archive/issue_comments_318152.json:
```json
{
    "body": "<a id='comment:1'></a>I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.\n\nDo you agree?",
    "created_at": "2015-04-26T19:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318152",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.

Do you agree?



---

archive/issue_comments_318153.json:
```json
{
    "body": "<a id='comment:2'></a>Replying to [comment:1 jdemeyer]:\n> I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.\n> \n> Do you agree?\n\n\nPartly. I agree that if `_cmp_` is doable **and** cheap then it is preferable. But\n   - consider lists (or words or sequences), you have a cheap test to check whether they are different: comparing the length. So in that case, you might want to use it before comparing items one by one for getting the lexicographic ordering. \n   - there are elements where equality makes sense but not comparison. `_richcmp_` can handle that but not `_cmp_`. In such case I would implement `_richcmp_` and raise an error if the operator is not `Py_EQ` or `Py_NE`.\n\nAnd I am not sure that I understand why `_cmp_` needs less coercion than `_richcmp_`.",
    "created_at": "2015-04-26T19:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318153",
    "user": "https://github.com/videlec"
}
```

<a id='comment:2'></a>Replying to [comment:1 jdemeyer]:
> I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.
> 
> Do you agree?


Partly. I agree that if `_cmp_` is doable **and** cheap then it is preferable. But
   - consider lists (or words or sequences), you have a cheap test to check whether they are different: comparing the length. So in that case, you might want to use it before comparing items one by one for getting the lexicographic ordering. 
   - there are elements where equality makes sense but not comparison. `_richcmp_` can handle that but not `_cmp_`. In such case I would implement `_richcmp_` and raise an error if the operator is not `Py_EQ` or `Py_NE`.

And I am not sure that I understand why `_cmp_` needs less coercion than `_richcmp_`.



---

archive/issue_comments_318154.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,9 +1,17 @@\n-In #17890 the comparisons of elements (i.e. through `__cmp__` and `__richcmp__`) has been simplified. In order for elements to take benefit of the coercion framekwork they should either implement `_cmp_(left,right)` and/or `_richcmp_(left,right,op)`.\n+In #17890 the comparison of elements (i.e. `Element.__cmp__`) and rich comparison of elements (i.e. `Element.__richcmp__`) have been simplified. \n \n-In particular, it is discouraged to implement `__eq__` and `__ne__` if coercion has to be involved. It would also be simpler if no element implements `__cmp__`.\n+1 .If coercion has to be involved then the Python elements should implement:\n+- `_richcmp_(left, right, op)` for rich comparisons (i.e. operators `<`, `<=`, `==`, `!=`, `>=` and `>=`)\n+- `_cmp_(left, right)` for comparisons (i.e. when calling `cmp(x,y)`)\n+  In these two methods, it can be assumed that both arguments `left` and `right` are subclasses of `Element` with the same parent. If `_cmp_` makes sense it is possible to implement it only. If an element wants to implement `==` and `!=` only, then it should just raise a `NotImplementedError` for other operators in `_richcmp_(left,right,op)`.\n+\n+2 . If comparison needs to not avoid coercion, then:\n+- rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)\n+- comparison is possible via `__cmp__`\n \n In this ticket:\n - make everything needed for rich comparisons available from Python (i.e. `Py_EQ`, `Py_NE`, etc as well as `rich_to_bool/rich_to_bool_sgn`)\n-- we check the sage libraries for occurrences of `__eq__`/`__ne__`/`__cmp__` in elements and see whether these can be simplified\n+- check the sage libraries for occurrences of `__eq__`/`__ne__`/`__cmp__` in elements and see whether these can be simplified\n     - #18303 takes care of `sage.rings.qqbar`\n - update the documentation in `sage.structure.Element`\n+- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion\n``````\n",
    "created_at": "2015-04-28T12:20:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318154",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,9 +1,17 @@
-In #17890 the comparisons of elements (i.e. through `__cmp__` and `__richcmp__`) has been simplified. In order for elements to take benefit of the coercion framekwork they should either implement `_cmp_(left,right)` and/or `_richcmp_(left,right,op)`.
+In #17890 the comparison of elements (i.e. `Element.__cmp__`) and rich comparison of elements (i.e. `Element.__richcmp__`) have been simplified. 
 
-In particular, it is discouraged to implement `__eq__` and `__ne__` if coercion has to be involved. It would also be simpler if no element implements `__cmp__`.
+1 .If coercion has to be involved then the Python elements should implement:
+- `_richcmp_(left, right, op)` for rich comparisons (i.e. operators `<`, `<=`, `==`, `!=`, `>=` and `>=`)
+- `_cmp_(left, right)` for comparisons (i.e. when calling `cmp(x,y)`)
+  In these two methods, it can be assumed that both arguments `left` and `right` are subclasses of `Element` with the same parent. If `_cmp_` makes sense it is possible to implement it only. If an element wants to implement `==` and `!=` only, then it should just raise a `NotImplementedError` for other operators in `_richcmp_(left,right,op)`.
+
+2 . If comparison needs to not avoid coercion, then:
+- rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)
+- comparison is possible via `__cmp__`
 
 In this ticket:
 - make everything needed for rich comparisons available from Python (i.e. `Py_EQ`, `Py_NE`, etc as well as `rich_to_bool/rich_to_bool_sgn`)
-- we check the sage libraries for occurrences of `__eq__`/`__ne__`/`__cmp__` in elements and see whether these can be simplified
+- check the sage libraries for occurrences of `__eq__`/`__ne__`/`__cmp__` in elements and see whether these can be simplified
     - #18303 takes care of `sage.rings.qqbar`
 - update the documentation in `sage.structure.Element`
+- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion
``````




---

archive/issue_comments_318155.json:
```json
{
    "body": "<a id='comment:3'></a>Another example: embedded number fields in `RR`. If you want that rich comparisons coincide with the order on `RR` then `==` and `!=` are cheap but not `<`, `<=`, `>` and `>=`.\n\nDo you agree with the new description?",
    "created_at": "2015-04-28T12:20:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318155",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>Another example: embedded number fields in `RR`. If you want that rich comparisons coincide with the order on `RR` then `==` and `!=` are cheap but not `<`, `<=`, `>` and `>=`.

Do you agree with the new description?



---

archive/issue_comments_318156.json:
```json
{
    "body": "Changing dependencies from \"#17890, #18303\" to \"#17890\"",
    "created_at": "2015-04-29T16:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318156",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#17890, #18303" to "#17890"



---

archive/issue_comments_318157.json:
```json
{
    "body": "<a id='comment:4'></a>I was able to modify six Python elements to use coercion for their comparisons. The code is simplified.\n\nIn order to do that, I had to modify slightly the implementation of `_richcmp` to not catch a `TypeError` when it calls `_richcmp_`. We should precise what elements should do when `==` and `!=` makes sense but not `<`, `<=`, `>=`, `>`. Is `TypeError` appropriate?\n\nVincent\n\n---\nLast 10 new commits:",
    "created_at": "2015-04-29T16:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318157",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>I was able to modify six Python elements to use coercion for their comparisons. The code is simplified.

In order to do that, I had to modify slightly the implementation of `_richcmp` to not catch a `TypeError` when it calls `_richcmp_`. We should precise what elements should do when `==` and `!=` makes sense but not `<`, `<=`, `>=`, `>`. Is `TypeError` appropriate?

Vincent

---
Last 10 new commits:



---

archive/issue_comments_318158.json:
```json
{
    "body": "Changing commit from \"\" to \"7749fe882a88d0978413e9c58b9d2660e0de23a6\"",
    "created_at": "2015-04-29T16:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318158",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "7749fe882a88d0978413e9c58b9d2660e0de23a6"



---

archive/issue_comments_318159.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/18305\"",
    "created_at": "2015-04-29T16:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318159",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/18305"



---

archive/issue_comments_318160.json:
```json
{
    "body": "Changing author from \"\" to \"Vincent Delecroix\"",
    "created_at": "2015-04-29T16:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318160",
    "user": "https://github.com/videlec"
}
```

Changing author from "" to "Vincent Delecroix"



---

archive/issue_comments_318161.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -9,9 +9,11 @@\n - rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)\n - comparison is possible via `__cmp__`\n \n-In this ticket:\n-- make everything needed for rich comparisons available from Python (i.e. `Py_EQ`, `Py_NE`, etc as well as `rich_to_bool/rich_to_bool_sgn`)\n-- check the sage libraries for occurrences of `__eq__`/`__ne__`/`__cmp__` in elements and see whether these can be simplified\n-    - #18303 takes care of `sage.rings.qqbar`\n+With the current branch:\n+- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `py_rich_to_bool_sgn` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE` and `op_GT` in `sage.structure.sage_object`\n+- six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)\n+\n+Still to do or discuss:\n - update the documentation in `sage.structure.Element`\n-- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion\n+- decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)\n+- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion (?)\n``````\n",
    "created_at": "2015-04-29T16:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318161",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -9,9 +9,11 @@
 - rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)
 - comparison is possible via `__cmp__`
 
-In this ticket:
-- make everything needed for rich comparisons available from Python (i.e. `Py_EQ`, `Py_NE`, etc as well as `rich_to_bool/rich_to_bool_sgn`)
-- check the sage libraries for occurrences of `__eq__`/`__ne__`/`__cmp__` in elements and see whether these can be simplified
-    - #18303 takes care of `sage.rings.qqbar`
+With the current branch:
+- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `py_rich_to_bool_sgn` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE` and `op_GT` in `sage.structure.sage_object`
+- six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)
+
+Still to do or discuss:
 - update the documentation in `sage.structure.Element`
-- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion
+- decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)
+- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion (?)
``````




---

archive/issue_comments_318162.json:
```json
{
    "body": "Changing commit from \"7749fe882a88d0978413e9c58b9d2660e0de23a6\" to \"81be759f0e28dc13aa17e2f7df72bee0e729ee8f\"",
    "created_at": "2015-04-29T16:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318162",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7749fe882a88d0978413e9c58b9d2660e0de23a6" to "81be759f0e28dc13aa17e2f7df72bee0e729ee8f"



---

archive/issue_comments_318163.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-29T16:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318163",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318164.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-29T16:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318164",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_318165.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,7 +13,6 @@\n - make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `py_rich_to_bool_sgn` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE` and `op_GT` in `sage.structure.sage_object`\n - six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)\n \n-Still to do or discuss:\n-- update the documentation in `sage.structure.Element`\n+Potentially to discuss:\n - decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)\n-- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion (?)\n+- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion\n``````\n",
    "created_at": "2015-04-29T16:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318165",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,7 +13,6 @@
 - make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `py_rich_to_bool_sgn` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE` and `op_GT` in `sage.structure.sage_object`
 - six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)
 
-Still to do or discuss:
-- update the documentation in `sage.structure.Element`
+Potentially to discuss:
 - decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)
-- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion (?)
+- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion
``````




---

archive/issue_comments_318166.json:
```json
{
    "body": "<a id='comment:7'></a>I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.",
    "created_at": "2015-05-04T09:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318166",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:7'></a>I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.



---

archive/issue_comments_318167.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 jdemeyer]:\n> I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.\n\n\nPerhaps I should set #18322 as a dependency? I do not think that there will be any conflict since nothing in Sage explicitely uses `cmp` (except doctests).\n\nVincent",
    "created_at": "2015-05-04T11:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318167",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>Replying to [comment:7 jdemeyer]:
> I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.


Perhaps I should set #18322 as a dependency? I do not think that there will be any conflict since nothing in Sage explicitely uses `cmp` (except doctests).

Vincent



---

archive/issue_comments_318168.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-06T08:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318168",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318169.json:
```json
{
    "body": "Changing commit from \"81be759f0e28dc13aa17e2f7df72bee0e729ee8f\" to \"df2b501daa2d5b9ebde44d8e698f3d7f51228299\"",
    "created_at": "2015-05-06T08:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "81be759f0e28dc13aa17e2f7df72bee0e729ee8f" to "df2b501daa2d5b9ebde44d8e698f3d7f51228299"



---

archive/issue_comments_318170.json:
```json
{
    "body": "<a id='comment:10'></a>Rebase on sage-6.7.beta4",
    "created_at": "2015-05-06T08:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318170",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>Rebase on sage-6.7.beta4



---

archive/issue_comments_318171.json:
```json
{
    "body": "Changing dependencies from \"#17890\" to \"\"",
    "created_at": "2015-05-06T08:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318171",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#17890" to ""



---

archive/issue_comments_318172.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:4 vdelecroix]:\n> |                                                                                                                                          |                                                                        |\n> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n> |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|\n\n\nI moved this to #18322 since I think it fits better there.",
    "created_at": "2015-05-06T08:12:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318172",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [comment:4 vdelecroix]:
> |                                                                                                                                          |                                                                        |
> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
> |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|


I moved this to #18322 since I think it fits better there.



---

archive/issue_comments_318173.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#18322\"",
    "created_at": "2015-05-07T09:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318173",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "" to "#18322"



---

archive/issue_comments_318174.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-07T09:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318174",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_318175.json:
```json
{
    "body": "<a id='comment:13'></a>Replying to [comment:12 jdemeyer]:\n> Replying to [comment:4 vdelecroix]:\n> > |                                                                                                                                          |                                                                        |\n> > |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n> > |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|\n\n> \n> I moved this to #18322 since I think it fits better there.\n\n\nGood to me.",
    "created_at": "2015-05-07T09:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318175",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>Replying to [comment:12 jdemeyer]:
> Replying to [comment:4 vdelecroix]:
> > |                                                                                                                                          |                                                                        |
> > |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
> > |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|

> 
> I moved this to #18322 since I think it fits better there.


Good to me.



---

archive/issue_comments_318176.json:
```json
{
    "body": "<a id='comment:14'></a>About this ticket: I don't really like that you're making major unrelated changes, for example (but not only) in alternating sign matrices. Do you really need that? Could those changes be moved to a different ticket?",
    "created_at": "2015-05-07T09:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318176",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>About this ticket: I don't really like that you're making major unrelated changes, for example (but not only) in alternating sign matrices. Do you really need that? Could those changes be moved to a different ticket?



---

archive/issue_comments_318177.json:
```json
{
    "body": "Changing commit from \"df2b501daa2d5b9ebde44d8e698f3d7f51228299\" to \"0259eb7814ac159722db566fcd52c21e040cb233\"",
    "created_at": "2015-05-08T21:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318177",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "df2b501daa2d5b9ebde44d8e698f3d7f51228299" to "0259eb7814ac159722db566fcd52c21e040cb233"



---

archive/issue_comments_318178.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-08T21:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318178",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318179.json:
```json
{
    "body": "<a id='comment:16'></a>Rebased above #18322.\n\nThe alternating sign matrices is now #18383. What are the other \"major unrelated changes\"?",
    "created_at": "2015-05-08T21:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318179",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>Rebased above #18322.

The alternating sign matrices is now #18383. What are the other "major unrelated changes"?



---

archive/issue_comments_318180.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-08T21:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318180",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318181.json:
```json
{
    "body": "<a id='comment:19'></a>I think having both `py_rich_to_bool_sgn` and `py_rich_to_bool` in Python is overkill. Since these are Python functions anyway, the overhead of the `_sgn` variant can be ignored.\n\nAnd I don't like most of your comment changes to `src/sage/structure/element.pyx`: if you implement just `_richcmp_`, then you don't need `__cmp__`, not even for `cmp()`. Why did you remove `or if that gives better performance`. And the `and are not identical (i.e. self is not other).` addition is also wrong I think.",
    "created_at": "2015-05-21T09:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318181",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>I think having both `py_rich_to_bool_sgn` and `py_rich_to_bool` in Python is overkill. Since these are Python functions anyway, the overhead of the `_sgn` variant can be ignored.

And I don't like most of your comment changes to `src/sage/structure/element.pyx`: if you implement just `_richcmp_`, then you don't need `__cmp__`, not even for `cmp()`. Why did you remove `or if that gives better performance`. And the `and are not identical (i.e. self is not other).` addition is also wrong I think.



---

archive/issue_comments_318182.json:
```json
{
    "body": "<a id='comment:20'></a>Also, there is no need for the `int` in\n\n```\ndef py_rich_to_bool_sgn(int op, int c)\n```\n(if we ever change the prototype of `rich_to_bool_sgn`, there is additional work for no reason)",
    "created_at": "2015-05-21T09:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318182",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>Also, there is no need for the `int` in

```
def py_rich_to_bool_sgn(int op, int c)
```
(if we ever change the prototype of `rich_to_bool_sgn`, there is additional work for no reason)



---

archive/issue_comments_318183.json:
```json
{
    "body": "<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-23T15:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:21'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318184.json:
```json
{
    "body": "Changing commit from \"0259eb7814ac159722db566fcd52c21e040cb233\" to \"17ed5499a2113637034ffc8ef2210f949896e5c6\"",
    "created_at": "2015-05-23T15:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318184",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0259eb7814ac159722db566fcd52c21e040cb233" to "17ed5499a2113637034ffc8ef2210f949896e5c6"



---

archive/issue_comments_318185.json:
```json
{
    "body": "Changing dependencies from \"#18322\" to \"\"",
    "created_at": "2015-05-23T16:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318185",
    "user": "https://github.com/videlec"
}
```

Changing dependencies from "#18322" to ""



---

archive/issue_comments_318186.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,7 +10,7 @@\n - comparison is possible via `__cmp__`\n \n With the current branch:\n-- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `py_rich_to_bool_sgn` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE` and `op_GT` in `sage.structure.sage_object`\n+- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE`, `op_GT` in `sage.structure.sage_object`\n - six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)\n \n Potentially to discuss:\n``````\n",
    "created_at": "2015-05-23T16:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318186",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,7 +10,7 @@
 - comparison is possible via `__cmp__`
 
 With the current branch:
-- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `py_rich_to_bool_sgn` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE` and `op_GT` in `sage.structure.sage_object`
+- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE`, `op_GT` in `sage.structure.sage_object`
 - six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)
 
 Potentially to discuss:
``````




---

archive/issue_comments_318187.json:
```json
{
    "body": "<a id='comment:22'></a>Rebased on 6.8.beta0.\n\nI took care of your comments.\n\nVincent",
    "created_at": "2015-05-23T16:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318187",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>Rebased on 6.8.beta0.

I took care of your comments.

Vincent



---

archive/issue_comments_318188.json:
```json
{
    "body": "<a id='comment:23'></a>does not apply, needs rebase",
    "created_at": "2015-07-30T12:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318188",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>does not apply, needs rebase



---

archive/issue_comments_318189.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-07-30T12:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318189",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_318190.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-06T15:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318190",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318191.json:
```json
{
    "body": "Changing commit from \"17ed5499a2113637034ffc8ef2210f949896e5c6\" to \"d768d2524b35e70345bf3b94392dd3e44ade9376\"",
    "created_at": "2015-08-06T15:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "17ed5499a2113637034ffc8ef2210f949896e5c6" to "d768d2524b35e70345bf3b94392dd3e44ade9376"



---

archive/issue_events_051640.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-08-06T15:36:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18305#event-51640"
}
```



---

archive/issue_comments_318192.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-06T15:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318192",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318193.json:
```json
{
    "body": "<a id='comment:25'></a>rebased on sage-6.9.beta1",
    "created_at": "2015-08-06T15:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318193",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>rebased on sage-6.9.beta1



---

archive/issue_comments_318194.json:
```json
{
    "body": "<a id='comment:26'></a>See also #19108 which solves the same problem in a different (more complicated) way.",
    "created_at": "2015-08-28T06:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318194",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>See also #19108 which solves the same problem in a different (more complicated) way.



---

archive/issue_comments_318195.json:
```json
{
    "body": "<a id='comment:27'></a>Can you split off the changes to `src/sage/algebras` to a different ticket?",
    "created_at": "2015-09-08T13:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318195",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>Can you split off the changes to `src/sage/algebras` to a different ticket?



---

archive/issue_comments_318196.json:
```json
{
    "body": "<a id='comment:28'></a>Replace\n\n```\nIf you need to call this function from Cython prefer\n```\nby\n\n```\nDo not use this function from Cython. Instead, call\n```",
    "created_at": "2015-09-08T13:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318196",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>Replace

```
If you need to call this function from Cython prefer
```
by

```
Do not use this function from Cython. Instead, call
```



---

archive/issue_comments_318197.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-09-09T00:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318197",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318198.json:
```json
{
    "body": "Changing commit from \"d768d2524b35e70345bf3b94392dd3e44ade9376\" to \"3f6ea84eb645f1e29426bedc7763c9f31997867b\"",
    "created_at": "2015-09-09T00:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318198",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d768d2524b35e70345bf3b94392dd3e44ade9376" to "3f6ea84eb645f1e29426bedc7763c9f31997867b"



---

archive/issue_comments_318199.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:27 jdemeyer]:\n> Can you split off the changes to `src/sage/algebras` to a different ticket?\n\n\nIt is now #19170",
    "created_at": "2015-09-09T01:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318199",
    "user": "https://github.com/videlec"
}
```

<a id='comment:30'></a>Replying to [comment:27 jdemeyer]:
> Can you split off the changes to `src/sage/algebras` to a different ticket?


It is now #19170



---

archive/issue_comments_318200.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-14T11:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318200",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_318201.json:
```json
{
    "body": "<a id='comment:31'></a>This is not good, you're adding back stuff which was removed:\n\n```diff\ndiff --git a/src/sage/structure/element.pyx b/src/sage/structure/element.pyx\nindex ede0157..4208a50 100644\n--- a/src/sage/structure/element.pyx\n+++ b/src/sage/structure/element.pyx\n@@ -1043,10 +1043,16 @@ cdef class Element(SageObject):\n             return rich_to_bool(op, -1)\n \n     ####################################################################\n-    # For a Cython class, you must define either _cmp_ (if your subclass\n-    # is totally ordered), _richcmp_ (if your subclass is partially\n-    # ordered), or both (if your class has both a total order and a\n-    # partial order, or if implementing both gives better performance).\n+    # For a derived Cython class, you **must** put the __richcmp__\n+    # method below in your subclasses, in order for it to take\n+    # advantage of the above generic comparison code. If you want to use cmp()\n+    # but did not implement a rich comparison, then you must copy paste the\n+    # __cmp__ method below.\n+    #\n+    # In a Cython or a Python class, you must define either _cmp_\n+    # (if your subclass is totally ordered), _richcmp_ (if your subclass\n+    # is partially ordered), or both (if your class has both a total order\n+    # and a partial order, or if that gives better performance).\n     #\n     # Rich comparisons (like a < b) will default to using _richcmp_,\n     # three-way comparisons (like cmp(a,b)) will default to using\n```",
    "created_at": "2015-09-14T11:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318201",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:31'></a>This is not good, you're adding back stuff which was removed:

```diff
diff --git a/src/sage/structure/element.pyx b/src/sage/structure/element.pyx
index ede0157..4208a50 100644
--- a/src/sage/structure/element.pyx
+++ b/src/sage/structure/element.pyx
@@ -1043,10 +1043,16 @@ cdef class Element(SageObject):
             return rich_to_bool(op, -1)
 
     ####################################################################
-    # For a Cython class, you must define either _cmp_ (if your subclass
-    # is totally ordered), _richcmp_ (if your subclass is partially
-    # ordered), or both (if your class has both a total order and a
-    # partial order, or if implementing both gives better performance).
+    # For a derived Cython class, you **must** put the __richcmp__
+    # method below in your subclasses, in order for it to take
+    # advantage of the above generic comparison code. If you want to use cmp()
+    # but did not implement a rich comparison, then you must copy paste the
+    # __cmp__ method below.
+    #
+    # In a Cython or a Python class, you must define either _cmp_
+    # (if your subclass is totally ordered), _richcmp_ (if your subclass
+    # is partially ordered), or both (if your class has both a total order
+    # and a partial order, or if that gives better performance).
     #
     # Rich comparisons (like a < b) will default to using _richcmp_,
     # three-way comparisons (like cmp(a,b)) will default to using
```



---

archive/issue_comments_318202.json:
```json
{
    "body": "<a id='comment:32'></a>`Py_EQ` should be `op_EQ` here:\n\n```\n    INPUT:\n\n    - ``op`` -- a rich comparison operation (e.g. ``Py_EQ``)\n```\n\n`c` can be any integer, not only -1, 0 or 1:\n\n```\n    - ``c`` -- the result of an ordinary comparison: -1, 0 or 1.\n```\n\nNo trailing slash needed:\n\n```\n        sage: from sage.structure.sage_object import (py_rich_to_bool, \\\n        ....:    op_EQ, op_NE, op_LT, op_LE, op_GT, op_GE)\n```",
    "created_at": "2015-09-14T11:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318202",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>`Py_EQ` should be `op_EQ` here:

```
    INPUT:

    - ``op`` -- a rich comparison operation (e.g. ``Py_EQ``)
```

`c` can be any integer, not only -1, 0 or 1:

```
    - ``c`` -- the result of an ordinary comparison: -1, 0 or 1.
```

No trailing slash needed:

```
        sage: from sage.structure.sage_object import (py_rich_to_bool, \
        ....:    op_EQ, op_NE, op_LT, op_LE, op_GT, op_GE)
```



---

archive/issue_comments_318203.json:
```json
{
    "body": "<a id='comment:33'></a>Please keep the doctests for `IndexedMonoidElement.__ne__` like you did for the other comparisons.",
    "created_at": "2015-09-14T11:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318203",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>Please keep the doctests for `IndexedMonoidElement.__ne__` like you did for the other comparisons.



---

archive/issue_comments_318204.json:
```json
{
    "body": "<a id='comment:34'></a>\n```\n$ pyflakes src/sage/geometry/newton_polygon.py\nsrc/sage/geometry/newton_polygon.py:20: 'op_GT' imported but unused\nsrc/sage/geometry/newton_polygon.py:20: 'py_rich_to_bool' imported but unused\n```",
    "created_at": "2015-09-14T12:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318204",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>
```
$ pyflakes src/sage/geometry/newton_polygon.py
src/sage/geometry/newton_polygon.py:20: 'op_GT' imported but unused
src/sage/geometry/newton_polygon.py:20: 'py_rich_to_bool' imported but unused
```



---

archive/issue_comments_318205.json:
```json
{
    "body": "<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-09-14T17:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318205",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_318206.json:
```json
{
    "body": "Changing commit from \"3f6ea84eb645f1e29426bedc7763c9f31997867b\" to \"0ee1f3a96c0db1834efe22def0c2556b9e83355b\"",
    "created_at": "2015-09-14T17:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318206",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3f6ea84eb645f1e29426bedc7763c9f31997867b" to "0ee1f3a96c0db1834efe22def0c2556b9e83355b"



---

archive/issue_comments_318207.json:
```json
{
    "body": "<a id='comment:36'></a>Hello Jeroen,\n\nI rebased on the latest beta taking care of all your remarks.\n\nVincent",
    "created_at": "2015-09-14T17:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318207",
    "user": "https://github.com/videlec"
}
```

<a id='comment:36'></a>Hello Jeroen,

I rebased on the latest beta taking care of all your remarks.

Vincent



---

archive/issue_comments_318208.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2015-09-14T17:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318208",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_318209.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-14T17:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318209",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_318210.json:
```json
{
    "body": "<a id='comment:38'></a>Replying to [comment:36 vdelecroix]:\n> I rebased on the latest beta taking care of all your remarks.\n\n\nGeneral comment: you should not rebase a branch which is being reviewed. For example, it is difficult for me to see what you changed since last time, which essentially forces me to re-review everything again.",
    "created_at": "2015-09-14T18:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318210",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:38'></a>Replying to [comment:36 vdelecroix]:
> I rebased on the latest beta taking care of all your remarks.


General comment: you should not rebase a branch which is being reviewed. For example, it is difficult for me to see what you changed since last time, which essentially forces me to re-review everything again.



---

archive/issue_comments_318211.json:
```json
{
    "body": "<a id='comment:39'></a>If you tell me, I can move back my changes on top of the previous commits. Sorry.",
    "created_at": "2015-09-14T22:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318211",
    "user": "https://github.com/videlec"
}
```

<a id='comment:39'></a>If you tell me, I can move back my changes on top of the previous commits. Sorry.



---

archive/issue_comments_318212.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-17T11:42:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318212",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_318213.json:
```json
{
    "body": "<a id='comment:41'></a>Thanks Jeroen. And again, I am sorry for the too early rebase.\n\nVincent",
    "created_at": "2015-09-17T11:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318213",
    "user": "https://github.com/videlec"
}
```

<a id='comment:41'></a>Thanks Jeroen. And again, I am sorry for the too early rebase.

Vincent



---

archive/issue_comments_318214.json:
```json
{
    "body": "<a id='comment:42'></a>Replying to [comment:41 vdelecroix]:\n> Thanks Jeroen. And again, I am sorry for the too early rebase.\n\n\nWhy \"too early\"? I don't think a ticket under review should be rebased at all.\n\nRebasing before review is fine for me.",
    "created_at": "2015-09-17T13:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318214",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:42'></a>Replying to [comment:41 vdelecroix]:
> Thanks Jeroen. And again, I am sorry for the too early rebase.


Why "too early"? I don't think a ticket under review should be rebased at all.

Rebasing before review is fine for me.



---

archive/issue_comments_318215.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-09-18T13:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318215",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_318216.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/18305\" to \"0ee1f3a96c0db1834efe22def0c2556b9e83355b\"",
    "created_at": "2015-09-18T13:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-318216",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/18305" to "0ee1f3a96c0db1834efe22def0c2556b9e83355b"



---

archive/issue_events_051641.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-18T13:03:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18305#event-51641"
}
```
