# Issue 18305: Element comparison for Python classes

archive/issues_018068.json:
```json
{
    "body": "CC:  @jdemeyer jpflori\n\nIn #17890 the comparison of elements (i.e. `Element.__cmp__`) and rich comparison of elements (i.e. `Element.__richcmp__`) have been simplified. \n\n1 .If coercion has to be involved then the Python elements should implement:\n- `_richcmp_(left, right, op)` for rich comparisons (i.e. operators `<`, `<=`, `==`, `!=`, `>=` and `>=`)\n- `_cmp_(left, right)` for comparisons (i.e. when calling `cmp(x,y)`)\n  In these two methods, it can be assumed that both arguments `left` and `right` are subclasses of `Element` with the same parent. If `_cmp_` makes sense it is possible to implement it only. If an element wants to implement `==` and `!=` only, then it should just raise a `NotImplementedError` for other operators in `_richcmp_(left,right,op)`.\n\n2 . If comparison needs to not avoid coercion, then:\n- rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)\n- comparison is possible via `__cmp__`\n\nWith the current branch:\n- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE`, `op_GT` in `sage.structure.sage_object`\n- six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)\n\nPotentially to discuss:\n- decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)\n- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion\n\nIssue created by migration from https://trac.sagemath.org/ticket/18305\n\n",
    "closed_at": "2015-09-18T13:03:22Z",
    "created_at": "2015-04-26T19:11:18Z",
    "labels": [
        "component: coercion"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Element comparison for Python classes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18305",
    "user": "https://github.com/videlec"
}
```
CC:  @jdemeyer jpflori

In #17890 the comparison of elements (i.e. `Element.__cmp__`) and rich comparison of elements (i.e. `Element.__richcmp__`) have been simplified. 

1 .If coercion has to be involved then the Python elements should implement:
- `_richcmp_(left, right, op)` for rich comparisons (i.e. operators `<`, `<=`, `==`, `!=`, `>=` and `>=`)
- `_cmp_(left, right)` for comparisons (i.e. when calling `cmp(x,y)`)
  In these two methods, it can be assumed that both arguments `left` and `right` are subclasses of `Element` with the same parent. If `_cmp_` makes sense it is possible to implement it only. If an element wants to implement `==` and `!=` only, then it should just raise a `NotImplementedError` for other operators in `_richcmp_(left,right,op)`.

2 . If comparison needs to not avoid coercion, then:
- rich comparison is possible through `__eq__`, `__ne__`, `__lt__`, etc (and all of these should be implemented)
- comparison is possible via `__cmp__`

With the current branch:
- make everything needed for rich comparisons available from Python: the branch adds `py_rich_to_bool` and `op_EQ`, `op_NE`, `op_LT`, `op_LE`, `op_GE`, `op_GT` in `sage.structure.sage_object`
- six elements are modified to use either `_richcmp_` or `_cmp_` instead of `__eq__`/`__ne__`/`__lt__`, etc (and #18303 takes care of `sage.rings.qqbar`)

Potentially to discuss:
- decide what should we do with respect to `x < y` when this makes no sense (some elements do raise a `TypeError`)
- remove the test in the default `Element._cmp_` since an element implementing `__cmp__` wants to avoid coercion

Issue created by migration from https://trac.sagemath.org/ticket/18305





---

archive/issue_comments_243147.json:
```json
{
    "body": "I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.\n\nDo you agree?",
    "created_at": "2015-04-26T19:32:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243147",
    "user": "https://github.com/jdemeyer"
}
```

I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.

Do you agree?



---

archive/issue_comments_243148.json:
```json
{
    "body": "Replying to [comment:1 jdemeyer]:\n> I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.\n> \n> Do you agree?\n\n\nPartly. I agree that if `_cmp_` is doable **and** cheap then it is preferable. But\n   - consider lists (or words or sequences), you have a cheap test to check whether they are different: comparing the length. So in that case, you might want to use it before comparing items one by one for getting the lexicographic ordering. \n   - there are elements where equality makes sense but not comparison. `_richcmp_` can handle that but not `_cmp_`. In such case I would implement `_richcmp_` and raise an error if the operator is not `Py_EQ` or `Py_NE`.\n\nAnd I am not sure that I understand why `_cmp_` needs less coercion than `_richcmp_`.",
    "created_at": "2015-04-26T19:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243148",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:1 jdemeyer]:
> I think in general, rich comparisons (both Cython's `__richcmp__` and Python's `__eq__` and friends) should be discouraged in favour of `_cmp_`, because the latter needs coercion only once. Only for more complicated types where rich comparisons cannot be implemented in terms of `__cmp__` (intervals for example) should rich comparisons be used.
> 
> Do you agree?


Partly. I agree that if `_cmp_` is doable **and** cheap then it is preferable. But
   - consider lists (or words or sequences), you have a cheap test to check whether they are different: comparing the length. So in that case, you might want to use it before comparing items one by one for getting the lexicographic ordering. 
   - there are elements where equality makes sense but not comparison. `_richcmp_` can handle that but not `_cmp_`. In such case I would implement `_richcmp_` and raise an error if the operator is not `Py_EQ` or `Py_NE`.

And I am not sure that I understand why `_cmp_` needs less coercion than `_richcmp_`.



---

archive/issue_comments_243149.json:
```json
{
    "body": "Another example: embedded number fields in `RR`. If you want that rich comparisons coincide with the order on `RR` then `==` and `!=` are cheap but not `<`, `<=`, `>` and `>=`.\n\nDo you agree with the new description?",
    "created_at": "2015-04-28T12:20:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243149",
    "user": "https://github.com/videlec"
}
```

Another example: embedded number fields in `RR`. If you want that rich comparisons coincide with the order on `RR` then `==` and `!=` are cheap but not `<`, `<=`, `>` and `>=`.

Do you agree with the new description?



---

archive/issue_comments_243150.json:
```json
{
    "body": "I was able to modify six Python elements to use coercion for their comparisons. The code is simplified.\n\nIn order to do that, I had to modify slightly the implementation of `_richcmp` to not catch a `TypeError` when it calls `_richcmp_`. We should precise what elements should do when `==` and `!=` makes sense but not `<`, `<=`, `>=`, `>`. Is `TypeError` appropriate?\n\nVincent\n\n---\nLast 10 new commits:",
    "created_at": "2015-04-29T16:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243150",
    "user": "https://github.com/videlec"
}
```

I was able to modify six Python elements to use coercion for their comparisons. The code is simplified.

In order to do that, I had to modify slightly the implementation of `_richcmp` to not catch a `TypeError` when it calls `_richcmp_`. We should precise what elements should do when `==` and `!=` makes sense but not `<`, `<=`, `>=`, `>`. Is `TypeError` appropriate?

Vincent

---
Last 10 new commits:



---

archive/issue_comments_243151.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-29T16:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243151",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_243152.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-29T16:24:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243152",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_243153.json:
```json
{
    "body": "I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.",
    "created_at": "2015-05-04T09:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243153",
    "user": "https://github.com/jdemeyer"
}
```

I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.



---

archive/issue_comments_243154.json:
```json
{
    "body": "Replying to [comment:7 jdemeyer]:\n> I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.\n\n\nPerhaps I should set #18322 as a dependency? I do not think that there will be any conflict since nothing in Sage explicitely uses `cmp` (except doctests).\n\nVincent",
    "created_at": "2015-05-04T11:19:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243154",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:7 jdemeyer]:
> I plan to have a look at this when #17890 is merged. I would also like to have some feedback on #18322, since both this ticket and #18322 change `Element`.


Perhaps I should set #18322 as a dependency? I do not think that there will be any conflict since nothing in Sage explicitely uses `cmp` (except doctests).

Vincent



---

archive/issue_comments_243155.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-06T08:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243155",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_243156.json:
```json
{
    "body": "Rebase on sage-6.7.beta4",
    "created_at": "2015-05-06T08:07:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243156",
    "user": "https://github.com/videlec"
}
```

Rebase on sage-6.7.beta4



---

archive/issue_comments_243157.json:
```json
{
    "body": "Replying to [comment:4 vdelecroix]:\n> |                                                                                                                                          |                                                                        |\n> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n> |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|\n\n\nI moved this to #18322 since I think it fits better there.",
    "created_at": "2015-05-06T08:12:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243157",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:4 vdelecroix]:
> |                                                                                                                                          |                                                                        |
> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
> |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|


I moved this to #18322 since I think it fits better there.



---

archive/issue_comments_243158.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-07T09:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243158",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_243159.json:
```json
{
    "body": "Replying to [comment:12 jdemeyer]:\n> Replying to [comment:4 vdelecroix]:\n> > |                                                                                                                                          |                                                                        |\n> > |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|\n> > |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|\n\n> \n> I moved this to #18322 since I think it fits better there.\n\n\nGood to me.",
    "created_at": "2015-05-07T09:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243159",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:12 jdemeyer]:
> Replying to [comment:4 vdelecroix]:
> > |                                                                                                                                          |                                                                        |
> > |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------|
> > |[042b6fe](http://git.sagemath.org/sage.git/commit/?id=042b6fe0fae411b924a09521aab7163731c2e588)|`Trac 18305: modify Element._richcmp so that _richcmp_ can raise errors`|

> 
> I moved this to #18322 since I think it fits better there.


Good to me.



---

archive/issue_comments_243160.json:
```json
{
    "body": "About this ticket: I don't really like that you're making major unrelated changes, for example (but not only) in alternating sign matrices. Do you really need that? Could those changes be moved to a different ticket?",
    "created_at": "2015-05-07T09:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243160",
    "user": "https://github.com/jdemeyer"
}
```

About this ticket: I don't really like that you're making major unrelated changes, for example (but not only) in alternating sign matrices. Do you really need that? Could those changes be moved to a different ticket?



---

archive/issue_comments_243161.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-08T21:47:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243161",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_243162.json:
```json
{
    "body": "Rebased above #18322.\n\nThe alternating sign matrices is now #18383. What are the other \"major unrelated changes\"?",
    "created_at": "2015-05-08T21:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243162",
    "user": "https://github.com/videlec"
}
```

Rebased above #18322.

The alternating sign matrices is now #18383. What are the other "major unrelated changes"?



---

archive/issue_comments_243163.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-08T21:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243163",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_243164.json:
```json
{
    "body": "I think having both `py_rich_to_bool_sgn` and `py_rich_to_bool` in Python is overkill. Since these are Python functions anyway, the overhead of the `_sgn` variant can be ignored.\n\nAnd I don't like most of your comment changes to `src/sage/structure/element.pyx`: if you implement just `_richcmp_`, then you don't need `__cmp__`, not even for `cmp()`. Why did you remove `or if that gives better performance`. And the `and are not identical (i.e. self is not other).` addition is also wrong I think.",
    "created_at": "2015-05-21T09:12:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243164",
    "user": "https://github.com/jdemeyer"
}
```

I think having both `py_rich_to_bool_sgn` and `py_rich_to_bool` in Python is overkill. Since these are Python functions anyway, the overhead of the `_sgn` variant can be ignored.

And I don't like most of your comment changes to `src/sage/structure/element.pyx`: if you implement just `_richcmp_`, then you don't need `__cmp__`, not even for `cmp()`. Why did you remove `or if that gives better performance`. And the `and are not identical (i.e. self is not other).` addition is also wrong I think.



---

archive/issue_comments_243165.json:
```json
{
    "body": "Also, there is no need for the `int` in\n\n```\ndef py_rich_to_bool_sgn(int op, int c)\n```\n(if we ever change the prototype of `rich_to_bool_sgn`, there is additional work for no reason)",
    "created_at": "2015-05-21T09:15:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243165",
    "user": "https://github.com/jdemeyer"
}
```

Also, there is no need for the `int` in

```
def py_rich_to_bool_sgn(int op, int c)
```
(if we ever change the prototype of `rich_to_bool_sgn`, there is additional work for no reason)



---

archive/issue_comments_243166.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-23T15:58:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243166",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_243167.json:
```json
{
    "body": "Rebased on 6.8.beta0.\n\nI took care of your comments.\n\nVincent",
    "created_at": "2015-05-23T16:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243167",
    "user": "https://github.com/videlec"
}
```

Rebased on 6.8.beta0.

I took care of your comments.

Vincent



---

archive/issue_comments_243168.json:
```json
{
    "body": "does not apply, needs rebase",
    "created_at": "2015-07-30T12:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243168",
    "user": "https://github.com/fchapoton"
}
```

does not apply, needs rebase



---

archive/issue_comments_243169.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-07-30T12:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243169",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_243170.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-06T15:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_events_051640.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-08-06T15:36:02Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18305#event-51640"
}
```



---

archive/issue_comments_243171.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-06T15:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243171",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_243172.json:
```json
{
    "body": "rebased on sage-6.9.beta1",
    "created_at": "2015-08-06T15:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243172",
    "user": "https://github.com/videlec"
}
```

rebased on sage-6.9.beta1



---

archive/issue_comments_243173.json:
```json
{
    "body": "See also #19108 which solves the same problem in a different (more complicated) way.",
    "created_at": "2015-08-28T06:11:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243173",
    "user": "https://github.com/jdemeyer"
}
```

See also #19108 which solves the same problem in a different (more complicated) way.



---

archive/issue_comments_243174.json:
```json
{
    "body": "Can you split off the changes to `src/sage/algebras` to a different ticket?",
    "created_at": "2015-09-08T13:33:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243174",
    "user": "https://github.com/jdemeyer"
}
```

Can you split off the changes to `src/sage/algebras` to a different ticket?



---

archive/issue_comments_243175.json:
```json
{
    "body": "Replace\n\n```\nIf you need to call this function from Cython prefer\n```\nby\n\n```\nDo not use this function from Cython. Instead, call\n```",
    "created_at": "2015-09-08T13:34:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243175",
    "user": "https://github.com/jdemeyer"
}
```

Replace

```
If you need to call this function from Cython prefer
```
by

```
Do not use this function from Cython. Instead, call
```



---

archive/issue_comments_243176.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-09-09T00:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243176",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_243177.json:
```json
{
    "body": "Replying to [comment:27 jdemeyer]:\n> Can you split off the changes to `src/sage/algebras` to a different ticket?\n\n\nIt is now #19170",
    "created_at": "2015-09-09T01:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243177",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:27 jdemeyer]:
> Can you split off the changes to `src/sage/algebras` to a different ticket?


It is now #19170



---

archive/issue_comments_243178.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-09-14T11:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243178",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_243179.json:
```json
{
    "body": "This is not good, you're adding back stuff which was removed:\n\n```diff\ndiff --git a/src/sage/structure/element.pyx b/src/sage/structure/element.pyx\nindex ede0157..4208a50 100644\n--- a/src/sage/structure/element.pyx\n+++ b/src/sage/structure/element.pyx\n@@ -1043,10 +1043,16 @@ cdef class Element(SageObject):\n             return rich_to_bool(op, -1)\n \n     ####################################################################\n-    # For a Cython class, you must define either _cmp_ (if your subclass\n-    # is totally ordered), _richcmp_ (if your subclass is partially\n-    # ordered), or both (if your class has both a total order and a\n-    # partial order, or if implementing both gives better performance).\n+    # For a derived Cython class, you **must** put the __richcmp__\n+    # method below in your subclasses, in order for it to take\n+    # advantage of the above generic comparison code. If you want to use cmp()\n+    # but did not implement a rich comparison, then you must copy paste the\n+    # __cmp__ method below.\n+    #\n+    # In a Cython or a Python class, you must define either _cmp_\n+    # (if your subclass is totally ordered), _richcmp_ (if your subclass\n+    # is partially ordered), or both (if your class has both a total order\n+    # and a partial order, or if that gives better performance).\n     #\n     # Rich comparisons (like a < b) will default to using _richcmp_,\n     # three-way comparisons (like cmp(a,b)) will default to using\n```",
    "created_at": "2015-09-14T11:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243179",
    "user": "https://github.com/jdemeyer"
}
```

This is not good, you're adding back stuff which was removed:

```diff
diff --git a/src/sage/structure/element.pyx b/src/sage/structure/element.pyx
index ede0157..4208a50 100644
--- a/src/sage/structure/element.pyx
+++ b/src/sage/structure/element.pyx
@@ -1043,10 +1043,16 @@ cdef class Element(SageObject):
             return rich_to_bool(op, -1)
 
     ####################################################################
-    # For a Cython class, you must define either _cmp_ (if your subclass
-    # is totally ordered), _richcmp_ (if your subclass is partially
-    # ordered), or both (if your class has both a total order and a
-    # partial order, or if implementing both gives better performance).
+    # For a derived Cython class, you **must** put the __richcmp__
+    # method below in your subclasses, in order for it to take
+    # advantage of the above generic comparison code. If you want to use cmp()
+    # but did not implement a rich comparison, then you must copy paste the
+    # __cmp__ method below.
+    #
+    # In a Cython or a Python class, you must define either _cmp_
+    # (if your subclass is totally ordered), _richcmp_ (if your subclass
+    # is partially ordered), or both (if your class has both a total order
+    # and a partial order, or if that gives better performance).
     #
     # Rich comparisons (like a < b) will default to using _richcmp_,
     # three-way comparisons (like cmp(a,b)) will default to using
```



---

archive/issue_comments_243180.json:
```json
{
    "body": "`Py_EQ` should be `op_EQ` here:\n\n```\n    INPUT:\n\n    - ``op`` -- a rich comparison operation (e.g. ``Py_EQ``)\n```\n\n`c` can be any integer, not only -1, 0 or 1:\n\n```\n    - ``c`` -- the result of an ordinary comparison: -1, 0 or 1.\n```\n\nNo trailing slash needed:\n\n```\n        sage: from sage.structure.sage_object import (py_rich_to_bool, \\\n        ....:    op_EQ, op_NE, op_LT, op_LE, op_GT, op_GE)\n```",
    "created_at": "2015-09-14T11:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243180",
    "user": "https://github.com/jdemeyer"
}
```

`Py_EQ` should be `op_EQ` here:

```
    INPUT:

    - ``op`` -- a rich comparison operation (e.g. ``Py_EQ``)
```

`c` can be any integer, not only -1, 0 or 1:

```
    - ``c`` -- the result of an ordinary comparison: -1, 0 or 1.
```

No trailing slash needed:

```
        sage: from sage.structure.sage_object import (py_rich_to_bool, \
        ....:    op_EQ, op_NE, op_LT, op_LE, op_GT, op_GE)
```



---

archive/issue_comments_243181.json:
```json
{
    "body": "Please keep the doctests for `IndexedMonoidElement.__ne__` like you did for the other comparisons.",
    "created_at": "2015-09-14T11:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243181",
    "user": "https://github.com/jdemeyer"
}
```

Please keep the doctests for `IndexedMonoidElement.__ne__` like you did for the other comparisons.



---

archive/issue_comments_243182.json:
```json
{
    "body": "```\n$ pyflakes src/sage/geometry/newton_polygon.py\nsrc/sage/geometry/newton_polygon.py:20: 'op_GT' imported but unused\nsrc/sage/geometry/newton_polygon.py:20: 'py_rich_to_bool' imported but unused\n```",
    "created_at": "2015-09-14T12:04:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243182",
    "user": "https://github.com/jdemeyer"
}
```

```
$ pyflakes src/sage/geometry/newton_polygon.py
src/sage/geometry/newton_polygon.py:20: 'op_GT' imported but unused
src/sage/geometry/newton_polygon.py:20: 'py_rich_to_bool' imported but unused
```



---

archive/issue_comments_243183.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-09-14T17:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243183",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_243184.json:
```json
{
    "body": "Hello Jeroen,\n\nI rebased on the latest beta taking care of all your remarks.\n\nVincent",
    "created_at": "2015-09-14T17:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243184",
    "user": "https://github.com/videlec"
}
```

Hello Jeroen,

I rebased on the latest beta taking care of all your remarks.

Vincent



---

archive/issue_comments_243185.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-14T17:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243185",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_243186.json:
```json
{
    "body": "Replying to [comment:36 vdelecroix]:\n> I rebased on the latest beta taking care of all your remarks.\n\n\nGeneral comment: you should not rebase a branch which is being reviewed. For example, it is difficult for me to see what you changed since last time, which essentially forces me to re-review everything again.",
    "created_at": "2015-09-14T18:50:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243186",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:36 vdelecroix]:
> I rebased on the latest beta taking care of all your remarks.


General comment: you should not rebase a branch which is being reviewed. For example, it is difficult for me to see what you changed since last time, which essentially forces me to re-review everything again.



---

archive/issue_comments_243187.json:
```json
{
    "body": "If you tell me, I can move back my changes on top of the previous commits. Sorry.",
    "created_at": "2015-09-14T22:27:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243187",
    "user": "https://github.com/videlec"
}
```

If you tell me, I can move back my changes on top of the previous commits. Sorry.



---

archive/issue_comments_243188.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-17T11:42:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243188",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_243189.json:
```json
{
    "body": "Thanks Jeroen. And again, I am sorry for the too early rebase.\n\nVincent",
    "created_at": "2015-09-17T11:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243189",
    "user": "https://github.com/videlec"
}
```

Thanks Jeroen. And again, I am sorry for the too early rebase.

Vincent



---

archive/issue_comments_243190.json:
```json
{
    "body": "Replying to [comment:41 vdelecroix]:\n> Thanks Jeroen. And again, I am sorry for the too early rebase.\n\n\nWhy \"too early\"? I don't think a ticket under review should be rebased at all.\n\nRebasing before review is fine for me.",
    "created_at": "2015-09-17T13:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243190",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:41 vdelecroix]:
> Thanks Jeroen. And again, I am sorry for the too early rebase.


Why "too early"? I don't think a ticket under review should be rebased at all.

Rebasing before review is fine for me.



---

archive/issue_comments_243191.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-09-18T13:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18305#issuecomment-243191",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_051641.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-09-18T13:03:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18305",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18305#event-51641"
}
```
