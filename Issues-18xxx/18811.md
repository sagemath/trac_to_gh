# Issue 18811: Boost Clustering Coefficient

archive/issues_018574.json:
```json
{
    "body": "Apply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.\n\nDepends on #18564\n\n**CC:**  @nathanncohen @dcoudert\n\n**Keywords:** Local clustering coefficient, Boost\n\n**Branch/Commit:** [582ce3466d9dff303532a84f9738cdd4f581d5a9](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)\n\n**Reviewer:** Nathann Cohen\n\n**Author:** Michele Borassi\n\nIssue created by migration from https://trac.sagemath.org/ticket/18811\n\n",
    "closed_at": "2015-07-02T22:32:45Z",
    "created_at": "2015-06-29T10:38:16Z",
    "labels": [
        "component: graph theory",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "title": "Boost Clustering Coefficient",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/18811",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```
Apply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.

Depends on #18564

**CC:**  @nathanncohen @dcoudert

**Keywords:** Local clustering coefficient, Boost

**Branch/Commit:** [582ce3466d9dff303532a84f9738cdd4f581d5a9](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)

**Reviewer:** Nathann Cohen

**Author:** Michele Borassi

Issue created by migration from https://trac.sagemath.org/ticket/18811





---

archive/issue_comments_265305.json:
```json
{
    "body": "**Branch:** [u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)",
    "created_at": "2015-06-30T07:40:22Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265305",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

**Branch:** [u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)



---

archive/issue_comments_265306.json:
```json
{
    "body": "<a id='comment:3'></a>\nHello!\nI have implemented the computation of the local clustering coefficient through Boost. The improvement is not as striking as the edge connectivity, but it is still a 10x improvement, more or less. Some benchmarks:\n\n```\nsage: g = graphs.RandomGNM(20000,100000)\nsage: %timeit g.clustering_coeff(implementation='boost')\n10 loops, best of 3: 258 ms per loop\nsage: %timeit g.clustering_coeff(implementation='networkx')\n1 loops, best of 3: 3.99 s per loop\n```\n\n```\nsage: g = graphs.CompleteGraph(300)\nsage: %timeit g.clustering_coeff(implementation='boost')\n1 loops, best of 3: 6.14 s per loop\nsage: %timeit g.clustering_coeff(implementation='networkx')\n1 loops, best of 3: 1min 3s per loop\n```\n\n```\nsage: g = graphs.RandomGNM(10000,1000000)\nsage: %timeit g.clustering_coeff(implementation='networkx',nodes=range(30))\n1 loops, best of 3: 13.1 s per loop\nsage: %timeit g.clustering_coeff(implementation='boost',nodes=range(30))\n1 loops, best of 3: 1.55 s per loop\n```\nI hope you like it!",
    "created_at": "2015-06-30T07:43:11Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265306",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:3'></a>
Hello!
I have implemented the computation of the local clustering coefficient through Boost. The improvement is not as striking as the edge connectivity, but it is still a 10x improvement, more or less. Some benchmarks:

```
sage: g = graphs.RandomGNM(20000,100000)
sage: %timeit g.clustering_coeff(implementation='boost')
10 loops, best of 3: 258 ms per loop
sage: %timeit g.clustering_coeff(implementation='networkx')
1 loops, best of 3: 3.99 s per loop
```

```
sage: g = graphs.CompleteGraph(300)
sage: %timeit g.clustering_coeff(implementation='boost')
1 loops, best of 3: 6.14 s per loop
sage: %timeit g.clustering_coeff(implementation='networkx')
1 loops, best of 3: 1min 3s per loop
```

```
sage: g = graphs.RandomGNM(10000,1000000)
sage: %timeit g.clustering_coeff(implementation='networkx',nodes=range(30))
1 loops, best of 3: 13.1 s per loop
sage: %timeit g.clustering_coeff(implementation='boost',nodes=range(30))
1 loops, best of 3: 1.55 s per loop
```
I hope you like it!



---

archive/issue_comments_265307.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Apply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.\n``````\n",
    "created_at": "2015-06-30T07:43:11Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265307",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Apply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.
``````




---

archive/issue_comments_265308.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"Local clustering coefficient, Boost\".",
    "created_at": "2015-06-30T07:43:11Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265308",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

**Changing keywords** from "" to "Local clustering coefficient, Boost".



---

archive/issue_comments_265309.json:
```json
{
    "body": "**Commit:** [283c61be9357902ff555843b27c0ffed6fed6ea4](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)",
    "created_at": "2015-06-30T07:43:11Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265309",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

**Commit:** [283c61be9357902ff555843b27c0ffed6fed6ea4](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)



---

archive/issue_comments_265310.json:
```json
{
    "body": "**Author:** Michele Borassi",
    "created_at": "2015-06-30T07:43:11Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265310",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

**Author:** Michele Borassi



---

archive/issue_events_169105.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/borassi",
    "created_at": "2015-06-30T07:43:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169105"
}
```



---

archive/issue_events_169106.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/borassi",
    "created_at": "2015-06-30T07:43:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "enhancement",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169106"
}
```



---

archive/issue_comments_265311.json:
```json
{
    "body": "**Dependencies:** 18564",
    "created_at": "2015-06-30T07:43:11Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265311",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

**Dependencies:** 18564



---

archive/issue_events_169107.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/borassi",
    "created_at": "2015-06-30T07:43:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "component: graph theory",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169107"
}
```



---

archive/issue_comments_265312.json:
```json
{
    "body": "<a id='comment:4'></a>\n> I hope you like it!\n\n\nAhahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`\n\nNathann",
    "created_at": "2015-06-30T07:44:24Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265312",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
> I hope you like it!


Ahahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`

Nathann



---

archive/issue_comments_265313.json:
```json
{
    "body": "<a id='comment:5'></a>\n> Ahahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`\n\n\nI'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.",
    "created_at": "2015-06-30T07:48:43Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265313",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:5'></a>
> Ahahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`


I'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.



---

archive/issue_comments_265314.json:
```json
{
    "body": "<a id='comment:6'></a>\n> I'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.\n\n\nSage's timings should be approximately those of `triangle_count`.",
    "created_at": "2015-06-30T07:50:20Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265314",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>
> I'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.


Sage's timings should be approximately those of `triangle_count`.



---

archive/issue_comments_265315.json:
```json
{
    "body": "<a id='comment:7'></a>\nHellooooooo Michele,\n\n- About `boost_clustering_coeff` -- to me it makes more sense if this function,\n  meant to apply to a boost graph, does not take a Sage graph as input. You only\n  need it to get the vertices' correct label, but you only need this at a higher\n  level. Returning a dictionary associating the coeffcient to each (integer)\n  vertex is not very expensive considering the computations you do, and so you\n  can afford to relabel it higher.\n\n- Could you define \"local clustering\" somewhere? Is it any different from the\n  'clustering coefficient of a vertex'?\n\n- Could you add an INPUT block to `cpdef clustering_coeff`?\n\n- Same function -- by using a `sig_check` instead of `sig_on/off` it is\n  impossible to interrupt the function while `boost_resulting_coeff` is\n  running. It will only be interrupted when the function returns.\n\n- Could you rename 'cc' to 'average_clustering_coefficient'? When you need a\n  comment to say what a variable is, it often means that you should rename the\n  variable.\n\n- in `clustering_average` -- could you document the default behaviour of\n  `implementation=None`? (you did it in `clustering_coeff` already).\n\n- You should not indent the *text* after a 'TESTS:' block (like it is done for\n  'INPUT:'). Usually, you only need to indent text in the documentation after a\n  '::'.\n\n- Instead of `weight==False`, it is better to use 'not weight'. Handles better\n  something like `weight=0` (faster to type `:-P`)\n\nLooks very good!\n\nThanks,\n\nNathann",
    "created_at": "2015-06-30T09:16:46Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265315",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:7'></a>
Hellooooooo Michele,

- About `boost_clustering_coeff` -- to me it makes more sense if this function,
  meant to apply to a boost graph, does not take a Sage graph as input. You only
  need it to get the vertices' correct label, but you only need this at a higher
  level. Returning a dictionary associating the coeffcient to each (integer)
  vertex is not very expensive considering the computations you do, and so you
  can afford to relabel it higher.

- Could you define "local clustering" somewhere? Is it any different from the
  'clustering coefficient of a vertex'?

- Could you add an INPUT block to `cpdef clustering_coeff`?

- Same function -- by using a `sig_check` instead of `sig_on/off` it is
  impossible to interrupt the function while `boost_resulting_coeff` is
  running. It will only be interrupted when the function returns.

- Could you rename 'cc' to 'average_clustering_coefficient'? When you need a
  comment to say what a variable is, it often means that you should rename the
  variable.

- in `clustering_average` -- could you document the default behaviour of
  `implementation=None`? (you did it in `clustering_coeff` already).

- You should not indent the *text* after a 'TESTS:' block (like it is done for
  'INPUT:'). Usually, you only need to indent text in the documentation after a
  '::'.

- Instead of `weight==False`, it is better to use 'not weight'. Handles better
  something like `weight=0` (faster to type `:-P`)

Looks very good!

Thanks,

Nathann



---

archive/issue_events_169108.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-30T09:16:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169108"
}
```



---

archive/issue_events_169109.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-30T09:16:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169109"
}
```



---

archive/issue_comments_265316.json:
```json
{
    "body": "<a id='comment:9'></a>\nHello,\n\nI have not checked the code yet.\n\nNathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)\nThe idea is to compute the number of triangles incident to each edge, and then to compute the number of triangles incident to a given vertex.\n\nDavid.",
    "created_at": "2015-06-30T09:17:48Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265316",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:9'></a>
Hello,

I have not checked the code yet.

Nathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)
The idea is to compute the number of triangles incident to each edge, and then to compute the number of triangles incident to a given vertex.

David.



---

archive/issue_comments_265317.json:
```json
{
    "body": "**Changing commit** from \"[283c61be9357902ff555843b27c0ffed6fed6ea4](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)\" to \"[18bd01ab82cf0b9d064d4fe680f17df908bed0da](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)\".",
    "created_at": "2015-06-30T18:09:13Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265317",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[283c61be9357902ff555843b27c0ffed6fed6ea4](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)" to "[18bd01ab82cf0b9d064d4fe680f17df908bed0da](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)".



---

archive/issue_comments_265318.json:
```json
{
    "body": "<a id='comment:10'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da\">18bd01a</a></td><td><code>Applied Nathann's suggestions</code></td></tr></table>\n",
    "created_at": "2015-06-30T18:09:13Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265318",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da">18bd01a</a></td><td><code>Applied Nathann's suggestions</code></td></tr></table>




---

archive/issue_comments_265319.json:
```json
{
    "body": "<a id='comment:11'></a>\nI do not change the status to \"needs_review\", yet, because I'm a bit tired and I'd like to check my work tomorrow morning.",
    "created_at": "2015-06-30T18:10:44Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265319",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:11'></a>
I do not change the status to "needs_review", yet, because I'm a bit tired and I'd like to check my work tomorrow morning.



---

archive/issue_comments_265320.json:
```json
{
    "body": "<a id='comment:12'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064\">99bd994</a></td><td><code>Few corrections in the reference manual</code></td></tr></table>\n",
    "created_at": "2015-07-01T08:12:13Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265320",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064">99bd994</a></td><td><code>Few corrections in the reference manual</code></td></tr></table>




---

archive/issue_comments_265321.json:
```json
{
    "body": "**Changing commit** from \"[18bd01ab82cf0b9d064d4fe680f17df908bed0da](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)\" to \"[99bd994335f70455d898c83f1a13b3d38e8f5064](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)\".",
    "created_at": "2015-07-01T08:12:13Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265321",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[18bd01ab82cf0b9d064d4fe680f17df908bed0da](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)" to "[99bd994335f70455d898c83f1a13b3d38e8f5064](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)".



---

archive/issue_comments_265322.json:
```json
{
    "body": "<a id='comment:13'></a>\nHelloooooooo!\n\n> \n> - About `boost_clustering_coeff` -- to me it makes more sense if this function,\n> meant to apply to a boost graph, does not take a Sage graph as input. You only\n> need it to get the vertices' correct label, but you only need this at a higher\n> level. Returning a dictionary associating the coeffcient to each (integer)\n> vertex is not very expensive considering the computations you do, and so you\n> can afford to relabel it higher.\n\n\nOops, I wrote it like this to test if it worked, and I forgot to change it. By solving this issue, I also have found problems if the vertex label is not an integer, I corrected it, and I added a doctest.\n\n> \n> - Could you define \"local clustering\" somewhere? Is it any different from the\n> 'clustering coefficient of a vertex'?\n\n\nIt is exactly the same (https://en.wikipedia.org/wiki/Clustering_coefficient#Local_clustering_coefficient): I decided to remove \"local\" from all comments.\n\n> \n> - Could you add an INPUT block to `cpdef clustering_coeff`?\n\n\nDone!\n\n> - Same function -- by using a `sig_check` instead of `sig_on/off` it is\n> impossible to interrupt the function while `boost_resulting_coeff` is\n> running. It will only be interrupted when the function returns.\n\n\nDone! Now I use sig_on/off.\n\n> - Could you rename 'cc' to 'average_clustering_coefficient'? When you need a\n> comment to say what a variable is, it often means that you should rename the\n> variable.\n\n\nDone!\n\n> - in `clustering_average` -- could you document the default behaviour of\n> `implementation=None`? (you did it in `clustering_coeff` already).\n\n\nDone\n\n> - You should not indent the *text* after a 'TESTS:' block (like it is done for\n> 'INPUT:'). Usually, you only need to indent text in the documentation after a\n> '::'.\n\n\nDone!\n\n> - Instead of `weight==False`, it is better to use 'not weight'. Handles better\n> something like `weight=0` (faster to type `:-P`)\n\n\nDone!",
    "created_at": "2015-07-01T08:16:59Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265322",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:13'></a>
Helloooooooo!

> 
> - About `boost_clustering_coeff` -- to me it makes more sense if this function,
> meant to apply to a boost graph, does not take a Sage graph as input. You only
> need it to get the vertices' correct label, but you only need this at a higher
> level. Returning a dictionary associating the coeffcient to each (integer)
> vertex is not very expensive considering the computations you do, and so you
> can afford to relabel it higher.


Oops, I wrote it like this to test if it worked, and I forgot to change it. By solving this issue, I also have found problems if the vertex label is not an integer, I corrected it, and I added a doctest.

> 
> - Could you define "local clustering" somewhere? Is it any different from the
> 'clustering coefficient of a vertex'?


It is exactly the same (https://en.wikipedia.org/wiki/Clustering_coefficient#Local_clustering_coefficient): I decided to remove "local" from all comments.

> 
> - Could you add an INPUT block to `cpdef clustering_coeff`?


Done!

> - Same function -- by using a `sig_check` instead of `sig_on/off` it is
> impossible to interrupt the function while `boost_resulting_coeff` is
> running. It will only be interrupted when the function returns.


Done! Now I use sig_on/off.

> - Could you rename 'cc' to 'average_clustering_coefficient'? When you need a
> comment to say what a variable is, it often means that you should rename the
> variable.


Done!

> - in `clustering_average` -- could you document the default behaviour of
> `implementation=None`? (you did it in `clustering_coeff` already).


Done

> - You should not indent the *text* after a 'TESTS:' block (like it is done for
> 'INPUT:'). Usually, you only need to indent text in the documentation after a
> '::'.


Done!

> - Instead of `weight==False`, it is better to use 'not weight'. Handles better
> something like `weight=0` (faster to type `:-P`)


Done!



---

archive/issue_events_169110.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/borassi",
    "created_at": "2015-07-01T08:16:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169110"
}
```



---

archive/issue_events_169111.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/borassi",
    "created_at": "2015-07-01T08:16:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169111"
}
```



---

archive/issue_comments_265323.json:
```json
{
    "body": "<a id='comment:14'></a>\n> Nathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)\n\n\nSage does have something like that, too. It would only require minor changes to what was added in #18250.\n\nNathann",
    "created_at": "2015-07-01T09:40:03Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265323",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>
> Nathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)


Sage does have something like that, too. It would only require minor changes to what was added in #18250.

Nathann



---

archive/issue_comments_265324.json:
```json
{
    "body": "**Reviewer:** Nathann Cohen",
    "created_at": "2015-07-01T10:10:21Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265324",
    "user": "https://github.com/nathanncohen"
}
```

**Reviewer:** Nathann Cohen



---

archive/issue_comments_265325.json:
```json
{
    "body": "<a id='comment:15'></a>\nHello Michele,\n\nThanks for your updates. I added a commit at public/18811, and if you agree with it then you can add it to the branch and this ticket can go.\n\nHere are the modifications I made:\n- remove trailing whitespaces\n- The function `boost_clustering_coeff` claimed to accept 'None' as a list of vertices, but did not\n- `len(clust_of_v.values())` is equal to `len(clust_of_v)`\n- `{g.vertices()[v]: clust_v_int[v] for v in vertices_boost`} this line calls `g.vertices()` for each `[v]`.\n- You can use 'tolerance' for tests like `sage: abs(G.clustering_average(implementation='boost') - G.clustering_average(implementation='networkx')) < 1E-12`\n\nHave fuuuuuuuuun,\n\nNathann",
    "created_at": "2015-07-01T10:10:21Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265325",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>
Hello Michele,

Thanks for your updates. I added a commit at public/18811, and if you agree with it then you can add it to the branch and this ticket can go.

Here are the modifications I made:
- remove trailing whitespaces
- The function `boost_clustering_coeff` claimed to accept 'None' as a list of vertices, but did not
- `len(clust_of_v.values())` is equal to `len(clust_of_v)`
- `{g.vertices()[v]: clust_v_int[v] for v in vertices_boost`} this line calls `g.vertices()` for each `[v]`.
- You can use 'tolerance' for tests like `sage: abs(G.clustering_average(implementation='boost') - G.clustering_average(implementation='networkx')) < 1E-12`

Have fuuuuuuuuun,

Nathann



---

archive/issue_comments_265326.json:
```json
{
    "body": "**Changing commit** from \"[99bd994335f70455d898c83f1a13b3d38e8f5064](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)\" to \"[6c8d49bc6d0101f897c489124d52c5e4a252a959](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)\".",
    "created_at": "2015-07-01T10:30:13Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265326",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[99bd994335f70455d898c83f1a13b3d38e8f5064](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)" to "[6c8d49bc6d0101f897c489124d52c5e4a252a959](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)".



---

archive/issue_comments_265327.json:
```json
{
    "body": "<a id='comment:16'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40df844cee8e59bc4bb57f5d7f4374e009053cb3\">40df844</a></td><td><code>trac #18811: Review</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959\">6c8d49b</a></td><td><code>More reviewer comments</code></td></tr></table>\n",
    "created_at": "2015-07-01T10:30:13Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265327",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:16'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40df844cee8e59bc4bb57f5d7f4374e009053cb3">40df844</a></td><td><code>trac #18811: Review</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959">6c8d49b</a></td><td><code>More reviewer comments</code></td></tr></table>




---

archive/issue_comments_265328.json:
```json
{
    "body": "<a id='comment:17'></a>\nHey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.\n\nNathann",
    "created_at": "2015-07-01T10:32:16Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265328",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>
Hey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.

Nathann



---

archive/issue_comments_265329.json:
```json
{
    "body": "<a id='comment:18'></a>\nSorry, I didn't realize you modified the code... That's why I modified the doc, I thought you forgot a commit, or something like that. In my opinion, it is better to modify the doc, for simplicity!\n\nBTW, how can I use 'tolerance' in the other test?\n\n```\nsage: G = graphs.RandomGNM(10,20)\nsage: clust_boost = G.clustering_coeff(implementation='boost')\nsage: clust_networkx = G.clustering_coeff(implementation='networkx')\nsage: for v in G.vertices():\n....:     if abs(clust_boost[v] - clust_networkx[v]) > 1E-12:\n....:         print \"Error:\"\n....:         print \"   Boost clustering of\", v, \"is\", clust_boost[v]\n....:         print \"NetworkX clustering of\", v, \"is\", clust_networkx[v]\n\n```\nReplying to [ncohen](#comment%3A17):\n\n\n> Hey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.\n> \n> Nathann\n",
    "created_at": "2015-07-01T10:36:12Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265329",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:18'></a>
Sorry, I didn't realize you modified the code... That's why I modified the doc, I thought you forgot a commit, or something like that. In my opinion, it is better to modify the doc, for simplicity!

BTW, how can I use 'tolerance' in the other test?

```
sage: G = graphs.RandomGNM(10,20)
sage: clust_boost = G.clustering_coeff(implementation='boost')
sage: clust_networkx = G.clustering_coeff(implementation='networkx')
sage: for v in G.vertices():
....:     if abs(clust_boost[v] - clust_networkx[v]) > 1E-12:
....:         print "Error:"
....:         print "   Boost clustering of", v, "is", clust_boost[v]
....:         print "NetworkX clustering of", v, "is", clust_networkx[v]

```
Replying to [ncohen](#comment%3A17):


> Hey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.
> 
> Nathann




---

archive/issue_comments_265330.json:
```json
{
    "body": "<a id='comment:19'></a>\nHelloooooo,\n\n> In my opinion, it is better to modify the doc, for simplicity!\n\n\nNo problem for me. But please update the code too, in this case.\n\n> BTW, how can I use 'tolerance' in the other test?\n\n\nI think that it could work by adding the same 'tol' flag on all lnes of the loop. Not sure, you have to try `^^;`\n\nhttp://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-tests\n\nNathann",
    "created_at": "2015-07-01T10:38:54Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265330",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:19'></a>
Helloooooo,

> In my opinion, it is better to modify the doc, for simplicity!


No problem for me. But please update the code too, in this case.

> BTW, how can I use 'tolerance' in the other test?


I think that it could work by adding the same 'tol' flag on all lnes of the loop. Not sure, you have to try `^^;`

http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-tests

Nathann



---

archive/issue_comments_265331.json:
```json
{
    "body": "<a id='comment:20'></a>\nOOOppss nononono sorry. Given that your doctest does not print anything when it works, I'd say that it is easier to understand it this way. Otherwise you would have to add lines and lines of useless '0'.\n\nBy the way, you can write 'for v in G' instead of 'for v in G.vertices()'.\n\nHave fuuuuun,\n\nNathann",
    "created_at": "2015-07-01T10:40:03Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265331",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:20'></a>
OOOppss nononono sorry. Given that your doctest does not print anything when it works, I'd say that it is easier to understand it this way. Otherwise you would have to add lines and lines of useless '0'.

By the way, you can write 'for v in G' instead of 'for v in G.vertices()'.

Have fuuuuun,

Nathann



---

archive/issue_comments_265332.json:
```json
{
    "body": "<a id='comment:21'></a>\n> Sage does have something like that, too. It would only require minor changes to what was added in #18250.\n\n\nDone at #18834. I will rebase it on top of this patch when it will be in positive review.\n\nNathann",
    "created_at": "2015-07-01T12:50:46Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265332",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:21'></a>
> Sage does have something like that, too. It would only require minor changes to what was added in #18250.


Done at #18834. I will rebase it on top of this patch when it will be in positive review.

Nathann



---

archive/issue_comments_265333.json:
```json
{
    "body": "<a id='comment:22'></a>\n**Branch pushed to git repo; I updated commit sha1.** **New commits:**\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c365d0294528fac6b0487b48996da831efc96c44\">c365d02</a></td><td><code>Removed \"vertices is None\" from boost_clustering_coeff</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9\">582ce34</a></td><td><code>Changed for v in G.vertices() => for v in G</code></td></tr></table>\n",
    "created_at": "2015-07-02T07:46:52Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265333",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:22'></a>
**Branch pushed to git repo; I updated commit sha1.** **New commits:**
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c365d0294528fac6b0487b48996da831efc96c44">c365d02</a></td><td><code>Removed "vertices is None" from boost_clustering_coeff</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9">582ce34</a></td><td><code>Changed for v in G.vertices() => for v in G</code></td></tr></table>




---

archive/issue_comments_265334.json:
```json
{
    "body": "**Changing commit** from \"[6c8d49bc6d0101f897c489124d52c5e4a252a959](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)\" to \"[582ce3466d9dff303532a84f9738cdd4f581d5a9](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)\".",
    "created_at": "2015-07-02T07:46:52Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265334",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

**Changing commit** from "[6c8d49bc6d0101f897c489124d52c5e4a252a959](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)" to "[582ce3466d9dff303532a84f9738cdd4f581d5a9](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)".



---

archive/issue_comments_265335.json:
```json
{
    "body": "<a id='comment:23'></a>\nFor me, now the patch is good to go!",
    "created_at": "2015-07-02T07:55:56Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265335",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:23'></a>
For me, now the patch is good to go!



---

archive/issue_events_169112.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-02T08:12:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169112"
}
```



---

archive/issue_events_169113.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-02T08:12:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169113"
}
```



---

archive/issue_comments_265336.json:
```json
{
    "body": "<a id='comment:24'></a>\nOkayyyy, then let it go.\n\nNathann",
    "created_at": "2015-07-02T08:12:32Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265336",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:24'></a>
Okayyyy, then let it go.

Nathann



---

archive/issue_comments_265337.json:
```json
{
    "body": "**Changing branch** from \"[u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)\" to \"[582ce3466d9dff303532a84f9738cdd4f581d5a9](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)\".",
    "created_at": "2015-07-02T22:32:45Z",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-265337",
    "user": "https://github.com/vbraun"
}
```

**Changing branch** from "[u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)" to "[582ce3466d9dff303532a84f9738cdd4f581d5a9](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)".



---

archive/issue_events_169114.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-02T22:32:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169114"
}
```



---

archive/issue_events_169115.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "c649ee5273ae48188498f7e00fc0444782d916b5",
    "created_at": "2015-07-02T22:32:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-169115"
}
```
