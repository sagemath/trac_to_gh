# Issue 18811: Boost Clustering Coefficient

archive/issues_018574.json:
```json
{
    "assignees": [],
    "body": "<div id=\"comment:0\"></div>\n\nApply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.\n\nDepends on #18564\n\nCC:  @nathanncohen @dcoudert\n\nComponent: **graph theory**\n\nKeywords: **Local clustering coefficient, Boost**\n\nAuthor: **Michele Borassi**\n\nBranch/Commit: **[`582ce34`](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)**\n\nReviewer: **Nathann Cohen**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18811_\n\n",
    "closed_at": "2015-07-02T22:32:45Z",
    "created_at": "2015-06-29T10:38:16Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Boost Clustering Coefficient",
    "type": "issue",
    "updated_at": "2015-07-02T22:32:45Z",
    "url": "https://github.com/sagemath/sage/issues/18811",
    "user": "https://github.com/sagetrac-borassi"
}
```
<div id="comment:0"></div>

Apply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.

Depends on #18564

CC:  @nathanncohen @dcoudert

Component: **graph theory**

Keywords: **Local clustering coefficient, Boost**

Author: **Michele Borassi**

Branch/Commit: **[`582ce34`](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)**

Reviewer: **Nathann Cohen**

_Issue created by migration from https://trac.sagemath.org/ticket/18811_





---

archive/issue_events_264734.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-29T10:38:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264734"
}
```



---

archive/issue_events_264735.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-29T10:38:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264735"
}
```



---

archive/issue_comments_262762.json:
```json
{
    "body": "Branch: **[u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)**",
    "created_at": "2015-06-30T07:40:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262762",
    "user": "https://github.com/sagetrac-borassi"
}
```

Branch: **[u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)**



---

archive/issue_comments_262763.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nHello!\nI have implemented the computation of the local clustering coefficient through Boost. The improvement is not as striking as the edge connectivity, but it is still a 10x improvement, more or less. Some benchmarks:\n\n```\nsage: g = graphs.RandomGNM(20000,100000)\nsage: %timeit g.clustering_coeff(implementation='boost')\n10 loops, best of 3: 258 ms per loop\nsage: %timeit g.clustering_coeff(implementation='networkx')\n1 loops, best of 3: 3.99 s per loop\n```\n\n```\nsage: g = graphs.CompleteGraph(300)\nsage: %timeit g.clustering_coeff(implementation='boost')\n1 loops, best of 3: 6.14 s per loop\nsage: %timeit g.clustering_coeff(implementation='networkx')\n1 loops, best of 3: 1min 3s per loop\n```\n\n```\nsage: g = graphs.RandomGNM(10000,1000000)\nsage: %timeit g.clustering_coeff(implementation='networkx',nodes=range(30))\n1 loops, best of 3: 13.1 s per loop\nsage: %timeit g.clustering_coeff(implementation='boost',nodes=range(30))\n1 loops, best of 3: 1.55 s per loop\n```\nI hope you like it!",
    "created_at": "2015-06-30T07:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262763",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:3" align="right">comment:3</div>

Hello!
I have implemented the computation of the local clustering coefficient through Boost. The improvement is not as striking as the edge connectivity, but it is still a 10x improvement, more or less. Some benchmarks:

```
sage: g = graphs.RandomGNM(20000,100000)
sage: %timeit g.clustering_coeff(implementation='boost')
10 loops, best of 3: 258 ms per loop
sage: %timeit g.clustering_coeff(implementation='networkx')
1 loops, best of 3: 3.99 s per loop
```

```
sage: g = graphs.CompleteGraph(300)
sage: %timeit g.clustering_coeff(implementation='boost')
1 loops, best of 3: 6.14 s per loop
sage: %timeit g.clustering_coeff(implementation='networkx')
1 loops, best of 3: 1min 3s per loop
```

```
sage: g = graphs.RandomGNM(10000,1000000)
sage: %timeit g.clustering_coeff(implementation='networkx',nodes=range(30))
1 loops, best of 3: 13.1 s per loop
sage: %timeit g.clustering_coeff(implementation='boost',nodes=range(30))
1 loops, best of 3: 1.55 s per loop
```
I hope you like it!



---

archive/issue_comments_262764.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-\n+Apply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.\n``````\n",
    "created_at": "2015-06-30T07:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262764",
    "user": "https://github.com/sagetrac-borassi"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-
+Apply Boost algorithm for computing the clustering coefficient, using the interface of Ticket !#18564.
``````




---

archive/issue_comments_262765.json:
```json
{
    "body": "Changed keywords from none to **Local clustering coefficient, Boost**",
    "created_at": "2015-06-30T07:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262765",
    "user": "https://github.com/sagetrac-borassi"
}
```

Changed keywords from none to **Local clustering coefficient, Boost**



---

archive/issue_comments_262766.json:
```json
{
    "body": "Commit: **[`283c61b`](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)**",
    "created_at": "2015-06-30T07:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262766",
    "user": "https://github.com/sagetrac-borassi"
}
```

Commit: **[`283c61b`](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)**



---

archive/issue_comments_262767.json:
```json
{
    "body": "Author: **Michele Borassi**",
    "created_at": "2015-06-30T07:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262767",
    "user": "https://github.com/sagetrac-borassi"
}
```

Author: **Michele Borassi**



---

archive/issue_events_264736.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-30T07:43:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264736"
}
```



---

archive/issue_events_264737.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-30T07:43:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264737"
}
```



---

archive/issue_comments_262768.json:
```json
{
    "body": "Dependencies: **18564**",
    "created_at": "2015-06-30T07:43:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262768",
    "user": "https://github.com/sagetrac-borassi"
}
```

Dependencies: **18564**



---

archive/issue_events_264738.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-30T07:43:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264738"
}
```



---

archive/issue_comments_262769.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\n> I hope you like it!\n\nAhahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`\n\nNathann",
    "created_at": "2015-06-30T07:44:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262769",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:4" align="right">comment:4</div>

> I hope you like it!

Ahahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`

Nathann



---

archive/issue_comments_262770.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n> Ahahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`\n\nI'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.",
    "created_at": "2015-06-30T07:48:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262770",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:5" align="right">comment:5</div>

> Ahahahah. I do! But the first thing I will do once this thing is reviewed is to see if I can beat it `:-P`

I'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.



---

archive/issue_comments_262771.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\n> I'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.\n\nSage's timings should be approximately those of `triangle_count`.",
    "created_at": "2015-06-30T07:50:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262771",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:6" align="right">comment:6</div>

> I'm pretty sure you can: to intersect two neighbors, Boost algorithm iterates over both adjacencies in time O(d_1d_2), where d_1 and d_2 are the degrees. Using binary trees instead of vectors, you could do it in O(d_1 log d_2), or viceversa.

Sage's timings should be approximately those of `triangle_count`.



---

archive/issue_comments_262772.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nHellooooooo Michele,\n\n- About `boost_clustering_coeff` -- to me it makes more sense if this function,\n  meant to apply to a boost graph, does not take a Sage graph as input. You only\n  need it to get the vertices' correct label, but you only need this at a higher\n  level. Returning a dictionary associating the coeffcient to each (integer)\n  vertex is not very expensive considering the computations you do, and so you\n  can afford to relabel it higher.\n\n- Could you define \"local clustering\" somewhere? Is it any different from the\n  'clustering coefficient of a vertex'?\n\n- Could you add an INPUT block to `cpdef clustering_coeff`?\n\n- Same function -- by using a `sig_check` instead of `sig_on/off` it is\n  impossible to interrupt the function while `boost_resulting_coeff` is\n  running. It will only be interrupted when the function returns.\n\n- Could you rename 'cc' to 'average_clustering_coefficient'? When you need a\n  comment to say what a variable is, it often means that you should rename the\n  variable.\n\n- in `clustering_average` -- could you document the default behaviour of\n  `implementation=None`? (you did it in `clustering_coeff` already).\n\n- You should not indent the *text* after a 'TESTS:' block (like it is done for\n  'INPUT:'). Usually, you only need to indent text in the documentation after a\n  '::'.\n\n- Instead of `weight==False`, it is better to use 'not weight'. Handles better\n  something like `weight=0` (faster to type `:-P`)\n\nLooks very good!\n\nThanks,\n\nNathann",
    "created_at": "2015-06-30T09:16:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262772",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:7" align="right">comment:7</div>

Hellooooooo Michele,

- About `boost_clustering_coeff` -- to me it makes more sense if this function,
  meant to apply to a boost graph, does not take a Sage graph as input. You only
  need it to get the vertices' correct label, but you only need this at a higher
  level. Returning a dictionary associating the coeffcient to each (integer)
  vertex is not very expensive considering the computations you do, and so you
  can afford to relabel it higher.

- Could you define "local clustering" somewhere? Is it any different from the
  'clustering coefficient of a vertex'?

- Could you add an INPUT block to `cpdef clustering_coeff`?

- Same function -- by using a `sig_check` instead of `sig_on/off` it is
  impossible to interrupt the function while `boost_resulting_coeff` is
  running. It will only be interrupted when the function returns.

- Could you rename 'cc' to 'average_clustering_coefficient'? When you need a
  comment to say what a variable is, it often means that you should rename the
  variable.

- in `clustering_average` -- could you document the default behaviour of
  `implementation=None`? (you did it in `clustering_coeff` already).

- You should not indent the *text* after a 'TESTS:' block (like it is done for
  'INPUT:'). Usually, you only need to indent text in the documentation after a
  '::'.

- Instead of `weight==False`, it is better to use 'not weight'. Handles better
  something like `weight=0` (faster to type `:-P`)

Looks very good!

Thanks,

Nathann



---

archive/issue_events_264739.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-30T09:16:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264739"
}
```



---

archive/issue_events_264740.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-30T09:16:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264740"
}
```



---

archive/issue_comments_262773.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHello,\n\nI have not checked the code yet.\n\nNathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)\nThe idea is to compute the number of triangles incident to each edge, and then to compute the number of triangles incident to a given vertex.\n\nDavid.",
    "created_at": "2015-06-30T09:17:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262773",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:9" align="right">comment:9</div>

Hello,

I have not checked the code yet.

Nathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)
The idea is to compute the number of triangles incident to each edge, and then to compute the number of triangles incident to a given vertex.

David.



---

archive/issue_comments_262774.json:
```json
{
    "body": "Changed commit from **[`283c61b`](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)** to **[`18bd01a`](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)**",
    "created_at": "2015-06-30T18:09:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262774",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`283c61b`](https://github.com/sagemath/sagetrac-mirror/commit/283c61be9357902ff555843b27c0ffed6fed6ea4)** to **[`18bd01a`](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)**



---

archive/issue_comments_262775.json:
```json
{
    "body": "<div id=\"comment:10\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da\"><code>18bd01a</code></a></td><td><code>Applied Nathann's suggestions</code></td></tr></table>\n",
    "created_at": "2015-06-30T18:09:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262775",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:10"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da"><code>18bd01a</code></a></td><td><code>Applied Nathann's suggestions</code></td></tr></table>




---

archive/issue_comments_262776.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI do not change the status to \"needs_review\", yet, because I'm a bit tired and I'd like to check my work tomorrow morning.",
    "created_at": "2015-06-30T18:10:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262776",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:11" align="right">comment:11</div>

I do not change the status to "needs_review", yet, because I'm a bit tired and I'd like to check my work tomorrow morning.



---

archive/issue_comments_262777.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064\"><code>99bd994</code></a></td><td><code>Few corrections in the reference manual</code></td></tr></table>\n",
    "created_at": "2015-07-01T08:12:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262777",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064"><code>99bd994</code></a></td><td><code>Few corrections in the reference manual</code></td></tr></table>




---

archive/issue_comments_262778.json:
```json
{
    "body": "Changed commit from **[`18bd01a`](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)** to **[`99bd994`](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)**",
    "created_at": "2015-07-01T08:12:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262778",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`18bd01a`](https://github.com/sagemath/sagetrac-mirror/commit/18bd01ab82cf0b9d064d4fe680f17df908bed0da)** to **[`99bd994`](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)**



---

archive/issue_comments_262779.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nHelloooooooo!\n\n> \n> - About `boost_clustering_coeff` -- to me it makes more sense if this function,\n> meant to apply to a boost graph, does not take a Sage graph as input. You only\n> need it to get the vertices' correct label, but you only need this at a higher\n> level. Returning a dictionary associating the coeffcient to each (integer)\n> vertex is not very expensive considering the computations you do, and so you\n> can afford to relabel it higher.\n\nOops, I wrote it like this to test if it worked, and I forgot to change it. By solving this issue, I also have found problems if the vertex label is not an integer, I corrected it, and I added a doctest.\n\n> \n> - Could you define \"local clustering\" somewhere? Is it any different from the\n> 'clustering coefficient of a vertex'?\n\nIt is exactly the same (https://en.wikipedia.org/wiki/Clustering_coefficient#Local_clustering_coefficient): I decided to remove \"local\" from all comments.\n\n> \n> - Could you add an INPUT block to `cpdef clustering_coeff`?\n\nDone!\n\n> - Same function -- by using a `sig_check` instead of `sig_on/off` it is\n> impossible to interrupt the function while `boost_resulting_coeff` is\n> running. It will only be interrupted when the function returns.\n\nDone! Now I use sig_on/off.\n\n> - Could you rename 'cc' to 'average_clustering_coefficient'? When you need a\n> comment to say what a variable is, it often means that you should rename the\n> variable.\n\nDone!\n\n> - in `clustering_average` -- could you document the default behaviour of\n> `implementation=None`? (you did it in `clustering_coeff` already).\n\nDone\n\n> - You should not indent the *text* after a 'TESTS:' block (like it is done for\n> 'INPUT:'). Usually, you only need to indent text in the documentation after a\n> '::'.\n\nDone!\n\n> - Instead of `weight==False`, it is better to use 'not weight'. Handles better\n> something like `weight=0` (faster to type `:-P`)\n\nDone!",
    "created_at": "2015-07-01T08:16:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262779",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:13" align="right">comment:13</div>

Helloooooooo!

> 
> - About `boost_clustering_coeff` -- to me it makes more sense if this function,
> meant to apply to a boost graph, does not take a Sage graph as input. You only
> need it to get the vertices' correct label, but you only need this at a higher
> level. Returning a dictionary associating the coeffcient to each (integer)
> vertex is not very expensive considering the computations you do, and so you
> can afford to relabel it higher.

Oops, I wrote it like this to test if it worked, and I forgot to change it. By solving this issue, I also have found problems if the vertex label is not an integer, I corrected it, and I added a doctest.

> 
> - Could you define "local clustering" somewhere? Is it any different from the
> 'clustering coefficient of a vertex'?

It is exactly the same (https://en.wikipedia.org/wiki/Clustering_coefficient#Local_clustering_coefficient): I decided to remove "local" from all comments.

> 
> - Could you add an INPUT block to `cpdef clustering_coeff`?

Done!

> - Same function -- by using a `sig_check` instead of `sig_on/off` it is
> impossible to interrupt the function while `boost_resulting_coeff` is
> running. It will only be interrupted when the function returns.

Done! Now I use sig_on/off.

> - Could you rename 'cc' to 'average_clustering_coefficient'? When you need a
> comment to say what a variable is, it often means that you should rename the
> variable.

Done!

> - in `clustering_average` -- could you document the default behaviour of
> `implementation=None`? (you did it in `clustering_coeff` already).

Done

> - You should not indent the *text* after a 'TESTS:' block (like it is done for
> 'INPUT:'). Usually, you only need to indent text in the documentation after a
> '::'.

Done!

> - Instead of `weight==False`, it is better to use 'not weight'. Handles better
> something like `weight=0` (faster to type `:-P`)

Done!



---

archive/issue_events_264741.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-07-01T08:16:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264741"
}
```



---

archive/issue_events_264742.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-07-01T08:16:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264742"
}
```



---

archive/issue_comments_262780.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\n> Nathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)\n\nSage does have something like that, too. It would only require minor changes to what was added in #18250.\n\nNathann",
    "created_at": "2015-07-01T09:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262780",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:14" align="right">comment:14</div>

> Nathann, I have an old code using bitsets for speeding up intersection of neighborhoods. I can update it using static dense graph and see if it is a good competitor ;)

Sage does have something like that, too. It would only require minor changes to what was added in #18250.

Nathann



---

archive/issue_comments_262781.json:
```json
{
    "body": "Reviewer: **Nathann Cohen**",
    "created_at": "2015-07-01T10:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262781",
    "user": "https://github.com/nathanncohen"
}
```

Reviewer: **Nathann Cohen**



---

archive/issue_comments_262782.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nHello Michele,\n\nThanks for your updates. I added a commit at public/18811, and if you agree with it then you can add it to the branch and this ticket can go.\n\nHere are the modifications I made:\n- remove trailing whitespaces\n- The function `boost_clustering_coeff` claimed to accept 'None' as a list of vertices, but did not\n- `len(clust_of_v.values())` is equal to `len(clust_of_v)`\n- `{g.vertices()[v]: clust_v_int[v] for v in vertices_boost`} this line calls `g.vertices()` for each `[v]`.\n- You can use 'tolerance' for tests like `sage: abs(G.clustering_average(implementation='boost') - G.clustering_average(implementation='networkx')) < 1E-12`\n\nHave fuuuuuuuuun,\n\nNathann",
    "created_at": "2015-07-01T10:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262782",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:15" align="right">comment:15</div>

Hello Michele,

Thanks for your updates. I added a commit at public/18811, and if you agree with it then you can add it to the branch and this ticket can go.

Here are the modifications I made:
- remove trailing whitespaces
- The function `boost_clustering_coeff` claimed to accept 'None' as a list of vertices, but did not
- `len(clust_of_v.values())` is equal to `len(clust_of_v)`
- `{g.vertices()[v]: clust_v_int[v] for v in vertices_boost`} this line calls `g.vertices()` for each `[v]`.
- You can use 'tolerance' for tests like `sage: abs(G.clustering_average(implementation='boost') - G.clustering_average(implementation='networkx')) < 1E-12`

Have fuuuuuuuuun,

Nathann



---

archive/issue_comments_262783.json:
```json
{
    "body": "Changed commit from **[`99bd994`](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)** to **[`6c8d49b`](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)**",
    "created_at": "2015-07-01T10:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262783",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`99bd994`](https://github.com/sagemath/sagetrac-mirror/commit/99bd994335f70455d898c83f1a13b3d38e8f5064)** to **[`6c8d49b`](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)**



---

archive/issue_comments_262784.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40df844cee8e59bc4bb57f5d7f4374e009053cb3\"><code>40df844</code></a></td><td><code>trac #18811: Review</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959\"><code>6c8d49b</code></a></td><td><code>More reviewer comments</code></td></tr></table>\n",
    "created_at": "2015-07-01T10:30:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262784",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40df844cee8e59bc4bb57f5d7f4374e009053cb3"><code>40df844</code></a></td><td><code>trac #18811: Review</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959"><code>6c8d49b</code></a></td><td><code>More reviewer comments</code></td></tr></table>




---

archive/issue_comments_262785.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nHey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.\n\nNathann",
    "created_at": "2015-07-01T10:32:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262785",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:17" align="right">comment:17</div>

Hey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.

Nathann



---

archive/issue_comments_262786.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nSorry, I didn't realize you modified the code... That's why I modified the doc, I thought you forgot a commit, or something like that. In my opinion, it is better to modify the doc, for simplicity!\n\nBTW, how can I use 'tolerance' in the other test?\n\n```\nsage: G = graphs.RandomGNM(10,20)\nsage: clust_boost = G.clustering_coeff(implementation='boost')\nsage: clust_networkx = G.clustering_coeff(implementation='networkx')\nsage: for v in G.vertices():\n....:     if abs(clust_boost[v] - clust_networkx[v]) > 1E-12:\n....:         print \"Error:\"\n....:         print \"   Boost clustering of\", v, \"is\", clust_boost[v]\n....:         print \"NetworkX clustering of\", v, \"is\", clust_networkx[v]\n\n```\nReplying to [@nathanncohen](#comment%3A17):\n\n\n> Hey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.\n> \n> Nathann",
    "created_at": "2015-07-01T10:36:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262786",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:18" align="right">comment:18</div>

Sorry, I didn't realize you modified the code... That's why I modified the doc, I thought you forgot a commit, or something like that. In my opinion, it is better to modify the doc, for simplicity!

BTW, how can I use 'tolerance' in the other test?

```
sage: G = graphs.RandomGNM(10,20)
sage: clust_boost = G.clustering_coeff(implementation='boost')
sage: clust_networkx = G.clustering_coeff(implementation='networkx')
sage: for v in G.vertices():
....:     if abs(clust_boost[v] - clust_networkx[v]) > 1E-12:
....:         print "Error:"
....:         print "   Boost clustering of", v, "is", clust_boost[v]
....:         print "NetworkX clustering of", v, "is", clust_networkx[v]

```
Replying to [@nathanncohen](#comment%3A17):


> Hey nononon! I had changed the code to handle the 'None' case! Do whatever you want, but please keep the code and the doc consistent.
> 
> Nathann



---

archive/issue_comments_262787.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nHelloooooo,\n\n> In my opinion, it is better to modify the doc, for simplicity!\n\nNo problem for me. But please update the code too, in this case.\n\n> BTW, how can I use 'tolerance' in the other test?\n\nI think that it could work by adding the same 'tol' flag on all lnes of the loop. Not sure, you have to try `^^;`\n\nhttp://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-tests\n\nNathann",
    "created_at": "2015-07-01T10:38:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262787",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:19" align="right">comment:19</div>

Helloooooo,

> In my opinion, it is better to modify the doc, for simplicity!

No problem for me. But please update the code too, in this case.

> BTW, how can I use 'tolerance' in the other test?

I think that it could work by adding the same 'tol' flag on all lnes of the loop. Not sure, you have to try `^^;`

http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-tests

Nathann



---

archive/issue_comments_262788.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOOOppss nononono sorry. Given that your doctest does not print anything when it works, I'd say that it is easier to understand it this way. Otherwise you would have to add lines and lines of useless '0'.\n\nBy the way, you can write 'for v in G' instead of 'for v in G.vertices()'.\n\nHave fuuuuun,\n\nNathann",
    "created_at": "2015-07-01T10:40:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262788",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:20" align="right">comment:20</div>

OOOppss nononono sorry. Given that your doctest does not print anything when it works, I'd say that it is easier to understand it this way. Otherwise you would have to add lines and lines of useless '0'.

By the way, you can write 'for v in G' instead of 'for v in G.vertices()'.

Have fuuuuun,

Nathann



---

archive/issue_comments_262789.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\n> Sage does have something like that, too. It would only require minor changes to what was added in #18250.\n\nDone at #18834. I will rebase it on top of this patch when it will be in positive review.\n\nNathann",
    "created_at": "2015-07-01T12:50:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262789",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:21" align="right">comment:21</div>

> Sage does have something like that, too. It would only require minor changes to what was added in #18250.

Done at #18834. I will rebase it on top of this patch when it will be in positive review.

Nathann



---

archive/issue_comments_262790.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c365d0294528fac6b0487b48996da831efc96c44\"><code>c365d02</code></a></td><td><code>Removed \"vertices is None\" from boost_clustering_coeff</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9\"><code>582ce34</code></a></td><td><code>Changed for v in G.vertices() => for v in G</code></td></tr></table>\n",
    "created_at": "2015-07-02T07:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262790",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:22"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c365d0294528fac6b0487b48996da831efc96c44"><code>c365d02</code></a></td><td><code>Removed "vertices is None" from boost_clustering_coeff</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9"><code>582ce34</code></a></td><td><code>Changed for v in G.vertices() => for v in G</code></td></tr></table>




---

archive/issue_comments_262791.json:
```json
{
    "body": "Changed commit from **[`6c8d49b`](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)** to **[`582ce34`](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)**",
    "created_at": "2015-07-02T07:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262791",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6c8d49b`](https://github.com/sagemath/sagetrac-mirror/commit/6c8d49bc6d0101f897c489124d52c5e4a252a959)** to **[`582ce34`](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)**



---

archive/issue_comments_262792.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nFor me, now the patch is good to go!",
    "created_at": "2015-07-02T07:55:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262792",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:23" align="right">comment:23</div>

For me, now the patch is good to go!



---

archive/issue_events_264743.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-02T08:12:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264743"
}
```



---

archive/issue_events_264744.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-07-02T08:12:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264744"
}
```



---

archive/issue_comments_262793.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOkayyyy, then let it go.\n\nNathann",
    "created_at": "2015-07-02T08:12:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262793",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:24" align="right">comment:24</div>

Okayyyy, then let it go.

Nathann



---

archive/issue_comments_262794.json:
```json
{
    "body": "Changed branch from **[u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)** to **[`582ce34`](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)**",
    "created_at": "2015-07-02T22:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18811#issuecomment-262794",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/borassi/boost_clustering_coefficient](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_clustering_coefficient)** to **[`582ce34`](https://github.com/sagemath/sagetrac-mirror/commit/582ce3466d9dff303532a84f9738cdd4f581d5a9)**



---

archive/issue_events_264745.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-02T22:32:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264745"
}
```



---

archive/issue_events_264746.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "c649ee5273ae48188498f7e00fc0444782d916b5",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-07-02T22:32:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18811",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18811#event-264746"
}
```
