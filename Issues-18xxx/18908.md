# Issue 18908: Fix math-readline script

archive/issues_018671.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: mathematica(1)\n```\nhangs indefinitely if `Mathematica` is not installed.\n\nThe reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished: currently the `math-readline` script keeps running even after the subprocess has exited.\n\nCC:  @nathanncohen @etn40ff @NathanDunfield @seblabbe\n\nBranch/Commit: **[`a3c75ab`](https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4)**\n\nReviewer: **Nathann Cohen, S\u00e9bastien Labb\u00e9, Salvatore Stella, Dima Pasechnik**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **scripts**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18908_\n\n",
    "closed_at": "2015-07-18T09:36:43Z",
    "created_at": "2015-07-15T15:23:41Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20scripts",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix math-readline script",
    "type": "issue",
    "updated_at": "2015-07-18T09:36:43Z",
    "url": "https://github.com/sagemath/sage/issues/18908",
    "user": "https://github.com/dimpase"
}
```

```
sage: mathematica(1)
```
hangs indefinitely if `Mathematica` is not installed.

The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished: currently the `math-readline` script keeps running even after the subprocess has exited.

CC:  @nathanncohen @etn40ff @NathanDunfield @seblabbe

Branch/Commit: **[`a3c75ab`](https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4)**

Reviewer: **Nathann Cohen, Sébastien Labbé, Salvatore Stella, Dima Pasechnik**

Author: **Jeroen Demeyer**

Component: **scripts**

_Issue created by migration from https://trac.sagemath.org/ticket/18908_





---

archive/issue_events_269682.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-15T15:23:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269682"
}
```



---

archive/issue_events_269683.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-15T15:23:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces%3A%20optional",
    "label_color": "0000ff",
    "label_name": "c: interfaces: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269683"
}
```



---

archive/issue_events_269684.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-15T15:23:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269684"
}
```



---

archive/issue_events_269685.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-15T15:23:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269685"
}
```



---

archive/issue_events_269686.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-15T15:24:21Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "title_is": "mathematica interface hangs if mathematica is not installed",
    "title_was": "mathematica interface hands if mathematica is not installed",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269686"
}
```



---

archive/issue_comments_264856.json:
```json
{
    "body": "Commit: **[`6b9a115`](https://github.com/sagemath/sagetrac-mirror/commit/6b9a1158e64480fe9daff56e179dc9d0fcbf689d)**",
    "created_at": "2015-07-16T09:00:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264856",
    "user": "https://github.com/dimpase"
}
```

Commit: **[`6b9a115`](https://github.com/sagemath/sagetrac-mirror/commit/6b9a1158e64480fe9daff56e179dc9d0fcbf689d)**



---

archive/issue_comments_264857.json:
```json
{
    "body": "Branch: **[public/18908](https://github.com/sagemath/sagetrac-mirror/tree/public/18908)**",
    "created_at": "2015-07-16T09:00:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264857",
    "user": "https://github.com/dimpase"
}
```

Branch: **[public/18908](https://github.com/sagemath/sagetrac-mirror/tree/public/18908)**



---

archive/issue_comments_264858.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nmoving the discussion from the closed #16703 here.\nI propose the patch in the attached `public/18908` branch.\nI don't have a system with mathematica installed, I only tested it works nicely without `math` present, both stand-alone and as well as producing the right result when calling `mathematica(10)` from Sage.",
    "created_at": "2015-07-16T09:00:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264858",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:2" align="right">comment:2</div>

moving the discussion from the closed #16703 here.
I propose the patch in the attached `public/18908` branch.
I don't have a system with mathematica installed, I only tested it works nicely without `math` present, both stand-alone and as well as producing the right result when calling `mathematica(10)` from Sage.



---

archive/issue_comments_264859.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWorks for me, though I don't have mathematica either. Can someone who has it run the optional mathematica doctests with it?\n\nNathann",
    "created_at": "2015-07-16T09:04:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264859",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:3" align="right">comment:3</div>

Works for me, though I don't have mathematica either. Can someone who has it run the optional mathematica doctests with it?

Nathann



---

archive/issue_comments_264860.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@nathanncohen](#comment:3):\n> Works for me, though I don't have mathematica either. Can someone who has it run the optional mathematica doctests with it?\n> \n\nworks for me with Mathematica 9, I don't seem to have Mathematica 10 though.\n(well, doctests fail due to numerical noise etc, but the patch itself looks good)",
    "created_at": "2015-07-16T09:08:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264860",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@nathanncohen](#comment:3):
> Works for me, though I don't have mathematica either. Can someone who has it run the optional mathematica doctests with it?
> 

works for me with Mathematica 9, I don't seem to have Mathematica 10 though.
(well, doctests fail due to numerical noise etc, but the patch itself looks good)



---

archive/issue_comments_264861.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI'll try to fix doctests for Mathematica 9 then...",
    "created_at": "2015-07-16T09:09:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264861",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:5" align="right">comment:5</div>

I'll try to fix doctests for Mathematica 9 then...



---

archive/issue_comments_264862.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThey may get pretty annoying when #18904 will be merged `;-)`",
    "created_at": "2015-07-16T09:10:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264862",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:6" align="right">comment:6</div>

They may get pretty annoying when #18904 will be merged `;-)`



---

archive/issue_comments_264863.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nbasically a lot of output is texified, or semi-texified, for a reason I don't get. Typically I see things like\n\n```\nFile \"src/sage/interfaces/mathematica.py\", line 44, in sage.interfaces.mathematica\nFailed example:\n    mathematica('Factor[x^2-1]')          # optional - mathematica\nExpected:\n    (-1 + x)*(1 + x)\nGot:\n    (x-1) (x+1)\n**********************************************************************\nFile \"src/sage/interfaces/mathematica.py\", line 46, in sage.interfaces.mathematica\nFailed example:\n    mathematica('Range[3]')               # optional - mathematica\nExpected:\n    {1, 2, 3}\nGot:\n    \\{1,2,3\\}\n```\n\nNow, the hard question: where does one have the place to describe the (pseudo)package type, \ni.e. optional vs experimental?!",
    "created_at": "2015-07-16T09:16:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264863",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:7" align="right">comment:7</div>

basically a lot of output is texified, or semi-texified, for a reason I don't get. Typically I see things like

```
File "src/sage/interfaces/mathematica.py", line 44, in sage.interfaces.mathematica
Failed example:
    mathematica('Factor[x^2-1]')          # optional - mathematica
Expected:
    (-1 + x)*(1 + x)
Got:
    (x-1) (x+1)
**********************************************************************
File "src/sage/interfaces/mathematica.py", line 46, in sage.interfaces.mathematica
Failed example:
    mathematica('Range[3]')               # optional - mathematica
Expected:
    {1, 2, 3}
Got:
    \{1,2,3\}
```

Now, the hard question: where does one have the place to describe the (pseudo)package type, 
i.e. optional vs experimental?!



---

archive/issue_comments_264864.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@dimpase](#comment:5):\n> I'll try to fix doctests for Mathematica 9 then...\n\nsee also #18888 which tries to fix doctests for Mathematica 10 to avoid conflicts...",
    "created_at": "2015-07-16T10:05:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264864",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@dimpase](#comment:5):
> I'll try to fix doctests for Mathematica 9 then...

see also #18888 which tries to fix doctests for Mathematica 10 to avoid conflicts...



---

archive/issue_comments_264865.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI have mathematica 10.1 but the machine is currently out of service. It should be back, hopefully, late next week; I can run the doctest then.",
    "created_at": "2015-07-16T10:13:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264865",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:9" align="right">comment:9</div>

I have mathematica 10.1 but the machine is currently out of service. It should be back, hopefully, late next week; I can run the doctest then.



---

archive/issue_events_269687.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-16T10:20:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269687"
}
```



---

archive/issue_comments_264866.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@seblabbe](#comment:8):\n> Replying to [@dimpase](#comment:5):\n> > I'll try to fix doctests for Mathematica 9 then...\n\n> \n> see also #18888 which tries to fix doctests for Mathematica 10 to avoid conflicts...\n\nAh, OK, so let us not fix any doctests here then, do it on #18888 instead.",
    "created_at": "2015-07-16T10:20:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264866",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@seblabbe](#comment:8):
> Replying to [@dimpase](#comment:5):
> > I'll try to fix doctests for Mathematica 9 then...

> 
> see also #18888 which tries to fix doctests for Mathematica 10 to avoid conflicts...

Ah, OK, so let us not fix any doctests here then, do it on #18888 instead.



---

archive/issue_comments_264867.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nI have `Mathematica 10.0 for Linux x86 (64-bit)` installed on my machine. I installed the branch. I did make start (I think sage -b does not update the script right?). And it seems to work:\n\n```\nsage: mathematica(10)\n10\n```\n\nTo make sure that the new code was really tested after the make start, I added some print:\n\n```\ndiff --git a/src/bin/math-readline b/src/bin/math-readline\nindex e6d40ef..ead0980 100755\n--- a/src/bin/math-readline\n+++ b/src/bin/math-readline\n@@ -11,6 +11,11 @@ try:\n except:\n     sys.exit('ERROR: executable math not found')\n \n+print \"NEW CODE IS BEING TESTED!!!\"\n+print \"NEW CODE IS BEING TESTED!!!\"\n+print \"NEW CODE IS BEING TESTED!!!\"\n+print \"NEW CODE IS BEING TESTED!!!\"\n+\n f1 = subprocess.Popen('math', shell=True, stdin=subprocess.PIPE).stdin\n f1.flush()\n try:\n```\n\ndid make start, run sage, but then, I still get\n\n```\nsage: mathematica(10)\n10\n```\nSo is the new code really run? Is it okay if the print are not shown?",
    "created_at": "2015-07-16T10:26:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264867",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:11" align="right">comment:11</div>

I have `Mathematica 10.0 for Linux x86 (64-bit)` installed on my machine. I installed the branch. I did make start (I think sage -b does not update the script right?). And it seems to work:

```
sage: mathematica(10)
10
```

To make sure that the new code was really tested after the make start, I added some print:

```
diff --git a/src/bin/math-readline b/src/bin/math-readline
index e6d40ef..ead0980 100755
--- a/src/bin/math-readline
+++ b/src/bin/math-readline
@@ -11,6 +11,11 @@ try:
 except:
     sys.exit('ERROR: executable math not found')
 
+print "NEW CODE IS BEING TESTED!!!"
+print "NEW CODE IS BEING TESTED!!!"
+print "NEW CODE IS BEING TESTED!!!"
+print "NEW CODE IS BEING TESTED!!!"
+
 f1 = subprocess.Popen('math', shell=True, stdin=subprocess.PIPE).stdin
 f1.flush()
 try:
```

did make start, run sage, but then, I still get

```
sage: mathematica(10)
10
```
So is the new code really run? Is it okay if the print are not shown?



---

archive/issue_comments_264868.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nPerhaps you should run 'make' in Sage's ROOT folder before trying it again. This could copy the updated `math-realine` from `src/bin/` to `local/bin/`.",
    "created_at": "2015-07-16T10:28:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264868",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:12" align="right">comment:12</div>

Perhaps you should run 'make' in Sage's ROOT folder before trying it again. This could copy the updated `math-realine` from `src/bin/` to `local/bin/`.



---

archive/issue_comments_264869.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI do see this line at the end of make start :\n\n```\ncp /home/labbe/Applications/sage-git/src/bin/math-readline /home/labbe/Applications/sage-git/local/bin/math-readline\n```",
    "created_at": "2015-07-16T10:30:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264869",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:13" align="right">comment:13</div>

I do see this line at the end of make start :

```
cp /home/labbe/Applications/sage-git/src/bin/math-readline /home/labbe/Applications/sage-git/local/bin/math-readline
```



---

archive/issue_comments_264870.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nReplying to [@seblabbe](#comment:11):\n\n> So is the new code really run? Is it okay if the print are not shown?\n\nI think it is, you should not get the output of math-readline within sage. It should be stripped as it is stripped the header \n\n```\nMathematica 10.0 for Linux x86 (64-bit)\nCopyright 1988-2014 Wolfram Research, Inc.\n\n```",
    "created_at": "2015-07-16T10:37:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264870",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:14" align="right">comment:14</div>

Replying to [@seblabbe](#comment:11):

> So is the new code really run? Is it okay if the print are not shown?

I think it is, you should not get the output of math-readline within sage. It should be stripped as it is stripped the header 

```
Mathematica 10.0 for Linux x86 (64-bit)
Copyright 1988-2014 Wolfram Research, Inc.

```



---

archive/issue_events_269688.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2015-07-16T10:59:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269688"
}
```



---

archive/issue_events_269689.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2015-07-16T10:59:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269689"
}
```



---

archive/issue_comments_264871.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nOk, so then, positive review!",
    "created_at": "2015-07-16T10:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264871",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:15" align="right">comment:15</div>

Ok, so then, positive review!



---

archive/issue_comments_264872.json:
```json
{
    "body": "Reviewer: **Nathann Cohen, S\u00e9bastien Labb\u00e9, Salvatore Stella**",
    "created_at": "2015-07-16T10:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264872",
    "user": "https://github.com/seblabbe"
}
```

Reviewer: **Nathann Cohen, Sébastien Labbé, Salvatore Stella**



---

archive/issue_comments_264873.json:
```json
{
    "body": "Author: **Dima Pasechnik**",
    "created_at": "2015-07-16T10:59:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264873",
    "user": "https://github.com/seblabbe"
}
```

Author: **Dima Pasechnik**



---

archive/issue_events_269690.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2015-07-16T11:19:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269690"
}
```



---

archive/issue_events_269691.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2015-07-16T11:19:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269691"
}
```



---

archive/issue_comments_264874.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nWait, is there a way to doctest this fix?\n\n```\nmathematica(10)  # not mathematica\nSome error message...\n```",
    "created_at": "2015-07-16T11:19:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264874",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:16" align="right">comment:16</div>

Wait, is there a way to doctest this fix?

```
mathematica(10)  # not mathematica
Some error message...
```



---

archive/issue_comments_264875.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\n> Wait, is there a way to doctest this fix?\n\nNo, though others have asked (Dima in particular).\n\nYou should not change the status of a ticket in `positive_review` to ask a question unrelated to what the ticket is supposed to address.",
    "created_at": "2015-07-16T11:23:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264875",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:17" align="right">comment:17</div>

> Wait, is there a way to doctest this fix?

No, though others have asked (Dima in particular).

You should not change the status of a ticket in `positive_review` to ask a question unrelated to what the ticket is supposed to address.



---

archive/issue_events_269692.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2015-07-16T11:44:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269692"
}
```



---

archive/issue_events_269693.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2015-07-16T11:44:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269693"
}
```



---

archive/issue_comments_264876.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nOk sorry. Back to positive review.",
    "created_at": "2015-07-16T11:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264876",
    "user": "https://github.com/seblabbe"
}
```

<div id="comment:18" align="right">comment:18</div>

Ok sorry. Back to positive review.



---

archive/issue_comments_264877.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@seblabbe](#comment:16):\n> Wait, is there a way to doctest this fix?\n> \n> ```\n> mathematica(10)  # not mathematica\n> Some error message...\n> ```\n\nlike this? \n\n```\ndiff --git a/src/sage/interfaces/mathematica.py b/src/sage/interfaces/mathematica.py\nindex aa5a848..04eaf9f 100644\n--- a/src/sage/interfaces/mathematica.py\n+++ b/src/sage/interfaces/mathematica.py\n@@ -729,6 +729,17 @@ class MathematicaElement(ExpectElement):\n             0\n \n \n+        TESTS::\n+\n+            sage: import subprocess                  # optional - nomathematica\n+            sage: try:                               # optional - nomathematica\n+            ....:     subprocess.check_output('which math', shell=True)  # optional - nomathematica\n+            ....: except:                            # optional - nomathematica\n+            ....:     mathematica(10)                # optional - nomathematica\n+            Traceback (most recent call last):\n+            ...\n+            TypeError: ...\n+\n         AUTHORS:\n \n         - Felix Lawrence (2010-11-03): Major rewrite to use ._sage_repr() and\n```",
    "created_at": "2015-07-16T11:58:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264877",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@seblabbe](#comment:16):
> Wait, is there a way to doctest this fix?
> 
> ```
> mathematica(10)  # not mathematica
> Some error message...
> ```

like this? 

```
diff --git a/src/sage/interfaces/mathematica.py b/src/sage/interfaces/mathematica.py
index aa5a848..04eaf9f 100644
--- a/src/sage/interfaces/mathematica.py
+++ b/src/sage/interfaces/mathematica.py
@@ -729,6 +729,17 @@ class MathematicaElement(ExpectElement):
             0
 
 
+        TESTS::
+
+            sage: import subprocess                  # optional - nomathematica
+            sage: try:                               # optional - nomathematica
+            ....:     subprocess.check_output('which math', shell=True)  # optional - nomathematica
+            ....: except:                            # optional - nomathematica
+            ....:     mathematica(10)                # optional - nomathematica
+            Traceback (most recent call last):
+            ...
+            TypeError: ...
+
         AUTHORS:
 
         - Felix Lawrence (2010-11-03): Major rewrite to use ._sage_repr() and
```



---

archive/issue_events_269694.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T14:55:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269694"
}
```



---

archive/issue_events_269695.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T14:55:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269695"
}
```



---

archive/issue_comments_264878.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,4 +2,6 @@\n ```\n sage: mathematica(1)\n ```\n-hangs indefinitely if `Mathematica` is not installed. The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check that `math` is present in the path, before proceeding.\n+hangs indefinitely if `Mathematica` is not installed.\n+\n+The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished.\n``````\n",
    "created_at": "2015-07-16T14:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264878",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,4 +2,6 @@
 ```
 sage: mathematica(1)
 ```
-hangs indefinitely if `Mathematica` is not installed. The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check that `math` is present in the path, before proceeding.
+hangs indefinitely if `Mathematica` is not installed.
+
+The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished.
``````




---

archive/issue_comments_264879.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis is really the wrong fix.",
    "created_at": "2015-07-16T14:55:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264879",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

This is really the wrong fix.



---

archive/issue_comments_264880.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n ```\n hangs indefinitely if `Mathematica` is not installed.\n \n-The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished.\n+The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished: currently the `math-readline` script keeps running even after the subprocess has exited.\n``````\n",
    "created_at": "2015-07-16T14:57:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264880",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 ```
 hangs indefinitely if `Mathematica` is not installed.
 
-The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished.
+The reason is that internally the script `$SAGE_LOCAL/bin/math-readline` is called by `Expect()`, and the latter hangs. This script should check whether the `math` command has finished: currently the `math-readline` script keeps running even after the subprocess has exited.
``````




---

archive/issue_comments_264881.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI don't know what you are talking about. If I quit Sage with math available, I see\n\n```\nsage: \nExiting Sage (CPU time 0m2.48s, Wall time 36m25.69s).\nExiting Mathematica with PID 12864 running /home/scratch/dimpase/sage/sage/src/bin/math-readline\n```\nDo you mean to say that the last message is misleading?\n\nAnd of course if there is no `math` there then the script kills itself by `sys.exit()`.",
    "created_at": "2015-07-16T15:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264881",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:22" align="right">comment:22</div>

I don't know what you are talking about. If I quit Sage with math available, I see

```
sage: 
Exiting Sage (CPU time 0m2.48s, Wall time 36m25.69s).
Exiting Mathematica with PID 12864 running /home/scratch/dimpase/sage/sage/src/bin/math-readline
```
Do you mean to say that the last message is misleading?

And of course if there is no `math` there then the script kills itself by `sys.exit()`.



---

archive/issue_comments_264882.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThe patch on this ticket means to solve the problem of hanging if `math` is not present, no more than that. And it does it. I am not aware of any other problems, leave alone ways to reproduce these other problems.",
    "created_at": "2015-07-16T15:15:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264882",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:23" align="right">comment:23</div>

The patch on this ticket means to solve the problem of hanging if `math` is not present, no more than that. And it does it. I am not aware of any other problems, leave alone ways to reproduce these other problems.



---

archive/issue_events_269696.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-16T15:17:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269696"
}
```



---

archive/issue_events_269697.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-16T15:17:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269697"
}
```



---

archive/issue_comments_264883.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nI am setting it back to positive review. Please feel free to submit a proper error report, not \"wrong fix\" bullsh*t, and then change the ticket status accordingly.",
    "created_at": "2015-07-16T15:17:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264883",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:24" align="right">comment:24</div>

I am setting it back to positive review. Please feel free to submit a proper error report, not "wrong fix" bullsh*t, and then change the ticket status accordingly.



---

archive/issue_comments_264884.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nIf I understand correctly what is being said by [jdemeyer](#comment:21) the problem is this:\n\n```\n$ math-readline\nMathematica 10.0 for Linux x86 (64-bit)\nCopyright 1988-2014 Wolfram Research, Inc.\n\nIn[1]:= Exit\n\nTraceback (most recent call last):\n  File \"/opt/sage/local/bin/math-readline\", line 23, in <module>\n    f1.writelines(line+'\\n')\nIOError: [Errno 32] Broken pipe\n```\n\nwhich is quite ugly.",
    "created_at": "2015-07-16T15:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264884",
    "user": "https://github.com/etn40ff"
}
```

<div id="comment:25" align="right">comment:25</div>

If I understand correctly what is being said by [jdemeyer](#comment:21) the problem is this:

```
$ math-readline
Mathematica 10.0 for Linux x86 (64-bit)
Copyright 1988-2014 Wolfram Research, Inc.

In[1]:= Exit

Traceback (most recent call last):
  File "/opt/sage/local/bin/math-readline", line 23, in <module>
    f1.writelines(line+'\n')
IOError: [Errno 32] Broken pipe
```

which is quite ugly.



---

archive/issue_events_269698.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2015-07-16T15:20:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269698"
}
```



---

archive/issue_events_269699.json:
```json
{
    "actor": "https://github.com/sagetrac-git",
    "created_at": "2015-07-16T15:20:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269699"
}
```



---

archive/issue_comments_264885.json:
```json
{
    "body": "<div id=\"comment:26\"></div>\n\nBranch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4\"><code>a3c75ab</code></a></td><td><code>Exit math-readline if child process exits</code></td></tr></table>\n",
    "created_at": "2015-07-16T15:20:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264885",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:26"></div>

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4"><code>a3c75ab</code></a></td><td><code>Exit math-readline if child process exits</code></td></tr></table>




---

archive/issue_comments_264886.json:
```json
{
    "body": "Changed commit from **[`6b9a115`](https://github.com/sagemath/sagetrac-mirror/commit/6b9a1158e64480fe9daff56e179dc9d0fcbf689d)** to **[`a3c75ab`](https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4)**",
    "created_at": "2015-07-16T15:20:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264886",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`6b9a115`](https://github.com/sagemath/sagetrac-mirror/commit/6b9a1158e64480fe9daff56e179dc9d0fcbf689d)** to **[`a3c75ab`](https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4)**



---

archive/issue_comments_264887.json:
```json
{
    "body": "Changed author from **Dima Pasechnik** to **Dima Pasechnik, Jeroen Demeyer**",
    "created_at": "2015-07-16T15:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264887",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Dima Pasechnik** to **Dima Pasechnik, Jeroen Demeyer**



---

archive/issue_events_269700.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T15:22:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20interfaces%3A%20optional",
    "label_color": "0000ff",
    "label_name": "c: interfaces: optional",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269700"
}
```



---

archive/issue_events_269701.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T15:22:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20scripts",
    "label_color": "000080",
    "label_name": "c: scripts",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269701"
}
```



---

archive/issue_comments_264888.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nSometimes it is easier to just write a patch and explain later rather than the other way around. And unfortunately there is no ticket status for \"hang on, I'm working on a patch\".\n\nThe *real* problem with the script was that, when the `math` child process exited (for whatever reason, including Mathematica not being installed), the `math-readline` script did not exit. The proper fix is to check for the exiting of the child process. This works no matter for which reason the child process exited (which could be calling `Exit` in Mathematica, which could be Mathematica crashing, which could be Mathematica not being installed).",
    "created_at": "2015-07-16T15:26:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264888",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Sometimes it is easier to just write a patch and explain later rather than the other way around. And unfortunately there is no ticket status for "hang on, I'm working on a patch".

The *real* problem with the script was that, when the `math` child process exited (for whatever reason, including Mathematica not being installed), the `math-readline` script did not exit. The proper fix is to check for the exiting of the child process. This works no matter for which reason the child process exited (which could be calling `Exit` in Mathematica, which could be Mathematica crashing, which could be Mathematica not being installed).



---

archive/issue_comments_264889.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nI also made a few more fixes to the script:\n1. actually using `readline`, which was the whole point of the script!\n2. removing the empty write `sys.stdout.write('')` (what was the point of that?).\n3. using `write()` instead of `writelines()` to write a single string.\n4. removing the unneeded `sys.exit()` at the end.",
    "created_at": "2015-07-16T15:30:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264889",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

I also made a few more fixes to the script:
1. actually using `readline`, which was the whole point of the script!
2. removing the empty write `sys.stdout.write('')` (what was the point of that?).
3. using `write()` instead of `writelines()` to write a single string.
4. removing the unneeded `sys.exit()` at the end.



---

archive/issue_events_269702.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-07-16T15:30:45Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "title_is": "Fix math-readline script",
    "title_was": "mathematica interface hangs if mathematica is not installed",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269702"
}
```



---

archive/issue_comments_264890.json:
```json
{
    "body": "Changed author from **Dima Pasechnik, Jeroen Demeyer** to **Jeroen Demeyer**",
    "created_at": "2015-07-16T15:39:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264890",
    "user": "https://github.com/dimpase"
}
```

Changed author from **Dima Pasechnik, Jeroen Demeyer** to **Jeroen Demeyer**



---

archive/issue_comments_264891.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@jdemeyer](#comment:20):\n> This is really the wrong fix.\n\nFYI, I found this comment very annoying. Unless you want to alienate people, always say in such cases instead \"I would like to improve this\".",
    "created_at": "2015-07-16T22:09:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264891",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@jdemeyer](#comment:20):
> This is really the wrong fix.

FYI, I found this comment very annoying. Unless you want to alienate people, always say in such cases instead "I would like to improve this".



---

archive/issue_comments_264892.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@dimpase](#comment:32):\n> Replying to [@jdemeyer](#comment:20):\n> > This is really the wrong fix.\n\n> FYI, I found this comment very annoying. Unless you want to alienate people, always say in such cases instead \"I would like to improve this\". \n\nOK, point taken. What about \"This is really not the correct fix, I'm having a look at how to improve it\".",
    "created_at": "2015-07-17T06:00:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264892",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@dimpase](#comment:32):
> Replying to [@jdemeyer](#comment:20):
> > This is really the wrong fix.

> FYI, I found this comment very annoying. Unless you want to alienate people, always say in such cases instead "I would like to improve this". 

OK, point taken. What about "This is really not the correct fix, I'm having a look at how to improve it".



---

archive/issue_comments_264893.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jdemeyer](#comment:33):\n> Replying to [@dimpase](#comment:32):\n> > Replying to [@jdemeyer](#comment:20):\n> > > This is really the wrong fix.\n\n> > FYI, I found this comment very annoying. Unless you want to alienate people, always say in such cases instead \"I would like to improve this\". \n\n> \n> OK, point taken. What about \"This is really not the correct fix, I'm having a look at how to improve it\"\n\ns/correct/complete would do; indeed, saying that something is incorrect/wrong without giving an explanation could create a tension you don't need.",
    "created_at": "2015-07-17T07:16:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264893",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jdemeyer](#comment:33):
> Replying to [@dimpase](#comment:32):
> > Replying to [@jdemeyer](#comment:20):
> > > This is really the wrong fix.

> > FYI, I found this comment very annoying. Unless you want to alienate people, always say in such cases instead "I would like to improve this". 

> 
> OK, point taken. What about "This is really not the correct fix, I'm having a look at how to improve it"

s/correct/complete would do; indeed, saying that something is incorrect/wrong without giving an explanation could create a tension you don't need.



---

archive/issue_comments_264894.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nReplying to [@dimpase](#comment:34):\n> saying that something is incorrect/wrong without giving an explanation could create a tension you don't need.\n\nBut it was really incorrect: the fact that the script hangs when `math` is not installed was a *symptom* of the problem, not the problem itself.\n\nBut at the time when I send that message, I didn't have a clear explanation of the real problem: I knew that the proposed solution was wrong, but I couldn't yet say what the right fix would be. Like I said: it's often easier to explain *after* you have a working patch.\n\nAnd I had to act quickly because, these days, tickets which have positive_review are often closed very soon.",
    "created_at": "2015-07-17T07:29:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264894",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:35" align="right">comment:35</div>

Replying to [@dimpase](#comment:34):
> saying that something is incorrect/wrong without giving an explanation could create a tension you don't need.

But it was really incorrect: the fact that the script hangs when `math` is not installed was a *symptom* of the problem, not the problem itself.

But at the time when I send that message, I didn't have a clear explanation of the real problem: I knew that the proposed solution was wrong, but I couldn't yet say what the right fix would be. Like I said: it's often easier to explain *after* you have a working patch.

And I had to act quickly because, these days, tickets which have positive_review are often closed very soon.



---

archive/issue_comments_264895.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nThe script hanged without `math` installed, and hanged Sage in return. And that few lines that were in the fix solved this particular issue, obviously an improvement. Anything that is an improvement cannot be called incorrect.",
    "created_at": "2015-07-17T07:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264895",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:36" align="right">comment:36</div>

The script hanged without `math` installed, and hanged Sage in return. And that few lines that were in the fix solved this particular issue, obviously an improvement. Anything that is an improvement cannot be called incorrect.



---

archive/issue_comments_264896.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nReplying to [@dimpase](#comment:36):\n> Anything that is an improvement cannot be called incorrect.\n\nI completely disagree with this. An improvement which hides a bug is incorrect.",
    "created_at": "2015-07-17T09:29:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264896",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:37" align="right">comment:37</div>

Replying to [@dimpase](#comment:36):
> Anything that is an improvement cannot be called incorrect.

I completely disagree with this. An improvement which hides a bug is incorrect.



---

archive/issue_comments_264897.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nlgtm",
    "created_at": "2015-07-17T09:29:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264897",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:38" align="right">comment:38</div>

lgtm



---

archive/issue_events_269703.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-17T09:29:45Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269703"
}
```



---

archive/issue_events_269704.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2015-07-17T09:29:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269704"
}
```



---

archive/issue_comments_264898.json:
```json
{
    "body": "Changed reviewer from **Nathann Cohen, S\u00e9bastien Labb\u00e9, Salvatore Stella** to **Nathann Cohen, S\u00e9bastien Labb\u00e9, Salvatore Stella, Dima Pasechnik**",
    "created_at": "2015-07-17T09:29:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264898",
    "user": "https://github.com/dimpase"
}
```

Changed reviewer from **Nathann Cohen, Sébastien Labbé, Salvatore Stella** to **Nathann Cohen, Sébastien Labbé, Salvatore Stella, Dima Pasechnik**



---

archive/issue_comments_264899.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@jdemeyer](#comment:37):\n> Replying to [@dimpase](#comment:36):\n> > Anything that is an improvement cannot be called incorrect.\n\n> I completely disagree with this. An improvement which hides a bug is incorrect.\n\nexcept that this one did not hide a bug, at least not any more than the original scrip did.\n \nAnyhow, this is not the point; the point is that you should not brand anything at all \"wrong\", \"incorrect\" without a justification. (Unless you out to annoy people, and I hope that this is not the case).",
    "created_at": "2015-07-17T09:33:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264899",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@jdemeyer](#comment:37):
> Replying to [@dimpase](#comment:36):
> > Anything that is an improvement cannot be called incorrect.

> I completely disagree with this. An improvement which hides a bug is incorrect.

except that this one did not hide a bug, at least not any more than the original scrip did.
 
Anyhow, this is not the point; the point is that you should not brand anything at all "wrong", "incorrect" without a justification. (Unless you out to annoy people, and I hope that this is not the case).



---

archive/issue_comments_264900.json:
```json
{
    "body": "Changed branch from **[public/18908](https://github.com/sagemath/sagetrac-mirror/tree/public/18908)** to **[`a3c75ab`](https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4)**",
    "created_at": "2015-07-18T09:36:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18908#issuecomment-264900",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/18908](https://github.com/sagemath/sagetrac-mirror/tree/public/18908)** to **[`a3c75ab`](https://github.com/sagemath/sagetrac-mirror/commit/a3c75ab48e7a0ef0b5f5c38cf769b58e0be35ba4)**



---

archive/issue_events_269705.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-18T09:36:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269705"
}
```



---

archive/issue_events_269706.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "e29390a6e5c3ee28d6d7a5ad5bf934aea07c70b9",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-07-18T09:36:43Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18908",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18908#event-269706"
}
```
