# Issue 18239: Constructing Cayley graphs is slow

archive/issues_018002.json:
```json
{
    "body": "Computing the Cayley graph of a group and generator set is extremely slow in Sage. The only reasonable solution was to use GRAPE directly. \n\nAs an example, let `p` and `q` be two permutations\n\n```\np=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))\nq=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)\nA = PermutationGroup([p,q])\np,q = A(p),A(q)\n```\n\nThen, the following code\n\n```\nG = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)\n```\ntakes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.\n\nWith the branch applied\n\n```\nsage: %time G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)\nCPU times: user 192 ms, sys: 4 ms, total: 196 ms\nWall time: 193 ms\n```\n\nCrazy speed up: x130 :-)\n\nA previous workaround was to do\n\n```\ngout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') \nast.literal_eval(str(gout))\n```\nwhich takes **0.4s**. Note that the last example assumed ast is imported and also that\n\n```\ngap.LoadPackage('\"grape\"')\n```\nwas loaded.\n\nCC:  @nathanncohen @videlec\n\nBranch/Commit: d0ec65bb221ff76dd0c63b606659ccfd3e4015e6\n\nReviewer: Nathann Cohen\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18239\n\n",
    "closed_at": "2015-04-19T01:52:01Z",
    "created_at": "2015-04-17T14:07:25Z",
    "labels": [
        "component: group theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "Constructing Cayley graphs is slow",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18239",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```
Computing the Cayley graph of a group and generator set is extremely slow in Sage. The only reasonable solution was to use GRAPE directly. 

As an example, let `p` and `q` be two permutations

```
p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))
q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)
A = PermutationGroup([p,q])
p,q = A(p),A(q)
```

Then, the following code

```
G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)
```
takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.

With the branch applied

```
sage: %time G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)
CPU times: user 192 ms, sys: 4 ms, total: 196 ms
Wall time: 193 ms
```

Crazy speed up: x130 :-)

A previous workaround was to do

```
gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') 
ast.literal_eval(str(gout))
```
which takes **0.4s**. Note that the last example assumed ast is imported and also that

```
gap.LoadPackage('"grape"')
```
was loaded.

CC:  @nathanncohen @videlec

Branch/Commit: d0ec65bb221ff76dd0c63b606659ccfd3e4015e6

Reviewer: Nathann Cohen

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18239





---

archive/issue_comments_316312.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,9 @@\n-I am leaving this here as a future task that needs to be addressed. Hopefully someone can do it instead of me :-)\n+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. \n \n-Constructing Cayley graphs is**  awfully** slow, compared to what we can get with GAP. Example\n+As an example\n \n-Let $x,g$ be two permutations\n+\n+Let x,g be two permutations\n \n ```\n sage: x,g\n@@ -35,7 +36,10 @@\n gap.LoadPackage('\"grape\"')\n ```\n \n-was loaded.\n+was loaded. \n+\n+\n+\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-17T14:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316312",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,9 @@
-I am leaving this here as a future task that needs to be addressed. Hopefully someone can do it instead of me :-)
+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. 
 
-Constructing Cayley graphs is**  awfully** slow, compared to what we can get with GAP. Example
+As an example
 
-Let $x,g$ be two permutations
+
+Let x,g be two permutations
 
 ```
 sage: x,g
@@ -35,7 +36,10 @@
 gap.LoadPackage('"grape"')
 ```
 
-was loaded.
+was loaded. 
+
+
+
 
 Comment: 1
 
``````




---

archive/issue_comments_316313.json:
```json
{
    "body": "<a id='comment:2'></a>Do you know what the bottleneck is?",
    "created_at": "2015-04-17T14:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316313",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'></a>Do you know what the bottleneck is?



---

archive/issue_comments_316314.json:
```json
{
    "body": "<a id='comment:3'></a>As far as I've profiled it seems that most of the time is spent multiplying PermutationGroup elements.\n\nAlso I am not sure but perhaps GRAPE is perhaps implemented in C and is already more efficient for this reason alone.",
    "created_at": "2015-04-17T15:00:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316314",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:3'></a>As far as I've profiled it seems that most of the time is spent multiplying PermutationGroup elements.

Also I am not sure but perhaps GRAPE is perhaps implemented in C and is already more efficient for this reason alone.



---

archive/issue_comments_316315.json:
```json
{
    "body": "<a id='comment:4'></a>> As far as I've profiled it seems that most of the time is spent multiplying PermutationGroup elements.\n> \n> Also I am not sure but perhaps GRAPE is perhaps implemented in C and is already more efficient for this reason alone.\n\n\nWell, being a C code may explain why it could be faster but now why it would be SO much faster.\n\nIt turns out [1] that there are several implementations of this `cayley_graph` function. There is one in `sage.categories.semigroups` and another in `groups/group.pyx`. Do you know which one is run by your code ?\n\nIt would help if you could share this group A.\n\nNathann\n\n[1] See? I don't scream anymore. Of course I want to punch a lot of people, but I say \"It turns out\"",
    "created_at": "2015-04-17T15:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316315",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>> As far as I've profiled it seems that most of the time is spent multiplying PermutationGroup elements.
> 
> Also I am not sure but perhaps GRAPE is perhaps implemented in C and is already more efficient for this reason alone.


Well, being a C code may explain why it could be faster but now why it would be SO much faster.

It turns out [1] that there are several implementations of this `cayley_graph` function. There is one in `sage.categories.semigroups` and another in `groups/group.pyx`. Do you know which one is run by your code ?

It would help if you could share this group A.

Nathann

[1] See? I don't scream anymore. Of course I want to punch a lot of people, but I say "It turns out"



---

archive/issue_comments_316316.json:
```json
{
    "body": "<a id='comment:5'></a>Oh, I forgot to write that - the group A is the one generated by x and g.\n\n```\nA = PermutationGroup([x,g])\n```\n\nAs far as I've researched into this, the sage.categories.semigroups cayley_graph function is called.",
    "created_at": "2015-04-17T15:20:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316316",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:5'></a>Oh, I forgot to write that - the group A is the one generated by x and g.

```
A = PermutationGroup([x,g])
```

As far as I've researched into this, the sage.categories.semigroups cayley_graph function is called.



---

archive/issue_comments_316317.json:
```json
{
    "body": "<a id='comment:6'></a>Okay. The solution is the same, again and again. Some people should get a license to write code.",
    "created_at": "2015-04-17T15:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316317",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>Okay. The solution is the same, again and again. Some people should get a license to write code.



---

archive/issue_comments_316318.json:
```json
{
    "body": "<a id='comment:7'></a>Solution?",
    "created_at": "2015-04-17T15:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316318",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:7'></a>Solution?



---

archive/issue_comments_316319.json:
```json
{
    "body": "<a id='comment:8'></a>2sc",
    "created_at": "2015-04-17T15:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316319",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:8'></a>2sc



---

archive/issue_comments_316320.json:
```json
{
    "body": "<a id='comment:9'></a>Well actually it's not the `cayley_graph` function. It is `list(A)`.",
    "created_at": "2015-04-17T15:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316320",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>Well actually it's not the `cayley_graph` function. It is `list(A)`.



---

archive/issue_comments_316321.json:
```json
{
    "body": "<a id='comment:10'></a>just cc'ing me",
    "created_at": "2015-04-17T16:56:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316321",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'></a>just cc'ing me



---

archive/issue_comments_316322.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,45 @@\n+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. \n+\n+As an example\n+\n+\n+Let x,g be two permutations\n+\n+```\n+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))\n+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)\n+A = PermutationGroup([p,q])\n+p,q = A(p),A(q)\n+```\n+\n+The following code\n+\n+```\n+G = A.cayley_graph(generators=[g,x, g.inverse()], simple=True)\n+```\n+\n+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.\n+\n+In order to obtain a list of edges of the above Cayley Graph one can also do\n+\n+```\n+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') \n+ast.literal_eval(str(gout))\n+```\n+\n+which takes **0.4s**.\n+\n+I need to do this for roughly 300k such permutation groups and it makes a big difference which implementation we use.\n+\n+Note that the last example assumed ast is imported and also that\n+\n+```\n+gap.LoadPackage('\"grape\"')\n+```\n+\n+was loaded. \n+\n+\n \n \n Comment: 1\n``````\n",
    "created_at": "2015-04-17T16:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316322",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,45 @@
+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. 
+
+As an example
+
+
+Let x,g be two permutations
+
+```
+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))
+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)
+A = PermutationGroup([p,q])
+p,q = A(p),A(q)
+```
+
+The following code
+
+```
+G = A.cayley_graph(generators=[g,x, g.inverse()], simple=True)
+```
+
+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.
+
+In order to obtain a list of edges of the above Cayley Graph one can also do
+
+```
+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') 
+ast.literal_eval(str(gout))
+```
+
+which takes **0.4s**.
+
+I need to do this for roughly 300k such permutation groups and it makes a big difference which implementation we use.
+
+Note that the last example assumed ast is imported and also that
+
+```
+gap.LoadPackage('"grape"')
+```
+
+was loaded. 
+
+
 
 
 Comment: 1
``````




---

archive/issue_comments_316323.json:
```json
{
    "body": "<a id='comment:12'></a>Indeed! Modifying the `__iter__` function in `PermutationGroup_generic` I got\n\n```\nsage: timeit(\"for x in A: pass\")\n5 loops, best of 3: 116 ms per loop\n```\nInstead of\n\n```\nsage: timeit(\"for x in A: pass\")\n... still waiting\n```\n\nDo you know why the `list` method in the same class is cached?\n\nVincent",
    "created_at": "2015-04-17T19:55:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316323",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'></a>Indeed! Modifying the `__iter__` function in `PermutationGroup_generic` I got

```
sage: timeit("for x in A: pass")
5 loops, best of 3: 116 ms per loop
```
Instead of

```
sage: timeit("for x in A: pass")
... still waiting
```

Do you know why the `list` method in the same class is cached?

Vincent



---

archive/issue_comments_316324.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-17T20:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316324",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_316325.json:
```json
{
    "body": "Changing author from \"\" to \"Vincent Delecroix\"",
    "created_at": "2015-04-17T20:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316325",
    "user": "https://github.com/videlec"
}
```

Changing author from "" to "Vincent Delecroix"



---

archive/issue_comments_316326.json:
```json
{
    "body": "Changing branch from \"\" to \"public/18239\"",
    "created_at": "2015-04-17T20:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316326",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "public/18239"



---

archive/issue_comments_316327.json:
```json
{
    "body": "<a id='comment:13'></a>New commits:",
    "created_at": "2015-04-17T20:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316327",
    "user": "https://github.com/videlec"
}
```

<a id='comment:13'></a>New commits:



---

archive/issue_comments_316328.json:
```json
{
    "body": "Changing commit from \"\" to \"7dbf867236b6c9c88acd25009fdf8453571b9d75\"",
    "created_at": "2015-04-17T20:16:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316328",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "7dbf867236b6c9c88acd25009fdf8453571b9d75"



---

archive/issue_comments_316329.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,51 @@\n+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. \n \n+As an example\n+\n+\n+Let x,g be two permutations\n+\n+```\n+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))\n+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)\n+A = PermutationGroup([p,q])\n+p,q = A(p),A(q)\n+```\n+\n+The following code\n+\n+```\n+G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)\n+```\n+\n+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.\n+\n+In order to obtain a list of edges of the above Cayley Graph one can also do\n+\n+```\n+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') \n+ast.literal_eval(str(gout))\n+```\n+\n+which takes **0.4s**.\n+\n+I need to do this for roughly 300k such permutation groups and it makes a big difference which implementation we use.\n+\n+Note that the last example assumed ast is imported and also that\n+\n+```\n+gap.LoadPackage('\"grape\"')\n+```\n+\n+was loaded. \n+\n+With the branch applied\n+\n+```\n+sage: %time G = A.cayley_graph(generators=[p,q,p.inverse()], simple=True)\n+CPU times: user 728 ms, sys: 0 ns, total: 728 ms\n+Wall time: 726 ms\n+```\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-17T20:20:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316329",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,51 @@
+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. 
 
+As an example
+
+
+Let x,g be two permutations
+
+```
+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))
+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)
+A = PermutationGroup([p,q])
+p,q = A(p),A(q)
+```
+
+The following code
+
+```
+G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)
+```
+
+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.
+
+In order to obtain a list of edges of the above Cayley Graph one can also do
+
+```
+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') 
+ast.literal_eval(str(gout))
+```
+
+which takes **0.4s**.
+
+I need to do this for roughly 300k such permutation groups and it makes a big difference which implementation we use.
+
+Note that the last example assumed ast is imported and also that
+
+```
+gap.LoadPackage('"grape"')
+```
+
+was loaded. 
+
+With the branch applied
+
+```
+sage: %time G = A.cayley_graph(generators=[p,q,p.inverse()], simple=True)
+CPU times: user 728 ms, sys: 0 ns, total: 728 ms
+Wall time: 726 ms
+```
 
 Comment: 1
 
``````




---

archive/issue_comments_316330.json:
```json
{
    "body": "<a id='comment:14'></a>In the description ticket I assumed that `x` meant `p` and `g` meant `q`. If I did wrong, please modify.",
    "created_at": "2015-04-17T20:20:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316330",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>In the description ticket I assumed that `x` meant `p` and `g` meant `q`. If I did wrong, please modify.



---

archive/issue_comments_316331.json:
```json
{
    "body": "<a id='comment:15'></a>`O_O`\n\nOkay.. Well, it works `:-P`",
    "created_at": "2015-04-17T20:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316331",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>`O_O`

Okay.. Well, it works `:-P`



---

archive/issue_comments_316332.json:
```json
{
    "body": "<a id='comment:16'></a>Perhaps we should add a long time to the doctest? It takes 2sec for me. I just want to check that it is reasonably doable in the new version (it was more than 2 min in the previous state).",
    "created_at": "2015-04-17T20:24:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316332",
    "user": "https://github.com/videlec"
}
```

<a id='comment:16'></a>Perhaps we should add a long time to the doctest? It takes 2sec for me. I just want to check that it is reasonably doable in the new version (it was more than 2 min in the previous state).



---

archive/issue_comments_316333.json:
```json
{
    "body": "<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T20:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316333",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:17'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316334.json:
```json
{
    "body": "Changing commit from \"7dbf867236b6c9c88acd25009fdf8453571b9d75\" to \"1e75b5bd931cf025ef7fa64617021a02474508c8\"",
    "created_at": "2015-04-17T20:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316334",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7dbf867236b6c9c88acd25009fdf8453571b9d75" to "1e75b5bd931cf025ef7fa64617021a02474508c8"



---

archive/issue_comments_316335.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T20:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316335",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316336.json:
```json
{
    "body": "Changing commit from \"1e75b5bd931cf025ef7fa64617021a02474508c8\" to \"86f696f0dd36cc683ce5a67c3986f55c846592e1\"",
    "created_at": "2015-04-17T20:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316336",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1e75b5bd931cf025ef7fa64617021a02474508c8" to "86f696f0dd36cc683ce5a67c3986f55c846592e1"



---

archive/issue_comments_316337.json:
```json
{
    "body": "<a id='comment:19'></a>I've got a good news and a bad news. Good news: we can shave 200ms off again.\n\nBad news: we don't have two but three implementations of `cayley_graph`. One of them in `old.py`, which is used by default by `PermutationGroup` `>_<`\n\nNathann",
    "created_at": "2015-04-17T20:39:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316337",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:19'></a>I've got a good news and a bad news. Good news: we can shave 200ms off again.

Bad news: we don't have two but three implementations of `cayley_graph`. One of them in `old.py`, which is used by default by `PermutationGroup` `>_<`

Nathann



---

archive/issue_comments_316338.json:
```json
{
    "body": "<a id='comment:20'></a>Is there a reason why not wipe out all three and add single function under graphs?",
    "created_at": "2015-04-17T20:40:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316338",
    "user": "https://trac.sagemath.org/admin/accounts/users/azi"
}
```

<a id='comment:20'></a>Is there a reason why not wipe out all three and add single function under graphs?



---

archive/issue_comments_316339.json:
```json
{
    "body": "<a id='comment:21'></a>Oh yeah.. And another bad news:\n\n`FiniteGroup.cayley_graph()` and `categories.semigroups.cayley_graph` do not take the same input `>_<`\n\nNathann",
    "created_at": "2015-04-17T20:41:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316339",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:21'></a>Oh yeah.. And another bad news:

`FiniteGroup.cayley_graph()` and `categories.semigroups.cayley_graph` do not take the same input `>_<`

Nathann



---

archive/issue_comments_316340.json:
```json
{
    "body": "<a id='comment:22'></a>> Is there a reason why not wipe out all three and add single function under graphs?\n\n\nA reason to not wipe out two among the three: None.\n\nA reason to have a single function in the graph folder: I'd say none. Because Nicolas decided that whatever applied to all groups should be in categories/.\n\nNathann",
    "created_at": "2015-04-17T20:42:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316340",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>> Is there a reason why not wipe out all three and add single function under graphs?


A reason to not wipe out two among the three: None.

A reason to have a single function in the graph folder: I'd say none. Because Nicolas decided that whatever applied to all groups should be in categories/.

Nathann



---

archive/issue_comments_316341.json:
```json
{
    "body": "<a id='comment:23'></a>Okay... So what would you think of removing the two `cayley_graph` functions from `group.pyx` and `old.pyx` ?\n\nNathann",
    "created_at": "2015-04-17T20:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316341",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:23'></a>Okay... So what would you think of removing the two `cayley_graph` functions from `group.pyx` and `old.pyx` ?

Nathann



---

archive/issue_comments_316342.json:
```json
{
    "body": "Changing commit from \"86f696f0dd36cc683ce5a67c3986f55c846592e1\" to \"d6494fd229e40573b2a86ba64c8cde241ab795b3\"",
    "created_at": "2015-04-17T20:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "86f696f0dd36cc683ce5a67c3986f55c846592e1" to "d6494fd229e40573b2a86ba64c8cde241ab795b3"



---

archive/issue_comments_316343.json:
```json
{
    "body": "<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-17T20:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316343",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:24'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_316344.json:
```json
{
    "body": "<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T21:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316344",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316345.json:
```json
{
    "body": "Changing commit from \"d6494fd229e40573b2a86ba64c8cde241ab795b3\" to \"07e79d5ac60305075ac196f144252d32f0962078\"",
    "created_at": "2015-04-17T21:29:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316345",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d6494fd229e40573b2a86ba64c8cde241ab795b3" to "07e79d5ac60305075ac196f144252d32f0962078"



---

archive/issue_comments_316346.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,51 @@\n+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. \n \n+As an example\n+\n+\n+Let x,g be two permutations\n+\n+```\n+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))\n+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)\n+A = PermutationGroup([p,q])\n+p,q = A(p),A(q)\n+```\n+\n+The following code\n+\n+```\n+G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)\n+```\n+\n+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.\n+\n+In order to obtain a list of edges of the above Cayley Graph one can also do\n+\n+```\n+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') \n+ast.literal_eval(str(gout))\n+```\n+\n+which takes **0.4s**.\n+\n+I need to do this for roughly 300k such permutation groups and it makes a big difference which implementation we use.\n+\n+Note that the last example assumed ast is imported and also that\n+\n+```\n+gap.LoadPackage('\"grape\"')\n+```\n+\n+was loaded. \n+\n+With the branch applied\n+\n+```\n+sage: %time G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)\n+CPU times: user 192 ms, sys: 4 ms, total: 196 ms\n+Wall time: 193 ms\n+```\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-17T21:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316346",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,51 @@
+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The solution is to use GRAPE directly. 
 
+As an example
+
+
+Let x,g be two permutations
+
+```
+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))
+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)
+A = PermutationGroup([p,q])
+p,q = A(p),A(q)
+```
+
+The following code
+
+```
+G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)
+```
+
+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.
+
+In order to obtain a list of edges of the above Cayley Graph one can also do
+
+```
+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') 
+ast.literal_eval(str(gout))
+```
+
+which takes **0.4s**.
+
+I need to do this for roughly 300k such permutation groups and it makes a big difference which implementation we use.
+
+Note that the last example assumed ast is imported and also that
+
+```
+gap.LoadPackage('"grape"')
+```
+
+was loaded. 
+
+With the branch applied
+
+```
+sage: %time G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)
+CPU times: user 192 ms, sys: 4 ms, total: 196 ms
+Wall time: 193 ms
+```
 
 Comment: 1
 
``````




---

archive/issue_comments_316347.json:
```json
{
    "body": "<a id='comment:26'></a>Got a x5 speedup ;-PPP",
    "created_at": "2015-04-17T21:29:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316347",
    "user": "https://github.com/videlec"
}
```

<a id='comment:26'></a>Got a x5 speedup ;-PPP



---

archive/issue_comments_316348.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T21:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316348",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316349.json:
```json
{
    "body": "Changing commit from \"07e79d5ac60305075ac196f144252d32f0962078\" to \"69aa0939c24ad4f0a2c02b2a5f296aa04f3a498e\"",
    "created_at": "2015-04-17T21:34:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316349",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "07e79d5ac60305075ac196f144252d32f0962078" to "69aa0939c24ad4f0a2c02b2a5f296aa04f3a498e"



---

archive/issue_comments_316350.json:
```json
{
    "body": "<a id='comment:28'></a>What are those constants again?.... It's like you are obfuscating the code.",
    "created_at": "2015-04-17T21:38:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316350",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:28'></a>What are those constants again?.... It's like you are obfuscating the code.



---

archive/issue_comments_316351.json:
```json
{
    "body": "<a id='comment:29'></a>Replying to [comment:28 ncohen]:\n> What are those constants again?.... It's like you are obfuscating the code.\n\n\nThese are the constants from the hasing of tuples in Python...",
    "created_at": "2015-04-17T21:40:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316351",
    "user": "https://github.com/videlec"
}
```

<a id='comment:29'></a>Replying to [comment:28 ncohen]:
> What are those constants again?.... It's like you are obfuscating the code.


These are the constants from the hasing of tuples in Python...



---

archive/issue_comments_316352.json:
```json
{
    "body": "<a id='comment:30'></a>Could you say so in the code?",
    "created_at": "2015-04-17T21:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316352",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:30'></a>Could you say so in the code?



---

archive/issue_comments_316353.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-17T22:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316353",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316354.json:
```json
{
    "body": "Changing commit from \"69aa0939c24ad4f0a2c02b2a5f296aa04f3a498e\" to \"763ca62c664f5f6c35d821f2fc908c479feafcdc\"",
    "created_at": "2015-04-17T22:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316354",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "69aa0939c24ad4f0a2c02b2a5f296aa04f3a498e" to "763ca62c664f5f6c35d821f2fc908c479feafcdc"



---

archive/issue_comments_316355.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,43 @@\n+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The only reasonable solution was to use GRAPE directly. \n \n+As an example, let `p` and `q` be two permutations\n+\n+```\n+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))\n+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)\n+A = PermutationGroup([p,q])\n+p,q = A(p),A(q)\n+```\n+\n+Then, the following code\n+\n+```\n+G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)\n+```\n+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.\n+\n+With the branch applied\n+\n+```\n+sage: %time G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)\n+CPU times: user 192 ms, sys: 4 ms, total: 196 ms\n+Wall time: 193 ms\n+```\n+\n+Crazy speed up: x130 :-)\n+\n+A previous workaround was to do\n+\n+```\n+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') \n+ast.literal_eval(str(gout))\n+```\n+which takes **0.4s**. Note that the last example assumed ast is imported and also that\n+\n+```\n+gap.LoadPackage('\"grape\"')\n+```\n+was loaded.\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-17T22:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316355",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,43 @@
+Computing the Cayley graph of a group and generator set is extremely slow in Sage. The only reasonable solution was to use GRAPE directly. 
 
+As an example, let `p` and `q` be two permutations
+
+```
+p=((2,9),(7,28),(10,32),(11,33),(12,34),(13,47),(14,36),(18,58),(22,66),(26,73),(30,77),(35,45),(37,81),(38,82),(39,98),(40,84),(41,85),(42,86),(43,106),(44,88),(46,89),(48,112),(49,91),(52,111),(56,125),(60,129),(64,136),(68,140),(71,144),(75,148),(79,152),(83,96),(87,104),(90,109),(92,156),(93,157),(94,177),(95,159),(97,160),(99,182),(100,162),(101,163),(102,187),(103,165),(105,166),(107,193),(108,168),(110,169),(113,199),(114,171),(117,192),(120,198),(123,211),(127,215),(131,219),(134,223),(138,227),(142,231),(146,235),(150,239),(154,243),(158,175),(161,180),(164,185),(167,190),(170,196),(172,246),(173,266),(174,248),(176,249),(178,271),(179,251),(181,252),(183,276),(184,254),(186,255),(188,282),(189,257),(191,258),(194,288),(195,260),(197,261),(200,294),(201,263),(203,281),(206,287),(209,293),(213,305),(217,309),(221,313),(225,316),(229,320),(233,324),(237,327),(241,331),(245,334),(247,264),(250,269),(253,274),(256,279),(259,285),(262,291),(265,335),(267,354),(268,337),(270,338),(272,359),(273,340),(275,341),(277,364),(278,343),(280,344),(283,369),(284,346),(286,347),(289,375),(290,349),(292,350),(295,379),(297,368),(300,374),(303,378),(307,388),(311,392),(315,395),(318,396),(322,400),(326,403),(329,404),(333,407),(336,352),(339,357),(342,362),(345,366),(348,372),(351,377),(353,408),(355,423),(356,410),(358,411),(360,428),(361,413),(363,414),(365,431),(367,416),(370,435),(371,418),(373,419),(376,439),(381,434),(384,438),(387,440),(390,446),(394,449),(398,450),(402,453),(406,454),(409,421),(412,426),(415,430),(417,432),(420,437),(422,455),(424,464),(425,457),(427,458),(429,467),(433,460),(436,470),(442,469),(445,471),(448,474),(452,475),(456,462),(459,466),(461,468),(463,476),(465,479),(473,480),(477,478))
+q=((1,107,306,184,333,101,19,272,328,201,56,265,31,289,447,10,75,280,132,429,70,14,217,422,155,43,212,100,241,433,3,178,236,114,394,172,8,194,389,278,26,186,61,360,405,2,127,353,80,376,122,40,150,367,222,94,145,49,311,463),(4,167,380,254,402,163,53,339,397,263,117,335,69,348,472,32,138,344,210,459,133,36,300,455,234,87,296,162,322,460,15,250,317,171,445,246,23,259,441,343,64,255,121,412,451,9,206,408,143,420,202,84,229,416,304,158,224,91,384,476),(5,188,130,273,406,12,57,355,153,290,123,97,76,370,314,37,146,110,218,465,6,44,307,275,242,102,59,179,329,292,16,267,78,195,448,38,27,283,220,361,71,46,128,424,244,11,213,181,151,436,17,95,237,197,312,173,29,108,390,363),(7,105,214,277,332,41,60,270,238,295,55,174,79,286,391,39,74,189,221,427,24,48,216,356,245,42,124,183,240,371,18,176,147,200,393,92,30,191,308,365,25,103,131,358,330,13,126,268,154,373,54,99,149,284,315,93,72,113,310,425),(20,256,208,340,452,34,118,409,232,349,203,160,139,417,386,81,225,169,301,477,21,88,381,341,323,164,119,251,398,350,50,336,141,260,473,82,65,345,302,413,134,89,207,456,325,33,297,252,230,461,51,159,318,261,385,247,67,168,442,414),(22,166,298,342,401,85,120,338,319,351,116,248,142,347,443,83,137,257,303,458,62,90,299,410,326,86,204,253,321,418,52,249,226,262,444,156,68,258,382,415,63,165,209,411,399,35,205,337,233,419,115,161,228,346,387,157,135,170,383,457),(28,190,388,362,407,185,129,357,404,377,125,352,152,372,474,96,148,366,313,466,144,109,309,462,334,104,305,274,331,468,58,269,327,291,449,264,77,285,446,430,73,279,219,426,454,45,215,421,243,437,211,180,239,432,395,175,235,196,392,478),(47,287,423,324,439,281,182,320,435,440,177,316,199,438,479,66,193,434,364,453,187,198,359,450,379,192,354,231,375,480,98,227,369,378,467,223,112,374,464,403,106,368,276,400,470,111,271,396,294,471,266,140,288,469,431,136,282,293,428,475),)
+A = PermutationGroup([p,q])
+p,q = A(p),A(q)
+```
+
+Then, the following code
+
+```
+G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)
+```
+takes **26** seconds to finish  and it returns a DiGraph that still to be converted to a Graph.
+
+With the branch applied
+
+```
+sage: %time G = A.cayley_graph(generators=[p, q, p.inverse()], simple=True)
+CPU times: user 192 ms, sys: 4 ms, total: 196 ms
+Wall time: 193 ms
+```
+
+Crazy speed up: x130 :-)
+
+A previous workaround was to do
+
+```
+gout = gap('UndirectedEdges(CayleyGraph((Group(' + str(x) + ',' + str(g)+ ' )), [' + str(g) + ',' + str(x) + ',' + str(g.inverse()) + ']));') 
+ast.literal_eval(str(gout))
+```
+which takes **0.4s**. Note that the last example assumed ast is imported and also that
+
+```
+gap.LoadPackage('"grape"')
+```
+was loaded.
 
 Comment: 1
 
``````




---

archive/issue_comments_316356.json:
```json
{
    "body": "<a id='comment:33'></a>This is your code:\n\n```\nmult += <long> (i + self.n)\n```\n\nThis is from Python's latest release\n\n```\nmult += (long)(82520L + len + len);\n```",
    "created_at": "2015-04-18T07:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316356",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:33'></a>This is your code:

```
mult += <long> (i + self.n)
```

This is from Python's latest release

```
mult += (long)(82520L + len + len);
```



---

archive/issue_comments_316357.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:33 ncohen]:\n> This is your code:\n> \n> ```\n> mult += <long> (i + self.n)\n> ```\n> \n> This is from Python's latest release\n> \n> ```\n> mult += (long)(82520L + len + len);\n> ```\n\n\nRight, this is not exactly the same as the Python implementation. Do you want me that it coincides with tuples as it was the case before? Note that in Python implementation len goes from n-1 to 0. Would it be better with some salt like\n\n```\nmult += <long>(82520L + i + self.n)\n```",
    "created_at": "2015-04-18T09:03:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316357",
    "user": "https://github.com/videlec"
}
```

<a id='comment:34'></a>Replying to [comment:33 ncohen]:
> This is your code:
> 
> ```
> mult += <long> (i + self.n)
> ```
> 
> This is from Python's latest release
> 
> ```
> mult += (long)(82520L + len + len);
> ```


Right, this is not exactly the same as the Python implementation. Do you want me that it coincides with tuples as it was the case before? Note that in Python implementation len goes from n-1 to 0. Would it be better with some salt like

```
mult += <long>(82520L + i + self.n)
```



---

archive/issue_comments_316358.json:
```json
{
    "body": "<a id='comment:35'></a>Right, this is not exactly the same as the Python implementation. Do you want me that it coincides with tuples as it was the case before? Note that in Python implementation len goes from n-1 to 0. Would it be better with some salt like\n> {{{\n> mult += <long>(82520L + i + self.n)\n> }}}\n\n\nHonestly I do not care at all. I see two ways out:\n\n1) You want it to coincide with the Python implementation, and so let's do it right\n\n2) You don't need it to coincide, and then I don't see why it has to be this complicated.\n\nNathann",
    "created_at": "2015-04-18T09:12:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316358",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:35'></a>Right, this is not exactly the same as the Python implementation. Do you want me that it coincides with tuples as it was the case before? Note that in Python implementation len goes from n-1 to 0. Would it be better with some salt like
> {{{
> mult += <long>(82520L + i + self.n)
> }}}


Honestly I do not care at all. I see two ways out:

1) You want it to coincide with the Python implementation, and so let's do it right

2) You don't need it to coincide, and then I don't see why it has to be this complicated.

Nathann



---

archive/issue_comments_316359.json:
```json
{
    "body": "Changing commit from \"763ca62c664f5f6c35d821f2fc908c479feafcdc\" to \"762b3e02dbffa614c937965978be65e0374c58c2\"",
    "created_at": "2015-04-18T10:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316359",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "763ca62c664f5f6c35d821f2fc908c479feafcdc" to "762b3e02dbffa614c937965978be65e0374c58c2"



---

archive/issue_comments_316360.json:
```json
{
    "body": "<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-04-18T10:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:36'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_316361.json:
```json
{
    "body": "<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-18T12:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:37'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_316362.json:
```json
{
    "body": "Changing commit from \"762b3e02dbffa614c937965978be65e0374c58c2\" to \"d0ec65bb221ff76dd0c63b606659ccfd3e4015e6\"",
    "created_at": "2015-04-18T12:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316362",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "762b3e02dbffa614c937965978be65e0374c58c2" to "d0ec65bb221ff76dd0c63b606659ccfd3e4015e6"



---

archive/issue_comments_316363.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Nathann Cohen\"",
    "created_at": "2015-04-18T12:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316363",
    "user": "https://github.com/nathanncohen"
}
```

Changing reviewer from "" to "Nathann Cohen"



---

archive/issue_comments_316364.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-18T12:47:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316364",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_051533.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-19T01:52:01Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18239#event-51533"
}
```



---

archive/issue_comments_316365.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-19T01:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316365",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_316366.json:
```json
{
    "body": "Changing branch from \"public/18239\" to \"d0ec65bb221ff76dd0c63b606659ccfd3e4015e6\"",
    "created_at": "2015-04-19T01:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18239",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18239#issuecomment-316366",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/18239" to "d0ec65bb221ff76dd0c63b606659ccfd3e4015e6"
