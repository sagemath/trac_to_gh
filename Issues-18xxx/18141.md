# Issue 18141: special values of transcendental functions

archive/issues_017904.json:
```json
{
    "body": "The functions in `transcentental.py` could return special values:\n* `zetaderiv(0,1)=-1/2*log(2*pi)`, http://dlmf.nist.gov/25.6#E11\n* `zetaderiv(0,2)=-1/2*log(2*pi)^2+...`, http://dlmf.nist.gov/25.6#E12, needs Euler constants\n* `hurwitz_zeta`, we already have:\n {{{\nsage: hurwitz_zeta(5,1/2)\n31*zeta(5)\nsage: hurwitz_zeta(x,1/2)\nhurwitz_zeta(x, 1/2)\n}}}\n The latter should be `(2^x-1)*zeta(x)`. Also `hurwitz_zeta(0,...)` is missing, http://dlmf.nist.gov/25.11#v\n\n\nThis ticket may also discuss: are there closed forms without `zeta` for\n* `zeta` with odd positive argument: http://dlmf.nist.gov/25.6#E6 ?\n \n\nCC:  @behackl\n\nStatus: new\n\nIssue created by migration from https://trac.sagemath.org/ticket/18141\n\n",
    "created_at": "2015-04-08T08:40:34Z",
    "labels": [
        "component: symbolics"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "special values of transcendental functions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18141",
    "user": "https://github.com/rwst"
}
```
The functions in `transcentental.py` could return special values:
* `zetaderiv(0,1)=-1/2*log(2*pi)`, http://dlmf.nist.gov/25.6#E11
* `zetaderiv(0,2)=-1/2*log(2*pi)^2+...`, http://dlmf.nist.gov/25.6#E12, needs Euler constants
* `hurwitz_zeta`, we already have:
 {{{
sage: hurwitz_zeta(5,1/2)
31*zeta(5)
sage: hurwitz_zeta(x,1/2)
hurwitz_zeta(x, 1/2)
}}}
 The latter should be `(2^x-1)*zeta(x)`. Also `hurwitz_zeta(0,...)` is missing, http://dlmf.nist.gov/25.11#v


This ticket may also discuss: are there closed forms without `zeta` for
* `zeta` with odd positive argument: http://dlmf.nist.gov/25.6#E6 ?
 

CC:  @behackl

Status: new

Issue created by migration from https://trac.sagemath.org/ticket/18141





---

archive/issue_comments_255729.json:
```json
{
    "body": "<a id='comment:2'></a>Hi!\n\nI'm rather motivated to implement some of the special values mentioned above; and I guess the \"correct\" place would be `src/functions/transcendental.py`, wouldn't it?\n\nHowever, I'm not quite sure of how to tackle the implementation of the [Stieltjes constants](https://en.wikipedia.org/wiki/Stieltjes_constants). I think that it would be elegant if the constants were also available in pynac (such that `zeta(s).series(s==1)` could yield the appropriate series expansion directly).\n\nThe problem with this approach is, that I'm not sure of how to implement a familiy of constants in pynac---or even just in sage.\n\nWhat do you think about moving the part with the Stieltjes constants to a separate ticket?",
    "created_at": "2016-01-05T12:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255729",
    "user": "https://github.com/behackl"
}
```

<a id='comment:2'></a>Hi!

I'm rather motivated to implement some of the special values mentioned above; and I guess the "correct" place would be `src/functions/transcendental.py`, wouldn't it?

However, I'm not quite sure of how to tackle the implementation of the [Stieltjes constants](https://en.wikipedia.org/wiki/Stieltjes_constants). I think that it would be elegant if the constants were also available in pynac (such that `zeta(s).series(s==1)` could yield the appropriate series expansion directly).

The problem with this approach is, that I'm not sure of how to implement a familiy of constants in pynac---or even just in sage.

What do you think about moving the part with the Stieltjes constants to a separate ticket?



---

archive/issue_comments_255730.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:2 behackl]:\n> I'm rather motivated to implement some of the special values mentioned above; and I guess the \"correct\" place would be `src/functions/transcendental.py`, wouldn't it?\n\nYes, where the functions are.\n> However, I'm not quite sure of how to tackle the implementation of the [Stieltjes constants](https://en.wikipedia.org/wiki/Stieltjes_constants). I think that it would be elegant if the constants were also available in pynac (such that `zeta(s).series(s==1)` could yield the appropriate series expansion directly).\n\nTo recap GiNaC/Pynac by default implements series by differentiation so a naive way to get a nice expansion would be to implement special values of the derivatives like in #17678 with the Bessel functions. With `zetaderiv` this doesn't look like resulting in something usable:\n\n```\nsage: zeta(x).series(x==1,2)\n1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + (1/2*euler_gamma^2 - 1/24*pi^2 + (euler_gamma + log(pi) + 2*zetaderiv(1, 0))*log(2) + 1/2*log(2)^2 + (euler_gamma + 2*zetaderiv(1, 0))*log(pi) + 1/2*log(pi)^2 + 2*euler_gamma*zetaderiv(1, 0) - zetaderiv(2, 0))*(x - 1) + Order((x - 1)^2)\n```\nI haven't fiddled with Pynac series yet so I'm naive on how to get a different output for this. I'm also not exactly at home with complex analysis.\n> The problem with this approach is, that I'm not sure of how to implement a familiy of constants in pynac---or even just in sage.\n\nIn Sage there is `symbolic/constants*` with three source files. Earlier I had started written about the Pynac side in https://github.com/pynac/pynac/wiki/%7C-constants\n\nTo implement a family of symbolic constants (i.e. indexed) would be a first.\n\nHowever, at first glance I see no reason why `Stieltjes` could not be another function taking only arguments from NN.\n> What do you think about moving the part with the Stieltjes constants to a separate ticket?\n\nIt looks like this is a sensible approach.",
    "created_at": "2016-01-05T14:19:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255730",
    "user": "https://github.com/rwst"
}
```

<a id='comment:3'></a>Replying to [comment:2 behackl]:
> I'm rather motivated to implement some of the special values mentioned above; and I guess the "correct" place would be `src/functions/transcendental.py`, wouldn't it?

Yes, where the functions are.
> However, I'm not quite sure of how to tackle the implementation of the [Stieltjes constants](https://en.wikipedia.org/wiki/Stieltjes_constants). I think that it would be elegant if the constants were also available in pynac (such that `zeta(s).series(s==1)` could yield the appropriate series expansion directly).

To recap GiNaC/Pynac by default implements series by differentiation so a naive way to get a nice expansion would be to implement special values of the derivatives like in #17678 with the Bessel functions. With `zetaderiv` this doesn't look like resulting in something usable:

```
sage: zeta(x).series(x==1,2)
1*(x - 1)^(-1) + (euler_gamma + log(2) + log(pi) + 2*zetaderiv(1, 0)) + (1/2*euler_gamma^2 - 1/24*pi^2 + (euler_gamma + log(pi) + 2*zetaderiv(1, 0))*log(2) + 1/2*log(2)^2 + (euler_gamma + 2*zetaderiv(1, 0))*log(pi) + 1/2*log(pi)^2 + 2*euler_gamma*zetaderiv(1, 0) - zetaderiv(2, 0))*(x - 1) + Order((x - 1)^2)
```
I haven't fiddled with Pynac series yet so I'm naive on how to get a different output for this. I'm also not exactly at home with complex analysis.
> The problem with this approach is, that I'm not sure of how to implement a familiy of constants in pynac---or even just in sage.

In Sage there is `symbolic/constants*` with three source files. Earlier I had started written about the Pynac side in https://github.com/pynac/pynac/wiki/%7C-constants

To implement a family of symbolic constants (i.e. indexed) would be a first.

However, at first glance I see no reason why `Stieltjes` could not be another function taking only arguments from NN.
> What do you think about moving the part with the Stieltjes constants to a separate ticket?

It looks like this is a sensible approach.



---

archive/issue_comments_255731.json:
```json
{
    "body": "<a id='comment:4'></a>See #19834.\n\nPlease open a ticket showing which result you would expect from a zeta expansion using the `Stieltjes` \"function\" from #19834 so that I know what I should do in Pynac for the series expansion.",
    "created_at": "2016-01-05T14:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255731",
    "user": "https://github.com/rwst"
}
```

<a id='comment:4'></a>See #19834.

Please open a ticket showing which result you would expect from a zeta expansion using the `Stieltjes` "function" from #19834 so that I know what I should do in Pynac for the series expansion.



---

archive/issue_comments_255732.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:3 rws]:\n> However, at first glance I see no reason why `Stieltjes` could not be another function taking only arguments from NN.\n> > What do you think about moving the part with the Stieltjes constants to a separate ticket?\n\n> It looks like this is a sensible approach.\n\nThis is a good idea; I'll open a ticket for the zeta-expansion. Should I also open an issue for pynac?\n\nAlso, the numerical evaluation of the Stieltjes constants would be implemented in Sage (by some sort of `_evalf_` or `_eval_` I guess)---or would you need to add some sort of method in pynac as well?",
    "created_at": "2016-01-05T18:45:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255732",
    "user": "https://github.com/behackl"
}
```

<a id='comment:5'></a>Replying to [comment:3 rws]:
> However, at first glance I see no reason why `Stieltjes` could not be another function taking only arguments from NN.
> > What do you think about moving the part with the Stieltjes constants to a separate ticket?

> It looks like this is a sensible approach.

This is a good idea; I'll open a ticket for the zeta-expansion. Should I also open an issue for pynac?

Also, the numerical evaluation of the Stieltjes constants would be implemented in Sage (by some sort of `_evalf_` or `_eval_` I guess)---or would you need to add some sort of method in pynac as well?



---

archive/issue_comments_255733.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [comment:5 behackl]:\n> This is a good idea; I'll open a ticket for the zeta-expansion. Should I also open an issue for pynac?\n\nDone.\n> Also, the numerical evaluation of the Stieltjes constants would be implemented in Sage (by some sort of `_evalf_` or `_eval_` I guess)---or would you need to add some sort of method in pynac as well?\nNo. This could be a Cython function using arb.",
    "created_at": "2016-01-06T07:54:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255733",
    "user": "https://github.com/rwst"
}
```

<a id='comment:6'></a>Replying to [comment:5 behackl]:
> This is a good idea; I'll open a ticket for the zeta-expansion. Should I also open an issue for pynac?

Done.
> Also, the numerical evaluation of the Stieltjes constants would be implemented in Sage (by some sort of `_evalf_` or `_eval_` I guess)---or would you need to add some sort of method in pynac as well?
No. This could be a Cython function using arb.



---

archive/issue_comments_255734.json:
```json
{
    "body": "<a id='comment:7'></a>No, Python suffices: http://docs.sympy.org/dev/modules/mpmath/functions/zeta.html#stieltjes",
    "created_at": "2016-01-06T08:02:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255734",
    "user": "https://github.com/rwst"
}
```

<a id='comment:7'></a>No, Python suffices: http://docs.sympy.org/dev/modules/mpmath/functions/zeta.html#stieltjes



---

archive/issue_comments_255735.json:
```json
{
    "body": "<a id='comment:8'></a>This means we can have generalized Stieltjes constants and Hurwitz zeta expansion with only minor additional work, right?",
    "created_at": "2016-01-06T08:09:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255735",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>This means we can have generalized Stieltjes constants and Hurwitz zeta expansion with only minor additional work, right?



---

archive/issue_comments_255736.json:
```json
{
    "body": "<a id='comment:9'></a>Replying to [comment:8 rws]:\n> This means we can have generalized Stieltjes constants and Hurwitz zeta expansion with only minor additional work, right?\n\n\nFor the Zeta-function: yes, that is my impression. Regarding the expansion of the Hurwitz-Zeta, I'm not quite sure: `Function_HurwitzZeta` is not a `Ginac`-function, but a `BuiltinFunction`---and I don't know whether the series expansion of this function can be influenced. Currently:\n\n```\nsage: hurwitz_zeta(s, x).series(s==1)\nTraceback (most recent call last):\n...\nNotImplementedError: derivative with respect to first argument\n```\n\nBut yes, of course: if it is possible to set the expansion in some place, then we get the respective expansion of `hurwitz_zeta` for free, given that we have the generalized Stiltjes-constants.",
    "created_at": "2016-01-06T12:30:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255736",
    "user": "https://github.com/behackl"
}
```

<a id='comment:9'></a>Replying to [comment:8 rws]:
> This means we can have generalized Stieltjes constants and Hurwitz zeta expansion with only minor additional work, right?


For the Zeta-function: yes, that is my impression. Regarding the expansion of the Hurwitz-Zeta, I'm not quite sure: `Function_HurwitzZeta` is not a `Ginac`-function, but a `BuiltinFunction`---and I don't know whether the series expansion of this function can be influenced. Currently:

```
sage: hurwitz_zeta(s, x).series(s==1)
Traceback (most recent call last):
...
NotImplementedError: derivative with respect to first argument
```

But yes, of course: if it is possible to set the expansion in some place, then we get the respective expansion of `hurwitz_zeta` for free, given that we have the generalized Stiltjes-constants.



---

archive/issue_comments_255737.json:
```json
{
    "body": "<a id='comment:10'></a>It seems that adapting the expansion from `.series()` is possible by implementing a `_series_`-method (this is somehow mentioned [here](https://github.com/sagemath/sage/blob/master/src/sage/symbolic/function.pyx#L34-L37) in `symbolic/function.pyx`.",
    "created_at": "2016-01-06T19:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255737",
    "user": "https://github.com/behackl"
}
```

<a id='comment:10'></a>It seems that adapting the expansion from `.series()` is possible by implementing a `_series_`-method (this is somehow mentioned [here](https://github.com/sagemath/sage/blob/master/src/sage/symbolic/function.pyx#L34-L37) in `symbolic/function.pyx`.



---

archive/issue_comments_255738.json:
```json
{
    "body": "<a id='comment:11'></a>Replying to [comment:10 behackl]:\n> It seems that adapting the expansion from `.series()` is possible by implementing a `_series_`-method (this is somehow mentioned [here](https://github.com/sagemath/sage/blob/master/src/sage/symbolic/function.pyx#L34-L37) in `symbolic/function.pyx`.\n\nYes, setting any of these functions in Python will override Pynac's implementation (and slow down its calls). In case of `_series_` it's dispatched to in `function::series`, see https://github.com/pynac/pynac/blob/master/ginac/function.cpp#L943.\n\nFrom experimentation I can say that if you define a `Function_zeta::_series_()` method it will be called with 6 arguments, e.g. `zeta(y).series(x==1,5)` will call the Python function `Function_zeta::_series_(self, (y,), {'var': x, 'options': 0, 'at': 1, 'order': 5})` so you need to define it as `_series_(self, varlist, var=..., options=... , at=..., order=...)` and return an expression.",
    "created_at": "2016-01-08T07:43:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255738",
    "user": "https://github.com/rwst"
}
```

<a id='comment:11'></a>Replying to [comment:10 behackl]:
> It seems that adapting the expansion from `.series()` is possible by implementing a `_series_`-method (this is somehow mentioned [here](https://github.com/sagemath/sage/blob/master/src/sage/symbolic/function.pyx#L34-L37) in `symbolic/function.pyx`.

Yes, setting any of these functions in Python will override Pynac's implementation (and slow down its calls). In case of `_series_` it's dispatched to in `function::series`, see https://github.com/pynac/pynac/blob/master/ginac/function.cpp#L943.

From experimentation I can say that if you define a `Function_zeta::_series_()` method it will be called with 6 arguments, e.g. `zeta(y).series(x==1,5)` will call the Python function `Function_zeta::_series_(self, (y,), {'var': x, 'options': 0, 'at': 1, 'order': 5})` so you need to define it as `_series_(self, varlist, var=..., options=... , at=..., order=...)` and return an expression.



---

archive/issue_comments_255739.json:
```json
{
    "body": "<a id='comment:12'></a>Regarding this ticket: as it turns out, there are closed-form formulae for `zetaderiv(k, 0)` in general, cf. [this paper, Theorem 3 and (14)](http://www.ams.org/journals/mcom/1985-44-169/S0025-5718-1985-0771044-5/S0025-5718-1985-0771044-5.pdf).\n\nThe question is, whether we want that kind of expansion to happen for all k, or just for reasonably small k (as far as I can tell, these expansions really blow up fast in terms of summands).",
    "created_at": "2016-01-19T10:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18141",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18141#issuecomment-255739",
    "user": "https://github.com/behackl"
}
```

<a id='comment:12'></a>Regarding this ticket: as it turns out, there are closed-form formulae for `zetaderiv(k, 0)` in general, cf. [this paper, Theorem 3 and (14)](http://www.ams.org/journals/mcom/1985-44-169/S0025-5718-1985-0771044-5/S0025-5718-1985-0771044-5.pdf).

The question is, whether we want that kind of expansion to happen for all k, or just for reasonably small k (as far as I can tell, these expansions really blow up fast in terms of summands).
