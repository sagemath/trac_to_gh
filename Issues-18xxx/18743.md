# Issue 18743: Display does not support the 'ascii_art' option of _repr_option

archive/issues_018506.json:
```json
{
    "body": "The following does not behave as it should:\n\n```\nsage: class Foo(object):\n....:     def __repr__(self):\n....:         return '''BBB    AA   RRR\n....: B  B  A  A  R  R\n....: BBB   AAAA  RRR\n....: B  B  A  A  R  R\n....: BBB   A  A  R   R'''\n....:     def _repr_option(self, key):\n....:         return key == 'ascii_art'\nsage: F = Foo()\nsage: [F, F]\n```\n\n\nAssignee: @tscrim\n\nCC:  @vbraun @jdemeyer elixyre jpflori simonking @kevindilks\n\nKeywords: fancy repr\n\nBranch/Commit: 7bc49f55af4b8758616f75855037387b89410b92\n\nReviewer: Kevin Dilks\n\nAuthor: Travis Scrimshaw\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18743\n\n",
    "closed_at": "2015-10-12T07:16:17Z",
    "created_at": "2015-06-19T22:57:01Z",
    "labels": [
        "component: interfaces",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.9",
    "title": "Display does not support the 'ascii_art' option of _repr_option",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18743",
    "user": "https://github.com/tscrim"
}
```
The following does not behave as it should:

```
sage: class Foo(object):
....:     def __repr__(self):
....:         return '''BBB    AA   RRR
....: B  B  A  A  R  R
....: BBB   AAAA  RRR
....: B  B  A  A  R  R
....: BBB   A  A  R   R'''
....:     def _repr_option(self, key):
....:         return key == 'ascii_art'
sage: F = Foo()
sage: [F, F]
```


Assignee: @tscrim

CC:  @vbraun @jdemeyer elixyre jpflori simonking @kevindilks

Keywords: fancy repr

Branch/Commit: 7bc49f55af4b8758616f75855037387b89410b92

Reviewer: Kevin Dilks

Author: Travis Scrimshaw

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18743





---

archive/issue_comments_325832.json:
```json
{
    "body": "Changing branch from \"\" to \"public/interfaces/repr_option_ascii_art-18743\"",
    "created_at": "2015-06-19T22:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325832",
    "user": "https://github.com/tscrim"
}
```

Changing branch from "" to "public/interfaces/repr_option_ascii_art-18743"



---

archive/issue_comments_325833.json:
```json
{
    "body": "<a id='comment:1'></a>\nNew commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[15729eb](https://github.com/sagemath/sagetrac-mirror/commit/15729ebe846214cb60a6e8b0a9637b1829d9465f)|`Added support for _repr_option('ascii_art').`|",
    "created_at": "2015-06-19T22:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325833",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>
New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[15729eb](https://github.com/sagemath/sagetrac-mirror/commit/15729ebe846214cb60a6e8b0a9637b1829d9465f)|`Added support for _repr_option('ascii_art').`|



---

archive/issue_comments_325834.json:
```json
{
    "body": "Changing commit from \"\" to \"15729ebe846214cb60a6e8b0a9637b1829d9465f\"",
    "created_at": "2015-06-19T22:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325834",
    "user": "https://github.com/tscrim"
}
```

Changing commit from "" to "15729ebe846214cb60a6e8b0a9637b1829d9465f"



---

archive/issue_comments_325835.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-19T22:58:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325835",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_325836.json:
```json
{
    "body": "<a id='comment:2'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[20bd15d](https://github.com/sagemath/sagetrac-mirror/commit/20bd15dd22b857e41bbe50244112f6128c8082bb)|`Added support for _repr_option('ascii_art').`|",
    "created_at": "2015-06-19T22:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325836",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[20bd15d](https://github.com/sagemath/sagetrac-mirror/commit/20bd15dd22b857e41bbe50244112f6128c8082bb)|`Added support for _repr_option('ascii_art').`|



---

archive/issue_comments_325837.json:
```json
{
    "body": "Changing commit from \"15729ebe846214cb60a6e8b0a9637b1829d9465f\" to \"20bd15dd22b857e41bbe50244112f6128c8082bb\"",
    "created_at": "2015-06-19T22:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325837",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "15729ebe846214cb60a6e8b0a9637b1829d9465f" to "20bd15dd22b857e41bbe50244112f6128c8082bb"



---

archive/issue_comments_325838.json:
```json
{
    "body": "<a id='comment:3'></a>\nI am completely dumbfounded as to why this addition causes the failing doctests in `interfaces/psage.py`. It fails in the *original* code\n\n```\nascii_art_repr = ascii_art_repr or o.parent()._repr_option('element_ascii_art')\n```\nbut only when I've added the line before it! I know I could simply add `NonImplementedError` or a general `Exception` as the `except` types, but this makes me feel like I'm covering up errors that should be allowed to propagate.\n\nJean-Pierre and Simon, I've cc-ed you incase you had any insight as you were the most recent listed authors to `interfaces/expect.py` (and have made significant changes and are not currently cc-ed).",
    "created_at": "2015-06-25T17:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325838",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>
I am completely dumbfounded as to why this addition causes the failing doctests in `interfaces/psage.py`. It fails in the *original* code

```
ascii_art_repr = ascii_art_repr or o.parent()._repr_option('element_ascii_art')
```
but only when I've added the line before it! I know I could simply add `NonImplementedError` or a general `Exception` as the `except` types, but this makes me feel like I'm covering up errors that should be allowed to propagate.

Jean-Pierre and Simon, I've cc-ed you incase you had any insight as you were the most recent listed authors to `interfaces/expect.py` (and have made significant changes and are not currently cc-ed).



---

archive/issue_comments_325839.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-25T17:37:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325839",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_325840.json:
```json
{
    "body": "<a id='comment:4'></a>\nIs there a `__getattr__` hack somewhere in the interface?",
    "created_at": "2015-06-25T19:46:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325840",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>
Is there a `__getattr__` hack somewhere in the interface?



---

archive/issue_comments_325841.json:
```json
{
    "body": "<a id='comment:5'></a>\nWould this count: in `interfaces.sage0.SageElement`\n\n```\n    def __getattr__(self, attrname):\n        \"\"\"\n        EXAMPLES::\n\n            sage: m = sage0(4)\n            sage: four_gcd = m.gcd\n            sage: type(four_gcd)\n            <class 'sage.interfaces.sage0.SageFunction'>\n        \"\"\"\n        self._check_valid()\n        return SageFunction(self, attrname)\n```",
    "created_at": "2015-06-25T21:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325841",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:5'></a>
Would this count: in `interfaces.sage0.SageElement`

```
    def __getattr__(self, attrname):
        """
        EXAMPLES::

            sage: m = sage0(4)
            sage: four_gcd = m.gcd
            sage: type(four_gcd)
            <class 'sage.interfaces.sage0.SageFunction'>
        """
        self._check_valid()
        return SageFunction(self, attrname)
```



---

archive/issue_comments_325842.json:
```json
{
    "body": "<a id='comment:6'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                                                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|\n|[6285150](https://github.com/sagemath/sagetrac-mirror/commit/628515042ee978503660028042ffa303c092db95)|`Merge branch 'public/interfaces/repr_option_ascii_art-18743' of trac.sagemath.org:sage into public/interfaces/repr_option_ascii_art-18743`|\n|[7bc49f5](https://github.com/sagemath/sagetrac-mirror/commit/7bc49f55af4b8758616f75855037387b89410b92)|`Adding `_repr_option` to the interface element to avoid __getattr__.`|",
    "created_at": "2015-06-27T15:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325842",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                                                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
|[6285150](https://github.com/sagemath/sagetrac-mirror/commit/628515042ee978503660028042ffa303c092db95)|`Merge branch 'public/interfaces/repr_option_ascii_art-18743' of trac.sagemath.org:sage into public/interfaces/repr_option_ascii_art-18743`|
|[7bc49f5](https://github.com/sagemath/sagetrac-mirror/commit/7bc49f55af4b8758616f75855037387b89410b92)|`Adding `_repr_option` to the interface element to avoid __getattr__.`|



---

archive/issue_comments_325843.json:
```json
{
    "body": "Changing commit from \"20bd15dd22b857e41bbe50244112f6128c8082bb\" to \"7bc49f55af4b8758616f75855037387b89410b92\"",
    "created_at": "2015-06-27T15:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325843",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "20bd15dd22b857e41bbe50244112f6128c8082bb" to "7bc49f55af4b8758616f75855037387b89410b92"



---

archive/issue_comments_325844.json:
```json
{
    "body": "<a id='comment:7'></a>\nYes, that was the issue. I've just returned `False` anytime `_repr_option` is called to avoid calling the `__getattr__`. Thanks.\n\nNeeds review. Should be easy enough at this point.",
    "created_at": "2015-06-27T15:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325844",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:7'></a>
Yes, that was the issue. I've just returned `False` anytime `_repr_option` is called to avoid calling the `__getattr__`. Thanks.

Needs review. Should be easy enough at this point.



---

archive/issue_comments_325845.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-27T15:08:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325845",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_events_067450.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2015-08-24T21:08:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18743#event-67450"
}
```



---

archive/issue_comments_325846.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-10T20:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325846",
    "user": "https://github.com/kevindilks"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_325847.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Kevin Dilks\"",
    "created_at": "2015-10-10T20:14:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325847",
    "user": "https://github.com/kevindilks"
}
```

Changing reviewer from "" to "Kevin Dilks"



---

archive/issue_events_067451.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-12T07:16:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18743#event-67451"
}
```



---

archive/issue_comments_325848.json:
```json
{
    "body": "Changing branch from \"public/interfaces/repr_option_ascii_art-18743\" to \"7bc49f55af4b8758616f75855037387b89410b92\"",
    "created_at": "2015-10-12T07:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325848",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/interfaces/repr_option_ascii_art-18743" to "7bc49f55af4b8758616f75855037387b89410b92"



---

archive/issue_comments_325849.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-12T07:16:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18743",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18743#issuecomment-325849",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
