# Issue 18564: Boost Edge Connectivity

archive/issues_018327.json:
```json
{
    "body": "This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.\n\nAssignee: borassi\n\nCC:  @nathanncohen @dcoudert @jdemeyer jpflori @slel snark @vbraun wstein\n\nKeywords: Boost, connectivity\n\nBranch/Commit: fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f\n\nReviewer: Nathann Cohen\n\nAuthor: Michele Borassi\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18564\n\n",
    "closed_at": "2015-06-24T11:37:15Z",
    "created_at": "2015-06-01T09:36:01Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "Boost Edge Connectivity",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18564",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```
This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.

Assignee: borassi

CC:  @nathanncohen @dcoudert @jdemeyer jpflori @slel snark @vbraun wstein

Keywords: Boost, connectivity

Branch/Commit: fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f

Reviewer: Nathann Cohen

Author: Michele Borassi

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18564





---

archive/issue_comments_264670.json:
```json
{
    "body": "Set assignee to borassi.",
    "created_at": "2015-06-01T09:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264670",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Set assignee to borassi.



---

archive/issue_comments_264671.json:
```json
{
    "body": "Changing type from PLEASE CHANGE to enhancement.",
    "created_at": "2015-06-01T09:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264671",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing type from PLEASE CHANGE to enhancement.



---

archive/issue_comments_264672.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to graph theory.",
    "created_at": "2015-06-01T09:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264672",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing component from PLEASE CHANGE to graph theory.



---

archive/issue_comments_264673.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.\n \n+Since in my preliminary coding I had several problems with generic types, I will only restrict to vector-stored adjacency lists, leaving genericity to a future ticket.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-06-01T09:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264673",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.
 
+Since in my preliminary coding I had several problems with generic types, I will only restrict to vector-stored adjacency lists, leaving genericity to a future ticket.
 
 Comment: 1
 
```




---

archive/issue_comments_264674.json:
```json
{
    "body": "Changing keywords from \"\" to \"Boost, connectivity\".",
    "created_at": "2015-06-01T09:45:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264674",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing keywords from "" to "Boost, connectivity".



---

archive/issue_comments_264675.json:
```json
{
    "body": "<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-03T08:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264675",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:3'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264676.json:
```json
{
    "body": "<a id='comment:4'></a>This version lets us use Boost graph library to compute edge connectivity. Probably it is not the cleanest     way to do it, but at least it works. I am looking for suggestions on how to improve the code, in order to make it more readable:\n\n* is it better to use only Boost in C++ and Cython for the interface, or write the code in C++ and use Cython to convert the results? In the first case, we might have problems with generic types.\n* should we only keep translation capabilities, or should we also add a new backend? In other words, do we need Boost for linear-time or O(n log n) time algorithms?\n\nSome benchmark:\n\n```\nsage: G = graphs.RandomGNM(100,1000)\nsage: %timeit G.edge_connectivity()\n1 loops, best of 3: 10.7 s per loop\nsage: %timeit G.to_boost_graph().edge_connectivity()\n100 loops, best of 3: 2.04 ms per loop\n\n```\nThank you very much!",
    "created_at": "2015-06-03T08:20:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264676",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:4'></a>This version lets us use Boost graph library to compute edge connectivity. Probably it is not the cleanest     way to do it, but at least it works. I am looking for suggestions on how to improve the code, in order to make it more readable:

* is it better to use only Boost in C++ and Cython for the interface, or write the code in C++ and use Cython to convert the results? In the first case, we might have problems with generic types.
* should we only keep translation capabilities, or should we also add a new backend? In other words, do we need Boost for linear-time or O(n log n) time algorithms?

Some benchmark:

```
sage: G = graphs.RandomGNM(100,1000)
sage: %timeit G.edge_connectivity()
1 loops, best of 3: 10.7 s per loop
sage: %timeit G.to_boost_graph().edge_connectivity()
100 loops, best of 3: 2.04 ms per loop

```
Thank you very much!



---

archive/issue_comments_264677.json:
```json
{
    "body": "<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-03T08:35:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264677",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264678.json:
```json
{
    "body": "<a id='comment:6'></a>Something is missing in `BoostGraph` \n\n```\nsage: H = G.to_boost_graph()\nsage: H\n<sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>\nsage: H.\nH.add_edge      H.add_vertex    H.num_edges     H.num_vertices  \nsage: H.num_edges\n<built-in method num_edges of sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>\nsage: H.num_edges()\n1000\nsage: %timeit G.to_boost_graph().edge_connectivity()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-7-86519c65f6dd> in <module>()\n----> 1 get_ipython().magic(u'timeit G.to_boost_graph().edge_connectivity()')\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)\n   2305         magic_name, _, magic_arg_s = arg_s.partition(' ')\n   2306         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)\n-> 2307         return self.run_line_magic(magic_name, magic_arg_s)\n   2308 \n   2309     #-------------------------------------------------------------------------\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)\n   2226                 kwargs['local_ns'] = sys._getframe(stack_depth).f_locals\n   2227             with self.builtin_trap:\n-> 2228                 result = fn(*args,**kwargs)\n   2229             return result\n   2230 \n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)\n    191     # but it's overkill for just that one bit of state.\n    192     def magic_deco(arg):\n--> 193         call = lambda f, *a, **k: f(*a, **k)\n    194 \n    195         if callable(arg):\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)\n   1034             number = 1\n   1035             for _ in range(1, 10):\n-> 1036                 time_number = timer.timeit(number)\n   1037                 worst_tuning = max(worst_tuning, time_number / number)\n   1038                 if time_number >= 0.2:\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, number)\n    130         gc.disable()\n    131         try:\n--> 132             timing = self.inner(it, self.timer)\n    133         finally:\n    134             if gcold:\n\n<magic-timeit> in inner(_it, _timer)\n\nAttributeError: 'sage.graphs.base.boost_graph.BoostGraph' object has no attribute 'edge_connectivity'\nsage: \n```",
    "created_at": "2015-06-03T08:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264678",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:6'></a>Something is missing in `BoostGraph` 

```
sage: H = G.to_boost_graph()
sage: H
<sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>
sage: H.
H.add_edge      H.add_vertex    H.num_edges     H.num_vertices  
sage: H.num_edges
<built-in method num_edges of sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>
sage: H.num_edges()
1000
sage: %timeit G.to_boost_graph().edge_connectivity()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-7-86519c65f6dd> in <module>()
----> 1 get_ipython().magic(u'timeit G.to_boost_graph().edge_connectivity()')

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)
   2305         magic_name, _, magic_arg_s = arg_s.partition(' ')
   2306         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)
-> 2307         return self.run_line_magic(magic_name, magic_arg_s)
   2308 
   2309     #-------------------------------------------------------------------------

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)
   2226                 kwargs['local_ns'] = sys._getframe(stack_depth).f_locals
   2227             with self.builtin_trap:
-> 2228                 result = fn(*args,**kwargs)
   2229             return result
   2230 

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)
    191     # but it's overkill for just that one bit of state.
    192     def magic_deco(arg):
--> 193         call = lambda f, *a, **k: f(*a, **k)
    194 
    195         if callable(arg):

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)
   1034             number = 1
   1035             for _ in range(1, 10):
-> 1036                 time_number = timer.timeit(number)
   1037                 worst_tuning = max(worst_tuning, time_number / number)
   1038                 if time_number >= 0.2:

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, number)
    130         gc.disable()
    131         try:
--> 132             timing = self.inner(it, self.timer)
    133         finally:
    134             if gcold:

<magic-timeit> in inner(_it, _timer)

AttributeError: 'sage.graphs.base.boost_graph.BoostGraph' object has no attribute 'edge_connectivity'
sage: 
```



---

archive/issue_comments_264679.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-03T10:49:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264679",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264680.json:
```json
{
    "body": "<a id='comment:8'></a>Now it should work!",
    "created_at": "2015-06-03T10:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264680",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:8'></a>Now it should work!



---

archive/issue_comments_264681.json:
```json
{
    "body": "<a id='comment:9'></a>Hellooooo Michele,\n\nGreat work, thank you very much! If we can speedup several Sage functions the\nway you did for edge connectivity, the future looks bright `:-P`\n\nI have been trying to avoid the creation of these two .cpp/.hpp files, but no\ngood new for the moment. I sent a question on cython-users [1], let's pray for\ntheir wisdom. If there is no better way to do it than write cpp code, then\nperhaps it will be better to 'patch' boost when it is installed, and only add\nthe couple of lines we need? We'll see this later, after they have had the time\nto answer.\n\nAbout your code:\n\n- You add 'copyright' headers with a name which isn't yours: that's neither fair\n  to Robert Miller nor to yourself! If you want your files to have a copyright\n  header, please make it contain your name. Oh, and please steal a more recent\n  header, for this one is a bit old. I think this one is the most recent\n  {{{\n  #*****************************************************************************\n  #       Copyright (C) 2015 Michele Borassi <email_adress>\n  #\n  #  Distributed under the terms of the GNU General Public License (GPL)\n  #  as published by the Free Software Foundation; either version 2 of\n  #  the License, or (at your option) any later version.\n  #                  http://www.gnu.org/licenses/\n  #*****************************************************************************\n  }}}\n\n- I do not think that having a `Graph.to_boost_graph` makes much sense: at\n  user-level, having a 'boost' graph does not have much interest as it only has\n  very few commands to add edges/vertices, and your `edge_connectivity`\n  function. It would make more sense to keep this function inside of\n  `boost_graph.pyx`, for internal use.\n\n- You should modify `GenericGraph.edge_connectivity` to make it able to call\n  your function. Beware: this function applies to both directed and undirected\n  graphs, while apparently your function only handles undirected graphs. The\n  ideal, of course, would be to be able to call boost in both situations.\n\n  Many graph function make several implementations available, and for instance\n  `GenericGraph.automorphism_group`.\n\n- Every function that you add must be documented. Besides, it would be cool to\n  add your new file to the doc index [2].\n\n- Every function must contain doctests.\n  {{{\n(tmp|\u271a3)~/sage/graphs/base$ sage -coverage boost_graph.pyx\n\n---\nSCORE boost_graph.pyx: 0.0% (0 of 6)\n\nMissing documentation:\n* line 57: def __cinit__(self)\n* line 62: def add_vertex(self)\n* line 65: def add_edge(self, u, v)\n* line 68: def num_vertices(self)\n* line 71: def num_edges(self)\n* line 74: def edge_connectivity(self)\n\n---\n  }}}\n\nThank you very much for this improvement. That's no small speedup, and an\nimportant function.\n\nNathann\n\nPS: Set the ticket's status to 'needs_review' when you want somebody to look at it.\n\n[1] https://groups.google.com/d/topic/cython-users/ICRgCWVZ6RQ/discussion\n[2] http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file",
    "created_at": "2015-06-04T12:34:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264681",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:9'></a>Hellooooo Michele,

Great work, thank you very much! If we can speedup several Sage functions the
way you did for edge connectivity, the future looks bright `:-P`

I have been trying to avoid the creation of these two .cpp/.hpp files, but no
good new for the moment. I sent a question on cython-users [1], let's pray for
their wisdom. If there is no better way to do it than write cpp code, then
perhaps it will be better to 'patch' boost when it is installed, and only add
the couple of lines we need? We'll see this later, after they have had the time
to answer.

About your code:

- You add 'copyright' headers with a name which isn't yours: that's neither fair
  to Robert Miller nor to yourself! If you want your files to have a copyright
  header, please make it contain your name. Oh, and please steal a more recent
  header, for this one is a bit old. I think this one is the most recent
  {{{
  #*****************************************************************************
  #       Copyright (C) 2015 Michele Borassi <email_adress>
  #
  #  Distributed under the terms of the GNU General Public License (GPL)
  #  as published by the Free Software Foundation; either version 2 of
  #  the License, or (at your option) any later version.
  #                  http://www.gnu.org/licenses/
  #*****************************************************************************
  }}}

- I do not think that having a `Graph.to_boost_graph` makes much sense: at
  user-level, having a 'boost' graph does not have much interest as it only has
  very few commands to add edges/vertices, and your `edge_connectivity`
  function. It would make more sense to keep this function inside of
  `boost_graph.pyx`, for internal use.

- You should modify `GenericGraph.edge_connectivity` to make it able to call
  your function. Beware: this function applies to both directed and undirected
  graphs, while apparently your function only handles undirected graphs. The
  ideal, of course, would be to be able to call boost in both situations.

  Many graph function make several implementations available, and for instance
  `GenericGraph.automorphism_group`.

- Every function that you add must be documented. Besides, it would be cool to
  add your new file to the doc index [2].

- Every function must contain doctests.
  {{{
(tmp|✚3)~/sage/graphs/base$ sage -coverage boost_graph.pyx

---
SCORE boost_graph.pyx: 0.0% (0 of 6)

Missing documentation:
* line 57: def __cinit__(self)
* line 62: def add_vertex(self)
* line 65: def add_edge(self, u, v)
* line 68: def num_vertices(self)
* line 71: def num_edges(self)
* line 74: def edge_connectivity(self)

---
  }}}

Thank you very much for this improvement. That's no small speedup, and an
important function.

Nathann

PS: Set the ticket's status to 'needs_review' when you want somebody to look at it.

[1] https://groups.google.com/d/topic/cython-users/ICRgCWVZ6RQ/discussion
[2] http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file



---

archive/issue_comments_264682.json:
```json
{
    "body": "<a id='comment:10'></a>Hello Michele,\n\nYou will find at public/18564 a commit that avoids the creation of .hpp and .cpp files.\n\nNathann",
    "created_at": "2015-06-07T10:37:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264682",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:10'></a>Hello Michele,

You will find at public/18564 a commit that avoids the creation of .hpp and .cpp files.

Nathann



---

archive/issue_comments_264683.json:
```json
{
    "body": "<a id='comment:11'></a>Hello Nathann,\n\nyour branch is working well and this is easier than the first solution proposed by Michele.\n\n```\nsage: G = graphs.RandomBarabasiAlbert(1000,2)\nsage: %timeit G.edge_connectivity()\n1 loops, best of 3: 1.02 s per loop\nsage: %timeit G.to_boost_graph().edge_connectivity()\n10 loops, best of 3: 46 ms per loop\n```\n\nI\u2019m really impressed by what you did (both of you).",
    "created_at": "2015-06-07T17:47:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264683",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:11'></a>Hello Nathann,

your branch is working well and this is easier than the first solution proposed by Michele.

```
sage: G = graphs.RandomBarabasiAlbert(1000,2)
sage: %timeit G.edge_connectivity()
1 loops, best of 3: 1.02 s per loop
sage: %timeit G.to_boost_graph().edge_connectivity()
10 loops, best of 3: 46 ms per loop
```

I’m really impressed by what you did (both of you).



---

archive/issue_comments_264684.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-09T16:07:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264684",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264685.json:
```json
{
    "body": "<a id='comment:13'></a>I have merged Nathann's work. I will continue from here!",
    "created_at": "2015-06-09T16:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264685",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:13'></a>I have merged Nathann's work. I will continue from here!



---

archive/issue_comments_264686.json:
```json
{
    "body": "<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-10T11:47:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264686",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:14'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264687.json:
```json
{
    "body": "<a id='comment:15'></a>Just a tip: if you run 'sage -cython -a your_file.pyx', you will get a .html file which indicates how much C code it takes to repleace each of your python lines (click on the yellow lines you see).\n\nWith this, you can easily notice loops which involve Python though they should not. It is often because of variables of unspecified type.\n\nIf you do the following replacement\n\n```\n- N = G_sage.num_verts()\n+ cdef int N = G_sage.num_verts()\n```\n\nyou should see something happen in the loops involving `N`.\n\nNathann",
    "created_at": "2015-06-10T11:51:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264687",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>Just a tip: if you run 'sage -cython -a your_file.pyx', you will get a .html file which indicates how much C code it takes to repleace each of your python lines (click on the yellow lines you see).

With this, you can easily notice loops which involve Python though they should not. It is often because of variables of unspecified type.

If you do the following replacement

```
- N = G_sage.num_verts()
+ cdef int N = G_sage.num_verts()
```

you should see something happen in the loops involving `N`.

Nathann



---

archive/issue_comments_264688.json:
```json
{
    "body": "<a id='comment:16'></a>\n```\nError compiling Cython file:\n------------------------------------------------------------\n...\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 return G\n\u00a0\u00a0\u00a0 \n\u00a0\u00a0\u00a0 def __cinit__(self):\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sig_on()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 self.graph = new UndVecGraph()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ^\n------------------------------------------------------------\n\nsrc/sage/graphs/base/boost_graph.pyx:80:25: Operation only allowed in c++\n```\nHow can I tell it that the language is C++?",
    "created_at": "2015-06-10T11:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264688",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:16'></a>
```
Error compiling Cython file:
------------------------------------------------------------
...
                
        return G
    
    def __cinit__(self):
        sig_on()
        self.graph = new UndVecGraph()
                        ^
------------------------------------------------------------

src/sage/graphs/base/boost_graph.pyx:80:25: Operation only allowed in c++
```
How can I tell it that the language is C++?



---

archive/issue_comments_264689.json:
```json
{
    "body": "<a id='comment:17'></a>On my machine your code compiles.",
    "created_at": "2015-06-10T12:28:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264689",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>On my machine your code compiles.



---

archive/issue_comments_264690.json:
```json
{
    "body": "<a id='comment:18'></a>The code also compiles on my computer",
    "created_at": "2015-06-10T13:10:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264690",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:18'></a>The code also compiles on my computer



---

archive/issue_comments_264691.json:
```json
{
    "body": "<a id='comment:19'></a>Sorry I forgot to say that this was the output to the command\n\n./sage -cython -a src/sage/graphs/base/boost_graph.pyx\n\nsuggested by Nathann in comment 15\n\nReplying to [comment:18 dcoudert]:\n\n\n> The code also compiles on my computer",
    "created_at": "2015-06-10T13:14:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264691",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:19'></a>Sorry I forgot to say that this was the output to the command

./sage -cython -a src/sage/graphs/base/boost_graph.pyx

suggested by Nathann in comment 15

Replying to [comment:18 dcoudert]:


> The code also compiles on my computer



---

archive/issue_comments_264692.json:
```json
{
    "body": "<a id='comment:20'></a>> I forgot to say that this was the output to the command\n> \n> ./sage -cython -a src/sage/graphs/base/boost_graph.pyx\n\n\nOh, right! Can you try again after adding '#clang C++' in the first line of the file?\n\nNathann",
    "created_at": "2015-06-10T13:15:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264692",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:20'></a>> I forgot to say that this was the output to the command
> 
> ./sage -cython -a src/sage/graphs/base/boost_graph.pyx


Oh, right! Can you try again after adding '#clang C++' in the first line of the file?

Nathann



---

archive/issue_comments_264693.json:
```json
{
    "body": "<a id='comment:21'></a>No way... I have tried the following:\n\n```\n'#clang C++'\n#clang C++\n'#distutils: language = c++'\n#distutils: language = c++\n\n```\nThe command\n\n```\n./sage -cython --cplus -a src/sage/graphs/base/boost_graph.pyx\n\n```\nseems to work, but I cannot find the html :(",
    "created_at": "2015-06-10T13:38:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264693",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:21'></a>No way... I have tried the following:

```
'#clang C++'
#clang C++
'#distutils: language = c++'
#distutils: language = c++

```
The command

```
./sage -cython --cplus -a src/sage/graphs/base/boost_graph.pyx

```
seems to work, but I cannot find the html :(



---

archive/issue_comments_264694.json:
```json
{
    "body": "<a id='comment:22'></a>> seems to work, but I cannot find the html :(\n\n\nIsn't it right next to `boost_graph.pyx`? Type \"git status\" in Sage's folder, it should tell you something.\n\nNathann",
    "created_at": "2015-06-10T13:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264694",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>> seems to work, but I cannot find the html :(


Isn't it right next to `boost_graph.pyx`? Type "git status" in Sage's folder, it should tell you something.

Nathann



---

archive/issue_comments_264695.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-11T17:05:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264695",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264696.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-11T17:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264696",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_264697.json:
```json
{
    "body": "<a id='comment:24'></a>This code should be a first draft of the final code. I have cleaned the Boost part and I have inserted the Boost edge connectivity. I have also cleaned the old edge connectivity, in order to integrate the new part. The following tests show that the cleaning did not affect speed, and that the new algorithm is much faster. Still, we might improve two points:\n\n* implement weighted graphs;\n\n* there is a (small) bottleneck when `vertices = True` and Boost is used.\n\nTESTS:\n\n```\nsage: G = graphs.CompleteGraph(40)\n\nsage: %timeit G.edge_connectivity(boost = False)\n1 loops, best of 3: 8.84 s per loop\n(OLD: 1 loops, best of 3: 8.78 s per loop)\n\nsage: %timeit G.edge_connectivity(boost = False, vertices = True)\n1 loops, best of 3: 8.82 s per loop\n(OLD: 1 loops, best of 3: 8.8 s per loop)\n\nsage: %timeit G.edge_connectivity()\n1000 loops, best of 3: 445 \u00b5s per loop\n\nsage: %timeit G.edge_connectivity(vertices = True)\n100 loops, best of 3: 1.57 ms per loop\n\nsage: G = graphs.PathGraph(100)\n\nsage: %timeit G.edge_connectivity(boost = False)\n100 loops, best of 3: 2.2 ms per loop\n(OLD: 100 loops, best of 3: 2.26 ms per loop)\n\nsage: %timeit G.edge_connectivity(boost = False, value_only = False)\n10 loops, best of 3: 59.2 ms per loop\n(OLD: 10 loops, best of 3: 58.9 ms per loop)\n\nsage: %timeit G.edge_connectivity(boost = False, vertices = True)\n10 loops, best of 3: 59.8 ms per loop\n(OLD: 10 loops, best of 3: 58.2 ms per loop)\n\nsage: %timeit G.edge_connectivity()\n1000 loops, best of 3: 226 \u00b5s per loop\n\nsage: %timeit G.edge_connectivity(vertices = True)\n1000 loops, best of 3: 524 \u00b5s per loop\n\n```\nPROBLEMS\n\nUnfortunately, the Boost edge connectivity has a bug when dealing with directed graphs, evidenced by the following C++ code. What can we do? Should we open a ticket in Boost graph library?\n\n```\n#include <iostream>\n#include <boost/graph/adjacency_list.hpp>\n#include <boost/graph/edge_connectivity.hpp>\n\n\nusing namespace boost;\ntypedef adjacency_list<vecS,vecS,bidirectionalS> MyGraph;\n\nint main()\n{\n    typedef graph_traits < MyGraph >::vertex_descriptor vertex_descriptor;\n    typedef graph_traits < MyGraph >::edge_descriptor edge_descriptor;\n\n    MyGraph g;\n\n    vertex_descriptor v1 = add_vertex(g);\n    vertex_descriptor v2 = add_vertex(g);\n    vertex_descriptor v3 = add_vertex(g);\n\n    add_edge(v1, v2, g);\n    add_edge(v2, v3, g);\n\n    std::cout << \"Number of vertices: \" << num_vertices(g) << \".\\nNumber of edges: \" << num_edges(g) << \".\\n\";\n    std::vector < edge_descriptor > disconnecting_set;\n\n    std::cout << \"The edge connectivity is \"\n              << edge_connectivity(g, std::back_inserter(disconnecting_set))\n              << \".\" << std::endl;\n\n    add_edge(v2, v1, g);\n    std::cout << \"Number of vertices: \" << num_vertices(g) << \".\\nNumber of edges: \" << num_edges(g) << \".\\n\";\n\n    std::cout << \"Now, the edge connectivity is \"\n              << edge_connectivity(g, std::back_inserter(disconnecting_set))\n              << \".\" << std::endl;\n    return EXIT_SUCCESS;\n}\n\n```\nOutput:\n\n```\nNumber of vertices: 3.\nNumber of edges: 2.\nThe edge connectivity is 1.\nNumber of vertices: 3.\nNumber of edges: 3.\nNow, the edge connectivity is 0.\n```",
    "created_at": "2015-06-11T17:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264697",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:24'></a>This code should be a first draft of the final code. I have cleaned the Boost part and I have inserted the Boost edge connectivity. I have also cleaned the old edge connectivity, in order to integrate the new part. The following tests show that the cleaning did not affect speed, and that the new algorithm is much faster. Still, we might improve two points:

* implement weighted graphs;

* there is a (small) bottleneck when `vertices = True` and Boost is used.

TESTS:

```
sage: G = graphs.CompleteGraph(40)

sage: %timeit G.edge_connectivity(boost = False)
1 loops, best of 3: 8.84 s per loop
(OLD: 1 loops, best of 3: 8.78 s per loop)

sage: %timeit G.edge_connectivity(boost = False, vertices = True)
1 loops, best of 3: 8.82 s per loop
(OLD: 1 loops, best of 3: 8.8 s per loop)

sage: %timeit G.edge_connectivity()
1000 loops, best of 3: 445 µs per loop

sage: %timeit G.edge_connectivity(vertices = True)
100 loops, best of 3: 1.57 ms per loop

sage: G = graphs.PathGraph(100)

sage: %timeit G.edge_connectivity(boost = False)
100 loops, best of 3: 2.2 ms per loop
(OLD: 100 loops, best of 3: 2.26 ms per loop)

sage: %timeit G.edge_connectivity(boost = False, value_only = False)
10 loops, best of 3: 59.2 ms per loop
(OLD: 10 loops, best of 3: 58.9 ms per loop)

sage: %timeit G.edge_connectivity(boost = False, vertices = True)
10 loops, best of 3: 59.8 ms per loop
(OLD: 10 loops, best of 3: 58.2 ms per loop)

sage: %timeit G.edge_connectivity()
1000 loops, best of 3: 226 µs per loop

sage: %timeit G.edge_connectivity(vertices = True)
1000 loops, best of 3: 524 µs per loop

```
PROBLEMS

Unfortunately, the Boost edge connectivity has a bug when dealing with directed graphs, evidenced by the following C++ code. What can we do? Should we open a ticket in Boost graph library?

```
#include <iostream>
#include <boost/graph/adjacency_list.hpp>
#include <boost/graph/edge_connectivity.hpp>


using namespace boost;
typedef adjacency_list<vecS,vecS,bidirectionalS> MyGraph;

int main()
{
    typedef graph_traits < MyGraph >::vertex_descriptor vertex_descriptor;
    typedef graph_traits < MyGraph >::edge_descriptor edge_descriptor;

    MyGraph g;

    vertex_descriptor v1 = add_vertex(g);
    vertex_descriptor v2 = add_vertex(g);
    vertex_descriptor v3 = add_vertex(g);

    add_edge(v1, v2, g);
    add_edge(v2, v3, g);

    std::cout << "Number of vertices: " << num_vertices(g) << ".\nNumber of edges: " << num_edges(g) << ".\n";
    std::vector < edge_descriptor > disconnecting_set;

    std::cout << "The edge connectivity is "
              << edge_connectivity(g, std::back_inserter(disconnecting_set))
              << "." << std::endl;

    add_edge(v2, v1, g);
    std::cout << "Number of vertices: " << num_vertices(g) << ".\nNumber of edges: " << num_edges(g) << ".\n";

    std::cout << "Now, the edge connectivity is "
              << edge_connectivity(g, std::back_inserter(disconnecting_set))
              << "." << std::endl;
    return EXIT_SUCCESS;
}

```
Output:

```
Number of vertices: 3.
Number of edges: 2.
The edge connectivity is 1.
Number of vertices: 3.
Number of edges: 3.
Now, the edge connectivity is 0.
```



---

archive/issue_comments_264698.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-11T22:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264698",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_264699.json:
```json
{
    "body": "<a id='comment:25'></a>Hello Michele,\n\nYour patch is rather big, and I think that it can be simplified:\n\n- There is a weird 'pass' in boost_graph.pxd\n\n- `#clang c++` is not useful in Sage's source\n\n- You should add your new file to the doc index\n  (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)\n\n  Also, the header of your new module should describe what it implements\n\n- This will make you notice (Sphinx will scream) that whatever follows a '::'\n  should be indented.\n\n- A module's documentation is no place for 'todo'. If you want to work on\n  something, create a trac ticket.\n\n- Why a static 'from_sage_graph' function instead of a constructor accepting a\n  graph as an input?\n\n- `sig_on/sig_off` -- these markers are used so that the code can be interrupted\n  while some C code is being run. Why would you put them around functions which\n  end instantaneously, like `add_edge/add_vertex`?\n\n- The variable 'i' is also an integer, and you should define it as 'cdef int' so\n  that your Cython code will be better optimised.\n\n- Why would you define `edge_connectivity_boost_*` functions in\n  `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can\n  import them if needed.\n\n- Why did you move the LP out of the current `edge_connectivity` function? Can't\n  you leave if where it is, and at the beginning of the file call the boost\n  functions if this is what the user wants?\n\n- When you submit a branch, always look at the final 'diff'. You can see it by\n  clicking on the (green) branch's name on its ticket, and it will tell you what\n  the reviewer sees and how he will have to figure out what your code\n  does. Everything that is not crystal clear for you is not crystal clear for\n  him.\n\nGood evening,\n\nNathann",
    "created_at": "2015-06-11T22:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264699",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:25'></a>Hello Michele,

Your patch is rather big, and I think that it can be simplified:

- There is a weird 'pass' in boost_graph.pxd

- `#clang c++` is not useful in Sage's source

- You should add your new file to the doc index
  (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)

  Also, the header of your new module should describe what it implements

- This will make you notice (Sphinx will scream) that whatever follows a '::'
  should be indented.

- A module's documentation is no place for 'todo'. If you want to work on
  something, create a trac ticket.

- Why a static 'from_sage_graph' function instead of a constructor accepting a
  graph as an input?

- `sig_on/sig_off` -- these markers are used so that the code can be interrupted
  while some C code is being run. Why would you put them around functions which
  end instantaneously, like `add_edge/add_vertex`?

- The variable 'i' is also an integer, and you should define it as 'cdef int' so
  that your Cython code will be better optimised.

- Why would you define `edge_connectivity_boost_*` functions in
  `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can
  import them if needed.

- Why did you move the LP out of the current `edge_connectivity` function? Can't
  you leave if where it is, and at the beginning of the file call the boost
  functions if this is what the user wants?

- When you submit a branch, always look at the final 'diff'. You can see it by
  clicking on the (green) branch's name on its ticket, and it will tell you what
  the reviewer sees and how he will have to figure out what your code
  does. Everything that is not crystal clear for you is not crystal clear for
  him.

Good evening,

Nathann



---

archive/issue_comments_264700.json:
```json
{
    "body": "<a id='comment:26'></a>Finally: please report the bug you found to boost. They must fix it.",
    "created_at": "2015-06-11T22:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264700",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:26'></a>Finally: please report the bug you found to boost. They must fix it.



---

archive/issue_comments_264701.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-12T10:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264701",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264702.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-12T10:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264702",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264703.json:
```json
{
    "body": "<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-12T10:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264703",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264704.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-12T10:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264704",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264705.json:
```json
{
    "body": "<a id='comment:30'></a>Hello,\n\nI have tried to correct your problems. More details below.\n\nBest,\n\nMichele\n\n> - There is a weird 'pass' in boost_graph.pxd\n\n\nRemoved!\n\n> \n> - `#clang c++` is not useful in Sage's source\n\n\nThen I am afraid I have not understood your comment 20... Where should I have put it? In any case, I removed it.\n\n> \n> - You should add your new file to the doc index\n> (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)\n\n\nSorry, you have already told me to do so, but since I had to take many things into account, I forgot. Now I have done it!\n\n> \n> Also, the header of your new module should describe what it implements\n\n\nI have added the list of methods implemented, as in `generic_graph`. Is this what you meant?\n\n> \n> - This will make you notice (Sphinx will scream) that whatever follows a '::'\n> should be indented.\n\n\nDone!\n\n> \n> - A module's documentation is no place for 'todo'. If you want to work on\n> something, create a trac ticket.\n\n\nOk!\n\n> \n> - Why a static 'from_sage_graph' function instead of a constructor accepting a\n> graph as an input?\n\n\nSigh, you are right... Done!\n\n> \n> - `sig_on/sig_off` -- these markers are used so that the code can be interrupted\n> while some C code is being run. Why would you put them around functions which\n> end instantaneously, like `add_edge/add_vertex`?\n\n\nUps, I thought they were used to handle segmentation faults... My mistake!\n\n> \n> - The variable 'i' is also an integer, and you should define it as 'cdef int' so\n> that your Cython code will be better optimised.\n\n\nI didn't define it as a cdef because that was not the bottleneck of the algorithm, and I chose readability instead of efficiency. However, now I used cdef.\n\n> \n> - Why would you define `edge_connectivity_boost_*` functions in\n> `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can\n> import them if needed.\n\n\nBecause, in my opinion, it could be better to keep the Boost implementation separated from the Boost algorithms (since soon there will be many of them), and to put the algorithms in the files where they will be used. Anyway, I moved it back!\n\n> \n> - Why did you move the LP out of the current `edge_connectivity` function? Can't\n> you leave if where it is, and at the beginning of the file call the boost\n> functions if this is what the user wants?\n\n\nBecause I do not really like functions that are \"too long\", and I thought that some code used with Boost could be re-used by the LP algorithm, simplifying the function. Anyway, I have returned to the old version.\n\n> \n> - When you submit a branch, always look at the final 'diff'. You can see it by\n> clicking on the (green) branch's name on its ticket, and it will tell you what\n> the reviewer sees and how he will have to figure out what your code\n> does. Everything that is not crystal clear for you is not crystal clear for\n> him.\n\n\nNow the diff should be cleaner. Is there any way to see the diff before pushing my changes (e.g. git diffall or something like that)?\n\n> Finally: please report the bug you found to boost. They must fix it.\n\n\nI will add the bug to the Boost trac as soon as the Boost trac server (svn.boost.org/) starts to work again. If it doesn't, in a few days I will try to find other ways to contact Boost developers.",
    "created_at": "2015-06-12T10:50:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264705",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:30'></a>Hello,

I have tried to correct your problems. More details below.

Best,

Michele

> - There is a weird 'pass' in boost_graph.pxd


Removed!

> 
> - `#clang c++` is not useful in Sage's source


Then I am afraid I have not understood your comment 20... Where should I have put it? In any case, I removed it.

> 
> - You should add your new file to the doc index
> (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)


Sorry, you have already told me to do so, but since I had to take many things into account, I forgot. Now I have done it!

> 
> Also, the header of your new module should describe what it implements


I have added the list of methods implemented, as in `generic_graph`. Is this what you meant?

> 
> - This will make you notice (Sphinx will scream) that whatever follows a '::'
> should be indented.


Done!

> 
> - A module's documentation is no place for 'todo'. If you want to work on
> something, create a trac ticket.


Ok!

> 
> - Why a static 'from_sage_graph' function instead of a constructor accepting a
> graph as an input?


Sigh, you are right... Done!

> 
> - `sig_on/sig_off` -- these markers are used so that the code can be interrupted
> while some C code is being run. Why would you put them around functions which
> end instantaneously, like `add_edge/add_vertex`?


Ups, I thought they were used to handle segmentation faults... My mistake!

> 
> - The variable 'i' is also an integer, and you should define it as 'cdef int' so
> that your Cython code will be better optimised.


I didn't define it as a cdef because that was not the bottleneck of the algorithm, and I chose readability instead of efficiency. However, now I used cdef.

> 
> - Why would you define `edge_connectivity_boost_*` functions in
> `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can
> import them if needed.


Because, in my opinion, it could be better to keep the Boost implementation separated from the Boost algorithms (since soon there will be many of them), and to put the algorithms in the files where they will be used. Anyway, I moved it back!

> 
> - Why did you move the LP out of the current `edge_connectivity` function? Can't
> you leave if where it is, and at the beginning of the file call the boost
> functions if this is what the user wants?


Because I do not really like functions that are "too long", and I thought that some code used with Boost could be re-used by the LP algorithm, simplifying the function. Anyway, I have returned to the old version.

> 
> - When you submit a branch, always look at the final 'diff'. You can see it by
> clicking on the (green) branch's name on its ticket, and it will tell you what
> the reviewer sees and how he will have to figure out what your code
> does. Everything that is not crystal clear for you is not crystal clear for
> him.


Now the diff should be cleaner. Is there any way to see the diff before pushing my changes (e.g. git diffall or something like that)?

> Finally: please report the bug you found to boost. They must fix it.


I will add the bug to the Boost trac as soon as the Boost trac server (svn.boost.org/) starts to work again. If it doesn't, in a few days I will try to find other ways to contact Boost developers.



---

archive/issue_comments_264706.json:
```json
{
    "body": "<a id='comment:31'></a>Helloooooooo Michele,\n\nThanks for this update, the code looks much better. Further remarks:\n\n- About `clang: c++`: this was useful for you to run `sage -cython -a\n  boost_graph.pyx` since this command does not read `module_list.py` (in which\n  you specified that it was a c++ file). However, there is no need to add this\n  line for everything to work 'in sage'. That's only useful to create the html\n  file, though you found a better way to do it with the `--cplus` file.\n\n- About `sig_on/off`:\n  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling\n\n- About `cdef int i`: well, you are right this is not a bottleneck at all. I\n  just said that as a reflex, sorry ^^;\n\n- About:\n  {{{\n  Because, in my opinion, it could be better to keep the Boost implementation\n  separated from the Boost algorithms (since soon there will be many of them),\n  and to put the algorithms in the files where they will be used.\n  }}}\n  Hmmmm... Well, as a result we would end up with data-structure specific code\n  in `generic_graph_pyx.pyx`, and that is not very pretty either. It is better\n  to have such low-level functions close together in a data-structure specific\n  file. If you think that the boost file will grow too large after a while,\n  however, we can split it in two files: one for the data structure, one for the\n  exposed algorithms. Several files from base/ already contain some algorithm.\n\n- About:\n  {{{\n  Because I do not really like functions that are \"too long\", and I thought\n  that some code used with Boost could be re-used by the LP algorithm,\n  simplifying the function.\n  }}}\n\n  First, note that moving code around has a very very bad effect on the final\n  'diff'. The reviewer sees a big removal and a big addition, and his job is to\n  check that no new bug was introduced, so that's quite some work only to move\n  code around. When you only want to *move* code around, it is much easier for\n  the reviewer if you do it in two steps:\n  - Move the code *without any other modification* (easy to check with a couple\n    of bash commands)\n  - Make the small changed needed in the code to 'adapt' it to its new location.\n  This way the review is easier.\n\n- You added 'boost_graph' first in its block in the graph documentation. That\n  list is not sorted alphabetically, for the first item is 'overview of graph\n  classes'. Could you move it below it? It is the most 'general' document.\n\n- Style issue, do whatever you want: instead of `if not (G is None)` followed by\n  a big indented block, you can write `if G is None: return`\n\n  By the way, `G is not None` does what you want:\n  {{{\n  sage: not False\n  True\n  sage: None is True\n  False\n  sage: None is not False\n  True\n  }}}\n\n- Your functions are \"def\" functions, i.e. Python functions. If you turn them\n  into 'cpdef' functions they will be both Python+C functions, and C code will\n  call the C function directly\n\n- Could you write somewhere in the doc of your boost classes that edge labels\n  are not supported (in particular when you build a Boost graph from a Sage\n  graph)\n\n- If multiple edges and loops are supported, can you add a doctest that checks\n  it?\n\n- `m = max(u, v)`: looks useless\n\n- `self.vertices.at(u)`: this sems to check that `u` is actually within the\n  bounds of the vector. Why not `self.vertices[u]` since the function is\n  `unsafe`?\n\n- `def edge_connectivity`: we try to keep the first line of a docstring to be a\n  short sentence describing what the function does. The next paragraph can be as\n  think as you want.\n\n- `for i from 0 <= i < ec`: that's old-style. Nowadays, it is equivalent to `for\n  i in range(ec)` (Cython translates it 'properly').\n\n- Awkward question: I have to admit that I am no big fan of the huge\n  copy/paste... Since Cython extension classes do not support templating but\n  functions do, what about not having a `BoostGraph` struct instead of a class?\n  We could have two of these struct and many functions that apply to it, each of\n  which handles fused types. Thus, only one function instead of two, no more\n  copy/paste?... Please tell me how you feel about that.\n\n- About:\n  {{{\n  Now the diff should be cleaner. Is there any way to see the diff before\n  pushing my changes (e.g. git diffall or something like that)?\n  }}}\n  You can see all the changes made by your current branch compared with the\n  latest release with 'git diff HEAD ^develop'. Beware: does not take uncommited\n  changed into account.\n\n- Another \"git cleanness\" issue: having commits undo what a previous commit did\n  is not entirely 'free'. For example, if you run 'git blame' on\n  `generic_graph.py` you will notice that your name on all lines of\n  `edge_connectivity` since you are the last one who touched them (you moved\n  them twice). While this is not a very very very bad problem, we somehow lose\n  information with things like that.\n\n  I also believe (and nobody but me is forced to follow those rules) that the\n  git history of a branch should be made to be read rather than be the\n  try-and-fail history of attempts to write a code.\n\n  A way to solve both problems is to *merge* commits together (a specific case\n  of history rewriting). You can do this with 'git rebase -i develop' [1] (look\n  for the 'squash' keyword).\n\n  If you do that, you will have to add -f (force) to your 'push' command since\n  you will not be adding commit but overwriting existing ones.\n\n- `from sage.graphs.digraph import DiGraph`: looks useless\n\n- `if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't\n  you be using a `breadth_first_search` instead of a `SCC`?\n\n- There is a `delete_edges` function.\n\nNathann\n\n[1] https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase-i/",
    "created_at": "2015-06-12T11:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264706",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:31'></a>Helloooooooo Michele,

Thanks for this update, the code looks much better. Further remarks:

- About `clang: c++`: this was useful for you to run `sage -cython -a
  boost_graph.pyx` since this command does not read `module_list.py` (in which
  you specified that it was a c++ file). However, there is no need to add this
  line for everything to work 'in sage'. That's only useful to create the html
  file, though you found a better way to do it with the `--cplus` file.

- About `sig_on/off`:
  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling

- About `cdef int i`: well, you are right this is not a bottleneck at all. I
  just said that as a reflex, sorry ^^;

- About:
  {{{
  Because, in my opinion, it could be better to keep the Boost implementation
  separated from the Boost algorithms (since soon there will be many of them),
  and to put the algorithms in the files where they will be used.
  }}}
  Hmmmm... Well, as a result we would end up with data-structure specific code
  in `generic_graph_pyx.pyx`, and that is not very pretty either. It is better
  to have such low-level functions close together in a data-structure specific
  file. If you think that the boost file will grow too large after a while,
  however, we can split it in two files: one for the data structure, one for the
  exposed algorithms. Several files from base/ already contain some algorithm.

- About:
  {{{
  Because I do not really like functions that are "too long", and I thought
  that some code used with Boost could be re-used by the LP algorithm,
  simplifying the function.
  }}}

  First, note that moving code around has a very very bad effect on the final
  'diff'. The reviewer sees a big removal and a big addition, and his job is to
  check that no new bug was introduced, so that's quite some work only to move
  code around. When you only want to *move* code around, it is much easier for
  the reviewer if you do it in two steps:
  - Move the code *without any other modification* (easy to check with a couple
    of bash commands)
  - Make the small changed needed in the code to 'adapt' it to its new location.
  This way the review is easier.

- You added 'boost_graph' first in its block in the graph documentation. That
  list is not sorted alphabetically, for the first item is 'overview of graph
  classes'. Could you move it below it? It is the most 'general' document.

- Style issue, do whatever you want: instead of `if not (G is None)` followed by
  a big indented block, you can write `if G is None: return`

  By the way, `G is not None` does what you want:
  {{{
  sage: not False
  True
  sage: None is True
  False
  sage: None is not False
  True
  }}}

- Your functions are "def" functions, i.e. Python functions. If you turn them
  into 'cpdef' functions they will be both Python+C functions, and C code will
  call the C function directly

- Could you write somewhere in the doc of your boost classes that edge labels
  are not supported (in particular when you build a Boost graph from a Sage
  graph)

- If multiple edges and loops are supported, can you add a doctest that checks
  it?

- `m = max(u, v)`: looks useless

- `self.vertices.at(u)`: this sems to check that `u` is actually within the
  bounds of the vector. Why not `self.vertices[u]` since the function is
  `unsafe`?

- `def edge_connectivity`: we try to keep the first line of a docstring to be a
  short sentence describing what the function does. The next paragraph can be as
  think as you want.

- `for i from 0 <= i < ec`: that's old-style. Nowadays, it is equivalent to `for
  i in range(ec)` (Cython translates it 'properly').

- Awkward question: I have to admit that I am no big fan of the huge
  copy/paste... Since Cython extension classes do not support templating but
  functions do, what about not having a `BoostGraph` struct instead of a class?
  We could have two of these struct and many functions that apply to it, each of
  which handles fused types. Thus, only one function instead of two, no more
  copy/paste?... Please tell me how you feel about that.

- About:
  {{{
  Now the diff should be cleaner. Is there any way to see the diff before
  pushing my changes (e.g. git diffall or something like that)?
  }}}
  You can see all the changes made by your current branch compared with the
  latest release with 'git diff HEAD ^develop'. Beware: does not take uncommited
  changed into account.

- Another "git cleanness" issue: having commits undo what a previous commit did
  is not entirely 'free'. For example, if you run 'git blame' on
  `generic_graph.py` you will notice that your name on all lines of
  `edge_connectivity` since you are the last one who touched them (you moved
  them twice). While this is not a very very very bad problem, we somehow lose
  information with things like that.

  I also believe (and nobody but me is forced to follow those rules) that the
  git history of a branch should be made to be read rather than be the
  try-and-fail history of attempts to write a code.

  A way to solve both problems is to *merge* commits together (a specific case
  of history rewriting). You can do this with 'git rebase -i develop' [1] (look
  for the 'squash' keyword).

  If you do that, you will have to add -f (force) to your 'push' command since
  you will not be adding commit but overwriting existing ones.

- `from sage.graphs.digraph import DiGraph`: looks useless

- `if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't
  you be using a `breadth_first_search` instead of a `SCC`?

- There is a `delete_edges` function.

Nathann

[1] https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase-i/



---

archive/issue_comments_264707.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-12T11:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264707",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_264708.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-12T13:47:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264708",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264709.json:
```json
{
    "body": "<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-12T13:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264709",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264710.json:
```json
{
    "body": "<a id='comment:34'></a>Hi (just to change ;-) )!\n\nI have applied all your remarks, except the following:\n\n> Awkward question: I have to admit that I am no big fan of the huge\n> copy/paste... Since Cython extension classes do not support templating but\n> functions do, what about not having a `BoostGraph` struct instead of a class?\n> We could have two of these struct and many functions that apply to it, each of\n> which handles fused types. Thus, only one function instead of two, no more\n> copy/paste?... Please tell me how you feel about that.\n\n\nNice! I will try it and I will let you know the results (it might take a while).\n\n> A  way to solve both problems is to *merge* commits together (a specific  case of history rewriting). You can do this with 'git rebase -i develop'\n\n\nI have two problems with rebase:\n\n* the  work can be very long, because I didn't know it, and in several commits  I also did small modifications that will be difficult to replicate.\n\n* At the moment, git rebase does not work:\n\n```\ngit rebase -i develop \nerror: could not apply de3440a... initial implementation of unicode art \n\nWhen you have resolved this problem, run \"git rebase --continue\". \nIf you prefer to skip this patch, run \"git rebase --skip\" instead. \nTo check out the original branch and stop rebasing, run \"git rebase --abort\". \nCould not apply de3440ab223b0031d10e447d124c5f68cbb388cd... initial implementation of unicode art\n```\n> !`if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't you be using a !`breadth_first_search` instead of a !`SCC`?\n\n\nCould you check that now the SCC/BFS code is correct?\n\nThank you very much!\n\nMichele",
    "created_at": "2015-06-12T13:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264710",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:34'></a>Hi (just to change ;-) )!

I have applied all your remarks, except the following:

> Awkward question: I have to admit that I am no big fan of the huge
> copy/paste... Since Cython extension classes do not support templating but
> functions do, what about not having a `BoostGraph` struct instead of a class?
> We could have two of these struct and many functions that apply to it, each of
> which handles fused types. Thus, only one function instead of two, no more
> copy/paste?... Please tell me how you feel about that.


Nice! I will try it and I will let you know the results (it might take a while).

> A  way to solve both problems is to *merge* commits together (a specific  case of history rewriting). You can do this with 'git rebase -i develop'


I have two problems with rebase:

* the  work can be very long, because I didn't know it, and in several commits  I also did small modifications that will be difficult to replicate.

* At the moment, git rebase does not work:

```
git rebase -i develop 
error: could not apply de3440a... initial implementation of unicode art 

When you have resolved this problem, run "git rebase --continue". 
If you prefer to skip this patch, run "git rebase --skip" instead. 
To check out the original branch and stop rebasing, run "git rebase --abort". 
Could not apply de3440ab223b0031d10e447d124c5f68cbb388cd... initial implementation of unicode art
```
> !`if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't you be using a !`breadth_first_search` instead of a !`SCC`?


Could you check that now the SCC/BFS code is correct?

Thank you very much!

Michele



---

archive/issue_comments_264711.json:
```json
{
    "body": "<a id='comment:35'></a>Helloooooo,\n\n> I have two problems with rebase:\n\n\nI will give it a try once I answer this message. I do not understand the error that you meet. Perhaps a not-up-to-date 'develop'? Either way, if it takes more than 30 seconds it means that something it not right.\n\n> Could you check that now the SCC/BFS code is correct?\n\n\nI do not think that it is. It fails on a very simple graph\n\n```\nsage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)\nThe directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.\n[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]\n```\n\nYou are simply doing things in the wrong direction. You should use the *sources* of the edges as the sources of your BFS.\n\nAnd you can also simplify your code a lot. Something like this should do:\n\n```\na = set(H.breadth_first_search([x for x,y in edges])))\nb = set(H).difference(a)\n```\n\nI did not try it, but I am optimistic.\n\nTwo other things:\n- There are many 'trailing whitespaces' [1] in your code. You can add `'(show-trailing-whitespace t)` in your `~/.emacs` file (if you use emacs `:-P`) to see them.\n- You should add a doctest for the digraph+boost case. You would see that your code breaks.\n- `Set` is a combinat object that you should not use unless you need their usual over-abstraction. 'set' is a faster python set object, which does what you need in this situation.\n\nNathann\n\n[1] http://programmers.stackexchange.com/questions/121555/why-is-trailing-whitespace-a-big-deal",
    "created_at": "2015-06-12T14:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264711",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:35'></a>Helloooooo,

> I have two problems with rebase:


I will give it a try once I answer this message. I do not understand the error that you meet. Perhaps a not-up-to-date 'develop'? Either way, if it takes more than 30 seconds it means that something it not right.

> Could you check that now the SCC/BFS code is correct?


I do not think that it is. It fails on a very simple graph

```
sage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)
The directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.
[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]
```

You are simply doing things in the wrong direction. You should use the *sources* of the edges as the sources of your BFS.

And you can also simplify your code a lot. Something like this should do:

```
a = set(H.breadth_first_search([x for x,y in edges])))
b = set(H).difference(a)
```

I did not try it, but I am optimistic.

Two other things:
- There are many 'trailing whitespaces' [1] in your code. You can add `'(show-trailing-whitespace t)` in your `~/.emacs` file (if you use emacs `:-P`) to see them.
- You should add a doctest for the digraph+boost case. You would see that your code breaks.
- `Set` is a combinat object that you should not use unless you need their usual over-abstraction. 'set' is a faster python set object, which does what you need in this situation.

Nathann

[1] http://programmers.stackexchange.com/questions/121555/why-is-trailing-whitespace-a-big-deal



---

archive/issue_comments_264712.json:
```json
{
    "body": "<a id='comment:36'></a>A merged commit (all into one) at public/18564_merged",
    "created_at": "2015-06-12T14:15:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264712",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:36'></a>A merged commit (all into one) at public/18564_merged



---

archive/issue_comments_264713.json:
```json
{
    "body": "<a id='comment:37'></a>Hello,\n\n```\n{{{\n\nsage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)\n\nThe directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.\n\n[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]\n\n}}}\n```\nI think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?",
    "created_at": "2015-06-14T14:12:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264713",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:37'></a>Hello,

```
{{{

sage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)

The directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.

[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]

}}}
```
I think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?



---

archive/issue_comments_264714.json:
```json
{
    "body": "<a id='comment:38'></a>> I think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?\n\n\nAny partition of the vertex set into two disjoint sets `A,B` such that there is only one edge going from A to B is fine.\n\nNathann",
    "created_at": "2015-06-14T14:30:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264714",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:38'></a>> I think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?


Any partition of the vertex set into two disjoint sets `A,B` such that there is only one edge going from A to B is fine.

Nathann



---

archive/issue_comments_264715.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-15T10:23:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264715",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264716.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-15T10:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264716",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264717.json:
```json
{
    "body": "<a id='comment:40'></a>Helloooooo!\n\nI have corrected all the issues raised in previous messages. In particular:\n\n* I have sent an email to the Boost mailing list with the edge connectivity bug (at the moment it is waiting for moderation, I will link it asap);\n\n* I have removed trailing whitespaces;\n\n* I have added a doctest for directed Boost connectivity;\n\n* I have used Nathann's code from public/18564_merged.\n\nOnly issue that remains open: avoiding the huge copy-paste. Unfortunately, also structs and templates do not support fused types ![1]. As far as I understood, if we do not want to write C++ code, the only solution is to write a function for each task and for each graph type, then to create a \"generic\" function that inputs a fused type containing all Boost graphs (for instance, a function `num_vertices(BoostVecDiGraph)`, a function `num_vertices(BoostVecGraph)`, and a function `num_vertices(BoostFusedGraph)` wrapping the other two). With the number of vertices, this is not a big issue, but with `add_edge` it might be, because we also need variable `vertices`  (which translates Sagemath vertices into Boost vertices), and we cannot use a struct (it is not supported). This might result in a huge mess, which increases even more if we have to use constructs for the specific algorithm we are \"stealing\" from Boost. Is it really worth it, if in some time Cython might start supporting fused types in templates?\n\n![1] !https://groups.google.com/forum/#!topic/cython-users/qQpMo3hGQqI",
    "created_at": "2015-06-15T10:44:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264717",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:40'></a>Helloooooo!

I have corrected all the issues raised in previous messages. In particular:

* I have sent an email to the Boost mailing list with the edge connectivity bug (at the moment it is waiting for moderation, I will link it asap);

* I have removed trailing whitespaces;

* I have added a doctest for directed Boost connectivity;

* I have used Nathann's code from public/18564_merged.

Only issue that remains open: avoiding the huge copy-paste. Unfortunately, also structs and templates do not support fused types ![1]. As far as I understood, if we do not want to write C++ code, the only solution is to write a function for each task and for each graph type, then to create a "generic" function that inputs a fused type containing all Boost graphs (for instance, a function `num_vertices(BoostVecDiGraph)`, a function `num_vertices(BoostVecGraph)`, and a function `num_vertices(BoostFusedGraph)` wrapping the other two). With the number of vertices, this is not a big issue, but with `add_edge` it might be, because we also need variable `vertices`  (which translates Sagemath vertices into Boost vertices), and we cannot use a struct (it is not supported). This might result in a huge mess, which increases even more if we have to use constructs for the specific algorithm we are "stealing" from Boost. Is it really worth it, if in some time Cython might start supporting fused types in templates?

![1] !https://groups.google.com/forum/#!topic/cython-users/qQpMo3hGQqI



---

archive/issue_comments_264718.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-18T10:18:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264718",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264719.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-\n+This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.\n \n Comment: 1\n \n```\n",
    "created_at": "2015-06-18T10:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264719",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,4 @@
-
+This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.
 
 Comment: 1
 
```




---

archive/issue_comments_264720.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-18T10:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264720",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_264721.json:
```json
{
    "body": "<a id='comment:42'></a>Hellooooooo!\n\nI summarize a discussion we had via email, dealing with the huge copy-paste. We found a way to avoid it: we created a C++ class boost_interface that interfaces Cython with Boost, and we used fused types to make generic functions accessing the C++ class.\n\nThe drawback is that we cannot access Boost graphs from Python anymore: Boost graphs must be defined and deleted in the same cdef function.\n\nThe advantage is that we can fully use the genericity of Boost, by calling any graph implementation we want.\n\nThe new code is available in this ticket's branch, while the old code is still available at `u/borassi/boost_edge_connectivity_not_generic`.\n\nI changed the status to needs_work, because I would like to test the code and the doctest a bit more before asking for a review (in particular, I would like to check if all previous comments are still applied).",
    "created_at": "2015-06-18T10:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264721",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:42'></a>Hellooooooo!

I summarize a discussion we had via email, dealing with the huge copy-paste. We found a way to avoid it: we created a C++ class boost_interface that interfaces Cython with Boost, and we used fused types to make generic functions accessing the C++ class.

The drawback is that we cannot access Boost graphs from Python anymore: Boost graphs must be defined and deleted in the same cdef function.

The advantage is that we can fully use the genericity of Boost, by calling any graph implementation we want.

The new code is available in this ticket's branch, while the old code is still available at `u/borassi/boost_edge_connectivity_not_generic`.

I changed the status to needs_work, because I would like to test the code and the doctest a bit more before asking for a review (in particular, I would like to check if all previous comments are still applied).



---

archive/issue_comments_264722.json:
```json
{
    "body": "<a id='comment:43'></a>I like this new implementation. I assume it will be relativity easy to call other boost method the same way.",
    "created_at": "2015-06-18T10:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264722",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:43'></a>I like this new implementation. I assume it will be relativity easy to call other boost method the same way.



---

archive/issue_comments_264723.json:
```json
{
    "body": "<a id='comment:44'></a>This comment needs to be expanded:\n\n```\nclass BoostGraph\n/*\n * This generic class wraps a Boost graph, in order to make it Cython-friendly.\n```\n\nFrom reading the code, I have no idea what is Cython-unfriendly.",
    "created_at": "2015-06-18T10:38:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264723",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>This comment needs to be expanded:

```
class BoostGraph
/*
 * This generic class wraps a Boost graph, in order to make it Cython-friendly.
```

From reading the code, I have no idea what is Cython-unfriendly.



---

archive/issue_comments_264724.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-18T16:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264724",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264725.json:
```json
{
    "body": "<a id='comment:46'></a>Hello!\n\nI have opened a Boost ticket on edge connectivity (https://svn.boost.org/trac/boost/ticket/11406), I have added this link in the documentation of our edge connectivity, I have expanded the comment as asked by jdemeyer, and I have corrected some small issues.\n\nI hope that now the code is correct!",
    "created_at": "2015-06-18T16:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264725",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:46'></a>Hello!

I have opened a Boost ticket on edge connectivity (https://svn.boost.org/trac/boost/ticket/11406), I have added this link in the documentation of our edge connectivity, I have expanded the comment as asked by jdemeyer, and I have corrected some small issues.

I hope that now the code is correct!



---

archive/issue_comments_264726.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-18T16:50:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264726",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264727.json:
```json
{
    "body": "<a id='comment:47'></a>Hello,\n\nInstall OK, tests OK, docbuild OK, page `boost_graph.html` looks good (it will certainly be enriched in the future), and it is fast.\n\n```\nsage: G = graphs.Grid2dGraph(20,20)\nsage: %timeit G.edge_connectivity(boost=0)\n1 loops, best of 3: 724 ms per loop\nsage: %timeit G.edge_connectivity(boost=1)\n100 loops, best of 3: 5.86 ms per loop\n\nsage: G = graphs.RandomBarabasiAlbert(1000,2)\nsage: %timeit G.edge_connectivity(boost=0)\n1 loops, best of 3: 1.14 s per loop\nsage: %timeit G.edge_connectivity(boost=1)\n10 loops, best of 3: 41.4 ms per loop\n```\n\nFor me the patch is good to go. However, it would be better if an expert in C++/boost/etc. could check the patch before setting it to positive review.\n\nNice work anyway!\n\nDavid.",
    "created_at": "2015-06-19T17:28:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264727",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:47'></a>Hello,

Install OK, tests OK, docbuild OK, page `boost_graph.html` looks good (it will certainly be enriched in the future), and it is fast.

```
sage: G = graphs.Grid2dGraph(20,20)
sage: %timeit G.edge_connectivity(boost=0)
1 loops, best of 3: 724 ms per loop
sage: %timeit G.edge_connectivity(boost=1)
100 loops, best of 3: 5.86 ms per loop

sage: G = graphs.RandomBarabasiAlbert(1000,2)
sage: %timeit G.edge_connectivity(boost=0)
1 loops, best of 3: 1.14 s per loop
sage: %timeit G.edge_connectivity(boost=1)
10 loops, best of 3: 41.4 ms per loop
```

For me the patch is good to go. However, it would be better if an expert in C++/boost/etc. could check the patch before setting it to positive review.

Nice work anyway!

David.



---

archive/issue_comments_264728.json:
```json
{
    "body": "<a id='comment:48'></a>Helloooooo Michele,\n\nI made several modifications, available as a new commit at `public/18564`. All\nof them are, of course, open to discussion.\n\n- You don't need two 'pass' in the .pxd file\n\n- About the paragraphs at the top of `boost_graph.pyx`: I find them a bit\n  unclear. Could you be more specific in those sentences? For example (but not\n  only), I do not get the meaning of\n  {{{\n  and they cannot be shared by different Python functions, because they cannot\n  be converted to Python objects.\n  }}}\n\n- I opened a ticket at #18753 (you are its author) to indicate that the boost\n  bug had been reported upstream. That's part of a 'procedure' called 'stopgap',\n  precisely meant for those situations (see\n  http://doc.sagemath.org/html/en/developer/trac.html#stopgaps)\n\n  I also turned your 'print warning' into a stopgap message.\n\n- I reversed the names of `edge_connectivity` and `boost_edge_connectivity`: now\n  the `boost_edge_connectivity` function is the one which takes a boost graph as\n  argument.\n\n- The link toward `edge_connectivity` that you had added at the top of the\n  document was broken, for `edge_connectivity` was a cdef function in your\n  patch, and you cannot link (in Sphinx) toward cdef functions. When yo uwork on\n  the doc, you can compile it with `--warn-links` to spot broken links.\n\n- I shortened a bit the doc of some boost functions: some of the things you say\n  in the doc would be more appropriate as comments in the code.\n\n- in simple cases, it is easier to use `sig_check` than `sig_on/off`. A\n  `sig_check` is a way to check at a specific time whether an exception should\n  be raised. See\n  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling\n\n- I renamed 'boost=True' to 'implementation=\"boost\"', which is a bit more\n  'standard'. You may not know what 'boost' is, but you understand the meaning\n  of a 'implementation' selector.\n\nAgain, don't hesitate to oppose and discuss any of the changes in this commit,\nas you are the reviewer of them. You are supposed to be as picky as we are when\nwe review your code.\n\nIn my mind, the branch with this commit added is good to go, though perhaps the\ncomments to the top of `boost_graph.pyx` could be made clearer. That's up to\nyou.\n\nHave fun, and thank you very much again for this addition. Now that this is\nwritten, it will be *much* easier to steal more boost code `;-)`\n\nNathann",
    "created_at": "2015-06-21T09:41:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264728",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:48'></a>Helloooooo Michele,

I made several modifications, available as a new commit at `public/18564`. All
of them are, of course, open to discussion.

- You don't need two 'pass' in the .pxd file

- About the paragraphs at the top of `boost_graph.pyx`: I find them a bit
  unclear. Could you be more specific in those sentences? For example (but not
  only), I do not get the meaning of
  {{{
  and they cannot be shared by different Python functions, because they cannot
  be converted to Python objects.
  }}}

- I opened a ticket at #18753 (you are its author) to indicate that the boost
  bug had been reported upstream. That's part of a 'procedure' called 'stopgap',
  precisely meant for those situations (see
  http://doc.sagemath.org/html/en/developer/trac.html#stopgaps)

  I also turned your 'print warning' into a stopgap message.

- I reversed the names of `edge_connectivity` and `boost_edge_connectivity`: now
  the `boost_edge_connectivity` function is the one which takes a boost graph as
  argument.

- The link toward `edge_connectivity` that you had added at the top of the
  document was broken, for `edge_connectivity` was a cdef function in your
  patch, and you cannot link (in Sphinx) toward cdef functions. When yo uwork on
  the doc, you can compile it with `--warn-links` to spot broken links.

- I shortened a bit the doc of some boost functions: some of the things you say
  in the doc would be more appropriate as comments in the code.

- in simple cases, it is easier to use `sig_check` than `sig_on/off`. A
  `sig_check` is a way to check at a specific time whether an exception should
  be raised. See
  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling

- I renamed 'boost=True' to 'implementation="boost"', which is a bit more
  'standard'. You may not know what 'boost' is, but you understand the meaning
  of a 'implementation' selector.

Again, don't hesitate to oppose and discuss any of the changes in this commit,
as you are the reviewer of them. You are supposed to be as picky as we are when
we review your code.

In my mind, the branch with this commit added is good to go, though perhaps the
comments to the top of `boost_graph.pyx` could be made clearer. That's up to
you.

Have fun, and thank you very much again for this addition. Now that this is
written, it will be *much* easier to steal more boost code `;-)`

Nathann



---

archive/issue_comments_264729.json:
```json
{
    "body": "<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-23T07:35:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264729",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:49'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264730.json:
```json
{
    "body": "<a id='comment:50'></a>Hello!\nI have checked your code and included it into the current version. I have made a few modifications:\n\n* I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.\n* Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to \"`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`\" Thank you, Martin!\n* I have added some spaces at the bottom of boost_graph.pxd, so that different graph implementations are aligned.\n* Currently, our Boost code does not support edge labels. With the previous code, if we have used `\"implementation='boost',use_edge_labels=True\"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.\n* If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.\n\nAlso for me, now the patch is good to go!",
    "created_at": "2015-06-23T07:38:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264730",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:50'></a>Hello!
I have checked your code and included it into the current version. I have made a few modifications:

* I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.
* Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to "`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`" Thank you, Martin!
* I have added some spaces at the bottom of boost_graph.pxd, so that different graph implementations are aligned.
* Currently, our Boost code does not support edge labels. With the previous code, if we have used `"implementation='boost',use_edge_labels=True"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.
* If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.

Also for me, now the patch is good to go!



---

archive/issue_comments_264731.json:
```json
{
    "body": "<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-23T07:38:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264731",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264732.json:
```json
{
    "body": "<a id='comment:52'></a>Hello Michele,\n\n>  * I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.\n\n\nThanks! That's better.\n\n>  * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to \"`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`\" Thank you, Martin!\n\n\nOh. Does that mean that there is \"no bug\" in boost because they never claimed that it worked? If so, several things need to be done:\n1) Close the bug report on boost's trac, as it is invalid\n2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)\n3) Remove the stopgap warning from this branch's code\n4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs\n5) Raise an exception when 'boost' is requested to run on a directed graph.\n\n>  * Currently, our Boost code does not support edge labels. With the previous code, if we have used `\"implementation='boost',use_edge_labels=True\"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.\n\n\nGood. I missed that `:-/`\n\n>  * If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.\n\n\nOKayyyyyyyyyyy.\n\nNathann",
    "created_at": "2015-06-23T08:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264732",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:52'></a>Hello Michele,

>  * I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.


Thanks! That's better.

>  * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to "`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`" Thank you, Martin!


Oh. Does that mean that there is "no bug" in boost because they never claimed that it worked? If so, several things need to be done:
1) Close the bug report on boost's trac, as it is invalid
2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)
3) Remove the stopgap warning from this branch's code
4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs
5) Raise an exception when 'boost' is requested to run on a directed graph.

>  * Currently, our Boost code does not support edge labels. With the previous code, if we have used `"implementation='boost',use_edge_labels=True"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.


Good. I missed that `:-/`

>  * If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.


OKayyyyyyyyyyy.

Nathann



---

archive/issue_comments_264733.json:
```json
{
    "body": "<a id='comment:53'></a>> > * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to \"`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`\" Thank you, Martin!\n> > \n \n> \n> Oh. Does that mean that there is \"no bug\" in boost because they never claimed that it worked? If so, several things need to be done:\n> 1) Close the bug report on boost's trac, as it is invalid\n> 2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)\n> 3) Remove the stopgap warning from this branch's code\n> 4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs\n> 5) Raise an exception when 'boost' is requested to run on a directed graph.\n\n\nWell, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!\n\nWhat do you think?\n\nThank you very much,\n\nMichele",
    "created_at": "2015-06-23T12:44:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264733",
    "user": "https://trac.sagemath.org/admin/accounts/users/borassi"
}
```

<a id='comment:53'></a>> > * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to "`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`" Thank you, Martin!
> > 
 
> 
> Oh. Does that mean that there is "no bug" in boost because they never claimed that it worked? If so, several things need to be done:
> 1) Close the bug report on boost's trac, as it is invalid
> 2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)
> 3) Remove the stopgap warning from this branch's code
> 4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs
> 5) Raise an exception when 'boost' is requested to run on a directed graph.


Well, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!

What do you think?

Thank you very much,

Michele



---

archive/issue_comments_264734.json:
```json
{
    "body": "<a id='comment:54'></a>> Well, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!\n> \n> What do you think?\n\n\nThat I trust your advice on this matter.\n\nGood to go! (and thank you very much for this first 'boost' addition)\n\nNathann",
    "created_at": "2015-06-23T13:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264734",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:54'></a>> Well, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!
> 
> What do you think?


That I trust your advice on this matter.

Good to go! (and thank you very much for this first 'boost' addition)

Nathann



---

archive/issue_comments_264735.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-06-23T13:10:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264735",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_052162.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-24T11:37:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18564#event-52162"
}
```



---

archive/issue_comments_264736.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-06-24T11:37:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18564#issuecomment-264736",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
