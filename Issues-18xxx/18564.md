# Issue 18564: Boost Edge Connectivity

archive/issues_018327.json:
```json
{
    "assignees": [
        "https://github.com/sagetrac-borassi"
    ],
    "body": "This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.\n\nCC:  @nathanncohen @dcoudert @jdemeyer @jpflori @slel @SnarkBoojum @vbraun @williamstein\n\nKeywords: **Boost, connectivity**\n\nBranch: **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)**\n\nReviewer: **Nathann Cohen**\n\nAuthor: **Michele Borassi**\n\nComponent: **graph theory**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18564_\n\n",
    "closed_at": "2015-06-24T11:37:15Z",
    "created_at": "2015-06-01T09:36:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Boost Edge Connectivity",
    "type": "issue",
    "updated_at": "2023-01-13T20:36:28Z",
    "url": "https://github.com/sagemath/sage/issues/18564",
    "user": "https://github.com/sagetrac-borassi"
}
```
This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.

CC:  @nathanncohen @dcoudert @jdemeyer @jpflori @slel @SnarkBoojum @vbraun @williamstein

Keywords: **Boost, connectivity**

Branch: **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)**

Reviewer: **Nathann Cohen**

Author: **Michele Borassi**

Component: **graph theory**

_Issue created by migration from https://trac.sagemath.org/ticket/18564_





---

archive/issue_events_263911.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-01T09:36:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263911"
}
```



---

archive/issue_events_263912.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-01T09:36:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263912"
}
```



---

archive/issue_comments_257900.json:
```json
{
    "body": "Author: **Michele Borassi**",
    "created_at": "2015-06-01T09:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257900",
    "user": "https://github.com/sagetrac-borassi"
}
```

Author: **Michele Borassi**



---

archive/issue_events_263913.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-01T09:45:00Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "subject": "https://github.com/sagetrac-borassi",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263913"
}
```



---

archive/issue_comments_257901.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n+This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.\n \n+Since in my preliminary coding I had several problems with generic types, I will only restrict to vector-stored adjacency lists, leaving genericity to a future ticket.\n``````\n",
    "created_at": "2015-06-01T09:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257901",
    "user": "https://github.com/sagetrac-borassi"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
+This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.
 
+Since in my preliminary coding I had several problems with generic types, I will only restrict to vector-stored adjacency lists, leaving genericity to a future ticket.
``````




---

archive/issue_events_263914.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-01T09:45:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263914"
}
```



---

archive/issue_events_263915.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-01T09:45:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20graph%20theory",
    "label_color": "0000ff",
    "label_name": "c: graph theory",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263915"
}
```



---

archive/issue_comments_257902.json:
```json
{
    "body": "Changed keywords from none to **Boost, connectivity**",
    "created_at": "2015-06-01T09:45:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257902",
    "user": "https://github.com/sagetrac-borassi"
}
```

Changed keywords from none to **Boost, connectivity**



---

archive/issue_comments_257903.json:
```json
{
    "body": "Branch: **[u/borassi/boost_edge_connectivity](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_edge_connectivity)**",
    "created_at": "2015-06-03T07:51:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257903",
    "user": "https://github.com/sagetrac-borassi"
}
```

Branch: **[u/borassi/boost_edge_connectivity](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_edge_connectivity)**



---

archive/issue_comments_257904.json:
```json
{
    "body": "Commit: **[fe40c54](https://github.com/sagemath/sagetrac-mirror/commit/fe40c540c67848ae4cb694921501185b0cd4f045)**",
    "created_at": "2015-06-03T08:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257904",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[fe40c54](https://github.com/sagemath/sagetrac-mirror/commit/fe40c540c67848ae4cb694921501185b0cd4f045)**



---

archive/issue_comments_257905.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe40c540c67848ae4cb694921501185b0cd4f045\">fe40c54</a></td><td><code>Edge connectivity working</code></td></tr></table>\n",
    "created_at": "2015-06-03T08:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257905",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe40c540c67848ae4cb694921501185b0cd4f045">fe40c54</a></td><td><code>Edge connectivity working</code></td></tr></table>




---

archive/issue_comments_257906.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThis version lets us use Boost graph library to compute edge connectivity. Probably it is not the cleanest     way to do it, but at least it works. I am looking for suggestions on how to improve the code, in order to make it more readable:\n\n* is it better to use only Boost in C++ and Cython for the interface, or write the code in C++ and use Cython to convert the results? In the first case, we might have problems with generic types.\n* should we only keep translation capabilities, or should we also add a new backend? In other words, do we need Boost for linear-time or O(n log n) time algorithms?\n\nSome benchmark:\n\n```\nsage: G = graphs.RandomGNM(100,1000)\nsage: %timeit G.edge_connectivity()\n1 loops, best of 3: 10.7 s per loop\nsage: %timeit G.to_boost_graph().edge_connectivity()\n100 loops, best of 3: 2.04 ms per loop\n\n```\nThank you very much!",
    "created_at": "2015-06-03T08:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257906",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:4" align="right">comment:4</div>

This version lets us use Boost graph library to compute edge connectivity. Probably it is not the cleanest     way to do it, but at least it works. I am looking for suggestions on how to improve the code, in order to make it more readable:

* is it better to use only Boost in C++ and Cython for the interface, or write the code in C++ and use Cython to convert the results? In the first case, we might have problems with generic types.
* should we only keep translation capabilities, or should we also add a new backend? In other words, do we need Boost for linear-time or O(n log n) time algorithms?

Some benchmark:

```
sage: G = graphs.RandomGNM(100,1000)
sage: %timeit G.edge_connectivity()
1 loops, best of 3: 10.7 s per loop
sage: %timeit G.to_boost_graph().edge_connectivity()
100 loops, best of 3: 2.04 ms per loop

```
Thank you very much!



---

archive/issue_comments_257907.json:
```json
{
    "body": "Changed commit from **[fe40c54](https://github.com/sagemath/sagetrac-mirror/commit/fe40c540c67848ae4cb694921501185b0cd4f045)** to **[9a0e868](https://github.com/sagemath/sagetrac-mirror/commit/9a0e86828eadda31e99ee203a693bb65afec4762)**",
    "created_at": "2015-06-03T08:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257907",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[fe40c54](https://github.com/sagemath/sagetrac-mirror/commit/fe40c540c67848ae4cb694921501185b0cd4f045)** to **[9a0e868](https://github.com/sagemath/sagetrac-mirror/commit/9a0e86828eadda31e99ee203a693bb65afec4762)**



---

archive/issue_comments_257908.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9a0e86828eadda31e99ee203a693bb65afec4762\">9a0e868</a></td><td><code>Improved code for conversion</code></td></tr></table>\n",
    "created_at": "2015-06-03T08:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257908",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9a0e86828eadda31e99ee203a693bb65afec4762">9a0e868</a></td><td><code>Improved code for conversion</code></td></tr></table>




---

archive/issue_comments_257909.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nSomething is missing in `BoostGraph` \n\n```\nsage: H = G.to_boost_graph()\nsage: H\n<sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>\nsage: H.\nH.add_edge      H.add_vertex    H.num_edges     H.num_vertices  \nsage: H.num_edges\n<built-in method num_edges of sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>\nsage: H.num_edges()\n1000\nsage: %timeit G.to_boost_graph().edge_connectivity()\n---------------------------------------------------------------------------\nAttributeError                            Traceback (most recent call last)\n<ipython-input-7-86519c65f6dd> in <module>()\n----> 1 get_ipython().magic(u'timeit G.to_boost_graph().edge_connectivity()')\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)\n   2305         magic_name, _, magic_arg_s = arg_s.partition(' ')\n   2306         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)\n-> 2307         return self.run_line_magic(magic_name, magic_arg_s)\n   2308 \n   2309     #-------------------------------------------------------------------------\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)\n   2226                 kwargs['local_ns'] = sys._getframe(stack_depth).f_locals\n   2227             with self.builtin_trap:\n-> 2228                 result = fn(*args,**kwargs)\n   2229             return result\n   2230 \n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)\n    191     # but it's overkill for just that one bit of state.\n    192     def magic_deco(arg):\n--> 193         call = lambda f, *a, **k: f(*a, **k)\n    194 \n    195         if callable(arg):\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)\n   1034             number = 1\n   1035             for _ in range(1, 10):\n-> 1036                 time_number = timer.timeit(number)\n   1037                 worst_tuning = max(worst_tuning, time_number / number)\n   1038                 if time_number >= 0.2:\n\n/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, number)\n    130         gc.disable()\n    131         try:\n--> 132             timing = self.inner(it, self.timer)\n    133         finally:\n    134             if gcold:\n\n<magic-timeit> in inner(_it, _timer)\n\nAttributeError: 'sage.graphs.base.boost_graph.BoostGraph' object has no attribute 'edge_connectivity'\nsage: \n```",
    "created_at": "2015-06-03T08:54:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257909",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:6" align="right">comment:6</div>

Something is missing in `BoostGraph` 

```
sage: H = G.to_boost_graph()
sage: H
<sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>
sage: H.
H.add_edge      H.add_vertex    H.num_edges     H.num_vertices  
sage: H.num_edges
<built-in method num_edges of sage.graphs.base.boost_graph.BoostGraph object at 0x10f1a4ef0>
sage: H.num_edges()
1000
sage: %timeit G.to_boost_graph().edge_connectivity()
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
<ipython-input-7-86519c65f6dd> in <module>()
----> 1 get_ipython().magic(u'timeit G.to_boost_graph().edge_connectivity()')

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in magic(self, arg_s)
   2305         magic_name, _, magic_arg_s = arg_s.partition(' ')
   2306         magic_name = magic_name.lstrip(prefilter.ESC_MAGIC)
-> 2307         return self.run_line_magic(magic_name, magic_arg_s)
   2308 
   2309     #-------------------------------------------------------------------------

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc in run_line_magic(self, magic_name, line)
   2226                 kwargs['local_ns'] = sys._getframe(stack_depth).f_locals
   2227             with self.builtin_trap:
-> 2228                 result = fn(*args,**kwargs)
   2229             return result
   2230 

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magic.pyc in <lambda>(f, *a, **k)
    191     # but it's overkill for just that one bit of state.
    192     def magic_deco(arg):
--> 193         call = lambda f, *a, **k: f(*a, **k)
    194 
    195         if callable(arg):

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, line, cell)
   1034             number = 1
   1035             for _ in range(1, 10):
-> 1036                 time_number = timer.timeit(number)
   1037                 worst_tuning = max(worst_tuning, time_number / number)
   1038                 if time_number >= 0.2:

/Users/dcoudert/sage/local/lib/python2.7/site-packages/IPython/core/magics/execution.pyc in timeit(self, number)
    130         gc.disable()
    131         try:
--> 132             timing = self.inner(it, self.timer)
    133         finally:
    134             if gcold:

<magic-timeit> in inner(_it, _timer)

AttributeError: 'sage.graphs.base.boost_graph.BoostGraph' object has no attribute 'edge_connectivity'
sage: 
```



---

archive/issue_comments_257910.json:
```json
{
    "body": "Changed commit from **[9a0e868](https://github.com/sagemath/sagetrac-mirror/commit/9a0e86828eadda31e99ee203a693bb65afec4762)** to **[b0ca92c](https://github.com/sagemath/sagetrac-mirror/commit/b0ca92c0674f7fe4df454566208e3f69d5faf982)**",
    "created_at": "2015-06-03T10:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257910",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9a0e868](https://github.com/sagemath/sagetrac-mirror/commit/9a0e86828eadda31e99ee203a693bb65afec4762)** to **[b0ca92c](https://github.com/sagemath/sagetrac-mirror/commit/b0ca92c0674f7fe4df454566208e3f69d5faf982)**



---

archive/issue_comments_257911.json:
```json
{
    "body": "<div id=\"comment:7\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b0ca92c0674f7fe4df454566208e3f69d5faf982\">b0ca92c</a></td><td><code>Added sig_on, sig_off, and corrected edge_connectivity</code></td></tr></table>\n",
    "created_at": "2015-06-03T10:49:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257911",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:7"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b0ca92c0674f7fe4df454566208e3f69d5faf982">b0ca92c</a></td><td><code>Added sig_on, sig_off, and corrected edge_connectivity</code></td></tr></table>




---

archive/issue_comments_257912.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nNow it should work!",
    "created_at": "2015-06-03T10:51:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257912",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:8" align="right">comment:8</div>

Now it should work!



---

archive/issue_comments_257913.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nHellooooo Michele,\n\nGreat work, thank you very much! If we can speedup several Sage functions the\nway you did for edge connectivity, the future looks bright `:-P`\n\nI have been trying to avoid the creation of these two .cpp/.hpp files, but no\ngood new for the moment. I sent a question on cython-users [1], let's pray for\ntheir wisdom. If there is no better way to do it than write cpp code, then\nperhaps it will be better to 'patch' boost when it is installed, and only add\nthe couple of lines we need? We'll see this later, after they have had the time\nto answer.\n\nAbout your code:\n\n- You add 'copyright' headers with a name which isn't yours: that's neither fair\n  to Robert Miller nor to yourself! If you want your files to have a copyright\n  header, please make it contain your name. Oh, and please steal a more recent\n  header, for this one is a bit old. I think this one is the most recent\n\n  ```\n  #*****************************************************************************\n  #       Copyright (C) 2015 Michele Borassi <email_adress>\n  #\n  #  Distributed under the terms of the GNU General Public License (GPL)\n  #  as published by the Free Software Foundation; either version 2 of\n  #  the License, or (at your option) any later version.\n  #                  http://www.gnu.org/licenses/\n  #*****************************************************************************\n  ```\n\n- I do not think that having a `Graph.to_boost_graph` makes much sense: at\n  user-level, having a 'boost' graph does not have much interest as it only has\n  very few commands to add edges/vertices, and your `edge_connectivity`\n  function. It would make more sense to keep this function inside of\n  `boost_graph.pyx`, for internal use.\n\n- You should modify `GenericGraph.edge_connectivity` to make it able to call\n  your function. Beware: this function applies to both directed and undirected\n  graphs, while apparently your function only handles undirected graphs. The\n  ideal, of course, would be to be able to call boost in both situations.\n\n  Many graph function make several implementations available, and for instance\n  `GenericGraph.automorphism_group`.\n\n- Every function that you add must be documented. Besides, it would be cool to\n  add your new file to the doc index [2].\n\n- Every function must contain doctests.\n\n  ```\n  (tmp|\u271a3)~/sage/graphs/base$ sage -coverage boost_graph.pyx\n  ------------------------------------------------------------------------\n  SCORE boost_graph.pyx: 0.0% (0 of 6)\n  \n  Missing documentation:\n      * line 57: def __cinit__(self)\n      * line 62: def add_vertex(self)\n      * line 65: def add_edge(self, u, v)\n      * line 68: def num_vertices(self)\n      * line 71: def num_edges(self)\n      * line 74: def edge_connectivity(self)\n  ------------------------------------------------------------------------\n  ```\n\nThank you very much for this improvement. That's no small speedup, and an\nimportant function.\n\nNathann\n\nPS: Set the ticket's status to 'needs_review' when you want somebody to look at it.\n\n[1] https://groups.google.com/d/topic/cython-users/ICRgCWVZ6RQ/discussion\n[2] http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file",
    "created_at": "2015-06-04T12:34:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257913",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:9" align="right">comment:9</div>

Hellooooo Michele,

Great work, thank you very much! If we can speedup several Sage functions the
way you did for edge connectivity, the future looks bright `:-P`

I have been trying to avoid the creation of these two .cpp/.hpp files, but no
good new for the moment. I sent a question on cython-users [1], let's pray for
their wisdom. If there is no better way to do it than write cpp code, then
perhaps it will be better to 'patch' boost when it is installed, and only add
the couple of lines we need? We'll see this later, after they have had the time
to answer.

About your code:

- You add 'copyright' headers with a name which isn't yours: that's neither fair
  to Robert Miller nor to yourself! If you want your files to have a copyright
  header, please make it contain your name. Oh, and please steal a more recent
  header, for this one is a bit old. I think this one is the most recent

  ```
  #*****************************************************************************
  #       Copyright (C) 2015 Michele Borassi <email_adress>
  #
  #  Distributed under the terms of the GNU General Public License (GPL)
  #  as published by the Free Software Foundation; either version 2 of
  #  the License, or (at your option) any later version.
  #                  http://www.gnu.org/licenses/
  #*****************************************************************************
  ```

- I do not think that having a `Graph.to_boost_graph` makes much sense: at
  user-level, having a 'boost' graph does not have much interest as it only has
  very few commands to add edges/vertices, and your `edge_connectivity`
  function. It would make more sense to keep this function inside of
  `boost_graph.pyx`, for internal use.

- You should modify `GenericGraph.edge_connectivity` to make it able to call
  your function. Beware: this function applies to both directed and undirected
  graphs, while apparently your function only handles undirected graphs. The
  ideal, of course, would be to be able to call boost in both situations.

  Many graph function make several implementations available, and for instance
  `GenericGraph.automorphism_group`.

- Every function that you add must be documented. Besides, it would be cool to
  add your new file to the doc index [2].

- Every function must contain doctests.

  ```
  (tmp|✚3)~/sage/graphs/base$ sage -coverage boost_graph.pyx
  ------------------------------------------------------------------------
  SCORE boost_graph.pyx: 0.0% (0 of 6)
  
  Missing documentation:
      * line 57: def __cinit__(self)
      * line 62: def add_vertex(self)
      * line 65: def add_edge(self, u, v)
      * line 68: def num_vertices(self)
      * line 71: def num_edges(self)
      * line 74: def edge_connectivity(self)
  ------------------------------------------------------------------------
  ```

Thank you very much for this improvement. That's no small speedup, and an
important function.

Nathann

PS: Set the ticket's status to 'needs_review' when you want somebody to look at it.

[1] https://groups.google.com/d/topic/cython-users/ICRgCWVZ6RQ/discussion
[2] http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file



---

archive/issue_comments_257914.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nHello Michele,\n\nYou will find at public/18564 a commit that avoids the creation of .hpp and .cpp files.\n\nNathann",
    "created_at": "2015-06-07T10:37:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257914",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:10" align="right">comment:10</div>

Hello Michele,

You will find at public/18564 a commit that avoids the creation of .hpp and .cpp files.

Nathann



---

archive/issue_comments_257915.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHello Nathann,\n\nyour branch is working well and this is easier than the first solution proposed by Michele.\n\n```\nsage: G = graphs.RandomBarabasiAlbert(1000,2)\nsage: %timeit G.edge_connectivity()\n1 loops, best of 3: 1.02 s per loop\nsage: %timeit G.to_boost_graph().edge_connectivity()\n10 loops, best of 3: 46 ms per loop\n```\n\nI\u2019m really impressed by what you did (both of you).",
    "created_at": "2015-06-07T17:47:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257915",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:11" align="right">comment:11</div>

Hello Nathann,

your branch is working well and this is easier than the first solution proposed by Michele.

```
sage: G = graphs.RandomBarabasiAlbert(1000,2)
sage: %timeit G.edge_connectivity()
1 loops, best of 3: 1.02 s per loop
sage: %timeit G.to_boost_graph().edge_connectivity()
10 loops, best of 3: 46 ms per loop
```

I’m really impressed by what you did (both of you).



---

archive/issue_comments_257916.json:
```json
{
    "body": "<div id=\"comment:12\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/2b85ec1513584ac4dee85b6f7611a21e10ccbf94\">2b85ec1</a></td><td><code>trac #18564: Merged with 6.8.beta3</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7d272ab6a82837daa1f296206c0ac63bb6203108\">7d272ab</a></td><td><code>Avoid .hpp/.cpp files</code></td></tr></table>\n",
    "created_at": "2015-06-09T16:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257916",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:12"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/2b85ec1513584ac4dee85b6f7611a21e10ccbf94">2b85ec1</a></td><td><code>trac #18564: Merged with 6.8.beta3</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7d272ab6a82837daa1f296206c0ac63bb6203108">7d272ab</a></td><td><code>Avoid .hpp/.cpp files</code></td></tr></table>




---

archive/issue_comments_257917.json:
```json
{
    "body": "Changed commit from **[b0ca92c](https://github.com/sagemath/sagetrac-mirror/commit/b0ca92c0674f7fe4df454566208e3f69d5faf982)** to **[7d272ab](https://github.com/sagemath/sagetrac-mirror/commit/7d272ab6a82837daa1f296206c0ac63bb6203108)**",
    "created_at": "2015-06-09T16:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257917",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b0ca92c](https://github.com/sagemath/sagetrac-mirror/commit/b0ca92c0674f7fe4df454566208e3f69d5faf982)** to **[7d272ab](https://github.com/sagemath/sagetrac-mirror/commit/7d272ab6a82837daa1f296206c0ac63bb6203108)**



---

archive/issue_comments_257918.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nI have merged Nathann's work. I will continue from here!",
    "created_at": "2015-06-09T16:09:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257918",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:13" align="right">comment:13</div>

I have merged Nathann's work. I will continue from here!



---

archive/issue_comments_257919.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9fc1be655dfc5a4cfea997f4da2b28c8c1aef686\">9fc1be6</a></td><td><code>Moved conversion to file boost_graph</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/911c3eafa2f714d32a8d4b2fa6a02793e94fe7ad\">911c3ea</a></td><td><code>Multiple vertex/edge implementations working</code></td></tr></table>\n",
    "created_at": "2015-06-10T11:47:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257919",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9fc1be655dfc5a4cfea997f4da2b28c8c1aef686">9fc1be6</a></td><td><code>Moved conversion to file boost_graph</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/911c3eafa2f714d32a8d4b2fa6a02793e94fe7ad">911c3ea</a></td><td><code>Multiple vertex/edge implementations working</code></td></tr></table>




---

archive/issue_comments_257920.json:
```json
{
    "body": "Changed commit from **[7d272ab](https://github.com/sagemath/sagetrac-mirror/commit/7d272ab6a82837daa1f296206c0ac63bb6203108)** to **[911c3ea](https://github.com/sagemath/sagetrac-mirror/commit/911c3eafa2f714d32a8d4b2fa6a02793e94fe7ad)**",
    "created_at": "2015-06-10T11:47:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257920",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7d272ab](https://github.com/sagemath/sagetrac-mirror/commit/7d272ab6a82837daa1f296206c0ac63bb6203108)** to **[911c3ea](https://github.com/sagemath/sagetrac-mirror/commit/911c3eafa2f714d32a8d4b2fa6a02793e94fe7ad)**



---

archive/issue_comments_257921.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nJust a tip: if you run 'sage -cython -a your_file.pyx', you will get a .html file which indicates how much C code it takes to repleace each of your python lines (click on the yellow lines you see).\n\nWith this, you can easily notice loops which involve Python though they should not. It is often because of variables of unspecified type.\n\nIf you do the following replacement\n\n```\n- N = G_sage.num_verts()\n+ cdef int N = G_sage.num_verts()\n```\n\nyou should see something happen in the loops involving `N`.\n\nNathann",
    "created_at": "2015-06-10T11:51:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257921",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:15" align="right">comment:15</div>

Just a tip: if you run 'sage -cython -a your_file.pyx', you will get a .html file which indicates how much C code it takes to repleace each of your python lines (click on the yellow lines you see).

With this, you can easily notice loops which involve Python though they should not. It is often because of variables of unspecified type.

If you do the following replacement

```
- N = G_sage.num_verts()
+ cdef int N = G_sage.num_verts()
```

you should see something happen in the loops involving `N`.

Nathann



---

archive/issue_comments_257922.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n\n```\nError compiling Cython file:\n------------------------------------------------------------\n...\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 \n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 return G\n\u00a0\u00a0\u00a0 \n\u00a0\u00a0\u00a0 def __cinit__(self):\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 sig_on()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 self.graph = new UndVecGraph()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 ^\n------------------------------------------------------------\n\nsrc/sage/graphs/base/boost_graph.pyx:80:25: Operation only allowed in c++\n```\nHow can I tell it that the language is C++?",
    "created_at": "2015-06-10T11:59:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257922",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:16" align="right">comment:16</div>


```
Error compiling Cython file:
------------------------------------------------------------
...
                
        return G
    
    def __cinit__(self):
        sig_on()
        self.graph = new UndVecGraph()
                        ^
------------------------------------------------------------

src/sage/graphs/base/boost_graph.pyx:80:25: Operation only allowed in c++
```
How can I tell it that the language is C++?



---

archive/issue_comments_257923.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nOn my machine your code compiles.",
    "created_at": "2015-06-10T12:28:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257923",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:17" align="right">comment:17</div>

On my machine your code compiles.



---

archive/issue_comments_257924.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nThe code also compiles on my computer",
    "created_at": "2015-06-10T13:10:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257924",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:18" align="right">comment:18</div>

The code also compiles on my computer



---

archive/issue_comments_257925.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nSorry I forgot to say that this was the output to the command\n\n./sage -cython -a src/sage/graphs/base/boost_graph.pyx\n\nsuggested by Nathann in comment 15\n\nReplying to [@dcoudert](#comment:18):\n\n\n> The code also compiles on my computer",
    "created_at": "2015-06-10T13:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257925",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:19" align="right">comment:19</div>

Sorry I forgot to say that this was the output to the command

./sage -cython -a src/sage/graphs/base/boost_graph.pyx

suggested by Nathann in comment 15

Replying to [@dcoudert](#comment:18):


> The code also compiles on my computer



---

archive/issue_comments_257926.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\n> I forgot to say that this was the output to the command\n> \n> ./sage -cython -a src/sage/graphs/base/boost_graph.pyx\n\nOh, right! Can you try again after adding '#clang C++' in the first line of the file?\n\nNathann",
    "created_at": "2015-06-10T13:15:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257926",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:20" align="right">comment:20</div>

> I forgot to say that this was the output to the command
> 
> ./sage -cython -a src/sage/graphs/base/boost_graph.pyx

Oh, right! Can you try again after adding '#clang C++' in the first line of the file?

Nathann



---

archive/issue_comments_257927.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nNo way... I have tried the following:\n\n```\n'#clang C++'\n#clang C++\n'#distutils: language = c++'\n#distutils: language = c++\n\n```\nThe command\n\n```\n./sage -cython --cplus -a src/sage/graphs/base/boost_graph.pyx\n\n```\nseems to work, but I cannot find the html :(",
    "created_at": "2015-06-10T13:38:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257927",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:21" align="right">comment:21</div>

No way... I have tried the following:

```
'#clang C++'
#clang C++
'#distutils: language = c++'
#distutils: language = c++

```
The command

```
./sage -cython --cplus -a src/sage/graphs/base/boost_graph.pyx

```
seems to work, but I cannot find the html :(



---

archive/issue_comments_257928.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\n> seems to work, but I cannot find the html :(\n\nIsn't it right next to `boost_graph.pyx`? Type \"git status\" in Sage's folder, it should tell you something.\n\nNathann",
    "created_at": "2015-06-10T13:41:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257928",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:22" align="right">comment:22</div>

> seems to work, but I cannot find the html :(

Isn't it right next to `boost_graph.pyx`? Type "git status" in Sage's folder, it should tell you something.

Nathann



---

archive/issue_comments_257929.json:
```json
{
    "body": "<div id=\"comment:23\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a756070045d80a028ab4287eefc61095a44035ae\">a756070</a></td><td><code>Boost graph/digraph working. Need to move edge connectivity algorithm</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75cdbb6786b2cdce82715a56bcbb6924de317cf4\">75cdbb6</a></td><td><code>Edge connectivity: working and clean.</code></td></tr></table>\n",
    "created_at": "2015-06-11T17:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257929",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:23"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a756070045d80a028ab4287eefc61095a44035ae">a756070</a></td><td><code>Boost graph/digraph working. Need to move edge connectivity algorithm</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75cdbb6786b2cdce82715a56bcbb6924de317cf4">75cdbb6</a></td><td><code>Edge connectivity: working and clean.</code></td></tr></table>




---

archive/issue_comments_257930.json:
```json
{
    "body": "Changed commit from **[911c3ea](https://github.com/sagemath/sagetrac-mirror/commit/911c3eafa2f714d32a8d4b2fa6a02793e94fe7ad)** to **[75cdbb6](https://github.com/sagemath/sagetrac-mirror/commit/75cdbb6786b2cdce82715a56bcbb6924de317cf4)**",
    "created_at": "2015-06-11T17:05:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257930",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[911c3ea](https://github.com/sagemath/sagetrac-mirror/commit/911c3eafa2f714d32a8d4b2fa6a02793e94fe7ad)** to **[75cdbb6](https://github.com/sagemath/sagetrac-mirror/commit/75cdbb6786b2cdce82715a56bcbb6924de317cf4)**



---

archive/issue_comments_257931.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThis code should be a first draft of the final code. I have cleaned the Boost part and I have inserted the Boost edge connectivity. I have also cleaned the old edge connectivity, in order to integrate the new part. The following tests show that the cleaning did not affect speed, and that the new algorithm is much faster. Still, we might improve two points:\n\n* implement weighted graphs;\n\n* there is a (small) bottleneck when `vertices = True` and Boost is used.\n\nTESTS:\n\n```\nsage: G = graphs.CompleteGraph(40)\n\nsage: %timeit G.edge_connectivity(boost = False)\n1 loops, best of 3: 8.84 s per loop\n(OLD: 1 loops, best of 3: 8.78 s per loop)\n\nsage: %timeit G.edge_connectivity(boost = False, vertices = True)\n1 loops, best of 3: 8.82 s per loop\n(OLD: 1 loops, best of 3: 8.8 s per loop)\n\nsage: %timeit G.edge_connectivity()\n1000 loops, best of 3: 445 \u00b5s per loop\n\nsage: %timeit G.edge_connectivity(vertices = True)\n100 loops, best of 3: 1.57 ms per loop\n\nsage: G = graphs.PathGraph(100)\n\nsage: %timeit G.edge_connectivity(boost = False)\n100 loops, best of 3: 2.2 ms per loop\n(OLD: 100 loops, best of 3: 2.26 ms per loop)\n\nsage: %timeit G.edge_connectivity(boost = False, value_only = False)\n10 loops, best of 3: 59.2 ms per loop\n(OLD: 10 loops, best of 3: 58.9 ms per loop)\n\nsage: %timeit G.edge_connectivity(boost = False, vertices = True)\n10 loops, best of 3: 59.8 ms per loop\n(OLD: 10 loops, best of 3: 58.2 ms per loop)\n\nsage: %timeit G.edge_connectivity()\n1000 loops, best of 3: 226 \u00b5s per loop\n\nsage: %timeit G.edge_connectivity(vertices = True)\n1000 loops, best of 3: 524 \u00b5s per loop\n\n```\nPROBLEMS\n\nUnfortunately, the Boost edge connectivity has a bug when dealing with directed graphs, evidenced by the following C++ code. What can we do? Should we open a ticket in Boost graph library?\n\n```\n#include <iostream>\n#include <boost/graph/adjacency_list.hpp>\n#include <boost/graph/edge_connectivity.hpp>\n\n\nusing namespace boost;\ntypedef adjacency_list<vecS,vecS,bidirectionalS> MyGraph;\n\nint main()\n{\n    typedef graph_traits < MyGraph >::vertex_descriptor vertex_descriptor;\n    typedef graph_traits < MyGraph >::edge_descriptor edge_descriptor;\n\n    MyGraph g;\n\n    vertex_descriptor v1 = add_vertex(g);\n    vertex_descriptor v2 = add_vertex(g);\n    vertex_descriptor v3 = add_vertex(g);\n\n    add_edge(v1, v2, g);\n    add_edge(v2, v3, g);\n\n    std::cout << \"Number of vertices: \" << num_vertices(g) << \".\\nNumber of edges: \" << num_edges(g) << \".\\n\";\n    std::vector < edge_descriptor > disconnecting_set;\n\n    std::cout << \"The edge connectivity is \"\n              << edge_connectivity(g, std::back_inserter(disconnecting_set))\n              << \".\" << std::endl;\n\n    add_edge(v2, v1, g);\n    std::cout << \"Number of vertices: \" << num_vertices(g) << \".\\nNumber of edges: \" << num_edges(g) << \".\\n\";\n\n    std::cout << \"Now, the edge connectivity is \"\n              << edge_connectivity(g, std::back_inserter(disconnecting_set))\n              << \".\" << std::endl;\n    return EXIT_SUCCESS;\n}\n\n```\nOutput:\n\n```\nNumber of vertices: 3.\nNumber of edges: 2.\nThe edge connectivity is 1.\nNumber of vertices: 3.\nNumber of edges: 3.\nNow, the edge connectivity is 0.\n```",
    "created_at": "2015-06-11T17:16:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257931",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:24" align="right">comment:24</div>

This code should be a first draft of the final code. I have cleaned the Boost part and I have inserted the Boost edge connectivity. I have also cleaned the old edge connectivity, in order to integrate the new part. The following tests show that the cleaning did not affect speed, and that the new algorithm is much faster. Still, we might improve two points:

* implement weighted graphs;

* there is a (small) bottleneck when `vertices = True` and Boost is used.

TESTS:

```
sage: G = graphs.CompleteGraph(40)

sage: %timeit G.edge_connectivity(boost = False)
1 loops, best of 3: 8.84 s per loop
(OLD: 1 loops, best of 3: 8.78 s per loop)

sage: %timeit G.edge_connectivity(boost = False, vertices = True)
1 loops, best of 3: 8.82 s per loop
(OLD: 1 loops, best of 3: 8.8 s per loop)

sage: %timeit G.edge_connectivity()
1000 loops, best of 3: 445 µs per loop

sage: %timeit G.edge_connectivity(vertices = True)
100 loops, best of 3: 1.57 ms per loop

sage: G = graphs.PathGraph(100)

sage: %timeit G.edge_connectivity(boost = False)
100 loops, best of 3: 2.2 ms per loop
(OLD: 100 loops, best of 3: 2.26 ms per loop)

sage: %timeit G.edge_connectivity(boost = False, value_only = False)
10 loops, best of 3: 59.2 ms per loop
(OLD: 10 loops, best of 3: 58.9 ms per loop)

sage: %timeit G.edge_connectivity(boost = False, vertices = True)
10 loops, best of 3: 59.8 ms per loop
(OLD: 10 loops, best of 3: 58.2 ms per loop)

sage: %timeit G.edge_connectivity()
1000 loops, best of 3: 226 µs per loop

sage: %timeit G.edge_connectivity(vertices = True)
1000 loops, best of 3: 524 µs per loop

```
PROBLEMS

Unfortunately, the Boost edge connectivity has a bug when dealing with directed graphs, evidenced by the following C++ code. What can we do? Should we open a ticket in Boost graph library?

```
#include <iostream>
#include <boost/graph/adjacency_list.hpp>
#include <boost/graph/edge_connectivity.hpp>


using namespace boost;
typedef adjacency_list<vecS,vecS,bidirectionalS> MyGraph;

int main()
{
    typedef graph_traits < MyGraph >::vertex_descriptor vertex_descriptor;
    typedef graph_traits < MyGraph >::edge_descriptor edge_descriptor;

    MyGraph g;

    vertex_descriptor v1 = add_vertex(g);
    vertex_descriptor v2 = add_vertex(g);
    vertex_descriptor v3 = add_vertex(g);

    add_edge(v1, v2, g);
    add_edge(v2, v3, g);

    std::cout << "Number of vertices: " << num_vertices(g) << ".\nNumber of edges: " << num_edges(g) << ".\n";
    std::vector < edge_descriptor > disconnecting_set;

    std::cout << "The edge connectivity is "
              << edge_connectivity(g, std::back_inserter(disconnecting_set))
              << "." << std::endl;

    add_edge(v2, v1, g);
    std::cout << "Number of vertices: " << num_vertices(g) << ".\nNumber of edges: " << num_edges(g) << ".\n";

    std::cout << "Now, the edge connectivity is "
              << edge_connectivity(g, std::back_inserter(disconnecting_set))
              << "." << std::endl;
    return EXIT_SUCCESS;
}

```
Output:

```
Number of vertices: 3.
Number of edges: 2.
The edge connectivity is 1.
Number of vertices: 3.
Number of edges: 3.
Now, the edge connectivity is 0.
```



---

archive/issue_events_263916.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-11T17:16:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263916"
}
```



---

archive/issue_comments_257932.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nHello Michele,\n\nYour patch is rather big, and I think that it can be simplified:\n\n- There is a weird 'pass' in boost_graph.pxd\n\n- `#clang c++` is not useful in Sage's source\n\n- You should add your new file to the doc index\n  (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)\n\n  Also, the header of your new module should describe what it implements\n\n- This will make you notice (Sphinx will scream) that whatever follows a '::'\n  should be indented.\n\n- A module's documentation is no place for 'todo'. If you want to work on\n  something, create a trac ticket.\n\n- Why a static 'from_sage_graph' function instead of a constructor accepting a\n  graph as an input?\n\n- `sig_on/sig_off` -- these markers are used so that the code can be interrupted\n  while some C code is being run. Why would you put them around functions which\n  end instantaneously, like `add_edge/add_vertex`?\n\n- The variable 'i' is also an integer, and you should define it as 'cdef int' so\n  that your Cython code will be better optimised.\n\n- Why would you define `edge_connectivity_boost_*` functions in\n  `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can\n  import them if needed.\n\n- Why did you move the LP out of the current `edge_connectivity` function? Can't\n  you leave if where it is, and at the beginning of the file call the boost\n  functions if this is what the user wants?\n\n- When you submit a branch, always look at the final 'diff'. You can see it by\n  clicking on the (green) branch's name on its ticket, and it will tell you what\n  the reviewer sees and how he will have to figure out what your code\n  does. Everything that is not crystal clear for you is not crystal clear for\n  him.\n\nGood evening,\n\nNathann",
    "created_at": "2015-06-11T22:13:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257932",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:25" align="right">comment:25</div>

Hello Michele,

Your patch is rather big, and I think that it can be simplified:

- There is a weird 'pass' in boost_graph.pxd

- `#clang c++` is not useful in Sage's source

- You should add your new file to the doc index
  (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)

  Also, the header of your new module should describe what it implements

- This will make you notice (Sphinx will scream) that whatever follows a '::'
  should be indented.

- A module's documentation is no place for 'todo'. If you want to work on
  something, create a trac ticket.

- Why a static 'from_sage_graph' function instead of a constructor accepting a
  graph as an input?

- `sig_on/sig_off` -- these markers are used so that the code can be interrupted
  while some C code is being run. Why would you put them around functions which
  end instantaneously, like `add_edge/add_vertex`?

- The variable 'i' is also an integer, and you should define it as 'cdef int' so
  that your Cython code will be better optimised.

- Why would you define `edge_connectivity_boost_*` functions in
  `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can
  import them if needed.

- Why did you move the LP out of the current `edge_connectivity` function? Can't
  you leave if where it is, and at the beginning of the file call the boost
  functions if this is what the user wants?

- When you submit a branch, always look at the final 'diff'. You can see it by
  clicking on the (green) branch's name on its ticket, and it will tell you what
  the reviewer sees and how he will have to figure out what your code
  does. Everything that is not crystal clear for you is not crystal clear for
  him.

Good evening,

Nathann



---

archive/issue_events_263917.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-11T22:13:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263917"
}
```



---

archive/issue_events_263918.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-11T22:13:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263918"
}
```



---

archive/issue_comments_257933.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nFinally: please report the bug you found to boost. They must fix it.",
    "created_at": "2015-06-11T22:15:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257933",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:26" align="right">comment:26</div>

Finally: please report the bug you found to boost. They must fix it.



---

archive/issue_comments_257934.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e0d81e4b8f85b0bf06e9af7c081a994971ea1a25\">e0d81e4</a></td><td><code>Cleaned the code according to Nathann's suggestions (except last point)</code></td></tr></table>\n",
    "created_at": "2015-06-12T10:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257934",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e0d81e4b8f85b0bf06e9af7c081a994971ea1a25">e0d81e4</a></td><td><code>Cleaned the code according to Nathann's suggestions (except last point)</code></td></tr></table>




---

archive/issue_comments_257935.json:
```json
{
    "body": "Changed commit from **[75cdbb6](https://github.com/sagemath/sagetrac-mirror/commit/75cdbb6786b2cdce82715a56bcbb6924de317cf4)** to **[e0d81e4](https://github.com/sagemath/sagetrac-mirror/commit/e0d81e4b8f85b0bf06e9af7c081a994971ea1a25)**",
    "created_at": "2015-06-12T10:27:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257935",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[75cdbb6](https://github.com/sagemath/sagetrac-mirror/commit/75cdbb6786b2cdce82715a56bcbb6924de317cf4)** to **[e0d81e4](https://github.com/sagemath/sagetrac-mirror/commit/e0d81e4b8f85b0bf06e9af7c081a994971ea1a25)**



---

archive/issue_comments_257936.json:
```json
{
    "body": "Changed commit from **[e0d81e4](https://github.com/sagemath/sagetrac-mirror/commit/e0d81e4b8f85b0bf06e9af7c081a994971ea1a25)** to **[7b62350](https://github.com/sagemath/sagetrac-mirror/commit/7b62350f7dd976a7e635a455378bfa4189083cf4)**",
    "created_at": "2015-06-12T10:30:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257936",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e0d81e4](https://github.com/sagemath/sagetrac-mirror/commit/e0d81e4b8f85b0bf06e9af7c081a994971ea1a25)** to **[7b62350](https://github.com/sagemath/sagetrac-mirror/commit/7b62350f7dd976a7e635a455378bfa4189083cf4)**



---

archive/issue_comments_257937.json:
```json
{
    "body": "<div id=\"comment:28\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7b62350f7dd976a7e635a455378bfa4189083cf4\">7b62350</a></td><td><code>Corrected all problems oulined by Nathann.</code></td></tr></table>\n",
    "created_at": "2015-06-12T10:30:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257937",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7b62350f7dd976a7e635a455378bfa4189083cf4">7b62350</a></td><td><code>Corrected all problems oulined by Nathann.</code></td></tr></table>




---

archive/issue_comments_257938.json:
```json
{
    "body": "Changed commit from **[7b62350](https://github.com/sagemath/sagetrac-mirror/commit/7b62350f7dd976a7e635a455378bfa4189083cf4)** to **[b513cf9](https://github.com/sagemath/sagetrac-mirror/commit/b513cf9f6a52e1dae5805cb622da9481069defc3)**",
    "created_at": "2015-06-12T10:33:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257938",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7b62350](https://github.com/sagemath/sagetrac-mirror/commit/7b62350f7dd976a7e635a455378bfa4189083cf4)** to **[b513cf9](https://github.com/sagemath/sagetrac-mirror/commit/b513cf9f6a52e1dae5805cb622da9481069defc3)**



---

archive/issue_comments_257939.json:
```json
{
    "body": "<div id=\"comment:29\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b513cf9f6a52e1dae5805cb622da9481069defc3\">b513cf9</a></td><td><code>Removed unused import in generic_graph_pyx</code></td></tr></table>\n",
    "created_at": "2015-06-12T10:33:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257939",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:29"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b513cf9f6a52e1dae5805cb622da9481069defc3">b513cf9</a></td><td><code>Removed unused import in generic_graph_pyx</code></td></tr></table>




---

archive/issue_events_263919.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-12T10:50:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263919"
}
```



---

archive/issue_events_263920.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-12T10:50:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263920"
}
```



---

archive/issue_comments_257940.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nHello,\n\nI have tried to correct your problems. More details below.\n\nBest,\n\nMichele\n\n> - There is a weird 'pass' in boost_graph.pxd\n\nRemoved!\n\n> \n> - `#clang c++` is not useful in Sage's source\n\nThen I am afraid I have not understood your comment 20... Where should I have put it? In any case, I removed it.\n\n> \n> - You should add your new file to the doc index\n> (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)\n\nSorry, you have already told me to do so, but since I had to take many things into account, I forgot. Now I have done it!\n\n> \n> Also, the header of your new module should describe what it implements\n\nI have added the list of methods implemented, as in `generic_graph`. Is this what you meant?\n\n> \n> - This will make you notice (Sphinx will scream) that whatever follows a '::'\n> should be indented.\n\nDone!\n\n> \n> - A module's documentation is no place for 'todo'. If you want to work on\n> something, create a trac ticket.\n\nOk!\n\n> \n> - Why a static 'from_sage_graph' function instead of a constructor accepting a\n> graph as an input?\n\nSigh, you are right... Done!\n\n> \n> - `sig_on/sig_off` -- these markers are used so that the code can be interrupted\n> while some C code is being run. Why would you put them around functions which\n> end instantaneously, like `add_edge/add_vertex`?\n\nUps, I thought they were used to handle segmentation faults... My mistake!\n\n> \n> - The variable 'i' is also an integer, and you should define it as 'cdef int' so\n> that your Cython code will be better optimised.\n\nI didn't define it as a cdef because that was not the bottleneck of the algorithm, and I chose readability instead of efficiency. However, now I used cdef.\n\n> \n> - Why would you define `edge_connectivity_boost_*` functions in\n> `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can\n> import them if needed.\n\nBecause, in my opinion, it could be better to keep the Boost implementation separated from the Boost algorithms (since soon there will be many of them), and to put the algorithms in the files where they will be used. Anyway, I moved it back!\n\n> \n> - Why did you move the LP out of the current `edge_connectivity` function? Can't\n> you leave if where it is, and at the beginning of the file call the boost\n> functions if this is what the user wants?\n\nBecause I do not really like functions that are \"too long\", and I thought that some code used with Boost could be re-used by the LP algorithm, simplifying the function. Anyway, I have returned to the old version.\n\n> \n> - When you submit a branch, always look at the final 'diff'. You can see it by\n> clicking on the (green) branch's name on its ticket, and it will tell you what\n> the reviewer sees and how he will have to figure out what your code\n> does. Everything that is not crystal clear for you is not crystal clear for\n> him.\n\nNow the diff should be cleaner. Is there any way to see the diff before pushing my changes (e.g. git diffall or something like that)?\n\n> Finally: please report the bug you found to boost. They must fix it.\n\nI will add the bug to the Boost trac as soon as the Boost trac server (svn.boost.org/) starts to work again. If it doesn't, in a few days I will try to find other ways to contact Boost developers.",
    "created_at": "2015-06-12T10:50:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257940",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:30" align="right">comment:30</div>

Hello,

I have tried to correct your problems. More details below.

Best,

Michele

> - There is a weird 'pass' in boost_graph.pxd

Removed!

> 
> - `#clang c++` is not useful in Sage's source

Then I am afraid I have not understood your comment 20... Where should I have put it? In any case, I removed it.

> 
> - You should add your new file to the doc index
> (http://doc.sagemath.org/html/en/developer/sage_manuals.html#adding-a-new-file)

Sorry, you have already told me to do so, but since I had to take many things into account, I forgot. Now I have done it!

> 
> Also, the header of your new module should describe what it implements

I have added the list of methods implemented, as in `generic_graph`. Is this what you meant?

> 
> - This will make you notice (Sphinx will scream) that whatever follows a '::'
> should be indented.

Done!

> 
> - A module's documentation is no place for 'todo'. If you want to work on
> something, create a trac ticket.

Ok!

> 
> - Why a static 'from_sage_graph' function instead of a constructor accepting a
> graph as an input?

Sigh, you are right... Done!

> 
> - `sig_on/sig_off` -- these markers are used so that the code can be interrupted
> while some C code is being run. Why would you put them around functions which
> end instantaneously, like `add_edge/add_vertex`?

Ups, I thought they were used to handle segmentation faults... My mistake!

> 
> - The variable 'i' is also an integer, and you should define it as 'cdef int' so
> that your Cython code will be better optimised.

I didn't define it as a cdef because that was not the bottleneck of the algorithm, and I chose readability instead of efficiency. However, now I used cdef.

> 
> - Why would you define `edge_connectivity_boost_*` functions in
> `generic_graph_pyx` instead of doing it in the `graph_boost` file? You can
> import them if needed.

Because, in my opinion, it could be better to keep the Boost implementation separated from the Boost algorithms (since soon there will be many of them), and to put the algorithms in the files where they will be used. Anyway, I moved it back!

> 
> - Why did you move the LP out of the current `edge_connectivity` function? Can't
> you leave if where it is, and at the beginning of the file call the boost
> functions if this is what the user wants?

Because I do not really like functions that are "too long", and I thought that some code used with Boost could be re-used by the LP algorithm, simplifying the function. Anyway, I have returned to the old version.

> 
> - When you submit a branch, always look at the final 'diff'. You can see it by
> clicking on the (green) branch's name on its ticket, and it will tell you what
> the reviewer sees and how he will have to figure out what your code
> does. Everything that is not crystal clear for you is not crystal clear for
> him.

Now the diff should be cleaner. Is there any way to see the diff before pushing my changes (e.g. git diffall or something like that)?

> Finally: please report the bug you found to boost. They must fix it.

I will add the bug to the Boost trac as soon as the Boost trac server (svn.boost.org/) starts to work again. If it doesn't, in a few days I will try to find other ways to contact Boost developers.



---

archive/issue_comments_257941.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nHelloooooooo Michele,\n\nThanks for this update, the code looks much better. Further remarks:\n\n- About `clang: c++`: this was useful for you to run `sage -cython -a\n  boost_graph.pyx` since this command does not read `module_list.py` (in which\n  you specified that it was a c++ file). However, there is no need to add this\n  line for everything to work 'in sage'. That's only useful to create the html\n  file, though you found a better way to do it with the `--cplus` file.\n\n- About `sig_on/off`:\n  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling\n\n- About `cdef int i`: well, you are right this is not a bottleneck at all. I\n  just said that as a reflex, sorry ^^;\n\n- About:\n\n  ```\n  Because, in my opinion, it could be better to keep the Boost implementation\n  separated from the Boost algorithms (since soon there will be many of them),\n  and to put the algorithms in the files where they will be used.\n  ```\n  Hmmmm... Well, as a result we would end up with data-structure specific code\n  in `generic_graph_pyx.pyx`, and that is not very pretty either. It is better\n  to have such low-level functions close together in a data-structure specific\n  file. If you think that the boost file will grow too large after a while,\n  however, we can split it in two files: one for the data structure, one for the\n  exposed algorithms. Several files from base/ already contain some algorithm.\n\n- About:\n\n  ```\n  Because I do not really like functions that are \"too long\", and I thought\n  that some code used with Boost could be re-used by the LP algorithm,\n  simplifying the function.\n  ```\n\n  First, note that moving code around has a very very bad effect on the final\n  'diff'. The reviewer sees a big removal and a big addition, and his job is to\n  check that no new bug was introduced, so that's quite some work only to move\n  code around. When you only want to *move* code around, it is much easier for\n  the reviewer if you do it in two steps:\n  - Move the code *without any other modification* (easy to check with a couple\n    of bash commands)\n  - Make the small changed needed in the code to 'adapt' it to its new location.\n  This way the review is easier.\n\n- You added 'boost_graph' first in its block in the graph documentation. That\n  list is not sorted alphabetically, for the first item is 'overview of graph\n  classes'. Could you move it below it? It is the most 'general' document.\n\n- Style issue, do whatever you want: instead of `if not (G is None)` followed by\n  a big indented block, you can write `if G is None: return`\n\n  By the way, `G is not None` does what you want:\n\n  ```\n  sage: not False\n  True\n  sage: None is True\n  False\n  sage: None is not False\n  True\n  ```\n\n- Your functions are \"def\" functions, i.e. Python functions. If you turn them\n  into 'cpdef' functions they will be both Python+C functions, and C code will\n  call the C function directly\n\n- Could you write somewhere in the doc of your boost classes that edge labels\n  are not supported (in particular when you build a Boost graph from a Sage\n  graph)\n\n- If multiple edges and loops are supported, can you add a doctest that checks\n  it?\n\n- `m = max(u, v)`: looks useless\n\n- `self.vertices.at(u)`: this sems to check that `u` is actually within the\n  bounds of the vector. Why not `self.vertices[u]` since the function is\n  `unsafe`?\n\n- `def edge_connectivity`: we try to keep the first line of a docstring to be a\n  short sentence describing what the function does. The next paragraph can be as\n  think as you want.\n\n- `for i from 0 <= i < ec`: that's old-style. Nowadays, it is equivalent to `for\n  i in range(ec)` (Cython translates it 'properly').\n\n- Awkward question: I have to admit that I am no big fan of the huge\n  copy/paste... Since Cython extension classes do not support templating but\n  functions do, what about not having a `BoostGraph` struct instead of a class?\n  We could have two of these struct and many functions that apply to it, each of\n  which handles fused types. Thus, only one function instead of two, no more\n  copy/paste?... Please tell me how you feel about that.\n\n- About:\n\n  ```\n  Now the diff should be cleaner. Is there any way to see the diff before\n  pushing my changes (e.g. git diffall or something like that)?\n  ```\n  You can see all the changes made by your current branch compared with the\n  latest release with 'git diff HEAD ^develop'. Beware: does not take uncommited\n  changed into account.\n\n- Another \"git cleanness\" issue: having commits undo what a previous commit did\n  is not entirely 'free'. For example, if you run 'git blame' on\n  `generic_graph.py` you will notice that your name on all lines of\n  `edge_connectivity` since you are the last one who touched them (you moved\n  them twice). While this is not a very very very bad problem, we somehow lose\n  information with things like that.\n\n  I also believe (and nobody but me is forced to follow those rules) that the\n  git history of a branch should be made to be read rather than be the\n  try-and-fail history of attempts to write a code.\n\n  A way to solve both problems is to *merge* commits together (a specific case\n  of history rewriting). You can do this with 'git rebase -i develop' [1] (look\n  for the 'squash' keyword).\n\n  If you do that, you will have to add -f (force) to your 'push' command since\n  you will not be adding commit but overwriting existing ones.\n\n- `from sage.graphs.digraph import DiGraph`: looks useless\n\n- `if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't\n  you be using a `breadth_first_search` instead of a `SCC`?\n\n- There is a `delete_edges` function.\n\nNathann\n\n[1] https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase-i/",
    "created_at": "2015-06-12T11:55:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257941",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:31" align="right">comment:31</div>

Helloooooooo Michele,

Thanks for this update, the code looks much better. Further remarks:

- About `clang: c++`: this was useful for you to run `sage -cython -a
  boost_graph.pyx` since this command does not read `module_list.py` (in which
  you specified that it was a c++ file). However, there is no need to add this
  line for everything to work 'in sage'. That's only useful to create the html
  file, though you found a better way to do it with the `--cplus` file.

- About `sig_on/off`:
  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling

- About `cdef int i`: well, you are right this is not a bottleneck at all. I
  just said that as a reflex, sorry ^^;

- About:

  ```
  Because, in my opinion, it could be better to keep the Boost implementation
  separated from the Boost algorithms (since soon there will be many of them),
  and to put the algorithms in the files where they will be used.
  ```
  Hmmmm... Well, as a result we would end up with data-structure specific code
  in `generic_graph_pyx.pyx`, and that is not very pretty either. It is better
  to have such low-level functions close together in a data-structure specific
  file. If you think that the boost file will grow too large after a while,
  however, we can split it in two files: one for the data structure, one for the
  exposed algorithms. Several files from base/ already contain some algorithm.

- About:

  ```
  Because I do not really like functions that are "too long", and I thought
  that some code used with Boost could be re-used by the LP algorithm,
  simplifying the function.
  ```

  First, note that moving code around has a very very bad effect on the final
  'diff'. The reviewer sees a big removal and a big addition, and his job is to
  check that no new bug was introduced, so that's quite some work only to move
  code around. When you only want to *move* code around, it is much easier for
  the reviewer if you do it in two steps:
  - Move the code *without any other modification* (easy to check with a couple
    of bash commands)
  - Make the small changed needed in the code to 'adapt' it to its new location.
  This way the review is easier.

- You added 'boost_graph' first in its block in the graph documentation. That
  list is not sorted alphabetically, for the first item is 'overview of graph
  classes'. Could you move it below it? It is the most 'general' document.

- Style issue, do whatever you want: instead of `if not (G is None)` followed by
  a big indented block, you can write `if G is None: return`

  By the way, `G is not None` does what you want:

  ```
  sage: not False
  True
  sage: None is True
  False
  sage: None is not False
  True
  ```

- Your functions are "def" functions, i.e. Python functions. If you turn them
  into 'cpdef' functions they will be both Python+C functions, and C code will
  call the C function directly

- Could you write somewhere in the doc of your boost classes that edge labels
  are not supported (in particular when you build a Boost graph from a Sage
  graph)

- If multiple edges and loops are supported, can you add a doctest that checks
  it?

- `m = max(u, v)`: looks useless

- `self.vertices.at(u)`: this sems to check that `u` is actually within the
  bounds of the vector. Why not `self.vertices[u]` since the function is
  `unsafe`?

- `def edge_connectivity`: we try to keep the first line of a docstring to be a
  short sentence describing what the function does. The next paragraph can be as
  think as you want.

- `for i from 0 <= i < ec`: that's old-style. Nowadays, it is equivalent to `for
  i in range(ec)` (Cython translates it 'properly').

- Awkward question: I have to admit that I am no big fan of the huge
  copy/paste... Since Cython extension classes do not support templating but
  functions do, what about not having a `BoostGraph` struct instead of a class?
  We could have two of these struct and many functions that apply to it, each of
  which handles fused types. Thus, only one function instead of two, no more
  copy/paste?... Please tell me how you feel about that.

- About:

  ```
  Now the diff should be cleaner. Is there any way to see the diff before
  pushing my changes (e.g. git diffall or something like that)?
  ```
  You can see all the changes made by your current branch compared with the
  latest release with 'git diff HEAD ^develop'. Beware: does not take uncommited
  changed into account.

- Another "git cleanness" issue: having commits undo what a previous commit did
  is not entirely 'free'. For example, if you run 'git blame' on
  `generic_graph.py` you will notice that your name on all lines of
  `edge_connectivity` since you are the last one who touched them (you moved
  them twice). While this is not a very very very bad problem, we somehow lose
  information with things like that.

  I also believe (and nobody but me is forced to follow those rules) that the
  git history of a branch should be made to be read rather than be the
  try-and-fail history of attempts to write a code.

  A way to solve both problems is to *merge* commits together (a specific case
  of history rewriting). You can do this with 'git rebase -i develop' [1] (look
  for the 'squash' keyword).

  If you do that, you will have to add -f (force) to your 'push' command since
  you will not be adding commit but overwriting existing ones.

- `from sage.graphs.digraph import DiGraph`: looks useless

- `if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't
  you be using a `breadth_first_search` instead of a `SCC`?

- There is a `delete_edges` function.

Nathann

[1] https://www.atlassian.com/git/tutorials/rewriting-history/git-rebase-i/



---

archive/issue_events_263921.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-12T11:55:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263921"
}
```



---

archive/issue_events_263922.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-12T11:55:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263922"
}
```



---

archive/issue_comments_257942.json:
```json
{
    "body": "<div id=\"comment:32\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6e9738d23064ce576771ea113b6efaaa530b94fc\">6e9738d</a></td><td><code>After second round of corrections (missing struct, SCC).</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f9beeee7fb3b29eae5e9388ff7f7d696eb241ea6\">f9beeee</a></td><td><code>Corrected a wrong parenthesis in the doc.</code></td></tr></table>\n",
    "created_at": "2015-06-12T13:47:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257942",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:32"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6e9738d23064ce576771ea113b6efaaa530b94fc">6e9738d</a></td><td><code>After second round of corrections (missing struct, SCC).</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f9beeee7fb3b29eae5e9388ff7f7d696eb241ea6">f9beeee</a></td><td><code>Corrected a wrong parenthesis in the doc.</code></td></tr></table>




---

archive/issue_comments_257943.json:
```json
{
    "body": "Changed commit from **[b513cf9](https://github.com/sagemath/sagetrac-mirror/commit/b513cf9f6a52e1dae5805cb622da9481069defc3)** to **[f9beeee](https://github.com/sagemath/sagetrac-mirror/commit/f9beeee7fb3b29eae5e9388ff7f7d696eb241ea6)**",
    "created_at": "2015-06-12T13:47:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257943",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[b513cf9](https://github.com/sagemath/sagetrac-mirror/commit/b513cf9f6a52e1dae5805cb622da9481069defc3)** to **[f9beeee](https://github.com/sagemath/sagetrac-mirror/commit/f9beeee7fb3b29eae5e9388ff7f7d696eb241ea6)**



---

archive/issue_comments_257944.json:
```json
{
    "body": "Changed commit from **[f9beeee](https://github.com/sagemath/sagetrac-mirror/commit/f9beeee7fb3b29eae5e9388ff7f7d696eb241ea6)** to **[7481889](https://github.com/sagemath/sagetrac-mirror/commit/7481889e9795e22c5d7ea9b42335f14548c9c636)**",
    "created_at": "2015-06-12T13:48:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257944",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f9beeee](https://github.com/sagemath/sagetrac-mirror/commit/f9beeee7fb3b29eae5e9388ff7f7d696eb241ea6)** to **[7481889](https://github.com/sagemath/sagetrac-mirror/commit/7481889e9795e22c5d7ea9b42335f14548c9c636)**



---

archive/issue_comments_257945.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/7481889e9795e22c5d7ea9b42335f14548c9c636\">7481889</a></td><td><code>Corrected SCC=>breadth_first_search</code></td></tr></table>\n",
    "created_at": "2015-06-12T13:48:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257945",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/7481889e9795e22c5d7ea9b42335f14548c9c636">7481889</a></td><td><code>Corrected SCC=>breadth_first_search</code></td></tr></table>




---

archive/issue_comments_257946.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nHi (just to change ;-) )!\n\nI have applied all your remarks, except the following:\n\n> Awkward question: I have to admit that I am no big fan of the huge\n> copy/paste... Since Cython extension classes do not support templating but\n> functions do, what about not having a `BoostGraph` struct instead of a class?\n> We could have two of these struct and many functions that apply to it, each of\n> which handles fused types. Thus, only one function instead of two, no more\n> copy/paste?... Please tell me how you feel about that.\n\nNice! I will try it and I will let you know the results (it might take a while).\n\n> A  way to solve both problems is to *merge* commits together (a specific  case of history rewriting). You can do this with 'git rebase -i develop'\n\nI have two problems with rebase:\n\n* the  work can be very long, because I didn't know it, and in several commits  I also did small modifications that will be difficult to replicate.\n\n* At the moment, git rebase does not work:\n\n```\ngit rebase -i develop \nerror: could not apply de3440a... initial implementation of unicode art \n\nWhen you have resolved this problem, run \"git rebase --continue\". \nIf you prefer to skip this patch, run \"git rebase --skip\" instead. \nTo check out the original branch and stop rebasing, run \"git rebase --abort\". \nCould not apply de3440ab223b0031d10e447d124c5f68cbb388cd... initial implementation of unicode art\n```\n> !`if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't you be using a !`breadth_first_search` instead of a !`SCC`?\n\nCould you check that now the SCC/BFS code is correct?\n\nThank you very much!\n\nMichele",
    "created_at": "2015-06-12T13:52:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257946",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:34" align="right">comment:34</div>

Hi (just to change ;-) )!

I have applied all your remarks, except the following:

> Awkward question: I have to admit that I am no big fan of the huge
> copy/paste... Since Cython extension classes do not support templating but
> functions do, what about not having a `BoostGraph` struct instead of a class?
> We could have two of these struct and many functions that apply to it, each of
> which handles fused types. Thus, only one function instead of two, no more
> copy/paste?... Please tell me how you feel about that.

Nice! I will try it and I will let you know the results (it might take a while).

> A  way to solve both problems is to *merge* commits together (a specific  case of history rewriting). You can do this with 'git rebase -i develop'

I have two problems with rebase:

* the  work can be very long, because I didn't know it, and in several commits  I also did small modifications that will be difficult to replicate.

* At the moment, git rebase does not work:

```
git rebase -i develop 
error: could not apply de3440a... initial implementation of unicode art 

When you have resolved this problem, run "git rebase --continue". 
If you prefer to skip this patch, run "git rebase --skip" instead. 
To check out the original branch and stop rebasing, run "git rebase --abort". 
Could not apply de3440ab223b0031d10e447d124c5f68cbb388cd... initial implementation of unicode art
```
> !`if H.is_directed(): val.append(H.strongly_connected_components())` shouldn't you be using a !`breadth_first_search` instead of a !`SCC`?

Could you check that now the SCC/BFS code is correct?

Thank you very much!

Michele



---

archive/issue_comments_257947.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nHelloooooo,\n\n> I have two problems with rebase:\n\nI will give it a try once I answer this message. I do not understand the error that you meet. Perhaps a not-up-to-date 'develop'? Either way, if it takes more than 30 seconds it means that something it not right.\n\n> Could you check that now the SCC/BFS code is correct?\n\nI do not think that it is. It fails on a very simple graph\n\n```\nsage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)\nThe directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.\n[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]\n```\n\nYou are simply doing things in the wrong direction. You should use the *sources* of the edges as the sources of your BFS.\n\nAnd you can also simplify your code a lot. Something like this should do:\n\n```\na = set(H.breadth_first_search([x for x,y in edges])))\nb = set(H).difference(a)\n```\n\nI did not try it, but I am optimistic.\n\nTwo other things:\n- There are many 'trailing whitespaces' [1] in your code. You can add `'(show-trailing-whitespace t)` in your `~/.emacs` file (if you use emacs `:-P`) to see them.\n- You should add a doctest for the digraph+boost case. You would see that your code breaks.\n- `Set` is a combinat object that you should not use unless you need their usual over-abstraction. 'set' is a faster python set object, which does what you need in this situation.\n\nNathann\n\n[1] http://programmers.stackexchange.com/questions/121555/why-is-trailing-whitespace-a-big-deal",
    "created_at": "2015-06-12T14:10:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257947",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:35" align="right">comment:35</div>

Helloooooo,

> I have two problems with rebase:

I will give it a try once I answer this message. I do not understand the error that you meet. Perhaps a not-up-to-date 'develop'? Either way, if it takes more than 30 seconds it means that something it not right.

> Could you check that now the SCC/BFS code is correct?

I do not think that it is. It fails on a very simple graph

```
sage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)
The directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.
[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]
```

You are simply doing things in the wrong direction. You should use the *sources* of the edges as the sources of your BFS.

And you can also simplify your code a lot. Something like this should do:

```
a = set(H.breadth_first_search([x for x,y in edges])))
b = set(H).difference(a)
```

I did not try it, but I am optimistic.

Two other things:
- There are many 'trailing whitespaces' [1] in your code. You can add `'(show-trailing-whitespace t)` in your `~/.emacs` file (if you use emacs `:-P`) to see them.
- You should add a doctest for the digraph+boost case. You would see that your code breaks.
- `Set` is a combinat object that you should not use unless you need their usual over-abstraction. 'set' is a faster python set object, which does what you need in this situation.

Nathann

[1] http://programmers.stackexchange.com/questions/121555/why-is-trailing-whitespace-a-big-deal



---

archive/issue_comments_257948.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nA merged commit (all into one) at public/18564_merged",
    "created_at": "2015-06-12T14:15:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257948",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:36" align="right">comment:36</div>

A merged commit (all into one) at public/18564_merged



---

archive/issue_comments_257949.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nHello,\n\n```\n{{{\n\nsage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)\n\nThe directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.\n\n[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]\n\n}}}\n```\nI think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?",
    "created_at": "2015-06-14T14:12:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257949",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:37" align="right">comment:37</div>

Hello,

```
{{{

sage: digraphs.Circuit(10).edge_connectivity(boost=True,vertices=True)

The directed edge connectivity algorithm implemented in the Boost graph library is not reliable. The result could be wrong.

[1, [[0, 1]], [[0, 1, 2, 3, 4, 5, 6, 7, 8, 9], []]]

}}}
```
I think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?



---

archive/issue_comments_257950.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\n> I think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?\n\nAny partition of the vertex set into two disjoint sets `A,B` such that there is only one edge going from A to B is fine.\n\nNathann",
    "created_at": "2015-06-14T14:30:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257950",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:38" align="right">comment:38</div>

> I think I have problems understanding which is the desired output. It is clear that if we have a directed cycle `(0,1,...,9)`, the connectivity is 1 (if we eliminate an edge, the graph will not be strongly connected anymore). However, I have problems understanding which sets of vertices we are looking for. For instance, if we cut `(0,1)`, should the two sets be `{1},{2,3,...,0}`, or maybe `{1,2,3},{4,5,...,9,0}`, or any division of the remaining graph in two components is fine?

Any partition of the vertex set into two disjoint sets `A,B` such that there is only one edge going from A to B is fine.

Nathann



---

archive/issue_comments_257951.json:
```json
{
    "body": "Changed commit from **[7481889](https://github.com/sagemath/sagetrac-mirror/commit/7481889e9795e22c5d7ea9b42335f14548c9c636)** to **[5d15475](https://github.com/sagemath/sagetrac-mirror/commit/5d15475d4591b889a057ae958b9ad095fa48a8e3)**",
    "created_at": "2015-06-15T10:23:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257951",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[7481889](https://github.com/sagemath/sagetrac-mirror/commit/7481889e9795e22c5d7ea9b42335f14548c9c636)** to **[5d15475](https://github.com/sagemath/sagetrac-mirror/commit/5d15475d4591b889a057ae958b9ad095fa48a8e3)**



---

archive/issue_comments_257952.json:
```json
{
    "body": "<div id=\"comment:39\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/178fa0937f20eb00371848dabffc443a29a18341\">178fa09</a></td><td><code>Edge connectivity through boost</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5d15475d4591b889a057ae958b9ad095fa48a8e3\">5d15475</a></td><td><code>More corrections of Boost edge connectivity.</code></td></tr></table>\n",
    "created_at": "2015-06-15T10:23:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257952",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:39"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/178fa0937f20eb00371848dabffc443a29a18341">178fa09</a></td><td><code>Edge connectivity through boost</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5d15475d4591b889a057ae958b9ad095fa48a8e3">5d15475</a></td><td><code>More corrections of Boost edge connectivity.</code></td></tr></table>




---

archive/issue_events_263923.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-15T10:44:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263923"
}
```



---

archive/issue_events_263924.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-15T10:44:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263924"
}
```



---

archive/issue_comments_257953.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nHelloooooo!\n\nI have corrected all the issues raised in previous messages. In particular:\n\n* I have sent an email to the Boost mailing list with the edge connectivity bug (at the moment it is waiting for moderation, I will link it asap);\n\n* I have removed trailing whitespaces;\n\n* I have added a doctest for directed Boost connectivity;\n\n* I have used Nathann's code from public/18564_merged.\n\nOnly issue that remains open: avoiding the huge copy-paste. Unfortunately, also structs and templates do not support fused types ![1]. As far as I understood, if we do not want to write C++ code, the only solution is to write a function for each task and for each graph type, then to create a \"generic\" function that inputs a fused type containing all Boost graphs (for instance, a function `num_vertices(BoostVecDiGraph)`, a function `num_vertices(BoostVecGraph)`, and a function `num_vertices(BoostFusedGraph)` wrapping the other two). With the number of vertices, this is not a big issue, but with `add_edge` it might be, because we also need variable `vertices`  (which translates Sagemath vertices into Boost vertices), and we cannot use a struct (it is not supported). This might result in a huge mess, which increases even more if we have to use constructs for the specific algorithm we are \"stealing\" from Boost. Is it really worth it, if in some time Cython might start supporting fused types in templates?\n\n![1] !https://groups.google.com/forum/#!topic/cython-users/qQpMo3hGQqI",
    "created_at": "2015-06-15T10:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257953",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:40" align="right">comment:40</div>

Helloooooo!

I have corrected all the issues raised in previous messages. In particular:

* I have sent an email to the Boost mailing list with the edge connectivity bug (at the moment it is waiting for moderation, I will link it asap);

* I have removed trailing whitespaces;

* I have added a doctest for directed Boost connectivity;

* I have used Nathann's code from public/18564_merged.

Only issue that remains open: avoiding the huge copy-paste. Unfortunately, also structs and templates do not support fused types ![1]. As far as I understood, if we do not want to write C++ code, the only solution is to write a function for each task and for each graph type, then to create a "generic" function that inputs a fused type containing all Boost graphs (for instance, a function `num_vertices(BoostVecDiGraph)`, a function `num_vertices(BoostVecGraph)`, and a function `num_vertices(BoostFusedGraph)` wrapping the other two). With the number of vertices, this is not a big issue, but with `add_edge` it might be, because we also need variable `vertices`  (which translates Sagemath vertices into Boost vertices), and we cannot use a struct (it is not supported). This might result in a huge mess, which increases even more if we have to use constructs for the specific algorithm we are "stealing" from Boost. Is it really worth it, if in some time Cython might start supporting fused types in templates?

![1] !https://groups.google.com/forum/#!topic/cython-users/qQpMo3hGQqI



---

archive/issue_comments_257954.json:
```json
{
    "body": "Changed commit from **[5d15475](https://github.com/sagemath/sagetrac-mirror/commit/5d15475d4591b889a057ae958b9ad095fa48a8e3)** to **[f3a1c07](https://github.com/sagemath/sagetrac-mirror/commit/f3a1c07f9d5c4a8b7830d2b624561f8ed5fc27f9)**",
    "created_at": "2015-06-18T10:18:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257954",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[5d15475](https://github.com/sagemath/sagetrac-mirror/commit/5d15475d4591b889a057ae958b9ad095fa48a8e3)** to **[f3a1c07](https://github.com/sagemath/sagetrac-mirror/commit/f3a1c07f9d5c4a8b7830d2b624561f8ed5fc27f9)**



---

archive/issue_comments_257955.json:
```json
{
    "body": "<div id=\"comment:41\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f3a1c07f9d5c4a8b7830d2b624561f8ed5fc27f9\">f3a1c07</a></td><td><code>Edge connectivity through Boost</code></td></tr></table>\n",
    "created_at": "2015-06-18T10:18:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257955",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:41"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f3a1c07f9d5c4a8b7830d2b624561f8ed5fc27f9">f3a1c07</a></td><td><code>Edge connectivity through Boost</code></td></tr></table>




---

archive/issue_comments_257956.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1 @@\n This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.\n-\n-Since in my preliminary coding I had several problems with generic types, I will only restrict to vector-stored adjacency lists, leaving genericity to a future ticket.\n``````\n",
    "created_at": "2015-06-18T10:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257956",
    "user": "https://github.com/sagetrac-borassi"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1 @@
 This is a first step in including Boost Graph Library (http://trac.sagemath.org/ticket/17966). I would like to implement the edge connectivity algorithm by converting a given Sage graph into a Boost graph, apply the Boost edge connectivity algorithm, and convert the result.
-
-Since in my preliminary coding I had several problems with generic types, I will only restrict to vector-stored adjacency lists, leaving genericity to a future ticket.
``````




---

archive/issue_events_263925.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-18T10:29:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263925"
}
```



---

archive/issue_events_263926.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-18T10:29:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263926"
}
```



---

archive/issue_comments_257957.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nHellooooooo!\n\nI summarize a discussion we had via email, dealing with the huge copy-paste. We found a way to avoid it: we created a C++ class boost_interface that interfaces Cython with Boost, and we used fused types to make generic functions accessing the C++ class.\n\nThe drawback is that we cannot access Boost graphs from Python anymore: Boost graphs must be defined and deleted in the same cdef function.\n\nThe advantage is that we can fully use the genericity of Boost, by calling any graph implementation we want.\n\nThe new code is available in this ticket's branch, while the old code is still available at `u/borassi/boost_edge_connectivity_not_generic`.\n\nI changed the status to needs_work, because I would like to test the code and the doctest a bit more before asking for a review (in particular, I would like to check if all previous comments are still applied).",
    "created_at": "2015-06-18T10:29:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257957",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:42" align="right">comment:42</div>

Hellooooooo!

I summarize a discussion we had via email, dealing with the huge copy-paste. We found a way to avoid it: we created a C++ class boost_interface that interfaces Cython with Boost, and we used fused types to make generic functions accessing the C++ class.

The drawback is that we cannot access Boost graphs from Python anymore: Boost graphs must be defined and deleted in the same cdef function.

The advantage is that we can fully use the genericity of Boost, by calling any graph implementation we want.

The new code is available in this ticket's branch, while the old code is still available at `u/borassi/boost_edge_connectivity_not_generic`.

I changed the status to needs_work, because I would like to test the code and the doctest a bit more before asking for a review (in particular, I would like to check if all previous comments are still applied).



---

archive/issue_comments_257958.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI like this new implementation. I assume it will be relativity easy to call other boost method the same way.",
    "created_at": "2015-06-18T10:33:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257958",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:43" align="right">comment:43</div>

I like this new implementation. I assume it will be relativity easy to call other boost method the same way.



---

archive/issue_comments_257959.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nThis comment needs to be expanded:\n\n```\nclass BoostGraph\n/*\n * This generic class wraps a Boost graph, in order to make it Cython-friendly.\n```\n\nFrom reading the code, I have no idea what is Cython-unfriendly.",
    "created_at": "2015-06-18T10:38:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257959",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

This comment needs to be expanded:

```
class BoostGraph
/*
 * This generic class wraps a Boost graph, in order to make it Cython-friendly.
```

From reading the code, I have no idea what is Cython-unfriendly.



---

archive/issue_comments_257960.json:
```json
{
    "body": "Changed commit from **[f3a1c07](https://github.com/sagemath/sagetrac-mirror/commit/f3a1c07f9d5c4a8b7830d2b624561f8ed5fc27f9)** to **[51a183a](https://github.com/sagemath/sagetrac-mirror/commit/51a183a065af09d203be1f01857b4045a1afee4d)**",
    "created_at": "2015-06-18T16:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257960",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f3a1c07](https://github.com/sagemath/sagetrac-mirror/commit/f3a1c07f9d5c4a8b7830d2b624561f8ed5fc27f9)** to **[51a183a](https://github.com/sagemath/sagetrac-mirror/commit/51a183a065af09d203be1f01857b4045a1afee4d)**



---

archive/issue_comments_257961.json:
```json
{
    "body": "<div id=\"comment:45\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51a183a065af09d203be1f01857b4045a1afee4d\">51a183a</a></td><td><code>Expanded the Cython-friendly comment, linked Boost ticket, removed trailing whitespaces</code></td></tr></table>\n",
    "created_at": "2015-06-18T16:46:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257961",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:45"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51a183a065af09d203be1f01857b4045a1afee4d">51a183a</a></td><td><code>Expanded the Cython-friendly comment, linked Boost ticket, removed trailing whitespaces</code></td></tr></table>




---

archive/issue_events_263927.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-18T16:50:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263927"
}
```



---

archive/issue_events_263928.json:
```json
{
    "actor": "https://github.com/sagetrac-borassi",
    "created_at": "2015-06-18T16:50:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263928"
}
```



---

archive/issue_comments_257962.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nHello!\n\nI have opened a Boost ticket on edge connectivity (https://svn.boost.org/trac/boost/ticket/11406), I have added this link in the documentation of our edge connectivity, I have expanded the comment as asked by jdemeyer, and I have corrected some small issues.\n\nI hope that now the code is correct!",
    "created_at": "2015-06-18T16:50:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257962",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:46" align="right">comment:46</div>

Hello!

I have opened a Boost ticket on edge connectivity (https://svn.boost.org/trac/boost/ticket/11406), I have added this link in the documentation of our edge connectivity, I have expanded the comment as asked by jdemeyer, and I have corrected some small issues.

I hope that now the code is correct!



---

archive/issue_comments_257963.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nHello,\n\nInstall OK, tests OK, docbuild OK, page `boost_graph.html` looks good (it will certainly be enriched in the future), and it is fast.\n\n```\nsage: G = graphs.Grid2dGraph(20,20)\nsage: %timeit G.edge_connectivity(boost=0)\n1 loops, best of 3: 724 ms per loop\nsage: %timeit G.edge_connectivity(boost=1)\n100 loops, best of 3: 5.86 ms per loop\n\nsage: G = graphs.RandomBarabasiAlbert(1000,2)\nsage: %timeit G.edge_connectivity(boost=0)\n1 loops, best of 3: 1.14 s per loop\nsage: %timeit G.edge_connectivity(boost=1)\n10 loops, best of 3: 41.4 ms per loop\n```\n\nFor me the patch is good to go. However, it would be better if an expert in C++/boost/etc. could check the patch before setting it to positive review.\n\nNice work anyway!\n\nDavid.",
    "created_at": "2015-06-19T17:28:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257963",
    "user": "https://github.com/dcoudert"
}
```

<div id="comment:47" align="right">comment:47</div>

Hello,

Install OK, tests OK, docbuild OK, page `boost_graph.html` looks good (it will certainly be enriched in the future), and it is fast.

```
sage: G = graphs.Grid2dGraph(20,20)
sage: %timeit G.edge_connectivity(boost=0)
1 loops, best of 3: 724 ms per loop
sage: %timeit G.edge_connectivity(boost=1)
100 loops, best of 3: 5.86 ms per loop

sage: G = graphs.RandomBarabasiAlbert(1000,2)
sage: %timeit G.edge_connectivity(boost=0)
1 loops, best of 3: 1.14 s per loop
sage: %timeit G.edge_connectivity(boost=1)
10 loops, best of 3: 41.4 ms per loop
```

For me the patch is good to go. However, it would be better if an expert in C++/boost/etc. could check the patch before setting it to positive review.

Nice work anyway!

David.



---

archive/issue_comments_257964.json:
```json
{
    "body": "Reviewer: **Nathann Cohen**",
    "created_at": "2015-06-21T09:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257964",
    "user": "https://github.com/nathanncohen"
}
```

Reviewer: **Nathann Cohen**



---

archive/issue_comments_257965.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nHelloooooo Michele,\n\nI made several modifications, available as a new commit at `public/18564`. All\nof them are, of course, open to discussion.\n\n- You don't need two 'pass' in the .pxd file\n\n- About the paragraphs at the top of `boost_graph.pyx`: I find them a bit\n  unclear. Could you be more specific in those sentences? For example (but not\n  only), I do not get the meaning of\n\n  ```\n  and they cannot be shared by different Python functions, because they cannot\n  be converted to Python objects.\n  ```\n\n- I opened a ticket at #18753 (you are its author) to indicate that the boost\n  bug had been reported upstream. That's part of a 'procedure' called 'stopgap',\n  precisely meant for those situations (see\n  http://doc.sagemath.org/html/en/developer/trac.html#stopgaps)\n\n  I also turned your 'print warning' into a stopgap message.\n\n- I reversed the names of `edge_connectivity` and `boost_edge_connectivity`: now\n  the `boost_edge_connectivity` function is the one which takes a boost graph as\n  argument.\n\n- The link toward `edge_connectivity` that you had added at the top of the\n  document was broken, for `edge_connectivity` was a cdef function in your\n  patch, and you cannot link (in Sphinx) toward cdef functions. When yo uwork on\n  the doc, you can compile it with `--warn-links` to spot broken links.\n\n- I shortened a bit the doc of some boost functions: some of the things you say\n  in the doc would be more appropriate as comments in the code.\n\n- in simple cases, it is easier to use `sig_check` than `sig_on/off`. A\n  `sig_check` is a way to check at a specific time whether an exception should\n  be raised. See\n  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling\n\n- I renamed 'boost=True' to 'implementation=\"boost\"', which is a bit more\n  'standard'. You may not know what 'boost' is, but you understand the meaning\n  of a 'implementation' selector.\n\nAgain, don't hesitate to oppose and discuss any of the changes in this commit,\nas you are the reviewer of them. You are supposed to be as picky as we are when\nwe review your code.\n\nIn my mind, the branch with this commit added is good to go, though perhaps the\ncomments to the top of `boost_graph.pyx` could be made clearer. That's up to\nyou.\n\nHave fun, and thank you very much again for this addition. Now that this is\nwritten, it will be *much* easier to steal more boost code `;-)`\n\nNathann",
    "created_at": "2015-06-21T09:41:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257965",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:48" align="right">comment:48</div>

Helloooooo Michele,

I made several modifications, available as a new commit at `public/18564`. All
of them are, of course, open to discussion.

- You don't need two 'pass' in the .pxd file

- About the paragraphs at the top of `boost_graph.pyx`: I find them a bit
  unclear. Could you be more specific in those sentences? For example (but not
  only), I do not get the meaning of

  ```
  and they cannot be shared by different Python functions, because they cannot
  be converted to Python objects.
  ```

- I opened a ticket at #18753 (you are its author) to indicate that the boost
  bug had been reported upstream. That's part of a 'procedure' called 'stopgap',
  precisely meant for those situations (see
  http://doc.sagemath.org/html/en/developer/trac.html#stopgaps)

  I also turned your 'print warning' into a stopgap message.

- I reversed the names of `edge_connectivity` and `boost_edge_connectivity`: now
  the `boost_edge_connectivity` function is the one which takes a boost graph as
  argument.

- The link toward `edge_connectivity` that you had added at the top of the
  document was broken, for `edge_connectivity` was a cdef function in your
  patch, and you cannot link (in Sphinx) toward cdef functions. When yo uwork on
  the doc, you can compile it with `--warn-links` to spot broken links.

- I shortened a bit the doc of some boost functions: some of the things you say
  in the doc would be more appropriate as comments in the code.

- in simple cases, it is easier to use `sig_check` than `sig_on/off`. A
  `sig_check` is a way to check at a specific time whether an exception should
  be raised. See
  http://www.sagemath.org/documentation/html/en/developer/coding_in_cython.html#interrupt-and-signal-handling

- I renamed 'boost=True' to 'implementation="boost"', which is a bit more
  'standard'. You may not know what 'boost' is, but you understand the meaning
  of a 'implementation' selector.

Again, don't hesitate to oppose and discuss any of the changes in this commit,
as you are the reviewer of them. You are supposed to be as picky as we are when
we review your code.

In my mind, the branch with this commit added is good to go, though perhaps the
comments to the top of `boost_graph.pyx` could be made clearer. That's up to
you.

Have fun, and thank you very much again for this addition. Now that this is
written, it will be *much* easier to steal more boost code `;-)`

Nathann



---

archive/issue_comments_257966.json:
```json
{
    "body": "<div id=\"comment:49\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9063cdc31fbaa5e4e7ac5f31c367ba5bf09f208e\">9063cdc</a></td><td><code>trac #18564: Merged with 6.8.beta5</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f0709aa5df62b6c266524099b9b6071b7c860bd0\">f0709aa</a></td><td><code>trac #18564: Reviewer's commit</code></td></tr></table>\n",
    "created_at": "2015-06-23T07:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257966",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9063cdc31fbaa5e4e7ac5f31c367ba5bf09f208e">9063cdc</a></td><td><code>trac #18564: Merged with 6.8.beta5</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f0709aa5df62b6c266524099b9b6071b7c860bd0">f0709aa</a></td><td><code>trac #18564: Reviewer's commit</code></td></tr></table>




---

archive/issue_comments_257967.json:
```json
{
    "body": "Changed commit from **[51a183a](https://github.com/sagemath/sagetrac-mirror/commit/51a183a065af09d203be1f01857b4045a1afee4d)** to **[f0709aa](https://github.com/sagemath/sagetrac-mirror/commit/f0709aa5df62b6c266524099b9b6071b7c860bd0)**",
    "created_at": "2015-06-23T07:35:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257967",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[51a183a](https://github.com/sagemath/sagetrac-mirror/commit/51a183a065af09d203be1f01857b4045a1afee4d)** to **[f0709aa](https://github.com/sagemath/sagetrac-mirror/commit/f0709aa5df62b6c266524099b9b6071b7c860bd0)**



---

archive/issue_comments_257968.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nHello!\nI have checked your code and included it into the current version. I have made a few modifications:\n\n* I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.\n* Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to \"`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`\" Thank you, Martin!\n* I have added some spaces at the bottom of boost_graph.pxd, so that different graph implementations are aligned.\n* Currently, our Boost code does not support edge labels. With the previous code, if we have used `\"implementation='boost',use_edge_labels=True\"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.\n* If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.\n\nAlso for me, now the patch is good to go!",
    "created_at": "2015-06-23T07:38:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257968",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:50" align="right">comment:50</div>

Hello!
I have checked your code and included it into the current version. I have made a few modifications:

* I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.
* Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to "`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`" Thank you, Martin!
* I have added some spaces at the bottom of boost_graph.pxd, so that different graph implementations are aligned.
* Currently, our Boost code does not support edge labels. With the previous code, if we have used `"implementation='boost',use_edge_labels=True"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.
* If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.

Also for me, now the patch is good to go!



---

archive/issue_comments_257969.json:
```json
{
    "body": "<div id=\"comment:51\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f\">fe55f76</a></td><td><code>Few more modifications</code></td></tr></table>\n",
    "created_at": "2015-06-23T07:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257969",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:51"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f">fe55f76</a></td><td><code>Few more modifications</code></td></tr></table>




---

archive/issue_comments_257970.json:
```json
{
    "body": "Changed commit from **[f0709aa](https://github.com/sagemath/sagetrac-mirror/commit/f0709aa5df62b6c266524099b9b6071b7c860bd0)** to **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)**",
    "created_at": "2015-06-23T07:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257970",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f0709aa](https://github.com/sagemath/sagetrac-mirror/commit/f0709aa5df62b6c266524099b9b6071b7c860bd0)** to **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)**



---

archive/issue_comments_257971.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nHello Michele,\n\n> * I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.\n\nThanks! That's better.\n\n> * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to \"`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`\" Thank you, Martin!\n\nOh. Does that mean that there is \"no bug\" in boost because they never claimed that it worked? If so, several things need to be done:\n1) Close the bug report on boost's trac, as it is invalid\n2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)\n3) Remove the stopgap warning from this branch's code\n4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs\n5) Raise an exception when 'boost' is requested to run on a directed graph.\n\n> * Currently, our Boost code does not support edge labels. With the previous code, if we have used `\"implementation='boost',use_edge_labels=True\"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.\n\nGood. I missed that `:-/`\n\n>    * If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.\n\nOKayyyyyyyyyyy.\n\nNathann",
    "created_at": "2015-06-23T08:10:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257971",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:52" align="right">comment:52</div>

Hello Michele,

> * I have tried to clarify a bit more the comment at the beginning of boost_graph.pyx.

Thanks! That's better.

> * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to "`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`" Thank you, Martin!

Oh. Does that mean that there is "no bug" in boost because they never claimed that it worked? If so, several things need to be done:
1) Close the bug report on boost's trac, as it is invalid
2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)
3) Remove the stopgap warning from this branch's code
4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs
5) Raise an exception when 'boost' is requested to run on a directed graph.

> * Currently, our Boost code does not support edge labels. With the previous code, if we have used `"implementation='boost',use_edge_labels=True"` the edge labels would simply have been ignored without a warning. Now, the algorithm raises an error.

Good. I missed that `:-/`

>    * If `num_edges()==0` and `vertices=True`, I have modified the output to return `[0,[],[[],[]]]`, that is `[edge_connectivity, edges, [first set of vertices, second set of vertices]]`.

OKayyyyyyyyyyy.

Nathann



---

archive/issue_comments_257972.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\n> > * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to \"`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`\" Thank you, Martin!\n> > \n\n> \n> Oh. Does that mean that there is \"no bug\" in boost because they never claimed that it worked? If so, several things need to be done:\n> 1) Close the bug report on boost's trac, as it is invalid\n> 2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)\n> 3) Remove the stopgap warning from this branch's code\n> 4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs\n> 5) Raise an exception when 'boost' is requested to run on a directed graph.\n\nWell, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!\n\nWhat do you think?\n\nThank you very much,\n\nMichele",
    "created_at": "2015-06-23T12:44:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257972",
    "user": "https://github.com/sagetrac-borassi"
}
```

<div id="comment:53" align="right">comment:53</div>

> > * Martin showed me that the Boost edge connectivity code actually tells that the input graph must be undirected (`Create a network flow graph out of the undirected graph FlowGraph flow_g(num_vertices(g))`). Hence, I changed the stopgap sentence to "`The edge connectivity of directed graphs is not implemented in Boost. The result may be mathematically unreliable.`" Thank you, Martin!
> > 

> 
> Oh. Does that mean that there is "no bug" in boost because they never claimed that it worked? If so, several things need to be done:
> 1) Close the bug report on boost's trac, as it is invalid
> 2) Change the milestone of our 'stopgap' ticket #18753 to invalid/wontfix (and status to positive review)
> 3) Remove the stopgap warning from this branch's code
> 4) Remove any claim that boost's algorithm is unreliable for directed graphs, and claim instead that it is only avilable for undirected graphs
> 5) Raise an exception when 'boost' is requested to run on a directed graph.

Well, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!

What do you think?

Thank you very much,

Michele



---

archive/issue_events_263929.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-23T13:10:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263929"
}
```



---

archive/issue_events_263930.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-23T13:10:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263930"
}
```



---

archive/issue_comments_257973.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\n> Well, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!\n> \n> What do you think?\n\nThat I trust your advice on this matter.\n\nGood to go! (and thank you very much for this first 'boost' addition)\n\nNathann",
    "created_at": "2015-06-23T13:10:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257973",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:54" align="right">comment:54</div>

> Well, not so fast! Martin told me that the edge connectivity is a work in progress, and that they might make it work on directed graph soon. Furthermore, I still think that the Boost code *has* a bug: the comment I mentioned is a line comment in the middle of the code, and a user does not necessarily read the whole code before using it! Furthermore, the comment does not say explicitly that they do not claim it works. For this reason, I have added a comment saying this in the Boost ticket, but I think we should leave the patch as it is, waiting for the final Boost edge connectivity!
> 
> What do you think?

That I trust your advice on this matter.

Good to go! (and thank you very much for this first 'boost' addition)

Nathann



---

archive/issue_events_263931.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-24T11:37:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263931"
}
```



---

archive/issue_events_263932.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "9cfb5f6f84c997c8d7d63d440b65c46b81208524",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-24T11:37:15Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18564#event-263932"
}
```



---

archive/issue_comments_257974.json:
```json
{
    "body": "Changed branch from **[u/borassi/boost_edge_connectivity](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_edge_connectivity)** to **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)**",
    "created_at": "2015-06-24T11:37:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257974",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/borassi/boost_edge_connectivity](https://github.com/sagemath/sagetrac-mirror/tree/u/borassi/boost_edge_connectivity)** to **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)**



---

archive/issue_comments_257975.json:
```json
{
    "body": "Changed commit from **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)** to none",
    "created_at": "2023-01-13T20:36:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18564",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18564#issuecomment-257975",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[fe55f76](https://github.com/sagemath/sagetrac-mirror/commit/fe55f76ef07c3d38b52f7b361a7a9a6fd512be9f)** to none
