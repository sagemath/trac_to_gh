# Issue 18443: Multiplier spectra for projective morphisms

archive/issues_018206.json:
```json
{
    "assignees": [],
    "body": "Implement a function to compute the n multiplier spectra, the set of multipliers of periodic points of formal period n, of a projective morphism. This currently only makes sense for morphisms over projective space of dimension 1.\n\nDepends on #18409\n\nCC:  @bhutz\n\nBranch/Commit: **[`6112c29`](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**\n\nReviewer: **Ben Hutz**\n\nAuthor: **Grayson Jorgenson**\n\nComponent: **algebraic geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18443_\n\n",
    "closed_at": "2015-06-17T07:42:42Z",
    "created_at": "2015-05-18T16:42:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Multiplier spectra for projective morphisms",
    "type": "issue",
    "updated_at": "2015-06-17T07:42:42Z",
    "url": "https://github.com/sagemath/sage/issues/18443",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```
Implement a function to compute the n multiplier spectra, the set of multipliers of periodic points of formal period n, of a projective morphism. This currently only makes sense for morphisms over projective space of dimension 1.

Depends on #18409

CC:  @bhutz

Branch/Commit: **[`6112c29`](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**

Reviewer: **Ben Hutz**

Author: **Grayson Jorgenson**

Component: **algebraic geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/18443_





---

archive/issue_events_262144.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262144"
}
```



---

archive/issue_events_262145.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "c: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262145"
}
```



---

archive/issue_events_262146.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262146"
}
```



---

archive/issue_events_262147.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262147"
}
```



---

archive/issue_comments_254372.json:
```json
{
    "body": "Branch: **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)**",
    "created_at": "2015-05-20T18:55:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254372",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

Branch: **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)**



---

archive/issue_comments_254373.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec\">e50b845</a></td><td><code>18443: added default values to documentation</code></td></tr></table>\n",
    "created_at": "2015-05-20T19:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254373",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec">e50b845</a></td><td><code>18443: added default values to documentation</code></td></tr></table>




---

archive/issue_comments_254374.json:
```json
{
    "body": "Commit: **[`e50b845`](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)**",
    "created_at": "2015-05-20T19:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254374",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[`e50b845`](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)**



---

archive/issue_events_262148.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-20T19:03:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262148"
}
```



---

archive/issue_events_262149.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-20T19:03:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262149"
}
```



---

archive/issue_events_262150.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-20T19:03:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262150"
}
```



---

archive/issue_events_262151.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-25T16:25:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262151"
}
```



---

archive/issue_events_262152.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-25T16:25:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262152"
}
```



---

archive/issue_comments_254375.json:
```json
{
    "body": "Reviewer: **Ben Hutz**",
    "created_at": "2015-05-25T16:25:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254375",
    "user": "https://github.com/bhutz"
}
```

Reviewer: **Ben Hutz**



---

archive/issue_comments_254376.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nA few things here, the big one is that the multiplier spectrum is defined with multiplicities. So if a perioidic point has multiplicity > 1 its multiplier should be repeated. Such as example should be added to the doc tests.\n\nOther minor issues:\n- a positive integer, the period.\n\n- numberfield -> number field\n\n- n = int(n)\n\n- change_ring now works for QQbar, so this is not needed\n\n```\nif not PS.base_ring() is QQbar:\n emb = PS.base_ring().embeddings(QQbar)[0]\n f = self.change_ring(QQbar,embedding=emb) # to be able to find all periodic points\nelse:\n f = self\n```\n\n- f.multiplier(P,n)[0][0] -> f.multiplier(P,n)[0,0]\n\n- multipliers.sort() -> not needed\n\n\n- sigma_invariants - 2nd senctence should say all periodic points. (same for INPUT)\n\n\n- from sage.combinat.sf.sf import SymmetricFunctions -> move to top\n\n- make len(multipliers) a constant in for loop",
    "created_at": "2015-05-25T16:25:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254376",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:4" align="right">comment:4</div>

A few things here, the big one is that the multiplier spectrum is defined with multiplicities. So if a perioidic point has multiplicity > 1 its multiplier should be repeated. Such as example should be added to the doc tests.

Other minor issues:
- a positive integer, the period.

- numberfield -> number field

- n = int(n)

- change_ring now works for QQbar, so this is not needed

```
if not PS.base_ring() is QQbar:
 emb = PS.base_ring().embeddings(QQbar)[0]
 f = self.change_ring(QQbar,embedding=emb) # to be able to find all periodic points
else:
 f = self
```

- f.multiplier(P,n)[0][0] -> f.multiplier(P,n)[0,0]

- multipliers.sort() -> not needed


- sigma_invariants - 2nd senctence should say all periodic points. (same for INPUT)


- from sage.combinat.sf.sf import SymmetricFunctions -> move to top

- make len(multipliers) a constant in for loop



---

archive/issue_comments_254377.json:
```json
{
    "body": "<div id=\"comment:5\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3\">cc8b735</a></td><td><code>18443: Implemented changes from review.</code></td></tr></table>\n",
    "created_at": "2015-05-27T15:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254377",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:5"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3">cc8b735</a></td><td><code>18443: Implemented changes from review.</code></td></tr></table>




---

archive/issue_comments_254378.json:
```json
{
    "body": "Changed commit from **[`e50b845`](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)** to **[`cc8b735`](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)**",
    "created_at": "2015-05-27T15:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254378",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`e50b845`](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)** to **[`cc8b735`](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)**



---

archive/issue_comments_254379.json:
```json
{
    "body": "<div id=\"comment:6\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab5c82e0c35cf71097401c6a0b1444fe42582d51\">ab5c82e</a></td><td><code>18443: Merged with latest beta</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a\">3333f6a</a></td><td><code>18443: implemented last change from reivew</code></td></tr></table>\n",
    "created_at": "2015-05-27T20:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254379",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:6"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab5c82e0c35cf71097401c6a0b1444fe42582d51">ab5c82e</a></td><td><code>18443: Merged with latest beta</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a">3333f6a</a></td><td><code>18443: implemented last change from reivew</code></td></tr></table>




---

archive/issue_comments_254380.json:
```json
{
    "body": "Changed commit from **[`cc8b735`](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)** to **[`3333f6a`](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)**",
    "created_at": "2015-05-27T20:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254380",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cc8b735`](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)** to **[`3333f6a`](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)**



---

archive/issue_events_262153.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-27T20:27:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262153"
}
```



---

archive/issue_events_262154.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-27T20:27:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262154"
}
```



---

archive/issue_events_262155.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-30T14:12:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262155"
}
```



---

archive/issue_events_262156.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-30T14:12:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262156"
}
```



---

archive/issue_comments_254381.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nA couple things in multiplier_spectrum\n\n- you should check that the domain is projective space to avoid subschemes\n\n- K = f._number_field_from_algebraics() should be outside the if\n\n- if [1,0] is a point of multplicity you will miss this (You also only check if it is fixed not n-periodic). You could instead see if the poly F is of the form `y^m*G(x,y)` for some poly G, then m is the multplicity of [1,0].\n\n- it doesn't seem like your conversion to QQbar is working. Trying your number field example, when the map is actually defined over a number field\n\n```\nsage: set_verbose(None)\nsage: z = QQ['z'].0\nsage: K.<w> = NumberField(z^4 - 4*z^2 + 1)\nsage: P.<x,y> = ProjectiveSpace(K,1)\nsage: H = End(P)\nsage: f = H([x^2 - w/4*y^2,y^2])\nsage: f.multiplier_spectra(2,False)\n```\n\nNot sure exactly what you should do here. One option is to get change_ring for polynomials to deal with QQbar, by passing in and/or creating an embedding. If you look in schemes.generic.morphism.SchemeMorphism_polynomial.change_ring() it gives a simple way to construct a hom of polynomials given a hom of the base rings. It does appear that the change_ring of the parent is working, so you probably just need to create the hom between the poly rings and apply it to the element to be changed.",
    "created_at": "2015-05-30T14:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254381",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:8" align="right">comment:8</div>

A couple things in multiplier_spectrum

- you should check that the domain is projective space to avoid subschemes

- K = f._number_field_from_algebraics() should be outside the if

- if [1,0] is a point of multplicity you will miss this (You also only check if it is fixed not n-periodic). You could instead see if the poly F is of the form `y^m*G(x,y)` for some poly G, then m is the multplicity of [1,0].

- it doesn't seem like your conversion to QQbar is working. Trying your number field example, when the map is actually defined over a number field

```
sage: set_verbose(None)
sage: z = QQ['z'].0
sage: K.<w> = NumberField(z^4 - 4*z^2 + 1)
sage: P.<x,y> = ProjectiveSpace(K,1)
sage: H = End(P)
sage: f = H([x^2 - w/4*y^2,y^2])
sage: f.multiplier_spectra(2,False)
```

Not sure exactly what you should do here. One option is to get change_ring for polynomials to deal with QQbar, by passing in and/or creating an embedding. If you look in schemes.generic.morphism.SchemeMorphism_polynomial.change_ring() it gives a simple way to construct a hom of polynomials given a hom of the base rings. It does appear that the change_ring of the parent is working, so you probably just need to create the hom between the poly rings and apply it to the element to be changed.



---

archive/issue_comments_254382.json:
```json
{
    "body": "Changed commit from **[`3333f6a`](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)** to **[`71d1123`](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)**",
    "created_at": "2015-06-08T19:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254382",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3333f6a`](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)** to **[`71d1123`](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)**



---

archive/issue_comments_254383.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd\">71d1123</a></td><td><code>18443: implemented changes from second review</code></td></tr></table>\n",
    "created_at": "2015-06-08T19:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254383",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd">71d1123</a></td><td><code>18443: implemented changes from second review</code></td></tr></table>




---

archive/issue_comments_254384.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nFor the formal==True case I used the technique in the morphism change_ring function to create the homomorphism between polynomial rings to use on F and this seems to have addressed the issues so far. For the formal==False case, the conversion already seemed to be working, but  the _number_field_from_algebraics version of the map wasn't needed for finding roots.\n\nI found another problem though:\n\n```\nP.<x,y> = ProjectiveSpace(QQ,1)\nH = End(P)\nf = H([x^2 - 3/4*y^2,y^2])\nf.multiplier_spectra(2)\n```\n\ngives [1,1] back which isn't correct.\n\nI didn\u2019t catch this before, but multiplier_spectra should only return [1] here, because there is only one two cycle. The collapsing causes this two cycle to turn into a root of multiplicity 2 of the dynatomic polynomial, so the algorithm I use to pick representatives from cycles doesn\u2019t work.\n\nI will implement a fix attempt for this next, but I wanted to push up the current commit before doing so.",
    "created_at": "2015-06-08T20:02:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254384",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<div id="comment:10" align="right">comment:10</div>

For the formal==True case I used the technique in the morphism change_ring function to create the homomorphism between polynomial rings to use on F and this seems to have addressed the issues so far. For the formal==False case, the conversion already seemed to be working, but  the _number_field_from_algebraics version of the map wasn't needed for finding roots.

I found another problem though:

```
P.<x,y> = ProjectiveSpace(QQ,1)
H = End(P)
f = H([x^2 - 3/4*y^2,y^2])
f.multiplier_spectra(2)
```

gives [1,1] back which isn't correct.

I didn’t catch this before, but multiplier_spectra should only return [1] here, because there is only one two cycle. The collapsing causes this two cycle to turn into a root of multiplicity 2 of the dynatomic polynomial, so the algorithm I use to pick representatives from cycles doesn’t work.

I will implement a fix attempt for this next, but I wanted to push up the current commit before doing so.



---

archive/issue_comments_254385.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nFor `x^2-3/4`, what you have are *no* 2-cycles. There are 2 formal 2-periodic points, but they are a doubled fixed point. So, I'm not sure [1,1] is incorrect in this case. Why do you think this is wrong?",
    "created_at": "2015-06-09T01:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254385",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:11" align="right">comment:11</div>

For `x^2-3/4`, what you have are *no* 2-cycles. There are 2 formal 2-periodic points, but they are a doubled fixed point. So, I'm not sure [1,1] is incorrect in this case. Why do you think this is wrong?



---

archive/issue_comments_254386.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI thought getting [1,1] back was messing up the resulting elementary symmetric polynomial. For the other `x^2 + c`, the formal 2-multiplier spectra consists of one multiplier and so there is only one elementary symmetric polynomial, `sigma_{1}^{(2)} = sigma_2 + 4`. For `x^2 - 3/4`, if we use [1,1] we have an extra multiplier, and `sigma_{1}^{(2)} = 1+1 = 2` when we expect `sigma_{1}^{(2)} = sigma_2 + 4 = 1`. \n\nI was thinking that it might be better to treat the doubled fixed point as a single 2-cycle so that we only get one multiplier. Would that work?",
    "created_at": "2015-06-09T05:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254386",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<div id="comment:12" align="right">comment:12</div>

I thought getting [1,1] back was messing up the resulting elementary symmetric polynomial. For the other `x^2 + c`, the formal 2-multiplier spectra consists of one multiplier and so there is only one elementary symmetric polynomial, `sigma_{1}^{(2)} = sigma_2 + 4`. For `x^2 - 3/4`, if we use [1,1] we have an extra multiplier, and `sigma_{1}^{(2)} = 1+1 = 2` when we expect `sigma_{1}^{(2)} = sigma_2 + 4 = 1`. 

I was thinking that it might be better to treat the doubled fixed point as a single 2-cycle so that we only get one multiplier. Would that work?



---

archive/issue_comments_254387.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nhmm...yes I see your point. I think having the correct number of multipliers so that the elementary symmetric polynomials are continuous as they are supposed to be would be the correct approach.",
    "created_at": "2015-06-09T14:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254387",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:13" align="right">comment:13</div>

hmm...yes I see your point. I think having the correct number of multipliers so that the elementary symmetric polynomials are continuous as they are supposed to be would be the correct approach.



---

archive/issue_comments_254388.json:
```json
{
    "body": "Changed commit from **[`71d1123`](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)** to **[`3aca932`](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)**",
    "created_at": "2015-06-10T03:30:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254388",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`71d1123`](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)** to **[`3aca932`](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)**



---

archive/issue_comments_254389.json:
```json
{
    "body": "<div id=\"comment:14\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88\">3aca932</a></td><td><code>18443: attempt to adapt algorithm for selecting cycle representatives</code></td></tr></table>\n",
    "created_at": "2015-06-10T03:30:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254389",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:14"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88">3aca932</a></td><td><code>18443: attempt to adapt algorithm for selecting cycle representatives</code></td></tr></table>




---

archive/issue_comments_254390.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI modified the selection loop slightly so now there's no break when iterating points to find their cycles. I think this will address the issue of extra representative points for collapsed cycles, and shouldn't change anything for maps with no collapsing.",
    "created_at": "2015-06-10T03:42:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254390",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<div id="comment:15" align="right">comment:15</div>

I modified the selection loop slightly so now there's no break when iterating points to find their cycles. I think this will address the issue of extra representative points for collapsed cycles, and shouldn't change anything for maps with no collapsing.



---

archive/issue_events_262157.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-10T03:42:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262157"
}
```



---

archive/issue_events_262158.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-10T03:42:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262158"
}
```



---

archive/issue_events_262159.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-11T15:12:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262159"
}
```



---

archive/issue_events_262160.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-11T15:12:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262160"
}
```



---

archive/issue_comments_254391.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nJust a couple very minor things here. You should actually convert n, not just check the conversion. ie. use ``n=int(n)``\n\nAlso, I'd rather not have you accessing the ._polys list directly. Instead you can use G[0], G[1], etc.\n\nFinally, I'd like to see an example with multiplicities.\n\nI see you directly implemented the QQbar change ring for the dynatomic polynomial. I still think the .change_ring() should be fixed as well, but that can be done in a different ticket.",
    "created_at": "2015-06-11T15:12:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254391",
    "user": "https://github.com/bhutz"
}
```

<div id="comment:16" align="right">comment:16</div>

Just a couple very minor things here. You should actually convert n, not just check the conversion. ie. use ``n=int(n)``

Also, I'd rather not have you accessing the ._polys list directly. Instead you can use G[0], G[1], etc.

Finally, I'd like to see an example with multiplicities.

I see you directly implemented the QQbar change ring for the dynatomic polynomial. I still think the .change_ring() should be fixed as well, but that can be done in a different ticket.



---

archive/issue_comments_254392.json:
```json
{
    "body": "Changed commit from **[`3aca932`](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)** to **[`6112c29`](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**",
    "created_at": "2015-06-12T22:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254392",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`3aca932`](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)** to **[`6112c29`](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**



---

archive/issue_comments_254393.json:
```json
{
    "body": "<div id=\"comment:17\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893\">6112c29</a></td><td><code>18443: minor changes and new example</code></td></tr></table>\n",
    "created_at": "2015-06-12T22:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254393",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893">6112c29</a></td><td><code>18443: minor changes and new example</code></td></tr></table>




---

archive/issue_events_262161.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-12T22:19:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262161"
}
```



---

archive/issue_events_262162.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-12T22:19:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262162"
}
```



---

archive/issue_comments_254394.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI added an example using `x^2 - 7/4` which has a collapsed 3-cycle. I left the `x^2 -3/4` example in to illustrate that the doubled fixed point is treated as one 2-cycle, but I can remove it if it seems unnecessary.",
    "created_at": "2015-06-12T22:19:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254394",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<div id="comment:18" align="right">comment:18</div>

I added an example using `x^2 - 7/4` which has a collapsed 3-cycle. I left the `x^2 -3/4` example in to illustrate that the doubled fixed point is treated as one 2-cycle, but I can remove it if it seems unnecessary.



---

archive/issue_events_262163.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-15T19:19:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262163"
}
```



---

archive/issue_events_262164.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-15T19:19:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262164"
}
```



---

archive/issue_events_262165.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-17T07:42:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262165"
}
```



---

archive/issue_events_262166.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "628cfb274b979c02428108ff30b3ec7fd50c9bec",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-17T07:42:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-262166"
}
```



---

archive/issue_comments_254395.json:
```json
{
    "body": "Changed branch from **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)** to **[`6112c29`](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**",
    "created_at": "2015-06-17T07:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-254395",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)** to **[`6112c29`](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**
