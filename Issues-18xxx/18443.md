# Issue 18443: Multiplier spectra for projective morphisms

archive/issues_018206.json:
```json
{
    "assignees": [],
    "body": "Implement a function to compute the n multiplier spectra, the set of multipliers of periodic points of formal period n, of a projective morphism. This currently only makes sense for morphisms over projective space of dimension 1.\n\nDepends on #18409\n\nCC:  @bhutz\n\nBranch/Commit: **[6112c29](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**\n\nReviewer: **Ben Hutz**\n\nAuthor: **Grayson Jorgenson**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18443_\n\n",
    "closed_at": "2015-06-17T07:42:42Z",
    "created_at": "2015-05-18T16:42:11Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Multiplier spectra for projective morphisms",
    "type": "issue",
    "updated_at": "2015-06-17T07:42:42Z",
    "url": "https://github.com/sagemath/sage/issues/18443",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```
Implement a function to compute the n multiplier spectra, the set of multipliers of periodic points of formal period n, of a projective morphism. This currently only makes sense for morphisms over projective space of dimension 1.

Depends on #18409

CC:  @bhutz

Branch/Commit: **[6112c29](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**

Reviewer: **Ben Hutz**

Author: **Grayson Jorgenson**

_Issue created by migration from https://trac.sagemath.org/ticket/18443_





---

archive/issue_events_235592.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235592"
}
```



---

archive/issue_events_235593.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebraic%20geometry",
    "label_color": "0000ff",
    "label_name": "component: algebraic geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235593"
}
```



---

archive/issue_events_235594.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235594"
}
```



---

archive/issue_events_235595.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-18T16:42:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235595"
}
```



---

archive/issue_comments_256885.json:
```json
{
    "body": "Branch: **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)**",
    "created_at": "2015-05-20T18:55:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256885",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

Branch: **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)**



---

archive/issue_comments_256886.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec\">e50b845</a></td><td><code>18443: added default values to documentation</code></td></tr></table>\n",
    "created_at": "2015-05-20T19:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256886",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:2'>Comment 2:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec">e50b845</a></td><td><code>18443: added default values to documentation</code></td></tr></table>




---

archive/issue_comments_256887.json:
```json
{
    "body": "Commit: **[e50b845](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)**",
    "created_at": "2015-05-20T19:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256887",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[e50b845](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)**



---

archive/issue_events_235596.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-20T19:03:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235596"
}
```



---

archive/issue_events_235597.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-20T19:03:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235597"
}
```



---

archive/issue_events_235598.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-20T19:03:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235598"
}
```



---

archive/issue_events_235599.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-25T16:25:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235599"
}
```



---

archive/issue_events_235600.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-25T16:25:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235600"
}
```



---

archive/issue_comments_256888.json:
```json
{
    "body": "Reviewer: **Ben Hutz**",
    "created_at": "2015-05-25T16:25:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256888",
    "user": "https://github.com/bhutz"
}
```

Reviewer: **Ben Hutz**



---

archive/issue_comments_256889.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nA few things here, the big one is that the multiplier spectrum is defined with multiplicities. So if a perioidic point has multiplicity > 1 its multiplier should be repeated. Such as example should be added to the doc tests.\n\nOther minor issues:\n- a positive integer, the period.\n\n- numberfield -> number field\n\n- n = int(n)\n\n- change_ring now works for QQbar, so this is not needed\n\n```\nif not PS.base_ring() is QQbar:\n emb = PS.base_ring().embeddings(QQbar)[0]\n f = self.change_ring(QQbar,embedding=emb) # to be able to find all periodic points\nelse:\n f = self\n```\n\n- f.multiplier(P,n)[0][0] -> f.multiplier(P,n)[0,0]\n\n- multipliers.sort() -> not needed\n\n\n- sigma_invariants - 2nd senctence should say all periodic points. (same for INPUT)\n\n\n- from sage.combinat.sf.sf import SymmetricFunctions -> move to top\n\n- make len(multipliers) a constant in for loop",
    "created_at": "2015-05-25T16:25:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256889",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:4'>Comment 4:</a>
A few things here, the big one is that the multiplier spectrum is defined with multiplicities. So if a perioidic point has multiplicity > 1 its multiplier should be repeated. Such as example should be added to the doc tests.

Other minor issues:
- a positive integer, the period.

- numberfield -> number field

- n = int(n)

- change_ring now works for QQbar, so this is not needed

```
if not PS.base_ring() is QQbar:
 emb = PS.base_ring().embeddings(QQbar)[0]
 f = self.change_ring(QQbar,embedding=emb) # to be able to find all periodic points
else:
 f = self
```

- f.multiplier(P,n)[0][0] -> f.multiplier(P,n)[0,0]

- multipliers.sort() -> not needed


- sigma_invariants - 2nd senctence should say all periodic points. (same for INPUT)


- from sage.combinat.sf.sf import SymmetricFunctions -> move to top

- make len(multipliers) a constant in for loop



---

archive/issue_comments_256890.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3\">cc8b735</a></td><td><code>18443: Implemented changes from review.</code></td></tr></table>\n",
    "created_at": "2015-05-27T15:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256890",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:5'>Comment 5:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3">cc8b735</a></td><td><code>18443: Implemented changes from review.</code></td></tr></table>




---

archive/issue_comments_256891.json:
```json
{
    "body": "Changed commit from **[e50b845](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)** to **[cc8b735](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)**",
    "created_at": "2015-05-27T15:58:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256891",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e50b845](https://github.com/sagemath/sagetrac-mirror/commit/e50b845d28353d49ef546a5d23d9b324116b9cec)** to **[cc8b735](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)**



---

archive/issue_comments_256892.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ab5c82e0c35cf71097401c6a0b1444fe42582d51\">ab5c82e</a></td><td><code>18443: Merged with latest beta</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a\">3333f6a</a></td><td><code>18443: implemented last change from reivew</code></td></tr></table>\n",
    "created_at": "2015-05-27T20:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256892",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ab5c82e0c35cf71097401c6a0b1444fe42582d51">ab5c82e</a></td><td><code>18443: Merged with latest beta</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a">3333f6a</a></td><td><code>18443: implemented last change from reivew</code></td></tr></table>




---

archive/issue_comments_256893.json:
```json
{
    "body": "Changed commit from **[cc8b735](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)** to **[3333f6a](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)**",
    "created_at": "2015-05-27T20:25:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256893",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[cc8b735](https://github.com/sagemath/sagetrac-mirror/commit/cc8b735281e6af9721a92c7850567a36574ec8c3)** to **[3333f6a](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)**



---

archive/issue_events_235601.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-27T20:27:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235601"
}
```



---

archive/issue_events_235602.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-05-27T20:27:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235602"
}
```



---

archive/issue_events_235603.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-30T14:12:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235603"
}
```



---

archive/issue_events_235604.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-05-30T14:12:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235604"
}
```



---

archive/issue_comments_256894.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nA couple things in multiplier_spectrum\n\n- you should check that the domain is projective space to avoid subschemes\n\n- K = f._number_field_from_algebraics() should be outside the if\n\n- if [1,0] is a point of multplicity you will miss this (You also only check if it is fixed not n-periodic). You could instead see if the poly F is of the form `y^m*G(x,y)` for some poly G, then m is the multplicity of [1,0].\n\n- it doesn't seem like your conversion to QQbar is working. Trying your number field example, when the map is actually defined over a number field\n\n```\nsage: set_verbose(None)\nsage: z = QQ['z'].0\nsage: K.<w> = NumberField(z^4 - 4*z^2 + 1)\nsage: P.<x,y> = ProjectiveSpace(K,1)\nsage: H = End(P)\nsage: f = H([x^2 - w/4*y^2,y^2])\nsage: f.multiplier_spectra(2,False)\n```\n\nNot sure exactly what you should do here. One option is to get change_ring for polynomials to deal with QQbar, by passing in and/or creating an embedding. If you look in schemes.generic.morphism.SchemeMorphism_polynomial.change_ring() it gives a simple way to construct a hom of polynomials given a hom of the base rings. It does appear that the change_ring of the parent is working, so you probably just need to create the hom between the poly rings and apply it to the element to be changed.",
    "created_at": "2015-05-30T14:12:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256894",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:8'>Comment 8:</a>
A couple things in multiplier_spectrum

- you should check that the domain is projective space to avoid subschemes

- K = f._number_field_from_algebraics() should be outside the if

- if [1,0] is a point of multplicity you will miss this (You also only check if it is fixed not n-periodic). You could instead see if the poly F is of the form `y^m*G(x,y)` for some poly G, then m is the multplicity of [1,0].

- it doesn't seem like your conversion to QQbar is working. Trying your number field example, when the map is actually defined over a number field

```
sage: set_verbose(None)
sage: z = QQ['z'].0
sage: K.<w> = NumberField(z^4 - 4*z^2 + 1)
sage: P.<x,y> = ProjectiveSpace(K,1)
sage: H = End(P)
sage: f = H([x^2 - w/4*y^2,y^2])
sage: f.multiplier_spectra(2,False)
```

Not sure exactly what you should do here. One option is to get change_ring for polynomials to deal with QQbar, by passing in and/or creating an embedding. If you look in schemes.generic.morphism.SchemeMorphism_polynomial.change_ring() it gives a simple way to construct a hom of polynomials given a hom of the base rings. It does appear that the change_ring of the parent is working, so you probably just need to create the hom between the poly rings and apply it to the element to be changed.



---

archive/issue_comments_256895.json:
```json
{
    "body": "Changed commit from **[3333f6a](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)** to **[71d1123](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)**",
    "created_at": "2015-06-08T19:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256895",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3333f6a](https://github.com/sagemath/sagetrac-mirror/commit/3333f6a4115954aa3a5e3e209e35e8b104ac160a)** to **[71d1123](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)**



---

archive/issue_comments_256896.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd\">71d1123</a></td><td><code>18443: implemented changes from second review</code></td></tr></table>\n",
    "created_at": "2015-06-08T19:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256896",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:9'>Comment 9:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd">71d1123</a></td><td><code>18443: implemented changes from second review</code></td></tr></table>




---

archive/issue_comments_256897.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nFor the formal==True case I used the technique in the morphism change_ring function to create the homomorphism between polynomial rings to use on F and this seems to have addressed the issues so far. For the formal==False case, the conversion already seemed to be working, but  the _number_field_from_algebraics version of the map wasn't needed for finding roots.\n\nI found another problem though:\n\n```\nP.<x,y> = ProjectiveSpace(QQ,1)\nH = End(P)\nf = H([x^2 - 3/4*y^2,y^2])\nf.multiplier_spectra(2)\n```\n\ngives [1,1] back which isn't correct.\n\nI didn\u2019t catch this before, but multiplier_spectra should only return [1] here, because there is only one two cycle. The collapsing causes this two cycle to turn into a root of multiplicity 2 of the dynatomic polynomial, so the algorithm I use to pick representatives from cycles doesn\u2019t work.\n\nI will implement a fix attempt for this next, but I wanted to push up the current commit before doing so.",
    "created_at": "2015-06-08T20:02:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256897",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:10'>Comment 10:</a>
For the formal==True case I used the technique in the morphism change_ring function to create the homomorphism between polynomial rings to use on F and this seems to have addressed the issues so far. For the formal==False case, the conversion already seemed to be working, but  the _number_field_from_algebraics version of the map wasn't needed for finding roots.

I found another problem though:

```
P.<x,y> = ProjectiveSpace(QQ,1)
H = End(P)
f = H([x^2 - 3/4*y^2,y^2])
f.multiplier_spectra(2)
```

gives [1,1] back which isn't correct.

I didn’t catch this before, but multiplier_spectra should only return [1] here, because there is only one two cycle. The collapsing causes this two cycle to turn into a root of multiplicity 2 of the dynatomic polynomial, so the algorithm I use to pick representatives from cycles doesn’t work.

I will implement a fix attempt for this next, but I wanted to push up the current commit before doing so.



---

archive/issue_comments_256898.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nFor `x^2-3/4`, what you have are *no* 2-cycles. There are 2 formal 2-periodic points, but they are a doubled fixed point. So, I'm not sure [1,1] is incorrect in this case. Why do you think this is wrong?",
    "created_at": "2015-06-09T01:50:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256898",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:11'>Comment 11:</a>
For `x^2-3/4`, what you have are *no* 2-cycles. There are 2 formal 2-periodic points, but they are a doubled fixed point. So, I'm not sure [1,1] is incorrect in this case. Why do you think this is wrong?



---

archive/issue_comments_256899.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nI thought getting [1,1] back was messing up the resulting elementary symmetric polynomial. For the other `x^2 + c`, the formal 2-multiplier spectra consists of one multiplier and so there is only one elementary symmetric polynomial, `sigma_{1}^{(2)} = sigma_2 + 4`. For `x^2 - 3/4`, if we use [1,1] we have an extra multiplier, and `sigma_{1}^{(2)} = 1+1 = 2` when we expect `sigma_{1}^{(2)} = sigma_2 + 4 = 1`. \n\nI was thinking that it might be better to treat the doubled fixed point as a single 2-cycle so that we only get one multiplier. Would that work?",
    "created_at": "2015-06-09T05:10:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256899",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:12'>Comment 12:</a>
I thought getting [1,1] back was messing up the resulting elementary symmetric polynomial. For the other `x^2 + c`, the formal 2-multiplier spectra consists of one multiplier and so there is only one elementary symmetric polynomial, `sigma_{1}^{(2)} = sigma_2 + 4`. For `x^2 - 3/4`, if we use [1,1] we have an extra multiplier, and `sigma_{1}^{(2)} = 1+1 = 2` when we expect `sigma_{1}^{(2)} = sigma_2 + 4 = 1`. 

I was thinking that it might be better to treat the doubled fixed point as a single 2-cycle so that we only get one multiplier. Would that work?



---

archive/issue_comments_256900.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nhmm...yes I see your point. I think having the correct number of multipliers so that the elementary symmetric polynomials are continuous as they are supposed to be would be the correct approach.",
    "created_at": "2015-06-09T14:42:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256900",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:13'>Comment 13:</a>
hmm...yes I see your point. I think having the correct number of multipliers so that the elementary symmetric polynomials are continuous as they are supposed to be would be the correct approach.



---

archive/issue_comments_256901.json:
```json
{
    "body": "Changed commit from **[71d1123](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)** to **[3aca932](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)**",
    "created_at": "2015-06-10T03:30:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256901",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[71d1123](https://github.com/sagemath/sagetrac-mirror/commit/71d1123d488ff029e34f50600554aa4fd5be32cd)** to **[3aca932](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)**



---

archive/issue_comments_256902.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88\">3aca932</a></td><td><code>18443: attempt to adapt algorithm for selecting cycle representatives</code></td></tr></table>\n",
    "created_at": "2015-06-10T03:30:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256902",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:14'>Comment 14:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88">3aca932</a></td><td><code>18443: attempt to adapt algorithm for selecting cycle representatives</code></td></tr></table>




---

archive/issue_comments_256903.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nI modified the selection loop slightly so now there's no break when iterating points to find their cycles. I think this will address the issue of extra representative points for collapsed cycles, and shouldn't change anything for maps with no collapsing.",
    "created_at": "2015-06-10T03:42:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256903",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:15'>Comment 15:</a>
I modified the selection loop slightly so now there's no break when iterating points to find their cycles. I think this will address the issue of extra representative points for collapsed cycles, and shouldn't change anything for maps with no collapsing.



---

archive/issue_events_235605.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-10T03:42:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235605"
}
```



---

archive/issue_events_235606.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-10T03:42:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235606"
}
```



---

archive/issue_events_235607.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-11T15:12:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235607"
}
```



---

archive/issue_events_235608.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-11T15:12:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235608"
}
```



---

archive/issue_comments_256904.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nJust a couple very minor things here. You should actually convert n, not just check the conversion. ie. use ``n=int(n)``\n\nAlso, I'd rather not have you accessing the ._polys list directly. Instead you can use G[0], G[1], etc.\n\nFinally, I'd like to see an example with multiplicities.\n\nI see you directly implemented the QQbar change ring for the dynatomic polynomial. I still think the .change_ring() should be fixed as well, but that can be done in a different ticket.",
    "created_at": "2015-06-11T15:12:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256904",
    "user": "https://github.com/bhutz"
}
```

<a id='comment:16'>Comment 16:</a>
Just a couple very minor things here. You should actually convert n, not just check the conversion. ie. use ``n=int(n)``

Also, I'd rather not have you accessing the ._polys list directly. Instead you can use G[0], G[1], etc.

Finally, I'd like to see an example with multiplicities.

I see you directly implemented the QQbar change ring for the dynatomic polynomial. I still think the .change_ring() should be fixed as well, but that can be done in a different ticket.



---

archive/issue_comments_256905.json:
```json
{
    "body": "Changed commit from **[3aca932](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)** to **[6112c29](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**",
    "created_at": "2015-06-12T22:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256905",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[3aca932](https://github.com/sagemath/sagetrac-mirror/commit/3aca932972ebf48911a05bcfef34d248b7a33e88)** to **[6112c29](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**



---

archive/issue_comments_256906.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893\">6112c29</a></td><td><code>18443: minor changes and new example</code></td></tr></table>\n",
    "created_at": "2015-06-12T22:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256906",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:17'>Comment 17:</a>
Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893">6112c29</a></td><td><code>18443: minor changes and new example</code></td></tr></table>




---

archive/issue_events_235609.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-12T22:19:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235609"
}
```



---

archive/issue_events_235610.json:
```json
{
    "actor": "https://github.com/sagetrac-gjorgenson",
    "created_at": "2015-06-12T22:19:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235610"
}
```



---

archive/issue_comments_256907.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nI added an example using `x^2 - 7/4` which has a collapsed 3-cycle. I left the `x^2 -3/4` example in to illustrate that the doubled fixed point is treated as one 2-cycle, but I can remove it if it seems unnecessary.",
    "created_at": "2015-06-12T22:19:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256907",
    "user": "https://github.com/sagetrac-gjorgenson"
}
```

<a id='comment:18'>Comment 18:</a>
I added an example using `x^2 - 7/4` which has a collapsed 3-cycle. I left the `x^2 -3/4` example in to illustrate that the doubled fixed point is treated as one 2-cycle, but I can remove it if it seems unnecessary.



---

archive/issue_events_235611.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-15T19:19:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235611"
}
```



---

archive/issue_events_235612.json:
```json
{
    "actor": "https://github.com/bhutz",
    "created_at": "2015-06-15T19:19:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235612"
}
```



---

archive/issue_events_235613.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-17T07:42:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235613"
}
```



---

archive/issue_events_235614.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "628cfb274b979c02428108ff30b3ec7fd50c9bec",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-17T07:42:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18443#event-235614"
}
```



---

archive/issue_comments_256908.json:
```json
{
    "body": "Changed branch from **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)** to **[6112c29](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**",
    "created_at": "2015-06-17T07:42:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18443",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18443#issuecomment-256908",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/gjorgenson/ticket/18443](https://github.com/sagemath/sagetrac-mirror/tree/u/gjorgenson/ticket/18443)** to **[6112c29](https://github.com/sagemath/sagetrac-mirror/commit/6112c29bf609d6cededc1441ffb99d75faef0893)**
