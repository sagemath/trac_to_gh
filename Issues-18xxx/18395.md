# Issue 18395: (moderate) Speedup in layout_spring

archive/issues_018158.json:
```json
{
    "body": "This branch improves (a bit) the performances of the 'layout_spring' algorithm, i.e. the attraction/repulsion layout for graphs.\n\nI tested it on the `CameronGraph` (big and dense), with the following results:\n\nBefore:\n\n```\nsage: g = graphs.CameronGraph()\nsage: %time _=g.layout_spring(iterations=100000)\nCPU times: user 30.8 s, sys: 8 ms, total: 30.8 s\nWall time: 30.8 s\n```\n\nAfter\n\n```\nsage: g = graphs.CameronGraph()\nsage: %time _=g.layout_spring(iterations=100000)\nCPU times: user 14.3 s, sys: 4 ms, total: 14.3 s\nWall time: 14.3 s\n```\n\nHonestly, that is mostly a failure. Most of the speedup comes from templating the code so that `dim=2` and `dim=3` are decided at compile-time. Most of the time it spent multiplying floats, and that's what I have been trying to reduce. Not with obvious success `:-/`\n\nNathann\n\nCC:  @vbraun @videlec @dcoudert\n\nReviewer: Travis Scrimshaw\n\nAuthor: Nathann Cohen, David Coudert\n\nBranch: 09a8953cbcb10a64c4a555fe54017be6db75ec21\n\nCommit: 09a8953cbcb10a64c4a555fe54017be6db75ec21\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18395\n\n",
    "closed_at": "2017-10-15T09:22:26Z",
    "created_at": "2015-05-10T08:57:53Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "(moderate) Speedup in layout_spring",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18395",
    "user": "https://github.com/nathanncohen"
}
```
This branch improves (a bit) the performances of the 'layout_spring' algorithm, i.e. the attraction/repulsion layout for graphs.

I tested it on the `CameronGraph` (big and dense), with the following results:

Before:

```
sage: g = graphs.CameronGraph()
sage: %time _=g.layout_spring(iterations=100000)
CPU times: user 30.8 s, sys: 8 ms, total: 30.8 s
Wall time: 30.8 s
```

After

```
sage: g = graphs.CameronGraph()
sage: %time _=g.layout_spring(iterations=100000)
CPU times: user 14.3 s, sys: 4 ms, total: 14.3 s
Wall time: 14.3 s
```

Honestly, that is mostly a failure. Most of the speedup comes from templating the code so that `dim=2` and `dim=3` are decided at compile-time. Most of the time it spent multiplying floats, and that's what I have been trying to reduce. Not with obvious success `:-/`

Nathann

CC:  @vbraun @videlec @dcoudert

Reviewer: Travis Scrimshaw

Author: Nathann Cohen, David Coudert

Branch: 09a8953cbcb10a64c4a555fe54017be6db75ec21

Commit: 09a8953cbcb10a64c4a555fe54017be6db75ec21

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18395





---

archive/issue_comments_244531.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-05-10T08:58:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244531",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_244532.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-10T08:59:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244532",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244533.json:
```json
{
    "body": "<a id='comment:3'></a>`mulsitplying floats`? Never heard of that ;-)",
    "created_at": "2015-05-10T09:05:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244533",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>`mulsitplying floats`? Never heard of that ;-)



---

archive/issue_comments_244534.json:
```json
{
    "body": "<a id='comment:4'></a>> `mulsitplying floats`? Never heard of that ;-)\n\n\nCan't you fix the typo instead of commenting on it?",
    "created_at": "2015-05-10T09:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244534",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>> `mulsitplying floats`? Never heard of that ;-)


Can't you fix the typo instead of commenting on it?



---

archive/issue_comments_244535.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-27T16:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_051849.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2015-07-19T12:34:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18395#event-51849"
}
```



---

archive/issue_comments_244536.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-07-19T12:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244536",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_244537.json:
```json
{
    "body": "<a id='comment:8'></a>I tried on top of 6.8.rc0\n\n```\nsage -t --long src/sage/graphs/generic_graph_pyx.pyx\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 54, in sage.graphs.generic_graph_pyx.spring_layout_fast_split\nFailed example:\n    spring_layout_fast_split(G)\nExpected:\n    {0: [0.452..., 0.247...], ..., 502: [25.7..., 0.505...]}\nGot:\n    {0: [nan, nan],\n     1: [nan, nan],\n     2: [nan, nan],\n...\n     902: [nan, nan]}\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 97, in sage.graphs.generic_graph_pyx.spring_layout_fast\nFailed example:\n    spring_layout_fast(G)\nExpected:\n    {0: [-0.0733..., 0.157...], ..., 502: [-0.551..., 0.682...]}\nGot:\n    {0: [nan, nan],\n     1: [nan, nan],\n...\n     902: [nan, nan]}\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 113, in sage.graphs.generic_graph_pyx.spring_layout_fast\nFailed example:\n    spring_layout_fast(G, by_component = True)\nExpected:\n    {0: [2.12..., -0.321...], ..., 502: [26.0..., -0.812...]}\nGot:\n    {0: [nan, nan],\n     1: [nan, nan],\n...\n     902: [nan, nan]}\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 346, in sage.graphs.generic_graph_pyx.sqrt_approx\nFailed example:\n    polar_plot([1,lambda x:dist(cos(x),sin(x))], (0, 2*pi))\nExpected:\n    Launched png viewer for Graphics object consisting of 2 graphics primitives\nGot:\n    Graphics object consisting of 2 graphics primitives\n**********************************************************************\n3 items had failures:\n   2 of   9 in sage.graphs.generic_graph_pyx.spring_layout_fast\n   1 of   5 in sage.graphs.generic_graph_pyx.spring_layout_fast_split\n   1 of   3 in sage.graphs.generic_graph_pyx.sqrt_approx\n    [81 tests, 4 failures, 3.03 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/graphs/generic_graph_pyx.pyx  # 4 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 3.1 seconds\n    cpu time: 2.8 seconds\n    cumulative wall time: 3.0 seconds\n```",
    "created_at": "2015-07-19T12:34:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244537",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:8'></a>I tried on top of 6.8.rc0

```
sage -t --long src/sage/graphs/generic_graph_pyx.pyx
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 54, in sage.graphs.generic_graph_pyx.spring_layout_fast_split
Failed example:
    spring_layout_fast_split(G)
Expected:
    {0: [0.452..., 0.247...], ..., 502: [25.7..., 0.505...]}
Got:
    {0: [nan, nan],
     1: [nan, nan],
     2: [nan, nan],
...
     902: [nan, nan]}
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 97, in sage.graphs.generic_graph_pyx.spring_layout_fast
Failed example:
    spring_layout_fast(G)
Expected:
    {0: [-0.0733..., 0.157...], ..., 502: [-0.551..., 0.682...]}
Got:
    {0: [nan, nan],
     1: [nan, nan],
...
     902: [nan, nan]}
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 113, in sage.graphs.generic_graph_pyx.spring_layout_fast
Failed example:
    spring_layout_fast(G, by_component = True)
Expected:
    {0: [2.12..., -0.321...], ..., 502: [26.0..., -0.812...]}
Got:
    {0: [nan, nan],
     1: [nan, nan],
...
     902: [nan, nan]}
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 346, in sage.graphs.generic_graph_pyx.sqrt_approx
Failed example:
    polar_plot([1,lambda x:dist(cos(x),sin(x))], (0, 2*pi))
Expected:
    Launched png viewer for Graphics object consisting of 2 graphics primitives
Got:
    Graphics object consisting of 2 graphics primitives
**********************************************************************
3 items had failures:
   2 of   9 in sage.graphs.generic_graph_pyx.spring_layout_fast
   1 of   5 in sage.graphs.generic_graph_pyx.spring_layout_fast_split
   1 of   3 in sage.graphs.generic_graph_pyx.sqrt_approx
    [81 tests, 4 failures, 3.03 s]
----------------------------------------------------------------------
sage -t --long src/sage/graphs/generic_graph_pyx.pyx  # 4 doctests failed
----------------------------------------------------------------------
Total time for all tests: 3.1 seconds
    cpu time: 2.8 seconds
    cumulative wall time: 3.0 seconds
```



---

archive/issue_comments_244538.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-20T12:07:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244538",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244539.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-20T12:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244540.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-20T12:15:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244540",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_244541.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-07-20T15:40:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244541",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_244542.json:
```json
{
    "body": "<a id='comment:12'></a>some problems remain :(\n\n```\nsage -t --long src/sage/graphs/generic_graph_pyx.pyx\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 54, in sage.graphs.generic_graph_pyx.spring_layout_fast_split\nFailed example:\n    spring_layout_fast_split(G)\nExpected:\n    {0: [0.452..., 0.247...], ..., 502: [25.7..., 0.505...]}\nGot:\n    {0: [0.7785109925614286, 0.06976708739098784],\n     1: [0.7761449200341834, 0.5516862310233024],\n...\n     902: [3.130511551759616, 0.22735834286143738]}\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 97, in sage.graphs.generic_graph_pyx.spring_layout_fast\nFailed example:\n    spring_layout_fast(G)\nExpected:\n    {0: [-0.0733..., 0.157...], ..., 502: [-0.551..., 0.682...]}\nGot:\n    {0: [0.007496865679470362, 0.04129113197411667],\n     1: [0.01495366592880235, 0.08850535412927439],\n     2: [0.05849657218327249, 0.09484847570321614],\n...\n     901: [-0.4474352390771702, -0.10570013179405174],\n     902: [-0.47861195812354, -0.10660577880837746]}\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 113, in sage.graphs.generic_graph_pyx.spring_layout_fast\nFailed example:\n    spring_layout_fast(G, by_component = True)\nExpected:\n    {0: [2.12..., -0.321...], ..., 502: [26.0..., -0.812...]}\nGot:\n    {0: [2.2186445972355, -0.008574741789712105],\n     1: [2.121454111190332, 0.5076017939042802],\n...\n     902: [3.0706796988471234, 0.8610997979963941]}\n**********************************************************************\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 348, in sage.graphs.generic_graph_pyx.sqrt_approx\nFailed example:\n    polar_plot([1,lambda x:dist(cos(x),sin(x))], (0, 2*pi))\nExpected:\n    Launched png viewer for Graphics object consisting of 2 graphics primitives\nGot:\n    Graphics object consisting of 2 graphics primitives\n**********************************************************************\n3 items had failures:\n   2 of   9 in sage.graphs.generic_graph_pyx.spring_layout_fast\n   1 of   5 in sage.graphs.generic_graph_pyx.spring_layout_fast_split\n   1 of   3 in sage.graphs.generic_graph_pyx.sqrt_approx\n    [81 tests, 4 failures, 3.42 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/graphs/generic_graph_pyx.pyx  # 4 doctests failed\n----------------------------------------------------------------------\nTotal time for all tests: 3.5 seconds\n    cpu time: 3.2 seconds\n    cumulative wall time: 3.4 seconds\n```",
    "created_at": "2015-07-20T15:40:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244542",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:12'></a>some problems remain :(

```
sage -t --long src/sage/graphs/generic_graph_pyx.pyx
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 54, in sage.graphs.generic_graph_pyx.spring_layout_fast_split
Failed example:
    spring_layout_fast_split(G)
Expected:
    {0: [0.452..., 0.247...], ..., 502: [25.7..., 0.505...]}
Got:
    {0: [0.7785109925614286, 0.06976708739098784],
     1: [0.7761449200341834, 0.5516862310233024],
...
     902: [3.130511551759616, 0.22735834286143738]}
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 97, in sage.graphs.generic_graph_pyx.spring_layout_fast
Failed example:
    spring_layout_fast(G)
Expected:
    {0: [-0.0733..., 0.157...], ..., 502: [-0.551..., 0.682...]}
Got:
    {0: [0.007496865679470362, 0.04129113197411667],
     1: [0.01495366592880235, 0.08850535412927439],
     2: [0.05849657218327249, 0.09484847570321614],
...
     901: [-0.4474352390771702, -0.10570013179405174],
     902: [-0.47861195812354, -0.10660577880837746]}
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 113, in sage.graphs.generic_graph_pyx.spring_layout_fast
Failed example:
    spring_layout_fast(G, by_component = True)
Expected:
    {0: [2.12..., -0.321...], ..., 502: [26.0..., -0.812...]}
Got:
    {0: [2.2186445972355, -0.008574741789712105],
     1: [2.121454111190332, 0.5076017939042802],
...
     902: [3.0706796988471234, 0.8610997979963941]}
**********************************************************************
File "src/sage/graphs/generic_graph_pyx.pyx", line 348, in sage.graphs.generic_graph_pyx.sqrt_approx
Failed example:
    polar_plot([1,lambda x:dist(cos(x),sin(x))], (0, 2*pi))
Expected:
    Launched png viewer for Graphics object consisting of 2 graphics primitives
Got:
    Graphics object consisting of 2 graphics primitives
**********************************************************************
3 items had failures:
   2 of   9 in sage.graphs.generic_graph_pyx.spring_layout_fast
   1 of   5 in sage.graphs.generic_graph_pyx.spring_layout_fast_split
   1 of   3 in sage.graphs.generic_graph_pyx.sqrt_approx
    [81 tests, 4 failures, 3.42 s]
----------------------------------------------------------------------
sage -t --long src/sage/graphs/generic_graph_pyx.pyx  # 4 doctests failed
----------------------------------------------------------------------
Total time for all tests: 3.5 seconds
    cpu time: 3.2 seconds
    cumulative wall time: 3.4 seconds
```



---

archive/issue_comments_244543.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-07-20T17:02:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244543",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244544.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-20T17:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244544",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_244545.json:
```json
{
    "body": "<a id='comment:14'></a>Sorry 'bout that `:-/`\n\nFixed.\n\nNathann",
    "created_at": "2015-07-20T17:03:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244545",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>Sorry 'bout that `:-/`

Fixed.

Nathann



---

archive/issue_comments_244546.json:
```json
{
    "body": "<a id='comment:15'></a>Those two almost certainly compile to the same binary:\n\n```\n-              for x from 0 <= x < dim:\n-                  disp_i[x] += delta[x] * force\n-                  disp_j[x] -= delta[x] * force\n+              for x in range(dim):\n+                  d_tmp = delta[x] * force\n+                  disp_i[x] += d_tmp\n+                  disp_j[x] -= d_tmp\n```\nYou can probably speed it by a few orders of magnitude by not using Euler's method.",
    "created_at": "2015-07-20T17:40:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244546",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:15'></a>Those two almost certainly compile to the same binary:

```
-              for x from 0 <= x < dim:
-                  disp_i[x] += delta[x] * force
-                  disp_j[x] -= delta[x] * force
+              for x in range(dim):
+                  d_tmp = delta[x] * force
+                  disp_i[x] += d_tmp
+                  disp_j[x] -= d_tmp
```
You can probably speed it by a few orders of magnitude by not using Euler's method.



---

archive/issue_comments_244547.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-08-30T18:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244547",
    "user": "https://github.com/koffie"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_244548.json:
```json
{
    "body": "<a id='comment:16'></a>Needs to be rebased on sage8.1beta3",
    "created_at": "2017-08-30T18:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244548",
    "user": "https://github.com/koffie"
}
```

<a id='comment:16'></a>Needs to be rebased on sage8.1beta3



---

archive/issue_comments_244549.json:
```json
{
    "body": "<a id='comment:17'></a>I tried but there are merge conflicts in file `generic_graph_pyx.pyx` and I don't know how to fix that (I need some help/pointer/training to do that).",
    "created_at": "2017-08-31T11:10:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244549",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:17'></a>I tried but there are merge conflicts in file `generic_graph_pyx.pyx` and I don't know how to fix that (I need some help/pointer/training to do that).



---

archive/issue_comments_244550.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:17 dcoudert]:\n> I tried but there are merge conflicts in file `generic_graph_pyx.pyx` and I don't know how to fix that (I need some help/pointer/training to do that).\n\n\nFor example https://gist.github.com/karenyyng/f19ff75c60f18b4b8149\n\nYou can also google \"git resolve conflicts\" or \"git mergetool\" and pick the link you prefer.",
    "created_at": "2017-08-31T15:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244550",
    "user": "https://github.com/videlec"
}
```

<a id='comment:18'></a>Replying to [comment:17 dcoudert]:
> I tried but there are merge conflicts in file `generic_graph_pyx.pyx` and I don't know how to fix that (I need some help/pointer/training to do that).


For example https://gist.github.com/karenyyng/f19ff75c60f18b4b8149

You can also google "git resolve conflicts" or "git mergetool" and pick the link you prefer.



---

archive/issue_comments_244551.json:
```json
{
    "body": "<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-08-31T16:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244551",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:19'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244552.json:
```json
{
    "body": "<a id='comment:20'></a>Outch... I did a `git add .` before the commit. Sorry for that.\nHow can I erase that and try again ?",
    "created_at": "2017-08-31T16:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244552",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:20'></a>Outch... I did a `git add .` before the commit. Sorry for that.
How can I erase that and try again ?



---

archive/issue_comments_244553.json:
```json
{
    "body": "<a id='comment:21'></a>To cancel the last commit `git reset HEAD^`. Then do what you want. At the time you will update the remote branch on trac with `git push ...` you will have a complain because you changed history. You will have to add the option `-f` (for `force`), i.e. do `git push -f ...`.",
    "created_at": "2017-08-31T16:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244553",
    "user": "https://github.com/videlec"
}
```

<a id='comment:21'></a>To cancel the last commit `git reset HEAD^`. Then do what you want. At the time you will update the remote branch on trac with `git push ...` you will have a complain because you changed history. You will have to add the option `-f` (for `force`), i.e. do `git push -f ...`.



---

archive/issue_comments_244554.json:
```json
{
    "body": "<a id='comment:22'></a>Though if your commit is a merge commit that is not a good idea...",
    "created_at": "2017-08-31T16:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244554",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>Though if your commit is a merge commit that is not a good idea...



---

archive/issue_comments_244555.json:
```json
{
    "body": "<a id='comment:23'></a>In the case you want to redo the merge, just start from scratch from `\u200b0a5461d`. In other words, something like\n\n```\n$ git checkout -b my_new_merge \u200b0a5461d\n$ git merge develop    # or whatever how this is called\n```",
    "created_at": "2017-08-31T16:31:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244555",
    "user": "https://github.com/videlec"
}
```

<a id='comment:23'></a>In the case you want to redo the merge, just start from scratch from `​0a5461d`. In other words, something like

```
$ git checkout -b my_new_merge ​0a5461d
$ git merge develop    # or whatever how this is called
```



---

archive/issue_comments_244556.json:
```json
{
    "body": "<a id='comment:24'></a>It's working !!! I'm currently recompiling / testing. It will be long.\n\nis this correct to push the changes `git push -f trac HEAD:public/18395` ? \n\nThank you very much.",
    "created_at": "2017-08-31T16:45:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244556",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:24'></a>It's working !!! I'm currently recompiling / testing. It will be long.

is this correct to push the changes `git push -f trac HEAD:public/18395` ? 

Thank you very much.



---

archive/issue_comments_244557.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 dcoudert]:\n> is this correct to push the changes `git push -f trac HEAD:public/18395` ? \n\n\nIt is.",
    "created_at": "2017-08-31T17:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244557",
    "user": "https://github.com/videlec"
}
```

<a id='comment:25'></a>Replying to [comment:24 dcoudert]:
> is this correct to push the changes `git push -f trac HEAD:public/18395` ? 


It is.



---

archive/issue_comments_244558.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-08-31T19:09:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244558",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_244559.json:
```json
{
    "body": "<a id='comment:27'></a>I followed what we said, but when I look at the branch it's really weird. Let me know if I show try again with a different set of commands. Thanks.",
    "created_at": "2017-08-31T19:16:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244559",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:27'></a>I followed what we said, but when I look at the branch it's really weird. Let me know if I show try again with a different set of commands. Thanks.



---

archive/issue_events_051850.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2017-09-04T15:00:19Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18395#event-51850"
}
```



---

archive/issue_events_051851.json:
```json
{
    "actor": "https://github.com/dcoudert",
    "created_at": "2017-09-04T15:00:19Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18395#event-51851"
}
```



---

archive/issue_comments_244560.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-04T15:00:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244560",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_244561.json:
```json
{
    "body": "<a id='comment:29'></a>I have created a new branched, on top of 8.1.beta5, containing all previous modifications. This way we get rid of all the mess I made with git. I hope we can now go forward with this ticket.\n\n---\nNew commits:",
    "created_at": "2017-09-16T11:33:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244561",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:29'></a>I have created a new branched, on top of 8.1.beta5, containing all previous modifications. This way we get rid of all the mess I made with git. I hope we can now go forward with this ticket.

---
New commits:



---

archive/issue_comments_244562.json:
```json
{
    "body": "<a id='comment:30'></a>LGTM except some more nitpick-type things:\n\n```diff\n-    Approximation of sqrt(x^2+y^2).\n+    Approximation of `\\sqrt(x^2 + y^2)`.\n \n-    Assuming that x>y>0, it is a taylor expansion at x^2. To see how 'bad' the\n-    approximation is::\n+    Assuming that `x > y > 0`, it is a Taylor expansion at `x^2`. To see how 'bad' the\n+    approximation is:\n \n+    .. PLOT::\n+\n+        def dist(x,y):\n+            x = abs(x)\n+            y = abs(y)\n+            return max(x,y) + min(x,y)**2/(2*max(x,y))\n+        sphinx_plot(polar_plot([1, lambda x: dist(cos(x),sin(x))], (0, 2*pi)))\n```\n(Please check that the plot of the graph is correct.)",
    "created_at": "2017-09-17T14:44:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244562",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:30'></a>LGTM except some more nitpick-type things:

```diff
-    Approximation of sqrt(x^2+y^2).
+    Approximation of `\sqrt(x^2 + y^2)`.
 
-    Assuming that x>y>0, it is a taylor expansion at x^2. To see how 'bad' the
-    approximation is::
+    Assuming that `x > y > 0`, it is a Taylor expansion at `x^2`. To see how 'bad' the
+    approximation is:
 
+    .. PLOT::
+
+        def dist(x,y):
+            x = abs(x)
+            y = abs(y)
+            return max(x,y) + min(x,y)**2/(2*max(x,y))
+        sphinx_plot(polar_plot([1, lambda x: dist(cos(x),sin(x))], (0, 2*pi)))
```
(Please check that the plot of the graph is correct.)



---

archive/issue_comments_244563.json:
```json
{
    "body": "<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-17T17:55:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244564.json:
```json
{
    "body": "<a id='comment:33'></a>I did the changes in the text (better reading), but not the `PLOT` part since the method is not in the html doc.",
    "created_at": "2017-09-17T17:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244564",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:33'></a>I did the changes in the text (better reading), but not the `PLOT` part since the method is not in the html doc.



---

archive/issue_comments_244565.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-09-17T18:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244565",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_244566.json:
```json
{
    "body": "<a id='comment:34'></a>Oh that's right, `cdef` functions are not included. Thanks.",
    "created_at": "2017-09-17T18:00:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244566",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:34'></a>Oh that's right, `cdef` functions are not included. Thanks.



---

archive/issue_comments_244567.json:
```json
{
    "body": "<a id='comment:35'></a>Fails on 32-bit, e.g. http://build.sagemath.org/#/builders/36/builds/14",
    "created_at": "2017-09-19T07:02:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244567",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:35'></a>Fails on 32-bit, e.g. http://build.sagemath.org/#/builders/36/builds/14



---

archive/issue_comments_244568.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-09-19T07:02:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244568",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_244569.json:
```json
{
    "body": "<a id='comment:37'></a>Numerical issues. I don't know how to make the tests robust to such issues. Anyone has a proposal?",
    "created_at": "2017-09-19T13:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244569",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:37'></a>Numerical issues. I don't know how to make the tests robust to such issues. Anyone has a proposal?



---

archive/issue_comments_244570.json:
```json
{
    "body": "<a id='comment:38'></a>It is quite easy to fix. One should just modify the doctest to only check for the correct ammount of digits. So one could just remove some digits that change between 32 and 64 bits before the ... in the current doctest. A more elegant solution would be to use the support in sage doctest to tolerate a certain ammount of numerical noise. See the  **tolerance** section of: http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests",
    "created_at": "2017-09-19T13:29:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244570",
    "user": "https://github.com/koffie"
}
```

<a id='comment:38'></a>It is quite easy to fix. One should just modify the doctest to only check for the correct ammount of digits. So one could just remove some digits that change between 32 and 64 bits before the ... in the current doctest. A more elegant solution would be to use the support in sage doctest to tolerate a certain ammount of numerical noise. See the  **tolerance** section of: http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests



---

archive/issue_comments_244571.json:
```json
{
    "body": "<a id='comment:39'></a>There are also flags you can set for doctest outout specifically for 32 bit and 64 bit machines.",
    "created_at": "2017-09-19T14:33:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244571",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:39'></a>There are also flags you can set for doctest outout specifically for 32 bit and 64 bit machines.



---

archive/issue_comments_244572.json:
```json
{
    "body": "<a id='comment:40'></a>Ah yes, tscrims solution is better in this case, since my solution would uneccesarily sacrifice precission. How to do this is also documented at the link I send previously",
    "created_at": "2017-09-19T14:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244572",
    "user": "https://github.com/koffie"
}
```

<a id='comment:40'></a>Ah yes, tscrims solution is better in this case, since my solution would uneccesarily sacrifice precission. How to do this is also documented at the link I send previously



---

archive/issue_comments_244573.json:
```json
{
    "body": "<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-19T15:20:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:41'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244574.json:
```json
{
    "body": "<a id='comment:42'></a>I used the values from http://build.sagemath.org/#/builders/36/builds/14 for 32-bits machine, since I don't have access to such CPU. I hope it's ok.",
    "created_at": "2017-09-19T15:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244574",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:42'></a>I used the values from http://build.sagemath.org/#/builders/36/builds/14 for 32-bits machine, since I don't have access to such CPU. I hope it's ok.



---

archive/issue_comments_244575.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-09-19T15:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244575",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_244576.json:
```json
{
    "body": "<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-30T12:29:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244576",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:44'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244577.json:
```json
{
    "body": "<a id='comment:45'></a>The patchbot reports incompatibility with python 3. I fixed that.\n\nThe patchbot reports an issue with doctest continuation ([here](https://patchbot.sagemath.org/log/18395/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-09-29%2019:57:07?plugin=doctest_continuation)) but I don't know what to do with it. Any help is more than welcome.",
    "created_at": "2017-09-30T12:32:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244577",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:45'></a>The patchbot reports incompatibility with python 3. I fixed that.

The patchbot reports an issue with doctest continuation ([here](https://patchbot.sagemath.org/log/18395/Ubuntu/14.04/i686/3.13.0-95-generic/arando/2017-09-29%2019:57:07?plugin=doctest_continuation)) but I don't know what to do with it. Any help is more than welcome.



---

archive/issue_comments_244578.json:
```json
{
    "body": "<a id='comment:46'></a>It means you should replace the `...` by `....:`  as explained on http://doc.sagemath.org/html/en/developer/coding_basics.html#writing-testable-examples under the heading multiline doctests.",
    "created_at": "2017-09-30T13:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244578",
    "user": "https://github.com/koffie"
}
```

<a id='comment:46'></a>It means you should replace the `...` by `....:`  as explained on http://doc.sagemath.org/html/en/developer/coding_basics.html#writing-testable-examples under the heading multiline doctests.



---

archive/issue_comments_244579.json:
```json
{
    "body": "<a id='comment:47'></a>I'm using `...` for the output, as for other doctests in the same file for which the patchbot is not complaining, and as explained on [http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests](http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests). It's not for the code part.\n\nI suspect a conflict with the `# 32-bit` and `# 64-bit` tags.",
    "created_at": "2017-09-30T13:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244579",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:47'></a>I'm using `...` for the output, as for other doctests in the same file for which the patchbot is not complaining, and as explained on [http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests](http://doc.sagemath.org/html/en/developer/coding_basics.html#special-markup-to-influence-doctests). It's not for the code part.

I suspect a conflict with the `# 32-bit` and `# 64-bit` tags.



---

archive/issue_comments_244580.json:
```json
{
    "body": "<a id='comment:48'></a>Patchbot plugins can be a little dumb at times. However, it does look like there still is some numerical issues.",
    "created_at": "2017-09-30T15:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244580",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:48'></a>Patchbot plugins can be a little dumb at times. However, it does look like there still is some numerical issues.



---

archive/issue_comments_244581.json:
```json
{
    "body": "<a id='comment:49'></a>I don't know what to do. All tests pass on my 64-bit OSX computer, but since the method uses random initial positions, the result may change from a computer to another.",
    "created_at": "2017-09-30T16:55:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244581",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:49'></a>I don't know what to do. All tests pass on my 64-bit OSX computer, but since the method uses random initial positions, the result may change from a computer to another.



---

archive/issue_comments_244582.json:
```json
{
    "body": "<a id='comment:50'></a>Two options: Raise the tolerance by removing sig-figs from the output or mark them with a `# rel tol` or `# abs tol`. I would suggest the second (unless the doctest framework doesn't like it) as it is more robust (i.e., a difference of `0.01` could change the first decimal place).",
    "created_at": "2017-09-30T16:59:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244582",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:50'></a>Two options: Raise the tolerance by removing sig-figs from the output or mark them with a `# rel tol` or `# abs tol`. I would suggest the second (unless the doctest framework doesn't like it) as it is more robust (i.e., a difference of `0.01` could change the first decimal place).



---

archive/issue_comments_244583.json:
```json
{
    "body": "<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-09-30T17:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244583",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:51'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244584.json:
```json
{
    "body": "<a id='comment:52'></a>Let's see if it's better this way.",
    "created_at": "2017-09-30T17:18:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244584",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:52'></a>Let's see if it's better this way.



---

archive/issue_comments_244585.json:
```json
{
    "body": "<a id='comment:53'></a>Hmm...that doesn't seem to work. Probably due to a mixing of the ellipses and the rel tol. I guess we just have to lower the sigfigs in the output.",
    "created_at": "2017-09-30T18:39:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244585",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:53'></a>Hmm...that doesn't seem to work. Probably due to a mixing of the ellipses and the rel tol. I guess we just have to lower the sigfigs in the output.



---

archive/issue_comments_244586.json:
```json
{
    "body": "<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-01T08:59:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244586",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:54'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244587.json:
```json
{
    "body": "<a id='comment:55'></a>I was not using correctly `rel tol`. Also, I have simplified the output.",
    "created_at": "2017-10-01T09:01:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244587",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:55'></a>I was not using correctly `rel tol`. Also, I have simplified the output.



---

archive/issue_comments_244588.json:
```json
{
    "body": "<a id='comment:56'></a>Since you have changed the output format, you should also add a check that the length is 902. Once done, you can set a positive review on my behalf.",
    "created_at": "2017-10-01T15:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244588",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:56'></a>Since you have changed the output format, you should also add a check that the length is 902. Once done, you can set a positive review on my behalf.



---

archive/issue_comments_244589.json:
```json
{
    "body": "<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-01T18:38:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244589",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244590.json:
```json
{
    "body": "<a id='comment:58'></a>902 is not the length but the largest index of a vertex (`pos` is a dictionary). \nThe graph has 50 vertices. I added a test to check that `pos` has 50 entries.\n\nI set the ticket to positive review as you proposed.\n\nThank you.",
    "created_at": "2017-10-01T18:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244590",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:58'></a>902 is not the length but the largest index of a vertex (`pos` is a dictionary). 
The graph has 50 vertices. I added a test to check that `pos` has 50 entries.

I set the ticket to positive review as you proposed.

Thank you.



---

archive/issue_comments_244591.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-01T18:41:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244591",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_244592.json:
```json
{
    "body": "<a id='comment:59'></a>```\nFile \"src/sage/graphs/generic_graph_pyx.pyx\", line 113, in sage.graphs.generic_graph_pyx.spring_layout_fast\nFailed example:\n    pos[902] # abs tol 0.03\nExpected:\n    [-0.48..., -0.10...]\nGot:\n    [-0.48914249502701945, -0.13939583925593196]\nTolerance exceeded in 1 of 2:\n    -0.10 vs -0.13939583925593196, tolerance 4e-02 > 3e-02\n**********************************************************************\n1 item had failures:\n   1 of  15 in sage.graphs.generic_graph_pyx.spring_layout_fast\n    [94 tests, 1 failure, 2.32 s]\n```",
    "created_at": "2017-10-04T06:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244592",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:59'></a>```
File "src/sage/graphs/generic_graph_pyx.pyx", line 113, in sage.graphs.generic_graph_pyx.spring_layout_fast
Failed example:
    pos[902] # abs tol 0.03
Expected:
    [-0.48..., -0.10...]
Got:
    [-0.48914249502701945, -0.13939583925593196]
Tolerance exceeded in 1 of 2:
    -0.10 vs -0.13939583925593196, tolerance 4e-02 > 3e-02
**********************************************************************
1 item had failures:
   1 of  15 in sage.graphs.generic_graph_pyx.spring_layout_fast
    [94 tests, 1 failure, 2.32 s]
```



---

archive/issue_comments_244593.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-10-04T06:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244593",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_244594.json:
```json
{
    "body": "<a id='comment:60'></a>I can either increase the tolerance to e.g. 0.1, or remove this test, but I don't know what would be better.",
    "created_at": "2017-10-05T14:57:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244594",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:60'></a>I can either increase the tolerance to e.g. 0.1, or remove this test, but I don't know what would be better.



---

archive/issue_comments_244595.json:
```json
{
    "body": "<a id='comment:61'></a>Increase the tolerance (or choose another output that is slightly higher if you think the current is on the low side).",
    "created_at": "2017-10-05T15:23:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244595",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:61'></a>Increase the tolerance (or choose another output that is slightly higher if you think the current is on the low side).



---

archive/issue_comments_244596.json:
```json
{
    "body": "<a id='comment:62'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-10-05T20:59:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244596",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:62'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_244597.json:
```json
{
    "body": "<a id='comment:63'></a>I have changed the tolerance to 0.1. It should be more robust to the various cpus / systems.",
    "created_at": "2017-10-05T21:00:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244597",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:63'></a>I have changed the tolerance to 0.1. It should be more robust to the various cpus / systems.



---

archive/issue_comments_244598.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-10-05T21:03:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244598",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_244599.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-10-05T21:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244599",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_244600.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-10-15T09:22:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18395#issuecomment-244600",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_051852.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-10-15T09:22:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18395",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18395#event-51852"
}
```
