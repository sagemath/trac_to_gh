# Issue 18158: wrap more libgap objects as `GapElement_List`

archive/issues_017921.json:
```json
{
    "assignees": [],
    "body": "Some objects in GAP are not PList but does support indexation.\n\n```\ngap> S := SymmetricGroup(5);;\ngap> irr := Irr(S);;\ngap> irr[3][1];\n5\n```\nor\n\n```\ngap> gens := GeneratorsOfGroup(SL(2,GF(5)));;\ngap> m := gens[1];;\ngap> m[1];\n[ Z(5), 0*Z(5) ]\ngap> m[2];\n[ 0*Z(5), Z(5)^3 ]\n```\nAnd Sage currently fails to recognize them as lists\n\n```\nsage: S = libgap.SymmetricGroup(5)\nsage: irr = S.Irr()[3]\nsage: irr[0]\nTraceback (most recent call last):\n...\nTypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'\n\nsage: gens = libgap.GeneratorsOfGroup(SL(2,GF(5)))\nsage: m = gens[0]\nsage: m[0]\nTraceback (most recent call last):\n...\nTypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'\n```\n\nIn this branch:\n\n- We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular we make possible the access to elements in the above example.\n\n- we move the methods `vector` and `matrix` to `GapElement_List`\n\nCC:  @vbraun @dimpase\n\nBranch/Commit: **[dbf8aea](https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Vincent Delecroix**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18158_\n\n",
    "closed_at": "2016-05-17T07:16:48Z",
    "created_at": "2015-04-11T11:20:07Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "wrap more libgap objects as `GapElement_List`",
    "type": "issue",
    "updated_at": "2016-05-17T07:16:48Z",
    "url": "https://github.com/sagemath/sage/issues/18158",
    "user": "https://github.com/videlec"
}
```
Some objects in GAP are not PList but does support indexation.

```
gap> S := SymmetricGroup(5);;
gap> irr := Irr(S);;
gap> irr[3][1];
5
```
or

```
gap> gens := GeneratorsOfGroup(SL(2,GF(5)));;
gap> m := gens[1];;
gap> m[1];
[ Z(5), 0*Z(5) ]
gap> m[2];
[ 0*Z(5), Z(5)^3 ]
```
And Sage currently fails to recognize them as lists

```
sage: S = libgap.SymmetricGroup(5)
sage: irr = S.Irr()[3]
sage: irr[0]
Traceback (most recent call last):
...
TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'

sage: gens = libgap.GeneratorsOfGroup(SL(2,GF(5)))
sage: m = gens[0]
sage: m[0]
Traceback (most recent call last):
...
TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'
```

In this branch:

- We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular we make possible the access to elements in the above example.

- we move the methods `vector` and `matrix` to `GapElement_List`

CC:  @vbraun @dimpase

Branch/Commit: **[dbf8aea](https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c)**

Reviewer: **Dima Pasechnik**

Author: **Vincent Delecroix**

_Issue created by migration from https://trac.sagemath.org/ticket/18158_





---

archive/issue_events_240490.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-11T11:20:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240490"
}
```



---

archive/issue_events_240491.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-11T11:20:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20interfaces",
    "label_color": "0000ff",
    "label_name": "component: interfaces",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240491"
}
```



---

archive/issue_events_240492.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-11T11:20:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240492"
}
```



---

archive/issue_events_240493.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-11T11:20:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240493"
}
```



---

archive/issue_comments_250678.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nlibgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`",
    "created_at": "2015-04-11T12:05:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250678",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:1" align="right">Comment 1</div>

libgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`



---

archive/issue_comments_250679.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nReplying to [@vbraun](#comment%3A1):\n> libgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`\n\ngap lists are Python iterable as well\n\n```\nsage: list(gap.List([1,2,3]))\n[1, 2, 3]\n```\nand having `list(x)[0] != x[0]` is not breaking any rule.",
    "created_at": "2015-04-11T12:12:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250679",
    "user": "https://github.com/videlec"
}
```

<div id="comment:2" align="right">Comment 2</div>

Replying to [@vbraun](#comment%3A1):
> libgap lists are python-iterable, so `__getitem__` needs to start at 0. otherwise you'd have `list(x)[0] != x[0]`

gap lists are Python iterable as well

```
sage: list(gap.List([1,2,3]))
[1, 2, 3]
```
and having `list(x)[0] != x[0]` is not breaking any rule.



---

archive/issue_comments_250680.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nIt does break the rule of least surprise, e.g.\n\n```\nsage: l = some_computation()\nsage: l \n[ 1, 2, 3 ]\nsage: l[0]     # guess what?\n```",
    "created_at": "2015-04-11T12:17:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250680",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:3" align="right">Comment 3</div>

It does break the rule of least surprise, e.g.

```
sage: l = some_computation()
sage: l 
[ 1, 2, 3 ]
sage: l[0]     # guess what?
```



---

archive/issue_comments_250681.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nReplying to [@vbraun](#comment%3A3):\n> It does break the rule of least surprise, e.g.\n> \n> ```\n> sage: l = some_computation()\n> sage: l \n> [ 1, 2, 3 ]\n> sage: l[0]     # guess what?\n> ```\n\nI agree with your example. On the other hand, gap permutations starts at 1 and it is coherent with their lists starting at 1.\n\nMore importantly, for who is intended the gap/libgap interface objects (and more generally Sage interface objects):\n- everybody\n- Sage programmers\n- users knowing gap (pari, singular, etc)\n- ?\nI rarely use `._pari_()`, `._gap_()` when doing actual computations. When I do, it is that Sage is lacking some interface.\n\nVincent",
    "created_at": "2015-04-11T12:30:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250681",
    "user": "https://github.com/videlec"
}
```

<div id="comment:4" align="right">Comment 4</div>

Replying to [@vbraun](#comment%3A3):
> It does break the rule of least surprise, e.g.
> 
> ```
> sage: l = some_computation()
> sage: l 
> [ 1, 2, 3 ]
> sage: l[0]     # guess what?
> ```

I agree with your example. On the other hand, gap permutations starts at 1 and it is coherent with their lists starting at 1.

More importantly, for who is intended the gap/libgap interface objects (and more generally Sage interface objects):
- everybody
- Sage programmers
- users knowing gap (pari, singular, etc)
- ?
I rarely use `._pari_()`, `._gap_()` when doing actual computations. When I do, it is that Sage is lacking some interface.

Vincent



---

archive/issue_comments_250682.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nSage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):\n\n```\nsage: pari(\"[1,2,3][1]\")\n1\nsage: pari(\"[1,2,3]\")[1]\n2\n```",
    "created_at": "2015-04-11T12:42:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250682",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">Comment 5</div>

Sage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):

```
sage: pari("[1,2,3][1]")
1
sage: pari("[1,2,3]")[1]
2
```



---

archive/issue_comments_250683.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nReplying to [@jdemeyer](#comment%3A5):\n> Sage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):\n> \n> ```\n> sage: pari(\"[1,2,3][1]\")\n> 1\n> sage: pari(\"[1,2,3]\")[1]\n> 2\n> ```\n\nAll right, this is as much consistent as gap vs libgap\n\n```\nsage: pari(\"[1,2,3]\")[1]\n2\nsage: gp(\"[1,2,3]\")[1]\n1\n```\n\nI will just add some warning in the doc and try to implement this `__getitem__` support in libgap.\n\nVincent",
    "created_at": "2015-04-11T13:18:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250683",
    "user": "https://github.com/videlec"
}
```

<div id="comment:6" align="right">Comment 6</div>

Replying to [@jdemeyer](#comment%3A5):
> Sage also redefines indexing for PARI objects (PARI starts counting at 1, Sage at 0):
> 
> ```
> sage: pari("[1,2,3][1]")
> 1
> sage: pari("[1,2,3]")[1]
> 2
> ```

All right, this is as much consistent as gap vs libgap

```
sage: pari("[1,2,3]")[1]
2
sage: gp("[1,2,3]")[1]
1
```

I will just add some warning in the doc and try to implement this `__getitem__` support in libgap.

Vincent



---

archive/issue_events_240494.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-11T14:05:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/p2%20%E2%80%93%20critical",
    "label_color": "ff7700",
    "label_name": "p2 \u2013 critical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240494"
}
```



---

archive/issue_events_240495.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-11T14:05:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240495"
}
```



---

archive/issue_comments_250684.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nI guess this is far from being optimal but it is at least very useful to me!\n\nVincent\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ee6506d15b2bbb976c738d6b804edf864a6ab24e\">ee6506d</a></td><td><code>Trac 18158: generic `__getitem__` for libgap object</code></td></tr></table>\n",
    "created_at": "2015-04-11T14:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250684",
    "user": "https://github.com/videlec"
}
```

<div id="comment:7" align="right">Comment 7</div>

I guess this is far from being optimal but it is at least very useful to me!

Vincent

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ee6506d15b2bbb976c738d6b804edf864a6ab24e">ee6506d</a></td><td><code>Trac 18158: generic `__getitem__` for libgap object</code></td></tr></table>




---

archive/issue_comments_250685.json:
```json
{
    "body": "Author: **Vincent Delecroix**",
    "created_at": "2015-04-11T14:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250685",
    "user": "https://github.com/videlec"
}
```

Author: **Vincent Delecroix**



---

archive/issue_comments_250686.json:
```json
{
    "body": "Commit: **[ee6506d](https://github.com/sagemath/sagetrac-mirror/commit/ee6506d15b2bbb976c738d6b804edf864a6ab24e)**",
    "created_at": "2015-04-11T14:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250686",
    "user": "https://github.com/videlec"
}
```

Commit: **[ee6506d](https://github.com/sagemath/sagetrac-mirror/commit/ee6506d15b2bbb976c738d6b804edf864a6ab24e)**



---

archive/issue_events_240496.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-04-11T14:05:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240496"
}
```



---

archive/issue_comments_250687.json:
```json
{
    "body": "Branch: **[u/vdelecroix/18158](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18158)**",
    "created_at": "2015-04-11T14:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250687",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/18158](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18158)**



---

archive/issue_comments_250688.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,26 +1,9 @@\n-There are two issue with `__getitem__` on gap vs libgap elements:\n-- gap indices start with `1`. This is respected with the gap interface but not with the libgap interface\n-- most libgap elements lacks a `__getitem__`\n-\n-Compare:\n+Some objects in GAP are not list but does support indexation\n \n ```\n-sage: irr = libgap.Irr(libgap.CharacterTable(S))\n-sage: irr[0]\n-Character( CharacterTable( Sym( [ 1 .. 10 ] ) ), [ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )\n-sage: irr[0][0]\n-Traceback (most recent call last):\n-...\n-TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'\n+gap> S := SymmetricGroup(5);;\n+gap> irr := Irr(S)[3];;\n+gap> irr[1];\n+5\n ```\n-with\n-\n-```\n-sage: irr = gap.Irr(gap.CharacterTable(S))\n-sage: irr[1]\n-Character( CharacterTable( SymmetricGroup( [ 1 .. 10 ] ) ), \n-[ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, \n-  -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )\n-sage: irr[1][1]\n-1\n-```\n+We provide in this ticket a generic `__getitem__` on `GapElement`.\n``````\n",
    "created_at": "2015-04-11T14:05:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250688",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,26 +1,9 @@
-There are two issue with `__getitem__` on gap vs libgap elements:
-- gap indices start with `1`. This is respected with the gap interface but not with the libgap interface
-- most libgap elements lacks a `__getitem__`
-
-Compare:
+Some objects in GAP are not list but does support indexation
 
 ```
-sage: irr = libgap.Irr(libgap.CharacterTable(S))
-sage: irr[0]
-Character( CharacterTable( Sym( [ 1 .. 10 ] ) ), [ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )
-sage: irr[0][0]
-Traceback (most recent call last):
-...
-TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'
+gap> S := SymmetricGroup(5);;
+gap> irr := Irr(S)[3];;
+gap> irr[1];
+5
 ```
-with
-
-```
-sage: irr = gap.Irr(gap.CharacterTable(S))
-sage: irr[1]
-Character( CharacterTable( SymmetricGroup( [ 1 .. 10 ] ) ), 
-[ 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 1, -1, 1, -1, 1, -1, 1, -1, 1, 
-  -1, 1, -1, 1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, 1, -1, 1, 1, -1 ] )
-sage: irr[1][1]
-1
-```
+We provide in this ticket a generic `__getitem__` on `GapElement`.
``````




---

archive/issue_comments_250689.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nGetitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`",
    "created_at": "2015-06-19T08:58:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250689",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">Comment 8</div>

Getitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`



---

archive/issue_comments_250690.json:
```json
{
    "body": "Changed commit from **[ee6506d](https://github.com/sagemath/sagetrac-mirror/commit/ee6506d15b2bbb976c738d6b804edf864a6ab24e)** to **[c27056e](https://github.com/sagemath/sagetrac-mirror/commit/c27056e7be55c28870ff781ff431b0fe58d927d5)**",
    "created_at": "2016-04-30T21:21:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250690",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ee6506d](https://github.com/sagemath/sagetrac-mirror/commit/ee6506d15b2bbb976c738d6b804edf864a6ab24e)** to **[c27056e](https://github.com/sagemath/sagetrac-mirror/commit/c27056e7be55c28870ff781ff431b0fe58d927d5)**



---

archive/issue_comments_250691.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c27056e7be55c28870ff781ff431b0fe58d927d5\">c27056e</a></td><td><code>Trac 18158: more __getitem__/__len__ for libgap</code></td></tr></table>\n",
    "created_at": "2016-04-30T21:21:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250691",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9" align="right">Comment 9</div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c27056e7be55c28870ff781ff431b0fe58d927d5">c27056e</a></td><td><code>Trac 18158: more __getitem__/__len__ for libgap</code></td></tr></table>




---

archive/issue_comments_250692.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Some objects in GAP are not list but does support indexation\n+Some objects in GAP are not PList but does support indexation\n \n ```\n gap> S := SymmetricGroup(5);;\n@@ -6,4 +6,15 @@\n gap> irr[1];\n 5\n ```\n-We provide in this ticket a generic `__getitem__` on `GapElement`.\n+or\n+\n+```\n+gap> gens := GeneratorsOfGroup(SL(2,GF(5)));;\n+gap> m := gens[1];;\n+gap> m[1];\n+[ Z(5), 0*Z(5) ]\n+gap> m[2];\n+[ 0*Z(5), Z(5)^3 ]\n+```\n+\n+We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`.\n``````\n",
    "created_at": "2016-04-30T21:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250692",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Some objects in GAP are not list but does support indexation
+Some objects in GAP are not PList but does support indexation
 
 ```
 gap> S := SymmetricGroup(5);;
@@ -6,4 +6,15 @@
 gap> irr[1];
 5
 ```
-We provide in this ticket a generic `__getitem__` on `GapElement`.
+or
+
+```
+gap> gens := GeneratorsOfGroup(SL(2,GF(5)));;
+gap> m := gens[1];;
+gap> m[1];
+[ Z(5), 0*Z(5) ]
+gap> m[2];
+[ 0*Z(5), Z(5)^3 ]
+```
+
+We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`.
``````




---

archive/issue_comments_250693.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@vbraun](#comment%3A8):\n> Getitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`\n\nIndeed it is much more robust and general. That way libgap vectors and matrices are also considered as lists\n\n```\nsage: M = libgap.eval('SL(2,GF(5))').GeneratorsOfGroup()[1]\nsage: M\n[ [ Z(5)^2, Z(5)^0 ], [ Z(5)^2, 0*Z(5) ] ]\nsage: M[0]\n[ Z(5)^2, Z(5)^0 ]\n```",
    "created_at": "2016-04-30T21:26:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250693",
    "user": "https://github.com/videlec"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@vbraun](#comment%3A8):
> Getitem without length is IMHO useless. The GAP function `IsList` just calls `IS_LIST` internally, so we should perhaps use that instead of `IS_PLIST` to decide when to wrap it in a `GapElement_List`

Indeed it is much more robust and general. That way libgap vectors and matrices are also considered as lists

```
sage: M = libgap.eval('SL(2,GF(5))').GeneratorsOfGroup()[1]
sage: M
[ [ Z(5)^2, Z(5)^0 ], [ Z(5)^2, 0*Z(5) ] ]
sage: M[0]
[ Z(5)^2, Z(5)^0 ]
```



---

archive/issue_events_240497.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-04-30T21:26:57Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240497"
}
```



---

archive/issue_events_240498.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-04-30T21:26:57Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "milestone_number": null,
    "milestone_title": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240498"
}
```



---

archive/issue_comments_250694.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI don't really get the purpose of this ticket; e.g.\n`m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')`\ncan just as well be done as follows, without an `eval`:\n\n```\nF=libgap.GF(4)\na=F.PrimitiveElement()\nm = libgap([[a,a^0],[0*a,a^2]])\n```",
    "created_at": "2016-05-03T18:52:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250694",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:11" align="right">Comment 11</div>

I don't really get the purpose of this ticket; e.g.
`m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')`
can just as well be done as follows, without an `eval`:

```
F=libgap.GF(4)
a=F.PrimitiveElement()
m = libgap([[a,a^0],[0*a,a^2]])
```



---

archive/issue_comments_250695.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nWhat are you exactly complaining about? With the branch, I am providing access to `__getitem__` and `__len__` for more gap objects. What `eval` has to do with all of this!?",
    "created_at": "2016-05-03T20:12:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250695",
    "user": "https://github.com/videlec"
}
```

<div id="comment:12" align="right">Comment 12</div>

What are you exactly complaining about? With the branch, I am providing access to `__getitem__` and `__len__` for more gap objects. What `eval` has to do with all of this!?



---

archive/issue_comments_250696.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nSorry, well, look at your branch yourself. It seems that you have removed and re-inserted a big chunk. Namely, that `m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')` is from \"green\" part, and so I assumed that is a part of the ticket contribution...",
    "created_at": "2016-05-03T20:29:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250696",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:13" align="right">Comment 13</div>

Sorry, well, look at your branch yourself. It seems that you have removed and re-inserted a big chunk. Namely, that `m = libgap.eval('[[Z(2^2), Z(2)^0],[0*Z(2), Z(2<sup>2)</sup>2]]')` is from "green" part, and so I assumed that is a part of the ticket contribution...



---

archive/issue_comments_250697.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nIndeed, I moved `matrix` and `vector` from `GapElement` to `GapElement_List`.\n\nThough, I can simplify the line that you don't like.",
    "created_at": "2016-05-03T21:24:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250697",
    "user": "https://github.com/videlec"
}
```

<div id="comment:14" align="right">Comment 14</div>

Indeed, I moved `matrix` and `vector` from `GapElement` to `GapElement_List`.

Though, I can simplify the line that you don't like.



---

archive/issue_comments_250698.json:
```json
{
    "body": "Changed commit from **[c27056e](https://github.com/sagemath/sagetrac-mirror/commit/c27056e7be55c28870ff781ff431b0fe58d927d5)** to **[dbf8aea](https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c)**",
    "created_at": "2016-05-03T21:31:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250698",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c27056e](https://github.com/sagemath/sagetrac-mirror/commit/c27056e7be55c28870ff781ff431b0fe58d927d5)** to **[dbf8aea](https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c)**



---

archive/issue_comments_250699.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c\">dbf8aea</a></td><td><code>Trac 18158: simplify some tests</code></td></tr></table>\n",
    "created_at": "2016-05-03T21:31:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250699",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15" align="right">Comment 15</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c">dbf8aea</a></td><td><code>Trac 18158: simplify some tests</code></td></tr></table>




---

archive/issue_comments_250700.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,4 +17,4 @@\n [ 0*Z(5), Z(5)^3 ]\n ```\n \n-We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`.\n+We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular the examples above previously failed inside Sage.\n``````\n",
    "created_at": "2016-05-03T21:34:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250700",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,4 +17,4 @@
 [ 0*Z(5), Z(5)^3 ]
 ```
 
-We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`.
+We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular the examples above previously failed inside Sage.
``````




---

archive/issue_events_240499.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2016-05-03T21:34:18Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "title_is": "wrap more libgap objects as `GapElement_List`",
    "title_was": "`__getitem__` for libGap_Element",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240499"
}
```



---

archive/issue_comments_250701.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,4 @@\n-Some objects in GAP are not PList but does support indexation\n-\n-```\n-gap> S := SymmetricGroup(5);;\n-gap> irr := Irr(S)[3];;\n-gap> irr[1];\n-5\n-```\n-or\n+Some objects in GAP are not PList but does support indexation.\n \n ```\n gap> gens := GeneratorsOfGroup(SL(2,GF(5)));;\n@@ -16,5 +8,19 @@\n gap> m[2];\n [ 0*Z(5), Z(5)^3 ]\n ```\n+Sage currently fails to recognize them as lists\n \n-We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular the examples above previously failed inside Sage.\n+```\n+sage: gens = libgap.GeneratorsOfGroup(SL(2,GF(5)))\n+sage: m = gens[0]\n+sage: m[0]\n+Traceback (most recent call last):\n+...\n+TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'\n+```\n+\n+In this branch:\n+\n+- We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular we make possible the access to elements in the above example.\n+\n+- we move the methods `vector` and `matrix` to `GapElement_List`\n``````\n",
    "created_at": "2016-05-08T03:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250701",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,4 @@
-Some objects in GAP are not PList but does support indexation
-
-```
-gap> S := SymmetricGroup(5);;
-gap> irr := Irr(S)[3];;
-gap> irr[1];
-5
-```
-or
+Some objects in GAP are not PList but does support indexation.
 
 ```
 gap> gens := GeneratorsOfGroup(SL(2,GF(5)));;
@@ -16,5 +8,19 @@
 gap> m[2];
 [ 0*Z(5), Z(5)^3 ]
 ```
+Sage currently fails to recognize them as lists
 
-We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular the examples above previously failed inside Sage.
+```
+sage: gens = libgap.GeneratorsOfGroup(SL(2,GF(5)))
+sage: m = gens[0]
+sage: m[0]
+Traceback (most recent call last):
+...
+TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'
+```
+
+In this branch:
+
+- We change the way gap lists are detected and hence more objects are now wrapped as `GapElement_List`. In particular we make possible the access to elements in the above example.
+
+- we move the methods `vector` and `matrix` to `GapElement_List`
``````




---

archive/issue_comments_250702.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,12 @@\n Some objects in GAP are not PList but does support indexation.\n+\n+```\n+gap> S := SymmetricGroup(5);;\n+gap> irr := Irr(S);;\n+gap> irr[3][1];\n+5\n+```\n+or\n \n ```\n gap> gens := GeneratorsOfGroup(SL(2,GF(5)));;\n@@ -8,9 +16,16 @@\n gap> m[2];\n [ 0*Z(5), Z(5)^3 ]\n ```\n-Sage currently fails to recognize them as lists\n+And Sage currently fails to recognize them as lists\n \n ```\n+sage: S = libgap.SymmetricGroup(5)\n+sage: irr = S.Irr()[3]\n+sage: irr[0]\n+Traceback (most recent call last):\n+...\n+TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'\n+\n sage: gens = libgap.GeneratorsOfGroup(SL(2,GF(5)))\n sage: m = gens[0]\n sage: m[0]\n``````\n",
    "created_at": "2016-05-08T03:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250702",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,12 @@
 Some objects in GAP are not PList but does support indexation.
+
+```
+gap> S := SymmetricGroup(5);;
+gap> irr := Irr(S);;
+gap> irr[3][1];
+5
+```
+or
 
 ```
 gap> gens := GeneratorsOfGroup(SL(2,GF(5)));;
@@ -8,9 +16,16 @@
 gap> m[2];
 [ 0*Z(5), Z(5)^3 ]
 ```
-Sage currently fails to recognize them as lists
+And Sage currently fails to recognize them as lists
 
 ```
+sage: S = libgap.SymmetricGroup(5)
+sage: irr = S.Irr()[3]
+sage: irr[0]
+Traceback (most recent call last):
+...
+TypeError: 'sage.libs.gap.element.GapElement' object has no attribute '__getitem__'
+
 sage: gens = libgap.GeneratorsOfGroup(SL(2,GF(5)))
 sage: m = gens[0]
 sage: m[0]
``````




---

archive/issue_comments_250703.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nIs the description helpful enough? I can revamp the commits if you like.",
    "created_at": "2016-05-08T03:03:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250703",
    "user": "https://github.com/videlec"
}
```

<div id="comment:18" align="right">Comment 18</div>

Is the description helpful enough? I can revamp the commits if you like.



---

archive/issue_events_240500.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-05-09T14:11:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240500"
}
```



---

archive/issue_events_240501.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-05-09T14:11:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240501"
}
```



---

archive/issue_comments_250704.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2016-05-09T14:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250704",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_comments_250705.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nlooks good to me.",
    "created_at": "2016-05-09T14:11:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250705",
    "user": "https://github.com/dimpase"
}
```

<div id="comment:19" align="right">Comment 19</div>

looks good to me.



---

archive/issue_comments_250706.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/18158](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18158)** to **[dbf8aea](https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c)**",
    "created_at": "2016-05-17T07:16:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18158#issuecomment-250706",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vdelecroix/18158](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18158)** to **[dbf8aea](https://github.com/sagemath/sagetrac-mirror/commit/dbf8aeac7bdcb1c458711b9c4d2f57a6d4fbac1c)**



---

archive/issue_events_240502.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-05-17T07:16:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240502"
}
```



---

archive/issue_events_240503.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bf691fa617f5b8c48bf5c6c359af0b5836c2b64b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-05-17T07:16:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18158",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18158#event-240503"
}
```
