# Issue 18061: Implement (correct) action of Atkin-Lehner operators on newforms

archive/issues_017824.json:
```json
{
    "body": "Let *f* be a newform of weight *k* for \u0393<sub>1</sub>(*n*), and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is (in the normalisation used by Sage) a complex number *\u03b7* of absolute value *d*^*k*/2 - 1^ such that *W<sub>d</sub>f* = *\u03b7f*<sup>*</sup>, where *f*<sup>*</sup> is a certain twist of *f*.\n\nThe main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that, given a newform `f`, returns a pair `(eta, g)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* on `f` and `g` is the appropriate twist of `f`.\n\nThis also fixes the following bug.  Consider the following newform of weight 2 for \u0393<sub>1</sub>(30) with coefficients in **Q**(*i*):\n\n```\nsage: f = Newforms(Gamma1(30), 2, names='a')[1]; f\nq + a1*q^2 - a1*q^3 - q^4 + (a1 - 2)*q^5 + O(q^6)\nsage: f.base_ring()\nNumber Field in a1 with defining polynomial x^2 + 1\nsage: f.character()\nDirichlet character modulo 30 of conductor 5 mapping 11 |--> 1, 7 |--> -1\n```\nThe method `atkin_lehner_eigenvalue()` returns a nonsensical result:\n\n```\nsage: f.atkin_lehner_eigenvalue()\n-2\n```\nThis is just the upper left entry of the matrix of the Atkin-Lehner operator *W*<sub>30</sub> with respect to some basis of the space of modular symbols attached to *f*:\n\n```\nsage: f.modular_symbols(sign=1).atkin_lehner_operator()\nHecke module morphism Atkin-Lehner operator W_30 defined by the matrix\n[-2 -3]\n[ 1  2]\nDomain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...\nCodomain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...\n```\n\n\nCC:  @kevinywlui @williamstein jpflori\n\nKeywords: newform Atkin-Lehner operator\n\nBranch/Commit: 41baa6825bd3018d1c443b53e1f0aba0242ea046\n\nReviewer: Peter Bruin, David Loeffler, Fr\u00e9d\u00e9ric Chapoton\n\nAuthor: Peter Bruin, David Loeffler\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18061\n\n",
    "closed_at": "2017-09-04T06:11:08Z",
    "created_at": "2015-03-26T18:20:08Z",
    "labels": [
        "component: modular forms",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Implement (correct) action of Atkin-Lehner operators on newforms",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18061",
    "user": "https://github.com/pjbruin"
}
```
Let *f* be a newform of weight *k* for Γ<sub>1</sub>(*n*), and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is (in the normalisation used by Sage) a complex number *η* of absolute value *d*^*k*/2 - 1^ such that *W<sub>d</sub>f* = *ηf*<sup>*</sup>, where *f*<sup>*</sup> is a certain twist of *f*.

The main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that, given a newform `f`, returns a pair `(eta, g)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* on `f` and `g` is the appropriate twist of `f`.

This also fixes the following bug.  Consider the following newform of weight 2 for Γ<sub>1</sub>(30) with coefficients in **Q**(*i*):

```
sage: f = Newforms(Gamma1(30), 2, names='a')[1]; f
q + a1*q^2 - a1*q^3 - q^4 + (a1 - 2)*q^5 + O(q^6)
sage: f.base_ring()
Number Field in a1 with defining polynomial x^2 + 1
sage: f.character()
Dirichlet character modulo 30 of conductor 5 mapping 11 |--> 1, 7 |--> -1
```
The method `atkin_lehner_eigenvalue()` returns a nonsensical result:

```
sage: f.atkin_lehner_eigenvalue()
-2
```
This is just the upper left entry of the matrix of the Atkin-Lehner operator *W*<sub>30</sub> with respect to some basis of the space of modular symbols attached to *f*:

```
sage: f.modular_symbols(sign=1).atkin_lehner_operator()
Hecke module morphism Atkin-Lehner operator W_30 defined by the matrix
[-2 -3]
[ 1  2]
Domain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...
Codomain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...
```


CC:  @kevinywlui @williamstein jpflori

Keywords: newform Atkin-Lehner operator

Branch/Commit: 41baa6825bd3018d1c443b53e1f0aba0242ea046

Reviewer: Peter Bruin, David Loeffler, Frédéric Chapoton

Author: Peter Bruin, David Loeffler

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18061





---

archive/issue_comments_315493.json:
```json
{
    "body": "<a id='comment:1'></a>\nA relevant sage-nt discussion: https://groups.google.com/forum/#!topic/sage-nt/SoBQfo0QnwM",
    "created_at": "2015-03-26T18:33:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315493",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:1'></a>
A relevant sage-nt discussion: https://groups.google.com/forum/#!topic/sage-nt/SoBQfo0QnwM



---

archive/issue_comments_315494.json:
```json
{
    "body": "<a id='comment:2'></a>\nThe implementation should probably use the formulae from this paper: A.O.L. Atkin and Wen-Ch'ing Winnie Li, Twists of newforms and pseudo-eigenvalues of *W*-operators, *Inventiones math.* **48** (1978), 221\u2013243.",
    "created_at": "2015-03-27T11:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315494",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:2'></a>
The implementation should probably use the formulae from this paper: A.O.L. Atkin and Wen-Ch'ing Winnie Li, Twists of newforms and pseudo-eigenvalues of *W*-operators, *Inventiones math.* **48** (1978), 221–243.



---

archive/issue_comments_315495.json:
```json
{
    "body": "Changing author from \"\" to \"Peter Bruin\"",
    "created_at": "2015-03-27T12:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315495",
    "user": "https://github.com/pjbruin"
}
```

Changing author from "" to "Peter Bruin"



---

archive/issue_comments_315496.json:
```json
{
    "body": "<a id='comment:3'></a>\nI am working on implementing this using a more general method `atkin_lehner_action()` that returns a pair `(eta, f_star)`, where `eta` is the pseudo-eigenvalue and `f_star` is the conjugate form.",
    "created_at": "2015-03-27T12:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315496",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:3'></a>
I am working on implementing this using a more general method `atkin_lehner_action()` that returns a pair `(eta, f_star)`, where `eta` is the pseudo-eigenvalue and `f_star` is the conjugate form.



---

archive/issue_comments_315497.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#18068, #18072\"",
    "created_at": "2015-03-30T12:29:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315497",
    "user": "https://github.com/pjbruin"
}
```

Changing dependencies from "" to "#18068, #18072"



---

archive/issue_comments_315498.json:
```json
{
    "body": "Changing dependencies from \"#18068, #18072\" to \"#18068, #18072, #18086\"",
    "created_at": "2015-03-30T13:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315498",
    "user": "https://github.com/pjbruin"
}
```

Changing dependencies from "#18068, #18072" to "#18068, #18072, #18086"



---

archive/issue_comments_315499.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-30T17:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315499",
    "user": "https://github.com/pjbruin"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_315500.json:
```json
{
    "body": "Changing commit from \"\" to \"9e8432448aa58142617fb2da80d244eb7e818ea2\"",
    "created_at": "2015-04-30T17:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315500",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "" to "9e8432448aa58142617fb2da80d244eb7e818ea2"



---

archive/issue_comments_315501.json:
```json
{
    "body": "Changing branch from \"\" to \"u/pbruin/18061-atkin_lehner_action\"",
    "created_at": "2015-04-30T17:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315501",
    "user": "https://github.com/pjbruin"
}
```

Changing branch from "" to "u/pbruin/18061-atkin_lehner_action"



---

archive/issue_comments_315502.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,8 @@\n-Consider the following newform of weight 2 for \u0393<sub>1</sub>(30) with coefficients in **Q**(*i*):\n+Let *f* be a newform of level *n*, and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is a complex number *\u03b7* of absolute value 1 such that *W<sub>d</sub>f* = *\u03b7f*<sup>*</sup>, where *f*<sup>*</sup> is the form whose coefficients are the complex conjugates of those of *f*.\n+\n+The main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that returns a pair `(eta, f_star)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* acting on a newform `f` and `f_star` is the conjugate form.\n+\n+This also fixes the following bug.  Consider the following newform of weight 2 for \u0393<sub>1</sub>(30) with coefficients in **Q**(*i*):\n \n ```\n sage: f = Newforms(Gamma1(30), 2, names='a')[1]; f\n@@ -24,4 +28,4 @@\n Domain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...\n Codomain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...\n ```\n-The correct result is in fact only a *pseudo*-eigenvalue; it is a complex number *\u03b7* of absolute value 1 such that *W*<sub>30</sub>*f* = *\u03b7f*<sup>*</sup>, where *f*<sup>*</sup> is the form whose coefficients are the complex conjugates of those of *f*.\n+\n``````\n",
    "created_at": "2015-04-30T17:25:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315502",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,8 @@
-Consider the following newform of weight 2 for Γ<sub>1</sub>(30) with coefficients in **Q**(*i*):
+Let *f* be a newform of level *n*, and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is a complex number *η* of absolute value 1 such that *W<sub>d</sub>f* = *ηf*<sup>*</sup>, where *f*<sup>*</sup> is the form whose coefficients are the complex conjugates of those of *f*.
+
+The main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that returns a pair `(eta, f_star)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* acting on a newform `f` and `f_star` is the conjugate form.
+
+This also fixes the following bug.  Consider the following newform of weight 2 for Γ<sub>1</sub>(30) with coefficients in **Q**(*i*):
 
 ```
 sage: f = Newforms(Gamma1(30), 2, names='a')[1]; f
@@ -24,4 +28,4 @@
 Domain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...
 Codomain: Modular Symbols subspace of dimension 2 of Modular Symbols space ...
 ```
-The correct result is in fact only a *pseudo*-eigenvalue; it is a complex number *η* of absolute value 1 such that *W*<sub>30</sub>*f* = *ηf*<sup>*</sup>, where *f*<sup>*</sup> is the form whose coefficients are the complex conjugates of those of *f*.
+
``````




---

archive/issue_events_058288.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "rename": {
        "from": "Fix Newform.atkin_lehner_eigenvalue() for coefficient fields other than QQ",
        "to": "Implement (correct) action of Atkin-Lehner operators on newforms"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58288"
}
```



---

archive/issue_comments_315503.json:
```json
{
    "body": "<a id='comment:8'></a>\nNote: the branch merges cleanly with 6.7.beta4 despite the name in the \"Branch\" field being red.",
    "created_at": "2015-05-06T14:28:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315503",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:8'></a>
Note: the branch merges cleanly with 6.7.beta4 despite the name in the "Branch" field being red.



---

archive/issue_comments_315504.json:
```json
{
    "body": "<a id='comment:9'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                      |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[a38e707](https://github.com/sagemath/sagetrac-mirror/commit/a38e707bc54952c8ac5f84353c2d3566b206fb69)|`Trac 18436: fix dimension formulae for modular forms`|\n|[aa6227f](https://github.com/sagemath/sagetrac-mirror/commit/aa6227f905e5e4160c832a2759c72457f3274fee)|`Merge branch 'ticket/18436-dimension_formulae' into ticket/18086-Newform_twist`|\n|[dd977f2](https://github.com/sagemath/sagetrac-mirror/commit/dd977f21a88f86e7ecc7712c1b921a23340f6879)|`Trac 18086: reviewer comments`|\n|[9c0133e](https://github.com/sagemath/sagetrac-mirror/commit/9c0133ede19fef7c1497c3dd79e67fe2146c0f58)|`Merge branch 'ticket/18086-Newform_twist' into ticket/18061-atkin_lehner_action`|",
    "created_at": "2015-05-18T10:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315504",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                      |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[a38e707](https://github.com/sagemath/sagetrac-mirror/commit/a38e707bc54952c8ac5f84353c2d3566b206fb69)|`Trac 18436: fix dimension formulae for modular forms`|
|[aa6227f](https://github.com/sagemath/sagetrac-mirror/commit/aa6227f905e5e4160c832a2759c72457f3274fee)|`Merge branch 'ticket/18436-dimension_formulae' into ticket/18086-Newform_twist`|
|[dd977f2](https://github.com/sagemath/sagetrac-mirror/commit/dd977f21a88f86e7ecc7712c1b921a23340f6879)|`Trac 18086: reviewer comments`|
|[9c0133e](https://github.com/sagemath/sagetrac-mirror/commit/9c0133ede19fef7c1497c3dd79e67fe2146c0f58)|`Merge branch 'ticket/18086-Newform_twist' into ticket/18061-atkin_lehner_action`|



---

archive/issue_comments_315505.json:
```json
{
    "body": "Changing commit from \"9e8432448aa58142617fb2da80d244eb7e818ea2\" to \"9c0133ede19fef7c1497c3dd79e67fe2146c0f58\"",
    "created_at": "2015-05-18T10:18:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315505",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9e8432448aa58142617fb2da80d244eb7e818ea2" to "9c0133ede19fef7c1497c3dd79e67fe2146c0f58"



---

archive/issue_comments_315506.json:
```json
{
    "body": "<a id='comment:10'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[7c5d213](https://github.com/sagemath/sagetrac-mirror/commit/7c5d21343137b57b0ce5d4686317092402960170)|`Trac 18061: add doctest`|",
    "created_at": "2015-05-19T17:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315506",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[7c5d213](https://github.com/sagemath/sagetrac-mirror/commit/7c5d21343137b57b0ce5d4686317092402960170)|`Trac 18061: add doctest`|



---

archive/issue_comments_315507.json:
```json
{
    "body": "Changing commit from \"9c0133ede19fef7c1497c3dd79e67fe2146c0f58\" to \"7c5d21343137b57b0ce5d4686317092402960170\"",
    "created_at": "2015-05-19T17:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315507",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "9c0133ede19fef7c1497c3dd79e67fe2146c0f58" to "7c5d21343137b57b0ce5d4686317092402960170"



---

archive/issue_comments_315508.json:
```json
{
    "body": "<a id='comment:11'></a>\nHi Peter! It's great that someone has got around to implementing this at last. But there are some things needing a little more work:\n\n- I think it's not good that the new implementation returns `NotImplementedError` on some cases where the *old* implementation was correct and valid:\n\n```\n# old implementation\nsage: F = Newforms(169,names='a')[0]\nsage: F[13]\n0\nsage: F.atkin_lehner_eigenvalue(169)\n-1\n```\n Here the A-L operator on the modular symbols space is actually a diagonal matrix, so taking its top left entry is the right thing to do:\n\n```\nsage: F.modular_symbols(sign=0).atkin_lehner_operator(169).matrix()\n[-1  0  0  0]\n[ 0 -1  0  0]\n[ 0  0 -1  0]\n[ 0  0  0 -1]\n```\n With your patch this bombs out at `NotImplementedError: action of W_Q is not implemented if a_Q(f) = 0`. If I'm not mistaken, the old implementation is correct if (and maybe only if) the character is trivial, while your new implementation will refuse to handle any case where the character is trivial and the base field is not QQ. (The old algorithm can be easily patched up to work whenever the Q-part of the character is trivial.)\n\n- The error message returned if Q is not an exact divisor of N is very uninformative:\n\n```\n\nsage: F = Newforms(20, 8, names='a')[1]; F\nq - a1*q^3 + 125*q^5 + O(q^6)\nsage: F.atkin_lehner_action(2)\n---------------------------------------------------------------------------\nIndexError                                Traceback (most recent call last)\n<ipython-input-36-b33b9d9d015f> in <module>()\n----> 1 F.atkin_lehner_action(Integer(2))\n\n/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_action(self, d, embedding)\n   1224         Q = q**e\n   1225         M = d // Q\n-> 1226         eps_Q = [eps for eps in self.character().decomposition() if eps.modulus() == Q][0]\n   1227         eps = eps_Q(M)\n   1228         if embedding is not None:\n\nIndexError: list index out of range\n```\n I would actually favour handing the special case where Q is a prime separately (interpreting it as W_p<sup>e</sup> where p<sup>e</sup> is the power of p dividing N). The `atkin_lehner_operator` method of modular symbol spaces does something along these lines. But in any case it should react more intelligently than this.\n\n- This error message is misleading:\n\n```\nsage: F.atkin_lehner_action(4)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-77-65866aefe137> in <module>()\n----> 1 F.atkin_lehner_action(Integer(4))\n\n/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_action(self, d, embedding)\n   1229             eps = embedding(eps)\n   1230         eta0, g0 = self.atkin_lehner_action(M, embedding)\n-> 1231         eta1, g1 = g0._atkin_lehner_action_prime_power(Q, embedding)\n   1232         return eps * eta0 * eta1, g1\n   1233 \n\n/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in _atkin_lehner_action_prime_power(self, Q, embedding)\n   1135         a_Q = self[Q]\n   1136         if not a_Q:\n-> 1137             raise NotImplementedError(\"action of W_Q is not implemented if a_Q(f) = 0\")\n   1138         epsilon = self.character()\n   1139         eps_Q = [eps for eps in epsilon.decomposition() if eps.modulus() == Q][0]\n\nNotImplementedError: action of W_Q is not implemented if a_Q(f) = 0\n```\n This action **is** implemented in some cases -- when the base ring is QQ (and it should be implemented in more). We don't want to sell our capabilities short here.\n\n- Your implementation will always fail for odd weights:\n\n```\nsage: Newforms(Gamma1(15), 3, names='a')\n[q - q^2 + 3*q^3 - 3*q^4 - 5*q^5 + O(q^6),\n q + q^2 - 3*q^3 - 3*q^4 + 5*q^5 + O(q^6),\n q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6),\n q + a3*q^2 + (3/5*a3^3 + 11/5*a3^2 + 22/5*a3 - 11/5)*q^3 + (-8/5*a3^3 - 31/5*a3^2 - 72/5*a3 + 16/5)*q^4 + (a3^3 + 4*a3^2 + 6*a3 - 6)*q^5 + O(q^6)]\nsage: f = _[2]\nsage: f.atkin_lehner_eigenvalue(5)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-87-4262769bbfb2> in <module>()\n----> 1 f.atkin_lehner_eigenvalue(Integer(5))\n\n/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_eigenvalue(self, d, embedding)\n   1285         if d is None:\n   1286             d = self.level()\n-> 1287         eta, g = self.atkin_lehner_action(d, embedding)\n   1288         if g != self:\n   1289             raise ValueError(\"%r is not an eigenform for W_%r\" % (self, d))\n\n/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_action(self, d, embedding)\n   1229             eps = embedding(eps)\n   1230         eta0, g0 = self.atkin_lehner_action(M, embedding)\n-> 1231         eta1, g1 = g0._atkin_lehner_action_prime_power(Q, embedding)\n   1232         return eps * eta0 * eta1, g1\n   1233 \n\n/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in _atkin_lehner_action_prime_power(self, Q, embedding)\n   1149         lambda_Q = g / a_Q\n   1150         Q = lambda_Q.parent()(Q)\n-> 1151         return Q**(self.weight()/2 - 1) * lambda_Q, f_star\n   1152 \n   1153     def atkin_lehner_action(self, d, embedding=None):\n\n/storage/masiao/sage/src/sage/structure/element.pyx in sage.structure.element.RingElement.__mul__ (build/cythonized/sage/structure/element.c:17184)()\n   1905         elif PyInt_CheckExact(left):\n   1906             return (<ModuleElement>right)._mul_long(PyInt_AS_LONG(left))\n-> 1907         return coercion_model.bin_op(left, right, mul)\n   1908 \n   1909     cpdef RingElement _mul_(self, RingElement right):\n\n/storage/masiao/sage/src/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9131)()\n   1044         # We should really include the underlying error.\n   1045         # This causes so much headache.\n-> 1046         raise TypeError, arith_error_message(x,y,op)\n   1047 \n   1048     cpdef canonical_coercion(self, x, y):\n\nTypeError: unsupported operand parent(s) for '*': 'Symbolic Ring' and 'Number Field in a2 with defining polynomial x^2 + 5'\n```\n Sage doesn't know which square root of 5 to take here, so it returns sqrt(5) in the symbolic ring, which of course causes an error when you try to multiply it by something in the base ring of f. Are you trying to renormalise the Atkin--Lehner operator so as to be an involution in all weights? This can't be done Galois-equivariantly, and is inconsistent with normalisations elsewhere in Sage. (There's a great quote from Deligne re these normalisations: \"Langlands is very sure he knows what the square root of p is. I have never been so sure\".) I personally favour the normalisation where W_Q<sup>2</sup> is Q^(k/2 - 1)^ up to a root of unity, which **is** Galois equivariant.",
    "created_at": "2015-05-21T12:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315508",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:11'></a>
Hi Peter! It's great that someone has got around to implementing this at last. But there are some things needing a little more work:

- I think it's not good that the new implementation returns `NotImplementedError` on some cases where the *old* implementation was correct and valid:

```
# old implementation
sage: F = Newforms(169,names='a')[0]
sage: F[13]
0
sage: F.atkin_lehner_eigenvalue(169)
-1
```
 Here the A-L operator on the modular symbols space is actually a diagonal matrix, so taking its top left entry is the right thing to do:

```
sage: F.modular_symbols(sign=0).atkin_lehner_operator(169).matrix()
[-1  0  0  0]
[ 0 -1  0  0]
[ 0  0 -1  0]
[ 0  0  0 -1]
```
 With your patch this bombs out at `NotImplementedError: action of W_Q is not implemented if a_Q(f) = 0`. If I'm not mistaken, the old implementation is correct if (and maybe only if) the character is trivial, while your new implementation will refuse to handle any case where the character is trivial and the base field is not QQ. (The old algorithm can be easily patched up to work whenever the Q-part of the character is trivial.)

- The error message returned if Q is not an exact divisor of N is very uninformative:

```

sage: F = Newforms(20, 8, names='a')[1]; F
q - a1*q^3 + 125*q^5 + O(q^6)
sage: F.atkin_lehner_action(2)
---------------------------------------------------------------------------
IndexError                                Traceback (most recent call last)
<ipython-input-36-b33b9d9d015f> in <module>()
----> 1 F.atkin_lehner_action(Integer(2))

/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_action(self, d, embedding)
   1224         Q = q**e
   1225         M = d // Q
-> 1226         eps_Q = [eps for eps in self.character().decomposition() if eps.modulus() == Q][0]
   1227         eps = eps_Q(M)
   1228         if embedding is not None:

IndexError: list index out of range
```
 I would actually favour handing the special case where Q is a prime separately (interpreting it as W_p<sup>e</sup> where p<sup>e</sup> is the power of p dividing N). The `atkin_lehner_operator` method of modular symbol spaces does something along these lines. But in any case it should react more intelligently than this.

- This error message is misleading:

```
sage: F.atkin_lehner_action(4)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-77-65866aefe137> in <module>()
----> 1 F.atkin_lehner_action(Integer(4))

/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_action(self, d, embedding)
   1229             eps = embedding(eps)
   1230         eta0, g0 = self.atkin_lehner_action(M, embedding)
-> 1231         eta1, g1 = g0._atkin_lehner_action_prime_power(Q, embedding)
   1232         return eps * eta0 * eta1, g1
   1233 

/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in _atkin_lehner_action_prime_power(self, Q, embedding)
   1135         a_Q = self[Q]
   1136         if not a_Q:
-> 1137             raise NotImplementedError("action of W_Q is not implemented if a_Q(f) = 0")
   1138         epsilon = self.character()
   1139         eps_Q = [eps for eps in epsilon.decomposition() if eps.modulus() == Q][0]

NotImplementedError: action of W_Q is not implemented if a_Q(f) = 0
```
 This action **is** implemented in some cases -- when the base ring is QQ (and it should be implemented in more). We don't want to sell our capabilities short here.

- Your implementation will always fail for odd weights:

```
sage: Newforms(Gamma1(15), 3, names='a')
[q - q^2 + 3*q^3 - 3*q^4 - 5*q^5 + O(q^6),
 q + q^2 - 3*q^3 - 3*q^4 + 5*q^5 + O(q^6),
 q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6),
 q + a3*q^2 + (3/5*a3^3 + 11/5*a3^2 + 22/5*a3 - 11/5)*q^3 + (-8/5*a3^3 - 31/5*a3^2 - 72/5*a3 + 16/5)*q^4 + (a3^3 + 4*a3^2 + 6*a3 - 6)*q^5 + O(q^6)]
sage: f = _[2]
sage: f.atkin_lehner_eigenvalue(5)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-87-4262769bbfb2> in <module>()
----> 1 f.atkin_lehner_eigenvalue(Integer(5))

/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_eigenvalue(self, d, embedding)
   1285         if d is None:
   1286             d = self.level()
-> 1287         eta, g = self.atkin_lehner_action(d, embedding)
   1288         if g != self:
   1289             raise ValueError("%r is not an eigenform for W_%r" % (self, d))

/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in atkin_lehner_action(self, d, embedding)
   1229             eps = embedding(eps)
   1230         eta0, g0 = self.atkin_lehner_action(M, embedding)
-> 1231         eta1, g1 = g0._atkin_lehner_action_prime_power(Q, embedding)
   1232         return eps * eta0 * eta1, g1
   1233 

/storage/masiao/sage/local/lib/python2.7/site-packages/sage/modular/modform/element.pyc in _atkin_lehner_action_prime_power(self, Q, embedding)
   1149         lambda_Q = g / a_Q
   1150         Q = lambda_Q.parent()(Q)
-> 1151         return Q**(self.weight()/2 - 1) * lambda_Q, f_star
   1152 
   1153     def atkin_lehner_action(self, d, embedding=None):

/storage/masiao/sage/src/sage/structure/element.pyx in sage.structure.element.RingElement.__mul__ (build/cythonized/sage/structure/element.c:17184)()
   1905         elif PyInt_CheckExact(left):
   1906             return (<ModuleElement>right)._mul_long(PyInt_AS_LONG(left))
-> 1907         return coercion_model.bin_op(left, right, mul)
   1908 
   1909     cpdef RingElement _mul_(self, RingElement right):

/storage/masiao/sage/src/sage/structure/coerce.pyx in sage.structure.coerce.CoercionModel_cache_maps.bin_op (build/cythonized/sage/structure/coerce.c:9131)()
   1044         # We should really include the underlying error.
   1045         # This causes so much headache.
-> 1046         raise TypeError, arith_error_message(x,y,op)
   1047 
   1048     cpdef canonical_coercion(self, x, y):

TypeError: unsupported operand parent(s) for '*': 'Symbolic Ring' and 'Number Field in a2 with defining polynomial x^2 + 5'
```
 Sage doesn't know which square root of 5 to take here, so it returns sqrt(5) in the symbolic ring, which of course causes an error when you try to multiply it by something in the base ring of f. Are you trying to renormalise the Atkin--Lehner operator so as to be an involution in all weights? This can't be done Galois-equivariantly, and is inconsistent with normalisations elsewhere in Sage. (There's a great quote from Deligne re these normalisations: "Langlands is very sure he knows what the square root of p is. I have never been so sure".) I personally favour the normalisation where W_Q<sup>2</sup> is Q^(k/2 - 1)^ up to a root of unity, which **is** Galois equivariant.



---

archive/issue_comments_315509.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-21T12:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315509",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_315510.json:
```json
{
    "body": "<a id='comment:13'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|\n|[c4d73ec](https://github.com/sagemath/sagetrac-mirror/commit/c4d73eca08154d368d2c6d66b90e010dd86b8e35)|`Trac 18061: Galois-equivariant normalisation for Atkin-Lehner operators`|\n|[b775957](https://github.com/sagemath/sagetrac-mirror/commit/b7759577d9f3346e1e9f8ec23ce137f3bf2ebb98)|`Trac 18061: make error message more precise`|\n|[eab427e](https://github.com/sagemath/sagetrac-mirror/commit/eab427e02d112a8486d6ae9fc6475666cab91389)|`Trac 18061: first try to use Atkin-Lehner matrix on modular symbols`|\n|[48e5d2d](https://github.com/sagemath/sagetrac-mirror/commit/48e5d2d924072cdbbaf4051c549e268e8e39e589)|`Trac 18061: improve handling of d in atkin_lehner_action()`|",
    "created_at": "2015-05-22T08:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315510",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------|
|[c4d73ec](https://github.com/sagemath/sagetrac-mirror/commit/c4d73eca08154d368d2c6d66b90e010dd86b8e35)|`Trac 18061: Galois-equivariant normalisation for Atkin-Lehner operators`|
|[b775957](https://github.com/sagemath/sagetrac-mirror/commit/b7759577d9f3346e1e9f8ec23ce137f3bf2ebb98)|`Trac 18061: make error message more precise`|
|[eab427e](https://github.com/sagemath/sagetrac-mirror/commit/eab427e02d112a8486d6ae9fc6475666cab91389)|`Trac 18061: first try to use Atkin-Lehner matrix on modular symbols`|
|[48e5d2d](https://github.com/sagemath/sagetrac-mirror/commit/48e5d2d924072cdbbaf4051c549e268e8e39e589)|`Trac 18061: improve handling of d in atkin_lehner_action()`|



---

archive/issue_comments_315511.json:
```json
{
    "body": "Changing commit from \"7c5d21343137b57b0ce5d4686317092402960170\" to \"48e5d2d924072cdbbaf4051c549e268e8e39e589\"",
    "created_at": "2015-05-22T08:49:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315511",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7c5d21343137b57b0ce5d4686317092402960170" to "48e5d2d924072cdbbaf4051c549e268e8e39e589"



---

archive/issue_comments_315512.json:
```json
{
    "body": "<a id='comment:14'></a>\nHi David,\n\nThanks a lot for taking a look at this!\n\n> - I think it's not good that the new implementation returns `NotImplementedError` on some cases where the *old* implementation was correct and valid:\n \nFixed by first checking if the Atkin-Lehner matrix is a scalar.\n\n> - The error message returned if Q is not an exact divisor of N is very uninformative:\n> [...]\n>  I would actually favour handing the special case where Q is a prime separately (interpreting it as W_p<sup>e</sup> where p<sup>e</sup> is the power of p dividing N). The `atkin_lehner_operator` method of modular symbol spaces does something along these lines.\n\nThe argument `d` is now handled in the same way as in the `atkin_lehner_operator` method of modular symbol spaces.\n> - This error message is misleading:\n> \n> ```\n> ...\n> NotImplementedError: action of W_Q is not implemented if a_Q(f) = 0\n> ```\n>  This action **is** implemented in some cases -- when the base ring is QQ (and it should be implemented in more). We don't want to sell our capabilities short here.\n\nI changed `if a_Q(f) = 0` to `for general newforms with a_Q(f) = 0`.\n\n> - Your implementation will always fail for odd weights:\n> [...]\n>  Are you trying to renormalise the Atkin--Lehner operator so as to be an involution in all weights? This can't be done Galois-equivariantly, and is inconsistent with normalisations elsewhere in Sage. (There's a great quote from Deligne re these normalisations: \"Langlands is very sure he knows what the square root of p is. I have never been so sure\".) I personally favour the normalisation where W_Q<sup>2</sup> is Q^(k/2 - 1)^ up to a root of unity, which **is** Galois equivariant.\n\n\nI was somehow convinced that the normalisation I used was consistent with the rest of sage, but apparently it isn't.  I changed it as you suggested (I think; did you mean W_Q<sup>2</sup> = Q^(k - 2)^ up to a root of unity?).",
    "created_at": "2015-05-22T09:01:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315512",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:14'></a>
Hi David,

Thanks a lot for taking a look at this!

> - I think it's not good that the new implementation returns `NotImplementedError` on some cases where the *old* implementation was correct and valid:
 
Fixed by first checking if the Atkin-Lehner matrix is a scalar.

> - The error message returned if Q is not an exact divisor of N is very uninformative:
> [...]
>  I would actually favour handing the special case where Q is a prime separately (interpreting it as W_p<sup>e</sup> where p<sup>e</sup> is the power of p dividing N). The `atkin_lehner_operator` method of modular symbol spaces does something along these lines.

The argument `d` is now handled in the same way as in the `atkin_lehner_operator` method of modular symbol spaces.
> - This error message is misleading:
> 
> ```
> ...
> NotImplementedError: action of W_Q is not implemented if a_Q(f) = 0
> ```
>  This action **is** implemented in some cases -- when the base ring is QQ (and it should be implemented in more). We don't want to sell our capabilities short here.

I changed `if a_Q(f) = 0` to `for general newforms with a_Q(f) = 0`.

> - Your implementation will always fail for odd weights:
> [...]
>  Are you trying to renormalise the Atkin--Lehner operator so as to be an involution in all weights? This can't be done Galois-equivariantly, and is inconsistent with normalisations elsewhere in Sage. (There's a great quote from Deligne re these normalisations: "Langlands is very sure he knows what the square root of p is. I have never been so sure".) I personally favour the normalisation where W_Q<sup>2</sup> is Q^(k/2 - 1)^ up to a root of unity, which **is** Galois equivariant.


I was somehow convinced that the normalisation I used was consistent with the rest of sage, but apparently it isn't.  I changed it as you suggested (I think; did you mean W_Q<sup>2</sup> = Q^(k - 2)^ up to a root of unity?).



---

archive/issue_comments_315513.json:
```json
{
    "body": "<a id='comment:15'></a>\nThe following still fails:\n\n```\nsage: f = Newforms(Gamma1(15), 3, names='a')[2]\nsage: f.atkin_lehner_eigenvalue(5)\nTraceback (most recent call last):\n...\nValueError: q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6) is not an eigenform for W_5\n```\nThis is wrong because `f` *is* an eigenform for `W_5`:\n\n```\nsage: f\nq + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6)\nsage: _, g = f.atkin_lehner_action(5); g\nq + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6)\n```\nThe reason is probably that the parents of `f` and `g` are different:\n\n```\nsage: parent(f)\nCuspidal subspace of dimension 8 of Modular Forms space of dimension 24 for Congruence Subgroup Gamma1(15) of weight 3 over Number Field in a2 with defining polynomial x^2 + 5\nsage: parent(g)\nCuspidal subspace of dimension 2 of Modular Forms space of dimension 6, character [-1, 1] and weight 3 over Number Field in a2 with defining polynomial x^2 + 5\n```",
    "created_at": "2015-05-22T09:05:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315513",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:15'></a>
The following still fails:

```
sage: f = Newforms(Gamma1(15), 3, names='a')[2]
sage: f.atkin_lehner_eigenvalue(5)
Traceback (most recent call last):
...
ValueError: q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6) is not an eigenform for W_5
```
This is wrong because `f` *is* an eigenform for `W_5`:

```
sage: f
q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6)
sage: _, g = f.atkin_lehner_action(5); g
q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6)
```
The reason is probably that the parents of `f` and `g` are different:

```
sage: parent(f)
Cuspidal subspace of dimension 8 of Modular Forms space of dimension 24 for Congruence Subgroup Gamma1(15) of weight 3 over Number Field in a2 with defining polynomial x^2 + 5
sage: parent(g)
Cuspidal subspace of dimension 2 of Modular Forms space of dimension 6, character [-1, 1] and weight 3 over Number Field in a2 with defining polynomial x^2 + 5
```



---

archive/issue_comments_315514.json:
```json
{
    "body": "<a id='comment:16'></a>\nHere's another gripe. The following is waaay too slow:\n\n```\nsage: F = Newforms(299,names='a')[0]\nsage: time F.atkin_lehner_eigenvalue(299)\nCPU times: user 4.99 s, sys: 18.9 ms, total: 5.01 s\nWall time: 5 s\n1\n```\nWhat on earth can be taking the time here? According to the profiler, the total time is 5.028 seconds, of which 5.026 is spent in four calls to the \"twist\" routine. Ultimately, most of that is actually spent creating Dirichlet character groups over number fields, which requires factoring some fairly large polynomials over those number fields. Why on earth is this necessary, or even relevant? Evaluating an Atkin--Lehner eigenvalue can't possibly require factorising 82 polynomials over number fields!",
    "created_at": "2015-05-22T09:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315514",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:16'></a>
Here's another gripe. The following is waaay too slow:

```
sage: F = Newforms(299,names='a')[0]
sage: time F.atkin_lehner_eigenvalue(299)
CPU times: user 4.99 s, sys: 18.9 ms, total: 5.01 s
Wall time: 5 s
1
```
What on earth can be taking the time here? According to the profiler, the total time is 5.028 seconds, of which 5.026 is spent in four calls to the "twist" routine. Ultimately, most of that is actually spent creating Dirichlet character groups over number fields, which requires factoring some fairly large polynomials over those number fields. Why on earth is this necessary, or even relevant? Evaluating an Atkin--Lehner eigenvalue can't possibly require factorising 82 polynomials over number fields!



---

archive/issue_comments_315515.json:
```json
{
    "body": "<a id='comment:17'></a>\nThe bug in[comment:15](#comment%3A15) is fixed by #18478.",
    "created_at": "2015-05-23T06:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315515",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:17'></a>
The bug in[comment:15](#comment%3A15) is fixed by #18478.



---

archive/issue_comments_315516.json:
```json
{
    "body": "Changing dependencies from \"#18068, #18072, #18086\" to \"#18068, #18072, #18086, #18478\"",
    "created_at": "2015-05-23T06:53:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315516",
    "user": "https://github.com/pjbruin"
}
```

Changing dependencies from "#18068, #18072, #18086" to "#18068, #18072, #18086, #18478"



---

archive/issue_comments_315517.json:
```json
{
    "body": "<a id='comment:18'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                         |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|\n|[a98bee2](https://github.com/sagemath/sagetrac-mirror/commit/a98bee2a3337431582e1762a0bf30f7577742bee)|`Trac 18061: add doctest`|",
    "created_at": "2015-05-23T07:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315517",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                         |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------|
|[a98bee2](https://github.com/sagemath/sagetrac-mirror/commit/a98bee2a3337431582e1762a0bf30f7577742bee)|`Trac 18061: add doctest`|



---

archive/issue_comments_315518.json:
```json
{
    "body": "Changing commit from \"48e5d2d924072cdbbaf4051c549e268e8e39e589\" to \"a98bee2a3337431582e1762a0bf30f7577742bee\"",
    "created_at": "2015-05-23T07:03:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315518",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "48e5d2d924072cdbbaf4051c549e268e8e39e589" to "a98bee2a3337431582e1762a0bf30f7577742bee"



---

archive/issue_comments_315519.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [davidloeffler](#comment%3A16):\n> Here's another gripe. The following is waaay too slow:\n> \n> ```\n> sage: F = Newforms(299,names='a')[0]\n> sage: time F.atkin_lehner_eigenvalue(299)\n> CPU times: user 4.99 s, sys: 18.9 ms, total: 5.01 s\n> Wall time: 5 s\n> 1\n> ```\n> What on earth can be taking the time here? According to the profiler, the total time is 5.028 seconds, of which 5.026 is spent in four calls to the \"twist\" routine.\n\nYou are right, `twist()` can and should be made much faster.  I propose to do this either on #18086 or on a follow-up ticket; I think this one can go back to needs_review.",
    "created_at": "2015-05-23T07:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315519",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:19'></a>
Replying to [davidloeffler](#comment%3A16):
> Here's another gripe. The following is waaay too slow:
> 
> ```
> sage: F = Newforms(299,names='a')[0]
> sage: time F.atkin_lehner_eigenvalue(299)
> CPU times: user 4.99 s, sys: 18.9 ms, total: 5.01 s
> Wall time: 5 s
> 1
> ```
> What on earth can be taking the time here? According to the profiler, the total time is 5.028 seconds, of which 5.026 is spent in four calls to the "twist" routine.

You are right, `twist()` can and should be made much faster.  I propose to do this either on #18086 or on a follow-up ticket; I think this one can go back to needs_review.



---

archive/issue_events_058289.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-05-23T07:11:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58289"
}
```



---

archive/issue_comments_315520.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-23T07:11:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315520",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_315521.json:
```json
{
    "body": "<a id='comment:20'></a>\nI think there are still some cases where the modular symbol algorithm actually works, but this implementation doesn't realise it. Here are two ways this can come up:\n\n- It can happen that the action of W_Q on f is multiplication by a scalar in the Hecke eigenvalue field of f, but not one which is in the base ring of f. Then the matrix of W_Q on the modular symbol space is not obviously recognisable as a scalar, but is contained in the subalgebra of the endomorphisms of the mod sym space generated by the Hecke operators (which is isomorphic to the Hecke eigenvalue field), and one should really recognise it as such and return the appropriate number field element. This comes up for my level 15 weight 3 example, where the W_5 eigenvalue is a square root of -5, but not just any square root -- rather, a specific one lying in the Hecke eigenvalue field of f:\n\n```\nsage: Newforms(Gamma1(15), 3, names='a')\n[q - q^2 + 3*q^3 - 3*q^4 - 5*q^5 + O(q^6),\n q + q^2 - 3*q^3 - 3*q^4 + 5*q^5 + O(q^6),\n q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6),\n q + a3*q^2 + (3/5*a3^3 + 11/5*a3^2 + 22/5*a3 - 11/5)*q^3 + (-8/5*a3^3 - 31/5*a3^2 - 72/5*a3 + 16/5)*q^4 + (a3^3 + 4*a3^2 + 6*a3 - 6)*q^5 + O(q^6)]\nsage: F = _[2]\nsage: M = F.modular_symbols(sign=0)\nsage: M.atkin_lehner_operator(5).matrix()\n[  -1/5 -39/10 -33/10    3/2]\n[   9/5 -19/10 -63/10  -13/2]\n[  -3/5    9/5   28/5      6]\n[     0   -3/2   -9/2   -7/2]\nsage: M.hecke_operator(5).matrix()\n[  1/5 39/10 33/10  -3/2]\n[ -9/5 19/10 63/10  13/2]\n[  3/5  -9/5 -28/5    -6]\n[    0   3/2   9/2   7/2]\n```\n\n- It can also happen that calculating the action of W_Q on the modular symbols space fails if you use \"sign = 1\" (as in your implementation). This is because the Atkin--Lehner operator and the star involution don't commute, although they do when restricted to an eigenspace on which the diamond operators at Q are trivial (if I remember rightly, the commutator of the two operators is exactly eps_Q(-1)). So one can get spurious linear algebra errors working on the sign 1 symbols, because the action of W_Q on the whole space is not defined, even though it is defined on the subspace we care about. This also comes up in the above example:\n\n```\nsage: F.modular_symbols(sign=1).atkin_lehner_operator(5) \n...\nArithmeticError: subspace is not invariant under matrix\n```\nI have a proof-of-concept implementation lying around on my hard drive which avoids these pitfalls, and I can merge it with your implementation to cover these extra cases; but this is definitely an enhancement of your work rather than a bug, and I won't have time to work on it for a week or so since I am away at a conference. So I will leave the ticket at needs_review for now, in case anybody else wants to look at it.",
    "created_at": "2015-05-27T18:51:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315521",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:20'></a>
I think there are still some cases where the modular symbol algorithm actually works, but this implementation doesn't realise it. Here are two ways this can come up:

- It can happen that the action of W_Q on f is multiplication by a scalar in the Hecke eigenvalue field of f, but not one which is in the base ring of f. Then the matrix of W_Q on the modular symbol space is not obviously recognisable as a scalar, but is contained in the subalgebra of the endomorphisms of the mod sym space generated by the Hecke operators (which is isomorphic to the Hecke eigenvalue field), and one should really recognise it as such and return the appropriate number field element. This comes up for my level 15 weight 3 example, where the W_5 eigenvalue is a square root of -5, but not just any square root -- rather, a specific one lying in the Hecke eigenvalue field of f:

```
sage: Newforms(Gamma1(15), 3, names='a')
[q - q^2 + 3*q^3 - 3*q^4 - 5*q^5 + O(q^6),
 q + q^2 - 3*q^3 - 3*q^4 + 5*q^5 + O(q^6),
 q + a2*q^2 + (-a2 - 2)*q^3 - q^4 - a2*q^5 + O(q^6),
 q + a3*q^2 + (3/5*a3^3 + 11/5*a3^2 + 22/5*a3 - 11/5)*q^3 + (-8/5*a3^3 - 31/5*a3^2 - 72/5*a3 + 16/5)*q^4 + (a3^3 + 4*a3^2 + 6*a3 - 6)*q^5 + O(q^6)]
sage: F = _[2]
sage: M = F.modular_symbols(sign=0)
sage: M.atkin_lehner_operator(5).matrix()
[  -1/5 -39/10 -33/10    3/2]
[   9/5 -19/10 -63/10  -13/2]
[  -3/5    9/5   28/5      6]
[     0   -3/2   -9/2   -7/2]
sage: M.hecke_operator(5).matrix()
[  1/5 39/10 33/10  -3/2]
[ -9/5 19/10 63/10  13/2]
[  3/5  -9/5 -28/5    -6]
[    0   3/2   9/2   7/2]
```

- It can also happen that calculating the action of W_Q on the modular symbols space fails if you use "sign = 1" (as in your implementation). This is because the Atkin--Lehner operator and the star involution don't commute, although they do when restricted to an eigenspace on which the diamond operators at Q are trivial (if I remember rightly, the commutator of the two operators is exactly eps_Q(-1)). So one can get spurious linear algebra errors working on the sign 1 symbols, because the action of W_Q on the whole space is not defined, even though it is defined on the subspace we care about. This also comes up in the above example:

```
sage: F.modular_symbols(sign=1).atkin_lehner_operator(5) 
...
ArithmeticError: subspace is not invariant under matrix
```
I have a proof-of-concept implementation lying around on my hard drive which avoids these pitfalls, and I can merge it with your implementation to cover these extra cases; but this is definitely an enhancement of your work rather than a bug, and I won't have time to work on it for a week or so since I am away at a conference. So I will leave the ticket at needs_review for now, in case anybody else wants to look at it.



---

archive/issue_comments_315522.json:
```json
{
    "body": "<a id='comment:21'></a>\nI had another look at your implementation. When using the modular-symbols algorithm, why do you take the conjugate of the (0,0) matrix entry? This is going to be quite slow to compute (because Sage has to verify from first principles that the coefficient fields are CM); and, more importantly, isn't it clearly the wrong answer?\n\n(Maybe Sage's conventions for Atkin--Lehner operators aren't the same as Atkin and Li, and the conjugation is the difference between conventions; but I think it would be very bad and confusing if Sage's conventions weren't internally consistent!)",
    "created_at": "2015-06-03T10:19:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315522",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:21'></a>
I had another look at your implementation. When using the modular-symbols algorithm, why do you take the conjugate of the (0,0) matrix entry? This is going to be quite slow to compute (because Sage has to verify from first principles that the coefficient fields are CM); and, more importantly, isn't it clearly the wrong answer?

(Maybe Sage's conventions for Atkin--Lehner operators aren't the same as Atkin and Li, and the conjugation is the difference between conventions; but I think it would be very bad and confusing if Sage's conventions weren't internally consistent!)



---

archive/issue_comments_315523.json:
```json
{
    "body": "<a id='comment:22'></a>\nI checked this against a newform of level 21 and character of conductor 7, and it does indeed appear to be the case that the Atkin--Lehner operator as currently implemented in Sage differs from Atkin and Li's conventions (even in weight 2, where the issue of powers of Q does not arise).\n\nSage's definition of the Atkin--Lehner operator seems to be that W<sub>Q</sub><sup>2</sup> = e<sub>Q</sub>(-1) e<sub>N/Q</sub>(Q), while Atkin and Li require that W<sub>Q</sub><sup>2</sup> = e<sub>Q</sub>(-1) e<sub>N/Q</sub>(Q)<sup>-1</sup>.\n\nSo there's a choice to be made here: we must have either an inconsistency between different parts of Sage, an inconsistency between Sage and Atkin--Li, or a non-backward-compatible change of conventions.\n\nI would actually favour the second option: there are plenty of other papers in the literature which use the convention W<sub>Q</sub><sup>2</sup> = Q<sup>k-2</sup>e<sub>Q</sub>(-1) e<sub>N/Q</sub>(Q). The great advantage of this convention is that if you use it, then the pseudo-eigenvalues l<sub>Q</sub> satisfy l<sub>QQ'</sub> = l<sub>Q</sub> l<sub>Q'</sub>, which is not the case with Atkin and Li's conventions.",
    "created_at": "2015-06-03T11:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315523",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:22'></a>
I checked this against a newform of level 21 and character of conductor 7, and it does indeed appear to be the case that the Atkin--Lehner operator as currently implemented in Sage differs from Atkin and Li's conventions (even in weight 2, where the issue of powers of Q does not arise).

Sage's definition of the Atkin--Lehner operator seems to be that W<sub>Q</sub><sup>2</sup> = e<sub>Q</sub>(-1) e<sub>N/Q</sub>(Q), while Atkin and Li require that W<sub>Q</sub><sup>2</sup> = e<sub>Q</sub>(-1) e<sub>N/Q</sub>(Q)<sup>-1</sup>.

So there's a choice to be made here: we must have either an inconsistency between different parts of Sage, an inconsistency between Sage and Atkin--Li, or a non-backward-compatible change of conventions.

I would actually favour the second option: there are plenty of other papers in the literature which use the convention W<sub>Q</sub><sup>2</sup> = Q<sup>k-2</sup>e<sub>Q</sub>(-1) e<sub>N/Q</sub>(Q). The great advantage of this convention is that if you use it, then the pseudo-eigenvalues l<sub>Q</sub> satisfy l<sub>QQ'</sub> = l<sub>Q</sub> l<sub>Q'</sub>, which is not the case with Atkin and Li's conventions.



---

archive/issue_comments_315524.json:
```json
{
    "body": "Changing branch from \"u/pbruin/18061-atkin_lehner_action\" to \"u/davidloeffler/18061-atkin_lehner_action\"",
    "created_at": "2015-06-03T16:53:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315524",
    "user": "https://github.com/loefflerd"
}
```

Changing branch from "u/pbruin/18061-atkin_lehner_action" to "u/davidloeffler/18061-atkin_lehner_action"



---

archive/issue_comments_315525.json:
```json
{
    "body": "Changing commit from \"a98bee2a3337431582e1762a0bf30f7577742bee\" to \"648b0ccf5bc27a4eb52b13279437e2e0bf61af6f\"",
    "created_at": "2015-06-03T16:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315525",
    "user": "https://github.com/loefflerd"
}
```

Changing commit from "a98bee2a3337431582e1762a0bf30f7577742bee" to "648b0ccf5bc27a4eb52b13279437e2e0bf61af6f"



---

archive/issue_comments_315526.json:
```json
{
    "body": "<a id='comment:24'></a>\nOK, here's my best attempt to merge your implementation and mine to cover the absolute maximum range of cases (sticking with the Atkin--Li conventions for now). \n\n---\nNew commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[c95288c](https://github.com/sagemath/sagetrac-mirror/commit/c95288c5b62f7ed5620444fc784ca070091725d5)|`Trac 18061: use mod-symb algorithm in more cases`|\n|[eb5a958](https://github.com/sagemath/sagetrac-mirror/commit/eb5a958bdcdb2d7d62e09f9a63ca96d56f95075c)|`Trac 18086: implement twisting of newforms by Dirichlet characters`|\n|[0d0544c](https://github.com/sagemath/sagetrac-mirror/commit/0d0544c4eebf8f9d4cfbac22a64bdff8b3546161)|`Trac 18086: reviewer comments`|\n|[751bf48](https://github.com/sagemath/sagetrac-mirror/commit/751bf48f8c2f65fd4a7478e0b22fbe76c6edf3bb)|`Trac 18086: fixed a small Dirichlet character bug`|\n|[abbeed5](https://github.com/sagemath/sagetrac-mirror/commit/abbeed56252780f1372966173fcd2d033f1f033f)|`Merge branch 't/18086/18086-merged' into t/18061/18061-atkin_lehner_action`|\n|[8b6cea1](https://github.com/sagemath/sagetrac-mirror/commit/8b6cea1b82b92af1be73ea29686b8200a0caf4d0)|`Trac 18478: fix comparison of equal newforms in different parents`|\n|[648b0cc](https://github.com/sagemath/sagetrac-mirror/commit/648b0ccf5bc27a4eb52b13279437e2e0bf61af6f)|`Merge branch 't/18478/18478-Newform_comparison' into t/18061/18061-atkin_lehner_action (prerequisite ticket)`|",
    "created_at": "2015-06-03T16:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315526",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:24'></a>
OK, here's my best attempt to merge your implementation and mine to cover the absolute maximum range of cases (sticking with the Atkin--Li conventions for now). 

---
New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[c95288c](https://github.com/sagemath/sagetrac-mirror/commit/c95288c5b62f7ed5620444fc784ca070091725d5)|`Trac 18061: use mod-symb algorithm in more cases`|
|[eb5a958](https://github.com/sagemath/sagetrac-mirror/commit/eb5a958bdcdb2d7d62e09f9a63ca96d56f95075c)|`Trac 18086: implement twisting of newforms by Dirichlet characters`|
|[0d0544c](https://github.com/sagemath/sagetrac-mirror/commit/0d0544c4eebf8f9d4cfbac22a64bdff8b3546161)|`Trac 18086: reviewer comments`|
|[751bf48](https://github.com/sagemath/sagetrac-mirror/commit/751bf48f8c2f65fd4a7478e0b22fbe76c6edf3bb)|`Trac 18086: fixed a small Dirichlet character bug`|
|[abbeed5](https://github.com/sagemath/sagetrac-mirror/commit/abbeed56252780f1372966173fcd2d033f1f033f)|`Merge branch 't/18086/18086-merged' into t/18061/18061-atkin_lehner_action`|
|[8b6cea1](https://github.com/sagemath/sagetrac-mirror/commit/8b6cea1b82b92af1be73ea29686b8200a0caf4d0)|`Trac 18478: fix comparison of equal newforms in different parents`|
|[648b0cc](https://github.com/sagemath/sagetrac-mirror/commit/648b0ccf5bc27a4eb52b13279437e2e0bf61af6f)|`Merge branch 't/18478/18478-Newform_comparison' into t/18061/18061-atkin_lehner_action (prerequisite ticket)`|



---

archive/issue_comments_315527.json:
```json
{
    "body": "Changing commit from \"648b0ccf5bc27a4eb52b13279437e2e0bf61af6f\" to \"c650fd8a14d1b9c3daddfa17ef6aaf4ca3bfb50a\"",
    "created_at": "2015-06-03T16:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315527",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "648b0ccf5bc27a4eb52b13279437e2e0bf61af6f" to "c650fd8a14d1b9c3daddfa17ef6aaf4ca3bfb50a"



---

archive/issue_comments_315528.json:
```json
{
    "body": "<a id='comment:25'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                  |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|\n|[c650fd8](https://github.com/sagemath/sagetrac-mirror/commit/c650fd8a14d1b9c3daddfa17ef6aaf4ca3bfb50a)|`Doctests and small fix to L-function computation`|",
    "created_at": "2015-06-03T16:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315528",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:25'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                  |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
|[c650fd8](https://github.com/sagemath/sagetrac-mirror/commit/c650fd8a14d1b9c3daddfa17ef6aaf4ca3bfb50a)|`Doctests and small fix to L-function computation`|



---

archive/issue_comments_315529.json:
```json
{
    "body": "Changing author from \"Peter Bruin\" to \"Peter Bruin, David Loeffler\"",
    "created_at": "2015-06-03T19:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315529",
    "user": "https://github.com/pjbruin"
}
```

Changing author from "Peter Bruin" to "Peter Bruin, David Loeffler"



---

archive/issue_comments_315530.json:
```json
{
    "body": "<a id='comment:26'></a>\nI uploaded a rebased branch (by cherry-picking the relevant commits) on top of #18086.  The reasons are (1) there were some duplicate commits (from the two versions of #18086) and merges of dependencies that are no longer needed since they are in the latest beta, and (2) merging the new branch from #18086 accidentally caused two copies of the method `Newform.twist()` to be present.  Hopefully we now have a clean branch to work on.",
    "created_at": "2015-06-03T19:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315530",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:26'></a>
I uploaded a rebased branch (by cherry-picking the relevant commits) on top of #18086.  The reasons are (1) there were some duplicate commits (from the two versions of #18086) and merges of dependencies that are no longer needed since they are in the latest beta, and (2) merging the new branch from #18086 accidentally caused two copies of the method `Newform.twist()` to be present.  Hopefully we now have a clean branch to work on.



---

archive/issue_comments_315531.json:
```json
{
    "body": "Changing branch from \"u/davidloeffler/18061-atkin_lehner_action\" to \"u/pbruin/18061-rebased\"",
    "created_at": "2015-06-03T19:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315531",
    "user": "https://github.com/pjbruin"
}
```

Changing branch from "u/davidloeffler/18061-atkin_lehner_action" to "u/pbruin/18061-rebased"



---

archive/issue_comments_315532.json:
```json
{
    "body": "Changing commit from \"c650fd8a14d1b9c3daddfa17ef6aaf4ca3bfb50a\" to \"90f0b3b0e0050d686169f7dc53da62e667fd8f6e\"",
    "created_at": "2015-06-03T19:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315532",
    "user": "https://github.com/pjbruin"
}
```

Changing commit from "c650fd8a14d1b9c3daddfa17ef6aaf4ca3bfb50a" to "90f0b3b0e0050d686169f7dc53da62e667fd8f6e"



---

archive/issue_comments_315533.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [davidloeffler](#comment%3A21):\n> I had another look at your implementation. When using the modular-symbols algorithm, why do you take the conjugate of the (0,0) matrix entry? This is going to be quite slow to compute (because Sage has to verify from first principles that the coefficient fields are CM); and, more importantly, isn't it clearly the wrong answer?\n\nTo be honest I ran into this through a doctest failure, and figured that in all probability either the (0,0) entry or its conjugate would be the correct value, with the conjugate being explained by some sesquilinear pairing intervening somewhere...\n> (Maybe Sage's conventions for Atkin--Lehner operators aren't the same as Atkin and Li, and the conjugation is the difference between conventions; but I think it would be very bad and confusing if Sage's conventions weren't internally consistent!)\n\nI didn't realise that the various conventions for the Atkin-Lehner operator differ in other ways than by a power of *Q*.  We should carefully document what convention we use and how it differs from others!",
    "created_at": "2015-06-03T19:36:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315533",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:27'></a>
Replying to [davidloeffler](#comment%3A21):
> I had another look at your implementation. When using the modular-symbols algorithm, why do you take the conjugate of the (0,0) matrix entry? This is going to be quite slow to compute (because Sage has to verify from first principles that the coefficient fields are CM); and, more importantly, isn't it clearly the wrong answer?

To be honest I ran into this through a doctest failure, and figured that in all probability either the (0,0) entry or its conjugate would be the correct value, with the conjugate being explained by some sesquilinear pairing intervening somewhere...
> (Maybe Sage's conventions for Atkin--Lehner operators aren't the same as Atkin and Li, and the conjugation is the difference between conventions; but I think it would be very bad and confusing if Sage's conventions weren't internally consistent!)

I didn't realise that the various conventions for the Atkin-Lehner operator differ in other ways than by a power of *Q*.  We should carefully document what convention we use and how it differs from others!



---

archive/issue_comments_315534.json:
```json
{
    "body": "<a id='comment:28'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                              |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[93e2f86](https://github.com/sagemath/sagetrac-mirror/commit/93e2f86b86ec763447d062f38a6ce340ace302a7)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|",
    "created_at": "2015-06-04T23:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315534",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                              |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[93e2f86](https://github.com/sagemath/sagetrac-mirror/commit/93e2f86b86ec763447d062f38a6ce340ace302a7)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|



---

archive/issue_comments_315535.json:
```json
{
    "body": "Changing commit from \"90f0b3b0e0050d686169f7dc53da62e667fd8f6e\" to \"93e2f86b86ec763447d062f38a6ce340ace302a7\"",
    "created_at": "2015-06-04T23:26:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315535",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "90f0b3b0e0050d686169f7dc53da62e667fd8f6e" to "93e2f86b86ec763447d062f38a6ce340ace302a7"



---

archive/issue_comments_315536.json:
```json
{
    "body": "Changing commit from \"93e2f86b86ec763447d062f38a6ce340ace302a7\" to \"d513f931d4ae9aa3f23efb893e084195204ff55f\"",
    "created_at": "2015-08-19T13:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315536",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "93e2f86b86ec763447d062f38a6ce340ace302a7" to "d513f931d4ae9aa3f23efb893e084195204ff55f"



---

archive/issue_comments_315537.json:
```json
{
    "body": "<a id='comment:29'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                            |\n|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|\n|[1dddad0](https://github.com/sagemath/sagetrac-mirror/commit/1dddad0135598d76366247deb7f38f1882c6caf7)|`Trac 18061: revert changes to dirichlet.py`|\n|[601287d](https://github.com/sagemath/sagetrac-mirror/commit/601287de641e32bb5af62708a99023df22de5c2f)|`Trac 18061: improve computation of root number`|\n|[d513f93](https://github.com/sagemath/sagetrac-mirror/commit/d513f931d4ae9aa3f23efb893e084195204ff55f)|`Trac 18061: remove trailing whitespace`|",
    "created_at": "2015-08-19T13:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315537",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:29'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                            |
|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------|
|[1dddad0](https://github.com/sagemath/sagetrac-mirror/commit/1dddad0135598d76366247deb7f38f1882c6caf7)|`Trac 18061: revert changes to dirichlet.py`|
|[601287d](https://github.com/sagemath/sagetrac-mirror/commit/601287de641e32bb5af62708a99023df22de5c2f)|`Trac 18061: improve computation of root number`|
|[d513f93](https://github.com/sagemath/sagetrac-mirror/commit/d513f931d4ae9aa3f23efb893e084195204ff55f)|`Trac 18061: remove trailing whitespace`|



---

archive/issue_comments_315538.json:
```json
{
    "body": "<a id='comment:30'></a>\nNew commits:\n- changes to `gauss_sum()` and `gauss_sum_numerical()` over `QQbar` should be done on the new ticket #19056 (it does not seem to be essential for this ticket, `gauss_sum()` and `gauss_sum_numerical()` should behave differently, and we should add doctests)\n- use correct precision in computation of root number in `lseries()`\n- clean up whitespace",
    "created_at": "2015-08-19T13:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315538",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:30'></a>
New commits:
- changes to `gauss_sum()` and `gauss_sum_numerical()` over `QQbar` should be done on the new ticket #19056 (it does not seem to be essential for this ticket, `gauss_sum()` and `gauss_sum_numerical()` should behave differently, and we should add doctests)
- use correct precision in computation of root number in `lseries()`
- clean up whitespace



---

archive/issue_comments_315539.json:
```json
{
    "body": "<a id='comment:31'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                           |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|\n|[c173a2e](https://github.com/sagemath/sagetrac-mirror/commit/c173a2ee022f18e6171d2addd756728f0280afb2)|`Trac 18061: move `@`cached_method to where the actual computation is done`|",
    "created_at": "2015-08-19T13:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315539",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                           |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------|
|[c173a2e](https://github.com/sagemath/sagetrac-mirror/commit/c173a2ee022f18e6171d2addd756728f0280afb2)|`Trac 18061: move `@`cached_method to where the actual computation is done`|



---

archive/issue_comments_315540.json:
```json
{
    "body": "Changing commit from \"d513f931d4ae9aa3f23efb893e084195204ff55f\" to \"c173a2ee022f18e6171d2addd756728f0280afb2\"",
    "created_at": "2015-08-19T13:21:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315540",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d513f931d4ae9aa3f23efb893e084195204ff55f" to "c173a2ee022f18e6171d2addd756728f0280afb2"



---

archive/issue_comments_315541.json:
```json
{
    "body": "Changing commit from \"c173a2ee022f18e6171d2addd756728f0280afb2\" to \"1c20775295a7c243cafb90d92469a22e8cb9e88e\"",
    "created_at": "2015-08-19T14:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315541",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "c173a2ee022f18e6171d2addd756728f0280afb2" to "1c20775295a7c243cafb90d92469a22e8cb9e88e"



---

archive/issue_comments_315542.json:
```json
{
    "body": "<a id='comment:32'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                       |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|\n|[6f1b77d](https://github.com/sagemath/sagetrac-mirror/commit/6f1b77daa20467410c3bd5450c53c9d6dbfcbe85)|`Trac 18061: small documentation fixes`|\n|[1c20775](https://github.com/sagemath/sagetrac-mirror/commit/1c20775295a7c243cafb90d92469a22e8cb9e88e)|`Trac 18061: make modsym_eigenspace() slightly more readable`|",
    "created_at": "2015-08-19T14:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315542",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:32'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                       |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------|
|[6f1b77d](https://github.com/sagemath/sagetrac-mirror/commit/6f1b77daa20467410c3bd5450c53c9d6dbfcbe85)|`Trac 18061: small documentation fixes`|
|[1c20775](https://github.com/sagemath/sagetrac-mirror/commit/1c20775295a7c243cafb90d92469a22e8cb9e88e)|`Trac 18061: make modsym_eigenspace() slightly more readable`|



---

archive/issue_comments_315543.json:
```json
{
    "body": "<a id='comment:33'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                                |\n|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|\n|[53d026f](https://github.com/sagemath/sagetrac-mirror/commit/53d026ffd12c40d4f991b470f45387c382e60925)|`Trac 18061: use Sage convention instead of Atkin-Li convention`|\n|[88bda87](https://github.com/sagemath/sagetrac-mirror/commit/88bda8783bc188c0a5ceccc999e576c93cc399c2)|`Trac 18061: replace ArithmeticError by assertion`|",
    "created_at": "2015-08-20T12:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315543",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:33'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                                |
|------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------|
|[53d026f](https://github.com/sagemath/sagetrac-mirror/commit/53d026ffd12c40d4f991b470f45387c382e60925)|`Trac 18061: use Sage convention instead of Atkin-Li convention`|
|[88bda87](https://github.com/sagemath/sagetrac-mirror/commit/88bda8783bc188c0a5ceccc999e576c93cc399c2)|`Trac 18061: replace ArithmeticError by assertion`|



---

archive/issue_comments_315544.json:
```json
{
    "body": "Changing commit from \"1c20775295a7c243cafb90d92469a22e8cb9e88e\" to \"88bda8783bc188c0a5ceccc999e576c93cc399c2\"",
    "created_at": "2015-08-20T12:05:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315544",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1c20775295a7c243cafb90d92469a22e8cb9e88e" to "88bda8783bc188c0a5ceccc999e576c93cc399c2"



---

archive/issue_comments_315545.json:
```json
{
    "body": "<a id='comment:34'></a>\nI changed `_atkin_lehner_action_from_{qexp,modsym}` to use the Sage convention instead of the Atkin-Li convention for Atkin-Lehner operators.  We still have to document this clearly.",
    "created_at": "2015-08-20T12:07:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315545",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:34'></a>
I changed `_atkin_lehner_action_from_{qexp,modsym}` to use the Sage convention instead of the Atkin-Li convention for Atkin-Lehner operators.  We still have to document this clearly.



---

archive/issue_comments_315546.json:
```json
{
    "body": "<a id='comment:35'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|\n|[cd6b13f](https://github.com/sagemath/sagetrac-mirror/commit/cd6b13f1e11ee10ff9d22d5972bc27ac64422c00)|`Trac 18061: document the definition of Atkin-Lehner operators`|",
    "created_at": "2015-08-20T13:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315546",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:35'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                               |
|------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------|
|[cd6b13f](https://github.com/sagemath/sagetrac-mirror/commit/cd6b13f1e11ee10ff9d22d5972bc27ac64422c00)|`Trac 18061: document the definition of Atkin-Lehner operators`|



---

archive/issue_comments_315547.json:
```json
{
    "body": "Changing commit from \"88bda8783bc188c0a5ceccc999e576c93cc399c2\" to \"cd6b13f1e11ee10ff9d22d5972bc27ac64422c00\"",
    "created_at": "2015-08-20T13:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315547",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "88bda8783bc188c0a5ceccc999e576c93cc399c2" to "cd6b13f1e11ee10ff9d22d5972bc27ac64422c00"



---

archive/issue_comments_315548.json:
```json
{
    "body": "<a id='comment:36'></a>\nAfter fixing the ticket description, I hope everything is consistent now.",
    "created_at": "2015-08-20T14:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315548",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:36'></a>
After fixing the ticket description, I hope everything is consistent now.



---

archive/issue_comments_315549.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n-Let *f* be a newform of level *n*, and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is a complex number *\u03b7* of absolute value 1 such that *W<sub>d</sub>f* = *\u03b7f*<sup>*</sup>, where *f*<sup>*</sup> is the form whose coefficients are the complex conjugates of those of *f*.\n+Let *f* be a newform of weight *k* for \u0393<sub>1</sub>(*n*), and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is (in the normalisation used by Sage) a complex number *\u03b7* of absolute value *d*^*k*/2 - 1^ such that *W<sub>d</sub>f* = *\u03b7f*<sup>*</sup>, where *f*<sup>*</sup> is a certain twist of *f*.\n \n-The main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that returns a pair `(eta, f_star)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* acting on a newform `f` and `f_star` is the conjugate form.\n+The main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that, given a newform `f`, returns a pair `(eta, g)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* on `f` and `g` is the appropriate twist of `f`.\n \n This also fixes the following bug.  Consider the following newform of weight 2 for \u0393<sub>1</sub>(30) with coefficients in **Q**(*i*):\n \n``````\n",
    "created_at": "2015-08-20T14:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315549",
    "user": "https://github.com/pjbruin"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
-Let *f* be a newform of level *n*, and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is a complex number *η* of absolute value 1 such that *W<sub>d</sub>f* = *ηf*<sup>*</sup>, where *f*<sup>*</sup> is the form whose coefficients are the complex conjugates of those of *f*.
+Let *f* be a newform of weight *k* for Γ<sub>1</sub>(*n*), and let *d* be a divisor of *n* that is coprime to *n/d*.  Then the Atkin-Lehner operator *W<sub>d</sub>* acts by a *pseudo-eigenvalue* on *f*: this is (in the normalisation used by Sage) a complex number *η* of absolute value *d*^*k*/2 - 1^ such that *W<sub>d</sub>f* = *ηf*<sup>*</sup>, where *f*<sup>*</sup> is a certain twist of *f*.
 
-The main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that returns a pair `(eta, f_star)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* acting on a newform `f` and `f_star` is the conjugate form.
+The main goal of this ticket is to add a method `Newform.atkin_lehner_action(d)` that, given a newform `f`, returns a pair `(eta, g)`, where `eta` is the pseudo-eigenvalue of *W<sub>d</sub>* on `f` and `g` is the appropriate twist of `f`.
 
 This also fixes the following bug.  Consider the following newform of weight 2 for Γ<sub>1</sub>(30) with coefficients in **Q**(*i*):
 
``````




---

archive/issue_comments_315550.json:
```json
{
    "body": "<a id='comment:37'></a>\nHi Peter,\n\nMega-pedantic comment: in the docstring for \"def atkin_lehner_eigenvalue\", the \"NOTE\" is untrue (as the accompanying example shows). It would be nice if we could get this merged, but our contributions are now so much intertwined that we can't really review each other's code -- we need a third-party reviewer.",
    "created_at": "2015-12-04T15:33:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315550",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:37'></a>
Hi Peter,

Mega-pedantic comment: in the docstring for "def atkin_lehner_eigenvalue", the "NOTE" is untrue (as the accompanying example shows). It would be nice if we could get this merged, but our contributions are now so much intertwined that we can't really review each other's code -- we need a third-party reviewer.



---

archive/issue_comments_315551.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-04T15:33:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315551",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_315552.json:
```json
{
    "body": "<a id='comment:38'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                                     |\n|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|\n|[0041931](https://github.com/sagemath/sagetrac-mirror/commit/0041931d71f2c870505f6781546c9cabf5dd6414)|`Trac 18061: remove incorrect statement in docstring`|",
    "created_at": "2015-12-07T22:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315552",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:38'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------|
|[0041931](https://github.com/sagemath/sagetrac-mirror/commit/0041931d71f2c870505f6781546c9cabf5dd6414)|`Trac 18061: remove incorrect statement in docstring`|



---

archive/issue_comments_315553.json:
```json
{
    "body": "Changing commit from \"cd6b13f1e11ee10ff9d22d5972bc27ac64422c00\" to \"0041931d71f2c870505f6781546c9cabf5dd6414\"",
    "created_at": "2015-12-07T22:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315553",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cd6b13f1e11ee10ff9d22d5972bc27ac64422c00" to "0041931d71f2c870505f6781546c9cabf5dd6414"



---

archive/issue_comments_315554.json:
```json
{
    "body": "<a id='comment:39'></a>\nHi David,\n> Mega-pedantic comment: in the docstring for \"def atkin_lehner_eigenvalue\", the \"NOTE\" is untrue (as the accompanying example shows).\n\nRemoved in the last commit, thanks for spotting this!\n> It would be nice if we could get this merged, but our contributions are now so much intertwined that we can't really review each other's code -- we need a third-party reviewer.\n\nI agree.",
    "created_at": "2015-12-07T22:17:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315554",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:39'></a>
Hi David,
> Mega-pedantic comment: in the docstring for "def atkin_lehner_eigenvalue", the "NOTE" is untrue (as the accompanying example shows).

Removed in the last commit, thanks for spotting this!
> It would be nice if we could get this merged, but our contributions are now so much intertwined that we can't really review each other's code -- we need a third-party reviewer.

I agree.



---

archive/issue_comments_315555.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-07T22:17:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315555",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_315556.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-12-10T09:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315556",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_315557.json:
```json
{
    "body": "<a id='comment:41'></a>\nThis now doesn't merge, because it conflicts with #19668 (merged in 6.10.rc0). I'll upload a rebased version shortly.",
    "created_at": "2015-12-10T09:32:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315557",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:41'></a>
This now doesn't merge, because it conflicts with #19668 (merged in 6.10.rc0). I'll upload a rebased version shortly.



---

archive/issue_comments_315558.json:
```json
{
    "body": "Changing branch from \"u/pbruin/18061-rebased\" to \"public/18061-rebase\"",
    "created_at": "2015-12-10T13:08:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315558",
    "user": "https://github.com/loefflerd"
}
```

Changing branch from "u/pbruin/18061-rebased" to "public/18061-rebase"



---

archive/issue_comments_315559.json:
```json
{
    "body": "<a id='comment:43'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                          |                                    |\n|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|\n|[559d7d0](https://github.com/sagemath/sagetrac-mirror/commit/559d7d0205cdcaf80427b67cf92a0de38ab9eb3c)|`Trac 18061: sort out merge fallout`|",
    "created_at": "2015-12-10T13:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315559",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                          |                                    |
|------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------|
|[559d7d0](https://github.com/sagemath/sagetrac-mirror/commit/559d7d0205cdcaf80427b67cf92a0de38ab9eb3c)|`Trac 18061: sort out merge fallout`|



---

archive/issue_comments_315560.json:
```json
{
    "body": "Changing commit from \"0041931d71f2c870505f6781546c9cabf5dd6414\" to \"559d7d0205cdcaf80427b67cf92a0de38ab9eb3c\"",
    "created_at": "2015-12-10T13:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315560",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "0041931d71f2c870505f6781546c9cabf5dd6414" to "559d7d0205cdcaf80427b67cf92a0de38ab9eb3c"



---

archive/issue_comments_315561.json:
```json
{
    "body": "<a id='comment:44'></a>\nI rebased it to 6.10.rc0, and created a new public branch.",
    "created_at": "2015-12-10T13:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315561",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:44'></a>
I rebased it to 6.10.rc0, and created a new public branch.



---

archive/issue_comments_315562.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-12-10T13:13:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315562",
    "user": "https://github.com/loefflerd"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_315563.json:
```json
{
    "body": "<a id='comment:45'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[adea89b](https://github.com/sagemath/sagetrac-mirror/commit/adea89bac4a262dbd0651a85720b7f0c1c794bb6)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|",
    "created_at": "2016-08-11T07:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315563",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[adea89b](https://github.com/sagemath/sagetrac-mirror/commit/adea89bac4a262dbd0651a85720b7f0c1c794bb6)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|



---

archive/issue_comments_315564.json:
```json
{
    "body": "Changing commit from \"559d7d0205cdcaf80427b67cf92a0de38ab9eb3c\" to \"adea89bac4a262dbd0651a85720b7f0c1c794bb6\"",
    "created_at": "2016-08-11T07:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315564",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "559d7d0205cdcaf80427b67cf92a0de38ab9eb3c" to "adea89bac4a262dbd0651a85720b7f0c1c794bb6"



---

archive/issue_comments_315565.json:
```json
{
    "body": "<a id='comment:46'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[d702cb3](https://github.com/sagemath/sagetrac-mirror/commit/d702cb3992a65d5a0280b06b5b6ab389dcd961ac)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|",
    "created_at": "2016-10-11T14:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315565",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:46'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[d702cb3](https://github.com/sagemath/sagetrac-mirror/commit/d702cb3992a65d5a0280b06b5b6ab389dcd961ac)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|



---

archive/issue_comments_315566.json:
```json
{
    "body": "Changing commit from \"adea89bac4a262dbd0651a85720b7f0c1c794bb6\" to \"d702cb3992a65d5a0280b06b5b6ab389dcd961ac\"",
    "created_at": "2016-10-11T14:29:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315566",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "adea89bac4a262dbd0651a85720b7f0c1c794bb6" to "d702cb3992a65d5a0280b06b5b6ab389dcd961ac"



---

archive/issue_comments_315567.json:
```json
{
    "body": "Changing commit from \"d702cb3992a65d5a0280b06b5b6ab389dcd961ac\" to \"3ffdf4a8775ef083b8576b8409ee5eb77e00d50a\"",
    "created_at": "2016-10-13T06:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315567",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d702cb3992a65d5a0280b06b5b6ab389dcd961ac" to "3ffdf4a8775ef083b8576b8409ee5eb77e00d50a"



---

archive/issue_comments_315568.json:
```json
{
    "body": "<a id='comment:47'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                                             |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|\n|[3ffdf4a](https://github.com/sagemath/sagetrac-mirror/commit/3ffdf4a8775ef083b8576b8409ee5eb77e00d50a)|`Trac 18061: refer correctly to ComplexField, QQ, ZZ (now imported directly)`|",
    "created_at": "2016-10-13T06:53:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315568",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:47'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                                             |
|-------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------|
|[3ffdf4a](https://github.com/sagemath/sagetrac-mirror/commit/3ffdf4a8775ef083b8576b8409ee5eb77e00d50a)|`Trac 18061: refer correctly to ComplexField, QQ, ZZ (now imported directly)`|



---

archive/issue_comments_315569.json:
```json
{
    "body": "<a id='comment:48'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|\n|[07e9003](https://github.com/sagemath/sagetrac-mirror/commit/07e90033bb02ebe4461302851b8acc9e7bb0eb6f)|`Trac 18061: update references [Atkin-Li] -> [AL1978]`|",
    "created_at": "2017-01-06T09:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315569",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:48'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------|
|[07e9003](https://github.com/sagemath/sagetrac-mirror/commit/07e90033bb02ebe4461302851b8acc9e7bb0eb6f)|`Trac 18061: update references [Atkin-Li] -> [AL1978]`|



---

archive/issue_comments_315570.json:
```json
{
    "body": "Changing commit from \"3ffdf4a8775ef083b8576b8409ee5eb77e00d50a\" to \"07e90033bb02ebe4461302851b8acc9e7bb0eb6f\"",
    "created_at": "2017-01-06T09:27:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315570",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3ffdf4a8775ef083b8576b8409ee5eb77e00d50a" to "07e90033bb02ebe4461302851b8acc9e7bb0eb6f"



---

archive/issue_comments_315571.json:
```json
{
    "body": "<a id='comment:49'></a>\nReferences had to be changed due to #21454.",
    "created_at": "2017-01-06T09:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315571",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:49'></a>
References had to be changed due to #21454.



---

archive/issue_comments_315572.json:
```json
{
    "body": "<a id='comment:50'></a>\nFailing doctests in `sage/modular/abvar/lseries.py`, see [patchbot report](https://patchbot.sagemath.org/log/18061/Ubuntu/16.04/x86_64/3.13.0-83-generic/poseidon/2017-01-26%2018:44:56?short)",
    "created_at": "2017-01-27T08:20:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315572",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:50'></a>
Failing doctests in `sage/modular/abvar/lseries.py`, see [patchbot report](https://patchbot.sagemath.org/log/18061/Ubuntu/16.04/x86_64/3.13.0-83-generic/poseidon/2017-01-26%2018:44:56?short)



---

archive/issue_comments_315573.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-01-27T08:20:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315573",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_315574.json:
```json
{
    "body": "<a id='comment:51'></a>\nI am CC-ing Kevin Lui and William Stein because the failing doctest was introduced in #21496.  I suspect that the numerical value occurring in the following doctest may be incorrect:\n\n```\nsage: L = J1(23).lseries(); L\nComplex L-series attached to Abelian variety J1(23) of dimension 12\nsage: L(1)\n1.71571957480487e-7\n```\n\nWith the current branch, the doctest fails with a `ValueError` because some of the cusp forms occurring in the decomposition of J_1(23) are not eigenforms for the Atkin-Lehner operator.  After fixing the method `ModularForm_abstract.lseries()` to dispense with this assumption (work in progress, not pushed yet), I get\n\n```\nsage: L = J1(23).lseries(); L\nComplex L-series attached to Abelian variety J1(23) of dimension 12\nsage: L(1)\n0.000129519861426989 + 1.14001148377577e-19*I\n```\nThis value agrees with the product of all special values *L*(*f*, 1) with *f* ranging over the 12 complex primitive forms of weight 2 for Gamma_1(23), which according to the LMFDB pages for the modular forms [23.2.1.a](http://www.lmfdb.org/ModularForm/GL2/Q/holomorphic/23/2/1/a/) and [23.2.2.a](http://www.lmfdb.org/ModularForm/GL2/Q/holomorphic/23/2/2/a/) are\n\n```\n0.4503793707,\n0.5516057856,\n0.2732227586 - 0.2394635951*I,\n0.4450567187 + 0.2281314535*I,\n0.5144735331 + 0.0030140754*I,\n0.4295189659 - 0.1720855959*I,\n0.5226459551 - 0.0741564295*I,\n0.5226459551 + 0.0741564295*I,\n0.4295189659 + 0.1720855959*I,\n0.5144735331 - 0.0030140754*I,\n0.4450567187 - 0.2281314535*I,\n0.2732227586 + 0.2394635951*I\n```\n(follow the various links to the L-functions on these pages, and look at the values *L*(*f*, 1/2); note that LMFDB uses the \"analytic\" normalisation).\n\nUnfortunately, Magma agrees with neither of the above two values:\n\n```\n> Evaluate(LSeries(JOne(23)), 1);\n8.07776970747857754200906998408E-8 + 5.36796212774822177732076691797E-8*i\n```",
    "created_at": "2017-01-30T13:56:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315574",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:51'></a>
I am CC-ing Kevin Lui and William Stein because the failing doctest was introduced in #21496.  I suspect that the numerical value occurring in the following doctest may be incorrect:

```
sage: L = J1(23).lseries(); L
Complex L-series attached to Abelian variety J1(23) of dimension 12
sage: L(1)
1.71571957480487e-7
```

With the current branch, the doctest fails with a `ValueError` because some of the cusp forms occurring in the decomposition of J_1(23) are not eigenforms for the Atkin-Lehner operator.  After fixing the method `ModularForm_abstract.lseries()` to dispense with this assumption (work in progress, not pushed yet), I get

```
sage: L = J1(23).lseries(); L
Complex L-series attached to Abelian variety J1(23) of dimension 12
sage: L(1)
0.000129519861426989 + 1.14001148377577e-19*I
```
This value agrees with the product of all special values *L*(*f*, 1) with *f* ranging over the 12 complex primitive forms of weight 2 for Gamma_1(23), which according to the LMFDB pages for the modular forms [23.2.1.a](http://www.lmfdb.org/ModularForm/GL2/Q/holomorphic/23/2/1/a/) and [23.2.2.a](http://www.lmfdb.org/ModularForm/GL2/Q/holomorphic/23/2/2/a/) are

```
0.4503793707,
0.5516057856,
0.2732227586 - 0.2394635951*I,
0.4450567187 + 0.2281314535*I,
0.5144735331 + 0.0030140754*I,
0.4295189659 - 0.1720855959*I,
0.5226459551 - 0.0741564295*I,
0.5226459551 + 0.0741564295*I,
0.4295189659 + 0.1720855959*I,
0.5144735331 - 0.0030140754*I,
0.4450567187 - 0.2281314535*I,
0.2732227586 + 0.2394635951*I
```
(follow the various links to the L-functions on these pages, and look at the values *L*(*f*, 1/2); note that LMFDB uses the "analytic" normalisation).

Unfortunately, Magma agrees with neither of the above two values:

```
> Evaluate(LSeries(JOne(23)), 1);
8.07776970747857754200906998408E-8 + 5.36796212774822177732076691797E-8*i
```



---

archive/issue_comments_315575.json:
```json
{
    "body": "<a id='comment:52'></a>\nHere is a smaller example of incorrectly computed special *L*-values of cusp forms:\n\n```\nsage: f = Newforms(Gamma1(13), 2, names='a')[0]  # coefficient field QQ(zeta_3)\nsage: f.lseries(embedding=0)(1)\n0.150417043086554 - 0.0100341694561220*I\nsage: f.lseries(embedding=1)(1)\n0.150417043086554 + 0.0100341694561220*I\nsage: J1(13).lseries()(1)  # product of the above two\n0.0227259714075763\n```\nWith my branch, these become\n\n```\nsage: f.lseries(embedding=0)(1)\n0.298115272465799 - 0.0402203326076734*I\nsage: f.lseries(embedding=1)(1)\n0.298115272465799 + 0.0402203326076732*I\nsage: J1(13).lseries()(1)  # product of the above two\n0.0904903908324296 - 4.51028103753970e-17*I\n```\nwhich agrees with the LMFDB data for [newform 13.2.4.a](http://www.lmfdb.org/ModularForm/GL2/Q/holomorphic/13/2/4/a/).\n\nHere Magma is almost certainly wrong (the result should be close to a real number):\n\n```\n> Evaluate(LSeries(JOne(13)), 1);\n0.00926625827718259912085805050640 - 0.0306402029795322002630256221347*i\n```",
    "created_at": "2017-01-30T14:26:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315575",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:52'></a>
Here is a smaller example of incorrectly computed special *L*-values of cusp forms:

```
sage: f = Newforms(Gamma1(13), 2, names='a')[0]  # coefficient field QQ(zeta_3)
sage: f.lseries(embedding=0)(1)
0.150417043086554 - 0.0100341694561220*I
sage: f.lseries(embedding=1)(1)
0.150417043086554 + 0.0100341694561220*I
sage: J1(13).lseries()(1)  # product of the above two
0.0227259714075763
```
With my branch, these become

```
sage: f.lseries(embedding=0)(1)
0.298115272465799 - 0.0402203326076734*I
sage: f.lseries(embedding=1)(1)
0.298115272465799 + 0.0402203326076732*I
sage: J1(13).lseries()(1)  # product of the above two
0.0904903908324296 - 4.51028103753970e-17*I
```
which agrees with the LMFDB data for [newform 13.2.4.a](http://www.lmfdb.org/ModularForm/GL2/Q/holomorphic/13/2/4/a/).

Here Magma is almost certainly wrong (the result should be close to a real number):

```
> Evaluate(LSeries(JOne(13)), 1);
0.00926625827718259912085805050640 - 0.0306402029795322002630256221347*i
```



---

archive/issue_comments_315576.json:
```json
{
    "body": "Changing commit from \"07e90033bb02ebe4461302851b8acc9e7bb0eb6f\" to \"d3ec5fbdea648bd8bbf6b89d5a3ea969d587307b\"",
    "created_at": "2017-01-30T16:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315576",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "07e90033bb02ebe4461302851b8acc9e7bb0eb6f" to "d3ec5fbdea648bd8bbf6b89d5a3ea969d587307b"



---

archive/issue_comments_315577.json:
```json
{
    "body": "<a id='comment:53'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[f07162a](https://github.com/sagemath/sagetrac-mirror/commit/f07162ab0efc4a55535c20bdbe7a1f5432f7fc5b)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|\n|[b0cfc85](https://github.com/sagemath/sagetrac-mirror/commit/b0cfc8527f3eb4d0162c51045e66532ca6918e1f)|`Trac 18061: implement/use atkin_lehner_action() for all modular forms`|\n|[0b8b81e](https://github.com/sagemath/sagetrac-mirror/commit/0b8b81eae5401396b7ea4db55b3f8dc5c1a0c49a)|`Trac 18061: do not restrict to Atkin-Lehner eigenforms in ModularForm_abstract.lseries()`|\n|[d3ec5fb](https://github.com/sagemath/sagetrac-mirror/commit/d3ec5fbdea648bd8bbf6b89d5a3ea969d587307b)|`Trac 18061: trivial docstring changes`|",
    "created_at": "2017-01-30T16:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315577",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:53'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[f07162a](https://github.com/sagemath/sagetrac-mirror/commit/f07162ab0efc4a55535c20bdbe7a1f5432f7fc5b)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|
|[b0cfc85](https://github.com/sagemath/sagetrac-mirror/commit/b0cfc8527f3eb4d0162c51045e66532ca6918e1f)|`Trac 18061: implement/use atkin_lehner_action() for all modular forms`|
|[0b8b81e](https://github.com/sagemath/sagetrac-mirror/commit/0b8b81eae5401396b7ea4db55b3f8dc5c1a0c49a)|`Trac 18061: do not restrict to Atkin-Lehner eigenforms in ModularForm_abstract.lseries()`|
|[d3ec5fb](https://github.com/sagemath/sagetrac-mirror/commit/d3ec5fbdea648bd8bbf6b89d5a3ea969d587307b)|`Trac 18061: trivial docstring changes`|



---

archive/issue_comments_315578.json:
```json
{
    "body": "<a id='comment:54'></a>\nHere are some improvements that should fix the above problems.",
    "created_at": "2017-01-30T16:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315578",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:54'></a>
Here are some improvements that should fix the above problems.



---

archive/issue_comments_315579.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-01-30T16:42:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315579",
    "user": "https://github.com/pjbruin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_315580.json:
```json
{
    "body": "<a id='comment:55'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|\n|[7030e6e](https://github.com/sagemath/sagetrac-mirror/commit/7030e6ebd2f8ef6be84a90ae376bc74947732e3b)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|",
    "created_at": "2017-03-13T08:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315580",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:55'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------|
|[7030e6e](https://github.com/sagemath/sagetrac-mirror/commit/7030e6ebd2f8ef6be84a90ae376bc74947732e3b)|`Merge branch 'develop' into ticket/18061-atkin_lehner_action`|



---

archive/issue_comments_315581.json:
```json
{
    "body": "Changing commit from \"d3ec5fbdea648bd8bbf6b89d5a3ea969d587307b\" to \"7030e6ebd2f8ef6be84a90ae376bc74947732e3b\"",
    "created_at": "2017-03-13T08:27:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315581",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "d3ec5fbdea648bd8bbf6b89d5a3ea969d587307b" to "7030e6ebd2f8ef6be84a90ae376bc74947732e3b"



---

archive/issue_events_058290.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-13T20:02:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "milestone": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58290"
}
```



---

archive/issue_events_058291.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-03-13T20:02:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58291"
}
```



---

archive/issue_comments_315582.json:
```json
{
    "body": "<a id='comment:56'></a>\ngreen bot, please review",
    "created_at": "2017-03-13T20:02:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315582",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:56'></a>
green bot, please review



---

archive/issue_comments_315583.json:
```json
{
    "body": "Changing commit from \"7030e6ebd2f8ef6be84a90ae376bc74947732e3b\" to \"cf0278bf9e6536c33b3ea59946e8124933156b80\"",
    "created_at": "2017-03-28T12:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315583",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "7030e6ebd2f8ef6be84a90ae376bc74947732e3b" to "cf0278bf9e6536c33b3ea59946e8124933156b80"



---

archive/issue_comments_315584.json:
```json
{
    "body": "<a id='comment:57'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                      |\n|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|\n|[cf0278b](https://github.com/sagemath/sagetrac-mirror/commit/cf0278bf9e6536c33b3ea59946e8124933156b80)|`Trac 18061: make doctest more robust`|",
    "created_at": "2017-03-28T12:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315584",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:57'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                      |
|-------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------|
|[cf0278b](https://github.com/sagemath/sagetrac-mirror/commit/cf0278bf9e6536c33b3ea59946e8124933156b80)|`Trac 18061: make doctest more robust`|



---

archive/issue_comments_315585.json:
```json
{
    "body": "<a id='comment:58'></a>\nImproved a doctest to avoid failures due to \"numerical noise\".",
    "created_at": "2017-03-28T12:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315585",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:58'></a>
Improved a doctest to avoid failures due to "numerical noise".



---

archive/issue_comments_315586.json:
```json
{
    "body": "<a id='comment:59'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                              |\n|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|\n|[3ba3aff](https://github.com/sagemath/sagetrac-mirror/commit/3ba3aff60b36e0dfc96c71606225b92251258e96)|`Merge branch 'public/18061-rebase' in 8.0.b0`|",
    "created_at": "2017-03-31T07:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315586",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:59'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                              |
|-------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------|
|[3ba3aff](https://github.com/sagemath/sagetrac-mirror/commit/3ba3aff60b36e0dfc96c71606225b92251258e96)|`Merge branch 'public/18061-rebase' in 8.0.b0`|



---

archive/issue_comments_315587.json:
```json
{
    "body": "Changing commit from \"cf0278bf9e6536c33b3ea59946e8124933156b80\" to \"3ba3aff60b36e0dfc96c71606225b92251258e96\"",
    "created_at": "2017-03-31T07:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315587",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "cf0278bf9e6536c33b3ea59946e8124933156b80" to "3ba3aff60b36e0dfc96c71606225b92251258e96"



---

archive/issue_comments_315588.json:
```json
{
    "body": "<a id='comment:60'></a>\ngreen bot",
    "created_at": "2017-04-05T10:15:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315588",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:60'></a>
green bot



---

archive/issue_events_058292.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-04-05T10:15:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58292"
}
```



---

archive/issue_events_058293.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-04-05T10:15:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58293"
}
```



---

archive/issue_comments_315589.json:
```json
{
    "body": "<a id='comment:61'></a>\ngreen bot ! experts and interested people, please look at this ticket !",
    "created_at": "2017-05-10T11:21:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315589",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:61'></a>
green bot ! experts and interested people, please look at this ticket !



---

archive/issue_comments_315590.json:
```json
{
    "body": "<a id='comment:62'></a>\n**PING** ?",
    "created_at": "2017-05-18T19:05:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315590",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:62'></a>
**PING** ?



---

archive/issue_comments_315591.json:
```json
{
    "body": "Changing dependencies from \"#18068, #18072, #18086, #18478\" to \"\"",
    "created_at": "2017-06-22T11:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315591",
    "user": "https://github.com/fchapoton"
}
```

Changing dependencies from "#18068, #18072, #18086, #18478" to ""



---

archive/issue_comments_315592.json:
```json
{
    "body": "<a id='comment:65'></a>\nBranch pushed to git repo; I updated commit sha1. New commits:\n|                                                                                                                                           |                                     |\n|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|\n|[41baa68](https://github.com/sagemath/sagetrac-mirror/commit/41baa6825bd3018d1c443b53e1f0aba0242ea046)|`Trac 18061: fix .. SEEALSO:: syntax`|",
    "created_at": "2017-07-11T07:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315592",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:65'></a>
Branch pushed to git repo; I updated commit sha1. New commits:
|                                                                                                                                           |                                     |
|-------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------|
|[41baa68](https://github.com/sagemath/sagetrac-mirror/commit/41baa6825bd3018d1c443b53e1f0aba0242ea046)|`Trac 18061: fix .. SEEALSO:: syntax`|



---

archive/issue_comments_315593.json:
```json
{
    "body": "Changing commit from \"3ba3aff60b36e0dfc96c71606225b92251258e96\" to \"41baa6825bd3018d1c443b53e1f0aba0242ea046\"",
    "created_at": "2017-07-11T07:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315593",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "3ba3aff60b36e0dfc96c71606225b92251258e96" to "41baa6825bd3018d1c443b53e1f0aba0242ea046"



---

archive/issue_comments_315594.json:
```json
{
    "body": "<a id='comment:66'></a>\nThe \"blocks\" plugin of the patchbot complains about the `.. SEEALSO::` blocks inserted by this ticket; see [this report](https://patchbot.sagemath.org/log/18061/Ubuntu/15.10/x86_64/3.13.0-123-generic/sagemath-patchbot-docker/2017-07-06%2006:51:02?plugin=blocks&diff=/log/0/Ubuntu/15.10/x86_64/3.13.0-123-generic/sagemath-patchbot-docker/2017-07-05%2023%3A23%3A47&ticket=18061&base=8.0.rc1).  One of them was missing a colon, but the others had the correct syntax as far as I can see.\n\nFr\u00e9d\u00e9ric, could you perhaps check the plugin to see if it is doing the right thing?",
    "created_at": "2017-07-11T07:58:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315594",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:66'></a>
The "blocks" plugin of the patchbot complains about the `.. SEEALSO::` blocks inserted by this ticket; see [this report](https://patchbot.sagemath.org/log/18061/Ubuntu/15.10/x86_64/3.13.0-123-generic/sagemath-patchbot-docker/2017-07-06%2006:51:02?plugin=blocks&diff=/log/0/Ubuntu/15.10/x86_64/3.13.0-123-generic/sagemath-patchbot-docker/2017-07-05%2023%3A23%3A47&ticket=18061&base=8.0.rc1).  One of them was missing a colon, but the others had the correct syntax as far as I can see.

Frédéric, could you perhaps check the plugin to see if it is doing the right thing?



---

archive/issue_comments_315595.json:
```json
{
    "body": "<a id='comment:67'></a>\nThis has been fixed already. In fact, patchbot 2.6.9 is not quite the latest, but I forgot to make a tag for 2.7.0\n\nEDIT: patchbot 2.7.0 now officially the latest version",
    "created_at": "2017-07-11T08:01:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315595",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:67'></a>
This has been fixed already. In fact, patchbot 2.6.9 is not quite the latest, but I forgot to make a tag for 2.7.0

EDIT: patchbot 2.7.0 now officially the latest version



---

archive/issue_events_058294.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-26T14:01:26Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "milestone": "sage-8.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58294"
}
```



---

archive/issue_events_058295.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2017-08-26T14:01:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "milestone": "sage-8.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58295"
}
```



---

archive/issue_comments_315596.json:
```json
{
    "body": "<a id='comment:68'></a>\nI think one could set this one to positive-review. There is one fully-green bot.\n\nConfirmation, somebody ?",
    "created_at": "2017-08-26T14:01:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315596",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:68'></a>
I think one could set this one to positive-review. There is one fully-green bot.

Confirmation, somebody ?



---

archive/issue_comments_315597.json:
```json
{
    "body": "<a id='comment:69'></a>\nReplying to [chapoton](#comment%3A68):\n> I think one could set this one to positive-review. There is one fully-green bot.\n> \n> Confirmation, somebody ?\n\nPersonally I would be very happy if this could finally be merged.  It fixes known bugs and is not known to introduce new ones.  If someone could verify that the fixed doctests in `sage/modular/abvar/lseries.py` are correct (see[comment:51](#comment%3A51)) then maybe together with the fact that David and I have looked at each other's code, that could count as a positive review?",
    "created_at": "2017-08-30T13:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315597",
    "user": "https://github.com/pjbruin"
}
```

<a id='comment:69'></a>
Replying to [chapoton](#comment%3A68):
> I think one could set this one to positive-review. There is one fully-green bot.
> 
> Confirmation, somebody ?

Personally I would be very happy if this could finally be merged.  It fixes known bugs and is not known to introduce new ones.  If someone could verify that the fixed doctests in `sage/modular/abvar/lseries.py` are correct (see[comment:51](#comment%3A51)) then maybe together with the fact that David and I have looked at each other's code, that could count as a positive review?



---

archive/issue_comments_315598.json:
```json
{
    "body": "<a id='comment:70'></a>\nok, let it be. It has been waiting for long enough.\n\nEDIT: I confirm that magma V2.22-3 has not the same value as us for J1(23). Let us keep that for another ticket.",
    "created_at": "2017-08-30T13:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315598",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:70'></a>
ok, let it be. It has been waiting for long enough.

EDIT: I confirm that magma V2.22-3 has not the same value as us for J1(23). Let us keep that for another ticket.



---

archive/issue_comments_315599.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Peter Bruin, David Loeffler, Fr\u00e9d\u00e9ric Chapoton\"",
    "created_at": "2017-08-30T13:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315599",
    "user": "https://github.com/fchapoton"
}
```

Changing reviewer from "" to "Peter Bruin, David Loeffler, Frédéric Chapoton"



---

archive/issue_comments_315600.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-08-30T13:31:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315600",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_315601.json:
```json
{
    "body": "Changing branch from \"public/18061-rebase\" to \"41baa6825bd3018d1c443b53e1f0aba0242ea046\"",
    "created_at": "2017-09-04T06:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315601",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "public/18061-rebase" to "41baa6825bd3018d1c443b53e1f0aba0242ea046"



---

archive/issue_comments_315602.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-09-04T06:11:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18061#issuecomment-315602",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_058296.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2017-09-04T06:11:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18061",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18061#event-58296"
}
```
