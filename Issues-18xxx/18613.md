# Issue 18613: Errors with is_isomorphic() for trivial cones

archive/issues_018376.json:
```json
{
    "assignees": [],
    "body": "Random testing (from Ticket #18454) reveals the following. I'm not familiar with the `Fan` stuff, so this might not even be an issue mathematically.\n\n```\nsage: K = Cone([], ToricLattice(0))\nsage: K.is_isomorphic(K)\n...\nKeyError: (frozenset([]), frozenset([]))\n```\n\n```\nsage: K = Cone([(0,)])\nsage: K.is_isomorphic(K)\n...\nTypeError: 'bool' object has no attribute '__getitem__'\n```\n\n\nKeywords: **cone**\n\nBranch: **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**\n\nReviewer: **Michael Orlitzky, Volker Braun**\n\nAuthor: **Andrey Novoseltsev**\n\nComponent: **geometry**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18613_\n\n",
    "closed_at": "2015-08-13T20:21:17Z",
    "created_at": "2015-06-04T21:25:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20geometry",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Errors with is_isomorphic() for trivial cones",
    "type": "issue",
    "updated_at": "2015-08-14T01:23:12Z",
    "url": "https://github.com/sagemath/sage/issues/18613",
    "user": "https://github.com/orlitzky"
}
```
Random testing (from Ticket #18454) reveals the following. I'm not familiar with the `Fan` stuff, so this might not even be an issue mathematically.

```
sage: K = Cone([], ToricLattice(0))
sage: K.is_isomorphic(K)
...
KeyError: (frozenset([]), frozenset([]))
```

```
sage: K = Cone([(0,)])
sage: K.is_isomorphic(K)
...
TypeError: 'bool' object has no attribute '__getitem__'
```


Keywords: **cone**

Branch: **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**

Reviewer: **Michael Orlitzky, Volker Braun**

Author: **Andrey Novoseltsev**

Component: **geometry**

_Issue created by migration from https://trac.sagemath.org/ticket/18613_





---

archive/issue_events_262156.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2015-06-04T21:25:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262156"
}
```



---

archive/issue_events_262157.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2015-06-04T21:25:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20geometry",
    "label_color": "0000ff",
    "label_name": "c: geometry",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262157"
}
```



---

archive/issue_events_262158.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2015-06-04T21:25:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262158"
}
```



---

archive/issue_events_262159.json:
```json
{
    "actor": "https://github.com/orlitzky",
    "created_at": "2015-06-04T21:25:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262159"
}
```



---

archive/issue_comments_258790.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nWell, mathematically the cone consisting of the origin in a 0-dimensional space is certainly isomorphic to itself and correctly handling such cases is often important for algorithms that ran into corner cases on less trivial examples.\n\nOn an unrelated note it is sad I didn't notice this ticket before, looks like RSS on trac has changed.",
    "created_at": "2015-07-30T00:16:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258790",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:1" align="right">comment:1</div>

Well, mathematically the cone consisting of the origin in a 0-dimensional space is certainly isomorphic to itself and correctly handling such cases is often important for algorithms that ran into corner cases on less trivial examples.

On an unrelated note it is sad I didn't notice this ticket before, looks like RSS on trac has changed.



---

archive/issue_comments_258791.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nSo the problem is with constructing the cone lattice of a fan containing the trivial cone only. We probably should call/get\n\n```\nsage: list(sage.geometry.cone.Hasse_diagram_from_incidences([()], [()]))\n[((), (0,)), ((0,), ())]\n```\nfor the lattice with a single atom (fan) and single coatom (trivial cone). We seem to correctly pass the list of coatoms, but have no atoms at all.",
    "created_at": "2015-07-30T01:33:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258791",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:2" align="right">comment:2</div>

So the problem is with constructing the cone lattice of a fan containing the trivial cone only. We probably should call/get

```
sage: list(sage.geometry.cone.Hasse_diagram_from_incidences([()], [()]))
[((), (0,)), ((0,), ())]
```
for the lattice with a single atom (fan) and single coatom (trivial cone). We seem to correctly pass the list of coatoms, but have no atoms at all.



---

archive/issue_comments_258792.json:
```json
{
    "body": "Branch: **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)**",
    "created_at": "2015-07-30T21:44:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258792",
    "user": "https://github.com/novoselt"
}
```

Branch: **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)**



---

archive/issue_comments_258793.json:
```json
{
    "body": "Author: **Andrey Novoseltsev**",
    "created_at": "2015-07-30T21:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258793",
    "user": "https://github.com/novoselt"
}
```

Author: **Andrey Novoseltsev**



---

archive/issue_events_262160.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-07-30T21:46:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262160"
}
```



---

archive/issue_comments_258794.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nBoth problems are fixed, thanks for detecting them!\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/cd6aec8491552051be48bfb278d43cf0798e8ef6\"><code>cd6aec8</code></a></td><td><code>Fix isomorphism check for trivial cones.</code></td></tr></table>\n",
    "created_at": "2015-07-30T21:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258794",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:4" align="right">comment:4</div>

Both problems are fixed, thanks for detecting them!

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/cd6aec8491552051be48bfb278d43cf0798e8ef6"><code>cd6aec8</code></a></td><td><code>Fix isomorphism check for trivial cones.</code></td></tr></table>




---

archive/issue_comments_258795.json:
```json
{
    "body": "Commit: **[`cd6aec8`](https://github.com/sagemath/sagetrac-mirror/commit/cd6aec8491552051be48bfb278d43cf0798e8ef6)**",
    "created_at": "2015-07-30T21:46:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258795",
    "user": "https://github.com/novoselt"
}
```

Commit: **[`cd6aec8`](https://github.com/sagemath/sagetrac-mirror/commit/cd6aec8491552051be48bfb278d43cf0798e8ef6)**



---

archive/issue_comments_258796.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nhum, what is this change in \"generic_graph\" doing in this branch ??",
    "created_at": "2015-07-31T11:51:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258796",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:5" align="right">comment:5</div>

hum, what is this change in "generic_graph" doing in this branch ??



---

archive/issue_comments_258797.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThere were two reasons why cones could not check isomorphness: corner case handling in fans and getting isomorphism with maps from trivial graphs.",
    "created_at": "2015-07-31T18:41:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258797",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:6" align="right">comment:6</div>

There were two reasons why cones could not check isomorphness: corner case handling in fans and getting isomorphism with maps from trivial graphs.



---

archive/issue_comments_258798.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThis ticket is a treasure chest of chained bugs, the latest one is\n\n```\nsage: K = Cone([(0,0)]); K.is_isomorphic(K)\n```\nwhich, after fixing a corner case in fan code, boils down to\n\n```\nsage: matrix(2, 1).echelon_form().is_mutable()\nFalse\nsage: matrix(2, 0).echelon_form().is_mutable()\nTrue\n```\nworking on it...",
    "created_at": "2015-07-31T23:36:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258798",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:7" align="right">comment:7</div>

This ticket is a treasure chest of chained bugs, the latest one is

```
sage: K = Cone([(0,0)]); K.is_isomorphic(K)
```
which, after fixing a corner case in fan code, boils down to

```
sage: matrix(2, 1).echelon_form().is_mutable()
False
sage: matrix(2, 0).echelon_form().is_mutable()
True
```
working on it...



---

archive/issue_comments_258799.json:
```json
{
    "body": "Work Issues: **mutability issues**",
    "created_at": "2015-07-31T23:59:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258799",
    "user": "https://github.com/novoselt"
}
```

Work Issues: **mutability issues**



---

archive/issue_events_262161.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-07-31T23:59:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262161"
}
```



---

archive/issue_events_262162.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-07-31T23:59:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262162"
}
```



---

archive/issue_comments_258800.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nBut since I am not quite sure what to do: https://groups.google.com/d/topic/sage-devel/rmQbBbddUwY/discussion",
    "created_at": "2015-07-31T23:59:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258800",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:8" align="right">comment:8</div>

But since I am not quite sure what to do: https://groups.google.com/d/topic/sage-devel/rmQbBbddUwY/discussion



---

archive/issue_comments_258801.json:
```json
{
    "body": "Changed commit from **[`cd6aec8`](https://github.com/sagemath/sagetrac-mirror/commit/cd6aec8491552051be48bfb278d43cf0798e8ef6)** to **[`af4b248`](https://github.com/sagemath/sagetrac-mirror/commit/af4b24856cedf243cbcb515c3e42a28c06367b6c)**",
    "created_at": "2015-08-01T00:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258801",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`cd6aec8`](https://github.com/sagemath/sagetrac-mirror/commit/cd6aec8491552051be48bfb278d43cf0798e8ef6)** to **[`af4b248`](https://github.com/sagemath/sagetrac-mirror/commit/af4b24856cedf243cbcb515c3e42a28c06367b6c)**



---

archive/issue_comments_258802.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/af4b24856cedf243cbcb515c3e42a28c06367b6c\"><code>af4b248</code></a></td><td><code>Trivial cones in 2-d lattices also have isomorphism issues.</code></td></tr></table>\n",
    "created_at": "2015-08-01T00:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258802",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/af4b24856cedf243cbcb515c3e42a28c06367b6c"><code>af4b248</code></a></td><td><code>Trivial cones in 2-d lattices also have isomorphism issues.</code></td></tr></table>




---

archive/issue_comments_258803.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nfound a typo:\n\n```\ntrac:`18613`\n```\nmissing the colon before trac",
    "created_at": "2015-08-03T18:40:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258803",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:10" align="right">comment:10</div>

found a typo:

```
trac:`18613`
```
missing the colon before trac



---

archive/issue_comments_258804.json:
```json
{
    "body": "Changed commit from **[`af4b248`](https://github.com/sagemath/sagetrac-mirror/commit/af4b24856cedf243cbcb515c3e42a28c06367b6c)** to **[`c02beee`](https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa)**",
    "created_at": "2015-08-11T01:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258804",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`af4b248`](https://github.com/sagemath/sagetrac-mirror/commit/af4b24856cedf243cbcb515c3e42a28c06367b6c)** to **[`c02beee`](https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa)**



---

archive/issue_comments_258805.json:
```json
{
    "body": "<div id=\"comment:11\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa\"><code>c02beee</code></a></td><td><code>Fix echelon_form of trivial matrices.</code></td></tr></table>\n",
    "created_at": "2015-08-11T01:44:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258805",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:11"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa"><code>c02beee</code></a></td><td><code>Fix echelon_form of trivial matrices.</code></td></tr></table>




---

archive/issue_comments_258806.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nFixed the typo and cleaned up `echelon_form` a bit.",
    "created_at": "2015-08-11T01:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258806",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:12" align="right">comment:12</div>

Fixed the typo and cleaned up `echelon_form` a bit.



---

archive/issue_comments_258807.json:
```json
{
    "body": "Changed work issues from **mutability issues** to none",
    "created_at": "2015-08-11T01:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258807",
    "user": "https://github.com/novoselt"
}
```

Changed work issues from **mutability issues** to none



---

archive/issue_events_262163.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-08-11T01:45:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262163"
}
```



---

archive/issue_events_262164.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-08-11T01:45:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262164"
}
```



---

archive/issue_events_262165.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-11T18:55:15Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262165"
}
```



---

archive/issue_events_262166.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-11T18:55:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "milestone_number": null,
    "milestone_title": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262166"
}
```



---

archive/issue_comments_258808.json:
```json
{
    "body": "Changed keywords from none to **cone**",
    "created_at": "2015-08-11T18:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258808",
    "user": "https://github.com/fchapoton"
}
```

Changed keywords from none to **cone**



---

archive/issue_comments_258809.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nThis seems to cause a lot of failing doctests now !",
    "created_at": "2015-08-11T18:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258809",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:13" align="right">comment:13</div>

This seems to cause a lot of failing doctests now !



---

archive/issue_events_262167.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-11T18:55:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262167"
}
```



---

archive/issue_events_262168.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2015-08-11T18:55:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262168"
}
```



---

archive/issue_comments_258810.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nIndeed, something is off with toric morphisms now (these are the only doctests I see failing). Investigating...",
    "created_at": "2015-08-11T21:01:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258810",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:14" align="right">comment:14</div>

Indeed, something is off with toric morphisms now (these are the only doctests I see failing). Investigating...



---

archive/issue_comments_258811.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nYet another bug uncovered by this ticket. In clean 6.9.beta0 I get\n\n```\nsage:             sage: polytope = LatticePolytope(\n....:             ...       [(-3,0,-1,-1),(-1,2,-1,-1),(0,-1,0,0),(0,0,0,1),(0,0,1,0),\n....:             ...        (0,1,0,0),(0,2,-1,-1),(1,0,0,0),(2,0,-1,-1)])\nsage:             sage: coarse_fan = FaceFan(polytope)\nsage:             sage: P2 = toric_varieties.P2()\nsage:             sage: proj24 = matrix([[0,0],[1,0],[0,0],[0,1]])\nsage: proj24\n[0 0]\n[1 0]\n[0 0]\n[0 1]\nsage: proj24.pivots()\n(0, 1)\nsage:             sage: fm = FanMorphism(proj24, coarse_fan, P2.fan(), subdivide=True)\nsage: fm.matrix()\n[0 0]\n[1 0]\n[0 0]\n[0 1]\nsage: fm.matrix().pivots()\n(0, 1, 2, 4)\n```\nso pivots are obviously screwed up somewhere. With my changes this affects the rank computation as well. Now to figure out the fix...",
    "created_at": "2015-08-11T21:44:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258811",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:15" align="right">comment:15</div>

Yet another bug uncovered by this ticket. In clean 6.9.beta0 I get

```
sage:             sage: polytope = LatticePolytope(
....:             ...       [(-3,0,-1,-1),(-1,2,-1,-1),(0,-1,0,0),(0,0,0,1),(0,0,1,0),
....:             ...        (0,1,0,0),(0,2,-1,-1),(1,0,0,0),(2,0,-1,-1)])
sage:             sage: coarse_fan = FaceFan(polytope)
sage:             sage: P2 = toric_varieties.P2()
sage:             sage: proj24 = matrix([[0,0],[1,0],[0,0],[0,1]])
sage: proj24
[0 0]
[1 0]
[0 0]
[0 1]
sage: proj24.pivots()
(0, 1)
sage:             sage: fm = FanMorphism(proj24, coarse_fan, P2.fan(), subdivide=True)
sage: fm.matrix()
[0 0]
[1 0]
[0 0]
[0 1]
sage: fm.matrix().pivots()
(0, 1, 2, 4)
```
so pivots are obviously screwed up somewhere. With my changes this affects the rank computation as well. Now to figure out the fix...



---

archive/issue_comments_258812.json:
```json
{
    "body": "Changed commit from **[`c02beee`](https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa)** to **[`deed947`](https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb)**",
    "created_at": "2015-08-11T23:17:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258812",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`c02beee`](https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa)** to **[`deed947`](https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb)**



---

archive/issue_comments_258813.json:
```json
{
    "body": "<div id=\"comment:16\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb\"><code>deed947</code></a></td><td><code>Drop wrong pivots from the output of HNF with transformation.</code></td></tr></table>\n",
    "created_at": "2015-08-11T23:17:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258813",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:16"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb"><code>deed947</code></a></td><td><code>Drop wrong pivots from the output of HNF with transformation.</code></td></tr></table>




---

archive/issue_events_262169.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-08-11T23:22:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262169"
}
```



---

archive/issue_events_262170.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2015-08-11T23:22:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262170"
}
```



---

archive/issue_comments_258814.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nMy latest attempt. grepping suggests that `hnf_with_transformation` was used in a single place and I think it is unlikely to be used by users directly, so I dropped pivots from its output. Even if somebody was using directly, they were getting wrong results for all matrices of not full rank. I have also tried to clean up the code of `echelon_form` a bit more and get rid of copypasta.",
    "created_at": "2015-08-11T23:22:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258814",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:17" align="right">comment:17</div>

My latest attempt. grepping suggests that `hnf_with_transformation` was used in a single place and I think it is unlikely to be used by users directly, so I dropped pivots from its output. Even if somebody was using directly, they were getting wrong results for all matrices of not full rank. I have also tried to clean up the code of `echelon_form` a bit more and get rid of copypasta.



---

archive/issue_comments_258815.json:
```json
{
    "body": "Changed commit from **[`deed947`](https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb)** to **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**",
    "created_at": "2015-08-12T20:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258815",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`deed947`](https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb)** to **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**



---

archive/issue_comments_258816.json:
```json
{
    "body": "<div id=\"comment:18\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8\"><code>40b87be</code></a></td><td><code>Fix dimensions of no-entry matrices in HNF.</code></td></tr></table>\n",
    "created_at": "2015-08-12T20:25:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258816",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8"><code>40b87be</code></a></td><td><code>Fix dimensions of no-entry matrices in HNF.</code></td></tr></table>




---

archive/issue_comments_258817.json:
```json
{
    "body": "Changed commit from **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)** to **[`9c5f3f9`](https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9)**",
    "created_at": "2015-08-12T21:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258817",
    "user": "https://github.com/orlitzky"
}
```

Changed commit from **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)** to **[`9c5f3f9`](https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9)**



---

archive/issue_comments_258818.json:
```json
{
    "body": "Reviewer: **Michael Orlitzky**",
    "created_at": "2015-08-12T21:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258818",
    "user": "https://github.com/orlitzky"
}
```

Reviewer: **Michael Orlitzky**



---

archive/issue_comments_258819.json:
```json
{
    "body": "Changed branch from **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)** to **[u/mjo/ticket/18613](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/18613)**",
    "created_at": "2015-08-12T21:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258819",
    "user": "https://github.com/orlitzky"
}
```

Changed branch from **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)** to **[u/mjo/ticket/18613](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/18613)**



---

archive/issue_comments_258820.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nThe first few fixes look good, but I have no idea what's going on with the HNF stuff and I'm not sure we can just throw it out. Would you be willing to move that to another ticket where someone more qualified can look at it?\n\nI've attempted to fix the `is_immutable()` issue separately (basically dropped your last two commits and made a copy of the trivial matrix in `echelon_form`). The only other issues were leading whitespace and that new OUTPUT block that I tried to clarify a little. It passes a ptestlong but leaves the pivot stuff as Somebody Else's Problem.\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5a514dc5d053ac7b62b95a5a13db42217d47df0\"><code>b5a514d</code></a></td><td><code>Trac #18613: Remove leading whitespace, and reword an OUTPUT block (reviewer).</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9\"><code>9c5f3f9</code></a></td><td><code>Trac #18613: Make trivial echelon_form()s immutable (reviewer).</code></td></tr></table>\n",
    "created_at": "2015-08-12T21:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258820",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:19" align="right">comment:19</div>

The first few fixes look good, but I have no idea what's going on with the HNF stuff and I'm not sure we can just throw it out. Would you be willing to move that to another ticket where someone more qualified can look at it?

I've attempted to fix the `is_immutable()` issue separately (basically dropped your last two commits and made a copy of the trivial matrix in `echelon_form`). The only other issues were leading whitespace and that new OUTPUT block that I tried to clarify a little. It passes a ptestlong but leaves the pivot stuff as Somebody Else's Problem.

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5a514dc5d053ac7b62b95a5a13db42217d47df0"><code>b5a514d</code></a></td><td><code>Trac #18613: Remove leading whitespace, and reword an OUTPUT block (reviewer).</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9"><code>9c5f3f9</code></a></td><td><code>Trac #18613: Make trivial echelon_form()s immutable (reviewer).</code></td></tr></table>




---

archive/issue_comments_258821.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nOh and I obviously stole some of your code in that last commit -- I'm not trying to take credit for it, I just didn't want to have a separate commit removing everything just added.",
    "created_at": "2015-08-12T22:01:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258821",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:20" align="right">comment:20</div>

Oh and I obviously stole some of your code in that last commit -- I'm not trying to take credit for it, I just didn't want to have a separate commit removing everything just added.



---

archive/issue_comments_258822.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nPlease don't throw away my last commits - they are fixing a real problem that depending on the way how `echelon_form` is called matrix cache may become corrupted! And that the trivial case was just not handled correctly at all.",
    "created_at": "2015-08-12T22:02:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258822",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:21" align="right">comment:21</div>

Please don't throw away my last commits - they are fixing a real problem that depending on the way how `echelon_form` is called matrix cache may become corrupted! And that the trivial case was just not handled correctly at all.



---

archive/issue_comments_258823.json:
```json
{
    "body": "<div id=\"comment:22\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b5a514dc5d053ac7b62b95a5a13db42217d47df0\"><code>b5a514d</code></a></td><td><code>Trac #18613: Remove leading whitespace, and reword an OUTPUT block (reviewer).</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9\"><code>9c5f3f9</code></a></td><td><code>Trac #18613: Make trivial echelon_form()s immutable (reviewer).</code></td></tr></table>\n",
    "created_at": "2015-08-12T22:05:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258823",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:22"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b5a514dc5d053ac7b62b95a5a13db42217d47df0"><code>b5a514d</code></a></td><td><code>Trac #18613: Remove leading whitespace, and reword an OUTPUT block (reviewer).</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9"><code>9c5f3f9</code></a></td><td><code>Trac #18613: Make trivial echelon_form()s immutable (reviewer).</code></td></tr></table>




---

archive/issue_comments_258824.json:
```json
{
    "body": "Changed branch from **[u/mjo/ticket/18613](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/18613)** to **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)**",
    "created_at": "2015-08-12T22:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258824",
    "user": "https://github.com/novoselt"
}
```

Changed branch from **[u/mjo/ticket/18613](https://github.com/sagemath/sagetrac-mirror/tree/u/mjo/ticket/18613)** to **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)**



---

archive/issue_comments_258825.json:
```json
{
    "body": "Changed commit from **[`9c5f3f9`](https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9)** to **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**",
    "created_at": "2015-08-12T22:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258825",
    "user": "https://github.com/novoselt"
}
```

Changed commit from **[`9c5f3f9`](https://github.com/sagemath/sagetrac-mirror/commit/9c5f3f990ab80f980df85cb16f4b7d87f31a2fb9)** to **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**



---

archive/issue_comments_258826.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nFiguring out how to revert...\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa\"><code>c02beee</code></a></td><td><code>Fix echelon_form of trivial matrices.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb\"><code>deed947</code></a></td><td><code>Drop wrong pivots from the output of HNF with transformation.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8\"><code>40b87be</code></a></td><td><code>Fix dimensions of no-entry matrices in HNF.</code></td></tr></table>\n",
    "created_at": "2015-08-12T22:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258826",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:23" align="right">comment:23</div>

Figuring out how to revert...

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c02beeea863a04328e39dd88b476ee1cfdc8fefa"><code>c02beee</code></a></td><td><code>Fix echelon_form of trivial matrices.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/deed9476f0bafa4a367cc437f3dc62e0489ba3eb"><code>deed947</code></a></td><td><code>Drop wrong pivots from the output of HNF with transformation.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8"><code>40b87be</code></a></td><td><code>Fix dimensions of no-entry matrices in HNF.</code></td></tr></table>




---

archive/issue_comments_258827.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@novoselt](#comment:21):\n> Please don't throw away my last commits - they are fixing a real problem that depending on the way how `echelon_form` is called matrix cache may become corrupted! And that the trivial case was just not handled correctly at all.\n\nI know, but it's all unrelated to this ticket, isn't it? I don't want to drop them -- I'm just not qualified to review them at the moment. The first half I've reviewed and tested already, so we could set that to positive_review and then move your remaining commits to another ticket where someone who knows the matrix stuff could look at it.",
    "created_at": "2015-08-12T22:09:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258827",
    "user": "https://github.com/orlitzky"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@novoselt](#comment:21):
> Please don't throw away my last commits - they are fixing a real problem that depending on the way how `echelon_form` is called matrix cache may become corrupted! And that the trivial case was just not handled correctly at all.

I know, but it's all unrelated to this ticket, isn't it? I don't want to drop them -- I'm just not qualified to review them at the moment. The first half I've reviewed and tested already, so we could set that to positive_review and then move your remaining commits to another ticket where someone who knows the matrix stuff could look at it.



---

archive/issue_comments_258828.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nOne of the problems why `is_isomorphic` was not working was that `echelon_form` was not working correctly. After my fix of \"just the mutability issue\" there were 20 errors in toric morphisms because a matrix of rank 2 was now claimed to be of rank 4. Because `echelon_form` was still not working correctly. And as I've finally realized after making all tests pass, the handling of the trivial case was wrong as well apart from mutability. All these things really go together and I'd rather not separate them, but I've ping the sage-devel thread in case someone else is willing to take a look.",
    "created_at": "2015-08-12T22:16:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258828",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:25" align="right">comment:25</div>

One of the problems why `is_isomorphic` was not working was that `echelon_form` was not working correctly. After my fix of "just the mutability issue" there were 20 errors in toric morphisms because a matrix of rank 2 was now claimed to be of rank 4. Because `echelon_form` was still not working correctly. And as I've finally realized after making all tests pass, the handling of the trivial case was wrong as well apart from mutability. All these things really go together and I'd rather not separate them, but I've ping the sage-devel thread in case someone else is willing to take a look.



---

archive/issue_comments_258829.json:
```json
{
    "body": "Changed reviewer from **Michael Orlitzky** to **Michael Orlitzky, Volker Braun**",
    "created_at": "2015-08-13T18:34:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258829",
    "user": "https://github.com/vbraun"
}
```

Changed reviewer from **Michael Orlitzky** to **Michael Orlitzky, Volker Braun**



---

archive/issue_events_262171.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-08-13T18:34:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262171"
}
```



---

archive/issue_events_262172.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-08-13T18:34:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262172"
}
```



---

archive/issue_comments_258830.json:
```json
{
    "body": "Changed branch from **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)** to **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**",
    "created_at": "2015-08-13T20:21:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258830",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/novoselt/errors_with_is_isomorphic___for_trivial_cones](https://github.com/sagemath/sagetrac-mirror/tree/u/novoselt/errors_with_is_isomorphic___for_trivial_cones)** to **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)**



---

archive/issue_events_262173.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-08-13T20:21:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262173"
}
```



---

archive/issue_events_262174.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "bb5b286aad58a9d97bdde5f77905de8b604b7608",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-08-13T20:21:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18613#event-262174"
}
```



---

archive/issue_comments_258831.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nThank you Volker!",
    "created_at": "2015-08-14T01:23:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258831",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:28" align="right">comment:28</div>

Thank you Volker!



---

archive/issue_comments_258832.json:
```json
{
    "body": "Changed commit from **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)** to none",
    "created_at": "2015-08-14T01:23:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18613",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18613#issuecomment-258832",
    "user": "https://github.com/novoselt"
}
```

Changed commit from **[`40b87be`](https://github.com/sagemath/sagetrac-mirror/commit/40b87be348e7f976614becf8c0cdbbb8fc546fa8)** to none
