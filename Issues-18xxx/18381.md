# Issue 18381: Cholesky decomposition should be real

archive/issues_018144.json:
```json
{
    "assignees": [],
    "body": "Currently, given a rational matrix the answer of the cholesky decomposition has base ring `QQbar` and not `AA`. This can lead to troubles when someone asks for a floating point approximation since `QQbar` does some exactification to be sure that the imaginary part is zero!\n\nSee [the original post on sage-support](https://groups.google.com/forum/#!topic/sage-support/sUdDwW9A8f0).\n\nCC:  tdumont\n\nBranch/Commit: **[c3db63d](https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1)**\n\nReviewer: **Dima Pasechnik**\n\nAuthor: **Vincent Delecroix**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18381_\n\n",
    "closed_at": "2016-04-28T15:36:26Z",
    "created_at": "2015-05-08T09:06:03Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-7.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Cholesky decomposition should be real",
    "type": "issue",
    "updated_at": "2016-04-28T15:36:26Z",
    "url": "https://github.com/sagemath/sage/issues/18381",
    "user": "https://github.com/videlec"
}
```
Currently, given a rational matrix the answer of the cholesky decomposition has base ring `QQbar` and not `AA`. This can lead to troubles when someone asks for a floating point approximation since `QQbar` does some exactification to be sure that the imaginary part is zero!

See [the original post on sage-support](https://groups.google.com/forum/#!topic/sage-support/sUdDwW9A8f0).

CC:  tdumont

Branch/Commit: **[c3db63d](https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1)**

Reviewer: **Dima Pasechnik**

Author: **Vincent Delecroix**

_Issue created by migration from https://trac.sagemath.org/ticket/18381_





---

archive/issue_events_234739.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T09:06:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "milestone_number": null,
    "milestone_title": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234739"
}
```



---

archive/issue_events_234740.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T09:06:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "component: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234740"
}
```



---

archive/issue_events_234741.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T09:06:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234741"
}
```



---

archive/issue_events_234742.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T09:06:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234742"
}
```



---

archive/issue_events_234743.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-05-08T14:54:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234743"
}
```



---

archive/issue_comments_255494.json:
```json
{
    "body": "Author: **Vincent Delecroix**",
    "created_at": "2015-05-08T14:54:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255494",
    "user": "https://github.com/videlec"
}
```

Author: **Vincent Delecroix**



---

archive/issue_comments_255495.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/5346ace6463af8e2c839fe3c3f16ddf470fd010c\">5346ace</a></td><td><code>Trac 18381: make Cholesky output real matrices</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c6fb1afce592c7f0967e05ea3fff3dfa0c760587\">c6fb1af</a></td><td><code>Trac 18381: add a doctest</code></td></tr></table>\n",
    "created_at": "2015-05-08T14:54:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255495",
    "user": "https://github.com/videlec"
}
```

<a id='comment:1'>Comment 1:</a>
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/5346ace6463af8e2c839fe3c3f16ddf470fd010c">5346ace</a></td><td><code>Trac 18381: make Cholesky output real matrices</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c6fb1afce592c7f0967e05ea3fff3dfa0c760587">c6fb1af</a></td><td><code>Trac 18381: add a doctest</code></td></tr></table>




---

archive/issue_comments_255496.json:
```json
{
    "body": "Commit: **[c6fb1af](https://github.com/sagemath/sagetrac-mirror/commit/c6fb1afce592c7f0967e05ea3fff3dfa0c760587)**",
    "created_at": "2015-05-08T14:54:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255496",
    "user": "https://github.com/videlec"
}
```

Commit: **[c6fb1af](https://github.com/sagemath/sagetrac-mirror/commit/c6fb1afce592c7f0967e05ea3fff3dfa0c760587)**



---

archive/issue_comments_255497.json:
```json
{
    "body": "Branch: **[u/vdelecroix/18381](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18381)**",
    "created_at": "2015-05-08T14:54:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255497",
    "user": "https://github.com/videlec"
}
```

Branch: **[u/vdelecroix/18381](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18381)**



---

archive/issue_comments_255498.json:
```json
{
    "body": "<a id='comment:2'>Comment 2:</a>\nJust a grammatical suggestion, instead of\n\n```\nraise ValueError(\"{} seems not be a subring of the \"\n                 \"real or complex numbers\".format(R))\n```\n\ncould we have\n\n```\nraise ValueError(\"Could not see {} as a subring of the \"\n                 \"real or complex numbers\".format(R))\n```",
    "created_at": "2015-05-10T14:10:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255498",
    "user": "https://github.com/slel"
}
```

<a id='comment:2'>Comment 2:</a>
Just a grammatical suggestion, instead of

```
raise ValueError("{} seems not be a subring of the "
                 "real or complex numbers".format(R))
```

could we have

```
raise ValueError("Could not see {} as a subring of the "
                 "real or complex numbers".format(R))
```



---

archive/issue_comments_255499.json:
```json
{
    "body": "Changed commit from **[c6fb1af](https://github.com/sagemath/sagetrac-mirror/commit/c6fb1afce592c7f0967e05ea3fff3dfa0c760587)** to **[ff2a05d](https://github.com/sagemath/sagetrac-mirror/commit/ff2a05d737a58a9647a7e775b3d0665e9368634e)**",
    "created_at": "2015-08-09T21:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255499",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c6fb1af](https://github.com/sagemath/sagetrac-mirror/commit/c6fb1afce592c7f0967e05ea3fff3dfa0c760587)** to **[ff2a05d](https://github.com/sagemath/sagetrac-mirror/commit/ff2a05d737a58a9647a7e775b3d0665e9368634e)**



---

archive/issue_comments_255500.json:
```json
{
    "body": "<a id='comment:3'>Comment 3:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ba4f1663654d7c656d8c5854d0eb2bb7b0008c79\">ba4f166</a></td><td><code>Trac 18381: make Cholesky output real matrices</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/94b0cf4abe7a3ff5f5b7fc7b4fc758280e4c1f29\">94b0cf4</a></td><td><code>Trac 18381: add a doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ff2a05d737a58a9647a7e775b3d0665e9368634e\">ff2a05d</a></td><td><code>Trac 18381: better wording</code></td></tr></table>\n",
    "created_at": "2015-08-09T21:01:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255500",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:3'>Comment 3:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ba4f1663654d7c656d8c5854d0eb2bb7b0008c79">ba4f166</a></td><td><code>Trac 18381: make Cholesky output real matrices</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/94b0cf4abe7a3ff5f5b7fc7b4fc758280e4c1f29">94b0cf4</a></td><td><code>Trac 18381: add a doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ff2a05d737a58a9647a7e775b3d0665e9368634e">ff2a05d</a></td><td><code>Trac 18381: better wording</code></td></tr></table>




---

archive/issue_comments_255501.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nReplying to [@slel](#comment%3A2):\n> Just a grammatical suggestion, \n> ...\n\ndone. And rebased on sage-6.9.beta1.\n\nVincent",
    "created_at": "2015-08-09T21:02:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255501",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'>Comment 4:</a>
Replying to [@slel](#comment%3A2):
> Just a grammatical suggestion, 
> ...

done. And rebased on sage-6.9.beta1.

Vincent



---

archive/issue_comments_255502.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nYou missed the word \"as\" in commit \u200bff2a05d.",
    "created_at": "2015-08-11T09:22:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255502",
    "user": "https://github.com/slel"
}
```

<a id='comment:5'>Comment 5:</a>
You missed the word "as" in commit ​ff2a05d.



---

archive/issue_comments_255503.json:
```json
{
    "body": "Changed commit from **[ff2a05d](https://github.com/sagemath/sagetrac-mirror/commit/ff2a05d737a58a9647a7e775b3d0665e9368634e)** to **[c357c20](https://github.com/sagemath/sagetrac-mirror/commit/c357c20417cdc41bf103f556c025e114ed8f1fc3)**",
    "created_at": "2015-08-13T13:19:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255503",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ff2a05d](https://github.com/sagemath/sagetrac-mirror/commit/ff2a05d737a58a9647a7e775b3d0665e9368634e)** to **[c357c20](https://github.com/sagemath/sagetrac-mirror/commit/c357c20417cdc41bf103f556c025e114ed8f1fc3)**



---

archive/issue_comments_255504.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c357c20417cdc41bf103f556c025e114ed8f1fc3\">c357c20</a></td><td><code>Trac 18381: better wording</code></td></tr></table>\n",
    "created_at": "2015-08-13T13:19:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255504",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:6'>Comment 6:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c357c20417cdc41bf103f556c025e114ed8f1fc3">c357c20</a></td><td><code>Trac 18381: better wording</code></td></tr></table>




---

archive/issue_comments_255505.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@slel](#comment%3A5):\n> You missed the word \"as\" in commit \u200bff2a05d.\n\nRight right right",
    "created_at": "2015-08-13T13:21:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255505",
    "user": "https://github.com/videlec"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@slel](#comment%3A5):
> You missed the word "as" in commit ​ff2a05d.

Right right right



---

archive/issue_events_234744.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-04-25T15:30:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "milestone_number": null,
    "milestone_title": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234744"
}
```



---

archive/issue_events_234745.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-04-25T15:30:27Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "milestone_number": null,
    "milestone_title": "sage-7.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234745"
}
```



---

archive/issue_comments_255506.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\na formatting issue to fix for the latest beta:\n\n```\nsage -t src/sage/matrix/matrix2.pyx\n**********************************************************************\nFile \"src/sage/matrix/matrix2.pyx\", line 11289, in sage.matrix.matrix2.Matrix.diagonal.cholesky\nFailed example:\n    L\nExpected:\n    [                       1.414213562373095?         0                     0]\n    [2.828427124746190? - 1.414213562373095?*I         1                     0]\n    [4.242640687119285? + 2.828427124746190?*I   2 - 2*I    1.732050807568878?]\nGot:\n    [                       1.414213562373095?                                         0                                         0]\n    [2.828427124746190? - 1.414213562373095?*I                                         1                                         0]\n    [4.242640687119285? + 2.828427124746190?*I                                  -2*I + 2                        1.732050807568878?]\n**********************************************************************\n1 item had failures:\n   1 of  61 in sage.matrix.matrix2.Matrix.diagonal.cholesky\n```",
    "created_at": "2016-04-25T15:30:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255506",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:8'>Comment 8:</a>
a formatting issue to fix for the latest beta:

```
sage -t src/sage/matrix/matrix2.pyx
**********************************************************************
File "src/sage/matrix/matrix2.pyx", line 11289, in sage.matrix.matrix2.Matrix.diagonal.cholesky
Failed example:
    L
Expected:
    [                       1.414213562373095?         0                     0]
    [2.828427124746190? - 1.414213562373095?*I         1                     0]
    [4.242640687119285? + 2.828427124746190?*I   2 - 2*I    1.732050807568878?]
Got:
    [                       1.414213562373095?                                         0                                         0]
    [2.828427124746190? - 1.414213562373095?*I                                         1                                         0]
    [4.242640687119285? + 2.828427124746190?*I                                  -2*I + 2                        1.732050807568878?]
**********************************************************************
1 item had failures:
   1 of  61 in sage.matrix.matrix2.Matrix.diagonal.cholesky
```



---

archive/issue_comments_255507.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nby the way, do you know how to fix the following wrong error message:\n\n```\nsage: m=matrix(RDF,[[2,1],[1,2]],sparse=True)\nsage: m.cholesky()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-18ff9bf78b55> in <module>()\n----> 1 m.cholesky()\n\n/home/dima/software/sage/src/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.cholesky (/home/dima/software/sage/src/build/cythonized/sage/matrix/matrix2.c:80453)()\n  11429             if not self.base_ring().is_exact():\n  11430                 msg = 'base ring of the matrix must be exact, not {0}'\n> 11431                 raise TypeError(msg.format(self.base_ring()))\n  11432             if not self.is_positive_definite():\n  11433                 msg = 'matrix is not positive definite, so cannot compute Cholesky decomposition'\n\nTypeError: base ring of the matrix must be exact, not Real Double Field \n```\n(it should say that the matrix must be dense...)",
    "created_at": "2016-04-25T15:32:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255507",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:9'>Comment 9:</a>
by the way, do you know how to fix the following wrong error message:

```
sage: m=matrix(RDF,[[2,1],[1,2]],sparse=True)
sage: m.cholesky()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-18ff9bf78b55> in <module>()
----> 1 m.cholesky()

/home/dima/software/sage/src/sage/matrix/matrix2.pyx in sage.matrix.matrix2.Matrix.cholesky (/home/dima/software/sage/src/build/cythonized/sage/matrix/matrix2.c:80453)()
  11429             if not self.base_ring().is_exact():
  11430                 msg = 'base ring of the matrix must be exact, not {0}'
> 11431                 raise TypeError(msg.format(self.base_ring()))
  11432             if not self.is_positive_definite():
  11433                 msg = 'matrix is not positive definite, so cannot compute Cholesky decomposition'

TypeError: base ring of the matrix must be exact, not Real Double Field 
```
(it should say that the matrix must be dense...)



---

archive/issue_comments_255508.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nWhy would you like to make cholesky work only for sparse matrices. The following works fine\n\n```\nsage: m=matrix(ZZ,[[2,1],[1,2]],sparse=True)\nsage: m.cholesky()\n[ 1.414213562373095?                   0]\n[0.7071067811865475?  1.224744871391589?]\n```\nOf course the output should always be dense but it makes sense for the input to either be sparse or dense.",
    "created_at": "2016-04-27T00:59:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255508",
    "user": "https://github.com/videlec"
}
```

<a id='comment:10'>Comment 10:</a>
Why would you like to make cholesky work only for sparse matrices. The following works fine

```
sage: m=matrix(ZZ,[[2,1],[1,2]],sparse=True)
sage: m.cholesky()
[ 1.414213562373095?                   0]
[0.7071067811865475?  1.224744871391589?]
```
Of course the output should always be dense but it makes sense for the input to either be sparse or dense.



---

archive/issue_comments_255509.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/17240cdcb6f91dbc96a13e1be9cd53d77731bfde\">17240cd</a></td><td><code>Trac 18381: make Cholesky output real matrices</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/650c04dffc5e3cfdee02c0bc4b0411491721e626\">650c04d</a></td><td><code>Trac 18381: add a doctest</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1b8fd019b56cedf0fc1d9c0c6054421acddeaa31\">1b8fd01</a></td><td><code>Trac 18381: better wording</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1\">c3db63d</a></td><td><code>Trac 18381: fix doctest</code></td></tr></table>\n",
    "created_at": "2016-04-27T01:00:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255509",
    "user": "https://github.com/sagetrac-git"
}
```

<a id='comment:11'>Comment 11:</a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/17240cdcb6f91dbc96a13e1be9cd53d77731bfde">17240cd</a></td><td><code>Trac 18381: make Cholesky output real matrices</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/650c04dffc5e3cfdee02c0bc4b0411491721e626">650c04d</a></td><td><code>Trac 18381: add a doctest</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1b8fd019b56cedf0fc1d9c0c6054421acddeaa31">1b8fd01</a></td><td><code>Trac 18381: better wording</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1">c3db63d</a></td><td><code>Trac 18381: fix doctest</code></td></tr></table>




---

archive/issue_comments_255510.json:
```json
{
    "body": "Changed commit from **[c357c20](https://github.com/sagemath/sagetrac-mirror/commit/c357c20417cdc41bf103f556c025e114ed8f1fc3)** to **[c3db63d](https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1)**",
    "created_at": "2016-04-27T01:00:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255510",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[c357c20](https://github.com/sagemath/sagetrac-mirror/commit/c357c20417cdc41bf103f556c025e114ed8f1fc3)** to **[c3db63d](https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1)**



---

archive/issue_comments_255511.json:
```json
{
    "body": "<a id='comment:12'>Comment 12:</a>\nrebased on last beta",
    "created_at": "2016-04-27T01:01:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255511",
    "user": "https://github.com/videlec"
}
```

<a id='comment:12'>Comment 12:</a>
rebased on last beta



---

archive/issue_comments_255512.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\ndense RDF input works:\n\n```\nsage: m=matrix(RDF,[[2,1],[1,2]])\nsage: m.cholesky()\n[1.4142135623730951                0.0]\n[0.7071067811865476  1.224744871391589]\n```\nso this message about `exact` is misleading.",
    "created_at": "2016-04-27T05:09:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255512",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:13'>Comment 13:</a>
dense RDF input works:

```
sage: m=matrix(RDF,[[2,1],[1,2]])
sage: m.cholesky()
[1.4142135623730951                0.0]
[0.7071067811865476  1.224744871391589]
```
so this message about `exact` is misleading.



---

archive/issue_comments_255513.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nIt reflects the reality: the dense `RDF` case is handled by numpy. While the Sage algorithm is not numerically stable (?) and should not be used for non exact rings.",
    "created_at": "2016-04-27T12:49:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255513",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'>Comment 14:</a>
It reflects the reality: the dense `RDF` case is handled by numpy. While the Sage algorithm is not numerically stable (?) and should not be used for non exact rings.



---

archive/issue_comments_255514.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nReplying to [@videlec](#comment%3A14):\n> It reflects the reality: the dense `RDF` case is handled by numpy. While the Sage algorithm is not numerically stable (?) and should not be used for non exact rings.\n\nthe reality is that while Sage does have code that can do Cholesky of sparse RDF matrices, and even of sparse CDF matrices (hidden in CVXOPT, that packages suitesparse with its cholmod), it just needs to be exposed the way numpy dense matrices are exposed. \n\nAnyhow, the error message  is wrong, it should say that either the matrix should be dense over  RDF, or sparse/dense over an exact field.",
    "created_at": "2016-04-27T13:20:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255514",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:15'>Comment 15:</a>
Replying to [@videlec](#comment%3A14):
> It reflects the reality: the dense `RDF` case is handled by numpy. While the Sage algorithm is not numerically stable (?) and should not be used for non exact rings.

the reality is that while Sage does have code that can do Cholesky of sparse RDF matrices, and even of sparse CDF matrices (hidden in CVXOPT, that packages suitesparse with its cholmod), it just needs to be exposed the way numpy dense matrices are exposed. 

Anyhow, the error message  is wrong, it should say that either the matrix should be dense over  RDF, or sparse/dense over an exact field.



---

archive/issue_comments_255515.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nOK, as far as the branch at hand is concerned, it's all good.",
    "created_at": "2016-04-27T14:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255515",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:16'>Comment 16:</a>
OK, as far as the branch at hand is concerned, it's all good.



---

archive/issue_comments_255516.json:
```json
{
    "body": "Reviewer: **Dima Pasechnik**",
    "created_at": "2016-04-27T14:30:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255516",
    "user": "https://github.com/dimpase"
}
```

Reviewer: **Dima Pasechnik**



---

archive/issue_events_234746.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-04-27T14:30:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234746"
}
```



---

archive/issue_events_234747.json:
```json
{
    "actor": "https://github.com/dimpase",
    "created_at": "2016-04-27T14:30:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234747"
}
```



---

archive/issue_comments_255517.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nThanks!\n\nIf you open a ticket for making available floating point cholesky for sparse matrices, put me in cc.",
    "created_at": "2016-04-27T14:31:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255517",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'>Comment 17:</a>
Thanks!

If you open a ticket for making available floating point cholesky for sparse matrices, put me in cc.



---

archive/issue_comments_255518.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nI don't think that Cholesky decomposition of sparse matrices would be so interesting here.  suitesparse\nworks with *very* sparse matrices we encounter for example when discretizing PDEs: that is, for a n x n matrix, we have O(n) non zero terms. As LU and Cholesky decomposition create new non zero terms, one must reorganise the graph of the matrix to minimize the amount of new terms created when factorizing. This is for example what SuperLU does, and  the successors of SuperLU too.These are quite specialized softwares.",
    "created_at": "2016-04-27T15:33:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255518",
    "user": "https://github.com/sagetrac-tdumont"
}
```

<a id='comment:18'>Comment 18:</a>
I don't think that Cholesky decomposition of sparse matrices would be so interesting here.  suitesparse
works with *very* sparse matrices we encounter for example when discretizing PDEs: that is, for a n x n matrix, we have O(n) non zero terms. As LU and Cholesky decomposition create new non zero terms, one must reorganise the graph of the matrix to minimize the amount of new terms created when factorizing. This is for example what SuperLU does, and  the successors of SuperLU too.These are quite specialized softwares.



---

archive/issue_comments_255519.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nReplying to [tdumont](#comment%3A18):\n> I don't think that Cholesky decomposition of sparse matrices would be so interesting here.  suitesparse\n> works with *very* sparse matrices we encounter for example when discretizing PDEs: that is, for a n x n matrix, we have O(n) non zero terms. As LU and Cholesky decomposition create new non zero terms, one must reorganise the graph of the matrix to minimize the amount of new terms created when factorizing. This is for example what SuperLU does, and  the successors of SuperLU too.These are quite specialized softwares.\n\nsuitesparse has amd (also packages in cvxopt) to get a kind of reordering you are talking about. Anyway it is a secondary question how to compute Cholesky, or perhaps a more general factorisation involving a permutation/reording, of a sparse [R,C]DF-matrix. It's more important to fix a backend for computations with sparse [R,C]DF-matrices.",
    "created_at": "2016-04-27T16:26:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255519",
    "user": "https://github.com/dimpase"
}
```

<a id='comment:19'>Comment 19:</a>
Replying to [tdumont](#comment%3A18):
> I don't think that Cholesky decomposition of sparse matrices would be so interesting here.  suitesparse
> works with *very* sparse matrices we encounter for example when discretizing PDEs: that is, for a n x n matrix, we have O(n) non zero terms. As LU and Cholesky decomposition create new non zero terms, one must reorganise the graph of the matrix to minimize the amount of new terms created when factorizing. This is for example what SuperLU does, and  the successors of SuperLU too.These are quite specialized softwares.

suitesparse has amd (also packages in cvxopt) to get a kind of reordering you are talking about. Anyway it is a secondary question how to compute Cholesky, or perhaps a more general factorisation involving a permutation/reording, of a sparse [R,C]DF-matrix. It's more important to fix a backend for computations with sparse [R,C]DF-matrices.



---

archive/issue_comments_255520.json:
```json
{
    "body": "Changed branch from **[u/vdelecroix/18381](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18381)** to **[c3db63d](https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1)**",
    "created_at": "2016-04-28T15:36:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18381#issuecomment-255520",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/vdelecroix/18381](https://github.com/sagemath/sagetrac-mirror/tree/u/vdelecroix/18381)** to **[c3db63d](https://github.com/sagemath/sagetrac-mirror/commit/c3db63db26a51c50344e7ecbac56dedd64e860c1)**



---

archive/issue_events_234748.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-04-28T15:36:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234748"
}
```



---

archive/issue_events_234749.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "0e14cd8634955abd9a68b52ad9f026e07af4ae02",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2016-04-28T15:36:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18381",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18381#event-234749"
}
```
