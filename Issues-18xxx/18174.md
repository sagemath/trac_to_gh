# Issue 18174: Generalize base class construction for functorial construction categories

archive/issues_017937.json:
```json
{
    "body": "This ticket implements the following syntactic sugar for functorial\nconstruction categories::\n\n```\n    GradedModules(K)  ->  Modules(K).Graded()\n    Modules.Graded(K) ->  Modules(K).Graded()\n```\nThis makes them behave consistently with `CategoryWithAxiom`.\n\nAs is noted in the code, the internal logic is very similar, but there\nseemed at this point to be no good way to avoid the duplication.\n\nThe first syntactic sugar was actually already partially implemented\nfor `GradedModulesCategory`, so half of the work is just generalizing\nexisting code.\n\nThe syntactic sugar is not valid for construction categories that take\nextra arguments like `Algebras`, since there is no generic way to\ndecide what the argument should be used for:\n\n```\n    Sets.Algebras(K)  ->   Sets(K).Algebras() or Sets().Algebras(K) ?\n```\n\n\nAssignee: @tscrim\n\nCC:  @nthiery\n\nKeywords: sd67\n\nReviewer: Nicolas M. Thi\u00e9ry\n\nAuthor: Travis Scrimshaw\n\nBranch: c35a27022e3199f3b2f05d3550e747b4cdd574b5\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18174\n\n",
    "closed_at": "2015-04-15T06:07:30Z",
    "created_at": "2015-04-12T17:37:42Z",
    "labels": [
        "component: categories"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Generalize base class construction for functorial construction categories",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18174",
    "user": "https://github.com/tscrim"
}
```
This ticket implements the following syntactic sugar for functorial
construction categories::

```
    GradedModules(K)  ->  Modules(K).Graded()
    Modules.Graded(K) ->  Modules(K).Graded()
```
This makes them behave consistently with `CategoryWithAxiom`.

As is noted in the code, the internal logic is very similar, but there
seemed at this point to be no good way to avoid the duplication.

The first syntactic sugar was actually already partially implemented
for `GradedModulesCategory`, so half of the work is just generalizing
existing code.

The syntactic sugar is not valid for construction categories that take
extra arguments like `Algebras`, since there is no generic way to
decide what the argument should be used for:

```
    Sets.Algebras(K)  ->   Sets(K).Algebras() or Sets().Algebras(K) ?
```


Assignee: @tscrim

CC:  @nthiery

Keywords: sd67

Reviewer: Nicolas M. Thiéry

Author: Travis Scrimshaw

Branch: c35a27022e3199f3b2f05d3550e747b4cdd574b5

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18174





---

archive/issue_comments_256284.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-12T17:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256284",
    "user": "https://github.com/tscrim"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_256285.json:
```json
{
    "body": "<a id='comment:1'></a>New commits:",
    "created_at": "2015-04-12T17:38:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256285",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:1'></a>New commits:



---

archive/issue_comments_256286.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-12T21:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256286",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_256287.json:
```json
{
    "body": "<a id='comment:3'></a>LGTM",
    "created_at": "2015-04-12T22:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256287",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:3'></a>LGTM



---

archive/issue_comments_256288.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-12T22:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256288",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_256289.json:
```json
{
    "body": "<a id='comment:4'></a>For the record: all long tests pass up to some failures/timeouts I often get on my test machine:\n\n```\nsage -t --long src/sage/misc/cachefunc.pyx  # 1 doctest failed\nsage -t --long src/sage/tests/cmdline.py  # 1 doctest failed\nsage -t --long src/sage/dev/sagedev.py  # Timed out\nsage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # Timed out\nsage -t --long src/sage/modular/arithgroup/arithgroup_perm.py  # Timed out\nsage -t --long src/doc/en/tutorial/interfaces.rst  # 10 doctests failed\n```",
    "created_at": "2015-04-12T23:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256289",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:4'></a>For the record: all long tests pass up to some failures/timeouts I often get on my test machine:

```
sage -t --long src/sage/misc/cachefunc.pyx  # 1 doctest failed
sage -t --long src/sage/tests/cmdline.py  # 1 doctest failed
sage -t --long src/sage/dev/sagedev.py  # Timed out
sage -t --long src/sage/schemes/elliptic_curves/lseries_ell.py  # Timed out
sage -t --long src/sage/modular/arithgroup/arithgroup_perm.py  # Timed out
sage -t --long src/doc/en/tutorial/interfaces.rst  # 10 doctests failed
```



---

archive/issue_comments_256290.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,27 @@\n-We generalize the magic functions in \\`GradedModulesCategory\\` so we can don't have to copy \\`_base_category_class\\` with minor changes and \\`__classcall__\\` in order to have separate files for categories created by a functorial construction.\n+This ticket implements the following syntactic sugar for functorial\n+construction categories::\n+\n+\\`\\`\\`\n+    GradedModules(K)  ->  Modules(K).Graded()\n+    Modules.Graded(K) ->  Modules(K).Graded()\n+\\`\\`\\`\n+This makes them behave consistently with \\`CategoryWithAxiom\\`.\n+\n+As is noted in the code, the internal logic is very similar, but there\n+seemed at this point to be no good way to avoid the duplication.\n+\n+The first syntactic sugar was actually already partially implemented\n+for \\`GradedModulesCategory\\`, so half of the work is just generalizing\n+existing code.\n+\n+The syntactic sugar is not valid for construction categories that take\n+extra arguments like \\`Algebras\\`, since there is no generic way to\n+decide what the argument should be used for:\n+\n+\\`\\`\\`\n+    Sets.Algebras(K)  ->   Sets(K).Algebras() or Sets().Algebras(K) ?\n+\\`\\`\\`\n+\n \n Reviewer: Nicolas Thi\u00e9ry\n \n```\n",
    "created_at": "2015-04-13T12:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256290",
    "user": "https://github.com/nthiery"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,27 @@
-We generalize the magic functions in \`GradedModulesCategory\` so we can don't have to copy \`_base_category_class\` with minor changes and \`__classcall__\` in order to have separate files for categories created by a functorial construction.
+This ticket implements the following syntactic sugar for functorial
+construction categories::
+
+\`\`\`
+    GradedModules(K)  ->  Modules(K).Graded()
+    Modules.Graded(K) ->  Modules(K).Graded()
+\`\`\`
+This makes them behave consistently with \`CategoryWithAxiom\`.
+
+As is noted in the code, the internal logic is very similar, but there
+seemed at this point to be no good way to avoid the duplication.
+
+The first syntactic sugar was actually already partially implemented
+for \`GradedModulesCategory\`, so half of the work is just generalizing
+existing code.
+
+The syntactic sugar is not valid for construction categories that take
+extra arguments like \`Algebras\`, since there is no generic way to
+decide what the argument should be used for:
+
+\`\`\`
+    Sets.Algebras(K)  ->   Sets(K).Algebras() or Sets().Algebras(K) ?
+\`\`\`
+
 
 Reviewer: Nicolas Thiéry
 
```




---

archive/issue_comments_256291.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd67\".",
    "created_at": "2015-04-13T16:32:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256291",
    "user": "https://github.com/nthiery"
}
```

Changing keywords from "" to "sd67".



---

archive/issue_comments_256292.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-15T06:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18174#issuecomment-256292",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_051419.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-15T06:07:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18174",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18174#event-51419"
}
```
