# Issue 18883: use Pynac for some symbolic comparisons instead of Maxima

archive/issues_018646.json:
```json
{
    "body": "This:\n\n```\nsage: bool(exp(x)>=0)\nTrue\n```\nunexpectedly uses Maxima, and gets it wrong, too (the already known complex domain problem, see e.g. #14305).\n\nSince Pynac can now assign info flags to function expressions the possible cases for `abs`, `factorial`, `binomial`, `real`, `imag`, `step` should be implemented in Pynac (this is https://github.com/pynac/pynac/issues/78) and the cases like above handled in Pynac.\n\nThe repercussions are not limited to such comparisons. The more expressions have info flags set the more expressions with more complicated structure can be decided and more questions answered.\n\nAuthor: Ralf Stephan\n\nBranch: u/rws/use_pynac_for_some_symbolic_comparisons_instead_of_maxima\n\nStatus: needs_work\n\nDependencies: #22219\n\nCommit: 18c27680eace1c3ac6933a912817a8822d4311d7\n\nIssue created by migration from https://trac.sagemath.org/ticket/18883\n\n",
    "created_at": "2015-07-12T08:38:54Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.2",
    "title": "use Pynac for some symbolic comparisons instead of Maxima",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18883",
    "user": "https://github.com/rwst"
}
```
This:

```
sage: bool(exp(x)>=0)
True
```
unexpectedly uses Maxima, and gets it wrong, too (the already known complex domain problem, see e.g. #14305).

Since Pynac can now assign info flags to function expressions the possible cases for `abs`, `factorial`, `binomial`, `real`, `imag`, `step` should be implemented in Pynac (this is https://github.com/pynac/pynac/issues/78) and the cases like above handled in Pynac.

The repercussions are not limited to such comparisons. The more expressions have info flags set the more expressions with more complicated structure can be decided and more questions answered.

Author: Ralf Stephan

Branch: u/rws/use_pynac_for_some_symbolic_comparisons_instead_of_maxima

Status: needs_work

Dependencies: #22219

Commit: 18c27680eace1c3ac6933a912817a8822d4311d7

Issue created by migration from https://trac.sagemath.org/ticket/18883





---

archive/issue_comments_270256.json:
```json
{
    "body": "<a id='comment:1'></a>Turns out that, additionally, an explicit `nonzero` info flag is needed in Pynac because without a `nonzero` flag the above test in the reals is always delegated to Maxima, as well. https://github.com/pynac/pynac/issues/79\n\nEDIT: remove nonsense",
    "created_at": "2015-07-19T15:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270256",
    "user": "https://github.com/rwst"
}
```

<a id='comment:1'></a>Turns out that, additionally, an explicit `nonzero` info flag is needed in Pynac because without a `nonzero` flag the above test in the reals is always delegated to Maxima, as well. https://github.com/pynac/pynac/issues/79

EDIT: remove nonsense



---

archive/issue_comments_270257.json:
```json
{
    "body": "<a id='comment:4'></a>pynac-0.4.3 is not a git branch",
    "created_at": "2016-07-12T09:52:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270257",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:4'></a>pynac-0.4.3 is not a git branch



---

archive/issue_comments_270258.json:
```json
{
    "body": "<a id='comment:5'></a>This was NOT fixed as claimed in the ticket field.",
    "created_at": "2016-07-12T12:55:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270258",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>This was NOT fixed as claimed in the ticket field.



---

archive/issue_comments_270259.json:
```json
{
    "body": "<a id='comment:7'></a>This commit enables all Pynac relational logic improvements and only falls back on Maxima if Pynac returns Not Implemented.\n\n---\nNew commits:",
    "created_at": "2017-01-19T08:57:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270259",
    "user": "https://github.com/rwst"
}
```

<a id='comment:7'></a>This commit enables all Pynac relational logic improvements and only falls back on Maxima if Pynac returns Not Implemented.

---
New commits:



---

archive/issue_comments_270260.json:
```json
{
    "body": "<a id='comment:8'></a>To fix the Maxima-related problem, as a solution to the complex/real domain issue is not expected it might be possible to use only Pynac with relations, and use both with equality questions.",
    "created_at": "2017-01-19T10:03:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270260",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>To fix the Maxima-related problem, as a solution to the complex/real domain issue is not expected it might be possible to use only Pynac with relations, and use both with equality questions.



---

archive/issue_comments_270261.json:
```json
{
    "body": "<a id='comment:9'></a>If Pynac should take over all questions on relations then it must be able to also answer this:\n\n```\n            sage: (x > 2).assume()\n            sage: bool(x > 0)\n            True\n```\nbecause it's impossible do separate domain-only questions from more general ones. That means the workaround mentioned in comment:8 depends on https://github.com/pynac/pynac/issues/227",
    "created_at": "2017-01-19T15:05:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270261",
    "user": "https://github.com/rwst"
}
```

<a id='comment:9'></a>If Pynac should take over all questions on relations then it must be able to also answer this:

```
            sage: (x > 2).assume()
            sage: bool(x > 0)
            True
```
because it's impossible do separate domain-only questions from more general ones. That means the workaround mentioned in comment:8 depends on https://github.com/pynac/pynac/issues/227



---

archive/issue_comments_270262.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-01-20T07:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270262",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_052741.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-02-08T07:39:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18883#event-52741"
}
```



---

archive/issue_comments_270263.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-02-08T07:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270263",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_events_052742.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-26T14:36:56Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "milestone": "sage-7.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18883#event-52742"
}
```



---

archive/issue_events_052743.json:
```json
{
    "actor": "https://github.com/rwst",
    "created_at": "2017-12-26T14:36:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "milestone": "sage-8.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18883#event-52743"
}
```



---

archive/issue_comments_270264.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-03-03T16:21:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270264",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_270265.json:
```json
{
    "body": "<a id='comment:14'></a>Lots of doctest errors. Back to the drawing board.",
    "created_at": "2018-03-03T16:27:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18883",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18883#issuecomment-270265",
    "user": "https://github.com/rwst"
}
```

<a id='comment:14'></a>Lots of doctest errors. Back to the drawing board.
