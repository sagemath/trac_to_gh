# Issue 18311: Improve radical_basis and cartan_invariants_matrix for a finite dimensional algebra

archive/issues_018074.json:
```json
{
    "body": "This ticket improves the algorithmic complexity (`n^4` to `n^3` for\n`radical_basis`) and further optimizes the code for computing the\nradical and the Cartan invariants matrix.\n\nWithout:\n\n```\nsage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)\nsage: %time len(A.radical_basis())\nCPU times: user 4.25 s, sys: 45.1 ms, total: 4.3 s\nWall time: 4.26 s\n104\nsage: %time A.cartan_invariants_matrix()\nCPU times: user 45.2 s, sys: 267 ms, total: 45.4 s\nWall time: 45.5 s\n```\n\nWith:\n\n```\nsage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)\nsage: %time len(A.radical_basis())\nCPU times: user 418 ms, sys: 29.5 ms, total: 447 ms\nWall time: 422 ms\n104\nsage: %time A.cartan_invariants_matrix_by_characters()\nCPU times: user 9.39 s, sys: 208 ms, total: 9.6 s\nWall time: 9.53 s\n```\n\n(the above examples do not use that this is a monoid algebra, though\nof course the sparsity helps).\n\nThe dependency on #6484 is only for speed.\n\nCC:  @hivert @saliola @avirmaux sage-combinat\n\nAuthor: Nicolas M. Thi\u00e9ry\n\nBranch: u/nthiery/representation_theory/finite_dimensional_algebras-18311\n\nStatus: new\n\nDependencies: #18310, #6484, #18336\n\nCommit: dca35bd3cbdc215a34862b654cba520659a63bee\n\nIssue created by migration from https://trac.sagemath.org/ticket/18311\n\n",
    "created_at": "2015-04-27T10:46:37Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "Improve radical_basis and cartan_invariants_matrix for a finite dimensional algebra",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18311",
    "user": "https://github.com/nthiery"
}
```
This ticket improves the algorithmic complexity (`n^4` to `n^3` for
`radical_basis`) and further optimizes the code for computing the
radical and the Cartan invariants matrix.

Without:

```
sage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)
sage: %time len(A.radical_basis())
CPU times: user 4.25 s, sys: 45.1 ms, total: 4.3 s
Wall time: 4.26 s
104
sage: %time A.cartan_invariants_matrix()
CPU times: user 45.2 s, sys: 267 ms, total: 45.4 s
Wall time: 45.5 s
```

With:

```
sage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)
sage: %time len(A.radical_basis())
CPU times: user 418 ms, sys: 29.5 ms, total: 447 ms
Wall time: 422 ms
104
sage: %time A.cartan_invariants_matrix_by_characters()
CPU times: user 9.39 s, sys: 208 ms, total: 9.6 s
Wall time: 9.53 s
```

(the above examples do not use that this is a monoid algebra, though
of course the sparsity helps).

The dependency on #6484 is only for speed.

CC:  @hivert @saliola @avirmaux sage-combinat

Author: Nicolas M. Thiéry

Branch: u/nthiery/representation_theory/finite_dimensional_algebras-18311

Status: new

Dependencies: #18310, #6484, #18336

Commit: dca35bd3cbdc215a34862b654cba520659a63bee

Issue created by migration from https://trac.sagemath.org/ticket/18311





---

archive/issue_comments_318289.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,33 @@\n+This ticket improves the algorithmic complexity (`n^4` to `n^3` for\n+`radical_basis`) and further optimizes the code for computing the\n+radical and the Cartan invariants matrix.\n \n+Without:\n+\n+```\n+sage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)\n+sage: %time len(A.radical_basis())\n+CPU times: user 4.25 s, sys: 45.1 ms, total: 4.3 s\n+Wall time: 4.26 s\n+104\n+sage: %time A.cartan_invariants_matrix()\n+CPU times: user 45.2 s, sys: 267 ms, total: 45.4 s\n+Wall time: 45.5 s\n+```\n+\n+With:\n+\n+```\n+sage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)\n+sage: %time len(A.radical_basis())\n+CPU times: user 418 ms, sys: 29.5 ms, total: 447 ms\n+Wall time: 422 ms\n+104\n+sage: %time A.cartan_invariants_matrix_by_characters()\n+CPU times: user 9.39 s, sys: 208 ms, total: 9.6 s\n+Wall time: 9.53 s\n+```\n+\n+(the above examples do not use that this is a monoid algebra, though\n+of course the sparsity helps).\n+\n``````\n",
    "created_at": "2015-04-27T10:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318289",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,33 @@
+This ticket improves the algorithmic complexity (`n^4` to `n^3` for
+`radical_basis`) and further optimizes the code for computing the
+radical and the Cartan invariants matrix.
 
+Without:
+
+```
+sage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)
+sage: %time len(A.radical_basis())
+CPU times: user 4.25 s, sys: 45.1 ms, total: 4.3 s
+Wall time: 4.26 s
+104
+sage: %time A.cartan_invariants_matrix()
+CPU times: user 45.2 s, sys: 267 ms, total: 45.4 s
+Wall time: 45.5 s
+```
+
+With:
+
+```
+sage: A = HeckeMonoid(SymmetricGroup(5)).algebra(QQ)
+sage: %time len(A.radical_basis())
+CPU times: user 418 ms, sys: 29.5 ms, total: 447 ms
+Wall time: 422 ms
+104
+sage: %time A.cartan_invariants_matrix_by_characters()
+CPU times: user 9.39 s, sys: 208 ms, total: 9.6 s
+Wall time: 9.53 s
+```
+
+(the above examples do not use that this is a monoid algebra, though
+of course the sparsity helps).
+
``````




---

archive/issue_comments_318290.json:
```json
{
    "body": "Changing author from \"\" to \"Nicolas M. Thi\u00e9ry\"",
    "created_at": "2015-04-27T10:51:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318290",
    "user": "https://github.com/nthiery"
}
```

Changing author from "" to "Nicolas M. Thiéry"



---

archive/issue_comments_318291.json:
```json
{
    "body": "Changing branch from \"\" to \"u/nthiery/representation_theory/finite_dimensional_algebras-18311\"",
    "created_at": "2015-04-27T10:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318291",
    "user": "https://github.com/nthiery"
}
```

Changing branch from "" to "u/nthiery/representation_theory/finite_dimensional_algebras-18311"



---

archive/issue_comments_318292.json:
```json
{
    "body": "Changing dependencies from \"\" to \"18310, 6484\"",
    "created_at": "2015-04-27T10:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318292",
    "user": "https://github.com/nthiery"
}
```

Changing dependencies from "" to "18310, 6484"



---

archive/issue_comments_318293.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -31,3 +31,4 @@\n (the above examples do not use that this is a monoid algebra, though\n of course the sparsity helps).\n \n+The dependency on #6484 is only for speed.\n``````\n",
    "created_at": "2015-04-27T10:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318293",
    "user": "https://github.com/nthiery"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -31,3 +31,4 @@
 (the above examples do not use that this is a monoid algebra, though
 of course the sparsity helps).
 
+The dependency on #6484 is only for speed.
``````




---

archive/issue_comments_318294.json:
```json
{
    "body": "<a id='comment:3'></a>Last 10 new commits:",
    "created_at": "2015-04-27T10:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318294",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:3'></a>Last 10 new commits:



---

archive/issue_comments_318295.json:
```json
{
    "body": "Changing commit from \"\" to \"50867d895544ee5a449423bde74440ea8470f9ee\"",
    "created_at": "2015-04-27T10:53:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318295",
    "user": "https://github.com/nthiery"
}
```

Changing commit from "" to "50867d895544ee5a449423bde74440ea8470f9ee"



---

archive/issue_comments_318296.json:
```json
{
    "body": "Changing dependencies from \"18310, 6484\" to \"#18310, #6484\"",
    "created_at": "2015-04-27T17:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318296",
    "user": "https://github.com/tscrim"
}
```

Changing dependencies from "18310, 6484" to "#18310, #6484"



---

archive/issue_comments_318297.json:
```json
{
    "body": "<a id='comment:4'></a>Mainly to cc myself.",
    "created_at": "2015-04-27T17:43:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318297",
    "user": "https://github.com/tscrim"
}
```

<a id='comment:4'></a>Mainly to cc myself.



---

archive/issue_comments_318298.json:
```json
{
    "body": "<a id='comment:5'></a>Hello,\n\nI just took some time to read the patch.\n\n`FiniteDimensionalAlgebrasWithBasis.multiplication_matrix` the name is not very explicit, what about `basis_action_matrices` ? As well, wether we want sparse matrices or not may be given as an argument?\n\nShould we overwrite the previous method for Cartan invariant matrix from #16659 with this new one ? Indeed the return should be the same and it's much faster! In this case maybe we may want to wait that #16659 is positive_reviewed to avoid merging issues.\n\nEverything else looks good to me (modulo the remaining documentation)\nI can do the aforementioned modifications.",
    "created_at": "2015-04-29T08:50:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318298",
    "user": "https://github.com/avirmaux"
}
```

<a id='comment:5'></a>Hello,

I just took some time to read the patch.

`FiniteDimensionalAlgebrasWithBasis.multiplication_matrix` the name is not very explicit, what about `basis_action_matrices` ? As well, wether we want sparse matrices or not may be given as an argument?

Should we overwrite the previous method for Cartan invariant matrix from #16659 with this new one ? Indeed the return should be the same and it's much faster! In this case maybe we may want to wait that #16659 is positive_reviewed to avoid merging issues.

Everything else looks good to me (modulo the remaining documentation)
I can do the aforementioned modifications.



---

archive/issue_comments_318299.json:
```json
{
    "body": "<a id='comment:6'></a>Replying to [virmaux](#comment%3A5):\n> I just took some time to read the patch.\n\n\nThanks!\n\n> `FiniteDimensionalAlgebrasWithBasis.multiplication_matrix` the name is not very explicit, what about `basis_action_matrices` ?\n\n\nAgreed; maybe `multiplication_matrix_on_basis`. Suggestions anyone?\n\n> As well, wether we want sparse matrices or not may be given as an argument?\n\n\nMaybe indeed. I am also thinking about an option that would apply to\nthe whole algebra to state whether its coefficients structure are\nsparse or dense.\n\n> Should we overwrite the previous method for Cartan invariant matrix from #16659 with this new one ? Indeed the return should be the same and it's much faster!\n\n\nThis one is only valid in large enough characteristic. Also it can be\ngood to have several algorithm for comparison. But I agree we probably\nwant to have an option instead (and possibly several private methods\nbehind the scene).\n\n> In this case maybe we may want to wait that #16659 is positive_reviewed to avoid merging issues.\n\n\nYeah, I'd rather wait for #16659 to be finished.\n\n> Everything else looks good to me (modulo the remaining documentation)\n> I can do the aforementioned modifications.\n\n\nLet's discuss this tomorrow with Florent. We might want to think about\nthe graded Cartan matrix.\n\nCheers,\n                       Nicolas",
    "created_at": "2015-04-29T12:46:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318299",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:6'></a>Replying to [virmaux](#comment%3A5):
> I just took some time to read the patch.


Thanks!

> `FiniteDimensionalAlgebrasWithBasis.multiplication_matrix` the name is not very explicit, what about `basis_action_matrices` ?


Agreed; maybe `multiplication_matrix_on_basis`. Suggestions anyone?

> As well, wether we want sparse matrices or not may be given as an argument?


Maybe indeed. I am also thinking about an option that would apply to
the whole algebra to state whether its coefficients structure are
sparse or dense.

> Should we overwrite the previous method for Cartan invariant matrix from #16659 with this new one ? Indeed the return should be the same and it's much faster!


This one is only valid in large enough characteristic. Also it can be
good to have several algorithm for comparison. But I agree we probably
want to have an option instead (and possibly several private methods
behind the scene).

> In this case maybe we may want to wait that #16659 is positive_reviewed to avoid merging issues.


Yeah, I'd rather wait for #16659 to be finished.

> Everything else looks good to me (modulo the remaining documentation)
> I can do the aforementioned modifications.


Let's discuss this tomorrow with Florent. We might want to think about
the graded Cartan matrix.

Cheers,
                       Nicolas



---

archive/issue_comments_318300.json:
```json
{
    "body": "<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-04T12:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318300",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:7'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318301.json:
```json
{
    "body": "Changing commit from \"50867d895544ee5a449423bde74440ea8470f9ee\" to \"6dcb0c5173f84d4920149641497fd343b73e2aea\"",
    "created_at": "2015-05-04T12:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318301",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "50867d895544ee5a449423bde74440ea8470f9ee" to "6dcb0c5173f84d4920149641497fd343b73e2aea"



---

archive/issue_comments_318302.json:
```json
{
    "body": "Changing dependencies from \"#18310, #6484\" to \"#18310, #6484, #18336\"",
    "created_at": "2015-05-04T13:14:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318302",
    "user": "https://github.com/nthiery"
}
```

Changing dependencies from "#18310, #6484" to "#18310, #6484, #18336"



---

archive/issue_comments_318303.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-04T20:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318303",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_318304.json:
```json
{
    "body": "Changing commit from \"6dcb0c5173f84d4920149641497fd343b73e2aea\" to \"dca35bd3cbdc215a34862b654cba520659a63bee\"",
    "created_at": "2015-05-04T20:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18311",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18311#issuecomment-318304",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "6dcb0c5173f84d4920149641497fd343b73e2aea" to "dca35bd3cbdc215a34862b654cba520659a63bee"
