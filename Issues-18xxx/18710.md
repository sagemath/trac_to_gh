# Issue 18710: Move some make targets to build/Makefile

archive/issues_018473.json:
```json
{
    "body": "Move all `make` targets involving building parts of Sage to `build/Makefile`.\n\nOne advantage is that we can build the documentation in parallel with packages: not every package needs to be installed to build the documentation; in particular R (which takes a while to build) can be built in parallel with the doc.\n\nWe also add targets for every package, such that `make mypkg` would install `mypkg` *with dependency checking* (unlike `./sage -i mypkg` which does not have dependency checking).\n\nCC:  @nathanncohen\n\nReviewer: Nathann Cohen, Volker Braun\n\nAuthor: Jeroen Demeyer\n\nBranch: 6db418e791a4d1881bd455e6814458457e904476\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18710\n\n",
    "closed_at": "2015-06-29T22:31:23Z",
    "created_at": "2015-06-16T10:01:00Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "Move some make targets to build/Makefile",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18710",
    "user": "https://github.com/jdemeyer"
}
```
Move all `make` targets involving building parts of Sage to `build/Makefile`.

One advantage is that we can build the documentation in parallel with packages: not every package needs to be installed to build the documentation; in particular R (which takes a while to build) can be built in parallel with the doc.

We also add targets for every package, such that `make mypkg` would install `mypkg` *with dependency checking* (unlike `./sage -i mypkg` which does not have dependency checking).

CC:  @nathanncohen

Reviewer: Nathann Cohen, Volker Braun

Author: Jeroen Demeyer

Branch: 6db418e791a4d1881bd455e6814458457e904476

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18710





---

archive/issue_comments_250733.json:
```json
{
    "body": "<a id='comment:5'></a>New commits:",
    "created_at": "2015-06-16T16:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250733",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>New commits:



---

archive/issue_comments_250734.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-16T16:58:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250734",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_250735.json:
```json
{
    "body": "<a id='comment:6'></a>You make many unrelated changes in the same diff and it's rather hard to figure out. Could you split the commits? Having one commit per block of rules that you move from one place to another would help a lot.\n\nNathann",
    "created_at": "2015-06-16T18:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250735",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:6'></a>You make many unrelated changes in the same diff and it's rather hard to figure out. Could you split the commits? Having one commit per block of rules that you move from one place to another would help a lot.

Nathann



---

archive/issue_comments_250736.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-16T18:28:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250736",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_250737.json:
```json
{
    "body": "<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-16T19:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250737",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:8'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_250738.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-16T19:45:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250738",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_250739.json:
```json
{
    "body": "<a id='comment:10'></a>I split off 2 tickets: #18715 and #18716 and kept only the core of this ticket here, I hope it's more clear now.",
    "created_at": "2015-06-16T19:50:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250739",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>I split off 2 tickets: #18715 and #18716 and kept only the core of this ticket here, I hope it's more clear now.



---

archive/issue_comments_250740.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-16T19:50:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250740",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_250741.json:
```json
{
    "body": "<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-16T21:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250741",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:13'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250742.json:
```json
{
    "body": "<a id='comment:14'></a>Yes yes it is clearer. Though you didn't have to go through the trouble of creating many tickets, splitting the commits would have been enough. I'll review this soon.",
    "created_at": "2015-06-17T08:21:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250742",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>Yes yes it is clearer. Though you didn't have to go through the trouble of creating many tickets, splitting the commits would have been enough. I'll review this soon.



---

archive/issue_comments_250743.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 ncohen]:\n> Though you shouldn't have to go through the trouble of creating many tickets\n\nWell, creating a ticket takes essentially no time (certainly much less than splitting up commits).",
    "created_at": "2015-06-17T08:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250743",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>Replying to [comment:14 ncohen]:
> Though you shouldn't have to go through the trouble of creating many tickets

Well, creating a ticket takes essentially no time (certainly much less than splitting up commits).



---

archive/issue_comments_250744.json:
```json
{
    "body": "<a id='comment:16'></a>What about the packages that install libraries that Sage needs to compile cython modules? They need to be installed if you want their doc to appear.\n\nAnd unfortunately, I am also talking of optional ones `:-/`",
    "created_at": "2015-06-17T08:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250744",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:16'></a>What about the packages that install libraries that Sage needs to compile cython modules? They need to be installed if you want their doc to appear.

And unfortunately, I am also talking of optional ones `:-/`



---

archive/issue_comments_250745.json:
```json
{
    "body": "<a id='comment:17'></a>```\n+# Defer unknown targets to build/Makefile\n+%::\n+\t$(MAKE) configure logs\n+\tcd build && ./pipestatus \\\n+\t\t\"./install '$@' 2>&1\" \\\n+\t\t\"tee -a ../logs/install.log\"\n```\n\nYou can't log everything to `.install.log` regarless of the command that was run.",
    "created_at": "2015-06-17T09:02:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250745",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>```
+# Defer unknown targets to build/Makefile
+%::
+	$(MAKE) configure logs
+	cd build && ./pipestatus \
+		"./install '$@' 2>&1" \
+		"tee -a ../logs/install.log"
```

You can't log everything to `.install.log` regarless of the command that was run.



---

archive/issue_comments_250746.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:16 ncohen]:\n> What about the packages that install libraries that Sage needs to compile cython modules? They need to be installed if you want their doc to appear.\n\nYes, they are handled by the `$(SAGERUNTIME)` dependency.\n\n> And unfortunately, I am also talking of optional ones `:-/`\n\nWell, we are currently not building documentation for optional extensions anyway, so that doesn't matter.",
    "created_at": "2015-06-17T10:03:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250746",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:18'></a>Replying to [comment:16 ncohen]:
> What about the packages that install libraries that Sage needs to compile cython modules? They need to be installed if you want their doc to appear.

Yes, they are handled by the `$(SAGERUNTIME)` dependency.

> And unfortunately, I am also talking of optional ones `:-/`

Well, we are currently not building documentation for optional extensions anyway, so that doesn't matter.



---

archive/issue_comments_250747.json:
```json
{
    "body": "<a id='comment:19'></a>Replying to [comment:17 ncohen]:\n> You can't log everything to `.install.log` regarless of the command that was run.\n\n\nActually, why not? I don't see a problem with having one \"master\" log file logging everything. And it can help debugging race conditions if some command fails depending on when it was run.\n\nThe individual log files are still generated, so I don't see this as a regression.",
    "created_at": "2015-06-17T10:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250747",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>Replying to [comment:17 ncohen]:
> You can't log everything to `.install.log` regarless of the command that was run.


Actually, why not? I don't see a problem with having one "master" log file logging everything. And it can help debugging race conditions if some command fails depending on when it was run.

The individual log files are still generated, so I don't see this as a regression.



---

archive/issue_comments_250748.json:
```json
{
    "body": "<a id='comment:20'></a>> The individual log files are still generated, so I don't see this as a regression.\n\n\nYou concatenate in the same file the results of several commands, don't you? How are we meant to know what is the result of what? Wouldn't it be better to have a logfile whose name includes the date or something?\n\nAlso, 'install' is ill-chosen. This filename is used whenever the rule that is being used does not exist in the  main makefile, and it can be anything (install/docbuild/tests). It also seems that calls to 'make' with a wrong rule will produce output too.\n\nNathann",
    "created_at": "2015-06-17T10:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250748",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:20'></a>> The individual log files are still generated, so I don't see this as a regression.


You concatenate in the same file the results of several commands, don't you? How are we meant to know what is the result of what? Wouldn't it be better to have a logfile whose name includes the date or something?

Also, 'install' is ill-chosen. This filename is used whenever the rule that is being used does not exist in the  main makefile, and it can be anything (install/docbuild/tests). It also seems that calls to 'make' with a wrong rule will produce output too.

Nathann



---

archive/issue_comments_250749.json:
```json
{
    "body": "<a id='comment:21'></a>Replying to [comment:20 ncohen]:\n> You concatenate in the same file the results of several commands, don't you?\n\nYes indeed.\n\n> How are we meant to know what is the result of what?\n\nYou cannot really know that. But if you need to know, just look at the individual log files, which still exist.\n\n> Wouldn't it be better to have a logfile whose name includes the date or something?\n> Also, 'install' is ill-chosen.\n\nWell, I think that changing the name of that file is outside the scope of this ticket. That should be done with caution, as this might have consequences for the patchbot/buildbot for example.\n\n> This filename is used whenever the rule that is being used does not exist in the  main makefile, and it can be anything (install/docbuild/tests).\n\nWell, this ticket is about integrating the build of the documentation into the rest of the build system. So having one log file is consistent with that.\n\n> It also seems that calls to 'make' with a wrong rule will produce output too.\n\nTrue, but that's not really a major problem, is it?",
    "created_at": "2015-06-17T10:53:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250749",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>Replying to [comment:20 ncohen]:
> You concatenate in the same file the results of several commands, don't you?

Yes indeed.

> How are we meant to know what is the result of what?

You cannot really know that. But if you need to know, just look at the individual log files, which still exist.

> Wouldn't it be better to have a logfile whose name includes the date or something?
> Also, 'install' is ill-chosen.

Well, I think that changing the name of that file is outside the scope of this ticket. That should be done with caution, as this might have consequences for the patchbot/buildbot for example.

> This filename is used whenever the rule that is being used does not exist in the  main makefile, and it can be anything (install/docbuild/tests).

Well, this ticket is about integrating the build of the documentation into the rest of the build system. So having one log file is consistent with that.

> It also seems that calls to 'make' with a wrong rule will produce output too.

True, but that's not really a major problem, is it?



---

archive/issue_comments_250750.json:
```json
{
    "body": "<a id='comment:22'></a>If having one makefile call the other forces you to accept so many issues with the logfiles, then this temporary design maybe isn't a good idea.",
    "created_at": "2015-06-17T10:57:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250750",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:22'></a>If having one makefile call the other forces you to accept so many issues with the logfiles, then this temporary design maybe isn't a good idea.



---

archive/issue_comments_250751.json:
```json
{
    "body": "<a id='comment:23'></a>Replying to [comment:22 ncohen]:\n> If having one makefile call the other forces you to accept so many issues with the logfiles, then this temporary design maybe isn't a good idea.\n\nThe only new issue is that the output of `make this_target_does_not_exist` gets logged in `install.log`. I do not believe that this is sufficient reason to reject this patch.\n\nAll the other issues that you mentioned in [comment:20] are already present in Sage, independent of this ticket.",
    "created_at": "2015-06-17T11:29:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250751",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>Replying to [comment:22 ncohen]:
> If having one makefile call the other forces you to accept so many issues with the logfiles, then this temporary design maybe isn't a good idea.

The only new issue is that the output of `make this_target_does_not_exist` gets logged in `install.log`. I do not believe that this is sufficient reason to reject this patch.

All the other issues that you mentioned in [comment:20] are already present in Sage, independent of this ticket.



---

archive/issue_comments_250752.json:
```json
{
    "body": "<a id='comment:24'></a>Why do you insist on logging the output of a 'forwarded' rule call? Why wouldn't you just let the actual rule hande the logging?\n\nP.S.: How can you even be sure that the final logging rule does not simultaneously output to install.log?",
    "created_at": "2015-06-17T11:32:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250752",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:24'></a>Why do you insist on logging the output of a 'forwarded' rule call? Why wouldn't you just let the actual rule hande the logging?

P.S.: How can you even be sure that the final logging rule does not simultaneously output to install.log?



---

archive/issue_comments_250753.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 ncohen]:\n> Why do you insist on logging the output of a 'forwarded' rule call?\n\nI am just keeping this behaviour **which already exists in Sage**. Changing this is not in the scope of this ticket.\n\n> P.S.: How can you even be sure that the final logging rule does not simultaneously output to install.log?\n\nEven if that happens, that's not really a problem (it's perfectly legal to have more than 1 process append to the same file, then output will appear in \"random\" order, nothing will be lost).",
    "created_at": "2015-06-17T11:36:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250753",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Replying to [comment:24 ncohen]:
> Why do you insist on logging the output of a 'forwarded' rule call?

I am just keeping this behaviour **which already exists in Sage**. Changing this is not in the scope of this ticket.

> P.S.: How can you even be sure that the final logging rule does not simultaneously output to install.log?

Even if that happens, that's not really a problem (it's perfectly legal to have more than 1 process append to the same file, then output will appear in "random" order, nothing will be lost).



---

archive/issue_comments_250754.json:
```json
{
    "body": "<a id='comment:26'></a>> I am just keeping this behaviour **which already exists in Sage**.\n\n\nExplain what you mean: this logging is done in a rule that you create in this branch.",
    "created_at": "2015-06-17T11:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250754",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:26'></a>> I am just keeping this behaviour **which already exists in Sage**.


Explain what you mean: this logging is done in a rule that you create in this branch.



---

archive/issue_comments_250755.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:26 ncohen]:\n> this logging is done in a rule created by this branch.\n\nCurrently in Sage:\n\n```\nbuild: logs configure\n    +cd build && \\\n    \"../$(PIPE)\" \\\n        \"./install all 2>&1\" \\\n        \"tee -a ../logs/install.log\"\n    +./sage -b\n```\n\nWith this ticket:\n\n```\n%::\n    $(MAKE) configure logs\n    +cd build && ./pipestatus \\\n        \"./install '$@' 2>&1\" \\\n        \"tee -a ../logs/install.log\"\n```\n\nThere is no difference at all in how `install.log` is treated.",
    "created_at": "2015-06-17T11:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250755",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>Replying to [comment:26 ncohen]:
> this logging is done in a rule created by this branch.

Currently in Sage:

```
build: logs configure
    +cd build && \
    "../$(PIPE)" \
        "./install all 2>&1" \
        "tee -a ../logs/install.log"
    +./sage -b
```

With this ticket:

```
%::
    $(MAKE) configure logs
    +cd build && ./pipestatus \
        "./install '$@' 2>&1" \
        "tee -a ../logs/install.log"
```

There is no difference at all in how `install.log` is treated.



---

archive/issue_comments_250756.json:
```json
{
    "body": "<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-17T11:51:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250756",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:28'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250757.json:
```json
{
    "body": "<a id='comment:29'></a>> There is no difference at all in how `install.log` is treated.\n\n\nBe honest for a second Jeroen. There is no difference at all *when make build* is called. For all other calls, there is a difference. In these situations, it would make more sense to not double-log everything. Why don't you move the logging to `install.log` to the `build:` rule in the other makefile?\n\nAnd then, you can remove the logging from this very very generic rule.\n\nNathann",
    "created_at": "2015-06-17T11:53:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250757",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:29'></a>> There is no difference at all in how `install.log` is treated.


Be honest for a second Jeroen. There is no difference at all *when make build* is called. For all other calls, there is a difference. In these situations, it would make more sense to not double-log everything. Why don't you move the logging to `install.log` to the `build:` rule in the other makefile?

And then, you can remove the logging from this very very generic rule.

Nathann



---

archive/issue_comments_250758.json:
```json
{
    "body": "<a id='comment:30'></a>Can you please try to understand the following sentence?\n\n**We are already double-logging the whole build process and my ticket does not change that.**\n\nThere are a few small differences, sure: with #18710, also the docbuild is double-logged. But that's not a fundamental change.",
    "created_at": "2015-06-17T12:00:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250758",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>Can you please try to understand the following sentence?

**We are already double-logging the whole build process and my ticket does not change that.**

There are a few small differences, sure: with #18710, also the docbuild is double-logged. But that's not a fundamental change.



---

archive/issue_comments_250759.json:
```json
{
    "body": "<a id='comment:31'></a>> Can you please try to understand the following sentence?\n> \n> **We are already double-logging the whole build process and my ticket does not change that.**\n\n\nJeroen, I am here to review your ticket. If all you plan on doing is scream whenever your reviewer disagrees with you, your ticket is blocked. Agreed ?\n\nSo let's do something constructive: can you tell me why you insist on double-logging in this new rule that you add? Can't you just move this logging to the other makefile?",
    "created_at": "2015-06-17T12:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250759",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:31'></a>> Can you please try to understand the following sentence?
> 
> **We are already double-logging the whole build process and my ticket does not change that.**


Jeroen, I am here to review your ticket. If all you plan on doing is scream whenever your reviewer disagrees with you, your ticket is blocked. Agreed ?

So let's do something constructive: can you tell me why you insist on double-logging in this new rule that you add? Can't you just move this logging to the other makefile?



---

archive/issue_comments_250760.json:
```json
{
    "body": "<a id='comment:32'></a>Replying to [comment:31 ncohen]:\n> > Can you please try to understand the following sentence?\n> > \n> > **We are already double-logging the whole build process and my ticket does not change that.**\n\n> \n> Jeroen, I am here to review your ticket. If all you plan on doing is scream whenever your reviewer disagrees with you, your ticket is blocked. Agreed ?\n\nIt just feels to me like you are complaining without reading my comments. I hope that the bold sentence above will not escape your attention. Anyway, I need to cool down for a while...",
    "created_at": "2015-06-17T12:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250760",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'></a>Replying to [comment:31 ncohen]:
> > Can you please try to understand the following sentence?
> > 
> > **We are already double-logging the whole build process and my ticket does not change that.**

> 
> Jeroen, I am here to review your ticket. If all you plan on doing is scream whenever your reviewer disagrees with you, your ticket is blocked. Agreed ?

It just feels to me like you are complaining without reading my comments. I hope that the bold sentence above will not escape your attention. Anyway, I need to cool down for a while...



---

archive/issue_comments_250761.json:
```json
{
    "body": "<a id='comment:33'></a>> It just feels to me like you are complaining without reading my comments. I hope that the bold sentence above will not escape your attention. \n\n\nTo me it is an assertion without proof. You tell me that everything is already double-logged, while I have my eyes on a generic rule that you add that double-logs everything automatically. Is it now triple-logged?\n\nI also asked you in my last comment why you wouldn't move this logging to the other file, so that it only applies to the 'build' rule, but you did not answer that.\n\n> Anyway, I need to cool down for a while...\n\n\nYep.\n\nNathann",
    "created_at": "2015-06-17T12:09:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250761",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:33'></a>> It just feels to me like you are complaining without reading my comments. I hope that the bold sentence above will not escape your attention. 


To me it is an assertion without proof. You tell me that everything is already double-logged, while I have my eyes on a generic rule that you add that double-logs everything automatically. Is it now triple-logged?

I also asked you in my last comment why you wouldn't move this logging to the other file, so that it only applies to the 'build' rule, but you did not answer that.

> Anyway, I need to cool down for a while...


Yep.

Nathann



---

archive/issue_comments_250762.json:
```json
{
    "body": "<a id='comment:34'></a>OK, let me try again:\n\n> Can't you just move this logging to the other makefile?\n\nThere is already logging in the individual rules in `build/Makefile`. This is logging number 1.\n\nThe logging to `install.log` from `Makefile` is logging number 2.\n\nI don't see where a \"triple logging\" could come from.\n\nNote that `install.log` contains information which is not available from the individual log files:\n1. a listing of environment variables at the start of the build, and other output from `build/install`.\n2. timing information: it shows all commands in parallel as they are executed. This is actually a feature, since it allows debugging race conditions. With just the individual files, that information is lost.",
    "created_at": "2015-06-17T12:41:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250762",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'></a>OK, let me try again:

> Can't you just move this logging to the other makefile?

There is already logging in the individual rules in `build/Makefile`. This is logging number 1.

The logging to `install.log` from `Makefile` is logging number 2.

I don't see where a "triple logging" could come from.

Note that `install.log` contains information which is not available from the individual log files:
1. a listing of environment variables at the start of the build, and other output from `build/install`.
2. timing information: it shows all commands in parallel as they are executed. This is actually a feature, since it allows debugging race conditions. With just the individual files, that information is lost.



---

archive/issue_comments_250763.json:
```json
{
    "body": "<a id='comment:35'></a>Yooooooo !\n\n> There is already logging in the individual rules in `build/Makefile`. This is logging number 1.\n> \n> The logging to `install.log` from `Makefile` is logging number 2.\n\n\nRight. Do we agree that before your branch is applied, this \"number 2 logging\" in `install.log` is only performed for 'make build'?\n\n(assuming that we agree on that) With the new fallback `%::` rule that you added, all calls to 'make X' that are not defined in `SAGE_ROOT/Makefile` are forwarded to `build/Makefile`. Thus, after your branch is applied, the output of `make doc-html` is logged in `install.log`. \n\n(assuming that we agree on that) Before your branch is applied, the output of `make doc-html` was not logged i install.log.\n\n(assuming that we agree on that) Why wouldn't we remove the logging from the `%::` rule, and only add it in the `make build` rule (which is now the `make all-build` rule from `build/Makefile`)?\n\n> Note that `install.log` contains information which is not available from the individual log files:\n> 1. a listing of environment variables at the start of the build, and other output from `build/install`.\n> 2. timing information: it shows all commands in parallel as they are executed. This is actually a feature, since it allows debugging race conditions. With just the individual files, that information is lost.\n\n\nFor 'make build' it I agree that this information can make sense.\n\nNathann",
    "created_at": "2015-06-17T13:12:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250763",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:35'></a>Yooooooo !

> There is already logging in the individual rules in `build/Makefile`. This is logging number 1.
> 
> The logging to `install.log` from `Makefile` is logging number 2.


Right. Do we agree that before your branch is applied, this "number 2 logging" in `install.log` is only performed for 'make build'?

(assuming that we agree on that) With the new fallback `%::` rule that you added, all calls to 'make X' that are not defined in `SAGE_ROOT/Makefile` are forwarded to `build/Makefile`. Thus, after your branch is applied, the output of `make doc-html` is logged in `install.log`. 

(assuming that we agree on that) Before your branch is applied, the output of `make doc-html` was not logged i install.log.

(assuming that we agree on that) Why wouldn't we remove the logging from the `%::` rule, and only add it in the `make build` rule (which is now the `make all-build` rule from `build/Makefile`)?

> Note that `install.log` contains information which is not available from the individual log files:
> 1. a listing of environment variables at the start of the build, and other output from `build/install`.
> 2. timing information: it shows all commands in parallel as they are executed. This is actually a feature, since it allows debugging race conditions. With just the individual files, that information is lost.


For 'make build' it I agree that this information can make sense.

Nathann



---

archive/issue_comments_250764.json:
```json
{
    "body": "<a id='comment:36'></a>Replying to [comment:35 ncohen]:\n> Right. Do we agree that before your branch is applied, this \"number 2 logging\" in `install.log` is only performed for 'make build'?\n  \nYes. However, let me remark that most top-level targets depend on `build`, so the \"build\" part of those targets is also logged in `install.log`.\n\n> With the new fallback `%::` rule that you added, all calls to 'make X' that are not defined in `SAGE_ROOT/Makefile` are forwarded to `build/Makefile`. Thus, after your branch is applied, the output of `make doc-html` is logged in `install.log`.\nTrue. But this is a feature, not a bug.\n\n> (assuming that we agree on that) Before your branch is applied, the output of `make doc-html` was not logged in `install.log`.\n\nObviously true.\n\n> (assuming that we agree on that) Why wouldn't we remove the logging from the `%::` rule, and only add it in the `make build` rule (which is now the `make all-build` rule from `build/Makefile`)?\n\n\nSee the last paragraph of [comment:34]. Those reasons make sense for `make doc` as much for `make build`.",
    "created_at": "2015-06-17T13:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250764",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'></a>Replying to [comment:35 ncohen]:
> Right. Do we agree that before your branch is applied, this "number 2 logging" in `install.log` is only performed for 'make build'?
  
Yes. However, let me remark that most top-level targets depend on `build`, so the "build" part of those targets is also logged in `install.log`.

> With the new fallback `%::` rule that you added, all calls to 'make X' that are not defined in `SAGE_ROOT/Makefile` are forwarded to `build/Makefile`. Thus, after your branch is applied, the output of `make doc-html` is logged in `install.log`.
True. But this is a feature, not a bug.

> (assuming that we agree on that) Before your branch is applied, the output of `make doc-html` was not logged in `install.log`.

Obviously true.

> (assuming that we agree on that) Why wouldn't we remove the logging from the `%::` rule, and only add it in the `make build` rule (which is now the `make all-build` rule from `build/Makefile`)?


See the last paragraph of [comment:34]. Those reasons make sense for `make doc` as much for `make build`.



---

archive/issue_comments_250765.json:
```json
{
    "body": "<a id='comment:37'></a>I'll try to get rid of the explicit running of `./sage -b` (which shouldn't be needed).",
    "created_at": "2015-06-17T13:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250765",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:37'></a>I'll try to get rid of the explicit running of `./sage -b` (which shouldn't be needed).



---

archive/issue_comments_250766.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-06-17T13:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250766",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_250767.json:
```json
{
    "body": "<a id='comment:38'></a>Okay. From what you say, it appears to me that:\n\n1) After your branch is applied, \"make build\" is logged exactly as previously in `install.log`\n2) After your branch is applied, the output of `make doc-html` is logged in `install.log`. As it triggers a `make build`, then the output of `make build` is logged twice in `install.log` (once in `make doc-html`, once in the triggered `make build`)\n3) My problem with your `%::` is that is that it covers *any* kind of rule, even those that we will add in the future. Promising right now that any rules that is aliased from `Makefile` to `build/Makefile` will be logged in `install.log` looks too wide for me.\n\nThus, could you remove this logging from the `%::` rule? You could add the same logging in the `make all-sage` rule. It would also let you add a more specific logging of `make doc` that would not cover the subsequent call to `make build`, thus we would not double-log that.\n\n> See the last paragraph of [comment:34]. Those reasons make sense for `make doc` as much for `make build`.\n\n\nI would have less problem if you were only adding those rules in `make doc` and `make build`. Right now you are doing this in a wider scope: you apply then to all rules that are aliased, even those that will be added later.\n\nNathann",
    "created_at": "2015-06-17T13:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250767",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:38'></a>Okay. From what you say, it appears to me that:

1) After your branch is applied, "make build" is logged exactly as previously in `install.log`
2) After your branch is applied, the output of `make doc-html` is logged in `install.log`. As it triggers a `make build`, then the output of `make build` is logged twice in `install.log` (once in `make doc-html`, once in the triggered `make build`)
3) My problem with your `%::` is that is that it covers *any* kind of rule, even those that we will add in the future. Promising right now that any rules that is aliased from `Makefile` to `build/Makefile` will be logged in `install.log` looks too wide for me.

Thus, could you remove this logging from the `%::` rule? You could add the same logging in the `make all-sage` rule. It would also let you add a more specific logging of `make doc` that would not cover the subsequent call to `make build`, thus we would not double-log that.

> See the last paragraph of [comment:34]. Those reasons make sense for `make doc` as much for `make build`.


I would have less problem if you were only adding those rules in `make doc` and `make build`. Right now you are doing this in a wider scope: you apply then to all rules that are aliased, even those that will be added later.

Nathann



---

archive/issue_comments_250768.json:
```json
{
    "body": "<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-17T14:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250768",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:39'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250769.json:
```json
{
    "body": "<a id='comment:40'></a>Replying to [comment:38 ncohen]:\n> After your branch is applied, the output of `make doc-html` is logged in `install.log`. As it triggers a `make build`, then the output of `make build` is logged twice in `install.log` (once in `make doc-html`, once in the triggered `make build`)\n\n\nI think you are misunderstanding something, because this is not true: `make doc-html` does not trigger `make build`.\n\nThe documentation is now built similarly to spkgs. The dependencies for the documentation are declared just like the dependencies for packages, see this part of `build/Makefile`:\n\n```Makefile\n# Building the documentation has many dependencies, because all\n# documented modules are imported and because we use matplotlib to\n# produce plots.\nDOC_DEPENDENCIES = sagelib $(INST)/$(SPHINX) $(INST)/$(SAGENB) \\\n    | $(SAGERUNTIME) $(INST)/$(MAXIMA) $(INST)/$(NETWORKX) \\\n    $(INST)/$(SCIPY) $(INST)/$(MATPLOTLIB) $(INST)/$(PILLOW)\n\ndoc: doc-html\n\ndoc-html: $(DOC_DEPENDENCIES)\n    cd .. && $(PIPE) \"./sage --docbuild --no-pdf-links all html $(SAGE_DOCBUILD_OPTS) 2>&1\" \"tee -a logs/dochtml.log\"\n```\n\n---\nNew commits:",
    "created_at": "2015-06-17T14:19:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250769",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>Replying to [comment:38 ncohen]:
> After your branch is applied, the output of `make doc-html` is logged in `install.log`. As it triggers a `make build`, then the output of `make build` is logged twice in `install.log` (once in `make doc-html`, once in the triggered `make build`)


I think you are misunderstanding something, because this is not true: `make doc-html` does not trigger `make build`.

The documentation is now built similarly to spkgs. The dependencies for the documentation are declared just like the dependencies for packages, see this part of `build/Makefile`:

```Makefile
# Building the documentation has many dependencies, because all
# documented modules are imported and because we use matplotlib to
# produce plots.
DOC_DEPENDENCIES = sagelib $(INST)/$(SPHINX) $(INST)/$(SAGENB) \
    | $(SAGERUNTIME) $(INST)/$(MAXIMA) $(INST)/$(NETWORKX) \
    $(INST)/$(SCIPY) $(INST)/$(MATPLOTLIB) $(INST)/$(PILLOW)

doc: doc-html

doc-html: $(DOC_DEPENDENCIES)
    cd .. && $(PIPE) "./sage --docbuild --no-pdf-links all html $(SAGE_DOCBUILD_OPTS) 2>&1" "tee -a logs/dochtml.log"
```

---
New commits:



---

archive/issue_comments_250770.json:
```json
{
    "body": "<a id='comment:41'></a>Replying to [comment:38 ncohen]:\n> 3) My problem with your `%::` is that is that it covers *any* kind of rule, even those that we will add in the future. Promising right now that any rules that is aliased from `Makefile` to `build/Makefile` will be logged in `install.log` looks too wide for me.\n\nWhen logging, it is safer to log too much than too little. So I actually think this extra logging of everything going through to `build/Makefile` is a feature rather than a bug. Think of `install.log` as a log of everything regarding the build of your Sage installation. What's wrong with that? Are you afraid of losing a few megabytes of disk space?\n\n> I would have less problem if you were only adding those rules in `make doc` and `make build`\n\nWhen you say `make doc`, do you really mean `make doc` or also `make doc-pdf` and `make doc-html-jsmath` and similar? When you say `make build`, I guess you really mean `make all` and `make all-build` (or just one of these?). You see that this becomes complicated...",
    "created_at": "2015-06-17T14:31:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250770",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:41'></a>Replying to [comment:38 ncohen]:
> 3) My problem with your `%::` is that is that it covers *any* kind of rule, even those that we will add in the future. Promising right now that any rules that is aliased from `Makefile` to `build/Makefile` will be logged in `install.log` looks too wide for me.

When logging, it is safer to log too much than too little. So I actually think this extra logging of everything going through to `build/Makefile` is a feature rather than a bug. Think of `install.log` as a log of everything regarding the build of your Sage installation. What's wrong with that? Are you afraid of losing a few megabytes of disk space?

> I would have less problem if you were only adding those rules in `make doc` and `make build`

When you say `make doc`, do you really mean `make doc` or also `make doc-pdf` and `make doc-html-jsmath` and similar? When you say `make build`, I guess you really mean `make all` and `make all-build` (or just one of these?). You see that this becomes complicated...



---

archive/issue_comments_250771.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-06-17T14:31:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250771",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_250772.json:
```json
{
    "body": "<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-19T10:34:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250772",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:43'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_250773.json:
```json
{
    "body": "<a id='comment:44'></a>Squashed and rebased to latest beta.",
    "created_at": "2015-06-19T10:34:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250773",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:44'></a>Squashed and rebased to latest beta.



---

archive/issue_comments_250774.json:
```json
{
    "body": "<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-06-19T10:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250774",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:45'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_250775.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-06-28T09:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250775",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_052411.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-28T11:37:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18710#event-52411"
}
```



---

archive/issue_comments_250776.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-06-28T11:37:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250776",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_250777.json:
```json
{
    "body": "<a id='comment:48'></a>I'm reopening this as it totally breaks OSX, see http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20full/builds/63/steps/compile_1/logs/stdio\n\nI haven't tried to understand whats going on but it seems that packages don't wait for the gcc build to finish",
    "created_at": "2015-06-29T09:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250777",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:48'></a>I'm reopening this as it totally breaks OSX, see http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20full/builds/63/steps/compile_1/logs/stdio

I haven't tried to understand whats going on but it seems that packages don't wait for the gcc build to finish



---

archive/issue_comments_250778.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2015-06-29T09:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250778",
    "user": "https://github.com/vbraun"
}
```

Changing status from closed to new.



---

archive/issue_events_052412.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-29T09:27:36Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18710#event-52412"
}
```



---

archive/issue_comments_250779.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2015-06-29T09:27:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250779",
    "user": "https://github.com/vbraun"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_250780.json:
```json
{
    "body": "<a id='comment:49'></a>Got it: the problem is that the buildbot runs `make start` which is indeed broken.",
    "created_at": "2015-06-29T09:53:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250780",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:49'></a>Got it: the problem is that the buildbot runs `make start` which is indeed broken.



---

archive/issue_comments_250781.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-29T11:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250781",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_250782.json:
```json
{
    "body": "<a id='comment:51'></a>Now `make start` works properly after `make distclean`.\n\n---\nNew commits:",
    "created_at": "2015-06-29T11:04:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250782",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>Now `make start` works properly after `make distclean`.

---
New commits:



---

archive/issue_comments_250783.json:
```json
{
    "body": "<a id='comment:52'></a>These old commits already have positive_review:\n> |                                                                                                                                          |                                        |\n> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|\n> |[f3c4445](http://git.sagemath.org/sage.git/commit/?id=f3c4445950120a708b9da3bd3d2bfe68a27f09cc)|`Move various targets to build/Makefile`|\n> |[b86e0bb](http://git.sagemath.org/sage.git/commit/?id=b86e0bb1f7f558f6f6b853a3eb0ff60a145eaebc)|`Fix strange mixture of TABs and spaces`|\n\n\nThis commit was by Volker for #18788, but it really belongs on this ticket. I give it positive_review:\n> |                                                                                                                                          |                              |\n> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|\n> |[1eac5fd](http://git.sagemath.org/sage.git/commit/?id=1eac5fdde95cd5a0c605028101d2c38f55fda275)|`Remove test for faux package`|\n\n\nSo this is the only commit which needs to be reviewed:\n> |                                                                                                                                          |                                   |\n> |------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|\n> |[6db418e](http://git.sagemath.org/sage.git/commit/?id=6db418e791a4d1881bd455e6814458457e904476)|`Fix dependencies for \"make start\"`|",
    "created_at": "2015-06-29T15:20:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250783",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:52'></a>These old commits already have positive_review:
> |                                                                                                                                          |                                        |
> |------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------|
> |[f3c4445](http://git.sagemath.org/sage.git/commit/?id=f3c4445950120a708b9da3bd3d2bfe68a27f09cc)|`Move various targets to build/Makefile`|
> |[b86e0bb](http://git.sagemath.org/sage.git/commit/?id=b86e0bb1f7f558f6f6b853a3eb0ff60a145eaebc)|`Fix strange mixture of TABs and spaces`|


This commit was by Volker for #18788, but it really belongs on this ticket. I give it positive_review:
> |                                                                                                                                          |                              |
> |------------------------------------------------------------------------------------------------------------------------------------------|------------------------------|
> |[1eac5fd](http://git.sagemath.org/sage.git/commit/?id=1eac5fdde95cd5a0c605028101d2c38f55fda275)|`Remove test for faux package`|


So this is the only commit which needs to be reviewed:
> |                                                                                                                                          |                                   |
> |------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------|
> |[6db418e](http://git.sagemath.org/sage.git/commit/?id=6db418e791a4d1881bd455e6814458457e904476)|`Fix dependencies for "make start"`|



---

archive/issue_events_052413.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-29T22:31:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18710#event-52413"
}
```



---

archive/issue_comments_250784.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-06-29T22:31:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250784",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_250785.json:
```json
{
    "body": "<a id='comment:54'></a>Is there a philosophy behind which targets are in the top-level `Makefile` and which are in `build/deps`? `build-clean`, for example? Or maybe more importantly, if someone wanted to add a new target, how to decide where it should go?",
    "created_at": "2015-07-06T18:31:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250785",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:54'></a>Is there a philosophy behind which targets are in the top-level `Makefile` and which are in `build/deps`? `build-clean`, for example? Or maybe more importantly, if someone wanted to add a new target, how to decide where it should go?



---

archive/issue_comments_250786.json:
```json
{
    "body": "<a id='comment:55'></a>To a first approximation, I'd say stuff dealing specifically with third-party packages should go to deps and more global targets to the top-level Makefile. But then its really just putting lipstick on a pig. What we **really** need is a reliable build system, not a policy where to put stuff right now.",
    "created_at": "2015-07-06T22:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250786",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:55'></a>To a first approximation, I'd say stuff dealing specifically with third-party packages should go to deps and more global targets to the top-level Makefile. But then its really just putting lipstick on a pig. What we **really** need is a reliable build system, not a policy where to put stuff right now.



---

archive/issue_comments_250787.json:
```json
{
    "body": "<a id='comment:56'></a>What's up with\n\n```\n+$(STARTED): $(STANDARD_PACKES)\n+\t\"$(SAGE_LOCAL)/bin/sage-starts\"\n```\nShouldn't that be `STANDARD_PACKAGES`?",
    "created_at": "2015-07-13T17:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250787",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:56'></a>What's up with

```
+$(STARTED): $(STANDARD_PACKES)
+	"$(SAGE_LOCAL)/bin/sage-starts"
```
Shouldn't that be `STANDARD_PACKAGES`?



---

archive/issue_comments_250788.json:
```json
{
    "body": "<a id='comment:57'></a>Of course...",
    "created_at": "2015-07-13T18:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18710",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18710#issuecomment-250788",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:57'></a>Of course...
