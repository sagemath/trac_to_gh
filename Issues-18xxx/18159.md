# Issue 18159: cardinality must output Infinty or a Sage integer

archive/issues_017922.json:
```json
{
    "body": "We add a `._test_cardinality()` method in the category `Sets` that takes care of checking that the output of `.cardinality()` is a Sage integer or +Infinity.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18159\n\n",
    "closed_at": "2015-07-02T20:09:24Z",
    "created_at": "2015-04-11T14:46:55Z",
    "labels": [
        "component: categories",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "cardinality must output Infinty or a Sage integer",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18159",
    "user": "https://github.com/videlec"
}
```
We add a `._test_cardinality()` method in the category `Sets` that takes care of checking that the output of `.cardinality()` is a Sage integer or +Infinity.

Issue created by migration from https://trac.sagemath.org/ticket/18159





---

archive/issue_comments_240346.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-04-11T14:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240346",
    "user": "https://github.com/videlec"
}
```

New commits:



---

archive/issue_comments_240347.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-11T16:09:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240347",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240348.json:
```json
{
    "body": "What is wrong with an 'int'? `O_o`",
    "created_at": "2015-04-11T16:27:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240348",
    "user": "https://github.com/nathanncohen"
}
```

What is wrong with an 'int'? `O_o`



---

archive/issue_comments_240349.json:
```json
{
    "body": "Replying to [comment:3 ncohen]:\n> What is wrong with an 'int'? `O_o`\n\n\n`2/3` for example.",
    "created_at": "2015-04-11T16:51:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240349",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:3 ncohen]:
> What is wrong with an 'int'? `O_o`


`2/3` for example.



---

archive/issue_comments_240350.json:
```json
{
    "body": "I do not understand. It seems that your code detects it as 'wrong' if a function `.cardinality()` returns `int(4)`. Why is that?",
    "created_at": "2015-04-11T16:53:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240350",
    "user": "https://github.com/nathanncohen"
}
```

I do not understand. It seems that your code detects it as 'wrong' if a function `.cardinality()` returns `int(4)`. Why is that?



---

archive/issue_comments_240351.json:
```json
{
    "body": "Replying to [comment:5 ncohen]:\n> I do not understand. It seems that your code detects it as 'wrong' if a function `.cardinality()` returns `int(4)`. Why is that?\n\n\nYes. And the reason is because Python int do not behave as Sage integers. For example\n\n```\nsage: S = my_finite_set()\nsage: S.cardinality().factor()\nsage: ~(S.cardinality())\n```\nFor coherence, we need to have some specifications for `.cardinality`.\n\nThe main reason for that ticket was that some sets were actually returning rational numbers see http://trac.sagemath.org/ticket/17852#comment:92",
    "created_at": "2015-04-11T16:59:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240351",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:5 ncohen]:
> I do not understand. It seems that your code detects it as 'wrong' if a function `.cardinality()` returns `int(4)`. Why is that?


Yes. And the reason is because Python int do not behave as Sage integers. For example

```
sage: S = my_finite_set()
sage: S.cardinality().factor()
sage: ~(S.cardinality())
```
For coherence, we need to have some specifications for `.cardinality`.

The main reason for that ticket was that some sets were actually returning rational numbers see http://trac.sagemath.org/ticket/17852#comment:92



---

archive/issue_comments_240352.json:
```json
{
    "body": "That they behave differently is not (to me) a sufficient reason to prevent everybody from returning python ints. Checking that the output can be turned into an int would be sufficient to detect this problem with rational numbers.",
    "created_at": "2015-04-11T17:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240352",
    "user": "https://github.com/nathanncohen"
}
```

That they behave differently is not (to me) a sufficient reason to prevent everybody from returning python ints. Checking that the output can be turned into an int would be sufficient to detect this problem with rational numbers.



---

archive/issue_comments_240353.json:
```json
{
    "body": "Replying to [comment:8 ncohen]:\n> That they behave differently is not (to me) a sufficient reason to prevent everybody from returning python ints. Checking that the output can be turned into an int would be sufficient to detect this problem with rational numbers.\n\n\nAll right, output string is accepted as well?\n\nThis is very bad. Imagine I need something like:\n\n```\nsage: vector([s.cardinality() for s in S])\n```\nIf any of the `s.cardinality()` returns a rational, I end up with a vector over rational numbers (which are much slower than over integers).\n\nIt is very similar to `is_X` functions that return boolean answers. You might complain if they start returning `gap` booleans or `numpy` boolean objects.\n\nVincent",
    "created_at": "2015-04-11T17:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240353",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:8 ncohen]:
> That they behave differently is not (to me) a sufficient reason to prevent everybody from returning python ints. Checking that the output can be turned into an int would be sufficient to detect this problem with rational numbers.


All right, output string is accepted as well?

This is very bad. Imagine I need something like:

```
sage: vector([s.cardinality() for s in S])
```
If any of the `s.cardinality()` returns a rational, I end up with a vector over rational numbers (which are much slower than over integers).

It is very similar to `is_X` functions that return boolean answers. You might complain if they start returning `gap` booleans or `numpy` boolean objects.

Vincent



---

archive/issue_comments_240354.json:
```json
{
    "body": "What would you have against testing that it is an int, a long, an Integer, or equal to (not 'is') infinity?\n\nNathann",
    "created_at": "2015-04-11T17:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240354",
    "user": "https://github.com/nathanncohen"
}
```

What would you have against testing that it is an int, a long, an Integer, or equal to (not 'is') infinity?

Nathann



---

archive/issue_comments_240355.json:
```json
{
    "body": "Replying to [comment:10 ncohen]:\n> What would you have against testing that it is an int, a long, an Integer, or equal to (not 'is') infinity?\n\n\nYou do not want to see a Sage rational anymore? And what about `numpy` integers, `pari` integers, `gp` integers, `gap` integers and `libgap` integers?\n\nTesting equality to infinity might be broken or you can have objects that want to be equal to everybody (why not?).\n\nThe specification in `sage.categories.sets_cat` is:\n\n```\n``self.cardinality()`` should return the cardinality of the set\n``self`` as a sage :class:`Integer` or as ``infinity``.\n```\n\nIf you complain that it should not be the case then you should argue why. And not telling me to argue why not.\n\nVincent",
    "created_at": "2015-04-11T17:21:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240355",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:10 ncohen]:
> What would you have against testing that it is an int, a long, an Integer, or equal to (not 'is') infinity?


You do not want to see a Sage rational anymore? And what about `numpy` integers, `pari` integers, `gp` integers, `gap` integers and `libgap` integers?

Testing equality to infinity might be broken or you can have objects that want to be equal to everybody (why not?).

The specification in `sage.categories.sets_cat` is:

```
``self.cardinality()`` should return the cardinality of the set
``self`` as a sage :class:`Integer` or as ``infinity``.
```

If you complain that it should not be the case then you should argue why. And not telling me to argue why not.

Vincent



---

archive/issue_comments_240356.json:
```json
{
    "body": "I think that it should not be the case because python ints/long are smaller and faster than Sage Integers, and that we should not be forced to instantiate Integers if we do not need to.\n\nFor the very same reason you invoked, earlier, when you said that you did not want rationals because of the possible loss of time.\n\nNathann",
    "created_at": "2015-04-11T17:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240356",
    "user": "https://github.com/nathanncohen"
}
```

I think that it should not be the case because python ints/long are smaller and faster than Sage Integers, and that we should not be forced to instantiate Integers if we do not need to.

For the very same reason you invoked, earlier, when you said that you did not want rationals because of the possible loss of time.

Nathann



---

archive/issue_comments_240357.json:
```json
{
    "body": "(note that your problems are solved if you specify ZZ when you build your vector, isn't it?)",
    "created_at": "2015-04-11T17:31:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240357",
    "user": "https://github.com/nathanncohen"
}
```

(note that your problems are solved if you specify ZZ when you build your vector, isn't it?)



---

archive/issue_comments_240358.json:
```json
{
    "body": "Replying to [comment:12 ncohen]:\n> I think that it should not be the case because python ints/long are smaller and faster than Sage Integers, and that we should not be forced to instantiate Integers if we do not need to.\n> \n> For the very same reason you invoked, earlier, when you said that you did not want rationals because of the possible loss of time.\n\n\nIt was not only loss of time but well defineness. Additioning Python int with Sage integers is slower than Sage integer with Sage integer.\n\n```\nsage: python_one = 1r\nsage: sage_one = 1\nsage: sage_a = 2**12\nsage: timeit(\"sage_a + python_one\", number=5000000)\n5000000 loops, best of 3: 66.3 ns per loop\nsage: timeit(\"sage_a + sage_one\", number=5000000)\n5000000 loops, best of 3: 57.9 ns per loop\n```\nSo it is better to have everything being Sage integers.\n\nOn the other hand, if you really want Python integers you should call `len(my_set)` (and be sure to obtain a Python integer) and not `my_set.cardinality()`.\n\nVincent",
    "created_at": "2015-04-11T17:37:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240358",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:12 ncohen]:
> I think that it should not be the case because python ints/long are smaller and faster than Sage Integers, and that we should not be forced to instantiate Integers if we do not need to.
> 
> For the very same reason you invoked, earlier, when you said that you did not want rationals because of the possible loss of time.


It was not only loss of time but well defineness. Additioning Python int with Sage integers is slower than Sage integer with Sage integer.

```
sage: python_one = 1r
sage: sage_one = 1
sage: sage_a = 2**12
sage: timeit("sage_a + python_one", number=5000000)
5000000 loops, best of 3: 66.3 ns per loop
sage: timeit("sage_a + sage_one", number=5000000)
5000000 loops, best of 3: 57.9 ns per loop
```
So it is better to have everything being Sage integers.

On the other hand, if you really want Python integers you should call `len(my_set)` (and be sure to obtain a Python integer) and not `my_set.cardinality()`.

Vincent



---

archive/issue_comments_240359.json:
```json
{
    "body": "Replying to [comment:13 ncohen]:\n> (note that your problems are solved if you specify ZZ when you build your vector, isn't it?)\n\n\nYes, and\n\n```\nsage: vector(ZZ, ['1', gap(2), pari(3)])\n(1, 2, 3)\n```\nworks too.",
    "created_at": "2015-04-11T17:38:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240359",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:13 ncohen]:
> (note that your problems are solved if you specify ZZ when you build your vector, isn't it?)


Yes, and

```
sage: vector(ZZ, ['1', gap(2), pari(3)])
(1, 2, 3)
```
works too.



---

archive/issue_comments_240360.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-11T17:41:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240361.json:
```json
{
    "body": "> So it is better to have everything being Sage integers.\n\n\nIt may be better to have Sage integers if you want, for instance, to add them with other Sage integers. Why would that be sufficient to prevent anyone from returning int?\n\nNathann",
    "created_at": "2015-04-11T17:50:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240361",
    "user": "https://github.com/nathanncohen"
}
```

> So it is better to have everything being Sage integers.


It may be better to have Sage integers if you want, for instance, to add them with other Sage integers. Why would that be sufficient to prevent anyone from returning int?

Nathann



---

archive/issue_comments_240362.json:
```json
{
    "body": "Okay do whatever you like. At some point in this community there was a rule that we should all agree on something to make it pass. Nowadays it's like you just have to convince one of your friends and it can get in.\n\nNathann",
    "created_at": "2015-04-11T17:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240362",
    "user": "https://github.com/nathanncohen"
}
```

Okay do whatever you like. At some point in this community there was a rule that we should all agree on something to make it pass. Nowadays it's like you just have to convince one of your friends and it can get in.

Nathann



---

archive/issue_comments_240363.json:
```json
{
    "body": "Replying to [comment:19 ncohen]:\n> > So it is better to have everything being Sage integers.\n\n> \n> It may be better to have Sage integers if you want, for instance, to add them with other Sage integers. Why would that be sufficient to prevent anyone from returning int?\n\n\nIt is not sufficient. **You** were arguing that Python ints were better because faster. I just showed you that it is not completely right. An argument for `X` is generally not an argument for `Y`.\n\nThe reason to oblige people to return Sage integers or Infinity in the method `.cardinality` of a `Parent` is mostly for consistency (things are generally better if specified)",
    "created_at": "2015-04-11T18:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240363",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:19 ncohen]:
> > So it is better to have everything being Sage integers.

> 
> It may be better to have Sage integers if you want, for instance, to add them with other Sage integers. Why would that be sufficient to prevent anyone from returning int?


It is not sufficient. **You** were arguing that Python ints were better because faster. I just showed you that it is not completely right. An argument for `X` is generally not an argument for `Y`.

The reason to oblige people to return Sage integers or Infinity in the method `.cardinality` of a `Parent` is mostly for consistency (things are generally better if specified)



---

archive/issue_comments_240364.json:
```json
{
    "body": "> It is not sufficient. **You** were arguing that Python ints were better because faster. I just showed you that it is not completely right. An argument for `X` is generally not an argument for `Y`.\n\n\nAll I wanted to point out is that *sometimes* an int is better than an Integer, and that for this reason they should not be forbidden. I do not mean to say that a Python int is always better than a Sage Integer, and quite clearly it is not the case: ints overflows, Integers do not.\n\n> The reason to oblige people to return Sage integers or Infinity in the method `.cardinality` of a `Parent` is mostly for consistency.\n\n\nCouldn't we just use the `TestSuite` to detect errors? When you see a non-integer then something is most probably wrong and the testsuite should report it. What you are doing right now is simulate a \"return type\" for a function in a language that does not support it.\n\nNathann",
    "created_at": "2015-04-11T18:38:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240364",
    "user": "https://github.com/nathanncohen"
}
```

> It is not sufficient. **You** were arguing that Python ints were better because faster. I just showed you that it is not completely right. An argument for `X` is generally not an argument for `Y`.


All I wanted to point out is that *sometimes* an int is better than an Integer, and that for this reason they should not be forbidden. I do not mean to say that a Python int is always better than a Sage Integer, and quite clearly it is not the case: ints overflows, Integers do not.

> The reason to oblige people to return Sage integers or Infinity in the method `.cardinality` of a `Parent` is mostly for consistency.


Couldn't we just use the `TestSuite` to detect errors? When you see a non-integer then something is most probably wrong and the testsuite should report it. What you are doing right now is simulate a "return type" for a function in a language that does not support it.

Nathann



---

archive/issue_comments_240365.json:
```json
{
    "body": "Replying to [comment:22 ncohen]:\n> > It is not sufficient. **You** were arguing that Python ints were better because faster. I just showed you that it is not completely right. An argument for `X` is generally not an argument for `Y`.\n\n> \n> All I wanted to point out is that *sometimes* an int is better than an Integer, and that for this reason they should not be forbidden. I do not mean to say that a Python int is always better than a Sage Integer, and quite clearly it is not the case: ints overflows, Integers do not.\n\n\nJust to be sure: I do not want to forbid Python integer in general. For the output of `.cardinality()` I consider that Sage integers are *always* better. Perhaps I am wrong and this can be debated if needed. And, as I already mentioned, you can get Python integer for less effort doing `len(my_set)`.\n\n> > The reason to oblige people to return Sage integers or Infinity in the method `.cardinality` of a `Parent` is mostly for consistency.\n\n> \n> Couldn't we just use the `TestSuite` to detect errors?\n\n\nThat is my goal. But we do not agree that returning an `int` for `.cardinality()` is an error. In many situation, \"ensuring\" that it is a Sage integer prevent doing wrong things afterwards.\n\n> When you see a non-integer then something is most probably wrong and the testsuite should report it. What you are doing right now is simulate a \"return type\" for a function in a language that does not support it.\n\n\nYes. But having as dependency a ticket \"switch from Python to a strongly typed language\" would be too much effort. So Python is a fact and we have to deal with it.\n\nLet me mention that Python is trying to do some type checking because it is useful:\n\n```\nsage: class A(object):\n....:     def __len__(self):\n....:         return 'haha! well tried!'\nsage: a = A()\nsage: len(a)\nTraceback (most recent call last):\n...\nTypeError: an integer is required\n```\n(note that `a.__len__()` returns what you asked it to do).\n\nVincent",
    "created_at": "2015-04-11T19:04:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240365",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:22 ncohen]:
> > It is not sufficient. **You** were arguing that Python ints were better because faster. I just showed you that it is not completely right. An argument for `X` is generally not an argument for `Y`.

> 
> All I wanted to point out is that *sometimes* an int is better than an Integer, and that for this reason they should not be forbidden. I do not mean to say that a Python int is always better than a Sage Integer, and quite clearly it is not the case: ints overflows, Integers do not.


Just to be sure: I do not want to forbid Python integer in general. For the output of `.cardinality()` I consider that Sage integers are *always* better. Perhaps I am wrong and this can be debated if needed. And, as I already mentioned, you can get Python integer for less effort doing `len(my_set)`.

> > The reason to oblige people to return Sage integers or Infinity in the method `.cardinality` of a `Parent` is mostly for consistency.

> 
> Couldn't we just use the `TestSuite` to detect errors?


That is my goal. But we do not agree that returning an `int` for `.cardinality()` is an error. In many situation, "ensuring" that it is a Sage integer prevent doing wrong things afterwards.

> When you see a non-integer then something is most probably wrong and the testsuite should report it. What you are doing right now is simulate a "return type" for a function in a language that does not support it.


Yes. But having as dependency a ticket "switch from Python to a strongly typed language" would be too much effort. So Python is a fact and we have to deal with it.

Let me mention that Python is trying to do some type checking because it is useful:

```
sage: class A(object):
....:     def __len__(self):
....:         return 'haha! well tried!'
sage: a = A()
sage: len(a)
Traceback (most recent call last):
...
TypeError: an integer is required
```
(note that `a.__len__()` returns what you asked it to do).

Vincent



---

archive/issue_comments_240366.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-11T19:33:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240366",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_240367.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-11T19:34:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240367",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_240368.json:
```json
{
    "body": "I'd say we should ask for others' feeling on sage-devel before making a move here.\nPersonally I don't mind returning a Sage integer for cardinality, but Nathann does not agree.\nSo we should try to satisfy a large proportion of Sage users (or let Sage rot forever).",
    "created_at": "2015-05-18T21:10:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240368",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I'd say we should ask for others' feeling on sage-devel before making a move here.
Personally I don't mind returning a Sage integer for cardinality, but Nathann does not agree.
So we should try to satisfy a large proportion of Sage users (or let Sage rot forever).



---

archive/issue_comments_240369.json:
```json
{
    "body": "I agree with Vincent's view here: Having `.cardinality()` return a Sage Integer is better to my mind since then it comes with all the methods for integers. For a *basic* user, I guess it may be misleading than for some (finite...) sets you can write `S.cardinality().factor()` while it sometimes results in an error. \n\nI understand Nathann's concern on efficiency. Yet, my impression is that the issue is going to arise to *advanced* or *expert* users (whatever this means). These users should be capable of switching to `len(S)` if they feel the need for it. The proposed change actually is an improvement since it provides the user the choice for the return type, while no such choice existed before.",
    "created_at": "2015-05-26T13:43:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240369",
    "user": "https://github.com/bgrenet"
}
```

I agree with Vincent's view here: Having `.cardinality()` return a Sage Integer is better to my mind since then it comes with all the methods for integers. For a *basic* user, I guess it may be misleading than for some (finite...) sets you can write `S.cardinality().factor()` while it sometimes results in an error. 

I understand Nathann's concern on efficiency. Yet, my impression is that the issue is going to arise to *advanced* or *expert* users (whatever this means). These users should be capable of switching to `len(S)` if they feel the need for it. The proposed change actually is an improvement since it provides the user the choice for the return type, while no such choice existed before.



---

archive/issue_comments_240370.json:
```json
{
    "body": "> I understand Nathann's concern on efficiency. Yet, my impression is that the issue is going to arise to *advanced* or *expert* users (whatever this means). These users should be capable of switching to `len(S)` if they feel the need for it. The proposed change actually is an improvement since it provides the user the choice for the return type, while no such choice existed before.\n\n\nThe arguments that I see on this thread are not about whether \"cardinality\" should return python ints or Sage integers. \n\nWhile the ticket is indeed about `.cardinality` only, you will see that the arguments given here can be applied to any other Sage function that returns integers.\n\nOf course, having *all* such Sage functions return `Integer` objects is almost impossible to enforce, yet there is an easy way to enforce that for `.cardinality`, and this is what the branch implements.\n\nI do not like what is going on here, but I will not oppose it. You are too many.\n\nNathann",
    "created_at": "2015-05-26T14:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240370",
    "user": "https://github.com/nathanncohen"
}
```

> I understand Nathann's concern on efficiency. Yet, my impression is that the issue is going to arise to *advanced* or *expert* users (whatever this means). These users should be capable of switching to `len(S)` if they feel the need for it. The proposed change actually is an improvement since it provides the user the choice for the return type, while no such choice existed before.


The arguments that I see on this thread are not about whether "cardinality" should return python ints or Sage integers. 

While the ticket is indeed about `.cardinality` only, you will see that the arguments given here can be applied to any other Sage function that returns integers.

Of course, having *all* such Sage functions return `Integer` objects is almost impossible to enforce, yet there is an easy way to enforce that for `.cardinality`, and this is what the branch implements.

I do not like what is going on here, but I will not oppose it. You are too many.

Nathann



---

archive/issue_comments_240371.json:
```json
{
    "body": "> The arguments that I see on this thread are not about whether \"cardinality\" should return python ints or Sage integers. \n> \n> While the ticket is indeed about `.cardinality` only, you will see that the arguments given here can be applied to any other Sage function that returns integers.\n\n\nThat is not totally exact, since as Vincent mentioned it, you can replace `S.cardinality()` by `len(S)` if you want an `int`, and for efficiency concerns, `len(S.set())` is the fastest way to get it. Not all functions have this python counterpart.\n\nAs a user, I very much cares about the consistency in the return types. And I find this *very* annoying:\n\n```python\nsage: S = Set(range(2^20))\nsage: T = CartesianProduct(S,S)\nsage: T.cardinality().factor()\n2^40\nsage: S.cardinality().factor()\nTraceback (most recent call last):\n...\nAttributeError: 'int' object has no attribute 'factor'\n```\n\nNote that I still agree that the same argument may be used at some other places. For instance, let me consider univariate polynomials in sparse representation. I find the following very weird, and would be in favor of changing this behavior:\n\n```python\nsage: R.<x> = PolynomialRing(ZZ, sparse=True)\nsage: p = x^(2^100)+1\nsage: map(lambda t: type(t), p.exponents())\n[<type 'int'>, <type 'sage.rings.integer.Integer'>]\n```\n\n> I do not like what is going on here, but I will not oppose it. You are too many.\n\n\nI've understood that (one of) your concern(s) is efficiency issues. But is it the only one? Don't you think that inconsistency also is a problem?",
    "created_at": "2015-05-26T15:25:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240371",
    "user": "https://github.com/bgrenet"
}
```

> The arguments that I see on this thread are not about whether "cardinality" should return python ints or Sage integers. 
> 
> While the ticket is indeed about `.cardinality` only, you will see that the arguments given here can be applied to any other Sage function that returns integers.


That is not totally exact, since as Vincent mentioned it, you can replace `S.cardinality()` by `len(S)` if you want an `int`, and for efficiency concerns, `len(S.set())` is the fastest way to get it. Not all functions have this python counterpart.

As a user, I very much cares about the consistency in the return types. And I find this *very* annoying:

```python
sage: S = Set(range(2^20))
sage: T = CartesianProduct(S,S)
sage: T.cardinality().factor()
2^40
sage: S.cardinality().factor()
Traceback (most recent call last):
...
AttributeError: 'int' object has no attribute 'factor'
```

Note that I still agree that the same argument may be used at some other places. For instance, let me consider univariate polynomials in sparse representation. I find the following very weird, and would be in favor of changing this behavior:

```python
sage: R.<x> = PolynomialRing(ZZ, sparse=True)
sage: p = x^(2^100)+1
sage: map(lambda t: type(t), p.exponents())
[<type 'int'>, <type 'sage.rings.integer.Integer'>]
```

> I do not like what is going on here, but I will not oppose it. You are too many.


I've understood that (one of) your concern(s) is efficiency issues. But is it the only one? Don't you think that inconsistency also is a problem?



---

archive/issue_comments_240372.json:
```json
{
    "body": "Please, do whatever you want. I voiced my opinion one thousand times already.\n\nNathann",
    "created_at": "2015-05-26T15:28:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240372",
    "user": "https://github.com/nathanncohen"
}
```

Please, do whatever you want. I voiced my opinion one thousand times already.

Nathann



---

archive/issue_comments_240373.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-27T12:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240373",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_240374.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-30T17:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_240375.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-30T19:09:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240375",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_240376.json:
```json
{
    "body": "There are conflicts in `src/sage/combinat/crystals/monomial_crystals.py`.",
    "created_at": "2015-07-01T12:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240376",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

There are conflicts in `src/sage/combinat/crystals/monomial_crystals.py`.



---

archive/issue_comments_240377.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-07-01T12:30:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240377",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_240378.json:
```json
{
    "body": "I will not keep it up to date because you like me working. As you can notice, I rebased it 5 weeks ago and nobody cared. Does your message mean that you will review it? There is no need to keep the branch up to date if there is no reviewer... `needs_review` means needs a reviewer. Not a patchbot log reader.\n\nVincent",
    "created_at": "2015-07-01T12:58:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240378",
    "user": "https://github.com/videlec"
}
```

I will not keep it up to date because you like me working. As you can notice, I rebased it 5 weeks ago and nobody cared. Does your message mean that you will review it? There is no need to keep the branch up to date if there is no reviewer... `needs_review` means needs a reviewer. Not a patchbot log reader.

Vincent



---

archive/issue_comments_240379.json:
```json
{
    "body": "I have some time to review it right now.\nI'm not making you work for fun... it's just that my dev time is very scarce these days.\nAnd I have no idea of how to fix the second conflict in the file.",
    "created_at": "2015-07-01T13:06:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240379",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I have some time to review it right now.
I'm not making you work for fun... it's just that my dev time is very scarce these days.
And I have no idea of how to fix the second conflict in the file.



---

archive/issue_comments_240380.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-07-01T13:15:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240380",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_240381.json:
```json
{
    "body": "Rebased on 6.8.beta6",
    "created_at": "2015-07-01T13:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240381",
    "user": "https://github.com/videlec"
}
```

Rebased on 6.8.beta6



---

archive/issue_comments_240382.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-07-01T13:16:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240382",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_240383.json:
```json
{
    "body": "Is there any reason why the DeBruijn squence stuff is included here?",
    "created_at": "2015-07-01T13:35:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240383",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Is there any reason why the DeBruijn squence stuff is included here?



---

archive/issue_comments_240384.json:
```json
{
    "body": "Replying to [comment:41 jpflori]:\n> Is there any reason why the DeBruijn squence stuff is included here?\n\n\nNot really. You can ignore `0aad2f9` and I will remove it.",
    "created_at": "2015-07-01T13:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240384",
    "user": "https://github.com/videlec"
}
```

Replying to [comment:41 jpflori]:
> Is there any reason why the DeBruijn squence stuff is included here?


Not really. You can ignore `0aad2f9` and I will remove it.



---

archive/issue_comments_240385.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-07-01T13:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240385",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_240386.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-07-01T13:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240386",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_240387.json:
```json
{
    "body": "Thanks for removing the unrelated commit.\nLGTM.",
    "created_at": "2015-07-01T13:56:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240387",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Thanks for removing the unrelated commit.
LGTM.



---

archive/issue_comments_240388.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-07-02T20:09:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18159#issuecomment-240388",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_051396.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-07-02T20:09:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18159",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18159#event-51396"
}
```
