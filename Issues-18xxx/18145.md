# Issue 18145: Cythonize optional extensions

archive/issues_017908.json:
```json
{
    "body": "For Cython code dependending on *optional* packages, we can still run `cython` on that `.pyx` file. The advantage is that breakage due to Cython changes will be detected earlier.\n\nOne more advantage of this branch is that optional extensions are listed in between the normal extensions, which is much cleaner.\n\nBranch/Commit: e56aeb2c9a190813096a0f7db1683d3d5bc774d1\n\nReviewer: Fran\u00e7ois Bissey\n\nAuthor: Jeroen Demeyer\n\nDependencies: #17860, #18095\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18145\n\n",
    "closed_at": "2015-04-14T19:44:26Z",
    "created_at": "2015-04-08T13:33:17Z",
    "labels": [
        "component: build"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "Cythonize optional extensions",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18145",
    "user": "https://github.com/jdemeyer"
}
```
For Cython code dependending on *optional* packages, we can still run `cython` on that `.pyx` file. The advantage is that breakage due to Cython changes will be detected earlier.

One more advantage of this branch is that optional extensions are listed in between the normal extensions, which is much cleaner.

Branch/Commit: e56aeb2c9a190813096a0f7db1683d3d5bc774d1

Reviewer: François Bissey

Author: Jeroen Demeyer

Dependencies: #17860, #18095

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18145





---

archive/issue_comments_309566.json:
```json
{
    "body": "Changing branch from \"\" to \"u/jdemeyer/ticket/18145\"",
    "created_at": "2015-04-08T13:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309566",
    "user": "https://github.com/jdemeyer"
}
```

Changing branch from "" to "u/jdemeyer/ticket/18145"



---

archive/issue_comments_309567.json:
```json
{
    "body": "Changing commit from \"\" to \"4105d78f8f5a03fbba8cf12b372e048dde3aa022\"",
    "created_at": "2015-04-08T14:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309567",
    "user": "https://github.com/jdemeyer"
}
```

Changing commit from "" to "4105d78f8f5a03fbba8cf12b372e048dde3aa022"



---

archive/issue_comments_309568.json:
```json
{
    "body": "<a id='comment:2'></a>\nNew commits:\n|                                                                                                                                          |                               |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|\n|[4105d78](https://github.com/sagemath/sagetrac-mirror/commit/4105d78f8f5a03fbba8cf12b372e048dde3aa022)|`Cythonize optional extensions`|",
    "created_at": "2015-04-08T14:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309568",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:2'></a>
New commits:
|                                                                                                                                          |                               |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------|
|[4105d78](https://github.com/sagemath/sagetrac-mirror/commit/4105d78f8f5a03fbba8cf12b372e048dde3aa022)|`Cythonize optional extensions`|



---

archive/issue_comments_309569.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-08T14:03:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309569",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_309570.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-04-08T16:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309570",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_309571.json:
```json
{
    "body": "Changing work_issues from \"\" to \"conflicts with #18095\"",
    "created_at": "2015-04-08T16:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309571",
    "user": "https://github.com/mezzarobba"
}
```

Changing work_issues from "" to "conflicts with #18095"



---

archive/issue_comments_309572.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#17860, #18095\"",
    "created_at": "2015-04-08T16:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309572",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#17860, #18095"



---

archive/issue_comments_309573.json:
```json
{
    "body": "Changing commit from \"4105d78f8f5a03fbba8cf12b372e048dde3aa022\" to \"e56aeb2c9a190813096a0f7db1683d3d5bc774d1\"",
    "created_at": "2015-04-08T16:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309573",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "4105d78f8f5a03fbba8cf12b372e048dde3aa022" to "e56aeb2c9a190813096a0f7db1683d3d5bc774d1"



---

archive/issue_comments_309574.json:
```json
{
    "body": "<a id='comment:5'></a>\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n|                                                                                                                                          |                                                                   |\n|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|\n|[c98e78d](https://github.com/sagemath/sagetrac-mirror/commit/c98e78dfcd1afe82b2ced15252b1f659b3590454)|`Merge commit '7d1b5f8ca56180ca2d7044453707c619ef17b51a' into HEAD`|\n|[c683c19](https://github.com/sagemath/sagetrac-mirror/commit/c683c1946e0bb790996664b06b989a88ae50ce18)|`Add PARI documentation`|\n|[4b07161](https://github.com/sagemath/sagetrac-mirror/commit/4b071619a00e667d3452a73229de43f231dfe662)|`Better format links`|\n|[9f710a2](https://github.com/sagemath/sagetrac-mirror/commit/9f710a200984ac1a1a218cc1c1c63e9bc37c9fbe)|`Merge commit '4b071619a00e667d3452a73229de43f231dfe662' into HEAD`|\n|[41755fe](https://github.com/sagemath/sagetrac-mirror/commit/41755fe8772858c5d94cc851efdb24ec9adfb6f4)|`Re-organize building of Sage library and auto-generated files`|\n|[3510d45](https://github.com/sagemath/sagetrac-mirror/commit/3510d4595fc6f35d801d69336e51d15f8bbe4ef4)|`Minor review fixes`|\n|[e56aeb2](https://github.com/sagemath/sagetrac-mirror/commit/e56aeb2c9a190813096a0f7db1683d3d5bc774d1)|`Cythonize optional extensions`|",
    "created_at": "2015-04-08T16:48:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309574",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:5'></a>
Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
|                                                                                                                                          |                                                                   |
|------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------|
|[c98e78d](https://github.com/sagemath/sagetrac-mirror/commit/c98e78dfcd1afe82b2ced15252b1f659b3590454)|`Merge commit '7d1b5f8ca56180ca2d7044453707c619ef17b51a' into HEAD`|
|[c683c19](https://github.com/sagemath/sagetrac-mirror/commit/c683c1946e0bb790996664b06b989a88ae50ce18)|`Add PARI documentation`|
|[4b07161](https://github.com/sagemath/sagetrac-mirror/commit/4b071619a00e667d3452a73229de43f231dfe662)|`Better format links`|
|[9f710a2](https://github.com/sagemath/sagetrac-mirror/commit/9f710a200984ac1a1a218cc1c1c63e9bc37c9fbe)|`Merge commit '4b071619a00e667d3452a73229de43f231dfe662' into HEAD`|
|[41755fe](https://github.com/sagemath/sagetrac-mirror/commit/41755fe8772858c5d94cc851efdb24ec9adfb6f4)|`Re-organize building of Sage library and auto-generated files`|
|[3510d45](https://github.com/sagemath/sagetrac-mirror/commit/3510d4595fc6f35d801d69336e51d15f8bbe4ef4)|`Minor review fixes`|
|[e56aeb2](https://github.com/sagemath/sagetrac-mirror/commit/e56aeb2c9a190813096a0f7db1683d3d5bc774d1)|`Cythonize optional extensions`|



---

archive/issue_comments_309575.json:
```json
{
    "body": "Changing work_issues from \"conflicts with #18095\" to \"\"",
    "created_at": "2015-04-08T16:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309575",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "conflicts with #18095" to ""



---

archive/issue_comments_309576.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-04-08T16:48:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309576",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_309577.json:
```json
{
    "body": "<a id='comment:7'></a>\nOK so if (in the general case) the spkg is installed `OptionalExtension` returns `Extension` but what does `CythonizeExtension` which is the alternative result does?",
    "created_at": "2015-04-08T20:12:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309577",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'></a>
OK so if (in the general case) the spkg is installed `OptionalExtension` returns `Extension` but what does `CythonizeExtension` which is the alternative result does?



---

archive/issue_comments_309578.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [fbissey](#comment%3A7):\n> OK so if (in the general case) the spkg is installed `OptionalExtension` returns `Extension` but what does `CythonizeExtension` which is the alternative result does?\n\nI cannot really parse your question, but I'll try to answer it anyway: `CythonizeExtension` is exactly like `Extension` except for the `skip_build` attribute. There is some code added to `src/setup.py` which checks this attribute. If `skip_build`, then the build (i.e. the `foo.c` -> `foo.so` part) of the extension is skipped.",
    "created_at": "2015-04-08T20:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309578",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>
Replying to [fbissey](#comment%3A7):
> OK so if (in the general case) the spkg is installed `OptionalExtension` returns `Extension` but what does `CythonizeExtension` which is the alternative result does?

I cannot really parse your question, but I'll try to answer it anyway: `CythonizeExtension` is exactly like `Extension` except for the `skip_build` attribute. There is some code added to `src/setup.py` which checks this attribute. If `skip_build`, then the build (i.e. the `foo.c` -> `foo.so` part) of the extension is skipped.



---

archive/issue_comments_309579.json:
```json
{
    "body": "<a id='comment:9'></a>\nThanks. You are doing an extremely good job of answering questions you cannot parse :) It otherwise looks good to me and should go in. I must say I thought something needed to be done with the optional stuff and now it is!",
    "created_at": "2015-04-08T21:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309579",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'></a>
Thanks. You are doing an extremely good job of answering questions you cannot parse :) It otherwise looks good to me and should go in. I must say I thought something needed to be done with the optional stuff and now it is!



---

archive/issue_comments_309580.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-08T21:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309580",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_309581.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Fran\u00e7ois Bissey\"",
    "created_at": "2015-04-08T21:31:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309581",
    "user": "https://github.com/kiwifb"
}
```

Changing reviewer from "" to "François Bissey"



---

archive/issue_comments_309582.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-14T19:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309582",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_309583.json:
```json
{
    "body": "Changing branch from \"u/jdemeyer/ticket/18145\" to \"e56aeb2c9a190813096a0f7db1683d3d5bc774d1\"",
    "created_at": "2015-04-14T19:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18145#issuecomment-309583",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/jdemeyer/ticket/18145" to "e56aeb2c9a190813096a0f7db1683d3d5bc774d1"



---

archive/issue_events_066200.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-14T19:44:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18145",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18145#event-66200"
}
```
