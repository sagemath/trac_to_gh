# Issue 18067: sage/graphs/graph.py: multigraph recognition in init fails

archive/issues_017830.json:
```json
{
    "body": "Sage is slightly inconsistent when it comes to detect multiple edges in\n`Graph(list_of_edges)`:\n\n```\nsage: Graph([[1,2],[1,2]])\nMulti-graph on 2 vertices\nsage: Graph([[1,2],[2,1]])\nGraph on 2 vertices\n```\n\nThis branch fixes that bug while removing code from `Graph.__init__` and\n`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:\n\n- Make Sage build a (di)graph from a list of edges with the following procedure:\n    - Create an empty graph allowing loops and multiple edges\n    - Call `self.add_edges(list_of_edges)`\n    - Check whether multiedges/loops have been created, and display the\n      pre-existing warnings accordingly.\n    - Update the `allow_loops` and `allow_multiple_edges` parameters\n      accordingly.\n\n- When Sage does not know how to create a graph from the provided data, it\n  currently gives it to NetworkX hoping that it will work, then convert the\n  result into a Sage graph. With this branch, we now raise an exception instead.\n\n- As a consequence it is not possible to create a graph from a Numpy matrix\n  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so\n  it is not that bad either (in particular, copying the matrix is not more\n  expensive than creating a NetworkX graph)\n\n  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'\n  NetworkX standards:\n\n```\nsage: import numpy\nsage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])\nsage: Graph(A).edges()\n[(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),\n(0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),\n(1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]\n```\n\n- Several corner-cases of Graph creation are now handled differently as a\n  result. I merely removed the doctests, thinking that they were not actually\n  testing a property that we want to keep, e.g.:\n\n  Before:\n\n```\nsage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n...\nValueError: Two different labels given for the same edge in a graph without multiple edges.\n```\n\n  After:\n\n```\nsage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\nsage: g.edges()\n[(1, 2, 4)]\n```\n\n  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`\n  already does, as in the latest release we have:\n\n```\nsage: g = Graph()\nsage: g.add_edges([(1,2,3),(1,2,4)])\nsage: g.edges()\n[(1, 2, 4)]\n```\n\n- Fix a bug in `GenericGraph.has_multiple_edges`:\n\n```\nsage: g = Graph(loops=True,multiedges=True)\nsage: g.add_edge(0,0)\nsage: g.has_multiple_edges()\nTrue\n```\n\nWhat this branch does will also help us reduce further the complexity of those\n(awful) `__init__` functions.\n\nNathann\n\nCC:  @nathanncohen sage-combinat tmonteil @videlec @dcoudert\n\nKeywords: graphs, sage-combinat,\n\nBranch/Commit: 197bc184f518fd6a773b2a28aea72507c3908ac2\n\nReviewer: David Coudert\n\nAuthor: Nathann Cohen\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18067\n\n",
    "closed_at": "2015-04-14T19:43:31Z",
    "created_at": "2015-03-27T06:48:24Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.6",
    "title": "sage/graphs/graph.py: multigraph recognition in init fails",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18067",
    "user": "https://github.com/darijgr"
}
```
Sage is slightly inconsistent when it comes to detect multiple edges in
`Graph(list_of_edges)`:

```
sage: Graph([[1,2],[1,2]])
Multi-graph on 2 vertices
sage: Graph([[1,2],[2,1]])
Graph on 2 vertices
```

This branch fixes that bug while removing code from `Graph.__init__` and
`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:

- Make Sage build a (di)graph from a list of edges with the following procedure:
    - Create an empty graph allowing loops and multiple edges
    - Call `self.add_edges(list_of_edges)`
    - Check whether multiedges/loops have been created, and display the
      pre-existing warnings accordingly.
    - Update the `allow_loops` and `allow_multiple_edges` parameters
      accordingly.

- When Sage does not know how to create a graph from the provided data, it
  currently gives it to NetworkX hoping that it will work, then convert the
  result into a Sage graph. With this branch, we now raise an exception instead.

- As a consequence it is not possible to create a graph from a Numpy matrix
  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so
  it is not that bad either (in particular, copying the matrix is not more
  expensive than creating a NetworkX graph)

  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'
  NetworkX standards:

```
sage: import numpy
sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])
sage: Graph(A).edges()
[(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),
(0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),
(1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]
```

- Several corner-cases of Graph creation are now handled differently as a
  result. I merely removed the doctests, thinking that they were not actually
  testing a property that we want to keep, e.g.:

  Before:

```
sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
...
ValueError: Two different labels given for the same edge in a graph without multiple edges.
```

  After:

```
sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
sage: g.edges()
[(1, 2, 4)]
```

  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`
  already does, as in the latest release we have:

```
sage: g = Graph()
sage: g.add_edges([(1,2,3),(1,2,4)])
sage: g.edges()
[(1, 2, 4)]
```

- Fix a bug in `GenericGraph.has_multiple_edges`:

```
sage: g = Graph(loops=True,multiedges=True)
sage: g.add_edge(0,0)
sage: g.has_multiple_edges()
True
```

What this branch does will also help us reduce further the complexity of those
(awful) `__init__` functions.

Nathann

CC:  @nathanncohen sage-combinat tmonteil @videlec @dcoudert

Keywords: graphs, sage-combinat,

Branch/Commit: 197bc184f518fd6a773b2a28aea72507c3908ac2

Reviewer: David Coudert

Author: Nathann Cohen

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18067





---

archive/issue_comments_254352.json:
```json
{
    "body": "<a id='comment:1'></a>Hello !\n\nI was actually thinking of this very behaviour last week, as many things in the (di)Graph constructors should be rewritten. A lot of time is also wasted because we have to detect what the user 'intends' to build, and at some point I thought that this could be solved by asking the user to tell us explicitly whether (s)he wants a simple graph or a multigraph, using the `multiedges=True` flag. Nowadays, I am not so sure anymore.\n\nIn this specific case, I also believe that, as you advise, we should return a multigraph. But to understand better what it works this way, see how it works for dictionary input (note that 'list of edges' input is converted into dictionary input):\n\n```\nsage: Graph({1:[2],2:[1]}).edges()\n[(1, 2, None)]\n```\n\nWhat do you think the user wants in this case ? Is (s)he giving us a multigraph, or merely giving the adjacencies between the vertices in both directions?\n\nRight now, giving the adjacencies in both direction or giving them only once yields the same result\n\n```\nsage: Graph({1:[2],2:[1]}) == Graph({1:[2]})\nTrue\n```\n\nAnd of course, saying twice that 2 is a neighbor of 1 yields a multigraph\n\n```\nsage: Graph({1:[2,2]})\nMulti-graph on 2 vertices\n```\n\nI will fix this bug soon, by making `Graph(list_of_edges)` call `add_edge` immediately. The code will also be shorter. But the graph constructors will have to be rewritten, and standards will change. We cannot guess the user's intent without guessing wrong at times, and we want to avoid that.\n\nNathann",
    "created_at": "2015-03-27T09:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254352",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>Hello !

I was actually thinking of this very behaviour last week, as many things in the (di)Graph constructors should be rewritten. A lot of time is also wasted because we have to detect what the user 'intends' to build, and at some point I thought that this could be solved by asking the user to tell us explicitly whether (s)he wants a simple graph or a multigraph, using the `multiedges=True` flag. Nowadays, I am not so sure anymore.

In this specific case, I also believe that, as you advise, we should return a multigraph. But to understand better what it works this way, see how it works for dictionary input (note that 'list of edges' input is converted into dictionary input):

```
sage: Graph({1:[2],2:[1]}).edges()
[(1, 2, None)]
```

What do you think the user wants in this case ? Is (s)he giving us a multigraph, or merely giving the adjacencies between the vertices in both directions?

Right now, giving the adjacencies in both direction or giving them only once yields the same result

```
sage: Graph({1:[2],2:[1]}) == Graph({1:[2]})
True
```

And of course, saying twice that 2 is a neighbor of 1 yields a multigraph

```
sage: Graph({1:[2,2]})
Multi-graph on 2 vertices
```

I will fix this bug soon, by making `Graph(list_of_edges)` call `add_edge` immediately. The code will also be shorter. But the graph constructors will have to be rewritten, and standards will change. We cannot guess the user's intent without guessing wrong at times, and we want to avoid that.

Nathann



---

archive/issue_comments_254353.json:
```json
{
    "body": "<a id='comment:2'></a>Sorry, Nathann; I have no idea how to fix this mess short of replacing the catch-all `__init__` by a bunch of separate constructors each of which does one thing well and has a predictable return type. Guessing the user's intent shouldn't happen unless the user asks for it.",
    "created_at": "2015-03-27T19:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254353",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:2'></a>Sorry, Nathann; I have no idea how to fix this mess short of replacing the catch-all `__init__` by a bunch of separate constructors each of which does one thing well and has a predictable return type. Guessing the user's intent shouldn't happen unless the user asks for it.



---

archive/issue_comments_254354.json:
```json
{
    "body": "<a id='comment:3'></a>> Sorry, Nathann; I have no idea how to fix this mess short of replacing the catch-all `__init__` by a bunch of separate constructors each of which does one thing well and has a predictable return type.\n\n\nDon't worry, I will write some code for that very soon. I am about to leave to Liege (Belgium) for some Sage days so I will not be able to do it this week-end most probably (I'll be backpacking) but it will definitely be done during the week.\n\nI would also like to turn this huge `__init__` into independent functions, but that is not totally straightforward either. I do want to make it shorter, though.\n\n> Guessing the user's intent shouldn't happen unless the user asks for it.\n\n\nI agree with you. But I already wrote something to make those argument mandatory, and noticed that it broke doctests.. Because a complete graph stored as a multigraph is not (for Sage) equal to a complete graph (stored as a simple graph) and other problems like that.\n\nWell. 1) I will fix this in the next days and 2) I am aware that this code has to be changed, and I will do something about it. Especially since David Coudert would like to be able to load huge graphs in Sage, and that it is currently impossible.\n\nNathann",
    "created_at": "2015-03-27T21:48:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254354",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:3'></a>> Sorry, Nathann; I have no idea how to fix this mess short of replacing the catch-all `__init__` by a bunch of separate constructors each of which does one thing well and has a predictable return type.


Don't worry, I will write some code for that very soon. I am about to leave to Liege (Belgium) for some Sage days so I will not be able to do it this week-end most probably (I'll be backpacking) but it will definitely be done during the week.

I would also like to turn this huge `__init__` into independent functions, but that is not totally straightforward either. I do want to make it shorter, though.

> Guessing the user's intent shouldn't happen unless the user asks for it.


I agree with you. But I already wrote something to make those argument mandatory, and noticed that it broke doctests.. Because a complete graph stored as a multigraph is not (for Sage) equal to a complete graph (stored as a simple graph) and other problems like that.

Well. 1) I will fix this in the next days and 2) I am aware that this code has to be changed, and I will do something about it. Especially since David Coudert would like to be able to load huge graphs in Sage, and that it is currently impossible.

Nathann



---

archive/issue_comments_254355.json:
```json
{
    "body": "<a id='comment:4'></a>Thanks a lot!\n\nYes, efficiency is too a reason to get rid of this ducktyping orgy.",
    "created_at": "2015-03-27T21:58:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254355",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:4'></a>Thanks a lot!

Yes, efficiency is too a reason to get rid of this ducktyping orgy.



---

archive/issue_comments_254356.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,5 @@\n-The idea seems to be that the `__init__` method of `Graph` should check if the user provides some edges more than 1 time, and, if so, return a multigraph instead of a graph. In reality, whether this happens depends on the order of vertices the user provides:\n+Sage is slightly inconsistent when it comes to detect multiple edges in\n+`Graph(list_of_edges)`:\n \n ```\n sage: Graph([[1,2],[1,2]])\n@@ -7,7 +8,75 @@\n Graph on 2 vertices\n ```\n \n-Apparently, it is the `if len(set(data[u])) != len(data[u])` conditional on line 1497 of graph.py which fails to fire in the second example.\n+This branch fixes that bug while removing code from `Graph.__init__` and\n+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:\n+\n+- Make Sage build a (di)graph from a list of edges with the following procedure:\n+\n+    - Create an empty graph allowing loops and multiple edges\n+\n+    - Call `self.add_edges(list_of_edges)`\n+\n+    - Check whether multiedges/loops have been created, and display the\n+      pre-existing warnings accordingly.\n+\n+    - Update the `allow_loops` and `allow_multiple_edges` parameters\n+      accordingly.\n+\n+- When Sage does not know how to create a graph from the provided data, it\n+  currently gives it to NetworkX hoping that it will work, then convert the\n+  result into a Sage graph. With this branch, we now raise an exception instead.\n+\n+- As a consequence it is not possible to create a graph from a Numpy matrix\n+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so\n+  it is not that bad either (in particular, copying the matrix is not more\n+  expensive than creating a NetworkX graph)\n+\n+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'\n+  NetworkX standards:\n+\n+      sage: import numpy\n+      sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])\n+      sage: Graph(A).edges()\n+      [(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),\n+       (0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),\n+       (1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]\n+\n+- Several corner-cases of Graph creation are now handled differently as a\n+  result. I merely removed the doctests, thinking that they were not actually\n+  testing a property that we want to keep, e.g.:\n+\n+  Before:\n+\n+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+      ...\n+      ValueError: Two different labels given for the same edge in a graph without multiple edges.\n+\n+  After:\n+\n+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+      sage: g.edges()\n+      [(1, 2, 4)]\n+\n+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`\n+  already does, as in the latest release we have:\n+\n+      sage: g = Graph()\n+      sage: g.add_edges([(1,2,3),(1,2,4)])\n+      sage: g.edges()\n+      [(1, 2, 4)]\n+\n+- Fix a bug in `GenericGraph.has_multiple_edges`:\n+\n+      sage: g = Graph(loops=True,multiedges=True)\n+      sage: g.add_edge(0,0)\n+      sage: g.has_multiple_edges()\n+      True\n+\n+What this branch does will also help us reduce further the complexity of those\n+(awful) `__init__` functions.\n+\n+Nathann\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-01T09:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254356",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,5 @@
-The idea seems to be that the `__init__` method of `Graph` should check if the user provides some edges more than 1 time, and, if so, return a multigraph instead of a graph. In reality, whether this happens depends on the order of vertices the user provides:
+Sage is slightly inconsistent when it comes to detect multiple edges in
+`Graph(list_of_edges)`:
 
 ```
 sage: Graph([[1,2],[1,2]])
@@ -7,7 +8,75 @@
 Graph on 2 vertices
 ```
 
-Apparently, it is the `if len(set(data[u])) != len(data[u])` conditional on line 1497 of graph.py which fails to fire in the second example.
+This branch fixes that bug while removing code from `Graph.__init__` and
+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:
+
+- Make Sage build a (di)graph from a list of edges with the following procedure:
+
+    - Create an empty graph allowing loops and multiple edges
+
+    - Call `self.add_edges(list_of_edges)`
+
+    - Check whether multiedges/loops have been created, and display the
+      pre-existing warnings accordingly.
+
+    - Update the `allow_loops` and `allow_multiple_edges` parameters
+      accordingly.
+
+- When Sage does not know how to create a graph from the provided data, it
+  currently gives it to NetworkX hoping that it will work, then convert the
+  result into a Sage graph. With this branch, we now raise an exception instead.
+
+- As a consequence it is not possible to create a graph from a Numpy matrix
+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so
+  it is not that bad either (in particular, copying the matrix is not more
+  expensive than creating a NetworkX graph)
+
+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'
+  NetworkX standards:
+
+      sage: import numpy
+      sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])
+      sage: Graph(A).edges()
+      [(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),
+       (0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),
+       (1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]
+
+- Several corner-cases of Graph creation are now handled differently as a
+  result. I merely removed the doctests, thinking that they were not actually
+  testing a property that we want to keep, e.g.:
+
+  Before:
+
+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+      ...
+      ValueError: Two different labels given for the same edge in a graph without multiple edges.
+
+  After:
+
+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+      sage: g.edges()
+      [(1, 2, 4)]
+
+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`
+  already does, as in the latest release we have:
+
+      sage: g = Graph()
+      sage: g.add_edges([(1,2,3),(1,2,4)])
+      sage: g.edges()
+      [(1, 2, 4)]
+
+- Fix a bug in `GenericGraph.has_multiple_edges`:
+
+      sage: g = Graph(loops=True,multiedges=True)
+      sage: g.add_edge(0,0)
+      sage: g.has_multiple_edges()
+      True
+
+What this branch does will also help us reduce further the complexity of those
+(awful) `__init__` functions.
+
+Nathann
 
 Comment: 1
 
``````




---

archive/issue_comments_254357.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-01T09:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254357",
    "user": "https://github.com/nathanncohen"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_254358.json:
```json
{
    "body": "<a id='comment:5'></a>Just added a branch, and explained what in does in this ticket's description. Needs review `:-)`\n\nNathann",
    "created_at": "2015-04-01T09:19:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254358",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:5'></a>Just added a branch, and explained what in does in this ticket's description. Needs review `:-)`

Nathann



---

archive/issue_comments_254359.json:
```json
{
    "body": "<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-01T09:20:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254359",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:6'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_254360.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,92 @@\n+Sage is slightly inconsistent when it comes to detect multiple edges in\n+`Graph(list_of_edges)`:\n \n+```\n+sage: Graph([[1,2],[1,2]])\n+Multi-graph on 2 vertices\n+sage: Graph([[1,2],[2,1]])\n+Graph on 2 vertices\n+```\n+\n+This branch fixes that bug while removing code from `Graph.__init__` and\n+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:\n+\n+- Make Sage build a (di)graph from a list of edges with the following procedure:\n+\n+    - Create an empty graph allowing loops and multiple edges\n+\n+    - Call `self.add_edges(list_of_edges)`\n+\n+    - Check whether multiedges/loops have been created, and display the\n+      pre-existing warnings accordingly.\n+\n+    - Update the `allow_loops` and `allow_multiple_edges` parameters\n+      accordingly.\n+\n+- When Sage does not know how to create a graph from the provided data, it\n+  currently gives it to NetworkX hoping that it will work, then convert the\n+  result into a Sage graph. With this branch, we now raise an exception instead.\n+\n+- As a consequence it is not possible to create a graph from a Numpy matrix\n+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so\n+  it is not that bad either (in particular, copying the matrix is not more\n+  expensive than creating a NetworkX graph)\n+\n+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'\n+  NetworkX standards:\n+\n+```\n+      sage: import numpy\n+      sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])\n+      sage: Graph(A).edges()\n+      [(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),\n+       (0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),\n+       (1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]\n+```\n+\n+- Several corner-cases of Graph creation are now handled differently as a\n+  result. I merely removed the doctests, thinking that they were not actually\n+  testing a property that we want to keep, e.g.:\n+\n+  Before:\n+\n+```\n+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+      ...\n+      ValueError: Two different labels given for the same edge in a graph without multiple edges.\n+```\n+\n+  After:\n+\n+```\n+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+      sage: g.edges()\n+      [(1, 2, 4)]\n+```\n+\n+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`\n+  already does, as in the latest release we have:\n+\n+```\n+      sage: g = Graph()\n+      sage: g.add_edges([(1,2,3),(1,2,4)])\n+      sage: g.edges()\n+      [(1, 2, 4)]\n+```\n+\n+- Fix a bug in `GenericGraph.has_multiple_edges`:\n+\n+```\n+      sage: g = Graph(loops=True,multiedges=True)\n+      sage: g.add_edge(0,0)\n+      sage: g.has_multiple_edges()\n+      True\n+```\n+\n+What this branch does will also help us reduce further the complexity of those\n+(awful) `__init__` functions.\n+\n+Nathann\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-01T09:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254360",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,92 @@
+Sage is slightly inconsistent when it comes to detect multiple edges in
+`Graph(list_of_edges)`:
 
+```
+sage: Graph([[1,2],[1,2]])
+Multi-graph on 2 vertices
+sage: Graph([[1,2],[2,1]])
+Graph on 2 vertices
+```
+
+This branch fixes that bug while removing code from `Graph.__init__` and
+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:
+
+- Make Sage build a (di)graph from a list of edges with the following procedure:
+
+    - Create an empty graph allowing loops and multiple edges
+
+    - Call `self.add_edges(list_of_edges)`
+
+    - Check whether multiedges/loops have been created, and display the
+      pre-existing warnings accordingly.
+
+    - Update the `allow_loops` and `allow_multiple_edges` parameters
+      accordingly.
+
+- When Sage does not know how to create a graph from the provided data, it
+  currently gives it to NetworkX hoping that it will work, then convert the
+  result into a Sage graph. With this branch, we now raise an exception instead.
+
+- As a consequence it is not possible to create a graph from a Numpy matrix
+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so
+  it is not that bad either (in particular, copying the matrix is not more
+  expensive than creating a NetworkX graph)
+
+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'
+  NetworkX standards:
+
+```
+      sage: import numpy
+      sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])
+      sage: Graph(A).edges()
+      [(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),
+       (0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),
+       (1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]
+```
+
+- Several corner-cases of Graph creation are now handled differently as a
+  result. I merely removed the doctests, thinking that they were not actually
+  testing a property that we want to keep, e.g.:
+
+  Before:
+
+```
+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+      ...
+      ValueError: Two different labels given for the same edge in a graph without multiple edges.
+```
+
+  After:
+
+```
+      sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+      sage: g.edges()
+      [(1, 2, 4)]
+```
+
+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`
+  already does, as in the latest release we have:
+
+```
+      sage: g = Graph()
+      sage: g.add_edges([(1,2,3),(1,2,4)])
+      sage: g.edges()
+      [(1, 2, 4)]
+```
+
+- Fix a bug in `GenericGraph.has_multiple_edges`:
+
+```
+      sage: g = Graph(loops=True,multiedges=True)
+      sage: g.add_edge(0,0)
+      sage: g.has_multiple_edges()
+      True
+```
+
+What this branch does will also help us reduce further the complexity of those
+(awful) `__init__` functions.
+
+Nathann
 
 Comment: 1
 
``````




---

archive/issue_comments_254361.json:
```json
{
    "body": "<a id='comment:8'></a>more beautiful description!",
    "created_at": "2015-04-01T09:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254361",
    "user": "https://github.com/videlec"
}
```

<a id='comment:8'></a>more beautiful description!



---

archive/issue_comments_254362.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,92 @@\n+Sage is slightly inconsistent when it comes to detect multiple edges in\n+`Graph(list_of_edges)`:\n \n+```\n+sage: Graph([[1,2],[1,2]])\n+Multi-graph on 2 vertices\n+sage: Graph([[1,2],[2,1]])\n+Graph on 2 vertices\n+```\n+\n+This branch fixes that bug while removing code from `Graph.__init__` and\n+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:\n+\n+- Make Sage build a (di)graph from a list of edges with the following procedure:\n+\n+    - Create an empty graph allowing loops and multiple edges\n+\n+    - Call `self.add_edges(list_of_edges)`\n+\n+    - Check whether multiedges/loops have been created, and display the\n+      pre-existing warnings accordingly.\n+\n+    - Update the `allow_loops` and `allow_multiple_edges` parameters\n+      accordingly.\n+\n+- When Sage does not know how to create a graph from the provided data, it\n+  currently gives it to NetworkX hoping that it will work, then convert the\n+  result into a Sage graph. With this branch, we now raise an exception instead.\n+\n+- As a consequence it is not possible to create a graph from a Numpy matrix\n+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so\n+  it is not that bad either (in particular, copying the matrix is not more\n+  expensive than creating a NetworkX graph)\n+\n+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'\n+  NetworkX standards:\n+\n+```\n+sage: import numpy\n+sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])\n+sage: Graph(A).edges()\n+[(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),\n+(0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),\n+(1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]\n+```\n+\n+- Several corner-cases of Graph creation are now handled differently as a\n+  result. I merely removed the doctests, thinking that they were not actually\n+  testing a property that we want to keep, e.g.:\n+\n+  Before:\n+\n+```\n+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+...\n+ValueError: Two different labels given for the same edge in a graph without multiple edges.\n+```\n+\n+  After:\n+\n+```\n+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+sage: g.edges()\n+[(1, 2, 4)]\n+```\n+\n+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`\n+  already does, as in the latest release we have:\n+\n+```\n+sage: g = Graph()\n+sage: g.add_edges([(1,2,3),(1,2,4)])\n+sage: g.edges()\n+[(1, 2, 4)]\n+```\n+\n+- Fix a bug in `GenericGraph.has_multiple_edges`:\n+\n+```\n+sage: g = Graph(loops=True,multiedges=True)\n+sage: g.add_edge(0,0)\n+sage: g.has_multiple_edges()\n+True\n+```\n+\n+What this branch does will also help us reduce further the complexity of those\n+(awful) `__init__` functions.\n+\n+Nathann\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-01T09:29:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254362",
    "user": "https://github.com/videlec"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,92 @@
+Sage is slightly inconsistent when it comes to detect multiple edges in
+`Graph(list_of_edges)`:
 
+```
+sage: Graph([[1,2],[1,2]])
+Multi-graph on 2 vertices
+sage: Graph([[1,2],[2,1]])
+Graph on 2 vertices
+```
+
+This branch fixes that bug while removing code from `Graph.__init__` and
+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:
+
+- Make Sage build a (di)graph from a list of edges with the following procedure:
+
+    - Create an empty graph allowing loops and multiple edges
+
+    - Call `self.add_edges(list_of_edges)`
+
+    - Check whether multiedges/loops have been created, and display the
+      pre-existing warnings accordingly.
+
+    - Update the `allow_loops` and `allow_multiple_edges` parameters
+      accordingly.
+
+- When Sage does not know how to create a graph from the provided data, it
+  currently gives it to NetworkX hoping that it will work, then convert the
+  result into a Sage graph. With this branch, we now raise an exception instead.
+
+- As a consequence it is not possible to create a graph from a Numpy matrix
+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so
+  it is not that bad either (in particular, copying the matrix is not more
+  expensive than creating a NetworkX graph)
+
+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'
+  NetworkX standards:
+
+```
+sage: import numpy
+sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])
+sage: Graph(A).edges()
+[(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),
+(0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),
+(1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]
+```
+
+- Several corner-cases of Graph creation are now handled differently as a
+  result. I merely removed the doctests, thinking that they were not actually
+  testing a property that we want to keep, e.g.:
+
+  Before:
+
+```
+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+...
+ValueError: Two different labels given for the same edge in a graph without multiple edges.
+```
+
+  After:
+
+```
+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+sage: g.edges()
+[(1, 2, 4)]
+```
+
+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`
+  already does, as in the latest release we have:
+
+```
+sage: g = Graph()
+sage: g.add_edges([(1,2,3),(1,2,4)])
+sage: g.edges()
+[(1, 2, 4)]
+```
+
+- Fix a bug in `GenericGraph.has_multiple_edges`:
+
+```
+sage: g = Graph(loops=True,multiedges=True)
+sage: g.add_edge(0,0)
+sage: g.has_multiple_edges()
+True
+```
+
+What this branch does will also help us reduce further the complexity of those
+(awful) `__init__` functions.
+
+Nathann
 
 Comment: 1
 
``````




---

archive/issue_comments_254363.json:
```json
{
    "body": "<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-04-01T14:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254363",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:9'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_254364.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,88 @@\n+Sage is slightly inconsistent when it comes to detect multiple edges in\n+`Graph(list_of_edges)`:\n \n+```\n+sage: Graph([[1,2],[1,2]])\n+Multi-graph on 2 vertices\n+sage: Graph([[1,2],[2,1]])\n+Graph on 2 vertices\n+```\n+\n+This branch fixes that bug while removing code from `Graph.__init__` and\n+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:\n+\n+- Make Sage build a (di)graph from a list of edges with the following procedure:\n+    - Create an empty graph allowing loops and multiple edges\n+    - Call `self.add_edges(list_of_edges)`\n+    - Check whether multiedges/loops have been created, and display the\n+      pre-existing warnings accordingly.\n+    - Update the `allow_loops` and `allow_multiple_edges` parameters\n+      accordingly.\n+\n+- When Sage does not know how to create a graph from the provided data, it\n+  currently gives it to NetworkX hoping that it will work, then convert the\n+  result into a Sage graph. With this branch, we now raise an exception instead.\n+\n+- As a consequence it is not possible to create a graph from a Numpy matrix\n+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so\n+  it is not that bad either (in particular, copying the matrix is not more\n+  expensive than creating a NetworkX graph)\n+\n+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'\n+  NetworkX standards:\n+\n+```\n+sage: import numpy\n+sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])\n+sage: Graph(A).edges()\n+[(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),\n+(0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),\n+(1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]\n+```\n+\n+- Several corner-cases of Graph creation are now handled differently as a\n+  result. I merely removed the doctests, thinking that they were not actually\n+  testing a property that we want to keep, e.g.:\n+\n+  Before:\n+\n+```\n+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+...\n+ValueError: Two different labels given for the same edge in a graph without multiple edges.\n+```\n+\n+  After:\n+\n+```\n+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)\n+sage: g.edges()\n+[(1, 2, 4)]\n+```\n+\n+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`\n+  already does, as in the latest release we have:\n+\n+```\n+sage: g = Graph()\n+sage: g.add_edges([(1,2,3),(1,2,4)])\n+sage: g.edges()\n+[(1, 2, 4)]\n+```\n+\n+- Fix a bug in `GenericGraph.has_multiple_edges`:\n+\n+```\n+sage: g = Graph(loops=True,multiedges=True)\n+sage: g.add_edge(0,0)\n+sage: g.has_multiple_edges()\n+True\n+```\n+\n+What this branch does will also help us reduce further the complexity of those\n+(awful) `__init__` functions.\n+\n+Nathann\n \n Comment: 1\n \n``````\n",
    "created_at": "2015-04-01T14:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254364",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,88 @@
+Sage is slightly inconsistent when it comes to detect multiple edges in
+`Graph(list_of_edges)`:
 
+```
+sage: Graph([[1,2],[1,2]])
+Multi-graph on 2 vertices
+sage: Graph([[1,2],[2,1]])
+Graph on 2 vertices
+```
+
+This branch fixes that bug while removing code from `Graph.__init__` and
+`DiGraph.__init__`, which now relies `GenericGraph.add_edges`. More precisely:
+
+- Make Sage build a (di)graph from a list of edges with the following procedure:
+    - Create an empty graph allowing loops and multiple edges
+    - Call `self.add_edges(list_of_edges)`
+    - Check whether multiedges/loops have been created, and display the
+      pre-existing warnings accordingly.
+    - Update the `allow_loops` and `allow_multiple_edges` parameters
+      accordingly.
+
+- When Sage does not know how to create a graph from the provided data, it
+  currently gives it to NetworkX hoping that it will work, then convert the
+  result into a Sage graph. With this branch, we now raise an exception instead.
+
+- As a consequence it is not possible to create a graph from a Numpy matrix
+  anymore, though that can be done easily through `Graph(Matrix(my_matrix))` so
+  it is not that bad either (in particular, copying the matrix is not more
+  expensive than creating a NetworkX graph)
+
+  Furthermore, the graphs created from a Numpy matrix inherited the 'weird'
+  NetworkX standards:
+
+```
+sage: import numpy
+sage: A = numpy.array([[0,1,1],[1,0,1],[1,1,0]])
+sage: Graph(A).edges()
+[(0, 1, {0: {'weight': 1}, 1: {'weight': 1}}),
+(0, 2, {0: {'weight': 1}, 1: {'weight': 1}}),
+(1, 2, {0: {'weight': 1}, 1: {'weight': 1}})]
+```
+
+- Several corner-cases of Graph creation are now handled differently as a
+  result. I merely removed the doctests, thinking that they were not actually
+  testing a property that we want to keep, e.g.:
+
+  Before:
+
+```
+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+...
+ValueError: Two different labels given for the same edge in a graph without multiple edges.
+```
+
+  After:
+
+```
+sage: g = Graph([(1,2,3),(1,2,4)], multiedges = False)
+sage: g.edges()
+[(1, 2, 4)]
+```
+
+  Note that it actually makes `Graph(list_of_edges)` behave as `add_edges`
+  already does, as in the latest release we have:
+
+```
+sage: g = Graph()
+sage: g.add_edges([(1,2,3),(1,2,4)])
+sage: g.edges()
+[(1, 2, 4)]
+```
+
+- Fix a bug in `GenericGraph.has_multiple_edges`:
+
+```
+sage: g = Graph(loops=True,multiedges=True)
+sage: g.add_edge(0,0)
+sage: g.has_multiple_edges()
+True
+```
+
+What this branch does will also help us reduce further the complexity of those
+(awful) `__init__` functions.
+
+Nathann
 
 Comment: 1
 
``````




---

archive/issue_comments_254365.json:
```json
{
    "body": "<a id='comment:10'></a>New commits:",
    "created_at": "2015-04-01T14:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254365",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:10'></a>New commits:



---

archive/issue_comments_254366.json:
```json
{
    "body": "<a id='comment:11'></a>I have nowhere near the expertise required to review this, but you have my thanks. This is a courageous and overdue step towards cleaning up the Augean stables of Sage's constructors.\n\nMeanwhile, this:\n\n```\n        if format is None and is_Matrix(data):\n            if data.is_square() and data == data.transpose():\n                format = 'adjacency_matrix'\n            else:\n                format = 'incidence_matrix'\n                msg += \"Non-symmetric or non-square matrix assumed to be an incidence matrix: \"\n```\nis so ugly it is almost ridiculous. Good job improving the if-condition, but IMHO the whole logic should go to hell. To drive the point home, maybe add a doctest with the matrix\n\n```\n0 0 0 0 1 1\n0 0 0 1 0 1\n0 0 0 1 1 0\n0 1 1 0 0 0\n1 0 1 0 0 0\n1 1 0 0 0 0\n```\nas either incidence or adjacency matrix.",
    "created_at": "2015-04-02T01:09:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254366",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:11'></a>I have nowhere near the expertise required to review this, but you have my thanks. This is a courageous and overdue step towards cleaning up the Augean stables of Sage's constructors.

Meanwhile, this:

```
        if format is None and is_Matrix(data):
            if data.is_square() and data == data.transpose():
                format = 'adjacency_matrix'
            else:
                format = 'incidence_matrix'
                msg += "Non-symmetric or non-square matrix assumed to be an incidence matrix: "
```
is so ugly it is almost ridiculous. Good job improving the if-condition, but IMHO the whole logic should go to hell. To drive the point home, maybe add a doctest with the matrix

```
0 0 0 0 1 1
0 0 0 1 0 1
0 0 0 1 1 0
0 1 1 0 0 0
1 0 1 0 0 0
1 1 0 0 0 0
```
as either incidence or adjacency matrix.



---

archive/issue_comments_254367.json:
```json
{
    "body": "<a id='comment:12'></a>Hello,\n\n> I have nowhere near the expertise required to review this, but you have my thanks. This is a courageous and overdue step towards cleaning up the Augean stables of Sage's constructors.\n\n\nWell, this code really needs to be rewritten properly.\n\n> is so ugly it is almost ridiculous.\n\n+1\n\n> Good job improving the if-condition, but IMHO the whole logic should go to hell.\n\n\nAhahaha. Well, I also agree with you on that point, but I cannot get code in Sage by myself. I know that I only fixed a small part of the problem in this ticket, but doing too many things at once makes it impossible to find a reviewer. Soooooo while I already know what the next ticket will be about, I thought that it was better to write a smaller patch first. Then the other will come.\n\n> To drive the point home, maybe add a doctest with the matrix\n\n\nI do not believe in adding doctests to explain that our code is bad. Let us change the code.\n\nNathann",
    "created_at": "2015-04-02T11:17:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254367",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:12'></a>Hello,

> I have nowhere near the expertise required to review this, but you have my thanks. This is a courageous and overdue step towards cleaning up the Augean stables of Sage's constructors.


Well, this code really needs to be rewritten properly.

> is so ugly it is almost ridiculous.

+1

> Good job improving the if-condition, but IMHO the whole logic should go to hell.


Ahahaha. Well, I also agree with you on that point, but I cannot get code in Sage by myself. I know that I only fixed a small part of the problem in this ticket, but doing too many things at once makes it impossible to find a reviewer. Soooooo while I already know what the next ticket will be about, I thought that it was better to write a smaller patch first. Then the other will come.

> To drive the point home, maybe add a doctest with the matrix


I do not believe in adding doctests to explain that our code is bad. Let us change the code.

Nathann



---

archive/issue_comments_254368.json:
```json
{
    "body": "<a id='comment:13'></a>That's fine -- it doesn't need to be fixed in this one ticket.\n\nFor reference, what is the rationale behind replacing `_weighted` by `weighted()`?",
    "created_at": "2015-04-02T18:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254368",
    "user": "https://github.com/darijgr"
}
```

<a id='comment:13'></a>That's fine -- it doesn't need to be fixed in this one ticket.

For reference, what is the rationale behind replacing `_weighted` by `weighted()`?



---

archive/issue_comments_254369.json:
```json
{
    "body": "<a id='comment:14'></a>> For reference, what is the rationale behind replacing `_weighted` by `weighted()`?\n\n\nNothing smart. Only the trace of some debugging I did, before I noticed that I did not set `_weighted` to something different from None in an early version of the branch.\n\nNathann",
    "created_at": "2015-04-02T21:48:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254369",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:14'></a>> For reference, what is the rationale behind replacing `_weighted` by `weighted()`?


Nothing smart. Only the trace of some debugging I did, before I noticed that I did not set `_weighted` to something different from None in an early version of the branch.

Nathann



---

archive/issue_comments_254370.json:
```json
{
    "body": "<a id='comment:15'></a>Hellos guys! It would help if somebody could reviw this ticket, for I have more changes to make in the constructors (speed and clarity).\n\nNathann",
    "created_at": "2015-04-09T06:56:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254370",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:15'></a>Hellos guys! It would help if somebody could reviw this ticket, for I have more changes to make in the constructors (speed and clarity).

Nathann



---

archive/issue_comments_254371.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-10T03:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254371",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_254372.json:
```json
{
    "body": "<a id='comment:16'></a>For me the patch is OK. All tests pass (sage/graphs/ and sage/graphs/*/) and the doc builds normally.\nDavid.",
    "created_at": "2015-04-10T03:52:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254372",
    "user": "https://github.com/dcoudert"
}
```

<a id='comment:16'></a>For me the patch is OK. All tests pass (sage/graphs/ and sage/graphs/*/) and the doc builds normally.
David.



---

archive/issue_comments_254373.json:
```json
{
    "body": "<a id='comment:17'></a>THaaaaaaaaaaaaaanks !!!!\n\nNathann",
    "created_at": "2015-04-10T06:23:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254373",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:17'></a>THaaaaaaaaaaaaaanks !!!!

Nathann



---

archive/issue_comments_254374.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2015-04-11T22:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254374",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_254375.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2015-04-11T22:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254375",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_254376.json:
```json
{
    "body": "<a id='comment:19'></a>Fixed merge failure...",
    "created_at": "2015-04-11T22:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254376",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:19'></a>Fixed merge failure...



---

archive/issue_comments_254377.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-11T22:59:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254377",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_051273.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-14T19:43:31Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18067#event-51273"
}
```



---

archive/issue_comments_254378.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-14T19:43:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18067",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18067#issuecomment-254378",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
