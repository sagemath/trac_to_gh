# Issue 18237: upgrade to pynac-0.3.5

archive/issues_018000.json:
```json
{
    "body": "We skip 0.3.3 (#18155) which couldn't be used because of a bug showing on OSX.\n\nhttps://drive.google.com/folderview?id=0B4PmRyK1JXgHfmJmbWZ5NnVtMnNITTVHQ2hCci1WVnhLbC1PeC1YbzRQLUpidU9yY0x3Qjg&usp=sharing\n\n```\n* fixed the series expansion of zeta(s) around 1\n* print_latex of wildcards\n* clear the libtool versioning scheme\n* sync with current GiNaC as much as possible\n* revert GiNaC commit interfering with Pynac print order\n* fix code that produced warnings\n```\nUpgrade will require a few doctests to adapt, see https://groups.google.com/d/topic/sage-devel/hwQXxFmutcU/discussion\n\nDependent tickets: #15047, #15846\n\nBranch/Commit: c5ac7dcca650cef95ed65cfb77c51b111fd80193\n\nReviewer: Benjamin Hackl\n\nAuthor: Ralf Stephan\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18237\n\n",
    "closed_at": "2015-04-19T01:52:02Z",
    "created_at": "2015-04-17T07:54:52Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "upgrade to pynac-0.3.5",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18237",
    "user": "https://github.com/rwst"
}
```
We skip 0.3.3 (#18155) which couldn't be used because of a bug showing on OSX.

https://drive.google.com/folderview?id=0B4PmRyK1JXgHfmJmbWZ5NnVtMnNITTVHQ2hCci1WVnhLbC1PeC1YbzRQLUpidU9yY0x3Qjg&usp=sharing

```
* fixed the series expansion of zeta(s) around 1
* print_latex of wildcards
* clear the libtool versioning scheme
* sync with current GiNaC as much as possible
* revert GiNaC commit interfering with Pynac print order
* fix code that produced warnings
```
Upgrade will require a few doctests to adapt, see https://groups.google.com/d/topic/sage-devel/hwQXxFmutcU/discussion

Dependent tickets: #15047, #15846

Branch/Commit: c5ac7dcca650cef95ed65cfb77c51b111fd80193

Reviewer: Benjamin Hackl

Author: Ralf Stephan

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18237





---

archive/issue_comments_241780.json:
```json
{
    "body": "<a id='comment:2'></a>New commits:",
    "created_at": "2015-04-17T07:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241780",
    "user": "https://github.com/rwst"
}
```

<a id='comment:2'></a>New commits:



---

archive/issue_comments_241781.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-04-17T07:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241781",
    "user": "https://github.com/rwst"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_241782.json:
```json
{
    "body": "<a id='comment:3'></a>On it, currently doing some more doctesting on Arch Linux (kernel 3.19.3-3, i7, 12GB RAM); will be finished soon.\n\nMeanwhile: I can confirm that the bug with the unstable output of `integrate(sec(x), (x, 0, pi/8))` on OSX (see https://github.com/pynac/pynac/issues/18) is gone. Thanks to Volker for access to the OSX buildslave!",
    "created_at": "2015-04-17T14:54:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241782",
    "user": "https://github.com/behackl"
}
```

<a id='comment:3'></a>On it, currently doing some more doctesting on Arch Linux (kernel 3.19.3-3, i7, 12GB RAM); will be finished soon.

Meanwhile: I can confirm that the bug with the unstable output of `integrate(sec(x), (x, 0, pi/8))` on OSX (see https://github.com/pynac/pynac/issues/18) is gone. Thanks to Volker for access to the OSX buildslave!



---

archive/issue_comments_241783.json:
```json
{
    "body": "<a id='comment:4'></a>`MAKE=\"make -j4\" make ptestlong` gives\n\n```\n----------------------------------------------------------------------\nsage -t --long --warn-long 81.8 src/sage/combinat/dyck_word.py  # 1 doctest failed\n----------------------------------------------------------------------\n```\n\nThe doctest fails with\n\n```\nsage -t --long --warn-long 81.8 src/sage/combinat/dyck_word.py\n**********************************************************************\nFile \"src/sage/combinat/dyck_word.py\", line 3501, in sage.combinat.dyck_word.DyckWords_size.__init__\nFailed example:\n    TestSuite(DyckWords(4,2)).run()\nExpected nothing\nGot:\n    Failure in _test_enumerated_set_iter_cardinality:\n    Traceback (most recent call last):\n      File \"/home/behackl/Programming/sage-6.7.beta1/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py\", line 282, in run\n        test_method(tester = tester)\n      File \"/home/behackl/Programming/sage-6.7.beta1/local/lib/python2.7/site-packages/sage/categories/finite_enumerated_sets.py\", line 462, in _test_enumerated_set_iter_cardinality\n        tester.assert_(isinstance(card, Integer))\n      File \"/home/behackl/Programming/sage-6.7.beta1/local/lib/python/unittest/case.py\", line 422, in assertTrue\n        raise self.failureException(msg)\n    AssertionError: False is not true\n    ------------------------------------------------------------\n    The following tests failed: _test_enumerated_set_iter_cardinality\n**********************************************************************\n1 item had failures:\n   1 of   2 in sage.combinat.dyck_word.DyckWords_size.__init__\n    [574 tests, 1 failure, 2.98 s]\n```\n\nThis happened two times. However, when testing the respective file manually:\n\n```\nsage -t --long --warn-long 81.8 src/sage/combinat/dyck_word.py\n    [574 tests, 0.95 s]\n----------------------------------------------------------------------\nAll tests passed!\n----------------------------------------------------------------------\n```\n\nSo this only seems to occur for `make ptestlong`. \n\nAdditionally, as I've not run `make ptestlong` on a clean install of `6.7.beta1` yet, I'm not even sure if this is related to Pynac at all. I'll do so and report back...",
    "created_at": "2015-04-17T16:58:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241783",
    "user": "https://github.com/behackl"
}
```

<a id='comment:4'></a>`MAKE="make -j4" make ptestlong` gives

```
----------------------------------------------------------------------
sage -t --long --warn-long 81.8 src/sage/combinat/dyck_word.py  # 1 doctest failed
----------------------------------------------------------------------
```

The doctest fails with

```
sage -t --long --warn-long 81.8 src/sage/combinat/dyck_word.py
**********************************************************************
File "src/sage/combinat/dyck_word.py", line 3501, in sage.combinat.dyck_word.DyckWords_size.__init__
Failed example:
    TestSuite(DyckWords(4,2)).run()
Expected nothing
Got:
    Failure in _test_enumerated_set_iter_cardinality:
    Traceback (most recent call last):
      File "/home/behackl/Programming/sage-6.7.beta1/local/lib/python2.7/site-packages/sage/misc/sage_unittest.py", line 282, in run
        test_method(tester = tester)
      File "/home/behackl/Programming/sage-6.7.beta1/local/lib/python2.7/site-packages/sage/categories/finite_enumerated_sets.py", line 462, in _test_enumerated_set_iter_cardinality
        tester.assert_(isinstance(card, Integer))
      File "/home/behackl/Programming/sage-6.7.beta1/local/lib/python/unittest/case.py", line 422, in assertTrue
        raise self.failureException(msg)
    AssertionError: False is not true
    ------------------------------------------------------------
    The following tests failed: _test_enumerated_set_iter_cardinality
**********************************************************************
1 item had failures:
   1 of   2 in sage.combinat.dyck_word.DyckWords_size.__init__
    [574 tests, 1 failure, 2.98 s]
```

This happened two times. However, when testing the respective file manually:

```
sage -t --long --warn-long 81.8 src/sage/combinat/dyck_word.py
    [574 tests, 0.95 s]
----------------------------------------------------------------------
All tests passed!
----------------------------------------------------------------------
```

So this only seems to occur for `make ptestlong`. 

Additionally, as I've not run `make ptestlong` on a clean install of `6.7.beta1` yet, I'm not even sure if this is related to Pynac at all. I'll do so and report back...



---

archive/issue_comments_241784.json:
```json
{
    "body": "<a id='comment:5'></a>See https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/7BQPmEgfA8M -- until this is resolved, I can't review the new Pynac version reliably.",
    "created_at": "2015-04-17T17:57:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241784",
    "user": "https://github.com/behackl"
}
```

<a id='comment:5'></a>See https://groups.google.com/forum/?fromgroups=#!topic/sage-devel/7BQPmEgfA8M -- until this is resolved, I can't review the new Pynac version reliably.



---

archive/issue_comments_241785.json:
```json
{
    "body": "<a id='comment:6'></a>I had the same doctest fail today on a clean `6.7beta1` install and, just like you, could not reproduce it when running this specific test again on the file, so I doubt that this is related to this ticket.",
    "created_at": "2015-04-17T18:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241785",
    "user": "https://trac.sagemath.org/admin/accounts/users/jkeitel"
}
```

<a id='comment:6'></a>I had the same doctest fail today on a clean `6.7beta1` install and, just like you, could not reproduce it when running this specific test again on the file, so I doubt that this is related to this ticket.



---

archive/issue_comments_241786.json:
```json
{
    "body": "<a id='comment:7'></a>I'm also quite sure that it has nothing to do with this ticket; especially after Vincent confirmed that this is happening for him too on both `6.7.beta0` and `6.7.beta1`. This discussion, however, belongs to the `sage-devel` thread.\n\nStill, I don't like the idea of giving this `positive_review` when I don't have a passing `ptestlong`, regardless of why the doctest is failing. Currently, I'm compiling sage on two more machines; one of those should enable me to review this.",
    "created_at": "2015-04-17T19:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241786",
    "user": "https://github.com/behackl"
}
```

<a id='comment:7'></a>I'm also quite sure that it has nothing to do with this ticket; especially after Vincent confirmed that this is happening for him too on both `6.7.beta0` and `6.7.beta1`. This discussion, however, belongs to the `sage-devel` thread.

Still, I don't like the idea of giving this `positive_review` when I don't have a passing `ptestlong`, regardless of why the doctest is failing. Currently, I'm compiling sage on two more machines; one of those should enable me to review this.



---

archive/issue_comments_241787.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-17T21:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241787",
    "user": "https://github.com/behackl"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_241788.json:
```json
{
    "body": "<a id='comment:8'></a>It seems that something went wrong when I upgraded sage from `6.6.rc2` to `6.7.beta1`. Completely rebuilding sage resolves everything, and `make ptestlong` passes without problems again for both, the clean install as well as this ticket (on all three machines I tested this; 2x Arch Linux, 1x Linux Mint). Therefore: `positive_review`. :-)",
    "created_at": "2015-04-17T21:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241788",
    "user": "https://github.com/behackl"
}
```

<a id='comment:8'></a>It seems that something went wrong when I upgraded sage from `6.6.rc2` to `6.7.beta1`. Completely rebuilding sage resolves everything, and `make ptestlong` passes without problems again for both, the clean install as well as this ticket (on all three machines I tested this; 2x Arch Linux, 1x Linux Mint). Therefore: `positive_review`. :-)



---

archive/issue_comments_241789.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-04-19T01:52:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18237#issuecomment-241789",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_051531.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-19T01:52:02Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18237",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18237#event-51531"
}
```
