# Issue 18358: a cython function that produces long given python input

archive/issues_018121.json:
```json
{
    "body": "I met twice the same problem which is the nedd for a standalone function that given a python objects return an associated long (if it makes sense).\n\nThe following is not safe\n\n```\ncdef long f(x):\n    return x\n```\nsince `f(2/3)` would return `0` (see e.g. #18278). Moreover, one could expect something that would be very fast for both Python int and Sage integers (see #18346).\n\nCC:  @nathanncohen\n\nBranch/Commit: 6b46fee72115db82a7eedb02482b83af694247ba\n\nReviewer: Jeroen Demeyer\n\nAuthor: Vincent Delecroix\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18358\n\n",
    "closed_at": "2015-05-14T22:40:19Z",
    "created_at": "2015-05-03T20:25:38Z",
    "labels": [
        "component: coercion"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.7",
    "title": "a cython function that produces long given python input",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18358",
    "user": "https://github.com/videlec"
}
```
I met twice the same problem which is the nedd for a standalone function that given a python objects return an associated long (if it makes sense).

The following is not safe

```
cdef long f(x):
    return x
```
since `f(2/3)` would return `0` (see e.g. #18278). Moreover, one could expect something that would be very fast for both Python int and Sage integers (see #18346).

CC:  @nathanncohen

Branch/Commit: 6b46fee72115db82a7eedb02482b83af694247ba

Reviewer: Jeroen Demeyer

Author: Vincent Delecroix

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18358





---

archive/issue_comments_319464.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-05-03T20:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319464",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_319465.json:
```json
{
    "body": "<a id='comment:1'></a>That's not a bug report, but a support request. If you post this to `sage-support`, I'll answer.",
    "created_at": "2015-05-03T20:44:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319465",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:1'></a>That's not a bug report, but a support request. If you post this to `sage-support`, I'll answer.



---

archive/issue_events_051785.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-03T20:44:04Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18358#event-51785"
}
```



---

archive/issue_comments_319466.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-05-03T20:44:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319466",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_319467.json:
```json
{
    "body": "<a id='comment:3'></a>Replying to [comment:1 jdemeyer]:\n> That's not a bug report, but a support request. If you post this to `sage-support`, I'll answer.\n\n\nhttps://groups.google.com/forum/#!topic/sage-support/0ATjCgQlq4c",
    "created_at": "2015-05-03T20:49:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319467",
    "user": "https://github.com/videlec"
}
```

<a id='comment:3'></a>Replying to [comment:1 jdemeyer]:
> That's not a bug report, but a support request. If you post this to `sage-support`, I'll answer.


https://groups.google.com/forum/#!topic/sage-support/0ATjCgQlq4c



---

archive/issue_comments_319468.json:
```json
{
    "body": "<a id='comment:4'></a>In view of your answer on sage-support, it might still be worth to have something along\n\n```\ncdef inline long long_or_LONG_MIN(x):\n    if PyInt_CheckExact(x):\n        return PyInt_AS_LONG(x)\n    elif type(x) is Integer:\n        if mpz_fits_slong_p((<Integer>x).value):\n            return mpz_get_si((<Integer>x).value)\n        else:\n            return LONG_MIN\n    else:\n        try:\n            return PyNumber_Index(x)\n        except Exception:\n            return LONG_MIN \n```\nIt would be faster for Python ints and Sage integers.\n\nVincent",
    "created_at": "2015-05-04T13:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319468",
    "user": "https://github.com/videlec"
}
```

<a id='comment:4'></a>In view of your answer on sage-support, it might still be worth to have something along

```
cdef inline long long_or_LONG_MIN(x):
    if PyInt_CheckExact(x):
        return PyInt_AS_LONG(x)
    elif type(x) is Integer:
        if mpz_fits_slong_p((<Integer>x).value):
            return mpz_get_si((<Integer>x).value)
        else:
            return LONG_MIN
    else:
        try:
            return PyNumber_Index(x)
        except Exception:
            return LONG_MIN 
```
It would be faster for Python ints and Sage integers.

Vincent



---

archive/issue_comments_319469.json:
```json
{
    "body": "<a id='comment:5'></a>For Python `int`s, there will not be much difference (calling `PyNumber_Index(x)` on an `int` just returns `x`, so the only overhead is a function call and some reference counting).\n\nFor `Integer`, there is a larger gain. It's just annoying that Python doesn't allow defining a fast conversion `ArbitraryType` -> C `long`.",
    "created_at": "2015-05-04T13:46:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319469",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>For Python `int`s, there will not be much difference (calling `PyNumber_Index(x)` on an `int` just returns `x`, so the only overhead is a function call and some reference counting).

For `Integer`, there is a larger gain. It's just annoying that Python doesn't allow defining a fast conversion `ArbitraryType` -> C `long`.



---

archive/issue_events_051786.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-04T14:02:05Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18358#event-51786"
}
```



---

archive/issue_events_051787.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-04T14:02:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "milestone": "sage-6.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18358#event-51787"
}
```



---

archive/issue_comments_319470.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-05-04T14:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319470",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_319471.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:5 jdemeyer]:\n\n> For `Integer`, there is a larger gain. It's just annoying that Python doesn't allow defining a fast conversion `ArbitraryType` -> C `long`.\n\n\nIt does! It's called `tp_hash` :-). It's of course already taken for other purposes. We'd need an extra slot. Something along the lines of the conversion macro suggested in comment:4 would probably be the best we can do without it.",
    "created_at": "2015-05-04T16:07:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319471",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:7'></a>Replying to [comment:5 jdemeyer]:

> For `Integer`, there is a larger gain. It's just annoying that Python doesn't allow defining a fast conversion `ArbitraryType` -> C `long`.


It does! It's called `tp_hash` :-). It's of course already taken for other purposes. We'd need an extra slot. Something along the lines of the conversion macro suggested in comment:4 would probably be the best we can do without it.



---

archive/issue_comments_319472.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:7 nbruin]:\n> We'd need an extra slot.\n\nSometimes I wish I could just patch Python...\n\n> Something along the lines of the conversion macro suggested in comment:4 would probably be the best we can do without it.\n\nIndeed.",
    "created_at": "2015-05-04T17:30:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319472",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Replying to [comment:7 nbruin]:
> We'd need an extra slot.

Sometimes I wish I could just patch Python...

> Something along the lines of the conversion macro suggested in comment:4 would probably be the best we can do without it.

Indeed.



---

archive/issue_comments_319473.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-05T13:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319473",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_319474.json:
```json
{
    "body": "Changing branch from \"\" to \"u/vdelecroix/18358\"",
    "created_at": "2015-05-05T13:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319474",
    "user": "https://github.com/videlec"
}
```

Changing branch from "" to "u/vdelecroix/18358"



---

archive/issue_comments_319475.json:
```json
{
    "body": "<a id='comment:9'></a>Here is an experimental branch with a macro `pyobject_to_long` in `sage.misc.long`. I do not like the gestion of error but I do not know how to do better without affecting performance. Please tell me.\n\nIt is used in `Integer.__pow__` and `Rational.__pow__` as a proof of concept. And we win 20 precious nano seconds when the exponent is a small Sage Integer (~10%):\n\n```\nsage: timeit(\"2**5\", number=400000, repeat=20)\n400000 loops, best of 20: 248 ns per loop\nsage: timeit(\"(2/3)**2\", number=100000, repeat=20)\n100000 loops, best of 20: 1.1 \u00b5s per loop\n```\nagainst\n\n```\nsage: timeit(\"2**5\", number=400000, repeat=20)\n400000 loops, best of 20: 228 ns per loop\nsage: timeit(\"(2/3)**2\", number=100000, repeat=20)\n200000 loops, best of 30: 990 ns per loop\n```\n\nVincent\n\n---\nNew commits:",
    "created_at": "2015-05-05T13:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319475",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>Here is an experimental branch with a macro `pyobject_to_long` in `sage.misc.long`. I do not like the gestion of error but I do not know how to do better without affecting performance. Please tell me.

It is used in `Integer.__pow__` and `Rational.__pow__` as a proof of concept. And we win 20 precious nano seconds when the exponent is a small Sage Integer (~10%):

```
sage: timeit("2**5", number=400000, repeat=20)
400000 loops, best of 20: 248 ns per loop
sage: timeit("(2/3)**2", number=100000, repeat=20)
100000 loops, best of 20: 1.1 µs per loop
```
against

```
sage: timeit("2**5", number=400000, repeat=20)
400000 loops, best of 20: 228 ns per loop
sage: timeit("(2/3)**2", number=100000, repeat=20)
200000 loops, best of 30: 990 ns per loop
```

Vincent

---
New commits:



---

archive/issue_comments_319476.json:
```json
{
    "body": "Changing commit from \"\" to \"8e9148450538c683d50c89d90acf7457feb0cc03\"",
    "created_at": "2015-05-05T13:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319476",
    "user": "https://github.com/videlec"
}
```

Changing commit from "" to "8e9148450538c683d50c89d90acf7457feb0cc03"



---

archive/issue_comments_319477.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-05T13:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319477",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_319478.json:
```json
{
    "body": "Changing commit from \"8e9148450538c683d50c89d90acf7457feb0cc03\" to \"1e7db2e21982c4d5097e0452bb19c5329ad1c40e\"",
    "created_at": "2015-05-05T13:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319478",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "8e9148450538c683d50c89d90acf7457feb0cc03" to "1e7db2e21982c4d5097e0452bb19c5329ad1c40e"



---

archive/issue_comments_319479.json:
```json
{
    "body": "<a id='comment:11'></a>`except LONG_MIN` -> `except? LONG_MIN` and there is no need to document `LONG_MIN` in the docstring.",
    "created_at": "2015-05-05T14:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319479",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>`except LONG_MIN` -> `except? LONG_MIN` and there is no need to document `LONG_MIN` in the docstring.



---

archive/issue_comments_319480.json:
```json
{
    "body": "<a id='comment:12'></a>`PyInt_CheckExact(...)` -> `isinstance(..., int)`",
    "created_at": "2015-05-05T14:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319480",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>`PyInt_CheckExact(...)` -> `isinstance(..., int)`



---

archive/issue_comments_319481.json:
```json
{
    "body": "<a id='comment:13'></a>`OverflowError` -> `OverflowError(\"Integer too large to convert to C long\")` or something like that.\n\nAnd obviously: doctests please.",
    "created_at": "2015-05-05T14:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319481",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>`OverflowError` -> `OverflowError("Integer too large to convert to C long")` or something like that.

And obviously: doctests please.



---

archive/issue_comments_319482.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-05T14:50:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319482",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_319483.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 jdemeyer]:\n> `OverflowError` -> `OverflowError(\"Integer too large to convert to C long\")` or something like that.\n> \n> And obviously: doctests please.\n\n\nHow? Should I use `Integer.__pow__` and `Rational.__pow__` with indirect doctests?",
    "created_at": "2015-05-05T15:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319483",
    "user": "https://github.com/videlec"
}
```

<a id='comment:14'></a>Replying to [comment:13 jdemeyer]:
> `OverflowError` -> `OverflowError("Integer too large to convert to C long")` or something like that.
> 
> And obviously: doctests please.


How? Should I use `Integer.__pow__` and `Rational.__pow__` with indirect doctests?



---

archive/issue_comments_319484.json:
```json
{
    "body": "<a id='comment:15'></a>Replying to [comment:14 vdelecroix]:\n> Replying to [comment:13 jdemeyer]:\n> > `OverflowError` -> `OverflowError(\"Integer too large to convert to C long\")` or something like that.\n> > \n> > And obviously: doctests please.\n\n> \n> How? Should I use `Integer.__pow__` and `Rational.__pow__` with indirect doctests?\n\nThat's actually not a bad idea. You should probably test the following numbers: `int(10)`, `long(10)`, `long(10^100)`, `10`, `10^100`, `QQ(10)`, `QQ(10^100)`, `1/2`.",
    "created_at": "2015-05-05T19:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319484",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>Replying to [comment:14 vdelecroix]:
> Replying to [comment:13 jdemeyer]:
> > `OverflowError` -> `OverflowError("Integer too large to convert to C long")` or something like that.
> > 
> > And obviously: doctests please.

> 
> How? Should I use `Integer.__pow__` and `Rational.__pow__` with indirect doctests?

That's actually not a bad idea. You should probably test the following numbers: `int(10)`, `long(10)`, `long(10^100)`, `10`, `10^100`, `QQ(10)`, `QQ(10^100)`, `1/2`.



---

archive/issue_comments_319485.json:
```json
{
    "body": "<a id='comment:16'></a>It would make sense to merge 6.7.beta4 and replace all occurances of `PyNumber_Index` and `PyNumber_AsSsize_t` by this new function.",
    "created_at": "2015-05-05T21:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319485",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>It would make sense to merge 6.7.beta4 and replace all occurances of `PyNumber_Index` and `PyNumber_AsSsize_t` by this new function.



---

archive/issue_comments_319486.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 jdemeyer]:\n> It would make sense to merge 6.7.beta4 and replace all occurances of `PyNumber_Index` and `PyNumber_AsSsize_t` by this new function.\n\n\nIt might not be good everywhere as the overflow might not be appropriate. I will have a look at occurrences.",
    "created_at": "2015-05-05T21:26:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319486",
    "user": "https://github.com/videlec"
}
```

<a id='comment:17'></a>Replying to [comment:16 jdemeyer]:
> It would make sense to merge 6.7.beta4 and replace all occurances of `PyNumber_Index` and `PyNumber_AsSsize_t` by this new function.


It might not be good everywhere as the overflow might not be appropriate. I will have a look at occurrences.



---

archive/issue_comments_319487.json:
```json
{
    "body": "<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-06T07:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319487",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:18'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_319488.json:
```json
{
    "body": "Changing commit from \"1e7db2e21982c4d5097e0452bb19c5329ad1c40e\" to \"e7ad72f5a0a5e44d4d6aad5208e597201edf2be8\"",
    "created_at": "2015-05-06T07:10:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319488",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "1e7db2e21982c4d5097e0452bb19c5329ad1c40e" to "e7ad72f5a0a5e44d4d6aad5208e597201edf2be8"



---

archive/issue_comments_319489.json:
```json
{
    "body": "<a id='comment:19'></a>Rebased on sage-6.7.beta4. I used `pyobject_to_long` where it seemed appropriate.\n\nVincent",
    "created_at": "2015-05-06T07:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319489",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>Rebased on sage-6.7.beta4. I used `pyobject_to_long` where it seemed appropriate.

Vincent



---

archive/issue_comments_319490.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-06T07:11:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319490",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_319491.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-06T07:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319491",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_319492.json:
```json
{
    "body": "<a id='comment:20'></a>In `c_graph`, if you call a variable `u_long`, actually make it a `long` (now it's still an `int` which means it can silently overflow).",
    "created_at": "2015-05-06T07:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319492",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>In `c_graph`, if you call a variable `u_long`, actually make it a `long` (now it's still an `int` which means it can silently overflow).



---

archive/issue_comments_319493.json:
```json
{
    "body": "<a id='comment:21'></a>You're not actually using this:\n\n```\nsage: tens = [10r, 10l, 10, 10/1]\n```",
    "created_at": "2015-05-06T07:33:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319493",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:21'></a>You're not actually using this:

```
sage: tens = [10r, 10l, 10, 10/1]
```



---

archive/issue_comments_319494.json:
```json
{
    "body": "<a id='comment:22'></a>I would prefer to replace\n\n```\ntry:\n    n = pyobject_to_long(exp)\nexcept TypeError:\n    raise TypeError(\"non-integral exponents not supported\")\n```\nby\n\n```\nn = pyobject_to_long(exp)\n```",
    "created_at": "2015-05-06T07:37:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319494",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>I would prefer to replace

```
try:
    n = pyobject_to_long(exp)
except TypeError:
    raise TypeError("non-integral exponents not supported")
```
by

```
n = pyobject_to_long(exp)
```



---

archive/issue_comments_319495.json:
```json
{
    "body": "Changing commit from \"e7ad72f5a0a5e44d4d6aad5208e597201edf2be8\" to \"90453ff943b693383a38c358aeb4a81a9c5da25e\"",
    "created_at": "2015-05-11T17:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319495",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "e7ad72f5a0a5e44d4d6aad5208e597201edf2be8" to "90453ff943b693383a38c358aeb4a81a9c5da25e"



---

archive/issue_comments_319496.json:
```json
{
    "body": "<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-11T17:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319496",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:23'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_319497.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2015-05-11T17:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319497",
    "user": "https://github.com/videlec"
}
```

Changing reviewer from "" to "Jeroen Demeyer"



---

archive/issue_comments_319498.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-11T17:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319498",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_319499.json:
```json
{
    "body": "<a id='comment:25'></a>Two more points:\n\n1. `raied` -> `raised`\n\n2. The doctests for `Integer.__pow__` and `Rational.__pow__` seem redundant. It's sufficient to keep just one.",
    "created_at": "2015-05-12T12:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319499",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'></a>Two more points:

1. `raied` -> `raised`

2. The doctests for `Integer.__pow__` and `Rational.__pow__` seem redundant. It's sufficient to keep just one.



---

archive/issue_comments_319500.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-12T12:44:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319500",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_319501.json:
```json
{
    "body": "Changing commit from \"90453ff943b693383a38c358aeb4a81a9c5da25e\" to \"6b46fee72115db82a7eedb02482b83af694247ba\"",
    "created_at": "2015-05-13T16:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319501",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing commit from "90453ff943b693383a38c358aeb4a81a9c5da25e" to "6b46fee72115db82a7eedb02482b83af694247ba"



---

archive/issue_comments_319502.json:
```json
{
    "body": "<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-05-13T16:15:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319502",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:27'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_319503.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-13T16:15:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319503",
    "user": "https://github.com/videlec"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_319504.json:
```json
{
    "body": "<a id='comment:29'></a>I didn't run doctests again, but positive_review assuming that they pass.",
    "created_at": "2015-05-13T19:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319504",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:29'></a>I didn't run doctests again, but positive_review assuming that they pass.



---

archive/issue_comments_319505.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-05-13T19:53:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319505",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_051788.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-14T22:40:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18358#event-51788"
}
```



---

archive/issue_comments_319506.json:
```json
{
    "body": "Changing branch from \"u/vdelecroix/18358\" to \"6b46fee72115db82a7eedb02482b83af694247ba\"",
    "created_at": "2015-05-14T22:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319506",
    "user": "https://github.com/vbraun"
}
```

Changing branch from "u/vdelecroix/18358" to "6b46fee72115db82a7eedb02482b83af694247ba"



---

archive/issue_comments_319507.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-05-14T22:40:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18358",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18358#issuecomment-319507",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
