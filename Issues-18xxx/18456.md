# Issue 18456: Re-Fix standard_packages(), optional_packages(), and experimental_packages()

archive/issues_018219.json:
```json
{
    "assignees": [],
    "body": "What was fixed in #18407 (one week ago) has been broken since `:-P`\n\nThat's because the website went mostly down. Also, that new version handles both old-style spkg and new-style spkg.\n\nNathann\n\nDepends on #18431\n\nCC:  @nexttime @vbraun @jdemeyer\n\nBranch/Commit: **[b093007](https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f)**\n\nReviewer: **John Palmieri**\n\nAuthor: **Nathann Cohen**\n\nComponent: **distribution**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18456_\n\n",
    "closed_at": "2015-06-03T23:22:39Z",
    "created_at": "2015-05-19T20:54:56Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20distribution",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Re-Fix standard_packages(), optional_packages(), and experimental_packages()",
    "type": "issue",
    "updated_at": "2015-06-03T23:22:39Z",
    "url": "https://github.com/sagemath/sage/issues/18456",
    "user": "https://github.com/nathanncohen"
}
```
What was fixed in #18407 (one week ago) has been broken since `:-P`

That's because the website went mostly down. Also, that new version handles both old-style spkg and new-style spkg.

Nathann

Depends on #18431

CC:  @nexttime @vbraun @jdemeyer

Branch/Commit: **[b093007](https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f)**

Reviewer: **John Palmieri**

Author: **Nathann Cohen**

Component: **distribution**

_Issue created by migration from https://trac.sagemath.org/ticket/18456_





---

archive/issue_events_262334.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-05-19T20:54:56Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262334"
}
```



---

archive/issue_events_262335.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-05-19T20:54:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20distribution",
    "label_color": "000080",
    "label_name": "c: distribution",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262335"
}
```



---

archive/issue_events_262336.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-05-19T20:54:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262336"
}
```



---

archive/issue_events_262337.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-05-19T20:54:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262337"
}
```



---

archive/issue_comments_254748.json:
```json
{
    "body": "Branch: **[u/ncohen/18456](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/18456)**",
    "created_at": "2015-05-19T20:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254748",
    "user": "https://github.com/nathanncohen"
}
```

Branch: **[u/ncohen/18456](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/18456)**



---

archive/issue_comments_254749.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-What was fixed in `18407` (one week ago) has been broken since `:-P`\n+What was fixed in #18407 (one week ago) has been broken since `:-P`\n \n That's because the website went mostly down. Also, that new version handles both old-style spkg and new-style spkg.\n \n``````\n",
    "created_at": "2015-05-19T20:55:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254749",
    "user": "https://github.com/nathanncohen"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-What was fixed in `18407` (one week ago) has been broken since `:-P`
+What was fixed in #18407 (one week ago) has been broken since `:-P`
 
 That's because the website went mostly down. Also, that new version handles both old-style spkg and new-style spkg.
 
``````




---

archive/issue_events_262338.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-05-19T20:55:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262338"
}
```



---

archive/issue_comments_254750.json:
```json
{
    "body": "<div id=\"comment:2\"></div>\n\nBranch pushed to git repo; I updated commit sha1. Last 10 new commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47705185c7a9917eacb9b78cce57f6b922ffd89e\">4770518</a></td><td><code>trac #18431: Type file for each package+define var from pkg name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/3efc9fbbefafc3652870456e4cd2835ebc15e5f4\">3efc9fb</a></td><td><code>trac #18431: package-specific 'dependencies' files</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/308ceff956d47f2eb1e6900c45153e6f0f4cfc88\">308ceff</a></td><td><code>trac #18431: Auto-generate make rules for standard packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/77f293f9b35cc889182504fbda61bef1ef0b9526\">77f293f</a></td><td><code>trac #18431: auto-generated Make target \"sage-standard-packages\"</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e1148740416708c41a1d7baf9e528f6bba729de1\">e114874</a></td><td><code>trac #18431: typo</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/766798e30f05f739cf6d4e568b6e58c308ecd946\">766798e</a></td><td><code>trac #18431: tab->spaces</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/47e438df730ef7ee30735be66a3e1725303bde24\">47e438d</a></td><td><code>Merge tag '6.7' into t/18441/base_packages_except_configure_should_be_standard</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4de8e37b49dacfb56aad239d2bd800ce0d3b7288\">4de8e37</a></td><td><code>Various changes to build system</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f83b0c4289a6dcf1ece58172928d6a511819a725\">f83b0c4</a></td><td><code>Correct variable name</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ebf52de4e4f6e7cb16d1372648617ff401b59d53\">ebf52de</a></td><td><code>trac #18456: Re-Fix standard_packages(), optional_packages(), and experimental_packages()</code></td></tr></table>\n",
    "created_at": "2015-05-19T20:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254750",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:2"></div>

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47705185c7a9917eacb9b78cce57f6b922ffd89e">4770518</a></td><td><code>trac #18431: Type file for each package+define var from pkg name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/3efc9fbbefafc3652870456e4cd2835ebc15e5f4">3efc9fb</a></td><td><code>trac #18431: package-specific 'dependencies' files</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/308ceff956d47f2eb1e6900c45153e6f0f4cfc88">308ceff</a></td><td><code>trac #18431: Auto-generate make rules for standard packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/77f293f9b35cc889182504fbda61bef1ef0b9526">77f293f</a></td><td><code>trac #18431: auto-generated Make target "sage-standard-packages"</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e1148740416708c41a1d7baf9e528f6bba729de1">e114874</a></td><td><code>trac #18431: typo</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/766798e30f05f739cf6d4e568b6e58c308ecd946">766798e</a></td><td><code>trac #18431: tab->spaces</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/47e438df730ef7ee30735be66a3e1725303bde24">47e438d</a></td><td><code>Merge tag '6.7' into t/18441/base_packages_except_configure_should_be_standard</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4de8e37b49dacfb56aad239d2bd800ce0d3b7288">4de8e37</a></td><td><code>Various changes to build system</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f83b0c4289a6dcf1ece58172928d6a511819a725">f83b0c4</a></td><td><code>Correct variable name</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ebf52de4e4f6e7cb16d1372648617ff401b59d53">ebf52de</a></td><td><code>trac #18456: Re-Fix standard_packages(), optional_packages(), and experimental_packages()</code></td></tr></table>




---

archive/issue_comments_254751.json:
```json
{
    "body": "Commit: **[ebf52de](https://github.com/sagemath/sagetrac-mirror/commit/ebf52de4e4f6e7cb16d1372648617ff401b59d53)**",
    "created_at": "2015-05-19T20:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254751",
    "user": "https://github.com/sagetrac-git"
}
```

Commit: **[ebf52de](https://github.com/sagemath/sagetrac-mirror/commit/ebf52de4e4f6e7cb16d1372648617ff401b59d53)**



---

archive/issue_comments_254752.json:
```json
{
    "body": "Changed commit from **[ebf52de](https://github.com/sagemath/sagetrac-mirror/commit/ebf52de4e4f6e7cb16d1372648617ff401b59d53)** to **[39cc007](https://github.com/sagemath/sagetrac-mirror/commit/39cc007aaaf83a6ff0fbd99536c1561486fbfead)**",
    "created_at": "2015-05-19T21:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254752",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[ebf52de](https://github.com/sagemath/sagetrac-mirror/commit/ebf52de4e4f6e7cb16d1372648617ff401b59d53)** to **[39cc007](https://github.com/sagemath/sagetrac-mirror/commit/39cc007aaaf83a6ff0fbd99536c1561486fbfead)**



---

archive/issue_comments_254753.json:
```json
{
    "body": "<div id=\"comment:3\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/39cc007aaaf83a6ff0fbd99536c1561486fbfead\">39cc007</a></td><td><code>trac #18456: Re-Fix standard_packages(), optional_packages(), and experimental_packages()</code></td></tr></table>\n",
    "created_at": "2015-05-19T21:01:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254753",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:3"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/39cc007aaaf83a6ff0fbd99536c1561486fbfead">39cc007</a></td><td><code>trac #18456: Re-Fix standard_packages(), optional_packages(), and experimental_packages()</code></td></tr></table>




---

archive/issue_comments_254754.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI insstalled the branch and did \"make\" which rebuilt a very large amount.  Then\n\n```\n./sage -standard\n```\ngave\n\n```\nUsing Sage Server http://www.sagemath.org/spkg\nHTTP Error 404: Not Found\n\n\n\n********************************************************************************\n\n\n\nError contacting http://www.sagemath.org/spkg/standard/list. Try using an alternative server.\nFor example, from the bash prompt try typing\n\n   export SAGE_SERVER=http://sage.scipy.org/sage/\n\nthen try again.\n```\nwhich also failed.  SO I don't exactly know what it is that I am supposed to be testing!",
    "created_at": "2015-05-28T08:24:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254754",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:4" align="right">comment:4</div>

I insstalled the branch and did "make" which rebuilt a very large amount.  Then

```
./sage -standard
```
gave

```
Using Sage Server http://www.sagemath.org/spkg
HTTP Error 404: Not Found



********************************************************************************



Error contacting http://www.sagemath.org/spkg/standard/list. Try using an alternative server.
For example, from the bash prompt try typing

   export SAGE_SERVER=http://sage.scipy.org/sage/

then try again.
```
which also failed.  SO I don't exactly know what it is that I am supposed to be testing!



---

archive/issue_comments_254755.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nHello !\n\n> I insstalled the branch and did \"make\" which rebuilt a very large amount.\n\nThis is suspicious. As you can see from the branch's diff, it only touches one file (i.e. sage/misc/package.py) which is not a dependency of anything as far as I know. I just did a checkout on the branch, and no recompilation was triggered at all.\n\n> which also failed.  SO I don't exactly know what it is that I am supposed to be testing!\n\nThis branch fixes the three functions `standard_packages`, `optional_packages`, and `experimental_packages` defined in `sage/misc/package.py`. The script `sage -standard` script does not call them.\n\nIn order to fix `sage -standard`, it makes more sense to make it call a Sage function that does the job. Previously, `standard_packages` ran `sage -standard` and parsed its output: it would be better to have `sage -standard` call `standard_packages` (without any parsing).\n\nThat would require changing the output or `standard_packages`, as currently it only returns the list of packages without including the version numbers.\n\nNathann",
    "created_at": "2015-05-28T08:44:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254755",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:5" align="right">comment:5</div>

Hello !

> I insstalled the branch and did "make" which rebuilt a very large amount.

This is suspicious. As you can see from the branch's diff, it only touches one file (i.e. sage/misc/package.py) which is not a dependency of anything as far as I know. I just did a checkout on the branch, and no recompilation was triggered at all.

> which also failed.  SO I don't exactly know what it is that I am supposed to be testing!

This branch fixes the three functions `standard_packages`, `optional_packages`, and `experimental_packages` defined in `sage/misc/package.py`. The script `sage -standard` script does not call them.

In order to fix `sage -standard`, it makes more sense to make it call a Sage function that does the job. Previously, `standard_packages` ran `sage -standard` and parsed its output: it would be better to have `sage -standard` call `standard_packages` (without any parsing).

That would require changing the output or `standard_packages`, as currently it only returns the list of packages without including the version numbers.

Nathann



---

archive/issue_comments_254756.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nYou are right to be suspicious.  I was starting from 6.8.beta0, while I think that the branch branched off from 6.7 -- right?  That would explain the extra rebuilding.",
    "created_at": "2015-05-28T09:12:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254756",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:6" align="right">comment:6</div>

You are right to be suspicious.  I was starting from 6.8.beta0, while I think that the branch branched off from 6.7 -- right?  That would explain the extra rebuilding.



---

archive/issue_comments_254757.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\n> You are right to be suspicious.  I was starting from 6.8.beta0, while I think that the branch branched off from 6.7 -- right?  That would explain the extra rebuilding.\n\nYep, totally. If it can be of interest to you, I use a short bash script that downloads a branch for me, and merges it with my current beta. This way, I never go back to an earlier version of sage and I avoid these problems.\n\nAbout `sage -standard`: I added a commit at public/18456v2 that makes it work again, though without the version number.\n\nI can add it to this ticket if you want.\n\nNathann",
    "created_at": "2015-05-28T09:27:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254757",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:7" align="right">comment:7</div>

> You are right to be suspicious.  I was starting from 6.8.beta0, while I think that the branch branched off from 6.7 -- right?  That would explain the extra rebuilding.

Yep, totally. If it can be of interest to you, I use a short bash script that downloads a branch for me, and merges it with my current beta. This way, I never go back to an earlier version of sage and I avoid these problems.

About `sage -standard`: I added a commit at public/18456v2 that makes it work again, though without the version number.

I can add it to this ticket if you want.

Nathann



---

archive/issue_comments_254758.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@nathanncohen](#comment:7):\n> > You are right to be suspicious.  I was starting from 6.8.beta0, while I think that the branch branched off from 6.7 -- right?  That would explain the extra rebuilding.\n\n> \n> Yep, totally. If it can be of interest to you, I use a short bash script that downloads a branch for me, and merges it with my current beta. This way, I never go back to an earlier version of sage and I avoid these problems.\n> \n> About `sage -standard`: I added a commit at public/18456v2 that makes it work again, though without the version number.\n> \n> I can add it to this ticket if you want.\n\nWell, if it doesn't work as is then it cannot get a positive review anyway, so I have changed it to \"needs work\" and can try again after you have added what is needed to make it work!\n\n\n> \n> Nathann",
    "created_at": "2015-05-28T09:47:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254758",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@nathanncohen](#comment:7):
> > You are right to be suspicious.  I was starting from 6.8.beta0, while I think that the branch branched off from 6.7 -- right?  That would explain the extra rebuilding.

> 
> Yep, totally. If it can be of interest to you, I use a short bash script that downloads a branch for me, and merges it with my current beta. This way, I never go back to an earlier version of sage and I avoid these problems.
> 
> About `sage -standard`: I added a commit at public/18456v2 that makes it work again, though without the version number.
> 
> I can add it to this ticket if you want.

Well, if it doesn't work as is then it cannot get a positive review anyway, so I have changed it to "needs work" and can try again after you have added what is needed to make it work!


> 
> Nathann



---

archive/issue_events_262339.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2015-05-28T09:47:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262339"
}
```



---

archive/issue_events_262340.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2015-05-28T09:47:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262340"
}
```



---

archive/issue_comments_254759.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n> Well, if it doesn't work as is then it cannot get a positive review anyway, so I have changed it to \"needs work\" and can try again after you have added what is needed to make it work!\n\nYou got me wrong: it does not work in the latest beta either. None of the two work. And this ticket fixes one of the two.\n\nNathann",
    "created_at": "2015-05-28T09:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254759",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:9" align="right">comment:9</div>

> Well, if it doesn't work as is then it cannot get a positive review anyway, so I have changed it to "needs work" and can try again after you have added what is needed to make it work!

You got me wrong: it does not work in the latest beta either. None of the two work. And this ticket fixes one of the two.

Nathann



---

archive/issue_events_262341.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-05-28T09:58:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262341"
}
```



---

archive/issue_events_262342.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-05-28T09:58:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262342"
}
```



---

archive/issue_comments_254760.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAgain: if you want I can add this other commit. It makes 'sage -standard' call the functions I fix in this branch and display the list of packages (though without the version number).\n\nNathann",
    "created_at": "2015-05-28T10:08:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254760",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:11" align="right">comment:11</div>

Again: if you want I can add this other commit. It makes 'sage -standard' call the functions I fix in this branch and display the list of packages (though without the version number).

Nathann



---

archive/issue_comments_254761.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nSorry, I ran out of time on this and have to go to give an exam (and grade 257 scripts) now.  For whoever comes next to the ticket, you will have to explain better why something known not to work is still on \"needs review\" since I don't understand!",
    "created_at": "2015-05-28T12:18:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254761",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:12" align="right">comment:12</div>

Sorry, I ran out of time on this and have to go to give an exam (and grade 257 scripts) now.  For whoever comes next to the ticket, you will have to explain better why something known not to work is still on "needs review" since I don't understand!



---

archive/issue_comments_254762.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\n> For whoever comes next to the ticket, you will have to explain better why something known not to work is still on \"needs review\" since I don't understand!\n\nI do not know where you got the idea that this branch breaks anything. If you tell me what, I can surely explain. This branch fixes three functions, as advertised in the ticket's title.\n\nNathann",
    "created_at": "2015-05-28T12:25:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254762",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:13" align="right">comment:13</div>

> For whoever comes next to the ticket, you will have to explain better why something known not to work is still on "needs review" since I don't understand!

I do not know where you got the idea that this branch breaks anything. If you tell me what, I can surely explain. This branch fixes three functions, as advertised in the ticket's title.

Nathann



---

archive/issue_comments_254763.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nI believe we should fix `sage -standard` and similar on this ticket. I think what John is confused about is that this currently fixes the interactive Sage functions (i.e., run from within Sage), not those you run on the shell.\n\nI'm okay with the output on `public/18456v2`, but I'd feel more comfortable if someone more experienced with (Sage's) bash scripts (and those who might have an opinion on this) took a look at it before giving this a positive review.",
    "created_at": "2015-05-29T17:48:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254763",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:14" align="right">comment:14</div>

I believe we should fix `sage -standard` and similar on this ticket. I think what John is confused about is that this currently fixes the interactive Sage functions (i.e., run from within Sage), not those you run on the shell.

I'm okay with the output on `public/18456v2`, but I'd feel more comfortable if someone more experienced with (Sage's) bash scripts (and those who might have an opinion on this) took a look at it before giving this a positive review.



---

archive/issue_comments_254764.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@nathanncohen](#comment:5):\n> In order to fix `sage -standard`, it makes more sense to make it call a Sage function that does the job. \n\nI don't agree with this: ideally, `sage --standard`, `sage --optional`, etc., should work without building Sage, or with a partially built Sage.",
    "created_at": "2015-05-29T19:50:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254764",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@nathanncohen](#comment:5):
> In order to fix `sage -standard`, it makes more sense to make it call a Sage function that does the job. 

I don't agree with this: ideally, `sage --standard`, `sage --optional`, etc., should work without building Sage, or with a partially built Sage.



---

archive/issue_comments_254765.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nHello guys,\n\nI wrote this fix for `sage -standard` because that is what everybody seems attracted to, but really my goal here is only to fix `standard_packages` (and others) so that I can use them in #18408. And then, in turn, update #18405.\n\nRight now, everything is broken. And I personally prefer by far to have the `*_package` functions get ther info directly from the server than parse the output of a command-line tool as it is done at the moment.\n\nNathann",
    "created_at": "2015-05-29T22:40:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254765",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:16" align="right">comment:16</div>

Hello guys,

I wrote this fix for `sage -standard` because that is what everybody seems attracted to, but really my goal here is only to fix `standard_packages` (and others) so that I can use them in #18408. And then, in turn, update #18405.

Right now, everything is broken. And I personally prefer by far to have the `*_package` functions get ther info directly from the server than parse the output of a command-line tool as it is done at the moment.

Nathann



---

archive/issue_comments_254766.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nJust to make sure I understand: the original purpose of this ticket was to fix `standard_packages` (etc.), but not `sage --standard`, right? That's fine with me.\n\nFor ease of maintenance (and for cleanliness of code, which isn't quite as important), it would be best to not duplicate the work, so it would be best to have `standard_packages` rely on `sage --standard`, or vice versa. My strong preference is for `sage --standard` to *not* rely on `standard_packages`, since `sage --standard` should work without having built Sage.\n\nThat's my opinion, but I don't feel that strongly about the code duplication, so I personally won't object if this ticket only fixes `standard_packages` (etc.) by having it talk directly to the server. I *will* object if it also fixes `sage --standard` in such a way that it won't work right after unpacking a fresh tarball.\n\n(In my brief tests, by the way, this does fix the Sage functions as intended. But I haven't looked at the actual changes to see if they make sense.)",
    "created_at": "2015-05-29T23:20:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254766",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

Just to make sure I understand: the original purpose of this ticket was to fix `standard_packages` (etc.), but not `sage --standard`, right? That's fine with me.

For ease of maintenance (and for cleanliness of code, which isn't quite as important), it would be best to not duplicate the work, so it would be best to have `standard_packages` rely on `sage --standard`, or vice versa. My strong preference is for `sage --standard` to *not* rely on `standard_packages`, since `sage --standard` should work without having built Sage.

That's my opinion, but I don't feel that strongly about the code duplication, so I personally won't object if this ticket only fixes `standard_packages` (etc.) by having it talk directly to the server. I *will* object if it also fixes `sage --standard` in such a way that it won't work right after unpacking a fresh tarball.

(In my brief tests, by the way, this does fix the Sage functions as intended. But I haven't looked at the actual changes to see if they make sense.)



---

archive/issue_comments_254767.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nHello !\n\n> For ease of maintenance (and for cleanliness of code, which isn't quite as important), it would be best to not duplicate the work, so it would be best to have `standard_packages` rely on `sage --standard`, or vice versa.\n\n+1\n\n> My strong preference is for `sage --standard` to *not* rely on `standard_packages`, since `sage --standard` should work without having built Sage.\n\nThat's what I tried first, i.e. fix `sage --standard`. But then you have some problems, like undefined environment variables, and you must re-parse everything in `standard_packages` again.\n\nI thought a bit about making this script dependent on sage, and I actually ended up wondering whether .... we need those `sage -standard` scripts. Right now they are totally broken, and... Well, if we do not need them then perhaps we should stop maintaining them. They returned outdated information long before they broke.\n\n> (In my brief tests, by the way, this does fix the Sage functions as intended. But I haven't looked at the actual changes to see if they make sense.)\n\nI hope that they do `;-)`\n\nNathann",
    "created_at": "2015-05-30T06:30:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254767",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:18" align="right">comment:18</div>

Hello !

> For ease of maintenance (and for cleanliness of code, which isn't quite as important), it would be best to not duplicate the work, so it would be best to have `standard_packages` rely on `sage --standard`, or vice versa.

+1

> My strong preference is for `sage --standard` to *not* rely on `standard_packages`, since `sage --standard` should work without having built Sage.

That's what I tried first, i.e. fix `sage --standard`. But then you have some problems, like undefined environment variables, and you must re-parse everything in `standard_packages` again.

I thought a bit about making this script dependent on sage, and I actually ended up wondering whether .... we need those `sage -standard` scripts. Right now they are totally broken, and... Well, if we do not need them then perhaps we should stop maintaining them. They returned outdated information long before they broke.

> (In my brief tests, by the way, this does fix the Sage functions as intended. But I haven't looked at the actual changes to see if they make sense.)

I hope that they do `;-)`

Nathann



---

archive/issue_comments_254768.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nOkay. Third fix.\n\nThis one fixes the three functions AND the `sage -standard` commands (which do not need Sage to be compiled). The executable now has a 'dump' options so that there is not much parsing left to do on Sage's side when running that script to get some info.\n\nWhen it will be reviewed, I will be able to add a cool feature: automatic test of (installed) optional packages.\n\nNeeds review again,\n\nNathann",
    "created_at": "2015-05-31T07:58:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254768",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:19" align="right">comment:19</div>

Okay. Third fix.

This one fixes the three functions AND the `sage -standard` commands (which do not need Sage to be compiled). The executable now has a 'dump' options so that there is not much parsing left to do on Sage's side when running that script to get some info.

When it will be reviewed, I will be able to add a cool feature: automatic test of (installed) optional packages.

Needs review again,

Nathann



---

archive/issue_comments_254769.json:
```json
{
    "body": "Changed commit from **[39cc007](https://github.com/sagemath/sagetrac-mirror/commit/39cc007aaaf83a6ff0fbd99536c1561486fbfead)** to **[a3402c9](https://github.com/sagemath/sagetrac-mirror/commit/a3402c959a7d74ede7a58ae1d75b17faba0ac52d)**",
    "created_at": "2015-05-31T07:58:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254769",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[39cc007](https://github.com/sagemath/sagetrac-mirror/commit/39cc007aaaf83a6ff0fbd99536c1561486fbfead)** to **[a3402c9](https://github.com/sagemath/sagetrac-mirror/commit/a3402c959a7d74ede7a58ae1d75b17faba0ac52d)**



---

archive/issue_comments_254770.json:
```json
{
    "body": "<div id=\"comment:20\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/a3402c959a7d74ede7a58ae1d75b17faba0ac52d\">a3402c9</a></td><td><code>trac #18456: Re-Fix standard_packages(), optional_packages(), and experimental_packages()</code></td></tr></table>\n",
    "created_at": "2015-05-31T07:58:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254770",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:20"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/a3402c959a7d74ede7a58ae1d75b17faba0ac52d">a3402c9</a></td><td><code>trac #18456: Re-Fix standard_packages(), optional_packages(), and experimental_packages()</code></td></tr></table>




---

archive/issue_comments_254771.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\n> add a cool feature: automatic test of (installed) optional packages.\n\nDone at #18558\n\nNathann",
    "created_at": "2015-05-31T08:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254771",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:21" align="right">comment:21</div>

> add a cool feature: automatic test of (installed) optional packages.

Done at #18558

Nathann



---

archive/issue_comments_254772.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nWhat do you think about either of these changes?\n\n```diff\ndiff --git a/src/bin/sage-list-packages b/src/bin/sage-list-packages\nindex 5b17272..e1b0889 100755\n--- a/src/bin/sage-list-packages\n+++ b/src/bin/sage-list-packages\n@@ -16,7 +16,12 @@ SAGE_ROOT = os.environ[\"SAGE_ROOT\"]\n # Input parsing #\n #################\n \n-parser = argparse.ArgumentParser(description=\"List Sage's packages\")\n+parser = argparse.ArgumentParser(formatter_class=argparse.RawDescriptionHelpFormatter,\n+                                 description=\"\"\"List Sage's packages, by default in the format\n+\n+  {:.<30} {}\n+\n+\"\"\".format(\"package\", \"version on-line (version installed)\"))\n parser.add_argument('category', choices=['standard','optional','experimental', 'installed'], metavar=\"category\",\n                     help=\"The type of packages. Can be 'standard','optional','experimental' or 'installed'.\")\n parser.add_argument('--dump', dest='dump', default=False, action='store_true',\n@@ -76,6 +81,10 @@ if args['remote'] and args['category']!='installed':\n # OUTPUT #\n ##########\n \n+if not args['dump']:\n+    print(\"{:.<40} {}\".format(\"PACKAGE\", \"version on-line (version installed)\"))\n+    print(\"-\"*76)\n+\n # installed\n if args['category'] == 'installed':\n     if args['version']:\n```\nI ask because when I ran `sage --standard`, I wasn't sure what a line like\n\n```\nzeromq.................................. not found (4.0.5)\n```\nin the output meant.",
    "created_at": "2015-06-01T19:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254772",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:22" align="right">comment:22</div>

What do you think about either of these changes?

```diff
diff --git a/src/bin/sage-list-packages b/src/bin/sage-list-packages
index 5b17272..e1b0889 100755
--- a/src/bin/sage-list-packages
+++ b/src/bin/sage-list-packages
@@ -16,7 +16,12 @@ SAGE_ROOT = os.environ["SAGE_ROOT"]
 # Input parsing #
 #################
 
-parser = argparse.ArgumentParser(description="List Sage's packages")
+parser = argparse.ArgumentParser(formatter_class=argparse.RawDescriptionHelpFormatter,
+                                 description="""List Sage's packages, by default in the format
+
+  {:.<30} {}
+
+""".format("package", "version on-line (version installed)"))
 parser.add_argument('category', choices=['standard','optional','experimental', 'installed'], metavar="category",
                     help="The type of packages. Can be 'standard','optional','experimental' or 'installed'.")
 parser.add_argument('--dump', dest='dump', default=False, action='store_true',
@@ -76,6 +81,10 @@ if args['remote'] and args['category']!='installed':
 # OUTPUT #
 ##########
 
+if not args['dump']:
+    print("{:.<40} {}".format("PACKAGE", "version on-line (version installed)"))
+    print("-"*76)
+
 # installed
 if args['category'] == 'installed':
     if args['version']:
```
I ask because when I ran `sage --standard`, I wasn't sure what a line like

```
zeromq.................................. not found (4.0.5)
```
in the output meant.



---

archive/issue_comments_254773.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nThis change is more important.\n\n```diff\ndiff --git a/src/bin/sage-list-packages b/src/bin/sage-list-packages\nindex 5b17272..88cbaab 100755\n--- a/src/bin/sage-list-packages\n+++ b/src/bin/sage-list-packages\n@@ -46,12 +51,12 @@ installed = dict(pkgname_split(pkgname)\n                  for pkgname in os.listdir(SAGE_SPKG_INST))\n \n # new-style packages\n-local_non_filtered = os.listdir(SAGE_ROOT+\"/build/pkgs/\")\n+local_non_filtered = os.listdir(os.path.join(SAGE_ROOT, \"build\", \"pkgs\"))\n local = {}\n for p in local_non_filtered:\n-    with open(SAGE_ROOT+\"/build/pkgs/\"+p+\"/package-version.txt\") as f:\n+    with open(os.path.join(SAGE_ROOT, \"build\", \"pkgs\", p, \"package-version.txt\")) as f:\n         version = f.read().strip()\n-    with open(SAGE_ROOT+\"/build/pkgs/\"+p+\"/type\") as f:\n+    with open(os.path.join(SAGE_ROOT, \"build\", \"pkgs\", p, \"type\")) as f:\n         if f.read().strip() == args['category']:\n             local[p] = version\n \n```\nI can create a new branch with this change and either of the earlier ones if you want. Or you can do it.",
    "created_at": "2015-06-01T19:25:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254773",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

This change is more important.

```diff
diff --git a/src/bin/sage-list-packages b/src/bin/sage-list-packages
index 5b17272..88cbaab 100755
--- a/src/bin/sage-list-packages
+++ b/src/bin/sage-list-packages
@@ -46,12 +51,12 @@ installed = dict(pkgname_split(pkgname)
                  for pkgname in os.listdir(SAGE_SPKG_INST))
 
 # new-style packages
-local_non_filtered = os.listdir(SAGE_ROOT+"/build/pkgs/")
+local_non_filtered = os.listdir(os.path.join(SAGE_ROOT, "build", "pkgs"))
 local = {}
 for p in local_non_filtered:
-    with open(SAGE_ROOT+"/build/pkgs/"+p+"/package-version.txt") as f:
+    with open(os.path.join(SAGE_ROOT, "build", "pkgs", p, "package-version.txt")) as f:
         version = f.read().strip()
-    with open(SAGE_ROOT+"/build/pkgs/"+p+"/type") as f:
+    with open(os.path.join(SAGE_ROOT, "build", "pkgs", p, "type")) as f:
         if f.read().strip() == args['category']:
             local[p] = version
 
```
I can create a new branch with this change and either of the earlier ones if you want. Or you can do it.



---

archive/issue_comments_254774.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThere are no doctests for `_package_lists_from_sage_output(..., version=True)`, nor does the `OUTPUT` block explain the output in that case.\n\nFor `version=True`, I would actually propose to change the output format to a list of triples `(package_name, installed_version, latest_version)`, where `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version. If, for example, `arb-2.5.0` is installed but `arb-2.6.0` is availble, then one such triple would be\n\n```\n('arb', '2.5.0', '2.6.0')\n```\nIf `arb` is not installed:\n\n```\n('arb', None, '2.6.0')\n```\n\nSince this function would be quite different from `_package_lists_from_sage_output`, perhaps there should be two functions: `_package_lists_from_sage_output` and `_package_versions_from_sage_output` or something...",
    "created_at": "2015-06-02T07:14:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254774",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

There are no doctests for `_package_lists_from_sage_output(..., version=True)`, nor does the `OUTPUT` block explain the output in that case.

For `version=True`, I would actually propose to change the output format to a list of triples `(package_name, installed_version, latest_version)`, where `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version. If, for example, `arb-2.5.0` is installed but `arb-2.6.0` is availble, then one such triple would be

```
('arb', '2.5.0', '2.6.0')
```
If `arb` is not installed:

```
('arb', None, '2.6.0')
```

Since this function would be quite different from `_package_lists_from_sage_output`, perhaps there should be two functions: `_package_lists_from_sage_output` and `_package_versions_from_sage_output` or something...



---

archive/issue_events_262343.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-02T07:14:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262343"
}
```



---

archive/issue_events_262344.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-02T07:14:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262344"
}
```



---

archive/issue_comments_254775.json:
```json
{
    "body": "<div id=\"comment:25\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/687e4261edc550d7521d99bfef9839e401ef522e\">687e426</a></td><td><code>trac #18456: Column names</code></td></tr></table>\n",
    "created_at": "2015-06-02T09:11:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254775",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:25"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/687e4261edc550d7521d99bfef9839e401ef522e">687e426</a></td><td><code>trac #18456: Column names</code></td></tr></table>




---

archive/issue_comments_254776.json:
```json
{
    "body": "Changed commit from **[a3402c9](https://github.com/sagemath/sagetrac-mirror/commit/a3402c959a7d74ede7a58ae1d75b17faba0ac52d)** to **[687e426](https://github.com/sagemath/sagetrac-mirror/commit/687e4261edc550d7521d99bfef9839e401ef522e)**",
    "created_at": "2015-06-02T09:11:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254776",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[a3402c9](https://github.com/sagemath/sagetrac-mirror/commit/a3402c959a7d74ede7a58ae1d75b17faba0ac52d)** to **[687e426](https://github.com/sagemath/sagetrac-mirror/commit/687e4261edc550d7521d99bfef9839e401ef522e)**



---

archive/issue_comments_254777.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\n> What do you think about either of these changes?\n> ...\n> I ask because when I ran `sage --standard`, I wasn't sure what a line like\n> \n> ```\n> zeromq.................................. not found (4.0.5)\n> ```\n> in the output meant.\n\nI added a commit that displays column names when '--dump' is not used. The columns change a lot depending on which flags are used, and so this code is not exactly the one you proposed.\n\nNathann",
    "created_at": "2015-06-02T09:13:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254777",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:26" align="right">comment:26</div>

> What do you think about either of these changes?
> ...
> I ask because when I ran `sage --standard`, I wasn't sure what a line like
> 
> ```
> zeromq.................................. not found (4.0.5)
> ```
> in the output meant.

I added a commit that displays column names when '--dump' is not used. The columns change a lot depending on which flags are used, and so this code is not exactly the one you proposed.

Nathann



---

archive/issue_comments_254778.json:
```json
{
    "body": "Changed commit from **[687e426](https://github.com/sagemath/sagetrac-mirror/commit/687e4261edc550d7521d99bfef9839e401ef522e)** to **[d671f1b](https://github.com/sagemath/sagetrac-mirror/commit/d671f1ba7545507e710099a94cb1f07f5ba2047d)**",
    "created_at": "2015-06-02T09:16:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254778",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[687e426](https://github.com/sagemath/sagetrac-mirror/commit/687e4261edc550d7521d99bfef9839e401ef522e)** to **[d671f1b](https://github.com/sagemath/sagetrac-mirror/commit/d671f1ba7545507e710099a94cb1f07f5ba2047d)**



---

archive/issue_comments_254779.json:
```json
{
    "body": "<div id=\"comment:27\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d671f1ba7545507e710099a94cb1f07f5ba2047d\">d671f1b</a></td><td><code>trac #18456: don't use explicitly '/' in file paths</code></td></tr></table>\n",
    "created_at": "2015-06-02T09:16:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254779",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d671f1ba7545507e710099a94cb1f07f5ba2047d">d671f1b</a></td><td><code>trac #18456: don't use explicitly '/' in file paths</code></td></tr></table>




---

archive/issue_comments_254780.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n> This change is more important.\n\nRight. Done.\n\nNathann",
    "created_at": "2015-06-02T09:16:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254780",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:28" align="right">comment:28</div>

> This change is more important.

Right. Done.

Nathann



---

archive/issue_events_262345.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-02T09:31:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262345"
}
```



---

archive/issue_events_262346.json:
```json
{
    "actor": "https://github.com/nathanncohen",
    "created_at": "2015-06-02T09:31:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262346"
}
```



---

archive/issue_comments_254781.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n> There are no doctests for `_package_lists_from_sage_output(..., version=True)`, nor does the `OUTPUT` block explain the output in that case.\n\nFixed.\n\n> For `version=True`, I would actually propose to change the output format to a list of triples `(package_name, installed_version, latest_version)`, where `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version.\n\nI do not mind, you can open a ticket if you need this feature.\n\n> Since this function would be quite different from `_package_lists_from_sage_output`, perhaps there should be two functions: `_package_lists_from_sage_output` and `_package_versions_from_sage_output` or something...\n\nTwo private functions that do almost the same job? Let's keep things simple, one is enough.\n\nNathann",
    "created_at": "2015-06-02T09:31:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254781",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:29" align="right">comment:29</div>

> There are no doctests for `_package_lists_from_sage_output(..., version=True)`, nor does the `OUTPUT` block explain the output in that case.

Fixed.

> For `version=True`, I would actually propose to change the output format to a list of triples `(package_name, installed_version, latest_version)`, where `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version.

I do not mind, you can open a ticket if you need this feature.

> Since this function would be quite different from `_package_lists_from_sage_output`, perhaps there should be two functions: `_package_lists_from_sage_output` and `_package_versions_from_sage_output` or something...

Two private functions that do almost the same job? Let's keep things simple, one is enough.

Nathann



---

archive/issue_comments_254782.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@nathanncohen](#comment:29):\n> I do not mind, you can open a ticket if you need this feature.\n\nDone: #18581",
    "created_at": "2015-06-02T09:36:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254782",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@nathanncohen](#comment:29):
> I do not mind, you can open a ticket if you need this feature.

Done: #18581



---

archive/issue_comments_254783.json:
```json
{
    "body": "Changed commit from **[d671f1b](https://github.com/sagemath/sagetrac-mirror/commit/d671f1ba7545507e710099a94cb1f07f5ba2047d)** to **[9854749](https://github.com/sagemath/sagetrac-mirror/commit/985474957e3f7327e635c7aa13dbf70f510c727f)**",
    "created_at": "2015-06-02T10:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254783",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[d671f1b](https://github.com/sagemath/sagetrac-mirror/commit/d671f1ba7545507e710099a94cb1f07f5ba2047d)** to **[9854749](https://github.com/sagemath/sagetrac-mirror/commit/985474957e3f7327e635c7aa13dbf70f510c727f)**



---

archive/issue_comments_254784.json:
```json
{
    "body": "<div id=\"comment:31\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/985474957e3f7327e635c7aa13dbf70f510c727f\">9854749</a></td><td><code>trac #18456: doc and doctest</code></td></tr></table>\n",
    "created_at": "2015-06-02T10:35:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254784",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:31"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/985474957e3f7327e635c7aa13dbf70f510c727f">9854749</a></td><td><code>trac #18456: doc and doctest</code></td></tr></table>




---

archive/issue_comments_254785.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI get an error with the new doctest:\n\n```\nsage -t --long src/sage/misc/package.py\n**********************************************************************\nFile \"src/sage/misc/package.py\", line 244, in sage.misc.package._package_lists_from_sage_output\nFailed example:\n    type(x[1]) == str and '4.55' <= x[1]\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 496, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 858, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.misc.package._package_lists_from_sage_output[8]>\", line 1, in <module>\n        type(x[Integer(1)]) == str and '4.55' <= x[Integer(1)]\n    TypeError: 'sage.symbolic.expression.Expression' object does not support indexing\n**********************************************************************\n```\nThe problem is that `x` does not get set by the expression `any(x[0] ...)`. You could maybe use this instead:\n\n```diff\ndiff --git a/src/sage/misc/package.py b/src/sage/misc/package.py\nindex 12b556d..91ab594 100644\n--- a/src/sage/misc/package.py\n+++ b/src/sage/misc/package.py\n@@ -239,9 +239,7 @@ def _package_lists_from_sage_output(package_type,version=False,local=False):\n         sage: installed, not_installed = _package_lists_from_sage_output('standard',local=True,version=True)\n         sage: bool(not_installed)\n         False\n-        sage: any(x[0] == 'glpk' for x in installed)\n-        True\n-        sage: type(x[1]) == str and '4.55' <= x[1]\n+        sage: any(x[0] == 'glpk' and type(x[1]) == str and '4.55' <= x[1] for x in installed)\n         True\n     \"\"\"\n     if package_type not in ['standard','optional','experimental']:\n```",
    "created_at": "2015-06-02T20:05:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254785",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:32" align="right">comment:32</div>

I get an error with the new doctest:

```
sage -t --long src/sage/misc/package.py
**********************************************************************
File "src/sage/misc/package.py", line 244, in sage.misc.package._package_lists_from_sage_output
Failed example:
    type(x[1]) == str and '4.55' <= x[1]
Exception raised:
    Traceback (most recent call last):
      File "/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 496, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/jpalmier/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 858, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.misc.package._package_lists_from_sage_output[8]>", line 1, in <module>
        type(x[Integer(1)]) == str and '4.55' <= x[Integer(1)]
    TypeError: 'sage.symbolic.expression.Expression' object does not support indexing
**********************************************************************
```
The problem is that `x` does not get set by the expression `any(x[0] ...)`. You could maybe use this instead:

```diff
diff --git a/src/sage/misc/package.py b/src/sage/misc/package.py
index 12b556d..91ab594 100644
--- a/src/sage/misc/package.py
+++ b/src/sage/misc/package.py
@@ -239,9 +239,7 @@ def _package_lists_from_sage_output(package_type,version=False,local=False):
         sage: installed, not_installed = _package_lists_from_sage_output('standard',local=True,version=True)
         sage: bool(not_installed)
         False
-        sage: any(x[0] == 'glpk' for x in installed)
-        True
-        sage: type(x[1]) == str and '4.55' <= x[1]
+        sage: any(x[0] == 'glpk' and type(x[1]) == str and '4.55' <= x[1] for x in installed)
         True
     """
     if package_type not in ['standard','optional','experimental']:
```



---

archive/issue_comments_254786.json:
```json
{
    "body": "<div id=\"comment:33\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f\">b093007</a></td><td><code>trac #18456: doc and doctest</code></td></tr></table>\n",
    "created_at": "2015-06-02T20:37:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254786",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f">b093007</a></td><td><code>trac #18456: doc and doctest</code></td></tr></table>




---

archive/issue_comments_254787.json:
```json
{
    "body": "Changed commit from **[9854749](https://github.com/sagemath/sagetrac-mirror/commit/985474957e3f7327e635c7aa13dbf70f510c727f)** to **[b093007](https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f)**",
    "created_at": "2015-06-02T20:37:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254787",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9854749](https://github.com/sagemath/sagetrac-mirror/commit/985474957e3f7327e635c7aa13dbf70f510c727f)** to **[b093007](https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f)**



---

archive/issue_comments_254788.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\n> I get an error with the new doctest:\n\nRightrightright, thanks! I updated the latest commit.\n\nNathann",
    "created_at": "2015-06-02T20:37:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254788",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:34" align="right">comment:34</div>

> I get an error with the new doctest:

Rightrightright, thanks! I updated the latest commit.

Nathann



---

archive/issue_comments_254789.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nThis looks good to me. Anyone else have any issues, or can we set it to positive review?",
    "created_at": "2015-06-03T18:40:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254789",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">comment:35</div>

This looks good to me. Anyone else have any issues, or can we set it to positive review?



---

archive/issue_events_262347.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-03T18:41:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262347"
}
```



---

archive/issue_events_262348.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-03T18:41:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262348"
}
```



---

archive/issue_comments_254790.json:
```json
{
    "body": "Reviewer: **John Palmieri**",
    "created_at": "2015-06-03T18:41:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254790",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **John Palmieri**



---

archive/issue_events_262349.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-03T23:22:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262349"
}
```



---

archive/issue_events_262350.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "fecd62785108defab23a3a5770aec3fcfe68c05b",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-03T23:22:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18456#event-262350"
}
```



---

archive/issue_comments_254791.json:
```json
{
    "body": "Changed branch from **[u/ncohen/18456](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/18456)** to **[b093007](https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f)**",
    "created_at": "2015-06-03T23:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18456",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18456#issuecomment-254791",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/ncohen/18456](https://github.com/sagemath/sagetrac-mirror/tree/u/ncohen/18456)** to **[b093007](https://github.com/sagemath/sagetrac-mirror/commit/b09300783d2dffe3b3fa6f4f643861909457e34f)**
