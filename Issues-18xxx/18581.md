# Issue 18581: _package_lists_from_sage_output() should output installed and available versions

archive/issues_018344.json:
```json
{
    "assignees": [],
    "body": "Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed.\n\nI propose to define a new function `package_versions(local=False)` which returns a dictionary with key:value pairs of the form\n\n```\npackage_name: (installed_version, latest_version)\n```\nwhere `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version.\n\nIf, for example, arb-2.5.0 is installed but arb-2.6.0 is availble, then one such key:value pair would be\n\n```\n'arb': ('2.5.0', '2.6.0')\n```\n\nIf arb is not installed, this would be:\n\n```\n'arb': (None, '2.6.0')\n```\n\nDepends on #18456\n\nCC:  @nathanncohen\n\nBranch/Commit: **[262ba16](https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93)**\n\nReviewer: **Jeroen Demeyer**\n\nAuthor: **John Palmieri**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/18581_\n\n",
    "closed_at": "2015-06-08T20:28:46Z",
    "created_at": "2015-06-02T09:34:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "_package_lists_from_sage_output() should output installed and available versions",
    "type": "issue",
    "updated_at": "2015-06-08T20:28:46Z",
    "url": "https://github.com/sagemath/sage/issues/18581",
    "user": "https://github.com/jdemeyer"
}
```
Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed.

I propose to define a new function `package_versions(local=False)` which returns a dictionary with key:value pairs of the form

```
package_name: (installed_version, latest_version)
```
where `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version.

If, for example, arb-2.5.0 is installed but arb-2.6.0 is availble, then one such key:value pair would be

```
'arb': ('2.5.0', '2.6.0')
```

If arb is not installed, this would be:

```
'arb': (None, '2.6.0')
```

Depends on #18456

CC:  @nathanncohen

Branch/Commit: **[262ba16](https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93)**

Reviewer: **Jeroen Demeyer**

Author: **John Palmieri**

_Issue created by migration from https://trac.sagemath.org/ticket/18581_





---

archive/issue_events_246384.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-02T09:34:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246384"
}
```



---

archive/issue_events_246385.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-02T09:34:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246385"
}
```



---

archive/issue_events_246386.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-02T09:34:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246386"
}
```



---

archive/issue_comments_260721.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Currently, the function `standard_packages()` only gives the latest available version of a package, not the version which is installed. I propose to actually return a list of triples\n+Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed. I propose to actually return a list of triples\n \n ```\n (package_name, installed_version, latest_version)\n``````\n",
    "created_at": "2015-06-02T09:36:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260721",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Currently, the function `standard_packages()` only gives the latest available version of a package, not the version which is installed. I propose to actually return a list of triples
+Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed. I propose to actually return a list of triples
 
 ```
 (package_name, installed_version, latest_version)
``````




---

archive/issue_events_246387.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-02T09:37:07Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "title_is": "_package_lists_from_sage_output() should output installed and available versions",
    "title_was": "standard_packages()... should output installed and available versions",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246387"
}
```



---

archive/issue_comments_260722.json:
```json
{
    "body": "Branch: **[u/jhpalmieri/versions](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/versions)**",
    "created_at": "2015-06-03T20:29:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260722",
    "user": "https://github.com/jhpalmieri"
}
```

Branch: **[u/jhpalmieri/versions](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/versions)**



---

archive/issue_events_246388.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-03T20:31:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246388"
}
```



---

archive/issue_comments_260723.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThe actual change is\n\n```diff\ndiff --git a/src/sage/misc/package.py b/src/sage/misc/package.py\nindex 91ab594..6a9f33d 100644\n--- a/src/sage/misc/package.py\n+++ b/src/sage/misc/package.py\n@@ -216,9 +216,13 @@ def _package_lists_from_sage_output(package_type,version=False,local=False):\n     When ``version=False``, the function returns a pair of list\n     ``(installed,not_installed)`` with the corresponding packages' name.\n \n-    When ``version=True``, the elements of each list are not package names but\n-    pairs ``(package_name,package_version)`` where ``version`` is a string\n-    representing the version of each package that is installed.\n+    When ``version=True``, the elements of each list are not package\n+    names but either pairs ``(package_name, installed_version)`` or\n+    triples ``(package_name, latest_version, installed_version)``,\n+    depending on whether ``local`` is ``True`` or ``False``. Here,\n+    ``latest_version`` is a string representing the version of the\n+    package available on the Sage package server, while\n+    ``installed_version`` is the version that is actually installed.\n \n     EXAMPLE::\n \n@@ -257,11 +261,10 @@ def _package_lists_from_sage_output(package_type,version=False,local=False):\n     if version:\n         for line in X:\n             line = line.split(' ')\n-            name,version = line[0],line[1]\n-            if is_package_installed(name):\n-                installed.append((name,version))\n+            if is_package_installed(line[0]):\n+                installed.append(tuple(line))\n             else:\n-                not_installed.append((name,version))\n+                not_installed.append(tuple(line))\n     else:\n         for name in X:\n             if is_package_installed(name):\n```\nalthough the branch includes all of the changes from #18456.",
    "created_at": "2015-06-03T20:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260723",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:4" align="right">Comment 4</div>

The actual change is

```diff
diff --git a/src/sage/misc/package.py b/src/sage/misc/package.py
index 91ab594..6a9f33d 100644
--- a/src/sage/misc/package.py
+++ b/src/sage/misc/package.py
@@ -216,9 +216,13 @@ def _package_lists_from_sage_output(package_type,version=False,local=False):
     When ``version=False``, the function returns a pair of list
     ``(installed,not_installed)`` with the corresponding packages' name.
 
-    When ``version=True``, the elements of each list are not package names but
-    pairs ``(package_name,package_version)`` where ``version`` is a string
-    representing the version of each package that is installed.
+    When ``version=True``, the elements of each list are not package
+    names but either pairs ``(package_name, installed_version)`` or
+    triples ``(package_name, latest_version, installed_version)``,
+    depending on whether ``local`` is ``True`` or ``False``. Here,
+    ``latest_version`` is a string representing the version of the
+    package available on the Sage package server, while
+    ``installed_version`` is the version that is actually installed.
 
     EXAMPLE::
 
@@ -257,11 +261,10 @@ def _package_lists_from_sage_output(package_type,version=False,local=False):
     if version:
         for line in X:
             line = line.split(' ')
-            name,version = line[0],line[1]
-            if is_package_installed(name):
-                installed.append((name,version))
+            if is_package_installed(line[0]):
+                installed.append(tuple(line))
             else:
-                not_installed.append((name,version))
+                not_installed.append(tuple(line))
     else:
         for name in X:
             if is_package_installed(name):
```
although the branch includes all of the changes from #18456.



---

archive/issue_comments_260724.json:
```json
{
    "body": "Commit: **[17bc8fa](https://github.com/sagemath/sagetrac-mirror/commit/17bc8fad32020a978d940694edba35b46e81389f)**",
    "created_at": "2015-06-03T20:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260724",
    "user": "https://github.com/jhpalmieri"
}
```

Commit: **[17bc8fa](https://github.com/sagemath/sagetrac-mirror/commit/17bc8fad32020a978d940694edba35b46e81389f)**



---

archive/issue_comments_260725.json:
```json
{
    "body": "Author: **John Palmieri**",
    "created_at": "2015-06-03T20:31:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260725",
    "user": "https://github.com/jhpalmieri"
}
```

Author: **John Palmieri**



---

archive/issue_comments_260726.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,18 +1,20 @@\n-Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed. I propose to actually return a list of triples\n+Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed.\n+\n+I propose to define a new function `package_versions(local=False)` which returns a dictionary with key:value pairs of the form\n \n ```\n-(package_name, installed_version, latest_version)\n+package_name: (installed_version, latest_version)\n ```\n where `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version.\n \n-If, for example, arb-2.5.0 is installed but arb-2.6.0 is availble, then one such triple would be\n+If, for example, arb-2.5.0 is installed but arb-2.6.0 is availble, then one such key:value pair would be\n \n ```\n-('arb', '2.5.0', '2.6.0')\n+'arb': ('2.5.0', '2.6.0')\n ```\n \n If arb is not installed, this would be:\n \n ```\n-('arb', None, '2.6.0')\n+'arb': (None, '2.6.0')\n ```\n``````\n",
    "created_at": "2015-06-04T06:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260726",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,18 +1,20 @@
-Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed. I propose to actually return a list of triples
+Currently, the function `_package_lists_from_sage_output` only gives the latest available version of a package, not the version which is installed.
+
+I propose to define a new function `package_versions(local=False)` which returns a dictionary with key:value pairs of the form
 
 ```
-(package_name, installed_version, latest_version)
+package_name: (installed_version, latest_version)
 ```
 where `installed_version` is `None` if the package is not installed and `latest_version` is the newest available version.
 
-If, for example, arb-2.5.0 is installed but arb-2.6.0 is availble, then one such triple would be
+If, for example, arb-2.5.0 is installed but arb-2.6.0 is availble, then one such key:value pair would be
 
 ```
-('arb', '2.5.0', '2.6.0')
+'arb': ('2.5.0', '2.6.0')
 ```
 
 If arb is not installed, this would be:
 
 ```
-('arb', None, '2.6.0')
+'arb': (None, '2.6.0')
 ```
``````




---

archive/issue_events_246389.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-04T06:07:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246389"
}
```



---

archive/issue_events_246390.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-04T06:07:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246390"
}
```



---

archive/issue_comments_260727.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI don't want a **tuple** of lists of tuples, that's just too complicated. I meant just one list of tuples.\n\nActually thinking a bit more about this, a dictionary makes more sense: the keys are the package names and the values are tuples `(installed_version, latest_version)`.\n\nAnd I certainly want the output format to be the same for `local=True` and `local=False`.\n\nI also propose to make this a separate function `package_versions()` to avoid the many `if version` branches you will need. And then implement the old `_package_lists_from_sage_output()` as a very short function using this new `package_versions()` function.",
    "created_at": "2015-06-04T06:07:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260727",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:5" align="right">Comment 5</div>

I don't want a **tuple** of lists of tuples, that's just too complicated. I meant just one list of tuples.

Actually thinking a bit more about this, a dictionary makes more sense: the keys are the package names and the values are tuples `(installed_version, latest_version)`.

And I certainly want the output format to be the same for `local=True` and `local=False`.

I also propose to make this a separate function `package_versions()` to avoid the many `if version` branches you will need. And then implement the old `_package_lists_from_sage_output()` as a very short function using this new `package_versions()` function.



---

archive/issue_comments_260728.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nNote: everything I said in the last comment should be treated as a suggestion, not a demand.\n\nExcept for the fact that the output for `local=True` should also include the latest available version, that's really important for #18558.",
    "created_at": "2015-06-04T06:23:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260728",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">Comment 6</div>

Note: everything I said in the last comment should be treated as a suggestion, not a demand.

Except for the fact that the output for `local=True` should also include the latest available version, that's really important for #18558.



---

archive/issue_comments_260729.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nReplying to [@jdemeyer](#comment%3A6):\n> Note: everything I said in the last comment should be treated as a suggestion, not a demand.\n> \n> Except for the fact that the output for `local=True` should also include the latest available version, that's really important for #18558.\n\nThen I don't understand what you want. With `local=True`, you don't use the internet, but to find the latest available version, you need the internet. So I'm puzzled.\n\nRegarding your previous comment, if we implement `package_versions()`, then do you care much what sort of output `_package_lists_from_sage_output` produces? Should I just revert it back to the output it had in #18456?",
    "created_at": "2015-06-04T15:49:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260729",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:7" align="right">Comment 7</div>

Replying to [@jdemeyer](#comment%3A6):
> Note: everything I said in the last comment should be treated as a suggestion, not a demand.
> 
> Except for the fact that the output for `local=True` should also include the latest available version, that's really important for #18558.

Then I don't understand what you want. With `local=True`, you don't use the internet, but to find the latest available version, you need the internet. So I'm puzzled.

Regarding your previous comment, if we implement `package_versions()`, then do you care much what sort of output `_package_lists_from_sage_output` produces? Should I just revert it back to the output it had in #18456?



---

archive/issue_comments_260730.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nReplying to [@jhpalmieri](#comment%3A7):\n> Then I don't understand what you want. With `local=True`, you don't use the internet, but to find the latest available version, you need the internet. So I'm puzzled.\n\nOr at least, that's how \"latest available version\" is defined in the earlier versions. Do you just want to read the data from `build/pkgs/benzene/package_version.txt`, etc.? What do you do with old style packages?",
    "created_at": "2015-06-04T15:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260730",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:8" align="right">Comment 8</div>

Replying to [@jhpalmieri](#comment%3A7):
> Then I don't understand what you want. With `local=True`, you don't use the internet, but to find the latest available version, you need the internet. So I'm puzzled.

Or at least, that's how "latest available version" is defined in the earlier versions. Do you just want to read the data from `build/pkgs/benzene/package_version.txt`, etc.? What do you do with old style packages?



---

archive/issue_comments_260731.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nReplying to [@jhpalmieri](#comment%3A7):\n> Then I don't understand what you want. With `local=True`, you don't use the internet, but to find the latest available version, you need the internet. So I'm puzzled.\n\nYou're right, I was only thinking about new-style packages. I propose the following:\n- for new-style packages, read the latest available version from `buikd/pkgs/foo/package_version.txt`\n- for old-style packages with `local=True`, use `None` as latest available version.",
    "created_at": "2015-06-04T16:23:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260731",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">Comment 9</div>

Replying to [@jhpalmieri](#comment%3A7):
> Then I don't understand what you want. With `local=True`, you don't use the internet, but to find the latest available version, you need the internet. So I'm puzzled.

You're right, I was only thinking about new-style packages. I propose the following:
- for new-style packages, read the latest available version from `buikd/pkgs/foo/package_version.txt`
- for old-style packages with `local=True`, use `None` as latest available version.



---

archive/issue_comments_260732.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@jhpalmieri](#comment%3A7):\n> Regarding your previous comment, if we implement `package_versions()`, then do you care much what sort of output `_package_lists_from_sage_output` produces?\n\nIf we do implement `package_versions()`, then `_package_lists_from_sage_output` shouldn't have a `version` argument.",
    "created_at": "2015-06-04T16:24:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260732",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@jhpalmieri](#comment%3A7):
> Regarding your previous comment, if we implement `package_versions()`, then do you care much what sort of output `_package_lists_from_sage_output` produces?

If we do implement `package_versions()`, then `_package_lists_from_sage_output` shouldn't have a `version` argument.



---

archive/issue_comments_260733.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nOkay, then should we rewrite `sage --standard` (etc.) to just read data from `build/pkgs/.../package_version.txt`? I think you're saying this:\n\n- if `local` is True, just read `package_version.txt` information. For old-style packages, we don't even know about them in that case.\n- if `local` is False, still use `package_version.txt` for new-style packages. For old-style packages, check the servers.\n\nThat sounds okay to me.",
    "created_at": "2015-06-04T16:58:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260733",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:11" align="right">Comment 11</div>

Okay, then should we rewrite `sage --standard` (etc.) to just read data from `build/pkgs/.../package_version.txt`? I think you're saying this:

- if `local` is True, just read `package_version.txt` information. For old-style packages, we don't even know about them in that case.
- if `local` is False, still use `package_version.txt` for new-style packages. For old-style packages, check the servers.

That sounds okay to me.



---

archive/issue_comments_260734.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nI suppose to make this work well, when a package is installed, we should record its type in its record in `local/var/lib/sage/installed`. I'm not sure I want to bother with that. As it is, if someone installs an old-style package, we don't know what type it is without checking the servers (and the servers are not 100% accurate: e.g., `zeromq` is listed as both standard and optional on the servers).\n\nCurrently, `sage --optional` (etc.) ignores the files in `var/lib/sage/installed` when compiling a list of packages to print: it only checks `build/pkgs` and the servers. (It does check those files to see what version of a package was installed.) I'm not sure of a better way to proceed, especially if `local` is True.",
    "created_at": "2015-06-04T17:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260734",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:12" align="right">Comment 12</div>

I suppose to make this work well, when a package is installed, we should record its type in its record in `local/var/lib/sage/installed`. I'm not sure I want to bother with that. As it is, if someone installs an old-style package, we don't know what type it is without checking the servers (and the servers are not 100% accurate: e.g., `zeromq` is listed as both standard and optional on the servers).

Currently, `sage --optional` (etc.) ignores the files in `var/lib/sage/installed` when compiling a list of packages to print: it only checks `build/pkgs` and the servers. (It does check those files to see what version of a package was installed.) I'm not sure of a better way to proceed, especially if `local` is True.



---

archive/issue_comments_260735.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nReplying to [@jhpalmieri](#comment%3A11):\n> Okay, then should we rewrite `sage --standard` (etc.) to just read data from `build/pkgs/.../package_version.txt`?\n\nI don't know, really. What would you find easier, changing `sage --standard` or changing the Sage library code? Nathann, do you have an opinion on this?\n\n> I think you're saying this:\n> \n> - if `local` is True, just read `package_version.txt` information. For old-style packages, we don't even know about them in that case.\n> - if `local` is False, still use `package_version.txt` for new-style packages. For old-style packages, check the servers.\n\nYes, indeed.",
    "created_at": "2015-06-04T17:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260735",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">Comment 13</div>

Replying to [@jhpalmieri](#comment%3A11):
> Okay, then should we rewrite `sage --standard` (etc.) to just read data from `build/pkgs/.../package_version.txt`?

I don't know, really. What would you find easier, changing `sage --standard` or changing the Sage library code? Nathann, do you have an opinion on this?

> I think you're saying this:
> 
> - if `local` is True, just read `package_version.txt` information. For old-style packages, we don't even know about them in that case.
> - if `local` is False, still use `package_version.txt` for new-style packages. For old-style packages, check the servers.

Yes, indeed.



---

archive/issue_comments_260736.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@jhpalmieri](#comment%3A12):\n> I suppose to make this work well, when a package is installed, we should record its type in its record in `local/var/lib/sage/installed`.\n\nI don't see why we need to change that. I think the current way of determining packages is good enough, especially since we're having fewer and fewer old-style packages. So, I would focus on getting new-style package right.",
    "created_at": "2015-06-04T18:00:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260736",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@jhpalmieri](#comment%3A12):
> I suppose to make this work well, when a package is installed, we should record its type in its record in `local/var/lib/sage/installed`.

I don't see why we need to change that. I think the current way of determining packages is good enough, especially since we're having fewer and fewer old-style packages. So, I would focus on getting new-style package right.



---

archive/issue_comments_260737.json:
```json
{
    "body": "Changed commit from **[17bc8fa](https://github.com/sagemath/sagetrac-mirror/commit/17bc8fad32020a978d940694edba35b46e81389f)** to **[e9f2500](https://github.com/sagemath/sagetrac-mirror/commit/e9f25000c4427703a4ed53fbf68cabb9a36818c0)**",
    "created_at": "2015-06-04T19:18:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260737",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[17bc8fa](https://github.com/sagemath/sagetrac-mirror/commit/17bc8fad32020a978d940694edba35b46e81389f)** to **[e9f2500](https://github.com/sagemath/sagetrac-mirror/commit/e9f25000c4427703a4ed53fbf68cabb9a36818c0)**



---

archive/issue_comments_260738.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/e9f25000c4427703a4ed53fbf68cabb9a36818c0\">e9f2500</a></td><td><code>trac 18581: new function package_versions</code></td></tr></table>\n",
    "created_at": "2015-06-04T19:18:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260738",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15" align="right">Comment 15</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/e9f25000c4427703a4ed53fbf68cabb9a36818c0">e9f2500</a></td><td><code>trac 18581: new function package_versions</code></td></tr></table>




---

archive/issue_events_246391.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-04T19:18:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246391"
}
```



---

archive/issue_events_246392.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-04T19:18:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246392"
}
```



---

archive/issue_comments_260739.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nIt's pretty easy to change `sage --standard`: all of the information is there, it's just a matter of how things are printed out. I might even consider the old way a bug. Here's a new version.",
    "created_at": "2015-06-04T19:18:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260739",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">Comment 16</div>

It's pretty easy to change `sage --standard`: all of the information is there, it's just a matter of how things are printed out. I might even consider the old way a bug. Here's a new version.



---

archive/issue_events_246393.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-04T22:04:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246393"
}
```



---

archive/issue_events_246394.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-04T22:04:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246394"
}
```



---

archive/issue_comments_260740.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nCan you replace the string `\"not_installed\"` in `package_versions()` by `None`? It's just because checking `x == \"not_installed\"` is a lot stranger and harder to remember than checking `x is None`.",
    "created_at": "2015-06-04T22:04:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260740",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:17" align="right">Comment 17</div>

Can you replace the string `"not_installed"` in `package_versions()` by `None`? It's just because checking `x == "not_installed"` is a lot stranger and harder to remember than checking `x is None`.



---

archive/issue_comments_260741.json:
```json
{
    "body": "Changed commit from **[e9f2500](https://github.com/sagemath/sagetrac-mirror/commit/e9f25000c4427703a4ed53fbf68cabb9a36818c0)** to **[9178afc](https://github.com/sagemath/sagetrac-mirror/commit/9178afcfa4e2b9288aa862dcfd84bc77b33ecabc)**",
    "created_at": "2015-06-04T22:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260741",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[e9f2500](https://github.com/sagemath/sagetrac-mirror/commit/e9f25000c4427703a4ed53fbf68cabb9a36818c0)** to **[9178afc](https://github.com/sagemath/sagetrac-mirror/commit/9178afcfa4e2b9288aa862dcfd84bc77b33ecabc)**



---

archive/issue_comments_260742.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/9178afcfa4e2b9288aa862dcfd84bc77b33ecabc\">9178afc</a></td><td><code>trac 18581: return None rather than 'not_installed' for version of uninstalled packages</code></td></tr></table>\n",
    "created_at": "2015-06-04T22:13:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260742",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:18" align="right">Comment 18</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/9178afcfa4e2b9288aa862dcfd84bc77b33ecabc">9178afc</a></td><td><code>trac 18581: return None rather than 'not_installed' for version of uninstalled packages</code></td></tr></table>




---

archive/issue_comments_260743.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nOkay.",
    "created_at": "2015-06-04T22:14:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260743",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:19" align="right">Comment 19</div>

Okay.



---

archive/issue_events_246395.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-04T22:14:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246395"
}
```



---

archive/issue_events_246396.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-04T22:14:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246396"
}
```



---

archive/issue_events_246397.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-05T14:04:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246397"
}
```



---

archive/issue_events_246398.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-05T14:04:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246398"
}
```



---

archive/issue_comments_260744.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nDoesn't this need to be changed also?\n\n```\nif versions[p][0] != 'not_installed'\n```",
    "created_at": "2015-06-05T14:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260744",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">Comment 20</div>

Doesn't this need to be changed also?

```
if versions[p][0] != 'not_installed'
```



---

archive/issue_comments_260745.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nFor `is_package_installed()`, can you add as doctest\n\n```\nsage: is_package_installed('pari')\nTrue\n```\njust because `sage` is special (it doesn't have a version number)",
    "created_at": "2015-06-05T14:07:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260745",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">Comment 21</div>

For `is_package_installed()`, can you add as doctest

```
sage: is_package_installed('pari')
True
```
just because `sage` is special (it doesn't have a version number)



---

archive/issue_comments_260746.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nInstead of running `sage --{} --dump` (with `{} == \"standard\"` for example), why don't you directly run\n\n```\nsage-list-packages {} --dump\n```\n(this is significantly faster since it avoids all the shell script overhead like `sage-env`)",
    "created_at": "2015-06-05T14:09:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260746",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">Comment 22</div>

Instead of running `sage --{} --dump` (with `{} == "standard"` for example), why don't you directly run

```
sage-list-packages {} --dump
```
(this is significantly faster since it avoids all the shell script overhead like `sage-env`)



---

archive/issue_comments_260747.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nInstead of this strange test\n\n```\nstd['glpk'][0] >= '4.55'\n```\ncouldn't you just show the actual result of something like\n\n```\nstd['zn_poly']\n```\n(a package which hasn't been updated in a long time in Sage and whose upstream is dead, so changes in the version number are unlikely)",
    "created_at": "2015-06-05T14:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260747",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">Comment 23</div>

Instead of this strange test

```
std['glpk'][0] >= '4.55'
```
couldn't you just show the actual result of something like

```
std['zn_poly']
```
(a package which hasn't been updated in a long time in Sage and whose upstream is dead, so changes in the version number are unlikely)



---

archive/issue_comments_260748.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nI would also like to see `package_versions()` added to `sage.misc.all`",
    "created_at": "2015-06-05T14:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260748",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">Comment 24</div>

I would also like to see `package_versions()` added to `sage.misc.all`



---

archive/issue_comments_260749.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nThis sentence is missing a final period: <code>If \\`\\`local\\`\\` is False, then Sage's servers are queried for package information</code>",
    "created_at": "2015-06-05T14:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260749",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">Comment 25</div>

This sentence is missing a final period: <code>If \`\`local\`\` is False, then Sage's servers are queried for package information</code>



---

archive/issue_comments_260750.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nIs there a reason why\n\n```\n./sage --optional --local\n```\ndoes *not* contain the lastest available version? (with `--dump`, it does)",
    "created_at": "2015-06-05T15:02:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260750",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">Comment 26</div>

Is there a reason why

```
./sage --optional --local
```
does *not* contain the lastest available version? (with `--dump`, it does)



---

archive/issue_comments_260751.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">Comment 27</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/24c0d0b008a482a3ca1d9fc42e10cd30a06436ff\">24c0d0b</a></td><td><code>trac 18581: responses to referee's comments</code></td></tr></table>\n",
    "created_at": "2015-06-05T15:36:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260751",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:27" align="right">Comment 27</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/24c0d0b008a482a3ca1d9fc42e10cd30a06436ff">24c0d0b</a></td><td><code>trac 18581: responses to referee's comments</code></td></tr></table>




---

archive/issue_comments_260752.json:
```json
{
    "body": "Changed commit from **[9178afc](https://github.com/sagemath/sagetrac-mirror/commit/9178afcfa4e2b9288aa862dcfd84bc77b33ecabc)** to **[24c0d0b](https://github.com/sagemath/sagetrac-mirror/commit/24c0d0b008a482a3ca1d9fc42e10cd30a06436ff)**",
    "created_at": "2015-06-05T15:36:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260752",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[9178afc](https://github.com/sagemath/sagetrac-mirror/commit/9178afcfa4e2b9288aa862dcfd84bc77b33ecabc)** to **[24c0d0b](https://github.com/sagemath/sagetrac-mirror/commit/24c0d0b008a482a3ca1d9fc42e10cd30a06436ff)**



---

archive/issue_comments_260753.json:
```json
{
    "body": "Changed commit from **[24c0d0b](https://github.com/sagemath/sagetrac-mirror/commit/24c0d0b008a482a3ca1d9fc42e10cd30a06436ff)** to **[caa8301](https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717)**",
    "created_at": "2015-06-05T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260753",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[24c0d0b](https://github.com/sagemath/sagetrac-mirror/commit/24c0d0b008a482a3ca1d9fc42e10cd30a06436ff)** to **[caa8301](https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717)**



---

archive/issue_comments_260754.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">Comment 28</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717\">caa8301</a></td><td><code>trac 18581: fix for 'sage --optional --local'</code></td></tr></table>\n",
    "created_at": "2015-06-05T15:40:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260754",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:28" align="right">Comment 28</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717">caa8301</a></td><td><code>trac 18581: fix for 'sage --optional --local'</code></td></tr></table>




---

archive/issue_comments_260755.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nThe `zn_poly` doctest makes me a little nervous, in case the version does change, but I added a note to SPKG.txt about it, just in case.\n\nReplying to [@jdemeyer](#comment%3A26):\n> Is there a reason why\n> \n> ```\n> ./sage --optional --local\n> ```\n> does *not* contain the lastest available version? (with `--dump`, it does)\n\nSorry, I missed that case in my changes to `sage-list-packages`.",
    "created_at": "2015-06-05T15:40:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260755",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:29" align="right">Comment 29</div>

The `zn_poly` doctest makes me a little nervous, in case the version does change, but I added a note to SPKG.txt about it, just in case.

Replying to [@jdemeyer](#comment%3A26):
> Is there a reason why
> 
> ```
> ./sage --optional --local
> ```
> does *not* contain the lastest available version? (with `--dump`, it does)

Sorry, I missed that case in my changes to `sage-list-packages`.



---

archive/issue_events_246399.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-05T15:41:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246399"
}
```



---

archive/issue_events_246400.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-05T15:41:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246400"
}
```



---

archive/issue_events_246401.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-06T08:50:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246401"
}
```



---

archive/issue_events_246402.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-06T08:50:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246402"
}
```



---

archive/issue_comments_260756.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nReplying to [@sagetrac-git](#comment%3A28):\n> Branch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717\">caa8301</a></td><td><code>trac 18581: fix for 'sage --optional --local'</code></td></tr></table>\n\nYou also need to fix the header:\n\n```\njdemeyer@tamiyo:/usr/local/src/sage-git$ ./sage --optional --local\n[package] .............................. [installed version]\n4ti2.................................... 1.6.5 (1.6.5)\narb..................................... 2.5.0 (2.6.0)\nautotools............................... 20141105 (not_installed)\nbenzene................................. 20130630 (not_installed)\nbliss................................... 0.72.p1 (not_installed)\n[...]\n```",
    "created_at": "2015-06-06T08:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260756",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">Comment 31</div>

Replying to [@sagetrac-git](#comment%3A28):
> Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717">caa8301</a></td><td><code>trac 18581: fix for 'sage --optional --local'</code></td></tr></table>

You also need to fix the header:

```
jdemeyer@tamiyo:/usr/local/src/sage-git$ ./sage --optional --local
[package] .............................. [installed version]
4ti2.................................... 1.6.5 (1.6.5)
arb..................................... 2.5.0 (2.6.0)
autotools............................... 20141105 (not_installed)
benzene................................. 20130630 (not_installed)
bliss................................... 0.72.p1 (not_installed)
[...]
```



---

archive/issue_comments_260757.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2015-06-06T08:50:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260757",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_comments_260758.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">Comment 32</div>\n\nNathann, do you have any comments about this ticket?",
    "created_at": "2015-06-06T08:51:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260758",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">Comment 32</div>

Nathann, do you have any comments about this ticket?



---

archive/issue_comments_260759.json:
```json
{
    "body": "Changed commit from **[caa8301](https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717)** to **[f7dc0cd](https://github.com/sagemath/sagetrac-mirror/commit/f7dc0cd67123e4316d39444182aebcf4d1204f88)**",
    "created_at": "2015-06-06T15:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260759",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[caa8301](https://github.com/sagemath/sagetrac-mirror/commit/caa8301969391828718510a45eab8eface47a717)** to **[f7dc0cd](https://github.com/sagemath/sagetrac-mirror/commit/f7dc0cd67123e4316d39444182aebcf4d1204f88)**



---

archive/issue_comments_260760.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/f7dc0cd67123e4316d39444182aebcf4d1204f88\">f7dc0cd</a></td><td><code>trac 18581: fix header for 'sage-list-packages TYPE --local'</code></td></tr></table>\n",
    "created_at": "2015-06-06T15:32:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260760",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:33" align="right">Comment 33</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/f7dc0cd67123e4316d39444182aebcf4d1204f88">f7dc0cd</a></td><td><code>trac 18581: fix header for 'sage-list-packages TYPE --local'</code></td></tr></table>




---

archive/issue_comments_260761.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/61a40761c68b5b054ff86a0d8d4102556b9dcf58\">61a4076</a></td><td><code>trac 18581: stylistic changes in sage-list-packages</code></td></tr></table>\n",
    "created_at": "2015-06-06T16:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260761",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:34" align="right">Comment 34</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/61a40761c68b5b054ff86a0d8d4102556b9dcf58">61a4076</a></td><td><code>trac 18581: stylistic changes in sage-list-packages</code></td></tr></table>




---

archive/issue_comments_260762.json:
```json
{
    "body": "Changed commit from **[f7dc0cd](https://github.com/sagemath/sagetrac-mirror/commit/f7dc0cd67123e4316d39444182aebcf4d1204f88)** to **[61a4076](https://github.com/sagemath/sagetrac-mirror/commit/61a40761c68b5b054ff86a0d8d4102556b9dcf58)**",
    "created_at": "2015-06-06T16:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260762",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[f7dc0cd](https://github.com/sagemath/sagetrac-mirror/commit/f7dc0cd67123e4316d39444182aebcf4d1204f88)** to **[61a4076](https://github.com/sagemath/sagetrac-mirror/commit/61a40761c68b5b054ff86a0d8d4102556b9dcf58)**



---

archive/issue_comments_260763.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nI fixed the header. I also made some stylistic changes, for example replacing \"foo,bar\" with \"foo, bar\" in various places, and cutting most of the lines to fewer than 80 characters.",
    "created_at": "2015-06-06T16:16:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260763",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">Comment 35</div>

I fixed the header. I also made some stylistic changes, for example replacing "foo,bar" with "foo, bar" in various places, and cutting most of the lines to fewer than 80 characters.



---

archive/issue_events_246403.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-06T16:16:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246403"
}
```



---

archive/issue_events_246404.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-06T16:16:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246404"
}
```



---

archive/issue_events_246405.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-07T08:44:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246405"
}
```



---

archive/issue_events_246406.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-07T08:44:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246406"
}
```



---

archive/issue_comments_260764.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nYour last changes made me notice this:\n\n```\npname = re.sub(\"(\\.|-)p[0-9]+$\", \"\", pname) # strip .p0\npname = re.sub(\"(\\.|-)[0-9].*\", \"\", pname) # strip version number\n```\n\nThat's actually too complicated and also wrong. As far as I know, all other places in Sage handling packages just split on the first `-` and that should be done here also.",
    "created_at": "2015-06-07T08:44:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260764",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">Comment 36</div>

Your last changes made me notice this:

```
pname = re.sub("(\.|-)p[0-9]+$", "", pname) # strip .p0
pname = re.sub("(\.|-)[0-9].*", "", pname) # strip version number
```

That's actually too complicated and also wrong. As far as I know, all other places in Sage handling packages just split on the first `-` and that should be done here also.



---

archive/issue_comments_260765.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nWhat's the point of this complication?\n\n```\nurlexec=os.path.join(os.path.dirname(sys.argv[0]), \"sage-download-file\")\nMIRROR_URL = os.popen(urlexec+\" --print-fastest-mirror\").read().strip()\n```\n\nWhy not simply\n\n```\nMIRROR_URL = os.popen(\"sage-download-file --print-fastest-mirror\").read().strip()\n```",
    "created_at": "2015-06-07T08:55:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260765",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:37" align="right">Comment 37</div>

What's the point of this complication?

```
urlexec=os.path.join(os.path.dirname(sys.argv[0]), "sage-download-file")
MIRROR_URL = os.popen(urlexec+" --print-fastest-mirror").read().strip()
```

Why not simply

```
MIRROR_URL = os.popen("sage-download-file --print-fastest-mirror").read().strip()
```



---

archive/issue_comments_260766.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\n> Your last changes made me notice this:\n> \n> ```\n> pname = re.sub(\"(\\.|-)p[0-9]+$\", \"\", pname) # strip .p0\n> pname = re.sub(\"(\\.|-)[0-9].*\", \"\", pname) # strip version number\n> ```\n> \n> That's actually too complicated and also wrong. As far as I know, all other places in Sage handling packages just split on the first `-` and that should be done here also.\n\nYou already claimed that on another ticket, and were answered with counter-examples: [#18408 comment:20](https://github.com/sagemath/sage/issues/18408#comment:20)\n\nNathann",
    "created_at": "2015-06-07T08:57:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260766",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:38" align="right">Comment 38</div>

> Your last changes made me notice this:
> 
> ```
> pname = re.sub("(\.|-)p[0-9]+$", "", pname) # strip .p0
> pname = re.sub("(\.|-)[0-9].*", "", pname) # strip version number
> ```
> 
> That's actually too complicated and also wrong. As far as I know, all other places in Sage handling packages just split on the first `-` and that should be done here also.

You already claimed that on another ticket, and were answered with counter-examples: [#18408 comment:20](https://github.com/sagemath/sage/issues/18408#comment:20)

Nathann



---

archive/issue_comments_260767.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nInstead of\n\n```\nlocal_non_filtered = os.listdir(SAGE_PKGS)\nlocal = {}\nfor p in local_non_filtered:\n```\nthe following is easier to understand:\n\n```\nlocal = {}\nfor p in os.listdir(SAGE_PKGS):\n```",
    "created_at": "2015-06-07T08:57:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260767",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">Comment 39</div>

Instead of

```
local_non_filtered = os.listdir(SAGE_PKGS)
local = {}
for p in local_non_filtered:
```
the following is easier to understand:

```
local = {}
for p in os.listdir(SAGE_PKGS):
```



---

archive/issue_comments_260768.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nReplying to [@nathanncohen](#comment%3A38):\n> You already claimed that on another ticket, and were answered with counter-examples: [#18408 comment:20](https://github.com/sagemath/sage/issues/18408#comment:20)\n\n1. I believe those counter-examples are gone now (but correct me if I'm wrong)\n2. Splitting package names from versions should be done consistently, it's not that every script can independently decide how to do that. In particular, I find it an obvious requirement that the package name reported by `./sage --optional` should be accepted by `./sage -i`.",
    "created_at": "2015-06-07T09:01:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260768",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:40" align="right">Comment 40</div>

Replying to [@nathanncohen](#comment%3A38):
> You already claimed that on another ticket, and were answered with counter-examples: [#18408 comment:20](https://github.com/sagemath/sage/issues/18408#comment:20)

1. I believe those counter-examples are gone now (but correct me if I'm wrong)
2. Splitting package names from versions should be done consistently, it's not that every script can independently decide how to do that. In particular, I find it an obvious requirement that the package name reported by `./sage --optional` should be accepted by `./sage -i`.



---

archive/issue_comments_260769.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\n> 1. I believe those counter-examples are gone now (but correct me if I'm wrong)\n\nhttp://mirror.switch.ch/mirror/sagemath//spkg/optional/list\n\nLook for 'stein'\n\n> 2. Splitting package names from versions should be done consistently, it's not that every script can independently decide how to do that. In particular, I find it an obvious requirement that the package name reported by `./sage --optional` should be accepted by `./sage -i`.\n\nI agree, but that's not my point. My point is that you try to enforce a standard which is not respected by Sage. If you wish for all packages to be easily split into [name,version] by splitting the first '-' (which also means no '-' should appear in their name), I totally agree with you. But it should be done this way:\n1) Fix the names\n2) Add a consistency check somewhere to make sure it does not break in the future\n3) Change the regexp\n\nNathann",
    "created_at": "2015-06-07T09:06:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260769",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:41" align="right">Comment 41</div>

> 1. I believe those counter-examples are gone now (but correct me if I'm wrong)

http://mirror.switch.ch/mirror/sagemath//spkg/optional/list

Look for 'stein'

> 2. Splitting package names from versions should be done consistently, it's not that every script can independently decide how to do that. In particular, I find it an obvious requirement that the package name reported by `./sage --optional` should be accepted by `./sage -i`.

I agree, but that's not my point. My point is that you try to enforce a standard which is not respected by Sage. If you wish for all packages to be easily split into [name,version] by splitting the first '-' (which also means no '-' should appear in their name), I totally agree with you. But it should be done this way:
1) Fix the names
2) Add a consistency check somewhere to make sure it does not break in the future
3) Change the regexp

Nathann



---

archive/issue_comments_260770.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nReplying to [@nathanncohen](#comment%3A41):\n> If you wish for all packages to be easily split into [name,version] by splitting the first '-'\n\nThat's not my wish, that how `sage-fix-pkg-checksums` and `./sage -i` already handle packages.\n\nNote that\n\n```\n./sage -i database_jones_numfield\n```\ndoes try to install the package `database_jones_numfield-v4`, so you cannot claim that the name of the package is \"`database_jones_numfield-v4`\" without a version number.\n\nConversely,\n\n```\n./sage -i database_stein_watkins_mini\n```\ncannot install the old-style package \"`database_stein_watkins_mini.p0`\" (even if you remove `build/pkgs/database_stein_watkins_mini`) because the `.p0` is not seen as a version number (and I don't think it should!)",
    "created_at": "2015-06-07T09:23:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260770",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">Comment 42</div>

Replying to [@nathanncohen](#comment%3A41):
> If you wish for all packages to be easily split into [name,version] by splitting the first '-'

That's not my wish, that how `sage-fix-pkg-checksums` and `./sage -i` already handle packages.

Note that

```
./sage -i database_jones_numfield
```
does try to install the package `database_jones_numfield-v4`, so you cannot claim that the name of the package is "`database_jones_numfield-v4`" without a version number.

Conversely,

```
./sage -i database_stein_watkins_mini
```
cannot install the old-style package "`database_stein_watkins_mini.p0`" (even if you remove `build/pkgs/database_stein_watkins_mini`) because the `.p0` is not seen as a version number (and I don't think it should!)



---

archive/issue_comments_260771.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\n> cannot install the old-style package \"`database_stein_watkins_mini.p0`\" (even if you remove `build/pkgs/database_stein_watkins_mini`) because the `.p0` is not seen as a version number (and I don't think it should!)\n\nOkay, so you are just telling me that \"only what follows a '-' character is a version number\" precisely because that's what the script handle (which is a bug). And to prove it, you explain to me that \"p0\" is clearly not a version number.\n\nCan we talk about the list of packages online? You set my patch to 'needs_work' because 'extcode' is not a standard package according to you. But of course, the official list of Sage's package had to be what is listed on the mirrors, don't you think? So how can you claim that 'extcode' is not a standard package when the opposite is stated on our website?\n\nDo you see what's happening here? Double standards. You don't want to fix this problem because you are lazy, yet you expect me to magically 'update the online list of packages' despite knowing that I have absolutely no way to make that happen.\n\nNathann",
    "created_at": "2015-06-07T09:32:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260771",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:43" align="right">Comment 43</div>

> cannot install the old-style package "`database_stein_watkins_mini.p0`" (even if you remove `build/pkgs/database_stein_watkins_mini`) because the `.p0` is not seen as a version number (and I don't think it should!)

Okay, so you are just telling me that "only what follows a '-' character is a version number" precisely because that's what the script handle (which is a bug). And to prove it, you explain to me that "p0" is clearly not a version number.

Can we talk about the list of packages online? You set my patch to 'needs_work' because 'extcode' is not a standard package according to you. But of course, the official list of Sage's package had to be what is listed on the mirrors, don't you think? So how can you claim that 'extcode' is not a standard package when the opposite is stated on our website?

Do you see what's happening here? Double standards. You don't want to fix this problem because you are lazy, yet you expect me to magically 'update the online list of packages' despite knowing that I have absolutely no way to make that happen.

Nathann



---

archive/issue_comments_260772.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nNathann, in #18456 you decided to change\n\n```\ndef split_pkgname(name):\n    try:\n        basename, version = name.split('-', 1)\n    except ValueError:\n        # Some packages such as currently \"csage\" aren't versioned, or\n        # have non-standard versioning, e.g. \"database_stein_watkins_mini.p0\".\n        basename = name\n        version = \"\"\n    return basename, version\n```\nto\n\n```\ndef pkgname_split(name):\n    pname = name.split(' ')[0]\n    pname = re.sub(\"(\\.|-)p[0-9]+$\",\"\",pname) # strip .p0\n    pname = re.sub(\"(\\.|-)[0-9].*\",\"\",pname) # strip version number\n    return (pname,name[len(pname)+1:])\n```\nwithout justification or giving a reason why the latter is correct (where did those regexes come from?)\n\nUnless you can give me a good reason why you changed that, I'm proposing to undo that change.",
    "created_at": "2015-06-07T12:01:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260772",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">Comment 44</div>

Nathann, in #18456 you decided to change

```
def split_pkgname(name):
    try:
        basename, version = name.split('-', 1)
    except ValueError:
        # Some packages such as currently "csage" aren't versioned, or
        # have non-standard versioning, e.g. "database_stein_watkins_mini.p0".
        basename = name
        version = ""
    return basename, version
```
to

```
def pkgname_split(name):
    pname = name.split(' ')[0]
    pname = re.sub("(\.|-)p[0-9]+$","",pname) # strip .p0
    pname = re.sub("(\.|-)[0-9].*","",pname) # strip version number
    return (pname,name[len(pname)+1:])
```
without justification or giving a reason why the latter is correct (where did those regexes come from?)

Unless you can give me a good reason why you changed that, I'm proposing to undo that change.



---

archive/issue_comments_260773.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\n> Unless you can give me a good reason why you changed that, I'm proposing to undo that change.\n\nCase-by-case analysis of all packages. It works, for all pacakges that we have. In a name that ends by .p0, there is no denying that .p0 is not part of the package's name but indicates a version. Do you think that it will lead you anywhere to deny something like that?\n\nNathann",
    "created_at": "2015-06-07T12:21:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260773",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:45" align="right">Comment 45</div>

> Unless you can give me a good reason why you changed that, I'm proposing to undo that change.

Case-by-case analysis of all packages. It works, for all pacakges that we have. In a name that ends by .p0, there is no denying that .p0 is not part of the package's name but indicates a version. Do you think that it will lead you anywhere to deny something like that?

Nathann



---

archive/issue_comments_260774.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">Comment 46</div>\n\nhttp://mirror.switch.ch/mirror/sagemath/spkg/experimental/\n\nExample: `mayavi_2.2.1.spkg` with your parsing, the package's name is 'mayavi_2.2.1' and there is no version number.\n\nNathann",
    "created_at": "2015-06-07T12:23:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260774",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:46" align="right">Comment 46</div>

http://mirror.switch.ch/mirror/sagemath/spkg/experimental/

Example: `mayavi_2.2.1.spkg` with your parsing, the package's name is 'mayavi_2.2.1' and there is no version number.

Nathann



---

archive/issue_comments_260775.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">Comment 47</div>\n\nReplying to [@nathanncohen](#comment%3A45):\n> > Unless you can give me a good reason why you changed that, I'm proposing to undo that change.\n\n> \n> Case-by-case analysis of all packages. It works, for all packages that we have. In a name that ends by .p0, there is no denying that .p0 is not part of the package's name but indicates a version. Do you think that it will lead you anywhere to deny something like that?\n\nIt's not a matter of denial, it's more a matter of consistency. What's the point of listing a package `FOO` in the output of `./sage --optional` if `./sage -i FOO` cannot install that package?\n\nInstead of making up contrived regular expressions to deal with wrong package names, let's just fix the packages instead. The package `database_stein_watkins_mini.p0` is already fixed by a new-style package and we should just remove the wrongly-named package.",
    "created_at": "2015-06-07T13:37:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260775",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">Comment 47</div>

Replying to [@nathanncohen](#comment%3A45):
> > Unless you can give me a good reason why you changed that, I'm proposing to undo that change.

> 
> Case-by-case analysis of all packages. It works, for all packages that we have. In a name that ends by .p0, there is no denying that .p0 is not part of the package's name but indicates a version. Do you think that it will lead you anywhere to deny something like that?

It's not a matter of denial, it's more a matter of consistency. What's the point of listing a package `FOO` in the output of `./sage --optional` if `./sage -i FOO` cannot install that package?

Instead of making up contrived regular expressions to deal with wrong package names, let's just fix the packages instead. The package `database_stein_watkins_mini.p0` is already fixed by a new-style package and we should just remove the wrongly-named package.



---

archive/issue_comments_260776.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nSome data: if I just split on the first hyphen, I think the only packages where the versions come out differently are\n\n```\ndatabase_jones_numfield-v4   is 'v4' the version number?\ndatabase_stein_watkins_mini  already fixed\nmayavi_2.2.1                 is it mayavi, v 2.2.1, or mayavi_2.2.1, no version?\nreallib3-linux-20060728      is 'linux' part of the version number?\n```\nThe Jones database hasn't been updated since 2007, MayaVi2 hasn't been updated since 2008, and reallib3-linux-20060728 since 2006. Based on this, I find Jeroen's argument more convincing. (I mean, I find the argument for consistency in version-checking convincing to start with, and the fact that there are only a few old exceptions makes Nathann's counterargument less persuasive.)\n\nThere is a separate issue that the servers seem to be a mess. Moving packages from old-style to new-style will help make that less of a problem.",
    "created_at": "2015-06-07T16:53:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260776",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:48" align="right">Comment 48</div>

Some data: if I just split on the first hyphen, I think the only packages where the versions come out differently are

```
database_jones_numfield-v4   is 'v4' the version number?
database_stein_watkins_mini  already fixed
mayavi_2.2.1                 is it mayavi, v 2.2.1, or mayavi_2.2.1, no version?
reallib3-linux-20060728      is 'linux' part of the version number?
```
The Jones database hasn't been updated since 2007, MayaVi2 hasn't been updated since 2008, and reallib3-linux-20060728 since 2006. Based on this, I find Jeroen's argument more convincing. (I mean, I find the argument for consistency in version-checking convincing to start with, and the fact that there are only a few old exceptions makes Nathann's counterargument less persuasive.)

There is a separate issue that the servers seem to be a mess. Moving packages from old-style to new-style will help make that less of a problem.



---

archive/issue_comments_260777.json:
```json
{
    "body": "Changed commit from **[61a4076](https://github.com/sagemath/sagetrac-mirror/commit/61a40761c68b5b054ff86a0d8d4102556b9dcf58)** to **[262ba16](https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93)**",
    "created_at": "2015-06-07T16:56:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260777",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[61a4076](https://github.com/sagemath/sagetrac-mirror/commit/61a40761c68b5b054ff86a0d8d4102556b9dcf58)** to **[262ba16](https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93)**



---

archive/issue_comments_260778.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/dca165c068d4dfa4b7a9e8c404f95f169e6c1de4\">dca165c</a></td><td><code>trac 18581: minor clean up in sage-list-packages</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93\">262ba16</a></td><td><code>trac 18581: determine version number for package by splitting at first hyphen</code></td></tr></table>\n",
    "created_at": "2015-06-07T16:56:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260778",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:49" align="right">Comment 49</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/dca165c068d4dfa4b7a9e8c404f95f169e6c1de4">dca165c</a></td><td><code>trac 18581: minor clean up in sage-list-packages</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93">262ba16</a></td><td><code>trac 18581: determine version number for package by splitting at first hyphen</code></td></tr></table>




---

archive/issue_events_246407.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-07T16:57:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246407"
}
```



---

archive/issue_events_246408.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2015-06-07T16:57:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246408"
}
```



---

archive/issue_comments_260779.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nThis is good for me, but I would like to give Nathann a chance to give his opinion.",
    "created_at": "2015-06-07T17:41:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260779",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">Comment 51</div>

This is good for me, but I would like to give Nathann a chance to give his opinion.



---

archive/issue_comments_260780.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\n> This is good for me, but I would like to give Nathann a chance to give his opinion.\n\nI believe that you are breaking something that works. If you want to set a new standard (it is not currently enforced), fix the package's name first and then write some code to enforce the standard.\n\nNathann",
    "created_at": "2015-06-07T17:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260780",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:52" align="right">Comment 52</div>

> This is good for me, but I would like to give Nathann a chance to give his opinion.

I believe that you are breaking something that works. If you want to set a new standard (it is not currently enforced), fix the package's name first and then write some code to enforce the standard.

Nathann



---

archive/issue_comments_260781.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nReplying to [@nathanncohen](#comment%3A52):\n> > This is good for me, but I would like to give Nathann a chance to give his opinion.\n\n> \n> I believe that you are breaking something that works.\n\nWhat worked before that I am breaking?\n\n> If you want to set a new standard (it is not currently enforced), fix the package's name first and then write some code to enforce the standard.\n\nThe current standard is that the full package name is split into a package-version pair by the first hyphen. This is probably not documented anywhere, but that's the current practice. This is the standard followed by `./sage -i` (*), by `sage-fix-pkg-checksums` and by `sage-list-packages` (until recently when you changed it).\n\nI am pretty sure that no script ever considered `mayavi_2.2.1` as the package `mayavi_2` with version `2.1`, so I'm wondering why you made it that way in #18456.\n\n(*) To be more precise, `./sage -i` splits by any hyphen, not just the first hyphen.",
    "created_at": "2015-06-07T18:29:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260781",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">Comment 53</div>

Replying to [@nathanncohen](#comment%3A52):
> > This is good for me, but I would like to give Nathann a chance to give his opinion.

> 
> I believe that you are breaking something that works.

What worked before that I am breaking?

> If you want to set a new standard (it is not currently enforced), fix the package's name first and then write some code to enforce the standard.

The current standard is that the full package name is split into a package-version pair by the first hyphen. This is probably not documented anywhere, but that's the current practice. This is the standard followed by `./sage -i` (*), by `sage-fix-pkg-checksums` and by `sage-list-packages` (until recently when you changed it).

I am pretty sure that no script ever considered `mayavi_2.2.1` as the package `mayavi_2` with version `2.1`, so I'm wondering why you made it that way in #18456.

(*) To be more precise, `./sage -i` splits by any hyphen, not just the first hyphen.



---

archive/issue_comments_260782.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nI am spending a nice evening with a nice girl, and I don't want to have this conversation again. Have fun, Nathann",
    "created_at": "2015-06-07T18:56:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260782",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:54" align="right">Comment 54</div>

I am spending a nice evening with a nice girl, and I don't want to have this conversation again. Have fun, Nathann



---

archive/issue_comments_260783.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nThe naming conventions for old-style spkgs are described [here](http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html#naming-your-spkg), and they insist that there is a hyphen separating the package name from the version.",
    "created_at": "2015-06-07T19:06:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260783",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:55" align="right">Comment 55</div>

The naming conventions for old-style spkgs are described [here](http://doc.sagemath.org/html/en/developer/packaging_old_spkgs.html#naming-your-spkg), and they insist that there is a hyphen separating the package name from the version.



---

archive/issue_events_246409.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-07T20:27:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246409"
}
```



---

archive/issue_events_246410.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-06-07T20:27:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246410"
}
```



---

archive/issue_events_246411.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-06-08T20:28:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246411"
}
```



---

archive/issue_events_246412.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "557a148b215a2f4dd1ea0f029460640099c52fa8",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-06-08T20:28:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/18581#event-246412"
}
```



---

archive/issue_comments_260784.json:
```json
{
    "body": "Changed branch from **[u/jhpalmieri/versions](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/versions)** to **[262ba16](https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93)**",
    "created_at": "2015-06-08T20:28:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/18581",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/18581#issuecomment-260784",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jhpalmieri/versions](https://github.com/sagemath/sagetrac-mirror/tree/u/jhpalmieri/versions)** to **[262ba16](https://github.com/sagemath/sagetrac-mirror/commit/262ba162c108f3fd3037370f7a23bc8288fe2d93)**
