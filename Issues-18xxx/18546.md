# Issue 18546: Make arb a standard package

archive/issues_018309.json:
```json
{
    "body": "[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in `<c02d759d-9a81-4c85-a110-a2e2ffd679dc`@`googlegroups.com>`.\n\nSee also: #17218, #17194, #16747\n\nCC:  @cheuberg @fredrik-johansson simonking\n\nBranch/Commit: ea5741f9a233c8a385a47e406cd436783206bc62\n\nReviewer: Clemens Heuberger, Marc Mezzarobba\n\nAuthor: Marc Mezzarobba, Clemens Heuberger\n\nDependencies: #19280, #19443\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/18546\n\n",
    "closed_at": "2015-10-30T08:33:33Z",
    "created_at": "2015-05-29T15:17:02Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "Make arb a standard package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18546",
    "user": "https://github.com/mezzarobba"
}
```
[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in `<c02d759d-9a81-4c85-a110-a2e2ffd679dc`@`googlegroups.com>`.

See also: #17218, #17194, #16747

CC:  @cheuberg @fredrik-johansson simonking

Branch/Commit: ea5741f9a233c8a385a47e406cd436783206bc62

Reviewer: Clemens Heuberger, Marc Mezzarobba

Author: Marc Mezzarobba, Clemens Heuberger

Dependencies: #19280, #19443

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/18546





---

archive/issue_comments_264159.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in \\`<c02d759d-9a81-4c85-a110-a2e2ffd679dc\\`@\\`googlegroups.com>\\`.\n \n+See also: #17218, #17194, #16747\n \n Comment: 1\n \n```\n",
    "created_at": "2015-05-29T15:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264159",
    "user": "https://github.com/mezzarobba"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in \`<c02d759d-9a81-4c85-a110-a2e2ffd679dc\`@\`googlegroups.com>\`.
 
+See also: #17218, #17194, #16747
 
 Comment: 1
 
```




---

archive/issue_comments_264160.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-05-29T15:38:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264160",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_264161.json:
```json
{
    "body": "<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-05-29T15:50:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264161",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:2'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264162.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in \\`<c02d759d-9a81-4c85-a110-a2e2ffd679dc\\`@\\`googlegroups.com>\\`.\n \n+See also: #16747, #17194, #17218, #17220, #17786\n \n Comment: 1\n \n```\n",
    "created_at": "2015-05-29T15:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264162",
    "user": "https://github.com/mezzarobba"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in \`<c02d759d-9a81-4c85-a110-a2e2ffd679dc\`@\`googlegroups.com>\`.
 
+See also: #16747, #17194, #17218, #17220, #17786
 
 Comment: 1
 
```




---

archive/issue_comments_264163.json:
```json
{
    "body": "<a id='comment:4'></a>It doesn't build for me on OS X 10.10:\n\n```\n    CC   ../build/partitions/partitions_fmpz_fmpz.o\n    CC   ../build/partitions/partitions_hrr_sum_arb.o\n    CC   ../build/partitions/partitions_rademacher_bound.o\n    AR   libarb.a\nar: no archive members specified\nusage:  ar -d [-TLsv] archive file ...\n\tar -m [-TLsv] archive file ...\n\tar -m [-abiTLsv] position archive file ...\n\tar -p [-TLsv] archive [file ...]\n\tar -q [-cTLsv] archive file ...\n\tar -r [-cuTLsv] archive file ...\n\tar -r [-abciuTLsv] position archive file ...\n\tar -t [-TLsv] archive [file ...]\n\tar -x [-ouTLsv] archive [file ...]\nmake[4]: *** [libarb.a] Error 1\nmake[3]: *** [library] Error 2\nError building arb.\n```",
    "created_at": "2015-05-29T16:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264163",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>It doesn't build for me on OS X 10.10:

```
    CC   ../build/partitions/partitions_fmpz_fmpz.o
    CC   ../build/partitions/partitions_hrr_sum_arb.o
    CC   ../build/partitions/partitions_rademacher_bound.o
    AR   libarb.a
ar: no archive members specified
usage:  ar -d [-TLsv] archive file ...
	ar -m [-TLsv] archive file ...
	ar -m [-abiTLsv] position archive file ...
	ar -p [-TLsv] archive [file ...]
	ar -q [-cTLsv] archive file ...
	ar -r [-cuTLsv] archive file ...
	ar -r [-abciuTLsv] position archive file ...
	ar -t [-TLsv] archive [file ...]
	ar -x [-ouTLsv] archive [file ...]
make[4]: *** [libarb.a] Error 1
make[3]: *** [library] Error 2
Error building arb.
```



---

archive/issue_comments_264164.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in \\`<c02d759d-9a81-4c85-a110-a2e2ffd679dc\\`@\\`googlegroups.com>\\`.\n \n+See also: #17218, #17194, #16747\n \n Comment: 1\n \n```\n",
    "created_at": "2015-05-29T16:45:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264164",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,4 +1,6 @@
+[Arb](http://fredrikj.net/arb/) has been an optional package for a few months. This is a proposal to fast-track it to standard, as suggested in \`<c02d759d-9a81-4c85-a110-a2e2ffd679dc\`@\`googlegroups.com>\`.
 
+See also: #17218, #17194, #16747
 
 Comment: 1
 
```




---

archive/issue_comments_264165.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-29T18:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264165",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_264166.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:4 jhpalmieri]:\n> It doesn't build for me on OS X 10.10:\n\n\nI made this a separate issue (#18552).",
    "created_at": "2015-05-30T08:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264166",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:7'></a>Replying to [comment:4 jhpalmieri]:
> It doesn't build for me on OS X 10.10:


I made this a separate issue (#18552).



---

archive/issue_comments_264167.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-05-30T08:09:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264167",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264168.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:4 jhpalmieri]:\n> It doesn't build for me on OS X 10.10:\n\n\nCould you please try with arb 2.6 (#18560)?",
    "created_at": "2015-06-01T07:06:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264168",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:8'></a>Replying to [comment:4 jhpalmieri]:
> It doesn't build for me on OS X 10.10:


Could you please try with arb 2.6 (#18560)?



---

archive/issue_comments_264169.json:
```json
{
    "body": "<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-06T13:37:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264169",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:10'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264170.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-08-08T07:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264170",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_264171.json:
```json
{
    "body": "<a id='comment:11'></a>does not apply, needs rebase",
    "created_at": "2015-08-08T07:35:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264171",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:11'></a>does not apply, needs rebase



---

archive/issue_comments_264172.json:
```json
{
    "body": "<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-08-18T14:07:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:12'></a>Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_264173.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-18T14:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264173",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264174.json:
```json
{
    "body": "<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-03T16:33:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264174",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:15'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_052133.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-09-03T16:38:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18546#event-52133"
}
```



---

archive/issue_comments_264175.json:
```json
{
    "body": "<a id='comment:16'></a>I reviewed this ticket. Including it into a fresh copy of develop (=6.9.beta4) builds fine with all doctests passing (three unrelated to this ticket only when called separately). In particular, the sage version built includes arb. Source code (removal of `optional - arb`) seems to be fine. Documentation seems to be ok.\n\nThere was one occurrence of `optional arb` in `real_mpfi.pyx`. I removed that as a reviewer patch. Please cross-review this change; then feel free to set to `positive_review`.",
    "created_at": "2015-09-03T16:38:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264175",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:16'></a>I reviewed this ticket. Including it into a fresh copy of develop (=6.9.beta4) builds fine with all doctests passing (three unrelated to this ticket only when called separately). In particular, the sage version built includes arb. Source code (removal of `optional - arb`) seems to be fine. Documentation seems to be ok.

There was one occurrence of `optional arb` in `real_mpfi.pyx`. I removed that as a reviewer patch. Please cross-review this change; then feel free to set to `positive_review`.



---

archive/issue_comments_264176.json:
```json
{
    "body": "<a id='comment:17'></a>Thanks!",
    "created_at": "2015-09-04T05:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264176",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:17'></a>Thanks!



---

archive/issue_comments_264177.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-09-04T05:02:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264177",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_264178.json:
```json
{
    "body": "<a id='comment:18'></a>You can only depend on tickets that contribute code",
    "created_at": "2015-09-12T09:56:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264178",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>You can only depend on tickets that contribute code



---

archive/issue_comments_264179.json:
```json
{
    "body": "<a id='comment:19'></a>Testsuite fails on 32-bit Linux\n\n```\natan....PASS\natan2....FAIL: containment\n\na = (-143601044557104111888298409983 * 2^-97) +/- (0)\n\nb = (-1 * 2^5) +/- (1040502623 * 2^-94)\n\nc = (-1933204245030245427143485 * 2^-80) +/- (959240107 * 2^-104)\n\nmake[4]: *** [../build/arb/test/t-atan2_RUN] Aborted (core dumped)\natan_arf....g++ -pthread -shared -L/home/buildslave-sage/slave/sage_git/build/local/lib build/temp.linux-i686-2.7/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/matrix/matrix_cyclo_dense.o -L/home/buildslave-sage/slave/sage_git/build/local/lib -L/home/buildslave-sage/slave/sage_git/build/local/lib -lntl -lgmp -lstdc++ -lpython2.7 -o build/lib.linux-i686-2.7/sage/matrix/matrix_cyclo_dense.so\n[ 75/170] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/home/buildslave-sage/slave/sage_git/build/local/include -I/home/buildslave-sage/slave/sage_git/build/local/include/python2.7 -I/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/home/buildslave-sage/slave/sage_git/build/src -I/home/buildslave-sage/slave/sage_git/build/src/sage/ext -I/home/buildslave-sage/slave/sage_git/build/src/build/cythonized -I/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/ext -I/home/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c /home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/matrix/matrix_modn_sparse.c -o build/temp.linux-i686-2.7/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/matrix/matrix_modn_sparse.o -fno-strict-aliasing -w -fno-tree-dominator-opts\nFAIL: containment\n\na = (-9905938165778121085362896895 * 2^-91) +/- (0)\n\nb = (-2031897670652875033840701129116896875534188457349248225 * 2^-180) +/- (538444801 * 2^-210)\n\nmake[4]: *** [../build/arb/test/t-atan_RUN] Aborted (core dumped)\n```",
    "created_at": "2015-09-12T11:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264179",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:19'></a>Testsuite fails on 32-bit Linux

```
atan....PASS
atan2....FAIL: containment

a = (-143601044557104111888298409983 * 2^-97) +/- (0)

b = (-1 * 2^5) +/- (1040502623 * 2^-94)

c = (-1933204245030245427143485 * 2^-80) +/- (959240107 * 2^-104)

make[4]: *** [../build/arb/test/t-atan2_RUN] Aborted (core dumped)
atan_arf....g++ -pthread -shared -L/home/buildslave-sage/slave/sage_git/build/local/lib build/temp.linux-i686-2.7/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/matrix/matrix_cyclo_dense.o -L/home/buildslave-sage/slave/sage_git/build/local/lib -L/home/buildslave-sage/slave/sage_git/build/local/lib -lntl -lgmp -lstdc++ -lpython2.7 -o build/lib.linux-i686-2.7/sage/matrix/matrix_cyclo_dense.so
[ 75/170] gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -fPIC -I/home/buildslave-sage/slave/sage_git/build/local/include -I/home/buildslave-sage/slave/sage_git/build/local/include/python2.7 -I/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/numpy/core/include -I/home/buildslave-sage/slave/sage_git/build/src -I/home/buildslave-sage/slave/sage_git/build/src/sage/ext -I/home/buildslave-sage/slave/sage_git/build/src/build/cythonized -I/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/ext -I/home/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c /home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/matrix/matrix_modn_sparse.c -o build/temp.linux-i686-2.7/home/buildslave-sage/slave/sage_git/build/src/build/cythonized/sage/matrix/matrix_modn_sparse.o -fno-strict-aliasing -w -fno-tree-dominator-opts
FAIL: containment

a = (-9905938165778121085362896895 * 2^-91) +/- (0)

b = (-2031897670652875033840701129116896875534188457349248225 * 2^-180) +/- (538444801 * 2^-210)

make[4]: *** [../build/arb/test/t-atan_RUN] Aborted (core dumped)
```



---

archive/issue_comments_264180.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-09-12T11:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264180",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264181.json:
```json
{
    "body": "<a id='comment:20'></a>http://build.sagedev.org/release/builders/%20%20fast%20Oxford%20arando%20%28Ubuntu%2013.04%20i686%29%20incremental/builds/538/steps/compile/logs/stdio",
    "created_at": "2015-09-12T11:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264181",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:20'></a>http://build.sagedev.org/release/builders/%20%20fast%20Oxford%20arando%20%28Ubuntu%2013.04%20i686%29%20incremental/builds/538/steps/compile/logs/stdio



---

archive/issue_comments_264182.json:
```json
{
    "body": "<a id='comment:21'></a>I can reproduce the failure on linux32 under virtualbox.\n\nThe source appears to be a bug in MPIR.\n\nIf you run\n\n#include \"mpir.h\"\n\nint main()\n{\n    mpz_t one, x, w;\n    mpz_init(one);\n    mpz_init(x);\n    mpz_init(w);\n    mpz_set_str(one, \"62165404551223330269422781018352605012557018849668464680057997111644937126566671941632\", 10);\n    mpz_set_str(x, \"39623752663112484341451587580\", 10);\n\n    mpz_tdiv_q(w, one, x);\n    gmp_printf(\"%Zd / %Zd = %Zd\\n\", one, x, w);\n}\n\nit outputs \n\n    62165404551223330269422781018352605012557018849668464680057997111644937126566671941632 / 39623752663112484341451587580 = 1568892406419848332919986945754866320479099155002496784035\n\nbut you can check with Python ints that the correct quotient should be\n\n        1568892403497558507879962225846103176600476845510570267609",
    "created_at": "2015-09-12T14:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264182",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:21'></a>I can reproduce the failure on linux32 under virtualbox.

The source appears to be a bug in MPIR.

If you run

#include "mpir.h"

int main()
{
    mpz_t one, x, w;
    mpz_init(one);
    mpz_init(x);
    mpz_init(w);
    mpz_set_str(one, "62165404551223330269422781018352605012557018849668464680057997111644937126566671941632", 10);
    mpz_set_str(x, "39623752663112484341451587580", 10);

    mpz_tdiv_q(w, one, x);
    gmp_printf("%Zd / %Zd = %Zd\n", one, x, w);
}

it outputs 

    62165404551223330269422781018352605012557018849668464680057997111644937126566671941632 / 39623752663112484341451587580 = 1568892406419848332919986945754866320479099155002496784035

but you can check with Python ints that the correct quotient should be

        1568892403497558507879962225846103176600476845510570267609



---

archive/issue_comments_264183.json:
```json
{
    "body": "<a id='comment:22'></a>Some more failures on 32-bit:\n\n```\nsage -t --long src/sage/rings/complex_ball_acb.pyx\n**********************************************************************\nFile \"src/sage/rings/complex_ball_acb.pyx\", line 1137, in sage.rings.complex_ball_acb.ComplexBall.accuracy\nFailed example:\n    CBF(I/2).accuracy()\nExpected:\n    9223372036854775807\nGot:\n    2147483647\n**********************************************************************\nFile \"src/sage/rings/complex_ball_acb.pyx\", line 1139, in sage.rings.complex_ball_acb.ComplexBall.accuracy\nFailed example:\n    CBF('nan', 'inf').accuracy()\nExpected:\n    -9223372036854775807\nGot:\n    -2147483647\n**********************************************************************\n1 item had failures:\n   2 of   5 in sage.rings.complex_ball_acb.ComplexBall.accuracy\n    [294 tests, 2 failures, 0.32 s]\nsage -t --long src/sage/rings/real_arb.pyx\n**********************************************************************\nFile \"src/sage/rings/real_arb.pyx\", line 1430, in sage.rings.real_arb.RealBall.accuracy\nFailed example:\n    RBF(1).accuracy()\nExpected:\n    9223372036854775807\nGot:\n    2147483647\n**********************************************************************\nFile \"src/sage/rings/real_arb.pyx\", line 1432, in sage.rings.real_arb.RealBall.accuracy\nFailed example:\n    RBF(NaN).accuracy()\nExpected:\n    -9223372036854775807\nGot:\n    -2147483647\n**********************************************************************\n1 item had failures:\n   2 of   5 in sage.rings.real_arb.RealBall.accuracy\n    [498 tests, 2 failures, 0.31 s]\n```",
    "created_at": "2015-09-12T14:14:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264183",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:22'></a>Some more failures on 32-bit:

```
sage -t --long src/sage/rings/complex_ball_acb.pyx
**********************************************************************
File "src/sage/rings/complex_ball_acb.pyx", line 1137, in sage.rings.complex_ball_acb.ComplexBall.accuracy
Failed example:
    CBF(I/2).accuracy()
Expected:
    9223372036854775807
Got:
    2147483647
**********************************************************************
File "src/sage/rings/complex_ball_acb.pyx", line 1139, in sage.rings.complex_ball_acb.ComplexBall.accuracy
Failed example:
    CBF('nan', 'inf').accuracy()
Expected:
    -9223372036854775807
Got:
    -2147483647
**********************************************************************
1 item had failures:
   2 of   5 in sage.rings.complex_ball_acb.ComplexBall.accuracy
    [294 tests, 2 failures, 0.32 s]
sage -t --long src/sage/rings/real_arb.pyx
**********************************************************************
File "src/sage/rings/real_arb.pyx", line 1430, in sage.rings.real_arb.RealBall.accuracy
Failed example:
    RBF(1).accuracy()
Expected:
    9223372036854775807
Got:
    2147483647
**********************************************************************
File "src/sage/rings/real_arb.pyx", line 1432, in sage.rings.real_arb.RealBall.accuracy
Failed example:
    RBF(NaN).accuracy()
Expected:
    -9223372036854775807
Got:
    -2147483647
**********************************************************************
1 item had failures:
   2 of   5 in sage.rings.real_arb.RealBall.accuracy
    [498 tests, 2 failures, 0.31 s]
```



---

archive/issue_comments_264184.json:
```json
{
    "body": "<a id='comment:23'></a>Regarding the divion bug, can someone tell me the value of SB_DIVAPPR_Q_SMALL_THRESHOLD and SB_DIV_QR_SMALL_THRESHOLD         on this machine, in gmp-mparam.h in MPIR.\n\nIf they are not 0, you will probably find setting them to 0 is a temporary workaround. If they are already 0 I wonder what on earth can have gone wrong.\n\nI'm afraid I personally won't be able to fix this bug until late this month, but I have posted it on mpir-devel in case someone else can track it down.\n\nIf the gcc is 5.2 or above, it might also be worth building MPIR without optimisation (and check the CFLAGS doesn't contain -ansi : I don't think it does). We've had reports of what we think is miscompilation with recent gcc on Linux 32. We are still trying to track it down (code works fine under valgrind but otherwise does not).",
    "created_at": "2015-09-12T14:20:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264184",
    "user": "https://trac.sagemath.org/admin/accounts/users/wbhart"
}
```

<a id='comment:23'></a>Regarding the divion bug, can someone tell me the value of SB_DIVAPPR_Q_SMALL_THRESHOLD and SB_DIV_QR_SMALL_THRESHOLD         on this machine, in gmp-mparam.h in MPIR.

If they are not 0, you will probably find setting them to 0 is a temporary workaround. If they are already 0 I wonder what on earth can have gone wrong.

I'm afraid I personally won't be able to fix this bug until late this month, but I have posted it on mpir-devel in case someone else can track it down.

If the gcc is 5.2 or above, it might also be worth building MPIR without optimisation (and check the CFLAGS doesn't contain -ansi : I don't think it does). We've had reports of what we think is miscompilation with recent gcc on Linux 32. We are still trying to track it down (code works fine under valgrind but otherwise does not).



---

archive/issue_comments_264185.json:
```json
{
    "body": "<a id='comment:24'></a>Defining both SB_DIVAPPR_Q_SMALL_THRESHOLD and SB_DIV_QR_SMALL_THRESHOLD as 0 in gmp-mparam.h fixes the problem (these values are currently not defined at all).\n\nThe bug might be restricted to 32-bit installations on a 64-bit host, where MPIR has outdated tuneup values (my arch is x86/nehalem).\n\nSince this is a rather serious bug affecting all of Sage, should it be a separate, blocker, ticket?",
    "created_at": "2015-09-12T15:31:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264185",
    "user": "https://github.com/fredrik-johansson"
}
```

<a id='comment:24'></a>Defining both SB_DIVAPPR_Q_SMALL_THRESHOLD and SB_DIV_QR_SMALL_THRESHOLD as 0 in gmp-mparam.h fixes the problem (these values are currently not defined at all).

The bug might be restricted to 32-bit installations on a 64-bit host, where MPIR has outdated tuneup values (my arch is x86/nehalem).

Since this is a rather serious bug affecting all of Sage, should it be a separate, blocker, ticket?



---

archive/issue_comments_264186.json:
```json
{
    "body": "<a id='comment:25'></a>Replying to [comment:24 fredrik.johansson]:\n> Defining both SB_DIVAPPR_Q_SMALL_THRESHOLD and SB_DIV_QR_SMALL_THRESHOLD as 0 in gmp-mparam.h fixes the problem (these values are currently not defined at all).\n> \n> The bug might be restricted to 32-bit installations on a 64-bit host, where MPIR has outdated tuneup values (my arch is x86/nehalem).\n> \n> Since this is a rather serious bug affecting all of Sage, should it be a separate, blocker, ticket?\n\n\nI'd say yes.\n\nFWIW, I only tested the MPIR alphas stand-alone on Linux x86, on a true 32-bit processor.",
    "created_at": "2015-09-12T16:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264186",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:25'></a>Replying to [comment:24 fredrik.johansson]:
> Defining both SB_DIVAPPR_Q_SMALL_THRESHOLD and SB_DIV_QR_SMALL_THRESHOLD as 0 in gmp-mparam.h fixes the problem (these values are currently not defined at all).
> 
> The bug might be restricted to 32-bit installations on a 64-bit host, where MPIR has outdated tuneup values (my arch is x86/nehalem).
> 
> Since this is a rather serious bug affecting all of Sage, should it be a separate, blocker, ticket?


I'd say yes.

FWIW, I only tested the MPIR alphas stand-alone on Linux x86, on a true 32-bit processor.



---

archive/issue_comments_264187.json:
```json
{
    "body": "<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-24T12:53:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264187",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:26'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264188.json:
```json
{
    "body": "<a id='comment:27'></a>Replying to [comment:22 vbraun]:\n> Some more failures on 32-bit:\n> \n> ```\n> sage -t --long src/sage/rings/complex_ball_acb.pyx\n> **********************************************************************\n> 1 item had failures:\n>    2 of   5 in sage.rings.complex_ball_acb.ComplexBall.accuracy\n>     [294 tests, 2 failures, 0.32 s]\n> sage -t --long src/sage/rings/real_arb.pyx\n> ```\n\nThese two failures do not belong to this ticket, but to #19063 (the relevant code is not present here).\n\n> {{{\n> File \"src/sage/rings/real_arb.pyx\", line 1430, in sage.rings.real_arb.RealBall.accuracy\n> 1 item had failures:\n>    2 of   5 in sage.rings.real_arb.RealBall.accuracy\n>     [498 tests, 2 failures, 0.31 s]\n> }}}\n\n\nI pushed a fix for this, but have not yet tested it under 32 bit.",
    "created_at": "2015-09-24T13:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264188",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:27'></a>Replying to [comment:22 vbraun]:
> Some more failures on 32-bit:
> 
> ```
> sage -t --long src/sage/rings/complex_ball_acb.pyx
> **********************************************************************
> 1 item had failures:
>    2 of   5 in sage.rings.complex_ball_acb.ComplexBall.accuracy
>     [294 tests, 2 failures, 0.32 s]
> sage -t --long src/sage/rings/real_arb.pyx
> ```

These two failures do not belong to this ticket, but to #19063 (the relevant code is not present here).

> {{{
> File "src/sage/rings/real_arb.pyx", line 1430, in sage.rings.real_arb.RealBall.accuracy
> 1 item had failures:
>    2 of   5 in sage.rings.real_arb.RealBall.accuracy
>     [498 tests, 2 failures, 0.31 s]
> }}}


I pushed a fix for this, but have not yet tested it under 32 bit.



---

archive/issue_comments_264189.json:
```json
{
    "body": "<a id='comment:28'></a>Replying to [comment:24 fredrik.johansson]:\n> Since this is a rather serious bug affecting all of Sage, should it be a separate, blocker, ticket?\n\n\nI opened #19280 for that.",
    "created_at": "2015-09-24T15:58:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264189",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:28'></a>Replying to [comment:24 fredrik.johansson]:
> Since this is a rather serious bug affecting all of Sage, should it be a separate, blocker, ticket?


I opened #19280 for that.



---

archive/issue_comments_264190.json:
```json
{
    "body": "<a id='comment:29'></a>Arb's testsuite passes on 32 bit once mpir has been rebuilt using #19280.",
    "created_at": "2015-09-24T18:58:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264190",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:29'></a>Arb's testsuite passes on 32 bit once mpir has been rebuilt using #19280.



---

archive/issue_comments_264191.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-09-25T06:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264191",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264192.json:
```json
{
    "body": "<a id='comment:30'></a>Replying to [comment:27 cheuberg]:\n>> I pushed a fix for this, but have not yet tested it under 32 bit.\n\n\nNow, after recompiling mpir with #19280 applied, all tests pass on my (virtual) 32 bit machine.",
    "created_at": "2015-09-25T06:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264192",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:30'></a>Replying to [comment:27 cheuberg]:
>> I pushed a fix for this, but have not yet tested it under 32 bit.


Now, after recompiling mpir with #19280 applied, all tests pass on my (virtual) 32 bit machine.



---

archive/issue_comments_264193.json:
```json
{
    "body": "<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-09-25T07:31:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264193",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

<a id='comment:31'></a>Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264194.json:
```json
{
    "body": "<a id='comment:32'></a>Thanks for taking care of this!",
    "created_at": "2015-10-15T08:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264194",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:32'></a>Thanks for taking care of this!



---

archive/issue_comments_264195.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-15T08:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264195",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_264196.json:
```json
{
    "body": "<a id='comment:33'></a>Needs to be rebased to the latest version of #19280",
    "created_at": "2015-10-15T08:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264196",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>Needs to be rebased to the latest version of #19280



---

archive/issue_comments_264197.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-15T08:45:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264197",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264198.json:
```json
{
    "body": "<a id='comment:34'></a>Replying to [comment:33 jdemeyer]:\n> Needs to be rebased to the latest version of #19280\n\n\nAre you saying we should **rebase** these changes (and the other branches that depend on them) on top of #19820? I can do it, but in this case I think we should also rebase #19280 itself on top of sage-6.9.\n\nOr do you want me to merge the branch there into this branch? (I'll do it if you want, but why? The other ticket is already a dependency, so this ticket won't get merged without it...)",
    "created_at": "2015-10-15T09:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264198",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:34'></a>Replying to [comment:33 jdemeyer]:
> Needs to be rebased to the latest version of #19280


Are you saying we should **rebase** these changes (and the other branches that depend on them) on top of #19820? I can do it, but in this case I think we should also rebase #19280 itself on top of sage-6.9.

Or do you want me to merge the branch there into this branch? (I'll do it if you want, but why? The other ticket is already a dependency, so this ticket won't get merged without it...)



---

archive/issue_comments_264199.json:
```json
{
    "body": "<a id='comment:35'></a>Replying to [comment:34 mmezzarobba]:\n> Replying to [comment:33 jdemeyer]:\n> > Needs to be rebased to the latest version of #19280\n\n> \n> Are you saying we should **rebase** these changes (and the other branches that depend on them) on top of #19820? I can do it, but in this case I think we should also rebase #19280 itself on top of sage-6.9.\n> \n> Or do you want me to merge the branch there into this branch? (I'll do it if you want, but why? The other ticket is already a dependency, so this ticket won't get merged without it...)\n\nRebase or merge: either is fine for me. The reason I ask it is for easier review/testing. It's better if I can just do `git trac checkout <ticket number>` instead of manually needing to merge the dependencies. The fact that this branch has a *wrong* version of #19280 makes it even worse.",
    "created_at": "2015-10-15T11:47:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264199",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:35'></a>Replying to [comment:34 mmezzarobba]:
> Replying to [comment:33 jdemeyer]:
> > Needs to be rebased to the latest version of #19280

> 
> Are you saying we should **rebase** these changes (and the other branches that depend on them) on top of #19820? I can do it, but in this case I think we should also rebase #19280 itself on top of sage-6.9.
> 
> Or do you want me to merge the branch there into this branch? (I'll do it if you want, but why? The other ticket is already a dependency, so this ticket won't get merged without it...)

Rebase or merge: either is fine for me. The reason I ask it is for easier review/testing. It's better if I can just do `git trac checkout <ticket number>` instead of manually needing to merge the dependencies. The fact that this branch has a *wrong* version of #19280 makes it even worse.



---

archive/issue_comments_264200.json:
```json
{
    "body": "<a id='comment:36'></a>New commits:",
    "created_at": "2015-10-15T12:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264200",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:36'></a>New commits:



---

archive/issue_comments_264201.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-15T12:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264201",
    "user": "https://github.com/mezzarobba"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264202.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-15T13:44:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264202",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_264203.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-15T19:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264203",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264204.json:
```json
{
    "body": "<a id='comment:38'></a>Merge conflict",
    "created_at": "2015-10-15T19:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264204",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:38'></a>Merge conflict



---

archive/issue_comments_264205.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-10-16T10:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264205",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_264206.json:
```json
{
    "body": "<a id='comment:39'></a>Merged 6.10.beta0 (conflict was with #19308). This introduces lots of blank space diff, so please diff with `git diff -b` to see the actual changes.\n\n---\nNew commits:",
    "created_at": "2015-10-16T10:02:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264206",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:39'></a>Merged 6.10.beta0 (conflict was with #19308). This introduces lots of blank space diff, so please diff with `git diff -b` to see the actual changes.

---
New commits:



---

archive/issue_events_052134.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-10-16T10:02:50Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "milestone": "sage-6.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18546#event-52134"
}
```



---

archive/issue_events_052135.json:
```json
{
    "actor": "https://github.com/cheuberg",
    "created_at": "2015-10-16T10:02:50Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "milestone": "sage-6.10",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18546#event-52135"
}
```



---

archive/issue_comments_264207.json:
```json
{
    "body": "<a id='comment:40'></a>going back to my branch because I also rebased the follow-up tickets\n\n---\nNew commits:",
    "created_at": "2015-10-16T10:56:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264207",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:40'></a>going back to my branch because I also rebased the follow-up tickets

---
New commits:



---

archive/issue_comments_264208.json:
```json
{
    "body": "<a id='comment:41'></a>I do not understand why you *rebase* at such a late stage with a chain of tickets depending on this here.",
    "created_at": "2015-10-16T11:00:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264208",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:41'></a>I do not understand why you *rebase* at such a late stage with a chain of tickets depending on this here.



---

archive/issue_comments_264209.json:
```json
{
    "body": "<a id='comment:42'></a>anyhow, the two branches contain the same code, so I set this back to positive.",
    "created_at": "2015-10-16T11:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264209",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:42'></a>anyhow, the two branches contain the same code, so I set this back to positive.



---

archive/issue_comments_264210.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-10-16T11:03:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264210",
    "user": "https://github.com/cheuberg"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_264211.json:
```json
{
    "body": "<a id='comment:43'></a>Replying to [comment:41 cheuberg]:\n> I do not understand why you *rebase* at such a late stage with a chain of tickets depending on this here.\n\n\nI'm doing it *because* there are other tickets depending on this one, and IMO adding merges everywhere makes their history less readable. But I can do merges instead if you prefer...",
    "created_at": "2015-10-16T11:17:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264211",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:43'></a>Replying to [comment:41 cheuberg]:
> I do not understand why you *rebase* at such a late stage with a chain of tickets depending on this here.


I'm doing it *because* there are other tickets depending on this one, and IMO adding merges everywhere makes their history less readable. But I can do merges instead if you prefer...



---

archive/issue_comments_264212.json:
```json
{
    "body": "<a id='comment:44'></a>IMHO, rebasing destroys history and requires much more work, e.g., you *have* to merge the rebased ticket into all depending tickets, while a merge might just work without additional intervention.\n\nLuckily, I never merged #18546 into #17220 and its dependencies; otherwise I'd have to remerge it again (although nothing relevant changed) and would have troubles in my private \"develop\" branch where I collect all tickets I authored in order to detect conflicts between apparently unrelated tickets early on.\n\nThus for me, rebasing something where somebody else might have based something (e.g., something pushed to a trac ticket) is something to avoid if at all possible.",
    "created_at": "2015-10-16T11:33:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264212",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:44'></a>IMHO, rebasing destroys history and requires much more work, e.g., you *have* to merge the rebased ticket into all depending tickets, while a merge might just work without additional intervention.

Luckily, I never merged #18546 into #17220 and its dependencies; otherwise I'd have to remerge it again (although nothing relevant changed) and would have troubles in my private "develop" branch where I collect all tickets I authored in order to detect conflicts between apparently unrelated tickets early on.

Thus for me, rebasing something where somebody else might have based something (e.g., something pushed to a trac ticket) is something to avoid if at all possible.



---

archive/issue_comments_264213.json:
```json
{
    "body": "<a id='comment:45'></a>Replying to [comment:44 cheuberg]:\n> Thus for me, rebasing something where somebody else might have based something (e.g., something pushed to a trac ticket) is something to avoid if at all possible.\n\n\nI agree, except that I would replace the condition \"something pushed to a trac ticket\" by \"something pushed to a trac ticket and set to needs_review\". I often push work-in-progress to Trac and keep rewriting history until it's ready for review.",
    "created_at": "2015-10-16T11:35:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264213",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>Replying to [comment:44 cheuberg]:
> Thus for me, rebasing something where somebody else might have based something (e.g., something pushed to a trac ticket) is something to avoid if at all possible.


I agree, except that I would replace the condition "something pushed to a trac ticket" by "something pushed to a trac ticket and set to needs_review". I often push work-in-progress to Trac and keep rewriting history until it's ready for review.



---

archive/issue_comments_264214.json:
```json
{
    "body": "<a id='comment:46'></a>Replying to [comment:45 jdemeyer]:\n> Replying to [comment:44 cheuberg]:\n> > Thus for me, rebasing something where somebody else might have based something (e.g., something pushed to a trac ticket) is something to avoid if at all possible.\n\n> \n> I agree, except that I would replace the condition \"something pushed to a trac ticket\" by \"something pushed to a trac ticket and set to needs_review\".\n\n\nFor me, rebasing on top of the last release or beta is okay if not desirable even in this case. (In particular, please feel free to do it when you know I'm on the other end.) But I'll refrain from doing it if you don't like it.",
    "created_at": "2015-10-16T11:47:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264214",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:46'></a>Replying to [comment:45 jdemeyer]:
> Replying to [comment:44 cheuberg]:
> > Thus for me, rebasing something where somebody else might have based something (e.g., something pushed to a trac ticket) is something to avoid if at all possible.

> 
> I agree, except that I would replace the condition "something pushed to a trac ticket" by "something pushed to a trac ticket and set to needs_review".


For me, rebasing on top of the last release or beta is okay if not desirable even in this case. (In particular, please feel free to do it when you know I'm on the other end.) But I'll refrain from doing it if you don't like it.



---

archive/issue_comments_264215.json:
```json
{
    "body": "<a id='comment:47'></a>Doesn't actually build arb, maybe you need to bump the patchlevel as well?\n\nhttp://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/143/steps/compile/logs/stdio",
    "created_at": "2015-10-16T21:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264215",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:47'></a>Doesn't actually build arb, maybe you need to bump the patchlevel as well?

http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/143/steps/compile/logs/stdio



---

archive/issue_comments_264216.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-16T21:08:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264216",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264217.json:
```json
{
    "body": "<a id='comment:48'></a>Replying to [comment:47 vbraun]:\n> Doesn't actually build arb, maybe you need to bump the patchlevel as well?\n> \n> http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/143/steps/compile/logs/stdio\n\n\nBumping the patchlevel does not help.",
    "created_at": "2015-10-17T09:18:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264217",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:48'></a>Replying to [comment:47 vbraun]:
> Doesn't actually build arb, maybe you need to bump the patchlevel as well?
> 
> http://build.sagedev.org/release/builders/%20%20slow%20AIMS%20%20%28Debian%208%2064%20bit%29%20incremental/builds/143/steps/compile/logs/stdio


Bumping the patchlevel does not help.



---

archive/issue_comments_264218.json:
```json
{
    "body": "<a id='comment:49'></a>You need to add `arb` as dependency for the Sage library in `build/make/deps`.",
    "created_at": "2015-10-17T11:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264218",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:49'></a>You need to add `arb` as dependency for the Sage library in `build/make/deps`.



---

archive/issue_comments_264219.json:
```json
{
    "body": "<a id='comment:50'></a>Replying to [comment:49 jdemeyer]:\n> You need to add `arb` as dependency for the Sage library in `build/make/deps`.\n\n\nI'll try that soon (currently, I have no sage available due to recompilation).\n\nWhat I tried up to now:\n\n1. I checked out this ticket, ran `make distclean` and then `make`. This resulted in a version of sage *with* `arb`.\n2. I checkout out plain `6.10.beta0`, ran `make distclean` and then `make`, obviously resulting in a version without `arb`.\n3. I checked out this ticket, ran `./configure` and `make`. Now everything is recompiling (*including* arb), however, `git diff` does show empty output, so while this would solve the problem for me, I cannot push it to the ticket.\n\nWhat I do not understand: why is it necessary to add `arb` to `build/make/deps` for an existing version while it is unnecessary for a fresh install or for people running `./configure`?",
    "created_at": "2015-10-17T11:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264219",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:50'></a>Replying to [comment:49 jdemeyer]:
> You need to add `arb` as dependency for the Sage library in `build/make/deps`.


I'll try that soon (currently, I have no sage available due to recompilation).

What I tried up to now:

1. I checked out this ticket, ran `make distclean` and then `make`. This resulted in a version of sage *with* `arb`.
2. I checkout out plain `6.10.beta0`, ran `make distclean` and then `make`, obviously resulting in a version without `arb`.
3. I checked out this ticket, ran `./configure` and `make`. Now everything is recompiling (*including* arb), however, `git diff` does show empty output, so while this would solve the problem for me, I cannot push it to the ticket.

What I do not understand: why is it necessary to add `arb` to `build/make/deps` for an existing version while it is unnecessary for a fresh install or for people running `./configure`?



---

archive/issue_comments_264220.json:
```json
{
    "body": "<a id='comment:51'></a>Replying to [comment:50 cheuberg]:\n> What I do not understand: why is it necessary to add `arb` to `build/make/deps` for an existing version while it is unnecessary for a fresh install or for people running `./configure`?\n\n\nProbably the fact that `arb` starts with the letter `a`. Anyway, there is no point in analysing, the fix is obvious.",
    "created_at": "2015-10-17T12:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264220",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>Replying to [comment:50 cheuberg]:
> What I do not understand: why is it necessary to add `arb` to `build/make/deps` for an existing version while it is unnecessary for a fresh install or for people running `./configure`?


Probably the fact that `arb` starts with the letter `a`. Anyway, there is no point in analysing, the fix is obvious.



---

archive/issue_comments_264221.json:
```json
{
    "body": "<a id='comment:52'></a>Replying to [comment:51 jdemeyer]:\n> Probably the fact that `arb` starts with the letter `a`. Anyway, there is no point in analysing, the fix is obvious.\n\n\nUnfortunately, it is not obvious to me:\n\nFollowing Volker's recommendation, I increased the patchlevel, following your recommendation, I added to `build/make/deps`, but `arb` is still not built.\n\n```diff\ndiff --git a/build/make/deps b/build/make/deps\nindex 3d0fb93..27f488d 100644\n--- a/build/make/deps\n+++ b/build/make/deps\n@@ -100,6 +100,7 @@ base: $(INST)/$(BZIP2) $(INST)/$(PATCH) $(INST)/$(PKGCONF)\n # Sage library (e.g. CYTHON, JINJA2), and on the other hand all\n # dependencies for Cython files (e.g. PARI, NTL, SAGE_MP_LIBRARY).\n sagelib: \\\n+               $(INST)/$(ARB) \\\n                $(INST)/$(ATLAS) \\\n                $(INST)/$(CEPHES) \\\n                $(INST)/$(CLIQUER) \\\ndiff --git a/build/pkgs/arb/package-version.txt b/build/pkgs/arb/package-version.txt\nindex 8f0f703..67b2238 100644\n--- a/build/pkgs/arb/package-version.txt\n+++ b/build/pkgs/arb/package-version.txt\n@@ -1,2 +1,2 @@\n-2.6.0\n+2.6.0.p0\n\n```",
    "created_at": "2015-10-17T14:33:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264221",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:52'></a>Replying to [comment:51 jdemeyer]:
> Probably the fact that `arb` starts with the letter `a`. Anyway, there is no point in analysing, the fix is obvious.


Unfortunately, it is not obvious to me:

Following Volker's recommendation, I increased the patchlevel, following your recommendation, I added to `build/make/deps`, but `arb` is still not built.

```diff
diff --git a/build/make/deps b/build/make/deps
index 3d0fb93..27f488d 100644
--- a/build/make/deps
+++ b/build/make/deps
@@ -100,6 +100,7 @@ base: $(INST)/$(BZIP2) $(INST)/$(PATCH) $(INST)/$(PKGCONF)
 # Sage library (e.g. CYTHON, JINJA2), and on the other hand all
 # dependencies for Cython files (e.g. PARI, NTL, SAGE_MP_LIBRARY).
 sagelib: \
+               $(INST)/$(ARB) \
                $(INST)/$(ATLAS) \
                $(INST)/$(CEPHES) \
                $(INST)/$(CLIQUER) \
diff --git a/build/pkgs/arb/package-version.txt b/build/pkgs/arb/package-version.txt
index 8f0f703..67b2238 100644
--- a/build/pkgs/arb/package-version.txt
+++ b/build/pkgs/arb/package-version.txt
@@ -1,2 +1,2 @@
-2.6.0
+2.6.0.p0

```



---

archive/issue_comments_264222.json:
```json
{
    "body": "<a id='comment:53'></a>Did you remember to run `./configure` first? If yes and it still doesn't work, please push your non-working branch (with the change to `build/make/deps`) and I'll have a look.\n\nThere is absolutely no need to change the patchlevel if you don't change the package.",
    "created_at": "2015-10-17T15:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264222",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:53'></a>Did you remember to run `./configure` first? If yes and it still doesn't work, please push your non-working branch (with the change to `build/make/deps`) and I'll have a look.

There is absolutely no need to change the patchlevel if you don't change the package.



---

archive/issue_comments_264223.json:
```json
{
    "body": "<a id='comment:54'></a>Replying to [comment:53 jdemeyer]:\n> Did you remember to run `./configure` first? \n\n\nRunning `./configure` solves the problem locally, but does not change any files under version control, thus will not solve the problem for anybody else.\n\n> If yes and it still doesn't work, please push your non-working branch (with the change to `build/make/deps`) and I'll have a look.\n\n\nPushed and thanks for having a look.\n\n> There is absolutely no need to change the patchlevel if you don't change the package.\n\n\nok, this is not part of the pushed branch.\n\n---\nLast 10 new commits:",
    "created_at": "2015-10-17T16:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264223",
    "user": "https://github.com/cheuberg"
}
```

<a id='comment:54'></a>Replying to [comment:53 jdemeyer]:
> Did you remember to run `./configure` first? 


Running `./configure` solves the problem locally, but does not change any files under version control, thus will not solve the problem for anybody else.

> If yes and it still doesn't work, please push your non-working branch (with the change to `build/make/deps`) and I'll have a look.


Pushed and thanks for having a look.

> There is absolutely no need to change the patchlevel if you don't change the package.


ok, this is not part of the pushed branch.

---
Last 10 new commits:



---

archive/issue_comments_264224.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-17T18:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264224",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_264225.json:
```json
{
    "body": "<a id='comment:55'></a>Replying to [comment:54 cheuberg]:\n> Running `./configure` solves the problem locally, but does not change any files under version control, thus will not solve the problem for anybody else.\n\n\nBut `./configure` is run automatically whenever the Sage version changes. So, if this ticket is merged in the next beta, there will not be problem since the Sage version will also change.",
    "created_at": "2015-10-17T18:16:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264225",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:55'></a>Replying to [comment:54 cheuberg]:
> Running `./configure` solves the problem locally, but does not change any files under version control, thus will not solve the problem for anybody else.


But `./configure` is run automatically whenever the Sage version changes. So, if this ticket is merged in the next beta, there will not be problem since the Sage version will also change.



---

archive/issue_comments_264226.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-17T19:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264226",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264227.json:
```json
{
    "body": "<a id='comment:56'></a>Doesn't build so I can't test it on the buildbot\n\nhttp://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/501/steps/compile/logs/stdio",
    "created_at": "2015-10-17T19:36:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264227",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:56'></a>Doesn't build so I can't test it on the buildbot

http://build.sagedev.org/release/builders/%20%20fast%20Volker%20MiniMac%20%28OSX%2010.10%20x86_64%29%20incremental/builds/501/steps/compile/logs/stdio



---

archive/issue_comments_264228.json:
```json
{
    "body": "<a id='comment:57'></a>`@`vbraun: would it be possible to either:\n1. install autotools on the buildbot\n2. build from an sdist instead of from git on the buildbot\nto avoid these kinds of problems.",
    "created_at": "2015-10-17T20:14:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264228",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:57'></a>`@`vbraun: would it be possible to either:
1. install autotools on the buildbot
2. build from an sdist instead of from git on the buildbot
to avoid these kinds of problems.



---

archive/issue_comments_264229.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-17T20:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264229",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_264230.json:
```json
{
    "body": "<a id='comment:58'></a>Hang on, `configure.ac` didn't change, so autotools aren't needed here.\n\nDo the buildbots run `./configure` before building? If not, they should.",
    "created_at": "2015-10-17T20:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264230",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:58'></a>Hang on, `configure.ac` didn't change, so autotools aren't needed here.

Do the buildbots run `./configure` before building? If not, they should.



---

archive/issue_comments_264231.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-17T21:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264231",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264232.json:
```json
{
    "body": "<a id='comment:59'></a>They don't run configure, and thats not in http://doc.sagemath.org/html/en/installation/source.html. I don't mind adding it but the docs should be updated first then.",
    "created_at": "2015-10-17T21:17:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264232",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:59'></a>They don't run configure, and thats not in http://doc.sagemath.org/html/en/installation/source.html. I don't mind adding it but the docs should be updated first then.



---

archive/issue_comments_264233.json:
```json
{
    "body": "<a id='comment:60'></a>[It is documented](http://doc.sagemath.org/html/en/developer/packaging.html#building-the-package)",
    "created_at": "2015-10-17T21:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264233",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:60'></a>[It is documented](http://doc.sagemath.org/html/en/developer/packaging.html#building-the-package)



---

archive/issue_comments_264234.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-17T21:22:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264234",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_264235.json:
```json
{
    "body": "<a id='comment:61'></a>I'm against different instructions for build-from-source and build-from-source-with-ticket, thats unnecessary. And the buildbot can realistically only test one version anyways, so its save to assume that the other version is going to be broken. Also, not all buildbots have autotools (e.g. OSX doesn't).",
    "created_at": "2015-10-17T22:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264235",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:61'></a>I'm against different instructions for build-from-source and build-from-source-with-ticket, thats unnecessary. And the buildbot can realistically only test one version anyways, so its save to assume that the other version is going to be broken. Also, not all buildbots have autotools (e.g. OSX doesn't).



---

archive/issue_comments_264236.json:
```json
{
    "body": "<a id='comment:62'></a>So what would you propose then? This isn't going to be the last ticket with this problem.\n\nSee #19432 for a documentation improvement.",
    "created_at": "2015-10-18T07:03:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264236",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:62'></a>So what would you propose then? This isn't going to be the last ticket with this problem.

See #19432 for a documentation improvement.



---

archive/issue_comments_264237.json:
```json
{
    "body": "<a id='comment:63'></a>Basically we have to decide between\n* Create the makefile rules at configure-time. Then running configure is mandatory; It may work without configure, but there can't be any guarantee\n* Create the makefile rules from within make(*), using an include and auto-reload of changed includes. \nWe previously used the latter, why did we have to change that? The rules aren't configurable, they just reflect the package types and dependencies.\n\n(*) possibly by calling configure, though I'd prefer something more straightforward",
    "created_at": "2015-10-18T09:54:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264237",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:63'></a>Basically we have to decide between
* Create the makefile rules at configure-time. Then running configure is mandatory; It may work without configure, but there can't be any guarantee
* Create the makefile rules from within make(*), using an include and auto-reload of changed includes. 
We previously used the latter, why did we have to change that? The rules aren't configurable, they just reflect the package types and dependencies.

(*) possibly by calling configure, though I'd prefer something more straightforward



---

archive/issue_comments_264238.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-10-18T12:08:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264238",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_264239.json:
```json
{
    "body": "<a id='comment:65'></a>Replying to [comment:63 vbraun]:\n> We previously used the latter, why did we have to change that?\n\n\n1. the new \"install packages with dependencies\" means that `./sage -i PKGNAME` needs a lot more time (running `./configure` takes some time). In particular, [Simon King complained about this](https://groups.google.com/d/topic/sage-devel/fQCBuz8-d8k/discussion).\n\n2. `./configure && make` is the standard way to build packages.\n\n> The rules aren't configurable, they just reflect the package types and dependencies.\n\nThat's something which can (and should) change in the future. It would be cool to run for example\n\n```\n./configure --with-system-python --with-package=valgrind --enable-check=yes\n```",
    "created_at": "2015-10-18T12:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264239",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:65'></a>Replying to [comment:63 vbraun]:
> We previously used the latter, why did we have to change that?


1. the new "install packages with dependencies" means that `./sage -i PKGNAME` needs a lot more time (running `./configure` takes some time). In particular, [Simon King complained about this](https://groups.google.com/d/topic/sage-devel/fQCBuz8-d8k/discussion).

2. `./configure && make` is the standard way to build packages.

> The rules aren't configurable, they just reflect the package types and dependencies.

That's something which can (and should) change in the future. It would be cool to run for example

```
./configure --with-system-python --with-package=valgrind --enable-check=yes
```



---

archive/issue_comments_264240.json:
```json
{
    "body": "<a id='comment:66'></a>From now on, every ticket which tries to add a standard package will get set back to needs_work forever because the buildbot is broken?",
    "created_at": "2015-10-18T12:14:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264240",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:66'></a>From now on, every ticket which tries to add a standard package will get set back to needs_work forever because the buildbot is broken?



---

archive/issue_comments_264241.json:
```json
{
    "body": "<a id='comment:67'></a>Thats partly why I said that rerunning configure isn't the most straightforward way of updating the rules.\n\nConfigure switches can just override rules (e.g. using that explicit rules override pattern rules); that doesn't prevent us from writing a makefile that works by default.\n\nI agree that `./configure && make` is the standard way but this is not what Sage used to do so its more of a social problem to a) agree on changing it and b) communicating that change. Write to sage-devel.\n\nI don't think the buildbot is broken, it just does what the docs say and our users have learned to rely on. The alternative to fixing the configure/make system is always updating the confball if you change the set of standard packages.",
    "created_at": "2015-10-18T12:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264241",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:67'></a>Thats partly why I said that rerunning configure isn't the most straightforward way of updating the rules.

Configure switches can just override rules (e.g. using that explicit rules override pattern rules); that doesn't prevent us from writing a makefile that works by default.

I agree that `./configure && make` is the standard way but this is not what Sage used to do so its more of a social problem to a) agree on changing it and b) communicating that change. Write to sage-devel.

I don't think the buildbot is broken, it just does what the docs say and our users have learned to rely on. The alternative to fixing the configure/make system is always updating the confball if you change the set of standard packages.



---

archive/issue_comments_264242.json:
```json
{
    "body": "<a id='comment:68'></a>Replying to [comment:67 vbraun]:\n> Write to sage-devel.\n\nThat already happened when the change was made.\n\n> it just does what the docs say\n\nBuilding Sage, then checking out a specific git branch and then rebuilding is not a normal build from source. So I don't think the installation manual applies here. What does apply is the developer's guide which does mention `./configure` (see [comment:60]).\n\n> The alternative to fixing the configure/make system is always updating the confball if you change the set of standard packages. \n\nUpdating the confball is not going to help if you don't even run `./configure`.",
    "created_at": "2015-10-18T14:05:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264242",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:68'></a>Replying to [comment:67 vbraun]:
> Write to sage-devel.

That already happened when the change was made.

> it just does what the docs say

Building Sage, then checking out a specific git branch and then rebuilding is not a normal build from source. So I don't think the installation manual applies here. What does apply is the developer's guide which does mention `./configure` (see [comment:60]).

> The alternative to fixing the configure/make system is always updating the confball if you change the set of standard packages. 

Updating the confball is not going to help if you don't even run `./configure`.



---

archive/issue_comments_264243.json:
```json
{
    "body": "<a id='comment:69'></a>Volker, a different solution would be to change the Sage version number in the branch you test on the buildbots. That should force a reconfiguration and is closer to a user build.",
    "created_at": "2015-10-18T14:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264243",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:69'></a>Volker, a different solution would be to change the Sage version number in the branch you test on the buildbots. That should force a reconfiguration and is closer to a user build.



---

archive/issue_comments_264244.json:
```json
{
    "body": "<a id='comment:70'></a>Of course I can bump the version with each closed ticket but thats a bit silly....",
    "created_at": "2015-10-18T15:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264244",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:70'></a>Of course I can bump the version with each closed ticket but thats a bit silly....



---

archive/issue_comments_264245.json:
```json
{
    "body": "<a id='comment:71'></a>Replying to [comment:70 vbraun]:\n> Of course I can bump the version with each closed ticket but thats a bit silly....\n\n\nThat's of course *not* what he meant.\n\nIncreasing the Sage version when testing with tickets not yet merged into a public release seems natural, as you're doing so in order to prepare the *next* release, aren't you?",
    "created_at": "2015-10-18T15:50:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264245",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:71'></a>Replying to [comment:70 vbraun]:
> Of course I can bump the version with each closed ticket but thats a bit silly....


That's of course *not* what he meant.

Increasing the Sage version when testing with tickets not yet merged into a public release seems natural, as you're doing so in order to prepare the *next* release, aren't you?



---

archive/issue_comments_264246.json:
```json
{
    "body": "<a id='comment:72'></a>Most of the work is figuring out which tickets merge cleanly and pass tests. Actually bumping the version is trivial and I only do that at the end of the release process. Its not always clear at the outset what the next version will be, another beta or rc or release?",
    "created_at": "2015-10-18T15:57:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264246",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:72'></a>Most of the work is figuring out which tickets merge cleanly and pass tests. Actually bumping the version is trivial and I only do that at the end of the release process. Its not always clear at the outset what the next version will be, another beta or rc or release?



---

archive/issue_comments_264247.json:
```json
{
    "body": "<a id='comment:73'></a>Replying to [comment:72 vbraun]:\n> Most of the work is figuring out which tickets merge cleanly and pass tests. Actually bumping the version is trivial and I only do that at the end of the release process. Its not always clear at the outset what the next version will be, another beta or rc or release?\n\n\nSo it doesn't make much of a difference whether you change it at the beginning or at the end;  in the rare cases where the next version won't be *betaN+1* you could fix it again at the end, before releasing.  *What* the temporary, internal version number for testing actually is doesn't really matter much.",
    "created_at": "2015-10-18T16:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264247",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:73'></a>Replying to [comment:72 vbraun]:
> Most of the work is figuring out which tickets merge cleanly and pass tests. Actually bumping the version is trivial and I only do that at the end of the release process. Its not always clear at the outset what the next version will be, another beta or rc or release?


So it doesn't make much of a difference whether you change it at the beginning or at the end;  in the rare cases where the next version won't be *betaN+1* you could fix it again at the end, before releasing.  *What* the temporary, internal version number for testing actually is doesn't really matter much.



---

archive/issue_comments_264248.json:
```json
{
    "body": "<a id='comment:74'></a>You are proposing a more complicated release process without technical advantage, and which introduces additional differences between whats tested on the buildbot vs. what users end up doing. Sure it can be done, but why?",
    "created_at": "2015-10-18T16:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264248",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:74'></a>You are proposing a more complicated release process without technical advantage, and which introduces additional differences between whats tested on the buildbot vs. what users end up doing. Sure it can be done, but why?



---

archive/issue_comments_264249.json:
```json
{
    "body": "<a id='comment:75'></a>The problem here is that you're *now* actually testing in a different way or in a different setting than users will (or would) when the ticket got merged and a next version released.",
    "created_at": "2015-10-18T16:22:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264249",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:75'></a>The problem here is that you're *now* actually testing in a different way or in a different setting than users will (or would) when the ticket got merged and a next version released.



---

archive/issue_comments_264250.json:
```json
{
    "body": "<a id='comment:76'></a>At least I'm just running the same \"make\" command that users are going to use. How is only tesing \"configure && make\" ever going to give better test coverage?\n\nNo amount of testing can guard against misuses of the version stamp, but then onbody knows what the next version stamp is going to be beforehand.",
    "created_at": "2015-10-18T16:30:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264250",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:76'></a>At least I'm just running the same "make" command that users are going to use. How is only tesing "configure && make" ever going to give better test coverage?

No amount of testing can guard against misuses of the version stamp, but then onbody knows what the next version stamp is going to be beforehand.



---

archive/issue_comments_264251.json:
```json
{
    "body": "<a id='comment:77'></a>I'm lost: could someone please explain what work *this* ticket needs?",
    "created_at": "2015-10-20T11:40:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264251",
    "user": "https://github.com/mezzarobba"
}
```

<a id='comment:77'></a>I'm lost: could someone please explain what work *this* ticket needs?



---

archive/issue_comments_264252.json:
```json
{
    "body": "<a id='comment:78'></a>I've opened #19443",
    "created_at": "2015-10-20T22:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264252",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:78'></a>I've opened #19443



---

archive/issue_comments_264253.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2015-10-20T22:30:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264253",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_264254.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-10-30T08:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18546#issuecomment-264254",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_052136.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-10-30T08:33:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/18546",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/18546#event-52136"
}
```
