# Issue 13621: roots over IntegerModRing is horribly slow

Issue created by migration from https://trac.sagemath.org/ticket/13825

Original creator: zimmerma

Original creation time: 2012-12-12 15:31:14

Assignee: malb

Consider the following:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
sage: R.<x> = IntegerModRing(20000009)[]
sage: eq = x^6+x-17                      
sage: time eq.roots(multiplicities=False)
[3109038, 17207405]
Time: CPU 202.93 s, Wall: 203.65 s
```

A faster method would be (when the modulus is not too large) to factor it,
solve modulo the prime factors, and reconstruct using CRT:

```
sage: R.<x> = IntegerModRing(61)[]       
sage: eq = x^6+x-17                      
sage: time eq.roots(multiplicities=False)
[51, 37]
Time: CPU 0.00 s, Wall: 0.00 s
sage: R.<x> = IntegerModRing(327869)[]   
sage: eq = x^6+x-17                      
sage: time eq.roots(multiplicities=False)
[158217]
Time: CPU 0.00 s, Wall: 0.00 s
sage: crt([51,158217],[61,327869])
3109038
sage: crt([37,158217],[61,327869])
17207405
```



---

Comment by chapoton created at 2018-04-30 15:21:17

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-04-30 15:21:17

first tentative
----
New commits:


---

Comment by git created at 2018-04-30 18:04:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by zimmerma created at 2018-04-30 20:08:07

looks good to me. Just a tiny remark: if the modulus is not square free, we can also call
roots on each p<sup>k</sup> and use CRT. Even if roots mod p<sup>k</sup> is slow, this will be better. Otherwise I'm happy to give a positive review.


---

Comment by git created at 2018-05-01 08:12:04

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-05-01 08:14:47

Here is a slightly better version, that works also for non-square free modulus N. I still reduce to prime fields for p dividing N, solve there, use the c.r.t. to get back to solution modulo rad(N), and then a naive iteration to find solutions modulo N.


---

Comment by zimmerma created at 2018-05-01 12:51:28

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2018-05-01 12:51:28

this looks good to me. Great!


---

Comment by vbraun created at 2018-05-15 22:33:06

Resolution: fixed
