# Issue 25854: py3: hash for projective space

archive/issues_025854.json:
```json
{
    "body": "CC:  tmonteil @tscrim\n\npart of #24551\n\nIssue created by migration from https://trac.sagemath.org/ticket/26091\n\n",
    "created_at": "2018-08-19T07:07:55Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "py3: hash for projective space",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25854",
    "user": "https://github.com/fchapoton"
}
```
CC:  tmonteil @tscrim

part of #24551

Issue created by migration from https://trac.sagemath.org/ticket/26091





---

archive/issue_comments_364446.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-19T07:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364446",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_364447.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-08-19T07:08:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364447",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_364448.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-19T09:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364448",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364449.json:
```json
{
    "body": "`@`tmonteil, could you please help me fix the 32 bits hash, by running the following doctest with this branch on your 32 bit machine and reporting the result ?\n\n```\n            sage: P.<x,y> = ProjectiveSpace(Zmod(10), 1)\n            sage: hash(P([2, 5]))\n            -479010389                     # 32-bit\n```\n",
    "created_at": "2018-08-19T09:44:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364449",
    "user": "https://github.com/fchapoton"
}
```

`@`tmonteil, could you please help me fix the 32 bits hash, by running the following doctest with this branch on your 32 bit machine and reporting the result ?

```
            sage: P.<x,y> = ProjectiveSpace(Zmod(10), 1)
            sage: hash(P([2, 5]))
            -479010389                     # 32-bit
```




---

archive/issue_comments_364450.json:
```json
{
    "body": "I stopped my patchbot and restarted it on this ticket, see https://patchbot.sagemath.org/log/Pending/26091/debian/9.4/i686/4.9.0-6-686/tmonteil-debian-stretch-32/2018-08-19%2011:15:44",
    "created_at": "2018-08-19T11:17:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364450",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

I stopped my patchbot and restarted it on this ticket, see https://patchbot.sagemath.org/log/Pending/26091/debian/9.4/i686/4.9.0-6-686/tmonteil-debian-stretch-32/2018-08-19%2011:15:44



---

archive/issue_comments_364451.json:
```json
{
    "body": "And the result is:\n\n\n```\nsage -t --long src/sage/schemes/projective/projective_point.py\n**********************************************************************\nFile \"src/sage/schemes/projective/projective_point.py\", line 402, in sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring.__hash__\nFailed example:\n    hash(P([2, 5]))\nExpected:\n    -479010389                     \nGot:\n    -2047536788\n**********************************************************************\n```\n",
    "created_at": "2018-08-19T15:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364451",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

And the result is:


```
sage -t --long src/sage/schemes/projective/projective_point.py
**********************************************************************
File "src/sage/schemes/projective/projective_point.py", line 402, in sage.schemes.projective.projective_point.SchemeMorphism_point_projective_ring.__hash__
Failed example:
    hash(P([2, 5]))
Expected:
    -479010389                     
Got:
    -2047536788
**********************************************************************
```




---

archive/issue_comments_364452.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-19T15:24:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364452",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364453.json:
```json
{
    "body": "Merci beaucoup !",
    "created_at": "2018-08-19T15:24:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364453",
    "user": "https://github.com/fchapoton"
}
```

Merci beaucoup !



---

archive/issue_comments_364454.json:
```json
{
    "body": "Note that #23807 plans to solve this in a different way by making projective space use `UniqueRepresentation`.",
    "created_at": "2018-08-20T00:49:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364454",
    "user": "https://github.com/tscrim"
}
```

Note that #23807 plans to solve this in a different way by making projective space use `UniqueRepresentation`.



---

archive/issue_comments_364455.json:
```json
{
    "body": "Would you mind replacing the `sage: hash(P([2, 5]))` with `sage: hash(P([2, 5])) == hash(P([2, 5]))`? I find these 32/64 bit tests really annoying because you cannot update these easily.",
    "created_at": "2018-08-22T02:21:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364455",
    "user": "https://github.com/saraedum"
}
```

Would you mind replacing the `sage: hash(P([2, 5]))` with `sage: hash(P([2, 5])) == hash(P([2, 5]))`? I find these 32/64 bit tests really annoying because you cannot update these easily.



---

archive/issue_comments_364456.json:
```json
{
    "body": "If you changed that, it would be a positive review from me. But I haven't looked at #23807, so I leave it to you to figure out whether that one should go in instead.",
    "created_at": "2018-08-22T02:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364456",
    "user": "https://github.com/saraedum"
}
```

If you changed that, it would be a positive review from me. But I haven't looked at #23807, so I leave it to you to figure out whether that one should go in instead.



---

archive/issue_comments_364457.json:
```json
{
    "body": "I expect this to be done and merged before #23807.",
    "created_at": "2018-08-22T03:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364457",
    "user": "https://github.com/tscrim"
}
```

I expect this to be done and merged before #23807.



---

archive/issue_comments_364458.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-22T06:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364458",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_364459.json:
```json
{
    "body": "done (note that this is a case where the hash does not depend on the point..)",
    "created_at": "2018-08-22T06:06:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364459",
    "user": "https://github.com/fchapoton"
}
```

done (note that this is a case where the hash does not depend on the point..)



---

archive/issue_comments_364460.json:
```json
{
    "body": "Everything seems to be ok. Positive review, somebody ?",
    "created_at": "2018-08-26T15:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364460",
    "user": "https://github.com/fchapoton"
}
```

Everything seems to be ok. Positive review, somebody ?



---

archive/issue_comments_364461.json:
```json
{
    "body": "review, please",
    "created_at": "2018-08-29T18:33:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364461",
    "user": "https://github.com/fchapoton"
}
```

review, please



---

archive/issue_comments_364462.json:
```json
{
    "body": "should we wait for #23807 ?",
    "created_at": "2018-09-07T12:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364462",
    "user": "https://github.com/fchapoton"
}
```

should we wait for #23807 ?



---

archive/issue_comments_364463.json:
```json
{
    "body": "No, let's just get this in and rebase #23807 on this.",
    "created_at": "2018-09-07T23:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364463",
    "user": "https://github.com/tscrim"
}
```

No, let's just get this in and rebase #23807 on this.



---

archive/issue_comments_364464.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-09-07T23:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364464",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_364465.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2018-09-09T07:38:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364465",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_364466.json:
```json
{
    "body": "Ah, I just noticed this one.  Thanks.  I was just starting to fix this myself but then I remembered to check first (actually I had already added a hash for this class a while ago, but only as a quick hack--never got around to documenting it or anything, so this is better).",
    "created_at": "2018-09-12T14:17:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25854",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25854#issuecomment-364466",
    "user": "https://github.com/embray"
}
```

Ah, I just noticed this one.  Thanks.  I was just starting to fix this myself but then I remembered to check first (actually I had already added a hash for this class a while ago, but only as a quick hack--never got around to documenting it or anything, so this is better).
