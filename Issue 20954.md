# Issue 20954: Improve support for warnings in doctester

Issue created by migration from https://trac.sagemath.org/ticket/21191

Original creator: jdemeyer

Original creation time: 2016-08-08 13:13:56

CC:  tscrim chapoton

When a warning happens in the doctester, the source filename is always replaced by `doctest`.

We should also investigate whether we can display a more complete traceback instead of just the warning message.


---

Comment by jdemeyer created at 2016-08-16 12:17:09

New commits:


---

Comment by jdemeyer created at 2016-08-16 12:17:09

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-08-17 08:43:33

The link

```
+    INPUT: see :func:`warnings.showwarning`.
```

should rather be to doctest_showwarning, no ?


---

Comment by novoselt created at 2016-08-18 03:40:32

Is it only for doctests? As I have complained here https://groups.google.com/d/topic/sage-devel/-KiMrG--5x8/discussion it would be nice to have it for "regular" use as well and perhaps that fix should be done in IPython if possible.


---

Comment by jdemeyer created at 2016-08-18 08:49:39

Replying to [comment:4 chapoton]:
> The link
> {{{
> +    INPUT: see :func:`warnings.showwarning`.
> }}}
> should rather be to doctest_showwarning, no ?

No, it is supposed to be a link to https://docs.python.org/2/library/warnings.html#warnings.showwarning


---

Comment by jdemeyer created at 2016-08-18 08:50:23

Replying to [comment:5 novoselt]:
> Is it only for doctests?

Yes.

> As I have complained here https://groups.google.com/d/topic/sage-devel/-KiMrG--5x8/discussion it would be nice to have it for "regular" use as well and perhaps that fix should be done in IPython if possible.

Well, there was some discussion on sage-devel and other people considered it a bad idea in interactive usage...


---

Comment by novoselt created at 2016-08-19 02:35:05

Replying to [comment:7 jdemeyer]:
> Well, there was some discussion on sage-devel and other people considered it a bad idea in interactive usage...

Oh, I saw the beginning and it seemed objections were to long traceback for warnings. I didn't think anyone can object to displaying correct line over wrong one...


---

Comment by jdemeyer created at 2016-08-19 12:29:09

In any case, this ticket only affects doctests. We can still deal with the command-line if we want, but in a different ticket.


---

Comment by chapoton created at 2016-08-19 13:23:39

There seems to be a handful of failing doctests, see bot


---

Comment by git created at 2016-08-19 15:46:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-08-20 12:21:44

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2016-08-20 12:21:44

lgtm


---

Comment by vbraun created at 2016-08-21 23:39:36

Resolution: fixed
