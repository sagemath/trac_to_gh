# Issue 22667: numerical noise in sage/matrix/matrix_double_dense.pyx

Issue created by migration from https://trac.sagemath.org/ticket/22904

Original creator: fbissey

Original creation time: 2017-04-29 21:11:23

CC:  strogdon

I get the following doctest failures in sage-on-gentoo

```
sage -t --long /usr/lib64/python2.7/site-packages/sage/matrix/matrix_double_dense.pyx
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/matrix/matrix_double_dense.pyx", line 628, in sage.matrix.matrix_double_dense.Matrix_double_dense.condition
Failed example:
    A.condition(p=Infinity)  # tol 2e-14
Expected:
    22738.50000000045
Got:
    22738.499999999945
Tolerance exceeded:
    22738.50000000045 vs 22738.499999999945, tolerance 2e-14 > 2e-14
**********************************************************************
File "/usr/lib64/python2.7/site-packages/sage/matrix/matrix_double_dense.pyx", line 1787, in sage.matrix.matrix_double_dense.Matrix_double_dense.solve_left
Failed example:
    x = A.solve_left(b); x.zero_at(1e-17) # fix noisy zeroes
Expected:
    (0.666666666..., 0.0, 0.333333333...)
Got:
    (0.6666666666666666, 1.50030138462859e-17, 0.3333333333333332)
**********************************************************************
```

At first I thought it was caused by a difference in openblas version but it turns out out not to be the case. Probably hardware tuning related.

This ticket will raise the tolerance of these tests a little bit to accomodate the failure



---

Comment by fbissey created at 2017-04-29 21:12:31

Changing status from new to needs_review.


---

Comment by fbissey created at 2017-04-29 21:12:31

Hi Steve,

would you mind reviewing this? This is fairly minor.
----
New commits:


---

Comment by strogdon created at 2017-04-30 00:54:34

Changing status from needs_review to positive_review.


---

Comment by strogdon created at 2017-04-30 00:54:34

I suppose you get the same with vanilla. Here my SoG and vanilla are identical for the first example. There are only minor difference for the second, but no noise in the `zero` value. Openblas version does not seem to affect results here. I have had similar problems with this particular test in the past.


---

Comment by vbraun created at 2017-05-04 21:00:33

Resolution: fixed
