# Issue 10660: Implement edge-by-edge options for latexing graphs with dot2tex

archive/issues_010660.json:
```json
{
    "body": "Assignee: @nthiery\n\nCC:  sage-combinat @rbeezer\n\nKeywords: graph, latex, dot2tex\n\nImplement edge-by-edge options for latexing graphs with dot2tex\n\n\nHere we color in red all edges touching the vertex ``0``::\n\n```\n   sage: G = graphs.PetersenGraph()\n   sage: G.set_latex_options(format=\"dot2tex\", edge_options = lambda (u,v,label): { \"color\": \"red\" if u==0 else 1})\n   sage: view(G)\n```\n\nBy the way, this refactors the code of color_by_label to simplify its logic and generalize it for dot2tex output.\n\nIt also fixes a couple typos in the documentation, as well as\nlittle shortcomings in the quotation functions in dot2tex_utils.\n\nPatch also available from the Sage-Combinat queue:\nhttp://combinat.sagemath.org/patches/file/tip/trac_10723-graph_edge_options-nt.patch\n\nIssue created by migration from https://trac.sagemath.org/ticket/10723\n\n",
    "closed_at": "2011-03-18T13:40:56Z",
    "created_at": "2011-02-01T12:48:52Z",
    "labels": [
        "component: graph theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7",
    "title": "Implement edge-by-edge options for latexing graphs with dot2tex",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/10660",
    "user": "https://github.com/nthiery"
}
```
Assignee: @nthiery

CC:  sage-combinat @rbeezer

Keywords: graph, latex, dot2tex

Implement edge-by-edge options for latexing graphs with dot2tex


Here we color in red all edges touching the vertex ``0``::

```
   sage: G = graphs.PetersenGraph()
   sage: G.set_latex_options(format="dot2tex", edge_options = lambda (u,v,label): { "color": "red" if u==0 else 1})
   sage: view(G)
```

By the way, this refactors the code of color_by_label to simplify its logic and generalize it for dot2tex output.

It also fixes a couple typos in the documentation, as well as
little shortcomings in the quotation functions in dot2tex_utils.

Patch also available from the Sage-Combinat queue:
http://combinat.sagemath.org/patches/file/tip/trac_10723-graph_edge_options-nt.patch

Issue created by migration from https://trac.sagemath.org/ticket/10723





---

archive/issue_comments_111809.json:
```json
{
    "body": "(cc me)",
    "created_at": "2011-02-01T16:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111809",
    "user": "https://github.com/nathanncohen"
}
```

(cc me)



---

archive/issue_comments_111810.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-02-07T23:26:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111810",
    "user": "https://github.com/nthiery"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_111811.json:
```json
{
    "body": "For the record, until the testbot does its job: this patch passes all tests on massena (with a couple patches applied before in the Sage-Combinat queue, but they should be unrelated).",
    "created_at": "2011-02-07T23:55:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111811",
    "user": "https://github.com/nthiery"
}
```

For the record, until the testbot does its job: this patch passes all tests on massena (with a couple patches applied before in the Sage-Combinat queue, but they should be unrelated).



---

archive/issue_comments_111812.json:
```json
{
    "body": "Note: the patch does *not* apply on 4.6.1, hence the current failure of the testbot.\n\nOh, and I should mention: when I said \"all test pass\" above, that's to the exception of a couple timeouts in completely unrelated tests files.",
    "created_at": "2011-02-07T23:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111812",
    "user": "https://github.com/nthiery"
}
```

Note: the patch does *not* apply on 4.6.1, hence the current failure of the testbot.

Oh, and I should mention: when I said "all test pass" above, that's to the exception of a couple timeouts in completely unrelated tests files.



---

archive/issue_comments_111813.json:
```json
{
    "body": "Changing assignee from jason, ncohen, rlm to @nthiery.",
    "created_at": "2011-02-07T23:59:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111813",
    "user": "https://github.com/nthiery"
}
```

Changing assignee from jason, ncohen, rlm to @nthiery.



---

archive/issue_comments_111814.json:
```json
{
    "body": "Comment from Dan Bump:\n\nCurrently after #10723 if dot2tex is not installed there are some\ndoc failures in:\n\ngraph_plot.py\ngeneric_graph.py",
    "created_at": "2011-02-13T20:52:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111814",
    "user": "https://github.com/anneschilling"
}
```

Comment from Dan Bump:

Currently after #10723 if dot2tex is not installed there are some
doc failures in:

graph_plot.py
generic_graph.py



---

archive/issue_comments_111815.json:
```json
{
    "body": "It looks good to me from the user interface point of view: I especially like the feature that one can now use for a digraph G\n\nsage: G.set_latex_options(color_by_label = True)\n\nand Sage sets its own color scheme (or one can set less colors than edge labels and Sage chooses the rest).",
    "created_at": "2011-02-13T21:30:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111815",
    "user": "https://github.com/anneschilling"
}
```

It looks good to me from the user interface point of view: I especially like the feature that one can now use for a digraph G

sage: G.set_latex_options(color_by_label = True)

and Sage sets its own color scheme (or one can set less colors than edge labels and Sage chooses the rest).



---

archive/issue_comments_111816.json:
```json
{
    "body": "Some comments and suggestions from a first pass through the patch, experimenting with the code and running doctests.\n\ndot2tex_utils.py:\n\nline 95:  strips string representation of ``x`` *from* quotes and newlines.\n  Not part of the patch, but while you are here...\n  Native speaker advice:  I'd say \"strip string *of* quotes\"\n\n\ngeneric_graph.py:\n\nline 12199:\n  The doctest with the Cayley graph is not very instructive if you do not know what the (automatically-supplied) labels are - especially if you don't know any group theory.  Maybe just a line or two describing the graph's labels before you go to work with them?\n  \nline 12212:\n  I did not understand the warning until I re-read one of your emails.  \"Collision\" suggests to me that one edge is getting two colors (two colors in the same place).  Instead, I think you mean that the \"rainbow\" assignments as a default will provide a color to some other edge, which is identical to a color that is user-supplied for an edge.  Is that right?  I think this is a bit \"dangerous\" - a user could wonder how \"their\" color ended up on other edges?\n\n  In any event, I really like the rainbow colors for *all* of the edges as a default, but the minute there are some user-supplied colors, then I think the other edges should get a single default color (probably black).\n\ngraph_latex.py:\n  \n  line 226:  What happens when you try to  view(G)? (Answer: I think this is one of the doctest failures.)\n\n  line 534:  I really think `color_by_label`  should be  `edge_color_by_label`.  One might want to do exactly the same thing with the vertices in the future?  Or it should be unambiguous just what is being colored?\n\n  line 857:  `edge_labels`  (plural)  is a good change.\n\nDoctests:  4.6.2.alpha4, dot2tex-2.8.7-2, graphviz 2.26.3\n\nsage -t  devel/sage/sage/graphs/graph_plot.py # 12 doctests failed\n\nsage -t  devel/sage/sage/graphs/graph_latex.py # 1 doctests failed\n\nsage -t  devel/sage/sage/graphs/generic_graph.py # 4 doctests failed\n",
    "created_at": "2011-02-15T01:24:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111816",
    "user": "https://github.com/rbeezer"
}
```

Some comments and suggestions from a first pass through the patch, experimenting with the code and running doctests.

dot2tex_utils.py:

line 95:  strips string representation of ``x`` *from* quotes and newlines.
  Not part of the patch, but while you are here...
  Native speaker advice:  I'd say "strip string *of* quotes"


generic_graph.py:

line 12199:
  The doctest with the Cayley graph is not very instructive if you do not know what the (automatically-supplied) labels are - especially if you don't know any group theory.  Maybe just a line or two describing the graph's labels before you go to work with them?
  
line 12212:
  I did not understand the warning until I re-read one of your emails.  "Collision" suggests to me that one edge is getting two colors (two colors in the same place).  Instead, I think you mean that the "rainbow" assignments as a default will provide a color to some other edge, which is identical to a color that is user-supplied for an edge.  Is that right?  I think this is a bit "dangerous" - a user could wonder how "their" color ended up on other edges?

  In any event, I really like the rainbow colors for *all* of the edges as a default, but the minute there are some user-supplied colors, then I think the other edges should get a single default color (probably black).

graph_latex.py:
  
  line 226:  What happens when you try to  view(G)? (Answer: I think this is one of the doctest failures.)

  line 534:  I really think `color_by_label`  should be  `edge_color_by_label`.  One might want to do exactly the same thing with the vertices in the future?  Or it should be unambiguous just what is being colored?

  line 857:  `edge_labels`  (plural)  is a good change.

Doctests:  4.6.2.alpha4, dot2tex-2.8.7-2, graphviz 2.26.3

sage -t  devel/sage/sage/graphs/graph_plot.py # 12 doctests failed

sage -t  devel/sage/sage/graphs/graph_latex.py # 1 doctests failed

sage -t  devel/sage/sage/graphs/generic_graph.py # 4 doctests failed




---

archive/issue_comments_111817.json:
```json
{
    "body": "Hi Robert!\n\nThanks for your review.\n\nReplying to [comment:10 rbeezer]:\n> dot2tex_utils.py, line 95:  strips string representation of ``x`` *from* quotes and newlines.\n>   Not part of the patch, but while you are here...\n>   Native speaker advice:  I'd say \"strip string *of* quotes\"\n\n\nDone.\n\n> generic_graph.py:\n> \n> line 12199:\n>   The doctest with the Cayley graph is not very instructive if you do not know what the (automatically-supplied) labels are - especially if you don't know any group theory.  Maybe just a line or two describing the graph's labels before you go to work with them?\n\n\nDone.\n\n> line 12212:\n>   I did not understand the warning until I re-read one of your emails.  \"Collision\" suggests to me that one edge is getting two colors (two colors in the same place).  Instead, I think you mean that the \"rainbow\" assignments as a default will provide a color to some other edge, which is identical to a color that is user-supplied for an edge.  Is that right?  I think this is a bit \"dangerous\" - a user could wonder how \"their\" color ended up on other edges?\n> \n>   In any event, I really like the rainbow colors for *all* of the edges as a default, but the minute there are some user-supplied colors, then I think the other edges should get a single default color (probably black).\n\n\nAgreed. It now uses the default color.\n\n> graph_latex.py:\n>   \n>   line 226:  What happens when you try to  view(G)? (Answer: I think this is one of the doctest failures.)\n\n\nReplaced by a call to latex as above in the same file.\n\n>   line 534:  I really think `color_by_label`  should be  `edge_color_by_label`.  One might want to do exactly the same thing with the vertices in the future?  Or it should be unambiguous just what is being colored?\n\n\nI agree, but this option already exists with that name in\nplot/plot3d. So if we decide for this change then this should be done\neverywhere at once. I vote for postponing that to #10851.\n\n> Doctests:  4.6.2.alpha4, dot2tex-2.8.7-2, graphviz 2.26.3\n\n\n> sage -t  devel/sage/sage/graphs/graph_plot.py # 12 doctests failed\n\n\n> sage -t  devel/sage/sage/graphs/graph_latex.py # 1 doctests failed\n\n\n> sage -t  devel/sage/sage/graphs/generic_graph.py # 4 doctests failed\n\n\n\nAll test pass on my machine with the updated patch I'll upload soon.\nIf I did not screw up, this is both with and without dot2tex, as well\nas with -long and -optional.\n\nCheers,\n\t\t\tNicolas",
    "created_at": "2011-02-25T11:54:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111817",
    "user": "https://github.com/nthiery"
}
```

Hi Robert!

Thanks for your review.

Replying to [comment:10 rbeezer]:
> dot2tex_utils.py, line 95:  strips string representation of ``x`` *from* quotes and newlines.
>   Not part of the patch, but while you are here...
>   Native speaker advice:  I'd say "strip string *of* quotes"


Done.

> generic_graph.py:
> 
> line 12199:
>   The doctest with the Cayley graph is not very instructive if you do not know what the (automatically-supplied) labels are - especially if you don't know any group theory.  Maybe just a line or two describing the graph's labels before you go to work with them?


Done.

> line 12212:
>   I did not understand the warning until I re-read one of your emails.  "Collision" suggests to me that one edge is getting two colors (two colors in the same place).  Instead, I think you mean that the "rainbow" assignments as a default will provide a color to some other edge, which is identical to a color that is user-supplied for an edge.  Is that right?  I think this is a bit "dangerous" - a user could wonder how "their" color ended up on other edges?
> 
>   In any event, I really like the rainbow colors for *all* of the edges as a default, but the minute there are some user-supplied colors, then I think the other edges should get a single default color (probably black).


Agreed. It now uses the default color.

> graph_latex.py:
>   
>   line 226:  What happens when you try to  view(G)? (Answer: I think this is one of the doctest failures.)


Replaced by a call to latex as above in the same file.

>   line 534:  I really think `color_by_label`  should be  `edge_color_by_label`.  One might want to do exactly the same thing with the vertices in the future?  Or it should be unambiguous just what is being colored?


I agree, but this option already exists with that name in
plot/plot3d. So if we decide for this change then this should be done
everywhere at once. I vote for postponing that to #10851.

> Doctests:  4.6.2.alpha4, dot2tex-2.8.7-2, graphviz 2.26.3


> sage -t  devel/sage/sage/graphs/graph_plot.py # 12 doctests failed


> sage -t  devel/sage/sage/graphs/graph_latex.py # 1 doctests failed


> sage -t  devel/sage/sage/graphs/generic_graph.py # 4 doctests failed



All test pass on my machine with the updated patch I'll upload soon.
If I did not screw up, this is both with and without dot2tex, as well
as with -long and -optional.

Cheers,
			Nicolas



---

archive/issue_comments_111818.json:
```json
{
    "body": "Attachment [trac_10723-graph_edge_options-nt.patch](tarball://root/attachments/some-uuid/ticket10723/trac_10723-graph_edge_options-nt.patch) by @nthiery created at 2011-02-25 16:11:14",
    "created_at": "2011-02-25T16:11:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111818",
    "user": "https://github.com/nthiery"
}
```

Attachment [trac_10723-graph_edge_options-nt.patch](tarball://root/attachments/some-uuid/ticket10723/trac_10723-graph_edge_options-nt.patch) by @nthiery created at 2011-02-25 16:11:14



---

archive/issue_comments_111819.json:
```json
{
    "body": "Oops, some long tests were still failing. Fixed and uploaded updated patch.\n\nPart of the issue was due to the conflicting usage for edge_colors, where the specs said it was a dictionary, but it was used as a string in a couple places. I forked a separate option edge_color.\n\nSome optional tests are failing due to a glitch in dot2tex which I have reported upstream (asking for a dot2tex layout with neato is currently broken). In any cases, that's orthogonal to this patch.",
    "created_at": "2011-02-25T16:14:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111819",
    "user": "https://github.com/nthiery"
}
```

Oops, some long tests were still failing. Fixed and uploaded updated patch.

Part of the issue was due to the conflicting usage for edge_colors, where the specs said it was a dictionary, but it was used as a string in a couple places. I forked a separate option edge_color.

Some optional tests are failing due to a glitch in dot2tex which I have reported upstream (asking for a dot2tex layout with neato is currently broken). In any cases, that's orthogonal to this patch.



---

archive/issue_comments_111820.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2011-03-03T00:14:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111820",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_111821.json:
```json
{
    "body": "I have the dot2tex-2.8.7-2 spkg installed.\n\nI have a system-wide graphviz installed, but the Sage graphviz package won't build:\n\n```\nmake[3]: *** No rule to make target `../../plugin/pango/libgvplugin_pango.la', needed by `dot_builtins'.  Stop.\nmake[3]: *** Waiting for unfinished jobs....\nmv -f .deps/dot_builtins.Tpo .deps/dot_builtins.Po\nmv -f .deps/no_demand_loading.Tpo .deps/no_demand_loading.Po\nmv -f .deps/dot.Tpo .deps/dot.Po\nmake[3]: Leaving directory `/sage/dev/spkg/build/graphviz-2.16.1.p0/src/cmd/dot'\nmake[2]: *** [all-recursive] Error 1\nmake[2]: Leaving directory `/sage/dev/spkg/build/graphviz-2.16.1.p0/src/cmd'\nmake[1]: *** [all-recursive] Error 1\nmake[1]: Leaving directory `/sage/dev/spkg/build/graphviz-2.16.1.p0/src'\nmake: *** [all] Error 2\nError building Graphviz\n```\n\nIn this state, I get just a few failures using\n\n```\nsage -tp 9 -only-optional \"dot2tex\" sage/graphs\n```\n\nthat start with errors below.  What am I doing wrong?\n\nRob\n\n```\nsage -t -only-optional sage/graphs/generic_graph.py\nERROR    Failed to process input\nTraceback (most recent call last):\n  File \"/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py\", line 2928, in main\n    s =  conv.convert(dotdata)\n  File \"/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py\", line 848, in convert\n    return self.output()\n  File \"/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py\", line 2566, in output\n    positions[node.name] = map(int, pos.split(','))\nValueError: invalid literal for int() with base 10: '87.137'\nERROR    Failed to process input\nTraceback (most recent call last):\n  File \"/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py\", line 2928, in main\n    s =  conv.convert(dotdata)\n  File \"/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py\", line 848, in convert\n    return self.output()\n  File \"/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py\", line 2566, in output\n    positions[node.name] = map(int, pos.split(','))\nValueError: invalid literal for int() with base 10: '239.56'\n**********************************************************************\nFile \"/sage/dev/devel/sage-main/sage/graphs/generic_graph.py\", line 12702:\n    sage: g.plot(layout = \"graphviz\", prog = \"neato\") # optional - dot2tex, graphviz\nException raised:\n    Traceback (most recent call last):\n      File \"/sage/dev/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/sage/dev/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/sage/dev/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_0[6]>\", line 1, in <module>\n        g.plot(layout = \"graphviz\", prog = \"neato\") # optional - dot2tex, graphviz###line 12702:\n    sage: g.plot(layout = \"graphviz\", prog = \"neato\") # optional - dot2tex, graphviz\n      File \"/sage/dev/local/lib/python/site-packages/sage/misc/decorators.py\", line 432, in wrapper\n        return func(*args, **options)\n      File \"/sage/dev/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 13078, in plot\n        return GraphPlot(graph=self, options=options).plot()\n      File \"/sage/dev/local/lib/python/site-packages/sage/graphs/graph_plot.py\", line 95, in __init__\n        self.set_pos()\n      File \"/sage/dev/local/lib/python/site-packages/sage/graphs/graph_plot.py\", line 141, in set_pos\n        self._pos = self._graph.layout(**self._options)\n      File \"/sage/dev/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 12425, in layout\n        pos = getattr(self, \"layout_%s\"%layout)(dim = dim, **options)\n      File \"/sage/dev/local/lib/python/site-packages/sage/graphs/generic_graph.py\", line 12732, in layout_graphviz\n        return dict( (key_to_vertex[key], pos) for (key, pos) in positions.iteritems() )\n    AttributeError: 'str' object has no attribute 'iteritems'\n```",
    "created_at": "2011-03-03T00:14:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111821",
    "user": "https://github.com/rbeezer"
}
```

I have the dot2tex-2.8.7-2 spkg installed.

I have a system-wide graphviz installed, but the Sage graphviz package won't build:

```
make[3]: *** No rule to make target `../../plugin/pango/libgvplugin_pango.la', needed by `dot_builtins'.  Stop.
make[3]: *** Waiting for unfinished jobs....
mv -f .deps/dot_builtins.Tpo .deps/dot_builtins.Po
mv -f .deps/no_demand_loading.Tpo .deps/no_demand_loading.Po
mv -f .deps/dot.Tpo .deps/dot.Po
make[3]: Leaving directory `/sage/dev/spkg/build/graphviz-2.16.1.p0/src/cmd/dot'
make[2]: *** [all-recursive] Error 1
make[2]: Leaving directory `/sage/dev/spkg/build/graphviz-2.16.1.p0/src/cmd'
make[1]: *** [all-recursive] Error 1
make[1]: Leaving directory `/sage/dev/spkg/build/graphviz-2.16.1.p0/src'
make: *** [all] Error 2
Error building Graphviz
```

In this state, I get just a few failures using

```
sage -tp 9 -only-optional "dot2tex" sage/graphs
```

that start with errors below.  What am I doing wrong?

Rob

```
sage -t -only-optional sage/graphs/generic_graph.py
ERROR    Failed to process input
Traceback (most recent call last):
  File "/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py", line 2928, in main
    s =  conv.convert(dotdata)
  File "/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py", line 848, in convert
    return self.output()
  File "/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py", line 2566, in output
    positions[node.name] = map(int, pos.split(','))
ValueError: invalid literal for int() with base 10: '87.137'
ERROR    Failed to process input
Traceback (most recent call last):
  File "/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py", line 2928, in main
    s =  conv.convert(dotdata)
  File "/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py", line 848, in convert
    return self.output()
  File "/sage/dev/local/lib/python/site-packages/dot2tex/dot2tex.py", line 2566, in output
    positions[node.name] = map(int, pos.split(','))
ValueError: invalid literal for int() with base 10: '239.56'
**********************************************************************
File "/sage/dev/devel/sage-main/sage/graphs/generic_graph.py", line 12702:
    sage: g.plot(layout = "graphviz", prog = "neato") # optional - dot2tex, graphviz
Exception raised:
    Traceback (most recent call last):
      File "/sage/dev/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/sage/dev/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/sage/dev/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_0[6]>", line 1, in <module>
        g.plot(layout = "graphviz", prog = "neato") # optional - dot2tex, graphviz###line 12702:
    sage: g.plot(layout = "graphviz", prog = "neato") # optional - dot2tex, graphviz
      File "/sage/dev/local/lib/python/site-packages/sage/misc/decorators.py", line 432, in wrapper
        return func(*args, **options)
      File "/sage/dev/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 13078, in plot
        return GraphPlot(graph=self, options=options).plot()
      File "/sage/dev/local/lib/python/site-packages/sage/graphs/graph_plot.py", line 95, in __init__
        self.set_pos()
      File "/sage/dev/local/lib/python/site-packages/sage/graphs/graph_plot.py", line 141, in set_pos
        self._pos = self._graph.layout(**self._options)
      File "/sage/dev/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 12425, in layout
        pos = getattr(self, "layout_%s"%layout)(dim = dim, **options)
      File "/sage/dev/local/lib/python/site-packages/sage/graphs/generic_graph.py", line 12732, in layout_graphviz
        return dict( (key_to_vertex[key], pos) for (key, pos) in positions.iteritems() )
    AttributeError: 'str' object has no attribute 'iteritems'
```



---

archive/issue_comments_111822.json:
```json
{
    "body": "Replying to [comment:13 rbeezer]:\n> I have the dot2tex-2.8.7-2 spkg installed.\n> \n> I have a system-wide graphviz installed, but the Sage graphviz package won't build:\n\n\nPlease create a ticket about the Sage graphviz package (if it does not already exists). Honestly, I always use my system-wide install :-)\n \n> In this state, I get just a few failures using\n> \n> \n> ```\n> sage -tp 9 -only-optional \"dot2tex\" sage/graphs\n> ```\n> \n> that start with errors below.  What am I doing wrong?\n\n\nThat's exactly what I meant with the above comment:\n``Some optional tests are failing due to a glitch in dot2tex which I have reported upstream (asking for a dot2tex layout with neato is currently broken). In any cases, that's orthogonal to this patch.''\n\nCheers,\n                 Nicolas",
    "created_at": "2011-03-03T08:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111822",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:13 rbeezer]:
> I have the dot2tex-2.8.7-2 spkg installed.
> 
> I have a system-wide graphviz installed, but the Sage graphviz package won't build:


Please create a ticket about the Sage graphviz package (if it does not already exists). Honestly, I always use my system-wide install :-)
 
> In this state, I get just a few failures using
> 
> 
> ```
> sage -tp 9 -only-optional "dot2tex" sage/graphs
> ```
> 
> that start with errors below.  What am I doing wrong?


That's exactly what I meant with the above comment:
``Some optional tests are failing due to a glitch in dot2tex which I have reported upstream (asking for a dot2tex layout with neato is currently broken). In any cases, that's orthogonal to this patch.''

Cheers,
                 Nicolas



---

archive/issue_comments_111823.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-03-03T08:18:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111823",
    "user": "https://github.com/nthiery"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_111824.json:
```json
{
    "body": "Hi Robert!\n\nWould you have a chance to finalize the review soon?\n\n#10632 and #10485 basically just depend on this.\n\nThanks!\n                       Nicolas",
    "created_at": "2011-03-10T08:00:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111824",
    "user": "https://github.com/nthiery"
}
```

Hi Robert!

Would you have a chance to finalize the review soon?

#10632 and #10485 basically just depend on this.

Thanks!
                       Nicolas



---

archive/issue_comments_111825.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-03-11T04:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111825",
    "user": "https://github.com/rbeezer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_111826.json:
```json
{
    "body": "Hi Nicolas,\n\nSorry for the delay on this one.  I didn't realize it was holding up some other tickets.  Thanks for the changes.  I let the failure of graphviz to install throw me off and I forgot your warning on the optional test failures.  I'll pursue reporting the problem with the graphviz package.\n\nThis passes all non-optional tests, with or without, dot2tex installed, documentation builds fine, and works as advertised.  So positive review.\n\nAnd yes, we should try to coordinate sometime on the different approaches to making these pretty pictures.\n\nRob",
    "created_at": "2011-03-11T04:41:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111826",
    "user": "https://github.com/rbeezer"
}
```

Hi Nicolas,

Sorry for the delay on this one.  I didn't realize it was holding up some other tickets.  Thanks for the changes.  I let the failure of graphviz to install throw me off and I forgot your warning on the optional test failures.  I'll pursue reporting the problem with the graphviz package.

This passes all non-optional tests, with or without, dot2tex installed, documentation builds fine, and works as advertised.  So positive review.

And yes, we should try to coordinate sometime on the different approaches to making these pretty pictures.

Rob



---

archive/issue_comments_111827.json:
```json
{
    "body": "Nicolas,\n\ngraphviz failure is known, old, and both of us are on the ticket.  ;-)\n\n#7438\n\nRob",
    "created_at": "2011-03-11T04:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111827",
    "user": "https://github.com/rbeezer"
}
```

Nicolas,

graphviz failure is known, old, and both of us are on the ticket.  ;-)

#7438

Rob



---

archive/issue_comments_111828.json:
```json
{
    "body": "Hi Rob!\n\nReplying to [comment:16 rbeezer]:\n> Sorry for the delay on this one.  I didn't realize it was holding up some other tickets.  \n\n\nI should have mentioned it in the first place :-)\n\n> Thanks for the changes.  I let the failure of graphviz to install throw me off and I forgot your warning on the optional test failures.  I'll pursue reporting the problem with the graphviz package.\n> \n> This passes all non-optional tests, with or without, dot2tex installed, documentation builds fine, and works as advertised.  So positive review.\n\n\nThanks much for the review!\n\n> And yes, we should try to coordinate sometime on the different approaches to making these pretty pictures.\n\n\nAnd even prettier :-)\n\nCheers,\n                      Nicolas",
    "created_at": "2011-03-14T16:06:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111828",
    "user": "https://github.com/nthiery"
}
```

Hi Rob!

Replying to [comment:16 rbeezer]:
> Sorry for the delay on this one.  I didn't realize it was holding up some other tickets.  


I should have mentioned it in the first place :-)

> Thanks for the changes.  I let the failure of graphviz to install throw me off and I forgot your warning on the optional test failures.  I'll pursue reporting the problem with the graphviz package.
> 
> This passes all non-optional tests, with or without, dot2tex installed, documentation builds fine, and works as advertised.  So positive review.


Thanks much for the review!

> And yes, we should try to coordinate sometime on the different approaches to making these pretty pictures.


And even prettier :-)

Cheers,
                      Nicolas



---

archive/issue_comments_111829.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-03-18T13:40:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/10660#issuecomment-111829",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_027617.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-03-18T13:40:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/10660",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/10660#event-27617"
}
```
