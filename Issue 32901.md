# Issue 32901: Ignoring --build-option when building numpy using PEP 517

Issue created by migration from https://trac.sagemath.org/ticket/33138

Original creator: mkoeppe

Original creation time: 2022-01-10 00:11:31

CC:  dimpase @kliem jhpalmieri culler

Seen in https://trac.sagemath.org/attachment/ticket/33070/numpy-1.21.4.log

The change made as part of #32046, using `pip wheel --build-option ...` (instead of `setup.py bdist_wheel...`) seems to have broken the use of said build options when the package is a PEP 517 package (i.e., has `pyproject.toml`)

Among the packages found by `git grep sdh_prefix`, only **numpy** is 
affected (the others, `python_igraph`, `jupyter_jsmol`, `pillow` (with do not have `pyproject.toml`).

The build options for numpy are in particular needed for `SAGE_FAT_BINARY=yes` builds. (Hence "blocker" for Sage 9.5.)


---

Comment by mkoeppe created at 2022-01-10 00:19:54

New commits:


---

Comment by mkoeppe created at 2022-01-10 00:19:54

Changing status from new to needs_review.


---

Comment by dimpase created at 2022-01-10 12:44:50

see #33083#comment:45 - it throws an error, saying that
`setup.py clean` is not supported.
(this is actually a by-product of a failing build)


---

Comment by dimpase created at 2022-01-12 11:05:15

OK, assuming the inability to build on Alpine in lxc (as reported on #33083) has nothing to do with this.


---

Comment by dimpase created at 2022-01-12 11:05:15

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-01-12 16:23:20

Thanks.


---

Comment by vbraun created at 2022-01-12 23:52:06

Resolution: fixed


---

Comment by mkoeppe created at 2022-08-25 17:58:57

Replying to [ticket:33138 mkoeppe]:
> Among the packages found by `git grep sdh_prefix`, only **numpy** is 
> affected (the others, `python_igraph`, `jupyter_jsmol`, `pillow`, do not have `pyproject.toml`).

Follow-up for these packages in #34430, #34421, #34433.
