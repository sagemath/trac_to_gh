# Issue 32901: Ignoring --build-option when building numpy using PEP 517

archive/issues_032901.json:
```json
{
    "body": "CC:  @dimpase @kliem @jhpalmieri @culler\n\nSeen in https://trac.sagemath.org/attachment/ticket/33070/numpy-1.21.4.log\n\nThe change made as part of #32046, using `pip wheel --build-option ...` (instead of `setup.py bdist_wheel...`) seems to have broken the use of said build options when the package is a PEP 517 package (i.e., has `pyproject.toml`)\n\nAmong the packages found by `git grep sdh_prefix`, only **numpy** is \naffected (the others, `python_igraph`, `jupyter_jsmol`, `pillow` (with do not have `pyproject.toml`).\n\nThe build options for numpy are in particular needed for `SAGE_FAT_BINARY=yes` builds. (Hence \"blocker\" for Sage 9.5.)\n\nIssue created by migration from https://trac.sagemath.org/ticket/33138\n\n",
    "created_at": "2022-01-10T00:11:31Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.5",
    "title": "Ignoring --build-option when building numpy using PEP 517",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32901",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dimpase @kliem @jhpalmieri @culler

Seen in https://trac.sagemath.org/attachment/ticket/33070/numpy-1.21.4.log

The change made as part of #32046, using `pip wheel --build-option ...` (instead of `setup.py bdist_wheel...`) seems to have broken the use of said build options when the package is a PEP 517 package (i.e., has `pyproject.toml`)

Among the packages found by `git grep sdh_prefix`, only **numpy** is 
affected (the others, `python_igraph`, `jupyter_jsmol`, `pillow` (with do not have `pyproject.toml`).

The build options for numpy are in particular needed for `SAGE_FAT_BINARY=yes` builds. (Hence "blocker" for Sage 9.5.)

Issue created by migration from https://trac.sagemath.org/ticket/33138





---

archive/issue_comments_468684.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-01-10T00:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468684",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_468685.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-10T00:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468685",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_468686.json:
```json
{
    "body": "see #33083#comment:45 - it throws an error, saying that\n`setup.py clean` is not supported.\n(this is actually a by-product of a failing build)",
    "created_at": "2022-01-10T12:44:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468686",
    "user": "https://github.com/dimpase"
}
```

see #33083#comment:45 - it throws an error, saying that
`setup.py clean` is not supported.
(this is actually a by-product of a failing build)



---

archive/issue_comments_468687.json:
```json
{
    "body": "OK, assuming the inability to build on Alpine in lxc (as reported on #33083) has nothing to do with this.",
    "created_at": "2022-01-12T11:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468687",
    "user": "https://github.com/dimpase"
}
```

OK, assuming the inability to build on Alpine in lxc (as reported on #33083) has nothing to do with this.



---

archive/issue_comments_468688.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-01-12T11:05:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468688",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_468689.json:
```json
{
    "body": "Thanks.",
    "created_at": "2022-01-12T16:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468689",
    "user": "https://github.com/mkoeppe"
}
```

Thanks.



---

archive/issue_events_029806.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-01-12T23:52:06Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32901#event-29806"
}
```



---

archive/issue_comments_468690.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-01-12T23:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468690",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_468691.json:
```json
{
    "body": "Replying to [ticket:33138 mkoeppe]:\n> Among the packages found by `git grep sdh_prefix`, only **numpy** is \n> affected (the others, `python_igraph`, `jupyter_jsmol`, `pillow`, do not have `pyproject.toml`).\n\nFollow-up for these packages in #34430, #34421, #34433.",
    "created_at": "2022-08-25T17:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32901",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32901#issuecomment-468691",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [ticket:33138 mkoeppe]:
> Among the packages found by `git grep sdh_prefix`, only **numpy** is 
> affected (the others, `python_igraph`, `jupyter_jsmol`, `pillow`, do not have `pyproject.toml`).

Follow-up for these packages in #34430, #34421, #34433.
