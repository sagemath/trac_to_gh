# Issue 21324: OpenBLAS package fails to build

archive/issues_021324.json:
```json
{
    "body": "CC:  @strogdon\n\nIn #20096, OpenBLAS was made standard in place of ATLAS, but the build fails:\n\n\n```\n...\ngcc -c -O2 -DMAX_STACK_ALLOC=2048 -Wall -m64 -DF_INTERFACE_GFORT -fPIC -DSMP_SERVER -DNO_WARMUP -DMAX_CPU_NUMBER=4 -DASMNAME= -DASMFNAME=_ -DNAME=_ -DCNAME= -DCHAR_NAME=\"_\" -DCHAR_CNAME=\"\" -DNO_AFFINITY -I. -DHAVE_LAPACK_CONFIG_H -I ../include -o lapacke_chpgvx.o lapacke_chpgvx.c\nIn file included from ../include/lapacke_utils.h:37:0,\n                 from lapacke_chpgvx.c:34:\n../include/lapacke.h:889:1: warning: null character(s) ignored\n                             lapack_int ldb, lapack_complex_float* x,\n ^\nIn file included from ../include/lapacke_utils.h:37:0,\n                 from lapacke_chpgvx.c:34:\n../include/lapacke.h:889:8216: error: unknown type name 'ued'\n                             lapack_int ldb, lapack_complex_float* x,\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/21561\n\n",
    "created_at": "2016-09-22T12:32:42Z",
    "labels": [
        "build",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "OpenBLAS package fails to build",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21324",
    "user": "@orlitzky"
}
```
CC:  @strogdon

In #20096, OpenBLAS was made standard in place of ATLAS, but the build fails:


```
...
gcc -c -O2 -DMAX_STACK_ALLOC=2048 -Wall -m64 -DF_INTERFACE_GFORT -fPIC -DSMP_SERVER -DNO_WARMUP -DMAX_CPU_NUMBER=4 -DASMNAME= -DASMFNAME=_ -DNAME=_ -DCNAME= -DCHAR_NAME="_" -DCHAR_CNAME="" -DNO_AFFINITY -I. -DHAVE_LAPACK_CONFIG_H -I ../include -o lapacke_chpgvx.o lapacke_chpgvx.c
In file included from ../include/lapacke_utils.h:37:0,
                 from lapacke_chpgvx.c:34:
../include/lapacke.h:889:1: warning: null character(s) ignored
                             lapack_int ldb, lapack_complex_float* x,
 ^
In file included from ../include/lapacke_utils.h:37:0,
                 from lapacke_chpgvx.c:34:
../include/lapacke.h:889:8216: error: unknown type name 'ued'
                             lapack_int ldb, lapack_complex_float* x,
```


Issue created by migration from https://trac.sagemath.org/ticket/21561





---

archive/issue_comments_295915.json:
```json
{
    "body": "Attachment [openblas-0.2.15.log.gz](tarball://root/attachments/some-uuid/ticket21561/openblas-0.2.15.log.gz) by @orlitzky created at 2016-09-22 12:33:14\n\nBuild log for openblas-0.2.15",
    "created_at": "2016-09-22T12:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295915",
    "user": "@orlitzky"
}
```

Attachment [openblas-0.2.15.log.gz](tarball://root/attachments/some-uuid/ticket21561/openblas-0.2.15.log.gz) by @orlitzky created at 2016-09-22 12:33:14

Build log for openblas-0.2.15



---

archive/issue_comments_295916.json:
```json
{
    "body": "See https://groups.google.com/forum/#!topic/sage-devel/1mtIT4FcaOk for another failure.",
    "created_at": "2016-09-26T19:14:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295916",
    "user": "@mantepse"
}
```

See https://groups.google.com/forum/#!topic/sage-devel/1mtIT4FcaOk for another failure.



---

archive/issue_comments_295917.json:
```json
{
    "body": "Can you try the latest upstream version?\nThat's currently 0.2.19.",
    "created_at": "2016-09-27T09:45:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295917",
    "user": "jpflori"
}
```

Can you try the latest upstream version?
That's currently 0.2.19.



---

archive/issue_comments_295918.json:
```json
{
    "body": "I'm wondering if the hardened profile `gcc version 4.9.3 (Gentoo Hardened 4.9.3 p1.5, pie-0.6.4` is doing something strange. I have `gcc version 4.9.3 (Gentoo 4.9.3 p1.5, pie-0.6.4)` and it (0.2.15) builds for me, but my hardware is fairly old.",
    "created_at": "2016-09-27T14:15:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295918",
    "user": "@strogdon"
}
```

I'm wondering if the hardened profile `gcc version 4.9.3 (Gentoo Hardened 4.9.3 p1.5, pie-0.6.4` is doing something strange. I have `gcc version 4.9.3 (Gentoo 4.9.3 p1.5, pie-0.6.4)` and it (0.2.15) builds for me, but my hardware is fairly old.



---

archive/issue_comments_295919.json:
```json
{
    "body": "Until we merge a working version of OpenBLAS, we should probably revert the default to ATLAS.\n\nThe current version in Sage apparently crashes (or makes other parts of Sage crash) on any \"recent\" AMD CPU (Bulldozer, Piledriver aka `bdver1`, `bdver2` / Opteron 62xx, 63xx, etc.).",
    "created_at": "2016-10-02T13:27:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295919",
    "user": "@nexttime"
}
```

Until we merge a working version of OpenBLAS, we should probably revert the default to ATLAS.

The current version in Sage apparently crashes (or makes other parts of Sage crash) on any "recent" AMD CPU (Bulldozer, Piledriver aka `bdver1`, `bdver2` / Opteron 62xx, 63xx, etc.).



---

archive/issue_comments_295920.json:
```json
{
    "body": "See #21627 for updating openblas.",
    "created_at": "2016-10-03T12:36:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295920",
    "user": "jpflori"
}
```

See #21627 for updating openblas.



---

archive/issue_comments_295921.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-08-27T05:53:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295921",
    "user": "@mantepse"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_295922.json:
```json
{
    "body": "No longer relevant",
    "created_at": "2018-08-27T05:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295922",
    "user": "@mantepse"
}
```

No longer relevant



---

archive/issue_comments_295923.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2018-08-27T05:54:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295923",
    "user": "@mantepse"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_295924.json:
```json
{
    "body": "Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295924",
    "user": "@embray"
}
```

Presuming these are all correctly reviewed as either duplicate, invalid, or wontfix.



---

archive/issue_comments_295925.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2019-02-26T13:58:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21324",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21324#issuecomment-295925",
    "user": "@embray"
}
```

Resolution: invalid
