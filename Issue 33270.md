# Issue 33270: sagemath_doc_html: Use pythreejs for 3D graphics

archive/issues_033270.json:
```json
{
    "body": "CC:  @kwankyu @jhpalmieri @nthiery @egourgoulhon @dimpase\n\nThe Sphinx documentation of `pythreejs` has proper 3D graphics, see for example\nhttps://pythreejs.readthedocs.io/en/stable/examples/Animation.html \n\nWe should be able to do the same.\n\nIssue created by migration from https://trac.sagemath.org/ticket/33507\n\n",
    "created_at": "2022-03-15T20:50:22Z",
    "labels": [
        "documentation",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "sagemath_doc_html: Use pythreejs for 3D graphics",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/33270",
    "user": "@mkoeppe"
}
```
CC:  @kwankyu @jhpalmieri @nthiery @egourgoulhon @dimpase

The Sphinx documentation of `pythreejs` has proper 3D graphics, see for example
https://pythreejs.readthedocs.io/en/stable/examples/Animation.html 

We should be able to do the same.

Issue created by migration from https://trac.sagemath.org/ticket/33507





---

archive/issue_comments_473640.json:
```json
{
    "body": "It uses nbsphinx: https://nbsphinx.readthedocs.io/en/0.8.8/\n\nnbsphinx allows including jupyter notebooks in toctrees. It seems that we cannot include a single cell of a jupyter notebook as a part of our documentation, which I guess is what we want.",
    "created_at": "2022-03-16T03:58:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473640",
    "user": "@kwankyu"
}
```

It uses nbsphinx: https://nbsphinx.readthedocs.io/en/0.8.8/

nbsphinx allows including jupyter notebooks in toctrees. It seems that we cannot include a single cell of a jupyter notebook as a part of our documentation, which I guess is what we want.



---

archive/issue_comments_473641.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-16T05:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473641",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473642.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-16T05:08:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473642",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_473643.json:
```json
{
    "body": "This tool \n\nhttps://jupyter-sphinx.readthedocs.io/en/latest/\n\nworks well.\n\nI uploaded a branch to experiment with the tool. First `sage -pip install jupyter-sphinx`.",
    "created_at": "2022-03-16T05:10:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473643",
    "user": "@kwankyu"
}
```

This tool 

https://jupyter-sphinx.readthedocs.io/en/latest/

works well.

I uploaded a branch to experiment with the tool. First `sage -pip install jupyter-sphinx`.



---

archive/issue_comments_473644.json:
```json
{
    "body": "This package would be easy to add, we already have all dependencies -  https://github.com/jupyter/jupyter-sphinx/blob/master/setup.py#L30",
    "created_at": "2022-03-16T05:28:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473644",
    "user": "@mkoeppe"
}
```

This package would be easy to add, we already have all dependencies -  https://github.com/jupyter/jupyter-sphinx/blob/master/setup.py#L30



---

archive/issue_comments_473645.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-16T05:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473645",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473646.json:
```json
{
    "body": "We need a sagemath binder repo for Thebe to work.",
    "created_at": "2022-03-16T08:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473646",
    "user": "@kwankyu"
}
```

We need a sagemath binder repo for Thebe to work.



---

archive/issue_comments_473647.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-17T04:53:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473647",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473648.json:
```json
{
    "body": "The last commit provides an example to provide live images to htmls and static images to pdfs.",
    "created_at": "2022-03-17T05:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473648",
    "user": "@kwankyu"
}
```

The last commit provides an example to provide live images to htmls and static images to pdfs.



---

archive/issue_comments_473649.json:
```json
{
    "body": "One annoying thing is that `.. only:: latex` works but `.. only:: pdf` doesn't.",
    "created_at": "2022-03-17T05:18:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473649",
    "user": "@kwankyu"
}
```

One annoying thing is that `.. only:: latex` works but `.. only:: pdf` doesn't.



---

archive/issue_comments_473650.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-17T05:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473650",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473651.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-17T07:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473651",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473652.json:
```json
{
    "body": "Here's the package",
    "created_at": "2022-03-17T07:13:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473652",
    "user": "@mkoeppe"
}
```

Here's the package



---

archive/issue_comments_473653.json:
```json
{
    "body": "Replying to [comment:10 klee]:\n> We need a sagemath binder repo for Thebe to work.\n\nI fixed 'Sage binder env' about a month ago:\n\nhttps://github.com/sagemath/sage-binder-env\n\nIt now uses conda to install Sage which is more maintained than\nSage's docker image.",
    "created_at": "2022-03-17T08:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473653",
    "user": "@nthiery"
}
```

Replying to [comment:10 klee]:
> We need a sagemath binder repo for Thebe to work.

I fixed 'Sage binder env' about a month ago:

https://github.com/sagemath/sage-binder-env

It now uses conda to install Sage which is more maintained than
Sage's docker image.



---

archive/issue_comments_473654.json:
```json
{
    "body": "Replying to [comment:16 mkoeppe]:\n> Here's the package\n\nThank you!",
    "created_at": "2022-03-17T08:29:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473654",
    "user": "@kwankyu"
}
```

Replying to [comment:16 mkoeppe]:
> Here's the package

Thank you!



---

archive/issue_comments_473655.json:
```json
{
    "body": "Replying to [comment:17 nthiery]:\n> Replying to [comment:10 klee]:\n> > We need a sagemath binder repo for Thebe to work.\n> \n> I fixed 'Sage binder env' about a month ago:\n> \n> https://github.com/sagemath/sage-binder-env\n> \n> It now uses conda to install Sage which is more maintained than\n> Sage's docker image.\n\nI have no experience with Thebe. Jupyter-sphinx supports Thebe. But running an interact example cell through jupyter-sphinx only shows `Waiting for kernel...`. Is this supposed to take long? Would the interact work well once the kernel is up?",
    "created_at": "2022-03-17T08:52:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473655",
    "user": "@kwankyu"
}
```

Replying to [comment:17 nthiery]:
> Replying to [comment:10 klee]:
> > We need a sagemath binder repo for Thebe to work.
> 
> I fixed 'Sage binder env' about a month ago:
> 
> https://github.com/sagemath/sage-binder-env
> 
> It now uses conda to install Sage which is more maintained than
> Sage's docker image.

I have no experience with Thebe. Jupyter-sphinx supports Thebe. But running an interact example cell through jupyter-sphinx only shows `Waiting for kernel...`. Is this supposed to take long? Would the interact work well once the kernel is up?



---

archive/issue_comments_473656.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-18T09:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473656",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473657.json:
```json
{
    "body": "Replying to [comment:19 klee]:\n> Replying to [comment:17 nthiery]:\n> > Replying to [comment:10 klee]:\n> > > We need a sagemath binder repo for Thebe to work.\n> > \n> > I fixed 'Sage binder env' about a month ago:\n> > \n> > https://github.com/sagemath/sage-binder-env\n> > \n> > It now uses conda to install Sage which is more maintained than\n> > Sage's docker image.\n> \n> I have no experience with Thebe. Jupyter-sphinx supports Thebe. But running an interact example cell through jupyter-sphinx only shows `Waiting for kernel...`. Is this supposed to take long? Would the interact work well once the kernel is up?\n\nIt now seems work almost...only that the sage in conda doesn't work well.",
    "created_at": "2022-03-18T09:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473657",
    "user": "@kwankyu"
}
```

Replying to [comment:19 klee]:
> Replying to [comment:17 nthiery]:
> > Replying to [comment:10 klee]:
> > > We need a sagemath binder repo for Thebe to work.
> > 
> > I fixed 'Sage binder env' about a month ago:
> > 
> > https://github.com/sagemath/sage-binder-env
> > 
> > It now uses conda to install Sage which is more maintained than
> > Sage's docker image.
> 
> I have no experience with Thebe. Jupyter-sphinx supports Thebe. But running an interact example cell through jupyter-sphinx only shows `Waiting for kernel...`. Is this supposed to take long? Would the interact work well once the kernel is up?

It now seems work almost...only that the sage in conda doesn't work well.



---

archive/issue_comments_473658.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-18T09:15:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473658",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473659.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-18T10:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473659",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473660.json:
```json
{
    "body": "> It now seems work almost...\n\nGood.\n\n> only that the sage in conda doesn't work well.\n\nCould this be made more specific?",
    "created_at": "2022-03-18T11:48:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473660",
    "user": "@nthiery"
}
```

> It now seems work almost...

Good.

> only that the sage in conda doesn't work well.

Could this be made more specific?



---

archive/issue_comments_473661.json:
```json
{
    "body": "Attachment [screenshot.png](tarball://root/attachments/some-uuid/ticket33507/screenshot.png) by @kwankyu created at 2022-03-18 13:07:18\n\nReplying to [comment:25 nthiery]:\n> > It now seems work almost...\n> \n> Good.\n> \n> > only that the sage in conda doesn't work well.\n> \n> Could this be made more specific?\n\nSee the screenshot.",
    "created_at": "2022-03-18T13:07:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473661",
    "user": "@kwankyu"
}
```

Attachment [screenshot.png](tarball://root/attachments/some-uuid/ticket33507/screenshot.png) by @kwankyu created at 2022-03-18 13:07:18

Replying to [comment:25 nthiery]:
> > It now seems work almost...
> 
> Good.
> 
> > only that the sage in conda doesn't work well.
> 
> Could this be made more specific?

See the screenshot.



---

archive/issue_comments_473662.json:
```json
{
    "body": "It seems python not sage runs.",
    "created_at": "2022-03-18T13:11:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473662",
    "user": "@kwankyu"
}
```

It seems python not sage runs.



---

archive/issue_comments_473663.json:
```json
{
    "body": "Replying to [comment:27 klee]:\n> It seems python not sage runs.\n\nI see.\n\nIn Thebe you can configure which kernel should be used;\nsee the kernel section in:\n\nhttps://thebe.readthedocs.io/en/latest/config_reference.html\n\nI assume that this can be done too through Jupyter-sphinx, though\nI don't know the details from the top of my head.",
    "created_at": "2022-03-18T16:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473663",
    "user": "@nthiery"
}
```

Replying to [comment:27 klee]:
> It seems python not sage runs.

I see.

In Thebe you can configure which kernel should be used;
see the kernel section in:

https://thebe.readthedocs.io/en/latest/config_reference.html

I assume that this can be done too through Jupyter-sphinx, though
I don't know the details from the top of my head.



---

archive/issue_comments_473664.json:
```json
{
    "body": "Presumably it should be enough to insert a kernel section \nas documented in the thebe manual in the jupyter-sphinx\nthebe configuration:\n\nhttps://jupyter-sphinx.readthedocs.io/en/latest/#thebelab-support\n\nSee also:\n\nhttps://jupyter-sphinx.readthedocs.io/en/latest/#controlling-the-execution-environment\n\nThank you for pushing this forward!",
    "created_at": "2022-03-18T16:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473664",
    "user": "@nthiery"
}
```

Presumably it should be enough to insert a kernel section 
as documented in the thebe manual in the jupyter-sphinx
thebe configuration:

https://jupyter-sphinx.readthedocs.io/en/latest/#thebelab-support

See also:

https://jupyter-sphinx.readthedocs.io/en/latest/#controlling-the-execution-environment

Thank you for pushing this forward!



---

archive/issue_comments_473665.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-18T23:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473665",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473666.json:
```json
{
    "body": "Replying to [comment:28 nthiery]:\n> In Thebe you can configure which kernel should be used;\n> see the kernel section in:\n> \n> https://thebe.readthedocs.io/en/latest/config_reference.html\n> \n> I assume that this can be done too through Jupyter-sphinx, though\n> I don't know the details from the top of my head.\n\nAdding the kernel spec makes it work perfect. Thank you!",
    "created_at": "2022-03-18T23:12:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473666",
    "user": "@kwankyu"
}
```

Replying to [comment:28 nthiery]:
> In Thebe you can configure which kernel should be used;
> see the kernel section in:
> 
> https://thebe.readthedocs.io/en/latest/config_reference.html
> 
> I assume that this can be done too through Jupyter-sphinx, though
> I don't know the details from the top of my head.

Adding the kernel spec makes it work perfect. Thank you!



---

archive/issue_comments_473667.json:
```json
{
    "body": "Given that all the old thebe stuff is commented out in `src/doc/common/themes/sage-classic/layout.html`, should we just remove it entirely (`build/pkgs/thebe/` etc.)?",
    "created_at": "2022-03-19T00:56:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473667",
    "user": "@mkoeppe"
}
```

Given that all the old thebe stuff is commented out in `src/doc/common/themes/sage-classic/layout.html`, should we just remove it entirely (`build/pkgs/thebe/` etc.)?



---

archive/issue_comments_473668.json:
```json
{
    "body": "(Looks like the branch at #24593 does this)",
    "created_at": "2022-03-19T01:02:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473668",
    "user": "@mkoeppe"
}
```

(Looks like the branch at #24593 does this)



---

archive/issue_comments_473669.json:
```json
{
    "body": "Done now in #33529.",
    "created_at": "2022-03-19T01:10:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473669",
    "user": "@mkoeppe"
}
```

Done now in #33529.



---

archive/issue_comments_473670.json:
```json
{
    "body": "With the present ticket, I am getting: \n\n```\n[sagemath_doc_html-none] [reference] WARNING: failed to reach any of the inventories with the following issues:\n[sagemath_doc_html-none] [reference] intersphinx inventory '/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/share/doc/sage/inventory/en/reference/jupyter_execute/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/share/doc/sage/inventory/en/reference/jupyter_execute/objects.inv'\n[sagemath_doc_html-none] [reference] building [html]: targets for 1 source files that are out of date\n[sagemath_doc_html-none] [reference] dumping search index in English (code: en)... done\n[sagemath_doc_html-none] [reference] The HTML pages are in local/share/doc/sage/html/en/reference/references.\n```\n\n(even after `make doc-uninstall`)",
    "created_at": "2022-03-19T01:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473670",
    "user": "@mkoeppe"
}
```

With the present ticket, I am getting: 

```
[sagemath_doc_html-none] [reference] WARNING: failed to reach any of the inventories with the following issues:
[sagemath_doc_html-none] [reference] intersphinx inventory '/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/share/doc/sage/inventory/en/reference/jupyter_execute/objects.inv' not fetchable due to <class 'FileNotFoundError'>: [Errno 2] No such file or directory: '/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/share/doc/sage/inventory/en/reference/jupyter_execute/objects.inv'
[sagemath_doc_html-none] [reference] building [html]: targets for 1 source files that are out of date
[sagemath_doc_html-none] [reference] dumping search index in English (code: en)... done
[sagemath_doc_html-none] [reference] The HTML pages are in local/share/doc/sage/html/en/reference/references.
```

(even after `make doc-uninstall`)



---

archive/issue_comments_473671.json:
```json
{
    "body": "I saw that strange thing. I just deleted the directory. I have no idea where that came from.",
    "created_at": "2022-03-19T02:53:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473671",
    "user": "@kwankyu"
}
```

I saw that strange thing. I just deleted the directory. I have no idea where that came from.



---

archive/issue_comments_473672.json:
```json
{
    "body": "Thanks, this helped.",
    "created_at": "2022-03-19T03:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473672",
    "user": "@mkoeppe"
}
```

Thanks, this helped.



---

archive/issue_comments_473673.json:
```json
{
    "body": "This looks very good already!",
    "created_at": "2022-03-19T03:09:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473673",
    "user": "@mkoeppe"
}
```

This looks very good already!



---

archive/issue_comments_473674.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-19T11:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473674",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473675.json:
```json
{
    "body": "As shown by the examples provided by the branch, static images for pdf documentation can either be provided (1) by `sphinx_plot` (this is the status quo), or (2) by prepared png image files saved from live threejs graphics. \n\nThere are pros and cons of both ways. Though both ways may coexist in sage, I think we should choose one of them as a norm, to guide future efforts to improve the documentation.\n\nPros of (1): It is the current standard; It does not increase the size of the sage distribution.\n\nPros of (2): It is of better quality; It is consistent with the live threejs renderings.\n\nCons of (1) is the negative of pros of (2), and vice versa. In particular, a big con of (2) is that it would increase the size of the sage distribution greatly.\n\nSo what do you think?",
    "created_at": "2022-03-19T12:16:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473675",
    "user": "@kwankyu"
}
```

As shown by the examples provided by the branch, static images for pdf documentation can either be provided (1) by `sphinx_plot` (this is the status quo), or (2) by prepared png image files saved from live threejs graphics. 

There are pros and cons of both ways. Though both ways may coexist in sage, I think we should choose one of them as a norm, to guide future efforts to improve the documentation.

Pros of (1): It is the current standard; It does not increase the size of the sage distribution.

Pros of (2): It is of better quality; It is consistent with the live threejs renderings.

Cons of (1) is the negative of pros of (2), and vice versa. In particular, a big con of (2) is that it would increase the size of the sage distribution greatly.

So what do you think?



---

archive/issue_comments_473676.json:
```json
{
    "body": "I'd say for this ticket (1) is better; actually not so much because of the added size but rather because of maintainability concerns. I'm not too worried about the output quality of the PDF documentation (I'd be surprised if anyone looks at it)",
    "created_at": "2022-03-19T18:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473676",
    "user": "@mkoeppe"
}
```

I'd say for this ticket (1) is better; actually not so much because of the added size but rather because of maintainability concerns. I'm not too worried about the output quality of the PDF documentation (I'd be surprised if anyone looks at it)



---

archive/issue_comments_473677.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-20T04:52:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473677",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473678.json:
```json
{
    "body": "Replying to [comment:43 mkoeppe]:\n> I'd say for this ticket (1) is better; actually not so much because of the added size but rather because of maintainability concerns. I'm not too worried about the output quality of the PDF documentation \n\nOkay.\n\n> (I'd be surprised if anyone looks at it)\n\n:)",
    "created_at": "2022-03-20T04:53:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473678",
    "user": "@kwankyu"
}
```

Replying to [comment:43 mkoeppe]:
> I'd say for this ticket (1) is better; actually not so much because of the added size but rather because of maintainability concerns. I'm not too worried about the output quality of the PDF documentation 

Okay.

> (I'd be surprised if anyone looks at it)

:)



---

archive/issue_comments_473679.json:
```json
{
    "body": "In the last commit, I added many jupyter-sphinx images to plot3d.py.\n\nBut if you see the page in a webbrowser (at least in my case), many initial images disappear as more images are rendered. \n\nI don't know why this happens. Too many iframes?",
    "created_at": "2022-03-20T04:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473679",
    "user": "@kwankyu"
}
```

In the last commit, I added many jupyter-sphinx images to plot3d.py.

But if you see the page in a webbrowser (at least in my case), many initial images disappear as more images are rendered. 

I don't know why this happens. Too many iframes?



---

archive/issue_comments_473680.json:
```json
{
    "body": "It seems a limit on threejs images:\n\nhttps://stackoverflow.com/questions/41919341/is-there-a-limit-to-the-number-of-three-webglrenderer-instances-in-a-page",
    "created_at": "2022-03-20T05:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473680",
    "user": "@kwankyu"
}
```

It seems a limit on threejs images:

https://stackoverflow.com/questions/41919341/is-there-a-limit-to-the-number-of-three-webglrenderer-instances-in-a-page



---

archive/issue_comments_473681.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-20T08:44:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473681",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473682.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-03-20T08:45:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473682",
    "user": "@kwankyu"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_473683.json:
```json
{
    "body": "Replying to [comment:45 klee]:\n> Replying to [comment:43 mkoeppe]:\n> > I'd say for this ticket (1) is better; actually not so much because of the added size but rather because of maintainability concerns. I'm not too worried about the output quality of the PDF documentation \n> \n> Okay.\n> \n> > (I'd be surprised if anyone looks at it)\n> \n> :)\n\nI would also vote for (1) for the same reason.",
    "created_at": "2022-03-20T09:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473683",
    "user": "@egourgoulhon"
}
```

Replying to [comment:45 klee]:
> Replying to [comment:43 mkoeppe]:
> > I'd say for this ticket (1) is better; actually not so much because of the added size but rather because of maintainability concerns. I'm not too worried about the output quality of the PDF documentation 
> 
> Okay.
> 
> > (I'd be surprised if anyone looks at it)
> 
> :)

I would also vote for (1) for the same reason.



---

archive/issue_comments_473684.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-20T10:34:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473684",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_473685.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-21T00:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473685",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_473686.json:
```json
{
    "body": "The last commit prevents input code display in Thebe cell as it is duplicate of the example just above it. This in effect also prevents a user from editing the input.",
    "created_at": "2022-03-21T00:57:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473686",
    "user": "@kwankyu"
}
```

The last commit prevents input code display in Thebe cell as it is duplicate of the example just above it. This in effect also prevents a user from editing the input.



---

archive/issue_comments_473687.json:
```json
{
    "body": "I have built HTML and PDF. HTML is great, a very nice improvement. PDF is unchanged. I would be ready to give it a positive review.",
    "created_at": "2022-03-21T06:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473687",
    "user": "@mkoeppe"
}
```

I have built HTML and PDF. HTML is great, a very nice improvement. PDF is unchanged. I would be ready to give it a positive review.



---

archive/issue_comments_473688.json:
```json
{
    "body": "Replying to [comment:55 mkoeppe]:\n> PDF is unchanged. \n\nI guess you are positive about this.",
    "created_at": "2022-03-21T06:54:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473688",
    "user": "@kwankyu"
}
```

Replying to [comment:55 mkoeppe]:
> PDF is unchanged. 

I guess you are positive about this.



---

archive/issue_comments_473689.json:
```json
{
    "body": "Replying to [comment:55 mkoeppe]:\n> I have built HTML and PDF. HTML is great, a very nice improvement. \n\nIndeed, we are fortunate to have a very nice tool: jupyter-sphix.",
    "created_at": "2022-03-21T06:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473689",
    "user": "@kwankyu"
}
```

Replying to [comment:55 mkoeppe]:
> I have built HTML and PDF. HTML is great, a very nice improvement. 

Indeed, we are fortunate to have a very nice tool: jupyter-sphix.



---

archive/issue_comments_473690.json:
```json
{
    "body": "Replying to [comment:56 klee]:\n> Replying to [comment:55 mkoeppe]:\n> > PDF is unchanged. \n> \n> I guess you are positive about this.\n\nYes, this matches the scope of the ticket.",
    "created_at": "2022-03-21T07:16:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473690",
    "user": "@mkoeppe"
}
```

Replying to [comment:56 klee]:
> Replying to [comment:55 mkoeppe]:
> > PDF is unchanged. 
> 
> I guess you are positive about this.

Yes, this matches the scope of the ticket.



---

archive/issue_comments_473691.json:
```json
{
    "body": "Thank you `@`klee! Very nice addition :-)\n\nI am super glad to see Thebe support in the Sage documentation!",
    "created_at": "2022-03-21T14:00:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473691",
    "user": "@nthiery"
}
```

Thank you `@`klee! Very nice addition :-)

I am super glad to see Thebe support in the Sage documentation!



---

archive/issue_comments_473692.json:
```json
{
    "body": "Thank you for setting up the sage binder repo!",
    "created_at": "2022-03-21T14:09:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473692",
    "user": "@kwankyu"
}
```

Thank you for setting up the sage binder repo!



---

archive/issue_comments_473693.json:
```json
{
    "body": "any reason to delay this until 9.7?",
    "created_at": "2022-03-21T20:21:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473693",
    "user": "@dimpase"
}
```

any reason to delay this until 9.7?



---

archive/issue_comments_473694.json:
```json
{
    "body": "even after doc-clean, I get an error building docs:\n\n```\n[sagemath_doc_html-none] OSError: WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle\n```\n",
    "created_at": "2022-03-21T20:43:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473694",
    "user": "@dimpase"
}
```

even after doc-clean, I get an error building docs:

```
[sagemath_doc_html-none] OSError: WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle
```




---

archive/issue_comments_473695.json:
```json
{
    "body": "Just tested it. This is very nice!\n\n+1 for a positive review. \n\nJust for curiosity: why is #33522 a dependency?",
    "created_at": "2022-03-21T20:44:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473695",
    "user": "@egourgoulhon"
}
```

Just tested it. This is very nice!

+1 for a positive review. 

Just for curiosity: why is #33522 a dependency?



---

archive/issue_comments_473696.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-22T00:05:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473696",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_473697.json:
```json
{
    "body": "Replying to [comment:65 egourgoulhon]: \n> Just for curiosity: why is #33522 a dependency?\n\nThat was just a temporary dependency. Now removed.",
    "created_at": "2022-03-22T00:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473697",
    "user": "@kwankyu"
}
```

Replying to [comment:65 egourgoulhon]: 
> Just for curiosity: why is #33522 a dependency?

That was just a temporary dependency. Now removed.



---

archive/issue_comments_473698.json:
```json
{
    "body": "Replying to [comment:64 dimpase]:\n> even after doc-clean, I get an error building docs:\n> {{{\n> [sagemath_doc_html-none] OSError: WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle\n> }}}\n\nI do: `make doc-clean; make doc-uninstall; make`",
    "created_at": "2022-03-22T00:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473698",
    "user": "@kwankyu"
}
```

Replying to [comment:64 dimpase]:
> even after doc-clean, I get an error building docs:
> {{{
> [sagemath_doc_html-none] OSError: WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle
> }}}

I do: `make doc-clean; make doc-uninstall; make`



---

archive/issue_comments_473699.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. Last 10 new commits:",
    "created_at": "2022-03-22T02:00:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473699",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:



---

archive/issue_comments_473700.json:
```json
{
    "body": "You revived the dependency #33522 that I removed.",
    "created_at": "2022-03-22T03:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473700",
    "user": "@kwankyu"
}
```

You revived the dependency #33522 that I removed.



---

archive/issue_comments_473701.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-22T04:34:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473701",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_473702.json:
```json
{
    "body": "Sorry, fixed now",
    "created_at": "2022-03-22T04:34:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473702",
    "user": "@mkoeppe"
}
```

Sorry, fixed now



---

archive/issue_comments_473703.json:
```json
{
    "body": "I am still getting this docbuild error on macOS, even after `git clean -fdx`.\n\n```\n[sagemath_doc_html-none] [repl     ] executing interact\n[sagemath_doc_html-none] [repl     ] /Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jsonschema/validators.py:188: DeprecationWarning: Passing a schema to Validator.iter_errors is deprecated and will be removed in a future release. Call validator.evolve(schema=new_schema).iter_errors(...) instead.\n[sagemath_doc_html-none] [repl     ]   warnings.warn(\n[sagemath_doc_html-none] [repl     ] Extension error:\n[sagemath_doc_html-none] [repl     ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage')\n...\n[sagemath_doc_html-none] [plot3d   ] executing plot3d\n[sagemath_doc_html-none] [plot3d   ] /Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jsonschema/validators.py:188: DeprecationWarning: Passing a schema to Validator.iter_errors is deprecated and will be removed in a future release. Call validator.evolve(schema=new_schema).iter_errors(...) instead.\n[sagemath_doc_html-none] [plot3d   ]   warnings.warn(\n[sagemath_doc_html-none] [plot3d   ] Extension error:\n[sagemath_doc_html-none] [plot3d   ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage')\n...\nsagemath_doc_html-none] [reference] ... done (500 todos, 2546 index, 1665 citations, 2139 modules)\n[sagemath_doc_html-none] [reference] WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle\n[sagemath_doc_html-none] [reference] WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/repl/environment.pickle\n[sagemath_doc_html-none] [reference] preparing documents... skipping loading of indexes... done\n[sagemath_doc_html-none] [reference] /Users/dima/sage/src/doc/en/reference/index.rst:17: WARNING: unknown document: repl/index\n[sagemath_doc_html-none] [reference] /Users/dima/sage/src/doc/en/reference/index.rst:24: WARNING: unknown document: plot3d/index\n[sagemath_doc_html-none] [reference] The inventory files are in local/share/doc/sage/inventory/en/reference.\n[sagemath_doc_html-none] Error building the documentation.\n[sagemath_doc_html-none] Traceback (most recent call last):\n[sagemath_doc_html-none]   File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 197, in _run_module_as_main\n[sagemath_doc_html-none]     return _run_code(code, main_globals, None,\n[sagemath_doc_html-none]   File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py\", line 87, in _run_code\n[sagemath_doc_html-none]     exec(code, run_globals)\n[sagemath_doc_html-none]   File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__main__.py\", line 2, in <module>\n[sagemath_doc_html-none]     main()\n[sagemath_doc_html-none]   File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py\", line 1751, in main\n[sagemath_doc_html-none]     builder()\n[sagemath_doc_html-none]   File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py\", line 141, in f\n[sagemath_doc_html-none]     runsphinx()\n[sagemath_doc_html-none]   File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py\", line 326, in runsphinx\n[sagemath_doc_html-none]     sys.stderr.raise_errors()\n[sagemath_doc_html-none]   File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py\", line 262, in raise_errors\n[sagemath_doc_html-none]     raise OSError(self._error)\n[sagemath_doc_html-none] OSError: WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle \n[sagemath_doc_html-none] \n[sagemath_doc_html-none]     Note: incremental documentation builds sometimes cause spurious\n[sagemath_doc_html-none]     error messages. To be certain that these are real errors, run\n[sagemath_doc_html-none]     \"make doc-clean doc-uninstall\" first and try again.\n[sagemath_doc_html-none] make[6]: *** [doc-inventory--reference_top] Error 1\n[sagemath_doc_html-none] make[5]: *** [doc-inventory-reference] Error 2\nmake[4]: *** [sagemath_doc_html-SAGE_DOCS-no-deps] Error 2\n```\n\n\nsomething in these two modules wants to call `'/Users/dima/sage/local/bin/sage'` - \nwhich is absent, naturally, and probably this leads to absent `environment.pickle` in plot3d.\n\nI presume the message \"Notebook execution failed\" comes from jupyter-sphinx:\nhttps://github.com/jupyter/jupyter-sphinx/blob/master/jupyter_sphinx/execute.py",
    "created_at": "2022-03-22T15:46:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473703",
    "user": "@dimpase"
}
```

I am still getting this docbuild error on macOS, even after `git clean -fdx`.

```
[sagemath_doc_html-none] [repl     ] executing interact
[sagemath_doc_html-none] [repl     ] /Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jsonschema/validators.py:188: DeprecationWarning: Passing a schema to Validator.iter_errors is deprecated and will be removed in a future release. Call validator.evolve(schema=new_schema).iter_errors(...) instead.
[sagemath_doc_html-none] [repl     ]   warnings.warn(
[sagemath_doc_html-none] [repl     ] Extension error:
[sagemath_doc_html-none] [repl     ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage')
...
[sagemath_doc_html-none] [plot3d   ] executing plot3d
[sagemath_doc_html-none] [plot3d   ] /Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jsonschema/validators.py:188: DeprecationWarning: Passing a schema to Validator.iter_errors is deprecated and will be removed in a future release. Call validator.evolve(schema=new_schema).iter_errors(...) instead.
[sagemath_doc_html-none] [plot3d   ]   warnings.warn(
[sagemath_doc_html-none] [plot3d   ] Extension error:
[sagemath_doc_html-none] [plot3d   ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage')
...
sagemath_doc_html-none] [reference] ... done (500 todos, 2546 index, 1665 citations, 2139 modules)
[sagemath_doc_html-none] [reference] WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle
[sagemath_doc_html-none] [reference] WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/repl/environment.pickle
[sagemath_doc_html-none] [reference] preparing documents... skipping loading of indexes... done
[sagemath_doc_html-none] [reference] /Users/dima/sage/src/doc/en/reference/index.rst:17: WARNING: unknown document: repl/index
[sagemath_doc_html-none] [reference] /Users/dima/sage/src/doc/en/reference/index.rst:24: WARNING: unknown document: plot3d/index
[sagemath_doc_html-none] [reference] The inventory files are in local/share/doc/sage/inventory/en/reference.
[sagemath_doc_html-none] Error building the documentation.
[sagemath_doc_html-none] Traceback (most recent call last):
[sagemath_doc_html-none]   File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
[sagemath_doc_html-none]     return _run_code(code, main_globals, None,
[sagemath_doc_html-none]   File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
[sagemath_doc_html-none]     exec(code, run_globals)
[sagemath_doc_html-none]   File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__main__.py", line 2, in <module>
[sagemath_doc_html-none]     main()
[sagemath_doc_html-none]   File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py", line 1751, in main
[sagemath_doc_html-none]     builder()
[sagemath_doc_html-none]   File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/__init__.py", line 141, in f
[sagemath_doc_html-none]     runsphinx()
[sagemath_doc_html-none]   File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 326, in runsphinx
[sagemath_doc_html-none]     sys.stderr.raise_errors()
[sagemath_doc_html-none]   File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/sage_docbuild/sphinxbuild.py", line 262, in raise_errors
[sagemath_doc_html-none]     raise OSError(self._error)
[sagemath_doc_html-none] OSError: WARNING: Unable to fetch /Users/dima/sage/local/share/doc/sage/doctrees/en/reference/plot3d/environment.pickle 
[sagemath_doc_html-none] 
[sagemath_doc_html-none]     Note: incremental documentation builds sometimes cause spurious
[sagemath_doc_html-none]     error messages. To be certain that these are real errors, run
[sagemath_doc_html-none]     "make doc-clean doc-uninstall" first and try again.
[sagemath_doc_html-none] make[6]: *** [doc-inventory--reference_top] Error 1
[sagemath_doc_html-none] make[5]: *** [doc-inventory-reference] Error 2
make[4]: *** [sagemath_doc_html-SAGE_DOCS-no-deps] Error 2
```


something in these two modules wants to call `'/Users/dima/sage/local/bin/sage'` - 
which is absent, naturally, and probably this leads to absent `environment.pickle` in plot3d.

I presume the message "Notebook execution failed" comes from jupyter-sphinx:
https://github.com/jupyter/jupyter-sphinx/blob/master/jupyter_sphinx/execute.py



---

archive/issue_comments_473704.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-22T20:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473704",
    "user": "@dimpase"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_473705.json:
```json
{
    "body": "after \n\n```\nln -s /Users/dima/sage/sage /Users/dima/sage/local/bin/sage\n```\n\nthe docbuild completes, but it's certainly a problem to be fixed that needs this workaround.",
    "created_at": "2022-03-22T20:30:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473705",
    "user": "@dimpase"
}
```

after 

```
ln -s /Users/dima/sage/sage /Users/dima/sage/local/bin/sage
```

the docbuild completes, but it's certainly a problem to be fixed that needs this workaround.



---

archive/issue_comments_473706.json:
```json
{
    "body": "Replying to [comment:75 dimpase]:\n> I am still getting this docbuild error on macOS, even after `git clean -fdx`.\n> {{{\n> [sagemath_doc_html-none] [repl     ] executing interact\n> [sagemath_doc_html-none] [repl     ] /Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jsonschema/validators.py:188: DeprecationWarning: Passing a schema to Validator.iter_errors is deprecated and will be removed in a future release. Call validator.evolve(schema=new_schema).iter_errors(...) instead.\n> [sagemath_doc_html-none] [repl     ]   warnings.warn(\n> [sagemath_doc_html-none] [repl     ] Extension error:\n> [sagemath_doc_html-none] [repl     ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage')\n...\n> I presume the message \"Notebook execution failed\" comes from jupyter-sphinx:\n> https://github.com/jupyter/jupyter-sphinx/blob/master/jupyter_sphinx/execute.py\n\nI am on macOS too. Do you have no problem in running sagemath kernel in jupyter from your sage installation?",
    "created_at": "2022-03-23T01:12:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473706",
    "user": "@kwankyu"
}
```

Replying to [comment:75 dimpase]:
> I am still getting this docbuild error on macOS, even after `git clean -fdx`.
> {{{
> [sagemath_doc_html-none] [repl     ] executing interact
> [sagemath_doc_html-none] [repl     ] /Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jsonschema/validators.py:188: DeprecationWarning: Passing a schema to Validator.iter_errors is deprecated and will be removed in a future release. Call validator.evolve(schema=new_schema).iter_errors(...) instead.
> [sagemath_doc_html-none] [repl     ]   warnings.warn(
> [sagemath_doc_html-none] [repl     ] Extension error:
> [sagemath_doc_html-none] [repl     ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage')
...
> I presume the message "Notebook execution failed" comes from jupyter-sphinx:
> https://github.com/jupyter/jupyter-sphinx/blob/master/jupyter_sphinx/execute.py

I am on macOS too. Do you have no problem in running sagemath kernel in jupyter from your sage installation?



---

archive/issue_comments_473707.json:
```json
{
    "body": "If I remove the symlink as in comment:76 I get a jupyter kernel error\n\n```\nTraceback (most recent call last):\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/web.py\", line 1704, in _execute\n    result = await result\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py\", line 328, in __wakeup\n    future.result()\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py\", line 769, in run\n    yielded = self.gen.throw(*exc_info)  # type: ignore\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/sessions/handlers.py\", line 74, in post\n    model = yield maybe_future(\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py\", line 762, in run\n    value = future.result()\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py\", line 769, in run\n    yielded = self.gen.throw(*exc_info)  # type: ignore\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/sessions/sessionmanager.py\", line 98, in create_session\n    kernel_id = yield self.start_kernel_for_session(session_id, path, name, type, kernel_name)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py\", line 762, in run\n    value = future.result()\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py\", line 769, in run\n    yielded = self.gen.throw(*exc_info)  # type: ignore\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/sessions/sessionmanager.py\", line 110, in start_kernel_for_session\n    kernel_id = yield maybe_future(\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py\", line 762, in run\n    value = future.result()\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py\", line 201, in result\n    raise self._exception\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py\", line 256, in __step\n    result = coro.send(None)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/kernels/kernelmanager.py\", line 176, in start_kernel\n    kernel_id = await maybe_future(self.pinned_superclass.start_kernel(self, **kwargs))\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py\", line 26, in wrapped\n    raise e\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py\", line 23, in wrapped\n    return loop.run_until_complete(future)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/nest_asyncio.py\", line 81, in run_until_complete\n    return f.result()\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py\", line 201, in result\n    raise self._exception\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py\", line 256, in __step\n    result = coro.send(None)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/multikernelmanager.py\", line 187, in _async_start_kernel\n    starter = ensure_async(km.start_kernel(**kwargs))\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py\", line 26, in wrapped\n    raise e\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py\", line 23, in wrapped\n    return loop.run_until_complete(future)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/nest_asyncio.py\", line 81, in run_until_complete\n    return f.result()\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py\", line 201, in result\n    raise self._exception\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py\", line 256, in __step\n    result = coro.send(None)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/manager.py\", line 362, in _async_start_kernel\n    raise e\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/manager.py\", line 351, in _async_start_kernel\n    await ensure_async(self._launch_kernel(kernel_cmd, **kw))\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py\", line 26, in wrapped\n    raise e\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py\", line 23, in wrapped\n    return loop.run_until_complete(future)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/nest_asyncio.py\", line 81, in run_until_complete\n    return f.result()\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py\", line 201, in result\n    raise self._exception\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py\", line 256, in __step\n    result = coro.send(None)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/manager.py\", line 269, in _async_launch_kernel\n    connection_info = await self.provisioner.launch_kernel(kernel_cmd, **kw)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/provisioning/local_provisioner.py\", line 179, in launch_kernel\n    self.process = launch_kernel(cmd, **scrubbed_kwargs)\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/launcher.py\", line 169, in launch_kernel\n    raise ex\n  File \"/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/launcher.py\", line 157, in launch_kernel\n    proc = Popen(cmd, **kwargs)\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py\", line 951, in __init__\n    self._execute_child(args, executable, preexec_fn, close_fds,\n  File \"/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py\", line 1821, in _execute_child\n    raise child_exception_type(errno_num, err_msg, err_filename)\nFileNotFoundError: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage'\n```\n\n\nWith the link it works. It turns out I have outdated things in `~/Library/Jupyter`, in particular `sagemath/kernel.json` with the obsolete path to `sage` (version 9.4.beta3).\n\nSorry for noise, it's OK.",
    "created_at": "2022-03-23T09:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473707",
    "user": "@dimpase"
}
```

If I remove the symlink as in comment:76 I get a jupyter kernel error

```
Traceback (most recent call last):
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/web.py", line 1704, in _execute
    result = await result
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 328, in __wakeup
    future.result()
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py", line 769, in run
    yielded = self.gen.throw(*exc_info)  # type: ignore
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/sessions/handlers.py", line 74, in post
    model = yield maybe_future(
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py", line 762, in run
    value = future.result()
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py", line 769, in run
    yielded = self.gen.throw(*exc_info)  # type: ignore
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/sessions/sessionmanager.py", line 98, in create_session
    kernel_id = yield self.start_kernel_for_session(session_id, path, name, type, kernel_name)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py", line 762, in run
    value = future.result()
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py", line 769, in run
    yielded = self.gen.throw(*exc_info)  # type: ignore
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/sessions/sessionmanager.py", line 110, in start_kernel_for_session
    kernel_id = yield maybe_future(
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/tornado/gen.py", line 762, in run
    value = future.result()
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py", line 201, in result
    raise self._exception
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 256, in __step
    result = coro.send(None)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/notebook/services/kernels/kernelmanager.py", line 176, in start_kernel
    kernel_id = await maybe_future(self.pinned_superclass.start_kernel(self, **kwargs))
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py", line 26, in wrapped
    raise e
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py", line 23, in wrapped
    return loop.run_until_complete(future)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/nest_asyncio.py", line 81, in run_until_complete
    return f.result()
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py", line 201, in result
    raise self._exception
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 256, in __step
    result = coro.send(None)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/multikernelmanager.py", line 187, in _async_start_kernel
    starter = ensure_async(km.start_kernel(**kwargs))
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py", line 26, in wrapped
    raise e
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py", line 23, in wrapped
    return loop.run_until_complete(future)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/nest_asyncio.py", line 81, in run_until_complete
    return f.result()
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py", line 201, in result
    raise self._exception
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 256, in __step
    result = coro.send(None)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/manager.py", line 362, in _async_start_kernel
    raise e
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/manager.py", line 351, in _async_start_kernel
    await ensure_async(self._launch_kernel(kernel_cmd, **kw))
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py", line 26, in wrapped
    raise e
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/utils.py", line 23, in wrapped
    return loop.run_until_complete(future)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/nest_asyncio.py", line 81, in run_until_complete
    return f.result()
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/futures.py", line 201, in result
    raise self._exception
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/asyncio/tasks.py", line 256, in __step
    result = coro.send(None)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/manager.py", line 269, in _async_launch_kernel
    connection_info = await self.provisioner.launch_kernel(kernel_cmd, **kw)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/provisioning/local_provisioner.py", line 179, in launch_kernel
    self.process = launch_kernel(cmd, **scrubbed_kwargs)
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/launcher.py", line 169, in launch_kernel
    raise ex
  File "/Users/dima/sage/local/var/lib/sage/venv-python3.9/lib/python3.9/site-packages/jupyter_client/launcher.py", line 157, in launch_kernel
    proc = Popen(cmd, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 951, in __init__
    self._execute_child(args, executable, preexec_fn, close_fds,
  File "/Library/Frameworks/Python.framework/Versions/3.9/lib/python3.9/subprocess.py", line 1821, in _execute_child
    raise child_exception_type(errno_num, err_msg, err_filename)
FileNotFoundError: [Errno 2] No such file or directory: '/Users/dima/sage/local/bin/sage'
```


With the link it works. It turns out I have outdated things in `~/Library/Jupyter`, in particular `sagemath/kernel.json` with the obsolete path to `sage` (version 9.4.beta3).

Sorry for noise, it's OK.



---

archive/issue_comments_473708.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2022-03-23T09:56:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473708",
    "user": "@dimpase"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_473709.json:
```json
{
    "body": "Probably the docbuild should try to isolate from such user settings.",
    "created_at": "2022-03-23T18:36:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473709",
    "user": "@mkoeppe"
}
```

Probably the docbuild should try to isolate from such user settings.



---

archive/issue_comments_473710.json:
```json
{
    "body": "Replying to [comment:79 mkoeppe]:\n> Probably the docbuild should try to isolate from such user settings.\n\nI don't understand the precise mechanism. But it seems that jupyter-sphinx just runs a new jupyter notebook with sagemath kernel. Then there is nothing to do with the docbuild.",
    "created_at": "2022-03-23T23:49:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473710",
    "user": "@kwankyu"
}
```

Replying to [comment:79 mkoeppe]:
> Probably the docbuild should try to isolate from such user settings.

I don't understand the precise mechanism. But it seems that jupyter-sphinx just runs a new jupyter notebook with sagemath kernel. Then there is nothing to do with the docbuild.



---

archive/issue_comments_473711.json:
```json
{
    "body": "Replying to [comment:78 dimpase]:\n\nThank you for review.",
    "created_at": "2022-03-23T23:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473711",
    "user": "@kwankyu"
}
```

Replying to [comment:78 dimpase]:

Thank you for review.



---

archive/issue_comments_473712.json:
```json
{
    "body": "Replying to [comment:80 klee]:\n> Replying to [comment:79 mkoeppe]:\n> > Probably the docbuild should try to isolate from such user settings.\n> \n> I don't understand the precise mechanism. But it seems that jupyter-sphinx just runs a new jupyter notebook with sagemath kernel. Then there is nothing to do with the docbuild.\n\nBut its happening during the docbuild according to the output that Dima shared",
    "created_at": "2022-03-24T00:16:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473712",
    "user": "@mkoeppe"
}
```

Replying to [comment:80 klee]:
> Replying to [comment:79 mkoeppe]:
> > Probably the docbuild should try to isolate from such user settings.
> 
> I don't understand the precise mechanism. But it seems that jupyter-sphinx just runs a new jupyter notebook with sagemath kernel. Then there is nothing to do with the docbuild.

But its happening during the docbuild according to the output that Dima shared



---

archive/issue_comments_473713.json:
```json
{
    "body": "Replying to [comment:82 mkoeppe]:\n> But its happening during the docbuild according to the output that Dima shared\n\nThe source of the problem may be in our jupyter kernel configuration in `repl.ipython_kernel.kernel`.",
    "created_at": "2022-03-24T00:27:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473713",
    "user": "@kwankyu"
}
```

Replying to [comment:82 mkoeppe]:
> But its happening during the docbuild according to the output that Dima shared

The source of the problem may be in our jupyter kernel configuration in `repl.ipython_kernel.kernel`.



---

archive/issue_comments_473714.json:
```json
{
    "body": "Replying to [comment:82 mkoeppe]:\n> Replying to [comment:80 klee]:\n> > Replying to [comment:79 mkoeppe]:\n> > > Probably the docbuild should try to isolate from such user settings.\n> > \n> > I don't understand the precise mechanism. But it seems that jupyter-sphinx just runs a new jupyter notebook with sagemath kernel. Then there is nothing to do with the docbuild.\n> \n> But its happening during the docbuild according to the output that Dima shared\n\nI could reproduce this issue just by running `./sage -n`. So this is indeed a \"pure\" notebook problem.",
    "created_at": "2022-03-24T08:55:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473714",
    "user": "@dimpase"
}
```

Replying to [comment:82 mkoeppe]:
> Replying to [comment:80 klee]:
> > Replying to [comment:79 mkoeppe]:
> > > Probably the docbuild should try to isolate from such user settings.
> > 
> > I don't understand the precise mechanism. But it seems that jupyter-sphinx just runs a new jupyter notebook with sagemath kernel. Then there is nothing to do with the docbuild.
> 
> But its happening during the docbuild according to the output that Dima shared

I could reproduce this issue just by running `./sage -n`. So this is indeed a "pure" notebook problem.



---

archive/issue_comments_473715.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-04-02T10:52:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473715",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_473716.json:
```json
{
    "body": "The first bug report on this may have arrived: https://groups.google.com/g/sage-release/c/-0luW4DPEPs/m/1bST2lbcCAAJ",
    "created_at": "2022-04-05T19:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473716",
    "user": "@mkoeppe"
}
```

The first bug report on this may have arrived: https://groups.google.com/g/sage-release/c/-0luW4DPEPs/m/1bST2lbcCAAJ



---

archive/issue_comments_473717.json:
```json
{
    "body": "Replying to [comment:86 mkoeppe]:\n> The first bug report on this may have arrived: https://groups.google.com/g/sage-release/c/-0luW4DPEPs/m/1bST2lbcCAAJ\n\nYou mean \n\n```\n[sagemath_doc_html-none] [plot3d   ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/home/furutaka/work/sage/sage-9.0-git-bld/local/bin/sage')\n```\n\nI suppose.\n\nThis looks identical to comment:75 - a stale Jupyter kernel somewhere.",
    "created_at": "2022-04-05T20:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473717",
    "user": "@dimpase"
}
```

Replying to [comment:86 mkoeppe]:
> The first bug report on this may have arrived: https://groups.google.com/g/sage-release/c/-0luW4DPEPs/m/1bST2lbcCAAJ

You mean 

```
[sagemath_doc_html-none] [plot3d   ] Notebook execution failed (exception: [Errno 2] No such file or directory: '/home/furutaka/work/sage/sage-9.0-git-bld/local/bin/sage')
```

I suppose.

This looks identical to comment:75 - a stale Jupyter kernel somewhere.



---

archive/issue_comments_473718.json:
```json
{
    "body": "Yes. I have opened #33650 for this.",
    "created_at": "2022-04-06T04:38:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/33270",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/33270#issuecomment-473718",
    "user": "@mkoeppe"
}
```

Yes. I have opened #33650 for this.
