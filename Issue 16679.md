# Issue 16679: cuspform_lseries() method for a new form has precision issues

Issue created by migration from https://trac.sagemath.org/ticket/16916

Original creator: tornaria

Original creation time: 2014-09-01 16:51:58

Keywords: lseries


```
sage: f = Newforms(67, names='a')[0]
sage: L = f.cuspform_lseries()      
...
RuntimeError: Unable to create L-series, due to precision or other limits in PARI.
```


This is because the field `prec` is used both for the numerical precision _and_ for the number of coefficients computed.

Since the L-functions class has a `num_coeffs()` method, the proper thing is to use that to know how many coefficients to compute.


---

Comment by tornaria created at 2014-09-01 17:12:02

Fixed as proposed.

See also #11631 (cusp forms of degree > 1) and #12015 (more general implementation of L-series).
----
New commits:


---

Comment by tornaria created at 2014-09-01 17:12:02

Changing status from new to needs_review.


---

Comment by git created at 2014-09-01 18:55:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tornaria created at 2014-09-01 18:57:27

After the first commit there were a few cases for which the runtime error would still happen. It turns out that
    
    f.q_expansion(num_coeff).list()
    
is not always a list of length num_coeff, because trailing zeros are removed. Instead we now use
    
    f.q_expansion(num_coeff).padded_list()
    
which will not drop the trailing zeros.


---

Comment by git created at 2014-09-01 19:20:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mneururer created at 2014-09-01 22:12:23

Review: This patch fixes the problem in the description. I tried to calculate L(f,1) for new forms of various levels but even setting the precision very high I was never able to calculate with levels above 100. With the patch I calculated L(f,1) for all new forms with rational coefficients up to level 400 without increasing the precision.


---

Comment by mneururer created at 2014-09-01 22:12:54

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-09-06 11:06:50

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2014-09-06 11:06:50

Author name should be full name, not trac username.


---

Comment by tornaria created at 2014-09-07 10:20:20

Replying to [comment:8 vbraun]:
> Author name should be full name, not trac username.
Isn't that inconsistent with how the "Reported by" field is handled?
Also, the "reported by" field links to a query for tickets reported by that person, but the "authors" field doesn't.

By the way, this ticket and #11631 are sooo embarrassing that I hope they can make it into 6.4... (especially since the fixes where kind of trivial).


---

Comment by vbraun created at 2014-09-07 11:56:28

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2014-09-07 11:56:28

"reported by" is where trac stores the account that created the ticket.

Author/Reviewer are not necessarily trac accounts (could have been written by somebody without an account, for example). Also, they end up in the git commit log.


---

Comment by tornaria created at 2014-09-07 14:10:25

Replying to [comment:10 vbraun]:
> "reported by" is where trac stores the account that created the ticket.

Yes, I know, but with the same reason a defect could have been reported by somebody without an account and picked up by someone different.

> Author/Reviewer are not necessarily trac accounts (could have been written by somebody without an account, for example). Also, they end up in the git commit log.

So anybody can change the !Author/Reviewer fields without a trac account?

I agree that git commit logs should have full name and email (mine do).

I understand your point, but I still think it's a bit inconsistent, and makes it difficult to search for tickets by name, because the account name is used for some fields (e.g. reported by, comments) but the real name is used for others (author, reviewer). Also, real names are not always canonical (e.g. mine has an accented i and it's not always used consistently -- can't be used in sage source code, for instance), while trac login names should be unique.

Anyway, thanks for your work.


---

Comment by vbraun created at 2014-09-07 14:34:04

You need a trac account to edit tickets but you might post somebody else's code.

You can use UTF8 in the sources, this should be enough to write your name in your preferred spelling. If you can't decide how to spell your name I can't help you, though ;-)


---

Comment by vbraun created at 2014-09-08 08:48:45

Resolution: fixed
