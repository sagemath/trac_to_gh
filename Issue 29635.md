# Issue 29635: macos: pynac ignores /usr/local

Issue created by migration from https://trac.sagemath.org/ticket/29872

Original creator: mkoeppe

Original creation time: 2020-06-16 11:39:53

CC:  dcoudert dimpase

As reported in https://groups.google.com/g/sage-devel/c/1AXipTx8HPA/m/dBawYmzWBwAJ

This can be worked around by the user by just adding `/usr/local` explicitly, for example by sourcing `.homebrew-build-env` (which is already recommended by `./configure`), but we should add a fix.

The reason for this is the `-isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk` that comes in from the system Python's compiler configuration (after #29404). This is correct for pynac.  

As we already determine the location of GMP in `build/pkgs/spkg-configure.m4`, we should pass it to pynac's `configure`.


---

Comment by @mwageringel created at 2020-07-16 17:12:41

Here is a workaround that works without sourcing `.homebrew-build-env`:

```
CXXFLAGS="$CXXFLAGS -I/usr/local/include" CFLAGS="$CFLAGS -I/usr/local/include" LDFLAGS="$LDFLAGS -L/usr/local/lib" make pynac
```



---

Comment by roed created at 2021-02-15 04:27:04

FWIW, this just happened to me as well, but I was able to find the recent thread on sage-devel referencing this ticket and source `.homebrew-build-env`.


---

Comment by mkoeppe created at 2021-02-15 04:48:14

This particular problem will go away with #31348, but in any case it's best to follow the advice that `./configure` prints at the end.


---

Comment by roed created at 2021-02-15 06:34:20

Looking back, I can see the suggestion.  The way it's phrased I thought it was optional.

"Homebrew can issue suggestions regarding keg-only packages.  The following command is to automatically apply these suggestions for packages relevant for Sage to make them available for the build.  Run it once to apply the suggestions for the current session."

So I just did `brew install ...` and then `./config.status --recheck && ./config.status`.


---

Comment by mkoeppe created at 2021-03-24 02:04:25

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-08-16 22:04:35

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2021-08-16 22:04:35

No longer relevant with #32386


---

Comment by @mwageringel created at 2021-09-05 08:43:12

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-09-10 04:50:10

Resolution: invalid
