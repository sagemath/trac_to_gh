# Issue 29635: macos: pynac ignores /usr/local

archive/issues_029635.json:
```json
{
    "body": "CC:  @dcoudert @dimpase\n\nAs reported in https://groups.google.com/g/sage-devel/c/1AXipTx8HPA/m/dBawYmzWBwAJ\n\nThis can be worked around by the user by just adding `/usr/local` explicitly, for example by sourcing `.homebrew-build-env` (which is already recommended by `./configure`), but we should add a fix.\n\nThe reason for this is the `-isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk` that comes in from the system Python's compiler configuration (after #29404). This is correct for pynac.  \n\nAs we already determine the location of GMP in `build/pkgs/spkg-configure.m4`, we should pass it to pynac's `configure`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/29872\n\n",
    "created_at": "2020-06-16T11:39:53Z",
    "labels": [
        "component: packages: standard",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "macos: pynac ignores /usr/local",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29635",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @dcoudert @dimpase

As reported in https://groups.google.com/g/sage-devel/c/1AXipTx8HPA/m/dBawYmzWBwAJ

This can be worked around by the user by just adding `/usr/local` explicitly, for example by sourcing `.homebrew-build-env` (which is already recommended by `./configure`), but we should add a fix.

The reason for this is the `-isysroot /Library/Developer/CommandLineTools/SDKs/MacOSX10.14.sdk` that comes in from the system Python's compiler configuration (after #29404). This is correct for pynac.  

As we already determine the location of GMP in `build/pkgs/spkg-configure.m4`, we should pass it to pynac's `configure`.

Issue created by migration from https://trac.sagemath.org/ticket/29872





---

archive/issue_comments_420466.json:
```json
{
    "body": "Here is a workaround that works without sourcing `.homebrew-build-env`:\n\n```\nCXXFLAGS=\"$CXXFLAGS -I/usr/local/include\" CFLAGS=\"$CFLAGS -I/usr/local/include\" LDFLAGS=\"$LDFLAGS -L/usr/local/lib\" make pynac\n```\n",
    "created_at": "2020-07-16T17:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420466",
    "user": "https://github.com/mwageringel"
}
```

Here is a workaround that works without sourcing `.homebrew-build-env`:

```
CXXFLAGS="$CXXFLAGS -I/usr/local/include" CFLAGS="$CFLAGS -I/usr/local/include" LDFLAGS="$LDFLAGS -L/usr/local/lib" make pynac
```




---

archive/issue_comments_420467.json:
```json
{
    "body": "FWIW, this just happened to me as well, but I was able to find the recent thread on sage-devel referencing this ticket and source `.homebrew-build-env`.",
    "created_at": "2021-02-15T04:27:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420467",
    "user": "https://github.com/roed314"
}
```

FWIW, this just happened to me as well, but I was able to find the recent thread on sage-devel referencing this ticket and source `.homebrew-build-env`.



---

archive/issue_comments_420468.json:
```json
{
    "body": "This particular problem will go away with #31348, but in any case it's best to follow the advice that `./configure` prints at the end.",
    "created_at": "2021-02-15T04:48:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420468",
    "user": "https://github.com/mkoeppe"
}
```

This particular problem will go away with #31348, but in any case it's best to follow the advice that `./configure` prints at the end.



---

archive/issue_comments_420469.json:
```json
{
    "body": "Looking back, I can see the suggestion.  The way it's phrased I thought it was optional.\n\n\"Homebrew can issue suggestions regarding keg-only packages.  The following command is to automatically apply these suggestions for packages relevant for Sage to make them available for the build.  Run it once to apply the suggestions for the current session.\"\n\nSo I just did `brew install ...` and then `./config.status --recheck && ./config.status`.",
    "created_at": "2021-02-15T06:34:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420469",
    "user": "https://github.com/roed314"
}
```

Looking back, I can see the suggestion.  The way it's phrased I thought it was optional.

"Homebrew can issue suggestions regarding keg-only packages.  The following command is to automatically apply these suggestions for packages relevant for Sage to make them available for the build.  Run it once to apply the suggestions for the current session."

So I just did `brew install ...` and then `./config.status --recheck && ./config.status`.



---

archive/issue_comments_420470.json:
```json
{
    "body": "Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-03-24T02:04:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420470",
    "user": "https://github.com/mkoeppe"
}
```

Sage development has entered the release candidate phase for 9.3. Setting a new milestone for this ticket based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_420471.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2021-08-16T22:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420471",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_420472.json:
```json
{
    "body": "No longer relevant with #32386",
    "created_at": "2021-08-16T22:04:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420472",
    "user": "https://github.com/mkoeppe"
}
```

No longer relevant with #32386



---

archive/issue_comments_420473.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2021-09-05T08:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420473",
    "user": "https://github.com/mwageringel"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_420474.json:
```json
{
    "body": "Resolution: invalid",
    "created_at": "2021-09-10T04:50:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29635",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29635#issuecomment-420474",
    "user": "https://github.com/mkoeppe"
}
```

Resolution: invalid
