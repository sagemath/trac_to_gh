# Issue 23346: py3: some more richcmp in schemes, rings, and combinat

Issue created by migration from https://trac.sagemath.org/ticket/23583

Original creator: chapoton

Original creation time: 2017-08-05 09:39:40

CC:  tscrim jdemeyer jhpalmieri

another step one our looong road to python3


---

Comment by chapoton created at 2017-08-05 09:41:40

New commits:


---

Comment by chapoton created at 2017-08-05 09:41:40

Changing status from new to needs_review.


---

Comment by git created at 2017-08-05 15:27:37

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2017-08-06 05:53:32

I do not understand why this change is needed:

```diff
@@ -1217,7 +1219,7 @@ class AlgebraicScheme_subscheme(AlgebraicScheme):
 
         A = self.ambient_space()
         C = Sequence([A.subscheme(X) for X in P], check=False, cr=True)
-        C.sort()
+        C.sort(key=lambda sch: sch.defining_polynomials())
         C.set_immutable()
         self.__irreducible_components = C
         return C
```

Otherwise LGTM.


---

Comment by chapoton created at 2017-08-06 06:48:24

This is needed to preserve the order of irreducible components in doctests of the same file. It turns out to change the doctest order in the tutorials.

I do not quite understand why this is so, but this works.


---

Comment by tscrim created at 2017-08-06 15:19:03

I might be paranoid, but I feel like we are changing the behavior, and without understanding why it happens. Could it come from the fact that the defining ideals are using `__cmp__` but not rich comparisons? At least, this seems the most probable to me and might be something we need to do at the same time to be a proper fix.

Also, perhaps for the rich comparisons, maybe do a rich comparisons for the ambient space? Although this last idea feels more like overkill.


---

Comment by chapoton created at 2017-08-18 06:51:47

I have undone the changes involving rings and ideals (making two step forwards and one step back does not lead to steady progress, I must say). Back to needs review.

----
New commits:


---

Comment by tscrim created at 2017-08-18 09:23:42

Replying to [comment:6 chapoton]:
> I have undone the changes involving rings and ideals (making two step forwards and one step back does not lead to steady progress, I must say).

I am sorry about this. I want to try and make sure we do not break anything in subtle ways by these changes. As always, thank you for your progress on all of this.


---

Comment by tscrim created at 2017-08-18 09:23:42

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-08-21 19:24:06

Resolution: fixed
