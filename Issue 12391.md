# Issue 12391: Don't "import site" in sympy's installer

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2012-02-22 14:31:33

Assignee: tbd

Since #12329, sympy might be installed after the Sage library.  The sympy `setup.py` imports lots of stuff, including `sage` itself.  One nasty consequence is that `sage-cleaner` can get started because of this.

The solution is to start `setup.py` with python's `-S` option to start Python with a minimal `sys.path`.


---

Attachment

Diff for the sympy spkg, for review only


---

Comment by jdemeyer created at 2012-02-23 17:51:42

Changing status from new to needs_review.


---

Comment by was created at 2012-02-23 20:14:59

Instead of a comment that sagelocal is defined, why not check it and exit with an error if it is not defined?


---

Comment by jdemeyer created at 2012-02-23 20:19:43

Replying to [comment:4 was]:
> Instead of a comment that sagelocal is defined, why not check it and exit with an error if it is not defined?
That's precisely what's happening in lines 3--7 of `spkg-install`.


---

Comment by was created at 2012-02-26 15:18:59

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2012-02-27 11:23:39

Resolution: fixed
