# Issue 19501: inconsistency in what simplify() does on trigonometrics expression

Issue created by migration from https://trac.sagemath.org/ticket/19738

Original creator: thome

Original creation time: 2015-12-17 14:32:14

CC:  zimmerma

I stumbled on the following oddity during an exercise class (sage-6.8, x86_64-linux, debian 8.2).

```
sage: simplify(cos(pi/12))
1/12*sqrt(6)*(sqrt(3) + 3)
sage: simplify(sin(pi/12))
-1/12*sqrt(6)*(sqrt(3) - 3)
sage: simplify(exp(i*pi/12))
e^(1/12*I*pi)
```

Is there any rationale for this ? It looks like an inconsistency.


---

Comment by zimmerma created at 2015-12-17 18:27:27

still the same in Sage 6.9.


---

Comment by rws created at 2015-12-27 14:31:09

Note expansion is done without the need for simplify.

Certainly the enhancement is within reach. There is a minor catch: although shortly before we have extended the values `m` for which `sin/cos/tan(n/m*pi)` is expanded in roots, simply doing `I*sin+cos` can result in mixed expressions because implementations differed for `sin` vs `cos`, e.g.

```
sage: sin(pi/15)
sin(1/15*pi)
sage: cos(pi/15)
1/8*sqrt(5) + 1/4*sqrt(3/2*sqrt(5) + 15/2) - 1/8
sage: I*sin(pi/15)+cos(pi/15)
1/8*sqrt(5) + 1/4*sqrt(3/2*sqrt(5) + 15/2) + I*sin(1/15*pi) - 1/8
```

The reason for the difference was the complexity of results---we stopped when the roots were nested more than twice.


---

Comment by rws created at 2015-12-27 15:42:05

This is fixed in pynac git master now and will come to Sage with the next upgrade (0.5.4).


---

Comment by rws created at 2015-12-28 08:46:19

However, do you want this?

```
File "src/sage/symbolic/expression.pyx", line 10262, in sage.symbolic.expression.Expression.solve
Failed example:
    (z^5 - 1).solve(z)
Expected:
    [z == e^(2/5*I*pi), z == e^(4/5*I*pi), z == e^(-4/5*I*pi), z == e^(-2/5*I*pi), z == 1]
Got:
    [z == 1/4*sqrt(5) + 1/4*I*sqrt(2*sqrt(5) + 10) - 1/4, z == -1/4*sqrt(5) + 1/4*I*sqrt(-2*sqrt(5) + 10) - 1/4, z == -1/4*sqrt(5) - 1/4*I*sqrt(-2*sqrt(5) + 10) - 1/4, z == 1/4*sqrt(5) - 1/4*I*sqrt(2*sqrt(5) + 10) - 1/4, z == 1]
```



---

Comment by zimmerma created at 2016-01-06 17:15:05

> However, do you want this?

yes, this looks coherent with the rationale "we stopped when the roots were nested more than twice" above.

Paul


---

Comment by slelievre created at 2016-01-13 09:30:50

Fixed by update to Pynac 0.6.0 at #19819?


---

Comment by rws created at 2016-01-18 07:53:14

Changing status from new to needs_review.


---

Comment by rws created at 2016-01-18 07:53:14

New commits:


---

Comment by zimmerma created at 2016-01-18 09:11:21

Changing status from needs_review to positive_review.


---

Comment by zimmerma created at 2016-01-18 09:11:21

looks good to me.
Paul


---

Comment by vbraun created at 2016-01-20 10:19:32

Resolution: fixed
