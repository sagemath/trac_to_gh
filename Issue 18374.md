# Issue 18374: Further isogeny improvement

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2015-06-04 19:45:02

CC:  cremona

To compute all `l`-isogenies, Sage uses a function `mult(f)` which computes

```
gcd( numerator(f(m)), psi )
```

where `m` is a rational function giving the multiplication-by-`m` map.

Instead of the above computation, the inverse direction is actually easier to compute: given `g`, we want to find `f` such that

```
gcd( numerator(f(m)), psi ) = g
```

Using some theory, this is equivalent to

```
f(m) = 0 mod g
```

Since `f` must be irreducible, this is just the characteristic (= minimal) polynomial of `a/b mod g`.


---

Comment by jdemeyer created at 2015-06-04 20:01:33

New commits:


---

Comment by jdemeyer created at 2015-06-04 20:01:33

Changing status from new to needs_review.


---

Comment by git created at 2015-06-04 20:13:52

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by cremona created at 2015-06-05 08:13:13

Before I go to look at the code I will confirm the theory sketched in the ticket description.  In the notation there,  g is irreducible and if alpha is a root of it then the desired f is precisely the min poly of m(alpha).


---

Comment by cremona created at 2015-06-05 08:49:30

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2015-06-05 08:49:30

Looks good and tests out well.  For the record:

```
sage: K.<a>=NumberField(x^2-x-22)                                                              sage: sage: E=EllipticCurve([0,0,1,-1590*a-8580,92750*a+359875])
sage: sage: time E.isogenies_prime_degree(89)
CPU times: user 25min 37s, sys: 2.4 s, total: 25min 39s
Wall time: 25min 37s
[Isogeny of degree 89 from Elliptic Curve defined by y^2 + y = x^3 + (-1590*a-8580)*x + (92750*a+359875) over Number Field in a with defining polynomial x^2 - x - 22 to Elliptic Curve defined by y^2 + y = x^3 + (12594390*a-80556570)*x + (-65385874750*a+319086769867) over Number Field in a with defining polynomial x^2 - x - 22]
```

though thanks to the code at #18589 this does not use mult() anyway so is not strictly relevant to this ticket.


---

Comment by jdemeyer created at 2015-06-05 09:56:27

One more remark on the algorithm: the current `mult()` does not use the fact that the characteristic polynomial is one of finitely many given possibilities. We could probably optimize even more using this information. However, my impression is that it's not currently worth it, since the other parts of the isogeny computation take more time anyway. If you do come across an example where `mult()` dominates the computation, I'd like to know.


---

Comment by vbraun created at 2015-06-06 12:47:41

Resolution: fixed
