# Issue 18374: Further isogeny improvement

archive/issues_018374.json:
```json
{
    "body": "CC:  @JohnCremona\n\nTo compute all `l`-isogenies, Sage uses a function `mult(f)` which computes\n\n```\ngcd( numerator(f(m)), psi )\n```\n\nwhere `m` is a rational function giving the multiplication-by-`m` map.\n\nInstead of the above computation, the inverse direction is actually easier to compute: given `g`, we want to find `f` such that\n\n```\ngcd( numerator(f(m)), psi ) = g\n```\n\nUsing some theory, this is equivalent to\n\n```\nf(m) = 0 mod g\n```\n\nSince `f` must be irreducible, this is just the characteristic (= minimal) polynomial of `a/b mod g`.\n\nIssue created by migration from https://trac.sagemath.org/ticket/18611\n\n",
    "created_at": "2015-06-04T19:45:02Z",
    "labels": [
        "component: elliptic curves"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.8",
    "title": "Further isogeny improvement",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/18374",
    "user": "https://github.com/jdemeyer"
}
```
CC:  @JohnCremona

To compute all `l`-isogenies, Sage uses a function `mult(f)` which computes

```
gcd( numerator(f(m)), psi )
```

where `m` is a rational function giving the multiplication-by-`m` map.

Instead of the above computation, the inverse direction is actually easier to compute: given `g`, we want to find `f` such that

```
gcd( numerator(f(m)), psi ) = g
```

Using some theory, this is equivalent to

```
f(m) = 0 mod g
```

Since `f` must be irreducible, this is just the characteristic (= minimal) polynomial of `a/b mod g`.

Issue created by migration from https://trac.sagemath.org/ticket/18611





---

archive/issue_comments_249126.json:
```json
{
    "body": "New commits:",
    "created_at": "2015-06-04T20:01:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249126",
    "user": "https://github.com/jdemeyer"
}
```

New commits:



---

archive/issue_comments_249127.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-06-04T20:01:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249127",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_249128.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2015-06-04T20:13:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249128",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_249129.json:
```json
{
    "body": "Before I go to look at the code I will confirm the theory sketched in the ticket description.  In the notation there,  g is irreducible and if alpha is a root of it then the desired f is precisely the min poly of m(alpha).",
    "created_at": "2015-06-05T08:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249129",
    "user": "https://github.com/JohnCremona"
}
```

Before I go to look at the code I will confirm the theory sketched in the ticket description.  In the notation there,  g is irreducible and if alpha is a root of it then the desired f is precisely the min poly of m(alpha).



---

archive/issue_comments_249130.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-06-05T08:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249130",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_249131.json:
```json
{
    "body": "Looks good and tests out well.  For the record:\n\n```\nsage: K.<a>=NumberField(x^2-x-22)                                                              sage: sage: E=EllipticCurve([0,0,1,-1590*a-8580,92750*a+359875])\nsage: sage: time E.isogenies_prime_degree(89)\nCPU times: user 25min 37s, sys: 2.4 s, total: 25min 39s\nWall time: 25min 37s\n[Isogeny of degree 89 from Elliptic Curve defined by y^2 + y = x^3 + (-1590*a-8580)*x + (92750*a+359875) over Number Field in a with defining polynomial x^2 - x - 22 to Elliptic Curve defined by y^2 + y = x^3 + (12594390*a-80556570)*x + (-65385874750*a+319086769867) over Number Field in a with defining polynomial x^2 - x - 22]\n```\n\nthough thanks to the code at #18589 this does not use mult() anyway so is not strictly relevant to this ticket.",
    "created_at": "2015-06-05T08:49:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249131",
    "user": "https://github.com/JohnCremona"
}
```

Looks good and tests out well.  For the record:

```
sage: K.<a>=NumberField(x^2-x-22)                                                              sage: sage: E=EllipticCurve([0,0,1,-1590*a-8580,92750*a+359875])
sage: sage: time E.isogenies_prime_degree(89)
CPU times: user 25min 37s, sys: 2.4 s, total: 25min 39s
Wall time: 25min 37s
[Isogeny of degree 89 from Elliptic Curve defined by y^2 + y = x^3 + (-1590*a-8580)*x + (92750*a+359875) over Number Field in a with defining polynomial x^2 - x - 22 to Elliptic Curve defined by y^2 + y = x^3 + (12594390*a-80556570)*x + (-65385874750*a+319086769867) over Number Field in a with defining polynomial x^2 - x - 22]
```

though thanks to the code at #18589 this does not use mult() anyway so is not strictly relevant to this ticket.



---

archive/issue_comments_249132.json:
```json
{
    "body": "One more remark on the algorithm: the current `mult()` does not use the fact that the characteristic polynomial is one of finitely many given possibilities. We could probably optimize even more using this information. However, my impression is that it's not currently worth it, since the other parts of the isogeny computation take more time anyway. If you do come across an example where `mult()` dominates the computation, I'd like to know.",
    "created_at": "2015-06-05T09:56:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249132",
    "user": "https://github.com/jdemeyer"
}
```

One more remark on the algorithm: the current `mult()` does not use the fact that the characteristic polynomial is one of finitely many given possibilities. We could probably optimize even more using this information. However, my impression is that it's not currently worth it, since the other parts of the isogeny computation take more time anyway. If you do come across an example where `mult()` dominates the computation, I'd like to know.



---

archive/issue_comments_249133.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-06-06T12:47:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/18374",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/18374#issuecomment-249133",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
