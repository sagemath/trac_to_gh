# Issue 30769: Add more typing information to manifold package

archive/issues_030769.json:
```json
{
    "body": "CC:  @tscrim @nthiery @mjungmath @egourgoulhon @fchapoton\n\nIn extension of #29775, more typing information is added to the manifold package (and its dependencies).\n\nIssue created by migration from https://trac.sagemath.org/ticket/31006\n\n",
    "closed_at": "2022-04-03T11:13:51Z",
    "created_at": "2020-12-04T12:42:25Z",
    "labels": [
        "component: manifolds"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Add more typing information to manifold package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30769",
    "user": "https://github.com/tobiasdiez"
}
```
CC:  @tscrim @nthiery @mjungmath @egourgoulhon @fchapoton

In extension of #29775, more typing information is added to the manifold package (and its dependencies).

Issue created by migration from https://trac.sagemath.org/ticket/31006





---

archive/issue_comments_439331.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-12-04T12:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439331",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_439332.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-04T12:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439332",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439333.json:
```json
{
    "body": "`from __future__ import annotations` is not available in Python 3.6, which we still support, so I am adding #30551 (Drop Python 3.6 support) as a dependency",
    "created_at": "2020-12-04T18:51:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439333",
    "user": "https://github.com/mkoeppe"
}
```

`from __future__ import annotations` is not available in Python 3.6, which we still support, so I am adding #30551 (Drop Python 3.6 support) as a dependency



---

archive/issue_comments_439334.json:
```json
{
    "body": "same in #30989",
    "created_at": "2020-12-04T19:46:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439334",
    "user": "https://github.com/fchapoton"
}
```

same in #30989



---

archive/issue_comments_439335.json:
```json
{
    "body": "Good to know, (but isn't #30053 already breaking 3.6 support?)",
    "created_at": "2020-12-05T12:32:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439335",
    "user": "https://github.com/tobiasdiez"
}
```

Good to know, (but isn't #30053 already breaking 3.6 support?)



---

archive/issue_comments_439336.json:
```json
{
    "body": "Replying to [comment:5 gh-tobiasdiez]:\n> isn't #30053 already breaking 3.6 support?\n\nThat was temporary, just for one beta during the 9.2 cycle. Python 3.6 support was restored in #30576, #30740, #30758.",
    "created_at": "2020-12-05T17:37:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439336",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:5 gh-tobiasdiez]:
> isn't #30053 already breaking 3.6 support?

That was temporary, just for one beta during the 9.2 cycle. Python 3.6 support was restored in #30576, #30740, #30758.



---

archive/issue_comments_439337.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-12-19T18:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439337",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439338.json:
```json
{
    "body": "red branch",
    "created_at": "2020-12-19T18:21:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439338",
    "user": "https://github.com/fchapoton"
}
```

red branch



---

archive/issue_comments_439339.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-12-20T22:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439339",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439340.json:
```json
{
    "body": "Merged develop branch.",
    "created_at": "2020-12-20T22:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439340",
    "user": "https://github.com/tobiasdiez"
}
```

Merged develop branch.



---

archive/issue_comments_439341.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-12-20T22:52:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439341",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439342.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-02-02T16:56:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439342",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_events_080973.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-02-02T17:46:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30769#event-80973"
}
```



---

archive/issue_comments_439343.json:
```json
{
    "body": "Now that we have dropped support for Python 3.6 (#30551), there is no obstacle to using `from __future__ import annotations` any more.",
    "created_at": "2021-05-27T22:29:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439343",
    "user": "https://github.com/mkoeppe"
}
```

Now that we have dropped support for Python 3.6 (#30551), there is no obstacle to using `from __future__ import annotations` any more.



---

archive/issue_comments_439344.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2021-07-13T13:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439344",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439345.json:
```json
{
    "body": "red branch => needs work",
    "created_at": "2021-07-13T13:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439345",
    "user": "https://github.com/fchapoton"
}
```

red branch => needs work



---

archive/issue_events_080974.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30769#event-80974"
}
```



---

archive/issue_events_080975.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-07-19T02:58:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30769#event-80975"
}
```



---

archive/issue_comments_439346.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-11-28T21:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439346",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439347.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2021-11-28T21:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439347",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439348.json:
```json
{
    "body": "Rebased",
    "created_at": "2021-11-28T21:02:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439348",
    "user": "https://github.com/tobiasdiez"
}
```

Rebased



---

archive/issue_comments_439349.json:
```json
{
    "body": "Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.",
    "created_at": "2021-12-18T19:53:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439349",
    "user": "https://github.com/mkoeppe"
}
```

Stalled in `needs_review` or `needs_info`; likely won't make it into Sage 9.5.



---

archive/issue_events_080976.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30769#event-80976"
}
```



---

archive/issue_events_080977.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:53:12Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30769#event-80977"
}
```



---

archive/issue_comments_439350.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-01-13T00:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439351.json:
```json
{
    "body": "The patchbot found some unused imports, which I've now removed. Should be green now.",
    "created_at": "2022-01-13T00:29:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439351",
    "user": "https://github.com/tobiasdiez"
}
```

The patchbot found some unused imports, which I've now removed. Should be green now.



---

archive/issue_comments_439352.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-02-23T17:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439352",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439353.json:
```json
{
    "body": "red branch",
    "created_at": "2022-02-23T17:59:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439353",
    "user": "https://github.com/mkoeppe"
}
```

red branch



---

archive/issue_comments_439354.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-02-23T21:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439354",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439355.json:
```json
{
    "body": "Merging the develop branch should be trivial, but I'll not be able to do this is in the near future; so setting it back to \"needs review\".",
    "created_at": "2022-02-23T21:53:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439355",
    "user": "https://github.com/tobiasdiez"
}
```

Merging the develop branch should be trivial, but I'll not be able to do this is in the near future; so setting it back to "needs review".



---

archive/issue_comments_439356.json:
```json
{
    "body": "That's not how it works",
    "created_at": "2022-02-23T23:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439356",
    "user": "https://github.com/mkoeppe"
}
```

That's not how it works



---

archive/issue_comments_439357.json:
```json
{
    "body": "The exact terminology of the ticket states is still somewhat mysterious to me. What I'm generally used to from participating in other projects is that \"needs review\" means that the PR is ready to be checked by the core developers. After the review process is complete but there are merge conflicts, then it's the responsibility of the contributer to fix then and after a final sign off it's merged. Sorry if that's different in sage and I've violated some unwritten laws",
    "created_at": "2022-02-24T22:47:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439357",
    "user": "https://github.com/tobiasdiez"
}
```

The exact terminology of the ticket states is still somewhat mysterious to me. What I'm generally used to from participating in other projects is that "needs review" means that the PR is ready to be checked by the core developers. After the review process is complete but there are merge conflicts, then it's the responsibility of the contributer to fix then and after a final sign off it's merged. Sorry if that's different in sage and I've violated some unwritten laws



---

archive/issue_comments_439358.json:
```json
{
    "body": "Yes, that's not how it works. Ready for review means that the branch can be merged and tested as is. The burden should not be on reviewers to fix merge conflicts",
    "created_at": "2022-02-24T22:55:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439358",
    "user": "https://github.com/mkoeppe"
}
```

Yes, that's not how it works. Ready for review means that the branch can be merged and tested as is. The burden should not be on reviewers to fix merge conflicts



---

archive/issue_comments_439359.json:
```json
{
    "body": "To add my own grain of salt, I do not like to have red blobs on my patchtbot summary:\n\nhttps://patchbot.sagemath.org/?base=develop&participant=chapoton\n\nUsually, I immediatly hammers them down to \"needs work\".",
    "created_at": "2022-02-26T20:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439359",
    "user": "https://github.com/fchapoton"
}
```

To add my own grain of salt, I do not like to have red blobs on my patchtbot summary:

https://patchbot.sagemath.org/?base=develop&participant=chapoton

Usually, I immediatly hammers them down to "needs work".



---

archive/issue_comments_439360.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-01T13:35:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439361.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-01T18:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439361",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439362.json:
```json
{
    "body": "Replying to [comment:24 mkoeppe]:\n> Yes, that's not how it works. Ready for review means that the branch can be merged and tested as is. The burden should not be on reviewers to fix merge conflicts\n\n\nI agree the reviewer shouldn't have to merge the latest develop version, but fail to see why the ticket cannot reviewed with merge conflicts.\n\nAnyway, rebased so ready for review.",
    "created_at": "2022-03-01T18:03:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439362",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:24 mkoeppe]:
> Yes, that's not how it works. Ready for review means that the branch can be merged and tested as is. The burden should not be on reviewers to fix merge conflicts


I agree the reviewer shouldn't have to merge the latest develop version, but fail to see why the ticket cannot reviewed with merge conflicts.

Anyway, rebased so ready for review.



---

archive/issue_comments_439363.json:
```json
{
    "body": "```\n     def chart(self, coordinates='', names=None, calc_method=None,\n-              coord_restrictions=None):\n+              coord_restrictions=None) -> Union[Chart, RealDiffChart]:\n         r\"\"\"\n         Define a chart, the domain of which is the manifold.\n \n@@ -1928,7 +1938,7 @@ class TopologicalManifold(ManifoldSubset):\n         return self._scalar_field_algebra\n \n     def scalar_field(self, coord_expression=None, chart=None, name=None,\n-                     latex_name=None):\n+                     latex_name=None) -> Union[ScalarField, DiffScalarField]:\n```\n\nWhy a union here - `Chart` is a base class of `RealDiffChart`.\nLikewise for `ScalarField`.",
    "created_at": "2022-03-03T01:21:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439363",
    "user": "https://github.com/mkoeppe"
}
```

```
     def chart(self, coordinates='', names=None, calc_method=None,
-              coord_restrictions=None):
+              coord_restrictions=None) -> Union[Chart, RealDiffChart]:
         r"""
         Define a chart, the domain of which is the manifold.
 
@@ -1928,7 +1938,7 @@ class TopologicalManifold(ManifoldSubset):
         return self._scalar_field_algebra
 
     def scalar_field(self, coord_expression=None, chart=None, name=None,
-                     latex_name=None):
+                     latex_name=None) -> Union[ScalarField, DiffScalarField]:
```

Why a union here - `Chart` is a base class of `RealDiffChart`.
Likewise for `ScalarField`.



---

archive/issue_comments_439364.json:
```json
{
    "body": "And same comment as I made in #29775: Please no gratuitous reformatting like this:\n\n```\n         for more examples and documentation.\n \n         \"\"\"\n-        from sage.manifolds.differentiable.tensorfield_module import \\\n-                                                              TensorFieldModule\n+        from sage.manifolds.differentiable.tensorfield_module import TensorFieldModule\n         if (k,l) not in self._tensor_modules:\n             self._tensor_modules[(k,l)] = TensorFieldModule(self, (k,l))\n         return self._tensor_modules[(k,l)]\n```\nor this:\n\n```\n         from sage.manifolds.differentiable.metric import PseudoRiemannianMetricParal\n-        return PseudoRiemannianMetricParal(self, name,\n-                                           signature=signature[0]-signature[1],\n-                                           latex_name=latex_name)\n+\n+        return PseudoRiemannianMetricParal(\n+            self, name, signature=signature[0] - signature[1], latex_name=latex_name\n+        )\n```\n\nIt's easier for reviewers if you focus the changes on what is promised on the ticket. Don't mix it with style changes and random other changes",
    "created_at": "2022-03-03T01:29:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439364",
    "user": "https://github.com/mkoeppe"
}
```

And same comment as I made in #29775: Please no gratuitous reformatting like this:

```
         for more examples and documentation.
 
         """
-        from sage.manifolds.differentiable.tensorfield_module import \
-                                                              TensorFieldModule
+        from sage.manifolds.differentiable.tensorfield_module import TensorFieldModule
         if (k,l) not in self._tensor_modules:
             self._tensor_modules[(k,l)] = TensorFieldModule(self, (k,l))
         return self._tensor_modules[(k,l)]
```
or this:

```
         from sage.manifolds.differentiable.metric import PseudoRiemannianMetricParal
-        return PseudoRiemannianMetricParal(self, name,
-                                           signature=signature[0]-signature[1],
-                                           latex_name=latex_name)
+
+        return PseudoRiemannianMetricParal(
+            self, name, signature=signature[0] - signature[1], latex_name=latex_name
+        )
```

It's easier for reviewers if you focus the changes on what is promised on the ticket. Don't mix it with style changes and random other changes



---

archive/issue_comments_439365.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-03T01:29:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439365",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439366.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-03T12:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439366",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439367.json:
```json
{
    "body": "Replying to [comment:29 mkoeppe]:\n> Why a union here - `Chart` is a base class of `RealDiffChart`.\n> Likewise for `ScalarField`.\n> \n\n\nThat was a workaround for a bug in pylance, which had troubles to correctly infer that RealDiffChart is indeed a subclass of Chart. This seems to be fixed in the meantime, so I've removed the union again. Thanks for pointing this out.",
    "created_at": "2022-03-03T12:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439367",
    "user": "https://github.com/tobiasdiez"
}
```

Replying to [comment:29 mkoeppe]:
> Why a union here - `Chart` is a base class of `RealDiffChart`.
> Likewise for `ScalarField`.
> 


That was a workaround for a bug in pylance, which had troubles to correctly infer that RealDiffChart is indeed a subclass of Chart. This seems to be fixed in the meantime, so I've removed the union again. Thanks for pointing this out.



---

archive/issue_comments_439368.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-03T12:49:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439368",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439369.json:
```json
{
    "body": "Before setting to needs review, please check whether you have addressed all comments",
    "created_at": "2022-03-03T19:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439369",
    "user": "https://github.com/mkoeppe"
}
```

Before setting to needs review, please check whether you have addressed all comments



---

archive/issue_comments_439370.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2022-03-03T19:12:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439370",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_439371.json:
```json
{
    "body": "What is still missing?",
    "created_at": "2022-03-03T19:20:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439371",
    "user": "https://github.com/tobiasdiez"
}
```

What is still missing?



---

archive/issue_comments_439372.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-20T13:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439372",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439373.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-20T16:18:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439373",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439374.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-20T16:19:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439374",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439375.json:
```json
{
    "body": "Also these changes are unnecessary:\n\n```\n \n         # 0/ Compatibility checks:\n         if comp._ring is not self._ring:\n-            raise ValueError(\"the components are not defined on the \"\n-                             \"same ring as the module\")\n+            raise ValueError(\"the components are not defined on the \" +\n+                              \"same ring as the module\")\n         if comp._frame not in self._known_bases:\n```",
    "created_at": "2022-03-20T16:47:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439375",
    "user": "https://github.com/mkoeppe"
}
```

Also these changes are unnecessary:

```
 
         # 0/ Compatibility checks:
         if comp._ring is not self._ring:
-            raise ValueError("the components are not defined on the "
-                             "same ring as the module")
+            raise ValueError("the components are not defined on the " +
+                              "same ring as the module")
         if comp._frame not in self._known_bases:
```



---

archive/issue_comments_439376.json:
```json
{
    "body": "Yes, I agree. As I've said above, these changes came from accidentally running a code formatter. Now it's quite a lot of work to untie these changes. But they are minor reformats, so I hope its fine to keep them as part of this ticket.",
    "created_at": "2022-03-20T16:56:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439376",
    "user": "https://github.com/tobiasdiez"
}
```

Yes, I agree. As I've said above, these changes came from accidentally running a code formatter. Now it's quite a lot of work to untie these changes. But they are minor reformats, so I hope its fine to keep them as part of this ticket.



---

archive/issue_comments_439377.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-21T01:11:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439377",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_439378.json:
```json
{
    "body": "Squashed, dropped reformats, rebased on top of #29775, fixed so that it works in Python 3.7",
    "created_at": "2022-03-21T01:12:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439378",
    "user": "https://github.com/mkoeppe"
}
```

Squashed, dropped reformats, rebased on top of #29775, fixed so that it works in Python 3.7



---

archive/issue_comments_439379.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-21T01:13:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439379",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439380.json:
```json
{
    "body": "Thanks",
    "created_at": "2022-03-21T09:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439380",
    "user": "https://github.com/tobiasdiez"
}
```

Thanks



---

archive/issue_comments_439381.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-03-21T10:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439381",
    "user": "https://github.com/mjungmath"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_439382.json:
```json
{
    "body": "Same comment as in #29775 here:\n\n```diff\n+        That is, return `\\Gamma^\\infty(\\Phi^* TN)` where `\\Phi:\\ M \\to N` is a smooth map.\n```\n\nDoc changes are not supposed to be part of this ticket. I would appreciate if we can address that in another ticket, and then discuss it with Eric and Travis.",
    "created_at": "2022-03-21T10:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439382",
    "user": "https://github.com/mjungmath"
}
```

Same comment as in #29775 here:

```diff
+        That is, return `\Gamma^\infty(\Phi^* TN)` where `\Phi:\ M \to N` is a smooth map.
```

Doc changes are not supposed to be part of this ticket. I would appreciate if we can address that in another ticket, and then discuss it with Eric and Travis.



---

archive/issue_comments_439383.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-21T11:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439383",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_439384.json:
```json
{
    "body": "Rebased onto narrowed #29775",
    "created_at": "2022-03-21T11:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439384",
    "user": "https://github.com/mkoeppe"
}
```

Rebased onto narrowed #29775



---

archive/issue_comments_439385.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-21T11:43:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439385",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439386.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2022-03-21T23:07:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439386",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_439387.json:
```json
{
    "body": "Rebased onto updated #29775",
    "created_at": "2022-03-21T23:07:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439387",
    "user": "https://github.com/mkoeppe"
}
```

Rebased onto updated #29775



---

archive/issue_comments_439388.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-21T23:21:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439388",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439389.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-28T10:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439389",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439390.json:
```json
{
    "body": "As all remarks seem to be addressed, Matthias is fine with my changes and I'm with his, I'll set it back to positively reviewed.",
    "created_at": "2022-03-28T10:38:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439390",
    "user": "https://github.com/tobiasdiez"
}
```

As all remarks seem to be addressed, Matthias is fine with my changes and I'm with his, I'll set it back to positively reviewed.



---

archive/issue_comments_439391.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2022-03-28T10:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439391",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_439392.json:
```json
{
    "body": "Merge failure with Sage 9.6.beta6",
    "created_at": "2022-03-28T10:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439392",
    "user": "https://github.com/egourgoulhon"
}
```

Merge failure with Sage 9.6.beta6



---

archive/issue_comments_439393.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-03-29T08:53:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439393",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_439394.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2022-03-29T08:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439394",
    "user": "https://github.com/tobiasdiez"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_439395.json:
```json
{
    "body": "Merged latest version of #29775",
    "created_at": "2022-03-29T08:58:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439395",
    "user": "https://github.com/tobiasdiez"
}
```

Merged latest version of #29775



---

archive/issue_comments_439396.json:
```json
{
    "body": "As in #29775, the coverage issue reported by the patchbot is a spurious one, due to the use of ``@`overload`. \n\nMichael, do you agree with the positive review?",
    "created_at": "2022-03-30T19:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439396",
    "user": "https://github.com/egourgoulhon"
}
```

As in #29775, the coverage issue reported by the patchbot is a spurious one, due to the use of ``@`overload`. 

Michael, do you agree with the positive review?



---

archive/issue_comments_439397.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-03-30T19:56:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439397",
    "user": "https://github.com/egourgoulhon"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_439398.json:
```json
{
    "body": "Thanks!",
    "created_at": "2022-03-30T20:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439398",
    "user": "https://github.com/tobiasdiez"
}
```

Thanks!



---

archive/issue_comments_439399.json:
```json
{
    "body": "Replying to [comment:56 egourgoulhon]:\n> Michael, do you agree with the positive review?\n\n\nYes. I still find some style changes unnecessary, e.g.\n\n```diff\n-    def set_embedding(self, phi, inverse=None, var=None,\n-                      t_inverse=None):\n+    def set_embedding(\n+        self, phi: ContinuousMap, inverse=None, var=None, t_inverse=None\n+    ):\n```\n\nleaving a glimpse of inconsistency behind. If that could be changed: I am happy. But I can also live with this. I would just appreciated it if we can stick to previously established styling rules in the future. Otherwise the code becomes more a patchwork rug than it already is.",
    "created_at": "2022-04-02T12:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439399",
    "user": "https://github.com/mjungmath"
}
```

Replying to [comment:56 egourgoulhon]:
> Michael, do you agree with the positive review?


Yes. I still find some style changes unnecessary, e.g.

```diff
-    def set_embedding(self, phi, inverse=None, var=None,
-                      t_inverse=None):
+    def set_embedding(
+        self, phi: ContinuousMap, inverse=None, var=None, t_inverse=None
+    ):
```

leaving a glimpse of inconsistency behind. If that could be changed: I am happy. But I can also live with this. I would just appreciated it if we can stick to previously established styling rules in the future. Otherwise the code becomes more a patchwork rug than it already is.



---

archive/issue_events_080978.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2022-04-03T11:13:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30769#event-80978"
}
```



---

archive/issue_comments_439400.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-04-03T11:13:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30769#issuecomment-439400",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
