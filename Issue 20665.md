# Issue 20665: Move Parent.list() method to Sets category

archive/issues_020665.json:
```json
{
    "body": "CC:  jsrn nbruin vbraun jdemeyer tscrim nthiery\n\nThe methods `__len__`, `list`, `_list_from_iterator_cashed` in the Parent class conflict with those of the `FiniteEnumerableSets` category.  One symptom is #20743. Arguably the proper place for them is the `EnumeratedSets` category (#12955). However many enumerable parents in Sage are not in that category, but nonetheless they are in Sets category. So, as a practical compromise, the three methods are moved  to the Sets category.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20902\n\n",
    "created_at": "2016-06-29T01:50:18Z",
    "labels": [
        "categories",
        "major",
        "bug"
    ],
    "title": "Move Parent.list() method to Sets category",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/20665",
    "user": "klee"
}
```
CC:  jsrn nbruin vbraun jdemeyer tscrim nthiery

The methods `__len__`, `list`, `_list_from_iterator_cashed` in the Parent class conflict with those of the `FiniteEnumerableSets` category.  One symptom is #20743. Arguably the proper place for them is the `EnumeratedSets` category (#12955). However many enumerable parents in Sage are not in that category, but nonetheless they are in Sets category. So, as a practical compromise, the three methods are moved  to the Sets category.

Issue created by migration from https://trac.sagemath.org/ticket/20902





---

archive/issue_comments_285389.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-06-29T01:59:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285389",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285390.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-06-29T02:42:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285390",
    "user": "klee"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_285391.json:
```json
{
    "body": "The patch introduces a doctest failure, which is not caused by the patch, but just revealed by it. The doctest failure is the issue treated in #20896.",
    "created_at": "2016-06-29T02:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285391",
    "user": "klee"
}
```

The patch introduces a doctest failure, which is not caused by the patch, but just revealed by it. The doctest failure is the issue treated in #20896.



---

archive/issue_comments_285392.json:
```json
{
    "body": "I have some issues with this:\n\n* You are arguing that these functions **should** be in `EnumeratedSets`, but you move them to `Sets`. Why not move them to `EnumeratedSets` and start adding parents to that category? At least, you should keep the TODO that this would be best?\n\n* The `list` function now returns a copy of the (cached) list every time. We had a long discussion on sage-devel as well as on #20743 about this, and though complete consensus didn't arise, everyone seemed to think that `list` should **not** return a fresh copy every time. Rather we should somehow flag the list as being immutable.\n\nApart from that it makes sense to move those functions from `Parent`.\n\n(I added a few of the debators on #20743 to Cc, hope you're all ok with that).",
    "created_at": "2016-07-13T02:28:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285392",
    "user": "jsrn"
}
```

I have some issues with this:

* You are arguing that these functions **should** be in `EnumeratedSets`, but you move them to `Sets`. Why not move them to `EnumeratedSets` and start adding parents to that category? At least, you should keep the TODO that this would be best?

* The `list` function now returns a copy of the (cached) list every time. We had a long discussion on sage-devel as well as on #20743 about this, and though complete consensus didn't arise, everyone seemed to think that `list` should **not** return a fresh copy every time. Rather we should somehow flag the list as being immutable.

Apart from that it makes sense to move those functions from `Parent`.

(I added a few of the debators on #20743 to Cc, hope you're all ok with that).



---

archive/issue_comments_285393.json:
```json
{
    "body": "First let me thank you for raising these issues, which are legitimate.\n\n> * You are arguing that these functions **should** be in `EnumeratedSets`, but you move them to `Sets`. Why not move them to `EnumeratedSets` and start adding parents to that category? At least, you should keep the TODO that this would be best?\n\nMany parents in Sage do have `list` method, but are not declared as in enumerable set category. Some of them seems that their enumerability is determined only at runtime, so cannot be declared so in its defining class. For example, a free module over a ring can be either enumerable or not depending on the ring. So keeping the \"list\" method only in `EnumeratedSets` category is not the way to support `list` method for existing parents. For the reason, I doubt that the TODO is really what we have to do. Yes, I am arguing against myself, but the **should** is for a perfect world.\n\n> * The `list` function now returns a copy of the (cached) list every time. We had a long discussion on sage-devel as well as on #20743 about this, and though complete consensus didn't arise, everyone seemed to think that `list` should **not** return a fresh copy every time. Rather we should somehow flag the list as being immutable.\n\nI am aware of the discussion. I was one of the proponents that `list` method should return a cashed tuple rather than a list. But searching through Sage library, I find that (1) `list` method is inconsistently implemented for many parents in Sage; (2) The implementation of `list` method for finite sets category returns a fresh copy of a cached list each time  (the same is true for `list` method of the current `Parent` class). My conclusion is that the behavior of the `list` method of the parents in the finite sets category is the de facto standard in Sage. So I copied the \"standard\" implementation to `Sets` category. \n\nIn the present ticket, I am not taking any position  about how the `list` method should be implemented, but just move around what is already in Sage. If we all agree on a proper implementation of the `list` methods of parents in the category framework, that should be another ticket.  Let me just say that for this issue, my present opinion is that the current implementation is reasonable in the category framework, and if a specific parent needs better performance, it can just implement its own `list` method.",
    "created_at": "2016-07-13T05:34:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285393",
    "user": "klee"
}
```

First let me thank you for raising these issues, which are legitimate.

> * You are arguing that these functions **should** be in `EnumeratedSets`, but you move them to `Sets`. Why not move them to `EnumeratedSets` and start adding parents to that category? At least, you should keep the TODO that this would be best?

Many parents in Sage do have `list` method, but are not declared as in enumerable set category. Some of them seems that their enumerability is determined only at runtime, so cannot be declared so in its defining class. For example, a free module over a ring can be either enumerable or not depending on the ring. So keeping the "list" method only in `EnumeratedSets` category is not the way to support `list` method for existing parents. For the reason, I doubt that the TODO is really what we have to do. Yes, I am arguing against myself, but the **should** is for a perfect world.

> * The `list` function now returns a copy of the (cached) list every time. We had a long discussion on sage-devel as well as on #20743 about this, and though complete consensus didn't arise, everyone seemed to think that `list` should **not** return a fresh copy every time. Rather we should somehow flag the list as being immutable.

I am aware of the discussion. I was one of the proponents that `list` method should return a cashed tuple rather than a list. But searching through Sage library, I find that (1) `list` method is inconsistently implemented for many parents in Sage; (2) The implementation of `list` method for finite sets category returns a fresh copy of a cached list each time  (the same is true for `list` method of the current `Parent` class). My conclusion is that the behavior of the `list` method of the parents in the finite sets category is the de facto standard in Sage. So I copied the "standard" implementation to `Sets` category. 

In the present ticket, I am not taking any position  about how the `list` method should be implemented, but just move around what is already in Sage. If we all agree on a proper implementation of the `list` methods of parents in the category framework, that should be another ticket.  Let me just say that for this issue, my present opinion is that the current implementation is reasonable in the category framework, and if a specific parent needs better performance, it can just implement its own `list` method.



---

archive/issue_comments_285394.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-07-13T07:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285394",
    "user": "klee"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_285395.json:
```json
{
    "body": "Hmm. Now I suspect that I am wrong in the first answer. The category is determined at the parent creation time and need not be hardcoded into the class. Then a free module over a ring can declare itself as either enumerable or not at its creation time. Then the fact that it does not do that in the current Sage is simply a bug.  So at least free modules are not a good example for my argument.",
    "created_at": "2016-07-13T07:37:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285395",
    "user": "klee"
}
```

Hmm. Now I suspect that I am wrong in the first answer. The category is determined at the parent creation time and need not be hardcoded into the class. Then a free module over a ring can declare itself as either enumerable or not at its creation time. Then the fact that it does not do that in the current Sage is simply a bug.  So at least free modules are not a good example for my argument.



---

archive/issue_comments_285396.json:
```json
{
    "body": "OK, your arguments are compelling. I agree that making the move is orthogonal to changing the implementation of `list`.\n\nSince it is possible to dynamically be a member of `EnumerableSets` or not, how hard would it be to move the functions into there immediately? It seems a bit wasteful to first make the move of this ticket, and then move them again. In `sets_cat.py` there's also a note on line 1368 that `cardinality` and other functions are intentionally left out of `Sets` to be put in subcategories. It seems a shame to put other functions into `Set` which actually belong elsewhere.\n\nAbout the default implementation of `__len__()`: perhaps it could check whether `self` has a `cardinality` method, in which case it could return that.",
    "created_at": "2016-07-14T13:09:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285396",
    "user": "jsrn"
}
```

OK, your arguments are compelling. I agree that making the move is orthogonal to changing the implementation of `list`.

Since it is possible to dynamically be a member of `EnumerableSets` or not, how hard would it be to move the functions into there immediately? It seems a bit wasteful to first make the move of this ticket, and then move them again. In `sets_cat.py` there's also a note on line 1368 that `cardinality` and other functions are intentionally left out of `Sets` to be put in subcategories. It seems a shame to put other functions into `Set` which actually belong elsewhere.

About the default implementation of `__len__()`: perhaps it could check whether `self` has a `cardinality` method, in which case it could return that.



---

archive/issue_comments_285397.json:
```json
{
    "body": "> Since it is possible to dynamically be a member of `EnumerableSets` or not, how hard would it be to move the functions into there immediately? It seems a bit wasteful to first make the move of this ticket, and then move them again. \n\nI thought before that it is a daunting task, if at all possible, to put every enumerable parent  into `EnumerableSets` category. Now I feel that the task can at least be done to such an extent as to avoid doctest failures.\n\n>In `sets_cat.py` there's also a note on line 1368 that `cardinality` and other functions are intentionally left out of `Sets` to be put in subcategories. It seems a shame to put other functions into `Set` which actually belong elsewhere.\n\nI agree.\n> About the default implementation of `__len__()`: perhaps it could check whether `self` has a `cardinality` method, in which case it could return that.\n\nI will consider that while moving the methods again into `EnumerableSets` category. For that, now the ticket is in \"needs work\" status :-)",
    "created_at": "2016-07-14T13:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285397",
    "user": "klee"
}
```

> Since it is possible to dynamically be a member of `EnumerableSets` or not, how hard would it be to move the functions into there immediately? It seems a bit wasteful to first make the move of this ticket, and then move them again. 

I thought before that it is a daunting task, if at all possible, to put every enumerable parent  into `EnumerableSets` category. Now I feel that the task can at least be done to such an extent as to avoid doctest failures.

>In `sets_cat.py` there's also a note on line 1368 that `cardinality` and other functions are intentionally left out of `Sets` to be put in subcategories. It seems a shame to put other functions into `Set` which actually belong elsewhere.

I agree.
> About the default implementation of `__len__()`: perhaps it could check whether `self` has a `cardinality` method, in which case it could return that.

I will consider that while moving the methods again into `EnumerableSets` category. For that, now the ticket is in "needs work" status :-)



---

archive/issue_comments_285398.json:
```json
{
    "body": "Sounds great. I'm glad you opened this ticket: I think one of the very confusing things about Sage is that many objects have generic methods that don't do anything sensible on them, exactly because some methods are not placed on the right category/parent object.",
    "created_at": "2016-07-14T14:22:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285398",
    "user": "jsrn"
}
```

Sounds great. I'm glad you opened this ticket: I think one of the very confusing things about Sage is that many objects have generic methods that don't do anything sensible on them, exactly because some methods are not placed on the right category/parent object.



---

archive/issue_comments_285399.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-09-04T13:14:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285399",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_285400.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-04T19:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285400",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285401.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-05T06:20:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285401",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285402.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-05T09:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285402",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285403.json:
```json
{
    "body": "In the patch, some old parents are modified to avoid doctest failures, but moving parents into enumerated sets cateogy is not attempted.",
    "created_at": "2016-09-07T05:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285403",
    "user": "klee"
}
```

In the patch, some old parents are modified to avoid doctest failures, but moving parents into enumerated sets cateogy is not attempted.



---

archive/issue_comments_285404.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-09-07T05:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285404",
    "user": "klee"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_285405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-08T01:43:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285405",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285406.json:
```json
{
    "body": "I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.\n\nThe change to Jordan algebras is incorrect. You should just let the `TypeError` (or whatever the error is from `tuple(self.algebra_generators())`) propagate up. Also, you should avoid having a bare `except:` statement.",
    "created_at": "2016-09-08T14:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285406",
    "user": "tscrim"
}
```

I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.

The change to Jordan algebras is incorrect. You should just let the `TypeError` (or whatever the error is from `tuple(self.algebra_generators())`) propagate up. Also, you should avoid having a bare `except:` statement.



---

archive/issue_comments_285407.json:
```json
{
    "body": "Replying to [comment:19 tscrim]:\n> I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.\n\nIt tests the method `_cardinality_from_iterator`, which is removed in the current patch. Now `.cardinality()` method is implemented instead just using `self.list()` inherited from the enumerated sets category, which itself uses the iterator of self.\n\nSo it seemed to me that the `_test_enumerated_set_iter_cardinality` lost its point with the current patch. Even the example (\"let us now break...\") under the test does not work. Would you try that?\n\nBut I may have missed the point of the test as intended by the original author. Then would you elaborate on that? \n\n> \n> The change to Jordan algebras is incorrect. You should just let the `TypeError` (or whatever the error is from `tuple(self.algebra_generators())`) propagate up. \n\nWith the current patch, the original code `tuple(self.algebra_generators())` falls into an infinite loop in the case that `self.algebra_generators()` is an infinite set. The change is to avoid this. I don't know a better way to deal with this... \n\n> Also, you should avoid having a bare `except:` statement.\n\nI see. I will correct that.",
    "created_at": "2016-09-08T15:30:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285407",
    "user": "klee"
}
```

Replying to [comment:19 tscrim]:
> I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.

It tests the method `_cardinality_from_iterator`, which is removed in the current patch. Now `.cardinality()` method is implemented instead just using `self.list()` inherited from the enumerated sets category, which itself uses the iterator of self.

So it seemed to me that the `_test_enumerated_set_iter_cardinality` lost its point with the current patch. Even the example ("let us now break...") under the test does not work. Would you try that?

But I may have missed the point of the test as intended by the original author. Then would you elaborate on that? 

> 
> The change to Jordan algebras is incorrect. You should just let the `TypeError` (or whatever the error is from `tuple(self.algebra_generators())`) propagate up. 

With the current patch, the original code `tuple(self.algebra_generators())` falls into an infinite loop in the case that `self.algebra_generators()` is an infinite set. The change is to avoid this. I don't know a better way to deal with this... 

> Also, you should avoid having a bare `except:` statement.

I see. I will correct that.



---

archive/issue_comments_285408.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-09-08T15:45:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285408",
    "user": "klee"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_285409.json:
```json
{
    "body": "Replying to [comment:20 klee]:\n> Replying to [comment:19 tscrim]:\n> > I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.\n> \n> It tests the method `_cardinality_from_iterator`, which is removed in the current patch. Now `.cardinality()` method is implemented instead just using `self.list()` inherited from the enumerated sets category, which itself uses the iterator of self.\n> \n> So it seemed to me that the `_test_enumerated_set_iter_cardinality` lost its point with the current patch. Even the example (\"let us now break...\") under the test does not work. Would you try that?\n> \n> But I may have missed the point of the test as intended by the original author. Then would you elaborate on that? \n\nIt is there to test that (`X.list()` or) `list(X) == X.cardinality()`, which could break anytime a user directly implements `cardinality` (such as on the powerset of a finite set).\n\n> > \n> > The change to Jordan algebras is incorrect. You should just let the `TypeError` (or whatever the error is from `tuple(self.algebra_generators())`) propagate up. \n> \n> With the current patch, the original code `tuple(self.algebra_generators())` falls into an infinite loop in the case that `self.algebra_generators()` is an infinite set. The change is to avoid this. I don't know a better way to deal with this... \n\nPreviously, if we were calling `tuple(X)` when `X` was known to be infinite, then this would fail with IIRC a `NotImplementedError` (try `tuple(ZZ)`). In the example, `self.algebra_generators` is known to be infinite:\n\n```\nsage: J = JordanAlgebra(FreeAlgebra(QQ, 3, 'x,y,z'))\nsage: J.algebra_generators().cardinality()\n+Infinity\n```\n\nSo the error is correct (although the reason was not because the family should know it is in the  infinite enumerated sets category). Thus I would propose fixing the category issue of `LazyFamily` when the keys are known to be infinite.\n\nAlso, I am slightly of the opinion that changing this behavior of enumerated sets with unknown cardinality is a regression. I believe that if the user knows the set is finite, they can do an explicit iteration over the object and we should force them to do that as a safeguard against the infinite loops.",
    "created_at": "2016-09-08T16:12:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285409",
    "user": "tscrim"
}
```

Replying to [comment:20 klee]:
> Replying to [comment:19 tscrim]:
> > I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.
> 
> It tests the method `_cardinality_from_iterator`, which is removed in the current patch. Now `.cardinality()` method is implemented instead just using `self.list()` inherited from the enumerated sets category, which itself uses the iterator of self.
> 
> So it seemed to me that the `_test_enumerated_set_iter_cardinality` lost its point with the current patch. Even the example ("let us now break...") under the test does not work. Would you try that?
> 
> But I may have missed the point of the test as intended by the original author. Then would you elaborate on that? 

It is there to test that (`X.list()` or) `list(X) == X.cardinality()`, which could break anytime a user directly implements `cardinality` (such as on the powerset of a finite set).

> > 
> > The change to Jordan algebras is incorrect. You should just let the `TypeError` (or whatever the error is from `tuple(self.algebra_generators())`) propagate up. 
> 
> With the current patch, the original code `tuple(self.algebra_generators())` falls into an infinite loop in the case that `self.algebra_generators()` is an infinite set. The change is to avoid this. I don't know a better way to deal with this... 

Previously, if we were calling `tuple(X)` when `X` was known to be infinite, then this would fail with IIRC a `NotImplementedError` (try `tuple(ZZ)`). In the example, `self.algebra_generators` is known to be infinite:

```
sage: J = JordanAlgebra(FreeAlgebra(QQ, 3, 'x,y,z'))
sage: J.algebra_generators().cardinality()
+Infinity
```

So the error is correct (although the reason was not because the family should know it is in the  infinite enumerated sets category). Thus I would propose fixing the category issue of `LazyFamily` when the keys are known to be infinite.

Also, I am slightly of the opinion that changing this behavior of enumerated sets with unknown cardinality is a regression. I believe that if the user knows the set is finite, they can do an explicit iteration over the object and we should force them to do that as a safeguard against the infinite loops.



---

archive/issue_comments_285410.json:
```json
{
    "body": "Hi Kwankyu!\n\nThanks for your much needed work on cleaning the generic code for\nenumerated sets. This code is tricky as it aims to cover many\ndifferent use cases, trying to do \"just the right thing\" in most of\nthem. It has grown from years of practice and this is all more artwork\nthan science ...\n\nReplying to [comment:20 klee]:\n> Replying to [comment:19 tscrim]:\n> > I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.\n> It tests the method `_cardinality_from_iterator`, which is removed in the current patch. Now `.cardinality()` method is implemented instead just using `self.list()` inherited from the enumerated sets category, which itself uses the iterator of self.\n\n-1 on removing `_cardinality_from_iterator`. This methods\nintentionally supports computing the cardinality of very large sets,\nwithout paying the memory overhead of storing all the elements. It has\nalready been used for sets that just would not fit in memory.\n\n-1 on removing `_test_enumerated_set_iter_cardinality`: it does not\nonly test `_cardinality_from_iterator`, but also all cases where both\n`__iter__` and `cardinality` are implemented by an enumerated set.\n\nCheers,\n                            Nicolas",
    "created_at": "2016-09-08T16:36:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285410",
    "user": "nthiery"
}
```

Hi Kwankyu!

Thanks for your much needed work on cleaning the generic code for
enumerated sets. This code is tricky as it aims to cover many
different use cases, trying to do "just the right thing" in most of
them. It has grown from years of practice and this is all more artwork
than science ...

Replying to [comment:20 klee]:
> Replying to [comment:19 tscrim]:
> > I don't understand why you removed `_test_enumerated_set_iter_cardinality`. This is a good check that any code cannot render invalid/redundant.
> It tests the method `_cardinality_from_iterator`, which is removed in the current patch. Now `.cardinality()` method is implemented instead just using `self.list()` inherited from the enumerated sets category, which itself uses the iterator of self.

-1 on removing `_cardinality_from_iterator`. This methods
intentionally supports computing the cardinality of very large sets,
without paying the memory overhead of storing all the elements. It has
already been used for sets that just would not fit in memory.

-1 on removing `_test_enumerated_set_iter_cardinality`: it does not
only test `_cardinality_from_iterator`, but also all cases where both
`__iter__` and `cardinality` are implemented by an enumerated set.

Cheers,
                            Nicolas



---

archive/issue_comments_285411.json:
```json
{
    "body": "Replying to [comment:23 nthiery]: \n> -1 on removing `_cardinality_from_iterator`. This methods\n> intentionally supports computing the cardinality of very large sets,\n> without paying the memory overhead of storing all the elements. It has\n> already been used for sets that just would not fit in memory.\n\nGood point. I missed this. \n\n> -1 on removing `_test_enumerated_set_iter_cardinality`: it does not\n> only test `_cardinality_from_iterator`, but also all cases where both\n> `__iter__` and `cardinality` are implemented by an enumerated set.\n\nI agree.\n\nI will recover these and also try to incorporate tscrim's criticisms. \n\nAs you will understand, it is quite tricky to accomplish this ticket's task while not failing parents relying on the existing structure...",
    "created_at": "2016-09-08T19:57:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285411",
    "user": "klee"
}
```

Replying to [comment:23 nthiery]: 
> -1 on removing `_cardinality_from_iterator`. This methods
> intentionally supports computing the cardinality of very large sets,
> without paying the memory overhead of storing all the elements. It has
> already been used for sets that just would not fit in memory.

Good point. I missed this. 

> -1 on removing `_test_enumerated_set_iter_cardinality`: it does not
> only test `_cardinality_from_iterator`, but also all cases where both
> `__iter__` and `cardinality` are implemented by an enumerated set.

I agree.

I will recover these and also try to incorporate tscrim's criticisms. 

As you will understand, it is quite tricky to accomplish this ticket's task while not failing parents relying on the existing structure...



---

archive/issue_comments_285412.json:
```json
{
    "body": "Replying to [comment:24 klee]:\n> As you will understand, it is quite tricky to accomplish this ticket's task while not failing parents relying on the existing structure... \n\nYou bet; that's why I am particularly grateful someone is taking up\nthe job!",
    "created_at": "2016-09-09T06:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285412",
    "user": "nthiery"
}
```

Replying to [comment:24 klee]:
> As you will understand, it is quite tricky to accomplish this ticket's task while not failing parents relying on the existing structure... 

You bet; that's why I am particularly grateful someone is taking up
the job!



---

archive/issue_comments_285413.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-10T19:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285413",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285414.json:
```json
{
    "body": "In the last commits, I tried to make the footprints of the patch as light as possible while accomplishing the task at hand.",
    "created_at": "2016-09-11T01:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285414",
    "user": "klee"
}
```

In the last commits, I tried to make the footprints of the patch as light as possible while accomplishing the task at hand.



---

archive/issue_comments_285415.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-09-11T01:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285415",
    "user": "klee"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_285416.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-11T22:39:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285416",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285417.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-12T16:54:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285417",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285418.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-12T22:57:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285418",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285419.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-10-25T09:24:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285419",
    "user": "klee"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_285420.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2016-10-25T14:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285420",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_285421.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-10-25T21:20:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285421",
    "user": "klee"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_285422.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-03T08:57:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285422",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285423.json:
```json
{
    "body": "From a quick look at things, I don't like all of the ``@`cached_method`'s on `__len__` because `cardinality` should be quick to compute or `list` is (generically) cached (and very fast to get the length of).\n\nYou should use ```self``` since it is essentially code.\n\nThis part of comment:22 is still true:\n> Also, I am slightly of the opinion that changing this behavior of enumerated sets with unknown cardinality is a regression. I believe that if the user knows the set is finite, they can do an explicit iteration over the object and we should force them to do that as a safeguard against the infinite loops. \n\nThinking about it a bit more, I am more convinced that this is a definite regression because it can cause infinite loops in cases that it previously did not.",
    "created_at": "2016-11-03T13:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285423",
    "user": "tscrim"
}
```

From a quick look at things, I don't like all of the ``@`cached_method`'s on `__len__` because `cardinality` should be quick to compute or `list` is (generically) cached (and very fast to get the length of).

You should use ```self``` since it is essentially code.

This part of comment:22 is still true:
> Also, I am slightly of the opinion that changing this behavior of enumerated sets with unknown cardinality is a regression. I believe that if the user knows the set is finite, they can do an explicit iteration over the object and we should force them to do that as a safeguard against the infinite loops. 

Thinking about it a bit more, I am more convinced that this is a definite regression because it can cause infinite loops in cases that it previously did not.



---

archive/issue_comments_285424.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-03T14:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285424",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285425.json:
```json
{
    "body": "Replying to [comment:35 tscrim]:\n> This part of comment:22 is still true:\n> > Also, I am slightly of the opinion that changing this behavior of enumerated sets with unknown cardinality is a regression. I believe that if the user knows the set is finite, they can do an explicit iteration over the object and we should force them to do that as a safeguard against the infinite loops. \n> \n> Thinking about it a bit more, I am more convinced that this is a definite regression because it can cause infinite loops in cases that it previously did not.\n\nI don't really understand exactly what change you mean. Would you help me by pinpointing the method where the change was introduced? And a concrete example will also help.. Perhaps I forgot something that I myself have done.",
    "created_at": "2016-11-03T15:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285425",
    "user": "klee"
}
```

Replying to [comment:35 tscrim]:
> This part of comment:22 is still true:
> > Also, I am slightly of the opinion that changing this behavior of enumerated sets with unknown cardinality is a regression. I believe that if the user knows the set is finite, they can do an explicit iteration over the object and we should force them to do that as a safeguard against the infinite loops. 
> 
> Thinking about it a bit more, I am more convinced that this is a definite regression because it can cause infinite loops in cases that it previously did not.

I don't really understand exactly what change you mean. Would you help me by pinpointing the method where the change was introduced? And a concrete example will also help.. Perhaps I forgot something that I myself have done.



---

archive/issue_comments_285426.json:
```json
{
    "body": "Replying to [comment:35 tscrim]:\n> Thinking about it a bit more, I am more convinced that this is a definite regression because it can cause infinite loops in cases that it previously did not\n\nI now see that you meant catching `TypeError` in the list method of enumerated sets.",
    "created_at": "2016-11-03T15:28:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285426",
    "user": "klee"
}
```

Replying to [comment:35 tscrim]:
> Thinking about it a bit more, I am more convinced that this is a definite regression because it can cause infinite loops in cases that it previously did not

I now see that you meant catching `TypeError` in the list method of enumerated sets.



---

archive/issue_comments_285427.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-03T22:44:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285427",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285428.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-11-03T22:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285428",
    "user": "klee"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_285429.json:
```json
{
    "body": "I made changes reflecting Travis' comments, perhaps except the last one.",
    "created_at": "2016-11-03T22:49:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285429",
    "user": "klee"
}
```

I made changes reflecting Travis' comments, perhaps except the last one.



---

archive/issue_comments_285430.json:
```json
{
    "body": "The problem I have is if a set `X` has unknown cardinality, then previously, if you call `len(X)`, it would error out to prevent you from entering into an infinite loop. If I understand the current code, it will not do that, and instead try to compute the length (which generically would try `X.list()`) and run into that infinite loop if `X` was indeed infinite.\n\nBefore:\n\n```sage\nsage: R = RecursivelyEnumeratedSet([1], lambda a: [a+1])\nsage: R.category()\nCategory of enumerated sets\nsage: R.list()\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n...\nNotImplementedError: unknown cardinality\n```\n\nWith the branch:\n\n```sage\nsage: R = RecursivelyEnumeratedSet([1], lambda a: [a+1])\nsage: R.list()  # Still waiting...\n```\n\nActually, `__len__` is defined in `RecursivelyEnumeratedSet` to return `None`, but the same issue would occur if it was not.",
    "created_at": "2016-11-04T14:22:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285430",
    "user": "tscrim"
}
```

The problem I have is if a set `X` has unknown cardinality, then previously, if you call `len(X)`, it would error out to prevent you from entering into an infinite loop. If I understand the current code, it will not do that, and instead try to compute the length (which generically would try `X.list()`) and run into that infinite loop if `X` was indeed infinite.

Before:

```sage
sage: R = RecursivelyEnumeratedSet([1], lambda a: [a+1])
sage: R.category()
Category of enumerated sets
sage: R.list()
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
...
NotImplementedError: unknown cardinality
```

With the branch:

```sage
sage: R = RecursivelyEnumeratedSet([1], lambda a: [a+1])
sage: R.list()  # Still waiting...
```

Actually, `__len__` is defined in `RecursivelyEnumeratedSet` to return `None`, but the same issue would occur if it was not.



---

archive/issue_comments_285431.json:
```json
{
    "body": "Replying to [comment:41 tscrim]:\n> The problem I have is if a set `X` has unknown cardinality, then previously, if you call `len(X)`, it would error out to prevent you from entering into an infinite loop. If I understand the current code, it will not do that, and instead try to compute the length (which generically would try `X.list()`) and run into that infinite loop if `X` was indeed infinite.\n\nThe current code for `list` method and `len` method for enumerated sets depend on `cardinality`. If cardinality is not defined, it just tries to list all elements (as the doc says). So it falls into an infinite loop when the set is actually infinite, as you said and shown by your example. An easy solution  would be to list elements only when the cardinality is known to be finite. I am now experimenting with the solution to see if it breaks other parts of Sage...",
    "created_at": "2016-11-04T15:45:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285431",
    "user": "klee"
}
```

Replying to [comment:41 tscrim]:
> The problem I have is if a set `X` has unknown cardinality, then previously, if you call `len(X)`, it would error out to prevent you from entering into an infinite loop. If I understand the current code, it will not do that, and instead try to compute the length (which generically would try `X.list()`) and run into that infinite loop if `X` was indeed infinite.

The current code for `list` method and `len` method for enumerated sets depend on `cardinality`. If cardinality is not defined, it just tries to list all elements (as the doc says). So it falls into an infinite loop when the set is actually infinite, as you said and shown by your example. An easy solution  would be to list elements only when the cardinality is known to be finite. I am now experimenting with the solution to see if it breaks other parts of Sage...



---

archive/issue_comments_285432.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-04T17:35:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285432",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285433.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-11-04T17:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285433",
    "user": "klee"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_285434.json:
```json
{
    "body": "Some little things:\n- `cashed` -> `cached`\n- Add back in the descriptive error message of \"unknown cardinality\"\n- This needs to be changed:\n  {{{#!diff\n-If ``x`` is known to be infinite, then an exception is raised.\n+If ``x`` is not known to be finite, then an exception is raised.\n  }}}\n- I don't see the point of `__len__` in `subword_complex.py`. If it is necessary, then it does not need to be cached and the `EXAMPLES::` needs a blankline after it.\n- Same for `abelian_group.py`.\n- Same for `libgap_mixin.py`.\n- For `fgp_module.py`, the `EXAMPLES::` block and you should use ```self``` (although isn't this just `_list_from_iterator`?).\n- In `homset.py`, use ```self```.\n- Same for `parent.pyx`.",
    "created_at": "2016-11-04T18:10:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285434",
    "user": "tscrim"
}
```

Some little things:
- `cashed` -> `cached`
- Add back in the descriptive error message of "unknown cardinality"
- This needs to be changed:
  {{{#!diff
-If ``x`` is known to be infinite, then an exception is raised.
+If ``x`` is not known to be finite, then an exception is raised.
  }}}
- I don't see the point of `__len__` in `subword_complex.py`. If it is necessary, then it does not need to be cached and the `EXAMPLES::` needs a blankline after it.
- Same for `abelian_group.py`.
- Same for `libgap_mixin.py`.
- For `fgp_module.py`, the `EXAMPLES::` block and you should use ```self``` (although isn't this just `_list_from_iterator`?).
- In `homset.py`, use ```self```.
- Same for `parent.pyx`.



---

archive/issue_comments_285435.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-04T18:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285435",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285436.json:
```json
{
    "body": "Replying to [comment:45 tscrim]:\n> Some little things:\n> - `cashed` -> `cached`\n\nDone.\n\n> - Add back in the descriptive error message of \"unknown cardinality\"\n\nIsn't this already there? Or do you mean somewhere else?\n\n> - This needs to be changed:\n>   {{{#!diff\n> -If ``x`` is known to be infinite, then an exception is raised.\n> +If ``x`` is not known to be finite, then an exception is raised.\n>   }}}\n\nDone.\n\n> - I don't see the point of `__len__` in `subword_complex.py`.\n\nThis would not be necessary if `subword_complex` are in enumerated sets category (the same for below), but this ticket is not to put parents into proper category. This and removing unnecesary `__len__` would be tasks of one who knows `subword_complex` well. \n\n> - If it is necessary, then it does not need to be cached and the `EXAMPLES::` needs a blankline after it.\n> - Same for `abelian_group.py`.\n> - Same for `libgap_mixin.py`.\n> - For `fgp_module.py`, the `EXAMPLES::` block and you should use ```self``` (although isn't this just `_list_from_iterator`?).\n> - In `homset.py`, use ```self```.\n> - Same for `parent.pyx`.\n\nDone.\n----\nNew commits:",
    "created_at": "2016-11-04T18:49:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285436",
    "user": "klee"
}
```

Replying to [comment:45 tscrim]:
> Some little things:
> - `cashed` -> `cached`

Done.

> - Add back in the descriptive error message of "unknown cardinality"

Isn't this already there? Or do you mean somewhere else?

> - This needs to be changed:
>   {{{#!diff
> -If ``x`` is known to be infinite, then an exception is raised.
> +If ``x`` is not known to be finite, then an exception is raised.
>   }}}

Done.

> - I don't see the point of `__len__` in `subword_complex.py`.

This would not be necessary if `subword_complex` are in enumerated sets category (the same for below), but this ticket is not to put parents into proper category. This and removing unnecesary `__len__` would be tasks of one who knows `subword_complex` well. 

> - If it is necessary, then it does not need to be cached and the `EXAMPLES::` needs a blankline after it.
> - Same for `abelian_group.py`.
> - Same for `libgap_mixin.py`.
> - For `fgp_module.py`, the `EXAMPLES::` block and you should use ```self``` (although isn't this just `_list_from_iterator`?).
> - In `homset.py`, use ```self```.
> - Same for `parent.pyx`.

Done.
----
New commits:



---

archive/issue_comments_285437.json:
```json
{
    "body": "Replying to [comment:47 klee]:\n> Replying to [comment:45 tscrim]:\n> > - Add back in the descriptive error message of \"unknown cardinality\"\n> \n> Isn't this already there? Or do you mean somewhere else?\n\nSorry, I had misread this diff:\n\n```diff\n+                sage: R.<t,p> = QQ[]\n+                sage: Q = R.quotient(t^2-t+1)\n+                sage: Q.is_finite()\n                 Traceback (most recent call last):\n                 ...\n-                NotImplementedError: unknown cardinality\n+                NotImplementedError\n```\n\n\n> > - I don't see the point of `__len__` in `subword_complex.py`.\n> \n> This would not be necessary if `subword_complex` are in enumerated sets category (the same for below), but this ticket is not to put parents into proper category. This and removing unnecesary `__len__` would be tasks of one who knows `subword_complex` well. \n\nThe issue is that `SubwordComplex` is a `SimplicialComplex`, and while the latter is not an enumerated set, the former considers itself to be. However, `SimplicialComplex` does not take a category as input. So I added this and put `SubwordComplex` in the enumerated finite simplicial complexes category.\n\nI also pushed some other improvements to the abelian groups and the libgap mixin groups. Although infinite abelian groups do not iterate properly, but that is a bug for another ticket.\n----\nNew commits:",
    "created_at": "2016-11-05T17:23:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285437",
    "user": "tscrim"
}
```

Replying to [comment:47 klee]:
> Replying to [comment:45 tscrim]:
> > - Add back in the descriptive error message of "unknown cardinality"
> 
> Isn't this already there? Or do you mean somewhere else?

Sorry, I had misread this diff:

```diff
+                sage: R.<t,p> = QQ[]
+                sage: Q = R.quotient(t^2-t+1)
+                sage: Q.is_finite()
                 Traceback (most recent call last):
                 ...
-                NotImplementedError: unknown cardinality
+                NotImplementedError
```


> > - I don't see the point of `__len__` in `subword_complex.py`.
> 
> This would not be necessary if `subword_complex` are in enumerated sets category (the same for below), but this ticket is not to put parents into proper category. This and removing unnecesary `__len__` would be tasks of one who knows `subword_complex` well. 

The issue is that `SubwordComplex` is a `SimplicialComplex`, and while the latter is not an enumerated set, the former considers itself to be. However, `SimplicialComplex` does not take a category as input. So I added this and put `SubwordComplex` in the enumerated finite simplicial complexes category.

I also pushed some other improvements to the abelian groups and the libgap mixin groups. Although infinite abelian groups do not iterate properly, but that is a bug for another ticket.
----
New commits:



---

archive/issue_comments_285438.json:
```json
{
    "body": "Replying to [comment:48 tscrim]:\n> The issue is that `SubwordComplex` is a `SimplicialComplex`, and while the latter is not an enumerated set, the former considers itself to be. However, `SimplicialComplex` does not take a category as input. So I added this and put `SubwordComplex` in the enumerated finite simplicial complexes category.\n> \n> I also pushed some other improvements to the abelian groups and the libgap mixin groups. Although infinite abelian groups do not iterate properly, but that is a bug for another ticket.\n\nThe patch looks good to me. Thank you.",
    "created_at": "2016-11-05T19:11:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285438",
    "user": "klee"
}
```

Replying to [comment:48 tscrim]:
> The issue is that `SubwordComplex` is a `SimplicialComplex`, and while the latter is not an enumerated set, the former considers itself to be. However, `SimplicialComplex` does not take a category as input. So I added this and put `SubwordComplex` in the enumerated finite simplicial complexes category.
> 
> I also pushed some other improvements to the abelian groups and the libgap mixin groups. Although infinite abelian groups do not iterate properly, but that is a bug for another ticket.

The patch looks good to me. Thank you.



---

archive/issue_comments_285439.json:
```json
{
    "body": "Is that a positive review?",
    "created_at": "2016-11-06T02:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285439",
    "user": "tscrim"
}
```

Is that a positive review?



---

archive/issue_comments_285440.json:
```json
{
    "body": "Replying to [comment:50 tscrim]:\n> Is that a positive review?\n\nYes, to your portion of the code.",
    "created_at": "2016-11-06T07:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285440",
    "user": "klee"
}
```

Replying to [comment:50 tscrim]:
> Is that a positive review?

Yes, to your portion of the code.



---

archive/issue_comments_285441.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-11-06T14:42:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285441",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_285442.json:
```json
{
    "body": "Everything else looks good. I just did some trivial fixes from the patchbot report, so I'm allowing myself to set a positive review.",
    "created_at": "2016-11-06T14:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285442",
    "user": "tscrim"
}
```

Everything else looks good. I just did some trivial fixes from the patchbot report, so I'm allowing myself to set a positive review.



---

archive/issue_comments_285443.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-11-06T14:43:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285443",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_285444.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-11-07T18:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/20665",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/20665#issuecomment-285444",
    "user": "vbraun"
}
```

Resolution: fixed
