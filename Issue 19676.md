# Issue 19676: Linear Code's covering_radius method forces the use of optional package Guava

Issue created by migration from Trac.

Original creator: dlucas

Original creation time: 2016-01-19 10:27:19

The method `covering_radius` for linear codes (in `linear_code.py`), uses optional package Guava for Gap by default.

If this package is not installed, the method crashes without a proper error message. 

This ticket proposes a reimplementation of `covering_radius`, with a generic algorithm written in Python. If Guava is not installed on the user's system, it uses the generic algorithm, else it uses the Guava one.


---

Comment by dlucas created at 2016-01-19 10:29:00

Changing status from new to needs_review.


---

Comment by dlucas created at 2016-01-19 10:29:00

I pushed the patch, this is now open for review.
----
New commits:


---

Comment by git created at 2016-01-19 11:34:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-01-19 11:35:52

As computing the covering radius is quite slow, I made this method a cached method.
This is still open for review.


---

Comment by ncohen created at 2016-01-19 12:29:36

Could you only nest inside of the try/except what needs to be, i.e. the 'load_package' command?

As it is, any 'RuntimError' raised by another line would be interpreted as a missing package, though it may well have another cause.

Thanks,

Nathann


---

Comment by ncohen created at 2016-01-19 12:32:15

Alternatively, there is this trick that Dima used somewhere else:


```
if not bool(libgap.LoadPackage("grape")):
    <code>
```



---

Comment by git created at 2016-01-19 12:42:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-01-19 12:42:50

Hello,

Thanks for your remark! I picked Dima's trick and fixed my code.

David


---

Comment by git created at 2016-01-21 12:08:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-01-21 12:10:45

It actually seems that 


```
if not bool(libgap.LoadPackage("Guava")):
    <code>
```


calls an error message which invites the user to install Guava if it's not installed.

Anyway, I went back to a (proper) `try`-`except` block.


---

Comment by git created at 2016-04-26 13:11:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dlucas created at 2016-04-26 13:11:51

I updated this ticket to the latest beta and fixed merge conflict.
This is still open for review.


---

Comment by danielaugot created at 2016-08-25 13:01:08

Hi

this is incredibly slow, up to the point of being not usable. Yet the code is correct, works on very small instances, and tests are passed.

I send the status to positive review.

Daniel


---

Comment by danielaugot created at 2016-08-25 13:01:08

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-08-26 17:50:23

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2016-08-26 17:50:23

Reviewer name is missing


---

Comment by dlucas created at 2016-08-27 09:27:58

Before setting to `positive_review` again, please read comment 13 on #21339.


---

Comment by ylchapuy created at 2016-08-31 15:10:00

You might also look at this implementation: [u/ylchapuy/coset_leaders](https://git.sagemath.org/sage.git/diff?id=u/ylchapuy/coset_leaders)


---

Comment by ylchapuy created at 2016-12-13 16:27:41

We don't really need Guava, there's all we need in gap.

I provide a sample implementation but it's buggy (try it with the code `codes.ExtendedQuadraticResidueCode(17, GF(4))`)

The branch up there could also be used in #21339 , and in the method `_build_lookup_table` from `linear_code.py`

This branch is quite efficient and computes the 177147 coset_leaders of a random linear code [30, 19] over GF(3) in less than 4 seconds, and the covering radius (5 in my example) in 3 seconds.
