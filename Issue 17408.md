# Issue 17408: load("object.sobj") is broken in the new sagenb

archive/issues_017408.json:
```json
{
    "body": "See [https://github.com/sagemath/sagenb/issues/336](https://github.com/sagemath/sagenb/issues/336)\n\nIssue created by migration from https://trac.sagemath.org/ticket/17645\n\n",
    "created_at": "2015-01-16T21:11:52Z",
    "labels": [
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.5",
    "title": "load(\"object.sobj\") is broken in the new sagenb",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/17408",
    "user": "https://github.com/novoselt"
}
```
See [https://github.com/sagemath/sagenb/issues/336](https://github.com/sagemath/sagenb/issues/336)

Issue created by migration from https://trac.sagemath.org/ticket/17645





---

archive/issue_comments_232110.json:
```json
{
    "body": "Changing component from PLEASE CHANGE to notebook.",
    "created_at": "2015-01-16T21:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232110",
    "user": "https://github.com/novoselt"
}
```

Changing component from PLEASE CHANGE to notebook.



---

archive/issue_comments_232111.json:
```json
{
    "body": "I believe this commit is responsible:\n\n```diff\ncommit 2ea8adb1158ffb5048610552ad36df55fd7ee417\nAuthor: kcrisman <kcrisman@gmail.com>\nDate:   Wed Dec 3 14:29:38 2014 -0500\n\n    Make init.sage work\n    \n    Ideally, this would later be changed to use `attach` again.\n\ndiff --git a/sagenb/notebook/worksheet.py b/sagenb/notebook/worksheet.py\nindex 53048a1..6507341 100644\n--- a/sagenb/notebook/worksheet.py\n+++ b/sagenb/notebook/worksheet.py\n@@ -3044,7 +3044,8 @@ sage.misc.latex.EMBEDDED_MODE=True\n # gets removed from the sage library.\n from sagenb.notebook.all import *\n try:\n-    attach(os.path.join(os.environ['DOT_SAGE'], 'init.sage'))\n+    from sage.misc.preparser import load\n+    load(os.path.join(os.environ['DOT_SAGE'], 'init.sage'), globals(),attach=True)\n except (KeyError, IOError):\n     pass\n     \"\"\" % (os.path.join(os.path.abspath(self.data_directory()),''), misc.DIR)\n```\n\n\nI guess it suffices to remove the added `import` line.",
    "created_at": "2015-01-19T11:08:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232111",
    "user": "https://github.com/jdemeyer"
}
```

I believe this commit is responsible:

```diff
commit 2ea8adb1158ffb5048610552ad36df55fd7ee417
Author: kcrisman <kcrisman@gmail.com>
Date:   Wed Dec 3 14:29:38 2014 -0500

    Make init.sage work
    
    Ideally, this would later be changed to use `attach` again.

diff --git a/sagenb/notebook/worksheet.py b/sagenb/notebook/worksheet.py
index 53048a1..6507341 100644
--- a/sagenb/notebook/worksheet.py
+++ b/sagenb/notebook/worksheet.py
@@ -3044,7 +3044,8 @@ sage.misc.latex.EMBEDDED_MODE=True
 # gets removed from the sage library.
 from sagenb.notebook.all import *
 try:
-    attach(os.path.join(os.environ['DOT_SAGE'], 'init.sage'))
+    from sage.misc.preparser import load
+    load(os.path.join(os.environ['DOT_SAGE'], 'init.sage'), globals(),attach=True)
 except (KeyError, IOError):
     pass
     """ % (os.path.join(os.path.abspath(self.data_directory()),''), misc.DIR)
```


I guess it suffices to remove the added `import` line.



---

archive/issue_comments_232112.json:
```json
{
    "body": "This needs a new sagenb package, coming within a few days.",
    "created_at": "2015-01-19T20:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232112",
    "user": "https://github.com/kcrisman"
}
```

This needs a new sagenb package, coming within a few days.



---

archive/issue_comments_232113.json:
```json
{
    "body": "Setting mutual dependency because this sagenb upgrade contains a very minor change in canvas3d that needs #12212.",
    "created_at": "2015-01-22T03:27:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232113",
    "user": "https://github.com/kcrisman"
}
```

Setting mutual dependency because this sagenb upgrade contains a very minor change in canvas3d that needs #12212.



---

archive/issue_comments_232114.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-01-22T03:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232114",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_232115.json:
```json
{
    "body": "Upstream package at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.3.tar\n----\nNew commits:",
    "created_at": "2015-01-22T03:31:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232115",
    "user": "https://github.com/kcrisman"
}
```

Upstream package at http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.3.tar
----
New commits:



---

archive/issue_events_050560.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-22T14:55:26Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17408#event-50560"
}
```



---

archive/issue_comments_232116.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-01-22T14:55:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232116",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_050561.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-23T11:24:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17408#event-50561"
}
```



---

archive/issue_events_050562.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-01-23T11:24:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "milestone": "sage-6.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17408#event-50562"
}
```



---

archive/issue_comments_232117.json:
```json
{
    "body": "Hang on, [https://github.com/sagemath/sagenb/pull/120](https://github.com/sagemath/sagenb/pull/120) needs more testing.",
    "created_at": "2015-01-27T11:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232117",
    "user": "https://github.com/jdemeyer"
}
```

Hang on, [https://github.com/sagemath/sagenb/pull/120](https://github.com/sagemath/sagenb/pull/120) needs more testing.



---

archive/issue_comments_232118.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2015-01-27T11:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232118",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_232119.json:
```json
{
    "body": "https://github.com/sagemath/sagenb/pull/338 has been positively reviewed, so 0.11.3.1 will probably come out tomorrow.",
    "created_at": "2015-01-29T02:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232119",
    "user": "https://github.com/kcrisman"
}
```

https://github.com/sagemath/sagenb/pull/338 has been positively reviewed, so 0.11.3.1 will probably come out tomorrow.



---

archive/issue_comments_232120.json:
```json
{
    "body": "Replying to [comment:13 kcrisman]:\n> 0.11.3.1 will probably come out tomorrow.\nCan we just make it 0.11.4 instead?",
    "created_at": "2015-01-29T06:28:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232120",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:13 kcrisman]:
> 0.11.3.1 will probably come out tomorrow.
Can we just make it 0.11.4 instead?



---

archive/issue_comments_232121.json:
```json
{
    "body": "That works too.  Did you see my comment there, by the way?\n> Only issue I see is that if someone had the beta version it would remember the previous config and still send to root`@`localhost, but for anyone just upgrading normally should be fine; I don't think there is a way to prevent that.\n\nIf you agree that is not something worth dealing with, I will make the package today.",
    "created_at": "2015-01-29T14:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232121",
    "user": "https://github.com/kcrisman"
}
```

That works too.  Did you see my comment there, by the way?
> Only issue I see is that if someone had the beta version it would remember the previous config and still send to root`@`localhost, but for anyone just upgrading normally should be fine; I don't think there is a way to prevent that.

If you agree that is not something worth dealing with, I will make the package today.



---

archive/issue_comments_232122.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-01-29T15:35:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232122",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_232123.json:
```json
{
    "body": "Upstream package at \u200bhttp://sage.math.washington.edu/home/kcrisman/sagenb-0.11.4.tar\n\nNote I *intentionally* kept the same branch to keep the history of having 0.11.3 release upstream, but no need to place 0.11.3 in upstream, obviously.",
    "created_at": "2015-01-29T15:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232123",
    "user": "https://github.com/kcrisman"
}
```

Upstream package at ​http://sage.math.washington.edu/home/kcrisman/sagenb-0.11.4.tar

Note I *intentionally* kept the same branch to keep the history of having 0.11.3 release upstream, but no need to place 0.11.3 in upstream, obviously.



---

archive/issue_comments_232124.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-01-29T15:39:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232124",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_232125.json:
```json
{
    "body": "Looks good to me. Jeroen ?",
    "created_at": "2015-01-30T21:07:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232125",
    "user": "https://github.com/fchapoton"
}
```

Looks good to me. Jeroen ?



---

archive/issue_comments_232126.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-01-31T15:52:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232126",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_232127.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2015-02-08T15:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/17408#issuecomment-232127",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_050563.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-02-08T15:26:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/17408",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/17408#event-50563"
}
```
