# Issue 11324: Add jmol script in SAGE_ROOT/local/bin to hg and update

Issue created by migration from https://trac.sagemath.org/ticket/11496

Original creator: gutow

Original creation time: 2011-06-16 02:39:31

Assignee: tbd

CC:  mhansen

Keywords: command line jmol

With the change to the Flask notebook jmol is moving to the directory local.  This requires  changes to the script that launches Jmol from the command line.  Attached is a patch that adds the updated file to the hg repository for the local/bin directory.  Don't know why it wasn't tracked in the past.


---

Attachment

jmol script into hg repository to go with flask changes


---

Comment by gutow created at 2011-06-16 02:54:40

Changing status from new to needs_review.


---

Comment by mariah created at 2011-06-23 14:25:00

Changing status from needs_review to needs_info.


---

Comment by mariah created at 2011-06-23 14:25:00

When I tried to apply the patch to sage-4.7.1.alpha1 with `hg_scripts.apply()` it failed:


```
sage: hg_scripts.apply("/home/mariah/trac_11496_add_jmol_script.patch")
cd "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin" && hg status
cd "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin" && hg status
cd "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin" && hg import   "/home/mariah/trac_11496_add_jmol_script.patch"
applying /home/mariah/trac_11496_add_jmol_script.patch
file jmol already exists
1 out of 1 hunks FAILED -- saving rejects to file jmol.rej
abort: patch failed to apply
sage:
```


Am I misunderstanding something?


---

Comment by gutow created at 2011-06-23 17:25:54

Changing status from needs_info to needs_review.


---

Comment by gutow created at 2011-06-23 17:25:54

It appears that this change may already be in 4.7.1.alpha2...check manually that the script is there and matches what is in the patch.
Replying to [comment:3 mariah]:
> When I tried to apply the patch to sage-4.7.1.alpha1 with `hg_scripts.apply()` it failed:
> 
> {{{
> sage: hg_scripts.apply("/home/mariah/trac_11496_add_jmol_script.patch")
> cd "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin" && hg status
> cd "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin" && hg status
> cd "/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin" && hg import   "/home/mariah/trac_11496_add_jmol_script.patch"
> applying /home/mariah/trac_11496_add_jmol_script.patch
> file jmol already exists
> 1 out of 1 hunks FAILED -- saving rejects to file jmol.rej
> abort: patch failed to apply
> sage:
> }}}
> 
> Am I misunderstanding something?


---

Comment by mariah created at 2011-06-23 18:26:16

They differ slightly (myjmol is the code in the patch):


```
eno% pwd
/home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin
eno% diff jmol ~/myjmol
3c3
< JMOL_HOME="`"$SAGE_LOCAL"/bin/sage-pypkg-location sagenb`""/sagenb/data/jmol"
---
> JMOL_HOME="$SAGE_LOCAL/share/jmol"
eno%
```



---

Comment by mariah created at 2011-06-23 18:26:16

Changing status from needs_review to needs_work.


---

Comment by gutow created at 2011-06-23 21:25:19

I'm not quite sure how to respond.  As of 4.7 (the last official release) that script was not included in the mercurial repository.  Am I expected to modify my patches to keep up with test releases?  

That said, If you are setting up to use the Flask notebook and the new release of Jmol, you need to have the version in my patch not the one that points to sagenb/data/jmol as that directory no longer exists.

I suggest patching by hand.

Replying to [comment:5 mariah]:

> They differ slightly (myjmol is the code in the patch): {{{ eno% pwd /home/mariah/sage/sage-4.7.1.alpha2-x86_64-Linux-core2-fc/local/bin eno% diff jmol ~/myjmol 3c3 < JMOL_HOME="`"$SAGE_LOCAL"/bin/sage-pypkg-location sagenb`""/sagenb/data/jmol" ---
> > JMOL_HOME="$SAGE_LOCAL/share/jmol"
> eno% }}}


---

Comment by gutow created at 2011-06-25 18:30:03

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2011-07-17 02:51:59

Changing status from needs_review to needs_info.


---

Comment by jhpalmieri created at 2011-07-17 02:51:59

I think that this isn't implemented correctly.  First, the reason that the jmol script is not tracked in the scripts repo is that it is installed there by the sagenb spkg.  So I think that the jmol script should be installed either by the sagenb spkg, or, even better, by the new jmol spkg from #11503.  In fact, it looks like the script is already part of that spkg; you just have to write it to the correct place in the spkg-install file.

I may be confused, though, so if you have a different opinion, please let me know.


---

Comment by gutow created at 2011-07-17 14:57:46

I believe this is a good idea.  As soon as I've changed the .spkg (see #11503) this ticket should be closed.

Replying to [comment:9 jhpalmieri]:

> I think that this isn't implemented correctly.  First, the reason that the jmol script is not tracked in the scripts repo is that it is installed there by the sagenb spkg.  So I think that the jmol script should be installed either by the sagenb spkg, or, even better, by the new jmol spkg from #11503.  In fact, it looks like the script is already part of that spkg; you just have to write it to the correct place in the spkg-install file. I may be confused, though, so if you have a different opinion, please let me know.


---

Comment by gutow created at 2011-07-18 20:41:13

Changing status from needs_info to needs_review.


---

Comment by gutow created at 2011-07-18 20:41:13

Should be closed because this is now subsumed by !#11503...


---

Comment by jhpalmieri created at 2011-07-18 21:47:30

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2011-07-18 21:47:30

To the release manager: please close this as a duplicate of #11503.


---

Comment by jdemeyer created at 2011-07-19 17:37:02

Resolution: duplicate
