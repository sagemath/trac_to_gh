# Issue 30485: Improve conda pkg-config test

Issue created by migration from https://trac.sagemath.org/ticket/30722

Original creator: mkoeppe

Original creation time: 2020-10-05 00:00:39

CC:  dimpase isuruf jhpalmieri

Follow-up from #30662.

The test introduced there seems to fail in https://github.com/mkoeppe/sage/runs/1206657981:

```
checking for x86_64-apple-darwin13.4.0-pkg-config... /Users/runner/work/sage/sage/.tox/local-conda-forge-macos-maximal/conda/bin/x86_64-apple-darwin13.4.0-pkg-config
checking pkg-config is at least version 0.29... yes
checking for ranlib... yes
checking for strip... yes
checking for GNU or BSD tar... /Users/runner/work/sage/sage/.tox/local-conda-forge-macos-maximal/conda/bin/tar
checking for Python... /Users/runner/work/sage/sage/.tox/local-conda-forge-macos-maximal/conda/bin/python
checking for latex... no
configure: You do not have 'latex', which is recommended, but not
configure: required. Latex is only really used for building pdf
configure: documents and for %latex mode in the Sage notebook.
checking for perl... /Users/runner/work/sage/sage/.tox/local-conda-forge-macos-maximal/conda/bin/perl
checking for Perl version 5.8.0 or later... yes
checking whether a conda environment is active... yes
configure: error: A conda environment (base) is active, but
the pkg-config command is not provided by the conda environment,
which indicates that the conda environment is missing
the following conda packages required for building Sage:
     pkg-config
For building Sage, either:
- activate a conda environment that has these packages, using:
    conda activate ENVIRONMENT
- or install these conda packages, using
    conda install  pkg-config
- or deactivate conda by
    conda deactivate
  (this command may need to be repeated).
```



---

Comment by mkoeppe created at 2020-10-05 00:24:55

New commits:


---

Comment by mkoeppe created at 2020-10-05 00:24:55

Changing priority from major to critical.


---

Comment by mkoeppe created at 2020-10-05 00:24:55

Changing status from new to needs_review.


---

Comment by mkoeppe created at 2020-10-05 19:52:04

This works as can be seen in https://github.com/mkoeppe/sage/runs/1206810115

Needs review


---

Comment by isuruf created at 2020-10-06 16:23:31

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2020-10-06 17:52:31

Thanks.


---

Comment by mkoeppe created at 2020-10-11 01:27:29

Changing priority from critical to blocker.


---

Comment by vbraun created at 2020-10-11 22:59:50

Resolution: fixed
