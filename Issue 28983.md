# Issue 28983: comparison in AA not reliable

Issue created by migration from https://trac.sagemath.org/ticket/29220

Original creator: vdelecroix

Original creation time: 2020-02-19 08:58:50

As reported on [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PcfHbt8pi2s)

```
sage: left_side = AA(2**(1/2) - 2**(1/3))
sage: right_side = 808620184/5240825825
sage: left_side < right_side 
True
sage: left_side < right_side 
False
```



---

Comment by lftabera created at 2020-02-19 11:22:44

I would not say that it is more consistent. It depends on the history of comparisons done before:



```
sage: a = AA(2**(1/2) - 2**(1/3))
sage: b = 808620184/5240825825
sage: a < b
True
sage: a < b
False
sage: a < b
False
sage: b = AA(b)
sage: b < a
False
sage: b > a
False
sage: b == a
False
```



---

Comment by vdelecroix created at 2020-02-19 13:40:39

New commits:


---

Comment by vdelecroix created at 2020-02-19 13:40:39

Changing status from new to needs_review.


---

Comment by SimonKing created at 2020-02-19 15:03:36

Typo: "might creates overlap" -> "might create overlap".


---

Comment by git created at 2020-02-20 10:45:43

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mmezzarobba created at 2020-02-20 12:48:35

Hi Vincent,

Thank you for investigating this issue. There is something I don't understand: why isn't it enough to call `interval._richcmp_(other, mode)` from the comparison methods for algebraic numbers?


---

Comment by vdelecroix created at 2020-02-20 12:59:06

Thanks Mark. That will be much better!


---

Comment by vdelecroix created at 2020-02-20 12:59:06

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2020-02-20 13:11:47

BTW, real interval fields are unreliable in the following scenario

```
sage: R1 = RealIntervalField(2)
sage: R2 = RealIntervalField(4)
sage: r1 = R1(1, 3/2)
sage: r2 = R2(7/4, 15/8)
sage: r1.overlaps(r2)
False
sage: r1 < r2
False
sage: r2 < r1
False
```

The problem is the implementation of `__richcmp__` which relies on the generic `richcmp` which performs coercion of the arguments. I think real intervals deserve a proper comparison implementation bypassing coercion.


---

Comment by git created at 2020-02-20 13:14:14

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by vdelecroix created at 2020-02-20 13:14:20

Changing status from needs_work to needs_review.


---

Comment by git created at 2020-02-20 14:29:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by saraedum created at 2020-02-21 00:45:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-02-22 21:15:28

Resolution: fixed
