# Issue 28983: comparison in AA not reliable

archive/issues_028983.json:
```json
{
    "body": "As reported on [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PcfHbt8pi2s)\n\n```\nsage: left_side = AA(2**(1/2) - 2**(1/3))\nsage: right_side = 808620184/5240825825\nsage: left_side < right_side \nTrue\nsage: left_side < right_side \nFalse\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/29220\n\n",
    "created_at": "2020-02-19T08:58:50Z",
    "labels": [
        "algebra",
        "critical",
        "bug"
    ],
    "title": "comparison in AA not reliable",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/28983",
    "user": "vdelecroix"
}
```
As reported on [this sage-devel thread](https://groups.google.com/forum/#!topic/sage-devel/PcfHbt8pi2s)

```
sage: left_side = AA(2**(1/2) - 2**(1/3))
sage: right_side = 808620184/5240825825
sage: left_side < right_side 
True
sage: left_side < right_side 
False
```


Issue created by migration from https://trac.sagemath.org/ticket/29220





---

archive/issue_comments_410255.json:
```json
{
    "body": "I would not say that it is more consistent. It depends on the history of comparisons done before:\n\n\n\n```\nsage: a = AA(2**(1/2) - 2**(1/3))\nsage: b = 808620184/5240825825\nsage: a < b\nTrue\nsage: a < b\nFalse\nsage: a < b\nFalse\nsage: b = AA(b)\nsage: b < a\nFalse\nsage: b > a\nFalse\nsage: b == a\nFalse\n```\n",
    "created_at": "2020-02-19T11:22:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410255",
    "user": "lftabera"
}
```

I would not say that it is more consistent. It depends on the history of comparisons done before:



```
sage: a = AA(2**(1/2) - 2**(1/3))
sage: b = 808620184/5240825825
sage: a < b
True
sage: a < b
False
sage: a < b
False
sage: b = AA(b)
sage: b < a
False
sage: b > a
False
sage: b == a
False
```




---

archive/issue_comments_410256.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-02-19T13:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410256",
    "user": "vdelecroix"
}
```

New commits:



---

archive/issue_comments_410257.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-02-19T13:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410257",
    "user": "vdelecroix"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_410258.json:
```json
{
    "body": "Typo: \"might creates overlap\" -> \"might create overlap\".",
    "created_at": "2020-02-19T15:03:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410258",
    "user": "SimonKing"
}
```

Typo: "might creates overlap" -> "might create overlap".



---

archive/issue_comments_410259.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-20T10:45:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410259",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_410260.json:
```json
{
    "body": "Hi Vincent,\n\nThank you for investigating this issue. There is something I don't understand: why isn't it enough to call `interval._richcmp_(other, mode)` from the comparison methods for algebraic numbers?",
    "created_at": "2020-02-20T12:48:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410260",
    "user": "mmezzarobba"
}
```

Hi Vincent,

Thank you for investigating this issue. There is something I don't understand: why isn't it enough to call `interval._richcmp_(other, mode)` from the comparison methods for algebraic numbers?



---

archive/issue_comments_410261.json:
```json
{
    "body": "Thanks Mark. That will be much better!",
    "created_at": "2020-02-20T12:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410261",
    "user": "vdelecroix"
}
```

Thanks Mark. That will be much better!



---

archive/issue_comments_410262.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-02-20T12:59:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410262",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_410263.json:
```json
{
    "body": "BTW, real interval fields are unreliable in the following scenario\n\n```\nsage: R1 = RealIntervalField(2)\nsage: R2 = RealIntervalField(4)\nsage: r1 = R1(1, 3/2)\nsage: r2 = R2(7/4, 15/8)\nsage: r1.overlaps(r2)\nFalse\nsage: r1 < r2\nFalse\nsage: r2 < r1\nFalse\n```\n\nThe problem is the implementation of `__richcmp__` which relies on the generic `richcmp` which performs coercion of the arguments. I think real intervals deserve a proper comparison implementation bypassing coercion.",
    "created_at": "2020-02-20T13:11:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410263",
    "user": "vdelecroix"
}
```

BTW, real interval fields are unreliable in the following scenario

```
sage: R1 = RealIntervalField(2)
sage: R2 = RealIntervalField(4)
sage: r1 = R1(1, 3/2)
sage: r2 = R2(7/4, 15/8)
sage: r1.overlaps(r2)
False
sage: r1 < r2
False
sage: r2 < r1
False
```

The problem is the implementation of `__richcmp__` which relies on the generic `richcmp` which performs coercion of the arguments. I think real intervals deserve a proper comparison implementation bypassing coercion.



---

archive/issue_comments_410264.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-02-20T13:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410264",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_410265.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-02-20T13:14:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410265",
    "user": "vdelecroix"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_410266.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-02-20T14:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410266",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_410267.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-02-21T00:45:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410267",
    "user": "saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_410268.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-02-22T21:15:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/28983",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/28983#issuecomment-410268",
    "user": "vbraun"
}
```

Resolution: fixed
