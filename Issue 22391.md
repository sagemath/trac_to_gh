# Issue 22391: SINGULAR_SO default is incorrect of Cygwin

archive/issues_022391.json:
```json
{
    "body": "It should be under `$SAGE_LOCAL/bin/cygSingular-<version>.dll`.  Rather than guess at the version the attached patch just takes the latest one (which will normally be the only one).  It's pretty hacky, but then so is this code on other platforms too.\n\nFor the purposes of the standard Sage distribution this should generally work though.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22628\n\n",
    "created_at": "2017-03-17T00:44:17Z",
    "labels": [
        "porting: Cygwin",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "SINGULAR_SO default is incorrect of Cygwin",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22391",
    "user": "@embray"
}
```
It should be under `$SAGE_LOCAL/bin/cygSingular-<version>.dll`.  Rather than guess at the version the attached patch just takes the latest one (which will normally be the only one).  It's pretty hacky, but then so is this code on other platforms too.

For the purposes of the standard Sage distribution this should generally work though.

Issue created by migration from https://trac.sagemath.org/ticket/22628





---

archive/issue_comments_311680.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-17T00:44:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311680",
    "user": "@embray"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_311681.json:
```json
{
    "body": "So on Cygwin there is no \"symlink\" `cygSingular.dll -> cygSingular-VERSION.dll`? It would be simpler if there would be. It would also be simpler if `cygSingular.dll` would just be called `libSingular.dll`. Is there any chance of getting done in upstream Singular? Then the same code could be used on all platforms.",
    "created_at": "2017-03-17T09:07:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311681",
    "user": "@jdemeyer"
}
```

So on Cygwin there is no "symlink" `cygSingular.dll -> cygSingular-VERSION.dll`? It would be simpler if there would be. It would also be simpler if `cygSingular.dll` would just be called `libSingular.dll`. Is there any chance of getting done in upstream Singular? Then the same code could be used on all platforms.



---

archive/issue_comments_311682.json:
```json
{
    "body": "Generally DLLs do not go in `/lib` on Cygwin.  The reason for this is that *Windows* searches `$PATH` for DLLs.  Further, the default way Cygwin implements symlinks is as normal files.  So Windows would see a symlink named `cygSingular.dll` and try to load the actual file `cygSingular.dll` as a DLL and fail.\n\nIn any case, I think it's better to explicitly point to the platform-specific location of a shared library.\n\n(In fact, rather than hard-coding this it would be better if there were a routine to get shared library paths in a platform-specific way.  `ctypes.util.find_library` comes close, but unfortunately it does not return absolute paths (there are a couple issues in the Python bug tracker about fixing this, but I don't know when it will be).)",
    "created_at": "2017-03-18T11:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311682",
    "user": "@embray"
}
```

Generally DLLs do not go in `/lib` on Cygwin.  The reason for this is that *Windows* searches `$PATH` for DLLs.  Further, the default way Cygwin implements symlinks is as normal files.  So Windows would see a symlink named `cygSingular.dll` and try to load the actual file `cygSingular.dll` as a DLL and fail.

In any case, I think it's better to explicitly point to the platform-specific location of a shared library.

(In fact, rather than hard-coding this it would be better if there were a routine to get shared library paths in a platform-specific way.  `ctypes.util.find_library` comes close, but unfortunately it does not return absolute paths (there are a couple issues in the Python bug tracker about fixing this, but I don't know when it will be).)



---

archive/issue_comments_311683.json:
```json
{
    "body": "Replying to [comment:3 embray]:\n> Generally DLLs do not go in `/lib` on Cygwin.  The reason for this is that *Windows* searches `$PATH` for DLLs.  Further, the default way Cygwin implements symlinks is as normal files.  So Windows would see a symlink named `cygSingular.dll` and try to load the actual file `cygSingular.dll` as a DLL and fail.\n\nThat said, for the purposes of `dlopen` it *might* be fine. I think Cygwin will resolve the symlink before passing to the underlying Windows APIs.  Regardless, I think this explicit approach is better.  I don't see the point of making a symlink on the filesystem that is otherwise pointless for this one case.",
    "created_at": "2017-03-18T11:04:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311683",
    "user": "@embray"
}
```

Replying to [comment:3 embray]:
> Generally DLLs do not go in `/lib` on Cygwin.  The reason for this is that *Windows* searches `$PATH` for DLLs.  Further, the default way Cygwin implements symlinks is as normal files.  So Windows would see a symlink named `cygSingular.dll` and try to load the actual file `cygSingular.dll` as a DLL and fail.

That said, for the purposes of `dlopen` it *might* be fine. I think Cygwin will resolve the symlink before passing to the underlying Windows APIs.  Regardless, I think this explicit approach is better.  I don't see the point of making a symlink on the filesystem that is otherwise pointless for this one case.



---

archive/issue_comments_311684.json:
```json
{
    "body": "There is still a potential problem when changing Singular versions. Then multiple DLLs might be installed. How do you know which is the correct one?",
    "created_at": "2017-03-18T13:32:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311684",
    "user": "@jdemeyer"
}
```

There is still a potential problem when changing Singular versions. Then multiple DLLs might be installed. How do you know which is the correct one?



---

archive/issue_comments_311685.json:
```json
{
    "body": "Would there be though?  I worried about this too, but I thought any previous version would be uninstalled before installing a new version.",
    "created_at": "2017-03-20T10:21:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311685",
    "user": "@embray"
}
```

Would there be though?  I worried about this too, but I thought any previous version would be uninstalled before installing a new version.



---

archive/issue_comments_311686.json:
```json
{
    "body": "Replying to [comment:6 embray]:\n> Would there be though?  I worried about this too, but I thought any previous version would be uninstalled before installing a new version.\n\n`build/pkgs/singular/spkg-install` has this wonderful part:\n\n```sh\nremove_old_version()\n{   \n    # the following is a little verbose but it ensures we leave no trace of 3.x\n    # _or_ 4.x\n    rm -f \"$SAGE_LOCAL\"/bin/*Singular*\n    rm -f \"$SAGE_LOCAL\"/bin/*singular*\n    rm -rf \"$SAGE_LOCAL/include/singular\" # 3.x and 4.x\n    rm -rf \"$SAGE_LOCAL/include/factory\" # 3.x and 4.x\n    rm -f \"$SAGE_LOCAL/include/factor.h\" # 3.x only\n    rm -f \"$SAGE_LOCAL/include/factoryconf.h\" # 3.x only\n    rm -rf \"$SAGE_LOCAL/include/omalloc\" #4.x only\n    rm -f \"$SAGE_LOCAL/include/omalloc.h\" # 3.x only\n    rm -f \"$SAGE_LOCAL/include/omlimits.h\" # 3.x only\n    rm -rf \"$SAGE_LOCAL/include/resources\" #4.x only\n    rm -rf \"$SAGE_LOCAL/include/gfanlib\" #4.x only\n    rm -f \"$SAGE_LOCAL\"/lib/libsingular* # 3.x with lower case\n    rm -f \"$SAGE_LOCAL\"/lib/libsingcf*.a # 3.x only additional archives\n    rm -f \"$SAGE_LOCAL\"/lib/libsingfac*.a # 3.x only additional archives\n    rm -f \"$SAGE_LOCAL\"/lib/libSingular* # 4.x with upper case\n    rm -f \"$SAGE_LOCAL\"/lib/p_Procs_Field* # 3.x only\n    # a bunch of additional libraries for 4.x\n    rm -f \"$SAGE_LOCAL\"/lib/libpolys*\n    rm -f \"$SAGE_LOCAL\"/lib/libfactory*\n    rm -f \"$SAGE_LOCAL\"/lib/libomalloc*\n    rm -f \"$SAGE_LOCAL\"/lib/libresources*\n    rm -r \"$SAGE_LOCAL\"/lib/libgfan*\n    rm -rf \"$SAGE_LOCAL/share/singular\"\n    rm -f \"$SAGE_LOCAL\"/share/info/singular*\n}\n```\n\nwhich doesn't deal with any of the Cygwin names for the library (that would be another good reason why Cygwin should just the name `libSingular` instead of `cygSingular`).",
    "created_at": "2017-03-20T10:26:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311686",
    "user": "@jdemeyer"
}
```

Replying to [comment:6 embray]:
> Would there be though?  I worried about this too, but I thought any previous version would be uninstalled before installing a new version.

`build/pkgs/singular/spkg-install` has this wonderful part:

```sh
remove_old_version()
{   
    # the following is a little verbose but it ensures we leave no trace of 3.x
    # _or_ 4.x
    rm -f "$SAGE_LOCAL"/bin/*Singular*
    rm -f "$SAGE_LOCAL"/bin/*singular*
    rm -rf "$SAGE_LOCAL/include/singular" # 3.x and 4.x
    rm -rf "$SAGE_LOCAL/include/factory" # 3.x and 4.x
    rm -f "$SAGE_LOCAL/include/factor.h" # 3.x only
    rm -f "$SAGE_LOCAL/include/factoryconf.h" # 3.x only
    rm -rf "$SAGE_LOCAL/include/omalloc" #4.x only
    rm -f "$SAGE_LOCAL/include/omalloc.h" # 3.x only
    rm -f "$SAGE_LOCAL/include/omlimits.h" # 3.x only
    rm -rf "$SAGE_LOCAL/include/resources" #4.x only
    rm -rf "$SAGE_LOCAL/include/gfanlib" #4.x only
    rm -f "$SAGE_LOCAL"/lib/libsingular* # 3.x with lower case
    rm -f "$SAGE_LOCAL"/lib/libsingcf*.a # 3.x only additional archives
    rm -f "$SAGE_LOCAL"/lib/libsingfac*.a # 3.x only additional archives
    rm -f "$SAGE_LOCAL"/lib/libSingular* # 4.x with upper case
    rm -f "$SAGE_LOCAL"/lib/p_Procs_Field* # 3.x only
    # a bunch of additional libraries for 4.x
    rm -f "$SAGE_LOCAL"/lib/libpolys*
    rm -f "$SAGE_LOCAL"/lib/libfactory*
    rm -f "$SAGE_LOCAL"/lib/libomalloc*
    rm -f "$SAGE_LOCAL"/lib/libresources*
    rm -r "$SAGE_LOCAL"/lib/libgfan*
    rm -rf "$SAGE_LOCAL/share/singular"
    rm -f "$SAGE_LOCAL"/share/info/singular*
}
```

which doesn't deal with any of the Cygwin names for the library (that would be another good reason why Cygwin should just the name `libSingular` instead of `cygSingular`).



---

archive/issue_comments_311687.json:
```json
{
    "body": "See #22652",
    "created_at": "2017-03-20T10:33:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311687",
    "user": "@embray"
}
```

See #22652



---

archive/issue_comments_311688.json:
```json
{
    "body": "Yeah, that's pretty hideous, which is why I wrote #22510.  In the meantime I'll update the existing \"uninstall\" to handle Cygwin better.  Unfortunately the DLL naming can't be changed.",
    "created_at": "2017-03-20T10:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311688",
    "user": "@embray"
}
```

Yeah, that's pretty hideous, which is why I wrote #22510.  In the meantime I'll update the existing "uninstall" to handle Cygwin better.  Unfortunately the DLL naming can't be changed.



---

archive/issue_comments_311689.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-20T11:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311689",
    "user": "@embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_311690.json:
```json
{
    "body": "At the very least the Singular `spkg-install` needs to be updated to handle uninstallation better on Cygwin (this is likely the case for other packages as well, but the broader issue can wait for another time).",
    "created_at": "2017-03-20T11:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311690",
    "user": "@embray"
}
```

At the very least the Singular `spkg-install` needs to be updated to handle uninstallation better on Cygwin (this is likely the case for other packages as well, but the broader issue can wait for another time).



---

archive/issue_comments_311691.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-22T15:12:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311691",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311692.json:
```json
{
    "body": "This ensures Singular will be \"uninstalled\" better when upgrading on Cygwin.  This way there really should only be one `SINGULAR_SO` (if any) found in the method used by this patch.\n\nMuch as it's not nice to have platform-specific checks in `sage.env` I think for something like this (that is, locating a shared library for `dlopen()`) it's inevitable. So I'd rather leave it explicit for now, and deal with it better later (e.g. in #22652).",
    "created_at": "2017-03-22T15:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311692",
    "user": "@embray"
}
```

This ensures Singular will be "uninstalled" better when upgrading on Cygwin.  This way there really should only be one `SINGULAR_SO` (if any) found in the method used by this patch.

Much as it's not nice to have platform-specific checks in `sage.env` I think for something like this (that is, locating a shared library for `dlopen()`) it's inevitable. So I'd rather leave it explicit for now, and deal with it better later (e.g. in #22652).



---

archive/issue_comments_311693.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-22T15:18:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311693",
    "user": "@embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_311694.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-22T15:21:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311694",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311695.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-22T15:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311695",
    "user": "@jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_311696.json:
```json
{
    "body": "Don't hardcode the extension. OS X uses `.dylib`",
    "created_at": "2017-03-22T15:22:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311696",
    "user": "@jdemeyer"
}
```

Don't hardcode the extension. OS X uses `.dylib`



---

archive/issue_comments_311697.json:
```json
{
    "body": "Ah, right.  I'll leave it for Cygwin but remove it for the 'else' case.",
    "created_at": "2017-03-22T15:23:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311697",
    "user": "@embray"
}
```

Ah, right.  I'll leave it for Cygwin but remove it for the 'else' case.



---

archive/issue_comments_311698.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-03-22T15:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311698",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311699.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-22T15:25:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311699",
    "user": "@embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_311700.json:
```json
{
    "body": "I made two minor corrections. You can set this ticket to positive_review if you agree.\n----\nNew commits:",
    "created_at": "2017-03-28T11:34:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311700",
    "user": "@jdemeyer"
}
```

I made two minor corrections. You can set this ticket to positive_review if you agree.
----
New commits:



---

archive/issue_comments_311701.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-28T11:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311701",
    "user": "@embray"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_311702.json:
```json
{
    "body": "I think I had `rm -rf` because one of the lines I replaced was `rm -r \"$SAGE_LOCAL\"/lib/libgfan*`, though I don't know why that would need `-r` either.\n\nI agree `SINGULAR_SO = None` is fairly useless, but there should still be a better fallback in case the library is not found.  Currently this just results in an `IndexError` if so.",
    "created_at": "2017-03-28T11:54:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311702",
    "user": "@embray"
}
```

I think I had `rm -rf` because one of the lines I replaced was `rm -r "$SAGE_LOCAL"/lib/libgfan*`, though I don't know why that would need `-r` either.

I agree `SINGULAR_SO = None` is fairly useless, but there should still be a better fallback in case the library is not found.  Currently this just results in an `IndexError` if so.



---

archive/issue_comments_311703.json:
```json
{
    "body": "Replying to [comment:20 embray]:\n> I think I had `rm -rf` because one of the lines I replaced was `rm -r \"$SAGE_LOCAL\"/lib/libgfan*`, though I don't know why that would need `-r` either.\n\nThe `-r` would only be needed if there would be a **directory** called `libgfan...`\n\nThat seems like something which shouldn't happen and I'd rather see an error in that case.\n\n> Currently this just results in an `IndexError` if so.\n\nAt least, it's very clear where the error happens. Setting `SINGULAR_SO = None` might just lead to more obscure errors later.",
    "created_at": "2017-03-28T11:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311703",
    "user": "@jdemeyer"
}
```

Replying to [comment:20 embray]:
> I think I had `rm -rf` because one of the lines I replaced was `rm -r "$SAGE_LOCAL"/lib/libgfan*`, though I don't know why that would need `-r` either.

The `-r` would only be needed if there would be a **directory** called `libgfan...`

That seems like something which shouldn't happen and I'd rather see an error in that case.

> Currently this just results in an `IndexError` if so.

At least, it's very clear where the error happens. Setting `SINGULAR_SO = None` might just lead to more obscure errors later.



---

archive/issue_comments_311704.json:
```json
{
    "body": "> The -r would only be needed if there would be a directory called libgfan...\n\nYeah. I didn't put it there.",
    "created_at": "2017-03-28T14:57:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311704",
    "user": "@embray"
}
```

> The -r would only be needed if there would be a directory called libgfan...

Yeah. I didn't put it there.



---

archive/issue_comments_311705.json:
```json
{
    "body": "> At least, it's very clear where the error happens. Setting SINGULAR_SO = None might just lead to more obscure errors later.\n\nBetter a more explicit error message in that \"later\" case then.  Or earlier, if you prefer.  My thinking was just that it might be nice to be able to import `sage.env` even if the Singular install is broken, for debugging purposes if nothing else.",
    "created_at": "2017-03-28T14:58:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311705",
    "user": "@embray"
}
```

> At least, it's very clear where the error happens. Setting SINGULAR_SO = None might just lead to more obscure errors later.

Better a more explicit error message in that "later" case then.  Or earlier, if you prefer.  My thinking was just that it might be nice to be able to import `sage.env` even if the Singular install is broken, for debugging purposes if nothing else.



---

archive/issue_comments_311706.json:
```json
{
    "body": "Replying to [comment:22 embray]:\n> Yeah. I didn't put it there.\n\nI'm not entirely sure that I follow you. You *did* change `-f` to `-rf`. I changed back `-rf` to `-f` in my commit.",
    "created_at": "2017-03-28T15:04:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311706",
    "user": "@jdemeyer"
}
```

Replying to [comment:22 embray]:
> Yeah. I didn't put it there.

I'm not entirely sure that I follow you. You *did* change `-f` to `-rf`. I changed back `-rf` to `-f` in my commit.



---

archive/issue_comments_311707.json:
```json
{
    "body": "> You did change -f to -rf\n\nNo, I added an entirely new line that used `-rf`--I didn't change some existing line from `-f` to `-rf`.  As I explained in [comment:21], one of the lines I *replaced* contained `rm -r` (probably unnecessarily).  I didn't really think about it though and just took the union of all the flags on the `rm` calls I was replacing (because honestly, knowing the history of this project and projects like Singular maybe there *was* a directory matching 'libgfan*' on somebody's install once... =_=)",
    "created_at": "2017-03-28T15:12:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311707",
    "user": "@embray"
}
```

> You did change -f to -rf

No, I added an entirely new line that used `-rf`--I didn't change some existing line from `-f` to `-rf`.  As I explained in [comment:21], one of the lines I *replaced* contained `rm -r` (probably unnecessarily).  I didn't really think about it though and just took the union of all the flags on the `rm` calls I was replacing (because honestly, knowing the history of this project and projects like Singular maybe there *was* a directory matching 'libgfan*' on somebody's install once... =_=)



---

archive/issue_comments_311708.json:
```json
{
    "body": "Replying to [comment:23 embray]:\n> > At least, it's very clear where the error happens. Setting SINGULAR_SO = None might just lead to more obscure errors later.\n> \n> Better a more explicit error message in that \"later\" case then.  Or earlier, if you prefer.  My thinking was just that it might be nice to be able to import `sage.env` even if the Singular install is broken, for debugging purposes if nothing else.\n\nAny comment on this?  This is the only thing keeping this from having positive_review.  There should be an explicit error message if a valid path for `SINGULAR_SO` is not found (as opposed to an obscure-looking `IndexError`).",
    "created_at": "2017-04-11T14:09:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311708",
    "user": "@embray"
}
```

Replying to [comment:23 embray]:
> > At least, it's very clear where the error happens. Setting SINGULAR_SO = None might just lead to more obscure errors later.
> 
> Better a more explicit error message in that "later" case then.  Or earlier, if you prefer.  My thinking was just that it might be nice to be able to import `sage.env` even if the Singular install is broken, for debugging purposes if nothing else.

Any comment on this?  This is the only thing keeping this from having positive_review.  There should be an explicit error message if a valid path for `SINGULAR_SO` is not found (as opposed to an obscure-looking `IndexError`).



---

archive/issue_comments_311709.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2017-04-21T12:23:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311709",
    "user": "@embray"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_311710.json:
```json
{
    "body": "Ping? FYI - I needed this to build on Cygwin.",
    "created_at": "2017-05-03T03:29:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311710",
    "user": "@tscrim"
}
```

Ping? FYI - I needed this to build on Cygwin.



---

archive/issue_comments_311711.json:
```json
{
    "body": "If Jeroen doesn't mind I could switch this back over to my branch and just add the minor fix I'm proposing.  It's mostly just a nitpick.",
    "created_at": "2017-05-03T09:02:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311711",
    "user": "@embray"
}
```

If Jeroen doesn't mind I could switch this back over to my branch and just add the minor fix I'm proposing.  It's mostly just a nitpick.



---

archive/issue_comments_311712.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-05-05T14:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311712",
    "user": "@embray"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_311713.json:
```json
{
    "body": "Went ahead and did what I had in mind.  This will error out very early on in `sage.env` on all platforms if Singular is not built/installed properly.\n----\nNew commits:",
    "created_at": "2017-05-05T14:46:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311713",
    "user": "@embray"
}
```

Went ahead and did what I had in mind.  This will error out very early on in `sage.env` on all platforms if Singular is not built/installed properly.
----
New commits:



---

archive/issue_comments_311714.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-05-05T14:49:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311714",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_311715.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-05-20T22:46:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311715",
    "user": "@vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_311716.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-04T10:11:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22391",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22391#issuecomment-311716",
    "user": "@vbraun"
}
```

Resolution: fixed
