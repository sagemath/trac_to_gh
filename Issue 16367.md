# Issue 16367: new OA for n=112,160,224,514,796

Issue created by migration from Trac.

Original creator: ncohen

Original creation time: 2014-07-02 17:16:22

CC:  vdelecroix

As the title says.

Because this method also needs to shorten a matrix in the middle of `OA_from_Vmt`, it is split into `QDM_from_Vmt` and `OA_from_quasi_difference_matrix` (which was already called).

Nathann


---

Comment by ncohen created at 2014-07-02 17:16:59

Changing status from new to needs_review.


---

Comment by git created at 2014-07-02 17:17:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-07-03 06:26:53

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2014-07-03 06:26:53

Hey Nathann,

In `OA_14_124`, it is not safe to ask for a finite field of size 2<sup>5</sup> and hope that, by chance, its generator satisfies `w^5 + w^2 + 1 = 0`. You would rather give the constructor an explicit polynomial:

```
sage: R = PolynomialRing(GF(2),'x')
sage: x = R.gen()
sage: GF(2**5, 'w', modulus=x**5+x**2+1)
Finite Field in w of size 2^5
```


and I got a docbuild error

```
OSError: [combinat ] None:5: WARNING: citation not found: BvR514
```


Vincent


---

Comment by ncohen created at 2014-07-03 11:38:58

Yo !

> In `OA_14_124`, it is not safe to ask for a finite field of size 2<sup>5</sup> and hope that, by chance, its generator satisfies `w^5 + w^2 + 1 = 0`. 

Yeah... And "by chance" it always works ?

Given that you are the one to complain about this, I will use the first's trick against you : `conway=True` `:-P`

> and I got a docbuild error
> {{{
> OSError: [combinat ] None:5: WARNING: citation not found: BvR514
> }}}

Ahahahah. I must have replaced 82 with 514 at some point `:-D`

I had also "made a small mistake" in the implementation. I had forgotten to set some flag from "False" to "True", which means that the new OA have a longer width. I didn't like to notice that I had implemented so many new OA and that they did not even reach the Handbook's bound.... Now all is good `:-P`

I also added an OA for 640, freshly debugged.

Nathann


---

Comment by ncohen created at 2014-07-03 11:38:58

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-07-03 11:39:06

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-03 11:57:52

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by ncohen created at 2014-07-03 11:58:14

(I had forgotten a "Found by Julian R. Abel" line)

Nathann


---

Comment by ncohen created at 2014-07-04 08:02:15

added a `OA(15,896)`.


---

Comment by git created at 2014-07-04 08:04:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-04 12:10:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-04 12:12:35

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-07-05 12:34:36

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-06 09:41:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-07 08:03:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-07 08:08:58

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2014-07-12 10:13:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-14 17:18:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-07-19 15:03:02

Is this the end of commit?


---

Comment by ncohen created at 2014-07-19 17:05:17

Yes it i! All MOLS from Julian R. Abel's thesis have been fixed and implemented ! `:-D`

Nathann


---

Comment by git created at 2014-07-21 15:47:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-08 10:05:21

Hi Nathann,

I simplified the helper function at u/vdelecroix/16604 and update the branch over 6.3.rc1.

I would be really happy if:
- the helper function would return a quasi-difference matrix instead
- it was a function (not a hidden one) with explanations. I was able to simplify the function reading line by line but I do not understand anything. Do you have at least references for the construction?

(I can handle the merge with your documentation ticket #16766)

Vincent


---

Comment by vdelecroix created at 2014-08-08 10:05:21

Changing status from needs_review to needs_info.


---

Comment by ncohen created at 2014-08-08 10:16:24

Yo !

> I would be really happy if:
> - the helper function would return a quasi-difference matrix instead
> - it was a function (not a hidden one) with explanations. I was able to simplify the function reading line by line but I do not understand anything. Do you have at least references for the construction?

I made it a private function exactly because I have no idea how to write a proper documentation for it. It is just a kind of construction that Julian R. Abel uses for many OA, and as I found I had been doing copy/pastes for it many many times I figured out that it would be better to simplify the code by making it one function. What it does exactly was not more documented before than it is now.

You can find examples of this construction in the Handbook, like on page 171 about theorem 3.76 for n=80.

> (I can handle the merge with your documentation ticket #16766)

Hmmmm... I know that we will have to pay for this patch `:-/`

Nathann


---

Comment by ncohen created at 2014-08-08 10:16:24

Changing status from needs_info to needs_review.


---

Comment by vdelecroix created at 2014-08-08 10:16:45

(I am using a live usb key and I completely messed up the author name in my commits. I tried "git rebase -i HEAD~2" but I obtain a list of 200+ commits because of the merge... do you know how to fix it?)


---

Comment by vdelecroix created at 2014-08-08 10:19:16

Replying to [comment:27 ncohen]:
> Yo !
> 
> > I would be really happy if:
> > - the helper function would return a quasi-difference matrix instead
> > - it was a function (not a hidden one) with explanations. I was able to simplify the function reading line by line but I do not understand anything. Do you have at least references for the construction?
> 
> I made it a private function exactly because I have no idea how to write a proper documentation for it. It is just a kind of construction that Julian R. Abel uses for many OA, and as I found I had been doing copy/pastes for it many many times I figured out that it would be better to simplify the code by making it one function. What it does exactly was not more documented before than it is now.
> 
> You can find examples of this construction in the Handbook, like on page 171 about theorem 3.76 for n=80.

It is not an explanation... I would like something like "If A and Y are matrices of size XX and properties YY then applying construction ZZ you obtain a quasi-difference matrix".


---

Comment by ncohen created at 2014-08-08 10:20:14

> It is not an explanation... I would like something like "If A and Y are matrices of size XX and properties YY then applying construction ZZ you obtain a quasi-difference matrix".

I understand what you want, I am just telling you that this is all I have.

Nathann


---

Comment by ncohen created at 2014-08-08 10:22:48

> (I am using a live usb key and I completely messed up the author name in my commits. I tried "git rebase -i HEAD~2" but I obtain a list of 200+ commits because of the merge... do you know how to fix it?)

to change your last two commits I would do that :

1) git reset HEAD~1 # this "cancels" your last commit, and its code will become "staged differences". As if you had not typed "git commit"

2) git commit --amend --author <whatever you want> # change the author of the merge commit

3) git commit -a --author <whatever you want> # do your last commit again

Nathann


---

Comment by vdelecroix created at 2014-08-08 10:26:10

Replying to [comment:31 ncohen]:
> > (I am using a live usb key and I completely messed up the author name in my commits. I tried "git rebase -i HEAD~2" but I obtain a list of 200+ commits because of the merge... do you know how to fix it?)
> 
> to change your last two commits I would do that :
> 
> 1) git reset HEAD~1 # this "cancels" your last commit, and its code will become "staged differences". As if you had not typed "git commit"
> 
> 2) git commit --amend --author <whatever you want> # change the author of the merge commit
> 
> 3) git commit -a --author <whatever you want> # do your last commit again

Great. It worked... but this method works only if there is at most one commit after the merge. If you have a look at the branch u/vdelecroix/16604 the helper function is much simpler (and the code run a bit faster).

Vincent


---

Comment by ncohen created at 2014-08-08 10:27:36

New commits:


---

Comment by ncohen created at 2014-08-08 10:34:05

Yooooooooo !

I just read your new version of the code. Thanks, it's much better than this ! I will add a small commit for a sentence I had some trouble understanding at first.

And if you do not mind I will also reverse your `2**n-->1<<n`. That's zero improvement on speed for less redability. 

Nathann


---

Comment by ncohen created at 2014-08-08 10:39:09

Here it is ! And I agree with your commits of course, thank you again !

By the way : the improvement at #16720 is made by not using addition on the group/field objects from Sage, because it is too slow. So we have to keep that in mind if we ever meet speed problems again with these operations.

Nathann
----
New commits:


---

Comment by git created at 2014-08-08 22:21:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-08 22:25:11

Hi again,

I read the Abel-Cheng paper of 1994 (written during Julian Abel's thesis I guess) where the explanation was clear enough to write a complete documentation. The function has moved to orthogonal_array.py...

Please read three times the documentation to see whether its readable and understandable. You can also complain about the ugly name I choose, but in that case find something better.

Vincent

PS: there are two mysteries that I will ask Julian about
 - it is not clear to me why we need w<sup>c</sup> = w + 1
 - we do not care very much of the fact that the part different from `2^c` is a prime number


---

Comment by ncohen created at 2014-08-10 07:38:47

Yooooo !!!

> I read the Abel-Cheng paper of 1994 (written during Julian Abel's thesis I guess) where the explanation was clear enough to write a complete documentation. The function has moved to orthogonal_array.py...

Great ! It is cool to have a good doc for this construction. But the function's name makes one think "Okay, this function takes c as an input and return an OA with `n=2^c`".

> Please read three times the documentation to see whether its readable and understandable. You can also complain about the ugly name I choose, but in that case find something better.

Well. Did you read it  three times yourself ? `:-P`

- Most of the function's one line description defines what n is, and at this level we do not care much. What about `Returns an OA(k,|G_1|2^c) from a constrained (G_1,k-1,2)-difference matrix` ? It is a bit more meaningful and also indicates that the function's input is not as simple as a pair of integers...

- Why `G_1` and not `G` ?

- Shouldn't we use `F_p` rather than `GF(2)` in the doc ?

- `that belong t`

- B and C : why not name them `A_{G_1}` and `A_{GF(2)} ` ?

- `For any pair `i` and `j` of distinct integers in `{1,...,k-1}` and `g` an element of `G_1`` --> `for any i\neq j and g\in G_1` ?

- `C_{i,k_1} - C_{i,k_1}` is zero `:-P`

- the array whose rowS

About the function's name here's my attempt: `OA_p_times_2_pow_c_from_matrix` ? With your name one can believe that it is just about powers of two. And the "from matrix" indicated that "if you are looking for something standard, pass your way".

Nathann


---

Comment by vdelecroix created at 2014-08-10 09:36:10

Hello,

Thanks for your careful reading.
 
> > Please read three times the documentation to see whether its readable and understandable. You can also complain about the ugly name I choose, but in that case find something better.
> 
> Well. Did you read it  three times yourself ? `:-P`

No. I wrote it three times ;-?

> - Most of the function's one line description defines what n is, and at this level we do not care much. What about `Returns an OA(k,|G_1|2^c) from a constrained (G_1,k-1,2)-difference matrix` ? It is a bit more meaningful and also indicates that the function's input is not as simple as a pair of integers...

done

> - Why `G_1` and not `G` ?

Because G was the cartesian product. Now changed.

> - Shouldn't we use `F_p` rather than `GF(2)` in the doc ?

You meant `F_2`? And then use `F_{2^c}` for `GF(2^c)`. In non compiled version of the doc I found my version more readable. Moreover, it conincides with what you use in Sage to get your finite field. And it is pretty much standard ([wikipedia entry for GF(2)](http://en.wikipedia.org/wiki/GF%282%29)).

> - `that belong t`

t -> to (done)

> - B and C : why not name them `A_{G_1}` and `A_{GF(2)} ` ?

B and C is the notation from Abel-Cheng 1994. And it is much shorter when you have to write `B_{i,k_1}` instead of `(A_{GF(2)})_{i,k_1}`.

> - `For any pair `i` and `j` of distinct integers in `{1,...,k-1}` and `g` an element of `G_1`` --> `for any i\neq j and g\in G_1` ?

done

> - `C_{i,k_1} - C_{i,k_1}` is zero `:-P`

you are right! It is now `C_{i,k_1} - C_{j,k_1}`.

> - the array whose rowS

done

> About the function's name here's my attempt: `OA_p_times_2_pow_c_from_matrix` ? With your name one can believe that it is just about powers of two. And the "from matrix" indicated that "if you are looking for something standard, pass your way".

As I mentioned it is not `p_times_2_pow_c` but `n_times_2_pow_c`. `G` needs not be a cyclic group of prime order. Changed for `OA_n_times_2_pow_c_from_matrix`.

Vincent


---

Comment by git created at 2014-08-10 09:36:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-08-11 09:04:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-08-11 09:10:02

Helloooooooooo !!

Thanks for your modifications. I added a small commit to fix a couple of things 

* add the function in the new index

* Move the explanation on how elements of `GF(2^c)` should be encoded to the input section

I also tried to rephrase the last sentence of the explanation but I still don't get it. I replaced an occurrence of `G_1` with `G` (and I think that was not a mistake), plus I changed the bound `1<=i<= |G|` to `1<= i <= 2|G|`, and now it seems that you indexed `Y` with `i,j` while it should be indexed on `k`. Especially since now that `i` goes to `2|G|` the vector `Y` has the wrong length. Plus you define `Y` as being of length `k-1`. Could you check that again ?

You also defined `k` as ranging from `1` to `k-1` which was a bit hard to read, so I "found a way around".

Tell me what you think !

Nathann


---

Comment by vdelecroix created at 2014-08-11 10:27:29

Hi,

I was a bit stupid: there is a `k` in the parameter but I used it as a variable... so it is definitely confusing. Moreover in the Abel-Cheng articles they use transposed matrix so I was confused with rows and columns. I will add a commit about that in a minute.

Vincent


---

Comment by git created at 2014-08-11 10:51:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-11 10:51:58

The matrix `A` has as many rows as the length of `Y` and has `2|G|` columns...

Vincent


---

Comment by ncohen created at 2014-08-11 11:13:03

Cool ! This time I got it ! `:-D`

It really is hell with everybody using the matrix or its transpose `T_T`

By the wayyyyyy... As this function is now public... Would you feel like writing some code to check that all constraints are satisfied ? `^^;`

You see all these things better than I, that's why I ask... `^^;`

Nathann


---

Comment by git created at 2014-08-11 12:02:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-11 12:03:38

Good idea. I did the dimension check... if we want more, we need `is_difference_matrix`.

I would go for a positive review at this stage... what do you think?

Vincent


---

Comment by ncohen created at 2014-08-11 12:11:54

Yo !

> Good idea. I did the dimension check... if we want more, we need `is_difference_matrix`.

We don't have `is_difference_matrix` ? `O_o`

Okay then I will write this today. You may like difference families but I like difference matrices.

We need a `is_difference_matrix`. Then we'll finish this ticket.

Nathann


---

Comment by ncohen created at 2014-08-11 19:27:50

Ticket for is_difference_matrix: #16797

Nathann


---

Comment by git created at 2014-08-13 10:55:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2014-08-13 10:55:51

Needs review.

Vincent


---

Comment by git created at 2014-08-13 12:40:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-08-13 13:34:38

Your turn !

Nathann


---

Comment by vdelecroix created at 2014-08-13 15:15:19

I am happy with the current version.

Vincent


---

Comment by vdelecroix created at 2014-08-13 15:15:19

Changing status from needs_review to positive_review.


---

Comment by git created at 2014-08-16 06:58:46

Changing status from positive_review to needs_review.


---

Comment by git created at 2014-08-16 06:58:46

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by ncohen created at 2014-08-16 06:59:54

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-08-16 09:32:21

Resolution: fixed
