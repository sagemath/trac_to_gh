# Issue 12791: PolyBoRi links against system -lboost_unit_test_framework

archive/issues_012791.json:
```json
{
    "body": "Assignee: tbd\n\nCC:  alexanderdreyer\n\nAs noted on sage-support, the sage-5.0 **binary** `sage-5.0-linux-32bit-fedora_release_16_verne_-i686-Linux.tar.gz` requires the boost library `libboost_unit_test_framework` at runtime, since the binary was built on a machine with that library available.  PolyBoRi checks for `-lboost_unit_test_framework` and links against it if available.\n\nThis is because of the PolyBoRi upgrade to version 0.8.1.  The older PolyBoRi in sage-4.8 did not do this.\n\nIssue created by migration from https://trac.sagemath.org/ticket/12963\n\n",
    "created_at": "2012-05-17T16:23:49Z",
    "labels": [
        "packages: standard",
        "blocker",
        "bug"
    ],
    "title": "PolyBoRi links against system -lboost_unit_test_framework",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/12791",
    "user": "jdemeyer"
}
```
Assignee: tbd

CC:  alexanderdreyer

As noted on sage-support, the sage-5.0 **binary** `sage-5.0-linux-32bit-fedora_release_16_verne_-i686-Linux.tar.gz` requires the boost library `libboost_unit_test_framework` at runtime, since the binary was built on a machine with that library available.  PolyBoRi checks for `-lboost_unit_test_framework` and links against it if available.

This is because of the PolyBoRi upgrade to version 0.8.1.  The older PolyBoRi in sage-4.8 did not do this.

Issue created by migration from https://trac.sagemath.org/ticket/12963





---

archive/issue_comments_153506.json:
```json
{
    "body": "I'd be in favor of adding the missing bits of boost. Its a great library and we should make more use of it if anything.",
    "created_at": "2012-05-17T17:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153506",
    "user": "vbraun"
}
```

I'd be in favor of adding the missing bits of boost. Its a great library and we should make more use of it if anything.



---

archive/issue_comments_153507.json:
```json
{
    "body": "The full boost package is close to 50 MB in size.  So I can imagine some people being unhappy about this.",
    "created_at": "2012-05-17T18:16:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153507",
    "user": "jdemeyer"
}
```

The full boost package is close to 50 MB in size.  So I can imagine some people being unhappy about this.



---

archive/issue_comments_153508.json:
```json
{
    "body": "Diff for the polybori spkg. For review only",
    "created_at": "2012-05-18T14:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153508",
    "user": "jdemeyer"
}
```

Diff for the polybori spkg. For review only



---

archive/issue_comments_153509.json:
```json
{
    "body": "Attachment",
    "created_at": "2012-05-18T14:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153509",
    "user": "jdemeyer"
}
```

Attachment



---

archive/issue_comments_153510.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-05-18T14:50:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153510",
    "user": "jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_153511.json:
```json
{
    "body": "The diff looks sane. If it installs and tests well, I'll give a positive review soon.\nNote that upcoming PolyBoRi 0.8.2 will only links the tests to boost_test. Since test executable  are not installed, the problem should not persist then.",
    "created_at": "2012-05-21T08:27:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153511",
    "user": "AlexanderDreyer"
}
```

The diff looks sane. If it installs and tests well, I'll give a positive review soon.
Note that upcoming PolyBoRi 0.8.2 will only links the tests to boost_test. Since test executable  are not installed, the problem should not persist then.



---

archive/issue_comments_153512.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-05-21T10:40:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153512",
    "user": "AlexanderDreyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_153513.json:
```json
{
    "body": "`make ptestlong` succeeded, so positive review.",
    "created_at": "2012-05-21T10:40:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153513",
    "user": "AlexanderDreyer"
}
```

`make ptestlong` succeeded, so positive review.



---

archive/issue_comments_153514.json:
```json
{
    "body": "My system boost library got upgraded (1.46 -> 1.48), and then polybori broke.\n\nIrrespective of however many times I recompiled polybori, ldd showed that libpolybori-0.8.1.so.0.0.0 was still linked agaist libboost_unit_test_framework-1_46*. Installing this spkg works, and now libpolybori-0.8.1.so.0.0.0 is linked against the new boost.",
    "created_at": "2012-05-25T17:28:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153514",
    "user": "ppurka"
}
```

My system boost library got upgraded (1.46 -> 1.48), and then polybori broke.

Irrespective of however many times I recompiled polybori, ldd showed that libpolybori-0.8.1.so.0.0.0 was still linked agaist libboost_unit_test_framework-1_46*. Installing this spkg works, and now libpolybori-0.8.1.so.0.0.0 is linked against the new boost.



---

archive/issue_comments_153515.json:
```json
{
    "body": "The new spkg here only changes things for binary versions of Sage (i.e. when `SAGE_FAT_BINARY=yes`).  If you're using Sage on your own computer, not intending to distribute it, I don't think it's a problem that the system Boost library gets linked.",
    "created_at": "2012-05-25T17:40:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153515",
    "user": "jdemeyer"
}
```

The new spkg here only changes things for binary versions of Sage (i.e. when `SAGE_FAT_BINARY=yes`).  If you're using Sage on your own computer, not intending to distribute it, I don't think it's a problem that the system Boost library gets linked.



---

archive/issue_comments_153516.json:
```json
{
    "body": "Replying to [comment:10 jdemeyer]:\n> The new spkg here only changes things for binary versions of Sage (i.e. when `SAGE_FAT_BINARY=yes`).  If you're using Sage on your own computer, not intending to distribute it, I don't think it's a problem that the system Boost library gets linked.\n\nWell, the point is that this spkg works while the one already present doesn't. I recompiled polybori several times, and I have no idea how it kept on relinking against boost-1.46 when it is not even present in my system. Using this spkg actually did the right thing and linked it against the installed boost-1.48.",
    "created_at": "2012-05-25T17:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153516",
    "user": "ppurka"
}
```

Replying to [comment:10 jdemeyer]:
> The new spkg here only changes things for binary versions of Sage (i.e. when `SAGE_FAT_BINARY=yes`).  If you're using Sage on your own computer, not intending to distribute it, I don't think it's a problem that the system Boost library gets linked.

Well, the point is that this spkg works while the one already present doesn't. I recompiled polybori several times, and I have no idea how it kept on relinking against boost-1.46 when it is not even present in my system. Using this spkg actually did the right thing and linked it against the installed boost-1.48.



---

archive/issue_comments_153517.json:
```json
{
    "body": "This SPKG gives weird linker errors (as in, `ld` quits with nonzero exit status) on my multiarch Debian system. Here's a diff of my build log for p1 and p3 (#13040): http://wstein.org/home/keshav/files/polybori-log.diff.xz",
    "created_at": "2012-05-28T03:52:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153517",
    "user": "kini"
}
```

This SPKG gives weird linker errors (as in, `ld` quits with nonzero exit status) on my multiarch Debian system. Here's a diff of my build log for p1 and p3 (#13040): http://wstein.org/home/keshav/files/polybori-log.diff.xz



---

archive/issue_comments_153518.json:
```json
{
    "body": "I'm not sure, but I would suspect, that the error were introduced by p3. Do the ld errors occur in with p2?",
    "created_at": "2012-05-28T20:34:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153518",
    "user": "AlexanderDreyer"
}
```

I'm not sure, but I would suspect, that the error were introduced by p3. Do the ld errors occur in with p2?



---

archive/issue_comments_153519.json:
```json
{
    "body": "Huh, you're right. Weird...\n\nDiff between output for p1 and p2: http://wstein.org/home/keshav/files/polybori-log.2.diff.xz",
    "created_at": "2012-05-28T21:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153519",
    "user": "kini"
}
```

Huh, you're right. Weird...

Diff between output for p1 and p2: http://wstein.org/home/keshav/files/polybori-log.2.diff.xz



---

archive/issue_comments_153520.json:
```json
{
    "body": "Replying to [comment:14 kini]:\n> Huh, you're right. Weird...\n> \n> Diff between output for p1 and p2: http://wstein.org/home/keshav/files/polybori-log.2.diff.xz\nLooking closer, the linker errors were intended, but they should be suppressed of course. Unfortunately, the patch from #13040 reverted this. I have suggested an alternative patch there.Looking closer, the linker errory were intended, but they should be suppressed of course. Unfortunately, the patch from #13040 reverted this. I have suggested an alternative patch there.",
    "created_at": "2012-05-28T21:10:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153520",
    "user": "AlexanderDreyer"
}
```

Replying to [comment:14 kini]:
> Huh, you're right. Weird...
> 
> Diff between output for p1 and p2: http://wstein.org/home/keshav/files/polybori-log.2.diff.xz
Looking closer, the linker errors were intended, but they should be suppressed of course. Unfortunately, the patch from #13040 reverted this. I have suggested an alternative patch there.Looking closer, the linker errory were intended, but they should be suppressed of course. Unfortunately, the patch from #13040 reverted this. I have suggested an alternative patch there.



---

archive/issue_comments_153521.json:
```json
{
    "body": "(Sorry for doublets.)",
    "created_at": "2012-05-28T21:10:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153521",
    "user": "AlexanderDreyer"
}
```

(Sorry for doublets.)



---

archive/issue_comments_153522.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-05-28T22:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/12791",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/12791#issuecomment-153522",
    "user": "jdemeyer"
}
```

Resolution: fixed
