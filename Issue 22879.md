# Issue 22879: Improved dot2tex installation instructions, replace have_dot2tex by Feature

archive/issues_022879.json:
```json
{
    "body": "CC:  @tscrim @dimpase @dcoudert @trevorkarn @seblabbe\n\n- ...\n- Replace the minimal dot2tex installation instructions in the lie tutorial by a link to the main place where this is explained.\n\n- the functions `have_dot2tex` and `assert_have_dot2tex` in  `sage.graphs.doc2tex_utils` should be replaced by `sage.features` \n\nIssue created by migration from https://trac.sagemath.org/ticket/23116\n\n",
    "created_at": "2017-05-31T14:32:19Z",
    "labels": [
        "component: graph theory",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Improved dot2tex installation instructions, replace have_dot2tex by Feature",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22879",
    "user": "https://github.com/nthiery"
}
```
CC:  @tscrim @dimpase @dcoudert @trevorkarn @seblabbe

- ...
- Replace the minimal dot2tex installation instructions in the lie tutorial by a link to the main place where this is explained.

- the functions `have_dot2tex` and `assert_have_dot2tex` in  `sage.graphs.doc2tex_utils` should be replaced by `sage.features` 

Issue created by migration from https://trac.sagemath.org/ticket/23116





---

archive/issue_comments_319698.json:
```json
{
    "body": "The instructions tell to use `sage -i dot2tex` to install dot2tex. This triggers some recompilation/update (presumably a `sage -b`) which can fail with certain Sage binary installation. I got hurt by that yesterday while helping someone. On the other hand `sage -pip install dot2tex` worked smoothly.\n\nSince `dot2tex` does not require anything to be recompiled/updated on the Sage side, I am considering changing the instructions to `sage -pip install dot2tex`.\n\nWhat do you think?",
    "created_at": "2017-05-31T14:36:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319698",
    "user": "https://github.com/nthiery"
}
```

The instructions tell to use `sage -i dot2tex` to install dot2tex. This triggers some recompilation/update (presumably a `sage -b`) which can fail with certain Sage binary installation. I got hurt by that yesterday while helping someone. On the other hand `sage -pip install dot2tex` worked smoothly.

Since `dot2tex` does not require anything to be recompiled/updated on the Sage side, I am considering changing the instructions to `sage -pip install dot2tex`.

What do you think?



---

archive/issue_comments_319699.json:
```json
{
    "body": "there is also a weird way implemented to test whether this package is installed, which does not use the \"normal\" Sage way to test whether a package is installed.\n\nThere is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).\nBasically, things go wrong on OSX binary installations of Sage.\n\n---\nNew commits:",
    "created_at": "2017-06-04T10:03:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319699",
    "user": "https://github.com/dimpase"
}
```

there is also a weird way implemented to test whether this package is installed, which does not use the "normal" Sage way to test whether a package is installed.

There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).
Basically, things go wrong on OSX binary installations of Sage.

---
New commits:



---

archive/issue_comments_319700.json:
```json
{
    "body": "Replying to [comment:1 nthiery]:\n> This triggers some recompilation/update\n\n\nIf so, I consider that a bug in the binary distribution. There is no fundamental reason why `sage -i dot2tex` couldn't \"just work\" on a binary distribution too (I guess it's pure Python, so nothing needs to be compiled). It seems that essentially no Sage developer really cares about usability of binary distributions, but maybe we should look into this at some point.",
    "created_at": "2017-06-04T10:13:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319700",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:1 nthiery]:
> This triggers some recompilation/update


If so, I consider that a bug in the binary distribution. There is no fundamental reason why `sage -i dot2tex` couldn't "just work" on a binary distribution too (I guess it's pure Python, so nothing needs to be compiled). It seems that essentially no Sage developer really cares about usability of binary distributions, but maybe we should look into this at some point.



---

archive/issue_comments_319701.json:
```json
{
    "body": "ODK ought to care about binary installations.",
    "created_at": "2017-06-04T10:14:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319701",
    "user": "https://github.com/dimpase"
}
```

ODK ought to care about binary installations.



---

archive/issue_comments_319702.json:
```json
{
    "body": "Replying to [comment:3 dimpase]:\n> there is also a weird way implemented to test whether this package is installed, which does not use the \"normal\" Sage way to test whether a package is installed.\n\n\nCould you elaborate on this? As far as I know, the test is to try\nwhether `import dot2tex` works. How is it weird? Indeed it's not using\n`is_package_installed`, but packagers would tell you it's actually a\ngood thing (see #20377). This, for example, enables installing\n`dot2tex` by pip which is totally fine. It could make sense to use the\n`Features` once it's finished (see #20382).\n\n> There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).\n> Basically, things go wrong on OSX binary installations of Sage.\n\n\nI read the whole thread, and it's hard to make a synthesis. At the\nend is this a general problem with Sage packages on binary\ndistributions, or a specific problem in Sage's `dot2tex` package or\nhow it's used? In the later case can you be specific about the\nproblem?\n\nDoes `sage -pip install dot2tex` work? Note: it worked smoothly for\nme last week on two macos machines with the binary distribution for\n8.0betasomething.",
    "created_at": "2017-06-04T12:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319702",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:3 dimpase]:
> there is also a weird way implemented to test whether this package is installed, which does not use the "normal" Sage way to test whether a package is installed.


Could you elaborate on this? As far as I know, the test is to try
whether `import dot2tex` works. How is it weird? Indeed it's not using
`is_package_installed`, but packagers would tell you it's actually a
good thing (see #20377). This, for example, enables installing
`dot2tex` by pip which is totally fine. It could make sense to use the
`Features` once it's finished (see #20382).

> There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).
> Basically, things go wrong on OSX binary installations of Sage.


I read the whole thread, and it's hard to make a synthesis. At the
end is this a general problem with Sage packages on binary
distributions, or a specific problem in Sage's `dot2tex` package or
how it's used? In the later case can you be specific about the
problem?

Does `sage -pip install dot2tex` work? Note: it worked smoothly for
me last week on two macos machines with the binary distribution for
8.0betasomething.



---

archive/issue_comments_319703.json:
```json
{
    "body": "Replying to [comment:4 jdemeyer]:\n> If so, I consider that a bug in the binary distribution. There is no fundamental reason why `sage -i dot2tex` couldn't \"just work\" on a binary distribution too (I guess it's pure Python, so nothing needs to be compiled).\n\n\nI agree.",
    "created_at": "2017-06-04T12:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319703",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:4 jdemeyer]:
> If so, I consider that a bug in the binary distribution. There is no fundamental reason why `sage -i dot2tex` couldn't "just work" on a binary distribution too (I guess it's pure Python, so nothing needs to be compiled).


I agree.



---

archive/issue_comments_319704.json:
```json
{
    "body": "Replying to [comment:4 jdemeyer]\n> It seems that essentially no Sage developer really cares about usability of binary distributions, but maybe we should look into this at some point. \n\n[comment:5 dimpase]:\n> ODK ought to care about binary installations.\n\n\nLet's not be judgemental: \u00abcaring about\u00bb != \u00abhaving the resources for\u00bb; there are soo many important things to care about.\n\nThat being said, yes, if someone in ODK has the resources to invest into it, that certainly fits within the scope if not inside the explicit deliverables.\n\nCheers,\n                           Nicolas",
    "created_at": "2017-06-04T12:35:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319704",
    "user": "https://github.com/nthiery"
}
```

Replying to [comment:4 jdemeyer]
> It seems that essentially no Sage developer really cares about usability of binary distributions, but maybe we should look into this at some point. 

[comment:5 dimpase]:
> ODK ought to care about binary installations.


Let's not be judgemental: «caring about» != «having the resources for»; there are soo many important things to care about.

That being said, yes, if someone in ODK has the resources to invest into it, that certainly fits within the scope if not inside the explicit deliverables.

Cheers,
                           Nicolas



---

archive/issue_comments_319705.json:
```json
{
    "body": "Replying to [comment:6 nthiery]:\n> Replying to [comment:3 dimpase]:\n> > there is also a weird way implemented to test whether this package is installed, which does not use the \"normal\" Sage way to test whether a package is installed.\n\n> \n> Could you elaborate on this? As far as I know, the test is to try\n> whether `import dot2tex` works. How is it weird? Indeed it's not using\n> `is_package_installed`, but packagers would tell you it's actually a\n> good thing (see #20377). This, for example, enables installing\n> `dot2tex` by pip which is totally fine. It could make sense to use the\n> `Features` once it's finished (see #20382).\n\n\nWell, yes, naturally, on sage-support I asked for the output of `is_package_installed`,\nwhich was (mis)reporting `True`.\nI would call this a bug in  `is_package_installed`.\nAs the functionality of `dot2tex` in Sage does not use the latter, it was impossible to understand what's going on.\nAt least if it was used then one would have seen an import error, but with `import dot2tex` in the try clause it was just totally hidden.\n\nI think it should do `is_package_installed` and return if it is not, else proceed to \nunconditionally `import dot2tex`. \n\n \n> \n> > There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).\n> > Basically, things go wrong on OSX binary installations of Sage.\n\n> \n> I read the whole thread, and it's hard to make a synthesis. At the\n> end is this a general problem with Sage packages on binary\n> distributions, or a specific problem in Sage's `dot2tex` package or\n> how it's used? In the later case can you be specific about the\n> problem?\n\nsee above (in the nutshell, `import` within `try` clause causes havoc in this case)\n\n> \n> Does `sage -pip install dot2tex` work? \n\nI've asked to try this, no reply as yet.",
    "created_at": "2017-06-04T14:02:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22879#issuecomment-319705",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:6 nthiery]:
> Replying to [comment:3 dimpase]:
> > there is also a weird way implemented to test whether this package is installed, which does not use the "normal" Sage way to test whether a package is installed.

> 
> Could you elaborate on this? As far as I know, the test is to try
> whether `import dot2tex` works. How is it weird? Indeed it's not using
> `is_package_installed`, but packagers would tell you it's actually a
> good thing (see #20377). This, for example, enables installing
> `dot2tex` by pip which is totally fine. It could make sense to use the
> `Features` once it's finished (see #20382).


Well, yes, naturally, on sage-support I asked for the output of `is_package_installed`,
which was (mis)reporting `True`.
I would call this a bug in  `is_package_installed`.
As the functionality of `dot2tex` in Sage does not use the latter, it was impossible to understand what's going on.
At least if it was used then one would have seen an import error, but with `import dot2tex` in the try clause it was just totally hidden.

I think it should do `is_package_installed` and return if it is not, else proceed to 
unconditionally `import dot2tex`. 

 
> 
> > There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).
> > Basically, things go wrong on OSX binary installations of Sage.

> 
> I read the whole thread, and it's hard to make a synthesis. At the
> end is this a general problem with Sage packages on binary
> distributions, or a specific problem in Sage's `dot2tex` package or
> how it's used? In the later case can you be specific about the
> problem?

see above (in the nutshell, `import` within `try` clause causes havoc in this case)

> 
> Does `sage -pip install dot2tex` work? 

I've asked to try this, no reply as yet.



---

archive/issue_events_059785.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-04-17T20:38:35Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59785"
}
```



---

archive/issue_events_059786.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59786"
}
```



---

archive/issue_events_059787.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-08-10T17:30:20Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59787"
}
```



---

archive/issue_events_059788.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.5",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59788"
}
```



---

archive/issue_events_059789.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-18T19:41:23Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59789"
}
```



---

archive/issue_events_059790.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59790"
}
```



---

archive/issue_events_059791.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-05-03T15:17:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59791"
}
```



---

archive/issue_events_059792.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59792"
}
```



---

archive/issue_events_059793.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-31T02:51:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/22879",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22879#event-59793"
}
```
