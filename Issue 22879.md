# Issue 22879: Improved dot2tex installation instructions

Issue created by migration from Trac.

Original creator: nthiery

Original creation time: 2017-05-31 14:32:19

CC:  tscrim dimpase dcoudert tkarn slabbe

- ...
- Replace the minimal dot2tex installation instructions in the lie tutorial by a link to the main place where this is explained.


---

Comment by nthiery created at 2017-05-31 14:36:53

The instructions tell to use `sage -i dot2tex` to install dot2tex. This triggers some recompilation/update (presumably a `sage -b`) which can fail with certain Sage binary installation. I got hurt by that yesterday while helping someone. On the other hand `sage -pip install dot2tex` worked smoothly.

Since `dot2tex` does not require anything to be recompiled/updated on the Sage side, I am considering changing the instructions to `sage -pip install dot2tex`.

What do you think?


---

Comment by dimpase created at 2017-06-04 10:03:02

there is also a weird way implemented to test whether this package is installed, which does not use the "normal" Sage way to test whether a package is installed.

There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).
Basically, things go wrong on OSX binary installations of Sage.

----
New commits:


---

Comment by jdemeyer created at 2017-06-04 10:13:20

Replying to [comment:1 nthiery]:
> This triggers some recompilation/update

If so, I consider that a bug in the binary distribution. There is no fundamental reason why `sage -i dot2tex` couldn't "just work" on a binary distribution too (I guess it's pure Python, so nothing needs to be compiled). It seems that essentially no Sage developer really cares about usability of binary distributions, but maybe we should look into this at some point.


---

Comment by dimpase created at 2017-06-04 10:14:33

ODK ought to care about binary installations.


---

Comment by nthiery created at 2017-06-04 12:28:55

Replying to [comment:3 dimpase]:
> there is also a weird way implemented to test whether this package is installed, which does not use the "normal" Sage way to test whether a package is installed.

Could you elaborate on this? As far as I know, the test is to try
whether `import dot2tex` works. How is it weird? Indeed it's not using
`is_package_installed`, but packagers would tell you it's actually a
good thing (see #20377). This, for example, enables installing
`dot2tex` by pip which is totally fine. It could make sense to use the
`Features` once it's finished (see #20382).

> There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).
> Basically, things go wrong on OSX binary installations of Sage.

I read the whole thread, and it's hard to make a synthesis. At the
end is this a general problem with Sage packages on binary
distributions, or a specific problem in Sage's `dot2tex` package or
how it's used? In the later case can you be specific about the
problem?

Does `sage -pip install dot2tex` work? Note: it worked smoothly for
me last week on two macos machines with the binary distribution for
8.0betasomething.


---

Comment by nthiery created at 2017-06-04 12:30:35

Replying to [comment:4 jdemeyer]:
> If so, I consider that a bug in the binary distribution. There is no fundamental reason why `sage -i dot2tex` couldn't "just work" on a binary distribution too (I guess it's pure Python, so nothing needs to be compiled).

I agree.


---

Comment by nthiery created at 2017-06-04 12:35:19

Replying to [comment:4 jdemeyer]
> It seems that essentially no Sage developer really cares about usability of binary distributions, but maybe we should look into this at some point. 
[comment:5 dimpase]:
> ODK ought to care about binary installations.

Let's not be judgemental: «caring about» != «having the resources for»; there are soo many important things to care about.

That being said, yes, if someone in ODK has the resources to invest into it, that certainly fits within the scope if not inside the explicit deliverables.

Cheers,
                           Nicolas


---

Comment by dimpase created at 2017-06-04 14:02:21

Replying to [comment:6 nthiery]:
> Replying to [comment:3 dimpase]:
> > there is also a weird way implemented to test whether this package is installed, which does not use the "normal" Sage way to test whether a package is installed.
> 
> Could you elaborate on this? As far as I know, the test is to try
> whether `import dot2tex` works. How is it weird? Indeed it's not using
> `is_package_installed`, but packagers would tell you it's actually a
> good thing (see #20377). This, for example, enables installing
> `dot2tex` by pip which is totally fine. It could make sense to use the
> `Features` once it's finished (see #20382).

Well, yes, naturally, on sage-support I asked for the output of `is_package_installed`,
which was (mis)reporting `True`.
I would call this a bug in  `is_package_installed`.
As the functionality of `dot2tex` in Sage does not use the latter, it was impossible to understand what's going on.
At least if it was used then one would have seen an import error, but with `import dot2tex` in the try clause it was just totally hidden.

I think it should do `is_package_installed` and return if it is not, else proceed to 
unconditionally `import dot2tex`. 

 
> 
> > There is a long discussion of these issues starting from [here](https://groups.google.com/d/msg/sage-support/BOlqVpkJzAQ/vQEgCbmwBwAJ).
> > Basically, things go wrong on OSX binary installations of Sage.
> 
> I read the whole thread, and it's hard to make a synthesis. At the
> end is this a general problem with Sage packages on binary
> distributions, or a specific problem in Sage's `dot2tex` package or
> how it's used? In the later case can you be specific about the
> problem?
see above (in the nutshell, `import` within `try` clause causes havoc in this case)

> 
> Does `sage -pip install dot2tex` work? 
I've asked to try this, no reply as yet.
