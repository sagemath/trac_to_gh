# Issue 15308: TypeError in matching_polynomial

Issue created by migration from https://trac.sagemath.org/ticket/15545

Original creator: rlm

Original creation time: 2013-12-19 05:09:56

CC:  ncohen


```python
sage: G = Graph(10); G
Graph on 10 vertices
sage: G.matching_polynomial()
x^10
sage: G.add_vertex((0,1))
sage: G.matching_polynomial()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-68-174221329fce> in <module>()
----> 1 G.matching_polynomial()

/Users/miller/sage-5.10/local/lib/python2.7/site-packages/sage/graphs/matchpoly.so in sage.graphs.matchpoly.matching_polynomial (sage/graphs/matchpoly.c:2681)()

TypeError: an integer is required
```


Another victim of arbitrary vertex labels...


---

Comment by rws created at 2014-05-23 15:57:25

If not a fix, I would expect "Maybe you should relabel the graph." from the function.


---

Comment by rws created at 2014-05-23 15:57:25

Changing priority from minor to major.


---

Comment by ncohen created at 2014-05-23 16:00:32

The fix is easy : check if the graph is labelled right, and if not call the function on a relabelled version.

Aaaaaaand I wonder what you think other Sage bugs are if you believe that this is a "major" problem `:-P`

Nathann


---

Comment by rws created at 2014-05-23 16:07:36

I don't think complexity is what is meant there. I mean any software requirement can lead to a complex change. Rather it's the perceived importance, and the bug reporter, esp. if new to sage, should be taken seriously. You want sage used by many people. So please be verbose with error messages too.


---

Comment by ncohen created at 2014-05-23 16:09:09

> I don't think complexity is what is meant there. I mean any software requirement can lead to a complex change. Rather it's the perceived importance, and the bug reporter, esp. if new to sage, should be taken seriously. You want sage used by many people. 

I don't mean that it shouldn't be fixed, of course. I am just saying that I can easily name a couple of things much more important to be fixed than this `:-P`

> So please be verbose with error messages too.

You know the bug and you know the fix, please don't make me fix it for you. I will be the reviewer, but you know how to write this.

Nathann


---

Comment by rws created at 2014-05-23 16:14:13

> > So please be verbose with error messages too.
> 
> You know the bug and you know the fix, please don't make me fix it for you. I will be the reviewer, but you know how to write this.

Of course but I didn't want to imply you should do the fix. I assumed you were the original author and wanted to make you do better next time.


---

Comment by rws created at 2014-05-25 07:58:57

Replying to [comment:4 ncohen]:
> The fix is easy : check if the graph is labelled right, and if not call the function on a relabelled version.
Bummer, that code works fine when run from the Sage command line:

```
    L = []
    for v, d in G.degree_iterator(labels=True):
        L.append((d, v))       <---------  error message
    L.sort()
    d = {}
    for i from 0 <= i < nverts:
        d[L[i][1]] = i
    G = G.relabel(d, inplace=False)
```

So, is this a Cython problem?


---

Comment by rws created at 2014-05-25 10:13:02

Changing status from new to needs_review.


---

Comment by rws created at 2014-05-25 10:13:02

Most minimal fix I did so far. Simply a bug in Cython usage. Please review.
----
New commits:


---

Comment by git created at 2014-05-25 12:52:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by ncohen created at 2014-05-25 15:44:56

That was all ? Cool ! `:-D`

I have got no working install of Sage right now but it should be reviewed tonight, or tomorrow morning.

Nathann


---

Comment by git created at 2014-05-26 06:16:29

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by rws created at 2014-05-26 06:18:01

Sadly, I had to change the 2-character into a 3-character fix because of style issues.


---

Comment by ncohen created at 2014-05-26 10:39:39

Changing status from needs_review to positive_review.


---

Comment by ncohen created at 2014-05-26 10:39:39

Okayyyyyyy good !

Nathann


---

Comment by vbraun created at 2014-05-29 11:07:36

Resolution: fixed
