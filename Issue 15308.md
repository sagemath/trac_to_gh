# Issue 15308: TypeError in matching_polynomial

archive/issues_015308.json:
```json
{
    "body": "CC:  ncohen\n\n\n```python\nsage: G = Graph(10); G\nGraph on 10 vertices\nsage: G.matching_polynomial()\nx^10\nsage: G.add_vertex((0,1))\nsage: G.matching_polynomial()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-68-174221329fce> in <module>()\n----> 1 G.matching_polynomial()\n\n/Users/miller/sage-5.10/local/lib/python2.7/site-packages/sage/graphs/matchpoly.so in sage.graphs.matchpoly.matching_polynomial (sage/graphs/matchpoly.c:2681)()\n\nTypeError: an integer is required\n```\n\n\nAnother victim of arbitrary vertex labels...\n\nIssue created by migration from https://trac.sagemath.org/ticket/15545\n\n",
    "created_at": "2013-12-19T05:09:56Z",
    "labels": [
        "graph theory",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.3",
    "title": "TypeError in matching_polynomial",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15308",
    "user": "rlm"
}
```
CC:  ncohen


```python
sage: G = Graph(10); G
Graph on 10 vertices
sage: G.matching_polynomial()
x^10
sage: G.add_vertex((0,1))
sage: G.matching_polynomial()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-68-174221329fce> in <module>()
----> 1 G.matching_polynomial()

/Users/miller/sage-5.10/local/lib/python2.7/site-packages/sage/graphs/matchpoly.so in sage.graphs.matchpoly.matching_polynomial (sage/graphs/matchpoly.c:2681)()

TypeError: an integer is required
```


Another victim of arbitrary vertex labels...

Issue created by migration from https://trac.sagemath.org/ticket/15545





---

archive/issue_comments_196960.json:
```json
{
    "body": "If not a fix, I would expect \"Maybe you should relabel the graph.\" from the function.",
    "created_at": "2014-05-23T15:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196960",
    "user": "rws"
}
```

If not a fix, I would expect "Maybe you should relabel the graph." from the function.



---

archive/issue_comments_196961.json:
```json
{
    "body": "Changing priority from minor to major.",
    "created_at": "2014-05-23T15:57:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196961",
    "user": "rws"
}
```

Changing priority from minor to major.



---

archive/issue_comments_196962.json:
```json
{
    "body": "The fix is easy : check if the graph is labelled right, and if not call the function on a relabelled version.\n\nAaaaaaand I wonder what you think other Sage bugs are if you believe that this is a \"major\" problem `:-P`\n\nNathann",
    "created_at": "2014-05-23T16:00:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196962",
    "user": "ncohen"
}
```

The fix is easy : check if the graph is labelled right, and if not call the function on a relabelled version.

Aaaaaaand I wonder what you think other Sage bugs are if you believe that this is a "major" problem `:-P`

Nathann



---

archive/issue_comments_196963.json:
```json
{
    "body": "I don't think complexity is what is meant there. I mean any software requirement can lead to a complex change. Rather it's the perceived importance, and the bug reporter, esp. if new to sage, should be taken seriously. You want sage used by many people. So please be verbose with error messages too.",
    "created_at": "2014-05-23T16:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196963",
    "user": "rws"
}
```

I don't think complexity is what is meant there. I mean any software requirement can lead to a complex change. Rather it's the perceived importance, and the bug reporter, esp. if new to sage, should be taken seriously. You want sage used by many people. So please be verbose with error messages too.



---

archive/issue_comments_196964.json:
```json
{
    "body": "> I don't think complexity is what is meant there. I mean any software requirement can lead to a complex change. Rather it's the perceived importance, and the bug reporter, esp. if new to sage, should be taken seriously. You want sage used by many people. \n\nI don't mean that it shouldn't be fixed, of course. I am just saying that I can easily name a couple of things much more important to be fixed than this `:-P`\n\n> So please be verbose with error messages too.\n\nYou know the bug and you know the fix, please don't make me fix it for you. I will be the reviewer, but you know how to write this.\n\nNathann",
    "created_at": "2014-05-23T16:09:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196964",
    "user": "ncohen"
}
```

> I don't think complexity is what is meant there. I mean any software requirement can lead to a complex change. Rather it's the perceived importance, and the bug reporter, esp. if new to sage, should be taken seriously. You want sage used by many people. 

I don't mean that it shouldn't be fixed, of course. I am just saying that I can easily name a couple of things much more important to be fixed than this `:-P`

> So please be verbose with error messages too.

You know the bug and you know the fix, please don't make me fix it for you. I will be the reviewer, but you know how to write this.

Nathann



---

archive/issue_comments_196965.json:
```json
{
    "body": "> > So please be verbose with error messages too.\n> \n> You know the bug and you know the fix, please don't make me fix it for you. I will be the reviewer, but you know how to write this.\n\nOf course but I didn't want to imply you should do the fix. I assumed you were the original author and wanted to make you do better next time.",
    "created_at": "2014-05-23T16:14:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196965",
    "user": "rws"
}
```

> > So please be verbose with error messages too.
> 
> You know the bug and you know the fix, please don't make me fix it for you. I will be the reviewer, but you know how to write this.

Of course but I didn't want to imply you should do the fix. I assumed you were the original author and wanted to make you do better next time.



---

archive/issue_comments_196966.json:
```json
{
    "body": "Replying to [comment:4 ncohen]:\n> The fix is easy : check if the graph is labelled right, and if not call the function on a relabelled version.\nBummer, that code works fine when run from the Sage command line:\n\n```\n    L = []\n    for v, d in G.degree_iterator(labels=True):\n        L.append((d, v))       <---------  error message\n    L.sort()\n    d = {}\n    for i from 0 <= i < nverts:\n        d[L[i][1]] = i\n    G = G.relabel(d, inplace=False)\n```\n\nSo, is this a Cython problem?",
    "created_at": "2014-05-25T07:58:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196966",
    "user": "rws"
}
```

Replying to [comment:4 ncohen]:
> The fix is easy : check if the graph is labelled right, and if not call the function on a relabelled version.
Bummer, that code works fine when run from the Sage command line:

```
    L = []
    for v, d in G.degree_iterator(labels=True):
        L.append((d, v))       <---------  error message
    L.sort()
    d = {}
    for i from 0 <= i < nverts:
        d[L[i][1]] = i
    G = G.relabel(d, inplace=False)
```

So, is this a Cython problem?



---

archive/issue_comments_196967.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-05-25T10:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196967",
    "user": "rws"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_196968.json:
```json
{
    "body": "Most minimal fix I did so far. Simply a bug in Cython usage. Please review.\n----\nNew commits:",
    "created_at": "2014-05-25T10:13:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196968",
    "user": "rws"
}
```

Most minimal fix I did so far. Simply a bug in Cython usage. Please review.
----
New commits:



---

archive/issue_comments_196969.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-25T12:52:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196969",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_196970.json:
```json
{
    "body": "That was all ? Cool ! `:-D`\n\nI have got no working install of Sage right now but it should be reviewed tonight, or tomorrow morning.\n\nNathann",
    "created_at": "2014-05-25T15:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196970",
    "user": "ncohen"
}
```

That was all ? Cool ! `:-D`

I have got no working install of Sage right now but it should be reviewed tonight, or tomorrow morning.

Nathann



---

archive/issue_comments_196971.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-05-26T06:16:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196971",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_196972.json:
```json
{
    "body": "Sadly, I had to change the 2-character into a 3-character fix because of style issues.",
    "created_at": "2014-05-26T06:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196972",
    "user": "rws"
}
```

Sadly, I had to change the 2-character into a 3-character fix because of style issues.



---

archive/issue_comments_196973.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-05-26T10:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196973",
    "user": "ncohen"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_196974.json:
```json
{
    "body": "Okayyyyyyy good !\n\nNathann",
    "created_at": "2014-05-26T10:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196974",
    "user": "ncohen"
}
```

Okayyyyyyy good !

Nathann



---

archive/issue_comments_196975.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-05-29T11:07:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15308",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15308#issuecomment-196975",
    "user": "vbraun"
}
```

Resolution: fixed
