# Issue 22985: Incorrect output from Vélu's formulas on j=0?

archive/issues_022985.json:
```json
{
    "body": "CC:  cremona\n\nKeywords: isogenies, supersingular\n\nI'm not sure about what's happening here. While playing around with supersingular curves:\n\n\n```\nsage: K = GF(47^2)\nsage: E = EllipticCurve([0,K.gen()])\nsage: E.trace_of_frobenius()\n-47\nsage: [E.isogeny(f).codomain().j_invariant() for f,_ in E.division_polynomial(7).factor()[3:]]\n[0, 24*z2 + 1, 24*z2 + 1, 24*z2 + 1, 36, 36, 36]\nsage: [E.isogeny(f).codomain().trace_of_frobenius() for f,_ in E.division_polynomial(7).factor()[3:]]\n[-47, -49, -49, -49, 94, 94, 94]\n```\n\n\nThe first curve is ok. The occurrences of trace 94 are weird, but j=0 and j=36 (1728) are 7-isogenous nevertheless. But trace -49?! That's not even supersingular!\n\nWhat's even more weird is that Magma gives the same results, so I'm starting to doubt of my own sanity.\n\nIssue created by migration from https://trac.sagemath.org/ticket/23222\n\n",
    "created_at": "2017-06-12T11:55:31Z",
    "labels": [
        "elliptic curves",
        "major",
        "bug"
    ],
    "title": "Incorrect output from V\u00e9lu's formulas on j=0?",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22985",
    "user": "defeo"
}
```
CC:  cremona

Keywords: isogenies, supersingular

I'm not sure about what's happening here. While playing around with supersingular curves:


```
sage: K = GF(47^2)
sage: E = EllipticCurve([0,K.gen()])
sage: E.trace_of_frobenius()
-47
sage: [E.isogeny(f).codomain().j_invariant() for f,_ in E.division_polynomial(7).factor()[3:]]
[0, 24*z2 + 1, 24*z2 + 1, 24*z2 + 1, 36, 36, 36]
sage: [E.isogeny(f).codomain().trace_of_frobenius() for f,_ in E.division_polynomial(7).factor()[3:]]
[-47, -49, -49, -49, 94, 94, 94]
```


The first curve is ok. The occurrences of trace 94 are weird, but j=0 and j=36 (1728) are 7-isogenous nevertheless. But trace -49?! That's not even supersingular!

What's even more weird is that Magma gives the same results, so I'm starting to doubt of my own sanity.

Issue created by migration from https://trac.sagemath.org/ticket/23222





---

archive/issue_comments_321655.json:
```json
{
    "body": "Remember that the Trace of Frobenius is an integer, not an element of the field, so seeing 94 which is 0 mod 47 is ok.\nSecondly, you have omitted the isogeny whose kernel is the product of the 3 linear factors of the 7-division polynomial.\nThirdly, if you want to see the 7-isogenous curves it is better to do\n\n```\nE.isogenies_prime_degree(7)\n```\n\nsince it is non-trivial to combine the factors of the division polynomial correctly.  In this case there are only two 7-isogenies.  Not that E.isogeny(f) does *not* actually check that f is a valid kernel polynomial even when check=True is give (the default).  It should!  When it was written we did not have code to do that but now we do.  It is slightly buried in the function isogenies_prime_degree_general().",
    "created_at": "2017-06-12T19:16:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321655",
    "user": "cremona"
}
```

Remember that the Trace of Frobenius is an integer, not an element of the field, so seeing 94 which is 0 mod 47 is ok.
Secondly, you have omitted the isogeny whose kernel is the product of the 3 linear factors of the 7-division polynomial.
Thirdly, if you want to see the 7-isogenous curves it is better to do

```
E.isogenies_prime_degree(7)
```

since it is non-trivial to combine the factors of the division polynomial correctly.  In this case there are only two 7-isogenies.  Not that E.isogeny(f) does *not* actually check that f is a valid kernel polynomial even when check=True is give (the default).  It should!  When it was written we did not have code to do that but now we do.  It is slightly buried in the function isogenies_prime_degree_general().



---

archive/issue_comments_321656.json:
```json
{
    "body": "Replying to [comment:1 cremona]:\n> Remember that the Trace of Frobenius is an integer, not an element of the field, so seeing 94 which is 0 mod 47 is ok.\n\nI agree with that, but doesn't Sato-Tate say that two curves are isogenous over a finite field iff they have the **same** trace? As I said, j=0 and j=36 are isogenous over GF(47<sup>2</sup>), but the exact curves in the example are not. And, indeed:\n\n\n```\nsage: phi = E.isogeny(E.division_polynomial(7).factor()[8][0])\nsage: phi(E.random_point())\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n...\nTypeError: Coordinates [16*z2 + 30, 3*z2 + 22, 1] do not define a point on Elliptic Curve defined by y^2 = x^3 + (3*z2+36)*x over Finite Field in z2 of size 47^2\n```\n\n\n> Secondly, you have omitted the isogeny whose kernel is the product of the 3 linear factors of the 7-division polynomial.\n\nYes. I just wanted to highlight the bug. One of the buggy factors would have been enough.\n\n> Thirdly, if you want to see the 7-isogenous curves it is better to do\n> {{{\n> E.isogenies_prime_degree(7)\n> }}}\n> since it is non-trivial to combine the factors of the division polynomial correctly.\n\nAbsolutely. However, I found the bug while doing a more general search.\n\n> Not that E.isogeny(f) does *not* actually check that f is a valid kernel polynomial even when check=True is give (the default).  It should!  When it was written we did not have code to do that but now we do.  It is slightly buried in the function isogenies_prime_degree_general().\n\nWell, that's not completely correct:\n\n\n```\nsage: E.isogeny(E.base_field().polynomial_ring().random_element(3))\n---------------------------------------------------------------------------\nValueError                                Traceback (most recent call last)\n...\nValueError: The polynomial does not define a finite subgroup of the elliptic curve.\n```\n\n\nSo there are some checks, but they are buggy, at least for j=0,1728, I suspect.\n\nI do not have time to dig this further right now. Hopefully in a couple of weeks I can come up with a fix.",
    "created_at": "2017-06-12T21:15:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321656",
    "user": "defeo"
}
```

Replying to [comment:1 cremona]:
> Remember that the Trace of Frobenius is an integer, not an element of the field, so seeing 94 which is 0 mod 47 is ok.

I agree with that, but doesn't Sato-Tate say that two curves are isogenous over a finite field iff they have the **same** trace? As I said, j=0 and j=36 are isogenous over GF(47<sup>2</sup>), but the exact curves in the example are not. And, indeed:


```
sage: phi = E.isogeny(E.division_polynomial(7).factor()[8][0])
sage: phi(E.random_point())
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
...
TypeError: Coordinates [16*z2 + 30, 3*z2 + 22, 1] do not define a point on Elliptic Curve defined by y^2 = x^3 + (3*z2+36)*x over Finite Field in z2 of size 47^2
```


> Secondly, you have omitted the isogeny whose kernel is the product of the 3 linear factors of the 7-division polynomial.

Yes. I just wanted to highlight the bug. One of the buggy factors would have been enough.

> Thirdly, if you want to see the 7-isogenous curves it is better to do
> {{{
> E.isogenies_prime_degree(7)
> }}}
> since it is non-trivial to combine the factors of the division polynomial correctly.

Absolutely. However, I found the bug while doing a more general search.

> Not that E.isogeny(f) does *not* actually check that f is a valid kernel polynomial even when check=True is give (the default).  It should!  When it was written we did not have code to do that but now we do.  It is slightly buried in the function isogenies_prime_degree_general().

Well, that's not completely correct:


```
sage: E.isogeny(E.base_field().polynomial_ring().random_element(3))
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
...
ValueError: The polynomial does not define a finite subgroup of the elliptic curve.
```


So there are some checks, but they are buggy, at least for j=0,1728, I suspect.

I do not have time to dig this further right now. Hopefully in a couple of weeks I can come up with a fix.



---

archive/issue_comments_321657.json:
```json
{
    "body": "The j-invariant does not determine the trace since it only determines the curve up to twist; in your case there are more than 2 twists as well.\n\nYes, some checking is done for validity of kernel polys, but that is misleading since bad input passes those tests as they are not complete.\n\nWe'll come back to that.",
    "created_at": "2017-06-13T07:30:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321657",
    "user": "cremona"
}
```

The j-invariant does not determine the trace since it only determines the curve up to twist; in your case there are more than 2 twists as well.

Yes, some checking is done for validity of kernel polys, but that is misleading since bad input passes those tests as they are not complete.

We'll come back to that.



---

archive/issue_comments_321658.json:
```json
{
    "body": "Can we close this as invalid / won't fix?  I just re-read the comments and think that I explained why none of the output which had been thought to be suspect was incorrect.",
    "created_at": "2018-04-13T08:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321658",
    "user": "cremona"
}
```

Can we close this as invalid / won't fix?  I just re-read the comments and think that I explained why none of the output which had been thought to be suspect was incorrect.



---

archive/issue_comments_321659.json:
```json
{
    "body": "I still don't get it. Admittedly, `E.isogeny(f)` does not test that `f` is a valid kernel polynomial. But, why is `f` not a valid kernel polynomial in this example:\n\n\n```\nsage: f = E.division_polynomial(7).factor()[4][0]\nsage: E.is_supersingular()\nTrue\nsage: E.isogeny(f).codomain().is_supersingular()\nFalse\n```\n\n\nAlso, the `TypeError` in [comment:2 comment 2] is not nice and would deserve fixing.",
    "created_at": "2018-04-13T13:12:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321659",
    "user": "defeo"
}
```

I still don't get it. Admittedly, `E.isogeny(f)` does not test that `f` is a valid kernel polynomial. But, why is `f` not a valid kernel polynomial in this example:


```
sage: f = E.division_polynomial(7).factor()[4][0]
sage: E.is_supersingular()
True
sage: E.isogeny(f).codomain().is_supersingular()
False
```


Also, the `TypeError` in [comment:2 comment 2] is not nice and would deserve fixing.



---

archive/issue_comments_321660.json:
```json
{
    "body": "The kernel poly of a 7-isogeny is a degree 3 factor of the 7-division poly but not every degree 3 factor is a kernel poly!  In this case the 3 roots of your degree 3 factor, which all lie in GF(47^6), are the x-coordinates of points in 3 different subgroups of order 7.\n\nIn the function isogenies_prime_degree_general() in sage.schemes.elliptic_curves.isogeny_small_degree, this is implemented properly: factor the l-division poly (here l is an odd prime); keep only factors of degree dividing (l-1)/2;  for each such factor work out whether or not it is an irreducible factor of a kernel poly.\n\nIt would be possible to extract from the code of that function a test for whether a polynomial of degree (l-1)/2 actually is a kernel poly.  Feel free to make a ticket for that!  The relevent theory is in Kimi Tsukazaki's thesis (cited in that file).",
    "created_at": "2018-04-13T13:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321660",
    "user": "cremona"
}
```

The kernel poly of a 7-isogeny is a degree 3 factor of the 7-division poly but not every degree 3 factor is a kernel poly!  In this case the 3 roots of your degree 3 factor, which all lie in GF(47^6), are the x-coordinates of points in 3 different subgroups of order 7.

In the function isogenies_prime_degree_general() in sage.schemes.elliptic_curves.isogeny_small_degree, this is implemented properly: factor the l-division poly (here l is an odd prime); keep only factors of degree dividing (l-1)/2;  for each such factor work out whether or not it is an irreducible factor of a kernel poly.

It would be possible to extract from the code of that function a test for whether a polynomial of degree (l-1)/2 actually is a kernel poly.  Feel free to make a ticket for that!  The relevent theory is in Kimi Tsukazaki's thesis (cited in that file).



---

archive/issue_comments_321661.json:
```json
{
    "body": "Oh, right!\n\nCan't we just edit this ticket so that it points to the problem, instead of closing it and opening a new one?",
    "created_at": "2018-04-13T14:16:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321661",
    "user": "defeo"
}
```

Oh, right!

Can't we just edit this ticket so that it points to the problem, instead of closing it and opening a new one?



---

archive/issue_comments_321662.json:
```json
{
    "body": "Sure, go ahead.  Once we have a stand-alone function test_kernel_poly(E,f,ell) it is clear where to put a call to it: in place of lines 2450-2454 where now it only tests if the polynomial divides the division poly.  I should have done this ages ago.",
    "created_at": "2018-04-13T14:26:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321662",
    "user": "cremona"
}
```

Sure, go ahead.  Once we have a stand-alone function test_kernel_poly(E,f,ell) it is clear where to put a call to it: in place of lines 2450-2454 where now it only tests if the polynomial divides the division poly.  I should have done this ages ago.



---

archive/issue_comments_321663.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2018-04-13T14:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321663",
    "user": "defeo"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_321664.json:
```json
{
    "body": "Changing keywords from \"isogenies, supersingular\" to \"isogenies, v\u00e9lu's formulas\".",
    "created_at": "2018-04-13T14:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321664",
    "user": "defeo"
}
```

Changing keywords from "isogenies, supersingular" to "isogenies, vélu's formulas".



---

archive/issue_comments_321665.json:
```json
{
    "body": "Changing type from enhancement to defect.",
    "created_at": "2018-04-16T11:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321665",
    "user": "cremona"
}
```

Changing type from enhancement to defect.



---

archive/issue_comments_321666.json:
```json
{
    "body": "Working on it...",
    "created_at": "2018-04-16T11:22:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321666",
    "user": "cremona"
}
```

Working on it...



---

archive/issue_comments_321667.json:
```json
{
    "body": "New commits:",
    "created_at": "2018-04-16T14:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321667",
    "user": "cremona"
}
```

New commits:



---

archive/issue_comments_321668.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-04-16T14:39:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321668",
    "user": "cremona"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_321669.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-04-16T15:28:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321669",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321670.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-01T13:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321670",
    "user": "chapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_321671.json:
```json
{
    "body": "red banch, needs rebasing",
    "created_at": "2018-12-01T13:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321671",
    "user": "chapoton"
}
```

red banch, needs rebasing



---

archive/issue_comments_321672.json:
```json
{
    "body": "Replying to [comment:13 chapoton]:\n> red branch, needs rebasing\nI will rebase it, but it would be good to have a commitment from someone to review it, since the actual work on this was done over 6 months ago.",
    "created_at": "2018-12-01T15:06:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321672",
    "user": "cremona"
}
```

Replying to [comment:13 chapoton]:
> red branch, needs rebasing
I will rebase it, but it would be good to have a commitment from someone to review it, since the actual work on this was done over 6 months ago.



---

archive/issue_comments_321673.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-01T20:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321673",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321674.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-01T20:28:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321674",
    "user": "cremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_321675.json:
```json
{
    "body": "It's been in my todo list for 6 months indeed. But I won't have time before Christmas.",
    "created_at": "2018-12-02T09:47:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321675",
    "user": "defeo"
}
```

It's been in my todo list for 6 months indeed. But I won't have time before Christmas.



---

archive/issue_comments_321676.json:
```json
{
    "body": "I have one doctest failure:\n\n\n```\nsage -t --long --warn-long 83.4 src/sage/schemes/elliptic_curves/ell_field.py                                                          \n**********************************************************************                                                                 \nFile \"src/sage/schemes/elliptic_curves/ell_field.py\", line 1023, in sage.schemes.elliptic_curves.ell_field.EllipticCurve_field.isogeni$\ns_prime_degree\nFailed example:\n    E.isogenies_prime_degree(5)\nException raised:\n    Traceback (most recent call last):\n      File \"/data/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 671, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/data/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 1086, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.schemes.elliptic_curves.ell_field.EllipticCurve_field.isogenies_prime_degree[28]>\", line 1, in <module>\n        E.isogenies_prime_degree(Integer(5))\n      File \"/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_field.py\", line 1091, in isogenies_prime$\ndegree\n        return sum([isogenies_prime_degree(self, d) for d in L], [])\n      File \"/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/isogeny_small_degree.py\", line 2328, in isog$\nnies_prime_degree\n        return isogenies_prime_degree_general(E,l, minimal_models=minimal_models)\n      File \"/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/isogeny_small_degree.py\", line 2197, in isog$\nnies_prime_degree_general\n        return [E.isogeny(k) for k in ker]\n      File \"/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_field.py\", line 880, in isogeny\n        raise RuntimeError(\"Unable to construct isogeny: %s\" % e)\n    RuntimeError: Unable to construct isogeny: 'sage.rings.fraction_field_FpT.FpTElement' object has no attribute 'divides'\n**********************************************************************\n```\n\n\n...investigating.",
    "created_at": "2019-01-15T10:26:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321676",
    "user": "defeo"
}
```

I have one doctest failure:


```
sage -t --long --warn-long 83.4 src/sage/schemes/elliptic_curves/ell_field.py                                                          
**********************************************************************                                                                 
File "src/sage/schemes/elliptic_curves/ell_field.py", line 1023, in sage.schemes.elliptic_curves.ell_field.EllipticCurve_field.isogeni$
s_prime_degree
Failed example:
    E.isogenies_prime_degree(5)
Exception raised:
    Traceback (most recent call last):
      File "/data/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 671, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/data/dfl/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 1086, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.schemes.elliptic_curves.ell_field.EllipticCurve_field.isogenies_prime_degree[28]>", line 1, in <module>
        E.isogenies_prime_degree(Integer(5))
      File "/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_field.py", line 1091, in isogenies_prime$
degree
        return sum([isogenies_prime_degree(self, d) for d in L], [])
      File "/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/isogeny_small_degree.py", line 2328, in isog$
nies_prime_degree
        return isogenies_prime_degree_general(E,l, minimal_models=minimal_models)
      File "/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/isogeny_small_degree.py", line 2197, in isog$
nies_prime_degree_general
        return [E.isogeny(k) for k in ker]
      File "/data/dfl/sage/local/lib/python2.7/site-packages/sage/schemes/elliptic_curves/ell_field.py", line 880, in isogeny
        raise RuntimeError("Unable to construct isogeny: %s" % e)
    RuntimeError: Unable to construct isogeny: 'sage.rings.fraction_field_FpT.FpTElement' object has no attribute 'divides'
**********************************************************************
```


...investigating.



---

archive/issue_comments_321677.json:
```json
{
    "body": "The doctest failure is due to #27064. No issue to be addressed here.",
    "created_at": "2019-01-15T17:30:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321677",
    "user": "defeo"
}
```

The doctest failure is due to #27064. No issue to be addressed here.



---

archive/issue_comments_321678.json:
```json
{
    "body": "In `is_kernel_polynomial`, there is this test:\n\n\n```\npsi_m = E.division_polynomial(m)\nif not f.divides(psi_m):\n    return False\n```\n\n\nisn't it (much) more efficient to do\n\n\n```\nif E.division_polynomial(m, x=f.parent().quo(f).gen()) != 0:\n    return False\n```\n",
    "created_at": "2019-01-15T18:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321678",
    "user": "defeo"
}
```

In `is_kernel_polynomial`, there is this test:


```
psi_m = E.division_polynomial(m)
if not f.divides(psi_m):
    return False
```


isn't it (much) more efficient to do


```
if E.division_polynomial(m, x=f.parent().quo(f).gen()) != 0:
    return False
```




---

archive/issue_comments_321679.json:
```json
{
    "body": "The doc still says\n\n\n```\n   * \"check\" (default: True) does some partial checks that the\n\n        input is valid (e.g., that the kernel polynomial provided is\n        valid); however, invalid input can in some cases still pass,\n        since that the points define a group is not checked.\n```\n\n\nwhat are the invalid inputs that still pass?",
    "created_at": "2019-01-15T18:34:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321679",
    "user": "defeo"
}
```

The doc still says


```
   * "check" (default: True) does some partial checks that the

        input is valid (e.g., that the kernel polynomial provided is
        valid); however, invalid input can in some cases still pass,
        since that the points define a group is not checked.
```


what are the invalid inputs that still pass?



---

archive/issue_comments_321680.json:
```json
{
    "body": "I will correct the docstring and also avoid using f.divides as suggested.",
    "created_at": "2019-01-17T12:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321680",
    "user": "cremona"
}
```

I will correct the docstring and also avoid using f.divides as suggested.



---

archive/issue_comments_321681.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-01-17T12:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321681",
    "user": "cremona"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_321682.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-17T13:03:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321682",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321683.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-01-17T13:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321683",
    "user": "cremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_321684.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-17T16:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321684",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321685.json:
```json
{
    "body": "Doctests pass. I just fixed a minor problem in the docstring (`r\"\"\"` instead of `\"\"\"`). Thanks, and sorry for the long time.",
    "created_at": "2019-01-17T16:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321685",
    "user": "defeo"
}
```

Doctests pass. I just fixed a minor problem in the docstring (`r"""` instead of `"""`). Thanks, and sorry for the long time.



---

archive/issue_comments_321686.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-01-17T16:24:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321686",
    "user": "defeo"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_321687.json:
```json
{
    "body": "Thanks!",
    "created_at": "2019-01-17T16:24:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321687",
    "user": "cremona"
}
```

Thanks!



---

archive/issue_comments_321688.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-01-22T12:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321688",
    "user": "vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_321689.json:
```json
{
    "body": "one py3-incompatible import was added here ; fix at #27107",
    "created_at": "2019-01-24T11:00:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22985",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22985#issuecomment-321689",
    "user": "chapoton"
}
```

one py3-incompatible import was added here ; fix at #27107
