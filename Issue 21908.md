# Issue 21908: LatticePoset: add is_stone

Issue created by migration from Trac.

Original creator: jmantysalo

Original creation time: 2017-01-07 07:59:26

CC:  tscrim

Add a function to check if a lattice is Stone lattice.

Done at https://sage.sis.uta.fi/home/pub/135/ (and hence de facto needs_review), waiting for 7.6beta to be added.


---

Comment by jmantysalo created at 2017-04-05 16:16:38

Changing status from new to needs_review.


---

Comment by jmantysalo created at 2017-04-05 16:16:38

New commits:


---

Comment by jmantysalo created at 2017-04-16 04:26:58

Travis? Quite trivial one, no complex algorithms.


---

Comment by tscrim created at 2017-04-16 04:44:42

There is a typo `Stone algebra` and it should be `a Stone lattice` (the name is being used as an adjective, which is okay, but it still needs an article; the other way would be `A lattice is *Stone* if ...`).


---

Comment by git created at 2017-04-16 04:50:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2017-04-16 04:52:04

Typo corrected and merged to newest beta.


---

Comment by tscrim created at 2017-04-16 05:03:01

You also need the article `a Stone lattice` in a few places in the `is_stone` method.


---

Comment by git created at 2017-04-16 05:05:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2017-04-16 05:06:03

Replying to [comment:7 tscrim]:
> You also need the article `a Stone lattice` in a few places in the `is_stone` method.

Done.


---

Comment by tscrim created at 2017-04-16 05:10:15

Last two nitpicks.


```diff
-            if (sum([x[1] for x in factor(self.cardinality())]) <
-                atoms_n):
+            if sum([x[1] for x in factor(self.cardinality())]) < atoms_n:
```

and similar. Here it is worthwhile to break the 80 char limit for readability.

Move `from sage.arith.misc import factor` below the `self.is_distributive()` check. Actually, I would argue that it should not raise a `ValueError` in this case, but instead simply return `False`. However, I've lost similar arguments before (the `is_similar` of matrices).


---

Comment by git created at 2017-04-16 05:22:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jmantysalo created at 2017-04-16 05:28:50

Replying to [comment:10 tscrim]:
> Here it is worthwhile to break the 80 char limit for readability.

True, done that.

> Move `from sage.arith.misc import factor` below the `self.is_distributive()` check.

Well... Done that too. It is of course faster to `import` only when needed, but it should be a special case if the user tries to see if a non-distributive lattice is a Stone lattice. There are also functions having something like


```
import somefunction ...
if self.cardinality() < 5: return True
if somefunction(self.bottom()) ...
```


and I think having `import`s at a start is more readable.

> Actually, I would argue that it should not raise a `ValueError` in this case, but instead simply return `False`. However, I've lost similar arguments before (the `is_similar` of matrices).

Two-sided question. But then at least `skeleton()` should be changed too.


---

Comment by tscrim created at 2017-04-16 05:39:36

Replying to [comment:12 jmantysalo]:
> Replying to [comment:10 tscrim]:
> > Actually, I would argue that it should not raise a `ValueError` in this case, but instead simply return `False`. However, I've lost similar arguments before (the `is_similar` of matrices).
> 
> Two-sided question. But then at least `skeleton()` should be changed too.

`skeleton()` is a different issue because it is not asking a boolean question, but instead constructing a new object. In that case, the correct thing to do (IMO) is raise a `ValueError`. While I have a strong opinion on this matter, I don't care enough to refight this battle. So if you prefer this method, then I will set it to a positive review.


---

Comment by jmantysalo created at 2017-04-16 05:47:50

Replying to [comment:13 tscrim]:
> Replying to [comment:12 jmantysalo]:
> > Replying to [comment:10 tscrim]:
> > > Actually, I would argue that it should not raise a `ValueError` in this case, but instead simply return `False`. However, I've lost similar arguments before (the `is_similar` of matrices).
> > 
> > Two-sided question. But then at least `skeleton()` should be changed too.
> 
> `skeleton()` is a different issue because it is not asking a boolean question, but instead constructing a new object. In that case, the correct thing to do (IMO) is raise a `ValueError`. While I have a strong opinion on this matter, I don't care enough to refight this battle. So if you prefer this method, then I will set it to a positive review.

I think there is also some other boolean-valued functions with similar behaviour, so please just set to a positive review.


---

Comment by tscrim created at 2017-04-16 05:49:44

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2017-04-16 05:49:44

IMO, that is not a good reason to keep a bad precedent. However, let it be so.


---

Comment by vbraun created at 2017-04-18 22:36:45

Resolution: fixed
