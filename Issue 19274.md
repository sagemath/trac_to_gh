# Issue 19274: q-ary symmetric channel class for coding theory

archive/issues_019274.json:
```json
{
    "body": "This ticket proposes an implementation of q-ary symmetric channels using the structure described in #18269.\n\nIssue created by migration from https://trac.sagemath.org/ticket/19511\n\n",
    "created_at": "2015-11-02T12:38:41Z",
    "labels": [
        "component: coding theory"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.10",
    "title": "q-ary symmetric channel class for coding theory",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19274",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```
This ticket proposes an implementation of q-ary symmetric channels using the structure described in #18269.

Issue created by migration from https://trac.sagemath.org/ticket/19511





---

archive/issue_comments_264235.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-11-02T12:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264235",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_264236.json:
```json
{
    "body": "I pushed the branch, this is now ready for review.\n\n---\nNew commits:",
    "created_at": "2015-11-02T12:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264236",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

I pushed the branch, this is now ready for review.

---
New commits:



---

archive/issue_comments_264237.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-11-03T09:42:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264237",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264238.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-13T10:15:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264238",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264239.json:
```json
{
    "body": "I updated this ticket to latest beta, it is still open for review.\n\n---\nNew commits:",
    "created_at": "2016-01-13T10:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264239",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

I updated this ticket to latest beta, it is still open for review.

---
New commits:



---

archive/issue_comments_264240.json:
```json
{
    "body": "Hi,\nI had a look at the code. It looks fine :-) I clarified some documentation wrt. alphabets and spaces, please look at that. I also fixed a bug in the while-loop for adding errors.\n\nApart from that I have a few questions/requests:\n- Should this channel-intro text really be in the q-ary symmetric channels doc?\n- Can you please make a test that input space is of the form Sigma^n, and that Sigma has random_element\n- It would be nice with a \"probability_of_exactly_t_errors\" and a \"probability_of_at_most_t_errors\" method :-) But I don't insist for now, the channel is functioning as it is.\n\nBest,\nJohan\n\n---\nNew commits:",
    "created_at": "2016-01-19T21:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264240",
    "user": "https://github.com/johanrosenkilde"
}
```

Hi,
I had a look at the code. It looks fine :-) I clarified some documentation wrt. alphabets and spaces, please look at that. I also fixed a bug in the while-loop for adding errors.

Apart from that I have a few questions/requests:
- Should this channel-intro text really be in the q-ary symmetric channels doc?
- Can you please make a test that input space is of the form Sigma^n, and that Sigma has random_element
- It would be nice with a "probability_of_exactly_t_errors" and a "probability_of_at_most_t_errors" method :-) But I don't insist for now, the channel is functioning as it is.

Best,
Johan

---
New commits:



---

archive/issue_comments_264241.json:
```json
{
    "body": "Hello,\n\nThanks for your remarks!\n\nI agree with your clarifications, and of course with your fix.\n\n> Should this channel-intro text really be in the q-ary symmetric channels doc? \n\n\nWell, I did that in the case one reads only the documentation for a channel class, and not the abstract class one. If you think it's useless, I'm ok to remove it.\n\n> Can you please make a test that input space is of the form Sigma^n, and that Sigma has random_element \n\n\nDone. Note that I wasn't able to find an example of a Sigma which can be of the form Sigma^n\nbut can not have a `random_element` method... \n\n>It would be nice with a \"probability_of_exactly_t_errors\" and a \"probability_of_at_most_t_errors\" method :-) But I don't insist for now, the channel is functioning as it is. \n\n\nNo need to insist, it's done ;) These two methods can be called on any instance of the class, with `t` as parameter. Maybe it can be better to propose generic methods, which take `epsilon`, `t` and `input_space.dimension()` as parameters, so the user can actually look for the best epsilon without having to construct the channel... As you prefer.\n\nBest,\n\nDavid\n\n---\nNew commits:",
    "created_at": "2016-01-20T13:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264241",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Hello,

Thanks for your remarks!

I agree with your clarifications, and of course with your fix.

> Should this channel-intro text really be in the q-ary symmetric channels doc? 


Well, I did that in the case one reads only the documentation for a channel class, and not the abstract class one. If you think it's useless, I'm ok to remove it.

> Can you please make a test that input space is of the form Sigma^n, and that Sigma has random_element 


Done. Note that I wasn't able to find an example of a Sigma which can be of the form Sigma^n
but can not have a `random_element` method... 

>It would be nice with a "probability_of_exactly_t_errors" and a "probability_of_at_most_t_errors" method :-) But I don't insist for now, the channel is functioning as it is. 


No need to insist, it's done ;) These two methods can be called on any instance of the class, with `t` as parameter. Maybe it can be better to propose generic methods, which take `epsilon`, `t` and `input_space.dimension()` as parameters, so the user can actually look for the best epsilon without having to construct the channel... As you prefer.

Best,

David

---
New commits:



---

archive/issue_comments_264242.json:
```json
{
    "body": "The following doesn't work\n\n```\nsage: V = (ZZ.quo(12))^5\nsage: Chan = channels.QarySymmetricChannel(V, .2)\n```",
    "created_at": "2016-01-21T11:18:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264242",
    "user": "https://github.com/johanrosenkilde"
}
```

The following doesn't work

```
sage: V = (ZZ.quo(12))^5
sage: Chan = channels.QarySymmetricChannel(V, .2)
```



---

archive/issue_comments_264243.json:
```json
{
    "body": "Hi,\n\n> Well, I did that in the case one reads only the documentation for a channel class, and not the abstract class one. If you think it's useless, I'm ok to remove it.\n\n\nI don't think it belongs there. But the text is nice, so perhaps it can be moved/merged somewhere else?\n\n> Done. Note that I wasn't able to find an example of a Sigma which can be of the form Sigma^n\n> but can not have a `random_element` method... \n\n\nHmm, I'm worried that the check for the \"dimension\" method is not the right thing to do. For instance, the following structure has a \"dimension\":\n\n```\n   X = CombinatorialFreeModule(QQ, [1,2])\n```\n\nBut I think that the last line of your `transmit_unsafe` is going to blow up on this structure. I don't think there is a bullet-proof-while-flexible way of checking for what we want. So perhaps your check at construction time could be a dummy `transmit_unsafe` call, and if that throws an exception, catch it and throw another exception telling the user that apparently his input space is not satisfactory.\n\nAnother thing: you added some text saying \"the input space has to be a vector space\", but if `\\Sigma` is not a field, then `\\Sigma^3` is not a vector space: it is a free module with a basis. Just write something like I did in the docstring that we check input space has the form `\\Sigma^n`.\n\n> No need to insist, it's done ;) These two methods can be called on any instance of the class, with `t` as parameter. Maybe it can be better to propose generic methods, which take `epsilon`, `t` and `input_space.dimension()` as parameters, so the user can actually look for the best epsilon without having to construct the channel... As you prefer.\n\n\nCool! I think having them available only non-static, after construction is\ncompletely fine. Your implementation of `at_most_t_errors` should sum over `exactly_t_errors` to avoid code-replication. I'm pretty sure you have an off-by-one error in the `exactly_t_errors` as well, since you're not summing the `t`'th error.\n\nBest,\nJohan",
    "created_at": "2016-01-21T11:28:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264243",
    "user": "https://github.com/johanrosenkilde"
}
```

Hi,

> Well, I did that in the case one reads only the documentation for a channel class, and not the abstract class one. If you think it's useless, I'm ok to remove it.


I don't think it belongs there. But the text is nice, so perhaps it can be moved/merged somewhere else?

> Done. Note that I wasn't able to find an example of a Sigma which can be of the form Sigma^n
> but can not have a `random_element` method... 


Hmm, I'm worried that the check for the "dimension" method is not the right thing to do. For instance, the following structure has a "dimension":

```
   X = CombinatorialFreeModule(QQ, [1,2])
```

But I think that the last line of your `transmit_unsafe` is going to blow up on this structure. I don't think there is a bullet-proof-while-flexible way of checking for what we want. So perhaps your check at construction time could be a dummy `transmit_unsafe` call, and if that throws an exception, catch it and throw another exception telling the user that apparently his input space is not satisfactory.

Another thing: you added some text saying "the input space has to be a vector space", but if `\Sigma` is not a field, then `\Sigma^3` is not a vector space: it is a free module with a basis. Just write something like I did in the docstring that we check input space has the form `\Sigma^n`.

> No need to insist, it's done ;) These two methods can be called on any instance of the class, with `t` as parameter. Maybe it can be better to propose generic methods, which take `epsilon`, `t` and `input_space.dimension()` as parameters, so the user can actually look for the best epsilon without having to construct the channel... As you prefer.


Cool! I think having them available only non-static, after construction is
completely fine. Your implementation of `at_most_t_errors` should sum over `exactly_t_errors` to avoid code-replication. I'm pretty sure you have an off-by-one error in the `exactly_t_errors` as well, since you're not summing the `t`'th error.

Best,
Johan



---

archive/issue_comments_264244.json:
```json
{
    "body": "Just a simple question before working on this again:\n\n> Your implementation of at_most_t_errors should sum over exactly_t_errors to avoid code-replication. \n\n\nThat was actually my first idea , but then I thought it's basically calling a method inside a loop. \nWell, I know it's not much of an optimization, but calling a method is slower than evaluating of an expression, isn't it?",
    "created_at": "2016-01-21T11:34:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264244",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

Just a simple question before working on this again:

> Your implementation of at_most_t_errors should sum over exactly_t_errors to avoid code-replication. 


That was actually my first idea , but then I thought it's basically calling a method inside a loop. 
Well, I know it's not much of an optimization, but calling a method is slower than evaluating of an expression, isn't it?



---

archive/issue_comments_264245.json:
```json
{
    "body": "True, but the loop is run `t < n` times, so it's not too bad. Better than code replication, I would say. Try to time it if you're worried.",
    "created_at": "2016-01-21T12:30:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264245",
    "user": "https://github.com/johanrosenkilde"
}
```

True, but the loop is run `t < n` times, so it's not too bad. Better than code replication, I would say. Try to time it if you're worried.



---

archive/issue_comments_264246.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-21T12:58:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264246",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_264247.json:
```json
{
    "body": "I made the changes, it should be better now.",
    "created_at": "2016-01-21T13:00:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264247",
    "user": "https://trac.sagemath.org/admin/accounts/users/dlucas"
}
```

I made the changes, it should be better now.



---

archive/issue_comments_264248.json:
```json
{
    "body": "OK. I'm giving this the green light. I'm pretty psyked about the following \"just working\":\n\n```\n   sage: MS = MatrixSpace(GF(3), 4, 4)\n   sage: Ch = channels.QarySymmetricChannel(MS, .3)\n   sage: Ch(MS.zero())\n   [0 0 0 1]\n   [1 0 0 0]\n   [0 2 1 2]\n   [0 0 0 0]\n```",
    "created_at": "2016-01-27T16:45:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264248",
    "user": "https://github.com/johanrosenkilde"
}
```

OK. I'm giving this the green light. I'm pretty psyked about the following "just working":

```
   sage: MS = MatrixSpace(GF(3), 4, 4)
   sage: Ch = channels.QarySymmetricChannel(MS, .3)
   sage: Ch(MS.zero())
   [0 0 0 1]
   [1 0 0 0]
   [0 2 1 2]
   [0 0 0 0]
```



---

archive/issue_comments_264249.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-01-27T16:45:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264249",
    "user": "https://github.com/johanrosenkilde"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_053782.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-01-28T17:14:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19274#event-53782"
}
```



---

archive/issue_comments_264250.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-01-28T17:14:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19274",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19274#issuecomment-264250",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
