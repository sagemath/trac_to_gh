# Issue 19765: stand-alone interrupt.pyx

archive/issues_019765.json:
```json
{
    "body": "CC:  @jdemeyer @videlec @kiwifb @vbraun\n\nThis ticket is about turning Sage\u2019s interrupt  handling into something that can be easily installed from PyPI.\n\nSee also https://groups.google.com/d/topic/sage-devel/oA9NsF26eOA/discussion\n\nIssue created by migration from https://trac.sagemath.org/ticket/20002\n\n",
    "created_at": "2016-02-02T09:14:45Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.1",
    "title": "stand-alone interrupt.pyx",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19765",
    "user": "https://github.com/malb"
}
```
CC:  @jdemeyer @videlec @kiwifb @vbraun

This ticket is about turning Sageâ€™s interrupt  handling into something that can be easily installed from PyPI.

See also https://groups.google.com/d/topic/sage-devel/oA9NsF26eOA/discussion

Issue created by migration from https://trac.sagemath.org/ticket/20002





---

archive/issue_comments_271331.json:
```json
{
    "body": "I am interested, partly because of [pplpy](https://pypi.python.org/pypi/pplpy).",
    "created_at": "2016-02-02T18:41:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271331",
    "user": "https://github.com/videlec"
}
```

I am interested, partly because of [pplpy](https://pypi.python.org/pypi/pplpy).



---

archive/issue_comments_271332.json:
```json
{
    "body": "This is certainly something that I would like to work on, I think it fits very well with [https://github.com/OpenDreamKit/OpenDreamKit/issues/52](https://github.com/OpenDreamKit/OpenDreamKit/issues/52).",
    "created_at": "2016-02-04T11:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271332",
    "user": "https://github.com/jdemeyer"
}
```

This is certainly something that I would like to work on, I think it fits very well with [https://github.com/OpenDreamKit/OpenDreamKit/issues/52](https://github.com/OpenDreamKit/OpenDreamKit/issues/52).



---

archive/issue_comments_271333.json:
```json
{
    "body": "Cool! I guess the next step is to figure out how to actually make this `signals.pyx` available to external packages (you need to install the `.pxd`, `.pxi` and `.h` files).\n\nI think it would be very useful to have an example package using `signals.pyx`. Both as documentation, but also as an additional test.",
    "created_at": "2016-02-06T20:23:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271333",
    "user": "https://github.com/jdemeyer"
}
```

Cool! I guess the next step is to figure out how to actually make this `signals.pyx` available to external packages (you need to install the `.pxd`, `.pxi` and `.h` files).

I think it would be very useful to have an example package using `signals.pyx`. Both as documentation, but also as an additional test.



---

archive/issue_comments_271334.json:
```json
{
    "body": "I created a [cysignals](https://github.com/malb/fpylll/commits/cysignals) branch for fpylll which uses the new cysignals.",
    "created_at": "2016-02-07T15:52:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271334",
    "user": "https://github.com/malb"
}
```

I created a [cysignals](https://github.com/malb/fpylll/commits/cysignals) branch for fpylll which uses the new cysignals.



---

archive/issue_comments_271335.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-11T12:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271335",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_271336.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-11T13:00:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271336",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_271337.json:
```json
{
    "body": "`@`vbraun: please test on buildbots.",
    "created_at": "2016-02-11T13:00:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271337",
    "user": "https://github.com/jdemeyer"
}
```

`@`vbraun: please test on buildbots.



---

archive/issue_comments_271338.json:
```json
{
    "body": "Couldn't we use the `include_path=sys.path` trick to avoid patching Cython, just in case they don't accept the pull request?",
    "created_at": "2016-02-11T14:07:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271338",
    "user": "https://github.com/malb"
}
```

Couldn't we use the `include_path=sys.path` trick to avoid patching Cython, just in case they don't accept the pull request?



---

archive/issue_comments_271339.json:
```json
{
    "body": "Replying to [comment:16 malb]:\n> Couldn't we use the `include_path=sys.path` trick to avoid patching Cython, just in case they don't accept the pull request?\n\n\nThe problem is that we have to support:\n1. the Sage library\n2. the `cython(...)` command\n3. the `%cython` notebook magic\n4. `./sage somefile.spyx`\n5. external spkgs using `cysignals`\n\nInstead of patching all these, I think it is much cleaner to apply just the Cython patch.",
    "created_at": "2016-02-11T15:39:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271339",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:16 malb]:
> Couldn't we use the `include_path=sys.path` trick to avoid patching Cython, just in case they don't accept the pull request?


The problem is that we have to support:
1. the Sage library
2. the `cython(...)` command
3. the `%cython` notebook magic
4. `./sage somefile.spyx`
5. external spkgs using `cysignals`

Instead of patching all these, I think it is much cleaner to apply just the Cython patch.



---

archive/issue_comments_271340.json:
```json
{
    "body": "Makes sense to me.",
    "created_at": "2016-02-11T16:46:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271340",
    "user": "https://github.com/malb"
}
```

Makes sense to me.



---

archive/issue_comments_271341.json:
```json
{
    "body": "Building a fresh Sage installation and running `make ptestlong` works on 64-bit Debian/GNU Linux.",
    "created_at": "2016-02-15T13:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271341",
    "user": "https://github.com/malb"
}
```

Building a fresh Sage installation and running `make ptestlong` works on 64-bit Debian/GNU Linux.



---

archive/issue_comments_271342.json:
```json
{
    "body": "- What is our convention for dependencies in SPKG.txt, shall we mention Pari?\n- I'm no fan of \"init_interrupts -> init_cysignals\". Why not fix up cysignals if that's needed?",
    "created_at": "2016-02-15T13:47:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271342",
    "user": "https://github.com/malb"
}
```

- What is our convention for dependencies in SPKG.txt, shall we mention Pari?
- I'm no fan of "init_interrupts -> init_cysignals". Why not fix up cysignals if that's needed?



---

archive/issue_comments_271343.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-02-15T13:48:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271343",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_271344.json:
```json
{
    "body": "Replying to [comment:21 malb]:\n> - What is our convention for dependencies in SPKG.txt, shall we mention Pari?\n\n\nIt is redundant with another file but since both `python` and `cython` are there, I guess it should be added.\n\n> - I'm no fan of \"init_interrupts -> init_cysignals\". Why not fix up cysignals if that's needed?\n\n\nIt is fixed on master but not in 0.9. Got bitten by that when I tried to build the thing with sage-on-gentoo (does build now against `cysignals` master instead of patching 0.9. )",
    "created_at": "2016-02-15T23:30:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271344",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:21 malb]:
> - What is our convention for dependencies in SPKG.txt, shall we mention Pari?


It is redundant with another file but since both `python` and `cython` are there, I guess it should be added.

> - I'm no fan of "init_interrupts -> init_cysignals". Why not fix up cysignals if that's needed?


It is fixed on master but not in 0.9. Got bitten by that when I tried to build the thing with sage-on-gentoo (does build now against `cysignals` master instead of patching 0.9. )



---

archive/issue_comments_271345.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2016-02-16T08:13:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271345",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_271346.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-16T15:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271346",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_271347.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-02-16T15:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271347",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_271348.json:
```json
{
    "body": "This resolves all issues I had, so positive review from me.",
    "created_at": "2016-02-16T16:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271348",
    "user": "https://github.com/malb"
}
```

This resolves all issues I had, so positive review from me.



---

archive/issue_comments_271349.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-16T16:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271349",
    "user": "https://github.com/malb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_271350.json:
```json
{
    "body": "```\nRunning the test suite for cysignals-1.0rc0...\npython setup.py build\nrunning build\nrunning build_py\nrunning build_ext\nrunning build_scripts\npython setup.py install\nrunning install\nrunning build\nrunning build_py\nrunning build_ext\nrunning build_scripts\nrunning install_lib\nrunning install_scripts\nchanging mode of /Users/buildslave-sage/slave/sage_git/build/local/bin/cysignals-CSI to 755\nchanging mode of /Users/buildslave-sage/slave/sage_git/build/local/bin/cysignals-CSI-helper.py to 755\nrunning install_egg_info\nRemoving /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals-1.0rc0-py2.7.egg-info\nWriting /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals-1.0rc0-py2.7.egg-info\npython -m doctest src/cysignals/*.pyx\ncd example && python setup.py build\nCompiling cysignals_example.pyx because it changed.\n[1/1] Cythonizing cysignals_example.pyx\nrunning build\nrunning build_ext\nbuilding 'cysignals_example' extension\ncreating build\ncreating build/temp.macosx-10.9-x86_64-2.7\ngcc -fno-strict-aliasing -I/Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/python2-2.7.10.p0/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.c -o build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o\ncreating build/lib.macosx-10.9-x86_64-2.7\ngcc -bundle -undefined dynamic_lookup -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o -L/Users/buildslave-sage/slave/sage_git/build/local/lib -o build/lib.macosx-10.9-x86_64-2.7/cysignals_example.so -lpari -Ddummy\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 491, in tests.pyx\nFailed example:\n    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS\nExpected:\n    ------------------------------------------------------------------------\n    ...\n    ------------------------------------------------------------------------\n    ------------------------------------------------------------------------\n    <BLANKLINE>\nGot:\n    ------------------------------------------------------------------------\n    0   signals.so                          0x000000010d478885 print_backtrace + 37\n    ------------------------------------------------------------------------\n    <BLANKLINE>\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 536, in tests.pyx\nFailed example:\n    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS\nExpected:\n    ------------------------------------------------------------------------\n    ...\n    ------------------------------------------------------------------------\n    ------------------------------------------------------------------------\n    Unhandled SIG...\n    This probably occurred because a *compiled* module has a bug\n    in it and is not properly wrapped with sig_on(), sig_off().\n    Python will now terminate.\n    ------------------------------------------------------------------------\n    <BLANKLINE>\nGot:\n    ------------------------------------------------------------------------\n    0   signals.so                          0x000000010e85f885 print_backtrace + 37\n    ------------------------------------------------------------------------\n    Unhandled SIGSEGV: A segmentation fault occurred.\n    This probably occurred because a *compiled* module has a bug\n    in it and is not properly wrapped with sig_on(), sig_off().\n    Python will now terminate.\n    ------------------------------------------------------------------------\n    <BLANKLINE>\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 575, in tests.pyx\nFailed example:\n    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS\nExpected:\n    ------------------------------------------------------------------------\n    ...\n    ------------------------------------------------------------------------\n    ------------------------------------------------------------------------\n    Unhandled SIGABRT: An abort() occurred.\n    This probably occurred because a *compiled* module has a bug\n    in it and is not properly wrapped with sig_on(), sig_off().\n    Python will now terminate.\n    ------------------------------------------------------------------------\n    <BLANKLINE>\nGot:\n    ------------------------------------------------------------------------\n    0   signals.so                          0x00000001099ff885 print_backtrace + 37\n    ------------------------------------------------------------------------\n    Unhandled SIGABRT: An abort() occurred.\n    This probably occurred because a *compiled* module has a bug\n    in it and is not properly wrapped with sig_on(), sig_off().\n    Python will now terminate.\n    ------------------------------------------------------------------------\n    <BLANKLINE>\n**********************************************************************\nFile \"src/cysignals/tests.pyx\", line 599, in tests.pyx\nFailed example:\n    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS\nExpected:\n    ------------------------------------------------------------------------\n    ...\n    ------------------------------------------------------------------------\n    ------------------------------------------------------------------------\n    An error occured during signal handling.\n    This probably occurred because a *compiled* module has a bug\n    in it and is not properly wrapped with sig_on(), sig_off().\n    Python will now terminate.\n    ------------------------------------------------------------------------\n    <BLANKLINE>\nGot:\n    ------------------------------------------------------------------------\n    0   signals.so                          0x000000010c6de885 print_backtrace + 37\n    ------------------------------------------------------------------------\n    An error occured during signal handling.\n    This probably occurred because a *compiled* module has a bug\n    in it and is not properly wrapped with sig_on(), sig_off().\n    Python will now terminate.\n    ------------------------------------------------------------------------\n    <BLANKLINE>\n**********************************************************************\n1 items had failures:\n   4 of  97 in tests.pyx\n***Test Failed*** 4 failures.\nmake[3]: *** [check-doctest] Error 1\nmake[3]: Target `check' not remade because of errors.\n```",
    "created_at": "2016-02-17T00:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271350",
    "user": "https://github.com/vbraun"
}
```

```
Running the test suite for cysignals-1.0rc0...
python setup.py build
running build
running build_py
running build_ext
running build_scripts
python setup.py install
running install
running build
running build_py
running build_ext
running build_scripts
running install_lib
running install_scripts
changing mode of /Users/buildslave-sage/slave/sage_git/build/local/bin/cysignals-CSI to 755
changing mode of /Users/buildslave-sage/slave/sage_git/build/local/bin/cysignals-CSI-helper.py to 755
running install_egg_info
Removing /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals-1.0rc0-py2.7.egg-info
Writing /Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals-1.0rc0-py2.7.egg-info
python -m doctest src/cysignals/*.pyx
cd example && python setup.py build
Compiling cysignals_example.pyx because it changed.
[1/1] Cythonizing cysignals_example.pyx
running build
running build_ext
building 'cysignals_example' extension
creating build
creating build/temp.macosx-10.9-x86_64-2.7
gcc -fno-strict-aliasing -I/Users/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/python2-2.7.10.p0/include -DNDEBUG -g -fwrapv -O3 -Wall -Wno-unused -I/Users/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/Users/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.c -o build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o
creating build/lib.macosx-10.9-x86_64-2.7
gcc -bundle -undefined dynamic_lookup -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib -L/Users/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/Users/buildslave-sage/slave/sage_git/build/local/lib build/temp.macosx-10.9-x86_64-2.7/cysignals_example.o -L/Users/buildslave-sage/slave/sage_git/build/local/lib -o build/lib.macosx-10.9-x86_64-2.7/cysignals_example.so -lpari -Ddummy
**********************************************************************
File "src/cysignals/tests.pyx", line 491, in tests.pyx
Failed example:
    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS
Expected:
    ------------------------------------------------------------------------
    ...
    ------------------------------------------------------------------------
    ------------------------------------------------------------------------
    <BLANKLINE>
Got:
    ------------------------------------------------------------------------
    0   signals.so                          0x000000010d478885 print_backtrace + 37
    ------------------------------------------------------------------------
    <BLANKLINE>
**********************************************************************
File "src/cysignals/tests.pyx", line 536, in tests.pyx
Failed example:
    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS
Expected:
    ------------------------------------------------------------------------
    ...
    ------------------------------------------------------------------------
    ------------------------------------------------------------------------
    Unhandled SIG...
    This probably occurred because a *compiled* module has a bug
    in it and is not properly wrapped with sig_on(), sig_off().
    Python will now terminate.
    ------------------------------------------------------------------------
    <BLANKLINE>
Got:
    ------------------------------------------------------------------------
    0   signals.so                          0x000000010e85f885 print_backtrace + 37
    ------------------------------------------------------------------------
    Unhandled SIGSEGV: A segmentation fault occurred.
    This probably occurred because a *compiled* module has a bug
    in it and is not properly wrapped with sig_on(), sig_off().
    Python will now terminate.
    ------------------------------------------------------------------------
    <BLANKLINE>
**********************************************************************
File "src/cysignals/tests.pyx", line 575, in tests.pyx
Failed example:
    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS
Expected:
    ------------------------------------------------------------------------
    ...
    ------------------------------------------------------------------------
    ------------------------------------------------------------------------
    Unhandled SIGABRT: An abort() occurred.
    This probably occurred because a *compiled* module has a bug
    in it and is not properly wrapped with sig_on(), sig_off().
    Python will now terminate.
    ------------------------------------------------------------------------
    <BLANKLINE>
Got:
    ------------------------------------------------------------------------
    0   signals.so                          0x00000001099ff885 print_backtrace + 37
    ------------------------------------------------------------------------
    Unhandled SIGABRT: An abort() occurred.
    This probably occurred because a *compiled* module has a bug
    in it and is not properly wrapped with sig_on(), sig_off().
    Python will now terminate.
    ------------------------------------------------------------------------
    <BLANKLINE>
**********************************************************************
File "src/cysignals/tests.pyx", line 599, in tests.pyx
Failed example:
    print Popen(['python', '-c', cmd], stdout=PIPE, stderr=PIPE).communicate()[1]  # doctest: +ELLIPSIS
Expected:
    ------------------------------------------------------------------------
    ...
    ------------------------------------------------------------------------
    ------------------------------------------------------------------------
    An error occured during signal handling.
    This probably occurred because a *compiled* module has a bug
    in it and is not properly wrapped with sig_on(), sig_off().
    Python will now terminate.
    ------------------------------------------------------------------------
    <BLANKLINE>
Got:
    ------------------------------------------------------------------------
    0   signals.so                          0x000000010c6de885 print_backtrace + 37
    ------------------------------------------------------------------------
    An error occured during signal handling.
    This probably occurred because a *compiled* module has a bug
    in it and is not properly wrapped with sig_on(), sig_off().
    Python will now terminate.
    ------------------------------------------------------------------------
    <BLANKLINE>
**********************************************************************
1 items had failures:
   4 of  97 in tests.pyx
***Test Failed*** 4 failures.
make[3]: *** [check-doctest] Error 1
make[3]: Target `check' not remade because of errors.
```



---

archive/issue_comments_271351.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-02-17T00:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271351",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_271352.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-02-18T10:22:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271352",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_271353.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-02-18T10:23:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271353",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_271354.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-18T10:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271354",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_271355.json:
```json
{
    "body": "The test is now hanging for half an hour on my desktop:\n\n```\nbuildsl+ 11539  0.0  0.0 117516  3068 ?        SN   Feb18   0:00 bash ./install start\nbuildsl+ 11568  0.0  0.0 115080  2948 ?        SN   Feb18   0:00 make -j8 start\nbuildsl+ 11576  0.0  0.0 116776  4588 ?        SN   Feb18   0:00 make -j8 all-sage\nvbraun   13964  0.0  0.0 117000  2256 pts/4    S+   00:30   0:00 grep --color=auto buildsl\nbuildsl+ 24718  0.0  0.0 117512  3144 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-logger sage-spkg cysignals-1.0rc1 /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log\nbuildsl+ 24735  0.0  0.0 117512  1828 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-logger sage-spkg cysignals-1.0rc1 /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log\nbuildsl+ 24737  0.0  0.0 117512   220 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-logger sage-spkg cysignals-1.0rc1 /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log\nbuildsl+ 24739  0.0  0.0 112180  1856 ?        SN   Feb18   0:00 tee -a /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log\nbuildsl+ 24740  0.0  0.0 117648  3120 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-spkg cysignals-1.0rc1\nbuildsl+ 25822  0.0  0.0   9636  2456 ?        SN   Feb18   0:00 bash ./spkg-check\nbuildsl+ 25823  0.0  0.0   6720  1980 ?        SN   Feb18   0:00 make check\nbuildsl+ 25828  0.1  0.0 116652 18112 ?        SN   Feb18   0:08 python -m doctest src/cysignals/alarm.pyx src/cysignals/signals.pyx src/cysignals/tests.pyx\n```\nAfter killing it \n\n```\ncd example && python setup.py build\nCompiling cysignals_example.pyx because it changed.\n[1/1] Cythonizing cysignals_example.pyx\nrunning build\nrunning build_ext\nbuilding 'cysignals_example' extension\ncreating build\ncreating build/temp.linux-x86_64-2.7-pydebug\ngcc -fno-strict-aliasing -g -O2 -g -O0 -Wall -Wno-unused -fPIC -I/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.c -o build/temp.linux-x86_64-2.7-pydebug/cysignals_example.o\ncreating build/lib.linux-x86_64-2.7-pydebug\ngcc -pthread -shared -L/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -L/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib build/temp.linux-x86_64-2.7-pydebug/cysignals_example.o -L/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -lpython2.7 -o build/lib.linux-x86_64-2.7-pydebug/cysignals_example.so -lpari -Ddummy\nMakefile:40: recipe for target 'check-doctest' failed\nmake[3]: *** [check-doctest] Terminated\nmake[3]: Target 'check' not remade because of errors.\nmake[3]: Leaving directory '/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/cysignals-1.0rc1/src'\n```\nGDB\n\n```\n(gdb) bt\n#0  0x00007fb1ed0f24ec in __lll_lock_wait_private () from /lib64/libc.so.6\n#1  0x00007fb1ed05f863 in ptmalloc_lock_all () from /lib64/libc.so.6\n#2  0x00007fb1ed0aa832 in fork () from /lib64/libc.so.6\n#3  0x00007fb1e786b957 in signal_pid_after_delay (signum=2, killpid=16455, ms=200, \n    interval=0, n=1) at src/cysignals/tests_helper.c:66\n#4  0x00007fb1e7875934 in __pyx_pf_9cysignals_5tests_70test_signal_during_malloc (\n    __pyx_self=0x0, __pyx_v_delay=200) at build/src/cysignals/tests.c:7948\n#5  0x00007fb1e78758a1 in __pyx_pw_9cysignals_5tests_71test_signal_during_malloc (\n    __pyx_self=0x0, __pyx_args=0x7fb1ee2eb060, __pyx_kwds=0x0)\n    at build/src/cysignals/tests.c:7894\n#6  0x00007fb1edd7d798 in PyCFunction_Call (func=0x7fb1e7828678, arg=0x7fb1ee2eb060, kw=0x0)\n    at Objects/methodobject.c:85\n#7  0x00007fb1ede23bf6 in call_function (pp_stack=0x7ffc6fbe3110, oparg=0)\n    at Python/ceval.c:4035\n#8  0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x7fb1e90727e0, throwflag=0)\n    at Python/ceval.c:2681\n#9  0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1e7844460, globals=0x7fb1e783fe78, \n    locals=0x7fb1e783fe78, args=0x0, argcount=0, kws=0x0, kwcount=0, defs=0x0, defcount=0, \n    closure=0x0) at Python/ceval.c:3267\n#10 0x00007fb1ede16998 in PyEval_EvalCode (co=0x7fb1e7844460, globals=0x7fb1e783fe78, \n    locals=0x7fb1e783fe78) at Python/ceval.c:669\n#11 0x00007fb1ede2671b in exec_statement (f=0x2054750, prog=0x7fb1e7844460, \n    globals=0x7fb1e783fe78, locals=0x7fb1e783fe78) at Python/ceval.c:4732\n#12 0x00007fb1ede1acea in PyEval_EvalFrameEx (f=0x2054750, throwflag=0) at Python/ceval.c:1883\n#13 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd59b40, globals=0x7fb1ee2df958, \n    locals=0x0, args=0x2050a28, argcount=4, kws=0x2050a48, kwcount=0, defs=0x0, defcount=0, \n    closure=0x0) at Python/ceval.c:3267\n#14 0x00007fb1ede24233 in fast_function (func=0x7fb1e9076ae0, pp_stack=0x7ffc6fbe3a20, n=4, \n    na=4, nk=0) at Python/ceval.c:4131\n#15 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe3a20, oparg=3)\n    at Python/ceval.c:4056\n---Type <return> to continue, or q <return> to quit---\n#16 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x2050860, throwflag=0) at Python/ceval.c:2681\n#17 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd59d50, globals=0x7fb1ee2df958, \n    locals=0x0, args=0x203fe20, argcount=2, kws=0x203fe30, kwcount=0, defs=0x7fb1e9075c88, \n    defcount=3, closure=0x0) at Python/ceval.c:3267\n#18 0x00007fb1ede24233 in fast_function (func=0x7fb1e9076cd8, pp_stack=0x7ffc6fbe3ee0, n=2, \n    na=2, nk=0) at Python/ceval.c:4131\n#19 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe3ee0, oparg=1)\n    at Python/ceval.c:4056\n#20 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x203fc20, throwflag=0) at Python/ceval.c:2681\n#21 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ec8eda90, globals=0x7fb1ee2df958, \n    locals=0x0, args=0x1fa72a8, argcount=1, kws=0x1fa72b0, kwcount=1, defs=0x7fb1eba93988, \n    defcount=11, closure=0x0) at Python/ceval.c:3267\n#22 0x00007fb1ede24233 in fast_function (func=0x7fb1e90795a0, pp_stack=0x7ffc6fbe43a0, n=3, \n    na=1, nk=1) at Python/ceval.c:4131\n#23 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe43a0, oparg=257)\n    at Python/ceval.c:4056\n#24 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x1fa70d0, throwflag=0) at Python/ceval.c:2681\n#25 0x00007fb1ede24119 in fast_function (func=0x7fb1e907be28, pp_stack=0x7ffc6fbe46d0, n=0, \n    na=0, nk=0) at Python/ceval.c:4121\n#26 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe46d0, oparg=0)\n    at Python/ceval.c:4056\n#27 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x1e551a0, throwflag=0) at Python/ceval.c:2681\n#28 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ec8f7d50, globals=0x7fb1ee2df958, \n    locals=0x7fb1ee2df958, args=0x0, argcount=0, kws=0x0, kwcount=0, defs=0x0, defcount=0, \n    closure=0x0) at Python/ceval.c:3267\n#29 0x00007fb1ede16998 in PyEval_EvalCode (co=0x7fb1ec8f7d50, globals=0x7fb1ee2df958, \n    locals=0x7fb1ee2df958) at Python/ceval.c:669\n#30 0x00007fb1ede2671b in exec_statement (f=0x1f8cb20, prog=0x7fb1ec8f7d50, \n    globals=0x7fb1ee2df958, locals=0x7fb1ee2df958) at Python/ceval.c:4732\n#31 0x00007fb1ede1acea in PyEval_EvalFrameEx (f=0x1f8cb20, throwflag=0) at Python/ceval.c:1883\n#32 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd62930, globals=0x7fb1ecd806c8, \n---Type <return> to continue, or q <return> to quit---\n    locals=0x0, args=0x1ede0c8, argcount=7, kws=0x1ede100, kwcount=0, defs=0x7fb1ecd65aa8, \n    defcount=5, closure=0x0) at Python/ceval.c:3267\n#33 0x00007fb1ede24233 in fast_function (func=0x7fb1ecd8d300, pp_stack=0x7ffc6fbe4fe0, n=7, \n    na=7, nk=0) at Python/ceval.c:4131\n#34 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe4fe0, oparg=7)\n    at Python/ceval.c:4056\n#35 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x1eddef0, throwflag=0) at Python/ceval.c:2681\n#36 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd7e1a0, globals=0x7fb1ecd806c8, \n    locals=0x0, args=0x7fb1ecda4da8, argcount=2, kws=0x0, kwcount=0, defs=0x7fb1ecd85e18, \n    defcount=1, closure=0x0) at Python/ceval.c:3267\n#37 0x00007fb1edd5996f in function_call (func=0x7fb1ecd90b88, arg=0x7fb1ecda4d80, kw=0x0)\n    at Objects/funcobject.c:526\n#38 0x00007fb1edd19a7c in PyObject_Call (func=0x7fb1ecd90b88, arg=0x7fb1ecda4d80, kw=0x0)\n    at Objects/abstract.c:2529\n#39 0x00007fb1ede6e49c in RunModule (module=0x1e55010 \"doctest\", set_argv0=1)\n    at Modules/main.c:192\n#40 0x00007fb1ede6f42b in Py_Main (argc=6, argv=0x7ffc6fbe55c8) at Modules/main.c:587\n#41 0x0000000000400846 in main (argc=6, argv=0x7ffc6fbe55c8) at ./Modules/python.c:23\n```\nRetried and hangs again at same spot.\n\nThis is a debug Python build (`SAGE_DEBUG=yes`)",
    "created_at": "2016-02-18T23:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271355",
    "user": "https://github.com/vbraun"
}
```

The test is now hanging for half an hour on my desktop:

```
buildsl+ 11539  0.0  0.0 117516  3068 ?        SN   Feb18   0:00 bash ./install start
buildsl+ 11568  0.0  0.0 115080  2948 ?        SN   Feb18   0:00 make -j8 start
buildsl+ 11576  0.0  0.0 116776  4588 ?        SN   Feb18   0:00 make -j8 all-sage
vbraun   13964  0.0  0.0 117000  2256 pts/4    S+   00:30   0:00 grep --color=auto buildsl
buildsl+ 24718  0.0  0.0 117512  3144 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-logger sage-spkg cysignals-1.0rc1 /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log
buildsl+ 24735  0.0  0.0 117512  1828 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-logger sage-spkg cysignals-1.0rc1 /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log
buildsl+ 24737  0.0  0.0 117512   220 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-logger sage-spkg cysignals-1.0rc1 /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log
buildsl+ 24739  0.0  0.0 112180  1856 ?        SN   Feb18   0:00 tee -a /mnt/disk/home/buildslave-sage/slave/sage_git/build/logs/pkgs/cysignals-1.0rc1.log
buildsl+ 24740  0.0  0.0 117648  3120 ?        SN   Feb18   0:00 bash /mnt/disk/home/buildslave-sage/slave/sage_git/build/build/bin/sage-spkg cysignals-1.0rc1
buildsl+ 25822  0.0  0.0   9636  2456 ?        SN   Feb18   0:00 bash ./spkg-check
buildsl+ 25823  0.0  0.0   6720  1980 ?        SN   Feb18   0:00 make check
buildsl+ 25828  0.1  0.0 116652 18112 ?        SN   Feb18   0:08 python -m doctest src/cysignals/alarm.pyx src/cysignals/signals.pyx src/cysignals/tests.pyx
```
After killing it 

```
cd example && python setup.py build
Compiling cysignals_example.pyx because it changed.
[1/1] Cythonizing cysignals_example.pyx
running build
running build_ext
building 'cysignals_example' extension
creating build
creating build/temp.linux-x86_64-2.7-pydebug
gcc -fno-strict-aliasing -g -O2 -g -O0 -Wall -Wno-unused -fPIC -I/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib/python2.7/site-packages/cysignals -I/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/include/python2.7 -c cysignals_example.c -o build/temp.linux-x86_64-2.7-pydebug/cysignals_example.o
creating build/lib.linux-x86_64-2.7-pydebug
gcc -pthread -shared -L/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -L/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -Wl,-rpath,/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib build/temp.linux-x86_64-2.7-pydebug/cysignals_example.o -L/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/lib -lpython2.7 -o build/lib.linux-x86_64-2.7-pydebug/cysignals_example.so -lpari -Ddummy
Makefile:40: recipe for target 'check-doctest' failed
make[3]: *** [check-doctest] Terminated
make[3]: Target 'check' not remade because of errors.
make[3]: Leaving directory '/mnt/disk/home/buildslave-sage/slave/sage_git/build/local/var/tmp/sage/build/cysignals-1.0rc1/src'
```
GDB

```
(gdb) bt
#0  0x00007fb1ed0f24ec in __lll_lock_wait_private () from /lib64/libc.so.6
#1  0x00007fb1ed05f863 in ptmalloc_lock_all () from /lib64/libc.so.6
#2  0x00007fb1ed0aa832 in fork () from /lib64/libc.so.6
#3  0x00007fb1e786b957 in signal_pid_after_delay (signum=2, killpid=16455, ms=200, 
    interval=0, n=1) at src/cysignals/tests_helper.c:66
#4  0x00007fb1e7875934 in __pyx_pf_9cysignals_5tests_70test_signal_during_malloc (
    __pyx_self=0x0, __pyx_v_delay=200) at build/src/cysignals/tests.c:7948
#5  0x00007fb1e78758a1 in __pyx_pw_9cysignals_5tests_71test_signal_during_malloc (
    __pyx_self=0x0, __pyx_args=0x7fb1ee2eb060, __pyx_kwds=0x0)
    at build/src/cysignals/tests.c:7894
#6  0x00007fb1edd7d798 in PyCFunction_Call (func=0x7fb1e7828678, arg=0x7fb1ee2eb060, kw=0x0)
    at Objects/methodobject.c:85
#7  0x00007fb1ede23bf6 in call_function (pp_stack=0x7ffc6fbe3110, oparg=0)
    at Python/ceval.c:4035
#8  0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x7fb1e90727e0, throwflag=0)
    at Python/ceval.c:2681
#9  0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1e7844460, globals=0x7fb1e783fe78, 
    locals=0x7fb1e783fe78, args=0x0, argcount=0, kws=0x0, kwcount=0, defs=0x0, defcount=0, 
    closure=0x0) at Python/ceval.c:3267
#10 0x00007fb1ede16998 in PyEval_EvalCode (co=0x7fb1e7844460, globals=0x7fb1e783fe78, 
    locals=0x7fb1e783fe78) at Python/ceval.c:669
#11 0x00007fb1ede2671b in exec_statement (f=0x2054750, prog=0x7fb1e7844460, 
    globals=0x7fb1e783fe78, locals=0x7fb1e783fe78) at Python/ceval.c:4732
#12 0x00007fb1ede1acea in PyEval_EvalFrameEx (f=0x2054750, throwflag=0) at Python/ceval.c:1883
#13 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd59b40, globals=0x7fb1ee2df958, 
    locals=0x0, args=0x2050a28, argcount=4, kws=0x2050a48, kwcount=0, defs=0x0, defcount=0, 
    closure=0x0) at Python/ceval.c:3267
#14 0x00007fb1ede24233 in fast_function (func=0x7fb1e9076ae0, pp_stack=0x7ffc6fbe3a20, n=4, 
    na=4, nk=0) at Python/ceval.c:4131
#15 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe3a20, oparg=3)
    at Python/ceval.c:4056
---Type <return> to continue, or q <return> to quit---
#16 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x2050860, throwflag=0) at Python/ceval.c:2681
#17 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd59d50, globals=0x7fb1ee2df958, 
    locals=0x0, args=0x203fe20, argcount=2, kws=0x203fe30, kwcount=0, defs=0x7fb1e9075c88, 
    defcount=3, closure=0x0) at Python/ceval.c:3267
#18 0x00007fb1ede24233 in fast_function (func=0x7fb1e9076cd8, pp_stack=0x7ffc6fbe3ee0, n=2, 
    na=2, nk=0) at Python/ceval.c:4131
#19 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe3ee0, oparg=1)
    at Python/ceval.c:4056
#20 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x203fc20, throwflag=0) at Python/ceval.c:2681
#21 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ec8eda90, globals=0x7fb1ee2df958, 
    locals=0x0, args=0x1fa72a8, argcount=1, kws=0x1fa72b0, kwcount=1, defs=0x7fb1eba93988, 
    defcount=11, closure=0x0) at Python/ceval.c:3267
#22 0x00007fb1ede24233 in fast_function (func=0x7fb1e90795a0, pp_stack=0x7ffc6fbe43a0, n=3, 
    na=1, nk=1) at Python/ceval.c:4131
#23 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe43a0, oparg=257)
    at Python/ceval.c:4056
#24 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x1fa70d0, throwflag=0) at Python/ceval.c:2681
#25 0x00007fb1ede24119 in fast_function (func=0x7fb1e907be28, pp_stack=0x7ffc6fbe46d0, n=0, 
    na=0, nk=0) at Python/ceval.c:4121
#26 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe46d0, oparg=0)
    at Python/ceval.c:4056
#27 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x1e551a0, throwflag=0) at Python/ceval.c:2681
#28 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ec8f7d50, globals=0x7fb1ee2df958, 
    locals=0x7fb1ee2df958, args=0x0, argcount=0, kws=0x0, kwcount=0, defs=0x0, defcount=0, 
    closure=0x0) at Python/ceval.c:3267
#29 0x00007fb1ede16998 in PyEval_EvalCode (co=0x7fb1ec8f7d50, globals=0x7fb1ee2df958, 
    locals=0x7fb1ee2df958) at Python/ceval.c:669
#30 0x00007fb1ede2671b in exec_statement (f=0x1f8cb20, prog=0x7fb1ec8f7d50, 
    globals=0x7fb1ee2df958, locals=0x7fb1ee2df958) at Python/ceval.c:4732
#31 0x00007fb1ede1acea in PyEval_EvalFrameEx (f=0x1f8cb20, throwflag=0) at Python/ceval.c:1883
#32 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd62930, globals=0x7fb1ecd806c8, 
---Type <return> to continue, or q <return> to quit---
    locals=0x0, args=0x1ede0c8, argcount=7, kws=0x1ede100, kwcount=0, defs=0x7fb1ecd65aa8, 
    defcount=5, closure=0x0) at Python/ceval.c:3267
#33 0x00007fb1ede24233 in fast_function (func=0x7fb1ecd8d300, pp_stack=0x7ffc6fbe4fe0, n=7, 
    na=7, nk=0) at Python/ceval.c:4131
#34 0x00007fb1ede23e00 in call_function (pp_stack=0x7ffc6fbe4fe0, oparg=7)
    at Python/ceval.c:4056
#35 0x00007fb1ede1e642 in PyEval_EvalFrameEx (f=0x1eddef0, throwflag=0) at Python/ceval.c:2681
#36 0x00007fb1ede2110b in PyEval_EvalCodeEx (co=0x7fb1ecd7e1a0, globals=0x7fb1ecd806c8, 
    locals=0x0, args=0x7fb1ecda4da8, argcount=2, kws=0x0, kwcount=0, defs=0x7fb1ecd85e18, 
    defcount=1, closure=0x0) at Python/ceval.c:3267
#37 0x00007fb1edd5996f in function_call (func=0x7fb1ecd90b88, arg=0x7fb1ecda4d80, kw=0x0)
    at Objects/funcobject.c:526
#38 0x00007fb1edd19a7c in PyObject_Call (func=0x7fb1ecd90b88, arg=0x7fb1ecda4d80, kw=0x0)
    at Objects/abstract.c:2529
#39 0x00007fb1ede6e49c in RunModule (module=0x1e55010 "doctest", set_argv0=1)
    at Modules/main.c:192
#40 0x00007fb1ede6f42b in Py_Main (argc=6, argv=0x7ffc6fbe55c8) at Modules/main.c:587
#41 0x0000000000400846 in main (argc=6, argv=0x7ffc6fbe55c8) at ./Modules/python.c:23
```
Retried and hangs again at same spot.

This is a debug Python build (`SAGE_DEBUG=yes`)



---

archive/issue_comments_271356.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-02-18T23:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271356",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_271357.json:
```json
{
    "body": "Considering the change between rc0 and rc1 it is very strange if it didn't happen before.",
    "created_at": "2016-02-19T00:00:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271357",
    "user": "https://github.com/kiwifb"
}
```

Considering the change between rc0 and rc1 it is very strange if it didn't happen before.



---

archive/issue_comments_271358.json:
```json
{
    "body": "It's also surprising that it doesn't happen with the interrupt code currently in Sage... it's the same code as in `cysignals`.",
    "created_at": "2016-02-19T09:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271358",
    "user": "https://github.com/jdemeyer"
}
```

It's also surprising that it doesn't happen with the interrupt code currently in Sage... it's the same code as in `cysignals`.



---

archive/issue_comments_271359.json:
```json
{
    "body": "The `malloc()` problem is genuine. I will update `cysignals`.",
    "created_at": "2016-02-19T10:30:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271359",
    "user": "https://github.com/jdemeyer"
}
```

The `malloc()` problem is genuine. I will update `cysignals`.



---

archive/issue_comments_271360.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2016-02-19T17:38:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271360",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_271361.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-02-19T17:39:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271361",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_271362.json:
```json
{
    "body": "I disabled the failing `malloc()` test. Eventually we should move `sage_malloc()` and friends to `cysignals` too and re-enable the test.",
    "created_at": "2016-02-19T17:40:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271362",
    "user": "https://github.com/jdemeyer"
}
```

I disabled the failing `malloc()` test. Eventually we should move `sage_malloc()` and friends to `cysignals` too and re-enable the test.



---

archive/issue_comments_271363.json:
```json
{
    "body": "needs review...",
    "created_at": "2016-02-22T08:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271363",
    "user": "https://github.com/jdemeyer"
}
```

needs review...



---

archive/issue_comments_271364.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-22T08:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271364",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_271365.json:
```json
{
    "body": "There, let's put it on one more time.",
    "created_at": "2016-02-22T08:41:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271365",
    "user": "https://github.com/kiwifb"
}
```

There, let's put it on one more time.



---

archive/issue_comments_271366.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-02-23T08:26:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19765#issuecomment-271366",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_054526.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-02-23T08:26:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/19765",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/19765#event-54526"
}
```
