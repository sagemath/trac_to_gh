# Issue 14533: Fragile GMP header hack in Singular

archive/issues_014533.json:
```json
{
    "body": "Assignee: @jdemeyer\n\nCC:  @mezzarobba\n\nKeywords: cf_gmp.h bits/c++config.h spkg\n\nThis is still present in SIngular 3-1-6.\n\nIssue created by migration from https://trac.sagemath.org/ticket/14737\n\n",
    "created_at": "2013-06-13T14:16:29Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.12",
    "title": "Fragile GMP header hack in Singular",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/14533",
    "user": "https://github.com/nexttime"
}
```
Assignee: @jdemeyer

CC:  @mezzarobba

Keywords: cf_gmp.h bits/c++config.h spkg

This is still present in SIngular 3-1-6.

Issue created by migration from https://trac.sagemath.org/ticket/14737





---

archive/issue_comments_184259.json:
```json
{
    "body": "(More to come...)",
    "created_at": "2013-06-13T14:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184259",
    "user": "https://github.com/nexttime"
}
```

(More to come...)



---

archive/issue_comments_184260.json:
```json
{
    "body": "Changing keywords from \"cf_gmp.h bits/c++config.h spkg\" to \"cf_gmp.h bits/c++config.h spkg factory build error\".",
    "created_at": "2013-06-13T14:23:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184260",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "cf_gmp.h bits/c++config.h spkg" to "cf_gmp.h bits/c++config.h spkg factory build error".



---

archive/issue_comments_184261.json:
```json
{
    "body": "Changing assignee from @jdemeyer to @nexttime.",
    "created_at": "2013-06-13T14:58:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184261",
    "user": "https://github.com/nexttime"
}
```

Changing assignee from @jdemeyer to @nexttime.



---

archive/issue_comments_184262.json:
```json
{
    "body": "For the impatient:\n\nAn initial fixed spkg can be found [here](http://boxen.math.washington.edu/home/leif/Sage/spkgs/singular-3-1-5.p8.spkg).  (Currently just adds a patch to `src/factory/GNUmakefile.in`, also simplifying the header generation a bit.)",
    "created_at": "2013-06-14T20:09:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184262",
    "user": "https://github.com/nexttime"
}
```

For the impatient:

An initial fixed spkg can be found [here](http://boxen.math.washington.edu/home/leif/Sage/spkgs/singular-3-1-5.p8.spkg).  (Currently just adds a patch to `src/factory/GNUmakefile.in`, also simplifying the header generation a bit.)



---

archive/issue_comments_184263.json:
```json
{
    "body": "Changing keywords from \"cf_gmp.h bits/c++config.h spkg factory build error\" to \"cf_gmp.h bits/c++config.h spkg factory build error Arch Linux Slackware\".",
    "created_at": "2013-06-23T13:11:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184263",
    "user": "https://github.com/nexttime"
}
```

Changing keywords from "cf_gmp.h bits/c++config.h spkg factory build error" to "cf_gmp.h bits/c++config.h spkg factory build error Arch Linux Slackware".



---

archive/issue_comments_184264.json:
```json
{
    "body": "I used the patch to build sage\u00a05.11\u03b23 on a system that used to be affected by this bug (debian sid, gcc\u00a04.8). It works for me.",
    "created_at": "2013-06-24T19:41:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184264",
    "user": "https://github.com/mezzarobba"
}
```

I used the patch to build sage 5.11β3 on a system that used to be affected by this bug (debian sid, gcc 4.8). It works for me.



---

archive/issue_comments_184265.json:
```json
{
    "body": "Replying to [comment:8 mmezzarobba]:\n> I used the patch to build sage\u00a05.11\u03b23 on a system that used to be affected by this bug (debian sid, gcc\u00a04.8). It works for me.\n\nSomeone else just reported the same error for Debian testing... :-)",
    "created_at": "2013-06-24T19:47:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184265",
    "user": "https://github.com/nexttime"
}
```

Replying to [comment:8 mmezzarobba]:
> I used the patch to build sage 5.11β3 on a system that used to be affected by this bug (debian sid, gcc 4.8). It works for me.

Someone else just reported the same error for Debian testing... :-)



---

archive/issue_comments_184266.json:
```json
{
    "body": "Slightly changed the spkg; patch now removes unneeded files as well.",
    "created_at": "2013-06-24T22:00:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184266",
    "user": "https://github.com/nexttime"
}
```

Slightly changed the spkg; patch now removes unneeded files as well.



---

archive/issue_comments_184267.json:
```json
{
    "body": "Attachment [sanitize_gmp_header_hack.patch](tarball://root/attachments/some-uuid/ticket14737/sanitize_gmp_header_hack.patch) by @nexttime created at 2013-06-24 22:05:05\n\nProposed patch to upstream (included in the `.p8` spkg).  For reference / review.",
    "created_at": "2013-06-24T22:05:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184267",
    "user": "https://github.com/nexttime"
}
```

Attachment [sanitize_gmp_header_hack.patch](tarball://root/attachments/some-uuid/ticket14737/sanitize_gmp_header_hack.patch) by @nexttime created at 2013-06-24 22:05:05

Proposed patch to upstream (included in the `.p8` spkg).  For reference / review.



---

archive/issue_comments_184268.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2013-06-26T13:30:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184268",
    "user": "https://github.com/vbraun"
}
```

Changing priority from major to critical.



---

archive/issue_comments_184269.json:
```json
{
    "body": "This spkg fixed the problem for me too ! And I also run debian sid. Thank you very much ! `;-)`\n\nNathann",
    "created_at": "2013-07-02T09:58:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184269",
    "user": "https://github.com/nathanncohen"
}
```

This spkg fixed the problem for me too ! And I also run debian sid. Thank you very much ! `;-)`

Nathann



---

archive/issue_comments_184270.json:
```json
{
    "body": "Leif, are you still working on the patch or is this ready for review?",
    "created_at": "2013-07-06T13:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184270",
    "user": "https://github.com/vbraun"
}
```

Leif, are you still working on the patch or is this ready for review?



---

archive/issue_comments_184271.json:
```json
{
    "body": "The GMP header patch looks good to me (positive review)\n\nSomebody needs to review the sage-src script and then we are ready.",
    "created_at": "2013-07-10T19:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184271",
    "user": "https://github.com/vbraun"
}
```

The GMP header patch looks good to me (positive review)

Somebody needs to review the sage-src script and then we are ready.



---

archive/issue_comments_184272.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-07-10T19:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184272",
    "user": "https://github.com/vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_184273.json:
```json
{
    "body": "Changing keywords from \"cf_gmp.h bits/c++config.h spkg factory build error Arch Linux Slackware\" to \"git cf_gmp.h bits/c++config.h spkg factory build error Arch Linux Slackware\".",
    "created_at": "2013-07-10T19:53:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184273",
    "user": "https://github.com/vbraun"
}
```

Changing keywords from "cf_gmp.h bits/c++config.h spkg factory build error Arch Linux Slackware" to "git cf_gmp.h bits/c++config.h spkg factory build error Arch Linux Slackware".



---

archive/issue_comments_184274.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-07-11T21:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184274",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_184275.json:
```json
{
    "body": "I'm ok with spkg-src.",
    "created_at": "2013-07-11T21:55:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184275",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

I'm ok with spkg-src.



---

archive/issue_events_042242.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-07-21T21:11:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14533#event-42242"
}
```



---

archive/issue_comments_184276.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-08-02T14:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/14533#issuecomment-184276",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_042243.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-02T14:19:05Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/14533",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/14533#event-42243"
}
```
