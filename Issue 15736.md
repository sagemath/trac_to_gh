# Issue 15736: Allow GAP to compile on OS X 10.4

archive/issues_015736.json:
```json
{
    "body": "I don't know whether this affects any other platform...\n\n\n```\ngcc -I. -I../.. -DCONFIG_H  -I/Users/student/Desktop/sage-6.2.beta4/local/include -Wall -g -O2  -O2 -g   -o sysfiles.o -c ../../src/sysfiles.c\n../../src/sysfiles.c:3075:15: error: conflicting types for 'sys_errlist'\nIn file included from ../../src/sysfiles.h:20:0,\n                 from ../../src/sysfiles.c:21:\n/usr/include/stdio.h:274:30: note: previous declaration of 'sys_errlist' was here\nmake[4]: *** [sysfiles.o] Error 1\nmake[3]: *** [compile] Error 2\nError building GAP.\n\nreal    11m47.329s\nuser    7m23.375s\nsys     2m4.167s\n************************************************************************\nError installing package gap-4.7.4\n************************************************************************\n```\n\nDima on [this sage-release thread](https://groups.google.com/forum/#!msg/sage-release/6Vh55hF7UXk/cITCg5T83EkJ) gives the correct solution - to add -DHAVE_SYS_ERRLIST to the CFLAGS.\n\nThere is another problem with an unknown `-no_pie` flag as well.\n\nIssue created by migration from https://trac.sagemath.org/ticket/15973\n\n",
    "created_at": "2014-03-18T18:10:24Z",
    "labels": [
        "packages: standard",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "Allow GAP to compile on OS X 10.4",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15736",
    "user": "kcrisman"
}
```
I don't know whether this affects any other platform...


```
gcc -I. -I../.. -DCONFIG_H  -I/Users/student/Desktop/sage-6.2.beta4/local/include -Wall -g -O2  -O2 -g   -o sysfiles.o -c ../../src/sysfiles.c
../../src/sysfiles.c:3075:15: error: conflicting types for 'sys_errlist'
In file included from ../../src/sysfiles.h:20:0,
                 from ../../src/sysfiles.c:21:
/usr/include/stdio.h:274:30: note: previous declaration of 'sys_errlist' was here
make[4]: *** [sysfiles.o] Error 1
make[3]: *** [compile] Error 2
Error building GAP.

real    11m47.329s
user    7m23.375s
sys     2m4.167s
************************************************************************
Error installing package gap-4.7.4
************************************************************************
```

Dima on [this sage-release thread](https://groups.google.com/forum/#!msg/sage-release/6Vh55hF7UXk/cITCg5T83EkJ) gives the correct solution - to add -DHAVE_SYS_ERRLIST to the CFLAGS.

There is another problem with an unknown `-no_pie` flag as well.

Issue created by migration from https://trac.sagemath.org/ticket/15973





---

archive/issue_comments_203647.json:
```json
{
    "body": "I didn't give a proper solution, I gave a hack. A proper solution would be to change `configure.in` appropriately, and/or  to run autoconf etc on OSX 10.4 to generate configure.\n\nSame applies to `-no_pie`, I guess.",
    "created_at": "2014-03-18T22:50:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203647",
    "user": "dimpase"
}
```

I didn't give a proper solution, I gave a hack. A proper solution would be to change `configure.in` appropriately, and/or  to run autoconf etc on OSX 10.4 to generate configure.

Same applies to `-no_pie`, I guess.



---

archive/issue_comments_203648.json:
```json
{
    "body": "This can be reported upstream - GAP devs usually honour requests for fixes for old and not too exotic platforms.",
    "created_at": "2014-03-18T22:59:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203648",
    "user": "dimpase"
}
```

This can be reported upstream - GAP devs usually honour requests for fixes for old and not too exotic platforms.



---

archive/issue_comments_203649.json:
```json
{
    "body": "> I didn't give a proper solution, I gave a hack. A proper solution would be to change `configure.in` appropriately, and/or  to run autoconf etc on OSX 10.4 to generate configure.\nOh, I see.  I guess we could apply a patch to that.  Though I'm having trouble seeing where it's done - configure.in, configure, sysinfo.in, none of them have `sys_err` in them.  Hard to navigate.\n> Same applies to `-no_pie`, I guess.\nPresumably, though I have the same trouble there.   And probably running autoconf on a bunch of different machines isn't a real solution, though maybe I'm misunderstanding this.\n> This can be reported upstream - GAP devs usually honour requests for fixes for old and not too exotic platforms.\nAwesome.  \n\nSo... why is there no GAP source code browser, and no public bug report list?  RWTH can't be that protective of it...",
    "created_at": "2014-03-19T00:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203649",
    "user": "kcrisman"
}
```

> I didn't give a proper solution, I gave a hack. A proper solution would be to change `configure.in` appropriately, and/or  to run autoconf etc on OSX 10.4 to generate configure.
Oh, I see.  I guess we could apply a patch to that.  Though I'm having trouble seeing where it's done - configure.in, configure, sysinfo.in, none of them have `sys_err` in them.  Hard to navigate.
> Same applies to `-no_pie`, I guess.
Presumably, though I have the same trouble there.   And probably running autoconf on a bunch of different machines isn't a real solution, though maybe I'm misunderstanding this.
> This can be reported upstream - GAP devs usually honour requests for fixes for old and not too exotic platforms.
Awesome.  

So... why is there no GAP source code browser, and no public bug report list?  RWTH can't be that protective of it...



---

archive/issue_comments_203650.json:
```json
{
    "body": "The issue is reported on GAP's brand new public issue tracker on Bitbucket\nhttps://bitbucket.org/gap-system/gap/issue/1/gap-474-does-not-build-on-osx-104\n\nIssue number 1, in fact...",
    "created_at": "2014-03-19T00:43:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203650",
    "user": "dimpase"
}
```

The issue is reported on GAP's brand new public issue tracker on Bitbucket
https://bitbucket.org/gap-system/gap/issue/1/gap-474-does-not-build-on-osx-104

Issue number 1, in fact...



---

archive/issue_comments_203651.json:
```json
{
    "body": "Just to repeat my comment on the gap bitbucket tracker:\n\nThe bug is probably https://bitbucket.org/gap-system/gap/commits/86fd78bc51f7, which enabled the -no_pie linker option on OSX 10.4. But the 10.4 linker does not understand the option, so linking fails. This, in turn, causes the AC_TRY_LINK for sys_errlist to fail, and autoconf unsets HAVE_SYS_ERRLIST.",
    "created_at": "2014-03-19T03:07:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203651",
    "user": "vbraun"
}
```

Just to repeat my comment on the gap bitbucket tracker:

The bug is probably https://bitbucket.org/gap-system/gap/commits/86fd78bc51f7, which enabled the -no_pie linker option on OSX 10.4. But the 10.4 linker does not understand the option, so linking fails. This, in turn, causes the AC_TRY_LINK for sys_errlist to fail, and autoconf unsets HAVE_SYS_ERRLIST.



---

archive/issue_comments_203652.json:
```json
{
    "body": "In particular, see [this commit](https://bitbucket.org/gap-system/gap/commits/070b4a9).",
    "created_at": "2014-03-20T02:30:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203652",
    "user": "kcrisman"
}
```

In particular, see [this commit](https://bitbucket.org/gap-system/gap/commits/070b4a9).



---

archive/issue_comments_203653.json:
```json
{
    "body": "Okay, just slapping [that patch](https://bitbucket.org/gap-system/gap/commits/070b4a964402c4396625dbf81e8f1a4e830259da/raw/) in the patches directory for Gap cleared the issue (yes, I had removed the previous hack).  Git isn't built on that machine yet so I couldn't export this as a branch, but if someone can just check it doesn't mess things up on a newer OS X machine then I think we're good to go.",
    "created_at": "2014-03-20T17:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203653",
    "user": "kcrisman"
}
```

Okay, just slapping [that patch](https://bitbucket.org/gap-system/gap/commits/070b4a964402c4396625dbf81e8f1a4e830259da/raw/) in the patches directory for Gap cleared the issue (yes, I had removed the previous hack).  Git isn't built on that machine yet so I couldn't export this as a branch, but if someone can just check it doesn't mess things up on a newer OS X machine then I think we're good to go.



---

archive/issue_comments_203654.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-03-20T18:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203654",
    "user": "vbraun"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_203655.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-03-20T18:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203655",
    "user": "vbraun"
}
```

New commits:



---

archive/issue_comments_203656.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-20T18:11:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203656",
    "user": "vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_203657.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-03-21T17:47:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15736",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15736#issuecomment-203657",
    "user": "vbraun"
}
```

Resolution: fixed
