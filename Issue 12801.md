# Issue 12801: Cannot copy() instances of GurobiBackend.

Issue created by migration from https://trac.sagemath.org/ticket/12973

Original creator: e.vaughan

Original creation time: 2012-05-18 15:26:03

Assignee: jason, jkantor

GurobiBackend does not implement copy().


---

Comment by e.vaughan created at 2012-05-18 15:41:28

Changing keywords from "" to "Gurobi, GurobiBackend, MixedIntegerLinearProgram".


---

Comment by ncohen created at 2012-05-19 12:40:21

Wow !! Very good patch for a first ! `:-D`

Well, it did not apply cleanly on version 5.1.beta0 but that was to be expected if you worked on 4.8 Actually, the replacement from GUROBI to Gurobi has been done since, and that was the whole reason why it did not apply. I just rebased your patch on 5.1.beta0 and updated it on the trac ticket.

There is a problem though, for your patch does not *compile*. When I apply it and type "sage -b" I get this :

```
Error compiling Cython file:
------------------------------------------------------------
...
            sage: p.set_objective([2, 5])                                           # optional - Gurobi
            sage: p.write_lp(SAGE_TMP+"/lp_problem.lp")                             # optional - Gurobi
        """
        check(self.env, GRBwrite(self.model[0], filename))

    cpdef GurobiBackend copy(self):
         ^
------------------------------------------------------------

sage/numerical/backends/gurobi_backend.pyx:1079:10: C method 'copy' not previously declared in definition part of extension type
Error running command, failed with status 256.
Error installing modified sage library code.
```


This is because cdef methods should be added to gurobi_backend.pxd as it is added for glpk in glpk_backend.pxd. I will post another patch to do exactly that.

Nathann


---

Comment by ncohen created at 2012-05-19 12:45:52

Nice !

So I agree with your changes, but as I added something myself you also need to check that everything is fine on your side, and then we will be able to set this ticket to "positive review", which means that the release manager can add it to the next release of Sage!

Thank you for your patch !!

Nathann


---

Comment by ncohen created at 2012-05-19 12:45:52

Changing status from new to needs_review.


---

Comment by ncohen created at 2012-05-19 12:46:39

Changing component from numerical to linear programming.


---

Comment by e.vaughan created at 2012-05-19 23:03:45

Thanks Nathann! I am a bit reluctant to upgrade to Sage 5.x to test the patch due to the issues with Core2 Duo Macs....

Also, in my original patch, I *did* have a
 
   `cpdef GurobiBackend copy(self)`

line.... Maybe that bit of the patch didn't apply properly in 5.1?

One question: why have you changed copy to be a cdef instead of a cpdef? (I used cpdef because that's what GLPKBackend uses (or did in 4.8).)


---

Comment by ncohen created at 2012-05-20 07:25:22

Helloooooo !!!

> Thanks Nathann! I am a bit reluctant to upgrade to Sage 5.x to test the patch due to the issues with Core2 Duo Macs....

Ahaha. That's understandable `:-D`
So the bug happens even when you compile from source ? Scary mac..

> Also, in my original patch, I *did* have a
>  
>    `cpdef GurobiBackend copy(self)`
> 
> line.... Maybe that bit of the patch didn't apply properly in 5.1?

OOpps. Yes, probably. I looked at the list of rejected lines and saw so many GUROBI -> Gurobi, I probably missed that one.

> One question: why have you changed copy to be a cdef instead of a cpdef? (I used cpdef because that's what GLPKBackend uses (or did in 4.8).)

Oops, you are right. Actually, cpef functions are functions that can be called at either C-level or Python level. Well, it more or less changes nothing in this situation, as the code onl calls the copy method from the backends at C level. It's actually totally up to you `:-)`

Nathann


---

Comment by jdemeyer created at 2012-07-27 20:40:04

Please fill in your real name as Author.


---

Comment by vbraun created at 2013-05-11 18:57:56

patchbot: 
apply 16400.patch, trac_12973-review.patch


---

Attachment


---

Attachment


---

Comment by ncohen created at 2013-05-11 23:30:34

Rebased !

Nathann


---

Comment by vbraun created at 2013-05-12 18:08:01

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2013-05-12 18:08:01

lgtm


---

Comment by ncohen created at 2013-05-12 18:22:25

Just learned a new acronym. Thank you very much Volker ! `:-)`

Nathann


---

Comment by jdemeyer created at 2013-05-15 08:24:10

Resolution: fixed
