# Issue 32722: Upgrade to givaro-4.2.0 fflas-ffpack-2.5.0 linbox-1.7.0

archive/issues_032722.json:
```json
{
    "body": "CC:  @kiwifb @orlitzky\n\nNew packages are available here (with the corresponding checksums):\n\ngivaro: https://github.com/linbox-team/givaro/releases/tag/v4.2.0\n\nfflas-ffpack: https://github.com/linbox-team/fflas-ffpack/releases/tag/v2.5.0\n\nlinbox: https://github.com/linbox-team/linbox/releases/tag/v1.7.0\n\nThe new versions require \"a C++ compiler supporting C++11 standard. More precisely g++ v5 or greater, clang++ v3.4 or greater\".\nSo this ticket depends on dropping support for some systems, see #32074.\n\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/32959\n\n",
    "created_at": "2021-12-02T10:49:33Z",
    "labels": [
        "component: packages: standard",
        "critical"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Upgrade to givaro-4.2.0 fflas-ffpack-2.5.0 linbox-1.7.0",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/32722",
    "user": "https://github.com/ClementPernet"
}
```
CC:  @kiwifb @orlitzky

New packages are available here (with the corresponding checksums):

givaro: https://github.com/linbox-team/givaro/releases/tag/v4.2.0

fflas-ffpack: https://github.com/linbox-team/fflas-ffpack/releases/tag/v2.5.0

linbox: https://github.com/linbox-team/linbox/releases/tag/v1.7.0

The new versions require "a C++ compiler supporting C++11 standard. More precisely g++ v5 or greater, clang++ v3.4 or greater".
So this ticket depends on dropping support for some systems, see #32074.




Issue created by migration from https://trac.sagemath.org/ticket/32959





---

archive/issue_comments_466164.json:
```json
{
    "body": "I see numerous build errors in https://github.com/linbox-team/fflas-ffpack/runs/4383290866?check_suite_focus=true that will need fixing before we can do these updates",
    "created_at": "2021-12-02T18:32:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466164",
    "user": "https://github.com/mkoeppe"
}
```

I see numerous build errors in https://github.com/linbox-team/fflas-ffpack/runs/4383290866?check_suite_focus=true that will need fixing before we can do these updates



---

archive/issue_comments_466165.json:
```json
{
    "body": "Of course. I just created this ticket to start working on a its branch, which will help us fix the last issues before cutting the final releases.\nBtw, I did not manage to access to the full artifact of the givaro install log givaro which caused the failures in these github action builds (only the tail of the givaro-log is displayed in the sage build log in your link). Is there any way to access it? (I could not find it in the whole log archive).",
    "created_at": "2021-12-03T08:35:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466165",
    "user": "https://github.com/ClementPernet"
}
```

Of course. I just created this ticket to start working on a its branch, which will help us fix the last issues before cutting the final releases.
Btw, I did not manage to access to the full artifact of the givaro install log givaro which caused the failures in these github action builds (only the tail of the givaro-log is displayed in the sage build log in your link). Is there any way to access it? (I could not find it in the whole log archive).



---

archive/issue_comments_466166.json:
```json
{
    "body": "New commits:",
    "created_at": "2021-12-03T14:13:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466166",
    "user": "https://github.com/ClementPernet"
}
```

New commits:



---

archive/issue_comments_466167.json:
```json
{
    "body": "Replying to [comment:5 cpernet]:\n> I did not manage to access to the full artifact of the givaro install log givaro which caused the failures in these github action builds (only the tail of the givaro-log is displayed in the sage build log in your link). Is there any way to access it? (I could not find it in the whole log archive).\n\n\nIn each run, such as https://github.com/linbox-team/fflas-ffpack/runs/4383290866?check_suite_focus=true, there is a section \"Print out logs for immediate inspection\" in the output, which shows all logs of failing package builds in full.\n\nWhen all jobs have completed, the summary page, such as https://github.com/linbox-team/fflas-ffpack/actions/runs/1526437644, gives access to the log artifacts.\nFor example, `logs-commit-3e42b4a1aaa585bce832738d5a8885dcf7c4273e-tox-docker-ubuntu-xenial-standard` (https://github.com/linbox-team/fflas-ffpack/suites/4521078418/artifacts/121757925) gives a zip file within which you will find `logs/pkgs/givaro-git.log`",
    "created_at": "2021-12-03T18:27:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466167",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:5 cpernet]:
> I did not manage to access to the full artifact of the givaro install log givaro which caused the failures in these github action builds (only the tail of the givaro-log is displayed in the sage build log in your link). Is there any way to access it? (I could not find it in the whole log archive).


In each run, such as https://github.com/linbox-team/fflas-ffpack/runs/4383290866?check_suite_focus=true, there is a section "Print out logs for immediate inspection" in the output, which shows all logs of failing package builds in full.

When all jobs have completed, the summary page, such as https://github.com/linbox-team/fflas-ffpack/actions/runs/1526437644, gives access to the log artifacts.
For example, `logs-commit-3e42b4a1aaa585bce832738d5a8885dcf7c4273e-tox-docker-ubuntu-xenial-standard` (https://github.com/linbox-team/fflas-ffpack/suites/4521078418/artifacts/121757925) gives a zip file within which you will find `logs/pkgs/givaro-git.log`



---

archive/issue_comments_466168.json:
```json
{
    "body": "We have a bit of documentation on this at https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-parallel-tox-runs-on-github-actions; if you feel anything needs to be added, let me know",
    "created_at": "2021-12-03T18:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466168",
    "user": "https://github.com/mkoeppe"
}
```

We have a bit of documentation on this at https://doc.sagemath.org/html/en/developer/portability_testing.html#automatic-parallel-tox-runs-on-github-actions; if you feel anything needs to be added, let me know



---

archive/issue_comments_466169.json:
```json
{
    "body": "Thanks a lot for the pointers.",
    "created_at": "2021-12-04T08:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466169",
    "user": "https://github.com/ClementPernet"
}
```

Thanks a lot for the pointers.



---

archive/issue_comments_466170.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-07T13:13:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466170",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466171.json:
```json
{
    "body": "The `checksums.ini` files should get `upstream_url` lines, see https://doc.sagemath.org/html/en/developer/packaging.html#upstream-urls",
    "created_at": "2021-12-08T00:31:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466171",
    "user": "https://github.com/mkoeppe"
}
```

The `checksums.ini` files should get `upstream_url` lines, see https://doc.sagemath.org/html/en/developer/packaging.html#upstream-urls



---

archive/issue_comments_466172.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2021-12-14T10:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466172",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466173.json:
```json
{
    "body": "I just released the three libraries and updated this branch with the corresponding checksums, and added the upstream_url as requested.\n\nI could check that the testsuite passes on 2 machines (broadwell and skylake-X both running Linux mint).\n\nI only had to comment out `local/include/factory/factory.h` line 92 (`#define IntegerDomain 1`), because this define by Singular gets in the way of Givaro's `Givaro::IntegerDomain`. See [https://groups.google.com/g/sage-devel/c/lC941Lab5ck](https://groups.google.com/g/sage-devel/c/lC941Lab5ck)\n\nDima suggested to pacth this file, but I am not sure to see where this should be done in sage install process. Any help would be most welcome.",
    "created_at": "2021-12-14T10:42:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466173",
    "user": "https://github.com/ClementPernet"
}
```

I just released the three libraries and updated this branch with the corresponding checksums, and added the upstream_url as requested.

I could check that the testsuite passes on 2 machines (broadwell and skylake-X both running Linux mint).

I only had to comment out `local/include/factory/factory.h` line 92 (`#define IntegerDomain 1`), because this define by Singular gets in the way of Givaro's `Givaro::IntegerDomain`. See [https://groups.google.com/g/sage-devel/c/lC941Lab5ck](https://groups.google.com/g/sage-devel/c/lC941Lab5ck)

Dima suggested to pacth this file, but I am not sure to see where this should be done in sage install process. Any help would be most welcome.



---

archive/issue_comments_466174.json:
```json
{
    "body": "Does https://github.com/Singular/Singular/commit/18bb792edcc6d3f65af0111f93ed61118123ffd1\ndo the job? Or they made an error there, it doesn't fix anything for you?",
    "created_at": "2021-12-14T12:03:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466174",
    "user": "https://github.com/dimpase"
}
```

Does https://github.com/Singular/Singular/commit/18bb792edcc6d3f65af0111f93ed61118123ffd1
do the job? Or they made an error there, it doesn't fix anything for you?



---

archive/issue_comments_466175.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> Does https://github.com/Singular/Singular/commit/18bb792edcc6d3f65af0111f93ed61118123ffd1\n> do the job? Or they made an error there, it doesn't fix anything for you?\n\n\nNote that the patched file is actually meant to be preprocessed by Singular's `./factory/bin/makeheader`",
    "created_at": "2021-12-14T12:10:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466175",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:16 dimpase]:
> Does https://github.com/Singular/Singular/commit/18bb792edcc6d3f65af0111f93ed61118123ffd1
> do the job? Or they made an error there, it doesn't fix anything for you?


Note that the patched file is actually meant to be preprocessed by Singular's `./factory/bin/makeheader`



---

archive/issue_comments_466176.json:
```json
{
    "body": "Replying to [comment:15 cpernet]:\n> \n> Dima suggested to pacth this file, but I am not sure to see where this should be done in sage install process. Any help would be most welcome.\n\n\nI don't think there's such an easy solution. The straightforward one is to wait for a new singular release, and then upgrade singular and givaro in sage at the same time, after enough distributions have packaged them both.",
    "created_at": "2021-12-14T13:12:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466176",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:15 cpernet]:
> 
> Dima suggested to pacth this file, but I am not sure to see where this should be done in sage install process. Any help would be most welcome.


I don't think there's such an easy solution. The straightforward one is to wait for a new singular release, and then upgrade singular and givaro in sage at the same time, after enough distributions have packaged them both.



---

archive/issue_comments_466177.json:
```json
{
    "body": "I would suggest to work around this clash in Givaro.",
    "created_at": "2021-12-14T16:38:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466177",
    "user": "https://github.com/mkoeppe"
}
```

I would suggest to work around this clash in Givaro.



---

archive/issue_comments_466178.json:
```json
{
    "body": "The latest run of the integration testing workflow - https://github.com/linbox-team/fflas-ffpack/runs/4511137082?check_suite_focus=true - fails badly on all platforms",
    "created_at": "2021-12-14T16:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466178",
    "user": "https://github.com/mkoeppe"
}
```

The latest run of the integration testing workflow - https://github.com/linbox-team/fflas-ffpack/runs/4511137082?check_suite_focus=true - fails badly on all platforms



---

archive/issue_events_087083.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2021-12-14T16:44:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32722#event-87083"
}
```



---

archive/issue_comments_466179.json:
```json
{
    "body": "Replying to [comment:20 mkoeppe]:\n> The latest run of the integration testing workflow - https://github.com/linbox-team/fflas-ffpack/runs/4511137082?check_suite_focus=true - fails badly on all platforms\n\nThis run does not correspond to the released package and the failure there has been fixed in a more recent commit which is in the release.",
    "created_at": "2021-12-14T17:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466179",
    "user": "https://github.com/ClementPernet"
}
```

Replying to [comment:20 mkoeppe]:
> The latest run of the integration testing workflow - https://github.com/linbox-team/fflas-ffpack/runs/4511137082?check_suite_focus=true - fails badly on all platforms

This run does not correspond to the released package and the failure there has been fixed in a more recent commit which is in the release.



---

archive/issue_comments_466180.json:
```json
{
    "body": "You may want to cancel the runs that are no longer needed so that the current one gets a chance to run",
    "created_at": "2021-12-14T17:35:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466180",
    "user": "https://github.com/mkoeppe"
}
```

You may want to cancel the runs that are no longer needed so that the current one gets a chance to run



---

archive/issue_comments_466181.json:
```json
{
    "body": "Replying to [comment:19 mkoeppe]:\n> I would suggest to work around this clash in Givaro.\n\n`Givaro::IntegerDomain` is in the public API of Givaro, and used for instance by fflas-ffpack, but possibly other external users or libraries.\nIt is rather hard to justify such a change on Givaro's side. I'd like to investigate further the option of changing the include order.",
    "created_at": "2021-12-14T17:36:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466181",
    "user": "https://github.com/ClementPernet"
}
```

Replying to [comment:19 mkoeppe]:
> I would suggest to work around this clash in Givaro.

`Givaro::IntegerDomain` is in the public API of Givaro, and used for instance by fflas-ffpack, but possibly other external users or libraries.
It is rather hard to justify such a change on Givaro's side. I'd like to investigate further the option of changing the include order.



---

archive/issue_comments_466182.json:
```json
{
    "body": "Replying to [comment:23 mkoeppe]:\n> You may want to cancel the runs that are no longer needed so that the current one gets a chance to run\n\nI was precisely doing this.\nI'll look into how to reduce the number of builds: it is quite a waste of energy to launch the whole build at any PR or push on master.",
    "created_at": "2021-12-14T17:38:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466182",
    "user": "https://github.com/ClementPernet"
}
```

Replying to [comment:23 mkoeppe]:
> You may want to cancel the runs that are no longer needed so that the current one gets a chance to run

I was precisely doing this.
I'll look into how to reduce the number of builds: it is quite a waste of energy to launch the whole build at any PR or push on master.



---

archive/issue_comments_466183.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> Does https://github.com/Singular/Singular/commit/18bb792edcc6d3f65af0111f93ed61118123ffd1\n> do the job? Or they made an error there, it doesn't fix anything for you?\n\n\nI can confirm that this Singular commit fixes the API conflicts, and Sage builds fine against the new linbox with this branch.",
    "created_at": "2021-12-14T18:06:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466183",
    "user": "https://github.com/antonio-rojas"
}
```

Replying to [comment:16 dimpase]:
> Does https://github.com/Singular/Singular/commit/18bb792edcc6d3f65af0111f93ed61118123ffd1
> do the job? Or they made an error there, it doesn't fix anything for you?


I can confirm that this Singular commit fixes the API conflicts, and Sage builds fine against the new linbox with this branch.



---

archive/issue_comments_466184.json:
```json
{
    "body": "Replying to [comment:25 cpernet]:\n> I'll look into how to reduce the number of builds: it is quite a waste of energy to launch the whole build at any PR or push on master.\n\n\nYou could for example change it to running only when a tag is pushed",
    "created_at": "2021-12-14T18:46:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466184",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:25 cpernet]:
> I'll look into how to reduce the number of builds: it is quite a waste of energy to launch the whole build at any PR or push on master.


You could for example change it to running only when a tag is pushed



---

archive/issue_comments_466185.json:
```json
{
    "body": "By the way, the singular update ticket #32907 needs review. Perhaps the patch should be added there?",
    "created_at": "2021-12-14T20:36:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466185",
    "user": "https://github.com/mkoeppe"
}
```

By the way, the singular update ticket #32907 needs review. Perhaps the patch should be added there?



---

archive/issue_comments_466186.json:
```json
{
    "body": "Replying to [comment:28 mkoeppe]:\n> By the way, the singular update ticket #32907 needs review. Perhaps the patch should be added there?\n\n\nPlease don't; if this ticket is then merged, that would magnify the problem from a small upstream annoyance to once that affects all distributions.",
    "created_at": "2021-12-14T23:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466186",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:28 mkoeppe]:
> By the way, the singular update ticket #32907 needs review. Perhaps the patch should be added there?


Please don't; if this ticket is then merged, that would magnify the problem from a small upstream annoyance to once that affects all distributions.



---

archive/issue_comments_466187.json:
```json
{
    "body": "Hm? Isn't this an upstream commit that will be in some later version of Singular anyway?",
    "created_at": "2021-12-14T23:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466187",
    "user": "https://github.com/mkoeppe"
}
```

Hm? Isn't this an upstream commit that will be in some later version of Singular anyway?



---

archive/issue_comments_466188.json:
```json
{
    "body": "Replying to [comment:30 mkoeppe]:\n> Hm? Isn't this an upstream commit that will be in some later version of Singular anyway?\n\n\nYes, but once sage has a patched singular, it can upgrade givaro/linbox/fflas-ffpack, while distros cannot (without backporting the patch).",
    "created_at": "2021-12-14T23:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466188",
    "user": "https://github.com/orlitzky"
}
```

Replying to [comment:30 mkoeppe]:
> Hm? Isn't this an upstream commit that will be in some later version of Singular anyway?


Yes, but once sage has a patched singular, it can upgrade givaro/linbox/fflas-ffpack, while distros cannot (without backporting the patch).



---

archive/issue_comments_466189.json:
```json
{
    "body": "Replying to [comment:24 cpernet]:\n> Replying to [comment:19 mkoeppe]:\n> > I would suggest to work around this clash in Givaro.\n\n> `Givaro::IntegerDomain` is in the public API of Givaro, and used for instance by fflas-ffpack, but possibly other external users or libraries.\n> It is rather hard to justify such a change on Givaro's side.\n\n\nHas it been in the API of any released version of Givaro?",
    "created_at": "2021-12-15T00:23:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466189",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:24 cpernet]:
> Replying to [comment:19 mkoeppe]:
> > I would suggest to work around this clash in Givaro.

> `Givaro::IntegerDomain` is in the public API of Givaro, and used for instance by fflas-ffpack, but possibly other external users or libraries.
> It is rather hard to justify such a change on Givaro's side.


Has it been in the API of any released version of Givaro?



---

archive/issue_comments_466190.json:
```json
{
    "body": "Replying to [comment:32 mkoeppe]:\n> Has it been in the API of any released version of Givaro? \n\n\nSince v4.0.1 (2016-02-24).\n\nIt seems that are only left with the following options:\n- delay the review of this ticket until Singular releases a new version including the fix, and all distros sage wants to support package it\n- change givaro's API and fflas-ffpack usage of this API\n- investigate the include chain and revert to a situation where singular is included after givaro and fflas-ffpack (this is probably why the problem did not show up previously)\n\nAm I missing something?",
    "created_at": "2022-01-05T07:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466190",
    "user": "https://github.com/ClementPernet"
}
```

Replying to [comment:32 mkoeppe]:
> Has it been in the API of any released version of Givaro? 


Since v4.0.1 (2016-02-24).

It seems that are only left with the following options:
- delay the review of this ticket until Singular releases a new version including the fix, and all distros sage wants to support package it
- change givaro's API and fflas-ffpack usage of this API
- investigate the include chain and revert to a situation where singular is included after givaro and fflas-ffpack (this is probably why the problem did not show up previously)

Am I missing something?



---

archive/issue_comments_466191.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-01-05T13:06:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466191",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_466192.json:
```json
{
    "body": "I pushed a fix for the naming conflict, forcing the include of `givinteger.h` before the include of `factory.h`. This was the cleaner way I could find. Trying to identify all situation where singular was included before givaro and swapping them, ended up in a mess.",
    "created_at": "2022-01-05T13:10:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466192",
    "user": "https://github.com/ClementPernet"
}
```

I pushed a fix for the naming conflict, forcing the include of `givinteger.h` before the include of `factory.h`. This was the cleaner way I could find. Trying to identify all situation where singular was included before givaro and swapping them, ended up in a mess.



---

archive/issue_comments_466193.json:
```json
{
    "body": "Singular 4.3.0 has been released - with the Singular patch in comment:26 merged.",
    "created_at": "2022-01-13T17:27:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466193",
    "user": "https://github.com/dimpase"
}
```

Singular 4.3.0 has been released - with the Singular patch in comment:26 merged.



---

archive/issue_comments_466194.json:
```json
{
    "body": "Changing priority from major to critical.",
    "created_at": "2022-02-01T00:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466194",
    "user": "https://github.com/mkoeppe"
}
```

Changing priority from major to critical.



---

archive/issue_comments_466195.json:
```json
{
    "body": "Replying to [comment:35 cpernet]:\n> I pushed a fix for the naming conflict, forcing the include of `givinteger.h` before the include of `factory.h`. This was the cleaner way I could find. Trying to identify all situation where singular was included before givaro and swapping them, ended up in a mess.\n\n\nThis looks like a good solution for now, but this will become an obstacle to modularization pretty soon.",
    "created_at": "2022-02-06T20:27:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466195",
    "user": "https://github.com/mkoeppe"
}
```

Replying to [comment:35 cpernet]:
> I pushed a fix for the naming conflict, forcing the include of `givinteger.h` before the include of `factory.h`. This was the cleaner way I could find. Trying to identify all situation where singular was included before givaro and swapping them, ended up in a mess.


This looks like a good solution for now, but this will become an obstacle to modularization pretty soon.



---

archive/issue_events_087084.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-06T20:49:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "milestone": "sage-9.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32722#event-87084"
}
```



---

archive/issue_events_087085.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-02-06T20:49:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32722#event-87085"
}
```



---

archive/issue_comments_466196.json:
```json
{
    "body": "Replying to [comment:39 mkoeppe]:\n> This looks like a good solution for now, but this will become an obstacle to modularization pretty soon.\n\nShould I revert this commit, as the fixed Singular is now released ? I am not sure what's the best move to get thinks rolling. Just let me know.",
    "created_at": "2022-02-07T07:41:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466196",
    "user": "https://github.com/ClementPernet"
}
```

Replying to [comment:39 mkoeppe]:
> This looks like a good solution for now, but this will become an obstacle to modularization pretty soon.

Should I revert this commit, as the fixed Singular is now released ? I am not sure what's the best move to get thinks rolling. Just let me know.



---

archive/issue_comments_466197.json:
```json
{
    "body": "This would depend on \n- actually making the Singular update (#33160, which needs help)\n- tightening our version requirement in `build/pkgs/singular/spkg-configure.m4`",
    "created_at": "2022-02-07T16:48:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466197",
    "user": "https://github.com/mkoeppe"
}
```

This would depend on 
- actually making the Singular update (#33160, which needs help)
- tightening our version requirement in `build/pkgs/singular/spkg-configure.m4`



---

archive/issue_comments_466198.json:
```json
{
    "body": "By the way, I've marked this ticket for Sage 9.7 because of the increased compiler requirements (see #32074).\n\nAlso before we can merge this upgrade, Cygwin support needs to repaired (https://github.com/linbox-team/fflas-ffpack/runs/4658698318)",
    "created_at": "2022-02-07T16:52:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466198",
    "user": "https://github.com/mkoeppe"
}
```

By the way, I've marked this ticket for Sage 9.7 because of the increased compiler requirements (see #32074).

Also before we can merge this upgrade, Cygwin support needs to repaired (https://github.com/linbox-team/fflas-ffpack/runs/4658698318)



---

archive/issue_comments_466199.json:
```json
{
    "body": "Also, 32bit platforms seem broken",
    "created_at": "2022-02-07T16:54:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466199",
    "user": "https://github.com/mkoeppe"
}
```

Also, 32bit platforms seem broken



---

archive/issue_events_087086.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-05T21:31:37Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "milestone": "sage-9.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32722#event-87086"
}
```



---

archive/issue_events_087087.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-08-05T21:31:37Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "milestone": "sage-9.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/32722#event-87087"
}
```



---

archive/issue_comments_466200.json:
```json
{
    "body": "`@`cpernet Is it planned to release new versions of the packages that include patches you may have received from distribution packaging?",
    "created_at": "2022-08-25T20:16:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466200",
    "user": "https://github.com/mkoeppe"
}
```

`@`cpernet Is it planned to release new versions of the packages that include patches you may have received from distribution packaging?



---

archive/issue_comments_466201.json:
```json
{
    "body": "Yes, I'm finally getting back to it, and would like to cut a minor version in a near future (say september or october) fixing the various issues raised here and in other PRs.",
    "created_at": "2022-08-26T12:15:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/32722",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/32722#issuecomment-466201",
    "user": "https://github.com/ClementPernet"
}
```

Yes, I'm finally getting back to it, and would like to cut a minor version in a near future (say september or october) fixing the various issues raised here and in other PRs.
