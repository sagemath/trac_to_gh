# Issue 16758: Detect the user interface

Issue created by migration from Trac.

Original creator: tmonteil

Original creation time: 2014-09-16 17:52:58

The aim of this ticket is to implement a `user_interface()` function that tells which user interface is used, to deal with different behaviours between sage notebook, ipython notebook and ipython command line, e.g. for printing latex or html.



---

Comment by tmonteil created at 2014-09-16 18:16:02

New commits:


---

Comment by tmonteil created at 2014-09-16 18:16:02

Changing status from new to needs_review.


---

Comment by vbraun created at 2014-09-16 18:41:24

Are you working on ipython notebook integration?

IMHO it is a bad design choice (much like the ACPI OSI fail) to allow directly querying the underlying system. We should abstract capabilities like `user_interface.graphics_display()` instead. Otherwise there will be if/elses scattered everywhere, relying on string comparisons with potentially misspelled magic names (`== 'IPython'` vs `== 'ipython'` etc).


---

Comment by jdemeyer created at 2014-09-16 19:01:53

And if you want to do this right, you should get rid of `DOCTEST_MODE` and `EMBEDDED_MODE` and use these new functions instead.


---

Comment by tmonteil created at 2014-09-16 21:04:17

Thanks for your replies. I completely agree with you, as explicitly stated in the doctest of the function.

However, we still have to support Sage notebook that works by querying the system and Sage is already full of `EMBEDDED_MODE` and related if/else statements (good luck to remove them), and currently features like `pretty_print` are just not working on ipython notebook (and provide some raw uninterpreted html). So we currently have both an ugly code as well as a not well integrated ipython notebook.

I have been recently asked for a `%display typeset` for the ipython notebook (to get the same typeset feature as in Sage notebook) and i see how to do it with a minimal impact on existing Sage's code with such a function (actually i was just about to open a ticket with this one as a dependency).

The question is about the transition: adding a layer of `_repr_*_()` methods on classes that have a specific output (no idea how much work it represents) or using the existing if/then structure (which should not add uglinesses, only modify the existing).

This stuff is not my usual business, but it has to be done before Sage notebook get de facto unmaintained. It seems that no one is really working on the ipython notebook integration, and i bet that having a more friendly ipython notebook early will ease its adoption, therefore its development.

So, if you have plans to do it right (and preferably short), it could be nice to share your options, i am likely to follow them since i am not used to such stuff.


---

Comment by vbraun created at 2014-09-16 23:18:35

My first stab at the IPython notebook is at #16996.

I'll have to look a bit more into the IPython zmq-based displayhook to have any suggestions for integrating it...


---

Comment by vbraun created at 2014-09-17 09:19:52

Thinking a bit about the issue, most of the graphics-related `DOCTEST_MODE` uses should just move into a special doctest-mode displayhook (that doesn't display graphics). Really, this is Python's hook for customizing the user interface, so put it there. Related: #16746


---

Comment by novoselt created at 2015-01-25 23:55:17

So - is this one "wontfix"?


---

Comment by novoselt created at 2015-01-25 23:55:17

Changing status from needs_review to needs_info.


---

Comment by novoselt created at 2015-08-22 21:39:15

Wontfix!


---

Comment by novoselt created at 2015-08-22 21:39:15

Changing status from needs_info to needs_review.


---

Comment by paulmasson created at 2016-09-20 01:31:07

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-01-21 18:03:11

Resolution: invalid
