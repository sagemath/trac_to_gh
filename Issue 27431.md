# Issue 27431: py3: fix some doctests in French book (graph and programming)

Issue created by migration from https://trac.sagemath.org/ticket/27668

Original creator: chapoton

Original creation time: 2019-04-15 13:03:25

CC:  dcoudert




---

Comment by chapoton created at 2019-04-15 13:03:50

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-04-15 13:03:50

New commits:


---

Comment by dcoudert created at 2019-04-15 13:51:03

The proposed patch fixes some doctests, but I also see this error.

```
File "src/sage/tests/books/computational-mathematics-with-sagemath/graphtheory_doctest.py", line 386, in sage.tests.books.computational-mathematics-with-sagemath.graphtheory_doctest
Failed example:
    for i in tasks:
      print("t{} assigned to {}".format(i,M.neighbors('t'+str(i))[0]))
Expected:
    t0 assigned to w2
    t1 assigned to w3
    t2 assigned to w5
    t3 assigned to w8
    t4 assigned to w1
    t5 assigned to w7
    t6 assigned to w9
    t7 assigned to w0
    t8 assigned to w4
    t9 assigned to w6
Got:
    t0 assigned to w3
    t1 assigned to w9
    t2 assigned to w5
    t3 assigned to w0
    t4 assigned to w1
    t5 assigned to w2
    t6 assigned to w8
    t7 assigned to w7
    t8 assigned to w4
    t9 assigned to w6
```

Do you want to solve it it or to postpone it for another ticket ?


---

Comment by chapoton created at 2019-04-15 13:51:24

postpone


---

Comment by dcoudert created at 2019-04-15 13:52:01

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2019-04-15 13:52:01

So then, LGTM.


---

Comment by embray created at 2019-04-15 15:27:05

Changing status from positive_review to needs_info.


---

Comment by embray created at 2019-04-15 15:27:05

What's up with this?


```diff
@@ -280,8 +280,11 @@ Sage example in ./graphtheory.tex, line 1736::
 Sage example in ./graphtheory.tex, line 1746::
 
   sage: P = Permutations(range(g.order()))
-  sage: n_colors, coloration = min(
-  ....:    greedy_coloring(g, P.random_element()) for i in range(50))
+  sage: n_colors = g.order()
+  sage: for i in range(50):
+  ....:     n_col, coloration = greedy_coloring(g, P.random_element())
+  ....:     if n_col < n_colors:
+  ....:         n_colors = n_col
   sage: n_colors
   4
```


It's not clear to me why the old code wouldn't work on Python 3.  In any case this is an ugly way to write `min(...)` so I would rather just skip this test if for some reason it doesn't work as a 1-liner.

Please in the future CC me on changes to these tests.


---

Comment by chapoton created at 2019-04-15 15:30:13

this was comparing also the second argument "coloration" with itself, which is a dict..


---

Comment by embray created at 2019-04-15 15:44:31

[min()](https://docs.python.org/2/library/functions.html#min) takes a `key` argument much like `sorted` so you can take the min while comparing just `n_colors` like `min(..., key=lambda c: c[0])`, for example.


---

Comment by git created at 2019-04-15 17:18:15

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2019-04-15 17:19:05

Changing status from needs_info to needs_review.


---

Comment by chapoton created at 2019-04-15 17:19:05

done, thx for the suggestion


---

Comment by git created at 2019-04-16 05:50:51

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2019-04-16 06:57:24

and the bot is now green


---

Comment by dcoudert created at 2019-04-16 09:09:33

Changing status from needs_review to positive_review.


---

Comment by dcoudert created at 2019-04-16 09:09:33

Right, it's much better like that.


---

Comment by embray created at 2019-04-16 11:20:04

+1 Thank you!


---

Comment by vbraun created at 2019-04-18 19:56:33

Resolution: fixed
