# Issue 27431: py3: fix some doctests in French book (graph and programming)

archive/issues_027431.json:
```json
{
    "body": "CC:  @dcoudert\n\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/27668\n\n",
    "created_at": "2019-04-15T13:03:25Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.8",
    "title": "py3: fix some doctests in French book (graph and programming)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/27431",
    "user": "https://github.com/fchapoton"
}
```
CC:  @dcoudert



Issue created by migration from https://trac.sagemath.org/ticket/27668





---

archive/issue_comments_386274.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2019-04-15T13:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386274",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_386275.json:
```json
{
    "body": "New commits:",
    "created_at": "2019-04-15T13:03:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386275",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_386276.json:
```json
{
    "body": "The proposed patch fixes some doctests, but I also see this error.\n\n```\nFile \"src/sage/tests/books/computational-mathematics-with-sagemath/graphtheory_doctest.py\", line 386, in sage.tests.books.computational-mathematics-with-sagemath.graphtheory_doctest\nFailed example:\n    for i in tasks:\n      print(\"t{} assigned to {}\".format(i,M.neighbors('t'+str(i))[0]))\nExpected:\n    t0 assigned to w2\n    t1 assigned to w3\n    t2 assigned to w5\n    t3 assigned to w8\n    t4 assigned to w1\n    t5 assigned to w7\n    t6 assigned to w9\n    t7 assigned to w0\n    t8 assigned to w4\n    t9 assigned to w6\nGot:\n    t0 assigned to w3\n    t1 assigned to w9\n    t2 assigned to w5\n    t3 assigned to w0\n    t4 assigned to w1\n    t5 assigned to w2\n    t6 assigned to w8\n    t7 assigned to w7\n    t8 assigned to w4\n    t9 assigned to w6\n```\n\nDo you want to solve it it or to postpone it for another ticket ?",
    "created_at": "2019-04-15T13:51:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386276",
    "user": "https://github.com/dcoudert"
}
```

The proposed patch fixes some doctests, but I also see this error.

```
File "src/sage/tests/books/computational-mathematics-with-sagemath/graphtheory_doctest.py", line 386, in sage.tests.books.computational-mathematics-with-sagemath.graphtheory_doctest
Failed example:
    for i in tasks:
      print("t{} assigned to {}".format(i,M.neighbors('t'+str(i))[0]))
Expected:
    t0 assigned to w2
    t1 assigned to w3
    t2 assigned to w5
    t3 assigned to w8
    t4 assigned to w1
    t5 assigned to w7
    t6 assigned to w9
    t7 assigned to w0
    t8 assigned to w4
    t9 assigned to w6
Got:
    t0 assigned to w3
    t1 assigned to w9
    t2 assigned to w5
    t3 assigned to w0
    t4 assigned to w1
    t5 assigned to w2
    t6 assigned to w8
    t7 assigned to w7
    t8 assigned to w4
    t9 assigned to w6
```

Do you want to solve it it or to postpone it for another ticket ?



---

archive/issue_comments_386277.json:
```json
{
    "body": "postpone",
    "created_at": "2019-04-15T13:51:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386277",
    "user": "https://github.com/fchapoton"
}
```

postpone



---

archive/issue_comments_386278.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-15T13:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386278",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_386279.json:
```json
{
    "body": "So then, LGTM.",
    "created_at": "2019-04-15T13:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386279",
    "user": "https://github.com/dcoudert"
}
```

So then, LGTM.



---

archive/issue_comments_386280.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2019-04-15T15:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386280",
    "user": "https://github.com/embray"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_386281.json:
```json
{
    "body": "What's up with this?\n\n\n```diff\n@@ -280,8 +280,11 @@ Sage example in ./graphtheory.tex, line 1736::\n Sage example in ./graphtheory.tex, line 1746::\n \n   sage: P = Permutations(range(g.order()))\n-  sage: n_colors, coloration = min(\n-  ....:    greedy_coloring(g, P.random_element()) for i in range(50))\n+  sage: n_colors = g.order()\n+  sage: for i in range(50):\n+  ....:     n_col, coloration = greedy_coloring(g, P.random_element())\n+  ....:     if n_col < n_colors:\n+  ....:         n_colors = n_col\n   sage: n_colors\n   4\n```\n\n\nIt's not clear to me why the old code wouldn't work on Python 3.  In any case this is an ugly way to write `min(...)` so I would rather just skip this test if for some reason it doesn't work as a 1-liner.\n\nPlease in the future CC me on changes to these tests.",
    "created_at": "2019-04-15T15:27:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386281",
    "user": "https://github.com/embray"
}
```

What's up with this?


```diff
@@ -280,8 +280,11 @@ Sage example in ./graphtheory.tex, line 1736::
 Sage example in ./graphtheory.tex, line 1746::
 
   sage: P = Permutations(range(g.order()))
-  sage: n_colors, coloration = min(
-  ....:    greedy_coloring(g, P.random_element()) for i in range(50))
+  sage: n_colors = g.order()
+  sage: for i in range(50):
+  ....:     n_col, coloration = greedy_coloring(g, P.random_element())
+  ....:     if n_col < n_colors:
+  ....:         n_colors = n_col
   sage: n_colors
   4
```


It's not clear to me why the old code wouldn't work on Python 3.  In any case this is an ugly way to write `min(...)` so I would rather just skip this test if for some reason it doesn't work as a 1-liner.

Please in the future CC me on changes to these tests.



---

archive/issue_comments_386282.json:
```json
{
    "body": "this was comparing also the second argument \"coloration\" with itself, which is a dict..",
    "created_at": "2019-04-15T15:30:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386282",
    "user": "https://github.com/fchapoton"
}
```

this was comparing also the second argument "coloration" with itself, which is a dict..



---

archive/issue_comments_386283.json:
```json
{
    "body": "[min()](https://docs.python.org/2/library/functions.html#min) takes a `key` argument much like `sorted` so you can take the min while comparing just `n_colors` like `min(..., key=lambda c: c[0])`, for example.",
    "created_at": "2019-04-15T15:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386283",
    "user": "https://github.com/embray"
}
```

[min()](https://docs.python.org/2/library/functions.html#min) takes a `key` argument much like `sorted` so you can take the min while comparing just `n_colors` like `min(..., key=lambda c: c[0])`, for example.



---

archive/issue_comments_386284.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-15T17:18:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386284",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_386285.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2019-04-15T17:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386285",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_386286.json:
```json
{
    "body": "done, thx for the suggestion",
    "created_at": "2019-04-15T17:19:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386286",
    "user": "https://github.com/fchapoton"
}
```

done, thx for the suggestion



---

archive/issue_comments_386287.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2019-04-16T05:50:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386287",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_386288.json:
```json
{
    "body": "and the bot is now green",
    "created_at": "2019-04-16T06:57:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386288",
    "user": "https://github.com/fchapoton"
}
```

and the bot is now green



---

archive/issue_comments_386289.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2019-04-16T09:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386289",
    "user": "https://github.com/dcoudert"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_386290.json:
```json
{
    "body": "Right, it's much better like that.",
    "created_at": "2019-04-16T09:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386290",
    "user": "https://github.com/dcoudert"
}
```

Right, it's much better like that.



---

archive/issue_comments_386291.json:
```json
{
    "body": "+1 Thank you!",
    "created_at": "2019-04-16T11:20:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386291",
    "user": "https://github.com/embray"
}
```

+1 Thank you!



---

archive/issue_events_068645.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2019-04-18T19:56:33Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/27431#event-68645"
}
```



---

archive/issue_comments_386292.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2019-04-18T19:56:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/27431",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/27431#issuecomment-386292",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
