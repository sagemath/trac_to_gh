# Issue 20891: Improve support for comparisons in plain Python modules

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2016-07-29 14:40:31

CC:  chapoton vdelecroix

This is meant to improve the way how plain Python modules can use `_richcmp_`.

We need access to the CPython function `PyObject_RichCompare()` which —as far as I know— is not exposed by Python. So we add a Python interface to `PyObject_RichCompare()` called `richcmp()`.


---

Comment by jdemeyer created at 2016-07-29 14:42:40

New commits:


---

Comment by jdemeyer created at 2016-07-29 14:42:40

Changing status from new to needs_review.


---

Comment by dmuthiah created at 2016-07-29 18:19:46

The function `py_rich_to_bool` had some documentation that `richcmp` lacks. And making `py_rich_to_bool` a deprecated alias of `richcmp` would be good.


---

Comment by jdemeyer created at 2016-07-30 07:55:47

Replying to [comment:3 dmuthiah]:
> And making `py_rich_to_bool` a deprecated alias of `richcmp` would be good.

The function `py_rich_to_bool` is not a public function, so I don't think we should do the trouble of deprecating it. But if you insist, I will do that.


---

Comment by vdelecroix created at 2016-07-30 17:32:51

It is not clear to me what is a public function. `py_rich_to_bool` is exactly the kind of function that is helpful for external Sage modules. Hence a deprecation seems reasonable to me.


---

Comment by jdemeyer created at 2016-08-01 08:15:29

Replying to [comment:3 dmuthiah]:
> The function `py_rich_to_bool` had some documentation that `richcmp` lacks. And making `py_rich_to_bool` a deprecated alias of `richcmp` would be good.

`py_rich_to_bool` is replaced by the existing function `rich_to_bool` and no documentation is lost. The function `richcmp()` is a new function analogous to `cmp()`.


---

Comment by chapoton created at 2016-08-01 09:39:38

Looks good.

Nevertheless, I would also prefer a deprecation for `py_rich_to_bool`.


---

Comment by git created at 2016-08-01 10:21:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by vdelecroix created at 2016-08-01 18:01:52

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-08-07 20:00:57

Resolution: fixed
