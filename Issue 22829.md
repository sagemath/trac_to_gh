# Issue 22829: sagenb update to 1.0

Issue created by migration from https://trac.sagemath.org/ticket/23066

Original creator: dimpase

Original creation time: 2017-05-24 00:18:39

CC:  jdemeyer jhpalmieri kcrisman

This is sagenb update, incorporating changes accumulating since May 2016. 

Tarball: http://users.ox.ac.uk/~coml0531/sage/sagenb-1.0.tar.bz2


---

Comment by dimpase created at 2017-05-24 00:21:01

please review!


---

Comment by dimpase created at 2017-05-24 00:21:01

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2017-05-24 22:25:47

See also #22787: do not build SageNB if `SAGE_PYTHON3=yes`. If this version fixes the Python 3 issues, then we should undo the change in #22787.


---

Comment by dimpase created at 2017-05-25 08:22:48

Replying to [comment:2 jhpalmieri]:
> See also #22787: do not build SageNB if `SAGE_PYTHON3=yes`. If this version fixes the Python 3 issues, then we should undo the change in #22787.


I propose we postpone dealing with this particular issue until Sage runs on python3.


---

Comment by dimpase created at 2017-05-25 08:32:51

I'd like to mention that after a first install of the new sagenb I sometimes have 

```
sage -t --long --warn-long 54.6 local/lib/python2.7/site-packages/sagenb/notebook/worksheet.py
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb/notebook/worksheet.py", line 477, in sagenb.notebook.worksheet.Worksheet.__lt__
Failed example:
    W1 <= W2
Expected:
    True
Got:
    False
**********************************************************************
File "local/lib/python2.7/site-packages/sagenb/notebook/worksheet.py", line 479, in sagenb.notebook.worksheet.Worksheet.__lt__
Failed example:
    W2 <= W1
Expected:
    False
Got:
    True
```

---something that I cannot reproduce after actually using sagenb.
In fact even the re-run of the same test does not reproduce it.
Not 100% sure how harmless these failures are. (I think they are harmless).


---

Comment by jdemeyer created at 2017-05-25 08:45:57

Test failures are never harmless.


---

Comment by jdemeyer created at 2017-05-25 08:45:57

Changing status from needs_review to needs_work.


---

Comment by dimpase created at 2017-05-25 08:54:40

If I reinstall the package then the test does not fail. 
Good luck debugging this, but I am not doing it.

As a workaround one can add running this test once in spkg-install and ignore its result.


---

Comment by dimpase created at 2017-05-25 08:55:52

Has anyone seen this before? I stopped paying much attention to sagenb in 2012, so I cannot recall anything.


---

Comment by dimpase created at 2017-05-25 08:55:52

Changing status from needs_work to needs_info.


---

Comment by chapoton created at 2017-05-25 15:18:05

hmm, comparison of worksheet has been changed recently (to avoid using __cmp__)

This lives in sagenb/notebook/worksheet.py

I think at least that maybe there lacks `__ne__` and maybe also `@`total_ordering ?


---

Comment by chapoton created at 2017-05-25 15:24:48

I just made a pull request on github


---

Comment by git created at 2017-05-26 11:21:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2017-05-26 11:23:56

Changing status from needs_info to needs_review.


---

Comment by dimpase created at 2017-05-26 11:23:56

OK, thanks to Frederic, the ordering of the worksheets is now fixed, and the doctests all pass too. (and the tarball is updated with these fixes, along with the checksum).


---

Comment by jhpalmieri created at 2017-06-02 20:29:54

This works for me. I haven't tested that thoroughly, but all tests pass, tests do not create the "SAGE_ROOT/home" directory any more, and the notebook seems to work. "Live" help works, too. Anyone object to a positive review?


---

Comment by jdemeyer created at 2017-06-02 20:35:37

Let me just check 2 things:

1. A rebuild from scratch (i.e. after `make distclean`)

2. That the tarball is correctly produced.


---

Comment by jdemeyer created at 2017-06-02 20:50:53

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-06-02 20:50:53

Replying to [comment:13 jdemeyer]:
> Let me just check 2 things:
> 
> 1. A rebuild from scratch (i.e. after `make distclean`)

Doing this right now...

> 2. That the tarball is correctly produced.

This is not looking good. Unless I'm missing something, the fixes mentioned in [comment:11] are _not_ in version 1.0 of SageNB. So the version number is misleading. Current SageNB master should be version 1.0.1 and then that tarball should be in Sage.


---

Comment by dimpase created at 2017-06-02 20:55:31

right, I shall bump up the version to 1.1.


---

Comment by jdemeyer created at 2017-06-02 20:57:05

If you want to use semantic versioning (not saying that you should), this is a bugfix, so it should be version 1.0.1


---

Comment by git created at 2017-06-03 07:54:39

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2017-06-03 07:56:47

here is the bumped up version, repackaged so that the tarball is made by github.


---

Comment by dimpase created at 2017-06-03 07:56:47

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2017-06-03 15:11:38

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2017-06-03 15:11:38

A git repository is not a source distribution. I suggest to use the `dist.sh` script to create the tarball.

That being said, it _might_ be possible to install from a git repository, but then

1. it should be clearly documented in `SPKG.txt`.

2. the filename should be fixed (`1.0.1.tar.gz` is not acceptable because it doesn't contain `sagenb`).


---

Comment by git created at 2017-06-03 19:43:03

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2017-06-03 19:48:11

OK, I have followed your suggestion and used `dist.sh` now.

PS. Regarding the somewhat unfortunate naming scheme for github "releases", I can only say that the tar.gz file gets renamed to the right one if you download it using a browser.


---

Comment by dimpase created at 2017-06-03 19:48:11

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2017-06-03 23:45:01

This also passes tests and works with my (cursory) usage after I built from scratch.


---

Comment by jdemeyer created at 2017-06-06 09:25:04

Replying to [comment:21 dimpase]:
> I can only say that the tar.gz file gets renamed to the right one if you download it using a browser.

My browser (GNU wget) didn't do that.


---

Comment by jdemeyer created at 2017-06-06 09:25:39

I'm testing this again...


---

Comment by jdemeyer created at 2017-06-06 12:27:53

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-06-09 18:37:51

Resolution: fixed
