# Issue 21575: Doctest failures involving pip

Issue created by migration from https://trac.sagemath.org/ticket/21812

Original creator: jdemeyer

Original creation time: 2016-11-03 19:57:02

CC:  embray vdelecroix vbraun

There are many failures which all boil down to

```
**********************************************************************
File "src/sage/misc/package.py", line 139, in sage.misc.package.pip_installed_packages
Failed example:
    d = pip_installed_packages()
Expected nothing
Got:
    You are using pip version 8.1.2, however version 9.0.0 is available.
    You should consider upgrading via the 'pip install --upgrade pip' command.
**********************************************************************
```



---

Comment by vdelecroix created at 2016-11-04 08:13:15

Luckily this appear on stderr!


---

Comment by vdelecroix created at 2016-11-04 08:16:24

Do you think we should have an option `ignore_warning`? Or `ignore_stderr`? Or something similar.


---

Comment by vdelecroix created at 2016-11-04 08:23:31

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2016-11-04 08:23:31

New commits:


---

Comment by jdemeyer created at 2016-11-04 10:52:47

There are many ways in Python to avoid the use of ugly `\"` quotes, pick one :-)


---

Comment by jdemeyer created at 2016-11-04 10:52:47

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2016-11-04 10:55:15

Besides, a _much_ better solution is simply using the `--disable-pip-version-check` argument.


---

Comment by jdemeyer created at 2016-11-04 10:57:44

Or even `pip list --no-index` which completely disables PyPI lookup.


---

Comment by jdemeyer created at 2016-11-04 11:11:16

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2016-11-04 11:11:16

Simple and better solution.
----
New commits:


---

Comment by vdelecroix created at 2016-11-04 17:39:27

Changing status from needs_review to positive_review.


---

Comment by dimpase created at 2016-11-06 19:35:42

AFAICS, pip's update allows to get rid of our patch, as they finally closed https://github.com/pypa/pip/issues/1165


---

Comment by charpent created at 2016-11-07 07:40:11

Changing status from positive_review to needs_work.


---

Comment by charpent created at 2016-11-07 07:40:11

This solution does not work but for a serial build with the included pip 8.x. See on `sage-devel` the serial novel starting at [this post](https://groups.google.com/d/msg/sage-release/OtYJUXuf2vk/zo-V9-MxAQAJ).

==> `needs_work`


---

Comment by jdemeyer created at 2016-11-07 09:28:52

Changing status from needs_work to positive_review.


---

Comment by jdemeyer created at 2016-11-07 09:29:25

Replying to [comment:11 charpent]:
> This solution does not work but for a serial build with the included pip 8.x. See on `sage-devel` the serial novel starting at [this post](https://groups.google.com/d/msg/sage-release/OtYJUXuf2vk/zo-V9-MxAQAJ).
> 
> ==> `needs_work`

That test failure is due to #15585, unrelated to this ticket.


---

Comment by vbraun created at 2016-11-07 18:27:22

Resolution: fixed
