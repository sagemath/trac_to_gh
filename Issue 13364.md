# Issue 13364: Quaternion Orders over Number Fields

archive/issues_013364.json:
```json
{
    "body": "Assignee: @aghitza\n\nCC:  schisholm @dansme\n\nKeywords: quaternion, order\n\nGeneralizes the code for quaternion orders of quaternion algebras over QQ to allow for quaternion orders of quaternion algebras over number fields.\n\nIssue created by migration from https://trac.sagemath.org/ticket/13568\n\n",
    "created_at": "2012-10-04T15:30:09Z",
    "labels": [
        "component: algebra"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Quaternion Orders over Number Fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/13364",
    "user": "https://github.com/adeines"
}
```
Assignee: @aghitza

CC:  schisholm @dansme

Keywords: quaternion, order

Generalizes the code for quaternion orders of quaternion algebras over QQ to allow for quaternion orders of quaternion algebras over number fields.

Issue created by migration from https://trac.sagemath.org/ticket/13568





---

archive/issue_comments_164011.json:
```json
{
    "body": "Attachment [Trac13569_quaternion_orders.patch](tarball://root/attachments/some-uuid/ticket13568/Trac13569_quaternion_orders.patch) by @adeines created at 2012-10-04 17:12:54",
    "created_at": "2012-10-04T17:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164011",
    "user": "https://github.com/adeines"
}
```

Attachment [Trac13569_quaternion_orders.patch](tarball://root/attachments/some-uuid/ticket13568/Trac13569_quaternion_orders.patch) by @adeines created at 2012-10-04 17:12:54



---

archive/issue_comments_164012.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-10-04T17:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164012",
    "user": "https://github.com/adeines"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_164013.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-11-09T18:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164013",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_events_037766.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13364#event-37766"
}
```



---

archive/issue_events_037767.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13364#event-37767"
}
```



---

archive/issue_events_037768.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13364#event-37768"
}
```



---

archive/issue_events_037769.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13364#event-37769"
}
```



---

archive/issue_events_037770.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13364#event-37770"
}
```



---

archive/issue_events_037771.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13364#event-37771"
}
```



---

archive/issue_events_037772.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/13364#event-37772"
}
```



---

archive/issue_comments_164014.json:
```json
{
    "body": "Rebased the patch to sage-6.4.beta1 and moved to git",
    "created_at": "2014-08-26T11:59:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164014",
    "user": "https://github.com/tornaria"
}
```

Rebased the patch to sage-6.4.beta1 and moved to git



---

archive/issue_comments_164015.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-26T16:12:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164015",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_164016.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-27T14:42:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164016",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_164017.json:
```json
{
    "body": "I've pushed a bunch of reviewer commits, the log explains them (esp f824306).\n\nThere's still a bug, namely when the base field is QQ and a pseudo-basis is given, the current code will just ignore the ideals.",
    "created_at": "2014-08-27T15:13:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164017",
    "user": "https://github.com/tornaria"
}
```

I've pushed a bunch of reviewer commits, the log explains them (esp f824306).

There's still a bug, namely when the base field is QQ and a pseudo-basis is given, the current code will just ignore the ideals.



---

archive/issue_comments_164018.json:
```json
{
    "body": "Okay.  I'll get on that.",
    "created_at": "2014-08-27T15:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164018",
    "user": "https://github.com/adeines"
}
```

Okay.  I'll get on that.



---

archive/issue_comments_164019.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-08-27T15:14:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164019",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_164020.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-27T23:20:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164020",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_164021.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-27T23:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164021",
    "user": "https://github.com/tornaria"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_164022.json:
```json
{
    "body": "I'm happy with this now. Since I made a lot of changes I'm leaving it as *needs_review*.",
    "created_at": "2014-08-27T23:27:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164022",
    "user": "https://github.com/tornaria"
}
```

I'm happy with this now. Since I made a lot of changes I'm leaving it as *needs_review*.



---

archive/issue_comments_164023.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-29T09:09:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164023",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_164024.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-29T12:44:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164024",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_164025.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-06T21:57:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164025",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_164026.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-12T13:21:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164026",
    "user": "https://github.com/mmasdeu"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_164027.json:
```json
{
    "body": "I started reviewing it, and made some changes. Some are to make it more pythonic, some are for clarity.\n\nI've set it to needs_work because the patch fails when using quaternion algebras not defined over number fields:\n\n```\nsage: A.<i,j,k> = QuaternionAlgebra(ZZ['x'].fraction_field(),-1,-1)\nsage: A.quaternion_order([1,i,j,k])                                \n---------------------------------------------------------------------------\nUnboundLocalError                         Traceback (most recent call last)\n...\nUnboundLocalError: local variable 'M1' referenced before assignment\n```\n",
    "created_at": "2014-09-12T13:23:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164027",
    "user": "https://github.com/mmasdeu"
}
```

I started reviewing it, and made some changes. Some are to make it more pythonic, some are for clarity.

I've set it to needs_work because the patch fails when using quaternion algebras not defined over number fields:

```
sage: A.<i,j,k> = QuaternionAlgebra(ZZ['x'].fraction_field(),-1,-1)
sage: A.quaternion_order([1,i,j,k])                                
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)
...
UnboundLocalError: local variable 'M1' referenced before assignment
```




---

archive/issue_comments_164028.json:
```json
{
    "body": "Just a remark: this functionality is in PARI now, so you could just try to wrap PARI.",
    "created_at": "2015-05-30T10:32:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164028",
    "user": "https://github.com/jdemeyer"
}
```

Just a remark: this functionality is in PARI now, so you could just try to wrap PARI.



---

archive/issue_comments_164029.json:
```json
{
    "body": "With Marc Masdeu, we checked that this is still compiling after rebasing on develop. We intend to have a look at this ticket.\n----\nLast 10 new commits:",
    "created_at": "2017-03-02T23:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/13364",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/13364#issuecomment-164029",
    "user": "https://trac.sagemath.org/admin/accounts/users/aurel"
}
```

With Marc Masdeu, we checked that this is still compiling after rebasing on develop. We intend to have a look at this ticket.
----
Last 10 new commits:
