# Issue 11126: Extend the capabilities of Sage's introspection

archive/issues_011126.json:
```json
{
    "body": "Assignee: @jasongrout\n\nCC:  @johanrosenkilde @nthiery @saliola\n\nKeywords: edit sageinspect\n\nThe following used to fail:\n\n\n```\nsage: x??\nError getting source: could not find class definition\nsage: P.<x,y> = QQ[]\nsage: P??\nError getting source: could not find class definition\nsage: I??\nError getting source: could not find class definition\n```\n\n\nSimilarly, the edit command did not work in these case.\n\nWith my patch, all that works. Moreover, both sage.misc.edit_module and sage.misc.sageinspect are put into the reference manual.\n\nNote that this may be related with #11287: `sage.misc.sage_getfile` and `sage_getsourcelines` could be a reliable tool to get information on how and from where to import a given object. Therefore Cc to the participants of that ticket.\n\nMoreover, Cc to #9976. Reason:\n\nDepends on #9976\n\nIssue created by migration from https://trac.sagemath.org/ticket/11298\n\n",
    "created_at": "2011-05-05T09:28:13Z",
    "labels": [
        "component: misc",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.2",
    "title": "Extend the capabilities of Sage's introspection",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11126",
    "user": "https://github.com/simon-king-jena"
}
```
Assignee: @jasongrout

CC:  @johanrosenkilde @nthiery @saliola

Keywords: edit sageinspect

The following used to fail:


```
sage: x??
Error getting source: could not find class definition
sage: P.<x,y> = QQ[]
sage: P??
Error getting source: could not find class definition
sage: I??
Error getting source: could not find class definition
```


Similarly, the edit command did not work in these case.

With my patch, all that works. Moreover, both sage.misc.edit_module and sage.misc.sageinspect are put into the reference manual.

Note that this may be related with #11287: `sage.misc.sage_getfile` and `sage_getsourcelines` could be a reliable tool to get information on how and from where to import a given object. Therefore Cc to the participants of that ticket.

Moreover, Cc to #9976. Reason:

Depends on #9976

Issue created by migration from https://trac.sagemath.org/ticket/11298





---

archive/issue_comments_121499.json:
```json
{
    "body": "For the patchbot:\n\nDepends on #9976",
    "created_at": "2011-05-05T09:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121499",
    "user": "https://github.com/simon-king-jena"
}
```

For the patchbot:

Depends on #9976



---

archive/issue_comments_121500.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-05-05T09:32:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121500",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_121501.json:
```json
{
    "body": "Correcting a misspelling.\n\nDepends on #9976",
    "created_at": "2011-05-05T10:10:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121501",
    "user": "https://github.com/simon-king-jena"
}
```

Correcting a misspelling.

Depends on #9976



---

archive/issue_comments_121502.json:
```json
{
    "body": "Note that, with the patch, `functools.partial` objects can be reasonably edited as well:\n\n```\nedit(sage.combinat.partition_algebra.SetPartitionsAk,'vim')\n```\n\nopens vim at line 31 of sage/combinat/partition_algebra.py:\n\n```\ndef create_set_partition_function(letter, k):\n    \"\"\"\n    EXAMPLES::\n    \n        sage: from sage.combinat.partition_algebra import create_set_partition_function\n        sage: create_set_partition_function('A', 3)\n        Set partitions of {1, ..., 3, -1, ..., -3}\n    \"\"\"\n    from sage.functions.all import floor\n    if isinstance(k, (int, Integer)):\n        if k > 0:\n            return globals()['SetPartitions' + letter + 'k_k'](k)\n    elif is_RealNumber(k):\n        if k - math.floor(k) == 0.5:\n            return globals()['SetPartitions' + letter + 'khalf_k'](floor(k))\n\n    raise ValueError, \"k must be an integer or an integer + 1/2\"\n```\n\nand indeed that is the underlying definition of `SetPartitionsAk`; see line 53, which is\n\n```\nSetPartitionsAk = functools.partial(create_set_partition_function,\"A\")\n```\n",
    "created_at": "2011-05-05T12:16:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121502",
    "user": "https://github.com/simon-king-jena"
}
```

Note that, with the patch, `functools.partial` objects can be reasonably edited as well:

```
edit(sage.combinat.partition_algebra.SetPartitionsAk,'vim')
```

opens vim at line 31 of sage/combinat/partition_algebra.py:

```
def create_set_partition_function(letter, k):
    """
    EXAMPLES::
    
        sage: from sage.combinat.partition_algebra import create_set_partition_function
        sage: create_set_partition_function('A', 3)
        Set partitions of {1, ..., 3, -1, ..., -3}
    """
    from sage.functions.all import floor
    if isinstance(k, (int, Integer)):
        if k > 0:
            return globals()['SetPartitions' + letter + 'k_k'](k)
    elif is_RealNumber(k):
        if k - math.floor(k) == 0.5:
            return globals()['SetPartitions' + letter + 'khalf_k'](floor(k))

    raise ValueError, "k must be an integer or an integer + 1/2"
```

and indeed that is the underlying definition of `SetPartitionsAk`; see line 53, which is

```
SetPartitionsAk = functools.partial(create_set_partition_function,"A")
```




---

archive/issue_comments_121503.json:
```json
{
    "body": "I found one more case where source code inspection failed: the (lib)singular_standard_options wrapper.\n\nWith the new patch, we have\n\n```\nsage: P.<x,y> = QQ[]\nsage: I = P*[x,y]\nsage: edit(I.interreduced_basis,'vim')\n    ...\n    @singular_standard_options\n    @libsingular_standard_options\n    def interreduced_basis(self):\n        r\"\"\"\n        If this ideal is spanned by `(f_1, ..., f_n)` this method\n        returns `(g_1, ..., g_s)` such that:\n        \n        - `(f_1,...,f_n) = (g_1,...,g_s)`\n        \n        - `LT(g_i) != LT(g_j)` for all `i != j`\n   ...\n```\n\nwhich would previously just show the code of the wrapper, not of the wrapped method.\n\nI wonder why the patchbot complains. In particular, why does the patchbot mention my patch from trac ticket #11115 - it shouldn't be a dependency, or should it? Let's see.\n\nFor now:\n\nDepends on #9976",
    "created_at": "2011-05-05T13:23:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121503",
    "user": "https://github.com/simon-king-jena"
}
```

I found one more case where source code inspection failed: the (lib)singular_standard_options wrapper.

With the new patch, we have

```
sage: P.<x,y> = QQ[]
sage: I = P*[x,y]
sage: edit(I.interreduced_basis,'vim')
    ...
    @singular_standard_options
    @libsingular_standard_options
    def interreduced_basis(self):
        r"""
        If this ideal is spanned by `(f_1, ..., f_n)` this method
        returns `(g_1, ..., g_s)` such that:
        
        - `(f_1,...,f_n) = (g_1,...,g_s)`
        
        - `LT(g_i) != LT(g_j)` for all `i != j`
   ...
```

which would previously just show the code of the wrapper, not of the wrapped method.

I wonder why the patchbot complains. In particular, why does the patchbot mention my patch from trac ticket #11115 - it shouldn't be a dependency, or should it? Let's see.

For now:

Depends on #9976



---

archive/issue_comments_121504.json:
```json
{
    "body": "I just verified: In my patch queue, the patches from #11115 come *after* [attachment:trac11298_introspection_and_edit.patch]\n\nIn other words, the behaviour of the patchbot seems very strange to me.",
    "created_at": "2011-05-05T13:28:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121504",
    "user": "https://github.com/simon-king-jena"
}
```

I just verified: In my patch queue, the patches from #11115 come *after* [attachment:trac11298_introspection_and_edit.patch]

In other words, the behaviour of the patchbot seems very strange to me.



---

archive/issue_comments_121505.json:
```json
{
    "body": "I still think that the patchbot goofed it, but I did as well: The old version of the second patch would really be on top of #11115 (but not the first). I was just updating it, so that we have:\n\nDepends on #9976\n\nand nothing else. Could be that I need to fix some tests, though...",
    "created_at": "2011-05-05T13:40:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121505",
    "user": "https://github.com/simon-king-jena"
}
```

I still think that the patchbot goofed it, but I did as well: The old version of the second patch would really be on top of #11115 (but not the first). I was just updating it, so that we have:

Depends on #9976

and nothing else. Could be that I need to fix some tests, though...



---

archive/issue_comments_121506.json:
```json
{
    "body": "Adding \"r\" to one doc string (for making the documentation nicely formatted) and correcting one doc test.\n\nThe tests in sage.misc and in sage.rings.polynomial all pass. Next, I'll run long tests.\n\nDepends on #9976",
    "created_at": "2011-05-05T13:54:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121506",
    "user": "https://github.com/simon-king-jena"
}
```

Adding "r" to one doc string (for making the documentation nicely formatted) and correcting one doc test.

The tests in sage.misc and in sage.rings.polynomial all pass. Next, I'll run long tests.

Depends on #9976



---

archive/issue_comments_121507.json:
```json
{
    "body": "I'll try to trigger the patchbot by changing to \"needs work\"...",
    "created_at": "2011-05-05T14:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121507",
    "user": "https://github.com/simon-king-jena"
}
```

I'll try to trigger the patchbot by changing to "needs work"...



---

archive/issue_comments_121508.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-05T14:22:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121508",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_121509.json:
```json
{
    "body": "... and returning to needs review...\n\nDepends on #9976",
    "created_at": "2011-05-05T14:23:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121509",
    "user": "https://github.com/simon-king-jena"
}
```

... and returning to needs review...

Depends on #9976



---

archive/issue_comments_121510.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-05T14:23:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121510",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_121511.json:
```json
{
    "body": "Extend the capabilities of introspection and interactive source code edition",
    "created_at": "2011-05-05T14:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121511",
    "user": "https://github.com/simon-king-jena"
}
```

Extend the capabilities of introspection and interactive source code edition



---

archive/issue_comments_121512.json:
```json
{
    "body": "Attachment [trac11298_introspection_and_edit.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_introspection_and_edit.patch) by @simon-king-jena created at 2011-05-05 14:25:51\n\nOK, that did not help. Hence, I submitted the patches again. I wish the red blob would finally vanish!\n\nDepends on #9976",
    "created_at": "2011-05-05T14:25:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121512",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment [trac11298_introspection_and_edit.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_introspection_and_edit.patch) by @simon-king-jena created at 2011-05-05 14:25:51

OK, that did not help. Hence, I submitted the patches again. I wish the red blob would finally vanish!

Depends on #9976



---

archive/issue_comments_121513.json:
```json
{
    "body": "Ooops, I forgot that since recently there is a form field in which to state dependencies. Let's try it!",
    "created_at": "2011-05-05T14:28:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121513",
    "user": "https://github.com/simon-king-jena"
}
```

Ooops, I forgot that since recently there is a form field in which to state dependencies. Let's try it!



---

archive/issue_comments_121514.json:
```json
{
    "body": "FWIW, long tests pass for me, and I believe that the patchbot has a serious flaw if it can not even deal with a single dependency.",
    "created_at": "2011-05-05T18:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121514",
    "user": "https://github.com/simon-king-jena"
}
```

FWIW, long tests pass for me, and I believe that the patchbot has a serious flaw if it can not even deal with a single dependency.



---

archive/issue_comments_121515.json:
```json
{
    "body": "Now I understand what the patchbot is doing (resp. not doing): It believes that #9976 does not need to be applied, since it is merged. But it does not understand that #9976 is merged in 4.7.1.alpha0, not in 4.7.rc1 (which is what it is starting with).",
    "created_at": "2011-05-07T19:59:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121515",
    "user": "https://github.com/simon-king-jena"
}
```

Now I understand what the patchbot is doing (resp. not doing): It believes that #9976 does not need to be applied, since it is merged. But it does not understand that #9976 is merged in 4.7.1.alpha0, not in 4.7.rc1 (which is what it is starting with).



---

archive/issue_comments_121516.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-05-25T14:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121516",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_121517.json:
```json
{
    "body": "I noticed that building the documentation crashes when the second patch is applied. It is as follows:\n\n\n```\nRunning Sphinx v1.0.4\nloading pickled environment... done\nbuilding [html]: targets for 39 source files that are out of date\nupdating environment: 0 added, 39 changed, 0 removed\nreading sources... [ 33%] sage/rings/polynomial/multi_polynomial_ideal_libsingular                           \nException occurred:\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/config.py\", line 207, in __getattr__\n    raise AttributeError('No such config value: %s' % name)\nAttributeError: No such config value: autodoc_default_flags\nThe full traceback has been saved in /tmp/sphinx-err-1tNBmd.log, if you want to report the issue to the developers.\nPlease also report this if it was a user error, so that a better error message can be provided next time.\nEither send bugs to the mailing list at <http://groups.google.com/group/sphinx-dev/>,\nor report them in the tracker at <http://bitbucket.org/birkenfeld/sphinx/issues/>. Thanks!\nBuild finished.  The built documents can be found in /mnt/local/king/SAGE/sage-4.7.rc2/devel/sage/doc/output/html/en/reference\n```\n\n\nand the traceback is\n\n```\n# Sphinx version: 1.0.4\n# Docutils version: 0.5 release\n# Jinja2 version: 2.5.5\nTraceback (most recent call last):\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/cmdline.py\", line 173, in main\n    app.build(force_all, filenames)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/application.py\", line 207, in build\n    self.builder.build_update()\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/builders/__init__.py\", line 198, in build_update\n    'out of date' % len(to_build))\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/builders/__init__.py\", line 218, in build\n    purple, length):\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/builders/__init__.py\", line 120, in status_iterator\n    for item in iterable:\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/environment.py\", line 518, in update_generator\n    self.read_doc(docname, app=app)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/environment.py\", line 658, in read_doc\n    pub.publish()\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/core.py\", line 204, in publish\n    self.settings)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/readers/__init__.py\", line 69, in read\n    self.parse()\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/readers/__init__.py\", line 75, in parse\n    self.parser.parse(self.input, document)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/__init__.py\", line 157, in parse\n    self.statemachine.run(inputlines, document, inliner=self.inliner)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 170, in run\n    input_source=document['source'])\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py\", line 232, in run\n    context, state, transitions)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py\", line 420, in check_line\n    return method(match, context, next_state)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 2658, in underline\n    self.section(title, source, style, lineno - 1, messages)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 308, in section\n    self.new_subsection(title, lineno, messages)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 376, in new_subsection\n    node=section_node, match_titles=1)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 266, in nested_parse\n    node=node, match_titles=match_titles)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 195, in run\n    results = StateMachineWS.run(self, input_lines, input_offset)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py\", line 232, in run\n    context, state, transitions)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py\", line 420, in check_line\n    return method(match, context, next_state)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 2241, in explicit_markup\n    self.explicit_list(blank_finish)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 2269, in explicit_list\n    match_titles=self.state_machine.match_titles)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 300, in nested_list_parse\n    node=node, match_titles=match_titles)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 195, in run\n    results = StateMachineWS.run(self, input_lines, input_offset)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py\", line 232, in run\n    context, state, transitions)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py\", line 420, in check_line\n    return method(match, context, next_state)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 2542, in explicit_markup\n    nodelist, blank_finish = self.explicit_construct(match)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 2251, in explicit_construct\n    return method(self, expmatch)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 1994, in directive\n    directive_class, match, type_name, option_presets)\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py\", line 2043, in run_directive\n    result = directive_instance.run()\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/ext/autodoc.py\", line 1154, in run\n    if flag in self.env.config.autodoc_default_flags and \\\n  File \"/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/config.py\", line 207, in __getattr__\n    raise AttributeError('No such config value: %s' % name)\nAttributeError: No such config value: autodoc_default_flags\n```\n\n\nI have no idea how this can be debugged.",
    "created_at": "2011-05-25T14:00:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121517",
    "user": "https://github.com/simon-king-jena"
}
```

I noticed that building the documentation crashes when the second patch is applied. It is as follows:


```
Running Sphinx v1.0.4
loading pickled environment... done
building [html]: targets for 39 source files that are out of date
updating environment: 0 added, 39 changed, 0 removed
reading sources... [ 33%] sage/rings/polynomial/multi_polynomial_ideal_libsingular                           
Exception occurred:
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/config.py", line 207, in __getattr__
    raise AttributeError('No such config value: %s' % name)
AttributeError: No such config value: autodoc_default_flags
The full traceback has been saved in /tmp/sphinx-err-1tNBmd.log, if you want to report the issue to the developers.
Please also report this if it was a user error, so that a better error message can be provided next time.
Either send bugs to the mailing list at <http://groups.google.com/group/sphinx-dev/>,
or report them in the tracker at <http://bitbucket.org/birkenfeld/sphinx/issues/>. Thanks!
Build finished.  The built documents can be found in /mnt/local/king/SAGE/sage-4.7.rc2/devel/sage/doc/output/html/en/reference
```


and the traceback is

```
# Sphinx version: 1.0.4
# Docutils version: 0.5 release
# Jinja2 version: 2.5.5
Traceback (most recent call last):
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/cmdline.py", line 173, in main
    app.build(force_all, filenames)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/application.py", line 207, in build
    self.builder.build_update()
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/builders/__init__.py", line 198, in build_update
    'out of date' % len(to_build))
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/builders/__init__.py", line 218, in build
    purple, length):
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/builders/__init__.py", line 120, in status_iterator
    for item in iterable:
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/environment.py", line 518, in update_generator
    self.read_doc(docname, app=app)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/environment.py", line 658, in read_doc
    pub.publish()
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/core.py", line 204, in publish
    self.settings)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/readers/__init__.py", line 69, in read
    self.parse()
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/readers/__init__.py", line 75, in parse
    self.parser.parse(self.input, document)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/__init__.py", line 157, in parse
    self.statemachine.run(inputlines, document, inliner=self.inliner)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 170, in run
    input_source=document['source'])
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py", line 232, in run
    context, state, transitions)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py", line 420, in check_line
    return method(match, context, next_state)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 2658, in underline
    self.section(title, source, style, lineno - 1, messages)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 308, in section
    self.new_subsection(title, lineno, messages)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 376, in new_subsection
    node=section_node, match_titles=1)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 266, in nested_parse
    node=node, match_titles=match_titles)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 195, in run
    results = StateMachineWS.run(self, input_lines, input_offset)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py", line 232, in run
    context, state, transitions)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py", line 420, in check_line
    return method(match, context, next_state)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 2241, in explicit_markup
    self.explicit_list(blank_finish)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 2269, in explicit_list
    match_titles=self.state_machine.match_titles)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 300, in nested_list_parse
    node=node, match_titles=match_titles)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 195, in run
    results = StateMachineWS.run(self, input_lines, input_offset)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py", line 232, in run
    context, state, transitions)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/statemachine.py", line 420, in check_line
    return method(match, context, next_state)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 2542, in explicit_markup
    nodelist, blank_finish = self.explicit_construct(match)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 2251, in explicit_construct
    return method(self, expmatch)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 1994, in directive
    directive_class, match, type_name, option_presets)
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/docutils/parsers/rst/states.py", line 2043, in run_directive
    result = directive_instance.run()
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/ext/autodoc.py", line 1154, in run
    if flag in self.env.config.autodoc_default_flags and \
  File "/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/Sphinx-1.0.4-py2.6.egg/sphinx/config.py", line 207, in __getattr__
    raise AttributeError('No such config value: %s' % name)
AttributeError: No such config value: autodoc_default_flags
```


I have no idea how this can be debugged.



---

archive/issue_comments_121518.json:
```json
{
    "body": "Perhaps it would be worth while to follow a more conceptual approach.\n\nCurrently, `singular_standard_options` and `magma_standard_options` applied to a method `func` simply return a function `wrapper`, that does not know about `func` (except its doc string, but I think that's a bad idea as well since copying that string costs time). So, introspection does not work. I tried to provide `wrapper` with the tools needed to make it work, but apparently it was not so easy.\n\nBut there is the `sage_wraps` factory, and I think I should try to use it!",
    "created_at": "2011-05-26T06:03:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121518",
    "user": "https://github.com/simon-king-jena"
}
```

Perhaps it would be worth while to follow a more conceptual approach.

Currently, `singular_standard_options` and `magma_standard_options` applied to a method `func` simply return a function `wrapper`, that does not know about `func` (except its doc string, but I think that's a bad idea as well since copying that string costs time). So, introspection does not work. I tried to provide `wrapper` with the tools needed to make it work, but apparently it was not so easy.

But there is the `sage_wraps` factory, and I think I should try to use it!



---

archive/issue_comments_121519.json:
```json
{
    "body": "Introspection for sage.misc.decorators.sage_wraps, applied for singular_standard_options. Put decorators into references.",
    "created_at": "2011-05-26T07:08:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121519",
    "user": "https://github.com/simon-king-jena"
}
```

Introspection for sage.misc.decorators.sage_wraps, applied for singular_standard_options. Put decorators into references.



---

archive/issue_comments_121520.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-26T07:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121520",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_121521.json:
```json
{
    "body": "Attachment [trac11298_singular_standard_options.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_singular_standard_options.patch) by @simon-king-jena created at 2011-05-26 07:11:56\n\nThe second patch has now been updated.\n\nThe problem seems solved: I touched all files in sage/rings/polynomial, did `sage -b` and then built the documentation without problem.\n\nMoreover, I fixed some syntax error in the documentation, and I've put sage.misc.decorators into the reference manual.\n\nSo, it is needing review again!",
    "created_at": "2011-05-26T07:11:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121521",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment [trac11298_singular_standard_options.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_singular_standard_options.patch) by @simon-king-jena created at 2011-05-26 07:11:56

The second patch has now been updated.

The problem seems solved: I touched all files in sage/rings/polynomial, did `sage -b` and then built the documentation without problem.

Moreover, I fixed some syntax error in the documentation, and I've put sage.misc.decorators into the reference manual.

So, it is needing review again!



---

archive/issue_comments_121522.json:
```json
{
    "body": "Attachment [trac11298_singular_standard_options.rebase4.7.1.a1.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_singular_standard_options.rebase4.7.1.a1.patch) by @burcin created at 2011-06-07 21:10:30\n\nrebased Simon's patch to 4.7.1.alpha1",
    "created_at": "2011-06-07T21:10:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121522",
    "user": "https://github.com/burcin"
}
```

Attachment [trac11298_singular_standard_options.rebase4.7.1.a1.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_singular_standard_options.rebase4.7.1.a1.patch) by @burcin created at 2011-06-07 21:10:30

rebased Simon's patch to 4.7.1.alpha1



---

archive/issue_comments_121523.json:
```json
{
    "body": "Thank you, Burcin!\n\nFor the patchbot, that seems to ignore the ticket description:\n\nApply trac11298_introspection_and_edit.patch, trac11298_singular_standard_options.rebase4.7.1.a1.patch",
    "created_at": "2011-06-08T06:24:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121523",
    "user": "https://github.com/simon-king-jena"
}
```

Thank you, Burcin!

For the patchbot, that seems to ignore the ticket description:

Apply trac11298_introspection_and_edit.patch, trac11298_singular_standard_options.rebase4.7.1.a1.patch



---

archive/issue_comments_121524.json:
```json
{
    "body": "This looks pretty good to me.  I have one question: in `sage_getsourcelines`, lines 1408-1411, you have the code\n\n```python\n            except IOError:\n                if obj.__class__ != type:\n                    return sage_getsourcelines(obj.__class__)\n                raise\n```\n\nWhat is `type` here?  Can you give me an example which will reach this code?",
    "created_at": "2011-07-20T19:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121524",
    "user": "https://github.com/jhpalmieri"
}
```

This looks pretty good to me.  I have one question: in `sage_getsourcelines`, lines 1408-1411, you have the code

```python
            except IOError:
                if obj.__class__ != type:
                    return sage_getsourcelines(obj.__class__)
                raise
```

What is `type` here?  Can you give me an example which will reach this code?



---

archive/issue_comments_121525.json:
```json
{
    "body": "(Is it just the built-in Python `type` function?)",
    "created_at": "2011-07-20T19:52:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121525",
    "user": "https://github.com/jhpalmieri"
}
```

(Is it just the built-in Python `type` function?)



---

archive/issue_comments_121526.json:
```json
{
    "body": "Replying to [comment:20 jhpalmieri]:\n> This looks pretty good to me.  I have one question: in `sage_getsourcelines`, lines 1408-1411, you have the code\n> ...\n>\n> What is `type` here?  Can you give me an example which will reach this code?\n\nBy `type`, I mean the type `type`, such as here:\n\n```\nsage: 1.__class__\n<type 'sage.rings.integer.Integer'>\nsage: 1.__class__.__class__\n<type 'type'>\n```\n\n\nThe idea of the code lines in question is as follows:\n\nLet `obj` be the object whose source lines we want to determine. It is not necessarily true that the correct source lines for `obj` coincide with the source lines of its class (notorious counter example: decorated methods). Therefore, we need to try harder.\n\n- First, it is attempted to get the position of the source code from what `inspect.getdoc` returns (lines 1400-1401)\n\n- Second (if \"first\" fails), the same is attempted with what `_sage_getdoc_unformatted` returns (lines 1403-1404). For a reason that I don't understand, one can not replace the first step by the second step: The comment that I inserted states that a mysterious import error would occur at startup.\n\n- Third (if \"second\" fails as well), it is tested whether the inspect module can provide the source lines of the object `obj` (line 1407).\n\n- Last resort (if \"third\" fails), we replace `obj` by `obj.__class__`. That is not desired for decorated methods, but these are supposed to provide the source lines in a different way, so that one of the first three methods should succeed. I think as  a last resort it is ok... (line 1410).\n\nThere is one obvious problem with the \"last resort\". If the source lines of `obj.__class__` can not be found (e.g., if `obj.__class__` is defined in an spkg, not in the Sage library) then as a last resort one would try to get  `obj.__class__.__class__`, but that is the type `type` (see example above), which is defined in the Python spkg and can thus not be found. Infinite recursion.\n\nIn order to avoid the infinite recursion, an error is raised if `obj.__class__` is the type `type`, which is, in particular, the case if `obj` is not a class instance but a class.\n\nI hope that answers your question...",
    "created_at": "2011-07-20T20:51:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121526",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:20 jhpalmieri]:
> This looks pretty good to me.  I have one question: in `sage_getsourcelines`, lines 1408-1411, you have the code
> ...
>
> What is `type` here?  Can you give me an example which will reach this code?

By `type`, I mean the type `type`, such as here:

```
sage: 1.__class__
<type 'sage.rings.integer.Integer'>
sage: 1.__class__.__class__
<type 'type'>
```


The idea of the code lines in question is as follows:

Let `obj` be the object whose source lines we want to determine. It is not necessarily true that the correct source lines for `obj` coincide with the source lines of its class (notorious counter example: decorated methods). Therefore, we need to try harder.

- First, it is attempted to get the position of the source code from what `inspect.getdoc` returns (lines 1400-1401)

- Second (if "first" fails), the same is attempted with what `_sage_getdoc_unformatted` returns (lines 1403-1404). For a reason that I don't understand, one can not replace the first step by the second step: The comment that I inserted states that a mysterious import error would occur at startup.

- Third (if "second" fails as well), it is tested whether the inspect module can provide the source lines of the object `obj` (line 1407).

- Last resort (if "third" fails), we replace `obj` by `obj.__class__`. That is not desired for decorated methods, but these are supposed to provide the source lines in a different way, so that one of the first three methods should succeed. I think as  a last resort it is ok... (line 1410).

There is one obvious problem with the "last resort". If the source lines of `obj.__class__` can not be found (e.g., if `obj.__class__` is defined in an spkg, not in the Sage library) then as a last resort one would try to get  `obj.__class__.__class__`, but that is the type `type` (see example above), which is defined in the Python spkg and can thus not be found. Infinite recursion.

In order to avoid the infinite recursion, an error is raised if `obj.__class__` is the type `type`, which is, in particular, the case if `obj` is not a class instance but a class.

I hope that answers your question...



---

archive/issue_comments_121527.json:
```json
{
    "body": "Replying to [comment:20 jhpalmieri]:\n> What is `type` here?  Can you give me an example which will reach this code?\n\nA concrete example (using the meataxe wrapper from my cohomology spkg):\n\n```\nsage: from sage.misc.sageinspect import sage_getsourcelines\nsage: from pGroupCohomology.mtx import MTX\nsage: M = MTX(5,[[1,2],[3,4]])\nsage: sage_getsourcelines(M)\n---------------------------------------------------------------------------\nIOError                                   Traceback (most recent call last)\n\n/home/king/<ipython console> in <module>()\n\n/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/sage/misc/sageinspect.pyc in sage_getsourcelines(obj, is_binary)\n   1407         if pos is None:\n   1408             try:\n-> 1409                 return inspect.getsourcelines(obj)\n   1410             except IOError:\n   1411                 if obj.__class__ != type:\n\n/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python/inspect.pyc in getsourcelines(object)\n    676     original source file the first line of code was found.  An IOError is\n    677     raised if the source code cannot be retrieved.\"\"\"\n--> 678     lines, lnum = findsource(object)\n    679\n    680     if ismodule(object): return lines, 0\n\n/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/IPython/ultraTB.pyc in findsource(object)\n    175             return lines, candidates[0][1]\n    176         else:\n--> 177             raise IOError('could not find class definition')\n    178\n    179     if ismethod(object):\n\nIOError: could not find class definition\n```\n\n\nSince `M` can not provide its source lines, the source lines of `M.__class__` (i.e., of `MTX`) are sought.\n\nSince the source lines of `MTX` can not be found (with the first three methods), the inspect module raises a `IOError`. It is caught, but reraised, since `MTX.__class__` is the type `type` and hence an infinite recursion must be prevented.",
    "created_at": "2011-07-20T21:06:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121527",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:20 jhpalmieri]:
> What is `type` here?  Can you give me an example which will reach this code?

A concrete example (using the meataxe wrapper from my cohomology spkg):

```
sage: from sage.misc.sageinspect import sage_getsourcelines
sage: from pGroupCohomology.mtx import MTX
sage: M = MTX(5,[[1,2],[3,4]])
sage: sage_getsourcelines(M)
---------------------------------------------------------------------------
IOError                                   Traceback (most recent call last)

/home/king/<ipython console> in <module>()

/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/sage/misc/sageinspect.pyc in sage_getsourcelines(obj, is_binary)
   1407         if pos is None:
   1408             try:
-> 1409                 return inspect.getsourcelines(obj)
   1410             except IOError:
   1411                 if obj.__class__ != type:

/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python/inspect.pyc in getsourcelines(object)
    676     original source file the first line of code was found.  An IOError is
    677     raised if the source code cannot be retrieved."""
--> 678     lines, lnum = findsource(object)
    679
    680     if ismodule(object): return lines, 0

/mnt/local/king/SAGE/sage-4.7.rc2/local/lib/python2.6/site-packages/IPython/ultraTB.pyc in findsource(object)
    175             return lines, candidates[0][1]
    176         else:
--> 177             raise IOError('could not find class definition')
    178
    179     if ismethod(object):

IOError: could not find class definition
```


Since `M` can not provide its source lines, the source lines of `M.__class__` (i.e., of `MTX`) are sought.

Since the source lines of `MTX` can not be found (with the first three methods), the inspect module raises a `IOError`. It is caught, but reraised, since `MTX.__class__` is the type `type` and hence an infinite recursion must be prevented.



---

archive/issue_comments_121528.json:
```json
{
    "body": "Okay, I'm happy with this.  I'm attaching a referee's patch with a few small changes.  If you're happy with my changes, please switch the ticket to \"positive review\".\n\nThis makes a very nice companion to #9976.",
    "created_at": "2011-07-20T21:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121528",
    "user": "https://github.com/jhpalmieri"
}
```

Okay, I'm happy with this.  I'm attaching a referee's patch with a few small changes.  If you're happy with my changes, please switch the ticket to "positive review".

This makes a very nice companion to #9976.



---

archive/issue_comments_121529.json:
```json
{
    "body": "Attachment [trac_11298-ref.patch](tarball://root/attachments/some-uuid/ticket11298/trac_11298-ref.patch) by @jhpalmieri created at 2011-07-20 21:33:30\n\nreferee patch; apply on top of others",
    "created_at": "2011-07-20T21:33:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121529",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_11298-ref.patch](tarball://root/attachments/some-uuid/ticket11298/trac_11298-ref.patch) by @jhpalmieri created at 2011-07-20 21:33:30

referee patch; apply on top of others



---

archive/issue_comments_121530.json:
```json
{
    "body": "(The only aspect of the referee's patch worth mentioning is the removal of the import of `sage_getsource`.  This is already done at the top-level of that file, so it doesn't need to be done again.)",
    "created_at": "2011-07-20T21:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121530",
    "user": "https://github.com/jhpalmieri"
}
```

(The only aspect of the referee's patch worth mentioning is the removal of the import of `sage_getsource`.  This is already done at the top-level of that file, so it doesn't need to be done again.)



---

archive/issue_comments_121531.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-07-20T22:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121531",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_121532.json:
```json
{
    "body": "Replying to [comment:24 jhpalmieri]:\n> Okay, I'm happy with this.  I'm attaching a referee's patch with a few small changes.  If you're happy with my changes, please switch the ticket to \"positive review\".\n\nI am happy with the changes. Thus I change it into a positive review. Thank you very much!",
    "created_at": "2011-07-20T22:44:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121532",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:24 jhpalmieri]:
> Okay, I'm happy with this.  I'm attaching a referee's patch with a few small changes.  If you're happy with my changes, please switch the ticket to "positive review".

I am happy with the changes. Thus I change it into a positive review. Thank you very much!



---

archive/issue_comments_121533.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2011-07-28T20:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121533",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_121534.json:
```json
{
    "body": "This needs to be rebased to #11287.",
    "created_at": "2011-07-28T20:20:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121534",
    "user": "https://github.com/jdemeyer"
}
```

This needs to be rebased to #11287.



---

archive/issue_comments_121535.json:
```json
{
    "body": "After applying the patch at #11287, these still apply for me, although one does have fuzz.  Is the fuzz an issue or are patches actually being rejected?",
    "created_at": "2011-07-28T21:26:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121535",
    "user": "https://github.com/jhpalmieri"
}
```

After applying the patch at #11287, these still apply for me, although one does have fuzz.  Is the fuzz an issue or are patches actually being rejected?



---

archive/issue_comments_121536.json:
```json
{
    "body": "Changing status from needs_work to needs_info.",
    "created_at": "2011-07-31T07:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121536",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_info.



---

archive/issue_comments_121537.json:
```json
{
    "body": "<Bump>\n\nJeroen, could you please elaborate why you think that it should be rebased?",
    "created_at": "2011-07-31T07:06:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121537",
    "user": "https://github.com/simon-king-jena"
}
```

<Bump>

Jeroen, could you please elaborate why you think that it should be rebased?



---

archive/issue_comments_121538.json:
```json
{
    "body": "(If all else fails, we can wait until 4.7.2.alpha0 and rebase it with respect to that.)",
    "created_at": "2011-08-01T01:24:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121538",
    "user": "https://github.com/jhpalmieri"
}
```

(If all else fails, we can wait until 4.7.2.alpha0 and rebase it with respect to that.)



---

archive/issue_comments_121539.json:
```json
{
    "body": "Replying to [comment:29 jhpalmieri]:\n> After applying the patch at #11287, these still apply for me, although one does have fuzz.  Is the fuzz an issue or are patches actually being rejected?\n\nMy personal opinion on applying patches with fuzz is that I allow patches with fuzz 1 but not with fuzz 2.  I have seen at least two cases where a \"fuzz 2\" patch was actually wrongly merged (I don't remember which tickets).",
    "created_at": "2011-08-01T10:08:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121539",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:29 jhpalmieri]:
> After applying the patch at #11287, these still apply for me, although one does have fuzz.  Is the fuzz an issue or are patches actually being rejected?

My personal opinion on applying patches with fuzz is that I allow patches with fuzz 1 but not with fuzz 2.  I have seen at least two cases where a "fuzz 2" patch was actually wrongly merged (I don't remember which tickets).



---

archive/issue_comments_121540.json:
```json
{
    "body": "Replying to [comment:32 jdemeyer]:\n> My personal opinion on applying patches with fuzz is that I allow patches with fuzz 1 but not with fuzz 2.  I have seen at least two cases where a \"fuzz 2\" patch was actually wrongly merged (I don't remember which tickets).\n\nOK. Then I'll take care of it.",
    "created_at": "2011-08-01T10:30:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121540",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:32 jdemeyer]:
> My personal opinion on applying patches with fuzz is that I allow patches with fuzz 1 but not with fuzz 2.  I have seen at least two cases where a "fuzz 2" patch was actually wrongly merged (I don't remember which tickets).

OK. Then I'll take care of it.



---

archive/issue_comments_121541.json:
```json
{
    "body": "By the way: When I tried to import the patch from #11287 on top of sage-4.7.rc2, application to doc/en/reference/mist.rst failed. But if I understood correctly, the problem with the patch here is somewhere else, right? And moreover, I should probably get a more recent Sage version...",
    "created_at": "2011-08-01T11:08:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121541",
    "user": "https://github.com/simon-king-jena"
}
```

By the way: When I tried to import the patch from #11287 on top of sage-4.7.rc2, application to doc/en/reference/mist.rst failed. But if I understood correctly, the problem with the patch here is somewhere else, right? And moreover, I should probably get a more recent Sage version...



---

archive/issue_comments_121542.json:
```json
{
    "body": "That's odd!\n\nI applied the patches from #11251, then #11287. Then I had fuzz 2 for one of the patches from #9976 (but they are already merged in 4.7.1.alpha0), and then the patches from here applied *cleanly* and *without fuzz*.\n\nSo, it seems that I should get the latest rc or alpha version of sage, and try again.",
    "created_at": "2011-08-01T11:12:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121542",
    "user": "https://github.com/simon-king-jena"
}
```

That's odd!

I applied the patches from #11251, then #11287. Then I had fuzz 2 for one of the patches from #9976 (but they are already merged in 4.7.1.alpha0), and then the patches from here applied *cleanly* and *without fuzz*.

So, it seems that I should get the latest rc or alpha version of sage, and try again.



---

archive/issue_comments_121543.json:
```json
{
    "body": "Replying to [comment:35 SimonKing]:\nYes, sage-4.7.rc2 is in fact quite old, so please try [sage-4.7.1.rc1](http://boxen.math.washington.edu/home/release/sage-4.7.1.rc1/) + #11287 (or wait until sage-4.7.2.alpha0 is released and rebase to that).",
    "created_at": "2011-08-01T11:31:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121543",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:35 SimonKing]:
Yes, sage-4.7.rc2 is in fact quite old, so please try [sage-4.7.1.rc1](http://boxen.math.washington.edu/home/release/sage-4.7.1.rc1/) + #11287 (or wait until sage-4.7.2.alpha0 is released and rebase to that).



---

archive/issue_comments_121544.json:
```json
{
    "body": "Attachment [trac11298_singular_standard_options.rebased.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_singular_standard_options.rebased.patch) by @simon-king-jena created at 2011-08-01 15:46:35\n\nIntrospection for sage.misc.decorators.sage_wraps, applied for singular_standard_options. Put decorators into references. Rebased against #11287",
    "created_at": "2011-08-01T15:46:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121544",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment [trac11298_singular_standard_options.rebased.patch](tarball://root/attachments/some-uuid/ticket11298/trac11298_singular_standard_options.rebased.patch) by @simon-king-jena created at 2011-08-01 15:46:35

Introspection for sage.misc.decorators.sage_wraps, applied for singular_standard_options. Put decorators into references. Rebased against #11287



---

archive/issue_comments_121545.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2011-08-01T15:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121545",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_121546.json:
```json
{
    "body": "I've built sage-4.7.1.rc1 and rebased the patch.\n\nApply trac11298_introspection_and_edit.patch attachment:trac11298_singular_standard_options.rebased.patch attachment:trac_11298-ref.patch",
    "created_at": "2011-08-01T15:48:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121546",
    "user": "https://github.com/simon-king-jena"
}
```

I've built sage-4.7.1.rc1 and rebased the patch.

Apply trac11298_introspection_and_edit.patch attachment:trac11298_singular_standard_options.rebased.patch attachment:trac_11298-ref.patch



---

archive/issue_comments_121547.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-08-01T15:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121547",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_121548.json:
```json
{
    "body": "The change of the patch concerns doc/en/misc.rst, and the reason for the change was the fact that the context of the inserted line has changed. In particular, the change in the patch has not changed code or doctests. Therefore I believe that it should be reverted to a positive review.\n\nApply trac11298_introspection_and_edit.patch trac11298_singular_standard_options.rebased.patch trac_11298-ref.patch",
    "created_at": "2011-08-01T15:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121548",
    "user": "https://github.com/simon-king-jena"
}
```

The change of the patch concerns doc/en/misc.rst, and the reason for the change was the fact that the context of the inserted line has changed. In particular, the change in the patch has not changed code or doctests. Therefore I believe that it should be reverted to a positive review.

Apply trac11298_introspection_and_edit.patch trac11298_singular_standard_options.rebased.patch trac_11298-ref.patch



---

archive/issue_comments_121549.json:
```json
{
    "body": "> I believe that it should be reverted to a positive review.\n\nI agree.  If it's a simple rebase, no new review should be needed.  Thanks for taking care of this.",
    "created_at": "2011-08-01T21:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121549",
    "user": "https://github.com/jhpalmieri"
}
```

> I believe that it should be reverted to a positive review.

I agree.  If it's a simple rebase, no new review should be needed.  Thanks for taking care of this.



---

archive/issue_comments_121550.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-08-02T19:44:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11126",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11126#issuecomment-121550",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
