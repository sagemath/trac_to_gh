# Issue 25146: deprecate useless or misleading functions in the global namespace

Issue created by migration from Trac.

Original creator: vdelecroix

Original creation time: 2018-05-17 08:49:17

CC:  tmonteil tscrim @davidayotte

- `backtrack_all` (for sudoku)


---

Comment by jdemeyer created at 2018-05-17 09:06:54

I'm not entirely sure that `banner` is unused. I can see that being actually used somewhere as `from sage.all import banner`. Although deprecating it cannot hurt.

The rest should be no problem.


---

Comment by kcrisman created at 2018-05-30 17:03:09

Sage did actually have some proto-database functionality but that never really went very far.

I'm not sure that `desolve` should move; similarly with the various types of matrices.  In a lot of contexts you really want the absolutely easiest dumb-sounding command, and extra object-oriented stuff can be confusing there.

That said, most of these probably indeed are a bit specific for top-level.  Seems like the kind of thing to put on sage-devel and allow people to ask for things to be separately discussed if necessary: see e.g. [consent agendas](https://en.wikipedia.org/wiki/Unanimous_consent#Consent_Agenda).


---

Comment by jdemeyer created at 2018-05-30 20:29:20

What's wrong with `alarm` and `column_matrix`? (just picking two which look genuinely useful)


---

Comment by vdelecroix created at 2018-05-30 21:23:44

Replying to [comment:7 jdemeyer]:
> What's wrong with `alarm` and `column_matrix`? (just picking two which look genuinely useful)

This is not a strong opinion. I just made up a list by quickly looking at `dir()`. Concerning the two names you mention:

- what is `alarm` useful for for a Sage user that does not know how to import it?
- `column_matrix` is accessible via `matrix.column` and I believe it is easier (if properly advertised) to use the second version

Removing from the global namespace is different from removing.


---

Comment by vdelecroix created at 2018-05-30 21:45:40

Replying to [comment:6 kcrisman]:

Thanks for your comment! I am just trying to make clear that we are at a point where the global namespace is so confusing that it is impossible to find anything relevant. What should be kept and how it should be organized is definitely open to suggestion. But I am not sure that discussing one by one the entries on this ticket is the best strategy.

> Sage did actually have some proto-database functionality but that never really went very far.
> 
> I'm not sure that `desolve` should move; similarly with the various types of matrices.  In a lot of contexts you really want the absolutely easiest dumb-sounding command, and extra object-oriented stuff can be confusing there.
>
> That said, most of these probably indeed are a bit specific for top-level.  Seems like the kind of thing to put on sage-devel and allow people to ask for things to be separately discussed if necessary: see e.g. [consent agendas](https://en.wikipedia.org/wiki/Unanimous_consent#Consent_Agenda).

I was thinking of something like this. It is very likely that commands will be moved by small amount in separate tickets.


---

Comment by nbruin created at 2018-06-16 17:39:34

Replying to [comment:9 vdelecroix]:
> Thanks for your comment! I am just trying to make clear that we are at a point where the global namespace is so confusing that it is impossible to find anything relevant. What should be kept and how it should be organized is definitely open to suggestion. But I am not sure that discussing one by one the entries on this ticket is the best strategy.

In what way is the global namespace "confusing"? Is it hard for python to find the bindings? (no because python dictionaries should basically have access time independent of the size of the dictionary)

Is the problem that browsing the global namespace gives too long a list? It may just be the case that browsing the global namespace is not such a great strategy to learn about a computer algebra system.

I think some culling can definitely be done, but the change has a cost, so I think it should be justified. What benefit do we get from culling?


---

Comment by vdelecroix created at 2018-06-16 17:56:18

Replying to [comment:10 nbruin]:
> Replying to [comment:9 vdelecroix]:
> > Thanks for your comment! I am just trying to make clear that we are at a point where the global namespace is so confusing that it is impossible to find anything relevant. What should be kept and how it should be organized is definitely open to suggestion. But I am not sure that discussing one by one the entries on this ticket is the best strategy.
> 
> In what way is the global namespace "confusing"? Is it hard for python to find the bindings? (no because python dictionaries should basically have access time independent of the size of the dictionary)

Indeed, nobody cares about this.

> Is the problem that browsing the global namespace gives too long a list? It may just be the case that browsing the global namespace is not such a great strategy to learn about a computer algebra system.

The length is not so important. The problem is that you have access to so many specialized and/or useless functions. If the functions/classes were better organized by modules (for example `graphs.<TAB>` is cool) it would be simpler to find functionalities. The only reasonable strategies I know for searching for a functionality in Sage is the tab-completion and grepping the source. While the latter technique is powerful it is not ideal for a newcomer. The Sage documentation could have been an alternative but it is very bad at the moment. The only references I know where things are organized are the books written about Sage (e.g. "Calcul Mathématique avec Sage" by Zimmermann et al.)

So it is not about *learning* but about *searching*. I am focusing not on the newcomers, but the next stage (learners?). The problem is "I want to do that, how do I do"?

> I think some culling can definitely be done, but the change has a cost, so I think it should be justified. What benefit do we get from culling? 

Cost for the developer? Cost for the reviewer? Cost for the one person who uses an ultra specialized feature that is imported by default?


---

Comment by jhpalmieri created at 2018-06-16 18:32:58

We also advertise tab-completion in the tutorial (and probably other places) as a way to learn about the system, and so perhaps the length of the list may actually be an issue.


---

Comment by dcoudert created at 2018-06-17 11:23:40

I agree that methods like:
- `random_DAG`, `firing_graph`, `parallel_firing_graph` defined in `sandpile/` could be moved to `digraphs.<TAB>`
- `all_max_clique`, `clique_number`, `max_clique` should be methods of `Graph` only.

Questions: 
- how to know where a method is defined ? For instance, when typing `random_DAG?` I don't get the source file of the method but of `LazyImport`.
- Is there an easy way to know where a method is used ? I'm usually relying on grep which might not be the smartest way.


---

Comment by vdelecroix created at 2018-06-17 17:00:16

This works often

```
sage: import_statements(random_DAG)
from sage.sandpiles.sandpile import random_DAG
```

and this as well

```
sage: import_statements("random_DAG")
from sage.sandpiles.sandpile import random_DAG
```



---

Comment by dcoudert created at 2018-06-17 20:12:57

Thanks ! I'm learning every day ;)


---

Comment by nbruin created at 2018-06-17 22:36:19

Replying to [comment:11 vdelecroix]:

> The length is not so important. The problem is that you have access to so many specialized and/or useless functions. If the functions/classes were better organized by modules (for example `graphs.<TAB>` is cool) it would be simpler to find functionalities.

I've tried that occasionally (not particularly on graphs) and have been underwhelmed with the results. Namespaces in python are generally too cluttered to be useful in that way (plus, the standard IPython interfaces give the completion list in a very small window, without much additional information). I have generally resorted to using "google" to get a hold of some relevant documentation. Once I have an object that is probably related to the functionality I'm looking for, I'd generally use a bit of tab completion on that (and wade through all the boiler-plate infrastructure that's cluttering those results)

If we'd have a command that would print a list such that you can hover over the results to see the associated docstring, I think it would already be a lot more useful. Especially if clicking would then redirect to the HTML documentation.

> The only reasonable strategies I know for searching for a functionality in Sage is the tab-completion and grepping the source. While the latter technique is powerful it is not ideal for a newcomer. The Sage documentation could have been an alternative but it is very bad at the moment. The only references I know where things are organized are the books written about Sage (e.g. "Calcul Mathématique avec Sage" by Zimmermann et al.)

Indeed, and for "cost" about changing namespace contents, I think such books suffer particularly. Any books/ articles / documentation / scripts that depend on the contents of certain namespaces are affected by changes. Changing contents of namespaces causes breakage and therefore bears a significant cost. 

> So it is not about *learning* but about *searching*. I am focusing not on the newcomers, but the next stage (learners?). The problem is "I want to do that, how do I do"?

> Cost for the developer? Cost for the reviewer? Cost for the one person who uses an ultra specialized feature that is imported by default?

As above: cost in the form of all existing usage/articles breaking. The benefits of a change must really outweigh such costs. As I describe above, I haven't found "tab completion" such an effective way for browsing functionality either, so the benefits don't seem so large at this point.

If we'd have a better browser for module contents, it may be an easier argument to make. The standard nowadays is really "do we provide a search interface that is considerably better than google search?". Using google is a universal strategy, so unless a specific search strategy for finding sage functionality is *considerably* better, people are better off sticking to using google.
I'm not so convinced that the sage documentation browsing (via tab or via HTML indices) gets considerably better results than google, so in reality I don't think changes at this point would lead to significant improvements anyway (search_src definitely has advantages if you have a sufficiently specific term, but indeed might not be so suitable for anybody below "expert" level)

Having better documentation and a better way of searching it would definitely be great. I'm not quite sure that culling the global namespace quite gets us there.

(incidentally, I've been quite happy finding `explain_pickle` right there in the top-level namespace. I have never been disappointed by finding that something was there in the top-level namespace. Having a bloated top-level does go against a general sense of aesthetics, so there's that, but I have trouble justifying that general feeling by practical arguments)


---

Comment by mantepse created at 2018-06-19 14:49:11

I almost exclusively use sage through the emacs interface (in fact, I don't even really know the ipython interface), and having a cleaner top level namespace might be quite helpful there.  I have, apart from aesthetics, two reasons:

* the list of suggestions becomes shorter, so when looking for something, I have less to read or search through, and thus better chances not to miss the needle in the haystack,

* tab completion has a better chance of working, that is, I have fewer characters to type to get completion.

However, I must say that things are not terribly bad currently.  So in case of doubt, I'd leave a particular item in the global name space.


---

Comment by chapoton created at 2018-07-06 09:53:50

some work in #25785


---

Comment by mantepse created at 2018-07-06 10:24:12

`class_graph` might actually make sense for exploration - I wouldn't know how to discover this utility otherwise.  But I don't know.


---

Comment by chapoton created at 2018-07-06 19:01:16

see also #25791 for more work


---

Comment by vdelecroix created at 2018-08-03 19:20:18

update milestone 8.3 -> 8.4


---

Comment by dcoudert created at 2018-09-05 12:46:33

Methods `all_max_clique`, `max_clique` and `clique_number` are imported into the global namespace in file `src/sage/graphs/all.py`. It contains `from sage.graphs.cliquer import *`. This can be removed as these methods are all already methods of `Graph`.

How should we proceed: open a specific ticket for that? add a deprecation warning, but with what message ?


---

Comment by vdelecroix created at 2018-09-06 13:14:51

Replying to [comment:25 dcoudert]:
> Methods `all_max_clique`, `max_clique` and `clique_number` are imported into the global namespace in file `src/sage/graphs/all.py`. It contains `from sage.graphs.cliquer import *`. This can be removed as these methods are all already methods of `Graph`.
> 
> How should we proceed: open a specific ticket for that? add a deprecation warning, but with what message ?

Yes: open a new ticket. And as it was done already for several of the functions, mention the ticket number in the description here.


---

Comment by jhpalmieri created at 2019-02-21 22:17:44

Related: #27337


---

Comment by embray created at 2020-01-06 14:10:03

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by embray created at 2020-08-31 14:58:59

Replying to [comment:8 vdelecroix]:
> Replying to [comment:7 jdemeyer]:
> > What's wrong with `alarm` and `column_matrix`? (just picking two which look genuinely useful)
> 
> This is not a strong opinion. I just made up a list by quickly looking at `dir()`. Concerning the two names you mention:
> 
> - what is `alarm` useful for for a Sage user that does not know how to import it?
> - `column_matrix` is accessible via `matrix.column` and I believe it is easier (if properly advertised) to use the second version
> 
> Removing from the global namespace is different from removing.

I think `alarm()` is useful for general users, so long as we advertise it.  I actually thought that it did come up in some of the user documentation, though it appears not.  It is, however, used in a number of doctests.

`alarm()` is an easy way for a user to set a timeout for a long-running computation without having to manually Ctrl-C, and can even be more responsive.  For example:


```
sage: try:
....:     alarm(5)
....:     print('computing some optimization that might diverge...')
....:     import time; time.sleep(10)
....:     print('done')
....: except AlarmInterrupt:
....:     print('calculation took too long')
....:     
....:     
computing some optimization that might diverge...
calculation took too long
```


(as an aside, there is currently a bug when using a bare `alarm()` call in the IPython REPL without explictly catching the `AlarmInterrupt`, but it works fine as in the example above.  I thought I had an issue opened for that but I can't seem to find it...


---

Comment by dcoudert created at 2020-08-31 15:56:09

I opened #30479 to deprecate `random_DAG` from global namespace.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by jhpalmieri created at 2022-03-30 23:55:27

What about developer-specific commands? When I look at `misc.all`, I see (among others):

- `benchmark`, `Profiler`, `logstr`, `cputime`, `walltime`, `set_edit_template`, the pickling stuff, `trace`, `fortran`?, everything from `sage.misc.package`

Other questionable commands from `misc.all`:

- `banner` (already mentioned above), `newton_method_sizes`, `map_threaded`

I don't actually know if any of these are useful. They're not useful to me, but I don't know how to judge whether they're useful enough to anyone else to keep in the global namespace.


---

Comment by jhpalmieri created at 2022-08-01 01:44:23

I don't know why any of the pickling stuff is in the global namespace, but it has uses scattered throughout the Sage library, so some people view it as useful or important.
