# Issue 10849: An object's element list should be immutable

Issue created by migration from https://trac.sagemath.org/ticket/10927

Original creator: justin

Original creation time: 2011-03-13 20:24:42

Assignee: nthiery

Here's the Ur example:

```
sage: R=Integers(5)
sage: L=R.list();L
[0, 1, 2, 3, 4]
sage: L.__delitem__(0)
sage: R.list()
[1, 2, 3, 4]
```

Should be a deep copy, methinks.  I don't yet if there's a "one change fixes all" fix, or whether this has to spawn a zillion fixes.

This doesn't seem to match any component, so I chose 'categories'.  Feel free to make appropriate changes.


---

Attachment

Fixing this by changing the function _list_from_iterator_cached() in parent.pyx.

Instead of creating and saving the element list as a list, do so as a tuple, and return
as a list when requested.


---

Comment by mmezzarobba created at 2014-03-15 13:22:49

Replying to [comment:1 justin]:
> Instead of creating and saving the element list as a list, do so as a tuple, and return
> as a list when requested.

I doubt people would be happy with the performance implications. IMO the proper fix would be to either return an immutable data structure despite the method's name, or better, to implement copy-on-write mutable lists.
