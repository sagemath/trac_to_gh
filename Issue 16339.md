# Issue 16339: Improve monic_integral_model() for function fields

archive/issues_016339.json:
```json
{
    "body": "Keywords: sd59\n\nThis make `monic_integral_model()` work for towers of function fields as well and adds more flexibility to the ``name`` parameter.\n\nIssue created by migration from https://trac.sagemath.org/ticket/16576\n\n",
    "created_at": "2014-06-28T00:33:08Z",
    "labels": [
        "commutative algebra",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "Improve monic_integral_model() for function fields",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16339",
    "user": "saraedum"
}
```
Keywords: sd59

This make `monic_integral_model()` work for towers of function fields as well and adds more flexibility to the ``name`` parameter.

Issue created by migration from https://trac.sagemath.org/ticket/16576





---

archive/issue_comments_214247.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-06-28T00:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214247",
    "user": "saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_214248.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-23T17:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214248",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214249.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-07-23T17:49:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214249",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214250.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2015-05-30T19:21:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214250",
    "user": "mmezzarobba"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214251.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2015-08-13T19:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214251",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214252.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2015-08-13T19:28:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214252",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214253.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-08-22T13:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214253",
    "user": "rws"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214254.json:
```json
{
    "body": "If this depends on another ticket then please merge that ticket branch here. Else no one can see if the integration is done correctly, or even review what is here.",
    "created_at": "2016-08-22T13:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214254",
    "user": "rws"
}
```

If this depends on another ticket then please merge that ticket branch here. Else no one can see if the integration is done correctly, or even review what is here.



---

archive/issue_comments_214255.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-08-25T01:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214255",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214256.json:
```json
{
    "body": "I don't understand what you mean. \u200b59fad8a is merged into this branch. It's hard to review this (on trac) because the dependencies have not been merged into develop yet. But there's nothing I can do about that I think.",
    "created_at": "2016-08-25T01:19:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214256",
    "user": "saraedum"
}
```

I don't understand what you mean. â€‹59fad8a is merged into this branch. It's hard to review this (on trac) because the dependencies have not been merged into develop yet. But there's nothing I can do about that I think.



---

archive/issue_comments_214257.json:
```json
{
    "body": "I am working on #16563. Please review that one first.",
    "created_at": "2016-08-25T01:24:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214257",
    "user": "saraedum"
}
```

I am working on #16563. Please review that one first.



---

archive/issue_comments_214258.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-12-11T13:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214258",
    "user": "klee"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214259.json:
```json
{
    "body": "Apply failed",
    "created_at": "2016-12-11T13:11:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214259",
    "user": "klee"
}
```

Apply failed



---

archive/issue_comments_214260.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-12-16T04:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214260",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214261.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-12-16T04:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214261",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214262.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-12-16T04:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214262",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214263.json:
```json
{
    "body": "New commits:\n----\nNew commits:",
    "created_at": "2016-12-16T04:41:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214263",
    "user": "saraedum"
}
```

New commits:
----
New commits:



---

archive/issue_comments_214264.json:
```json
{
    "body": "Nice work!\n\nSome immediate comments:\n\n* In `monic_integral_model`,\n\n```\n        - ``names`` -- a string, a tuple of up to two strings, or ``None``\n          (default: ``None``), the name of the generator of the field, and\n          the name of the generator of the underlying rational function\n          field (if a tuple); if ``None``, then the names are chosen\n          automatically.\n```\n\nThis is correct. But following usual practice, you can omit `or ``None``` and instead of `if ``None```, you can write `if not given` in a friendly way. The same comment applies in other places.\n\n* In `_simple_model`: Although this is a helper method, the docstring is better to start with `Return ...`-style sentence.\n\n* In `ALGORITHM`: You write `Indeed, suppose for contradiction that for all `i` we had `N_i\\neq M``. Here you do not seek for a contradiction because you directly show it. You have `Then `N_i=N_j` for some `i,j`.` not because of supposing that but because there are only finitely many intermediate fields, as you mentioned above.\n\n* In `REFERENCES`: I am not sure about this myself. But as far as I know, the policy changed, and we should place all references in a central reference file `src/doc/en/reference/references/index.rst`\n\n* In `_simple_model`: A small optimization is to move out `M.degree()*L.degree()` from the `while` loop, and multiply `x_pow`  by `x` instead of `x**exponet`. But these things could make not much difference. It is up to your discretion :-)",
    "created_at": "2016-12-16T09:33:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214264",
    "user": "klee"
}
```

Nice work!

Some immediate comments:

* In `monic_integral_model`,

```
        - ``names`` -- a string, a tuple of up to two strings, or ``None``
          (default: ``None``), the name of the generator of the field, and
          the name of the generator of the underlying rational function
          field (if a tuple); if ``None``, then the names are chosen
          automatically.
```

This is correct. But following usual practice, you can omit `or ``None``` and instead of `if ``None```, you can write `if not given` in a friendly way. The same comment applies in other places.

* In `_simple_model`: Although this is a helper method, the docstring is better to start with `Return ...`-style sentence.

* In `ALGORITHM`: You write `Indeed, suppose for contradiction that for all `i` we had `N_i\neq M``. Here you do not seek for a contradiction because you directly show it. You have `Then `N_i=N_j` for some `i,j`.` not because of supposing that but because there are only finitely many intermediate fields, as you mentioned above.

* In `REFERENCES`: I am not sure about this myself. But as far as I know, the policy changed, and we should place all references in a central reference file `src/doc/en/reference/references/index.rst`

* In `_simple_model`: A small optimization is to move out `M.degree()*L.degree()` from the `while` loop, and multiply `x_pow`  by `x` instead of `x**exponet`. But these things could make not much difference. It is up to your discretion :-)



---

archive/issue_comments_214265.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-12-16T14:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214265",
    "user": "saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214266.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-06T00:00:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214266",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214267.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-06T03:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214267",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214268.json:
```json
{
    "body": "Thanks for your comments.\n\nReplying to [comment:18 klee]:\n> * In `monic_integral_model`,\n> {{{\n>         - ``names`` -- a string, a tuple of up to two strings, or ``None``\n>           (default: ``None``), the name of the generator of the field, and\n>           the name of the generator of the underlying rational function\n>           field (if a tuple); if ``None``, then the names are chosen\n>           automatically.\n> }}}\n> This is correct. But following usual practice, you can omit `or ``None``` and instead of `if ``None```, you can write `if not given` in a friendly way. The same comment applies in other places.\nFixed all the occurences I could find.\n\n> * In `_simple_model`: Although this is a helper method, the docstring is better to start with `Return ...`-style sentence.\nFixed.\n\n> * In `ALGORITHM`: You write `Indeed, suppose for contradiction that for all `i` we had `N_i\\neq M``. Here you do not seek for a contradiction because you directly show it. You have `Then `N_i=N_j` for some `i,j`.` not because of supposing that but because there are only finitely many intermediate fields, as you mentioned above.\nFixed.\n\n> * In `REFERENCES`: I am not sure about this myself. But as far as I know, the policy changed, and we should place all references in a central reference file `src/doc/en/reference/references/index.rst`\nFixed.\n\n> * In `_simple_model`: A small optimization is to move out `M.degree()*L.degree()` from the `while` loop, and multiply `x_pow`  by `x` instead of `x**exponet`. But these things could make not much difference. It is up to your discretion :-)\nI don't think that it will make enough of a difference, so I left it as it is.\n----\nNew commits:",
    "created_at": "2017-06-06T03:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214268",
    "user": "saraedum"
}
```

Thanks for your comments.

Replying to [comment:18 klee]:
> * In `monic_integral_model`,
> {{{
>         - ``names`` -- a string, a tuple of up to two strings, or ``None``
>           (default: ``None``), the name of the generator of the field, and
>           the name of the generator of the underlying rational function
>           field (if a tuple); if ``None``, then the names are chosen
>           automatically.
> }}}
> This is correct. But following usual practice, you can omit `or ``None``` and instead of `if ``None```, you can write `if not given` in a friendly way. The same comment applies in other places.
Fixed all the occurences I could find.

> * In `_simple_model`: Although this is a helper method, the docstring is better to start with `Return ...`-style sentence.
Fixed.

> * In `ALGORITHM`: You write `Indeed, suppose for contradiction that for all `i` we had `N_i\neq M``. Here you do not seek for a contradiction because you directly show it. You have `Then `N_i=N_j` for some `i,j`.` not because of supposing that but because there are only finitely many intermediate fields, as you mentioned above.
Fixed.

> * In `REFERENCES`: I am not sure about this myself. But as far as I know, the policy changed, and we should place all references in a central reference file `src/doc/en/reference/references/index.rst`
Fixed.

> * In `_simple_model`: A small optimization is to move out `M.degree()*L.degree()` from the `while` loop, and multiply `x_pow`  by `x` instead of `x**exponet`. But these things could make not much difference. It is up to your discretion :-)
I don't think that it will make enough of a difference, so I left it as it is.
----
New commits:



---

archive/issue_comments_214269.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-06T03:23:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214269",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214270.json:
```json
{
    "body": "Changing keywords from \"sd59\" to \"sd59, sd68.5\".",
    "created_at": "2017-06-06T03:27:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214270",
    "user": "saraedum"
}
```

Changing keywords from "sd59" to "sd59, sd68.5".



---

archive/issue_comments_214271.json:
```json
{
    "body": "Changing keywords from \"sd59, sd68.5\" to \"sd59, sd86.5\".",
    "created_at": "2017-06-06T03:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214271",
    "user": "saraedum"
}
```

Changing keywords from "sd59, sd68.5" to "sd59, sd86.5".



---

archive/issue_comments_214272.json:
```json
{
    "body": "Looking good once patchbot okays it.",
    "created_at": "2017-06-07T02:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214272",
    "user": "roed"
}
```

Looking good once patchbot okays it.



---

archive/issue_comments_214273.json:
```json
{
    "body": "Some quick notes:\n\n(1) `Unless ...` should be `unless` as the sentence is connected with the previous one.\n\n(2) To clarify, how about this?\n\n```\nif names:\n    if not isinstance(names, tuple):\n        names = (names,)\n    if len(names) > 2:\n        raise ValueError(\"names must contain at most 2 entries\")\n```\n\nAlso note erorr in `ValueError`.\n\n(3) Is it necessary to check zero-length tuple? That is just a wrong input by the user.\n\n```\nif names is None or names == ():\n```\n\nThen how about just this: `if not names:`\n\n(4) In the `INPUT:` block in `matrix()` method, I think\n`a function field (default: ``None``); ...` is clear enough.",
    "created_at": "2017-06-07T04:09:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214273",
    "user": "klee"
}
```

Some quick notes:

(1) `Unless ...` should be `unless` as the sentence is connected with the previous one.

(2) To clarify, how about this?

```
if names:
    if not isinstance(names, tuple):
        names = (names,)
    if len(names) > 2:
        raise ValueError("names must contain at most 2 entries")
```

Also note erorr in `ValueError`.

(3) Is it necessary to check zero-length tuple? That is just a wrong input by the user.

```
if names is None or names == ():
```

Then how about just this: `if not names:`

(4) In the `INPUT:` block in `matrix()` method, I think
`a function field (default: ``None``); ...` is clear enough.



---

archive/issue_comments_214274.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-06-07T23:45:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214274",
    "user": "saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_214275.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-08T07:00:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214275",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214276.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-06-08T07:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214276",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_214277.json:
```json
{
    "body": "New commits:\n----\nNew commits:",
    "created_at": "2017-06-08T07:01:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214277",
    "user": "saraedum"
}
```

New commits:
----
New commits:



---

archive/issue_comments_214278.json:
```json
{
    "body": "Looks good.  I ran tests.",
    "created_at": "2017-06-08T18:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214278",
    "user": "roed"
}
```

Looks good.  I ran tests.



---

archive/issue_comments_214279.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-08T18:24:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214279",
    "user": "roed"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_214280.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-06-11T20:19:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214280",
    "user": "klee"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_214281.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-12T00:19:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214281",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_214282.json:
```json
{
    "body": "New commits:\n----\nNew commits:",
    "created_at": "2017-06-12T00:19:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214282",
    "user": "saraedum"
}
```

New commits:
----
New commits:



---

archive/issue_comments_214283.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-06-12T00:20:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214283",
    "user": "saraedum"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_214284.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-13T06:51:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16339#issuecomment-214284",
    "user": "vbraun"
}
```

Resolution: fixed
