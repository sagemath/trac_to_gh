# Issue 34178: Sirocco improvements: discriminant and optional information

Issue created by migration from https://trac.sagemath.org/ticket/34415

Original creator: enriqueartal

Original creation time: 2022-08-23 13:15:03

CC:  mmarco

Given a polynomial `f(x, y)`, the method `braid_monodromy` starts with changes of variables of the type `x:x+y` till the global degree of `f` coincides with its `y`-degree. Next step is to compute its discriminant with respect to `y`.

Applying it to an example of a polynomial of degree 18 with coefficients in a number field of index 12 yields to more that 30 minutes of computation time. This polynomial has three factors. The computation of the discriminant of each factor and the resultant of the three pairs of factors is done in 15 seconds.

Now `Sirocco` takes into account the factors, so computing the discriminant via the factorization would reduce the time of computation. 

In the same ideas it would be useful to know to which irreducible component each string of the braids correspond. As a first approach, at least the result could contain also the number of changes of variables and the base point, which contains the information to decide about the relationship of strings and factors.


---

Comment by git created at 2022-08-23 15:35:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by enriqueartal created at 2022-08-23 15:41:22

The definition of `discrim` takes into account factorization. The optional information has been added. A new variable  `change_info` has been added to method `braid_monodromy`. The default value is `False` and in this case it behaves as previously, the output is a list of braids; if the value is `True` then a tuple with three items is returned:

- List of braids
- Number of changes of variables `x : x + y` to have the same degree and `y`-degree
- A vector with components the real and imaginary parts of the `x`-coordinate of the base point.


---

Comment by git created at 2022-08-31 14:48:50

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-01 11:25:32

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by enriqueartal created at 2022-09-01 11:29:02

After this change, the computation of `braid_monodromy` and `braid_monodromy_arrangement` gives an error if `sage` runs with `SAGE_NUM_THREADS>1`,

```
File /usr/local/sage310/src/sage/schemes/curves/affine_curve.py:1769, in AffinePlaneCurve_field.braid_monodromy(self)
   1766     raise NotImplementedError("the base field must have an embedding"
   1767                               " to the algebraic field")
   1768 f = self.defining_polynomial()
-> 1769 return braid_monodromy(f)

File /usr/local/sage310/src/sage/schemes/curves/zariski_vankampen.py:980, in braid_monodromy(f, arrangement)
    977     braidscomputed = (braid_in_segment([(gfac, seg[0], seg[1])
    978                                         for seg in segs]))
    979 segsbraids = {}
--> 980 for braidcomputed in braidscomputed:
    981     seg = (braidcomputed[0][0][1], braidcomputed[0][0][2])
    982     beginseg = (QQ(seg[0].real()), QQ(seg[0].imag()))

File /usr/local/sage310/src/sage/parallel/use_fork.py:191, in p_iter_fork.__call__(self, f, inputs)
    188     alarm(max(timeout - (T - oldest), 0.1))
    190 try:
--> 191     pid = os.wait()[0]
    192     cancel_alarm()
    193     W = workers.pop(pid)

ChildProcessError: [Errno 10] No child processes
```

but if it is executed twice it works


---

Comment by git created at 2022-09-01 19:26:42

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by enriqueartal created at 2022-09-01 19:35:59

I think the parallelism problem has disappeared. If an object `CurveArrangement` could be defined as a list of curves, almost any method of `Curve` could be associated and some of them could be adapted as `braid_monodromy_arrangement`.


---

Comment by git created at 2022-09-02 10:36:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-03 16:03:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-03 16:27:09

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-05 09:23:13

Branch pushed to git repo; I updated commit sha1. Last 10 new commits:


---

Comment by git created at 2022-09-06 21:48:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-13 15:28:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-09-24 15:13:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by enriqueartal created at 2022-09-25 08:55:39

This version passess the tests. At some point the description will be updated since more tasks have been done to shorten times of execution by replacing at some places `QQbar` by some number fields embedded in `QQbar`. Besides typos corrctions and more serious improvements there are a couple of things that could be done:
- Create classes of arrangement of affine or projective curves; besides braid monodromy of fundamental group, other methods could be created, e.g. for singular points assignment of branches to components.
- For the computation of `braid_monodromy`, there is an intermediate step consisting in the computation of a _geometric basis_ of the fundamental group of a punctured plane. Sometimes it gives an error stopping the computations; we (`@`mmarco and me) analyzed the problem and he found out how to correct it.


---

Comment by git created at 2022-10-01 11:02:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-10-02 21:44:41

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-10-03 05:56:16

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2022-10-03 06:55:41

no space around `=` signs inside the arguments of functions, please (pep8)


---

Comment by git created at 2022-10-03 18:10:10

Branch pushed to git repo; I updated commit sha1. New commits:
