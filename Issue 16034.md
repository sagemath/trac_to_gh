# Issue 16034: Support the generic Steenrod algebra at the prime 2

Issue created by migration from https://trac.sagemath.org/ticket/16271

Original creator: cnassau

Original creation time: 2014-04-30 12:18:49

CC:  jhpalmieri

Keywords: Steenrod algebra

For some applications one would like to work with the "odd primary Steenrod algebra at the prime 2". The attached patch introduces a new keyword "generic" that allows to do this:


```
  sage: EA=SteenrodAlgebra(p=2,generic=True) ; EA
  generic mod 2 Steenrod algebra, milnor basis
  sage: EA[8]
  Vector space spanned by (Q_0 Q_2, Q_0 Q_1 P(2), P(1,1), P(4)) over Finite Field of size 2
  sage: SteenrodAlgebra(p=2,generic=True,basis='adem')[7]
  Vector space spanned by (beta P^2 P^1, beta P^3, P^2 P^1 beta, P^3 beta) over Finite Field of size 2
```




---

Comment by jhpalmieri created at 2014-04-30 17:16:42

New commits:


---

Comment by git created at 2014-05-05 14:02:35

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-05-06 19:21:14

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-05-08 12:19:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cnassau created at 2014-05-08 12:31:04

Changing status from new to needs_review.


---

Comment by cnassau created at 2014-05-08 12:31:04

The code seems functional now. I've also added an `is_generic` method to allow inspection of the '_generic' attribute.

One thing that might be problematic about this patch is that a few routines have changed their signature now: 'serre_cartan_mono_to_string', for example, now expects 'generic' as second argument, not 'p'. We might instead go for

    `def serre_cartan_mono_to_string(data,p,generic=None)`

which would save backward compatibility... I'm not sure if that is required, though.


---

Comment by git created at 2014-05-12 13:04:57

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2014-05-28 21:45:06

I'm not getting this to work. When I evaluate

```
sage: SteenrodAlgebra(p=2,generic=True)
```

I get an error:

```
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-1-7bd50008c6f7> in <module>()
----> 1 EA = SteenrodAlgebra(p=Integer(2),generic=True) ; EA

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/algebras/steenrod/steenrod_algebra.pyc in SteenrodAlgebra(p, basis, generic, **kwds)
   4122         return SteenrodAlgebra_mod_two(p=2, basis=basis, **kwds)
   4123     else:
-> 4124         return SteenrodAlgebra_generic(p=p, basis=basis, generic=True, **kwds)
   4125 
   4126 

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/misc/classcall_metaclass.so in sage.misc.classcall_metaclass.ClasscallMetaclass.__call__ (sage/misc/classcall_metaclass.c:1282)()

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/algebras/steenrod/steenrod_algebra.pyc in __classcall__(self, p, basis, **kwds)
    525 
    526         std_basis = get_basis_name(basis, p, generic=std_generic)
--> 527         std_profile, std_type = normalize_profile(profile, precision=precision, truncation_type=truncation_type, p=p, generic=std_generic)
    528         return super(SteenrodAlgebra_generic, self).__classcall__(self, p=p, basis=std_basis, profile=std_profile,
    529                                                                   truncation_type=std_type, generic=std_generic)

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/algebras/steenrod/steenrod_algebra_misc.pyc in normalize_profile(profile, precision, truncation_type, p, generic)
    550                     k = k[:-1]
    551             new_profile = (e, k)
--> 552         if is_valid_profile(new_profile, truncation_type, p):
    553             return new_profile, truncation_type
    554         else:

/Users/palmieri/Desktop/Sage_stuff/git/sage/local/lib/python2.7/site-packages/sage/algebras/steenrod/steenrod_algebra_misc.pyc in is_valid_profile(profile, truncation_type, p)
    258             if pro_r < Infinity:
    259                 for i in range(1,r):
--> 260                     if pro_r < min(pro[r-i-1] - i, pro[i-1]):
    261                         return False
    262     else:
```

Does `is_valid_profile` also need to accept a `generic` argument? Maybe something like this:

```diff
diff --git a/src/sage/algebras/steenrod/steenrod_algebra_misc.py b/src/sage/algebras/steenrod/steen
index 70b328c..fe58660 100644
--- a/src/sage/algebras/steenrod/steenrod_algebra_misc.py
+++ b/src/sage/algebras/steenrod/steenrod_algebra_misc.py
@@ -183,7 +183,7 @@ def get_basis_name(basis, p, generic=None):
 ######################################################
 # profile functions
 
-def is_valid_profile(profile, truncation_type, p=2):
+def is_valid_profile(profile, truncation_type, p=2, generic=None):
     """
     True if ``profile``, together with ``truncation_type``, is a valid
     profile at the prime `p`.
@@ -250,7 +250,9 @@ def is_valid_profile(profile, truncation_type, p=2):
         True
     """
     from sage.rings.infinity import Infinity
-    if p == 2:
+    if generic is None:
+        generic = False if p==2 else True
+    if p == 2 and not generic:
         pro = list(profile) + [truncation_type]*len(profile)
         r = 0
         for pro_r in pro:
@@ -549,7 +551,7 @@ def normalize_profile(profile, precision=None, truncation_type='auto', p=2, gen
                 while len(k) > 0 and k[-1] == 2:
                     k = k[:-1]
             new_profile = (e, k)
-        if is_valid_profile(new_profile, truncation_type, p):
+        if is_valid_profile(new_profile, truncation_type, p, generic=generic):
             return new_profile, truncation_type
         else:
             raise ValueError("Invalid profile")
```

Also, in the documentation for the function `SteenrodAlgebra`, I think you should say a bit more, for example what the degrees of the elements are. Maybe move the comment about what the dual looks like from `is_generic` to `SteenrodAlgebra`.


---

Comment by git created at 2014-05-29 08:11:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cnassau created at 2014-05-29 13:35:53

Replying to [comment:8 jhpalmieri]:
> I'm not getting this to work. When I evaluate
> {{{
> sage: SteenrodAlgebra(p=2,generic=True)
> }}}
> I get an error:

Very strange: it works for me, it works for the patchbot (selmer, sage 6.3.beta1) - yet your machine (and your patch) is definitely right. I do get this error when I try to construct a subalgebra:


```
sage: SteenrodAlgebra(p=2,generic=True,profile=([2,1],(2,2,2,)))
...
/waste/cn/sage-git/local/lib/python2.7/site-packages/sage/algebras/steenrod/steenrod_algebra_misc.pyc in is_valid_profile(profile, truncation_type, p)
    258             if pro_r < Infinity:
    259                 for i in range(1,r):
--> 260                     if pro_r < min(pro[r-i-1] - i, pro[i-1]):
    261                         return False
    262     else:

TypeError: unsupported operand type(s) for -: 'tuple' and 'int'
```


You're also right about the documentation, which should be improved. I'll post an updated patch when it is ready.


---

Comment by cnassau created at 2014-05-29 13:35:53

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-06-19 14:07:11

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-01 07:01:27

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-07-06 13:21:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by cnassau created at 2014-07-06 13:34:00

Replying to [comment:8 jhpalmieri]:
> Does `is_valid_profile` also need to accept a `generic` argument? 
> Also, in the documentation for the function `SteenrodAlgebra`, I think you should say a bit more, for example what the degrees of the elements are. Maybe move the comment about what the dual looks like from `is_generic` to `SteenrodAlgebra`.

As suggested, I have added the `generic` argument to `is_valid_profile` and enhanced the documentation a (tiny) little bit. [My apologies that this took so long - I was busy with other matters.] I now refer to Voevodsky's motivic Steenrod algebra paper as another source that relates to the generic Steenrod algebra - other explicit references are not so easy to find.

It might be nice to also add support for the motivic Steenrod algebra, but I'll leave that for another ticket. Currently my cohomology programs can deal with the classical and the generic case, but not the motivic one, so my interest in the motivic case is not so urgent. It shouldn't be too difficult to implement the motivic version on top of the existing code, though...


---

Comment by cnassau created at 2014-07-06 13:34:00

Changing status from needs_work to needs_review.


---

Comment by git created at 2014-07-22 15:27:59

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2014-07-23 17:20:48

I've made a few small changes:

- added some doctests explicitly involving the mod 2 generic Steenrod algebra. I guess this is mostly not necessary, since the generic code gets tested well at odd primes, but I added these anyway.

- top of the file: added `# -*- coding: utf-8 -*-` so the accent in "Ã‰tudes" wouldn't break docbuilding.

- fixed a pre-existing bug in `_latex_term` for the "pst" basis

- changed the `__contains__` method so that elements in the ordinary mod 2 Steenrod algebra are not contained in the generic version. Is this the right thing to do?

If you're happy with these changes, it can get a positive review.
----
New commits:


---

Comment by cnassau created at 2014-07-24 09:17:56

Replying to [comment:16 jhpalmieri]:
> - changed the `__contains__` method so that elements in the ordinary mod 2 Steenrod algebra are not contained in the generic version. Is this the right thing to do?

Yes, I think so, at least for the moment. It might eventually make sense to think of the generic variant as a quotient of the regular Steenrod algebra - but I'm hesitant to propose such a change right now, as the need for it is not clear to me. I'm also not sure whether one should then follow the Sage `SubQuotient` protocol or just provide some extra logic in the element constructor; currently, the latter sounds more resonable to me.

> If you're happy with these changes, it can get a positive review.

I'm very happy - thanks for all the work you've put into this!


---

Comment by jhpalmieri created at 2014-07-24 14:50:02

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2014-07-25 05:05:39

Resolution: fixed
