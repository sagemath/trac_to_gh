# Issue 31786: Multivariate Generating Functions: cohomology_decomposition fails during lifting

Issue created by migration from https://trac.sagemath.org/ticket/32023

Original creator: behackl

Original creation time: 2021-06-21 15:46:43

CC:  @markcwilson

In the following example, `FractionWithFactoredDenominator.cohomology_decomposition` fails, which might hint at either a mathematical problem, or at an issue with the implementation. The situation has to be debugged carefully.


```
sage: from sage.rings.asymptotic.asymptotics_multivariate_generating_functions import FractionWithFactoredDenominatorRing
sage: R.<x,y,z> = PolynomialRing(QQ)
sage: FFPD = FractionWithFactoredDenominatorRing(R, SR)

sage: H = (1 - (x*y + x*z + y*z + 2*x*y*z))^2
sage: Hfac = H.factor()
sage: G = 1 / Hfac.unit()
sage: F = FFPD(G, Hfac)

sage: F.cohomology_decomposition()
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
[...]

[...]/sage/rings/asymptotic/asymptotics_multivariate_generating_functions.py in cohomology_decomposition(self)
   1377             L = xgcd(qs[0], dets[0])[1:]
   1378         else:
-> 1379             L = R.one().lift(R.ideal(qs + dets))
   1380 
   1381         # Do first iteration of decomposition.

[...]/sage/rings/polynomial/multi_polynomial_libsingular.pyx in sage.rings.polynomial.multi_polynomial_libsingular.MPolynomial_libsingular.lift (build/cythonized/sage/rings/polynomial/multi_polynomial_libsingular.cpp:35674)()
   4572             errorreported = 0
   4573             if errorcode == 1:
-> 4574                 raise ValueError("polynomial is not in the ideal")
   4575             raise RuntimeError
   4576 

ValueError: polynomial is not in the ideal
```

