# Issue 19285: Change default for MILP variables to nonnegative=False

Issue created by migration from Trac.

Original creator: jdemeyer

Original creation time: 2015-11-04 15:53:58

CC:  ncohen

See #15521 and #16504.


---

Comment by jdemeyer created at 2015-11-04 16:32:35

New commits:


---

Comment by jdemeyer created at 2015-11-04 16:32:35

Changing status from new to needs_review.


---

Comment by ncohen created at 2015-11-05 09:25:45

Hellooooo Jeroen,

This look good to me, but could you say why you replace exmples which use the "p[x]" variables with examples that do not use this trick? It was added because it is useful, from time to time, when instead of needing a 'dictionary' of variables you just need 'one' specific variable. With this trick, you avoid needing to create a dictionary that you wouldn't use much otherwise.

Aaaaaaaaand as this trick is pretty unknown, some advertisement cannot hurt `:-)`

Nathann


---

Comment by jdemeyer created at 2015-11-05 10:27:21

Replying to [comment:3 ncohen]:
> why you replace exmples which use the "p[x]" variables with examples that do not use this trick?
Because that trick creates variables with _default_ parameters, which now changed to `nonnegative=False`. So, the restore the old example, I needed to explicitly use `p.new_variable(nonnegative=True)`.


---

Comment by ncohen created at 2015-11-05 10:28:34

Hmmmmmmm.. I see. Would you have anything against fixing that by calling `p.set_min(p['x'],0)` instead?


---

Comment by jdemeyer created at 2015-11-05 12:25:09

Replying to [comment:5 ncohen]:
> Hmmmmmmm.. I see. Would you have anything against fixing that by calling `p.set_min(p['x'],0)` instead?
Yes, I think it's uglier than what I have currently done: you need to do that for every variable separately. Also, `set_min(x, 0)` is less readable than using `nonnegative=True`.


---

Comment by ncohen created at 2015-11-05 12:26:37

That it is uglier is granted, but the syntax has to be illustrated or nobody will know that it exists.


---

Comment by ncohen created at 2015-11-05 12:27:26

Perhaps you could just remove the constraint that those variables are nonnegative, if it plays no role in the example?


---

Comment by jdemeyer created at 2015-11-05 12:27:55

If you really want to fix this properly (not on this ticket), allow setting the default variable parameters in the `MixedIntegerLinearProgram` call:

```
sage: p = MixedIntegerLinearProgram(nonnegative=True, integer=True)
```



---

Comment by jdemeyer created at 2015-11-05 12:29:31

Replying to [comment:7 ncohen]:
> That it is uglier is granted, but the syntax has to be illustrated or nobody will know that it exists.
If "the syntax" often yields ugly code, then perhaps "the syntax" shouldn't be illustrated as much.


---

Comment by ncohen created at 2015-11-05 12:29:49

ARgggggg... No that's scary `O_o`

If the constraint that the variables should be nonnegative is not necessary in the LP you change, then our problem has a trivial solution.

Nathann


---

Comment by jdemeyer created at 2015-11-05 12:30:09

Replying to [comment:8 ncohen]:
> Perhaps you could just remove the constraint that those variables are nonnegative, if it plays no role in the example?
Which example? There are many which I changed.


---

Comment by ncohen created at 2015-11-05 12:31:31

> If "the syntax" often yields ugly code, then perhaps "the syntax" shouldn't be illustrated as much.

There are frequent cases in which it is valid. Let us say that you have many variables `x[v]` and that you want to minimize their maximum. Then you can do this:


```
p.set_objective(p['max'])
for v in g:
    p.add_constraint(x[v] <= p['max'])
```


Is was not added without reason `^^;`


---

Comment by ncohen created at 2015-11-05 12:32:23

> Which example? There are many which I changed.

All those in which you removed the call to `p[whatever]` and created a variable instead.

Nathann


---

Comment by jdemeyer created at 2015-11-05 12:33:57

Replying to [comment:13 ncohen]:
> Is was not added without reason `^^;`

Of course. I just don't think it is justified to make doctests uglier just to show off "the syntax". If the doctest can be expressed naturally using "the syntax", then there is no problem. However, if it requires constructions like `p.set_min(p['x'], 0)`, then perhaps "the syntax" should not be used.


---

Comment by ncohen created at 2015-11-05 12:35:12

Yep. So please check that the nonnegativity plays no role in the examples that you modify, for if it is not required then the syntax can stay, and be elegant.


---

Comment by jdemeyer created at 2015-11-05 12:35:28

Replying to [comment:14 ncohen]:
> > Which example? There are many which I changed.
> 
> All those in which you removed the call to `p[whatever]` and created a variable instead.

It is certainly not true that all those changes can be reverted. I only did this because I got doctest failures.


---

Comment by ncohen created at 2015-11-05 12:37:44

> It is certainly not true that all those changes can be reverted. I only did this because I got doctest failures.

I see. Then please revert those that do not need this change, and I will then go over the others to change the LP if possible. Those LP are just here to provide an illustration of the syntax, there is no harm in modifying them to this end.


---

Comment by git created at 2015-11-05 12:46:47

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2015-11-05 12:48:18

Replying to [comment:18 ncohen]:
> Then please revert those that do not need this change
Done, there was just one.

> I will then go over the others to change the LP if possible.
If you insist. However, make sure you don't introduce conflicts with #19525.


---

Comment by ncohen created at 2015-11-05 12:49:58

> If you insist. However, make sure you don't introduce conflicts with #19525.

I will only touch the doctests that you modify here.

Nathann


---

Comment by ncohen created at 2015-11-05 13:06:12

I added a commit at public/19522. If you agree with it, then you can set this ticket to `positive_review`.

Nathann


---

Comment by jdemeyer created at 2015-11-05 13:19:09

New commits:


---

Comment by jdemeyer created at 2015-11-05 13:20:56

If this makes you a happier man...


---

Comment by jdemeyer created at 2015-11-05 13:20:56

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-11-06 19:04:39

Resolution: fixed
