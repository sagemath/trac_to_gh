# Issue 11647: don't use the deprecated 'new' module

Issue created by migration from Trac.

Original creator: jhpalmieri

Original creation time: 2011-09-20 18:35:12

Assignee: was

The Python module 'new' is deprecated and has been removed in Python 3.0, so since it's not hard to avoid it, we shouldn't use it.  The attached patch removes all imports of 'new', tested with

```
sage: search_src('import', 'new', whole_word=True)
```

The file new.py (in `SAGE_ROOT/local/lib/python/`) contains code like

```
from types import InstanceType as instance
```

so we just have to replace

```
import new
new.instance(...)
```

with

```
import types
types.InstanceType(...)
```



---

Comment by jhpalmieri created at 2011-09-20 18:36:26

Changing status from new to needs_review.


---

Attachment


---

Comment by saraedum created at 2011-12-19 15:09:06

It appears I added some uses of 'new' in #11716. So your patch doesn't apply anymore. I'm trying to do something about it now.


---

Comment by saraedum created at 2011-12-19 15:09:06

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2011-12-19 17:10:12

I made some additional changes. Feel free to set it to positive review if you're ok with these.


---

Comment by saraedum created at 2011-12-19 17:10:19

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2011-12-19 17:10:54

Btw. I'll add doctests to the new functions in #12192.


---

Comment by saraedum created at 2011-12-19 17:41:21

Apply trac_11819_review.patch


---

Comment by jhpalmieri created at 2011-12-19 21:35:35

The doctest 

```
    sage: sage0("'new' in sys.modules")
    False
```

fails for me.  It might be imported by IPython; if I do `sage --ipython`:

```
In [1]: import sys

In [2]: 'new' in sys.modules
Out[2]: True
```

Or more tersely:

```
$ sage --ipython -c "import sys; print 'new' in sys.modules"
True
```



---

Attachment

combined and rebased patch


---

Comment by saraedum created at 2011-12-20 15:08:25

You are right. I must have run the wrong patch somehow. Sorry for that.

I adapted my patch. I it works now.


---

Comment by jhpalmieri created at 2011-12-21 00:28:37

Changing status from needs_review to positive_review.


---

Comment by saraedum created at 2011-12-21 15:22:37

Changing keywords from "" to "sd35".


---

Comment by jdemeyer created at 2012-01-18 08:15:59

Resolution: fixed
