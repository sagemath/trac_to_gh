# Issue 11647: don't use the deprecated 'new' module

archive/issues_011647.json:
```json
{
    "body": "Assignee: @williamstein\n\nKeywords: sd35\n\nThe Python module 'new' is deprecated and has been removed in Python 3.0, so since it's not hard to avoid it, we shouldn't use it.  The attached patch removes all imports of 'new', tested with\n\n```\nsage: search_src('import', 'new', whole_word=True)\n```\nThe file new.py (in `SAGE_ROOT/local/lib/python/`) contains code like\n\n```\nfrom types import InstanceType as instance\n```\nso we just have to replace\n\n```\nimport new\nnew.instance(...)\n```\nwith\n\n```\nimport types\ntypes.InstanceType(...)\n```\n\n---\n\nApply\n\n1. [attachment:trac_11819_review.patch]\n\nto the sage repository\n\nIssue created by migration from https://trac.sagemath.org/ticket/11819\n\n",
    "closed_at": "2012-01-18T08:15:59Z",
    "created_at": "2011-09-20T18:35:12Z",
    "labels": [
        "component: pickling",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.0",
    "title": "don't use the deprecated 'new' module",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/11647",
    "user": "https://github.com/jhpalmieri"
}
```
Assignee: @williamstein

Keywords: sd35

The Python module 'new' is deprecated and has been removed in Python 3.0, so since it's not hard to avoid it, we shouldn't use it.  The attached patch removes all imports of 'new', tested with

```
sage: search_src('import', 'new', whole_word=True)
```
The file new.py (in `SAGE_ROOT/local/lib/python/`) contains code like

```
from types import InstanceType as instance
```
so we just have to replace

```
import new
new.instance(...)
```
with

```
import types
types.InstanceType(...)
```

---

Apply

1. [attachment:trac_11819_review.patch]

to the sage repository

Issue created by migration from https://trac.sagemath.org/ticket/11819





---

archive/issue_comments_131448.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-09-20T18:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131448",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_131449.json:
```json
{
    "body": "Attachment [trac_11819-no-new.patch](tarball://root/attachments/some-uuid/ticket11819/trac_11819-no-new.patch) by @jhpalmieri created at 2011-09-20 18:36:26",
    "created_at": "2011-09-20T18:36:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131449",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_11819-no-new.patch](tarball://root/attachments/some-uuid/ticket11819/trac_11819-no-new.patch) by @jhpalmieri created at 2011-09-20 18:36:26



---

archive/issue_comments_131450.json:
```json
{
    "body": "It appears I added some uses of 'new' in #11716. So your patch doesn't apply anymore. I'm trying to do something about it now.",
    "created_at": "2011-12-19T15:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131450",
    "user": "https://github.com/saraedum"
}
```

It appears I added some uses of 'new' in #11716. So your patch doesn't apply anymore. I'm trying to do something about it now.



---

archive/issue_comments_131451.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-12-19T15:09:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131451",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_131452.json:
```json
{
    "body": "I made some additional changes. Feel free to set it to positive review if you're ok with these.",
    "created_at": "2011-12-19T17:10:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131452",
    "user": "https://github.com/saraedum"
}
```

I made some additional changes. Feel free to set it to positive review if you're ok with these.



---

archive/issue_comments_131453.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-12-19T17:10:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131453",
    "user": "https://github.com/saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_131454.json:
```json
{
    "body": "Btw. I'll add doctests to the new functions in #12192.",
    "created_at": "2011-12-19T17:10:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131454",
    "user": "https://github.com/saraedum"
}
```

Btw. I'll add doctests to the new functions in #12192.



---

archive/issue_comments_131455.json:
```json
{
    "body": "Apply trac_11819_review.patch",
    "created_at": "2011-12-19T17:41:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131455",
    "user": "https://github.com/saraedum"
}
```

Apply trac_11819_review.patch



---

archive/issue_comments_131456.json:
```json
{
    "body": "The doctest \n\n```\n    sage: sage0(\"'new' in sys.modules\")\n    False\n```\nfails for me.  It might be imported by IPython; if I do `sage --ipython`:\n\n```\nIn [1]: import sys\n\nIn [2]: 'new' in sys.modules\nOut[2]: True\n```\nOr more tersely:\n\n```\n$ sage --ipython -c \"import sys; print 'new' in sys.modules\"\nTrue\n```",
    "created_at": "2011-12-19T21:35:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131456",
    "user": "https://github.com/jhpalmieri"
}
```

The doctest 

```
    sage: sage0("'new' in sys.modules")
    False
```
fails for me.  It might be imported by IPython; if I do `sage --ipython`:

```
In [1]: import sys

In [2]: 'new' in sys.modules
Out[2]: True
```
Or more tersely:

```
$ sage --ipython -c "import sys; print 'new' in sys.modules"
True
```



---

archive/issue_comments_131457.json:
```json
{
    "body": "Attachment [trac_11819_review.patch](tarball://root/attachments/some-uuid/ticket11819/trac_11819_review.patch) by @saraedum created at 2011-12-20 13:30:35\n\ncombined and rebased patch",
    "created_at": "2011-12-20T13:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131457",
    "user": "https://github.com/saraedum"
}
```

Attachment [trac_11819_review.patch](tarball://root/attachments/some-uuid/ticket11819/trac_11819_review.patch) by @saraedum created at 2011-12-20 13:30:35

combined and rebased patch



---

archive/issue_comments_131458.json:
```json
{
    "body": "You are right. I must have run the wrong patch somehow. Sorry for that.\n\nI adapted my patch. I it works now.",
    "created_at": "2011-12-20T15:08:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131458",
    "user": "https://github.com/saraedum"
}
```

You are right. I must have run the wrong patch somehow. Sorry for that.

I adapted my patch. I it works now.



---

archive/issue_comments_131459.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-12-21T00:28:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131459",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_131460.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd35\".",
    "created_at": "2011-12-21T15:22:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131460",
    "user": "https://github.com/saraedum"
}
```

Changing keywords from "" to "sd35".



---

archive/issue_events_031158.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-12-22T16:41:05Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11647#event-31158"
}
```



---

archive/issue_comments_131461.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-01-18T08:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/11647#issuecomment-131461",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_031159.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-01-18T08:15:59Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/11647",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/11647#event-31159"
}
```
