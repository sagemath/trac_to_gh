# Issue 24467: ppl build fails with clang-5.0

Issue created by migration from https://trac.sagemath.org/ticket/24704

Original creator: rws

Original creation time: 2018-02-10 14:07:30


```
In file included from Box.cc:25:
In file included from ./Box_defs.hh:2286:
In file included from ./Box_templates.hh:38:
In file included from ./BD_Shape_defs.hh:2371:
In file included from ./BD_Shape_inlines.hh:31:
In file included from ./Octagonal_Shape_defs.hh:36:
In file included from ./OR_Matrix_defs.hh:608:
./OR_Matrix_inlines.hh:100:8: error: missing 'typename' prior to dependent type 
template name 'OR_Matrix<T>::Pseudo_Row'
inline OR_Matrix<T>::Pseudo_Row<U>&
```

This is OpeSuSE. There are also reports on Debian and FreeBSD on the net. clang-4.0.1 is fine.


---

Attachment


---

Comment by rws created at 2018-02-10 14:28:26

Seems a simple omission:
https://stackoverflow.com/questions/610245/where-and-why-do-i-have-to-put-the-template-and-typename-keywords

Will provide a patch here.


---

Comment by dimpase created at 2018-02-11 01:02:02

see https://www.cs.unipr.it/mantis/view.php?id=2128

I repored this in Sept 2017, but upstream was not happy due to my patch not working on gcc 4.4.3...


---

Comment by dimpase created at 2018-02-11 08:58:54

here is the fix from PPLs repo:
http://www.cs.unipr.it/git/gitweb.cgi?p=ppl/ppl.git;a=commit;h=c39f6a07b51f89e365b05ba4147aa2aa448febd7


---

Comment by fbissey created at 2018-02-12 01:02:28

Really stealing your hard work there. Currently doc-testing a full clang-5 build. Everything built OK after applying this and dealing with #24712.
----
New commits:


---

Comment by fbissey created at 2018-02-12 01:02:28

Changing status from new to needs_review.


---

Comment by fbissey created at 2018-02-12 01:02:28

Changing component from build to porting.


---

Comment by fbissey created at 2018-02-12 01:35:09

All doctests pass with clang-5.0.1.


---

Comment by rws created at 2018-02-12 04:14:28

How do you get over #24705? Which compiler flags do you set?


---

Comment by fbissey created at 2018-02-12 04:18:27

Replying to [comment:6 rws]:
> How do you get over #24705? Which compiler flags do you set?

Nothing. It just works on my Gentoo box. I assume that -lstdc++ is just ignored when libc++ is the default.


---

Comment by fbissey created at 2018-02-14 21:39:27

Reviews anyone?


---

Comment by dimpase created at 2018-02-15 11:35:12

This works (and has been working for me since ages).

I don't know why upstream says it's their version of a patch - it's the exact copy of what I proposed.


---

Comment by dimpase created at 2018-02-15 11:35:12

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-02-18 12:52:33

Resolution: fixed
