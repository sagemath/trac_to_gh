# Issue 17794: Bug in saturation for elliptic curves over Q

Issue created by migration from https://trac.sagemath.org/ticket/18031

Original creator: cremona

Original creation time: 2015-03-21 14:38:50

Keywords: saturation

A bug in eclib's saturation function is revealed here:

```
sage: E = EllipticCurve([0,-1,1,-266,968])
sage: Q1 = E([-1995,3674,125])
sage: Q2 = E([157,1950,1])
sage: E.saturation([Q1,Q2])                                                                                     
([(-399/25 : 3674/125 : 1), (157 : 1950 : 1)], 1, 7.21429780216482)
sage: P1, P2 = E.gens()                                                                                         
sage: E.regulator()
0.801588644684980
sage: E.regulator_of_points([Q1,Q2])
7.21429780216482
```

The points Q1,Q2 generate a subgroup of index 3 but the computed bound on the index is between 2 and 3.  This will be fixed upstream.

Note that for this curve E.gens() gives correct generators but E.simon_two_descent() gives the above two points.


---

Comment by cremona created at 2015-03-21 17:42:54

Bug in eclib fixed.  After testing, will update the upstream sources and the package information.


---

Comment by cremona created at 2015-03-23 21:47:33

With upstream eclib-20150323:

```
sage: E = EllipticCurve([0,-1,1,-266,968])
sage: Q1 = E([-1995,3674,125])
sage: Q2 = E([157,1950,1])
sage: E.saturation([Q1,Q2])
([(1 : -27 : 1), (157 : 1950 : 1)], 3, 0.801588644684981)
```

which will be put in as a doctest.


---

Comment by cremona created at 2015-03-23 21:57:36

New commits:


---

Comment by cremona created at 2015-03-23 21:58:07

Changing status from new to needs_review.


---

Comment by fbissey created at 2015-03-24 02:50:07

lgtm


---

Comment by fbissey created at 2015-03-24 02:50:07

Changing status from needs_review to positive_review.


---

Comment by cremona created at 2015-03-24 12:09:02

Thanks!

Release manager -- compared to 20150228 which was already merged, this only changes one source file, there are no API changes so this is a minor bug-fix release.  Sorry it comes so soon after the previous one, but that's when I discovered the bug.


---

Comment by fbissey created at 2015-03-24 18:19:24

I am making this a blocker, that'll get Volker's attention.


---

Comment by fbissey created at 2015-03-24 18:19:24

Changing priority from major to blocker.


---

Comment by vbraun created at 2015-03-25 00:26:44

Resolution: fixed
