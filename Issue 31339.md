# Issue 31339: Projective points over rings with zero divisors

archive/issues_031339.json:
```json
{
    "body": "CC:  @bhutz jdefaria @slel\n\nKeywords: projective points\n\nCurrently a point of a projective space over a ring is an accepted input unless all coordinates are zero. For instance,\n\n```\nsage: P2 = ProjectiveSpace(Integers(15),2)      \nsage: P2(3,3,3)                                                                                                                                        \n(3 : 3 : 3)\n```\n\nis allowed.\nThat is a bad convention as they should only be allowed if they generate the ring. Here, at least one entry must be a unit.\n\nThe equality between points is tested by the equations `x[i]*y[j]=x[j]*y[i]`\nWith the troublesome entries above this results in errors like\n\n```\nsage: a = P2(3,3,3)\nsage: a2 = P2(1,1,1)                                                                                                                                   \nsage: b = P2(5,-5,5)                                                                                                                                   \nsage: b2 = P2(1,-1,1)\nsage: [a2==a,a==b,b==b2,b2==a2]    \n[True, True, True, False]\n```\n\n    \nIt seems this code was last modified in #17433, so I CC these authors there.\n\nIssue created by migration from https://trac.sagemath.org/ticket/31576\n\n",
    "created_at": "2021-03-28T21:02:14Z",
    "labels": [
        "component: algebraic geometry",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.6",
    "title": "Projective points over rings with zero divisors",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/31339",
    "user": "https://github.com/categorie"
}
```
CC:  @bhutz jdefaria @slel

Keywords: projective points

Currently a point of a projective space over a ring is an accepted input unless all coordinates are zero. For instance,

```
sage: P2 = ProjectiveSpace(Integers(15),2)      
sage: P2(3,3,3)                                                                                                                                        
(3 : 3 : 3)
```

is allowed.
That is a bad convention as they should only be allowed if they generate the ring. Here, at least one entry must be a unit.

The equality between points is tested by the equations `x[i]*y[j]=x[j]*y[i]`
With the troublesome entries above this results in errors like

```
sage: a = P2(3,3,3)
sage: a2 = P2(1,1,1)                                                                                                                                   
sage: b = P2(5,-5,5)                                                                                                                                   
sage: b2 = P2(1,-1,1)
sage: [a2==a,a==b,b==b2,b2==a2]    
[True, True, True, False]
```

    
It seems this code was last modified in #17433, so I CC these authors there.

Issue created by migration from https://trac.sagemath.org/ticket/31576





---

archive/issue_comments_447648.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2022-01-28T08:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447648",
    "user": "https://github.com/yyyyx4"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_447649.json:
```json
{
    "body": "New commits:",
    "created_at": "2022-01-28T08:00:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447649",
    "user": "https://github.com/yyyyx4"
}
```

New commits:



---

archive/issue_comments_447650.json:
```json
{
    "body": "I disagree with the ticket's summary.\n\nThe projective space over `Z/m`, with m composite,\nhas two types of points:\n\n- points whose coordinates generate the ring\n- points whose coordinates do not generate the ring\n\nBoth types of points are valid. See\n\n- [Wikipedia: Projective line over a ring](https://en.wikipedia.org/wiki/Projective_line_over_a_ring)\n\nPhrased otherwise, not all lines in `(Z/m)^n`\nhave the same number of points.\n\nSometimes only points of the first type matter,\nother times both types are useful.",
    "created_at": "2022-01-28T09:43:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447650",
    "user": "https://github.com/slel"
}
```

I disagree with the ticket's summary.

The projective space over `Z/m`, with m composite,
has two types of points:

- points whose coordinates generate the ring
- points whose coordinates do not generate the ring

Both types of points are valid. See

- [Wikipedia: Projective line over a ring](https://en.wikipedia.org/wiki/Projective_line_over_a_ring)

Phrased otherwise, not all lines in `(Z/m)^n`
have the same number of points.

Sometimes only points of the first type matter,
other times both types are useful.



---

archive/issue_comments_447651.json:
```json
{
    "body": "Replying to [comment:5 slelievre]:\n> The projective space over `Z/m`, with m composite,\n> has two types of points:\n> \n> - points whose coordinates generate the ring\n> - points whose coordinates do not generate the ring\n\nNo, I disagree and the linked page as well! A point in `P^n` over a ring `R` is `(x_0:..x_n)` with `x_0R+...+x_nR = R` quotient by the equivalence relation which is scaling by units in `R`.\nYour second kind is not a point. This agrees with viewing `P^n` as a scheme over R and taking its `R`-valued points. It follows that `P^1(Z/pq)` is `P^1(Z/p) x P^1(Z/q)`, that it is the union of affine patches as usual, etc.\n\nYour confusion may stem from the following: Not every equivalence class has the same number of elements in `R^(n+1)`. But that is not the issue here (or ever when dealing projective geometry, I believe).",
    "created_at": "2022-01-28T10:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447651",
    "user": "https://github.com/categorie"
}
```

Replying to [comment:5 slelievre]:
> The projective space over `Z/m`, with m composite,
> has two types of points:
> 
> - points whose coordinates generate the ring
> - points whose coordinates do not generate the ring

No, I disagree and the linked page as well! A point in `P^n` over a ring `R` is `(x_0:..x_n)` with `x_0R+...+x_nR = R` quotient by the equivalence relation which is scaling by units in `R`.
Your second kind is not a point. This agrees with viewing `P^n` as a scheme over R and taking its `R`-valued points. It follows that `P^1(Z/pq)` is `P^1(Z/p) x P^1(Z/q)`, that it is the union of affine patches as usual, etc.

Your confusion may stem from the following: Not every equivalence class has the same number of elements in `R^(n+1)`. But that is not the issue here (or ever when dealing projective geometry, I believe).



---

archive/issue_comments_447652.json:
```json
{
    "body": "You are of course right. Thanks for unconfusing me.\n\nDoes the documentation have examples such as the following?\n\n```\nsage: P1 = ProjectiveSpace(Zmod(6), 1)\nsage: P1(2, 3)\n```\n",
    "created_at": "2022-01-29T11:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447652",
    "user": "https://github.com/slel"
}
```

You are of course right. Thanks for unconfusing me.

Does the documentation have examples such as the following?

```
sage: P1 = ProjectiveSpace(Zmod(6), 1)
sage: P1(2, 3)
```




---

archive/issue_comments_447653.json:
```json
{
    "body": "Looks good.\n\nOptionally, wrap long lines, e.g. as follows.\n\n\n```diff\n-                    raise ValueError(f\"{v} does not define a point in {X.codomain()} since all entries are zero\")\n+                    raise ValueError(f\"{v} does not define a point \"\n+                                     f\"in {X.codomain()} \"\n+                                     \"since all entries are zero\")\n```\n\n\n\n```diff\n-                    raise ValueError(f\"{v} does not define a point in {X.codomain()} since it is a multiple of a zero divisor\")\n+                    raise ValueError(f\"{v} does not define a point \"\n+                                     f\"in {X.codomain()} since it is \"\n+                                     \"a multiple of a zero divisor\")\n```\n",
    "created_at": "2022-01-29T11:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447653",
    "user": "https://github.com/slel"
}
```

Looks good.

Optionally, wrap long lines, e.g. as follows.


```diff
-                    raise ValueError(f"{v} does not define a point in {X.codomain()} since all entries are zero")
+                    raise ValueError(f"{v} does not define a point "
+                                     f"in {X.codomain()} "
+                                     "since all entries are zero")
```



```diff
-                    raise ValueError(f"{v} does not define a point in {X.codomain()} since it is a multiple of a zero divisor")
+                    raise ValueError(f"{v} does not define a point "
+                                     f"in {X.codomain()} since it is "
+                                     "a multiple of a zero divisor")
```




---

archive/issue_comments_447654.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-01-29T17:05:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447654",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447655.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-01-29T17:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447655",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447656.json:
```json
{
    "body": "Done, and also fixed some more doctests. The remaining failures should disappear with #33237.",
    "created_at": "2022-01-29T17:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447656",
    "user": "https://github.com/yyyyx4"
}
```

Done, and also fixed some more doctests. The remaining failures should disappear with #33237.



---

archive/issue_comments_447657.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2022-02-21T05:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447657",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_447658.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2022-02-22T05:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447658",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_447659.json:
```json
{
    "body": "The latest changes LGTM. Given comment:8, I am setting a positive review.",
    "created_at": "2022-02-22T05:02:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447659",
    "user": "https://github.com/tscrim"
}
```

The latest changes LGTM. Given comment:8, I am setting a positive review.



---

archive/issue_events_028658.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2022-02-27T22:00:45Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/31339#event-28658"
}
```



---

archive/issue_comments_447660.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2022-02-27T22:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/31339",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/31339#issuecomment-447660",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
