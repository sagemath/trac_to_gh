# Issue 22623: ticket #22840 causes breakage with some linkers when the order is important.

archive/issues_022623.json:
```json
{
    "body": "CC:  @dimpase @jm58660 @tscrim @strogdon\n\nAfter #22840 was merged and released as part of 8.0.beta3 users of ubuntu 16.04.4 started to complain that `lcalc` couldn't be built\n\n```\ng++ -O3   -ffast-math -fPIC   -I../include -L/home/travis/sage-build/local/lib -Wl,-rpath,/home/travis/sage-build/local/lib  -L/home/travis/sage-build/local/lib -lpari -lgmp -L/home/travis/sage-build/local/lib -lpari -lgmp Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandline.o cmdline.o -o lcalc \nLcommandline_elliptic.o: In function `cxcompotor.constprop.52':\nLcommandline_elliptic.cc:(.text+0x44): undefined reference to `pari_err'\nLcommandline_elliptic.cc:(.text+0x63): undefined reference to `avma'\nLcommandline_elliptic.cc:(.text+0x6a): undefined reference to `pari_mainstack'\nLcommandline_elliptic.cc:(.text+0xa3): undefined reference to `affir'\nLcommandline_elliptic.cc:(.text+0xc3): undefined reference to `avma'\n...\n...\nLcommandline_elliptic.cc:(.text+0x1289): undefined reference to `new_chunk_resize'\nLcommandline.o: In function `main':\nLcommandline.cc:(.text.startup+0x8d5): undefined reference to `pari_init'\nLcommandline.cc:(.text.startup+0x14ba): undefined reference to `paristack_setsize'\ncollect2: error: ld returned 1 exit status\n```\n\nThis is a perfect example were the libraries need to be after the objects needed them in some linkers.\n\nIssue created by migration from https://trac.sagemath.org/ticket/22860\n\n",
    "created_at": "2017-04-24T04:01:20Z",
    "labels": [
        "component: packages: standard",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "ticket #22840 causes breakage with some linkers when the order is important.",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22623",
    "user": "https://github.com/kiwifb"
}
```
CC:  @dimpase @jm58660 @tscrim @strogdon

After #22840 was merged and released as part of 8.0.beta3 users of ubuntu 16.04.4 started to complain that `lcalc` couldn't be built

```
g++ -O3   -ffast-math -fPIC   -I../include -L/home/travis/sage-build/local/lib -Wl,-rpath,/home/travis/sage-build/local/lib  -L/home/travis/sage-build/local/lib -lpari -lgmp -L/home/travis/sage-build/local/lib -lpari -lgmp Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandline.o cmdline.o -o lcalc 
Lcommandline_elliptic.o: In function `cxcompotor.constprop.52':
Lcommandline_elliptic.cc:(.text+0x44): undefined reference to `pari_err'
Lcommandline_elliptic.cc:(.text+0x63): undefined reference to `avma'
Lcommandline_elliptic.cc:(.text+0x6a): undefined reference to `pari_mainstack'
Lcommandline_elliptic.cc:(.text+0xa3): undefined reference to `affir'
Lcommandline_elliptic.cc:(.text+0xc3): undefined reference to `avma'
...
...
Lcommandline_elliptic.cc:(.text+0x1289): undefined reference to `new_chunk_resize'
Lcommandline.o: In function `main':
Lcommandline.cc:(.text.startup+0x8d5): undefined reference to `pari_init'
Lcommandline.cc:(.text.startup+0x14ba): undefined reference to `paristack_setsize'
collect2: error: ld returned 1 exit status
```

This is a perfect example were the libraries need to be after the objects needed them in some linkers.

Issue created by migration from https://trac.sagemath.org/ticket/22860





---

archive/issue_comments_315320.json:
```json
{
    "body": "Dima, I will move LDFLAGS after the objects file in those makefiles. If this isn't working for you we'll have to do some split between flags proper and `LIBS`.",
    "created_at": "2017-04-24T04:02:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315320",
    "user": "https://github.com/kiwifb"
}
```

Dima, I will move LDFLAGS after the objects file in those makefiles. If this isn't working for you we'll have to do some split between flags proper and `LIBS`.



---

archive/issue_comments_315321.json:
```json
{
    "body": "I think only `lcalc` has an issue but looking closer I think LDFLAGS should be separated from \"`PARI_LIBS`\". Can you tell me what's in your LDFLAGS on freeBSD?",
    "created_at": "2017-04-24T04:43:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315321",
    "user": "https://github.com/kiwifb"
}
```

I think only `lcalc` has an issue but looking closer I think LDFLAGS should be separated from "`PARI_LIBS`". Can you tell me what's in your LDFLAGS on freeBSD?



---

archive/issue_comments_315322.json:
```json
{
    "body": "Cc'ing myself. Got same error on two different Ubuntu 16.04 LTS machines.",
    "created_at": "2017-04-24T06:17:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315322",
    "user": "https://github.com/jm58660"
}
```

Cc'ing myself. Got same error on two different Ubuntu 16.04 LTS machines.



---

archive/issue_comments_315323.json:
```json
{
    "body": "Changing status from new to needs_info.",
    "created_at": "2017-04-24T07:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315323",
    "user": "https://github.com/kiwifb"
}
```

Changing status from new to needs_info.



---

archive/issue_comments_315324.json:
```json
{
    "body": "OK here is a quick branch to test and give feedback on. But I am waiting for comments from Dima on freeBSD before putting to review #22840 was motivated by linking issues on freeBSD and I don't want to go backwards on that.\n----\nNew commits:",
    "created_at": "2017-04-24T07:25:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315324",
    "user": "https://github.com/kiwifb"
}
```

OK here is a quick branch to test and give feedback on. But I am waiting for comments from Dima on freeBSD before putting to review #22840 was motivated by linking issues on freeBSD and I don't want to go backwards on that.
----
New commits:



---

archive/issue_comments_315325.json:
```json
{
    "body": "On FreeBSD I have\n`LDFLAGS=-L/usr/home/dima/Sage/sage/local/lib -Wl,--add-needed -lm`\n\nAnd this is the (working) command in question:\n\n```\nclang++-devel -fPIC -pipe -O3   -ffast-math -fPIC   -I../include -L/usr/home/dima/Sage/sage/local/lib -Wl,-rpath,/usr/home/dima/Sage/\nsage/local/lib -L/usr/home/dima/Sage/sage/local/lib -Wl,--add-needed -lm -L/usr/home/dima/Sage/sage/local/lib -lpari -lgmp -L/usr/hom\ne/dima/Sage/sage/local/lib -lpari -lgmp Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals\n.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandl\nine.o cmdline.o -o lcalc \n```\n",
    "created_at": "2017-04-24T07:44:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315325",
    "user": "https://github.com/dimpase"
}
```

On FreeBSD I have
`LDFLAGS=-L/usr/home/dima/Sage/sage/local/lib -Wl,--add-needed -lm`

And this is the (working) command in question:

```
clang++-devel -fPIC -pipe -O3   -ffast-math -fPIC   -I../include -L/usr/home/dima/Sage/sage/local/lib -Wl,-rpath,/usr/home/dima/Sage/
sage/local/lib -L/usr/home/dima/Sage/sage/local/lib -Wl,--add-needed -lm -L/usr/home/dima/Sage/sage/local/lib -lpari -lgmp -L/usr/hom
e/dima/Sage/sage/local/lib -lpari -lgmp Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals
.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandl
ine.o cmdline.o -o lcalc 
```




---

archive/issue_comments_315326.json:
```json
{
    "body": "Strangely, patchbots (one of then Ubuntu 16.04) had no problem with #22840.",
    "created_at": "2017-04-24T07:46:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315326",
    "user": "https://github.com/dimpase"
}
```

Strangely, patchbots (one of then Ubuntu 16.04) had no problem with #22840.



---

archive/issue_comments_315327.json:
```json
{
    "body": "OK, `-Wl,--add-needed` probably shield you from a lot of stuff. In any case it should work with this branch. You guys can start trashing it, it was a quicky so there may be a mistake or two lurking.",
    "created_at": "2017-04-24T08:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315327",
    "user": "https://github.com/kiwifb"
}
```

OK, `-Wl,--add-needed` probably shield you from a lot of stuff. In any case it should work with this branch. You guys can start trashing it, it was a quicky so there may be a mistake or two lurking.



---

archive/issue_comments_315328.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2017-04-24T08:19:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315328",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_315329.json:
```json
{
    "body": "`--add-needed` is necessary for the extra `libm` we install on FreeBSD, and which is linked to the \"real\" `libm`.\n\nBy the way, \n\n```\n-+\t$(MAKE) libLfunction$(LIBEXT)\n-+\t$(MAKE) lcalc$(EXEEXT)\n++\t$(MAKE) libLfunction.so\n++\t$(MAKE) lcalc\n```\n\nlooks too optimistic for OSX, don't we get `.dynlib` rather than `.so`, and too optimistic for Cygwin, where we get `.exe` for executables.",
    "created_at": "2017-04-24T08:27:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315329",
    "user": "https://github.com/dimpase"
}
```

`--add-needed` is necessary for the extra `libm` we install on FreeBSD, and which is linked to the "real" `libm`.

By the way, 

```
-+	$(MAKE) libLfunction$(LIBEXT)
-+	$(MAKE) lcalc$(EXEEXT)
++	$(MAKE) libLfunction.so
++	$(MAKE) lcalc
```

looks too optimistic for OSX, don't we get `.dynlib` rather than `.so`, and too optimistic for Cygwin, where we get `.exe` for executables.



---

archive/issue_comments_315330.json:
```json
{
    "body": "Thanks, I missed these. I should have had a look at a diff of the patch. Correcting shortly.",
    "created_at": "2017-04-24T08:53:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315330",
    "user": "https://github.com/kiwifb"
}
```

Thanks, I missed these. I should have had a look at a diff of the patch. Correcting shortly.



---

archive/issue_comments_315331.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-24T09:05:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315331",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315332.json:
```json
{
    "body": "OK, so for the review I am expecting testing from Dima on freeBSD, someone on ubuntu 16.04.4 and Steve Trogdon on Gentoo with `--as-needed` in LDFLAGS.",
    "created_at": "2017-04-24T09:08:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315332",
    "user": "https://github.com/kiwifb"
}
```

OK, so for the review I am expecting testing from Dima on freeBSD, someone on ubuntu 16.04.4 and Steve Trogdon on Gentoo with `--as-needed` in LDFLAGS.



---

archive/issue_comments_315333.json:
```json
{
    "body": "\n```\n-+\trm -f *.o lcalc libLfunction$(LIBEXT) example_programs/example\n++\trm -f *.o lcalc$(EXEEXT) libLfunction$(LIBEXT) example_programs/example\n```\n\nshould be `example_programs/example$(EXEEXT)` at the 2nd line",
    "created_at": "2017-04-24T09:18:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315333",
    "user": "https://github.com/dimpase"
}
```


```
-+	rm -f *.o lcalc libLfunction$(LIBEXT) example_programs/example
++	rm -f *.o lcalc$(EXEEXT) libLfunction$(LIBEXT) example_programs/example
```

should be `example_programs/example$(EXEEXT)` at the 2nd line



---

archive/issue_comments_315334.json:
```json
{
    "body": "Replying to [comment:13 dimpase]:\n> {{{\n> -+\trm -f *.o lcalc libLfunction$(LIBEXT) example_programs/example\n> ++\trm -f *.o lcalc$(EXEEXT) libLfunction$(LIBEXT) example_programs/example\n> }}}\n> should be `example_programs/example$(EXEEXT)` at the 2nd line\n\nIf you look at the original Makefile.patch you will note that `$(EXEEXT)` has never been appended to `example` neither here or the earlier rule to build it. Neither did you in your patch revision. Nothing in spkg-install or spkg-build will ever call that target, it has only been amended for some measure of consistency but someone (probably working on cygwin) didn't see the point in adding that bit.",
    "created_at": "2017-04-24T09:26:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315334",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:13 dimpase]:
> {{{
> -+	rm -f *.o lcalc libLfunction$(LIBEXT) example_programs/example
> ++	rm -f *.o lcalc$(EXEEXT) libLfunction$(LIBEXT) example_programs/example
> }}}
> should be `example_programs/example$(EXEEXT)` at the 2nd line

If you look at the original Makefile.patch you will note that `$(EXEEXT)` has never been appended to `example` neither here or the earlier rule to build it. Neither did you in your patch revision. Nothing in spkg-install or spkg-build will ever call that target, it has only been amended for some measure of consistency but someone (probably working on cygwin) didn't see the point in adding that bit.



---

archive/issue_comments_315335.json:
```json
{
    "body": "Replying to [comment:14 fbissey]:\n> Replying to [comment:13 dimpase]:\n> > {{{\n> > -+\trm -f *.o lcalc libLfunction$(LIBEXT) example_programs/example\n> > ++\trm -f *.o lcalc$(EXEEXT) libLfunction$(LIBEXT) example_programs/example\n> > }}}\n> > should be `example_programs/example$(EXEEXT)` at the 2nd line\n> \n> If you look at the original Makefile.patch you will note that `$(EXEEXT)` has never been appended to `example` neither here or the earlier rule to build it. Neither did you in your patch revision. Nothing in spkg-install or spkg-build will ever call that target, it has only been amended for some measure of consistency but someone (probably working on cygwin) didn't see the point in adding that bit.\n\nI think on Windows you'd get `.exe` appended to an executable even if `-o ...` does not mention it. And then you need to remove the file with the `.exe` extension.",
    "created_at": "2017-04-24T09:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315335",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:14 fbissey]:
> Replying to [comment:13 dimpase]:
> > {{{
> > -+	rm -f *.o lcalc libLfunction$(LIBEXT) example_programs/example
> > ++	rm -f *.o lcalc$(EXEEXT) libLfunction$(LIBEXT) example_programs/example
> > }}}
> > should be `example_programs/example$(EXEEXT)` at the 2nd line
> 
> If you look at the original Makefile.patch you will note that `$(EXEEXT)` has never been appended to `example` neither here or the earlier rule to build it. Neither did you in your patch revision. Nothing in spkg-install or spkg-build will ever call that target, it has only been amended for some measure of consistency but someone (probably working on cygwin) didn't see the point in adding that bit.

I think on Windows you'd get `.exe` appended to an executable even if `-o ...` does not mention it. And then you need to remove the file with the `.exe` extension.



---

archive/issue_comments_315336.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-24T10:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315336",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315337.json:
```json
{
    "body": "OK things are more consistent now.",
    "created_at": "2017-04-24T10:11:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315337",
    "user": "https://github.com/kiwifb"
}
```

OK things are more consistent now.



---

archive/issue_comments_315338.json:
```json
{
    "body": "Replying to [comment:12 fbissey]:\n> OK, so for the review I am expecting testing from Dima on freeBSD, someone on ubuntu 16.04.4 \nI confirm that pulling the ticket branch in Sage 8.0.beta3 sources (from a fresh git clone) yields a successful built on Ubuntu 16.04 (it failed otherwise).",
    "created_at": "2017-04-24T11:20:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315338",
    "user": "https://github.com/egourgoulhon"
}
```

Replying to [comment:12 fbissey]:
> OK, so for the review I am expecting testing from Dima on freeBSD, someone on ubuntu 16.04.4 
I confirm that pulling the ticket branch in Sage 8.0.beta3 sources (from a fresh git clone) yields a successful built on Ubuntu 16.04 (it failed otherwise).



---

archive/issue_comments_315339.json:
```json
{
    "body": "OK, this works on FreeBSD.",
    "created_at": "2017-04-24T13:08:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315339",
    "user": "https://github.com/dimpase"
}
```

OK, this works on FreeBSD.



---

archive/issue_comments_315340.json:
```json
{
    "body": "Worked for me on linux. I'm going to try on Cygwin in a minute.",
    "created_at": "2017-04-24T13:30:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315340",
    "user": "https://github.com/tscrim"
}
```

Worked for me on linux. I'm going to try on Cygwin in a minute.



---

archive/issue_comments_315341.json:
```json
{
    "body": "Builds here on Gentoo with `LDFLAGS=-Wl,-O1 -Wl,--as-needed` with a slightly different ordering of linked libs\n\n```\ng++ -O3   -ffast-math -fPIC   -I../include -L/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-rpath,/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-O1 -Wl,--as-needed Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandline.o cmdline.o -o lcalc -L/64bitdev/storage/sage-git_develop/sage/local/lib -lpari -lgmp -lm\n```\n",
    "created_at": "2017-04-24T14:39:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315341",
    "user": "https://github.com/strogdon"
}
```

Builds here on Gentoo with `LDFLAGS=-Wl,-O1 -Wl,--as-needed` with a slightly different ordering of linked libs

```
g++ -O3   -ffast-math -fPIC   -I../include -L/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-rpath,/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-O1 -Wl,--as-needed Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandline.o cmdline.o -o lcalc -L/64bitdev/storage/sage-git_develop/sage/local/lib -lpari -lgmp -lm
```




---

archive/issue_comments_315342.json:
```json
{
    "body": "Replying to [comment:21 strogdon]:\n> Builds here on Gentoo with `LDFLAGS=-Wl,-O1 -Wl,--as-needed` with a slightly different ordering of linked libs\n> {{{\n> g++ -O3   -ffast-math -fPIC   -I../include -L/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-rpath,/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-O1 -Wl,--as-needed Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandline.o cmdline.o -o lcalc -L/64bitdev/storage/sage-git_develop/sage/local/lib -lpari -lgmp -lm\n> }}}\nI'm curious about the `-L/64bitdev/storage/sage-git_develop/sage/local/lib -lpari -lgmp -lm` that appears above. In particular the `-lm` that wasn't present when it failed. I have no `libm.so` under `64bitdev/storage/sage-git_develop/sage/local/lib`. I don't think it's needed. But why does it appear?",
    "created_at": "2017-04-24T16:30:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315342",
    "user": "https://github.com/strogdon"
}
```

Replying to [comment:21 strogdon]:
> Builds here on Gentoo with `LDFLAGS=-Wl,-O1 -Wl,--as-needed` with a slightly different ordering of linked libs
> {{{
> g++ -O3   -ffast-math -fPIC   -I../include -L/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-rpath,/64bitdev/storage/sage-git_develop/sage/local/lib -Wl,-O1 -Wl,--as-needed Lglobals.o Lgamma.o Lriemannsiegel.o Lriemannsiegel_blfi.o Ldokchitser.o Lcommandline_globals.o Lcommandline_misc.o Lcommandline_numbertheory.o Lcommandline_values_zeros.o Lcommandline_elliptic.o Lcommandline_twist.o Lcommandline.o cmdline.o -o lcalc -L/64bitdev/storage/sage-git_develop/sage/local/lib -lpari -lgmp -lm
> }}}
I'm curious about the `-L/64bitdev/storage/sage-git_develop/sage/local/lib -lpari -lgmp -lm` that appears above. In particular the `-lm` that wasn't present when it failed. I have no `libm.so` under `64bitdev/storage/sage-git_develop/sage/local/lib`. I don't think it's needed. But why does it appear?



---

archive/issue_comments_315343.json:
```json
{
    "body": "I see, the `-lm` is now in the Makefile. Is it needed?",
    "created_at": "2017-04-24T16:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315343",
    "user": "https://github.com/strogdon"
}
```

I see, the `-lm` is now in the Makefile. Is it needed?



---

archive/issue_comments_315344.json:
```json
{
    "body": "This built for me without problems on Cygwin.",
    "created_at": "2017-04-24T16:54:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315344",
    "user": "https://github.com/tscrim"
}
```

This built for me without problems on Cygwin.



---

archive/issue_comments_315345.json:
```json
{
    "body": "Replying to [comment:23 strogdon]:\n> I see, the `-lm` is now in the Makefile. Is it needed?\n\nPossibly not, I am just not taking chances in case someone has a system with somewhat broken dynamic libraries. Both pari and gmp use libm.",
    "created_at": "2017-04-24T18:36:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315345",
    "user": "https://github.com/kiwifb"
}
```

Replying to [comment:23 strogdon]:
> I see, the `-lm` is now in the Makefile. Is it needed?

Possibly not, I am just not taking chances in case someone has a system with somewhat broken dynamic libraries. Both pari and gmp use libm.



---

archive/issue_comments_315346.json:
```json
{
    "body": "I think that's enough reviews :)",
    "created_at": "2017-04-24T22:06:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315346",
    "user": "https://github.com/kiwifb"
}
```

I think that's enough reviews :)



---

archive/issue_comments_315347.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-04-24T22:06:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315347",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_315348.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-04-25T04:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315348",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_315349.json:
```json
{
    "body": "Don't forget to bump the patchlevel (you can set this back to positive_review after you did that).",
    "created_at": "2017-04-25T04:33:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315349",
    "user": "https://github.com/jdemeyer"
}
```

Don't forget to bump the patchlevel (you can set this back to positive_review after you did that).



---

archive/issue_comments_315350.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-04-25T05:35:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315350",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_315351.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-04-25T05:35:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315351",
    "user": "https://github.com/kiwifb"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_315352.json:
```json
{
    "body": "Is there still an upstream for lcalc where to forward our patches?",
    "created_at": "2017-04-25T11:44:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315352",
    "user": "https://trac.sagemath.org/admin/accounts/users/jpflori"
}
```

Is there still an upstream for lcalc where to forward our patches?



---

archive/issue_comments_315353.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-04-27T20:11:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22623#issuecomment-315353",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_021273.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2017-04-27T20:11:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/22623",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/22623#event-21273"
}
```
