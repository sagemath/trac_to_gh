# Issue 18997: gsl doesn't build with Xcode 7.0

Issue created by migration from https://trac.sagemath.org/ticket/19234

Original creator: jhpalmieri

Original creation time: 2015-09-17 21:16:41

CC:  fbissey

As the summary says. [Log file](http://www.math.washington.edu/~palmieri/Sage/gsl-1.16.log)


---

Comment by fbissey created at 2015-09-17 21:33:49

The relevant bit was not easy to find, can you generate serial logs next time, please?

```
Making all in statistics
/bin/sh ../libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I.. -I..    -g -O2  -MT mean.lo -MD -MP -MF .deps/mean.Tpo -c -o mean.lo mean.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I.. -I.. -g -O2 -MT mean.lo -MD -MP -MF .deps/mean.Tpo -c mean.c  -fno-common -DPIC -o .libs/mean.o
/var/folders/4v/hpyd22v96zz44t_p2hw5_gy80000gn/T//ccu3SHJV.s:606:2: error: ambiguous instructions require an explicit suffix (could be 'filds', or 'fildl')
        fild    (%rdi)
        ^
/var/folders/4v/hpyd22v96zz44t_p2hw5_gy80000gn/T//ccu3SHJV.s:745:2: error: ambiguous instructions require an explicit suffix (could be 'filds', or 'fildl')
        fild    -24(%rsp)
        ^
make[5]: *** [mean.lo] Error 1
```

That prevents libgslstatistics.la from being build which gives the final compiling error.


---

Comment by jhpalmieri created at 2015-09-17 22:26:42

The end of the log file from a serial build (I guess you don't need this, but just in case):

```
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I.. -I.. -g -O2 -MT multirobust.lo -MD -MP -MF .deps/multirobust.Tpo -c multirobust.c -o multirobust.o >/dev/null 2>&1
mv -f .deps/multirobust.Tpo .deps/multirobust.Plo
/bin/sh ../libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I.. -I..    -g -O2  -MT robust_wfun.lo -MD -MP -MF .deps/robust_wfun.Tpo -c -o robust_wfun.lo robust_wfun.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I.. -I.. -g -O2 -MT robust_wfun.lo -MD -MP -MF .deps/robust_wfun.Tpo -c robust_wfun.c  -fno-common -DPIC -o .libs/robust_wfun.o
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I.. -I.. -g -O2 -MT robust_wfun.lo -MD -MP -MF .deps/robust_wfun.Tpo -c robust_wfun.c -o robust_wfun.o >/dev/null 2>&1
mv -f .deps/robust_wfun.Tpo .deps/robust_wfun.Plo
/bin/sh ../libtool  --tag=CC   --mode=link gcc  -g -O2    -o libgslmultifit.la  multilinear.lo work.lo lmder.lo fsolver.lo fdfsolver.lo fdjac.lo convergence.lo gradient.lo covar.lo multirobust.lo robust_wfun.lo  -lm 
libtool: link: ar cru .libs/libgslmultifit.a .libs/multilinear.o .libs/work.o .libs/lmder.o .libs/fsolver.o .libs/fdfsolver.o .libs/fdjac.o .libs/convergence.o .libs/gradient.o .libs/covar.o .libs/multirobust.o .libs/robust_wfun.o 
libtool: link: ranlib .libs/libgslmultifit.a
libtool: link: ( cd ".libs" && rm -f "libgslmultifit.la" && ln -s "../libgslmultifit.la" "libgslmultifit.la" )
Making all in statistics
/bin/sh ../libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I.. -I..    -g -O2  -MT mean.lo -MD -MP -MF .deps/mean.Tpo -c -o mean.lo mean.c
libtool: compile:  gcc -DHAVE_CONFIG_H -I. -I.. -I.. -g -O2 -MT mean.lo -MD -MP -MF .deps/mean.Tpo -c mean.c  -fno-common -DPIC -o .libs/mean.o
/var/folders/4v/hpyd22v96zz44t_p2hw5_gy80000gn/T//cc80qd0d.s:606:2: error: ambiguous instructions require an explicit suffix (could be 'filds', or 'fildl')
        fild    (%rdi)
        ^
/var/folders/4v/hpyd22v96zz44t_p2hw5_gy80000gn/T//cc80qd0d.s:745:2: error: ambiguous instructions require an explicit suffix (could be 'filds', or 'fildl')
        fild    -24(%rsp)
        ^
make[4]: *** [mean.lo] Error 1
make[3]: *** [all-recursive] Error 1
make[2]: *** [all] Error 2
Error building GSL.
```



---

Comment by fbissey created at 2015-09-17 22:31:42

Yes that's exactly the bit I fished from the middle of the log but it's good to see there was no interferences from another part of the build.

I have not much of a clue since it happens when the assembly is generated. I haven't looked yet if it matches a function in `gsl`. It may be that we have to bump `gcc` for that one, or possibly a bug fix in xcode because there is a slew of similar messages in `numpy`.


---

Comment by fbissey created at 2015-09-17 22:37:40

No reported bugs on the `gsl` bug mailing list.


---

Comment by vbraun created at 2015-09-23 20:51:07

Changing status from new to needs_review.


---

Comment by vbraun created at 2015-09-23 20:51:07

New commits:


---

Comment by jhpalmieri created at 2015-09-24 01:02:43

This works for me; Sage builds with it and passes tests (if I build `ecm` with the added configure flag `--disable-asm-redc`).


---

Comment by jhpalmieri created at 2015-09-24 01:02:43

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-09-25 07:53:05

Resolution: fixed
