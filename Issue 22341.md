# Issue 22341: Polyhedron.bounding_box: New keyword argument integral_hull, use it it .integral_points

archive/issues_022341.json:
```json
{
    "body": "CC:  @videlec @jplab @tscrim\n\nAn amazing insight is that if one wants to know to bounding box of the integer points, rather than of all points, then one can round down upper bounds and round up lower bounds.\n\nThis can make a huge difference for integer points enumeration.\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/22578\n\n",
    "created_at": "2017-03-10T16:41:22Z",
    "labels": [
        "geometry",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.6",
    "title": "Polyhedron.bounding_box: New keyword argument integral_hull, use it it .integral_points",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22341",
    "user": "@mkoeppe"
}
```
CC:  @videlec @jplab @tscrim

An amazing insight is that if one wants to know to bounding box of the integer points, rather than of all points, then one can round down upper bounds and round up lower bounds.

This can make a huge difference for integer points enumeration.


Issue created by migration from https://trac.sagemath.org/ticket/22578





---

archive/issue_comments_310575.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-03-10T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310575",
    "user": "@mkoeppe"
}
```

New commits:



---

archive/issue_comments_310576.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-03-10T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310576",
    "user": "@mkoeppe"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_310577.json:
```json
{
    "body": "Changing keywords from \"\" to \"days84\".",
    "created_at": "2017-03-10T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310577",
    "user": "@mkoeppe"
}
```

Changing keywords from "" to "days84".



---

archive/issue_comments_310578.json:
```json
{
    "body": "This causes doctest failures in sandpiles. My guess is something is now returning a `None` that is fed to a `zip`.",
    "created_at": "2017-03-14T19:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310578",
    "user": "@tscrim"
}
```

This causes doctest failures in sandpiles. My guess is something is now returning a `None` that is fed to a `zip`.



---

archive/issue_comments_310579.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-03-14T19:44:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310579",
    "user": "@tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_310580.json:
```json
{
    "body": "Thanks for catching this. I'm preparing a fix.",
    "created_at": "2017-03-14T20:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310580",
    "user": "@mkoeppe"
}
```

Thanks for catching this. I'm preparing a fix.



---

archive/issue_comments_310581.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2017-03-14T23:19:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310581",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_310582.json:
```json
{
    "body": "Fixed the failures that resulted from empty bounding boxes; \nbut there remain failures that result from different sorting orders of `integral_points`. \nShould I change all these doctests so that they become independent of the sorting order?",
    "created_at": "2017-03-14T23:23:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310582",
    "user": "@mkoeppe"
}
```

Fixed the failures that resulted from empty bounding boxes; 
but there remain failures that result from different sorting orders of `integral_points`. 
Should I change all these doctests so that they become independent of the sorting order?



---

archive/issue_comments_310583.json:
```json
{
    "body": "If the output of `integral_points` is not subject to location in memory, then you don't have to. I'm prepared to set a positive review once addressed.",
    "created_at": "2017-03-14T23:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310583",
    "user": "@tscrim"
}
```

If the output of `integral_points` is not subject to location in memory, then you don't have to. I'm prepared to set a positive review once addressed.



---

archive/issue_comments_310584.json:
```json
{
    "body": "Changing keywords from \"days84\" to \"days84, days85\".",
    "created_at": "2017-03-14T23:35:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310584",
    "user": "@tscrim"
}
```

Changing keywords from "days84" to "days84, days85".



---

archive/issue_comments_310585.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-03-15T02:18:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310585",
    "user": "@mkoeppe"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_310586.json:
```json
{
    "body": "It looks like the order of some doctests in sandpiles have either changes or does depend on the machine/memory location (which is the case if they pass on your machine). I do agree that they are all trivial failures and can be easily fixed, but I just need an answer to which of the above cases we are in.",
    "created_at": "2017-03-15T22:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310586",
    "user": "@tscrim"
}
```

It looks like the order of some doctests in sandpiles have either changes or does depend on the machine/memory location (which is the case if they pass on your machine). I do agree that they are all trivial failures and can be easily fixed, but I just need an answer to which of the above cases we are in.



---

archive/issue_comments_310587.json:
```json
{
    "body": "I think the order has changed because a different enumeration strategy is selected. I don't think it's machine or address specific.\nIn my opinion, doctests should not rely on the order of lists whose ordering is unspecified by documentation; they should be rewritten using `sort` or `set`.",
    "created_at": "2017-03-15T22:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310587",
    "user": "@mkoeppe"
}
```

I think the order has changed because a different enumeration strategy is selected. I don't think it's machine or address specific.
In my opinion, doctests should not rely on the order of lists whose ordering is unspecified by documentation; they should be rewritten using `sort` or `set`.



---

archive/issue_comments_310588.json:
```json
{
    "body": "If you want to change the tests so that the order is sorted, go ahead. I would avoid using `set` since (unfortunately) the output may not be in a specific order. However, we can just change the output for now too. I can also make these changes if you want me to.",
    "created_at": "2017-03-16T21:51:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310588",
    "user": "@tscrim"
}
```

If you want to change the tests so that the order is sorted, go ahead. I would avoid using `set` since (unfortunately) the output may not be in a specific order. However, we can just change the output for now too. I can also make these changes if you want me to.



---

archive/issue_comments_310589.json:
```json
{
    "body": "I would strongly suggest to adjust the tests to use `sort` then; because it is very likely that future changes to the lattice point enumeration code (such as automatic selection of the normaliz backend if it is available) will change the order again. If you'd like to go ahead with this change, that would be great...",
    "created_at": "2017-03-16T21:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310589",
    "user": "@mkoeppe"
}
```

I would strongly suggest to adjust the tests to use `sort` then; because it is very likely that future changes to the lattice point enumeration code (such as automatic selection of the normaliz backend if it is available) will change the order again. If you'd like to go ahead with this change, that would be great...



---

archive/issue_comments_310590.json:
```json
{
    "body": "I will do so now.",
    "created_at": "2017-03-16T21:58:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310590",
    "user": "@tscrim"
}
```

I will do so now.



---

archive/issue_comments_310591.json:
```json
{
    "body": "All tests now pass, and they are now checked by sorting the output. If my changes look good to you, then you can set a positive review.\n----\nNew commits:",
    "created_at": "2017-03-16T22:09:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310591",
    "user": "@tscrim"
}
```

All tests now pass, and they are now checked by sorting the output. If my changes look good to you, then you can set a positive review.
----
New commits:



---

archive/issue_comments_310592.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-03-16T22:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310592",
    "user": "@mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_310593.json:
```json
{
    "body": "Looks good. Thanks very much!",
    "created_at": "2017-03-16T22:19:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310593",
    "user": "@mkoeppe"
}
```

Looks good. Thanks very much!



---

archive/issue_comments_310594.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-03-27T20:41:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310594",
    "user": "@vbraun"
}
```

Resolution: fixed



---

archive/issue_comments_310595.json:
```json
{
    "body": "Sorry, my typo in a ticket number.",
    "created_at": "2017-04-05T05:58:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22341",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22341#issuecomment-310595",
    "user": "@jm58660"
}
```

Sorry, my typo in a ticket number.
