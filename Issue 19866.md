# Issue 19866: Some clean up in simplicial complexes

archive/issues_019866.json:
```json
{
    "body": "CC:  tscrim chapoton\n\nThis in some sense a followup to #6102 and in some sense a precursor a future ticket for simplicial sets. This mainly involves some reorganization, not much new.\n\n- Add a `reduced` keyword to the `homology` method, to make it easy to compute unreduced homology. (Computing reduced homology has always been the default, but it was a little inconvenient to compute the unreduced homology before.)\n- Add an `is_acyclic` method for cell complexes.\n- Instead of having a single `algebraic_topological_model` method for all cell complexes, broken into cases depending on the complex, instead each class which inherits from `GenericCellComplex` should implement its own method.\n- Similarly, cell complexes should have an `alexander_whitney` method. This helps to clean up the cup product code; that code should be easy to maintain if we add more types of cell complexes.\n- Change `__cmp__` to `__eq__` etc., for all types of cells and complexes. My understanding is that `__cmp__` is no longer used in Python 3, so we should eliminate it.\n- For simplicial complexes, define a `face` method: then `K.face(sigma, i)` will return the ith face of `sigma` in `K`. This is not really useful on its own, but it gets used in the `Sq` method in `homology_vector_space_with_basis`. The point is, we could define cell complexes (like the current Delta complexes, and like simplicial sets) in which you can only compute the face of a cell by knowing about the complex in which it lives, and we might want to extend the `Sq` method to work with such complexes.\n\nIssue created by migration from https://trac.sagemath.org/ticket/20103\n\n",
    "created_at": "2016-02-23T22:12:15Z",
    "labels": [
        "algebraic topology",
        "minor",
        "enhancement"
    ],
    "title": "Some clean up in simplicial complexes",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/19866",
    "user": "jhpalmieri"
}
```
CC:  tscrim chapoton

This in some sense a followup to #6102 and in some sense a precursor a future ticket for simplicial sets. This mainly involves some reorganization, not much new.

- Add a `reduced` keyword to the `homology` method, to make it easy to compute unreduced homology. (Computing reduced homology has always been the default, but it was a little inconvenient to compute the unreduced homology before.)
- Add an `is_acyclic` method for cell complexes.
- Instead of having a single `algebraic_topological_model` method for all cell complexes, broken into cases depending on the complex, instead each class which inherits from `GenericCellComplex` should implement its own method.
- Similarly, cell complexes should have an `alexander_whitney` method. This helps to clean up the cup product code; that code should be easy to maintain if we add more types of cell complexes.
- Change `__cmp__` to `__eq__` etc., for all types of cells and complexes. My understanding is that `__cmp__` is no longer used in Python 3, so we should eliminate it.
- For simplicial complexes, define a `face` method: then `K.face(sigma, i)` will return the ith face of `sigma` in `K`. This is not really useful on its own, but it gets used in the `Sq` method in `homology_vector_space_with_basis`. The point is, we could define cell complexes (like the current Delta complexes, and like simplicial sets) in which you can only compute the face of a cell by knowing about the complex in which it lives, and we might want to extend the `Sq` method to work with such complexes.

Issue created by migration from https://trac.sagemath.org/ticket/20103





---

archive/issue_comments_273126.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-02-23T22:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273126",
    "user": "jhpalmieri"
}
```

New commits:



---

archive/issue_comments_273127.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-02-23T22:13:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273127",
    "user": "jhpalmieri"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_273128.json:
```json
{
    "body": "Some quick comments:\n\n- The input block bullets are usually not considered to be sentences and typically lack periods.\n- Use ``@`abstract_method` for the generic `alexander_whitney`.\n- I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.\n- I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.\n- Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.",
    "created_at": "2016-02-24T15:45:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273128",
    "user": "tscrim"
}
```

Some quick comments:

- The input block bullets are usually not considered to be sentences and typically lack periods.
- Use ``@`abstract_method` for the generic `alexander_whitney`.
- I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.
- I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
- Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.



---

archive/issue_comments_273129.json:
```json
{
    "body": "Replying to [comment:4 tscrim]:\n> Some quick comments:\n> \n> - Use ``@`abstract_method` for the generic `alexander_whitney`.\n\nShould this be done more widely? E.g. for `cells`, `product`, `disjoint_union`, etc.?\n\n> - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.\n\nI think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)\n\n> - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.\n\nPython sets are by definition unordered, so it seems safest to explicitly sort.\n\n> - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.\n\nI am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.",
    "created_at": "2016-02-24T16:55:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273129",
    "user": "jhpalmieri"
}
```

Replying to [comment:4 tscrim]:
> Some quick comments:
> 
> - Use ``@`abstract_method` for the generic `alexander_whitney`.

Should this be done more widely? E.g. for `cells`, `product`, `disjoint_union`, etc.?

> - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.

I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)

> - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.

Python sets are by definition unordered, so it seems safest to explicitly sort.

> - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.

I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.



---

archive/issue_comments_273130.json:
```json
{
    "body": "Replying to [comment:5 jhpalmieri]:\n> Replying to [comment:4 tscrim]:\n> > Some quick comments:\n> > \n> > - Use ``@`abstract_method` for the generic `alexander_whitney`.\n> \n> Should this be done more widely? E.g. for `cells`, `product`, `disjoint_union`, etc.?\n\nProbably (and maybe checking to see if it is not handled by the appropriate category).\n\n> > - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.\n> \n> I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)\n\nIt shouldn't have any problems because it is used for the elements, which are not subclasses of `EqualityById` (plus implementing an `__eq__` nullifies the use of that class). ``@`total_ordering` does modify the class, but this should be done at initialization of the module. Thus it is done before category framework gets its hands on it (via `Element`) when an instance of the parent class is created.\n\n> > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.\n> \n> Python sets are by definition unordered, so it seems safest to explicitly call sort.\n\nRight, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.\n\n> > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.\n> \n> I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.\n\nI can cythonize it on a separate ticket then.",
    "created_at": "2016-02-24T17:26:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273130",
    "user": "tscrim"
}
```

Replying to [comment:5 jhpalmieri]:
> Replying to [comment:4 tscrim]:
> > Some quick comments:
> > 
> > - Use ``@`abstract_method` for the generic `alexander_whitney`.
> 
> Should this be done more widely? E.g. for `cells`, `product`, `disjoint_union`, etc.?

Probably (and maybe checking to see if it is not handled by the appropriate category).

> > - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.
> 
> I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)

It shouldn't have any problems because it is used for the elements, which are not subclasses of `EqualityById` (plus implementing an `__eq__` nullifies the use of that class). ``@`total_ordering` does modify the class, but this should be done at initialization of the module. Thus it is done before category framework gets its hands on it (via `Element`) when an instance of the parent class is created.

> > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
> 
> Python sets are by definition unordered, so it seems safest to explicitly call sort.

Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.

> > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.
> 
> I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.

I can cythonize it on a separate ticket then.



---

archive/issue_comments_273131.json:
```json
{
    "body": "Replying to [comment:6 tscrim]:\n> Replying to [comment:5 jhpalmieri]:\n> > Replying to [comment:4 tscrim]:\n> > > Some quick comments:\n> \n> > > - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.\n> > \n> > I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)\n> \n> It shouldn't have any problems because it is used for the elements, which are not subclasses of `EqualityById` (plus implementing an `__eq__` nullifies the use of that class). ``@`total_ordering` does modify the class, but this should be done at initialization of the module. Thus it is done before category framework gets its hands on it (via `Element`) when an instance of the parent class is created.\n\nI tried it and it looks okay. I'll make that change.\n\n> \n> > > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.\n> > \n> > Python sets are by definition unordered, so it seems safest to explicitly call sort.\n> \n> Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.\n\nIt is completely opaque to me how this is done. Maybe by the code in `repl/display/pretty_print.py` and `fancy_repr.py`? I only see references to dictionaries being sorted by keys, not for other data types.\n\n> > > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.\n> > \n> > I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.\n> \n> I can cythonize it on a separate ticket then.\n\nCC me on it and I will review it.",
    "created_at": "2016-02-24T19:17:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273131",
    "user": "jhpalmieri"
}
```

Replying to [comment:6 tscrim]:
> Replying to [comment:5 jhpalmieri]:
> > Replying to [comment:4 tscrim]:
> > > Some quick comments:
> 
> > > - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.
> > 
> > I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)
> 
> It shouldn't have any problems because it is used for the elements, which are not subclasses of `EqualityById` (plus implementing an `__eq__` nullifies the use of that class). ``@`total_ordering` does modify the class, but this should be done at initialization of the module. Thus it is done before category framework gets its hands on it (via `Element`) when an instance of the parent class is created.

I tried it and it looks okay. I'll make that change.

> 
> > > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
> > 
> > Python sets are by definition unordered, so it seems safest to explicitly call sort.
> 
> Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.

It is completely opaque to me how this is done. Maybe by the code in `repl/display/pretty_print.py` and `fancy_repr.py`? I only see references to dictionaries being sorted by keys, not for other data types.

> > > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.
> > 
> > I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.
> 
> I can cythonize it on a separate ticket then.

CC me on it and I will review it.



---

archive/issue_comments_273132.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-02-24T19:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273132",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_273133.json:
```json
{
    "body": "Replying to [comment:7 jhpalmieri]:\n> Replying to [comment:6 tscrim]:\n> > Replying to [comment:5 jhpalmieri]:\n> > > Replying to [comment:4 tscrim]:\n> > > > Some quick comments:\n> > > > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.\n> > > \n> > > Python sets are by definition unordered, so it seems safest to explicitly call sort.\n> > \n> > Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.\n> \n> It is completely opaque to me how this is done. Maybe by the code in `repl/display/pretty_print.py` and `fancy_repr.py`? I only see references to dictionaries being sorted by keys, not for other data types.\n\nIt's entirely possible we don't yet try to order `set` and only `dict`. Okay, then we will explicitly sort things.\n\n> > > > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.\n> > > \n> > > I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.\n> > \n> > I can cythonize it on a separate ticket then.\n> \n> CC me on it and I will review it.\n\nThis is now #20114.\n\nSo then this is now a positive review. Thanks!",
    "created_at": "2016-02-25T17:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273133",
    "user": "tscrim"
}
```

Replying to [comment:7 jhpalmieri]:
> Replying to [comment:6 tscrim]:
> > Replying to [comment:5 jhpalmieri]:
> > > Replying to [comment:4 tscrim]:
> > > > Some quick comments:
> > > > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
> > > 
> > > Python sets are by definition unordered, so it seems safest to explicitly call sort.
> > 
> > Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.
> 
> It is completely opaque to me how this is done. Maybe by the code in `repl/display/pretty_print.py` and `fancy_repr.py`? I only see references to dictionaries being sorted by keys, not for other data types.

It's entirely possible we don't yet try to order `set` and only `dict`. Okay, then we will explicitly sort things.

> > > > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.
> > > 
> > > I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.
> > 
> > I can cythonize it on a separate ticket then.
> 
> CC me on it and I will review it.

This is now #20114.

So then this is now a positive review. Thanks!



---

archive/issue_comments_273134.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-25T17:36:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273134",
    "user": "tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_273135.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2016-02-25T22:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273135",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_273136.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2016-02-25T22:38:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273136",
    "user": "git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_273137.json:
```json
{
    "body": "There was a merge conflict with `simplicial_complex.py`, now fixed.",
    "created_at": "2016-02-25T22:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273137",
    "user": "jhpalmieri"
}
```

There was a merge conflict with `simplicial_complex.py`, now fixed.



---

archive/issue_comments_273138.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2016-02-25T22:40:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273138",
    "user": "jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_273139.json:
```json
{
    "body": "Reviewer name...",
    "created_at": "2016-02-25T23:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273139",
    "user": "vbraun"
}
```

Reviewer name...



---

archive/issue_comments_273140.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2016-02-25T23:38:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273140",
    "user": "vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_273141.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-02-26T02:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273141",
    "user": "jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_273142.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-02-27T09:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/19866",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/19866#issuecomment-273142",
    "user": "vbraun"
}
```

Resolution: fixed
