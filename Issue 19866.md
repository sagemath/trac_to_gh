# Issue 19866: Some clean up in simplicial complexes

Issue created by migration from Trac.

Original creator: jhpalmieri

Original creation time: 2016-02-23 22:12:15

CC:  tscrim chapoton

This in some sense a followup to #6102 and in some sense a precursor a future ticket for simplicial sets. This mainly involves some reorganization, not much new.

- Add a `reduced` keyword to the `homology` method, to make it easy to compute unreduced homology. (Computing reduced homology has always been the default, but it was a little inconvenient to compute the unreduced homology before.)
- Add an `is_acyclic` method for cell complexes.
- Instead of having a single `algebraic_topological_model` method for all cell complexes, broken into cases depending on the complex, instead each class which inherits from `GenericCellComplex` should implement its own method.
- Similarly, cell complexes should have an `alexander_whitney` method. This helps to clean up the cup product code; that code should be easy to maintain if we add more types of cell complexes.
- Change `__cmp__` to `__eq__` etc., for all types of cells and complexes. My understanding is that `__cmp__` is no longer used in Python 3, so we should eliminate it.
- For simplicial complexes, define a `face` method: then `K.face(sigma, i)` will return the ith face of `sigma` in `K`. This is not really useful on its own, but it gets used in the `Sq` method in `homology_vector_space_with_basis`. The point is, we could define cell complexes (like the current Delta complexes, and like simplicial sets) in which you can only compute the face of a cell by knowing about the complex in which it lives, and we might want to extend the `Sq` method to work with such complexes.


---

Comment by jhpalmieri created at 2016-02-23 22:13:34

New commits:


---

Comment by jhpalmieri created at 2016-02-23 22:13:34

Changing status from new to needs_review.


---

Comment by tscrim created at 2016-02-24 15:45:20

Some quick comments:

- The input block bullets are usually not considered to be sentences and typically lack periods.
- Use ``@`abstract_method` for the generic `alexander_whitney`.
- I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.
- I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
- Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.


---

Comment by jhpalmieri created at 2016-02-24 16:55:37

Replying to [comment:4 tscrim]:
> Some quick comments:
> 
> - Use ``@`abstract_method` for the generic `alexander_whitney`.

Should this be done more widely? E.g. for `cells`, `product`, `disjoint_union`, etc.?

> - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.

I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)

> - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.

Python sets are by definition unordered, so it seems safest to explicitly sort.

> - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.

I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.


---

Comment by tscrim created at 2016-02-24 17:26:15

Replying to [comment:5 jhpalmieri]:
> Replying to [comment:4 tscrim]:
> > Some quick comments:
> > 
> > - Use ``@`abstract_method` for the generic `alexander_whitney`.
> 
> Should this be done more widely? E.g. for `cells`, `product`, `disjoint_union`, etc.?

Probably (and maybe checking to see if it is not handled by the appropriate category).

> > - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.
> 
> I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)

It shouldn't have any problems because it is used for the elements, which are not subclasses of `EqualityById` (plus implementing an `__eq__` nullifies the use of that class). ``@`total_ordering` does modify the class, but this should be done at initialization of the module. Thus it is done before category framework gets its hands on it (via `Element`) when an instance of the parent class is created.

> > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
> 
> Python sets are by definition unordered, so it seems safest to explicitly call sort.

Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.

> > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.
> 
> I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.

I can cythonize it on a separate ticket then.


---

Comment by jhpalmieri created at 2016-02-24 19:17:26

Replying to [comment:6 tscrim]:
> Replying to [comment:5 jhpalmieri]:
> > Replying to [comment:4 tscrim]:
> > > Some quick comments:
> 
> > > - I think this would benefit from using ``@`total_ordering` (in reality, we probably should implement a generic `__ne__` for `Element`...) so we don't have so many little methods for all of the comparison operators.
> > 
> > I think I tried this for one of the classes and ran into problems. I'll try again and see what happens. (Actually, this may have been for a draft of a simplex class for use with simplicial sets, and it might have been a conflict with `UniqueRepresentation` or `EqualityById` or something like that.)
> 
> It shouldn't have any problems because it is used for the elements, which are not subclasses of `EqualityById` (plus implementing an `__eq__` nullifies the use of that class). ``@`total_ordering` does modify the class, but this should be done at initialization of the module. Thus it is done before category framework gets its hands on it (via `Element`) when an instance of the parent class is created.

I tried it and it looks okay. I'll make that change.

> 
> > > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
> > 
> > Python sets are by definition unordered, so it seems safest to explicitly call sort.
> 
> Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.

It is completely opaque to me how this is done. Maybe by the code in `repl/display/pretty_print.py` and `fancy_repr.py`? I only see references to dictionaries being sorted by keys, not for other data types.

> > > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.
> > 
> > I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.
> 
> I can cythonize it on a separate ticket then.

CC me on it and I will review it.


---

Comment by git created at 2016-02-24 19:52:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2016-02-25 17:36:19

Replying to [comment:7 jhpalmieri]:
> Replying to [comment:6 tscrim]:
> > Replying to [comment:5 jhpalmieri]:
> > > Replying to [comment:4 tscrim]:
> > > > Some quick comments:
> > > > - I'm actually not sure if the output of a (python) `set` is (attempted to be) sorted as for a `dict`. So I'm not sure if we need to explicitly call `sorted`.
> > > 
> > > Python sets are by definition unordered, so it seems safest to explicitly call sort.
> > 
> > Right, but the doctesting framework sorts the output of (some) things automatically when running tests on a file to avoid having to do machine-independent/memory-independent tests. I'm not opposed to doing the sort, but just a note.
> 
> It is completely opaque to me how this is done. Maybe by the code in `repl/display/pretty_print.py` and `fancy_repr.py`? I only see references to dictionaries being sorted by keys, not for other data types.

It's entirely possible we don't yet try to order `set` and only `dict`. Okay, then we will explicitly sort things.

> > > > - Should we cythonize `algebraic_topological_model` now? It probably won't be too hard and we could get some speedup from that.
> > > 
> > > I am probably not the person to do that. It could safely go on another ticket, since it seems independent of the changes here.
> > 
> > I can cythonize it on a separate ticket then.
> 
> CC me on it and I will review it.

This is now #20114.

So then this is now a positive review. Thanks!


---

Comment by tscrim created at 2016-02-25 17:36:19

Changing status from needs_review to positive_review.


---

Comment by git created at 2016-02-25 22:38:53

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by git created at 2016-02-25 22:38:53

Changing status from positive_review to needs_review.


---

Comment by jhpalmieri created at 2016-02-25 22:40:52

There was a merge conflict with `simplicial_complex.py`, now fixed.


---

Comment by jhpalmieri created at 2016-02-25 22:40:52

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-02-25 23:38:01

Reviewer name...


---

Comment by vbraun created at 2016-02-25 23:38:01

Changing status from positive_review to needs_work.


---

Comment by jhpalmieri created at 2016-02-26 02:01:53

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-02-27 09:25:24

Resolution: fixed
