# Issue 29077: update GAP to version 4.11

archive/issues_029077.json:
```json
{
    "body": "CC:  @antonio-rojas @timokau @soehms @tobiasdiez\n\nGAP 4.11.0 has been released.\n\ntarball: \nhttps://www.gap-system.org/pub/gap/gap-4.11/tar.bz2/gap-4.11.0.tar.bz2\n\nIssue created by migration from https://trac.sagemath.org/ticket/29314\n\n",
    "created_at": "2020-03-11T11:12:19Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.3",
    "title": "update GAP to version 4.11",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/29077",
    "user": "https://github.com/dimpase"
}
```
CC:  @antonio-rojas @timokau @soehms @tobiasdiez

GAP 4.11.0 has been released.

tarball: 
https://www.gap-system.org/pub/gap/gap-4.11/tar.bz2/gap-4.11.0.tar.bz2

Issue created by migration from https://trac.sagemath.org/ticket/29314





---

archive/issue_comments_411038.json:
```json
{
    "body": "Does the upgrade fix #28728?",
    "created_at": "2020-03-12T00:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411038",
    "user": "https://github.com/mkoeppe"
}
```

Does the upgrade fix #28728?



---

archive/issue_comments_411039.json:
```json
{
    "body": "Besides changes in tests output, there's only one small change needed due to the VERSION alias removal. Patch at https://aur.archlinux.org/cgit/aur.git/tree/sagemath-gap-4.11.patch?h=sagemath-git\n\nI haven't tested the gap-packages update",
    "created_at": "2020-03-15T20:53:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411039",
    "user": "https://github.com/antonio-rojas"
}
```

Besides changes in tests output, there's only one small change needed due to the VERSION alias removal. Patch at https://aur.archlinux.org/cgit/aur.git/tree/sagemath-gap-4.11.patch?h=sagemath-git

I haven't tested the gap-packages update



---

archive/issue_comments_411040.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-09-02T17:01:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411040",
    "user": "https://github.com/dimpase"
}
```

New commits:



---

archive/issue_comments_411041.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-09-02T17:20:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411041",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_411042.json:
```json
{
    "body": "\n```\nsage -t --warn-long 105.7 --random-seed=0 src/sage/libs/gap/element.pyx  # 6 doctests failed\nsage -t --warn-long 105.7 --random-seed=0 src/sage/libs/gap/libgap.pyx  # 1 doctest failed\n```\n\n\nsomething to be fixed 1st",
    "created_at": "2020-09-02T17:52:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411042",
    "user": "https://github.com/dimpase"
}
```


```
sage -t --warn-long 105.7 --random-seed=0 src/sage/libs/gap/element.pyx  # 6 doctests failed
sage -t --warn-long 105.7 --random-seed=0 src/sage/libs/gap/libgap.pyx  # 1 doctest failed
```


something to be fixed 1st



---

archive/issue_comments_411043.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:",
    "created_at": "2020-09-02T21:36:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411043",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:



---

archive/issue_comments_411044.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-02T21:50:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411044",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411045.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-02T22:51:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411045",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411046.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-03T08:53:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411046",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411047.json:
```json
{
    "body": "there seems to be one failing doctest that is macOS-specific, in `src/sage/groups/cubic_braid.py`, \nbut I still think we have to proceed (it's probably a platform-specific GAP bug).",
    "created_at": "2020-09-03T13:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411047",
    "user": "https://github.com/dimpase"
}
```

there seems to be one failing doctest that is macOS-specific, in `src/sage/groups/cubic_braid.py`, 
but I still think we have to proceed (it's probably a platform-specific GAP bug).



---

archive/issue_comments_411048.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-09-03T13:55:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411048",
    "user": "https://github.com/dimpase"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_411049.json:
```json
{
    "body": "on macOS 10.15.6 with and without gap_packages installed\n\n```\nsage -t --warn-long 70.9 --random-seed=0 src/sage/groups/cubic_braid.py\n**********************************************************************\nFile \"src/sage/groups/cubic_braid.py\", line 1454, in sage.groups.cubic_braid.CubicBraidGroup.as_matrix_group\nFailed example:\n    m_back = C5(m)\nException raised:\n    Traceback (most recent call last):\n      File \"/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 715, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/doctest/forker.py\", line 1139, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.groups.cubic_braid.CubicBraidGroup.as_matrix_group[4]>\", line 1, in <module>\n        m_back = C5(m)\n      File \"sage/structure/parent.pyx\", line 900, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9336)\n        return mor._call_(x)\n      File \"sage/structure/coerce_maps.pyx\", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4623)\n        raise\n      File \"sage/structure/coerce_maps.pyx\", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4515)\n        return C._element_constructor(x)\n      File \"/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/groups/cubic_braid.py\", line 1314, in _element_constructor_\n        return map_to.lift(x)\n      File \"/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/groups/libgap_morphism.py\", line 514, in lift\n        if h.gap() not in phi.Image():\n      File \"sage/libs/gap/element.pyx\", line 656, in sage.libs.gap.element.GapElement.__contains__ (build/cythonized/sage/libs/gap/element.c:7753)\n        return GAP_IN(other, self).sage()\n      File \"sage/libs/gap/element.pyx\", line 2525, in sage.libs.gap.element.GapElement_Function.__call__ (build/cythonized/sage/libs/gap/element.c:19780)\n        sig_on()\n    sage.libs.gap.util.GAPError: Error, reached the pre-set memory limit\n    (change it with the -o command line option)\n```\n\n\ncan't reproduce this on Linux",
    "created_at": "2020-09-03T15:06:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411049",
    "user": "https://github.com/dimpase"
}
```

on macOS 10.15.6 with and without gap_packages installed

```
sage -t --warn-long 70.9 --random-seed=0 src/sage/groups/cubic_braid.py
**********************************************************************
File "src/sage/groups/cubic_braid.py", line 1454, in sage.groups.cubic_braid.CubicBraidGroup.as_matrix_group
Failed example:
    m_back = C5(m)
Exception raised:
    Traceback (most recent call last):
      File "/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 715, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/doctest/forker.py", line 1139, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.groups.cubic_braid.CubicBraidGroup.as_matrix_group[4]>", line 1, in <module>
        m_back = C5(m)
      File "sage/structure/parent.pyx", line 900, in sage.structure.parent.Parent.__call__ (build/cythonized/sage/structure/parent.c:9336)
        return mor._call_(x)
      File "sage/structure/coerce_maps.pyx", line 161, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4623)
        raise
      File "sage/structure/coerce_maps.pyx", line 156, in sage.structure.coerce_maps.DefaultConvertMap_unique._call_ (build/cythonized/sage/structure/coerce_maps.c:4515)
        return C._element_constructor(x)
      File "/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/groups/cubic_braid.py", line 1314, in _element_constructor_
        return map_to.lift(x)
      File "/Users/dima/software/sagetrac-mirror/local/lib/python3.7/site-packages/sage/groups/libgap_morphism.py", line 514, in lift
        if h.gap() not in phi.Image():
      File "sage/libs/gap/element.pyx", line 656, in sage.libs.gap.element.GapElement.__contains__ (build/cythonized/sage/libs/gap/element.c:7753)
        return GAP_IN(other, self).sage()
      File "sage/libs/gap/element.pyx", line 2525, in sage.libs.gap.element.GapElement_Function.__call__ (build/cythonized/sage/libs/gap/element.c:19780)
        sig_on()
    sage.libs.gap.util.GAPError: Error, reached the pre-set memory limit
    (change it with the -o command line option)
```


can't reproduce this on Linux



---

archive/issue_comments_411050.json:
```json
{
    "body": "Sebastian, could you reproduce this computation in GAP? I suspect it's a \"pure\" GAP bug.",
    "created_at": "2020-09-03T15:40:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411050",
    "user": "https://github.com/dimpase"
}
```

Sebastian, could you reproduce this computation in GAP? I suspect it's a "pure" GAP bug.



---

archive/issue_comments_411051.json:
```json
{
    "body": "It's not macOS-specific, I've been seeing this on Arch since I updated GAP. It only happens when running the full test suite, testing only the groups/cubic_braid.py file or even the entire groups module works.",
    "created_at": "2020-09-03T16:08:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411051",
    "user": "https://github.com/antonio-rojas"
}
```

It's not macOS-specific, I've been seeing this on Arch since I updated GAP. It only happens when running the full test suite, testing only the groups/cubic_braid.py file or even the entire groups module works.



---

archive/issue_comments_411052.json:
```json
{
    "body": "Replying to [comment:17 arojas]:\n> It's not macOS-specific, I've been seeing this on Arch since I updated GAP. It only happens when running the full test suite, testing only the groups/cubic_braid.py file or even the entire groups module works.\n\nOn macOS it's reproducible at Sage prompt.",
    "created_at": "2020-09-03T16:32:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411052",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:17 arojas]:
> It's not macOS-specific, I've been seeing this on Arch since I updated GAP. It only happens when running the full test suite, testing only the groups/cubic_braid.py file or even the entire groups module works.

On macOS it's reproducible at Sage prompt.



---

archive/issue_comments_411053.json:
```json
{
    "body": "I'll just do\n\n```diff\n--- a/src/sage/interfaces/gap.py\n+++ b/src/sage/interfaces/gap.py\n@@ -277,7 +277,7 @@ def get_gap_memory_pool_size():\n     # Don't eat all address space if the user set ulimit -v\n     suggested_size = min(suggested_size, vmax // 10)\n     # ~220MB is the minimum for long doctests\n-    suggested_size = max(suggested_size, 250 * 1024**2)\n+    suggested_size = max(suggested_size, 350 * 1024**2)\n     return suggested_size\n```\n\nthis limit has not been chnaged for 7 years, so that's OK :-)",
    "created_at": "2020-09-03T17:04:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411053",
    "user": "https://github.com/dimpase"
}
```

I'll just do

```diff
--- a/src/sage/interfaces/gap.py
+++ b/src/sage/interfaces/gap.py
@@ -277,7 +277,7 @@ def get_gap_memory_pool_size():
     # Don't eat all address space if the user set ulimit -v
     suggested_size = min(suggested_size, vmax // 10)
     # ~220MB is the minimum for long doctests
-    suggested_size = max(suggested_size, 250 * 1024**2)
+    suggested_size = max(suggested_size, 350 * 1024**2)
     return suggested_size
```

this limit has not been chnaged for 7 years, so that's OK :-)



---

archive/issue_comments_411054.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-03T17:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411054",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411055.json:
```json
{
    "body": "made it 400m",
    "created_at": "2020-09-03T17:15:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411055",
    "user": "https://github.com/dimpase"
}
```

made it 400m



---

archive/issue_comments_411056.json:
```json
{
    "body": "GitHub Actions tests on https://github.com/sagemath/sage/pull/98",
    "created_at": "2020-09-03T17:19:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411056",
    "user": "https://github.com/dimpase"
}
```

GitHub Actions tests on https://github.com/sagemath/sage/pull/98



---

archive/issue_comments_411057.json:
```json
{
    "body": "https://github.com/sagemath/sage/actions just needs some housekeeping - there are lots of workflowed from the WSL pull request that are no longer needed",
    "created_at": "2020-09-04T15:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411057",
    "user": "https://github.com/mkoeppe"
}
```

https://github.com/sagemath/sage/actions just needs some housekeeping - there are lots of workflowed from the WSL pull request that are no longer needed



---

archive/issue_comments_411058.json:
```json
{
    "body": "ping?",
    "created_at": "2020-09-07T09:23:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411058",
    "user": "https://github.com/dimpase"
}
```

ping?



---

archive/issue_comments_411059.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-07T19:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411059",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_411060.json:
```json
{
    "body": "The updated `libsemigroup` fails to build on the outdated platforms `ubuntu-trusty`, `debian-jessie`, `linuxmint-17`. This is a regression regarding platform support, but I think that's fine for an optional package (also `normaliz` has the same problem).\n\nOtherwise looks fine.",
    "created_at": "2020-09-07T19:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411060",
    "user": "https://github.com/mkoeppe"
}
```

The updated `libsemigroup` fails to build on the outdated platforms `ubuntu-trusty`, `debian-jessie`, `linuxmint-17`. This is a regression regarding platform support, but I think that's fine for an optional package (also `normaliz` has the same problem).

Otherwise looks fine.



---

archive/issue_comments_411061.json:
```json
{
    "body": "Does the upgrade fix something \"critical\"?",
    "created_at": "2020-09-07T19:36:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411061",
    "user": "https://github.com/mkoeppe"
}
```

Does the upgrade fix something "critical"?



---

archive/issue_comments_411062.json:
```json
{
    "body": "it removes a lot of patches (in fact, all the patches we have for `gap` and `gap_packages`), for one, which is always good. It incorporates numerous upstream bug fixes too, and it's a bit overdue, as 4.11 was released 6 months ago.",
    "created_at": "2020-09-07T20:22:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411062",
    "user": "https://github.com/dimpase"
}
```

it removes a lot of patches (in fact, all the patches we have for `gap` and `gap_packages`), for one, which is always good. It incorporates numerous upstream bug fixes too, and it's a bit overdue, as 4.11 was released 6 months ago.



---

archive/issue_comments_411063.json:
```json
{
    "body": "Replying to [comment:16 dimpase]:\n> Sebastian, could you reproduce this computation in GAP? I suspect it's a \"pure\" GAP bug.\nSorry, that I didn't see that earlier, since I'm on vacation until next weekend! But it seems that you've solved that already.\n\nDo you know the reason why the domains of permutation groups of matrix groups have increased in the new version (see the differences of the doctests of `permgroup.py` at line 850 and 899)?\nOn a first impression I wouldn't take that for an improvement. Anyway, I would break these long doctests lines.\n\nSebastian.",
    "created_at": "2020-09-07T21:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411063",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:16 dimpase]:
> Sebastian, could you reproduce this computation in GAP? I suspect it's a "pure" GAP bug.
Sorry, that I didn't see that earlier, since I'm on vacation until next weekend! But it seems that you've solved that already.

Do you know the reason why the domains of permutation groups of matrix groups have increased in the new version (see the differences of the doctests of `permgroup.py` at line 850 and 899)?
On a first impression I wouldn't take that for an improvement. Anyway, I would break these long doctests lines.

Sebastian.



---

archive/issue_comments_411064.json:
```json
{
    "body": "Docbuild hangs forever on buildbots, a strace ends with\n\n```\n$ strace -ff ./sage --docbuild --verbose 99 --no-pdf-links all html\n[...]\n[pid 106971] access(\"/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/resclasses-4.7.2/init.g\", F_OK) = 0\n[pid 106971] access(\"/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/resclasses-4.7.2/read.g\", F_OK) = 0\n[pid 106971] access(\"/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/polenta-1.3.9/doc/manual.six\", F_OK) = 0\n[pid 106971] access(\"/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/resclasses-4.7.2/doc/manual.six\", F_OK) = 0\n[pid 106971] access(\"/var/lib/buildbot/.gap/gaprc\", R_OK) = -1 ENOENT (No such file or directory)\n[pid 106971] access(\"/var/lib/buildbot/.gap/gaprc.gz\", R_OK) = -1 ENOENT (No such file or directory)\n[pid 106971] access(\"/var/lib/buildbot/slave/sage_git/build/local/share/gap/gaprc\", R_OK) = -1 ENOENT (No such file or directory)\n[pid 106971] access(\"/var/lib/buildbot/slave/sage_git/build/local/share/gap/gaprc.gz\", R_OK) = -1 ENOENT (No such file or directory)\n[pid 106971] access(\"/var/lib/buildbot/.gap\", F_OK) = -1 ENOENT (No such file or directory)\n[pid 106971] open(\"/var/lib/buildbot/.gaprc\", O_RDONLY) = -1 ENOENT (No such file or directory)\n[pid 106971] access(\"/var/lib/buildbot/.gaprc.gz\", R_OK) = -1 ENOENT (No such file or directory)\n[pid 106971] access(\"/var/lib/buildbot/.gaprc.gz.gz\", R_OK) = -1 ENOENT (No such file or directory)\n[pid 106971] open(\"/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/libs/gap/sage.gaprc\", O_RDONLY) = 12\n[pid 106971] read(12, \"# This file is run by Sage when \"..., 20000) = 567\n[pid 106971] read(12, \"\", 20000)        = 0\n[pid 106971] close(12)                  = 0\n[pid 106971] rt_sigaction(SIGCHLD, {SIG_DFL, [CHLD], SA_RESTORER|SA_RESTART, 0x7f2bc20154b0}, {0x7f0bc9679880, [CHLD], SA_RESTORER|SA_RESTART, 0x7f2bc20154b0}, 8) = 0\n[pid 106971] stat(\"/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/matrix\", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0\n[pid 106971] stat(\"/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/matrix/action.cpython-38-x86_64-linux-gnu.so\", {st_mode=S_IFREG|0755, st_size=1110904, ...}) = 0\n[pid 106971] open(\"/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/matrix/action.cpython-38-x86_64-linux-gnu.so\", O_RDONLY|O_CLOEXEC) = 12\n[pid 106971] read(12, \"\\177ELF\\2\\1\\1\\0\\0\\0\\0\\0\\0\\0\\0\\0\\3\\0>\\0\\1\\0\\0\\0\\300?\\0\\0\\0\\0\\0\\0\"..., 832) = 832\n[pid 106971] fstat(12, {st_mode=S_IFREG|0755, st_size=1110904, ...}) = 0\n[pid 106971] mmap(NULL, 2244824, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 12, 0) = 0x7f0babc8a000\n[pid 106971] mprotect(0x7f0babca9000, 2093056, PROT_NONE) = 0\n[pid 106971] mmap(0x7f0babea8000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 12, 0x1e000) = 0x7f0babea8000\n[pid 106971] mmap(0x7f0babeae000, 216, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f0babeae000\n[pid 106971] close(12)                  = 0\n[pid 106971] mprotect(0x7f0babea8000, 4096, PROT_READ) = 0\n[pid 106971] mmap(NULL, 262144, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f0babc4a000\n[pid 106971] munmap(0x7f0babc4a000, 262144) = 0\n[pid 106971] mmap(NULL, 262144, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f0babc4a000\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={16, 968000}, ru_stime={0, 556000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={16, 968000}, ru_stime={0, 556000}, ...}) = 0\n[pid 106971] madvise(0x100004a00000, 7344128, MADV_DONTNEED) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={17, 532000}, ru_stime={0, 556000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={17, 532000}, ru_stime={0, 556000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 76000}, ru_stime={0, 556000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 76000}, ru_stime={0, 556000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 624000}, ru_stime={0, 564000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 624000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 172000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 172000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 712000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 712000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 252000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 252000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 788000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 792000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={21, 328000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={21, 328000}, ru_stime={0, 568000}, ...}) = 0\n[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={21, 872000}, ru_stime={0, 568000}, ...}) = 0\n[... repeat ad infinitum ...]\n```\n\nbut not when building locally. I tried to delete the content of sage.gaprc but that didn't help.",
    "created_at": "2020-09-12T12:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411064",
    "user": "https://github.com/vbraun"
}
```

Docbuild hangs forever on buildbots, a strace ends with

```
$ strace -ff ./sage --docbuild --verbose 99 --no-pdf-links all html
[...]
[pid 106971] access("/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/resclasses-4.7.2/init.g", F_OK) = 0
[pid 106971] access("/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/resclasses-4.7.2/read.g", F_OK) = 0
[pid 106971] access("/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/polenta-1.3.9/doc/manual.six", F_OK) = 0
[pid 106971] access("/var/lib/buildbot/slave/sage_git/build/local/share/gap/pkg/resclasses-4.7.2/doc/manual.six", F_OK) = 0
[pid 106971] access("/var/lib/buildbot/.gap/gaprc", R_OK) = -1 ENOENT (No such file or directory)
[pid 106971] access("/var/lib/buildbot/.gap/gaprc.gz", R_OK) = -1 ENOENT (No such file or directory)
[pid 106971] access("/var/lib/buildbot/slave/sage_git/build/local/share/gap/gaprc", R_OK) = -1 ENOENT (No such file or directory)
[pid 106971] access("/var/lib/buildbot/slave/sage_git/build/local/share/gap/gaprc.gz", R_OK) = -1 ENOENT (No such file or directory)
[pid 106971] access("/var/lib/buildbot/.gap", F_OK) = -1 ENOENT (No such file or directory)
[pid 106971] open("/var/lib/buildbot/.gaprc", O_RDONLY) = -1 ENOENT (No such file or directory)
[pid 106971] access("/var/lib/buildbot/.gaprc.gz", R_OK) = -1 ENOENT (No such file or directory)
[pid 106971] access("/var/lib/buildbot/.gaprc.gz.gz", R_OK) = -1 ENOENT (No such file or directory)
[pid 106971] open("/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/libs/gap/sage.gaprc", O_RDONLY) = 12
[pid 106971] read(12, "# This file is run by Sage when "..., 20000) = 567
[pid 106971] read(12, "", 20000)        = 0
[pid 106971] close(12)                  = 0
[pid 106971] rt_sigaction(SIGCHLD, {SIG_DFL, [CHLD], SA_RESTORER|SA_RESTART, 0x7f2bc20154b0}, {0x7f0bc9679880, [CHLD], SA_RESTORER|SA_RESTART, 0x7f2bc20154b0}, 8) = 0
[pid 106971] stat("/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/matrix", {st_mode=S_IFDIR|0755, st_size=12288, ...}) = 0
[pid 106971] stat("/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/matrix/action.cpython-38-x86_64-linux-gnu.so", {st_mode=S_IFREG|0755, st_size=1110904, ...}) = 0
[pid 106971] open("/var/lib/buildbot/slave/sage_git/build/local/lib/python3.8/site-packages/sage/matrix/action.cpython-38-x86_64-linux-gnu.so", O_RDONLY|O_CLOEXEC) = 12
[pid 106971] read(12, "\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0>\0\1\0\0\0\300?\0\0\0\0\0\0"..., 832) = 832
[pid 106971] fstat(12, {st_mode=S_IFREG|0755, st_size=1110904, ...}) = 0
[pid 106971] mmap(NULL, 2244824, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, 12, 0) = 0x7f0babc8a000
[pid 106971] mprotect(0x7f0babca9000, 2093056, PROT_NONE) = 0
[pid 106971] mmap(0x7f0babea8000, 24576, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, 12, 0x1e000) = 0x7f0babea8000
[pid 106971] mmap(0x7f0babeae000, 216, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, -1, 0) = 0x7f0babeae000
[pid 106971] close(12)                  = 0
[pid 106971] mprotect(0x7f0babea8000, 4096, PROT_READ) = 0
[pid 106971] mmap(NULL, 262144, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f0babc4a000
[pid 106971] munmap(0x7f0babc4a000, 262144) = 0
[pid 106971] mmap(NULL, 262144, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1, 0) = 0x7f0babc4a000
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={16, 968000}, ru_stime={0, 556000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={16, 968000}, ru_stime={0, 556000}, ...}) = 0
[pid 106971] madvise(0x100004a00000, 7344128, MADV_DONTNEED) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={17, 532000}, ru_stime={0, 556000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={17, 532000}, ru_stime={0, 556000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 76000}, ru_stime={0, 556000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 76000}, ru_stime={0, 556000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 624000}, ru_stime={0, 564000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={18, 624000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 172000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 172000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 712000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={19, 712000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 252000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 252000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 788000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={20, 792000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={21, 328000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={21, 328000}, ru_stime={0, 568000}, ...}) = 0
[pid 106971] getrusage(RUSAGE_SELF, {ru_utime={21, 872000}, ru_stime={0, 568000}, ...}) = 0
[... repeat ad infinitum ...]
```

but not when building locally. I tried to delete the content of sage.gaprc but that didn't help.



---

archive/issue_comments_411065.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-09-12T12:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411065",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_411066.json:
```json
{
    "body": "Absolutely no idea what sort of fresh hell this might be. \n\nTime to get rid of buildbots, maybe...\n----\nNew commits:",
    "created_at": "2020-09-12T21:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411066",
    "user": "https://github.com/dimpase"
}
```

Absolutely no idea what sort of fresh hell this might be. 

Time to get rid of buildbots, maybe...
----
New commits:



---

archive/issue_comments_411067.json:
```json
{
    "body": "could it be something like running out of file descriptors?",
    "created_at": "2020-09-12T21:54:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411067",
    "user": "https://github.com/dimpase"
}
```

could it be something like running out of file descriptors?



---

archive/issue_comments_411068.json:
```json
{
    "body": "Unlikely, it happened also on kucalc which is rather beefy",
    "created_at": "2020-09-12T22:32:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411068",
    "user": "https://github.com/vbraun"
}
```

Unlikely, it happened also on kucalc which is rather beefy



---

archive/issue_comments_411069.json:
```json
{
    "body": "OS has a hard limit on the number of them, beefy or not, and if you leak them, then god help you.\n\ncould also be some parallelisation crap. Do bildbots try to over-parallelise things, with setting MAKE to something etc?\n\nCould also be something similar to #30351 - which deals with a hanging docbuild on macOS - maybe this desease is now infecting buildbots too?",
    "created_at": "2020-09-13T06:54:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411069",
    "user": "https://github.com/dimpase"
}
```

OS has a hard limit on the number of them, beefy or not, and if you leak them, then god help you.

could also be some parallelisation crap. Do bildbots try to over-parallelise things, with setting MAKE to something etc?

Could also be something similar to #30351 - which deals with a hanging docbuild on macOS - maybe this desease is now infecting buildbots too?



---

archive/issue_comments_411070.json:
```json
{
    "body": "There are multiple physical hosts, its not a resource limit (or at least one thats set up by the docbuilder)",
    "created_at": "2020-09-13T09:40:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411070",
    "user": "https://github.com/vbraun"
}
```

There are multiple physical hosts, its not a resource limit (or at least one thats set up by the docbuilder)



---

archive/issue_comments_411071.json:
```json
{
    "body": "any idea at what point of docbuild it hangs?",
    "created_at": "2020-09-13T17:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411071",
    "user": "https://github.com/dimpase"
}
```

any idea at what point of docbuild it hangs?



---

archive/issue_comments_411072.json:
```json
{
    "body": "\n```\ncd ../.. && sage-logger -p './sage --docbuild --no-pdf-links all html -j ' logs/dochtml.log\n[dochtml] \n[dochtml] Building reference manual, first pass.\n[dochtml] \n[dochtml] [reference] building [inventory]: targets for 1 source files that are out of date\n[dochtml] [reference] updating environment: [new config] 1 added, 0 changed, 0 removed\n[dochtml] [reference] The inventory files are in local/share/doc/sage/inventory/en/reference/references.\n[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/references\n[dochtml] [spkg     ] building [inventory]: targets for 271 source files that are out of date\n[dochtml] [spkg     ] updating environment: [new config] 271 added, 0 changed, 0 removed\n[dochtml] [spkg     ] The inventory files are in local/share/doc/sage/inventory/en/reference/spkg.\n[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/spkg\n[dochtml] [manifolds] building [inventory]: targets for 78 source files that are out of date\n[dochtml] [manifolds] updating environment: [new config] 78 added, 0 changed, 0 removed\n[dochtml] [manifolds] The inventory files are in local/share/doc/sage/inventory/en/reference/manifolds.\n[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/manifolds\n[dochtml] [polynomia] building [inventory]: targets for 62 source files that are out of date\n[dochtml] [polynomia] updating environment: [new config] 62 added, 0 changed, 0 removed\n[dochtml] [polynomia] The inventory files are in local/share/doc/sage/inventory/en/reference/polynomial_rings.\n[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/polynomial_rings\n[dochtml] [repl     ] building [inventory]: targets for 35 source files that are out of date\n[dochtml] [repl     ] updating environment: [new config] 35 added, 0 changed, 0 removed\n[dochtml] [repl     ] The inventory files are in local/share/doc/sage/inventory/en/reference/repl.\n[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/repl\n[dochtml] [algebras ] building [inventory]: targets for 95 source files that are out of date\n[dochtml] [algebras ] updating environment: [new config] 95 added, 0 changed, 0 removed\n[dochtml] [algebras ] The inventory files are in local/share/doc/sage/inventory/en/reference/algebras.\n[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/algebras\n[dochtml] [tensor_fr] building [inventory]: targets for 19 source files that are out of date\n[dochtml] [tensor_fr] updating environment: [new config] 19 added, 0 changed, 0 removed\n[dochtml] [tensor_fr] The inventory files are in local/share/doc/sage/inventory/en/reference/tensor_free_modules.\n[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/tensor_free_modules\n[dochtml] Warning: Missing title for sage.combinat.posets.mobile\n[dochtml] [combinat ] building [inventory]: targets for 378 source files that are out of date\n[dochtml] [combinat ] updating environment: [new config] 378 added, 0 changed, 0 removed\ncommand timed out: 1200 seconds without output running ['make', 'doc-html-mathjax'], attempting to kill\nprocess killed by signal 9\nprogram finished with exit code -1\nelapsedTime=1349.554977\n```\n\n`@`mkoeppe: can you try to reproduce it on a CI build?",
    "created_at": "2020-09-13T22:17:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411072",
    "user": "https://github.com/vbraun"
}
```


```
cd ../.. && sage-logger -p './sage --docbuild --no-pdf-links all html -j ' logs/dochtml.log
[dochtml] 
[dochtml] Building reference manual, first pass.
[dochtml] 
[dochtml] [reference] building [inventory]: targets for 1 source files that are out of date
[dochtml] [reference] updating environment: [new config] 1 added, 0 changed, 0 removed
[dochtml] [reference] The inventory files are in local/share/doc/sage/inventory/en/reference/references.
[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/references
[dochtml] [spkg     ] building [inventory]: targets for 271 source files that are out of date
[dochtml] [spkg     ] updating environment: [new config] 271 added, 0 changed, 0 removed
[dochtml] [spkg     ] The inventory files are in local/share/doc/sage/inventory/en/reference/spkg.
[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/spkg
[dochtml] [manifolds] building [inventory]: targets for 78 source files that are out of date
[dochtml] [manifolds] updating environment: [new config] 78 added, 0 changed, 0 removed
[dochtml] [manifolds] The inventory files are in local/share/doc/sage/inventory/en/reference/manifolds.
[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/manifolds
[dochtml] [polynomia] building [inventory]: targets for 62 source files that are out of date
[dochtml] [polynomia] updating environment: [new config] 62 added, 0 changed, 0 removed
[dochtml] [polynomia] The inventory files are in local/share/doc/sage/inventory/en/reference/polynomial_rings.
[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/polynomial_rings
[dochtml] [repl     ] building [inventory]: targets for 35 source files that are out of date
[dochtml] [repl     ] updating environment: [new config] 35 added, 0 changed, 0 removed
[dochtml] [repl     ] The inventory files are in local/share/doc/sage/inventory/en/reference/repl.
[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/repl
[dochtml] [algebras ] building [inventory]: targets for 95 source files that are out of date
[dochtml] [algebras ] updating environment: [new config] 95 added, 0 changed, 0 removed
[dochtml] [algebras ] The inventory files are in local/share/doc/sage/inventory/en/reference/algebras.
[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/algebras
[dochtml] [tensor_fr] building [inventory]: targets for 19 source files that are out of date
[dochtml] [tensor_fr] updating environment: [new config] 19 added, 0 changed, 0 removed
[dochtml] [tensor_fr] The inventory files are in local/share/doc/sage/inventory/en/reference/tensor_free_modules.
[dochtml] Build finished. The built documents can be found in /home/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/tensor_free_modules
[dochtml] Warning: Missing title for sage.combinat.posets.mobile
[dochtml] [combinat ] building [inventory]: targets for 378 source files that are out of date
[dochtml] [combinat ] updating environment: [new config] 378 added, 0 changed, 0 removed
command timed out: 1200 seconds without output running ['make', 'doc-html-mathjax'], attempting to kill
process killed by signal 9
program finished with exit code -1
elapsedTime=1349.554977
```

`@`mkoeppe: can you try to reproduce it on a CI build?



---

archive/issue_comments_411073.json:
```json
{
    "body": "What is the meaning of `-j` option in `./sage --docbuild --no-pdf-links all html -j `?\n\nIs it documented? If it's akin to `-j` for `make`, then, hmm, all bets are off.",
    "created_at": "2020-09-13T22:57:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411073",
    "user": "https://github.com/dimpase"
}
```

What is the meaning of `-j` option in `./sage --docbuild --no-pdf-links all html -j `?

Is it documented? If it's akin to `-j` for `make`, then, hmm, all bets are off.



---

archive/issue_comments_411074.json:
```json
{
    "body": "Ah, ok, `-j` is  for MathJax. Is MathJax locally installed?",
    "created_at": "2020-09-13T23:00:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411074",
    "user": "https://github.com/dimpase"
}
```

Ah, ok, `-j` is  for MathJax. Is MathJax locally installed?



---

archive/issue_comments_411075.json:
```json
{
    "body": "Definitely not on all buildbots...",
    "created_at": "2020-09-15T22:10:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411075",
    "user": "https://github.com/vbraun"
}
```

Definitely not on all buildbots...



---

archive/issue_comments_411076.json:
```json
{
    "body": "Replying to [comment:40 vbraun]:\n> Definitely not on all buildbots...\ndoes it only hang on buildbots without locally installed MathJax ?",
    "created_at": "2020-09-16T08:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411076",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:40 vbraun]:
> Definitely not on all buildbots...
does it only hang on buildbots without locally installed MathJax ?



---

archive/issue_comments_411077.json:
```json
{
    "body": "Here an observation which could help (done under WSL Ubuntu):\n\nIf I checkout this ticket on top of 9.2.beta12 and do\n\n\n```\nmake SAGE_SPKG=\"sage-spkg -o\" gap_packages-clean build\n```\n\n\nthen I get:\n\n\n```\nsage: B = BraidGroup(8)\nTraceback (most recent call last):\n...\nGAPError: Error, no method found! Error, no 2nd choice method found for `InverseSameMutability' on 1 arguments\n```\n\n\nI came accross that while looking at the docbuild failure noted in #30346 (which seems to be caused by this ticket as well).",
    "created_at": "2020-09-16T12:57:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411077",
    "user": "https://github.com/soehms"
}
```

Here an observation which could help (done under WSL Ubuntu):

If I checkout this ticket on top of 9.2.beta12 and do


```
make SAGE_SPKG="sage-spkg -o" gap_packages-clean build
```


then I get:


```
sage: B = BraidGroup(8)
Traceback (most recent call last):
...
GAPError: Error, no method found! Error, no 2nd choice method found for `InverseSameMutability' on 1 arguments
```


I came accross that while looking at the docbuild failure noted in #30346 (which seems to be caused by this ticket as well).



---

archive/issue_comments_411078.json:
```json
{
    "body": "Replying to [comment:42 soehms]:\n> Here an observation which could help (done under WSL Ubuntu):\n> \n> If I checkout this ticket on top of 9.2.beta12 and do\n> \n> {{{\n> make SAGE_SPKG=\"sage-spkg -o\" gap_packages-clean build\n> }}}\n> \n> then I get:\n> \n> {{{\n> sage: B = BraidGroup(8)\n> Traceback (most recent call last):\n> ...\n> GAPError: Error, no method found! Error, no 2nd choice method found for `InverseSameMutability' on 1 arguments\n> }}}\n> \n> I came accross that while looking at the docbuild failure noted in #30346 (which seems to be caused by this ticket as well).\n\nI tried `B = BraidGroup(8)` on this branch, without and with `gap_packages` installed, and it works for me. (On Gentoo Linux - so this might be an WSL problem).",
    "created_at": "2020-09-16T15:12:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411078",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:42 soehms]:
> Here an observation which could help (done under WSL Ubuntu):
> 
> If I checkout this ticket on top of 9.2.beta12 and do
> 
> {{{
> make SAGE_SPKG="sage-spkg -o" gap_packages-clean build
> }}}
> 
> then I get:
> 
> {{{
> sage: B = BraidGroup(8)
> Traceback (most recent call last):
> ...
> GAPError: Error, no method found! Error, no 2nd choice method found for `InverseSameMutability' on 1 arguments
> }}}
> 
> I came accross that while looking at the docbuild failure noted in #30346 (which seems to be caused by this ticket as well).

I tried `B = BraidGroup(8)` on this branch, without and with `gap_packages` installed, and it works for me. (On Gentoo Linux - so this might be an WSL problem).



---

archive/issue_comments_411079.json:
```json
{
    "body": "to support gcc10 we need https://github.com/gap-packages/cohomolo/pull/25 here",
    "created_at": "2020-09-16T17:12:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411079",
    "user": "https://github.com/dimpase"
}
```

to support gcc10 we need https://github.com/gap-packages/cohomolo/pull/25 here



---

archive/issue_comments_411080.json:
```json
{
    "body": "Can this upstream patch be applied to the existing gap version (4.10.2) as well? Then that should probably be done on a separate ticket",
    "created_at": "2020-09-16T21:32:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411080",
    "user": "https://github.com/mkoeppe"
}
```

Can this upstream patch be applied to the existing gap version (4.10.2) as well? Then that should probably be done on a separate ticket



---

archive/issue_comments_411081.json:
```json
{
    "body": "added a patch needed for gap_packages on XCode 12\n----\nNew commits:",
    "created_at": "2020-09-24T13:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411081",
    "user": "https://github.com/dimpase"
}
```

added a patch needed for gap_packages on XCode 12
----
New commits:



---

archive/issue_comments_411082.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-09-24T13:51:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411082",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_411083.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-24T13:52:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411083",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411084.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-24T17:06:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411084",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411085.json:
```json
{
    "body": "added forgotten gcc-10 patch",
    "created_at": "2020-09-24T17:06:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411085",
    "user": "https://github.com/dimpase"
}
```

added forgotten gcc-10 patch



---

archive/issue_comments_411086.json:
```json
{
    "body": "Replying to [comment:43 dimpase]:\n> Replying to [comment:42 soehms]:\n> > Here an observation which could help (done under WSL Ubuntu):\n....\n> \n> I tried `B = BraidGroup(8)` on this branch, without and with `gap_packages` installed, and it works for me. (On Gentoo Linux - so this might be an WSL problem).\n\nDima, I'm having the same problem on `LinuxMint 19.1`. So, its probably not a WSL issue but maybe a problem with the person in front of the computer. Can you please post how I have to build Sage after checking out the branch?",
    "created_at": "2020-09-26T15:27:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411086",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:43 dimpase]:
> Replying to [comment:42 soehms]:
> > Here an observation which could help (done under WSL Ubuntu):
....
> 
> I tried `B = BraidGroup(8)` on this branch, without and with `gap_packages` installed, and it works for me. (On Gentoo Linux - so this might be an WSL problem).

Dima, I'm having the same problem on `LinuxMint 19.1`. So, its probably not a WSL issue but maybe a problem with the person in front of the computer. Can you please post how I have to build Sage after checking out the branch?



---

archive/issue_comments_411087.json:
```json
{
    "body": "Replying to [comment:51 soehms]:\n> Dima, I'm having the same problem on `LinuxMint 19.1`. So, its probably not a WSL issue but maybe a problem with the person in front of the computer. Can you please post how I have to build Sage after checking out the branch?\n\n1. pull the branch\n2. ./sage  -f gap\n3. ./sage -f gap_packages  # (optional)\n4. make build",
    "created_at": "2020-09-27T17:03:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411087",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:51 soehms]:
> Dima, I'm having the same problem on `LinuxMint 19.1`. So, its probably not a WSL issue but maybe a problem with the person in front of the computer. Can you please post how I have to build Sage after checking out the branch?

1. pull the branch
2. ./sage  -f gap
3. ./sage -f gap_packages  # (optional)
4. make build



---

archive/issue_comments_411088.json:
```json
{
    "body": "Replying to [comment:52 dimpase]:\n> Replying to [comment:51 soehms]:\n> > Dima, I'm having the same problem on `LinuxMint 19.1`. So, its probably not a WSL issue but maybe a problem with the person in front of the computer. Can you please post how I have to build Sage after checking out the branch?\n> \n> 1. pull the branch\n> 2. ./sage  -f gap\n> 3. ./sage -f gap_packages  # (optional)\n> 4. make build\n> \n\nThank you! Unfortunately that didn't solve the problem. Is it possible that there is a dependency missing in the ticket description?\n\nThe list of doctest failures under `groups` I'm getting under `WSL` and `LinuxMint` looks like this:\n\n\n```\n...\nsage -t --random-seed=0 src/sage/groups/braid.py  # 289 doctests failed\nsage -t --random-seed=0 src/sage/groups/raag.py  # 145 doctests failed\nsage -t --random-seed=0 src/sage/groups/libgap_wrapper.pyx  # 13 doctests failed\nsage -t --random-seed=0 src/sage/groups/free_group.py  # Killed due to segmentation fault\nsage -t --random-seed=0 src/sage/groups/finitely_presented.py  # 251 doctests failed\n...\n```\n\n\nIn the case of `finitely_presented.py` I also got `longjmp` error messages:\n\n\n```\n*** longjmp causes uninitialized stack frame ***: /home/sebastian/develop/sage/local/bin/python3 terminated\n*** longjmp causes uninitialized stack frame ***: /home/sebastian/develop/sage/local/bin/python3 terminated\n```\n",
    "created_at": "2020-09-28T19:31:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411088",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:52 dimpase]:
> Replying to [comment:51 soehms]:
> > Dima, I'm having the same problem on `LinuxMint 19.1`. So, its probably not a WSL issue but maybe a problem with the person in front of the computer. Can you please post how I have to build Sage after checking out the branch?
> 
> 1. pull the branch
> 2. ./sage  -f gap
> 3. ./sage -f gap_packages  # (optional)
> 4. make build
> 

Thank you! Unfortunately that didn't solve the problem. Is it possible that there is a dependency missing in the ticket description?

The list of doctest failures under `groups` I'm getting under `WSL` and `LinuxMint` looks like this:


```
...
sage -t --random-seed=0 src/sage/groups/braid.py  # 289 doctests failed
sage -t --random-seed=0 src/sage/groups/raag.py  # 145 doctests failed
sage -t --random-seed=0 src/sage/groups/libgap_wrapper.pyx  # 13 doctests failed
sage -t --random-seed=0 src/sage/groups/free_group.py  # Killed due to segmentation fault
sage -t --random-seed=0 src/sage/groups/finitely_presented.py  # 251 doctests failed
...
```


In the case of `finitely_presented.py` I also got `longjmp` error messages:


```
*** longjmp causes uninitialized stack frame ***: /home/sebastian/develop/sage/local/bin/python3 terminated
*** longjmp causes uninitialized stack frame ***: /home/sebastian/develop/sage/local/bin/python3 terminated
```




---

archive/issue_comments_411089.json:
```json
{
    "body": "1. try removing `~/.sage/gap/`, or even `~/.sage/`. \n\n2. Could it be you have GAP installed systemwide, and you get an interference?\n   Or perhaps something in your `gap.ini` or `gaprc` files, cf. https://www.gap-system.org/Manuals/doc/ref/chap3.html#X7FD66F977A3B02DF ? \n\n3. Test the Sage's GAP 4.11 installation, e.g. by\n\n```\n$ SAGE_CHECK=yes ./sage -f gap\n```\n\n\n4. Try building this branch from scratch.",
    "created_at": "2020-09-28T21:01:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411089",
    "user": "https://github.com/dimpase"
}
```

1. try removing `~/.sage/gap/`, or even `~/.sage/`. 

2. Could it be you have GAP installed systemwide, and you get an interference?
   Or perhaps something in your `gap.ini` or `gaprc` files, cf. https://www.gap-system.org/Manuals/doc/ref/chap3.html#X7FD66F977A3B02DF ? 

3. Test the Sage's GAP 4.11 installation, e.g. by

```
$ SAGE_CHECK=yes ./sage -f gap
```


4. Try building this branch from scratch.



---

archive/issue_comments_411090.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-09-29T16:02:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411090",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_411091.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-29T16:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411091",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_411092.json:
```json
{
    "body": "Volker, could we try this again? I gather that the commit in comment:55 should change the behaviour of buildbots in comment:29, where crunch seems to happen after reading `sage.gaprc`\n(and this commit removes an overlooked GAP 4.10-specific workaround in `sage.gaprc`)",
    "created_at": "2020-09-29T16:05:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411092",
    "user": "https://github.com/dimpase"
}
```

Volker, could we try this again? I gather that the commit in comment:55 should change the behaviour of buildbots in comment:29, where crunch seems to happen after reading `sage.gaprc`
(and this commit removes an overlooked GAP 4.10-specific workaround in `sage.gaprc`)



---

archive/issue_comments_411093.json:
```json
{
    "body": "Replying to [comment:54 dimpase]:\n\nThanks for the advices! Here my results:\n\n> 1. try removing `~/.sage/gap/`, or even `~/.sage/`.\n\nno succsess\n\n> 2. Could it be you have GAP installed systemwide, and you get an interference?  Or perhaps something in your `gap.ini` or `gaprc` files ...\n\nyes, on both of the platforms there is gap 4.8.8, but I was not aware of that. I once installed Sage via `apt` which is an old version (8.1). My guess is that the systemwide gap came along with that (possible?). \n\n\nBut anyway, I have an older computer running under `LinuxMint 18` without a systemwide gap installed and the bug shows there, as well, even after your latest commit. Furthermore I didn't find `gap.ini` and `gaprc` below `local/share/gap`.\n\n> 3. Test the Sage's GAP 4.11 installation, e.g. by\n> {{{\n> $ SAGE_CHECK=yes ./sage -f gap\n> }}}\n\nThe gap testsuite passed through successfully (in all cases).\n\n> 4. Try building this branch from scratch.\n\nOn the `WSL` machine I build from a fresh git clone. The bug still shows.\n\nThe error output on the older machine produced back-trace information for the longjmp errors. Shall I upload a log-file?",
    "created_at": "2020-09-29T17:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411093",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:54 dimpase]:

Thanks for the advices! Here my results:

> 1. try removing `~/.sage/gap/`, or even `~/.sage/`.

no succsess

> 2. Could it be you have GAP installed systemwide, and you get an interference?  Or perhaps something in your `gap.ini` or `gaprc` files ...

yes, on both of the platforms there is gap 4.8.8, but I was not aware of that. I once installed Sage via `apt` which is an old version (8.1). My guess is that the systemwide gap came along with that (possible?). 


But anyway, I have an older computer running under `LinuxMint 18` without a systemwide gap installed and the bug shows there, as well, even after your latest commit. Furthermore I didn't find `gap.ini` and `gaprc` below `local/share/gap`.

> 3. Test the Sage's GAP 4.11 installation, e.g. by
> {{{
> $ SAGE_CHECK=yes ./sage -f gap
> }}}

The gap testsuite passed through successfully (in all cases).

> 4. Try building this branch from scratch.

On the `WSL` machine I build from a fresh git clone. The bug still shows.

The error output on the older machine produced back-trace information for the longjmp errors. Shall I upload a log-file?



---

archive/issue_comments_411094.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2020-09-29T18:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411094",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_411095.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:",
    "created_at": "2020-09-29T18:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411095",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:



---

archive/issue_comments_411096.json:
```json
{
    "body": "Replying to [comment:57 soehms]:\n> Replying to [comment:54 dimpase]:\n> \n> Thanks for the advices! Here my results:\n> \n> > 1. try removing `~/.sage/gap/`, or even `~/.sage/`.\n> \n> no succsess\n> \n> > 2. Could it be you have GAP installed systemwide, and you get an interference?  Or perhaps something in your `gap.ini` or `gaprc` files ...\n> \n> yes, on both of the platforms there is gap 4.8.8, but I was not aware of that. I once installed Sage via `apt` which is an old version (8.1). My guess is that the systemwide gap came along with that (possible?). \n\nCould it be that you have an old libgap too, somewhere, from Sage 8.1?\n\n\nlibgap and GAP share stuff under Sage, and if something came from GAP 4.8.8 then certainly there is a high chance that things break.\nCould you remove the old GAP and old Sage and try again?\n\n> \n> \n> But anyway, I have an older computer running under `LinuxMint 18` without a systemwide gap installed and the bug shows there, as well, even after your latest commit. Furthermore I didn't find `gap.ini` and `gaprc` below `local/share/gap`.\n\nPlease make sure there no traces of other GAP installations, `.gaprc` etc on that other machine.\n\n> \n> > 3. Test the Sage's GAP 4.11 installation, e.g. by\n> > {{{\n> > $ SAGE_CHECK=yes ./sage -f gap\n> > }}}\n> \n> The gap testsuite passed through successfully (in all cases).\n> \n> > 4. Try building this branch from scratch.\n> \n> On the `WSL` machine I build from a fresh git clone. The bug still shows.\n> \n> The error output on the older machine produced back-trace information for the longjmp errors. Shall I upload a log-file?\n\nHopefully it's just stale bits that cause this error.\nCould you post the linkage of libgap Python module, i.e. the output of\n\n```\nldd local/lib/python3*/site-packages/sage/libs/gap/libgap.*.so\n```\n",
    "created_at": "2020-09-29T18:27:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411096",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:57 soehms]:
> Replying to [comment:54 dimpase]:
> 
> Thanks for the advices! Here my results:
> 
> > 1. try removing `~/.sage/gap/`, or even `~/.sage/`.
> 
> no succsess
> 
> > 2. Could it be you have GAP installed systemwide, and you get an interference?  Or perhaps something in your `gap.ini` or `gaprc` files ...
> 
> yes, on both of the platforms there is gap 4.8.8, but I was not aware of that. I once installed Sage via `apt` which is an old version (8.1). My guess is that the systemwide gap came along with that (possible?). 

Could it be that you have an old libgap too, somewhere, from Sage 8.1?


libgap and GAP share stuff under Sage, and if something came from GAP 4.8.8 then certainly there is a high chance that things break.
Could you remove the old GAP and old Sage and try again?

> 
> 
> But anyway, I have an older computer running under `LinuxMint 18` without a systemwide gap installed and the bug shows there, as well, even after your latest commit. Furthermore I didn't find `gap.ini` and `gaprc` below `local/share/gap`.

Please make sure there no traces of other GAP installations, `.gaprc` etc on that other machine.

> 
> > 3. Test the Sage's GAP 4.11 installation, e.g. by
> > {{{
> > $ SAGE_CHECK=yes ./sage -f gap
> > }}}
> 
> The gap testsuite passed through successfully (in all cases).
> 
> > 4. Try building this branch from scratch.
> 
> On the `WSL` machine I build from a fresh git clone. The bug still shows.
> 
> The error output on the older machine produced back-trace information for the longjmp errors. Shall I upload a log-file?

Hopefully it's just stale bits that cause this error.
Could you post the linkage of libgap Python module, i.e. the output of

```
ldd local/lib/python3*/site-packages/sage/libs/gap/libgap.*.so
```




---

archive/issue_comments_411097.json:
```json
{
    "body": "Replying to [comment:59 dimpase]:\n> Replying to [comment:57 soehms]:\n> > Replying to [comment:54 dimpase]:\n> > \n> ......\n\n> Hopefully it's just stale bits that cause this error.\n> Could you post the linkage of libgap Python module, i.e. the output of\n> {{{\n> ldd local/lib/python3*/site-packages/sage/libs/gap/libgap.*.so\n> }}}\n\n\n> \n\nHere the one from the `LinuxMint 18`\n\n\n```\nlocal/lib/python3.7/site-packages/sage/libs/gap/libgap.cpython-37m-x86_64-linux-gnu.so:\n\tlinux-vdso.so.1 =>  (0x00007ffd3a776000)\n\tlibgap.so.0 => /home/sebastian/develop/sage/local/lib/libgap.so.0 (0x00007efc33b3c000)\n\tlibpython3.7m.so.1.0 => not found\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007efc3391f000)\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007efc33555000)\n\tlibgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007efc332d5000)\n\tlibz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007efc330bb000)\n\tlibreadline.so.6 => /home/sebastian/develop/sage/local/lib/libreadline.so.6 (0x00007efc32e71000)\n\tlibm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007efc32b68000)\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007efc32964000)\n\tlibutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007efc32761000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00007efc34a8c000)\n\tlibtinfo.so.6 => /home/sebastian/develop/sage/local/lib/libtinfo.so.6 (0x00007efc32528000)\nlocal/lib/python3.8/site-packages/sage/libs/gap/libgap.cpython-38-x86_64-linux-gnu.so:\n\tlinux-vdso.so.1 =>  (0x00007fff44b9d000)\n\tlibgap.so.0 => /home/sebastian/develop/sage/local/lib/libgap.so.0 (0x00007fdca3ad8000)\n\tlibpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fdca38bb000)\n\tlibc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fdca34f1000)\n\tlibgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007fdca3271000)\n\tlibz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007fdca3057000)\n\tlibreadline.so.6 => /home/sebastian/develop/sage/local/lib/libreadline.so.6 (0x00007fdca2e0d000)\n\tlibm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007fdca2b04000)\n\tlibdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fdca2900000)\n\tlibutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007fdca26fd000)\n\t/lib64/ld-linux-x86-64.so.2 (0x00007fdca4a29000)\n\tlibtinfo.so.6 => /home/sebastian/develop/sage/local/lib/libtinfo.so.6 (0x00007fdca24c4000)\n```\n\n\n\nHere from `WSL` case\n\n\n```\n        linux-vdso.so.1 (0x00007ffff0e43000)\n        libgap.so.0 => /home/sebastian/devel/sage/local/lib/libgap.so.0 (0x00007f53a2a65000)\n        libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f53a2830000)\n        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f53a2430000)\n        libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f53a21a0000)\n        libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007f53a1f80000)\n        libreadline.so.7 => /lib/x86_64-linux-gnu/libreadline.so.7 (0x00007f53a1d30000)\n        libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f53a1980000)\n        libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f53a1770000)\n        libutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007f53a1560000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007f53a3600000)\n        libtinfo.so.5 => /lib/x86_64-linux-gnu/libtinfo.so.5 (0x00007f53a1330000)\n```\n",
    "created_at": "2020-09-29T19:08:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411097",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:59 dimpase]:
> Replying to [comment:57 soehms]:
> > Replying to [comment:54 dimpase]:
> > 
> ......

> Hopefully it's just stale bits that cause this error.
> Could you post the linkage of libgap Python module, i.e. the output of
> {{{
> ldd local/lib/python3*/site-packages/sage/libs/gap/libgap.*.so
> }}}


> 

Here the one from the `LinuxMint 18`


```
local/lib/python3.7/site-packages/sage/libs/gap/libgap.cpython-37m-x86_64-linux-gnu.so:
	linux-vdso.so.1 =>  (0x00007ffd3a776000)
	libgap.so.0 => /home/sebastian/develop/sage/local/lib/libgap.so.0 (0x00007efc33b3c000)
	libpython3.7m.so.1.0 => not found
	libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007efc3391f000)
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007efc33555000)
	libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007efc332d5000)
	libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007efc330bb000)
	libreadline.so.6 => /home/sebastian/develop/sage/local/lib/libreadline.so.6 (0x00007efc32e71000)
	libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007efc32b68000)
	libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007efc32964000)
	libutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007efc32761000)
	/lib64/ld-linux-x86-64.so.2 (0x00007efc34a8c000)
	libtinfo.so.6 => /home/sebastian/develop/sage/local/lib/libtinfo.so.6 (0x00007efc32528000)
local/lib/python3.8/site-packages/sage/libs/gap/libgap.cpython-38-x86_64-linux-gnu.so:
	linux-vdso.so.1 =>  (0x00007fff44b9d000)
	libgap.so.0 => /home/sebastian/develop/sage/local/lib/libgap.so.0 (0x00007fdca3ad8000)
	libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fdca38bb000)
	libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fdca34f1000)
	libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007fdca3271000)
	libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007fdca3057000)
	libreadline.so.6 => /home/sebastian/develop/sage/local/lib/libreadline.so.6 (0x00007fdca2e0d000)
	libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007fdca2b04000)
	libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007fdca2900000)
	libutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007fdca26fd000)
	/lib64/ld-linux-x86-64.so.2 (0x00007fdca4a29000)
	libtinfo.so.6 => /home/sebastian/develop/sage/local/lib/libtinfo.so.6 (0x00007fdca24c4000)
```



Here from `WSL` case


```
        linux-vdso.so.1 (0x00007ffff0e43000)
        libgap.so.0 => /home/sebastian/devel/sage/local/lib/libgap.so.0 (0x00007f53a2a65000)
        libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f53a2830000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f53a2430000)
        libgmp.so.10 => /usr/lib/x86_64-linux-gnu/libgmp.so.10 (0x00007f53a21a0000)
        libz.so.1 => /lib/x86_64-linux-gnu/libz.so.1 (0x00007f53a1f80000)
        libreadline.so.7 => /lib/x86_64-linux-gnu/libreadline.so.7 (0x00007f53a1d30000)
        libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f53a1980000)
        libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f53a1770000)
        libutil.so.1 => /lib/x86_64-linux-gnu/libutil.so.1 (0x00007f53a1560000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f53a3600000)
        libtinfo.so.5 => /lib/x86_64-linux-gnu/libtinfo.so.5 (0x00007f53a1330000)
```




---

archive/issue_comments_411098.json:
```json
{
    "body": "Linux Mint case looks a bit funny, as you have both python 3.7 and 3.8 in one installation? Or they are different?\n\nCould you also post the errors you get in src/sage/groups/libgap_wrapper.pyx ?\n(which is the root cause of the other errors, I gather)\n\nAnyhow, I'm now testing on Linux Mint 19 (in an lxc container), let's see if this is reproducible.",
    "created_at": "2020-09-29T21:06:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411098",
    "user": "https://github.com/dimpase"
}
```

Linux Mint case looks a bit funny, as you have both python 3.7 and 3.8 in one installation? Or they are different?

Could you also post the errors you get in src/sage/groups/libgap_wrapper.pyx ?
(which is the root cause of the other errors, I gather)

Anyhow, I'm now testing on Linux Mint 19 (in an lxc container), let's see if this is reproducible.



---

archive/issue_comments_411099.json:
```json
{
    "body": "Output of doctest of libgap_wrapper.pyx on LinuxMint 18",
    "created_at": "2020-09-30T04:33:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411099",
    "user": "https://github.com/soehms"
}
```

Output of doctest of libgap_wrapper.pyx on LinuxMint 18



---

archive/issue_comments_411100.json:
```json
{
    "body": "Attachment [libgap_wrapper_test.log](tarball://root/attachments/some-uuid/ticket29314/libgap_wrapper_test.log) by @soehms created at 2020-09-30 04:37:39\n\nReplying to [comment:61 dimpase]:\n\n> Could you also post the errors you get in src/sage/groups/libgap_wrapper.pyx ?\n> (which is the root cause of the other errors, I gather)\n\nSee the attached file!",
    "created_at": "2020-09-30T04:37:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411100",
    "user": "https://github.com/soehms"
}
```

Attachment [libgap_wrapper_test.log](tarball://root/attachments/some-uuid/ticket29314/libgap_wrapper_test.log) by @soehms created at 2020-09-30 04:37:39

Replying to [comment:61 dimpase]:

> Could you also post the errors you get in src/sage/groups/libgap_wrapper.pyx ?
> (which is the root cause of the other errors, I gather)

See the attached file!



---

archive/issue_comments_411101.json:
```json
{
    "body": "I've installed Linux Mint Tara (i.e. 19) in an xlc container, built this branch there, and ran tests - and everything worked. Here is what I have in the apt sources list\n\n```\ndeb http://packages.linuxmint.com tara main upstream import backport\ndeb http://archive.ubuntu.com/ubuntu bionic main restricted universe multiverse\ndeb http://archive.ubuntu.com/ubuntu bionic-updates main restricted universe multiverse\ndeb http://security.ubuntu.com/ubuntu bionic-security main restricted universe multiverse\n```\n\nthe kernel is\n\n```\nLinux m1 5.4.48-06434-gd868196d13af #1 SMP PREEMPT Wed Jul 29 00:32:34 PDT 2020 x86_64 x86_64 x86_64 GNU/Linux\n```\n\nSo it looks as if everything should run just fine - I guess something is wrong with the particular box, sorry.",
    "created_at": "2020-09-30T08:25:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411101",
    "user": "https://github.com/dimpase"
}
```

I've installed Linux Mint Tara (i.e. 19) in an xlc container, built this branch there, and ran tests - and everything worked. Here is what I have in the apt sources list

```
deb http://packages.linuxmint.com tara main upstream import backport
deb http://archive.ubuntu.com/ubuntu bionic main restricted universe multiverse
deb http://archive.ubuntu.com/ubuntu bionic-updates main restricted universe multiverse
deb http://security.ubuntu.com/ubuntu bionic-security main restricted universe multiverse
```

the kernel is

```
Linux m1 5.4.48-06434-gd868196d13af #1 SMP PREEMPT Wed Jul 29 00:32:34 PDT 2020 x86_64 x86_64 x86_64 GNU/Linux
```

So it looks as if everything should run just fine - I guess something is wrong with the particular box, sorry.



---

archive/issue_comments_411102.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-09-30T12:35:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411102",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_411103.json:
```json
{
    "body": "Replying to [comment:63 dimpase]:\n\n> So it looks as if everything should run just fine - I guess something is wrong with the particular box, sorry. \n\nDima, one thing common to my platforms is, that I have `gap3` installed (from https://webusers.imj-prg.fr/~jean.michel/gap3/ according to the advices given in `src/sage/interfaces/gap3.py`, and I'm using it inside Sage). Did you test with `gap3`, as well?\n\nBTW: removing gap 4.8.8 did not help!",
    "created_at": "2020-10-01T08:02:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411103",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:63 dimpase]:

> So it looks as if everything should run just fine - I guess something is wrong with the particular box, sorry. 

Dima, one thing common to my platforms is, that I have `gap3` installed (from https://webusers.imj-prg.fr/~jean.michel/gap3/ according to the advices given in `src/sage/interfaces/gap3.py`, and I'm using it inside Sage). Did you test with `gap3`, as well?

BTW: removing gap 4.8.8 did not help!



---

archive/issue_comments_411104.json:
```json
{
    "body": "Replying to [comment:66 soehms]:\n> Replying to [comment:63 dimpase]:\n> \n> > So it looks as if everything should run just fine - I guess something is wrong with the particular box, sorry. \n> \n> Dima, one thing common to my platforms is, that I have `gap3` installed (from https://webusers.imj-prg.fr/~jean.michel/gap3/ according to the advices given in `src/sage/interfaces/gap3.py`, and I'm using it inside Sage). Did you test with `gap3`, as well?\n\nI just tried installing gap3 experimental package and running tests, and nothing is broken for me (in Linux Mint container, too).\n\nI don't know the advantage of following the manual instructions in `src/sage/interfaces/gap3.py` instead -- are there any?\n\nPerhaps they should be marked as obsolete, or just removed. In any event, `WARNING` about broken `pexpect` there should go.\n\nNeedless to say, if you mangle your Sage installation manually in some way, then all the bets are off, we can't say that Sage has a bug then. :-)",
    "created_at": "2020-10-01T09:05:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411104",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:66 soehms]:
> Replying to [comment:63 dimpase]:
> 
> > So it looks as if everything should run just fine - I guess something is wrong with the particular box, sorry. 
> 
> Dima, one thing common to my platforms is, that I have `gap3` installed (from https://webusers.imj-prg.fr/~jean.michel/gap3/ according to the advices given in `src/sage/interfaces/gap3.py`, and I'm using it inside Sage). Did you test with `gap3`, as well?

I just tried installing gap3 experimental package and running tests, and nothing is broken for me (in Linux Mint container, too).

I don't know the advantage of following the manual instructions in `src/sage/interfaces/gap3.py` instead -- are there any?

Perhaps they should be marked as obsolete, or just removed. In any event, `WARNING` about broken `pexpect` there should go.

Needless to say, if you mangle your Sage installation manually in some way, then all the bets are off, we can't say that Sage has a bug then. :-)



---

archive/issue_comments_411105.json:
```json
{
    "body": "for the latter, see #30686.",
    "created_at": "2020-10-01T09:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411105",
    "user": "https://github.com/dimpase"
}
```

for the latter, see #30686.



---

archive/issue_comments_411106.json:
```json
{
    "body": "Replying to [comment:67 dimpase]:\n> Replying to [comment:66 soehms]:\n> ...\n>\n> I just tried installing gap3 experimental package and running tests, and nothing is broken for me (in Linux Mint container, too).\nThanks for your help! In the meantime I realized that gap3 isn't the reason for my desaster, either (since against my expectation it was not present on the WSL).\n\n> I don't know the advantage of following the manual instructions in `src/sage/interfaces/gap3.py` instead -- are there any?\n\nI don't know. I did that years ago when I was new to Sage, and probably didn't know it better.\n\n> Perhaps they should be marked as obsolete, or just removed. In any event, `WARNING` about broken `pexpect` there should go.\n>\n> Needless to say, if you mangle your Sage installation manually in some way, then all the bets are off, we can't say that Sage has a bug then. :-)\n\nI agree! But that was not my point. I have to fix my facilities until this ticket is released (or completely switch to working in docker containers).",
    "created_at": "2020-10-01T16:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411106",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:67 dimpase]:
> Replying to [comment:66 soehms]:
> ...
>
> I just tried installing gap3 experimental package and running tests, and nothing is broken for me (in Linux Mint container, too).
Thanks for your help! In the meantime I realized that gap3 isn't the reason for my desaster, either (since against my expectation it was not present on the WSL).

> I don't know the advantage of following the manual instructions in `src/sage/interfaces/gap3.py` instead -- are there any?

I don't know. I did that years ago when I was new to Sage, and probably didn't know it better.

> Perhaps they should be marked as obsolete, or just removed. In any event, `WARNING` about broken `pexpect` there should go.
>
> Needless to say, if you mangle your Sage installation manually in some way, then all the bets are off, we can't say that Sage has a bug then. :-)

I agree! But that was not my point. I have to fix my facilities until this ticket is released (or completely switch to working in docker containers).



---

archive/issue_comments_411107.json:
```json
{
    "body": "Replying to [comment:69 soehms]:\n\ndo you have a particular \"interesting\" hardware for WSL and Mint  - is it the same box? Unusual toolchain?\n\nCould you maybe spin a WSL somewhere else and try to reproduce?\n\n> I agree! But that was not my point. I have to fix my facilities until this ticket is released (or completely switch to working in docker containers).\n> \nany test errors in `src/sage/libs/gap/` ? in `src/sage/groups/matrix_gps/` ?\nOr is your problem specifically related to free groups and finitely presented groups?",
    "created_at": "2020-10-02T11:00:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411107",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:69 soehms]:

do you have a particular "interesting" hardware for WSL and Mint  - is it the same box? Unusual toolchain?

Could you maybe spin a WSL somewhere else and try to reproduce?

> I agree! But that was not my point. I have to fix my facilities until this ticket is released (or completely switch to working in docker containers).
> 
any test errors in `src/sage/libs/gap/` ? in `src/sage/groups/matrix_gps/` ?
Or is your problem specifically related to free groups and finitely presented groups?



---

archive/issue_comments_411108.json:
```json
{
    "body": "Replying to [comment:70 dimpase]:\n> Replying to [comment:69 soehms]:\n> \n\nThanks again for your hints!\n\n> do you have a particular \"interesting\" hardware for WSL and Mint - is it the same box? Unusual toolchain?\n\nThe three cases above where all Lenovo ThinkPads (L560 WSL, X240 LinuxMint 19.1, L520 LinuxMint 18, all running on Intel i5). In addition I have now a fourth test case: SonyVaio (on Intel i5, as well, and LinuxMint 17.3).\n\nOn the X240 I created a Docker image for the ticket using the `$SAGE_ROOT/docker/Dockerfile`. The bug does not show in the corresponding container. So, I think the issue has nothing to do with the hardware.\n\n\n> Could you maybe spin a WSL somewhere else and try to reproduce?\n\nI will check that out.\n\n> any test errors in src/sage/libs/gap/ ? in src/sage/groups/matrix_gps/ ? Or is your problem specifically related to free groups and finitely presented groups?\n\nYes:\n\n\n```\nFile \"src/sage/libs/gap/element.pyx\", line 1335, in sage.libs.gap.element.GapElement.sage\nFile \"src/sage/libs/gap/element.pyx\", line 1336, in sage.libs.gap.element.GapElement.sage\nFile \"src/sage/libs/gap/element.pyx\", line 1338, in sage.libs.gap.element.GapElement.sage\nFile \"src/sage/libs/gap/element.pyx\", line 1347, in sage.libs.gap.element.GapElement.sage\nFile \"src/sage/libs/gap/element.pyx\", line 1348, in sage.libs.gap.element.GapElement.sage\nFile \"src/sage/libs/gap/element.pyx\", line 1350, in sage.libs.gap.element.GapElement.sage\nFile \"src/sage/libs/gap/libgap.pyx\", line 351, in sage.libs.gap.libgap.Gap._construct_matrix\n\nsage -t --warn-long 46.3 --random-seed=0 src/sage/libs/gap/element.pyx  # 6 doctests failed\nsage -t --warn-long 46.3 --random-seed=0 src/sage/libs/gap/libgap.pyx  # 1 doctest failed\n```\n\n\nUnder `src/sage/groups` there are in sum 1182 failing doctests, 78 of them under `sage.groups.matrix_gps`. Free groups and finitely presented groups are just the top scores. Probably they all have the same origin.",
    "created_at": "2020-10-02T22:16:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411108",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:70 dimpase]:
> Replying to [comment:69 soehms]:
> 

Thanks again for your hints!

> do you have a particular "interesting" hardware for WSL and Mint - is it the same box? Unusual toolchain?

The three cases above where all Lenovo ThinkPads (L560 WSL, X240 LinuxMint 19.1, L520 LinuxMint 18, all running on Intel i5). In addition I have now a fourth test case: SonyVaio (on Intel i5, as well, and LinuxMint 17.3).

On the X240 I created a Docker image for the ticket using the `$SAGE_ROOT/docker/Dockerfile`. The bug does not show in the corresponding container. So, I think the issue has nothing to do with the hardware.


> Could you maybe spin a WSL somewhere else and try to reproduce?

I will check that out.

> any test errors in src/sage/libs/gap/ ? in src/sage/groups/matrix_gps/ ? Or is your problem specifically related to free groups and finitely presented groups?

Yes:


```
File "src/sage/libs/gap/element.pyx", line 1335, in sage.libs.gap.element.GapElement.sage
File "src/sage/libs/gap/element.pyx", line 1336, in sage.libs.gap.element.GapElement.sage
File "src/sage/libs/gap/element.pyx", line 1338, in sage.libs.gap.element.GapElement.sage
File "src/sage/libs/gap/element.pyx", line 1347, in sage.libs.gap.element.GapElement.sage
File "src/sage/libs/gap/element.pyx", line 1348, in sage.libs.gap.element.GapElement.sage
File "src/sage/libs/gap/element.pyx", line 1350, in sage.libs.gap.element.GapElement.sage
File "src/sage/libs/gap/libgap.pyx", line 351, in sage.libs.gap.libgap.Gap._construct_matrix

sage -t --warn-long 46.3 --random-seed=0 src/sage/libs/gap/element.pyx  # 6 doctests failed
sage -t --warn-long 46.3 --random-seed=0 src/sage/libs/gap/libgap.pyx  # 1 doctest failed
```


Under `src/sage/groups` there are in sum 1182 failing doctests, 78 of them under `sage.groups.matrix_gps`. Free groups and finitely presented groups are just the top scores. Probably they all have the same origin.



---

archive/issue_comments_411109.json:
```json
{
    "body": "By the way, do you by any chances have any stray/old patches in `build/pkgs/gap/patches` or in `build/pkgs/gap_packages/patches` ?\n\nCertainly, errors in `src/sage/libs/gap/element.pyx` and `src/sage/libs/gap/libgap.pyx` are the root of the problem, and should be relatively easy to debug, as it's more or less direct interaction with libgap, and well-localised - everything has to do with dealing with a GAP variable `x`.\n\nSo what happens if you run the stuff around line 1335 from `libs/gap/element.pyx`?\n\n```\nsage: x = libgap.Integers.Indeterminate(\"x\")\nsage: x\nsage: x+1\nsage: x^2\nsage: p = x^2 - 2*x + 3\n```\n",
    "created_at": "2020-10-02T23:12:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411109",
    "user": "https://github.com/dimpase"
}
```

By the way, do you by any chances have any stray/old patches in `build/pkgs/gap/patches` or in `build/pkgs/gap_packages/patches` ?

Certainly, errors in `src/sage/libs/gap/element.pyx` and `src/sage/libs/gap/libgap.pyx` are the root of the problem, and should be relatively easy to debug, as it's more or less direct interaction with libgap, and well-localised - everything has to do with dealing with a GAP variable `x`.

So what happens if you run the stuff around line 1335 from `libs/gap/element.pyx`?

```
sage: x = libgap.Integers.Indeterminate("x")
sage: x
sage: x+1
sage: x^2
sage: p = x^2 - 2*x + 3
```




---

archive/issue_comments_411110.json:
```json
{
    "body": "Still hangs the buildbot\n\n```\n[dochtml] [algebras ] building [inventory]: targets for 95 source files that are out of date\n[dochtml] [algebras ] updating environment: [new config] 95 added, 0 changed, 0 removed\n[dochtml] [algebras ] The inventory files are in local/share/doc/sage/inventory/en/reference/algebras.\n[dochtml] Build finished. The built documents can be found in /var/lib/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/algebras\n[dochtml] [tensor_fr] building [inventory]: targets for 19 source files that are out of date\n[dochtml] [tensor_fr] updating environment: [new config] 19 added, 0 changed, 0 removed\n[dochtml] [tensor_fr] The inventory files are in local/share/doc/sage/inventory/en/reference/tensor_free_modules.\n[dochtml] Build finished. The built documents can be found in /var/lib/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/tensor_free_modules\n[dochtml] Warning: Missing title for sage.combinat.posets.mobile\n[dochtml] [combinat ] building [inventory]: targets for 379 source files that are out of date\n[dochtml] [combinat ] updating environment: [new config] 379 added, 0 changed, 0 removed\ncommand timed out: 1200 seconds without output running ['make', 'doc-html-mathjax'], attempting to kill\nprocess killed by signal 9\nprogram finished with exit code -1\nelapsedTime=1394.804628\n```\n",
    "created_at": "2020-10-04T22:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411110",
    "user": "https://github.com/vbraun"
}
```

Still hangs the buildbot

```
[dochtml] [algebras ] building [inventory]: targets for 95 source files that are out of date
[dochtml] [algebras ] updating environment: [new config] 95 added, 0 changed, 0 removed
[dochtml] [algebras ] The inventory files are in local/share/doc/sage/inventory/en/reference/algebras.
[dochtml] Build finished. The built documents can be found in /var/lib/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/algebras
[dochtml] [tensor_fr] building [inventory]: targets for 19 source files that are out of date
[dochtml] [tensor_fr] updating environment: [new config] 19 added, 0 changed, 0 removed
[dochtml] [tensor_fr] The inventory files are in local/share/doc/sage/inventory/en/reference/tensor_free_modules.
[dochtml] Build finished. The built documents can be found in /var/lib/buildbot/slave/sage_git/build/local/share/doc/sage/inventory/en/reference/tensor_free_modules
[dochtml] Warning: Missing title for sage.combinat.posets.mobile
[dochtml] [combinat ] building [inventory]: targets for 379 source files that are out of date
[dochtml] [combinat ] updating environment: [new config] 379 added, 0 changed, 0 removed
command timed out: 1200 seconds without output running ['make', 'doc-html-mathjax'], attempting to kill
process killed by signal 9
program finished with exit code -1
elapsedTime=1394.804628
```




---

archive/issue_comments_411111.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2020-10-04T22:26:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411111",
    "user": "https://github.com/vbraun"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_411112.json:
```json
{
    "body": "How about backporting the patch added for Xcode 12 and leaving the gap upgrade to the 9.3 series.",
    "created_at": "2020-10-04T22:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411112",
    "user": "https://github.com/mkoeppe"
}
```

How about backporting the patch added for Xcode 12 and leaving the gap upgrade to the 9.3 series.



---

archive/issue_comments_411113.json:
```json
{
    "body": "Created #30720 for this",
    "created_at": "2020-10-04T22:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411113",
    "user": "https://github.com/mkoeppe"
}
```

Created #30720 for this



---

archive/issue_comments_411114.json:
```json
{
    "body": "Replying to [comment:72 dimpase]:\n> By the way, do you by any chances have any stray/old patches in `build/pkgs/gap/patches` or in `build/pkgs/gap_packages/patches` ?\n> \nNo!\n\n> Certainly, errors in `src/sage/libs/gap/element.pyx` and `src/sage/libs/gap/libgap.pyx` are the root of the problem, and should be relatively easy to debug, as it's more or less direct interaction with libgap, and well-localised - everything has to do with dealing with a GAP variable `x`.\n> \n> So what happens if you run the stuff around line 1335 from `libs/gap/element.pyx`?\n> {{{\n> sage: x = libgap.Integers.Indeterminate(\"x\")\n> sage: x\n> sage: x+1\n> sage: x^2\n> sage: p = x^2 - 2*x + 3\n> }}}\n> \n\nThe crash already occured at the addition `x+1`, more precisely in `local/lib/python3.8/site-packages/cysignals/macros.h`. It jumped to line 134 even though `cysigs.sig_on_count` was zero.\n\n\n```\n(gdb) n\n__pyx_f_4sage_4libs_3gap_7element_10GapElement__add_ (__pyx_v_self=0x7f5e227f1840, __pyx_v_right=0x7f5e2281eb00, __pyx_skip_dispatch=<optimized out>)\n    at build/cythonized/sage/libs/gap/element.c:10206\n10206       __pyx_t_5 = sig_on(); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(0, 1007, __pyx_L4_error)\n(gdb) s\n_sig_on_prejmp (message=0x0, file=0x7f5e31f0c728 \"build/cythonized/sage/libs/gap/element.c\", line=10206)\n    at /home/sebastian/develop/sage/local/lib/python3.8/site-packages/cysignals/macros.h:117\n117         cysigs.s = message;\n(gdb) s\n132         if (cysigs.sig_on_count > 0)\n(gdb) p cysigs.sig_on_count\n$2 = 0\n(gdb) l\n127             fprintf(stderr, \"\\n*** ERROR *** sig_on() with sig_on_count = %i, block_sigint = %i\\n\",\n128                     (int)cysigs.sig_on_count, (int)cysigs.block_sigint);\n129             print_backtrace();\n130         }\n131     #endif\n132         if (cysigs.sig_on_count > 0)\n133         {\n134             cysigs.sig_on_count++;\n135             return 1;\n136         }\n(gdb) s\n134             cysigs.sig_on_count++;\n(gdb) p cysigs.sig_on_count\n$3 = 0\n```\n\n\nTherefore, I ran\n\n\n```\nsage -f cysignals\nmake build\n```\n\n\nand that **solved the problem**!\n\nBut, why did I have to do that even in the case where I build fro scratch? Anyway, thanks a lot for your patience!",
    "created_at": "2020-10-05T09:00:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411114",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:72 dimpase]:
> By the way, do you by any chances have any stray/old patches in `build/pkgs/gap/patches` or in `build/pkgs/gap_packages/patches` ?
> 
No!

> Certainly, errors in `src/sage/libs/gap/element.pyx` and `src/sage/libs/gap/libgap.pyx` are the root of the problem, and should be relatively easy to debug, as it's more or less direct interaction with libgap, and well-localised - everything has to do with dealing with a GAP variable `x`.
> 
> So what happens if you run the stuff around line 1335 from `libs/gap/element.pyx`?
> {{{
> sage: x = libgap.Integers.Indeterminate("x")
> sage: x
> sage: x+1
> sage: x^2
> sage: p = x^2 - 2*x + 3
> }}}
> 

The crash already occured at the addition `x+1`, more precisely in `local/lib/python3.8/site-packages/cysignals/macros.h`. It jumped to line 134 even though `cysigs.sig_on_count` was zero.


```
(gdb) n
__pyx_f_4sage_4libs_3gap_7element_10GapElement__add_ (__pyx_v_self=0x7f5e227f1840, __pyx_v_right=0x7f5e2281eb00, __pyx_skip_dispatch=<optimized out>)
    at build/cythonized/sage/libs/gap/element.c:10206
10206       __pyx_t_5 = sig_on(); if (unlikely(__pyx_t_5 == ((int)0))) __PYX_ERR(0, 1007, __pyx_L4_error)
(gdb) s
_sig_on_prejmp (message=0x0, file=0x7f5e31f0c728 "build/cythonized/sage/libs/gap/element.c", line=10206)
    at /home/sebastian/develop/sage/local/lib/python3.8/site-packages/cysignals/macros.h:117
117         cysigs.s = message;
(gdb) s
132         if (cysigs.sig_on_count > 0)
(gdb) p cysigs.sig_on_count
$2 = 0
(gdb) l
127             fprintf(stderr, "\n*** ERROR *** sig_on() with sig_on_count = %i, block_sigint = %i\n",
128                     (int)cysigs.sig_on_count, (int)cysigs.block_sigint);
129             print_backtrace();
130         }
131     #endif
132         if (cysigs.sig_on_count > 0)
133         {
134             cysigs.sig_on_count++;
135             return 1;
136         }
(gdb) s
134             cysigs.sig_on_count++;
(gdb) p cysigs.sig_on_count
$3 = 0
```


Therefore, I ran


```
sage -f cysignals
make build
```


and that **solved the problem**!

But, why did I have to do that even in the case where I build fro scratch? Anyway, thanks a lot for your patience!



---

archive/issue_comments_411115.json:
```json
{
    "body": "Replying to [comment:76 soehms]:\n[...]\n> Therefore, I ran\n> \n> {{{\n> sage -f cysignals\n> make build\n> }}}\n> \n> and that **solved the problem**!\n\nGreat! \n\n> But, why did I have to do that even in the case where I build fro scratch? Anyway, thanks a lot for your patience! \nCould be #30687 (with the original suject: \"local/**lib**/python3*\" must be removed)  - unless\nyou did run `make distclean` which removes `local/` completely anyway...",
    "created_at": "2020-10-05T11:29:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411115",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:76 soehms]:
[...]
> Therefore, I ran
> 
> {{{
> sage -f cysignals
> make build
> }}}
> 
> and that **solved the problem**!

Great! 

> But, why did I have to do that even in the case where I build fro scratch? Anyway, thanks a lot for your patience! 
Could be #30687 (with the original suject: "local/**lib**/python3*" must be removed)  - unless
you did run `make distclean` which removes `local/` completely anyway...



---

archive/issue_comments_411116.json:
```json
{
    "body": "Replying to [comment:73 vbraun]:\n> Still hangs the buildbot\n\nSomeone has to debug this somehow, I have no clue what's going on there. Could you do another `strace -ff ...` as in comment:29 ?",
    "created_at": "2020-10-05T11:33:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411116",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:73 vbraun]:
> Still hangs the buildbot

Someone has to debug this somehow, I have no clue what's going on there. Could you do another `strace -ff ...` as in comment:29 ?



---

archive/issue_comments_411117.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:",
    "created_at": "2020-10-05T19:02:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411117",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:



---

archive/issue_comments_411118.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-10-05T19:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411118",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_411119.json:
```json
{
    "body": "rebased over #30720",
    "created_at": "2020-10-05T19:03:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411119",
    "user": "https://github.com/dimpase"
}
```

rebased over #30720



---

archive/issue_comments_411120.json:
```json
{
    "body": "The patches for `gap_packages` don't work:\n\n```\nApplying patches from ../patches...\nApplying ../patches/cohomolo-gcc10.patch\ncan't find file to patch at input line 5\nPerhaps you used the wrong -p or --strip option?\nThe text leading up to this was:\n--------------------------\n--------------------------\nFile to patch: \nSkip this patch? [y] \nSkipping patch.\n4 out of 4 hunks ignored\ncan't find file to patch at input line 54\nPerhaps you used the wrong -p or --strip option?\nThe text leading up to this was:\n--------------------------\n--------------------------\nFile to patch: \nSkip this patch? [y] \nSkipping patch.\n4 out of 4 hunks ignored\ncan't find file to patch at input line 98\nPerhaps you used the wrong -p or --strip option?\nThe text leading up to this was:\n--------------------------\n--------------------------\nFile to patch: \nSkip this patch? [y] \nSkipping patch.\n4 out of 4 hunks ignored\ncan't find file to patch at input line 135\nPerhaps you used the wrong -p or --strip option?\nThe text leading up to this was:\n--------------------------\n--------------------------\nFile to patch: \nSkip this patch? [y] \nSkipping patch.\n2 out of 2 hunks ignored\nError applying '../patches/cohomolo-gcc10.patch'\n************************************************************************\nError applying patches\n************************************************************************\n```\n",
    "created_at": "2020-10-05T22:20:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411120",
    "user": "https://github.com/jhpalmieri"
}
```

The patches for `gap_packages` don't work:

```
Applying patches from ../patches...
Applying ../patches/cohomolo-gcc10.patch
can't find file to patch at input line 5
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
--------------------------
File to patch: 
Skip this patch? [y] 
Skipping patch.
4 out of 4 hunks ignored
can't find file to patch at input line 54
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
--------------------------
File to patch: 
Skip this patch? [y] 
Skipping patch.
4 out of 4 hunks ignored
can't find file to patch at input line 98
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
--------------------------
File to patch: 
Skip this patch? [y] 
Skipping patch.
4 out of 4 hunks ignored
can't find file to patch at input line 135
Perhaps you used the wrong -p or --strip option?
The text leading up to this was:
--------------------------
--------------------------
File to patch: 
Skip this patch? [y] 
Skipping patch.
2 out of 2 hunks ignored
Error applying '../patches/cohomolo-gcc10.patch'
************************************************************************
Error applying patches
************************************************************************
```




---

archive/issue_comments_411121.json:
```json
{
    "body": "I see: the versions are wrong. Here's a fix.",
    "created_at": "2020-10-05T22:24:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411121",
    "user": "https://github.com/jhpalmieri"
}
```

I see: the versions are wrong. Here's a fix.



---

archive/issue_comments_411122.json:
```json
{
    "body": "This (including `libsemigroups` and `gap_packages`) builds for me on OS X with Xcode 12.\n----\nNew commits:",
    "created_at": "2020-10-05T22:27:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411122",
    "user": "https://github.com/jhpalmieri"
}
```

This (including `libsemigroups` and `gap_packages`) builds for me on OS X with Xcode 12.
----
New commits:



---

archive/issue_comments_411123.json:
```json
{
    "body": "Building the documentation, I see\n\n```\nError, reached the pre-set memory limit\n(change it with the -o command line option)\n```\n\nI don't remember ever seeing this before. (The documentation build continues, but the error message was strange.)",
    "created_at": "2020-10-05T22:36:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411123",
    "user": "https://github.com/jhpalmieri"
}
```

Building the documentation, I see

```
Error, reached the pre-set memory limit
(change it with the -o command line option)
```

I don't remember ever seeing this before. (The documentation build continues, but the error message was strange.)



---

archive/issue_comments_411124.json:
```json
{
    "body": "Then patching the failing packages in #30729 using the diff to GAP 4.11 would be a way forward",
    "created_at": "2020-10-05T22:38:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411124",
    "user": "https://github.com/mkoeppe"
}
```

Then patching the failing packages in #30729 using the diff to GAP 4.11 would be a way forward



---

archive/issue_comments_411125.json:
```json
{
    "body": "Doctests pass for me (with `libsemigroups` and `gap_packages` installed).",
    "created_at": "2020-10-05T23:22:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411125",
    "user": "https://github.com/jhpalmieri"
}
```

Doctests pass for me (with `libsemigroups` and `gap_packages` installed).



---

archive/issue_comments_411126.json:
```json
{
    "body": "Replying to [comment:87 mkoeppe]:\n> Then patching the failing packages in #30729 using the diff to GAP 4.11 would be a way forward\n\nOr just merge this ticket instead.",
    "created_at": "2020-10-05T23:23:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411126",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:87 mkoeppe]:
> Then patching the failing packages in #30729 using the diff to GAP 4.11 would be a way forward

Or just merge this ticket instead.



---

archive/issue_comments_411127.json:
```json
{
    "body": "There are unresolved problems with this upgrade",
    "created_at": "2020-10-05T23:28:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411127",
    "user": "https://github.com/mkoeppe"
}
```

There are unresolved problems with this upgrade



---

archive/issue_comments_411128.json:
```json
{
    "body": "Replying to [comment:85 jhpalmieri]:\n> This (including `libsemigroups` and `gap_packages`) builds for me on OS X with Xcode 12.\n\nthanks for fixing this. \nWhat XCode 12 are you on? 12.0? 12.2?",
    "created_at": "2020-10-06T08:25:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411128",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:85 jhpalmieri]:
> This (including `libsemigroups` and `gap_packages`) builds for me on OS X with Xcode 12.

thanks for fixing this. 
What XCode 12 are you on? 12.0? 12.2?



---

archive/issue_comments_411129.json:
```json
{
    "body": "Replying to [comment:90 mkoeppe]:\n> There are unresolved problems with this upgrade\n\nand a problem I cannot debug, as it's essentially a privately run network of buildbots which (in part?) seem to hang on our damn docbuild :-(",
    "created_at": "2020-10-06T08:27:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411129",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:90 mkoeppe]:
> There are unresolved problems with this upgrade

and a problem I cannot debug, as it's essentially a privately run network of buildbots which (in part?) seem to hang on our damn docbuild :-(



---

archive/issue_comments_411130.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2020-10-06T17:53:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411130",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_411131.json:
```json
{
    "body": "It does not seem realistic to get this ticket done for 9.2. So let's do #30729",
    "created_at": "2020-10-06T17:53:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411131",
    "user": "https://github.com/mkoeppe"
}
```

It does not seem realistic to get this ticket done for 9.2. So let's do #30729



---

archive/issue_comments_411132.json:
```json
{
    "body": "Replying to [comment:91 dimpase]:\n> Replying to [comment:85 jhpalmieri]:\n> > This (including `libsemigroups` and `gap_packages`) builds for me on OS X with Xcode 12.\n> \n> thanks for fixing this. \n> What XCode 12 are you on? 12.0? 12.2?\n\n12.0.1",
    "created_at": "2020-10-06T18:31:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411132",
    "user": "https://github.com/jhpalmieri"
}
```

Replying to [comment:91 dimpase]:
> Replying to [comment:85 jhpalmieri]:
> > This (including `libsemigroups` and `gap_packages`) builds for me on OS X with Xcode 12.
> 
> thanks for fixing this. 
> What XCode 12 are you on? 12.0? 12.2?

12.0.1



---

archive/issue_comments_411133.json:
```json
{
    "body": "Replying to [comment:77 dimpase]:\n> Replying to [comment:76 soehms]:\n> [...]\n> > Therefore, I ran\n> > \n> > {{{\n> > sage -f cysignals\n> > make build\n> > }}}\n> > \n> > and that **solved the problem**!\n> \n> Great! \n> \n> > But, why did I have to do that even in the case where I build fro scratch? Anyway, thanks a lot for your patience! \n> Could be #30687 (with the original suject: \"local/**lib**/python3*\" must be removed)  - unless\n> you did run `make distclean` which removes `local/` completely anyway...\n> \n> \n\nIt must be an independent problem. As it appears now on all of my systems (by whatever reason) I have to rebuild `cysignals` whenever I switch back and forth between gap 4.10 and 4.11. This is regardless of whether I merged #30687 in or not.",
    "created_at": "2020-10-11T17:09:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411133",
    "user": "https://github.com/soehms"
}
```

Replying to [comment:77 dimpase]:
> Replying to [comment:76 soehms]:
> [...]
> > Therefore, I ran
> > 
> > {{{
> > sage -f cysignals
> > make build
> > }}}
> > 
> > and that **solved the problem**!
> 
> Great! 
> 
> > But, why did I have to do that even in the case where I build fro scratch? Anyway, thanks a lot for your patience! 
> Could be #30687 (with the original suject: "local/**lib**/python3*" must be removed)  - unless
> you did run `make distclean` which removes `local/` completely anyway...
> 
> 

It must be an independent problem. As it appears now on all of my systems (by whatever reason) I have to rebuild `cysignals` whenever I switch back and forth between gap 4.10 and 4.11. This is regardless of whether I merged #30687 in or not.



---

archive/issue_comments_411134.json:
```json
{
    "body": "perhaps buildbot hanging is a multithreading issue - libgap in not multithreaded, calling it from several threads is asking for trouble: https://github.com/gap-system/gap/issues/2893#issuecomment-707700408",
    "created_at": "2020-10-13T14:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411134",
    "user": "https://github.com/dimpase"
}
```

perhaps buildbot hanging is a multithreading issue - libgap in not multithreaded, calling it from several threads is asking for trouble: https://github.com/gap-system/gap/issues/2893#issuecomment-707700408



---

archive/issue_comments_411135.json:
```json
{
    "body": "we should move PackageManager GAP package from gap_packages to gap - it is small and useful.",
    "created_at": "2020-10-16T13:11:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411135",
    "user": "https://github.com/dimpase"
}
```

we should move PackageManager GAP package from gap_packages to gap - it is small and useful.



---

archive/issue_comments_411136.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2020-11-10T17:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411136",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_411137.json:
```json
{
    "body": "The ball here is in Volker's court. I have no idea why his buildbots hang.",
    "created_at": "2020-11-10T17:55:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411137",
    "user": "https://github.com/dimpase"
}
```

The ball here is in Volker's court. I have no idea why his buildbots hang.



---

archive/issue_comments_411138.json:
```json
{
    "body": "Replying to [comment:98 dimpase]:\n> we should move PackageManager GAP package from gap_packages to gap - it is small and useful.\n\n+1 -- separate ticket or here?",
    "created_at": "2020-11-14T09:46:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411138",
    "user": "https://github.com/slel"
}
```

Replying to [comment:98 dimpase]:
> we should move PackageManager GAP package from gap_packages to gap - it is small and useful.

+1 -- separate ticket or here?



---

archive/issue_comments_411139.json:
```json
{
    "body": "Replying to [comment:101 slelievre]:\n> Replying to [comment:98 dimpase]:\n> > we should move PackageManager GAP package from gap_packages to gap - it is small and useful.\n> \n> +1 -- separate ticket or here?\nI'll do it here - it's still \"needs review\" after all.",
    "created_at": "2020-11-14T09:49:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411139",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:101 slelievre]:
> Replying to [comment:98 dimpase]:
> > we should move PackageManager GAP package from gap_packages to gap - it is small and useful.
> 
> +1 -- separate ticket or here?
I'll do it here - it's still "needs review" after all.



---

archive/issue_comments_411140.json:
```json
{
    "body": "rebased over the latest beta, moved PackageManager GAP package as discussed.",
    "created_at": "2020-11-14T09:59:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411140",
    "user": "https://github.com/dimpase"
}
```

rebased over the latest beta, moved PackageManager GAP package as discussed.



---

archive/issue_comments_411141.json:
```json
{
    "body": "I've used this ticket in #30371, and it runs well on the github action (https://github.com/tobiasdiez/sage/runs/1413136300?check_suite_focus=true). In particular, there was no \"hanging\" or multithreading problem.\n\nThe only gap related doc tests that fail are:\n\n```\n2020-11-17T17:27:35.4675866Z sage -t --random-seed=0 /__w/sage/sage/src/sage/interfaces/gap_workspace.py\n2020-11-17T17:27:35.4676910Z **********************************************************************\n2020-11-17T17:27:35.4677821Z File \"/__w/sage/sage/src/sage/interfaces/gap_workspace.py\", line 55, in sage.interfaces.gap_workspace.gap_workspace_file\n2020-11-17T17:27:35.4681873Z Failed example:\n2020-11-17T17:27:35.4683784Z     name1 = Popen([sys.executable, '-c', cmd], stdout=PIPE).communicate()[0]\n2020-11-17T17:27:35.4684739Z Expected nothing\n2020-11-17T17:27:35.4685235Z Got:\n2020-11-17T17:27:35.4686344Z     /__w/sage/sage/src/sage/calculus/functional.py:57: DeprecationWarning: invalid escape sequence \\d\n2020-11-17T17:27:35.4687468Z       \"\"\"\n2020-11-17T17:27:39.4060681Z **********************************************************************\n2020-11-17T17:27:39.4062343Z File \"/__w/sage/sage/src/sage/interfaces/gap_workspace.py\", line 56, in sage.interfaces.gap_workspace.gap_workspace_file\n2020-11-17T17:27:39.4063371Z Failed example:\n2020-11-17T17:27:39.4065030Z     name2 = Popen([sys.executable, '-c', cmd], stdout=PIPE).communicate()[0]\n2020-11-17T17:27:39.4065813Z Expected nothing\n2020-11-17T17:27:39.4066315Z Got:\n2020-11-17T17:27:39.4067147Z     /__w/sage/sage/src/sage/calculus/functional.py:57: DeprecationWarning: invalid escape sequence \\d\n2020-11-17T17:27:39.4067993Z       \"\"\"\n2020-11-17T17:27:39.4129689Z **********************************************************************\n```\n\nBut that could also very well be a result of the somewhat unusual setup of #30371.\nSo from my side this looks good.",
    "created_at": "2020-11-17T21:48:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411141",
    "user": "https://github.com/tobiasdiez"
}
```

I've used this ticket in #30371, and it runs well on the github action (https://github.com/tobiasdiez/sage/runs/1413136300?check_suite_focus=true). In particular, there was no "hanging" or multithreading problem.

The only gap related doc tests that fail are:

```
2020-11-17T17:27:35.4675866Z sage -t --random-seed=0 /__w/sage/sage/src/sage/interfaces/gap_workspace.py
2020-11-17T17:27:35.4676910Z **********************************************************************
2020-11-17T17:27:35.4677821Z File "/__w/sage/sage/src/sage/interfaces/gap_workspace.py", line 55, in sage.interfaces.gap_workspace.gap_workspace_file
2020-11-17T17:27:35.4681873Z Failed example:
2020-11-17T17:27:35.4683784Z     name1 = Popen([sys.executable, '-c', cmd], stdout=PIPE).communicate()[0]
2020-11-17T17:27:35.4684739Z Expected nothing
2020-11-17T17:27:35.4685235Z Got:
2020-11-17T17:27:35.4686344Z     /__w/sage/sage/src/sage/calculus/functional.py:57: DeprecationWarning: invalid escape sequence \d
2020-11-17T17:27:35.4687468Z       """
2020-11-17T17:27:39.4060681Z **********************************************************************
2020-11-17T17:27:39.4062343Z File "/__w/sage/sage/src/sage/interfaces/gap_workspace.py", line 56, in sage.interfaces.gap_workspace.gap_workspace_file
2020-11-17T17:27:39.4063371Z Failed example:
2020-11-17T17:27:39.4065030Z     name2 = Popen([sys.executable, '-c', cmd], stdout=PIPE).communicate()[0]
2020-11-17T17:27:39.4065813Z Expected nothing
2020-11-17T17:27:39.4066315Z Got:
2020-11-17T17:27:39.4067147Z     /__w/sage/sage/src/sage/calculus/functional.py:57: DeprecationWarning: invalid escape sequence \d
2020-11-17T17:27:39.4067993Z       """
2020-11-17T17:27:39.4129689Z **********************************************************************
```

But that could also very well be a result of the somewhat unusual setup of #30371.
So from my side this looks good.



---

archive/issue_comments_411142.json:
```json
{
    "body": "Replying to [comment:105 gh-tobiasdiez]:\n> I've used this ticket in #30371, and it runs well on the github action (https://github.com/tobiasdiez/sage/runs/1413136300?check_suite_focus=true). In particular, there was no \"hanging\" or multithreading problem.\n> \n> The only gap related doc tests that fail are:\nThanks.\nI can't reproduce these, they don't seem to originate from this ticket.",
    "created_at": "2020-11-18T14:13:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411142",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:105 gh-tobiasdiez]:
> I've used this ticket in #30371, and it runs well on the github action (https://github.com/tobiasdiez/sage/runs/1413136300?check_suite_focus=true). In particular, there was no "hanging" or multithreading problem.
> 
> The only gap related doc tests that fail are:
Thanks.
I can't reproduce these, they don't seem to originate from this ticket.



---

archive/issue_comments_411143.json:
```json
{
    "body": "New commits:",
    "created_at": "2020-12-08T23:46:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411143",
    "user": "https://github.com/mkoeppe"
}
```

New commits:



---

archive/issue_comments_411144.json:
```json
{
    "body": "Looks all fine on GH Actions. (comment:25 of course still applies)",
    "created_at": "2020-12-10T01:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411144",
    "user": "https://github.com/mkoeppe"
}
```

Looks all fine on GH Actions. (comment:25 of course still applies)



---

archive/issue_comments_411145.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-12-10T01:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411145",
    "user": "https://github.com/mkoeppe"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_411146.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-12-13T20:31:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/29077#issuecomment-411146",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_026877.json:
```json
{
    "actor": "@vbraun",
    "created_at": "2020-12-13T20:31:08Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/29077",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/29077#event-26877"
}
```
