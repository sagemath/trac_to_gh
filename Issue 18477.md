# Issue 18477: Dual bases for finite fields

Issue created by migration from Trac.

Original creator: tgagne

Original creation time: 2015-06-16 17:18:45

CC:  rbeezer malb simonking defeo

Keywords: dual basis, finite field

The dual basis `d` of a basis `e` of the finite field `GF(p)^n` has the property that the field trace of the product of an element of `e` with an element of `d` equals the Kronecker delta function. Every linear function over `GF(p)^n` can be realized as a polynomial over `GF(p^n)`; the dual basis is critical to the determination of this polynomial.
The algorithm for dual basis calculation comes from pages 110-111 of McEliece's "Finite Fields for Computer Scientists and Engineers" and is calculated with a single matrix inversion over `GF(p)`. 


---

Comment by tgagne created at 2015-06-16 17:28:55

Changing status from new to needs_review.


---

Comment by tgagne created at 2015-06-16 17:28:55

New commits:


---

Comment by vdelecroix created at 2015-08-10 09:14:44

Hello,

The code and the documentation are very clean! That is a pleasure to read. Here are some comments.

1. Could you move the content of the `OUTPUT` block (i.e. the definition of duality) just after the one-line description. The `OUTPUT` section is not mandatory. And in your case what is the output is quite clear from the description.

2. You can replace `if check == True` by `if check`.

3. Be careful that there are a lot of trailing whitespaces (ie a space just before the end of a line). Please get rid of them. In most editors, they can be deleted (or highlighted) automatically.

4. You can do the following

```
entries = []
for i in range(self.degree()):
    row = []
    for j in range(self.degree()):
        row.append((basis[i] * basis[j]).trace())
    entries.append(row)
```

  in one Python instruction

```
entries = [[(basis[i] * basis[j]).trace() for j in range(self.degree()] \
            for i in range(self.degree())]
```

  or even better, you can initialize your matrix with

```
    m = matrix(base_ring, dimension, lambda i,j: (basis[i]*basis[j]).trace())
```


Vincent


---

Comment by vdelecroix created at 2015-08-10 09:14:44

Changing status from needs_review to needs_work.


---

Comment by git created at 2015-08-11 19:29:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tgagne created at 2015-08-11 19:34:55

Thanks for the helpful comments Vincent!
I've made the changes you suggested, as well as compacted the for loop which calculated the dual basis into a simpler list comprehension.

Thomas


---

Comment by vdelecroix created at 2015-08-11 19:52:57

Hello,

For next time: the first line of your message commit should be shorter. Like

```
review 1: better documentation + code simplification

bla bla long explanations bla bla
```

One reasone is because of the option `--oneline` in git

```
$ git log --oneline -5
d3738ed merge u/tgagne/dual_basis_finite_field in Sage-6.9.beta1
522766c Moved the OUTPUT section's content to below the one-line description, removed some trailing whitespace, and compacted several for loops into simpler list comprehensions.
83bef8d Updated Sage version to 6.9.beta1
d585e9c Trac #18993: sage-list-packages should ignore files in build/pkgs/
4e1711e Trac #18991: Remove useful doctest
```

where you can notice that your line is toooooooooooooooo long.


---

Comment by vdelecroix created at 2015-08-11 20:11:37

Sorry to be annoying with english details:
- in the description you can not start with `In particular`. The sentence is not a particular case of what was before. Simply start with `If `\{e_0, e_1, ..., e_{n-1}\}` is ...`. You can also say that it is the dual basis over `GF(p)` with respect to the bilinear form `Tr`.
- replace `is another basis` with `is the other basis`. The dual basis is unique right?

Beyond that everything looks good to me.

Vincent


---

Comment by git created at 2015-08-12 02:00:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tgagne created at 2015-08-12 02:08:53

Thanks so much for this help, Vincent!

I've made those minor changes you suggested.
Also, thanks for bringing my attention to the length of the commit message's first line. I wasn't previously aware of the issue, but I'll be sure to keep it in mind!

Thomas


---

Comment by vdelecroix created at 2015-08-12 11:47:07

All right. This is good to go. I set to positive review and your changes should be included in the next release of Sage.


---

Comment by vdelecroix created at 2015-08-12 11:47:07

Changing status from needs_work to positive_review.


---

Comment by tgagne created at 2015-08-13 06:01:51

Glad to hear it!
Thanks again for all your help with reviewing and improving my work, Vincent. I really appreciate it!

Thomas


---

Comment by vbraun created at 2015-08-13 18:35:15

Resolution: fixed


---

Comment by jpflori created at 2015-08-14 06:32:33

I'm cc'ing Luca here as he might be interested.
