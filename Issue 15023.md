# Issue 15023: Integer division of rationals

archive/issues_015023.json:
```json
{
    "body": "CC:  was tmonteil zimmerma\n\nAs reported there [1]\n\n\n```\nsage: x = 1/2 \nsage: x \n1/2 \nsage: x//2 \n1/4\n```\n \n\nThough I have no idea how this kind of things is to be fixed `^^;`\n\nNathann\n\n[1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion\n\nIssue created by migration from https://trac.sagemath.org/ticket/15260\n\n",
    "created_at": "2013-10-07T11:59:20Z",
    "labels": [
        "numerical",
        "major",
        "bug"
    ],
    "title": "Integer division of rationals",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/15023",
    "user": "ncohen"
}
```
CC:  was tmonteil zimmerma

As reported there [1]


```
sage: x = 1/2 
sage: x 
1/2 
sage: x//2 
1/4
```
 

Though I have no idea how this kind of things is to be fixed `^^;`

Nathann

[1] https://groups.google.com/d/topic/sage-support/xE_S3WbFHzA/discussion

Issue created by migration from https://trac.sagemath.org/ticket/15260





---

archive/issue_comments_192043.json:
```json
{
    "body": "The reason is that for rationals (and apparently more generally for `FieldElement`), we have\n\n\n```\n    def __floordiv__(self, other):\n        return self / other\n```\n\n\nwhere it should be\n\n\n```\n    def __floordiv__(self, other):\n        return floor(self / other)\n```\n\n\nI will do a patch once i have compiled a more recent version of Sage\n\nWhat is fun is that\n\n\n```\nsage: RDF(0.5)//2\n0.25\n\nsage: RR(0.5)//2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfr.RealLiteral' and 'sage.rings.real_mpfr.RealNumber'\n```\n",
    "created_at": "2013-10-07T12:24:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192043",
    "user": "tmonteil"
}
```

The reason is that for rationals (and apparently more generally for `FieldElement`), we have


```
    def __floordiv__(self, other):
        return self / other
```


where it should be


```
    def __floordiv__(self, other):
        return floor(self / other)
```


I will do a patch once i have compiled a more recent version of Sage

What is fun is that


```
sage: RDF(0.5)//2
0.25

sage: RR(0.5)//2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfr.RealLiteral' and 'sage.rings.real_mpfr.RealNumber'
```




---

archive/issue_comments_192044.json:
```json
{
    "body": "Here's a branch that does this and implements a simple `floordiv` method for RR.\n----\nNew commits:",
    "created_at": "2014-08-03T06:52:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192044",
    "user": "jkeitel"
}
```

Here's a branch that does this and implements a simple `floordiv` method for RR.
----
New commits:



---

archive/issue_comments_192045.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-08-03T06:53:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192045",
    "user": "jkeitel"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_192046.json:
```json
{
    "body": "New commits:",
    "created_at": "2014-08-05T12:28:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192046",
    "user": "jdemeyer"
}
```

New commits:



---

archive/issue_comments_192047.json:
```json
{
    "body": "Using the `floor()` function for every field is a bad idea, for many fields taking `floor()` does not make sense.",
    "created_at": "2014-08-05T12:44:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192047",
    "user": "jdemeyer"
}
```

Using the `floor()` function for every field is a bad idea, for many fields taking `floor()` does not make sense.



---

archive/issue_comments_192048.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-05T13:10:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192048",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_192049.json:
```json
{
    "body": "I suggest just making the fixes for reals and rationals and deferring the discussion about a generic `__floordiv__` to #2034.",
    "created_at": "2014-08-05T13:11:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192049",
    "user": "jdemeyer"
}
```

I suggest just making the fixes for reals and rationals and deferring the discussion about a generic `__floordiv__` to #2034.



---

archive/issue_comments_192050.json:
```json
{
    "body": "Running doctests now...",
    "created_at": "2014-08-05T13:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192050",
    "user": "jdemeyer"
}
```

Running doctests now...



---

archive/issue_comments_192051.json:
```json
{
    "body": "Tests passed, needs review.",
    "created_at": "2014-08-05T14:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192051",
    "user": "jdemeyer"
}
```

Tests passed, needs review.



---

archive/issue_comments_192052.json:
```json
{
    "body": "Could the fix work at least for RDF and RIF ? The current situation is:\n\n\n\n```\nsage: RDF(5) // 2\n2.5\n\nsage: RIF(5) // 2\nTypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'\n```\n",
    "created_at": "2014-08-12T21:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192052",
    "user": "tmonteil"
}
```

Could the fix work at least for RDF and RIF ? The current situation is:



```
sage: RDF(5) // 2
2.5

sage: RIF(5) // 2
TypeError: unsupported operand type(s) for //: 'sage.rings.real_mpfi.RealIntervalFieldElement' and 'sage.rings.real_mpfi.RealIntervalFieldElement'
```




---

archive/issue_comments_192053.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-08-12T21:34:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192053",
    "user": "tmonteil"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_192054.json:
```json
{
    "body": "Changing component from numerical to basic arithmetic.",
    "created_at": "2014-08-13T07:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192054",
    "user": "jdemeyer"
}
```

Changing component from numerical to basic arithmetic.



---

archive/issue_comments_192055.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2014-08-13T07:10:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192055",
    "user": "jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_192056.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-13T07:48:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192056",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_192057.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-13T09:52:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192057",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_192058.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2014-08-24T21:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192058",
    "user": "tmonteil"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_192059.json:
```json
{
    "body": "The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?\n\nI do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.\n\nConcerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:\n\n\n```\nsage: RLF(5) // 2\n2.5000000000000000?\nsage: AA(5) // 2\n5/2\n```\n\n\nWhat about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?",
    "created_at": "2014-08-24T21:32:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192059",
    "user": "tmonteil"
}
```

The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?

I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.

Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:


```
sage: RLF(5) // 2
2.5000000000000000?
sage: AA(5) // 2
5/2
```


What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?



---

archive/issue_comments_192060.json:
```json
{
    "body": "Replying to [comment:18 tmonteil]:\n> The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?\nBecause I wanted something which behaves like `contains_zero()` but still works for any kind of element (unfortunately, `__floordiv__` doesn't use the coercion system).\n\n> Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:\n> \n> What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?\nThat's outside the scope of this ticket, but something like that could be done in a new ticket or as part of #2034.",
    "created_at": "2014-08-25T10:00:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192060",
    "user": "jdemeyer"
}
```

Replying to [comment:18 tmonteil]:
> The condition `if not other != 0:` looks weird. For real interval fields, why not using `other.contains_zero()` which is both easier to understand and faster ?
Because I wanted something which behaves like `contains_zero()` but still works for any kind of element (unfortunately, `__floordiv__` doesn't use the coercion system).

> Concerning `FieldElement` it is very dangerous to return the usual division, since it will silently fail when the field in a subset of the reals for which we did not define a `__floordiv__` method:
> 
> What about trying `(self/other).floor()` and raising a `NotImplementedError` if the method does not exist ?
That's outside the scope of this ticket, but something like that could be done in a new ticket or as part of #2034.



---

archive/issue_comments_192061.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2014-08-25T10:00:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192061",
    "user": "jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_192062.json:
```json
{
    "body": "Replying to [comment:18 tmonteil]:\n> I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.\nYes, that was problematic, that is fixed now.",
    "created_at": "2014-08-25T13:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192062",
    "user": "jdemeyer"
}
```

Replying to [comment:18 tmonteil]:
> I do not understand the ad-hoc coercion that is made for `RealNumber` where the precision of `self` takes predecence over the one of `other`.
Yes, that was problematic, that is fixed now.



---

archive/issue_comments_192063.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-08-25T13:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192063",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_192064.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-08-25T13:43:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192064",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_192065.json:
```json
{
    "body": "Is there a reason for why we don't fix #2034 first? It seems its a really simple fix in `src/sage/structure/element.pyx`, just following what is done for `__div__`. Otherwise whoever wants to tackle that also has to undo the handcrafted type promotion from this ticket.",
    "created_at": "2014-10-04T11:58:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192065",
    "user": "vbraun"
}
```

Is there a reason for why we don't fix #2034 first? It seems its a really simple fix in `src/sage/structure/element.pyx`, just following what is done for `__div__`. Otherwise whoever wants to tackle that also has to undo the handcrafted type promotion from this ticket.



---

archive/issue_comments_192066.json:
```json
{
    "body": "Replying to [comment:23 vbraun]:\n> Is there a reason for why we don't fix #2034 first?\nNot really. Mostly, I don't know how to do it.",
    "created_at": "2014-10-04T21:22:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192066",
    "user": "jdemeyer"
}
```

Replying to [comment:23 vbraun]:
> Is there a reason for why we don't fix #2034 first?
Not really. Mostly, I don't know how to do it.



---

archive/issue_comments_192067.json:
```json
{
    "body": "I do not agree with your semantic of `__floordiv__`. Within Sage `//` is meant for *internal division* (i.e. quotient of the euclidean division):\n\n```\nsage: x = polygen(ZZ)\nsage: p1 = (x+1)*(x+2)\nsage: p1 // (x+1)\nx + 2\nsage: _.parent()\nUnivariate Polynomial Ring in x over Integer Ring\nsage: sage: p1 / (x+1)\nx + 2\nsage: sage: _.parent()\nFraction Field of Univariate Polynomial Ring in x over Integer Ring\n```\n\n\nInside `RR` or `RDF` I am not sure what would be the point of `//`. This is a prefectly valid euclidean division `5 = 2 x 2.5 + 0`.",
    "created_at": "2015-04-30T10:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192067",
    "user": "vdelecroix"
}
```

I do not agree with your semantic of `__floordiv__`. Within Sage `//` is meant for *internal division* (i.e. quotient of the euclidean division):

```
sage: x = polygen(ZZ)
sage: p1 = (x+1)*(x+2)
sage: p1 // (x+1)
x + 2
sage: _.parent()
Univariate Polynomial Ring in x over Integer Ring
sage: sage: p1 / (x+1)
x + 2
sage: sage: _.parent()
Fraction Field of Univariate Polynomial Ring in x over Integer Ring
```


Inside `RR` or `RDF` I am not sure what would be the point of `//`. This is a prefectly valid euclidean division `5 = 2 x 2.5 + 0`.



---

archive/issue_comments_192068.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2015-04-30T10:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192068",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_192069.json:
```json
{
    "body": "Changing status from needs_info to needs_work.",
    "created_at": "2016-01-19T17:41:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192069",
    "user": "jdemeyer"
}
```

Changing status from needs_info to needs_work.



---

archive/issue_comments_192070.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-01-20T13:57:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192070",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_192071.json:
```json
{
    "body": "Replying to [comment:25 vdelecroix]:\n> I do not agree with your semantic of `__floordiv__`.\n\nIt's consistent with Python's `__floordiv__` for `float`, so this what we should do according to the \"principle of least surprise\".",
    "created_at": "2016-01-20T14:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192071",
    "user": "jdemeyer"
}
```

Replying to [comment:25 vdelecroix]:
> I do not agree with your semantic of `__floordiv__`.

It's consistent with Python's `__floordiv__` for `float`, so this what we should do according to the "principle of least surprise".



---

archive/issue_comments_192072.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-01-20T14:03:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192072",
    "user": "jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_192073.json:
```json
{
    "body": "Is that what we want\n\n```\nsage: QQ(7) // QQ(3)\n2\nsage: parent(_)\nInteger Ring\nsage: RR(7) // RR(3)\n2\nsage: parent(_)\nInteger Ring\n```\n\nFloordiv of two Python floats is a float (in both Python 2 and 3).",
    "created_at": "2016-01-20T15:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192073",
    "user": "vdelecroix"
}
```

Is that what we want

```
sage: QQ(7) // QQ(3)
2
sage: parent(_)
Integer Ring
sage: RR(7) // RR(3)
2
sage: parent(_)
Integer Ring
```

Floordiv of two Python floats is a float (in both Python 2 and 3).



---

archive/issue_comments_192074.json:
```json
{
    "body": "Changing status from needs_review to needs_info.",
    "created_at": "2016-01-20T15:52:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192074",
    "user": "vdelecroix"
}
```

Changing status from needs_review to needs_info.



---

archive/issue_comments_192075.json:
```json
{
    "body": "The sage-devel thread is in favor of throwing an exception. Really code shouldn't rely on `QQ.__floordiv__` as it is ambiguous and likely to cause difficult-to-see errors.",
    "created_at": "2016-01-20T20:57:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192075",
    "user": "vbraun"
}
```

The sage-devel thread is in favor of throwing an exception. Really code shouldn't rely on `QQ.__floordiv__` as it is ambiguous and likely to cause difficult-to-see errors.



---

archive/issue_comments_192076.json:
```json
{
    "body": "By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python. Another reason for `__floordiv__` to be internal is that it gives a generic \"exact division\" method (division while you know in advance that the result is exact), which has several use cases. For instance if you want to take the primitive part of a polynomial: You can write a generic method which works over fields as well as over rings, as soon as you have a method `content` which returns 1 for fields and a more interesting content for rings.\u00b9 In a situation where `__floordiv__` raises an Exception, you must use a `__truediv__` and then convert to the original ring to obtain an exact division.\n\n\u00b9 This example may seem anecdotal though I constantly encounter the need for an exact division. Of course, this is only useful for generic implementation, which could be used with rings or fields.",
    "created_at": "2016-03-16T17:31:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192076",
    "user": "bruno"
}
```

By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python. Another reason for `__floordiv__` to be internal is that it gives a generic "exact division" method (division while you know in advance that the result is exact), which has several use cases. For instance if you want to take the primitive part of a polynomial: You can write a generic method which works over fields as well as over rings, as soon as you have a method `content` which returns 1 for fields and a more interesting content for rings.ยน In a situation where `__floordiv__` raises an Exception, you must use a `__truediv__` and then convert to the original ring to obtain an exact division.

ยน This example may seem anecdotal though I constantly encounter the need for an exact division. Of course, this is only useful for generic implementation, which could be used with rings or fields.



---

archive/issue_comments_192077.json:
```json
{
    "body": "Replying to [comment:32 bruno]:\n> By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python.\n\nIn my opinion, `QQ` and `float` are very different things so I see no reason why their `__floordiv__` methods should be similar.",
    "created_at": "2016-03-16T21:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192077",
    "user": "jdemeyer"
}
```

Replying to [comment:32 bruno]:
> By the principle of least surprise, I would be in favor of `QQ.__floordiv__` behaving the same way as `float.__floordiv__` behaves in Python.

In my opinion, `QQ` and `float` are very different things so I see no reason why their `__floordiv__` methods should be similar.



---

archive/issue_comments_192078.json:
```json
{
    "body": "That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:\n\n```\nsage: QQ(7)//QQ(3)\n2\nsage: parent(QQ(7)//QQ(3))\nRational Field\n```\n\nwhich looks useful indeed. But I don't know if there is enough consensus for this.",
    "created_at": "2016-03-16T21:11:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192078",
    "user": "jdemeyer"
}
```

That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:

```
sage: QQ(7)//QQ(3)
2
sage: parent(QQ(7)//QQ(3))
Rational Field
```

which looks useful indeed. But I don't know if there is enough consensus for this.



---

archive/issue_comments_192079.json:
```json
{
    "body": "I used `QQ` as an example, but the same holds for other fields. In the current branch, `__floordiv__` always returns an integer, while it should to my mind always be internal. Note that I am strongly against raising an exception since it would be a useless regression. (By this I mean that it would break some existing code, and bring nothing interesting.) I guess that my viewpoint is the same as (close to?) the one expressed by Vincent in comment:28 and comment:30.\n\nReplying to [comment:31 vbraun]:\n> The sage-devel thread is in favor of throwing an exception. \n\nI do not see any such consensus in the sage-devel thread! You are the only one proposing to raise an exception... William says that it is a reasonable option, as is Jeroen's proposal.",
    "created_at": "2016-03-17T09:04:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192079",
    "user": "bruno"
}
```

I used `QQ` as an example, but the same holds for other fields. In the current branch, `__floordiv__` always returns an integer, while it should to my mind always be internal. Note that I am strongly against raising an exception since it would be a useless regression. (By this I mean that it would break some existing code, and bring nothing interesting.) I guess that my viewpoint is the same as (close to?) the one expressed by Vincent in comment:28 and comment:30.

Replying to [comment:31 vbraun]:
> The sage-devel thread is in favor of throwing an exception. 

I do not see any such consensus in the sage-devel thread! You are the only one proposing to raise an exception... William says that it is a reasonable option, as is Jeroen's proposal.



---

archive/issue_comments_192080.json:
```json
{
    "body": "See #21745 for modifying only QQ.\n\nActually I think that a good (partial) specification would be:\n- `//` and `%` should always be consistent when implemented\n- in non-trivial euclidean rings `a // b` and `a % b` should stand for the remainder and quotient of euclidean division (eg `ZZ`, `QQ[x]`). In these cases, it would just be aliases of `a.quo_rem(b)[0]` and `a.quo_rem(b)[1]`.\n- for subset of the reals it should be the natural extension of integer euclidean division as proposed in [this thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) (see also #21745 and #21747 for a concrete proposal)",
    "created_at": "2016-10-23T13:52:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192080",
    "user": "vdelecroix"
}
```

See #21745 for modifying only QQ.

Actually I think that a good (partial) specification would be:
- `//` and `%` should always be consistent when implemented
- in non-trivial euclidean rings `a // b` and `a % b` should stand for the remainder and quotient of euclidean division (eg `ZZ`, `QQ[x]`). In these cases, it would just be aliases of `a.quo_rem(b)[0]` and `a.quo_rem(b)[1]`.
- for subset of the reals it should be the natural extension of integer euclidean division as proposed in [this thread](https://groups.google.com/forum/#!topic/sage-devel/PfMop0nyiL0) (see also #21745 and #21747 for a concrete proposal)



---

archive/issue_comments_192081.json:
```json
{
    "body": "Replying to [comment:34 jdemeyer]:\n> That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:\n> {{{\n> sage: QQ(7)//QQ(3)\n> 2\n> sage: parent(QQ(7)//QQ(3))\n> Rational Field\n> }}}\n> which looks useful indeed. But I don't know if there is enough consensus for this.\n\nWould make sense to me and would also be better from the coercion point of view. However in Sage we use to convert exact integer results to integer as in\n\n```\nsage: type((2.5).floor())\n<type 'sage.rings.integer.Integer'>\n```\n\n\nNote that Python is sloppy about the output type\n\n```\n>>> type(2.0 // 1.0)\nfloat\n>>> type(fractions.Fraction(2,1) // fractions.Fraction(1,1))\nint\n```\n\n(but `fractions` is not so much a standard)",
    "created_at": "2016-10-23T15:30:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/15023",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/15023#issuecomment-192081",
    "user": "vdelecroix"
}
```

Replying to [comment:34 jdemeyer]:
> That being said, I could certainly agree with `QQ.__floordiv__` returning a rational which is always an exact integer. That would be:
> {{{
> sage: QQ(7)//QQ(3)
> 2
> sage: parent(QQ(7)//QQ(3))
> Rational Field
> }}}
> which looks useful indeed. But I don't know if there is enough consensus for this.

Would make sense to me and would also be better from the coercion point of view. However in Sage we use to convert exact integer results to integer as in

```
sage: type((2.5).floor())
<type 'sage.rings.integer.Integer'>
```


Note that Python is sloppy about the output type

```
>>> type(2.0 // 1.0)
float
>>> type(fractions.Fraction(2,1) // fractions.Fraction(1,1))
int
```

(but `fractions` is not so much a standard)
