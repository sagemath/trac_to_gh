# Issue 27345: py3: fix bug in all_paths

Issue created by migration from https://trac.sagemath.org/ticket/27582

Original creator: dcoudert

Original creation time: 2019-03-31 17:38:25

CC:  @rajat1433

Keywords: py3, graph

With #27501, we introduced an error in `all_paths` for Python 3. Indeed, `my_dict.keys()` returns a list in Python 2 but it is an iterator in Python 3, so the following code breaks as the size of the dictionary change during iteration.

```
                for u, v in my_dict.keys():
                    my_dict[v, u] = my_dict[u, v]
```


We fix this issue using `list(my_dict.keys())`. On the way, we also rename `my_dict` to `edge_labels`.


---

Comment by dcoudert created at 2019-03-31 17:40:11

New commits:


---

Comment by dcoudert created at 2019-03-31 17:40:11

Changing status from new to needs_review.


---

Comment by chapoton created at 2019-03-31 18:34:21

you can also remove the `.keys()`


---

Comment by git created at 2019-03-31 18:41:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-03-31 18:41:46

Right, done.


---

Comment by chapoton created at 2019-03-31 19:23:19

some `.keys()` are still there


---

Comment by git created at 2019-03-31 19:53:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dcoudert created at 2019-03-31 19:54:15

Should be OK now. Thanks.


---

Comment by chapoton created at 2019-03-31 20:11:52

good to go if the patchbot is green


---

Comment by chapoton created at 2019-04-01 07:24:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-04-03 18:38:33

Resolution: fixed
