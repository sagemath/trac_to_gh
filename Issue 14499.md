# Issue 14499: Bad error message when Finitely Presented Group cannot be represented as pemrutation groups

Issue created by migration from Trac.

Original creator: Bouillaguet

Original creation time: 2013-06-08 06:05:58

Assignee: joyner

CC:  mmarco


```
sage: G.<a,b> = FreeGroup()
sage: H = G / [a^3*b]
sage: H.as_permutation_group()
---------------------------------------------------------------------------
UnboundLocalError                         Traceback (most recent call last)
...
UnboundLocalError: local variable 'l' referenced before assignment
```



---

Attachment

Updated patch


---

Comment by vbraun created at 2013-06-08 13:00:31

Changing status from new to needs_review.


---

Comment by vbraun created at 2013-06-08 13:00:31

My patch implements a context manager for temporarily switching global variables in GAP, and then uses that to implement a user-specified limit on the number of cosets (defaults to the GAP default value).


---

Comment by mmarco created at 2013-06-12 12:56:20

I have to check it more carefully, but in principle it looks good.

How does libgap handle memory session limit now? Are we still limited by some -o option?


---

Comment by vbraun created at 2013-06-12 13:02:44

Its still a fixed memory pool, with details of the size depending on whats available at startup.

GAP always used an arbitrary limit for the number of cosets, and never filled all available memory. Whether or not you hit the coset limit depends on if `4096000` cosets fit RAM or not.


---

Comment by vbraun created at 2013-06-18 18:21:49

Anybody up for a review?


---

Comment by mmarco created at 2013-06-18 18:27:59

I am having trouble applying the patch. The dependencies are supposed to be merged on sage-5.11.beta0... but i am unable to find it (is there some mistake? sage 5.10 is not finished and there is already a 5.11beta?)


---

Comment by vbraun created at 2013-06-18 22:13:57

Jeroen recommeded the not-yet-released sage-5.11.beta1 (http://boxen.math.washington.edu/home/release/sage-5.11.beta1). The patch applies cleanly on that version.


---

Comment by mmarco created at 2013-06-19 20:02:38

I have tested it, and the result is that the sage session quits.


```
sage: G=FreeGroup(2)
sage: G.inject_variables()                                                                                                                          
Defining x0, x1
sage: H=G.quotient([x0*x1^2])                                                                                                                       
sage: H.as_permutation_group()                                                                                                                      
gap: cannot extend the workspace any more!
mmarco`@`neumann ~/sage-5.11.beta1 $ 
```



Is that expected?


---

Comment by vbraun created at 2013-06-19 20:21:37

That should be the same behavior as without the patch, if GAP runs out of memory then it aborts (we should probably catch that, but its unrelated to this ticket).

Can you try a smaller limit?


---

Comment by mmarco created at 2013-06-19 21:01:25

It seems to work fine with smaller limits. Maybe there should be a smaller default limit? I think it is preferable that the default behaviour is to raise an error than to crash the session.


---

Comment by vbraun created at 2013-06-19 21:04:21

Actually this (the abort when out of memory) seems to be a regression in the new libgap. I opened a new ticket at #14779


---

Comment by vbraun created at 2013-06-19 21:04:52

PS: the default limit in the patch equals the GAP default


---

Comment by mmarco created at 2013-06-19 21:31:25

Ok, fair enough.


---

Comment by mmarco created at 2013-06-19 21:31:32

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-06-20 06:54:15

Please fill in your real names as Author/Reviewer.


---

Comment by jdemeyer created at 2013-06-20 07:19:22

Changing status from positive_review to needs_info.


---

Comment by mmarco created at 2013-06-20 08:56:37

Changing status from needs_info to needs_review.


---

Comment by mmarco created at 2013-06-20 08:56:48

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2013-06-20 21:37:03

Resolution: fixed
