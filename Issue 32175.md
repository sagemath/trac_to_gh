# Issue 32175: Deprecate sage.interfaces.primecount

Issue created by migration from https://trac.sagemath.org/ticket/32412

Original creator: mkoeppe

Original creation time: 2021-08-24 06:54:05

CC:  vdelecroix tscrim

(see #25009#comment:4)




---

Comment by mkoeppe created at 2021-08-26 21:24:48

New commits:


---

Comment by mkoeppe created at 2021-08-26 21:24:48

Changing status from new to needs_review.


---

Comment by tscrim created at 2021-08-26 23:45:36

Just to confirm, we are deprecating the interface in favor of only having the `libs/primecount.pxd`, correct? If so, LGTM and you can set a positive review.


---

Comment by git created at 2021-08-27 00:03:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2021-08-27 00:04:36

Actually, the pxd file would also be scheduled for removal.


---

Comment by tscrim created at 2021-08-27 01:06:31

Okay, then I am a bit confused about this now. We still want to link to the library, right? If we don't have a lib or interface, then how will we access it within Sage?


---

Comment by mkoeppe created at 2021-08-27 02:41:02

Note that it is currently unused in Sage.

`sage.interfaces.primecount`, because its compilation depends on an optional package, 
would have to be provided by a distribution separate from `sagemath-standard`.

For other modules such as `sage.graphs.graph_decompositions.tdlib` that depend on an optional package, we would indeed split it out as a distribution `sagemath-tdlib`. This is done in #29864. Note that `sage.graphs.graph_decompositions.tdlib` depends on both Sage (by using the `Graph` class) and on the optional package.

The difference is that `sage.interfaces.primecount` does not depend in any way on Sage. Therefore it should be redone as a standalone Python (Cython) package, in the same way that Vincent split out (and extended) https://pypi.org/project/pplpy/ from Sage (`sage.libs.ppl`).


---

Comment by tscrim created at 2021-08-27 12:58:35

Replying to [comment:7 mkoeppe]:
> For other modules such as `sage.graphs.graph_decompositions.tdlib` that depend on an optional package, we would indeed split it out as a distribution `sagemath-tdlib`. This is done in #29864. Note that `sage.graphs.graph_decompositions.tdlib` depends on both Sage (by using the `Graph` class) and on the optional package.

Thank you for the explanation. Does that mean this distribution meant to replace the current package? Otherwise it feels like double duty as there already is the package itself on top of the library. (My standard example of this is `meataxe`.)

> The difference is that `sage.interfaces.primecount` does not depend in any way on Sage. Therefore it should be redone as a standalone Python (Cython) package, in the same way that Vincent split out (and extended) https://pypi.org/project/pplpy/ from Sage (`sage.libs.ppl`).

So the expectation here is that such a standalone package would provide a way for it to be important from Python with a usual `import` statement?


---

Comment by mkoeppe created at 2021-08-27 18:54:32

Replying to [comment:8 tscrim]:
> Replying to [comment:7 mkoeppe]:
> > For other modules such as `sage.graphs.graph_decompositions.tdlib` that depend on an optional package, we would indeed split it out as a distribution `sagemath-tdlib`. This is done in #29864. Note that `sage.graphs.graph_decompositions.tdlib` depends on both Sage (by using the `Graph` class) and on the optional package.
> 
> Thank you for the explanation. Does that mean this distribution meant to replace the current package? Otherwise it feels like double duty as there already is the package itself on top of the library. (My standard example of this is `meataxe`.)

There will always be two packages - one providing the C library and one providing the Python bindings.

When the Python bindings are not Sage-specific:
- `ppl` / `pplpy`
- `igraph` / `python_igraph`
- `primecount` / `pyprimecount` (to be created) 

When the Python package is Sage-specific:
- `tdlib` / `sagemath-tdlib` (to be created in #29864)
- `meataxe` / `sagemath-meataxe` (to be created in #30151)


---

Comment by mkoeppe created at 2021-08-27 18:55:08

Replying to [comment:8 tscrim]:
> > The difference is that `sage.interfaces.primecount` does not depend in any way on Sage. Therefore it should be redone as a standalone Python (Cython) package, in the same way that Vincent split out (and extended) https://pypi.org/project/pplpy/ from Sage (`sage.libs.ppl`).
> 
> So the expectation here is that such a standalone package would provide a way for it to be imported from Python with a usual `import` statement?

Yes, exactly.


---

Comment by tscrim created at 2021-08-27 22:33:48

Okay, thank you. LGTM.


---

Comment by tscrim created at 2021-08-27 22:33:48

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2021-08-27 22:58:14

Thanks!


---

Comment by vbraun created at 2021-09-13 22:18:37

Resolution: fixed


---

Comment by dimpase created at 2021-11-12 22:35:56

Let us revert this, upgrade primecount, and use it to compute `prime_pi`, instead of buggy and slow Sage code - cf. #24960


---

Comment by mkoeppe created at 2021-11-12 22:37:05

comment:7, 3rd paragraph, explains the correct way forward


---

Comment by dimpase created at 2021-11-12 23:23:56

Replying to [comment:15 mkoeppe]:
> comment:7, 3rd paragraph, explains the correct way forward

I forgot to mention that we should promote primecount to standard.
I don't understand why one need to do a special package thing for the (pretty trivial)
interface, why can't this just live in sagelib, like other interfaces to C/C++ libs?


---

Comment by mkoeppe created at 2021-11-12 23:26:04

Replying to [comment:16 dimpase]:
> I don't understand why one need to do a special package thing for the (pretty trivial)
> interface, why can't this just live in sagelib, like other interfaces to C/C++ libs?

Did you read my discussion with tscrim above, on exactly this topic?


---

Comment by dimpase created at 2021-11-12 23:36:13

Perhaps we can use https://github.com/hearot/primecount-python (not on pip, unfortunately)


---

Comment by dimpase created at 2021-11-12 23:37:08

Replying to [comment:17 mkoeppe]:
> Replying to [comment:16 dimpase]:
> > I don't understand why one need to do a special package thing for the (pretty trivial)
> > interface, why can't this just live in sagelib, like other interfaces to C/C++ libs?
> 
> Did you read my discussion with tscrim above, on exactly this topic?

It was about dependence on an optional package, but we're promoting it to standard now?


---

Comment by mkoeppe created at 2021-11-12 23:39:53

It doesn't matter that you are promoting it to standard.


---

Comment by dimpase created at 2021-11-12 23:43:55

anyhow, there is an external package already, it's unfortunately a bit light on the distribution side - well, the author is still in high school according to GH. Maybe he can use some help in building wheels and stuff.
