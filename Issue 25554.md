# Issue 25554: some import cleanup and lazification in algebras and root systems

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2018-07-06 18:57:18

CC:  tscrim vdelecroix nthiery bump




---

Comment by chapoton created at 2018-07-06 19:00:15

New commits:


---

Comment by chapoton created at 2018-07-06 19:00:15

Changing status from new to needs_review.


---

Comment by vdelecroix created at 2018-07-07 08:17:42

This has to be thought carefully

```diff
-from .weyl_group import WeylGroup, WeylGroupElement
+lazy_import('sage.combinat.root_system.weyl_group', ['WeylGroup',
+                                                     'WeylGroupElement'])
```

because it forbids `isinstance(X, WeylGroup)` in a Sage shell.


---

Comment by tscrim created at 2018-07-07 14:54:56

A number of doctest failures; see patchbot.


---

Comment by tscrim created at 2018-07-07 14:54:56

Changing status from needs_review to needs_work.


---

Comment by git created at 2018-07-07 16:24:23

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-07-09 08:11:23

better now


---

Comment by chapoton created at 2018-07-09 08:11:23

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2018-07-09 14:34:28

I do not agree with deprecating `branching_rule_from_plethsym` but not `branching_rule` as the former provides functionality not accessible via the latter (at present). I would probably keep both for now. I think `BranchingRule` can be deprecated from the global namespace (its doctests all seem to use the `branching_rule` function).

In regards to comment:2, actually, `WeylGroup` is a function, so that doesn't even work currently. However, if it was the class, it would still work with this branch:

```
sage: W = WeylGroup('A2', prefix='s')
sage: isinstance(W.an_element(), WeylGroupElement)
True
sage: type(WeylGroupElement)
<type 'sage.misc.lazy_import.LazyImport'>
```



---

Comment by git created at 2018-07-10 07:57:55

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2018-07-10 08:00:03

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2018-07-10 14:55:46

LGTM. Thank you.


---

Comment by tscrim created at 2018-07-10 14:55:46

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2018-07-15 15:47:32

Changing status from positive_review to needs_work.


---

Comment by vbraun created at 2018-07-15 15:47:32

Docbuild fails


---

Comment by chapoton created at 2018-07-16 18:30:14

It is not clear to me what is happening..

```
-[dochtml] [thematic_] writing output... [ 38%] geometry/polyhedra_quickref

+[dochtml] [developer] reading sources... [ 88%] sagenb/set_up_fork

-[dochtml] [developer] reading sources... [ 88%] sagenb/set_up_fork
+[dochtml] [thematic_] Exception occurred:
+[dochtml] [thematic_]   File "sage/misc/lazy_import.pyx", line 221, in sage.misc.lazy_import.LazyImport._get_object (build/cythonized/sage/misc/lazy_import.c:2532)
+[dochtml] [thematic_]     self._object = getattr(__import__(self._module, {}, {}, [self._name]), self._name)
+[dochtml] [thematic_] ValueError: Empty module name
+[dochtml] [thematic_] The full traceback has been saved in /tmp/sphinx-err-wL_pQe.log, if you want to report the issue to the developers.
+[dochtml] [thematic_] Please also report this if it was a user error, so that a better error message can be provided next time.
+[dochtml] [thematic_] A bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!

-[dochtml] [thematic_] writing output... [ 55%] lie/crystals
```



---

Comment by git created at 2018-08-27 18:46:37

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2018-08-27 18:47:40

another tentative, by not touching branching rules.. Let us see what the patchbot says


---

Comment by chapoton created at 2018-08-27 18:47:40

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2018-08-27 23:57:10

Patchbot comes back green.


---

Comment by tscrim created at 2018-08-27 23:57:10

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2018-08-30 07:45:36

I wonder if a closed milestone prevents the ticket to get closed by the release manager. See #25829 for example.


---

Comment by tscrim created at 2018-08-30 07:59:37

I don't think so. It sometimes feels more of a FILO-ish structure with a dependence on the priority.


---

Comment by vbraun created at 2018-08-30 08:00:12

My merge script isn't looking at the milestone. Tickets are priorities by ascending ticket number afair.


---

Comment by tscrim created at 2018-08-30 08:01:52

Replying to [comment:18 vbraun]:
> My merge script isn't looking at the milestone. Tickets are priorities by ascending ticket number afair.

Thank you for the explanation.


---

Comment by vbraun created at 2018-08-30 22:24:46

Resolution: fixed
