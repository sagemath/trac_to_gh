# Issue 24049: py3: minor fixes to sage.repl.load

Issue created by migration from https://trac.sagemath.org/ticket/24286

Original creator: embray

Original creation time: 2017-11-27 14:13:11

CC:  jdemeyer

This will be one of many tickets I will be opening for miscellaneous minor fixes to specific modules.

In some cases I'll keep these more "thematic" in which case they might span multiple modules, but in other cases it is simpler to submit one module at a time for minor fixes.

See the commit messages for more details about individual fixes.


---

Comment by embray created at 2017-11-27 14:14:18

This will need #24222 to be merged first to make sense.


---

Comment by embray created at 2018-01-02 13:31:59

Changing status from new to needs_review.


---

Comment by chapoton created at 2018-01-03 19:43:48

~~looks good enough to me~~.

Jeroen, any opinion ?

EDIT: This seems to break several things, see patchbot report..


---

Comment by embray created at 2018-01-04 16:50:40

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2018-01-14 16:06:15

I fixed one of the doctest failures (the easy one).
----
New commits:


---

Comment by embray created at 2018-01-16 16:56:09

I already had this fixed in my local branch; I just hadn't pushed it yet, so for simplicity's sake I'll keep my branch.  The other issues are (mostly) related to #24475


---

Comment by chapoton created at 2018-02-12 12:51:18

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2018-02-12 12:51:18

New commits:


---

Comment by git created at 2018-02-12 13:15:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jdemeyer created at 2018-02-12 13:30:11

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2018-02-12 13:30:11

1. In `src/sage/repl/load.py`, some doctests are marked `# py2` for no good reason.

2. Why use `tmp_filename` here?

```
        sage: fname = tmp_filename(ext='.py')
        sage: fullpath = os.path.join(t_dir, fname)
        sage: with open(fullpath, 'w') as f:
        ....:     _ = f.write("print(37 * 3)")
```


3. The git history is a mess (in particular, the commit message `Merge branch 'u/embray/python3/sage-repl-load' in 8.1.b5` is wrong). It would be best to squash this in one commit on top op Sage 8.2.beta5


---

Comment by git created at 2018-02-12 13:33:54

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by chapoton created at 2018-02-12 13:38:25

I do not understand the issue in point 2


---

Comment by git created at 2018-02-12 16:56:53

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-02-13 10:33:19

green bot


---

Comment by jdemeyer created at 2018-02-13 10:45:04

Replying to [comment:13 chapoton]:
> I do not understand the issue in point 2

The old code did not use `tmp_filename`. The new code does. I see no reason for that change, so it needs to be justified.


---

Comment by git created at 2018-02-13 10:49:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2018-02-13 10:50:28

ok, done


---

Comment by chapoton created at 2018-02-13 10:50:28

Changing status from needs_work to needs_review.


---

Comment by jdemeyer created at 2018-02-13 15:27:08

Changing status from needs_review to positive_review.


---

Comment by embray created at 2018-02-14 16:33:20

Replying to [comment:16 jdemeyer]:
> Replying to [comment:13 chapoton]:
> > I do not understand the issue in point 2
> 
> The old code did not use `tmp_filename`. The new code does. I see no reason for that change, so it needs to be justified.

I think it was _probably_ a mistake but I'm going to have to double-check now...


---

Comment by vbraun created at 2018-02-15 23:13:43

Resolution: fixed
