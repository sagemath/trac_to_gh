# Issue 23543: Modify p-adic Gauss sum to allow working directly in Q_p

Issue created by migration from Trac.

Original creator: kedlaya

Original creation time: 2017-09-04 15:30:25

Keywords: Gauss sums, Gross-Koblitz formula

The Gross-Koblitz formula for p-adic computation of Gauss sums was implemented in #23456. The formula involves working in the ramified extension of `Q_p` generated by an element `pi` for which `pi^(p-1) == -p`; however, the formula actually is written as a power of `pi` times an element of `Z_p`, and for some applications (e.g., hypergeometric motives; see #23671) it would be helpful to be able to access the unramified factor without going through the extension ring (for efficiency when `p` is large). That is, one should have the option to request the output in the form `(e, z)` where `e` is a nonnegative integer, `z` is an element of `Z_p`, and the real answer is `pi^e*z` for `pi` as above. And in this case, the extension field should not be formed at all.


---

Comment by git created at 2017-09-04 15:50:54

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2017-09-04 15:51:59

Commit added, with a doctest to match. I also fixed the mathematical issue with the docstring reported in #23671.

This should be an easy review, except possibly for formatting issues.


---

Comment by kedlaya created at 2017-09-04 15:51:59

Changing status from new to needs_review.


---

Comment by roed created at 2017-09-04 19:05:06

Looks good to me; positive review once tests pass.


---

Comment by git created at 2017-09-05 15:42:00

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2017-09-05 15:43:04

Fixed docstring formatting in my mathematical correction; and forced the answer to be cast into the p-adic ring even when `r=0` (otherwise errors may result down the line).


---

Comment by chapoton created at 2017-09-06 11:41:03

does not apply on the latest beta, needs rebase


---

Comment by git created at 2017-09-06 13:07:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kedlaya created at 2017-09-06 13:09:07

Sorry, that should be fixed now.


---

Comment by roed created at 2017-09-06 16:35:06

Adding author for patchbot.


---

Comment by chapoton created at 2017-09-07 19:03:13

trying to make the doc build.
----
New commits:


---

Comment by chapoton created at 2017-09-08 06:34:01

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2017-09-08 06:34:01

ok, let it be.


---

Comment by vbraun created at 2017-09-11 13:47:08

Resolution: fixed
