# Issue 22993: adding is_coxeter_element to finite coxeter groups

archive/issues_022993.json:
```json
{
    "body": "CC:  @tscrim @darijgr stumpc5\n\nto allow using noncrossing partition lattices for Weyl groups\n\nIssue created by migration from https://trac.sagemath.org/ticket/23230\n\n",
    "created_at": "2017-06-13T13:07:51Z",
    "labels": [
        "combinatorics",
        "major",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.0",
    "title": "adding is_coxeter_element to finite coxeter groups",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/22993",
    "user": "@fchapoton"
}
```
CC:  @tscrim @darijgr stumpc5

to allow using noncrossing partition lattices for Weyl groups

Issue created by migration from https://trac.sagemath.org/ticket/23230





---

archive/issue_comments_321799.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-06-13T13:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321799",
    "user": "@fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_321800.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-06-13T13:08:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321800",
    "user": "@fchapoton"
}
```

New commits:



---

archive/issue_comments_321801.json:
```json
{
    "body": "The check\n\n```\n    self.absolute_length() == self.parent().rank()\n```\n\ndoes not seem enough to test for Coxeter elements. E.g., in type B already there are elements with this property that are not Coxeter elements. The most general version of Coxeter element would need to test that such an element has an eigenvalue that is a primitive h-th root of unity where h is the Coxeter number.",
    "created_at": "2017-06-13T13:15:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321801",
    "user": "stumpc5"
}
```

The check

```
    self.absolute_length() == self.parent().rank()
```

does not seem enough to test for Coxeter elements. E.g., in type B already there are elements with this property that are not Coxeter elements. The most general version of Coxeter element would need to test that such an element has an eigenvalue that is a primitive h-th root of unity where h is the Coxeter number.



---

archive/issue_comments_321802.json:
```json
{
    "body": "aargh, I am such a type-A-only guy..",
    "created_at": "2017-06-13T13:17:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321802",
    "user": "@fchapoton"
}
```

aargh, I am such a type-A-only guy..



---

archive/issue_comments_321803.json:
```json
{
    "body": "I think it would be better to remove the `is_coxeter_element` call from the `noncrossing_partition_lattice` method, or at least only call it if available.",
    "created_at": "2017-06-13T13:20:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321803",
    "user": "stumpc5"
}
```

I think it would be better to remove the `is_coxeter_element` call from the `noncrossing_partition_lattice` method, or at least only call it if available.



---

archive/issue_comments_321804.json:
```json
{
    "body": "What about\n\n```\nreturn self in prod(W.gens()).conjugacy_class()\n```\n",
    "created_at": "2017-06-13T13:20:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321804",
    "user": "@fchapoton"
}
```

What about

```
return self in prod(W.gens()).conjugacy_class()
```




---

archive/issue_comments_321805.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-13T13:26:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321805",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321806.json:
```json
{
    "body": "An alternative would be\n\n```\n                if self.is_real() or (hasattr(c,\"is_coxeter_element\") and c.is_coxeter_element()):\n                    smart_covers = in_unitary_group = True\n\n                R = self.reflections()\n                if L is None:\n                    L = self.elements_below_coxeter_element(c=c)\n#                    if c.is_coxeter_element():\n#                        smart_covers = in_unitary_group = True\n```\n\nbut yours is fine, too!\n----\nNew commits:",
    "created_at": "2017-06-13T13:31:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321806",
    "user": "stumpc5"
}
```

An alternative would be

```
                if self.is_real() or (hasattr(c,"is_coxeter_element") and c.is_coxeter_element()):
                    smart_covers = in_unitary_group = True

                R = self.reflections()
                if L is None:
                    L = self.elements_below_coxeter_element(c=c)
#                    if c.is_coxeter_element():
#                        smart_covers = in_unitary_group = True
```

but yours is fine, too!
----
New commits:



---

archive/issue_comments_321807.json:
```json
{
    "body": "To use more generic code, it'd vote for using\n\n```\nreturn self in self.parent().coxeter_elements()\n```\n",
    "created_at": "2017-06-13T13:56:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321807",
    "user": "stumpc5"
}
```

To use more generic code, it'd vote for using

```
return self in self.parent().coxeter_elements()
```




---

archive/issue_comments_321808.json:
```json
{
    "body": "What about back to basics:\n\n```python\nwd = self.reduced_word()\nI = self.parent().index_set()\nreturn len(wd) == len(I) and set(wd) == set(I)  # Really this is just checking it is a permutation of I\n```\n\nThis should also work for all Coxeter groups.",
    "created_at": "2017-06-13T14:35:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321808",
    "user": "@tscrim"
}
```

What about back to basics:

```python
wd = self.reduced_word()
I = self.parent().index_set()
return len(wd) == len(I) and set(wd) == set(I)  # Really this is just checking it is a permutation of I
```

This should also work for all Coxeter groups.



---

archive/issue_comments_321809.json:
```json
{
    "body": "Well, this works but doesn't check whether an element is a Coxeter element :-)\n\nHere are some definitions:\n\n1. A standard Coxeter element is the product of the generators in some order\n\n    2a. A Coxeter element is an element that is conjugate to a standard Coxeter element.\n\n    2b. This is equivalent to : A Coxeter element is an element for that has eigenvalue e^{2\\pi i / h} where h is the Coxeter number.\n\nGiven the alternative description in 2, this condition can be relaxed to:\n\n2c. A Coxeter element is an element that has a primitive h-th root of unity as an eigenvalue.\n\nThis can be shown to be equivalent to\n\n2d. A Coxeter element is an element that is obtained from a standard Coxeter element by conjugation and Galois automorphisms.\n\nFor Weyl groups, 2a - 2d are all equivalent, while one can show that in general, there are k conjugacy classes of Coxeter elements where k is the degree of the field extension of the field of definition over QQ. You find all these notions in my paper arxiv.org/abs/1404.5522 with Vic Reiner and Vivien Ripoll.",
    "created_at": "2017-06-13T14:59:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321809",
    "user": "stumpc5"
}
```

Well, this works but doesn't check whether an element is a Coxeter element :-)

Here are some definitions:

1. A standard Coxeter element is the product of the generators in some order

    2a. A Coxeter element is an element that is conjugate to a standard Coxeter element.

    2b. This is equivalent to : A Coxeter element is an element for that has eigenvalue e^{2\pi i / h} where h is the Coxeter number.

Given the alternative description in 2, this condition can be relaxed to:

2c. A Coxeter element is an element that has a primitive h-th root of unity as an eigenvalue.

This can be shown to be equivalent to

2d. A Coxeter element is an element that is obtained from a standard Coxeter element by conjugation and Galois automorphisms.

For Weyl groups, 2a - 2d are all equivalent, while one can show that in general, there are k conjugacy classes of Coxeter elements where k is the degree of the field extension of the field of definition over QQ. You find all these notions in my paper arxiv.org/abs/1404.5522 with Vic Reiner and Vivien Ripoll.



---

archive/issue_comments_321810.json:
```json
{
    "body": "Oh, I see. I only learned what you call standard Coxeter elements.",
    "created_at": "2017-06-13T15:06:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321810",
    "user": "@tscrim"
}
```

Oh, I see. I only learned what you call standard Coxeter elements.



---

archive/issue_comments_321811.json:
```json
{
    "body": "We are talking here about finite Coxeter groups, so Travis method should be ok.\n\nI do not care here about general complex reflection groups.\n\nEDIT: well, maybe not, after all..",
    "created_at": "2017-06-13T15:07:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321811",
    "user": "@fchapoton"
}
```

We are talking here about finite Coxeter groups, so Travis method should be ok.

I do not care here about general complex reflection groups.

EDIT: well, maybe not, after all..



---

archive/issue_comments_321812.json:
```json
{
    "body": "So this boils down to a **terminology** problem. What do we call a Coxeter element in sage ?",
    "created_at": "2017-06-13T15:29:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321812",
    "user": "@fchapoton"
}
```

So this boils down to a **terminology** problem. What do we call a Coxeter element in sage ?



---

archive/issue_comments_321813.json:
```json
{
    "body": "I think it is standard to call a Coxeter element an element that is conjugate to the product of the generators. This is also what's implemented in\n\n```\ncategories/finite_complex_reflection_groups.py\n```\n",
    "created_at": "2017-06-13T17:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321813",
    "user": "stumpc5"
}
```

I think it is standard to call a Coxeter element an element that is conjugate to the product of the generators. This is also what's implemented in

```
categories/finite_complex_reflection_groups.py
```




---

archive/issue_comments_321814.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-13T19:39:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321814",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321815.json:
```json
{
    "body": "ok, guys. Does this suit you ?",
    "created_at": "2017-06-13T19:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321815",
    "user": "@fchapoton"
}
```

ok, guys. Does this suit you ?



---

archive/issue_comments_321816.json:
```json
{
    "body": "Replying to [comment:13 chapoton]:\n> So this boils down to a **terminology** problem. What do we call a Coxeter element in sage ?\n> \nThis might just be my lack of properly learning the terminology as I've learned the product of all generators is a Coxeter element and that all Coxeter elements are conjugate (stated more as a fact rather than a definition.\n\nActually, you might want edit [Wikipedia](https://en.wikipedia.org/wiki/Coxeter_element):\n\n> A *Coxeter element* is a product of all simple reflections. The product depends on the order in which they are taken, but different orderings produce conjugate elements, which have the same order.\n\nI don't really care about the terminology, so standard Coxeter elements for the above and the conjugacy class being Coxeter elements is good with me. Although we should make sure we explain things in our documentation more than anything.",
    "created_at": "2017-06-14T04:37:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321816",
    "user": "@tscrim"
}
```

Replying to [comment:13 chapoton]:
> So this boils down to a **terminology** problem. What do we call a Coxeter element in sage ?
> 
This might just be my lack of properly learning the terminology as I've learned the product of all generators is a Coxeter element and that all Coxeter elements are conjugate (stated more as a fact rather than a definition.

Actually, you might want edit [Wikipedia](https://en.wikipedia.org/wiki/Coxeter_element):

> A *Coxeter element* is a product of all simple reflections. The product depends on the order in which they are taken, but different orderings produce conjugate elements, which have the same order.

I don't really care about the terminology, so standard Coxeter elements for the above and the conjugacy class being Coxeter elements is good with me. Although we should make sure we explain things in our documentation more than anything.



---

archive/issue_comments_321817.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-14T13:36:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321817",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321818.json:
```json
{
    "body": "I added the definitions to the docs -- unfortunately, my `make doc` failed (after the `make build` went through) so I cannot test whether I made mistakes in the doc strings, which I likely do as I never remember how to properly typeset it.",
    "created_at": "2017-06-14T13:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321818",
    "user": "stumpc5"
}
```

I added the definitions to the docs -- unfortunately, my `make doc` failed (after the `make build` went through) so I cannot test whether I made mistakes in the doc strings, which I likely do as I never remember how to properly typeset it.



---

archive/issue_comments_321819.json:
```json
{
    "body": "It looks okay overall, but you might be getting problems with latex and `\\p` being converted by Python as an escaped character. Anytime I put any latex in a docstring, I make sure it is raw, so it starts `r\"\"\"` (or a single line `r\"`) (and overall in Sage because of how we do our documentation, you probably want to do this for any docstring).\n\nAlso, you might want to use\n\n```diff\n-:meth:`sage.categories.finite_complex_reflection_groups.coxeter_elements`\n+:meth:`~sage.categories.finite_complex_reflection_groups.coxeter_elements`\n```\n",
    "created_at": "2017-06-14T13:43:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321819",
    "user": "@tscrim"
}
```

It looks okay overall, but you might be getting problems with latex and `\p` being converted by Python as an escaped character. Anytime I put any latex in a docstring, I make sure it is raw, so it starts `r"""` (or a single line `r"`) (and overall in Sage because of how we do our documentation, you probably want to do this for any docstring).

Also, you might want to use

```diff
-:meth:`sage.categories.finite_complex_reflection_groups.coxeter_elements`
+:meth:`~sage.categories.finite_complex_reflection_groups.coxeter_elements`
```




---

archive/issue_comments_321820.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2017-06-14T13:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321820",
    "user": "git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_321821.json:
```json
{
    "body": "IIRC, there was another method that added an ``e^{2\\pi i/h}`` that was not marked raw.",
    "created_at": "2017-06-14T13:49:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321821",
    "user": "@tscrim"
}
```

IIRC, there was another method that added an ``e^{2\pi i/h}`` that was not marked raw.



---

archive/issue_comments_321822.json:
```json
{
    "body": "It may be worth pointing out that for a general Coxeter group, the \"standard Coxeter elements\" (ie, product of all simple reflections in some order) are only guaranteed to be conjugate if the Coxeter diagram is acyclic. This will of course be true for the finite case we're considering here, but notably, it doesn't extend to type A affine.\n----\nNew commits:",
    "created_at": "2017-06-14T13:54:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321822",
    "user": "@kevindilks"
}
```

It may be worth pointing out that for a general Coxeter group, the "standard Coxeter elements" (ie, product of all simple reflections in some order) are only guaranteed to be conjugate if the Coxeter diagram is acyclic. This will of course be true for the finite case we're considering here, but notably, it doesn't extend to type A affine.
----
New commits:



---

archive/issue_comments_321823.json:
```json
{
    "body": "Replying to [comment:23 tscrim]:\n> IIRC, there was another method that added an ``e^{2\\pi i/h}`` that was not marked raw.\n\nsorry, I don't find it.",
    "created_at": "2017-06-14T17:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321823",
    "user": "stumpc5"
}
```

Replying to [comment:23 tscrim]:
> IIRC, there was another method that added an ``e^{2\pi i/h}`` that was not marked raw.

sorry, I don't find it.



---

archive/issue_comments_321824.json:
```json
{
    "body": "as far as I can tell, it already has the `r\"\"\"` mark.",
    "created_at": "2017-06-14T19:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321824",
    "user": "@fchapoton"
}
```

as far as I can tell, it already has the `r"""` mark.



---

archive/issue_comments_321825.json:
```json
{
    "body": "bot is green (but does not check the pdf build)",
    "created_at": "2017-06-15T07:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321825",
    "user": "@fchapoton"
}
```

bot is green (but does not check the pdf build)



---

archive/issue_comments_321826.json:
```json
{
    "body": "Replying to [comment:27 chapoton]:\n> bot is green (but does not check the pdf build)\n\nI cannot build the doc for reasons I don't want to investigate - from my side the ticket is good to go, so `@`Travis, please give it a positive review if you agree!",
    "created_at": "2017-06-15T07:07:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321826",
    "user": "stumpc5"
}
```

Replying to [comment:27 chapoton]:
> bot is green (but does not check the pdf build)

I cannot build the doc for reasons I don't want to investigate - from my side the ticket is good to go, so `@`Travis, please give it a positive review if you agree!



---

archive/issue_comments_321827.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-06-15T08:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321827",
    "user": "@tscrim"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_321828.json:
```json
{
    "body": "Ah, sorry, I must have misread it. Good to go.",
    "created_at": "2017-06-15T08:13:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321828",
    "user": "@tscrim"
}
```

Ah, sorry, I must have misread it. Good to go.



---

archive/issue_comments_321829.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-06-15T23:09:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/22993",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/22993#issuecomment-321829",
    "user": "@vbraun"
}
```

Resolution: fixed
