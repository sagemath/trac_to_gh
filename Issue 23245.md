# Issue 23245: Identities are injective and surjective

archive/issues_023245.json:
```json
{
    "body": "\n\nIssue created by migration from https://trac.sagemath.org/ticket/23482\n\n",
    "created_at": "2017-07-19T23:29:56Z",
    "labels": [
        "coercion",
        "trivial",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.1",
    "title": "Identities are injective and surjective",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/23245",
    "user": "saraedum"
}
```


Issue created by migration from https://trac.sagemath.org/ticket/23482





---

archive/issue_comments_325145.json:
```json
{
    "body": "New commits:",
    "created_at": "2017-07-19T23:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325145",
    "user": "saraedum"
}
```

New commits:



---

archive/issue_comments_325146.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2017-07-19T23:30:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325146",
    "user": "saraedum"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_325147.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd87\".",
    "created_at": "2017-07-19T23:38:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325147",
    "user": "saraedum"
}
```

Changing keywords from "" to "sd87".



---

archive/issue_comments_325148.json:
```json
{
    "body": "Changing keywords from \"sd87\" to \"sd87, beginner\".",
    "created_at": "2017-07-19T23:41:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325148",
    "user": "saraedum"
}
```

Changing keywords from "sd87" to "sd87, beginner".



---

archive/issue_comments_325149.json:
```json
{
    "body": "I checked out the ticket branch, ran `./sage -ba` to rebuild all of Sage including all the Cython, and ran `./sage -tp 2 --long src/sage/categories/morphism.pyx` to run the relevant doctests. However, one doctest failed, as the output below shows:\n\n\n```bash\nbash-3.2$ ./sage -tp 2 --long src/sage/categories/morphism.pyx\ntoo few successful tests, not using stored timings\nRunning doctests with ID 2017-07-20-13-16-59-0bd01dfc.\nGit branch: ticket_23482\nUsing --optional=mpir,python2,sage\nDoctesting 1 file using 2 threads.\nsage -t --long src/sage/categories/morphism.pyx\n**********************************************************************\nFile \"src/sage/categories/morphism.pyx\", line 429, in sage.categories.morphism.IdentityMorphism.is_surjective\nFailed example:\n    ZZ.hom(ZZ).is_surjective()\nException raised:\n    Traceback (most recent call last):\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 509, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 872, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.categories.morphism.IdentityMorphism.is_surjective[0]>\", line 1, in <module>\n        ZZ.hom(ZZ).is_surjective()\n      File \"sage/categories/map.pyx\", line 1204, in sage.categories.map.Map.is_surjective (/Sage/sage/src/build/cythonized/sage/categories/map.c:9227)\n        raise NotImplementedError(type(self))\n    NotImplementedError: <type 'sage.rings.morphism.RingHomomorphism_coercion'>\n**********************************************************************\n1 item had failures:\n   1 of   2 in sage.categories.morphism.IdentityMorphism.is_surjective\n    [105 tests, 1 failure, 0.67 s]\n----------------------------------------------------------------------\nsage -t --long src/sage/categories/morphism.pyx  # 1 doctest failed\n----------------------------------------------------------------------\nTotal time for all tests: 0.7 seconds\n    cpu time: 0.7 seconds\n    cumulative wall time: 0.7 seconds\n```\n\n\nIt seems like this failure is coming from the fact that the objects used in the doctests rely on `RingHomomorphism_coercion`, whose removal and replacement was proposed in [ticket:23204 #23204] but which this ticket isn't listed as being dependent on.\n\nI am not sure what the owner of this ticket would prefer to do at this point.",
    "created_at": "2017-07-20T18:03:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325149",
    "user": "cmt"
}
```

I checked out the ticket branch, ran `./sage -ba` to rebuild all of Sage including all the Cython, and ran `./sage -tp 2 --long src/sage/categories/morphism.pyx` to run the relevant doctests. However, one doctest failed, as the output below shows:


```bash
bash-3.2$ ./sage -tp 2 --long src/sage/categories/morphism.pyx
too few successful tests, not using stored timings
Running doctests with ID 2017-07-20-13-16-59-0bd01dfc.
Git branch: ticket_23482
Using --optional=mpir,python2,sage
Doctesting 1 file using 2 threads.
sage -t --long src/sage/categories/morphism.pyx
**********************************************************************
File "src/sage/categories/morphism.pyx", line 429, in sage.categories.morphism.IdentityMorphism.is_surjective
Failed example:
    ZZ.hom(ZZ).is_surjective()
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.morphism.IdentityMorphism.is_surjective[0]>", line 1, in <module>
        ZZ.hom(ZZ).is_surjective()
      File "sage/categories/map.pyx", line 1204, in sage.categories.map.Map.is_surjective (/Sage/sage/src/build/cythonized/sage/categories/map.c:9227)
        raise NotImplementedError(type(self))
    NotImplementedError: <type 'sage.rings.morphism.RingHomomorphism_coercion'>
**********************************************************************
1 item had failures:
   1 of   2 in sage.categories.morphism.IdentityMorphism.is_surjective
    [105 tests, 1 failure, 0.67 s]
----------------------------------------------------------------------
sage -t --long src/sage/categories/morphism.pyx  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 0.7 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
```


It seems like this failure is coming from the fact that the objects used in the doctests rely on `RingHomomorphism_coercion`, whose removal and replacement was proposed in [ticket:23204 #23204] but which this ticket isn't listed as being dependent on.

I am not sure what the owner of this ticket would prefer to do at this point.



---

archive/issue_comments_325150.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2017-07-20T18:06:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325150",
    "user": "cmt"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_325151.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2017-07-20T18:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325151",
    "user": "saraedum"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_325152.json:
```json
{
    "body": "You are absolutely right. Thanks for pointing this out.",
    "created_at": "2017-07-20T18:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325152",
    "user": "saraedum"
}
```

You are absolutely right. Thanks for pointing this out.



---

archive/issue_comments_325153.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-20T20:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325153",
    "user": "cmt"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_325154.json:
```json
{
    "body": "I reran `./sage -tp 2 --long src/sage/categories/morphism.pyx` and now it returned that all tests passed!",
    "created_at": "2017-07-20T20:17:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325154",
    "user": "cmt"
}
```

I reran `./sage -tp 2 --long src/sage/categories/morphism.pyx` and now it returned that all tests passed!



---

archive/issue_comments_325155.json:
```json
{
    "body": "Great :) Please add your real name in the \"Reviewer\" field.",
    "created_at": "2017-07-20T20:32:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325155",
    "user": "saraedum"
}
```

Great :) Please add your real name in the "Reviewer" field.



---

archive/issue_comments_325156.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2017-07-20T23:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325156",
    "user": "tscrim"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_325157.json:
```json
{
    "body": "Setting to needs work because missing reviewer name.\n\nHowever, I think this should be done independently of #23204, which just means writing a little smarter doctest:\n\n```\nsage: Hom(QQ, QQ).identity()\nIdentity endomorphism of Rational Field\n```\n",
    "created_at": "2017-07-20T23:16:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325157",
    "user": "tscrim"
}
```

Setting to needs work because missing reviewer name.

However, I think this should be done independently of #23204, which just means writing a little smarter doctest:

```
sage: Hom(QQ, QQ).identity()
Identity endomorphism of Rational Field
```




---

archive/issue_comments_325158.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2017-07-21T01:10:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325158",
    "user": "saraedum"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_325159.json:
```json
{
    "body": "Changing priority from trivial to minor.",
    "created_at": "2017-07-21T22:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325159",
    "user": "tscrim"
}
```

Changing priority from trivial to minor.



---

archive/issue_comments_325160.json:
```json
{
    "body": "Changing status from positive_review to needs_review.",
    "created_at": "2017-07-21T22:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325160",
    "user": "tscrim"
}
```

Changing status from positive_review to needs_review.



---

archive/issue_comments_325161.json:
```json
{
    "body": "Changing component from coercion to algebra.",
    "created_at": "2017-07-21T22:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325161",
    "user": "tscrim"
}
```

Changing component from coercion to algebra.



---

archive/issue_comments_325162.json:
```json
{
    "body": "Thinking more about this, it really is a good idea to not depend on #23204 and do a doctest that is a little more robust. My changes should be easy to review.\n----\nNew commits:",
    "created_at": "2017-07-21T22:22:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325162",
    "user": "tscrim"
}
```

Thinking more about this, it really is a good idea to not depend on #23204 and do a doctest that is a little more robust. My changes should be easy to review.
----
New commits:



---

archive/issue_comments_325163.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2017-07-22T02:14:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325163",
    "user": "saraedum"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_325164.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2017-08-05T23:27:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/23245",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/23245#issuecomment-325164",
    "user": "vbraun"
}
```

Resolution: fixed
