# Issue 23245: Identities are injective and surjective

Issue created by migration from https://trac.sagemath.org/ticket/23482

Original creator: saraedum

Original creation time: 2017-07-19 23:29:56




---

Comment by saraedum created at 2017-07-19 23:30:39

New commits:


---

Comment by saraedum created at 2017-07-19 23:30:39

Changing status from new to needs_review.


---

Comment by saraedum created at 2017-07-19 23:38:34

Changing keywords from "" to "sd87".


---

Comment by saraedum created at 2017-07-19 23:41:33

Changing keywords from "sd87" to "sd87, beginner".


---

Comment by cmt created at 2017-07-20 18:03:40

I checked out the ticket branch, ran `./sage -ba` to rebuild all of Sage including all the Cython, and ran `./sage -tp 2 --long src/sage/categories/morphism.pyx` to run the relevant doctests. However, one doctest failed, as the output below shows:


```bash
bash-3.2$ ./sage -tp 2 --long src/sage/categories/morphism.pyx
too few successful tests, not using stored timings
Running doctests with ID 2017-07-20-13-16-59-0bd01dfc.
Git branch: ticket_23482
Using --optional=mpir,python2,sage
Doctesting 1 file using 2 threads.
sage -t --long src/sage/categories/morphism.pyx
**********************************************************************
File "src/sage/categories/morphism.pyx", line 429, in sage.categories.morphism.IdentityMorphism.is_surjective
Failed example:
    ZZ.hom(ZZ).is_surjective()
Exception raised:
    Traceback (most recent call last):
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 509, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Sage/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 872, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.categories.morphism.IdentityMorphism.is_surjective[0]>", line 1, in <module>
        ZZ.hom(ZZ).is_surjective()
      File "sage/categories/map.pyx", line 1204, in sage.categories.map.Map.is_surjective (/Sage/sage/src/build/cythonized/sage/categories/map.c:9227)
        raise NotImplementedError(type(self))
    NotImplementedError: <type 'sage.rings.morphism.RingHomomorphism_coercion'>
**********************************************************************
1 item had failures:
   1 of   2 in sage.categories.morphism.IdentityMorphism.is_surjective
    [105 tests, 1 failure, 0.67 s]
----------------------------------------------------------------------
sage -t --long src/sage/categories/morphism.pyx  # 1 doctest failed
----------------------------------------------------------------------
Total time for all tests: 0.7 seconds
    cpu time: 0.7 seconds
    cumulative wall time: 0.7 seconds
```


It seems like this failure is coming from the fact that the objects used in the doctests rely on `RingHomomorphism_coercion`, whose removal and replacement was proposed in [ticket:23204 #23204] but which this ticket isn't listed as being dependent on.

I am not sure what the owner of this ticket would prefer to do at this point.


---

Comment by cmt created at 2017-07-20 18:06:27

Changing status from needs_review to needs_work.


---

Comment by saraedum created at 2017-07-20 18:52:15

Changing status from needs_work to needs_review.


---

Comment by saraedum created at 2017-07-20 18:52:15

You are absolutely right. Thanks for pointing this out.


---

Comment by cmt created at 2017-07-20 20:17:18

Changing status from needs_review to positive_review.


---

Comment by cmt created at 2017-07-20 20:17:18

I reran `./sage -tp 2 --long src/sage/categories/morphism.pyx` and now it returned that all tests passed!


---

Comment by saraedum created at 2017-07-20 20:32:27

Great :) Please add your real name in the "Reviewer" field.


---

Comment by tscrim created at 2017-07-20 23:16:05

Changing status from positive_review to needs_work.


---

Comment by tscrim created at 2017-07-20 23:16:05

Setting to needs work because missing reviewer name.

However, I think this should be done independently of #23204, which just means writing a little smarter doctest:

```
sage: Hom(QQ, QQ).identity()
Identity endomorphism of Rational Field
```



---

Comment by saraedum created at 2017-07-21 01:10:50

Changing status from needs_work to positive_review.


---

Comment by tscrim created at 2017-07-21 22:22:48

Changing priority from trivial to minor.


---

Comment by tscrim created at 2017-07-21 22:22:48

Changing status from positive_review to needs_review.


---

Comment by tscrim created at 2017-07-21 22:22:48

Changing component from coercion to algebra.


---

Comment by tscrim created at 2017-07-21 22:22:48

Thinking more about this, it really is a good idea to not depend on #23204 and do a doctest that is a little more robust. My changes should be easy to review.
----
New commits:


---

Comment by saraedum created at 2017-07-22 02:14:45

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2017-08-05 23:27:27

Resolution: fixed
