# Issue 28310: Remove hardcoded mathjax path in docs/conf.py

Issue created by migration from https://trac.sagemath.org/ticket/28547

Original creator: arojas

Original creation time: 2019-10-01 15:58:46

CC:  @timokau saraedum fbissey




---

Comment by arojas created at 2019-10-01 16:47:54

Changing type from PLEASE CHANGE to enhancement.


---

Comment by arojas created at 2019-10-01 16:47:54

Changing component from PLEASE CHANGE to documentation.


---

Comment by arojas created at 2019-10-01 16:47:54

Changing status from new to needs_review.


---

Comment by arojas created at 2019-10-01 16:47:54

New commits:


---

Comment by fbissey created at 2019-10-01 19:34:59

I'd like something slightly different probably because I painted myself in that corner years ago :)

In sage-on-gentoo SAGE_SHARE is `/usr/share/sage`, that is proper sage only object in share. It is not just /usr/share. I don't want those

```
fbissey@moonloop ~ $ ll /usr/share/sage
total 48K
drwxr-xr-x  10 root root 4.0K Mar 31  2019 .
drwxr-xr-x 321 root root  12K Sep 22 09:54 ..
drwxr-xr-x   2 root root 4.0K Aug 28  2018 combinatorial_designs
drwxr-xr-x   2 root root 4.0K Aug 28  2018 conway_polynomials
drwxr-xr-x   2 root root 4.0K Aug 28  2018 cremona
drwxr-xr-x   2 root root 4.0K Aug 28  2018 ellcurves
drwxr-xr-x  15 root root 4.0K Mar 31  2019 ext
drwxr-xr-x   2 root root 4.0K Aug 28  2018 graphs
drwxr-xr-x   4 root root 4.0K Aug 28  2018 reflexive_polytopes
drwxr-xr-x   4 root root 4.0K Jun 28 11:17 threejs
```

directly in `/usr/share` especially with generic names like `ext` and `graphs`. But vanilla sage is expecting `SAGE_LOCAL/share` which leads to some intense patching in `env.py`. The point here is that I have 

```
mathjax_relative = '../mathjax'
```

in sage-on-gentoo not plain `mathjax`. I would favor `os.path.relpath(MATHJAX_DIR,SAGE_SHARE)`. which means that you also have to restore SAGE_SHARE in the `from sage.env`.


---

Comment by arojas created at 2019-10-01 19:50:20

The only use of mathjax_relative is in conf.py:269, when defining the list of files to exclude from source file search. And it is preceded by two asterisks, so it will match anything that ends in '/mathjax' (or whatever MATHJAX_DIR's basename is after applying this patch). So unless I'm missing something, this should still work fine in your setup, right?


---

Comment by fbissey created at 2019-10-01 20:27:32

Now that I am looking at the full consequences of your patch it should work as is yes. I never noticed those `**` before. I wonder when they were added. I will test things to make sure.


---

Comment by fbissey created at 2019-10-01 21:34:03

All good!


---

Comment by fbissey created at 2019-10-01 21:34:03

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-10-06 23:07:08

Resolution: fixed
