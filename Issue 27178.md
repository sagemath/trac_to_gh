# Issue 27178: py3: algebras/lie_algebras

Issue created by migration from https://trac.sagemath.org/ticket/27415

Original creator: jhpalmieri

Original creation time: 2019-03-04 05:46:46

Fix py3 doctests in `lie_algebras`. Together with #27414, this should fix all of the doctests in `algebras`.


---

Comment by jhpalmieri created at 2019-03-04 05:48:12

New commits:


---

Comment by jhpalmieri created at 2019-03-04 05:48:12

Changing status from new to needs_review.


---

Comment by git created at 2019-03-04 05:50:38

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by tscrim created at 2019-03-04 06:46:22

I don't understand why you create the `_sorting_key` attribute? Why not just use `_basis_key` (which is guaranteed to exist from the category)? Nice catch on that bug in `_bracket_`, which then with using `_basis_key` would become

```diff
-if key_ml < key_mr:
+if self._basis_key(key_ml) < self._basis_key(key_mr):
```



---

Comment by jhpalmieri created at 2019-03-04 17:20:09

If I use `_basis_key`, I get this:

```
sage: d = lie_algebras.VirasoroAlgebra(QQ)
sage: d._basis_key(3)
3
sage: d._basis_key('c')
'c'
```

As a result, sorting doesn't work between them in Python 3. The `_sorting_key` attribute as I've defined it uses the _function_ `_basis_key` in that file, which converts `c` to `+Infinity`.


---

Comment by jhpalmieri created at 2019-03-04 17:21:41

I could instead add a new `_basis_key` method:

```
    def _basis_key(self, m):
        return _basis_key(m)
```



---

Comment by git created at 2019-03-04 18:53:56

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by jhpalmieri created at 2019-03-04 18:54:49

The code in `categories/lie_algebras_with_basis.py` already uses `self._basis_key(...)`, so I added a `_basis_key` method for the Virasoro algebra.


---

Comment by jhpalmieri created at 2019-03-04 18:56:09

Changing type from PLEASE CHANGE to defect.


---

Comment by tscrim created at 2019-03-04 21:44:39

I think this is a much better solution. Thank you.


---

Comment by tscrim created at 2019-03-04 21:44:39

Changing status from needs_review to positive_review.


---

Comment by jhpalmieri created at 2019-03-04 21:56:52

I agree, thanks for the suggestion.


---

Comment by vbraun created at 2019-03-05 23:11:04

Resolution: fixed
