# Issue 20072: Expose PARI code for Frobenius matrix on hyperelliptic curves

Issue created by migration from https://trac.sagemath.org/ticket/20309

Original creator: kedlaya

Original creation time: 2016-03-27 20:28:18

CC:  tornaria edgarcosta

Keywords: hyperelliptic curve, matrix of Frobenius

PARI provides a method `hyperellpadicfrobenius` for computing the matrix of Frobenius on p-adic cohomology of a hyperelliptic curve over a prime field, and another method `nfhyperellpadicfrobenius` for doing so over a nonprime field. We don't currently provide any alternative for the latter, so I propose to expose the PARI code as a method of `HyperellipticCurve`. See #18916 for more discussion.


---

Comment by jdemeyer created at 2016-03-29 09:49:41

Do you know why GP does not have `nfhyperellpadicfrobenius`? If PARI/GP doesn't expose it, I'm doubting whether Sage should.


---

Comment by kedlaya created at 2016-03-29 22:52:32

According to an email from Bill Allombert:

```
Mostly, the reason I did not make nfhyperellpadicfrobenius() 
public in the first place was that I was not sure what to write in
the documentation that would tell users what it is good for and how
to use it.
```

However, there do exist some use cases where it is relevant; I'll try to put together a coherent post describing these.


---

Comment by jpflori created at 2016-04-05 16:39:10

Replying to [comment:2 kedlaya]:
> According to an email from Bill Allombert:
> {{{
> Mostly, the reason I did not make nfhyperellpadicfrobenius() 
> public in the first place was that I was not sure what to write in
> the documentation that would tell users what it is good for and how
> to use it.
> }}}
> However, there do exist some use cases where it is relevant; I'll try to put together a coherent post describing these.
On top of what you said here: http://trac.sagemath.org/ticket/18916#comment:16
a use case for getting the matrix rather than the charpoly is to compute number of points on the curve faster by using less precision than need for the charpoly.
That's already implemented that way in Sage.


---

Comment by roed created at 2017-07-17 17:42:31

Changing keywords from "hyperelliptic curve, matrix of Frobenius" to "hyperelliptic curve, matrix of Frobenius, sd87".


---

Comment by mmasdeu created at 2017-07-20 00:40:07

Changing status from new to needs_review.


---

Comment by mmasdeu created at 2017-07-20 00:40:07

The code seems to work. The documentation does not build but we believe that it's not our fault (it seems to complain about plot3d, which this patch does not touch).


---

Comment by mmasdeu created at 2017-07-20 00:44:41

New commits:


---

Comment by vdelecroix created at 2017-07-20 15:13:29

What is the point of your function `hyperellpadicfrobenius`!? It is already exposed in cypari

```
sage: x = polygen(QQ)
sage: pari(4*x^5 - 92*x^3 + 72*x^2 + 160*x).hyperellpadicfrobenius(13, 20)
[3*13^2 + 6*13^3 + 3*13^4 + 8*13^5 + 12*13^6 + 7*13^7 + 4*13^8 + 2*13^9 + 10*13^10 + 10*13^11 + 4*13^12 + 12*13^13 + 11*13^14 + 11*13^15 + 4*13^16 + 8*13^17 + 11*13^18 + 9*13^19 + O(13^20), 11*13 + 7*13^2 + 8*13^3 + 12*13^5 + 8*13^6 + 12*13^7 + 3*13^8 + 2*13^9 + 5*13^10 + 2*13^12 + 9*13^13 + 10*13^14 + 8*13^15 + 8*13^16 + 3*13^17 + 6*13^18 + 7*13^19 + O(13^20), 2 + 6*13 + 11*13^2 + 8*13^3 + 13^4 + 9*13^5 + 9*13^6 + 11*13^7 + 8*13^8 + 9*13^9 + 5*13^10 + 4*13^11 + 10*13^12 + 5*13^13 + 12*13^14 + 11*13^15 + 3*13^16 + 13^17 + 6*13^18 + 11*13^19 + O(13^20), 10 + 10*13^2 + 3*13^3 + 8*13^4 + 13^5 + 4*13^7 + 6*13^8 + 5*13^9 + 9*13^10 + 7*13^11 + 6*13^12 + 13^13 + 2*13^14 + 9*13^15 + 8*13^16 + 7*13^17 + 4*13^18 + O(13^20); 5*13 + 3*13^2 + 3*13^3 + 12*13^4 + 13^5 + 12*13^6 + 12*13^7 + 2*13^8 + 10*13^9 + 3*13^10 + 10*13^11 + 5*13^12 + 3*13^13 + 13^14 + 12*13^15 + 3*13^16 + 13^18 + 12*13^19 + O(13^20), 4*13^2 + 3*13^3 + 11*13^4 + 6*13^5 + 2*13^6 + 8*13^7 + 11*13^8 + 6*13^9 + 8*13^10 + 11*13^11 + 8*13^12 + 6*13^13 + 6*13^14 + 4*13^15 + 10*13^17 + 8*13^18 + 10*13^19 + O(13^20), 8 + 12*13 + 7*13^2 + 13^3 + 4*13^4 + 2*13^5 + 4*13^6 + 10*13^7 + 2*13^8 + 4*13^9 + 7*13^10 + 7*13^11 + 12*13^12 + 5*13^13 + 10*13^14 + 9*13^15 + 13^16 + 8*13^17 + 2*13^18 + 10*13^19 + O(13^20), 6*13 + 9*13^2 + 9*13^4 + 10*13^5 + 4*13^6 + 12*13^7 + 10*13^9 + 5*13^10 + 7*13^11 + 4*13^12 + 10*13^13 + 8*13^14 + 2*13^15 + 2*13^16 + 7*13^17 + 10*13^18 + 5*13^19 + O(13^20); 9*13 + 7*13^2 + 11*13^3 + 10*13^4 + 4*13^5 + 9*13^6 + 13^7 + 3*13^8 + 10*13^9 + 4*13^10 + 7*13^12 + 8*13^13 + 7*13^14 + 4*13^15 + 9*13^16 + 10*13^17 + 8*13^18 + 3*13^19 + O(13^20), 4*13 + 6*13^2 + 3*13^3 + 11*13^4 + 5*13^5 + 7*13^6 + 6*13^7 + 9*13^8 + 10*13^9 + 13^10 + 9*13^11 + 5*13^12 + 10*13^13 + 11*13^14 + 6*13^15 + 7*13^16 + 7*13^17 + 9*13^18 + 11*13^19 + O(13^20), 4 + 6*13 + 3*13^2 + 8*13^3 + 8*13^4 + 9*13^6 + 11*13^7 + 4*13^8 + 8*13^9 + 6*13^10 + 2*13^11 + 6*13^12 + 8*13^13 + 6*13^14 + 13^15 + 11*13^16 + 9*13^17 + 4*13^18 + 13^19 + O(13^20), 10 + 9*13 + 9*13^2 + 8*13^3 + 10*13^4 + 6*13^5 + 12*13^7 + 8*13^8 + 11*13^9 + 10*13^10 + 10*13^11 + 11*13^12 + 9*13^13 + 11*13^14 + 12*13^15 + 7*13^16 + 9*13^17 + 5*13^18 + 12*13^19 + O(13^20); 11*13 + 10*13^2 + 11*13^3 + 4*13^4 + 11*13^5 + 9*13^6 + 8*13^7 + 9*13^8 + 3*13^9 + 7*13^10 + 12*13^11 + 8*13^12 + 4*13^13 + 13^14 + 13^15 + 11*13^16 + 7*13^17 + 5*13^18 + 12*13^19 + O(13^20), 11*13 + 11*13^3 + 5*13^4 + 12*13^5 + 13^6 + 13^7 + 12*13^8 + 5*13^9 + 12*13^10 + 7*13^11 + 10*13^12 + 5*13^13 + 5*13^14 + 9*13^15 + 7*13^16 + 8*13^17 + 10*13^18 + 13^19 + O(13^20), 11 + 6*13 + 7*13^2 + 9*13^3 + 13^4 + 5*13^5 + 12*13^6 + 13^7 + 10*13^8 + 12*13^9 + 2*13^10 + 13^11 + 8*13^13 + 8*13^14 + 11*13^15 + 5*13^16 + 9*13^17 + O(13^20), 5 + 6*13 + 2*13^2 + 8*13^3 + 2*13^4 + 10*13^5 + 13^6 + 11*13^7 + 4*13^8 + 8*13^9 + 13^11 + 6*13^12 + 11*13^13 + 8*13^15 + 9*13^16 + 10*13^17 + 4*13^19 + O(13^20)]
```


Though, `nfhyperellpadicfrobenius` is not... any idea why this function is not available in GP?


---

Comment by vdelecroix created at 2017-07-20 15:13:36

Changing status from needs_review to needs_work.


---

Comment by vdelecroix created at 2017-07-20 15:17:44

Replying to [comment:9 vdelecroix]:
> Though, `nfhyperellpadicfrobenius` is not... any idea why this function is not available in GP?

Oh I discovered [comment:3 comment:3]! It would be much better to provide a patch to PARI/GP for that purpose. In the mean time, you can provide a pull request to [cypari2](https://github.com/defeo/cypari2) (as was done by Rob Harron in [PR16](https://github.com/defeo/cypari2/pull/16)).


---

Comment by chapoton created at 2019-06-06 19:26:50

I have a made a rebased, squashed, and refreshed branch.
----
New commits:


---

Comment by embray created at 2019-06-14 14:50:27

Tickets still needing working or clarification should be moved to the next release milestone at the soonest (please feel free to revert if you think the ticket is close to being resolved).


---

Comment by kedlaya created at 2019-12-17 01:34:48

I just heard from the Pari team that there will be change in the next release that affects this ticket: the functionality of `nfhyperellpadicfrobenius` will be exposed by modifying the call syntax of `hyperellpadicfrobenius`. Once that happens, we should revisit the issue.


---

Comment by embray created at 2019-12-30 14:48:17

Ticket retargeted after milestone closed


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by mkoeppe created at 2021-07-19 00:44:56

Setting a new milestone for this ticket based on a cursory review.
