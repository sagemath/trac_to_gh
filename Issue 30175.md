# Issue 30175: Upgrade gf2x to 1.3

archive/issues_030175.json:
```json
{
    "body": "CC:  @slel @dimpase @zimmermann6\n\nhttps://prod-gitlab.inria.fr/gf2x/gf2x/-/releases\n\nIssue created by migration from https://trac.sagemath.org/ticket/30412\n\n",
    "created_at": "2020-08-21T00:36:28Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.2",
    "title": "Upgrade gf2x to 1.3",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/30175",
    "user": "https://github.com/mkoeppe"
}
```
CC:  @slel @dimpase @zimmermann6

https://prod-gitlab.inria.fr/gf2x/gf2x/-/releases

Issue created by migration from https://trac.sagemath.org/ticket/30412





---

archive/issue_comments_429594.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2020-08-21T10:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429594",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_429595.json:
```json
{
    "body": "Since `gf2x-1.3.0` does not provide a `configure` script anymore (only `configure.ac`) i called autotools (and removed touching files that was related to some patch that does not exist anymore). Tell me if it is the correct way to do.\n\nSelf-tests work well for me.\n----\nNew commits:",
    "created_at": "2020-08-21T10:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429595",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Since `gf2x-1.3.0` does not provide a `configure` script anymore (only `configure.ac`) i called autotools (and removed touching files that was related to some patch that does not exist anymore). Tell me if it is the correct way to do.

Self-tests work well for me.
----
New commits:



---

archive/issue_comments_429596.json:
```json
{
    "body": "Can't run autotools in `spkg-install`.",
    "created_at": "2020-08-21T14:25:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429596",
    "user": "https://github.com/mkoeppe"
}
```

Can't run autotools in `spkg-install`.



---

archive/issue_comments_429597.json:
```json
{
    "body": "If i do not add those lines, i got : \n\n\n```\n[gf2x-1.3.0] /opt/sagemath/sage-source/build/bin/sage-dist-helpers: line 165: ./configure: No such file or directory\n```\n\n\nSo, what is the good way ?",
    "created_at": "2020-08-21T14:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429597",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

If i do not add those lines, i got : 


```
[gf2x-1.3.0] /opt/sagemath/sage-source/build/bin/sage-dist-helpers: line 165: ./configure: No such file or directory
```


So, what is the good way ?



---

archive/issue_comments_429598.json:
```json
{
    "body": "one needs to prepare a tarball (or a patch) with all the stuff produced by `autoreconf -ivf` or something like this.",
    "created_at": "2020-08-21T14:52:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429598",
    "user": "https://github.com/dimpase"
}
```

one needs to prepare a tarball (or a patch) with all the stuff produced by `autoreconf -ivf` or something like this.



---

archive/issue_comments_429599.json:
```json
{
    "body": "That's right. See https://doc.sagemath.org/html/en/developer/packaging.html#when-to-patch-when-to-repackage-when-to-autoconfiscate -- it falls in the case as \"If you have to make changes to configure.ac or other source files of the autotools build system...\"\n\nIt's an unfortunate trend that upstream maintainers don't prepare actual release tarballs any more...\n\nAfter the autoreconf as suggested by Dima, run `./configure && make distcheck`.\n\nPut these instructions into an `spkg-src` script.\nThe tarball can be put as an attachment on the ticket.",
    "created_at": "2020-08-21T15:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429599",
    "user": "https://github.com/mkoeppe"
}
```

That's right. See https://doc.sagemath.org/html/en/developer/packaging.html#when-to-patch-when-to-repackage-when-to-autoconfiscate -- it falls in the case as "If you have to make changes to configure.ac or other source files of the autotools build system..."

It's an unfortunate trend that upstream maintainers don't prepare actual release tarballs any more...

After the autoreconf as suggested by Dima, run `./configure && make distcheck`.

Put these instructions into an `spkg-src` script.
The tarball can be put as an attachment on the ticket.



---

archive/issue_comments_429600.json:
```json
{
    "body": "I'll try to ping gf2x people on this - but first one needs to get an account on the INRIA [GitLab](GitLab) server (I just asked for one).\n\nBy the way, did you check that none of the tarballs/zipfiles they offer contains `./configure` ?",
    "created_at": "2020-08-22T11:21:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429600",
    "user": "https://github.com/dimpase"
}
```

I'll try to ping gf2x people on this - but first one needs to get an account on the INRIA [GitLab](GitLab) server (I just asked for one).

By the way, did you check that none of the tarballs/zipfiles they offer contains `./configure` ?



---

archive/issue_comments_429601.json:
```json
{
    "body": "Replying to [comment:7 dimpase]:\n> I'll try to ping gf2x people on this - but first one needs to get an account on the INRIA [GitLab](GitLab) server (I just asked for one).\n\nI am about to do the same (by direct email). For me, they forgot to produce the file since the `README` still speaks about running `./configure`.\n \n> By the way, did you check that none of the tarballs/zipfiles they offer contains `./configure` ? \n\nNo. I will do that in case.",
    "created_at": "2020-08-22T12:29:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429601",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Replying to [comment:7 dimpase]:
> I'll try to ping gf2x people on this - but first one needs to get an account on the INRIA [GitLab](GitLab) server (I just asked for one).

I am about to do the same (by direct email). For me, they forgot to produce the file since the `README` still speaks about running `./configure`.
 
> By the way, did you check that none of the tarballs/zipfiles they offer contains `./configure` ? 

No. I will do that in case.



---

archive/issue_comments_429602.json:
```json
{
    "body": "Replying to [comment:8 tmonteil]:\n> Replying to [comment:7 dimpase]:\n> > By the way, did you check that none of the tarballs/zipfiles they offer contains `./configure` ? \n> \n> No. I will do that in case.\n\nNone of the archives contain a `configure` script.",
    "created_at": "2020-08-22T12:32:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429602",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Replying to [comment:8 tmonteil]:
> Replying to [comment:7 dimpase]:
> > By the way, did you check that none of the tarballs/zipfiles they offer contains `./configure` ? 
> 
> No. I will do that in case.

None of the archives contain a `configure` script.



---

archive/issue_comments_429603.json:
```json
{
    "body": "I sent an email to Emmanuel Thom\u00e9 and Paul Zimmermann (also Cc-ed on the ticket). I would prefer to ship an upstream traball than an ad-hoc one.",
    "created_at": "2020-08-22T13:50:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429603",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

I sent an email to Emmanuel ThomÃ© and Paul Zimmermann (also Cc-ed on the ticket). I would prefer to ship an upstream traball than an ad-hoc one.



---

archive/issue_comments_429604.json:
```json
{
    "body": "thanks for the heads up.\n\nyes of course you're right.\n\nwhen ditching gforge in favor of gitlab a few weeks ago, I accidentally forgot the implication that the tarballs that are attached to git tags no longer contain the autotools-generated configure scripts.\n\nI'll try to fix that (and first, find out what is \"the right way\" to do it).\n\nAs regards the sponsorship wall on the inria gitlab account, this has recently been forced on us, and I have only limited hope that we can do something about it. I'm not at all confident that I have the right to create \"normal\" invitee accounts :-(. All I can do is hope that the sponsorship maze that they have invented is at least possible to work out if you have the will to try (and as for me, I'm 100% fine with ticking yes for anyone who wants to contribute to issue trackers)",
    "created_at": "2020-08-22T17:10:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429604",
    "user": "https://github.com/emmanuelthome"
}
```

thanks for the heads up.

yes of course you're right.

when ditching gforge in favor of gitlab a few weeks ago, I accidentally forgot the implication that the tarballs that are attached to git tags no longer contain the autotools-generated configure scripts.

I'll try to fix that (and first, find out what is "the right way" to do it).

As regards the sponsorship wall on the inria gitlab account, this has recently been forced on us, and I have only limited hope that we can do something about it. I'm not at all confident that I have the right to create "normal" invitee accounts :-(. All I can do is hope that the sponsorship maze that they have invented is at least possible to work out if you have the will to try (and as for me, I'm 100% fine with ticking yes for anyone who wants to contribute to issue trackers)



---

archive/issue_comments_429605.json:
```json
{
    "body": "Replying to [comment:11 thome]:\n> thanks for the heads up.\n> \n> yes of course you're right.\n> \n> when ditching gforge in favor of gitlab a few weeks ago, I accidentally forgot the implication that the tarballs that are attached to git tags no longer contain the autotools-generated configure scripts.\n> \n> I'll try to fix that (and first, find out what is \"the right way\" to do it).\n\nunlike [GitHub](GitHub), gitlab does not seem to allow attaching binary blobs to releases, only links can be added.\nThus you can create a tarball and post it somewhere. E.g. clone the gitlab repo to a public [GitHub](GitHub), and post the tarball there in a release.\nThen you could make a link to it in [GitLab](GitLab).\nOr just put it somewhere else on the web.\n\n\n> \n> As regards the sponsorship wall on the inria gitlab account, this has recently been forced on us, and I have only limited hope that we can do something about it. I'm not at all confident that I have the right to create \"normal\" invitee accounts :-(. All I can do is hope that the sponsorship maze that they have invented is at least possible to work out if you have the will to try (and as for me, I'm 100% fine with ticking yes for anyone who wants to contribute to issue trackers)\n\nThis is ludicrous (good luck explaining to your bosses that it goes against the whole concept of open source...). Why couldn't you host a de facto main repo somewhere that allows the public to comment, provide patches/pull requests, etc?",
    "created_at": "2020-08-23T10:44:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429605",
    "user": "https://github.com/dimpase"
}
```

Replying to [comment:11 thome]:
> thanks for the heads up.
> 
> yes of course you're right.
> 
> when ditching gforge in favor of gitlab a few weeks ago, I accidentally forgot the implication that the tarballs that are attached to git tags no longer contain the autotools-generated configure scripts.
> 
> I'll try to fix that (and first, find out what is "the right way" to do it).

unlike [GitHub](GitHub), gitlab does not seem to allow attaching binary blobs to releases, only links can be added.
Thus you can create a tarball and post it somewhere. E.g. clone the gitlab repo to a public [GitHub](GitHub), and post the tarball there in a release.
Then you could make a link to it in [GitLab](GitLab).
Or just put it somewhere else on the web.


> 
> As regards the sponsorship wall on the inria gitlab account, this has recently been forced on us, and I have only limited hope that we can do something about it. I'm not at all confident that I have the right to create "normal" invitee accounts :-(. All I can do is hope that the sponsorship maze that they have invented is at least possible to work out if you have the will to try (and as for me, I'm 100% fine with ticking yes for anyone who wants to contribute to issue trackers)

This is ludicrous (good luck explaining to your bosses that it goes against the whole concept of open source...). Why couldn't you host a de facto main repo somewhere that allows the public to comment, provide patches/pull requests, etc?



---

archive/issue_comments_429606.json:
```json
{
    "body": "Replying to [comment:12 dimpase]:\n> unlike [GitHub](GitHub), gitlab does not seem to allow attaching binary blobs to releases, only links can be added.\n> Thus you can create a tarball and post it somewhere. E.g. clone the gitlab repo to a public [GitHub](GitHub), and post the tarball there in a release.\n> Then you could make a link to it in [GitLab](GitLab).\n> Or just put it somewhere else on the web.\n\nAs a matter of fact, you can add file attachments to the release notes. While this is a manual process that has some some obvious shortcomings, it will do for the time being. I searched a bit for a process that would ship a \"make dist\"-generated tarball as part of gitlab's ci/cd pipelines, but that does not seem to be possible as of now. Maybe in the future.\n\nFor the time being, I did just that, and attached tar.gz for the existing releases (exactly the same tarballs as the ones that used to exist on gforge).\n\nI'm not entirely satisfied, and at this point the url to download these files is too long. Hopefully I'll figure out a way to do that better. But the tar.gz files themselves won't change.",
    "created_at": "2020-08-23T13:09:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429606",
    "user": "https://github.com/emmanuelthome"
}
```

Replying to [comment:12 dimpase]:
> unlike [GitHub](GitHub), gitlab does not seem to allow attaching binary blobs to releases, only links can be added.
> Thus you can create a tarball and post it somewhere. E.g. clone the gitlab repo to a public [GitHub](GitHub), and post the tarball there in a release.
> Then you could make a link to it in [GitLab](GitLab).
> Or just put it somewhere else on the web.

As a matter of fact, you can add file attachments to the release notes. While this is a manual process that has some some obvious shortcomings, it will do for the time being. I searched a bit for a process that would ship a "make dist"-generated tarball as part of gitlab's ci/cd pipelines, but that does not seem to be possible as of now. Maybe in the future.

For the time being, I did just that, and attached tar.gz for the existing releases (exactly the same tarballs as the ones that used to exist on gforge).

I'm not entirely satisfied, and at this point the url to download these files is too long. Hopefully I'll figure out a way to do that better. But the tar.gz files themselves won't change.



---

archive/issue_comments_429607.json:
```json
{
    "body": "Replying to [comment:13 thome]:\n> I'm not entirely satisfied, and at this point the url to download these files is too long. Hopefully I'll figure out a way to do that better. But the tar.gz files themselves won't change.\n\nNot sure if that's what you are looking for but if you create these tar.gz files during one of the [GitLab](GitLab) CI steps and treat them as build artifacts, they automatically get a reasonable public URL. Here's for a example a log file that is created during the build-from-clean step of the [GitLab](GitLab) CI that [SageMath](SageMath) is using:\n\nhttps://gitlab.com/sagemath/sage/builds/artifacts/9.2.beta3/file/gitlab-build-docker.log?job=build-from-clean",
    "created_at": "2020-08-23T13:52:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429607",
    "user": "https://github.com/saraedum"
}
```

Replying to [comment:13 thome]:
> I'm not entirely satisfied, and at this point the url to download these files is too long. Hopefully I'll figure out a way to do that better. But the tar.gz files themselves won't change.

Not sure if that's what you are looking for but if you create these tar.gz files during one of the [GitLab](GitLab) CI steps and treat them as build artifacts, they automatically get a reasonable public URL. Here's for a example a log file that is created during the build-from-clean step of the [GitLab](GitLab) CI that [SageMath](SageMath) is using:

https://gitlab.com/sagemath/sage/builds/artifacts/9.2.beta3/file/gitlab-build-docker.log?job=build-from-clean



---

archive/issue_comments_429608.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-23T16:56:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429608",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429609.json:
```json
{
    "body": "Thanks for providing an antotoolized tarball. I updated the branch (needs review).",
    "created_at": "2020-08-23T17:01:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429609",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Thanks for providing an antotoolized tarball. I updated the branch (needs review).



---

archive/issue_comments_429610.json:
```json
{
    "body": "please update `upstream_url:` to point to the correct tarball",
    "created_at": "2020-08-23T17:31:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429610",
    "user": "https://github.com/dimpase"
}
```

please update `upstream_url:` to point to the correct tarball



---

archive/issue_comments_429611.json:
```json
{
    "body": "Note: the url starts with `prod-gitlab` but starting with\nthe simpler `gitlab` without `prod-` seems to work too.",
    "created_at": "2020-08-23T19:01:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429611",
    "user": "https://github.com/slel"
}
```

Note: the url starts with `prod-gitlab` but starting with
the simpler `gitlab` without `prod-` seems to work too.



---

archive/issue_comments_429612.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-08-23T21:20:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429612",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_429613.json:
```json
{
    "body": "Done, i was thinking the generic URL is useful when updating for next release.",
    "created_at": "2020-08-23T22:20:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429613",
    "user": "https://trac.sagemath.org/admin/accounts/users/tmonteil"
}
```

Done, i was thinking the generic URL is useful when updating for next release.



---

archive/issue_comments_429614.json:
```json
{
    "body": "lgtm",
    "created_at": "2020-08-24T16:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429614",
    "user": "https://github.com/dimpase"
}
```

lgtm



---

archive/issue_comments_429615.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2020-08-24T16:40:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429615",
    "user": "https://github.com/dimpase"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_078867.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2020-08-30T08:38:47Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/30175#event-78867"
}
```



---

archive/issue_comments_429616.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2020-08-30T08:38:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/30175",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/30175#issuecomment-429616",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed
