# Issue 21346: py3 replace xrange by range in doctests of all cython files

archive/issues_021346.json:
```json
{
    "body": "as a step towards python3\n\n(recall that xrange must stay in the cython code)\n\nin one file with very large ranges, import six.moves.range in the doctests\n\nIssue created by migration from https://trac.sagemath.org/ticket/21583\n\n",
    "closed_at": "2016-10-05T22:41:52Z",
    "created_at": "2016-09-24T16:42:31Z",
    "labels": [
        "component: python3"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-7.4",
    "title": "py3 replace xrange by range in doctests of all cython files",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/21346",
    "user": "https://github.com/fchapoton"
}
```
as a step towards python3

(recall that xrange must stay in the cython code)

in one file with very large ranges, import six.moves.range in the doctests

Issue created by migration from https://trac.sagemath.org/ticket/21583





---

archive/issue_comments_295853.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2016-09-24T16:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295853",
    "user": "https://github.com/fchapoton"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_295854.json:
```json
{
    "body": "New commits:",
    "created_at": "2016-09-24T16:43:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295854",
    "user": "https://github.com/fchapoton"
}
```

New commits:



---

archive/issue_comments_295855.json:
```json
{
    "body": "When this `xrange(...)` is passed to some Sage function, this actually changes what is being tested. For loops, I agree with this change. But doing this mass replacement everywhere, I don't agree.",
    "created_at": "2016-09-27T08:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295855",
    "user": "https://github.com/jdemeyer"
}
```

When this `xrange(...)` is passed to some Sage function, this actually changes what is being tested. For loops, I agree with this change. But doing this mass replacement everywhere, I don't agree.



---

archive/issue_comments_295856.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-09-27T08:52:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295856",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_295857.json:
```json
{
    "body": "could you name the files where you have objections, please ?",
    "created_at": "2016-09-28T09:25:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295857",
    "user": "https://github.com/fchapoton"
}
```

could you name the files where you have objections, please ?



---

archive/issue_comments_295858.json:
```json
{
    "body": "Replying to [comment:3 chapoton]:\n> could you name the files where you have objections, please ?\n\n\nAll replacements `xrange() -> range()` which are done in a **looping construct** are fine. This means replacements in code like `for i in xrange(n)` or in `[f(x) for x in xrange(n)]`.\n\nEverything else (for example, the `matrix()` calls) should be investigated more carefully, preferably in a different ticket.",
    "created_at": "2016-09-28T10:34:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295858",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:3 chapoton]:
> could you name the files where you have objections, please ?


All replacements `xrange() -> range()` which are done in a **looping construct** are fine. This means replacements in code like `for i in xrange(n)` or in `[f(x) for x in xrange(n)]`.

Everything else (for example, the `matrix()` calls) should be investigated more carefully, preferably in a different ticket.



---

archive/issue_comments_295859.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-28T18:46:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295859",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_295860.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2016-09-28T18:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295860",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_295861.json:
```json
{
    "body": "is this what you required ?",
    "created_at": "2016-09-28T18:48:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295861",
    "user": "https://github.com/fchapoton"
}
```

is this what you required ?



---

archive/issue_comments_295862.json:
```json
{
    "body": "I guess so, but I need to check in more detail.\n\nFor the `matrix()` calls, you can use `six.moves.range` instead of `xrange` because those are equivalent in Python 2.",
    "created_at": "2016-09-29T07:55:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295862",
    "user": "https://github.com/jdemeyer"
}
```

I guess so, but I need to check in more detail.

For the `matrix()` calls, you can use `six.moves.range` instead of `xrange` because those are equivalent in Python 2.



---

archive/issue_comments_295863.json:
```json
{
    "body": "Branch as is is looking good, patchbot happy. Feel positive after cosmetics.",
    "created_at": "2016-09-29T08:56:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295863",
    "user": "https://github.com/rwst"
}
```

Branch as is is looking good, patchbot happy. Feel positive after cosmetics.



---

archive/issue_comments_295864.json:
```json
{
    "body": "is this a positive review ?",
    "created_at": "2016-09-29T17:05:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295864",
    "user": "https://github.com/fchapoton"
}
```

is this a positive review ?



---

archive/issue_comments_295865.json:
```json
{
    "body": "Yes, regardless if you use six. I couldn't have set positive myself if you wanted to do that.",
    "created_at": "2016-09-29T17:17:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295865",
    "user": "https://github.com/rwst"
}
```

Yes, regardless if you use six. I couldn't have set positive myself if you wanted to do that.



---

archive/issue_comments_295866.json:
```json
{
    "body": "This is also **not** a loop:\n\n```diff\n-            sage: l = lazy_list(iter(xrange(10000)))\n+            sage: l = lazy_list(iter(range(10000)))\n```",
    "created_at": "2016-09-30T11:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295866",
    "user": "https://github.com/jdemeyer"
}
```

This is also **not** a loop:

```diff
-            sage: l = lazy_list(iter(xrange(10000)))
+            sage: l = lazy_list(iter(range(10000)))
```



---

archive/issue_comments_295867.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2016-09-30T11:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295867",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_295868.json:
```json
{
    "body": "If you undo the change from [comment:11], you can set this to positive_review.",
    "created_at": "2016-09-30T11:43:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295868",
    "user": "https://github.com/jdemeyer"
}
```

If you undo the change from [comment:11], you can set this to positive_review.



---

archive/issue_comments_295869.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2016-09-30T13:48:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295869",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_295870.json:
```json
{
    "body": "done, thanks",
    "created_at": "2016-09-30T13:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295870",
    "user": "https://github.com/fchapoton"
}
```

done, thanks



---

archive/issue_comments_295871.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2016-09-30T13:49:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295871",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_295872.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2016-10-05T22:41:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/21346#issuecomment-295872",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_057273.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2016-10-05T22:41:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/21346",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/21346#event-57273"
}
```
