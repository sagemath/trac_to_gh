# Issue 21346: py3 replace xrange by range in doctests of all cython files

Issue created by migration from https://trac.sagemath.org/ticket/21583

Original creator: chapoton

Original creation time: 2016-09-24 16:42:31

as a step towards python3

(recall that xrange must stay in the cython code)

in one file with very large ranges, import six.moves.range in the doctests


---

Comment by chapoton created at 2016-09-24 16:43:08

Changing status from new to needs_review.


---

Comment by chapoton created at 2016-09-24 16:43:08

New commits:


---

Comment by jdemeyer created at 2016-09-27 08:52:15

When this `xrange(...)` is passed to some Sage function, this actually changes what is being tested. For loops, I agree with this change. But doing this mass replacement everywhere, I don't agree.


---

Comment by jdemeyer created at 2016-09-27 08:52:15

Changing status from needs_review to needs_work.


---

Comment by chapoton created at 2016-09-28 09:25:44

could you name the files where you have objections, please ?


---

Comment by jdemeyer created at 2016-09-28 10:34:18

Replying to [comment:3 chapoton]:
> could you name the files where you have objections, please ?

All replacements `xrange() -> range()` which are done in a *looping construct* are fine. This means replacements in code like `for i in xrange(n)` or in `[f(x) for x in xrange(n)]`.

Everything else (for example, the `matrix()` calls) should be investigated more carefully, preferably in a different ticket.


---

Comment by git created at 2016-09-28 18:46:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-09-28 18:48:30

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2016-09-28 18:48:30

is this what you required ?


---

Comment by jdemeyer created at 2016-09-29 07:55:41

I guess so, but I need to check in more detail.

For the `matrix()` calls, you can use `six.moves.range` instead of `xrange` because those are equivalent in Python 2.


---

Comment by rws created at 2016-09-29 08:56:58

Branch as is is looking good, patchbot happy. Feel positive after cosmetics.


---

Comment by chapoton created at 2016-09-29 17:05:59

is this a positive review ?


---

Comment by rws created at 2016-09-29 17:17:33

Yes, regardless if you use six. I couldn't have set positive myself if you wanted to do that.


---

Comment by jdemeyer created at 2016-09-30 11:40:46

This is also *not* a loop:

```diff
-            sage: l = lazy_list(iter(xrange(10000)))
+            sage: l = lazy_list(iter(range(10000)))
```



---

Comment by jdemeyer created at 2016-09-30 11:40:46

Changing status from needs_review to needs_work.


---

Comment by jdemeyer created at 2016-09-30 11:43:19

If you undo the change from [comment:11], you can set this to positive_review.


---

Comment by git created at 2016-09-30 13:48:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-09-30 13:49:13

done, thanks


---

Comment by chapoton created at 2016-09-30 13:49:13

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-10-05 22:41:52

Resolution: fixed
