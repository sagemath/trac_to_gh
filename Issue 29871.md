# Issue 29871: Inequality comparison for mixed forms

Issue created by migration from https://trac.sagemath.org/ticket/30108

Original creator: @mjungmath

Original creation time: 2020-07-11 10:15:14

CC:  egourgoulhon tscrim chapoton mkoeppe

Keywords: mixed_forms, manifolds

At this stage, the inequality comparison fails:

```
sage: M = Manifold(4, 'M')
sage: X.<x,y,z,t> = M.chart()
sage: Form0 = M.mixed_form(comp=([0,0,0,0,0]))
sage: Form1 = M.mixed_form(comp=([1,0,0,0,0]))
sage: Form0 != Form1
False
```


I already spotted the error: originally, `richcmp` is checked separately on each component and returns `False` if the check fails for at least one element. But for the inequality, it is enough when the check succeeds for at least one element because then both mixed forms are already unequal.

I will remove the method `_richcmp_` and replace it with `__eq__`. Since only `==` and `!=` are mathematically well-defined for mixed forms, this is perfectly fine.


---

Comment by git created at 2020-07-11 10:28:05

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-07-11 10:31:05

Changing status from new to needs_review.


---

Comment by git created at 2020-07-11 10:36:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-07-11 10:43:31

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-07-11 15:56:49

Changing status from needs_review to needs_work.


---

Comment by git created at 2020-07-11 17:13:32

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by @mjungmath created at 2020-07-11 17:15:27

Changing status from needs_work to needs_review.


---

Comment by @mjungmath created at 2020-07-11 17:15:27

I have overwritten my former approach. This should be much cleaner.


---

Comment by git created at 2020-07-11 17:24:44

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2020-07-11 17:27:08

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-07-11 17:34:12

For the sake of consistency, and compatibility, I think that the method `__eq__` should be replaced by `_richcmp_` in `scalarfield.py` and `tensorfield.py`. The method `_richcmp_` tries to coerce both elements into elements of a common parent first which makes most of the current checks obsolete and increases compatibility.

Eric, what do you think?

I have already opened a new ticket for this: #30116


---

Comment by git created at 2020-07-11 18:22:52

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-07-14 17:07:31

Changing component from geometry to manifolds.


---

Comment by egourgoulhon created at 2020-07-15 14:19:33

Replying to [comment:13 gh-mjungmath]:
> For the sake of consistency, and compatibility, I think that the method `__eq__` should be replaced by `_richcmp_` in `scalarfield.py` and `tensorfield.py`. The method `_richcmp_` tries to coerce both elements into elements of a common parent first which makes most of the current checks obsolete and increases compatibility.
> 
> Eric, what do you think?

This sounds like a good idea, except maybe when efficiency matters, like for `ManifoldPoint`, since points are parameters of `UniqueRepresentation` objects, namely tangent spaces.


---

Comment by git created at 2020-07-20 12:37:13

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by @mjungmath created at 2020-07-20 12:42:10

Can someone please review this ticket? There's not much change going on, and someone asked, rather indirectly, for a fix.


---

Comment by egourgoulhon created at 2020-07-20 12:51:24

Replying to [comment:19 gh-mjungmath]:
> Can someone please review this ticket? There's not much change going on, and someone asked, rather indirectly, for a fix.

LGTM. Just waiting for the patchbot green light.


---

Comment by @mjungmath created at 2020-07-20 15:50:13

Replying to [comment:20 egourgoulhon]:
> Replying to [comment:19 gh-mjungmath]:
> > Can someone please review this ticket? There's not much change going on, and someone asked, rather indirectly, for a fix.
> 
> LGTM. Just waiting for the patchbot green light. 

Patchbot appears to be green now. Thank you.


---

Comment by egourgoulhon created at 2020-07-21 08:39:02

Changing status from needs_review to positive_review.


---

Comment by egourgoulhon created at 2020-07-21 08:39:02

Good to go!


---

Comment by @mjungmath created at 2020-07-21 08:45:36

Perfect. Thank you! :)


---

Comment by git created at 2020-07-26 15:21:20

Changing status from positive_review to needs_review.


---

Comment by git created at 2020-07-26 15:21:20

Branch pushed to git repo; I updated commit sha1 and set ticket back to needs_review. New commits:


---

Comment by @mjungmath created at 2020-07-26 15:22:01

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-08-02 08:20:35

Resolution: fixed
