# Issue 26945: spkg-configure.m4 for bzip2

Issue created by migration from https://trac.sagemath.org/ticket/27182

Original creator: embray

Original creation time: 2019-01-31 13:13:48

Spun off from #27168.


---

Comment by embray created at 2019-01-31 13:14:57

This also reminds me, we probably should add a section in the installation docs (especially for Linux) listing optional `-devel` packages that should be installed in order to take advantage of supported system packages where possible.


---

Comment by embray created at 2019-01-31 13:14:57

Changing status from new to needs_review.


---

Comment by embray created at 2019-01-31 13:28:31

For testing tickets like this it's best to start from a fresh install, since otherwise I think, even if the `./configure` script now detects your system's bzip2, it's not like it will _uninstall_ the package already installed spkg.


---

Comment by embray created at 2019-01-31 14:04:57

Tested a fresh build and `ptestlong` with my system's bzip2 (also 1.0.6).  Actually, I think this software's creator has stopped maintaining it.  There was some discussion about that a bit ago on the Cygwin mailing list IIRC.


---

Comment by dimpase created at 2019-01-31 14:30:56

the branch does not seem to contain spkg-configure.m4 :-)
(at least using the trac view)

No, it's just not there. Forgotten commit?


---

Comment by dimpase created at 2019-01-31 14:36:30

![](https://pbs.twimg.com/media/DyPGJFhVsAA9diM.jpg)https://twitter.com/JordanHawker/status/1090933555067158529


---

Comment by embray created at 2019-01-31 14:58:49

Lol. Must be a forgotten `git add`.


---

Comment by git created at 2019-01-31 15:01:07

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2019-02-04 04:37:51

looks good to me. See #27212 for ditto for GMP, by the way.


---

Comment by dimpase created at 2019-02-04 04:38:40

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-02-05 16:57:48

Resolution: fixed


---

Comment by dimpase created at 2019-02-12 09:17:13

Changing keywords from "" to "spkg-configure".


---

Comment by mjo created at 2020-01-06 03:43:17

Sanity check: does that last AC_CHECK_PROG really do what it's supposed to?


```
SAGE_SPKG_CONFIGURE([bzip2], [
    AC_CHECK_HEADER(bzlib.h, [], [sage_spkg_install_bzip2=yes])
    AC_SEARCH_LIBS([BZ2_bzCompress], [bz2], [], [sage_spkg_install_bzip2=yes])
    AC_CHECK_PROG(bzip2, [break], [sage_spkg_install_bzip2=yes])
])
```



---

Comment by dimpase created at 2020-01-06 06:47:33

Replying to [comment:12 mjo]:
> Sanity check: does that last AC_CHECK_PROG really do what it's supposed to?
> 
> {{{
> SAGE_SPKG_CONFIGURE([bzip2], [
>     AC_CHECK_HEADER(bzlib.h, [], [sage_spkg_install_bzip2=yes])
>     AC_SEARCH_LIBS([BZ2_bzCompress], [bz2], [], [sage_spkg_install_bzip2=yes])
>     AC_CHECK_PROG(bzip2, [break], [sage_spkg_install_bzip2=yes])
> ])
> }}}

hmm, no. It should be `AC_PATH_PROG([BZIP2], [bzip2], [sage_spkg_install_bzip2=yes])`

- the test as specified always passes.


---

Comment by dimpase created at 2020-01-06 07:34:06

I've opened #28956 to deal with it.
