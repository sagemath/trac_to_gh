# Issue 28436: Do not create ipython symlink

Issue created by migration from https://trac.sagemath.org/ticket/28673

Original creator: jhpalmieri

Original creation time: 2019-10-29 22:39:08

CC:  dimpase

When `python` runs Python 3, the IPython `spkg-install` script creates a symlink `ipython3 -> ipython` in `SAGE_LOCAL/bin`, and this interferes with the installation process.



---

Comment by jhpalmieri created at 2019-10-29 22:39:52

New commits:


---

Comment by jhpalmieri created at 2019-10-29 22:39:52

Changing status from new to needs_review.


---

Comment by jhpalmieri created at 2019-10-29 22:55:58

By the way, the deleted lines never really functioned as intended: in earlier versions of Sage, `python` was always installed as Python 2. In the most recent versions of Sage, with a Python 3 build, `python2` is not installed, so there is no `$SAGE_LOCAL/bin/python`. In that case the test

```
if python -c 'import sys; sys.exit(sys.version_info.major != 3)'
```

will only test positively if the system `python` runs Python 3.

Also, the `spkg-install` procedure involves building elsewhere and then installing all at once into `SAGE_LOCAL`, so manually creating the symlink makes no sense at all.


---

Comment by dimpase created at 2019-10-29 22:57:37

is there a need to put `rm -f "$SAGE_LOCAL"/bin/ipython` into `if` clause?
Certainly not needed on Linux...


---

Comment by jhpalmieri created at 2019-10-29 23:41:30

I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)


---

Comment by git created at 2019-10-29 23:42:25

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by dimpase created at 2019-10-30 06:55:51

Replying to [comment:5 jhpalmieri]:
> I guess our current procedure uninstalls the old package first, so no, there is no need. (We used to at least try to be careful about deleting the old installation until we were sure that the new version built successfully.)

unistall only happens if it was properly installed (with sdh_... script), with the corresponding uninstall info stored.
If not, it would be left there.

IMHO "rf -f blah" ignores the result  - if blah was not there, there is still no error (although OSX might be different...)


---

Comment by dimpase created at 2019-10-30 07:58:30

looks good to me. Please double-check that repeatedly running
`./sage -f ipython` on MacOS works, then you can set it to positive review.


---

Comment by jhpalmieri created at 2019-10-30 17:02:05

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2019-10-31 22:40:51

Resolution: fixed
