# Issue 16010: Abuse of Modules() for modules over noncommutative rings

archive/issues_016010.json:
```json
{
    "body": "CC:  @nthiery simonking @orlitzky\n\nKeywords: modules, categories, associativity,\n\nWe have `LeftModules` and `RightModules` functorial constructions (not sure if since #10963 or already before), and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.\n\nI'm currently running the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. I'll post the results once it's done. So far:\n\n```\n----------------------------------------------------------------------\nsage -t src/sage/groups/finitely_presented.py  # 2 doctests failed\nsage -t src/sage/matrix/matrix_sparse.pyx  # 4 doctests failed\nsage -t src/sage/matrix/matrix0.pyx  # 5 doctests failed\nsage -t src/sage/matrix/matrix2.pyx  # 1 doctest failed\nsage -t src/sage/matrix/matrix_space.py  # 2 doctests failed\nDoctests interrupted: 231/2069 files tested\n----------------------------------------------------------------------\n```\n\n\nIssue created by migration from https://trac.sagemath.org/ticket/16247\n\n",
    "created_at": "2014-04-27T03:42:08Z",
    "labels": [
        "algebra",
        "major",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-9.8",
    "title": "Abuse of Modules() for modules over noncommutative rings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16010",
    "user": "@darijgr"
}
```
CC:  @nthiery simonking @orlitzky

Keywords: modules, categories, associativity,

We have `LeftModules` and `RightModules` functorial constructions (not sure if since #10963 or already before), and they should be used. `Modules` implements left and right multiplication to be *the same*, which causes misleading and counterintuitive non-associativity issues.

I'm currently running the (short) doctests of src/sage with a commit that adds a warning every time Modules(A) is called for A noncommutative. I'll post the results once it's done. So far:

```
----------------------------------------------------------------------
sage -t src/sage/groups/finitely_presented.py  # 2 doctests failed
sage -t src/sage/matrix/matrix_sparse.pyx  # 4 doctests failed
sage -t src/sage/matrix/matrix0.pyx  # 5 doctests failed
sage -t src/sage/matrix/matrix2.pyx  # 1 doctest failed
sage -t src/sage/matrix/matrix_space.py  # 2 doctests failed
Doctests interrupted: 231/2069 files tested
----------------------------------------------------------------------
```


Issue created by migration from https://trac.sagemath.org/ticket/16247





---

archive/issue_comments_207891.json:
```json
{
    "body": "Changing keywords from \"modules, categories, associativity,\" to \"modules, categories, associativity, matrices\".",
    "created_at": "2014-04-27T03:57:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16010#issuecomment-207891",
    "user": "@darijgr"
}
```

Changing keywords from "modules, categories, associativity," to "modules, categories, associativity, matrices".



---

archive/issue_comments_207892.json:
```json
{
    "body": "Thanks for exploring how to clean this up.\n\nJust for the record: we have had left/right/bimodules since 2009 and probably even before. Also, at this point, they are just categories over a base ring, not functorial constructions.\n\nOne thing to check is how this was handled in Axiom. MuPAD was roughly as here: on the lousy side in the non commutative case.",
    "created_at": "2014-04-27T07:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16010#issuecomment-207892",
    "user": "@nthiery"
}
```

Thanks for exploring how to clean this up.

Just for the record: we have had left/right/bimodules since 2009 and probably even before. Also, at this point, they are just categories over a base ring, not functorial constructions.

One thing to check is how this was handled in Axiom. MuPAD was roughly as here: on the lousy side in the non commutative case.



---

archive/issue_comments_207893.json:
```json
{
    "body": "Setting new milestone based on a cursory review of ticket status, priority, and last modification date.",
    "created_at": "2021-02-13T20:51:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16010#issuecomment-207893",
    "user": "@mkoeppe"
}
```

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.



---

archive/issue_comments_207894.json:
```json
{
    "body": "I got here through #32250, in which I propose a precise definition for (magmatic) algebras over an associative unital ring, and comment:2:ticket:32250.\n\nMy personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.",
    "created_at": "2021-07-27T11:40:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16010#issuecomment-207894",
    "user": "@pjbruin"
}
```

I got here through #32250, in which I propose a precise definition for (magmatic) algebras over an associative unital ring, and comment:2:ticket:32250.

My personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.



---

archive/issue_comments_207895.json:
```json
{
    "body": "Replying to [comment:11 pbruin]:\n> \n> My personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.\n\nI agree. This is what the existing `Modules?` docstring is trying to say. The cited `UserWarning` more or less says that your ring should be commutative, and that your left- and right-module actions had better be the same. The definition should match what Sage is actually capable of.\n\nThis would leave us with new problem though, that of defining a symmetric bimodule within sage. Maybe we should just be explicit about the axioms instead of using that term.",
    "created_at": "2021-07-30T11:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16010",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16010#issuecomment-207895",
    "user": "@orlitzky"
}
```

Replying to [comment:11 pbruin]:
> 
> My personal preferred solution would be a variant of the first option in the ticket description: make `Modules` only support *commutative* base rings, and define a module over a commutative ring *R* to be a symmetric (*R*, *R*)-bimodule.  This feels most in line with how modules are currently used in Sage.  Supporting non-commutative rings with this definition would probably be more confusing than justified by the little amount of added functionality.

I agree. This is what the existing `Modules?` docstring is trying to say. The cited `UserWarning` more or less says that your ring should be commutative, and that your left- and right-module actions had better be the same. The definition should match what Sage is actually capable of.

This would leave us with new problem though, that of defining a symmetric bimodule within sage. Maybe we should just be explicit about the axioms instead of using that term.
