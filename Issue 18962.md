# Issue 18962: FiniteStateMachine: do not mess with color 'None'

Issue created by migration from Trac.

Original creator: cheuberg

Original creation time: 2015-09-13 15:57:36

CC:  skropf dkrenn

Keywords: color

Currently, `determinisation`, `product_FiniteStateMachine` and related functions construct colors as frozensets or tuples of colors of its constituent states. If all colors are None, this leads to strange artifacts:

```
sage: A = Automaton([(0, 0, 0)], initial_states=[0], final_states=[0])
sage: [s.color for s in A.determinisation().iter_states()]
[frozenset({None})]
sage: [s.color for s in A.cartesian_product(A).iter_states()]
[(None, None)]
sage: T = Transducer([(0, 0, 0, 0)], initial_states=[0], final_states=[0])
sage: [s.color for s in T.composition(T).iter_states()]
[(None, None)]
sage: [s.color
....:  for s in T.product_FiniteStateMachine(
....:       T, lambda t1, t2: (0, 0)).iter_states()]
[(None, None)]
```


In those case, just use the color `None` if all constituent states have color `None`.


---

Comment by cheuberg created at 2015-09-14 12:35:44

Changing status from new to needs_review.


---

Comment by cheuberg created at 2015-09-14 12:35:44

New commits:


---

Comment by dkrenn created at 2015-09-14 15:06:13

Changing status from needs_review to positive_review.


---

Comment by dkrenn created at 2015-09-14 15:06:13

Code is fine, doc builds.


---

Comment by vbraun created at 2015-09-16 18:31:27

Resolution: fixed
