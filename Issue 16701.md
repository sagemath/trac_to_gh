# Issue 16701: Sage debug version

archive/issues_016701.json:
```json
{
    "body": "CC:  jpflori @vbraun @malb\n\nKeywords: debug singular cygwin64\n\nWhen building sage with `SAGE_DEBUG=yes`, then it turns out that the debug and the cygwin64 patches to the Singular spkg are in conflict. Hence, the built fails. Let's fix it!\n\nIssue created by migration from https://trac.sagemath.org/ticket/16938\n\n",
    "created_at": "2014-09-05T14:07:35Z",
    "labels": [
        "component: build",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.4",
    "title": "Sage debug version",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/16701",
    "user": "https://github.com/simon-king-jena"
}
```
CC:  jpflori @vbraun @malb

Keywords: debug singular cygwin64

When building sage with `SAGE_DEBUG=yes`, then it turns out that the debug and the cygwin64 patches to the Singular spkg are in conflict. Hence, the built fails. Let's fix it!

Issue created by migration from https://trac.sagemath.org/ticket/16938





---

archive/issue_comments_220385.json:
```json
{
    "body": "The function `choose_patches()` of singular's spkg-install removes most of the files in `$SRC/omalloc/` if we are in debug mode. However, the cygwin64 patch tries to patch some files in that folder.\n\nIn addition to that, the cygwin64 patch says\n\n```\n+ifeq ($(SINGUNAME),x86_64-Win)\n+SO_SUFFIX = dll\n+MODULE_SUFFIX    = dll\n+LIBSINGULAR_FLAGS = -shared\n+LIBSINGULAR_LIBS = -lsingfac -lsingcf -lntl -lreadline -lgmp -lomalloc \n+endif\n+\n```\nSo, if one would try to build the debug version in 64 bit cygwin, then one had -lomalloc, but that would not work, since omalloc is disabled on purpose, for the debug version.\n\nWhat to do? In principle, we could put an alternative version of the cygwin64 patch into the patches/conditional folder, and if we are in debug version, we could let `choose_patches()` replace the regular cygwin patch version by the conditional version.\n\nI will try to solve the problem accordingly, however, I have no windows box. Hence, someone else needs to test if a debug version of singular works in cygwin.",
    "created_at": "2014-09-05T19:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220385",
    "user": "https://github.com/simon-king-jena"
}
```

The function `choose_patches()` of singular's spkg-install removes most of the files in `$SRC/omalloc/` if we are in debug mode. However, the cygwin64 patch tries to patch some files in that folder.

In addition to that, the cygwin64 patch says

```
+ifeq ($(SINGUNAME),x86_64-Win)
+SO_SUFFIX = dll
+MODULE_SUFFIX    = dll
+LIBSINGULAR_FLAGS = -shared
+LIBSINGULAR_LIBS = -lsingfac -lsingcf -lntl -lreadline -lgmp -lomalloc 
+endif
+
```
So, if one would try to build the debug version in 64 bit cygwin, then one had -lomalloc, but that would not work, since omalloc is disabled on purpose, for the debug version.

What to do? In principle, we could put an alternative version of the cygwin64 patch into the patches/conditional folder, and if we are in debug version, we could let `choose_patches()` replace the regular cygwin patch version by the conditional version.

I will try to solve the problem accordingly, however, I have no windows box. Hence, someone else needs to test if a debug version of singular works in cygwin.



---

archive/issue_comments_220386.json:
```json
{
    "body": "PS: Instead of omalloc, the debug version's memory manager is called xalloc. This is a hint for a debug version in cygwin: Perhaps it needs to say `-lxalloc` rather than `-lomalloc`?",
    "created_at": "2014-09-05T19:56:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220386",
    "user": "https://github.com/simon-king-jena"
}
```

PS: Instead of omalloc, the debug version's memory manager is called xalloc. This is a hint for a debug version in cygwin: Perhaps it needs to say `-lxalloc` rather than `-lomalloc`?



---

archive/issue_comments_220387.json:
```json
{
    "body": "Unfortunately, one important debug patch, namely `singular_xalloc.patch`, fails to apply.",
    "created_at": "2014-09-05T20:02:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220387",
    "user": "https://github.com/simon-king-jena"
}
```

Unfortunately, one important debug patch, namely `singular_xalloc.patch`, fails to apply.



---

archive/issue_comments_220388.json:
```json
{
    "body": "Replying to [comment:3 SimonKing]:\n> Unfortunately, one important debug patch, namely `singular_xalloc.patch`, fails to apply.\n\n\nThe good news is that many of the failing patches went upstream!",
    "created_at": "2014-09-05T20:46:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220388",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:3 SimonKing]:
> Unfortunately, one important debug patch, namely `singular_xalloc.patch`, fails to apply.


The good news is that many of the failing patches went upstream!



---

archive/issue_comments_220389.json:
```json
{
    "body": "I modified the patches so that they apply. However, the built fails, as the function `omalloc0` is used in one place, but is not defined when using xalloc instead of omalloc. I guess I have to ask Hans Sch\u00f6nemann for advice.",
    "created_at": "2014-09-05T20:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220389",
    "user": "https://github.com/simon-king-jena"
}
```

I modified the patches so that they apply. However, the built fails, as the function `omalloc0` is used in one place, but is not defined when using xalloc instead of omalloc. I guess I have to ask Hans SchÃ¶nemann for advice.



---

archive/issue_comments_220390.json:
```json
{
    "body": "IMHO we shouldn't waste time on a Cygwin debug version. Thats for way down the road. If it doesn't work now, so be it.",
    "created_at": "2014-09-10T19:09:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220390",
    "user": "https://github.com/vbraun"
}
```

IMHO we shouldn't waste time on a Cygwin debug version. Thats for way down the road. If it doesn't work now, so be it.



---

archive/issue_comments_220391.json:
```json
{
    "body": "Replying to [comment:6 vbraun]:\n> IMHO we shouldn't waste time on a Cygwin debug version. Thats for way down the road. If it doesn't work now, so be it.\n\n\nCygwin itself is not in the game. Only the cygwin PATCH currently constitutes a problem. It is not a big deal to solve it: I modified the patches *and* spkg-install so that building the debug version starts (i.e., so that all patches and changes apply).\n\nMeanwhile Hans gave me a hint on where to get a missing function. After fixing that, the debug version will hopefully build.",
    "created_at": "2014-09-10T19:34:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220391",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:6 vbraun]:
> IMHO we shouldn't waste time on a Cygwin debug version. Thats for way down the road. If it doesn't work now, so be it.


Cygwin itself is not in the game. Only the cygwin PATCH currently constitutes a problem. It is not a big deal to solve it: I modified the patches *and* spkg-install so that building the debug version starts (i.e., so that all patches and changes apply).

Meanwhile Hans gave me a hint on where to get a missing function. After fixing that, the debug version will hopefully build.



---

archive/issue_comments_220392.json:
```json
{
    "body": "With Hans' hint, building the debug version went a bit further. However, building still fails, with \"cannot find -lomalloc_ndebug\".\n\nOOOOPS! Looking for `-lomalloc_ndebug` in our patches, I see that the `sage_debug.patch` looks like this:\n\n```diff\ndiff -ru src/kernel/Makefile.in src.debug/kernel/Makefile.in\n--- src/kernel/Makefile.in      2012-04-17 21:00:08.000000000 +0200\n+++ src.debug/kernel/Makefile.in        2012-07-12 16:51:29.923359810 +0200\n@@ -49,7 +49,7 @@\n CXXFLAGS       = @CXXFLAGS@ ${PIPE} \n CXXTEMPLFLAGS  = @CXXTEMPLFLAGS@\n CPPFLAGS       = -I${srcdir} -I.. -I@prefix@  @CPPFLAGS@ \n-DEFS           = -DNDEBUG -DOM_NDEBUG -D@SING_UNAME@ @DEFS@\n+DEFS           = -DOM_NDEBUG -D@SING_UNAME@ @DEFS@\n LDFLAGS                = @LDFLAGS@\n LD_DYN_FLAGS   = @LD_DYN_FLAGS@\n SFLAGS         = @SFLAGS@\n@@ -64,7 +64,7 @@\n LIBS           = -lm @NEED_LIBS@ \n else\n # for the 2-0-* versions under Windows, we don't need gdbm, readline and ncurses\n-LIBS           = -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lomalloc_ndebug\n+LIBS           = -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lomalloc\n #LIBS          = -lsingfac -lsingcf -lgmp\n endif\n MP_LIBS                = @MP_LIBS@\n```\nIsn't the diff file formatted wrongly? I am talking about the paths \"src/kernel\" and \"src.debug/kernel\", which do not exist.",
    "created_at": "2014-09-10T20:40:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220392",
    "user": "https://github.com/simon-king-jena"
}
```

With Hans' hint, building the debug version went a bit further. However, building still fails, with "cannot find -lomalloc_ndebug".

OOOOPS! Looking for `-lomalloc_ndebug` in our patches, I see that the `sage_debug.patch` looks like this:

```diff
diff -ru src/kernel/Makefile.in src.debug/kernel/Makefile.in
--- src/kernel/Makefile.in      2012-04-17 21:00:08.000000000 +0200
+++ src.debug/kernel/Makefile.in        2012-07-12 16:51:29.923359810 +0200
@@ -49,7 +49,7 @@
 CXXFLAGS       = @CXXFLAGS@ ${PIPE} 
 CXXTEMPLFLAGS  = @CXXTEMPLFLAGS@
 CPPFLAGS       = -I${srcdir} -I.. -I@prefix@  @CPPFLAGS@ 
-DEFS           = -DNDEBUG -DOM_NDEBUG -D@SING_UNAME@ @DEFS@
+DEFS           = -DOM_NDEBUG -D@SING_UNAME@ @DEFS@
 LDFLAGS                = @LDFLAGS@
 LD_DYN_FLAGS   = @LD_DYN_FLAGS@
 SFLAGS         = @SFLAGS@
@@ -64,7 +64,7 @@
 LIBS           = -lm @NEED_LIBS@ 
 else
 # for the 2-0-* versions under Windows, we don't need gdbm, readline and ncurses
-LIBS           = -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lomalloc_ndebug
+LIBS           = -lsingfac -lsingcf -lntl -lgmp -lreadline -lncurses -lomalloc
 #LIBS          = -lsingfac -lsingcf -lgmp
 endif
 MP_LIBS                = @MP_LIBS@
```
Isn't the diff file formatted wrongly? I am talking about the paths "src/kernel" and "src.debug/kernel", which do not exist.



---

archive/issue_comments_220393.json:
```json
{
    "body": "Concerning ndebug: There is quite a number of files in `upstream/singular-3.1.6/latest/` mentioning `-lomalloc_ndebug`. Probably we should change all of them to only mention `-lomalloc`.",
    "created_at": "2014-09-10T20:54:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220393",
    "user": "https://github.com/simon-king-jena"
}
```

Concerning ndebug: There is quite a number of files in `upstream/singular-3.1.6/latest/` mentioning `-lomalloc_ndebug`. Probably we should change all of them to only mention `-lomalloc`.



---

archive/issue_comments_220394.json:
```json
{
    "body": "I have pushed my changes, so that someone else may have a change to see how to solve the `-lomalloc_ndebug` problem.\n\n---\nNew commits:",
    "created_at": "2014-09-10T21:04:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220394",
    "user": "https://github.com/simon-king-jena"
}
```

I have pushed my changes, so that someone else may have a change to see how to solve the `-lomalloc_ndebug` problem.

---
New commits:



---

archive/issue_comments_220395.json:
```json
{
    "body": "Patches are applied with `-p1`, so the first path component is stripped off.",
    "created_at": "2014-09-10T22:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220395",
    "user": "https://github.com/vbraun"
}
```

Patches are applied with `-p1`, so the first path component is stripped off.



---

archive/issue_comments_220396.json:
```json
{
    "body": "Replying to [comment:12 vbraun]:\n> Patches are applied with `-p1`, so the first path component is stripped off.\n\n\nOK, but I think it doesn't hurt that in the latest commit I change the path names according to what is done in the other patches (source path `a/...` versus target path `b/...`).\n\nI got more Info from Hans. There is a debug version of omalloc, but it would still be omalloc. Hence, valgrind would not see details but would only see large pages allocated. So, he recommends to stick with xalloc (which is a compatibility layer on top of malloc).\n\nIf we would have Singular 4-x in Sage (we only have 3-1-6), xalloc would be part of the sources. Hence, all our current patching for the debug version wouldn't be needed.\n\nAs for `-lomalloc_ndebug`: Hans suggests to change the makefile so that a module `libomalloc_ndebug.so` rather than `libomalloc.so` is created. To my understanding, it would also allow to remove other parts of our patches, where we replace `-lomalloc_ndebug` by `-lomalloc`.",
    "created_at": "2014-09-11T10:09:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220396",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:12 vbraun]:
> Patches are applied with `-p1`, so the first path component is stripped off.


OK, but I think it doesn't hurt that in the latest commit I change the path names according to what is done in the other patches (source path `a/...` versus target path `b/...`).

I got more Info from Hans. There is a debug version of omalloc, but it would still be omalloc. Hence, valgrind would not see details but would only see large pages allocated. So, he recommends to stick with xalloc (which is a compatibility layer on top of malloc).

If we would have Singular 4-x in Sage (we only have 3-1-6), xalloc would be part of the sources. Hence, all our current patching for the debug version wouldn't be needed.

As for `-lomalloc_ndebug`: Hans suggests to change the makefile so that a module `libomalloc_ndebug.so` rather than `libomalloc.so` is created. To my understanding, it would also allow to remove other parts of our patches, where we replace `-lomalloc_ndebug` by `-lomalloc`.



---

archive/issue_comments_220397.json:
```json
{
    "body": "libm4ri fails its self-tests when debug is on, this is #16966.",
    "created_at": "2014-09-11T12:10:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220397",
    "user": "https://github.com/vbraun"
}
```

libm4ri fails its self-tests when debug is on, this is #16966.



---

archive/issue_comments_220398.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-11T12:10:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220398",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220399.json:
```json
{
    "body": "Meanwhile I got Singular's xalloc version (which is better for valgrinding than the debug version of omalloc) to build. Now I am trying to build the rest of Sage, but expect that I will soon run into the issue tracked at #16966...\n\nIn the latest commit I added one missing function (which is empty in the debug version) and I changed the module name from `libomalloc.so` into `libomalloc_ndebug.so`. It may seem strange for someone that the DEBUG version is named `..._ndebug`. If that's a problem then (s)he may change it, so that it still works...\n\nI am trying to continue building, potentially with m4ri in non-debug mode. I guess for now one can say that it needs review.",
    "created_at": "2014-09-11T12:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220399",
    "user": "https://github.com/simon-king-jena"
}
```

Meanwhile I got Singular's xalloc version (which is better for valgrinding than the debug version of omalloc) to build. Now I am trying to build the rest of Sage, but expect that I will soon run into the issue tracked at #16966...

In the latest commit I added one missing function (which is empty in the debug version) and I changed the module name from `libomalloc.so` into `libomalloc_ndebug.so`. It may seem strange for someone that the DEBUG version is named `..._ndebug`. If that's a problem then (s)he may change it, so that it still works...

I am trying to continue building, potentially with m4ri in non-debug mode. I guess for now one can say that it needs review.



---

archive/issue_comments_220400.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2014-09-11T12:16:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220400",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_220401.json:
```json
{
    "body": "For the record, m4ri builds fine if you don't set `SAGE_CHECK=yes`",
    "created_at": "2014-09-11T12:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220401",
    "user": "https://github.com/vbraun"
}
```

For the record, m4ri builds fine if you don't set `SAGE_CHECK=yes`



---

archive/issue_comments_220402.json:
```json
{
    "body": "I get `/usr/bin/ld: cannot find -lomalloc` when building from scratch...",
    "created_at": "2014-09-11T12:42:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220402",
    "user": "https://github.com/vbraun"
}
```

I get `/usr/bin/ld: cannot find -lomalloc` when building from scratch...



---

archive/issue_comments_220403.json:
```json
{
    "body": "Replying to [comment:18 vbraun]:\n> I get `/usr/bin/ld: cannot find -lomalloc` when building from scratch...\n\n\nIt has built for me (without `SAGE_CHECK=yes`), but I suppose that `libomalloc` was present from previous attempts to build. So, let's try \"make distclean\" and try again...",
    "created_at": "2014-09-11T15:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220403",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:18 vbraun]:
> I get `/usr/bin/ld: cannot find -lomalloc` when building from scratch...


It has built for me (without `SAGE_CHECK=yes`), but I suppose that `libomalloc` was present from previous attempts to build. So, let's try "make distclean" and try again...



---

archive/issue_comments_220404.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-11T15:18:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220404",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_220405.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-11T22:21:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220405",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220406.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-11T22:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220406",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_220407.json:
```json
{
    "body": "After make distclean I could reproduce the build errors.\n\nThe latest commit provides a solution. Perhaps you don't like it, for aesthetic reasons (\"the debug version uses a module called omalloc_ndebug\"), but it works. I also had to resolve a conflict with `cygwin_64.patch` to achieve it.",
    "created_at": "2014-09-11T22:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220407",
    "user": "https://github.com/simon-king-jena"
}
```

After make distclean I could reproduce the build errors.

The latest commit provides a solution. Perhaps you don't like it, for aesthetic reasons ("the debug version uses a module called omalloc_ndebug"), but it works. I also had to resolve a conflict with `cygwin_64.patch` to achieve it.



---

archive/issue_comments_220408.json:
```json
{
    "body": "I'll give it a spin.\n\nIMHO we don't have to win beauty contests with the debug version...",
    "created_at": "2014-09-11T23:16:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220408",
    "user": "https://github.com/vbraun"
}
```

I'll give it a spin.

IMHO we don't have to win beauty contests with the debug version...



---

archive/issue_comments_220409.json:
```json
{
    "body": "Still doesn't build for me:\n\n```\ng++ -O0 -g  -fPIC -I.. -I/home/vbraun/Sage/git-develop/local -pipe -I. -I.. -I/home/vbraun/Sage/git-develop/local -I/home/vbraun/Sage/git-develop/local/include -I/home/vbraun/Sage/git-develop/local/include   -fno-implicit-templates -I.. -I/home/vbraun/Sage/git-develop/local -Dx86_64_Linux -DHAVE_CONFIG_H \\\n  -o Singular \\\n  tesths.cc iparith.o mpsr_Tok.o claptmpl.o\\\n  grammar.o scanner.o attrib.o blackbox.o eigenval_ip.o extra.o fehelp.o feOpt.o ipassign.o ipconv.o ipid.o iplib.o ipprint.o ipshell.o newstruct.o lists.o sdb.o fglm.o interpolation.o silink.o ssiLink.o s_buff.o subexpr.o janet.o wrapper.o libparse.o sing_win.o gms.o pcv.o maps_ip.o walk.o walk_ip.o cntrlc.o misc_ip.o calcSVD.o pipeLink.o Minor.o MinorProcessor.o MinorInterface.o bigintm.o pyobject_setup.o denom_list.o minpoly.o countedref.o semaphore.o slInit_Dynamic.o -rdynamic -L/home/vbraun/Sage/git-develop/local/kernel -L../kernel -lkernel_g -L/home/vbraun/Sage/git-develop/local/lib  -L/home/vbraun/Sage/git-develop/local/lib -lflint -lmpfr -lmpir  -ldl -lm -lsingfac -lsingcf -lflint -lmpfr -lntl -lgmp -lreadline -ltermcap -lnsl -lm  -lnsl -lbsd  -lomalloc -lpthread  ../kernel/mmalloc.o \n/usr/bin/ld: cannot find -lomalloc\ncollect2: error: ld returned 1 exit status\nmake[1]: *** [Singular] Error 1\nmake[1]: Leaving directory `/home/vbraun/Sage/git-develop/local/var/tmp/sage/build/singular-3.1.6.p3/src/latest/Singular'\nmake: *** [install-nolns] Error 1\nUnable to build and install Singular\nError building Singular (error in build_singular).\n```",
    "created_at": "2014-09-12T12:47:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220409",
    "user": "https://github.com/vbraun"
}
```

Still doesn't build for me:

```
g++ -O0 -g  -fPIC -I.. -I/home/vbraun/Sage/git-develop/local -pipe -I. -I.. -I/home/vbraun/Sage/git-develop/local -I/home/vbraun/Sage/git-develop/local/include -I/home/vbraun/Sage/git-develop/local/include   -fno-implicit-templates -I.. -I/home/vbraun/Sage/git-develop/local -Dx86_64_Linux -DHAVE_CONFIG_H \
  -o Singular \
  tesths.cc iparith.o mpsr_Tok.o claptmpl.o\
  grammar.o scanner.o attrib.o blackbox.o eigenval_ip.o extra.o fehelp.o feOpt.o ipassign.o ipconv.o ipid.o iplib.o ipprint.o ipshell.o newstruct.o lists.o sdb.o fglm.o interpolation.o silink.o ssiLink.o s_buff.o subexpr.o janet.o wrapper.o libparse.o sing_win.o gms.o pcv.o maps_ip.o walk.o walk_ip.o cntrlc.o misc_ip.o calcSVD.o pipeLink.o Minor.o MinorProcessor.o MinorInterface.o bigintm.o pyobject_setup.o denom_list.o minpoly.o countedref.o semaphore.o slInit_Dynamic.o -rdynamic -L/home/vbraun/Sage/git-develop/local/kernel -L../kernel -lkernel_g -L/home/vbraun/Sage/git-develop/local/lib  -L/home/vbraun/Sage/git-develop/local/lib -lflint -lmpfr -lmpir  -ldl -lm -lsingfac -lsingcf -lflint -lmpfr -lntl -lgmp -lreadline -ltermcap -lnsl -lm  -lnsl -lbsd  -lomalloc -lpthread  ../kernel/mmalloc.o 
/usr/bin/ld: cannot find -lomalloc
collect2: error: ld returned 1 exit status
make[1]: *** [Singular] Error 1
make[1]: Leaving directory `/home/vbraun/Sage/git-develop/local/var/tmp/sage/build/singular-3.1.6.p3/src/latest/Singular'
make: *** [install-nolns] Error 1
Unable to build and install Singular
Error building Singular (error in build_singular).
```



---

archive/issue_comments_220410.json:
```json
{
    "body": "Replying to [comment:23 vbraun]:\n> Still doesn't build for me:\n\n\nSeriously? It did build for me, even though I did `make distclean` after making the makefile make `omalloc_ndebug` instead of `omalloc`.\n\n> {{{\n> g++ -O0 -g  -fPIC -I.. -I/home/vbraun/Sage/git-develop/local -pipe -I. -I.. -I/home/vbraun/Sage/git-develop/local -I/home/vbraun/Sage/git-develop/local/include -I/home/vbraun/Sage/git-develop/local/include   -fno-implicit-templates -I.. -I/home/vbraun/Sage/git-develop/local -Dx86_64_Linux -DHAVE_CONFIG_H \\\n>   -o Singular \\\n>   tesths.cc iparith.o mpsr_Tok.o claptmpl.o\\...\n> }}}\n\n\nThe name `tesths.cc` suggests that this is for testing. So, did you build with `SAGE_CHECK` and `SAGE_DEBUG` together?",
    "created_at": "2014-09-12T12:57:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220410",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:23 vbraun]:
> Still doesn't build for me:


Seriously? It did build for me, even though I did `make distclean` after making the makefile make `omalloc_ndebug` instead of `omalloc`.

> {{{
> g++ -O0 -g  -fPIC -I.. -I/home/vbraun/Sage/git-develop/local -pipe -I. -I.. -I/home/vbraun/Sage/git-develop/local -I/home/vbraun/Sage/git-develop/local/include -I/home/vbraun/Sage/git-develop/local/include   -fno-implicit-templates -I.. -I/home/vbraun/Sage/git-develop/local -Dx86_64_Linux -DHAVE_CONFIG_H \
>   -o Singular \
>   tesths.cc iparith.o mpsr_Tok.o claptmpl.o\...
> }}}


The name `tesths.cc` suggests that this is for testing. So, did you build with `SAGE_CHECK` and `SAGE_DEBUG` together?



---

archive/issue_comments_220411.json:
```json
{
    "body": "Are you using 32bit? I did not enable `SAGE_CHECKS`.",
    "created_at": "2014-09-12T13:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220411",
    "user": "https://github.com/vbraun"
}
```

Are you using 32bit? I did not enable `SAGE_CHECKS`.



---

archive/issue_comments_220412.json:
```json
{
    "body": "Replying to [comment:25 vbraun]:\n> Are you using 32bit? I did not enable `SAGE_CHECKS`.\n\n\nNo, I am on 64 bit. Is the file you mentioned only built on 32 bit??\n\n---\nNew commits:",
    "created_at": "2014-09-12T13:06:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220412",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:25 vbraun]:
> Are you using 32bit? I did not enable `SAGE_CHECKS`.


No, I am on 64 bit. Is the file you mentioned only built on 32 bit??

---
New commits:



---

archive/issue_comments_220413.json:
```json
{
    "body": "OK, the change sounds reasonable.",
    "created_at": "2014-09-12T13:07:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220413",
    "user": "https://github.com/simon-king-jena"
}
```

OK, the change sounds reasonable.



---

archive/issue_comments_220414.json:
```json
{
    "body": "No, I'm on x86 too. The issue comes from the `test \"$ac_cv_sizeof_voidp\" != 4;` so I thought it might be a bitwidth thing.",
    "created_at": "2014-09-12T13:08:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220414",
    "user": "https://github.com/vbraun"
}
```

No, I'm on x86 too. The issue comes from the `test "$ac_cv_sizeof_voidp" != 4;` so I thought it might be a bitwidth thing.



---

archive/issue_comments_220415.json:
```json
{
    "body": "By the way: I did not run the full test suite yet (now I am rebuilding from scratch), but found a surprisingly high number of test errors, given that not so long time ago the debug version passed *all* tests.",
    "created_at": "2014-09-12T13:16:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220415",
    "user": "https://github.com/simon-king-jena"
}
```

By the way: I did not run the full test suite yet (now I am rebuilding from scratch), but found a surprisingly high number of test errors, given that not so long time ago the debug version passed *all* tests.



---

archive/issue_comments_220416.json:
```json
{
    "body": "Most failures seem to be from non-commutative stuff...",
    "created_at": "2014-09-12T14:56:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220416",
    "user": "https://github.com/vbraun"
}
```

Most failures seem to be from non-commutative stuff...



---

archive/issue_comments_220417.json:
```json
{
    "body": "For example:\n\n```\n(gdb) break dReportError\nBreakpoint 1 at 0x7fffcc699a71: file dError.c, line 28.\n(gdb) cont\nContinuing.\n\nsage: F.<x,y,z> = FreeAlgebra(QQ, implementation='letterplace')\nsage: I = F*[x*y+y*z,x^2+x*y-y*x-y^2]*F\nsage: Q.<a,b,c> = F.quo(I); Q\nQuotient of Free Associative Unital Algebra on 3 generators (x, y, z) over Rational Field by the ideal (x*y + y*z, x*x + x*y - y*x - y*y)\nsage: a^3\n\nBreakpoint 1, dReportError (fmt=0x7fffcc8b2679 \"S_2_R[%d]=%d != T[%d].i_r=%d\\n\") at dError.c:28\n28\tdError.c: No such file or directory.\n(gdb) bt\n#0  dReportError (fmt=0x7fffcc8b2679 \"S_2_R[%d]=%d != T[%d].i_r=%d\\n\") at dError.c:28\n#1  0x00007fffcc5b860a in kTest_TS (strat=0x2d09920) at kutil.cc:861\n#2  0x00007fffcc5b0598 in bbaShift (F=0x18d0638, Q=0x0, w=0x0, hilb=0x0, strat=0x2d09920, uptodeg=3, lV=3)\n    at kstd2.cc:1724\n#3  0x00007fffcc5a79ed in kStdShift (F=0x18d0638, Q=0x0, h=isHomog, w=0x0, hilb=0x0, syzComp=0, \n    newIdeal=0, vw=0x0, uptodeg=3, lV=3) at kstd1.cc:1912\n#4  0x00007fffcc5b09ce in freegb (I=0x18d0638, uptodeg=3, lVblock=3) at kstd2.cc:1823\n#5  0x00007fffcc4e2301 in jjSYSTEM (res=0x2d06588, args=0x18d0548) at extra.cc:1370\n#6  0x00007fffcc4a06b5 in iiExprArithM (res=0x2d06588, a=0x18d0548, op=496) at iparith.cc:8321\n#7  0x00007fffcb9c3eb9 in __pyx_f_4sage_4libs_8singular_8function_17KernelCallHandler_handle_call (\n    __pyx_v_self=0x7fffb80d2880, __pyx_v_argument_list=0x7fffb80d1860, __pyx_optional_args=0x7fffffff7ef0)\n    at build/cythonized/sage/libs/singular/function.cpp:12083\n[...]\n(gdb) cy bt\n[...]\n#78 0x00007ffff7cd7b2d in _reduce_() at /home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sage/rings/quotient_ring_element.py:118\n       118            self.__rep = I.reduce(self.__rep)\n#83 0x00007fffb5ae04ce in reduce() at /home/vbraun/Sage/git-develop/src/sage/algebras/letterplace/letterplace_ideal.pyx:306\n       306        def reduce(self, G):\n#87 0x00007fffb5f90e45 in normal_form() at /home/vbraun/Sage/git-develop/src/sage/algebras/letterplace/free_algebra_element_letterplace.pyx:733\n       733        def normal_form(self,I):\n#93 0x00007fffb5ad9bb4 in groebner_basis() at /home/vbraun/Sage/git-develop/src/sage/algebras/letterplace/letterplace_ideal.pyx:187\n---Type <return> to continue, or q <return> to quit---\n       187        def groebner_basis(self, degbound=None):\n#96 0x00007fffcb9c5095 in __call__() at /home/vbraun/Sage/git-develop/src/sage/libs/singular/function.pyx:1185\n      1185        def __call__(self, *args, ring=None, bint interruptible=True, attributes=None):\n#98 0x00007fffcb9ca76b in call_function() at /home/vbraun/Sage/git-develop/src/sage/libs/singular/function.pyx:1462\n      1462                _res = self.call_handler.handle_call(argument_list, si_ring)\n#99 0x00007fffcb9c3d15 in handle_call() at /home/vbraun/Sage/git-develop/src/sage/libs/singular/function.pyx:1093\n      1093                iiExprArithM(res, argument_list.args, self.cmd_n)\n#100 0x00007fffcc4a029d in iiExprArithM()\n\n```",
    "created_at": "2014-09-12T15:22:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220417",
    "user": "https://github.com/vbraun"
}
```

For example:

```
(gdb) break dReportError
Breakpoint 1 at 0x7fffcc699a71: file dError.c, line 28.
(gdb) cont
Continuing.

sage: F.<x,y,z> = FreeAlgebra(QQ, implementation='letterplace')
sage: I = F*[x*y+y*z,x^2+x*y-y*x-y^2]*F
sage: Q.<a,b,c> = F.quo(I); Q
Quotient of Free Associative Unital Algebra on 3 generators (x, y, z) over Rational Field by the ideal (x*y + y*z, x*x + x*y - y*x - y*y)
sage: a^3

Breakpoint 1, dReportError (fmt=0x7fffcc8b2679 "S_2_R[%d]=%d != T[%d].i_r=%d\n") at dError.c:28
28	dError.c: No such file or directory.
(gdb) bt
#0  dReportError (fmt=0x7fffcc8b2679 "S_2_R[%d]=%d != T[%d].i_r=%d\n") at dError.c:28
#1  0x00007fffcc5b860a in kTest_TS (strat=0x2d09920) at kutil.cc:861
#2  0x00007fffcc5b0598 in bbaShift (F=0x18d0638, Q=0x0, w=0x0, hilb=0x0, strat=0x2d09920, uptodeg=3, lV=3)
    at kstd2.cc:1724
#3  0x00007fffcc5a79ed in kStdShift (F=0x18d0638, Q=0x0, h=isHomog, w=0x0, hilb=0x0, syzComp=0, 
    newIdeal=0, vw=0x0, uptodeg=3, lV=3) at kstd1.cc:1912
#4  0x00007fffcc5b09ce in freegb (I=0x18d0638, uptodeg=3, lVblock=3) at kstd2.cc:1823
#5  0x00007fffcc4e2301 in jjSYSTEM (res=0x2d06588, args=0x18d0548) at extra.cc:1370
#6  0x00007fffcc4a06b5 in iiExprArithM (res=0x2d06588, a=0x18d0548, op=496) at iparith.cc:8321
#7  0x00007fffcb9c3eb9 in __pyx_f_4sage_4libs_8singular_8function_17KernelCallHandler_handle_call (
    __pyx_v_self=0x7fffb80d2880, __pyx_v_argument_list=0x7fffb80d1860, __pyx_optional_args=0x7fffffff7ef0)
    at build/cythonized/sage/libs/singular/function.cpp:12083
[...]
(gdb) cy bt
[...]
#78 0x00007ffff7cd7b2d in _reduce_() at /home/vbraun/Sage/git-develop/local/lib/python2.7/site-packages/sage/rings/quotient_ring_element.py:118
       118            self.__rep = I.reduce(self.__rep)
#83 0x00007fffb5ae04ce in reduce() at /home/vbraun/Sage/git-develop/src/sage/algebras/letterplace/letterplace_ideal.pyx:306
       306        def reduce(self, G):
#87 0x00007fffb5f90e45 in normal_form() at /home/vbraun/Sage/git-develop/src/sage/algebras/letterplace/free_algebra_element_letterplace.pyx:733
       733        def normal_form(self,I):
#93 0x00007fffb5ad9bb4 in groebner_basis() at /home/vbraun/Sage/git-develop/src/sage/algebras/letterplace/letterplace_ideal.pyx:187
---Type <return> to continue, or q <return> to quit---
       187        def groebner_basis(self, degbound=None):
#96 0x00007fffcb9c5095 in __call__() at /home/vbraun/Sage/git-develop/src/sage/libs/singular/function.pyx:1185
      1185        def __call__(self, *args, ring=None, bint interruptible=True, attributes=None):
#98 0x00007fffcb9ca76b in call_function() at /home/vbraun/Sage/git-develop/src/sage/libs/singular/function.pyx:1462
      1462                _res = self.call_handler.handle_call(argument_list, si_ring)
#99 0x00007fffcb9c3d15 in handle_call() at /home/vbraun/Sage/git-develop/src/sage/libs/singular/function.pyx:1093
      1093                iiExprArithM(res, argument_list.args, self.cmd_n)
#100 0x00007fffcc4a029d in iiExprArithM()

```



---

archive/issue_comments_220418.json:
```json
{
    "body": "I can reproduce some failures just in Singular, so I've asked here: https://groups.google.com/d/msg/libsingular-devel/4fL9NKCVGw0/mlOd_vzNSG8J",
    "created_at": "2014-09-12T17:15:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220418",
    "user": "https://github.com/vbraun"
}
```

I can reproduce some failures just in Singular, so I've asked here: https://groups.google.com/d/msg/libsingular-devel/4fL9NKCVGw0/mlOd_vzNSG8J



---

archive/issue_comments_220419.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-12T20:39:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220419",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220420.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-13T18:44:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220420",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220421.json:
```json
{
    "body": "I think some internal Singular checks that get enabled with `NDEBUG` are too strict, I've added a patch removing these. I also almost despaired in `fast_map` until I noticed that `idTest` incorrectly assumes that `currRing` is set.\n\nNow `make ptest` passes.",
    "created_at": "2014-09-13T18:47:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220421",
    "user": "https://github.com/vbraun"
}
```

I think some internal Singular checks that get enabled with `NDEBUG` are too strict, I've added a patch removing these. I also almost despaired in `fast_map` until I noticed that `idTest` incorrectly assumes that `currRing` is set.

Now `make ptest` passes.



---

archive/issue_comments_220422.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-13T20:21:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220422",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220423.json:
```json
{
    "body": "Computing the invariants of an order-480 group after an order-48 group really only checks that you have a fast computer.\n\nThis fixes the last timeout in the `make ptestlong` for me.",
    "created_at": "2014-09-13T20:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220423",
    "user": "https://github.com/vbraun"
}
```

Computing the invariants of an order-480 group after an order-48 group really only checks that you have a fast computer.

This fixes the last timeout in the `make ptestlong` for me.



---

archive/issue_comments_220424.json:
```json
{
    "body": "Hi Volker, I am not happy with the two commits to reduce size of doctests.\n\nIt is said in the doc that `below we do the Fateman benchmark over the finite field of order 32003`, but I guess with your changes the statement becomes wrong, it isn't the Fateman benchmark if the exponent is only 10 and not 20.\n\nAlso I don't see why a test that is marked \"long\" anyway should be removed just because the debug version slows it down too much.\n\nBy the way, how long does this test take in non-debug version? It is stated that it used to take 12 seconds, four years ago. And 12 seconds is totally fine for a long test, IMHO.",
    "created_at": "2014-09-13T20:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220424",
    "user": "https://github.com/simon-king-jena"
}
```

Hi Volker, I am not happy with the two commits to reduce size of doctests.

It is said in the doc that `below we do the Fateman benchmark over the finite field of order 32003`, but I guess with your changes the statement becomes wrong, it isn't the Fateman benchmark if the exponent is only 10 and not 20.

Also I don't see why a test that is marked "long" anyway should be removed just because the debug version slows it down too much.

By the way, how long does this test take in non-debug version? It is stated that it used to take 12 seconds, four years ago. And 12 seconds is totally fine for a long test, IMHO.



---

archive/issue_comments_220425.json:
```json
{
    "body": "They are doctests, not benchmarks. Don't confuse the two. Really, showing off what size of a problem you can do in doctests is just an overall drag on development as people have to wait longer and longer for tests. IMHO 12 seconds is already on the long side, you should aim for <=5 for long tests.\n\nPut differently, would you rather \na) have a buildbot with `SAGE_DEBUG`, or \nb) doctest a huge computation and then discard the result because it can't do anything useful with the timings obtained.",
    "created_at": "2014-09-13T20:51:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220425",
    "user": "https://github.com/vbraun"
}
```

They are doctests, not benchmarks. Don't confuse the two. Really, showing off what size of a problem you can do in doctests is just an overall drag on development as people have to wait longer and longer for tests. IMHO 12 seconds is already on the long side, you should aim for <=5 for long tests.

Put differently, would you rather 
a) have a buildbot with `SAGE_DEBUG`, or 
b) doctest a huge computation and then discard the result because it can't do anything useful with the timings obtained.



---

archive/issue_comments_220426.json:
```json
{
    "body": "Replying to [comment:42 vbraun]:\n> They are doctests, not benchmarks. Don't confuse the two. Really, showing off what size of a problem you can do in doctests is just an overall drag on development as people have to wait longer and longer for tests. IMHO 12 seconds is already on the long side, you should aim for <=5 for long tests.\n> \n> Put differently, would you rather \n> a) have a buildbot with `SAGE_DEBUG`, or \n> b) doctest a huge computation and then discard the result because it can't do anything useful with the timings obtained.\n\n\nI'd rather have c): A buildbot with `SAGE_DEBUG` that only runs the tests that are not marked long.",
    "created_at": "2014-09-13T20:52:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220426",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:42 vbraun]:
> They are doctests, not benchmarks. Don't confuse the two. Really, showing off what size of a problem you can do in doctests is just an overall drag on development as people have to wait longer and longer for tests. IMHO 12 seconds is already on the long side, you should aim for <=5 for long tests.
> 
> Put differently, would you rather 
> a) have a buildbot with `SAGE_DEBUG`, or 
> b) doctest a huge computation and then discard the result because it can't do anything useful with the timings obtained.


I'd rather have c): A buildbot with `SAGE_DEBUG` that only runs the tests that are not marked long.



---

archive/issue_comments_220427.json:
```json
{
    "body": "I disagree. Doctests are not benchmarks. Doctests coverage is more important than benchvertising. We should have a framework for benchmarks in addition to doctests, but stuffing benchmarks into doctests is counterproductive.",
    "created_at": "2014-09-13T20:54:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220427",
    "user": "https://github.com/vbraun"
}
```

I disagree. Doctests are not benchmarks. Doctests coverage is more important than benchvertising. We should have a framework for benchmarks in addition to doctests, but stuffing benchmarks into doctests is counterproductive.



---

archive/issue_comments_220428.json:
```json
{
    "body": "I can not tell why the patchbot scripts are complaining. In any case, I get the following test failures:\n\n```\nsage -t src/sage/stats/hmm/hmm.pyx\n    [118 tests, 2 failures, 1.70 s]\n...\nsage -t src/sage/gsl/probability_distribution.pyx\n    [207 tests, 3 failures, 11.09 s]\n...\nsage -t src/sage/plot/plot3d/transform.pyx\n    [25 tests, 1 failure, 6.27 s]\n```\n\nUnfortunately it doesn't say what the failure is. Why does it not?",
    "created_at": "2014-09-14T07:57:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220428",
    "user": "https://github.com/simon-king-jena"
}
```

I can not tell why the patchbot scripts are complaining. In any case, I get the following test failures:

```
sage -t src/sage/stats/hmm/hmm.pyx
    [118 tests, 2 failures, 1.70 s]
...
sage -t src/sage/gsl/probability_distribution.pyx
    [207 tests, 3 failures, 11.09 s]
...
sage -t src/sage/plot/plot3d/transform.pyx
    [25 tests, 1 failure, 6.27 s]
```

Unfortunately it doesn't say what the failure is. Why does it not?



---

archive/issue_comments_220429.json:
```json
{
    "body": "Try `sage -t --verbose`. Also, I've never seen a failure to report whats wrong. Can you post the full log?",
    "created_at": "2014-09-14T11:25:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220429",
    "user": "https://github.com/vbraun"
}
```

Try `sage -t --verbose`. Also, I've never seen a failure to report whats wrong. Can you post the full log?



---

archive/issue_comments_220430.json:
```json
{
    "body": "Replying to [comment:46 vbraun]:\n> Try `sage -t --verbose`.\n\n\n```\n**********************************************************************\nFile \"src/sage/stats/hmm/hmm.pyx\", line 282, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel\nFailed example:\n    m\nExpected:\n    Discrete Hidden Markov Model with 2 States and 2 Emissions\n    Transition matrix:\n    [1.0134345614...e-70               1.0]\n    [              1.0 3.997435271...e-19]\n    Emission matrix:\n    [7.3802215662...e-54               1.0]\n    [              1.0  3.99743526...e-19]\n    Initial probabilities: [0.0000, 1.0000]\nGot:\n    Discrete Hidden Markov Model with 2 States and 2 Emissions\n    Transition matrix:\n    [1.0134345614745788e-70                    1.0]\n    [                   1.0 3.9974352713558623e-19]\n    Emission matrix:\n    [ 7.380221566254936e-54                    1.0]\n    [                   1.0 3.9974352626002193e-19]\n    Initial probabilities: [0.0000, 1.0000]\n**********************************************************************\nFile \"src/sage/stats/hmm/hmm.pyx\", line 1236, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel.baum_welch\nFailed example:\n    m.baum_welch(v)\nExpected:\n    (-66.7823606592935..., 100)\nGot:\n    (-66.7823606592936, 100)\n```\n\n```\n**********************************************************************\nFile \"src/sage/gsl/probability_distribution.pyx\", line 364, in sage.gsl.probability_distribution.RealDistribution\nFailed example:\n    T.cum_distribution_function_inv(.5)\nExpected:\n    3.532230067546424\nGot:\n    3.5322300675464247\n**********************************************************************\nFile \"src/sage/gsl/probability_distribution.pyx\", line 402, in sage.gsl.probability_distribution.RealDistribution\nFailed example:\n    T.distribution_function(0)\nExpected:\n    0.3183098861837906\nGot:\n    0.3183098861837905\nTrying (line 404):    T.cum_distribution_function(1)\nExpecting:\n    0.7499999999999998\n**********************************************************************\nFile \"src/sage/gsl/probability_distribution.pyx\", line 404, in sage.gsl.probability_distribution.RealDistribution\nFailed example:\n    T.cum_distribution_function(1)\nExpected:\n    0.7499999999999998\nGot:\n    0.75\n```\n\n```\n*********************************************************************\nFile \"src/sage/plot/plot3d/transform.pyx\", line 179, in sage.plot.plot3d.transform.rotate_arbitrary\nFailed example:\n    rotate_arbitrary((1,1,1), 2*pi/3) * vector(RDF, (1,2,3))  # rel tol 1e-15\nExpected:\n    (1.9999999999999996, 2.9999999999999996, 0.9999999999999999)\nGot:\n    (2.000000000000001, 3.0000000000000013, 1.000000000000001)\nTolerance exceeded in 1 of 3:\n    0.9999999999999999 vs 1.000000000000001, tolerance 1e-15 > 1e-15\n```\n\n> Also, I've never seen a failure to report whats wrong.\n\n\nYes, but I have always seen a failure to report what has failed.\n\nBut here, there is simply nothing in the log. It simply says that some tests failed, but not WHICH test failed, not what was the expected output and the actual output, not whether there has been a crash. Absolutely nothing.\n\n> Can you post the full log?\n\n\nNot before Monday (bandwidth).\n\nAnyway, the verbose output above indicates that we have numerical noise, not related with Singular. By the way, if that's relevant: In my local branch I have merged your gdb branch from #16978.",
    "created_at": "2014-09-14T13:04:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220430",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:46 vbraun]:
> Try `sage -t --verbose`.


```
**********************************************************************
File "src/sage/stats/hmm/hmm.pyx", line 282, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel
Failed example:
    m
Expected:
    Discrete Hidden Markov Model with 2 States and 2 Emissions
    Transition matrix:
    [1.0134345614...e-70               1.0]
    [              1.0 3.997435271...e-19]
    Emission matrix:
    [7.3802215662...e-54               1.0]
    [              1.0  3.99743526...e-19]
    Initial probabilities: [0.0000, 1.0000]
Got:
    Discrete Hidden Markov Model with 2 States and 2 Emissions
    Transition matrix:
    [1.0134345614745788e-70                    1.0]
    [                   1.0 3.9974352713558623e-19]
    Emission matrix:
    [ 7.380221566254936e-54                    1.0]
    [                   1.0 3.9974352626002193e-19]
    Initial probabilities: [0.0000, 1.0000]
**********************************************************************
File "src/sage/stats/hmm/hmm.pyx", line 1236, in sage.stats.hmm.hmm.DiscreteHiddenMarkovModel.baum_welch
Failed example:
    m.baum_welch(v)
Expected:
    (-66.7823606592935..., 100)
Got:
    (-66.7823606592936, 100)
```

```
**********************************************************************
File "src/sage/gsl/probability_distribution.pyx", line 364, in sage.gsl.probability_distribution.RealDistribution
Failed example:
    T.cum_distribution_function_inv(.5)
Expected:
    3.532230067546424
Got:
    3.5322300675464247
**********************************************************************
File "src/sage/gsl/probability_distribution.pyx", line 402, in sage.gsl.probability_distribution.RealDistribution
Failed example:
    T.distribution_function(0)
Expected:
    0.3183098861837906
Got:
    0.3183098861837905
Trying (line 404):    T.cum_distribution_function(1)
Expecting:
    0.7499999999999998
**********************************************************************
File "src/sage/gsl/probability_distribution.pyx", line 404, in sage.gsl.probability_distribution.RealDistribution
Failed example:
    T.cum_distribution_function(1)
Expected:
    0.7499999999999998
Got:
    0.75
```

```
*********************************************************************
File "src/sage/plot/plot3d/transform.pyx", line 179, in sage.plot.plot3d.transform.rotate_arbitrary
Failed example:
    rotate_arbitrary((1,1,1), 2*pi/3) * vector(RDF, (1,2,3))  # rel tol 1e-15
Expected:
    (1.9999999999999996, 2.9999999999999996, 0.9999999999999999)
Got:
    (2.000000000000001, 3.0000000000000013, 1.000000000000001)
Tolerance exceeded in 1 of 3:
    0.9999999999999999 vs 1.000000000000001, tolerance 1e-15 > 1e-15
```

> Also, I've never seen a failure to report whats wrong.


Yes, but I have always seen a failure to report what has failed.

But here, there is simply nothing in the log. It simply says that some tests failed, but not WHICH test failed, not what was the expected output and the actual output, not whether there has been a crash. Absolutely nothing.

> Can you post the full log?


Not before Monday (bandwidth).

Anyway, the verbose output above indicates that we have numerical noise, not related with Singular. By the way, if that's relevant: In my local branch I have merged your gdb branch from #16978.



---

archive/issue_comments_220431.json:
```json
{
    "body": "Hans sent a patch for one of the debug build issues to libsingular-devel, I've added it and removed my patch that disabled various checks. If he manages to fix the rest then we might not need my patch...\n\n---\nNew commits:",
    "created_at": "2014-09-15T21:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220431",
    "user": "https://github.com/vbraun"
}
```

Hans sent a patch for one of the debug build issues to libsingular-devel, I've added it and removed my patch that disabled various checks. If he manages to fix the rest then we might not need my patch...

---
New commits:



---

archive/issue_comments_220432.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-09-15T21:16:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220432",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_220433.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-16T16:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220433",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220434.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-09-18T12:27:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220434",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220435.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-09-22T15:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220435",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_220436.json:
```json
{
    "body": "I've reported the failures on libsingular-devel and Hans posted patches for all of them. Branch now compiles/doctests fine for me without disabling any debug statements.",
    "created_at": "2014-09-22T15:02:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220436",
    "user": "https://github.com/vbraun"
}
```

I've reported the failures on libsingular-devel and Hans posted patches for all of them. Branch now compiles/doctests fine for me without disabling any debug statements.



---

archive/issue_comments_220437.json:
```json
{
    "body": "Replying to [comment:52 vbraun]:\n> I've reported the failures on libsingular-devel and Hans posted patches for all of them. Branch now compiles/doctests fine for me without disabling any debug statements.\n\n\nExcellent!",
    "created_at": "2014-09-22T15:11:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220437",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:52 vbraun]:
> I've reported the failures on libsingular-devel and Hans posted patches for all of them. Branch now compiles/doctests fine for me without disabling any debug statements.


Excellent!



---

archive/issue_comments_220438.json:
```json
{
    "body": "Replying to [comment:52 vbraun]:\n> I've reported the failures on libsingular-devel and Hans posted patches for all of them. Branch now compiles/doctests fine for me without disabling any debug statements.\n\n\nThe branch did not change since four days. So, is it the case that the branch contains all of Hans' patches, or do you need to push another commit?",
    "created_at": "2014-09-22T15:29:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220438",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:52 vbraun]:
> I've reported the failures on libsingular-devel and Hans posted patches for all of them. Branch now compiles/doctests fine for me without disabling any debug statements.


The branch did not change since four days. So, is it the case that the branch contains all of Hans' patches, or do you need to push another commit?



---

archive/issue_comments_220439.json:
```json
{
    "body": "I was just busy elsewhere...",
    "created_at": "2014-09-22T15:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220439",
    "user": "https://github.com/vbraun"
}
```

I was just busy elsewhere...



---

archive/issue_comments_220440.json:
```json
{
    "body": "imho there is little to review here... it works, and most of the patches come straight from upstream.",
    "created_at": "2014-09-26T22:35:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220440",
    "user": "https://github.com/vbraun"
}
```

imho there is little to review here... it works, and most of the patches come straight from upstream.



---

archive/issue_comments_220441.json:
```json
{
    "body": "I'll try to review it, although I am one of the authors...",
    "created_at": "2014-09-30T12:30:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220441",
    "user": "https://github.com/simon-king-jena"
}
```

I'll try to review it, although I am one of the authors...



---

archive/issue_comments_220442.json:
```json
{
    "body": "Replying to [comment:47 SimonKing]:\n> But here, there is simply nothing in the log. It simply says that some tests failed, but not WHICH test failed, not what was the expected output and the actual output, not whether there has been a crash. Absolutely nothing.\n\nI have heard occasional rumours that this happens sometimes, but I have no idea how to reproduce it.\n\n---\nNew commits:",
    "created_at": "2014-09-30T15:06:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220442",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:47 SimonKing]:
> But here, there is simply nothing in the log. It simply says that some tests failed, but not WHICH test failed, not what was the expected output and the actual output, not whether there has been a crash. Absolutely nothing.

I have heard occasional rumours that this happens sometimes, but I have no idea how to reproduce it.

---
New commits:



---

archive/issue_comments_220443.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-09-30T20:33:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220443",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_220444.json:
```json
{
    "body": "Thank you, Jeroen. I would have needed to run tests overnight to finish the review. But I do think that the patched patches look OK.",
    "created_at": "2014-09-30T20:40:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220444",
    "user": "https://github.com/simon-king-jena"
}
```

Thank you, Jeroen. I would have needed to run tests overnight to finish the review. But I do think that the patched patches look OK.



---

archive/issue_comments_220445.json:
```json
{
    "body": "The `conway_polynomials` package fails to build, even though I have `SAGE_UPGRADING` set to `yes`. [See logs](http://sage.math.washington.edu/home/SimonKing/logs/conway_polynomials-0.4.p0.log)\n\nIs there a problem with the debug? Or is it a problem with \"make\" and dependency checking?",
    "created_at": "2014-10-01T04:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220445",
    "user": "https://github.com/simon-king-jena"
}
```

The `conway_polynomials` package fails to build, even though I have `SAGE_UPGRADING` set to `yes`. [See logs](http://sage.math.washington.edu/home/SimonKing/logs/conway_polynomials-0.4.p0.log)

Is there a problem with the debug? Or is it a problem with "make" and dependency checking?



---

archive/issue_comments_220446.json:
```json
{
    "body": "Changing status from positive_review to needs_info.",
    "created_at": "2014-10-01T04:59:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220446",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from positive_review to needs_info.



---

archive/issue_comments_220447.json:
```json
{
    "body": "Did you build everything with this ticket applied and with `SAGE_DEBUG=yes`?",
    "created_at": "2014-10-01T06:25:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220447",
    "user": "https://github.com/jdemeyer"
}
```

Did you build everything with this ticket applied and with `SAGE_DEBUG=yes`?



---

archive/issue_comments_220448.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-01T07:24:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220448",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220449.json:
```json
{
    "body": "Replying to [comment:62 SimonKing]:\n> Is there a problem with the debug?\n\nLooks like a genuine bug to me in libm4ri. I don't know why they need `sizeof(mzd_t) == 64`, but that equality is only true on 64-bit systems. Since two of the fields in `mzd_t` are pointers, this would give only 56 bytes on 32-bit systems.\n\nI'll try to reproduce it and report upstream if it is confirmed.",
    "created_at": "2014-10-01T07:37:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220449",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:62 SimonKing]:
> Is there a problem with the debug?

Looks like a genuine bug to me in libm4ri. I don't know why they need `sizeof(mzd_t) == 64`, but that equality is only true on 64-bit systems. Since two of the fields in `mzd_t` are pointers, this would give only 56 bytes on 32-bit systems.

I'll try to reproduce it and report upstream if it is confirmed.



---

archive/issue_comments_220450.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-01T08:17:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220450",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220451.json:
```json
{
    "body": "Replying to [comment:65 jdemeyer]:\n> Replying to [comment:62 SimonKing]:\n> > Is there a problem with the debug?\n\n> Looks like a genuine bug to me in libm4ri. I don't know why they need `sizeof(mzd_t) == 64`, but that equality is only true on 64-bit systems. Since two of the fields in `mzd_t` are pointers, this would give only 56 bytes on 32-bit systems.\n> \n> I'll try to reproduce it and report upstream if it is confirmed.\n\n\nWould be surprising to me. After all, in an earlier debug version on this ticket, Sage did build. Now it doesn't. Anyway, I will try with your latest commit.",
    "created_at": "2014-10-01T09:12:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220451",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:65 jdemeyer]:
> Replying to [comment:62 SimonKing]:
> > Is there a problem with the debug?

> Looks like a genuine bug to me in libm4ri. I don't know why they need `sizeof(mzd_t) == 64`, but that equality is only true on 64-bit systems. Since two of the fields in `mzd_t` are pointers, this would give only 56 bytes on 32-bit systems.
> 
> I'll try to reproduce it and report upstream if it is confirmed.


Would be surprising to me. After all, in an earlier debug version on this ticket, Sage did build. Now it doesn't. Anyway, I will try with your latest commit.



---

archive/issue_comments_220452.json:
```json
{
    "body": "Replying to [comment:67 SimonKing]:\n> Would be surprising to me. After all, in an earlier debug version on this ticket, Sage did build.\n\nWas that after #16981?",
    "created_at": "2014-10-01T09:21:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220452",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:67 SimonKing]:
> Would be surprising to me. After all, in an earlier debug version on this ticket, Sage did build.

Was that after #16981?



---

archive/issue_comments_220453.json:
```json
{
    "body": "Replying to [comment:68 jdemeyer]:\n> Replying to [comment:67 SimonKing]:\n> > Would be surprising to me. After all, in an earlier debug version on this ticket, Sage did build.\n\n> Was that after #16981?\n\nNo idea. And I actually doubt that M4RI is to blame. After all, the error occurs in the line\n\n```\n>    4    from sage.all import save\n```\nwhen installing the Conway polynomial package.",
    "created_at": "2014-10-01T09:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220453",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:68 jdemeyer]:
> Replying to [comment:67 SimonKing]:
> > Would be surprising to me. After all, in an earlier debug version on this ticket, Sage did build.

> Was that after #16981?

No idea. And I actually doubt that M4RI is to blame. After all, the error occurs in the line

```
>    4    from sage.all import save
```
when installing the Conway polynomial package.



---

archive/issue_comments_220454.json:
```json
{
    "body": "Note that in addition to the install log that I posted earlier, there also is a [Crash Log](http://sage.math.washington.edu/home/SimonKing/logs/sage_crash_XN6UDt.log) that is the result of the failing import.",
    "created_at": "2014-10-01T09:45:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220454",
    "user": "https://github.com/simon-king-jena"
}
```

Note that in addition to the install log that I posted earlier, there also is a [Crash Log](http://sage.math.washington.edu/home/SimonKing/logs/sage_crash_XN6UDt.log) that is the result of the failing import.



---

archive/issue_comments_220455.json:
```json
{
    "body": "Replying to [comment:69 SimonKing]:\n> the error occurs in the line\n> \n> ```\n> >    4    from sage.all import save\n> ```\n> when installing the Conway polynomial package.\n\nThat's just the top of the traceback. Importing `sage.all` does a lot of things. The full traceback clearly shows that the problem is in m4ri:\n\n```\nStack backtrace\n---------------\n[...]\n#8  0xb72e9d07 in __assert_fail () from /lib/libc.so.6\nNo symbol table info available.\n#9  0xb18e62f1 in mzd_init (r=7, c=7) at m4ri/mzd.c:151\n        __PRETTY_FUNCTION__ = \"mzd_init\"\n#10 0xb19270c4 in __pyx_pf_4sage_6matrix_17matrix_mod2_dense_17Matrix_mod2_dense___cinit__ (__pyx_v_self=0xad884034, __pyx_v_parent=0xace7b2f4, \n    __pyx_v_entries=0xad874fbc, __pyx_v_copy=0xb76a48ec <_Py_ZeroStruct>, \n    __pyx_v_coerce=0xb76a4900 <_Py_TrueStruct>, \n    __pyx_v_alloc=0xb76a4900 <_Py_TrueStruct>)\n    at build/cythonized/sage/matrix/matrix_mod2_dense.c:3313\n        __pyx_r = 1245376913\n        __pyx_t_1 = 0x0\n        __pyx_t_2 = 0x0\n        __pyx_t_3 = 0x0\n        __pyx_t_4 = 0\n        __pyx_t_5 = 0x0\n        __pyx_t_6 = 1\n        __pyx_lineno = 0\n        __pyx_filename = 0x0\n        __pyx_clineno = 0\n[...]\n```",
    "created_at": "2014-10-01T09:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220455",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:69 SimonKing]:
> the error occurs in the line
> 
> ```
> >    4    from sage.all import save
> ```
> when installing the Conway polynomial package.

That's just the top of the traceback. Importing `sage.all` does a lot of things. The full traceback clearly shows that the problem is in m4ri:

```
Stack backtrace
---------------
[...]
#8  0xb72e9d07 in __assert_fail () from /lib/libc.so.6
No symbol table info available.
#9  0xb18e62f1 in mzd_init (r=7, c=7) at m4ri/mzd.c:151
        __PRETTY_FUNCTION__ = "mzd_init"
#10 0xb19270c4 in __pyx_pf_4sage_6matrix_17matrix_mod2_dense_17Matrix_mod2_dense___cinit__ (__pyx_v_self=0xad884034, __pyx_v_parent=0xace7b2f4, 
    __pyx_v_entries=0xad874fbc, __pyx_v_copy=0xb76a48ec <_Py_ZeroStruct>, 
    __pyx_v_coerce=0xb76a4900 <_Py_TrueStruct>, 
    __pyx_v_alloc=0xb76a4900 <_Py_TrueStruct>)
    at build/cythonized/sage/matrix/matrix_mod2_dense.c:3313
        __pyx_r = 1245376913
        __pyx_t_1 = 0x0
        __pyx_t_2 = 0x0
        __pyx_t_3 = 0x0
        __pyx_t_4 = 0
        __pyx_t_5 = 0x0
        __pyx_t_6 = 1
        __pyx_lineno = 0
        __pyx_filename = 0x0
        __pyx_clineno = 0
[...]
```



---

archive/issue_comments_220456.json:
```json
{
    "body": "Changing status from needs_info to needs_review.",
    "created_at": "2014-10-01T09:57:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220456",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_info to needs_review.



---

archive/issue_comments_220457.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-01T10:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220457",
    "user": "https://github.com/simon-king-jena"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_220458.json:
```json
{
    "body": "The build problem that I obtain is with the latest commit (53b73dbfaf33d8e28840d5b6ad91ce1bf941cffa), hence, it needs work.",
    "created_at": "2014-10-01T10:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220458",
    "user": "https://github.com/simon-king-jena"
}
```

The build problem that I obtain is with the latest commit (53b73dbfaf33d8e28840d5b6ad91ce1bf941cffa), hence, it needs work.



---

archive/issue_comments_220459.json:
```json
{
    "body": "Are you really really sure? The patch fixes the problem for me. Don't forget to rebuild m4ri!",
    "created_at": "2014-10-01T10:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220459",
    "user": "https://github.com/jdemeyer"
}
```

Are you really really sure? The patch fixes the problem for me. Don't forget to rebuild m4ri!



---

archive/issue_comments_220460.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-01T10:06:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220460",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_220461.json:
```json
{
    "body": "Replying to [comment:74 jdemeyer]:\n> Are you really really sure? The patch fixes the problem for me. Don't forget to rebuild m4ri!\n\n\nThen we come back to my question above: Is it a problem with dependency checking? I did `make` with `SAGE_UPGRADING=yes`, and it didn't work.",
    "created_at": "2014-10-01T10:16:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220461",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:74 jdemeyer]:
> Are you really really sure? The patch fixes the problem for me. Don't forget to rebuild m4ri!


Then we come back to my question above: Is it a problem with dependency checking? I did `make` with `SAGE_UPGRADING=yes`, and it didn't work.



---

archive/issue_comments_220462.json:
```json
{
    "body": "For the record: Now I explicitly did `sage -i m4ri` before doing `make` again. Let's see if it works this time.",
    "created_at": "2014-10-01T10:17:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220462",
    "user": "https://github.com/simon-king-jena"
}
```

For the record: Now I explicitly did `sage -i m4ri` before doing `make` again. Let's see if it works this time.



---

archive/issue_comments_220463.json:
```json
{
    "body": "It does start. Now let us wait for the tests...",
    "created_at": "2014-10-01T10:28:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220463",
    "user": "https://github.com/simon-king-jena"
}
```

It does start. Now let us wait for the tests...



---

archive/issue_comments_220464.json:
```json
{
    "body": "Replying to [comment:75 SimonKing]:\n> Is it a problem with dependency checking?\n\nNot really. You built a broken version of m4ri before and that broken version will not automatically be updated when doing \"make\". However, as long as you don't first build a broken version with `SAGE_DEBUG=yes` without applying this patch, there is no problem.\n\nOne could argue that there is a problem with dependency checking in the sense that `SAGE_DEBUG=yes` does not automatically cause everything to get rebuilt. But that's really a different issue.",
    "created_at": "2014-10-01T10:49:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220464",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:75 SimonKing]:
> Is it a problem with dependency checking?

Not really. You built a broken version of m4ri before and that broken version will not automatically be updated when doing "make". However, as long as you don't first build a broken version with `SAGE_DEBUG=yes` without applying this patch, there is no problem.

One could argue that there is a problem with dependency checking in the sense that `SAGE_DEBUG=yes` does not automatically cause everything to get rebuilt. But that's really a different issue.



---

archive/issue_comments_220465.json:
```json
{
    "body": "Next, I was bitten again by the infamous \"incremental documentation builds sometimes cause spurious\". Sigh.",
    "created_at": "2014-10-01T10:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220465",
    "user": "https://github.com/simon-king-jena"
}
```

Next, I was bitten again by the infamous "incremental documentation builds sometimes cause spurious". Sigh.



---

archive/issue_comments_220466.json:
```json
{
    "body": "hashdist also takes build switches / environment variables into account for the dependency calculation, fwiw.\n\nUntil then I think its reasonable to require a \"make distclean\" to switch between debug and non-debug build.",
    "created_at": "2014-10-01T11:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220466",
    "user": "https://github.com/vbraun"
}
```

hashdist also takes build switches / environment variables into account for the dependency calculation, fwiw.

Until then I think its reasonable to require a "make distclean" to switch between debug and non-debug build.



---

archive/issue_comments_220467.json:
```json
{
    "body": "Replying to [comment:80 vbraun]:\n> hashdist\n\nIs this another of the many proposals to change the Sage build system with something else? I feel like I have seen too many of these...",
    "created_at": "2014-10-01T11:51:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220467",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:80 vbraun]:
> hashdist

Is this another of the many proposals to change the Sage build system with something else? I feel like I have seen too many of these...



---

archive/issue_comments_220468.json:
```json
{
    "body": "So far there is one error, and it seems to be a serious problem, namely a segmentation fault:\n\n```\nsage -t src/sage/modular/modsym/space.py\n**********************************************************************\nFile \"src/sage/modular/modsym/space.py\", line 930, in sage.modular.modsym.space.ModularSymbolsSpace._q_expansion_module\nFailed example:\n    ModularSymbols(11, 2, base_ring=GF(4,'a')).cuspidal_submodule()._q_expansion_module(prec=4, algorithm=\"hecke\")\nException raised:\n    Traceback (most recent call last):\n      File \"/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 486, in _run\n        self.compile_and_execute(example, compiler, test.globs)\n      File \"/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py\", line 849, in compile_and_execute\n        exec(compiled, globs)\n      File \"<doctest sage.modular.modsym.space.ModularSymbolsSpace._q_expansion_module[0]>\", line 1, in <module>\n        ModularSymbols(Integer(11), Integer(2), base_ring=GF(Integer(4),'a')).cuspidal_submodule()._q_expansion_module(prec=Integer(4), algorithm=\"hecke\")\n      File \"/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/modular/modsym/ambient.py\", line 1392, in cuspidal_submodule\n        S = self.boundary_map().kernel()\n      File \"/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/modules/matrix_morphism.py\", line 649, in kernel\n        V = self.matrix().kernel()\n      File \"sage/matrix/matrix2.pyx\", line 3755, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:23920)\n      File \"sage/matrix/matrix2.pyx\", line 3596, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:23371)\n      File \"sage/matrix/matrix2.pyx\", line 3244, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:22751)\n      File \"sage/matrix/matrix2.pyx\", line 6119, in sage.matrix.matrix2.Matrix.echelon_form (build/cythonized/sage/matrix/matrix2.c:42445)\n      File \"sage/matrix/matrix_mod2e_dense.pyx\", line 946, in sage.matrix.matrix_mod2e_dense.Matrix_mod2e_dense.echelonize (build/cythonized/sage/matrix/matrix_mod2e_dense.c:7938)\n      File \"sage/ext/c_lib.pyx\", line 97, in sage.ext.c_lib.sig_raise_exception (build/cythonized/sage/ext/c_lib.c:1168)\n    SignalError: Segmentation fault\n**********************************************************************\n1 item had failures:\n   1 of   3 in sage.modular.modsym.space.ModularSymbolsSpace._q_expansion_module\n    [313 tests, 1 failure, 43.51 s]\n```",
    "created_at": "2014-10-01T12:28:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220468",
    "user": "https://github.com/simon-king-jena"
}
```

So far there is one error, and it seems to be a serious problem, namely a segmentation fault:

```
sage -t src/sage/modular/modsym/space.py
**********************************************************************
File "src/sage/modular/modsym/space.py", line 930, in sage.modular.modsym.space.ModularSymbolsSpace._q_expansion_module
Failed example:
    ModularSymbols(11, 2, base_ring=GF(4,'a')).cuspidal_submodule()._q_expansion_module(prec=4, algorithm="hecke")
Exception raised:
    Traceback (most recent call last):
      File "/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 486, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/doctest/forker.py", line 849, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.modular.modsym.space.ModularSymbolsSpace._q_expansion_module[0]>", line 1, in <module>
        ModularSymbols(Integer(11), Integer(2), base_ring=GF(Integer(4),'a')).cuspidal_submodule()._q_expansion_module(prec=Integer(4), algorithm="hecke")
      File "/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/modular/modsym/ambient.py", line 1392, in cuspidal_submodule
        S = self.boundary_map().kernel()
      File "/home/king/Sage/debug/sage/local/lib/python2.7/site-packages/sage/modules/matrix_morphism.py", line 649, in kernel
        V = self.matrix().kernel()
      File "sage/matrix/matrix2.pyx", line 3755, in sage.matrix.matrix2.Matrix.left_kernel (build/cythonized/sage/matrix/matrix2.c:23920)
      File "sage/matrix/matrix2.pyx", line 3596, in sage.matrix.matrix2.Matrix.right_kernel (build/cythonized/sage/matrix/matrix2.c:23371)
      File "sage/matrix/matrix2.pyx", line 3244, in sage.matrix.matrix2.Matrix.right_kernel_matrix (build/cythonized/sage/matrix/matrix2.c:22751)
      File "sage/matrix/matrix2.pyx", line 6119, in sage.matrix.matrix2.Matrix.echelon_form (build/cythonized/sage/matrix/matrix2.c:42445)
      File "sage/matrix/matrix_mod2e_dense.pyx", line 946, in sage.matrix.matrix_mod2e_dense.Matrix_mod2e_dense.echelonize (build/cythonized/sage/matrix/matrix_mod2e_dense.c:7938)
      File "sage/ext/c_lib.pyx", line 97, in sage.ext.c_lib.sig_raise_exception (build/cythonized/sage/ext/c_lib.c:1168)
    SignalError: Segmentation fault
**********************************************************************
1 item had failures:
   1 of   3 in sage.modular.modsym.space.ModularSymbolsSpace._q_expansion_module
    [313 tests, 1 failure, 43.51 s]
```



---

archive/issue_comments_220469.json:
```json
{
    "body": "Replying to [comment:80 vbraun]:\n> Until then I think its reasonable to require a \"make distclean\" to switch between debug and non-debug build.\n\n\nI did *not* switch between debug and non-debug build. I have one sage git repository which I have never touched without `SAGE_DEBUG` being set to `yes`. Nevertheless, things got wrong.",
    "created_at": "2014-10-01T12:29:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220469",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:80 vbraun]:
> Until then I think its reasonable to require a "make distclean" to switch between debug and non-debug build.


I did *not* switch between debug and non-debug build. I have one sage git repository which I have never touched without `SAGE_DEBUG` being set to `yes`. Nevertheless, things got wrong.



---

archive/issue_comments_220470.json:
```json
{
    "body": "Replying to [comment:83 SimonKing]:\n> Nevertheless, things got wrong.\n\n...while testing a ticket in development. You cannot do development without things breaking now and then. The goal is that the end result of a ticket works, there are no guarantees about what happens in between.",
    "created_at": "2014-10-01T12:33:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220470",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:83 SimonKing]:
> Nevertheless, things got wrong.

...while testing a ticket in development. You cannot do development without things breaking now and then. The goal is that the end result of a ticket works, there are no guarantees about what happens in between.



---

archive/issue_comments_220471.json:
```json
{
    "body": "Martin, can you comment on the 64-bit alignment issue in m4ri?",
    "created_at": "2014-10-01T12:35:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220471",
    "user": "https://github.com/vbraun"
}
```

Martin, can you comment on the 64-bit alignment issue in m4ri?



---

archive/issue_comments_220472.json:
```json
{
    "body": "Replying to [comment:82 SimonKing]:\n> So far there is one error, and it seems to be a serious problem, namely a segmentation fault:\n\nWorks for me. The problem seems to be in `m4rie`, did you remember to rebuild with `SAGE_UPGRADING=yes` after rebuilding `mpir`?",
    "created_at": "2014-10-01T12:37:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220472",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:82 SimonKing]:
> So far there is one error, and it seems to be a serious problem, namely a segmentation fault:

Works for me. The problem seems to be in `m4rie`, did you remember to rebuild with `SAGE_UPGRADING=yes` after rebuilding `mpir`?



---

archive/issue_comments_220473.json:
```json
{
    "body": "Replying to [comment:86 jdemeyer]:\n> Replying to [comment:82 SimonKing]:\n> > So far there is one error, and it seems to be a serious problem, namely a segmentation fault:\n\n> Works for me. Did you remember to rebuild with `SAGE_UPGRADING=yes` after rebuilding `mpir`?\n\nI currently have `SAGE_UPGRADING=yes` by default.",
    "created_at": "2014-10-01T12:40:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220473",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:86 jdemeyer]:
> Replying to [comment:82 SimonKing]:
> > So far there is one error, and it seems to be a serious problem, namely a segmentation fault:

> Works for me. Did you remember to rebuild with `SAGE_UPGRADING=yes` after rebuilding `mpir`?

I currently have `SAGE_UPGRADING=yes` by default.



---

archive/issue_comments_220474.json:
```json
{
    "body": "Replying to [comment:84 jdemeyer]:\n> Replying to [comment:83 SimonKing]:\n> > Nevertheless, things got wrong.\n\n> ...while testing a ticket in development. You cannot do development without things breaking now and then. The goal is that the end result of a ticket works, there are no guarantees about what happens in between.\n\nOK, but I think that dependency checking should work, regardless whether it is a debug or a non-debug built.\n\nAnyway, meanwhile I got loads of other errors. I will next try `make distclean` and `make`, with `SAGE_DEBUG=yes` and unsetting `SAGE_UPGRADING`.",
    "created_at": "2014-10-01T12:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220474",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:84 jdemeyer]:
> Replying to [comment:83 SimonKing]:
> > Nevertheless, things got wrong.

> ...while testing a ticket in development. You cannot do development without things breaking now and then. The goal is that the end result of a ticket works, there are no guarantees about what happens in between.

OK, but I think that dependency checking should work, regardless whether it is a debug or a non-debug built.

Anyway, meanwhile I got loads of other errors. I will next try `make distclean` and `make`, with `SAGE_DEBUG=yes` and unsetting `SAGE_UPGRADING`.



---

archive/issue_comments_220475.json:
```json
{
    "body": "Replying to [comment:88 SimonKing]:\n> OK, but I think that dependency checking should work, regardless whether it is a debug or a non-debug built.\n\nDependency checking works (modulo #17072).\n\nThe problem is that building with `SAGE_DEBUG=yes` didn't work before, but the problem with `m4ri` wasn't seen at build-time of `m4ri`. Therefore, the build system thinks that the build of `m4ri` was successful, even though it was completely broken. This is a very specific set of circumstances, I don't think it requires a fix to the build system.",
    "created_at": "2014-10-01T12:47:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220475",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:88 SimonKing]:
> OK, but I think that dependency checking should work, regardless whether it is a debug or a non-debug built.

Dependency checking works (modulo #17072).

The problem is that building with `SAGE_DEBUG=yes` didn't work before, but the problem with `m4ri` wasn't seen at build-time of `m4ri`. Therefore, the build system thinks that the build of `m4ri` was successful, even though it was completely broken. This is a very specific set of circumstances, I don't think it requires a fix to the build system.



---

archive/issue_comments_220476.json:
```json
{
    "body": "Simon, just to be sure, I will try to reproduce your bug on a 32-bit system:\n\n```\n$ export SAGE_UPGRADING=yes SAGE_DEBUG=yes\n$ git checkout 0fb627916b73a741be1d942b0d94fd0046dc2536\n$ make    # should fail in conway_polynomials\n$ git checkout 53b73dbfaf33d8e28840d5b6ad91ce1bf941cffa\n$ ./sage -f m4ri\n$ make ptest\n```",
    "created_at": "2014-10-01T13:20:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220476",
    "user": "https://github.com/jdemeyer"
}
```

Simon, just to be sure, I will try to reproduce your bug on a 32-bit system:

```
$ export SAGE_UPGRADING=yes SAGE_DEBUG=yes
$ git checkout 0fb627916b73a741be1d942b0d94fd0046dc2536
$ make    # should fail in conway_polynomials
$ git checkout 53b73dbfaf33d8e28840d5b6ad91ce1bf941cffa
$ ./sage -f m4ri
$ make ptest
```



---

archive/issue_comments_220477.json:
```json
{
    "body": "Replying to [comment:90 jdemeyer]:\n> Simon, just to be sure, I will try to reproduce your bug on a 32-bit system:\n> \n> ```\n> $ export SAGE_UPGRADING=yes SAGE_DEBUG=yes\n> $ git checkout 0fb627916b73a741be1d942b0d94fd0046dc2536\n> $ make    # should fail in conway_polynomials\n> $ git checkout 53b73dbfaf33d8e28840d5b6ad91ce1bf941cffa\n> $ ./sage -f m4ri\n> $ make ptest\n> ```\n\n\nI am on 64 bit, if I am not mistaken.",
    "created_at": "2014-10-01T13:29:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220477",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:90 jdemeyer]:
> Simon, just to be sure, I will try to reproduce your bug on a 32-bit system:
> 
> ```
> $ export SAGE_UPGRADING=yes SAGE_DEBUG=yes
> $ git checkout 0fb627916b73a741be1d942b0d94fd0046dc2536
> $ make    # should fail in conway_polynomials
> $ git checkout 53b73dbfaf33d8e28840d5b6ad91ce1bf941cffa
> $ ./sage -f m4ri
> $ make ptest
> ```


I am on 64 bit, if I am not mistaken.



---

archive/issue_comments_220478.json:
```json
{
    "body": "Replying to [comment:91 SimonKing]:\n> I am on 64 bit, if I am not mistaken.\n\nYour [comment:62 previous error] was on a 32-bit system.",
    "created_at": "2014-10-01T13:32:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220478",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:91 SimonKing]:
> I am on 64 bit, if I am not mistaken.

Your [comment:62 previous error] was on a 32-bit system.



---

archive/issue_comments_220479.json:
```json
{
    "body": "Replying to [comment:92 jdemeyer]:\n> Replying to [comment:91 SimonKing]:\n> > I am on 64 bit, if I am not mistaken.\n\n> Your [comment:62 previous error] was on a 32-bit system.\n\nI did all tests related with this ticket on the same machine, namely my `OpenSuse` laptop, and I am pretty sure that it is x86_64. Although I can currently not recall how to find out the architecture. In any case, `cat /proc/cpuinfo` tells me that I have two Intel(R) Core(TM)2 Duo.",
    "created_at": "2014-10-01T13:44:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220479",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:92 jdemeyer]:
> Replying to [comment:91 SimonKing]:
> > I am on 64 bit, if I am not mistaken.

> Your [comment:62 previous error] was on a 32-bit system.

I did all tests related with this ticket on the same machine, namely my `OpenSuse` laptop, and I am pretty sure that it is x86_64. Although I can currently not recall how to find out the architecture. In any case, `cat /proc/cpuinfo` tells me that I have two Intel(R) Core(TM)2 Duo.



---

archive/issue_comments_220480.json:
```json
{
    "body": "Replying to [comment:93 SimonKing]:\n> I did all tests related with this ticket on the same machine, namely my `OpenSuse` laptop, and I am pretty sure that it is x86_64.\n\nPerhaps the hardware is 64-bit, but the kernel in the logs you posted is 32-bit.\n\n> Although I can currently not recall how to find out the architecture.\n\n`uname -m` prints the \"machine hardware name\" which is probably what you want.",
    "created_at": "2014-10-01T13:51:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220480",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:93 SimonKing]:
> I did all tests related with this ticket on the same machine, namely my `OpenSuse` laptop, and I am pretty sure that it is x86_64.

Perhaps the hardware is 64-bit, but the kernel in the logs you posted is 32-bit.

> Although I can currently not recall how to find out the architecture.

`uname -m` prints the "machine hardware name" which is probably what you want.



---

archive/issue_comments_220481.json:
```json
{
    "body": "```\nuname -m\ni686\n```\nwhatever that means.",
    "created_at": "2014-10-01T14:02:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220481",
    "user": "https://github.com/simon-king-jena"
}
```

```
uname -m
i686
```
whatever that means.



---

archive/issue_comments_220482.json:
```json
{
    "body": "That means 32-bit with a certain set of ISA extensions beyond the i386 (requires Pentium Pro / Pentium II and newer). If you have < 4GB then this is would be the recommended installation.",
    "created_at": "2014-10-01T14:40:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220482",
    "user": "https://github.com/vbraun"
}
```

That means 32-bit with a certain set of ISA extensions beyond the i386 (requires Pentium Pro / Pentium II and newer). If you have < 4GB then this is would be the recommended installation.



---

archive/issue_comments_220483.json:
```json
{
    "body": "Replying to [comment:96 vbraun]:\n> That means 32-bit with a certain set of ISA extensions beyond the i386 (requires Pentium Pro / Pentium II and newer). If you have < 4GB then this is would be the recommended installation.\n\n\nInteresting. Currently I have 4 GB. Can I change the installation without to much hassle when upgrading the memory in future?",
    "created_at": "2014-10-01T14:47:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220483",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:96 vbraun]:
> That means 32-bit with a certain set of ISA extensions beyond the i386 (requires Pentium Pro / Pentium II and newer). If you have < 4GB then this is would be the recommended installation.


Interesting. Currently I have 4 GB. Can I change the installation without to much hassle when upgrading the memory in future?



---

archive/issue_comments_220484.json:
```json
{
    "body": "I don't think any distro supports architecture changes. Just install x86_64 on a separate partition / btrfs volume and mound your /home.",
    "created_at": "2014-10-01T14:51:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220484",
    "user": "https://github.com/vbraun"
}
```

I don't think any distro supports architecture changes. Just install x86_64 on a separate partition / btrfs volume and mound your /home.



---

archive/issue_comments_220485.json:
```json
{
    "body": "After make distclean, make test did almost work. I got no timeouts, and the following errors:\n\n```\nsage -t src/sage/stats/hmm/hmm.pyx  # 2 doctests failed\nsage -t src/sage/schemes/elliptic_curves/period_lattice_region.pyx  # 1 doctest failed\nsage -t src/sage/gsl/probability_distribution.pyx  # 3 doctests failed\nsage -t src/sage/plot/plot3d/transform.pyx  # 1 doctest failed\n```\n\nUnfortunately, I again encounter the problem that the test log does not indicate what tests went wrong, it just gives the number of failing tests.",
    "created_at": "2014-10-01T22:48:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220485",
    "user": "https://github.com/simon-king-jena"
}
```

After make distclean, make test did almost work. I got no timeouts, and the following errors:

```
sage -t src/sage/stats/hmm/hmm.pyx  # 2 doctests failed
sage -t src/sage/schemes/elliptic_curves/period_lattice_region.pyx  # 1 doctest failed
sage -t src/sage/gsl/probability_distribution.pyx  # 3 doctests failed
sage -t src/sage/plot/plot3d/transform.pyx  # 1 doctest failed
```

Unfortunately, I again encounter the problem that the test log does not indicate what tests went wrong, it just gives the number of failing tests.



---

archive/issue_comments_220486.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2014-10-02T07:06:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220486",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_220487.json:
```json
{
    "body": "There is a very strange thing happening on this 32-bit system. When running doctests with `make ptest`, a lot of tests fail. When running those tests indivually, most of them pass (except for the ones [comment:99 mentioned by Simon]). So there is certainly something fishy going on.\n\nThis might be due to [https://savannah.gnu.org/bugs/?22010](https://savannah.gnu.org/bugs/?22010), I'm upgrading `make` to see if that fixes it.",
    "created_at": "2014-10-02T08:33:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220487",
    "user": "https://github.com/jdemeyer"
}
```

There is a very strange thing happening on this 32-bit system. When running doctests with `make ptest`, a lot of tests fail. When running those tests indivually, most of them pass (except for the ones [comment:99 mentioned by Simon]). So there is certainly something fishy going on.

This might be due to [https://savannah.gnu.org/bugs/?22010](https://savannah.gnu.org/bugs/?22010), I'm upgrading `make` to see if that fixes it.



---

archive/issue_comments_220488.json:
```json
{
    "body": "I am investigating the doctest failures reported by Simon, hang on...",
    "created_at": "2014-10-02T08:59:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220488",
    "user": "https://github.com/jdemeyer"
}
```

I am investigating the doctest failures reported by Simon, hang on...



---

archive/issue_comments_220489.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2014-10-02T12:01:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220489",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_220490.json:
```json
{
    "body": "Can you elaborate on the \"periodic lattice\" commit?",
    "created_at": "2014-10-02T12:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220490",
    "user": "https://github.com/simon-king-jena"
}
```

Can you elaborate on the "periodic lattice" commit?



---

archive/issue_comments_220491.json:
```json
{
    "body": "Replying to [comment:105 SimonKing]:\n> Can you elaborate on the \"periodic lattice\" commit?\n\nSee #17088",
    "created_at": "2014-10-02T12:24:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220491",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:105 SimonKing]:
> Can you elaborate on the "periodic lattice" commit?

See #17088



---

archive/issue_comments_220492.json:
```json
{
    "body": "Replying to [comment:106 jdemeyer]:\n> Replying to [comment:105 SimonKing]:\n> > Can you elaborate on the \"periodic lattice\" commit?\n\n> See #17088\n\nOK. Running tests now. Hope it will work this time...",
    "created_at": "2014-10-02T12:30:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220492",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:106 jdemeyer]:
> Replying to [comment:105 SimonKing]:
> > Can you elaborate on the "periodic lattice" commit?

> See #17088

OK. Running tests now. Hope it will work this time...



---

archive/issue_comments_220493.json:
```json
{
    "body": "I still get random segmentation faults with long tests in `src/sage/matrix/matrix_integer_dense_hnf.py`",
    "created_at": "2014-10-02T13:15:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220493",
    "user": "https://github.com/jdemeyer"
}
```

I still get random segmentation faults with long tests in `src/sage/matrix/matrix_integer_dense_hnf.py`



---

archive/issue_comments_220494.json:
```json
{
    "body": "If you're interested in debugging on Linux: see also #17089.",
    "created_at": "2014-10-02T13:23:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220494",
    "user": "https://github.com/jdemeyer"
}
```

If you're interested in debugging on Linux: see also #17089.



---

archive/issue_comments_220495.json:
```json
{
    "body": "Replying to [comment:108 jdemeyer]:\n> I still get random segmentation faults with long tests in `src/sage/matrix/matrix_integer_dense_hnf.py`\n\n\nO_o...\n\nI thought the point of a debug version is that all segmentation faults will be non-random, reproducible and accompanied by a useful C backtrace.",
    "created_at": "2014-10-02T13:26:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220495",
    "user": "https://github.com/simon-king-jena"
}
```

Replying to [comment:108 jdemeyer]:
> I still get random segmentation faults with long tests in `src/sage/matrix/matrix_integer_dense_hnf.py`


O_o...

I thought the point of a debug version is that all segmentation faults will be non-random, reproducible and accompanied by a useful C backtrace.



---

archive/issue_comments_220496.json:
```json
{
    "body": "Replying to [comment:110 SimonKing]:\n> accompanied by a useful C backtrace.\n\n...at least we have this (modulo #17089)",
    "created_at": "2014-10-02T13:30:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220496",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:110 SimonKing]:
> accompanied by a useful C backtrace.

...at least we have this (modulo #17089)



---

archive/issue_comments_220497.json:
```json
{
    "body": "The command which crashes is\n\n```\nsage: from sage.matrix.matrix_integer_dense_hnf import benchmark_hnf; benchmark_hnf([50,100],32)\n```",
    "created_at": "2014-10-02T13:41:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220497",
    "user": "https://github.com/jdemeyer"
}
```

The command which crashes is

```
sage: from sage.matrix.matrix_integer_dense_hnf import benchmark_hnf; benchmark_hnf([50,100],32)
```



---

archive/issue_comments_220498.json:
```json
{
    "body": "I wonder whether random segmentation faults in the debug version should prevent this ticket from getting a positive review. After all, if segmentation faults show up then probably there is a problem in the non-debug version as well. This ticket is not about fixing the segmentation fault, but it is about providing the means to analyse segmentation fault.",
    "created_at": "2014-10-02T13:42:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220498",
    "user": "https://github.com/simon-king-jena"
}
```

I wonder whether random segmentation faults in the debug version should prevent this ticket from getting a positive review. After all, if segmentation faults show up then probably there is a problem in the non-debug version as well. This ticket is not about fixing the segmentation fault, but it is about providing the means to analyse segmentation fault.



---

archive/issue_comments_220499.json:
```json
{
    "body": "Replying to [comment:113 SimonKing]:\n> This ticket is not about fixing the segmentation fault, but it is about providing the means to analyse segmentation fault.\n\nExactly, the segfault issue is #17090.",
    "created_at": "2014-10-02T14:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220499",
    "user": "https://github.com/jdemeyer"
}
```

Replying to [comment:113 SimonKing]:
> This ticket is not about fixing the segmentation fault, but it is about providing the means to analyse segmentation fault.

Exactly, the segfault issue is #17090.



---

archive/issue_comments_220500.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2014-10-02T14:02:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220500",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_220501.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-10-02T16:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220501",
    "user": "https://github.com/vbraun"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_220502.json:
```json
{
    "body": "lgtm",
    "created_at": "2014-10-02T16:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220502",
    "user": "https://github.com/vbraun"
}
```

lgtm



---

archive/issue_comments_220503.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2014-10-05T22:39:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/16701#issuecomment-220503",
    "user": "https://github.com/vbraun"
}
```

Resolution: fixed



---

archive/issue_events_049423.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-10-05T22:39:11Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/16701",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/16701#event-49423"
}
```
