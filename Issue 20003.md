# Issue 20003: random Tamari interval posets

Issue created by migration from Trac.

Original creator: chapoton

Original creation time: 2016-03-21 13:27:00

CC:  gchatel vivianepons tscrim

Let us implement a `random_element` method for Tamari intervals.

This uses random triangulations and the bijection of Bernardi and Bonichon.

On the way, one needs also to compute a minimal Schnyder wood of a planar triangulation.


---

Comment by chapoton created at 2016-03-21 13:27:33

New commits:


---

Comment by chapoton created at 2016-03-21 13:27:33

Changing status from new to needs_review.


---

Comment by git created at 2016-03-21 14:41:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2016-03-23 20:21:55

For a `random_element()` method, I would typically like to see some mention in the documentation as to whether it is provably uniformly random, conjecturally uniformly random, just random-ish, etc.


---

Comment by git created at 2016-03-23 20:42:20

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2016-03-28 23:13:41

`minimal_schnyder_wood` relies very heavily on the input being in the same form as the output of `graphs.Random_Triangulation`. If this were purely a helper function for computing random Tamari intervals, that would be fine. But as something defined on all graphs, I think there should be some kind of check to make sure the input is a planar triangulation, and the user should be able to specify what they want the root edge to be. Also, the purpose of the optional parameter `minimum=False` isn't documented.

Still need to look at the two papers to understand the code/algorithms, but the end product seems to work.


---

Comment by git created at 2016-03-29 12:54:24

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2016-04-09 20:26:26

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-05-08 20:00:58

ping ? anybody ?


---

Comment by git created at 2016-05-26 09:34:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-06-10 18:27:57

Changing keywords from "" to "random".


---

Comment by chapoton created at 2016-06-29 19:14:30

ping ? for Viviane or Kevin, maybe, if you feel interested.


---

Comment by git created at 2016-07-08 12:35:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by kdilks created at 2016-07-11 14:07:21

Changing status from needs_review to positive_review.


---

Comment by chapoton created at 2016-07-11 19:02:49

Thanks for the review, Kevin.


---

Comment by vbraun created at 2016-07-12 07:26:18

Merge conflict


---

Comment by vbraun created at 2016-07-12 07:26:18

Changing status from positive_review to needs_work.


---

Comment by git created at 2016-07-19 13:47:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2016-07-19 13:47:47

trivial rebase, setting back to positive review


---

Comment by chapoton created at 2016-07-19 13:47:47

Changing status from needs_work to positive_review.


---

Comment by vbraun created at 2016-07-19 23:12:55

Resolution: fixed


---

Comment by vbraun created at 2016-07-20 06:55:51

Resolution changed from fixed to 


---

Comment by vbraun created at 2016-07-20 06:55:51

Changing status from closed to new.


---

Comment by vbraun created at 2016-07-20 06:55:51


```
sage -t --long src/sage/graphs/schnyder.py
**********************************************************************
File "src/sage/graphs/schnyder.py", line 731, in sage.graphs.schnyder.minimal_schnyder_wood
Failed example:
    sorted(newg.edges())
Expected:
    [(0, 2, 'blue'),
     (0, 'a', 'green'),
     (0, 'c', 'red'),
     (1, 0, 'green'),
     (1, 'b', 'blue'),
     (1, 'c', 'red'),
     (2, 1, 'red'),
     (2, 'a', 'green'),
     (2, 'b', 'blue')]
Got:
    [(0, 'a', 'green'),
     (0, 'c', 'red'),
     (0, 2, 'blue'),
     (1, 0, 'green'),
     (1, 'b', 'blue'),
     (1, 'c', 'red'),
     (2, 'a', 'green'),
     (2, 'b', 'blue'),
     (2, 1, 'red')]
**********************************************************************
File "src/sage/graphs/schnyder.py", line 742, in sage.graphs.schnyder.minimal_schnyder_wood
Failed example:
    sorted(newg2.edges())
Expected:
    [(0, 1, 'blue'),
     (0, 'a', 'green'),
     (0, 'c', 'red'),
     (1, 2, 'green'),
     (1, 'b', 'blue'),
     (1, 'c', 'red'),
     (2, 0, 'red'),
     (2, 'a', 'green'),
     (2, 'b', 'blue')]
Got:
    [(0, 'a', 'green'),
     (0, 'c', 'red'),
     (0, 1, 'blue'),
     (1, 'b', 'blue'),
     (1, 'c', 'red'),
     (1, 2, 'green'),
     (2, 0, 'red'),
     (2, 'a', 'green'),
     (2, 'b', 'blue')]
**********************************************************************
1 item had failures:
   2 of  17 in sage.graphs.schnyder.minimal_schnyder_wood
    [96 tests, 2 failures, 1.64 s]
```



---

Comment by chapoton created at 2016-07-20 07:37:58

WTF ? How can the behaviour of `sorted` change on such simple objects ??


---

Comment by vbraun created at 2016-07-20 08:30:39

sort order between integer and string is undefined (memory location)


---

Comment by chapoton created at 2016-07-20 08:32:44

ok, thanks.

It seems also that python3 refuses to do that completely.

I have changed the doctests to sort using strings only.
----
Last 10 new commits:


---

Comment by chapoton created at 2016-07-20 08:33:28

Changing status from new to needs_review.


---

Comment by tscrim created at 2016-07-20 15:36:48

LGTM.


---

Comment by tscrim created at 2016-07-20 15:36:48

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2016-07-21 16:51:57

Resolution: fixed


---

Comment by vdelecroix created at 2016-07-24 00:27:38

see #21078 for failing doctests
