# Issue 13686: small bug in point3d

Issue created by migration from Trac.

Original creator: tjolivet

Original creation time: 2012-12-30 23:11:56

Assignee: jason, was

The following three commands work as expected (a Graphics object is returned)

```
sage: points([(1,1)])                                                                                      

sage: points(iter([(1,1)]))                                                                                

sage: points([(1,1,1)])                                                                                    
```

but the following command raises an `AttributeError`.

```
sage: points(iter([(1,1,1)]))
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)

/home/jaje/dropbox/Dropbox/IFS/<ipython console> in <module>()

/home/jaje/sage-5.5/local/lib/python2.7/site-packages/sage/plot/point.pyc in point(points, **kwds)
    310     except (ValueError, TypeError):
    311         from sage.plot.plot3d.shapes2 import point3d
--> 312         return point3d(points, **kwds)
    313 
    314 `@`rename_keyword(color='rgbcolor', pointsize='size')

/home/jaje/sage-5.5/local/lib/python2.7/site-packages/sage/plot/plot3d/shapes2.pyc in point3d(v, size, **kwds)
   1021     else:
   1022         A = sum([Point(z, size, **kwds) for z in v])
-> 1023         A._set_extra_kwds(kwds)
   1024         return A
   1025 

AttributeError: 'int' object has no attribute '_set_extra_kwds'
```



---

Comment by chapoton created at 2014-10-28 09:07:10

Changing status from new to needs_review.


---

Comment by chapoton created at 2014-10-28 09:07:10

New commits:


---

Comment by chapoton created at 2014-10-28 09:07:10

Changing keywords from "" to "plot3d, point3d".


---

Comment by chapoton created at 2014-10-28 09:10:52

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-10-28 10:14:19

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2014-10-28 10:35:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-10-28 10:36:13

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2014-10-28 10:36:13

New commits:


---

Comment by kcrisman created at 2014-11-13 19:10:33

This applies, but apparently needs rebasing since I still get the same error after applying this.  There does seem to be some new code in that spot.

Interestingly, n the meantime the original error has changed.

```
sage: points(iter([(1,1,1)]))
---------------------------------------------------------------------------
   1077 
   1078     """
-> 1079     if len(v) == 3:
   1080         try:
   1081             # check if the first element can be changed to a float

TypeError: object of type 'listiterator' has no len()
```


By the way, should we try to accommodate generators as well?   

```
points( (x,x,x) for x in range(3) )
```

or the like.


---

Comment by kcrisman created at 2014-11-13 19:10:40

Changing status from needs_review to needs_work.


---

Comment by git created at 2014-11-14 14:47:48

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-11-14 14:50:38

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2014-11-14 14:50:38

I have now made so that use of iterators is forbidden in `points`. The reason is that one cannot test if the point has 2 or 3 dimensions without burning the iterator. So it does not make sense to try to guess what is the expected dimension. But iterators are now allowed in both `point2d` and `point3d`.


---

Comment by kcrisman created at 2014-11-14 15:16:55

Aha!  I see what happened.   Glad I tried that out.   I'll take a look at this momentarily.


---

Comment by kcrisman created at 2014-11-14 15:23:38

Hmm, but look at #10478.  There is an explicit example there (oddly, not doctested) for

```
line(iter([(0,0), (1,0), (2,2)]))
```

and `points` and `line` should really work the same.  Can't we just do `points = list(points)` and then test like they do there?


---

Comment by git created at 2014-11-19 16:09:12

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2014-12-26 16:30:10

ping ?


---

Comment by kcrisman created at 2015-01-04 02:29:00

Sorry, other business (Sage-wise as well) to attend to, and then a break.  Is this behavior desired?

```
sage: point(iter([]))  # works

sage: point2d(iter([]))
---------------------------------------------------------------------------
ValueError             
```

Actually, probably only the latter (and 3d version thereof) is desired, since one can't know what dimension an empty list should be... or we could default to 2d.


---

Comment by mmezzarobba created at 2015-01-23 14:16:17

Changing status from needs_review to needs_info.


---

Comment by git created at 2015-01-29 20:37:02

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-01-29 20:37:19

Changing status from needs_info to needs_review.


---

Comment by kcrisman created at 2015-02-03 01:34:29

So the empty iterator should be 2d, not 3d (or nothing)?  Just checking if this is the "right" design decision.


---

Comment by chapoton created at 2015-02-05 10:48:32

Sorry, I do not understand if you still have a concern or not ?


---

Comment by kcrisman created at 2015-02-05 14:20:02

Well, I'm asking about that.  To me `point2d([])` and `point3d([])` are meaningful; `point([])` maybe isn't, because it isn't clear what the default dimension should be.  Same for empty iterators.  Maybe I'm thinking about it too much.


---

Comment by chapoton created at 2015-02-05 16:51:23

It seems to me that the initial aim of this ticket is met (namely allowing to use iterators in all kinds of points). Maybe this is enough ?


---

Comment by kcrisman created at 2015-02-12 03:28:55

Yes, upon further thought you are right, that was a pre-existing thing.  Thanks!  Sorry this small thing ended up going crazy long.


---

Comment by kcrisman created at 2015-02-12 03:28:55

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-02-17 09:52:48

Some doctests  fail, e.g.

```
sage -t --long --warn-long 56.5 src/sage/geometry/polyhedron/ppl_lattice_polygon.py
**********************************************************************
File "src/sage/geometry/polyhedron/ppl_lattice_polygon.py", line 413, in sage.geometry.polyhedron.ppl_lattice_polygon.LatticePolygon_PPL_class.plot
Failed example:
    LatticePolytope_PPL([0], [1]).plot()
Expected:
    Graphics object consisting of 2 graphics primitives
Got:
    Graphics object consisting of 3 graphics primitives
```



---

Comment by vbraun created at 2015-02-17 09:52:48

Changing status from positive_review to needs_work.


---

Comment by git created at 2015-02-17 10:20:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2015-02-17 12:42:10

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by chapoton created at 2015-02-17 12:43:04

Changing status from needs_work to needs_review.


---

Comment by chapoton created at 2015-02-17 12:43:04

Should be good now.


---

Comment by vbraun created at 2015-02-17 13:26:35

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2015-02-17 19:28:15

Resolution: fixed
