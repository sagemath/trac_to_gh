# Issue 30550: package modular_resolution: Split out from p_group_cohomology

Issue created by migration from https://trac.sagemath.org/ticket/30787

Original creator: mkoeppe

Original creation time: 2020-10-17 22:57:53

CC:  simonking dimpase jhpalmieri tscrim klee

As discussed in #28711#comment:64:

We split the current `p_group_cohomology` spkg:

In this ticket, we create the package `modular_resolution`, depending on meataxe-the-C-library, that installs
a standalone C library `libmodres.so` in `$SAGE_LOCAL/lib` and 
some executables in `$SAGE_LOCAL/bin`, linked against `libmodres`


---

Comment by SimonKing created at 2020-10-20 07:48:47

I'll start with summing up what the current p_group_cohomology spkg comprises and how the parts depend upon each other.
1. the C library `libmodres`, which also links against `libmtx` and thus depends on the `meataxe` spkg, but not necessarily on `sage-meataxe`.
2. some executables linked against `libmodres`
3. some module for Singular, that should be installed in `SAGE_LOCAL/share/singular/LIB/` (that's where Singular expect modules)
4. some package for GAP, which by #28711 should be installed in `SAGE_LOCAL/share/gap/pkg/` (that's where GAP expect packages)
5. some database of cohomology rings, to be installed in `SAGE_LOCAL/share/pGroupCohomology` (could in principle be moved to somewhere else, but is data and thus shouldn't be in places like `SAGE_SRC`)
6. some pip installable modules linked against `libmodres` and `libmtx` and also depending on `sage.matrix.matrix_gfpn_dense` being built and uses some Cython headers from `sage.structure`. The pip installable modules could in principle be put into the Sage src tree, analogously to `sage-meataxe`. 2.-5. are run time dependencies.


---

Comment by SimonKing created at 2020-10-20 07:55:22

Obviously, 1. and 2. from the previous comment should be in the new modular_resolution spkg. But at what point should 3.-5. be installed? Currently, 5. is installed when making modular_resolution, whereas 3.-4. are installed by p_group_cohomology's spkg-install.

Would it be better to install ALL of 3.-5. by modular_resolution's spkg-install (not by the make file)? Or ALL of 3.-5. by p_group_cohomology's spkg-install? Or something else?


---

Comment by dimpase created at 2020-10-20 08:19:47

The python/cython modules should be left alone, do not bundle anything with it please.

Have you thought about upstreaming the Singular library?


---

Comment by SimonKing created at 2020-10-20 08:56:04

Replying to [comment:4 dimpase]:
> The python/cython modules should be left alone, do not bundle anything with it please.
> 
> Have you thought about upstreaming the Singular library?

No. I'm not sure if I should. It is about the computation of Dickson invariants, though. Since Singular has some capabilities of computing non-modular and modular invariant rings of finite group actions, it would somehow make sense to include it in Singular. (EDIT: I think I'll ask the Singular developers).

Concerning the analogous question on the GAP package: In this case I think it makes no sense to make it an upstream package. It calls the executables of `modular_resolution`, writing initial data needed for p_group_cohomology into several files.


---

Comment by dimpase created at 2020-10-20 09:07:46

Replying to [comment:5 SimonKing]:
> 
> Concerning the analogous question on the GAP package: In this case I think it makes no sense to make it an upstream package. It calls the executables of `modular_resolution`, writing initial data needed for p_group_cohomology into several files.

An important consideration is the ability to have `spkg-check` - e.g. for instance you can bundle the GAP package with modular_resolution, so that you can easily write some tests (in GAP) for all of them.


---

Comment by SimonKing created at 2020-10-20 09:18:33

Replying to [comment:6 dimpase]:
> An important consideration is the ability to have `spkg-check` - e.g. for instance you can bundle the GAP package with modular_resolution, so that you can easily write some tests (in GAP) for all of them. 

Good point!

If one bundles modular_resolution together with the cohomology database (which is currently the case) and with the GAP package, one could add the following self test: Call a function from the GAP package that uses an executable from modular_resolution to create initial data for, say, the cohomology ring of the dihedral group, which is part of the database, i.e., one can verify that the newly created initial data coincides what is found in the data base.


---

Comment by mkoeppe created at 2020-10-20 15:45:10

Replying to [comment:3 SimonKing]:
> Obviously, 1. and 2. from the previous comment should be in the new modular_resolution spkg. But at what point should 3.-5. be installed? Currently, 5. is installed when making modular_resolution, whereas 3.-4. are installed by p_group_cohomology's spkg-install.
> 
> Would it be better to install ALL of 3.-5. by modular_resolution's spkg-install (not by the make file)? Or ALL of 3.-5. by p_group_cohomology's spkg-install? Or something else?

parts 3.-4. are outside of the scope of this ticket.

part 5. Is it used by 1.-2.? Then it should be included here; otherwise, outside of the scope of this ticket.


---

Comment by SimonKing created at 2020-10-20 16:24:13

Replying to [comment:8 mkoeppe]:
> parts 3.-4. are outside of the scope of this ticket.

You argued in #28711, comment 58, that "an spkg should either be a pip-installable Python package, or it should be a non-Python package (which can install anywhere in SAGE_LOCAL)."

If I understand correctly, it means that not only the C library libmodres but also the database as well as the helpers for GAP and Singular shouldn't be installed by p_group_cohomology (whose main part IS pip-installable). So, 3.-5. should be split out as well and thus ARE in the scope of this ticket.

> part 5. Is it used by 1.-2.? Then it should be included here; otherwise, outside of the scope of this ticket.

Then tell me by what source the database should be provided, if it shouldn't be p_group_cohomology.


---

Comment by mkoeppe created at 2020-10-20 16:29:37

Replying to [comment:9 SimonKing]:
> Replying to [comment:8 mkoeppe]:
> > parts 3.-4. are outside of the scope of this ticket.
> 
> You argued in #28711, comment 58, that "an spkg should either be a pip-installable Python package, or it should be a non-Python package (which can install anywhere in SAGE_LOCAL)."
> 
> If I understand correctly, it means that not only the C library libmodres but also the database as well as the helpers for GAP and Singular shouldn't be installed by p_group_cohomology (whose main part IS pip-installable).

Yes, but this ticket is titled "package modular_resolution: Split out from p_group_cohomology", so it is more narrowly focused than a ticket titled "Split p_group_cohomology into its irreducible components".


---

Comment by SimonKing created at 2020-10-20 17:04:05

Replying to [comment:10 mkoeppe]:
> Yes, but this ticket is titled "package modular_resolution: Split out from p_group_cohomology", so it is more narrowly focused than a ticket titled "Split p_group_cohomology into its irreducible components".

I don't understand what you suggest.

Do you suggest to change the title and description of the ticket? Or do you suggest to keep the Singular and Gap helpers in p_group_cohomology and additionally to move the database from modular_cohomology (that's where the database currently is) to p_group_cohomology, even though it is basically a pip installable module? Or something else?


---

Comment by mkoeppe created at 2020-10-20 17:17:24

Replying to [comment:11 SimonKing]:
> Or do you suggest to keep the Singular and Gap helpers in p_group_cohomology

Yes, that's my suggestion for this ticket - to keep the ticket simple. Follow-up tickets can take care of further restructuring.

> additionally to move the database from modular_cohomology (that's where the database currently is) to p_group_cohomology

If the `modular_cohomology` Makefile currently installs this database, there's probably no need to change it.


---

Comment by mkoeppe created at 2020-10-20 17:19:59

If the database is part of the `modular_resolution` package, I would suggest to install an executable script (perhaps `modres-config`) that reports the install location.


---

Comment by SimonKing created at 2020-10-20 19:52:09

Replying to [comment:13 mkoeppe]:
> If the database is part of the `modular_resolution` package, I would suggest to install an executable script (perhaps `modres-config`) that reports the install location.

How can this be done? I mean, I know where the database ends up. Makefile.am is

```
ACLOCAL_AMFLAGS = -I m4
SUBDIRS = src

dbdir           = $(datadir)/pGroupCohomology
dist_db_DATA    = group_cohomology_database.tar

install-data-hook:
	cd $(DESTDIR)$(dbdir) && tar xf $(dist_db_DATA) && rm $(dist_db_DATA)

uninstall-hook:
	rm -r $(DESTDIR)$(dbdir)
```

and so the database will be in `$SAGE_LOCAL/share/pGroupCohomology`. But I guess a script returning that path (dependent on the value of `SAGE_LOCAL` is not what you suggest.

Is there a standard script in the autotools ecosystem that would provide the correct value of `$(dbdir)` both during and after (staged) installation?


---

Comment by mkoeppe created at 2020-10-20 20:04:16

Replying to [comment:14 SimonKing]:
> Replying to [comment:13 mkoeppe]:
> > If the database is part of the `modular_resolution` package, I would suggest to install an executable script (perhaps `modres-config`) that reports the install location.
> 
> How can this be done? I mean, I know where the database ends up. Makefile.am is
> {{{
> ACLOCAL_AMFLAGS = -I m4
> SUBDIRS = src
> 
> dbdir           = $(datadir)/pGroupCohomology
> dist_db_DATA    = group_cohomology_database.tar
> 
> install-data-hook:
> 	cd $(DESTDIR)$(dbdir) && tar xf $(dist_db_DATA) && rm $(dist_db_DATA)
> 
> uninstall-hook:
> 	rm -r $(DESTDIR)$(dbdir)
> }}}
> and so the database will be in `$SAGE_LOCAL/share/pGroupCohomology`. But I guess a script returning that path (dependent on the value of `SAGE_LOCAL` is not what you suggest.

Not depending on `SAGE_LOCAL` - the upstream package should make sense without Sage.
Rather, depending on the configured install prefix.

Like this: Create template file `modres-config.in`
{{{#! /bin/sh
echo "@datadir@/pGroupCohomology"
```

and add to configure.ac:

```
AC_CONFIG_FILES([modres-config], [chmod +x modres-config])
```


> Is there a standard script in the autotools ecosystem that would provide the correct 
value of `$(dbdir)` both during and after (staged) installation?

No, one would not want to read from DESTDIR.


---

Comment by SimonKing created at 2020-10-20 20:48:23

Replying to [comment:15 mkoeppe]:
> Like this: Create template file `modres-config.in`
> {{{
> #! /bin/sh
> echo "`@`datadir`@`/pGroupCohomology"
> }}}
> and add to configure.ac:
> {{{
> AC_CONFIG_FILES([modres-config], [chmod +x modres-config])
> }}}
> 
> > Is there a standard script in the autotools ecosystem that would provide the correct 
> value of `$(dbdir)` both during and after (staged) installation?
> 
> No, one would not want to read from DESTDIR.

Do I understand correctly that the syntax ``@`datadir`@`` in `modres-config.in` makes it so that the value `$(datadir)` is inserted during creation of the `modres-config` script, so that calling it later provides the final destination of the database? Well, I simply didn't know how to achieve this and is what I meant by a "standard script in the autotools ecosystem".

To be clear: Do you suggest that this script will be called by the Python/Cython modules to find out the location of the database?


---

Comment by mkoeppe created at 2020-10-20 20:52:56

Replying to [comment:16 SimonKing]:
> Do I understand correctly that the syntax ``@`datadir`@`` in `modres-config.in` makes it so that the value `$(datadir)` is inserted during creation of the `modres-config` script, so that calling it later provides the final destination of the database? 

That's right. `./configure` will create the file `modres-config`. There are, of course, many other ways to do it, like generating this simple script in an install-hook.

> Well, I simply didn't know how to achieve this and is what I meant by a "standard script in the autotools ecosystem".

Ok, great; but note that it does not do anything about DESTDIR (and should not).

> To be clear: Do you suggest that this script will be called by the Python/Cython modules to find out the location of the database?

Yes.


---

Comment by SimonKing created at 2020-10-20 21:13:00

Replying to [comment:17 mkoeppe]:
> > To be clear: Do you suggest that this script will be called by the Python/Cython modules to find out the location of the database?
> 
> Yes.

Is this ticket only about creating a new `modular_resolution` spkg, or also to modify `p_group_cohomology` to use the new split-off spkg? Or shall the latter be done on a new ticket?

While we are at it: Is there a recommended way (at least recommended in Sage) to read from the output of system calls in Python? `os.popen`, or `subprocess.Popen` or something else?


---

Comment by mkoeppe created at 2020-10-20 23:23:19

Replying to [comment:18 SimonKing]:
> Is this ticket only about creating a new `modular_resolution` spkg, or also to modify `p_group_cohomology` to use the new split-off spkg? Or shall the latter be done on a new ticket?

Both

> While we are at it: Is there a recommended way (at least recommended in Sage) to read from the output of system calls in Python? `os.popen`, or `subprocess.Popen` or something else?

I just learned the hard way how to write this portably for Python >= 3.6 (all our currently supported Python versions): Take a look at the most recent version (after #30758) of `src/sage/features/__init.py__` (`package_systems`).

```
        from subprocess import run, CalledProcessError, PIPE

        try:
            proc = run('sage-guess-package-system', shell=True, stdout=PIPE, stderr=PIPE, universal_newlines=True, check=True)
            _cache_package_systems = [PackageSystem(proc.stdout.strip())]
        except CalledProcessError:
            pass
```



---

Comment by dimpase created at 2020-10-21 09:15:41

Why would one want to create a custom script `modres-config` instead of hooking this up on `pkg-config` ?
(I can show you the very easy autoconf/automake magic for this, I've done this for many projects used by Sage)

Then the Python interface is already there (with Python module `pkgconfig` - see e.g. `src/sage/env.py`)


---

Comment by SimonKing created at 2020-10-21 09:22:02

Replying to [comment:20 dimpase]:
> Why would one want to create a custom script `modres-config` instead of hooking this up on `pkg-config` ?

I have no preference.

> (I can show you the very easy autoconf/automake magic for this, I've done this for many projects used by Sage)

Please do!


---

Comment by mkoeppe created at 2020-10-21 09:22:53

We were discussing how to advertise the install location of the data files. Pkgconfig for the library would also be nice of course


---

Comment by SimonKing created at 2020-10-21 09:55:41

Replying to [comment:21 SimonKing]:
> > (I can show you the very easy autoconf/automake magic for this, I've done this for many projects used by Sage)
> 
> Please do!

In particular, I have no idea how to make pkgconfig aware of an autotoolized library: `pkgconfig.list_all()` contains neither `libmtx` nor `mtx` nor `meataxe` nor `modres` nor `libmodres` nor `modular_resolution`, although meataxe and modular_resolution are installed.


---

Comment by dimpase created at 2020-10-21 10:34:46

Replying to [comment:23 SimonKing]:
> Replying to [comment:21 SimonKing]:
> > > (I can show you the very easy autoconf/automake magic for this, I've done this for many projects used by Sage)
> > 
> > Please do!
> 
> In particular, I have no idea how to make pkgconfig aware of an autotoolized library: `pkgconfig.list_all()` contains neither `libmtx` nor `mtx` nor `meataxe` nor `modres` nor `libmodres` nor `modular_resolution`, although meataxe and modular_resolution are installed.

As an example, have a look at e.g. https://github.com/cddlib/cddlib/pull/40
(It changes a bit more than just adds `cddlib.pc` (adds some GMP-related stuff), so skip these parts)
Namely, 

1. `Makefile.am` needed

``` 
pkgconfigdir       = $(libdir)/pkgconfig
pkgconfig_DATA     = cddlib.pc
```


2. `cddlib.pc.in` (a template) needed to be created

3. `cddlib.pc` had to be added to the list in `AC_CONFIG_FILES`
   
After all this, `./configure` will fill in `cddlib.pc.in` and create `cddlib.pc`, which is then installed by `make install`.
Then Python `pkgconfig` module will be aware of that .pc file, no problem.

By the way, you can have a custom variable in .pc file - in your case, say, the path to the database - and request it using
`pkg-config --variable=... ...` calls (and from Python `pkgconfig` in a similar way)


---

Comment by SimonKing created at 2020-10-21 10:46:06

Thank you, Dima!

I wonder: Should I add pkg-config to SharedMeatAxe as well? After all, meataxe uses arithmetic tables that are of course stored in some default folder, and currently its location is presented by an environment variable. This variable is needed by the meataxe executables (that are also part of the package), whereas libmtx uses a C variable for the same purpose.

I took this design from the original `MeatAxe` from which I forked off `SharedMeatAxe`, but I've never been happy with it.

On the other hand, I'm not sure if pkg-config would be the right tool in this case: The location of the tables is in fact not determined by the autotoolised build system, but it is determined at run time -- and moreover the arithmetic tables are first created by spkg-postinst, not by the makefile of meataxe.


---

Comment by dimpase created at 2020-10-21 11:18:49

Replying to [comment:25 SimonKing]:
> Thank you, Dima!
> 
> I wonder: Should I add pkg-config to SharedMeatAxe as well? After all, meataxe uses arithmetic tables that are of course stored in some default folder, and currently its location is presented by an environment variable. This variable is needed by the meataxe executables (that are also part of the package), whereas libmtx uses a C variable for the same purpose.

It certainly simplifies things, to be able to use pkg-config to  check the library. E.g. imagine meataxe library available as a Debian package, and then naturally one would want to use it rather than to build Sage's one...

As to location of the tables/databases, naturally, there is no standard. Although I imagine there are defaults set in libmtx and in meataxe executables.

> 
> I took this design from the original `MeatAxe` from which I forked off `SharedMeatAxe`, but I've never been happy with it.
> 
> On the other hand, I'm not sure if pkg-config would be the right tool in this case: The location of the tables is in fact not determined by the autotoolised build system, but it is determined at run time -- and moreover the arithmetic tables are first created by spkg-postinst, not by the makefile of meataxe.

How is this determination happening at runtime? Checking an environment variable? Or there is a default value?


---

Comment by SimonKing created at 2020-10-21 11:35:07

Replying to [comment:26 dimpase]:
> It certainly simplifies things, to be able to use pkg-config to  check the library. E.g. imagine meataxe library available as a Debian package, and then naturally one would want to use it rather than to build Sage's one...

However, the location of the arithmetic tables does not depend on who built it. If the tables can not be found in the location specified by the environment variable MTXLIB resp. the C variable `MtxLibDir`, then it is attempted to read from `pwd`. And if this fails, it is attempted create new tables.

> As to location of the tables/databases, naturally, there is no standard. Although I imagine there are defaults set in libmtx and in meataxe executables.

The default is the current directory (so, better not use the default!).

> How is this determination happening at runtime? Checking an environment variable? Or there is a default value?

Actually I don't recall if there is a default value of the variable. You as a user of meataxe executables on the command line are supposed to assign a value to the environment variable, and you as a programmer of code linked against libmtx are supposed to assign a value to the C variable. Sage does both automatically, if you import from sage.libs.meataxe.

So, the user (Sage, in this case) has full control. If one fails to assign a value, then the current directory is used, or an error results (I don't recall).


---

Comment by mkoeppe created at 2020-10-21 18:15:04

Replying to [comment:24 dimpase]:
> By the way, you can have a custom variable in .pc file - in your case, say, the path to the database - and request it using
> `pkg-config --variable=... ...` calls (and from Python `pkgconfig` in a similar way)

This is a great point that I had forgotten about -- so `pkg-config` is a great solution for advertising the location of the data files too.


---

Comment by mkoeppe created at 2020-10-21 18:19:25

I would suggest deferring the discussion about meataxe to a separate ticket


---

Comment by SimonKing created at 2020-10-21 19:02:56

Replying to [comment:29 mkoeppe]:
> I would suggest deferring the discussion about meataxe to a separate ticket

I wanted to know whether a new ticket makes sense at all, before opening it.


---

Comment by mkoeppe created at 2020-12-06 18:17:38

Changing keywords from "" to "sd111".


---

Comment by mkoeppe created at 2020-12-06 18:17:38

Hoping we can make progress on this ticket this week - https://wiki.sagemath.org/days111


---

Comment by mkoeppe created at 2021-02-13 20:51:01

Setting new milestone based on a cursory review of ticket status, priority, and last modification date.


---

Comment by dimpase created at 2021-09-10 13:56:39

while working on #31404, and trying p_group_cohomology in the new setup, I saw that Singular has renamed `poly.lib` to `polylib.lib`.
This causes errors in the doctests, with Singular 4.2. Maybe a special ticket for such things? Also
the format of `dickson.lib` is old:

```
> LIB "dickson.lib";
// ** loaded /mnt/opt/Sage/sage-dev/local/share/singular/LIB/dickson.lib 
// ** library dickson.lib has old format. This format is still accepted,
// ** but for functionality you may wish to change to the new
// ** format. Please refer to the manual for further information.
// ** loaded /usr/bin/../share/singular/LIB/polylib.lib (4.2.0.0,Dec_2020)
// ** redefining ringweights (LIB "dickson.lib";)
// ** redefining ringweights (LIB "dickson.lib";)
// ** loaded /usr/bin/../share/singular/LIB/ring.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/primdec.lib (4.2.0.0,Mar_2021)
// ** loaded /usr/bin/../share/singular/LIB/absfact.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/triang.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/matrix.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/nctools.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/random.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/elim.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/inout.lib (4.1.2.0,Feb_2019)
// ** loaded /usr/bin/../share/singular/LIB/general.lib (4.1.2.0,Feb_2019)
> 
```



---

Comment by mkoeppe created at 2021-09-10 17:39:18

Replying to [comment:36 dimpase]:
> while working on #31404, and trying p_group_cohomology in the new setup, I saw that Singular has renamed `poly.lib` to `polylib.lib`.
That's https://github.com/sagemath/p_group_cohomology/issues/4


---

Comment by culler created at 2021-11-04 21:56:09

For what it is worth, I am attaching a patch for p_group_cohomology/spkg-install.in
and a patch (include_dir.patch) to be installed in p_group_cohomology/patches/.

I was able to build the spkg with these changes.


---

Comment by culler created at 2021-11-04 21:58:50

patch for p_group_cohomology/spkg-install.in


---

Attachment

patch to install in p_group_cohomology/patches


---

Comment by dimpase created at 2022-03-07 06:02:42

`p_group_cohomology` build fails on Linux 9.6.beta3, with or without the `@`culler's patches.
I opened #33474 to fix this.


---

Comment by mkoeppe created at 2022-03-07 06:41:29

Here's a beginning
----
New commits:


---

Comment by git created at 2022-03-07 07:09:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-03-07 07:16:21

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-03-07 07:17:55

untested, feel free to continue. getting late here.


---

Comment by dimpase created at 2022-03-07 13:16:42

OK, this builds - but the GAP helper files aren't ending in the correct place. Thus this fix. 
Still need to sort of `dickson.lib`, as the system-wide Singular doesn't find it.
----
New commits:


---

Comment by dimpase created at 2022-03-07 13:20:57

OK, the following tells Singular where to look for:

```
dima@hilbert /mnt/opt/Sage/sage-dev $ export SINGULARPATH=`pwd`/local/share/singular/LIB
dima@hilbert /mnt/opt/Sage/sage-dev $ ./sage --singular
                     SINGULAR                                 /  Development
 A Computer Algebra System for Polynomial Computations       /   version 4.2.1
                                                           0<
 by: W. Decker, G.-M. Greuel, G. Pfister, H. Schoenemann     \   May 2021
FB Mathematik der Universitaet, D-67653 Kaiserslautern        \
> LIB "dickson.lib";
// ** loaded /mnt/opt/Sage/sage-dev/local/share/singular/LIB/dickson.lib 
// ** library dickson.lib has old format. This format is still accepted,
// ** but for functionality you may wish to change to the new
// ** format. Please refer to the manual for further information.
   ? cannot open `poly.lib`
// ** loaded /usr/bin/../share/singular/LIB/general.lib (4.1.2.0,Feb_2019)
...
```

And we're running into an old name for `polylib.lib`.


---

Comment by git created at 2022-03-07 13:49:01

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2022-03-07 13:52:10

OK, so now we are in a reasonable shape; one doctest fails due to deprecation of `set_default_prec()`, used in `upstream/p_group_cohomology-3.3.2/pGroupCohomology-3.3.2/pGroupCohomology/barcode.py`,
the rest work.

And we need to sort out how to deal with `SINGULARPATH` - cf. comment:48.


---

Comment by dimpase created at 2022-03-07 13:52:38

Changing priority from major to blocker.


---

Comment by dimpase created at 2022-03-07 13:52:38

Changing status from new to needs_info.


---

Comment by mkoeppe created at 2022-03-07 16:34:18

Replying to [comment:50 dimpase]:
> And we need to sort out how to deal with `SINGULARPATH` - cf. comment:48.

Don't try to adjust SINGULARPATH, just load the library from the absolute pathname


---

Comment by mkoeppe created at 2022-03-07 16:35:44

Likewise for the gap helper, don't try to install it in the GAP library, just load it from the absolute pathname


---

Comment by jhpalmieri created at 2022-03-07 22:29:48

I installed this on OS X, although the first time failed in building `modular_resolution`:

```
./modular_resolution.h:29:10: fatal error: 'meataxe.h' file not found
#include "meataxe.h"
         ^~~~~~~~~~~
1 error generated.
```

Maybe add `meataxe` to the dependencies file for `modular_resolution`?

After building everything, the test suite failed almost immediately with

```
Running the test suite for p_group_cohomology-3.3.2.p0...
make[3]: *** No rule to make target `check'.  Stop.
********************************************************************************
Error testing modular_resolution-1.1
********************************************************************************

real	0m0.134s
user	0m0.016s
sys	0m0.025s
************************************************************************
Error testing package p_group_cohomology-3.3.2.p0
************************************************************************
```

The package has an extensive test suite, so if we can get it to pass tests, that should be a strong indication that everything is working.


---

Comment by git created at 2022-03-07 23:11:04

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2022-03-07 23:11:36

Replying to [comment:54 jhpalmieri]:
> Maybe add `meataxe` to the dependencies file for `modular_resolution`?

Here it is. I had forgotten to add the file


---

Comment by jhpalmieri created at 2022-03-07 23:40:59

The documentation doesn't build:

```
Running Sphinx v4.4.0

Extension error:
Could not import extension inventory_builder (exception: No module named 'inventory_builder')
make[3]: *** [html] Error 2
```



---

Comment by jhpalmieri created at 2022-03-07 23:50:37

Patching `conf.py` fixed it:

```diff
diff --git a/pGroupCohomology-3.3.2/doc/source/conf.py b/pGroupCohomology-3.3.2/doc/source/conf.py
index e24ceb6..ee16257 100644
--- a/pGroupCohomology-3.3.2/doc/source/conf.py
+++ b/pGroupCohomology-3.3.2/doc/source/conf.py
@@ -34,8 +34,8 @@ sys.path.append(os.path.join(SAGE_SRC, "sage_setup", "docbuild", "ext"))
 # Add any Sphinx extension module names here, as strings. They can be
 # extensions coming with Sphinx (named 'sphinx.ext.*') or your custom
 # ones.
-extensions = ['inventory_builder',
-              'sage_autodoc',
+extensions = ['sage_docbuild.ext.inventory_builder',
+              'sage_docbuild.ext.sage_autodoc',
               'sphinx.ext.intersphinx',
               'sphinx.ext.todo']
```

but I wonder if the p_group_cohomology `conf.py` should just point to Sage's conf.py and use that.


---

Comment by dimpase created at 2022-03-08 08:42:11

Changing status from needs_info to needs_work.


---

Comment by dimpase created at 2022-03-08 08:42:11

testsuite for `modular_resolution` (created in the latest commit) passes.

With `p_group_cohomology`, somehow I can't uninstall it, for some reason.
 
----
New commits:


---

Comment by dimpase created at 2022-03-08 09:13:02

Doing

```
export SINGULARPATH=`pwd`/local/share/singular/LIB
```

and after some fighting `./configure` and using `./sage -f` instead of `make`, I was able to rebuild `p_group_cohomology` and ran its testsuite. 2 failures - one due to deprecated `set_default_prec()`, clear how to fix, and another

```
[p_group_cohomology-3.3.2.p0] File "pGroupCohomology-3.3.2/pGroupCohomology/cohomology.pyx", line 993, in pGroupCohomology.cohomology.is_filter_regular
[p_group_cohomology-3.3.2.p0] Failed example:
[p_group_cohomology-3.3.2.p0]     is_filter_regular(H.relation_ideal(), F[0])
[p_group_cohomology-3.3.2.p0] Expected:
[p_group_cohomology-3.3.2.p0]     False
[p_group_cohomology-3.3.2.p0] Got:
[p_group_cohomology-3.3.2.p0]     [0]
```

I am not sure about. Looks like a genuine change.


---

Comment by git created at 2022-03-08 11:05:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2022-03-08 11:08:13

more doctest etc patches for the package. This reduces the noise, but there are still quite a lot of discrepancies, some of which look serious.
Also,

```
sage -t --warn-long 62.5 --random-seed=230138939486715312795148381621394057005 src/sage/tests/modular_group_cohomology.py
**********************************************************************
File "src/sage/tests/modular_group_cohomology.py", line 55, in sage.tests.modular_group_cohomology
Failed example:
    ascii_art(H.bar_code('LowerCentralSeries')[2])# optional - p_group_cohomology
Expected:
        *
      *-*
      *-*
    *
Got:
      *-*
      *-*
      *-*
      *-*
    *
**********************************************************************
1 item had failures:
   1 of  18 in sage.tests.modular_group_cohomology
    [17 tests, 1 failure, 3.71 s]
```


John, do you have an idea about test failures?


---

Comment by SimonKing created at 2022-03-08 11:53:56

First of all: Thank you very much for working on it! I am currently buried in exam grading and unable to do more interesting stuff.

Both the failure at `is_filter_regular(H.relation_ideal(), F[0])` and `H.bar_code('LowerCentralSeries')` look very serious to me. So, I should try and build stuff, and try to analyse the failures.

My question: It looks to me as if the branch introduces patches -- I guess these should eventually be included in the next version of the p_group_cohomology package, i.e., should be pushed to the github repository of the package. But how? Could you tell me a workflow?

Best regards,
Simon


---

Comment by dimpase created at 2022-03-08 12:19:25

Hi Simon, patches are a bit messy, as they are against the package, which has a different directory structure. So a straight `git apply <patch-file>` doesn't work in the upstream directory, one needs to use `patch -pX` with different values of `X` for different files.
Don't worry about this, I'll push a branch upstream with these changes applied.

After that, for the new release we'd also need to sort out packaging of GAP and Singular files, as Matthias
says. But it's certainly most important to fix the maths issues!

It's already possible to build and test this branch, with workaround in comment:62


---

Comment by dimpase created at 2022-03-08 12:37:20

I've collected the patches for upstream in https://github.com/sagemath/p_group_cohomology/tree/wip_trac_30787
see also
https://github.com/sagemath/p_group_cohomology/issues/6


---

Comment by mkoeppe created at 2022-03-08 19:05:06

Do I understand correctly that the only place (other than install scripts) that knows about the installation location of the database is `set_local_sources` (
https://github.com/sagemath/p_group_cohomology/blob/master/src/pGroupCohomology/factory.py#L617)?
----
New commits:


---

Comment by git created at 2022-03-08 19:20:38

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by jhpalmieri created at 2022-03-08 21:58:07

This should fix docbuilding.
----
New commits:


---

Comment by dimpase created at 2022-03-09 12:12:11

New commits:


---

Comment by git created at 2022-03-09 14:47:22

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by dimpase created at 2022-03-09 14:48:33

OK, refactoring done, what remains are maths errors.


---

Comment by SimonKing created at 2022-03-09 14:52:06

Replying to [comment:76 dimpase]:
> OK, refactoring done, what remains are maths errors.

Thank you! So, what's the plan now? I suppose I have to pull from the upstream repository to which you posted the new version, and then try to install it on my laptop, so that I can see what is happening on the mathematical side.

Question: Has there been a recent Singular upgrade in Sage? If so: What version of Sage?


---

Comment by SimonKing created at 2022-03-09 14:55:33

I just tried to pull, but I got permission denied. It could be that I am on a new laptop now. So, how can I convince git that I have permission to pull and push? Both for the upstream repository and for the sage trac please.


---

Comment by dimpase created at 2022-03-09 15:12:49

you probably don't need the upstream repo now. (for github  (and for git trac) you might need to create  a new ssh keypair, some old keys are now deemed too insecure)

Just build the branch of this ticket.


---

Comment by dimpase created at 2022-03-09 15:14:30

Singular now is 4.2.0 or 1, don't recall. (away from kbd now)


---

Comment by dimpase created at 2022-03-09 15:48:04

You can also run this branch in GitPod (the rightmost button in Status Badges above)
You'll get a VM with this branch pulled (but without p_group_cohomology built, so you'd need to do
`make p_group_cohomology` followed up by `make build` in the terminal window there). Takes 5-10 minutes to start.

You'd need to be authenticated to GitHub, I guess, to use it.


---

Comment by dimpase created at 2022-03-09 16:06:47

Oops, it seems that my latest change to the package created a circular import (only detected from a fresh build it seems)

See https://github.com/sagemath/p_group_cohomology/commit/3a7a043fe259b7ce667ad6b8f8d8ab0ea42a9fa4
One cannot import a package inside itself, I gather, but without this I can't 
call `os.path.dirname(pGroupCohomology.__file__)`. Any way out here?


---

Comment by dimpase created at 2022-03-09 16:25:35

I guess, just use `__file__` in these  calls, and remove `import` statements.


---

Comment by mkoeppe created at 2022-03-09 17:40:10

yes


---

Comment by git created at 2022-03-09 19:44:46

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-03-09 19:52:01

Branch pushed to git repo; I updated commit sha1. This was a forced push. Last 10 new commits:


---

Comment by SimonKing created at 2022-03-09 19:52:19

Replying to [comment:79 dimpase]:
> you probably don't need the upstream repo now.

At some point (namely when fixing the maths problem) I need to be able to push.

> (for github  (and for git trac) you might need to create  a new ssh keypair, some old keys are now deemed too insecure)

How? I'm logged in to my github account and visited my profile, but I see no hint how to upload my public ssh key. Also it is a long time since I last created an ssh key. How do I do this? On sage-devel, I saw that some special type of key is now needed.

> Just build the branch of this ticket.

This wouldn't allow me to work an the maths problem.
----
Last 10 new commits:


---

Comment by dimpase created at 2022-03-09 22:12:52

still an error to fix for the GAP package path. Should be ready soon.


---

Comment by dimpase created at 2022-03-09 22:47:09

Replying to [comment:89 SimonKing]:
> Replying to [comment:79 dimpase]:
> > you probably don't need the upstream repo now.
> 
> At some point (namely when fixing the maths problem) I need to be able to push.
> 
> > (for github  (and for git trac) you might need to create  a new ssh keypair, some old keys are now deemed too insecure)
> 
> How? I'm logged in to my github account and visited my profile, but I see no hint how to upload my public ssh key.

It's in Settings, not in Profile.


> Also it is a long time since I last created an ssh key. How do I do this? On sage-devel, I saw that some special type of key is now needed.

Nothing special, just secure by modern standards. Either a long RSA key (say, 4096 bits), or 
an ed25519 key. The command to run for the latter is `ssh-keygen -t ed25519`
 
> 
> > Just build the branch of this ticket.
> 
> This wouldn't allow me to work an the maths problem.
one can make patches against the package tarball, instead of re-creating the tarball
at the source repo. Anyway, you should be able to get your keys right.


---

Comment by git created at 2022-03-09 22:52:40

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2022-03-09 23:39:39

Is this currently expected to be able to be installed? When I tried `make modular_resolution`, I just get that it couldn't find the make target, similar for `sage -i modular_resolution`. It is being picked up by `sage --optional` (and I did also run `./configure` and `make build` before trying this too). Am I just doing something stupid (like forgetting a step)?


---

Comment by dimpase created at 2022-03-09 23:42:35

Perhaps it needs a run of `./bootstrap && ./configure --enable-download-from-upstream-url`?
It works for me now from a clean build - and it works even in GitPod.


---

Comment by dimpase created at 2022-03-09 23:43:55

`modular_resolution` by itself is not interesting, try `p_group_cohomology`.


---

Comment by dimpase created at 2022-03-09 23:50:06

Apparently, GitPod allows creating snapshots - so that's what I just have got there on this branch:

https://gitpod.io#snapshot/a3cc9419-a976-446c-8247-1f2d84b4cabc

(no idea for how long it persists)


---

Comment by tscrim created at 2022-03-10 00:02:37

I was not doing the `./bootstrap`, which I didn't think was necessary since I was adding this to my already built Sage. That fixed it.


---

Comment by jhpalmieri created at 2022-03-10 01:49:05

During compilation, I see a bunch of warnings ("unused variable" or "unused function"). Do we care about these?


---

Comment by SimonKing created at 2022-03-10 08:39:52

Replying to [comment:98 jhpalmieri]:
> During compilation, I see a bunch of warnings ("unused variable" or "unused function"). Do we care about these? 

I do. I'm afraid that it is a long time since last working on the package, but getting rid of warnings was one of my concerns.


---

Comment by mkoeppe created at 2022-03-19 00:15:15

Should we just merge this ticket, as going from "cannot be installed" to "can be installed" is already an improvement?


---

Comment by dimpase created at 2022-03-19 08:20:32

Yes, it would be good to have it in 9.6,
fixed, preferably (or else failing tests should be marked as bugs)


---

Comment by mkoeppe created at 2022-03-20 16:20:54

Changing priority from blocker to critical.


---

Comment by jhpalmieri created at 2022-08-08 22:07:12

See [this sage-devel](https://groups.google.com/g/sage-devel/c/KCu_VuBwjgg/m/fNhn6wtWAgAJ) message for a fix to build `p_group_cohomology`, along with #34221.


---

Comment by git created at 2022-08-09 03:37:18

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by mkoeppe created at 2022-08-09 03:54:46


```
sage -t --random-seed=154551441816182074078932648792662937529 src/sage/tests/modular_group_cohomology.py
**********************************************************************
File "src/sage/tests/modular_group_cohomology.py", line 10, in sage.tests.modular_group_cohomology
Failed example:
    from pGroupCohomology import CohomologyRing   # optional - p_group_cohomology
Exception raised:
    Traceback (most recent call last):
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 695, in _run
        self.compile_and_execute(example, compiler, test.globs)
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/src/sage/doctest/forker.py", line 1093, in compile_and_execute
        exec(compiled, globs)
      File "<doctest sage.tests.modular_group_cohomology[0]>", line 1, in <module>
        from pGroupCohomology import CohomologyRing   # optional - p_group_cohomology
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/pGroupCohomology/__init__.py", line 2466, in <module>
        from pGroupCohomology.factory import CohomologyRing
      File "/Users/mkoeppe/s/sage/sage-rebasing/worktree-gcc11/local/var/lib/sage/venv-python3.8/lib/python3.8/site-packages/pGroupCohomology/factory.py", line 45, in <module>
        from pGroupCohomology.cohomology import COHO
      File "pGroupCohomology/cohomology.pyx", line 71, in init pGroupCohomology.cohomology
        from sage.docs.instancedoc import instancedoc
    ImportError: cannot import name instancedoc
```



---

Comment by mkoeppe created at 2022-08-09 04:04:02

Broken by #33763?


---

Comment by tscrim created at 2022-08-09 04:07:50

Indeed, we need to change

```diff
-from sage.docs.instancedoc import instancedoc
+from sage.misc.instancedoc import instancedoc
```

upstream.


---

Comment by mkoeppe created at 2022-08-09 04:08:49

Looks like the deprecation done in #33763 somehow doesn't work


---

Comment by tscrim created at 2022-08-09 04:18:41

Maybe because it is a Cython file? It could be converted to a `.py` file, but then I don't get a deprecation message. Probably the best thing would be to display a deprecation message when `sage.docs.instancedoc` (maybe also changed to a `.py` file) is imported and the redirect is a normal import.

Well, this still will need to be fixed upstream anyways.


---

Comment by mkoeppe created at 2022-08-09 17:03:02

I've opened #34324 (Fix deprecated import of instancedoc)


---

Comment by mkoeppe created at 2022-08-09 17:12:39

Replying to [comment:113 tscrim]:
> Well, this still will need to be fixed upstream anyways.

That's now https://github.com/sagemath/p_group_cohomology/pull/7


---

Comment by git created at 2022-08-09 17:15:25

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by git created at 2022-08-09 17:32:05

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by git created at 2022-08-09 17:38:33

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by mkoeppe created at 2022-08-09 18:05:30

This fixes it. 

We are now back to the same status as comment:100, 5 months ago:
- it builds
- package testsuite (`make SAGE_CHECK=warn p_group_cohomology`) has failures
- 1 failure in `./sage -t src/sage/tests/modular_group_cohomology.py`

I'd suggest that we merge it as is.


---

Comment by mkoeppe created at 2022-08-09 18:05:41

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2022-08-09 18:33:38

I think that it should have #34291 as a dependency and set this back to optional.


---

Comment by git created at 2022-08-09 18:35:49

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2022-08-09 23:53:08

What would be your recommended way to test this package? Of course, I can do pull requests to fix things like

```
File "pGroupCohomology-3.3.3/pGroupCohomology/factory.py", line 909, in pGroupCohomology.factory.CohomologyRingFactory.create_group_key
Failed example:
    type(X._key[0][0])
Expected:
    <type 'sage.rings.integer.Integer'>
Got:
    <class 'sage.rings.integer.Integer'>
```

but if I wanted to start looking at the more serious bugs, what would be the most efficient way to test it? I imagine doing patches and rebuilding the spkg is not ideal.

`@`SimonKing If you have any comments, both on the mathematical side or the development side, they would be appreciated!


---

Comment by SimonKing created at 2022-08-09 23:57:43

I very much appreciate that you work on these things. Because of teaching, I didn't have much time recently. Actually, even though my [SageMath](SageMath) installation is still working on my laptop, git claims that there is no git repository in the source tree. Hence, I couldn't even upgrade my [SageMath](SageMath) installation. Today I finished a new build from scratch.

Next, I probably need to be reminded how to access/use the github repository of the cohomology package...


---

Comment by mkoeppe created at 2022-08-09 23:59:59

Replying to [comment:124 tscrim]:
> What would be your recommended way to test this package? Of course, I can do pull requests to fix things like
> {{{
> File "pGroupCohomology-3.3.3/pGroupCohomology/factory.py", line 909, in pGroupCohomology.factory.CohomologyRingFactory.create_group_key
> Failed example:
>     type(X._key[0][0])
> Expected:
>     <type 'sage.rings.integer.Integer'>
> Got:
>     <class 'sage.rings.integer.Integer'>
> }}}
> but if I wanted to start looking at the more serious bugs, what would be the most efficient way to test it? I imagine doing patches and rebuilding the spkg is not ideal.

You can just go into a git checkout of https://github.com/sagemath/p_group_cohomology,  and do `sage -pip install src/`


---

Comment by tscrim created at 2022-08-10 00:04:54

comment:125: No problem; I think we can all relate. `;)` It sounds like you might have accidentally deleted the `.git` folder. You can run

```
git clone git@github.com:sagemath/p_group_cohomology.git
```

(assuming you will access github via ssh; I got this from the (on my screen it is green) "code" button) from whatever folder you want to get the source code. You might even have direct push/pull access.

comment:126: Thank you. I am guessing I should run that command from the folder I put the pGpCoHo package?


---

Comment by mkoeppe created at 2022-08-10 00:06:06

Replying to [comment:127 tscrim]:
> comment:126: Thank you. I am guessing I should run that command from the folder I put the pGpCoHo package?

Yes, that's what I meant by "go into"


---

Comment by tscrim created at 2022-08-10 00:06:36

Replying to [comment:128 mkoeppe]:
> Replying to [comment:127 tscrim]:
> > comment:126: Thank you. I am guessing I should run that command from the folder I put the pGpCoHo package?
> 
> Yes, that's what I meant by "go into"

Ah, sorry I missed that. Thank you.


---

Attachment

Current failures of 3.3.3p1 version


---

Comment by SimonKing created at 2022-08-10 00:21:47

Replying to [comment:127 tscrim]:
> comment:125: No problem; I think we can all relate. `;)` It sounds like you might have accidentally deleted the `.git` folder. 

That would come as a surprise. Anyway, I used several worktrees, and I see a .git file (not a folder) whose content is `gitdir: /home/king/Sage/git/sage/.git/worktrees/py3`

Anyway, now I have a new Sage installation, I see not an urgent need to fix the old one, although I won't delete the old installations.

> You can run
> {{{
> git clone git`@`github.com:sagemath/p_group_cohomology.git
> }}}
> (assuming you will access github via ssh;

Meanwhile I have. Strange enough: I used to work with Sage on this laptop, but I needed to upload the public ssh key that I have on this laptop.


---

Comment by tscrim created at 2022-08-10 00:24:08

Replying to [comment:130 SimonKing]:
> Replying to [comment:127 tscrim]:
> > comment:125: No problem; I think we can all relate. `;)` It sounds like you might have accidentally deleted the `.git` folder. 
> 
> That would come as a surprise. Anyway, I used several worktrees, and I see a .git file (not a folder) whose content is `gitdir: /home/king/Sage/git/sage/.git/worktrees/py3`

That is very strange.

> Anyway, now I have a new Sage installation, I see not an urgent need to fix the old one, although I won't delete the old installations.

Indeed, it is not worth the trouble.

> Meanwhile I have. Strange enough: I used to work with Sage on this laptop, but I needed to upload the public ssh key that I have on this laptop.

That is because Github is not trac. They are different servers and both require your (public) ssh key.


---

Comment by mkoeppe created at 2022-08-10 16:58:39

Replying to [comment:119 mkoeppe]:
> We are now back to the same status as comment:100, 5 months ago:
> - it builds
> - package testsuite (`make SAGE_CHECK=warn p_group_cohomology`) has failures
> - 1 failure in `./sage -t src/sage/tests/modular_group_cohomology.py`
> 
> I'd suggest that we merge it as is. 

I've opened #34333 for fixing the tests.


---

Comment by jhpalmieri created at 2022-08-10 20:07:49

I agree that we should merge it as is, since it now builds. I won't set to "positive review" yet in case anyone disagrees, but I'll change it in a few days if no one says anything (or does it first).


---

Comment by dimpase created at 2022-08-10 21:02:37

it's good to go.


---

Comment by dimpase created at 2022-08-10 21:02:37

Changing status from needs_review to positive_review.


---

Comment by mkoeppe created at 2022-08-10 21:04:44

Thanks all!


---

Comment by tscrim created at 2022-08-10 23:45:34

+1 on this as the errors are likely a little more involved to fix and it would be good to keep this optional. However, one thing before we include this is marking the doctest failure within Sage as a `# known bug`.


---

Comment by tscrim created at 2022-08-10 23:45:34

Changing status from positive_review to needs_work.


---

Comment by mkoeppe created at 2022-08-10 23:46:59

This was also demanded in comment:101, but who's going to work on it?


---

Comment by mkoeppe created at 2022-08-10 23:49:02

Changing status from needs_work to needs_review.


---

Comment by tscrim created at 2022-08-11 00:08:34

It doesn't need to be fixed here, it is just having the doctest marked so we don't get the failure reported when running tests with the spkg installed.


---

Comment by tscrim created at 2022-08-11 00:11:59

I mean specifically the one in the Sage library noted in comment:64.


---

Comment by mkoeppe created at 2022-08-11 00:13:50

Outside the scope of the ticket to add such annotations.


---

Comment by tscrim created at 2022-08-11 00:19:58

I disagree. I have pushed it.
----
New commits:


---

Comment by mkoeppe created at 2022-08-11 00:21:56

Do you know that it's a bug?


---

Comment by tscrim created at 2022-08-11 00:27:20

No as I can't (quickly) find this in the literature (as I don't know this area very well). However, since it is in a tests file, I am operating under the assumption it has been verified through some other means. Furthermore, none of the other results have changed.

Simon, perhaps you can comment briefly on this?


---

Comment by mkoeppe created at 2022-08-11 00:32:14

Then please clarify the annotation from `# known bug` to `# known bug - at least one of the results is wrong`


---

Comment by git created at 2022-08-11 01:01:30

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by tscrim created at 2022-08-11 01:02:03

Done.


---

Comment by mkoeppe created at 2022-08-11 01:03:16

This is fine with me.


---

Comment by tscrim created at 2022-08-11 01:04:33

Changing status from needs_review to positive_review.


---

Comment by tscrim created at 2022-08-11 01:04:33

I am setting it back to a positive review then.

Simon (or John or someone else if you know), if you could comment on the correctness of the test output, that would be appreciated.


---

Comment by SimonKing created at 2022-08-11 05:40:47

Replying to [comment:146 tscrim]:
> No as I can't (quickly) find this in the literature (as I don't know this area very well). However, since it is in a tests file, I am operating under the assumption it has been verified through some other means. Furthermore, none of the other results have changed.
> 
> Simon, perhaps you can comment briefly on this?

In the test, an invariant of the group is calculated. So, if there are two different results than either the result computed by the old package version or the result computed by the new package version is wrong (or both). Therefore certainly one of the two versions has a bug.

I could ask Graham Ellis (my co-author in a publication on "persistant group cohomology") if he can compute this example: I know that he has software developed independently of `p_group_cohomology`.


---

Comment by tscrim created at 2022-08-11 07:54:34

Replying to [comment:152 SimonKing]:
> I could ask Graham Ellis (my co-author in a publication on "persistant group cohomology") if he can compute this example: I know that he has software developed independently of `p_group_cohomology`.

Thank you for your thoughts. Could you please ask him? Independent corroboration would be great.


---

Comment by vbraun created at 2022-08-29 11:24:27

Resolution: fixed
