# Issue 31160: Work around LaTeX bug for building pdf documentation

Issue created by migration from https://trac.sagemath.org/ticket/31397

Original creator: jhpalmieri

Original creation time: 2021-02-14 22:34:27

Very recent versions of LaTeX won't build the PDF documentation for `en/reference/stats/`, instead yielding an error:

```
Chapter 8.
! TeX capacity exceeded, sorry [input stack size=5000].
\non@alpherr #1->\@latex@error {\string #1
                                          allowed only in math mode}\@ehd 
l.2922 ...Samplers for \protect\(\ZZ[x]\protect\)}                                           
```

We should find a workaround.


---

Comment by jhpalmieri created at 2021-02-14 22:35:44

This is under discussion at ​https://tex.stackexchange.com/questions/583391/mactex-2020-error-with-report-hyperref-mathbf-in-chapter and has been proposed as a bug at ​https://github.com/latex3/latex2e/issues/501.


---

Comment by jhpalmieri created at 2021-02-14 23:21:22

This works for me (taken from one of the answers at tex.stackexchange.com).
----
New commits:


---

Comment by jhpalmieri created at 2021-02-14 23:21:22

Changing status from new to needs_review.


---

Comment by @DaveWitteMorris created at 2021-02-16 05:36:29

Changing status from needs_review to positive_review.


---

Comment by @DaveWitteMorris created at 2021-02-16 05:36:29

Works for me, too. Thanks for fixing this. 

By the way, I don't think `\makeatletter` and `\makeatother` are necessary, because the definition of `\pdfstringdefDisableCommands` in hyperref.sty already includes `\makeatletter`:

```
\def\pdfstringdefDisableCommands{%
  \begingroup
    \makeatletter
    \HyPsd@DisableCommands
}
```

However, I don't see any harm in adding the extra lines, and it seems possible that old versions of hyperref might not have this, so the extra lines may be safer.


---

Comment by jhpalmieri created at 2021-02-16 06:04:47

Great, thank you!


---

Comment by vbraun created at 2021-03-01 00:21:10

Resolution: fixed
