# Issue 9668: Fix hardcoding of paths in R binary

archive/issues_009668.json:
```json
{
    "assignees": [],
    "body": "See [this](http://groups.google.com/group/sage-devel/browse_thread/thread/b35848f099c763a9) thread on sage-support.\n\n```\nHere is how I got the optional package automap to install into a \nbinary sage R. \nGo into the sage directory and edit the following files: \nlocal/bin/R and local/lib/R/bin/R \nand change all the hard-set user variables \"/scratch/....\" to the true \nlocations of R_HOME_DIR, R_HOME, R_INCLUDE_DIR, R_SHARE_DIR and for \ngood measure, R_DOC_DIR. Replace the default string EVERYWHERE in the \nfile. \nI then exported SAGE_HOME as well (Not sure that this is needed.), and \nrun local/bin/R \nInside R, install.packages(\"automap\") \nNo more build errors, and when I restart R, automap loads using \nlibrary. Just have to try it out from sage now. \nAny chance there's a script to find all of these hard-set strings and \nchange them to correct values? \n```\n\n---\n\nRelated (R package):\n* #9906\n* #9847\n* #8274\n* #10967\n\n---\n\nNew spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)\n\n**Assignee:** @nexttime\n\n**CC:**  @nexttime @jhpalmieri\n\n**Keywords:** R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project\n\n**Reviewer:** Karl-Dieter Crisman, Jeroen Demeyer\n\n**Author:** John Palmieri\n\n**Merged:** sage-5.9.rc0\n\nIssue created by migration from https://trac.sagemath.org/ticket/9668\n\n",
    "closed_at": "2013-04-18T10:07:58Z",
    "created_at": "2010-08-02T14:33:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix hardcoding of paths in R binary",
    "type": "issue",
    "updated_at": "2013-04-18T10:07:58Z",
    "url": "https://github.com/sagemath/sage/issues/9668",
    "user": "https://github.com/kcrisman"
}
```
See [this](http://groups.google.com/group/sage-devel/browse_thread/thread/b35848f099c763a9) thread on sage-support.

```
Here is how I got the optional package automap to install into a 
binary sage R. 
Go into the sage directory and edit the following files: 
local/bin/R and local/lib/R/bin/R 
and change all the hard-set user variables "/scratch/...." to the true 
locations of R_HOME_DIR, R_HOME, R_INCLUDE_DIR, R_SHARE_DIR and for 
good measure, R_DOC_DIR. Replace the default string EVERYWHERE in the 
file. 
I then exported SAGE_HOME as well (Not sure that this is needed.), and 
run local/bin/R 
Inside R, install.packages("automap") 
No more build errors, and when I restart R, automap loads using 
library. Just have to try it out from sage now. 
Any chance there's a script to find all of these hard-set strings and 
change them to correct values? 
```

---

Related (R package):
* #9906
* #9847
* #8274
* #10967

---

New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)

**Assignee:** @nexttime

**CC:**  @nexttime @jhpalmieri

**Keywords:** R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project

**Reviewer:** Karl-Dieter Crisman, Jeroen Demeyer

**Author:** John Palmieri

**Merged:** sage-5.9.rc0

Issue created by migration from https://trac.sagemath.org/ticket/9668





---

archive/issue_events_104732.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T14:33:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104732"
}
```



---

archive/issue_events_104733.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T14:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
    "label_color": "08517b",
    "label_name": "component: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104733"
}
```



---

archive/issue_events_104734.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T14:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "008080",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104734"
}
```



---

archive/issue_comments_086611.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -17,3 +17,11 @@\n Any chance there's a script to find all of these hard-set strings and \n change them to correct values? \n ```\n+\n+---\n+\n+Related (R package):\n+* #9906\n+* #9847\n+* #8274\n+\n``````\n",
    "created_at": "2011-08-03T14:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86611",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -17,3 +17,11 @@
 Any chance there's a script to find all of these hard-set strings and 
 change them to correct values? 
 ```
+
+---
+
+Related (R package):
+* #9906
+* #9847
+* #8274
+
``````




---

archive/issue_comments_086612.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nIIRC I have some \"almost\" ready R spkg for #9906, which also does a lot of clean-up in `spkg-install`...",
    "created_at": "2011-08-03T14:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86612",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'>**Comment 2:**</a>
IIRC I have some "almost" ready R spkg for #9906, which also does a lot of clean-up in `spkg-install`...



---

archive/issue_comments_086613.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nWell, I would certainly welcome and help review this.  Anything which cleans up parts of #8274 could be commented there, and perhaps even a new ticket opened if there isn't much left.  \n\nBut what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?",
    "created_at": "2011-08-03T15:04:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86613",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'>**Comment 3:**</a>
Well, I would certainly welcome and help review this.  Anything which cleans up parts of #8274 could be commented there, and perhaps even a new ticket opened if there isn't much left.  

But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?



---

archive/issue_comments_086614.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nReplying to [@kcrisman](#comment%3A3):\n> But what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?\n\nNot yet, i.e. not all of it. See [comment:ticket:9906:14 this comment there].",
    "created_at": "2011-08-05T11:27:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86614",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'>**Comment 4:**</a>
Replying to [@kcrisman](#comment%3A3):
> But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?

Not yet, i.e. not all of it. See [comment:ticket:9906:14 this comment there].



---

archive/issue_comments_086615.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\nReplying to [@nexttime](#comment%3A4):\n> Replying to [@kcrisman](#comment%3A3):\n> > But what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?\n\n> \n> Not yet, i.e. not all of it. See [comment:ticket:9906:14 this comment there].\n\nOk, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).\n\n---\n\nThere was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a \"complicated\" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.",
    "created_at": "2011-08-05T16:09:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86615",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'>**Comment 5:**</a>
Replying to [@nexttime](#comment%3A4):
> Replying to [@kcrisman](#comment%3A3):
> > But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?

> 
> Not yet, i.e. not all of it. See [comment:ticket:9906:14 this comment there].

Ok, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).

---

There was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a "complicated" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.



---

archive/issue_comments_086616.json:
```json
{
    "body": "<a id='comment:6'>**Comment 6:**</a>\nReplying to [@nexttime](#comment%3A5):\n> Replying to [@nexttime](#comment%3A4):\n> > Replying to [@kcrisman](#comment%3A3):\n> > > But what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?\n\n> > \n> > Not yet, i.e. not all of it. See [comment:ticket:9906:14 this comment there].\n\n> Ok, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).\n\nOkay, I'll watch this space.\n> There was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a \"complicated\" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.\n\nAgreed.",
    "created_at": "2011-08-05T16:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86616",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'>**Comment 6:**</a>
Replying to [@nexttime](#comment%3A5):
> Replying to [@nexttime](#comment%3A4):
> > Replying to [@kcrisman](#comment%3A3):
> > > But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?

> > 
> > Not yet, i.e. not all of it. See [comment:ticket:9906:14 this comment there].

> Ok, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).

Okay, I'll watch this space.
> There was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a "complicated" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.

Agreed.



---

archive/issue_comments_086617.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nSee also #10967.  We should probably either incorporate that here, or make a followup spkg there.",
    "created_at": "2011-08-19T13:47:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86617",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'>**Comment 7:**</a>
See also #10967.  We should probably either incorporate that here, or make a followup spkg there.



---

archive/issue_comments_086618.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -24,4 +24,4 @@\n * #9906\n * #9847\n * #8274\n-\n+* #10967\n``````\n",
    "created_at": "2011-08-19T13:47:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86618",
    "user": "https://github.com/kcrisman"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -24,4 +24,4 @@
 * #9906
 * #9847
 * #8274
-
+* #10967
``````




---

archive/issue_comments_086619.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nReplying to [@kcrisman](#comment%3A7):\n> See also #10967.  We should probably either incorporate that here, or make a followup spkg there.  \n\nAlmost certainly the former.\n\n[Note to myself:]\n\nThe problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being \"automatically\" relocated in the first place.\n\nI'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.",
    "created_at": "2011-08-19T14:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86619",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:8'>**Comment 8:**</a>
Replying to [@kcrisman](#comment%3A7):
> See also #10967.  We should probably either incorporate that here, or make a followup spkg there.  

Almost certainly the former.

[Note to myself:]

The problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being "automatically" relocated in the first place.

I'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.



---

archive/issue_comments_086620.json:
```json
{
    "body": "**Dependencies:** #9906",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86620",
    "user": "https://github.com/nexttime"
}
```

**Dependencies:** #9906



---

archive/issue_comments_086621.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR\".",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86621",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "" to "R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR".



---

archive/issue_comments_086622.json:
```json
{
    "body": "**Assignee:** @nexttime",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86622",
    "user": "https://github.com/nexttime"
}
```

**Assignee:** @nexttime



---

archive/issue_comments_086623.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nReplying to [@nexttime](#comment%3A8):\n> [Note to myself:] \n\n> \n> The problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being \"automatically\" relocated in the first place.\n> \n> I'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.\n\nGuessing `SAGE_ROOT` there is simply bullshit. Simply add a sanity check, pointing to `sage --R`, `install_scripts()` and perhaps `sage --sh` in case `SAGE_LOCAL` isn't defined.\n\nFurthermore:\n\n* Address / check the following (copied from [comment:ticket:10967:14]):\n\n```\nThe problem was with hard-coded paths, not the \npermissions.  Anyway, the fix was easy.  I opened all the files listed \nabove by George: \nsage/local/lib/R/bin/R \nsage/local/lib/R/bin/libtool \nsage/local/lib/R/etc/Makeconf \nsage/local/lib/R/etc/ldpath \nsage/local/lib/R/etc/Renviron \nsage/local/bin/R \nand edited obvious lines containing hardcoded paths (using find- \nreplace-all at once). \n```\n\n* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86623",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'>**Comment 9:**</a>
Replying to [@nexttime](#comment%3A8):
> [Note to myself:] 

> 
> The problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being "automatically" relocated in the first place.
> 
> I'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.

Guessing `SAGE_ROOT` there is simply bullshit. Simply add a sanity check, pointing to `sage --R`, `install_scripts()` and perhaps `sage --sh` in case `SAGE_LOCAL` isn't defined.

Furthermore:

* Address / check the following (copied from [comment:ticket:10967:14]):

```
The problem was with hard-coded paths, not the 
permissions.  Anyway, the fix was easy.  I opened all the files listed 
above by George: 
sage/local/lib/R/bin/R 
sage/local/lib/R/bin/libtool 
sage/local/lib/R/etc/Makeconf 
sage/local/lib/R/etc/ldpath 
sage/local/lib/R/etc/Renviron 
sage/local/bin/R 
and edited obvious lines containing hardcoded paths (using find- 
replace-all at once). 
```

* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)



---

archive/issue_comments_086624.json:
```json
{
    "body": "**Work Issues:** Provide an R 2.10.1.p6 spkg.",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86624",
    "user": "https://github.com/nexttime"
}
```

**Work Issues:** Provide an R 2.10.1.p6 spkg.



---

archive/issue_comments_086625.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nReplying to [@nexttime](#comment%3A9):\n> * Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)\n\nShould read:\n\n* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, set `PKG_CONFIG_TOP_BUILD_DIR` to `$SAGE_ROOT` unless it is already, perhaps issuing a warning in case it isn't, or especially if its setting differs.) \n\n  Also prepend `$SAGE_ROOT/local/lib/pkgconfig` to `PKG_CONFIG_PATH`, unless it is already contained. Warn if `PKG_CONFIG_PATH` is empty, then set it to `$SAGE_ROOT/local/lib/pkgconfig`.",
    "created_at": "2011-08-21T02:16:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86625",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:10'>**Comment 10:**</a>
Replying to [@nexttime](#comment%3A9):
> * Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)

Should read:

* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, set `PKG_CONFIG_TOP_BUILD_DIR` to `$SAGE_ROOT` unless it is already, perhaps issuing a warning in case it isn't, or especially if its setting differs.) 

  Also prepend `$SAGE_ROOT/local/lib/pkgconfig` to `PKG_CONFIG_PATH`, unless it is already contained. Warn if `PKG_CONFIG_PATH` is empty, then set it to `$SAGE_ROOT/local/lib/pkgconfig`.



---

archive/issue_comments_086626.json:
```json
{
    "body": "**Changing keywords** from \"R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR\" to \"R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32\".",
    "created_at": "2011-08-24T23:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86626",
    "user": "https://github.com/williamstein"
}
```

**Changing keywords** from "R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR" to "R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32".



---

archive/issue_comments_086627.json:
```json
{
    "body": "**Changing keywords** from \"R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32\" to \"R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project\".",
    "created_at": "2011-11-20T01:20:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86627",
    "user": "https://github.com/kcrisman"
}
```

**Changing keywords** from "R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32" to "R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project".



---

archive/issue_comments_086628.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nThis problem prevents Sage from being relocatable on Solaris, or at least on the skynet machines mark and mark2: if I build Sage, then move the entire Sage directory, then run `sage` so the relocation scripts get executed, and then run `sage -R`, I get an error:\n\n```\n$ ./sage -R\nld.so.1: R: fatal: libgcc_s.so.1: version `GCC_4.3.0' not found (required by file /usr/local/gcc-4.7.0/sparc-SunOS-ultrasparc3/lib/libgomp.so.1)\nld.so.1: R: fatal: libgcc_s.so.1: open failed: No such file or directory\n/home/palmieri/mark2/sage-5.4.rc2-7797/spkg/bin/sage: line 457: 28710 Killed                  \"$SAGE_LOCAL/bin/R\" \"$@\"\n```\nI tried just modifying local/bin/R and local/lib/R/bin/R, replacing the hard-coded paths with `$SAGE_ROOT`, but I still got an error.",
    "created_at": "2012-10-26T16:45:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86628",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'>**Comment 14:**</a>
This problem prevents Sage from being relocatable on Solaris, or at least on the skynet machines mark and mark2: if I build Sage, then move the entire Sage directory, then run `sage` so the relocation scripts get executed, and then run `sage -R`, I get an error:

```
$ ./sage -R
ld.so.1: R: fatal: libgcc_s.so.1: version `GCC_4.3.0' not found (required by file /usr/local/gcc-4.7.0/sparc-SunOS-ultrasparc3/lib/libgomp.so.1)
ld.so.1: R: fatal: libgcc_s.so.1: open failed: No such file or directory
/home/palmieri/mark2/sage-5.4.rc2-7797/spkg/bin/sage: line 457: 28710 Killed                  "$SAGE_LOCAL/bin/R" "$@"
```
I tried just modifying local/bin/R and local/lib/R/bin/R, replacing the hard-coded paths with `$SAGE_ROOT`, but I still got an error.



---

archive/issue_comments_086629.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nI doubt this is related to the original topic at all.  The setup on skynet's Solaris machines is (or used to be) quite broken, as there are outdated versions of shared libraries left around in typical paths, and some R scripts insist on messing up your paths such that the former gets relevant.\n\nUnfortunately I don't recall what the exact problem was, and how I managed to work around it, just that I had to [and *somehow* successfully did]; I think this problem appeared with, or was related to, [the installation of] GCC 4.7.0.  In case I am right, changing `PATH` and/or `LD_LIBRARY_PATH` should \"solve\" the issue.\n\nSorry for not being of much help here, at least right now... ;-)",
    "created_at": "2012-10-26T19:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86629",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:15'>**Comment 15:**</a>
I doubt this is related to the original topic at all.  The setup on skynet's Solaris machines is (or used to be) quite broken, as there are outdated versions of shared libraries left around in typical paths, and some R scripts insist on messing up your paths such that the former gets relevant.

Unfortunately I don't recall what the exact problem was, and how I managed to work around it, just that I had to [and *somehow* successfully did]; I think this problem appeared with, or was related to, [the installation of] GCC 4.7.0.  In case I am right, changing `PATH` and/or `LD_LIBRARY_PATH` should "solve" the issue.

Sorry for not being of much help here, at least right now... ;-)



---

archive/issue_comments_086630.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nWell, if the problems on mark are not related, then for this ticket, we could just add some lines at the end of spkg-install:\n\n```\n# Make R relocatable by using \"$SAGE_ROOT\" instead of the hardcoded path.\nsed -e \"s|$SAGE_ROOT|\\$SAGE_ROOT/|\" \"$SAGE_LOCAL/bin/R\" > \"$SAGE_LOCAL/bin/R.tmp\" && mv \"$SAGE_LOCAL/bin/R.tmp\" \"$SAGE_LOCAL/bin/R\" && chmod a+x \"$SAGE_LOCAL/bin/R\"\nsed -e \"s|$SAGE_ROOT|\\$SAGE_ROOT/|\" \"$SAGE_LOCAL/lib/R/bin/R\" > \"$SAGE_LOCAL/lib/R/bin/R.tmp\" && mv \"$SAGE_LOCAL/lib/R/bin/R.tmp\" \"$SAGE_LOCAL/lib/R/bin/R\" && chmod a+x \"$SAGE_LOCAL/lib/R/bin/R\"\n```\n(It's too bad that the `-i` flag for sed is not portable.) `libR.pc` already uses SAGE_ROOT. What else needs to be done?",
    "created_at": "2012-10-26T19:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86630",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'>**Comment 16:**</a>
Well, if the problems on mark are not related, then for this ticket, we could just add some lines at the end of spkg-install:

```
# Make R relocatable by using "$SAGE_ROOT" instead of the hardcoded path.
sed -e "s|$SAGE_ROOT|\$SAGE_ROOT/|" "$SAGE_LOCAL/bin/R" > "$SAGE_LOCAL/bin/R.tmp" && mv "$SAGE_LOCAL/bin/R.tmp" "$SAGE_LOCAL/bin/R" && chmod a+x "$SAGE_LOCAL/bin/R"
sed -e "s|$SAGE_ROOT|\$SAGE_ROOT/|" "$SAGE_LOCAL/lib/R/bin/R" > "$SAGE_LOCAL/lib/R/bin/R.tmp" && mv "$SAGE_LOCAL/lib/R/bin/R.tmp" "$SAGE_LOCAL/lib/R/bin/R" && chmod a+x "$SAGE_LOCAL/lib/R/bin/R"
```
(It's too bad that the `-i` flag for sed is not portable.) `libR.pc` already uses SAGE_ROOT. What else needs to be done?



---

archive/issue_comments_086631.json:
```json
{
    "body": "**Author:** John Palmieri",
    "created_at": "2012-10-26T20:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86631",
    "user": "https://github.com/jhpalmieri"
}
```

**Author:** John Palmieri



---

archive/issue_comments_086632.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -25,3 +25,8 @@\n * #9847\n * #8274\n * #10967\n+\n+---\n+\n+New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)\n+\n``````\n",
    "created_at": "2012-10-26T20:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86632",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -25,3 +25,8 @@
 * #9847
 * #8274
 * #10967
+
+---
+
+New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)
+
``````




---

archive/issue_events_104735.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-26T20:27:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104735"
}
```



---

archive/issue_comments_086633.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nI've posted a new spkg, along with the corresponding patch.",
    "created_at": "2012-10-26T20:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86633",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'>**Comment 17:**</a>
I've posted a new spkg, along with the corresponding patch.



---

archive/issue_comments_086634.json:
```json
{
    "body": "**Changing work issues** from \"Provide an R 2.10.1.p6 spkg.\" to \"\".",
    "created_at": "2012-10-26T20:29:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86634",
    "user": "https://github.com/jhpalmieri"
}
```

**Changing work issues** from "Provide an R 2.10.1.p6 spkg." to "".



---

archive/issue_comments_086635.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nReplying to [@nexttime](#comment%3A9):\n> * Address / check the following (copied from [comment:ticket:10967:14]):\n> \n> ```\n> The problem was with hard-coded paths, not the \n> permissions.  Anyway, the fix was easy.  I opened all the files listed \n> above by George: \n> sage/local/lib/R/bin/R \n> sage/local/lib/R/bin/libtool \n> sage/local/lib/R/etc/Makeconf \n> sage/local/lib/R/etc/ldpath \n> sage/local/lib/R/etc/Renviron \n> sage/local/bin/R \n> and edited obvious lines containing hardcoded paths (using find- \n> replace-all at once). \n> ```\n\nIt's easy enough to add these to the \"for\" loop that I added to spkg-install, so I might as well do that. For what it's worth, the binary files `Rscript` in both local/bin and local/lib/R/bin also have the path hard-coded in them, but I don't know how to fix this, or whether it's important. When are those files used?",
    "created_at": "2012-10-26T20:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86635",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'>**Comment 19:**</a>
Replying to [@nexttime](#comment%3A9):
> * Address / check the following (copied from [comment:ticket:10967:14]):
> 
> ```
> The problem was with hard-coded paths, not the 
> permissions.  Anyway, the fix was easy.  I opened all the files listed 
> above by George: 
> sage/local/lib/R/bin/R 
> sage/local/lib/R/bin/libtool 
> sage/local/lib/R/etc/Makeconf 
> sage/local/lib/R/etc/ldpath 
> sage/local/lib/R/etc/Renviron 
> sage/local/bin/R 
> and edited obvious lines containing hardcoded paths (using find- 
> replace-all at once). 
> ```

It's easy enough to add these to the "for" loop that I added to spkg-install, so I might as well do that. For what it's worth, the binary files `Rscript` in both local/bin and local/lib/R/bin also have the path hard-coded in them, but I don't know how to fix this, or whether it's important. When are those files used?



---

archive/issue_comments_086636.json:
```json
{
    "body": "**Attachment:** [trac_9668-r.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.patch.gz)\n\npatch for R spkg; for review only",
    "created_at": "2012-10-26T21:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86636",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_9668-r.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.patch.gz)

patch for R spkg; for review only



---

archive/issue_comments_086637.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nThis patch for the spkg makes sense to me, anyway.\n\nDid you end up changing the libR.pc stuff in [comment:10](#comment%3A10)?  Or was that done elsewhere?",
    "created_at": "2013-01-03T21:17:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86637",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'>**Comment 20:**</a>
This patch for the spkg makes sense to me, anyway.

Did you end up changing the libR.pc stuff in [comment:10](#comment%3A10)?  Or was that done elsewhere?



---

archive/issue_comments_086638.json:
```json
{
    "body": "**Changing dependencies** from \"#9906\" to \"\".",
    "created_at": "2013-01-03T21:17:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86638",
    "user": "https://github.com/kcrisman"
}
```

**Changing dependencies** from "#9906" to "".



---

archive/issue_comments_086639.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nThe \".pc\" files are handled by the `sage-location` script, I think. In any case, I believe that if you run `make build` on a fresh Sage tarball, then libR.pc should be in good shape.",
    "created_at": "2013-01-03T21:36:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86639",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:21'>**Comment 21:**</a>
The ".pc" files are handled by the `sage-location` script, I think. In any case, I believe that if you run `make build` on a fresh Sage tarball, then libR.pc should be in good shape.



---

archive/issue_comments_086640.json:
```json
{
    "body": "**Reviewer:** Karl-Dieter Crisman",
    "created_at": "2013-01-03T21:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86640",
    "user": "https://github.com/kcrisman"
}
```

**Reviewer:** Karl-Dieter Crisman



---

archive/issue_events_104736.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-01-03T21:58:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104736"
}
```



---

archive/issue_events_104737.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-01-03T21:58:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104737"
}
```



---

archive/issue_comments_086641.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nThis looks good, and I now recall the sage-location discussion.  I think this is ready to go; it behaves as advertised.   I can't check whether this fixes the problems on Solaris directly, but it should fix the problem in the original post too - well, if such a person were to upgrade the spkg without just downloading a new Sage.",
    "created_at": "2013-01-03T21:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86641",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:22'>**Comment 22:**</a>
This looks good, and I now recall the sage-location discussion.  I think this is ready to go; it behaves as advertised.   I can't check whether this fixes the problems on Solaris directly, but it should fix the problem in the original post too - well, if such a person were to upgrade the spkg without just downloading a new Sage.



---

archive/issue_comments_086642.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nA slight correction to what I said before: just doing `make build` doesn't fix libR.pc, but running Sage once takes care of it.",
    "created_at": "2013-01-03T22:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86642",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:23'>**Comment 23:**</a>
A slight correction to what I said before: just doing `make build` doesn't fix libR.pc, but running Sage once takes care of it.



---

archive/issue_comments_086643.json:
```json
{
    "body": "<a id='comment:24'>**Comment 24:**</a>\nOr anything else that triggers `sage-location` (nowadays, any spkg upgrade even), yes.",
    "created_at": "2013-01-04T01:26:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86643",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'>**Comment 24:**</a>
Or anything else that triggers `sage-location` (nowadays, any spkg upgrade even), yes.



---

archive/issue_comments_086644.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\nI think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better solution would be to patch the R sources. This is already partially done (see `R.sh.patch` in the R sources) to allow for basic relocation of R, but apparently installing R packages doesn't work.",
    "created_at": "2013-01-04T12:39:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86644",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'>**Comment 25:**</a>
I think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better solution would be to patch the R sources. This is already partially done (see `R.sh.patch` in the R sources) to allow for basic relocation of R, but apparently installing R packages doesn't work.



---

archive/issue_events_104738.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-04T12:39:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104738"
}
```



---

archive/issue_events_104739.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-04T12:39:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104739"
}
```



---

archive/issue_comments_086645.json:
```json
{
    "body": "<a id='comment:26'>**Comment 26:**</a>\nReplying to [@jdemeyer](#comment%3A25):\n> I think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better \n\nOut of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?  I feel like we already don't allow whitespace, though that might be an old memory.  Does Sage work in non-ASCII paths as well, say with Cyrillic characters?",
    "created_at": "2013-01-04T14:55:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86645",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:26'>**Comment 26:**</a>
Replying to [@jdemeyer](#comment%3A25):
> I think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better 

Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?  I feel like we already don't allow whitespace, though that might be an old memory.  Does Sage work in non-ASCII paths as well, say with Cyrillic characters?



---

archive/issue_comments_086646.json:
```json
{
    "body": "<a id='comment:27'>**Comment 27:**</a>\nReplying to [@kcrisman](#comment%3A26):\n> Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?\n\nWe certainly do, although only \"no spaces\" is documented.\n\nBut I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|\"+*=@$'` (which is a valid UNIX filename)",
    "created_at": "2013-01-04T15:05:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86646",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'>**Comment 27:**</a>
Replying to [@kcrisman](#comment%3A26):
> Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?

We certainly do, although only "no spaces" is documented.

But I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|"+*=@$'` (which is a valid UNIX filename)



---

archive/issue_comments_086647.json:
```json
{
    "body": "<a id='comment:28'>**Comment 28:**</a>\n> > Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?\n\n> We certainly do, although only \"no spaces\" is documented.\n> \n> But I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|\"+*=@$'` (which is a valid UNIX filename)\n\nYou sound like you're arguing that we might as well use `sed` :-)  If I wasn't lazy I'd try to grep through other spkgs to see if it's used elsewhere - I'm almost sure I've seen it in use before...",
    "created_at": "2013-01-04T15:09:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86647",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:28'>**Comment 28:**</a>
> > Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?

> We certainly do, although only "no spaces" is documented.
> 
> But I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|"+*=@$'` (which is a valid UNIX filename)

You sound like you're arguing that we might as well use `sed` :-)  If I wasn't lazy I'd try to grep through other spkgs to see if it's used elsewhere - I'm almost sure I've seen it in use before...



---

archive/issue_comments_086648.json:
```json
{
    "body": "**Attachment:** [trac_9668-r.v2.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch.gz)\n\npatch for R spkg; for review only",
    "created_at": "2013-02-01T02:12:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86648",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_9668-r.v2.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch.gz)

patch for R spkg; for review only



---

archive/issue_events_104740.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T02:13:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104740"
}
```



---

archive/issue_events_104741.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T02:13:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104741"
}
```



---

archive/issue_comments_086649.json:
```json
{
    "body": "<a id='comment:29'>**Comment 29:**</a>\nHere is another attempt at fixing this.",
    "created_at": "2013-02-01T02:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86649",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:29'>**Comment 29:**</a>
Here is another attempt at fixing this.



---

archive/issue_events_104742.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:55:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104742"
}
```



---

archive/issue_events_104743.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:55:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104743"
}
```



---

archive/issue_comments_086650.json:
```json
{
    "body": "<a id='comment:31'>**Comment 31:**</a>\nWishful thinking: I accidentally set this to \"positive review\". Oops.\n\nI think the changes in [attachment:trac_9668-r.v2.patch](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch) could be polished a bit, but I'm not going to bother until people agree with the general approach.",
    "created_at": "2013-02-01T06:56:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86650",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:31'>**Comment 31:**</a>
Wishful thinking: I accidentally set this to "positive review". Oops.

I think the changes in [attachment:trac_9668-r.v2.patch](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch) could be polished a bit, but I'm not going to bother until people agree with the general approach.



---

archive/issue_events_104744.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:56:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104744"
}
```



---

archive/issue_events_104745.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:56:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104745"
}
```



---

archive/issue_comments_086651.json:
```json
{
    "body": "<a id='comment:32'>**Comment 32:**</a>\nI don't like this at all:\n\n```\n./configure --prefix=\"\\$SAGE_LOCAL\"\n```\nIf it works, you're probably relying on a bug. Why is it needed?\n\nAlso, the first hunk in `Makefile.in.patch` is not needed.\n\nIn any case, this needs to be rebased as R has been upgraded.",
    "created_at": "2013-03-16T22:27:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86651",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:32'>**Comment 32:**</a>
I don't like this at all:

```
./configure --prefix="\$SAGE_LOCAL"
```
If it works, you're probably relying on a bug. Why is it needed?

Also, the first hunk in `Makefile.in.patch` is not needed.

In any case, this needs to be rebased as R has been upgraded.



---

archive/issue_comments_086652.json:
```json
{
    "body": "<a id='comment:33'>**Comment 33:**</a>\nReplying to [@jdemeyer](#comment%3A32):\n> I don't like this at all:\n> \n> ```\n> ./configure --prefix=\"\\$SAGE_LOCAL\"\n> ```\n> If it works, you're probably relying on a bug. Why is it needed?\n\nIf I remember correctly, the prefix directory gets written into various of the files in `SAGE_LOCAL/lib/R/bin/`, so using `\\$SAGE_LOCAL` instead of `$SAGE_LOCAL` means that \"$SAGE_LOCAL\" gets written verbatim to the file, instead of expanded first and then written. This makes those files relocatable.\n\nWhy don't you like it?",
    "created_at": "2013-03-16T23:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86652",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:33'>**Comment 33:**</a>
Replying to [@jdemeyer](#comment%3A32):
> I don't like this at all:
> 
> ```
> ./configure --prefix="\$SAGE_LOCAL"
> ```
> If it works, you're probably relying on a bug. Why is it needed?

If I remember correctly, the prefix directory gets written into various of the files in `SAGE_LOCAL/lib/R/bin/`, so using `\$SAGE_LOCAL` instead of `$SAGE_LOCAL` means that "$SAGE_LOCAL" gets written verbatim to the file, instead of expanded first and then written. This makes those files relocatable.

Why don't you like it?



---

archive/issue_comments_086653.json:
```json
{
    "body": "<a id='comment:34'>**Comment 34:**</a>\nReplying to [@jhpalmieri](#comment%3A33):\n> Why don't you like it?\n\nBecause the fact that it works looks like a bug rather than a feature.",
    "created_at": "2013-03-17T10:07:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86653",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:34'>**Comment 34:**</a>
Replying to [@jhpalmieri](#comment%3A33):
> Why don't you like it?

Because the fact that it works looks like a bug rather than a feature.



---

archive/issue_comments_086654.json:
```json
{
    "body": "<a id='comment:35'>**Comment 35:**</a>\nIf you look at `src/scripts/R.sh.in`, it has lines like\n\n```\n        R_HOME_DIR=\"@prefix@/${libnn}/R\"\n```\nMy understanding is that `prefix` gets set by the configure script, stored in `Makefile.conf`, and then read by `src/scripts/Makefile` so this variable's value can get used when making the R script. In particular, the R people are deliberately using the `prefix` variable here. So it looks like their design decision, not a bug. But I'm not sure I understand your point.",
    "created_at": "2013-03-17T15:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86654",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:35'>**Comment 35:**</a>
If you look at `src/scripts/R.sh.in`, it has lines like

```
        R_HOME_DIR="@prefix@/${libnn}/R"
```
My understanding is that `prefix` gets set by the configure script, stored in `Makefile.conf`, and then read by `src/scripts/Makefile` so this variable's value can get used when making the R script. In particular, the R people are deliberately using the `prefix` variable here. So it looks like their design decision, not a bug. But I'm not sure I understand your point.



---

archive/issue_comments_086655.json:
```json
{
    "body": "<a id='comment:36'>**Comment 36:**</a>\nReplying to [@jhpalmieri](#comment%3A35):\n> If you look at `src/scripts/R.sh.in`, it has lines like\n> \n> ```\n>         R_HOME_DIR=\"@prefix@/${libnn}/R\"\n> ```\n\nThis line is completely irrelevant, as we already patch `R.sh.in` to overwrite `R_HOME_DIR`.",
    "created_at": "2013-03-17T15:50:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86655",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:36'>**Comment 36:**</a>
Replying to [@jhpalmieri](#comment%3A35):
> If you look at `src/scripts/R.sh.in`, it has lines like
> 
> ```
>         R_HOME_DIR="@prefix@/${libnn}/R"
> ```

This line is completely irrelevant, as we already patch `R.sh.in` to overwrite `R_HOME_DIR`.



---

archive/issue_comments_086656.json:
```json
{
    "body": "**Attachment:** [trac_9668-r.v3.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v3.patch.gz)",
    "created_at": "2013-03-18T01:02:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86656",
    "user": "https://github.com/jhpalmieri"
}
```

**Attachment:** [trac_9668-r.v3.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v3.patch.gz)



---

archive/issue_comments_086657.json:
```json
{
    "body": "<a id='comment:37'>**Comment 37:**</a>\nI'll post a new version of the spkg when sage.math is back up. I've attached the patch. This has the effect of changing lines in `local/bin/R` (and the corresponding file `local/lib/R/bin/R`) from\n\n```\nR_SHARE_DIR=.../sage-5.8.beta4/local/lib/R/share\nexport R_SHARE_DIR\nR_INCLUDE_DIR=.../sage-5.8.beta4/local/lib/R/include\nexport R_INCLUDE_DIR\nR_DOC_DIR=.../sage-5.8.beta4/local/lib/R/doc\nexport R_DOC_DIR\n```\nto\n\n```\nR_SHARE_DIR=\"${R_HOME_DIR}/share\"\nexport R_SHARE_DIR\nR_INCLUDE_DIR=\"${R_HOME_DIR}/include\"\nexport R_INCLUDE_DIR\nR_DOC_DIR=\"${R_HOME_DIR}/doc\"\nexport R_DOC_DIR\n```\nWith this change, running `sage -R` and then `install.packages(\"automap\")` seems to work.",
    "created_at": "2013-03-18T01:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86657",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:37'>**Comment 37:**</a>
I'll post a new version of the spkg when sage.math is back up. I've attached the patch. This has the effect of changing lines in `local/bin/R` (and the corresponding file `local/lib/R/bin/R`) from

```
R_SHARE_DIR=.../sage-5.8.beta4/local/lib/R/share
export R_SHARE_DIR
R_INCLUDE_DIR=.../sage-5.8.beta4/local/lib/R/include
export R_INCLUDE_DIR
R_DOC_DIR=.../sage-5.8.beta4/local/lib/R/doc
export R_DOC_DIR
```
to

```
R_SHARE_DIR="${R_HOME_DIR}/share"
export R_SHARE_DIR
R_INCLUDE_DIR="${R_HOME_DIR}/include"
export R_INCLUDE_DIR
R_DOC_DIR="${R_HOME_DIR}/doc"
export R_DOC_DIR
```
With this change, running `sage -R` and then `install.packages("automap")` seems to work.



---

archive/issue_comments_086658.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -28,5 +28,4 @@\n \n ---\n \n-New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)\n-\n+New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)\n``````\n",
    "created_at": "2013-03-18T17:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86658",
    "user": "https://github.com/jhpalmieri"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -28,5 +28,4 @@
 
 ---
 
-New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)
-
+New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)
``````




---

archive/issue_comments_086659.json:
```json
{
    "body": "<a id='comment:38'>**Comment 38:**</a>\nNew spkg posted.",
    "created_at": "2013-03-18T17:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86659",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'>**Comment 38:**</a>
New spkg posted.



---

archive/issue_comments_086660.json:
```json
{
    "body": "<a id='comment:39'>**Comment 39:**</a>\nReplying to [@jhpalmieri](#comment%3A37):\n> I'll post a new version of the spkg when sage.math is back up.\n\nReplying to [@jhpalmieri](#comment%3A38):\n> New spkg posted.\n\nI still cannot log into sage.math... ;-)",
    "created_at": "2013-03-18T18:12:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86660",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:39'>**Comment 39:**</a>
Replying to [@jhpalmieri](#comment%3A37):
> I'll post a new version of the spkg when sage.math is back up.

Replying to [@jhpalmieri](#comment%3A38):
> New spkg posted.

I still cannot log into sage.math... ;-)



---

archive/issue_comments_086661.json:
```json
{
    "body": "<a id='comment:40'>**Comment 40:**</a>\nReplying to [@nexttime](#comment%3A39):\n> Replying to [@jhpalmieri](#comment%3A37):\n> > I'll post a new version of the spkg when sage.math is back up.\n\n> \n> Replying to [@jhpalmieri](#comment%3A38):\n> > New spkg posted.\n\n> \n> I still cannot log into sage.math... ;-)\n\nI did an `scp` to boxen. If you want, I can try to keep my promise by posting the new version (again) when sage.math comes back up...",
    "created_at": "2013-03-18T18:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86661",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:40'>**Comment 40:**</a>
Replying to [@nexttime](#comment%3A39):
> Replying to [@jhpalmieri](#comment%3A37):
> > I'll post a new version of the spkg when sage.math is back up.

> 
> Replying to [@jhpalmieri](#comment%3A38):
> > New spkg posted.

> 
> I still cannot log into sage.math... ;-)

I did an `scp` to boxen. If you want, I can try to keep my promise by posting the new version (again) when sage.math comes back up...



---

archive/issue_comments_086662.json:
```json
{
    "body": "<a id='comment:41'>**Comment 41:**</a>\nFor what it's worth, someone reported on [ask.sagemath.org](http://ask.sagemath.org/question/2476/cant-install-r-packages-in-sage) that this spkg fixed their problem with installing an R package.",
    "created_at": "2013-04-16T17:34:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86662",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:41'>**Comment 41:**</a>
For what it's worth, someone reported on [ask.sagemath.org](http://ask.sagemath.org/question/2476/cant-install-r-packages-in-sage) that this spkg fixed their problem with installing an R package.



---

archive/issue_comments_086663.json:
```json
{
    "body": "<a id='comment:42'>**Comment 42:**</a>\nI think that sounds like a positive review, combined with Jeroen's good comments... What do you think?",
    "created_at": "2013-04-16T17:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86663",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:42'>**Comment 42:**</a>
I think that sounds like a positive review, combined with Jeroen's good comments... What do you think?



---

archive/issue_comments_086664.json:
```json
{
    "body": "<a id='comment:43'>**Comment 43:**</a>\nI think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.",
    "created_at": "2013-04-16T17:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86664",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:43'>**Comment 43:**</a>
I think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.



---

archive/issue_comments_086665.json:
```json
{
    "body": "<a id='comment:44'>**Comment 44:**</a>\n> I think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.\n\nI can do this.",
    "created_at": "2013-04-16T19:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86665",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:44'>**Comment 44:**</a>
> I think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.

I can do this.



---

archive/issue_comments_086666.json:
```json
{
    "body": "**Changing reviewer** from \"Karl-Dieter Crisman\" to \"Karl-Dieter Crisman, Jeroen Demeyer\".",
    "created_at": "2013-04-16T19:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86666",
    "user": "https://github.com/kcrisman"
}
```

**Changing reviewer** from "Karl-Dieter Crisman" to "Karl-Dieter Crisman, Jeroen Demeyer".



---

archive/issue_events_104746.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T19:47:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104746"
}
```



---

archive/issue_events_104747.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T19:47:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104747"
}
```



---

archive/issue_comments_086667.json:
```json
{
    "body": "<a id='comment:45'>**Comment 45:**</a>\nI confirmed that moving a Sage install (not just binary) caused installing an R package to fail with precisely the problems one would expect if these were incorrectly defined (e.g. \n\n```\nWarning: R include directory is empty -- perhaps need to install R-devel.rpm or similar\n```\nwith appropriate nonexistent directory referenced).  The script `local/bin/R` had the (now incorrect) paths.  \n\nThen installing this spkg and retrying caused success, and `local/bin/R` looks right now too.  Nice work!",
    "created_at": "2013-04-16T19:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86667",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:45'>**Comment 45:**</a>
I confirmed that moving a Sage install (not just binary) caused installing an R package to fail with precisely the problems one would expect if these were incorrectly defined (e.g. 

```
Warning: R include directory is empty -- perhaps need to install R-devel.rpm or similar
```
with appropriate nonexistent directory referenced).  The script `local/bin/R` had the (now incorrect) paths.  

Then installing this spkg and retrying caused success, and `local/bin/R` looks right now too.  Nice work!



---

archive/issue_comments_086668.json:
```json
{
    "body": "<a id='comment:46'>**Comment 46:**</a>\nOne question, though... when I move Sage back and run Sage, it doesn't change `R_HOME_DIR` back.\n\n```\nR_HOME_DIR=/Users/.../Downloads/tempR/sage-5.9.beta5/local/lib/R\n```\nwhen it should be\n\n```\nR_HOME_DIR=/Users/.../Downloads/sage-5.9.beta5/local/lib/R\n```\nSo this was changed, presumably, when I reinstalled the spkg.  It doesn't impact installing new R packages, by the way, nor functionality of R.\n\nIn particular, moving a *different* Sage installation and starting Sage changes some things, but doesn't change the location of `R_HOME_DIR` in `local/bin/R`.    I'm not sure why that doesn't affect functionality, but presumably this should somehow be taken care of.  On this ticket?",
    "created_at": "2013-04-16T20:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86668",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:46'>**Comment 46:**</a>
One question, though... when I move Sage back and run Sage, it doesn't change `R_HOME_DIR` back.

```
R_HOME_DIR=/Users/.../Downloads/tempR/sage-5.9.beta5/local/lib/R
```
when it should be

```
R_HOME_DIR=/Users/.../Downloads/sage-5.9.beta5/local/lib/R
```
So this was changed, presumably, when I reinstalled the spkg.  It doesn't impact installing new R packages, by the way, nor functionality of R.

In particular, moving a *different* Sage installation and starting Sage changes some things, but doesn't change the location of `R_HOME_DIR` in `local/bin/R`.    I'm not sure why that doesn't affect functionality, but presumably this should somehow be taken care of.  On this ticket?



---

archive/issue_events_104748.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T20:09:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104748"
}
```



---

archive/issue_events_104749.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T20:09:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104749"
}
```



---

archive/issue_comments_086669.json:
```json
{
    "body": "<a id='comment:47'>**Comment 47:**</a>\nIt took me a little while to understand this, too. Right before the lines defining `R_SHARE_DIR`, etc., there are lines\n\n```sh\nif test x$SAGE_BUILDING_R = x; then\n    R_HOME_DIR=\"$SAGE_LOCAL/lib/R/\"\nfi\n```\nIf you're not *building* the R spkg, then this will be executed, overriding the hard-coded path earlier in the script, and setting `R_HOME_DIR` to the desired portable setting. I don't know R, so I don't know how to test this: if you run `sage -R`, can you execute some R command to tell you the current setting of `R_HOME_DIR`?",
    "created_at": "2013-04-16T22:20:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86669",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:47'>**Comment 47:**</a>
It took me a little while to understand this, too. Right before the lines defining `R_SHARE_DIR`, etc., there are lines

```sh
if test x$SAGE_BUILDING_R = x; then
    R_HOME_DIR="$SAGE_LOCAL/lib/R/"
fi
```
If you're not *building* the R spkg, then this will be executed, overriding the hard-coded path earlier in the script, and setting `R_HOME_DIR` to the desired portable setting. I don't know R, so I don't know how to test this: if you run `sage -R`, can you execute some R command to tell you the current setting of `R_HOME_DIR`?



---

archive/issue_events_104750.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104750"
}
```



---

archive/issue_events_104751.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104751"
}
```



---

archive/issue_comments_086670.json:
```json
{
    "body": "<a id='comment:48'>**Comment 48:**</a>\nWell, that is a Sage-specific thing, I think, but we have\n\n```\nR_HOME=\"${R_HOME_DIR}\"\n```\nlater on and also\n\n```\n$ ./sage -R RHOME\n/Users/.../Downloads/sage-5.9.beta5/local/lib/R/\n```\nSo all is well, I think.",
    "created_at": "2013-04-17T01:36:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86670",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:48'>**Comment 48:**</a>
Well, that is a Sage-specific thing, I think, but we have

```
R_HOME="${R_HOME_DIR}"
```
later on and also

```
$ ./sage -R RHOME
/Users/.../Downloads/sage-5.9.beta5/local/lib/R/
```
So all is well, I think.



---

archive/issue_events_104752.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104752"
}
```



---

archive/issue_events_104753.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104753"
}
```



---

archive/issue_events_104754.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-18T10:07:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104754"
}
```



---

archive/issue_events_104755.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-18T10:07:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-104755"
}
```



---

archive/issue_comments_086671.json:
```json
{
    "body": "**Merged:** sage-5.9.rc0",
    "created_at": "2013-04-18T10:07:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-86671",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.9.rc0
