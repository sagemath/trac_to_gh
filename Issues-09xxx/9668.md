# Issue 9668: Fix hardcoding of paths in R binary

archive/issues_009668.json:
```json
{
    "assignees": [
        "https://github.com/nexttime"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nSee [this](http://groups.google.com/group/sage-devel/browse_thread/thread/b35848f099c763a9) thread on sage-support.\n\n```\nHere is how I got the optional package automap to install into a \nbinary sage R. \nGo into the sage directory and edit the following files: \nlocal/bin/R and local/lib/R/bin/R \nand change all the hard-set user variables \"/scratch/....\" to the true \nlocations of R_HOME_DIR, R_HOME, R_INCLUDE_DIR, R_SHARE_DIR and for \ngood measure, R_DOC_DIR. Replace the default string EVERYWHERE in the \nfile. \nI then exported SAGE_HOME as well (Not sure that this is needed.), and \nrun local/bin/R \nInside R, install.packages(\"automap\") \nNo more build errors, and when I restart R, automap loads using \nlibrary. Just have to try it out from sage now. \nAny chance there's a script to find all of these hard-set strings and \nchange them to correct values? \n```\n\n---\n\nRelated (R package):\n* #9906\n* #9847\n* #8274\n* #10967\n\n---\n\nNew spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)\n\nCC:  @nexttime @jhpalmieri\n\nComponent: **packages: standard**\n\nKeywords: **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project**\n\nAuthor: **John Palmieri**\n\nReviewer: **Karl-Dieter Crisman, Jeroen Demeyer**\n\nMerged: **sage-5.9.rc0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9668_\n\n",
    "closed_at": "2013-04-18T10:07:58Z",
    "created_at": "2010-08-02T14:33:47Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Fix hardcoding of paths in R binary",
    "type": "issue",
    "updated_at": "2013-04-18T10:07:58Z",
    "url": "https://github.com/sagemath/sage/issues/9668",
    "user": "https://github.com/kcrisman"
}
```
<div id="comment:0"></div>

See [this](http://groups.google.com/group/sage-devel/browse_thread/thread/b35848f099c763a9) thread on sage-support.

```
Here is how I got the optional package automap to install into a 
binary sage R. 
Go into the sage directory and edit the following files: 
local/bin/R and local/lib/R/bin/R 
and change all the hard-set user variables "/scratch/...." to the true 
locations of R_HOME_DIR, R_HOME, R_INCLUDE_DIR, R_SHARE_DIR and for 
good measure, R_DOC_DIR. Replace the default string EVERYWHERE in the 
file. 
I then exported SAGE_HOME as well (Not sure that this is needed.), and 
run local/bin/R 
Inside R, install.packages("automap") 
No more build errors, and when I restart R, automap loads using 
library. Just have to try it out from sage now. 
Any chance there's a script to find all of these hard-set strings and 
change them to correct values? 
```

---

Related (R package):
* #9906
* #9847
* #8274
* #10967

---

New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)

CC:  @nexttime @jhpalmieri

Component: **packages: standard**

Keywords: **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project**

Author: **John Palmieri**

Reviewer: **Karl-Dieter Crisman, Jeroen Demeyer**

Merged: **sage-5.9.rc0**

_Issue created by migration from https://trac.sagemath.org/ticket/9668_





---

archive/issue_events_123641.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T14:33:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123641"
}
```



---

archive/issue_events_123642.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T14:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123642"
}
```



---

archive/issue_events_123643.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T14:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123643"
}
```



---

archive/issue_events_123644.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-08-02T14:33:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123644"
}
```



---

archive/issue_comments_084691.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,3 +17,11 @@\n Any chance there's a script to find all of these hard-set strings and \n change them to correct values? \n ```\n+\n+---\n+\n+Related (R package):\n+* #9906\n+* #9847\n+* #8274\n+\n``````\n",
    "created_at": "2011-08-03T14:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84691",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,3 +17,11 @@
 Any chance there's a script to find all of these hard-set strings and 
 change them to correct values? 
 ```
+
+---
+
+Related (R package):
+* #9906
+* #9847
+* #8274
+
``````




---

archive/issue_comments_084692.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nIIRC I have some \"almost\" ready R spkg for #9906, which also does a lot of clean-up in `spkg-install`...",
    "created_at": "2011-08-03T14:26:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84692",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:2" align="right">comment:2</div>

IIRC I have some "almost" ready R spkg for #9906, which also does a lot of clean-up in `spkg-install`...



---

archive/issue_comments_084693.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWell, I would certainly welcome and help review this.  Anything which cleans up parts of #8274 could be commented there, and perhaps even a new ticket opened if there isn't much left.  \n\nBut what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?",
    "created_at": "2011-08-03T15:04:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84693",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:3" align="right">comment:3</div>

Well, I would certainly welcome and help review this.  Anything which cleans up parts of #8274 could be commented there, and perhaps even a new ticket opened if there isn't much left.  

But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?



---

archive/issue_comments_084694.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@kcrisman](#comment%3A3):\n> But what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?\n\nNot yet, i.e. not all of it. See [this comment there](https://github.com/sagemath/sage/issues/9906#comment:14).",
    "created_at": "2011-08-05T11:27:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84694",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@kcrisman](#comment%3A3):
> But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?

Not yet, i.e. not all of it. See [this comment there](https://github.com/sagemath/sage/issues/9906#comment:14).



---

archive/issue_comments_084695.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nReplying to [@nexttime](#comment%3A4):\n> Replying to [@kcrisman](#comment%3A3):\n> > But what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?\n> \n> \n> Not yet, i.e. not all of it. See [this comment there](https://github.com/sagemath/sage/issues/9906#comment:14).\n\nOk, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).\n\n---\n\nThere was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a \"complicated\" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.",
    "created_at": "2011-08-05T16:09:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84695",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:5" align="right">comment:5</div>

Replying to [@nexttime](#comment%3A4):
> Replying to [@kcrisman](#comment%3A3):
> > But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?
> 
> 
> Not yet, i.e. not all of it. See [this comment there](https://github.com/sagemath/sage/issues/9906#comment:14).

Ok, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).

---

There was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a "complicated" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.



---

archive/issue_comments_084696.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@nexttime](#comment%3A5):\n> Replying to [@nexttime](#comment%3A4):\n> > Replying to [@kcrisman](#comment%3A3):\n> > > But what about #9668 (this ticket) itself?  Does the stuff that is \"almost\" ready at #9906 address that?\n> > \n> > \n> > Not yet, i.e. not all of it. See [this comment there](https://github.com/sagemath/sage/issues/9906#comment:14).\n> \n> Ok, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).\n\nOkay, I'll watch this space.\n> There was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a \"complicated\" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.\n\nAgreed.",
    "created_at": "2011-08-05T16:29:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84696",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@nexttime](#comment%3A5):
> Replying to [@nexttime](#comment%3A4):
> > Replying to [@kcrisman](#comment%3A3):
> > > But what about #9668 (this ticket) itself?  Does the stuff that is "almost" ready at #9906 address that?
> > 
> > 
> > Not yet, i.e. not all of it. See [this comment there](https://github.com/sagemath/sage/issues/9906#comment:14).
> 
> Ok, a bit more subtle than I expected (R is quite weird, failed to build inbetween), but I now have a p6 that fixes both the `R` scripts and the `pkg-config` file (`libR.pc`).

Okay, I'll watch this space.
> There was another issue with R [someone reported on sage-devel](http://groups.google.com/group/sage-devel/msg/ebb50bd73aba7d53?dmode=source) which was caused by a "complicated" setting of an environment variable, in this case `PAGER`, but that's certainly an upstream problem and rather exotic.

Agreed.



---

archive/issue_comments_084697.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nSee also #10967.  We should probably either incorporate that here, or make a followup spkg there.",
    "created_at": "2011-08-19T13:47:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84697",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:7" align="right">comment:7</div>

See also #10967.  We should probably either incorporate that here, or make a followup spkg there.



---

archive/issue_comments_084698.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,4 +24,4 @@\n * #9906\n * #9847\n * #8274\n-\n+* #10967\n``````\n",
    "created_at": "2011-08-19T13:47:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84698",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,4 +24,4 @@
 * #9906
 * #9847
 * #8274
-
+* #10967
``````




---

archive/issue_comments_084699.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@kcrisman](#comment%3A7):\n> See also #10967.  We should probably either incorporate that here, or make a followup spkg there.  \n\nAlmost certainly the former.\n\n[Note to myself:]\n\nThe problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being \"automatically\" relocated in the first place.\n\nI'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.",
    "created_at": "2011-08-19T14:43:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84699",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@kcrisman](#comment%3A7):
> See also #10967.  We should probably either incorporate that here, or make a followup spkg there.  

Almost certainly the former.

[Note to myself:]

The problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being "automatically" relocated in the first place.

I'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.



---

archive/issue_comments_084700.json:
```json
{
    "body": "Dependencies: **#9906**",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84700",
    "user": "https://github.com/nexttime"
}
```

Dependencies: **#9906**



---

archive/issue_comments_084701.json:
```json
{
    "body": "Changed keywords from none to **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR**",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84701",
    "user": "https://github.com/nexttime"
}
```

Changed keywords from none to **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR**



---

archive/issue_events_123645.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-21T00:36:32Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "subject": "https://github.com/nexttime",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123645"
}
```



---

archive/issue_comments_084702.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@nexttime](#comment%3A8):\n> [Note to myself:] \n> \n> \n> The problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being \"automatically\" relocated in the first place.\n> \n> I'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.\n\nGuessing `SAGE_ROOT` there is simply bullshit. Simply add a sanity check, pointing to `sage --R`, `install_scripts()` and perhaps `sage --sh` in case `SAGE_LOCAL` isn't defined.\n\nFurthermore:\n\n* Address / check the following (copied from [comment:ticket:10967:14]):\n\n```\nThe problem was with hard-coded paths, not the \npermissions.  Anyway, the fix was easy.  I opened all the files listed \nabove by George: \nsage/local/lib/R/bin/R \nsage/local/lib/R/bin/libtool \nsage/local/lib/R/etc/Makeconf \nsage/local/lib/R/etc/ldpath \nsage/local/lib/R/etc/Renviron \nsage/local/bin/R \nand edited obvious lines containing hardcoded paths (using find- \nreplace-all at once). \n```\n\n* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84702",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@nexttime](#comment%3A8):
> [Note to myself:] 
> 
> 
> The problem is that removing any reference to `SAGE_ROOT` and `SAGE_LOCAL` disables the script being "automatically" relocated in the first place.
> 
> I'll then have to guess `SAGE_ROOT` if none of Sage's variables are defined. We also have two copies of the R script, one in `local/bin/`, and one in `local/lib/R/bin/`.

Guessing `SAGE_ROOT` there is simply bullshit. Simply add a sanity check, pointing to `sage --R`, `install_scripts()` and perhaps `sage --sh` in case `SAGE_LOCAL` isn't defined.

Furthermore:

* Address / check the following (copied from [comment:ticket:10967:14]):

```
The problem was with hard-coded paths, not the 
permissions.  Anyway, the fix was easy.  I opened all the files listed 
above by George: 
sage/local/lib/R/bin/R 
sage/local/lib/R/bin/libtool 
sage/local/lib/R/etc/Makeconf 
sage/local/lib/R/etc/ldpath 
sage/local/lib/R/etc/Renviron 
sage/local/bin/R 
and edited obvious lines containing hardcoded paths (using find- 
replace-all at once). 
```

* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)



---

archive/issue_comments_084703.json:
```json
{
    "body": "Work Issues: **Provide an R 2.10.1.p6 spkg.**",
    "created_at": "2011-08-21T00:36:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84703",
    "user": "https://github.com/nexttime"
}
```

Work Issues: **Provide an R 2.10.1.p6 spkg.**



---

archive/issue_comments_084704.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@nexttime](#comment%3A9):\n> * Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)\n\nShould read:\n\n* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, set `PKG_CONFIG_TOP_BUILD_DIR` to `$SAGE_ROOT` unless it is already, perhaps issuing a warning in case it isn't, or especially if its setting differs.) \n\n  Also prepend `$SAGE_ROOT/local/lib/pkgconfig` to `PKG_CONFIG_PATH`, unless it is already contained. Warn if `PKG_CONFIG_PATH` is empty, then set it to `$SAGE_ROOT/local/lib/pkgconfig`.",
    "created_at": "2011-08-21T02:16:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84704",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@nexttime](#comment%3A9):
> * Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, perhaps also set `PC_TOP_BUILD_DIR` to `$SAGE_ROOT`, or prepend `$SAGE_ROOT:`, unless it is already contained.)

Should read:

* Change `libR.pc` to use either `${pc_top_builddir}` or `$${SAGE_ROOT}`. (In the former case, set `PKG_CONFIG_TOP_BUILD_DIR` to `$SAGE_ROOT` unless it is already, perhaps issuing a warning in case it isn't, or especially if its setting differs.) 

  Also prepend `$SAGE_ROOT/local/lib/pkgconfig` to `PKG_CONFIG_PATH`, unless it is already contained. Warn if `PKG_CONFIG_PATH` is empty, then set it to `$SAGE_ROOT/local/lib/pkgconfig`.



---

archive/issue_comments_084705.json:
```json
{
    "body": "Changed keywords from **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR** to **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32**",
    "created_at": "2011-08-24T23:41:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84705",
    "user": "https://github.com/williamstein"
}
```

Changed keywords from **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR** to **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32**



---

archive/issue_comments_084706.json:
```json
{
    "body": "Changed keywords from **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32** to **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project**",
    "created_at": "2011-11-20T01:20:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84706",
    "user": "https://github.com/kcrisman"
}
```

Changed keywords from **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32** to **R spkg R.sh.in libR.pc pkg-config hard-coded package installation R_HOME_DIR sd32 r-project**



---

archive/issue_comments_084707.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThis problem prevents Sage from being relocatable on Solaris, or at least on the skynet machines mark and mark2: if I build Sage, then move the entire Sage directory, then run `sage` so the relocation scripts get executed, and then run `sage -R`, I get an error:\n\n```\n$ ./sage -R\nld.so.1: R: fatal: libgcc_s.so.1: version `GCC_4.3.0' not found (required by file /usr/local/gcc-4.7.0/sparc-SunOS-ultrasparc3/lib/libgomp.so.1)\nld.so.1: R: fatal: libgcc_s.so.1: open failed: No such file or directory\n/home/palmieri/mark2/sage-5.4.rc2-7797/spkg/bin/sage: line 457: 28710 Killed                  \"$SAGE_LOCAL/bin/R\" \"$@\"\n```\nI tried just modifying local/bin/R and local/lib/R/bin/R, replacing the hard-coded paths with `$SAGE_ROOT`, but I still got an error.",
    "created_at": "2012-10-26T16:45:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84707",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:14" align="right">comment:14</div>

This problem prevents Sage from being relocatable on Solaris, or at least on the skynet machines mark and mark2: if I build Sage, then move the entire Sage directory, then run `sage` so the relocation scripts get executed, and then run `sage -R`, I get an error:

```
$ ./sage -R
ld.so.1: R: fatal: libgcc_s.so.1: version `GCC_4.3.0' not found (required by file /usr/local/gcc-4.7.0/sparc-SunOS-ultrasparc3/lib/libgomp.so.1)
ld.so.1: R: fatal: libgcc_s.so.1: open failed: No such file or directory
/home/palmieri/mark2/sage-5.4.rc2-7797/spkg/bin/sage: line 457: 28710 Killed                  "$SAGE_LOCAL/bin/R" "$@"
```
I tried just modifying local/bin/R and local/lib/R/bin/R, replacing the hard-coded paths with `$SAGE_ROOT`, but I still got an error.



---

archive/issue_comments_084708.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nI doubt this is related to the original topic at all.  The setup on skynet's Solaris machines is (or used to be) quite broken, as there are outdated versions of shared libraries left around in typical paths, and some R scripts insist on messing up your paths such that the former gets relevant.\n\nUnfortunately I don't recall what the exact problem was, and how I managed to work around it, just that I had to [and *somehow* successfully did]; I think this problem appeared with, or was related to, [the installation of] GCC 4.7.0.  In case I am right, changing `PATH` and/or `LD_LIBRARY_PATH` should \"solve\" the issue.\n\nSorry for not being of much help here, at least right now... ;-)",
    "created_at": "2012-10-26T19:28:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84708",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:15" align="right">comment:15</div>

I doubt this is related to the original topic at all.  The setup on skynet's Solaris machines is (or used to be) quite broken, as there are outdated versions of shared libraries left around in typical paths, and some R scripts insist on messing up your paths such that the former gets relevant.

Unfortunately I don't recall what the exact problem was, and how I managed to work around it, just that I had to [and *somehow* successfully did]; I think this problem appeared with, or was related to, [the installation of] GCC 4.7.0.  In case I am right, changing `PATH` and/or `LD_LIBRARY_PATH` should "solve" the issue.

Sorry for not being of much help here, at least right now... ;-)



---

archive/issue_comments_084709.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nWell, if the problems on mark are not related, then for this ticket, we could just add some lines at the end of spkg-install:\n\n```\n# Make R relocatable by using \"$SAGE_ROOT\" instead of the hardcoded path.\nsed -e \"s|$SAGE_ROOT|\\$SAGE_ROOT/|\" \"$SAGE_LOCAL/bin/R\" > \"$SAGE_LOCAL/bin/R.tmp\" && mv \"$SAGE_LOCAL/bin/R.tmp\" \"$SAGE_LOCAL/bin/R\" && chmod a+x \"$SAGE_LOCAL/bin/R\"\nsed -e \"s|$SAGE_ROOT|\\$SAGE_ROOT/|\" \"$SAGE_LOCAL/lib/R/bin/R\" > \"$SAGE_LOCAL/lib/R/bin/R.tmp\" && mv \"$SAGE_LOCAL/lib/R/bin/R.tmp\" \"$SAGE_LOCAL/lib/R/bin/R\" && chmod a+x \"$SAGE_LOCAL/lib/R/bin/R\"\n```\n(It's too bad that the `-i` flag for sed is not portable.) `libR.pc` already uses SAGE_ROOT. What else needs to be done?",
    "created_at": "2012-10-26T19:47:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84709",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:16" align="right">comment:16</div>

Well, if the problems on mark are not related, then for this ticket, we could just add some lines at the end of spkg-install:

```
# Make R relocatable by using "$SAGE_ROOT" instead of the hardcoded path.
sed -e "s|$SAGE_ROOT|\$SAGE_ROOT/|" "$SAGE_LOCAL/bin/R" > "$SAGE_LOCAL/bin/R.tmp" && mv "$SAGE_LOCAL/bin/R.tmp" "$SAGE_LOCAL/bin/R" && chmod a+x "$SAGE_LOCAL/bin/R"
sed -e "s|$SAGE_ROOT|\$SAGE_ROOT/|" "$SAGE_LOCAL/lib/R/bin/R" > "$SAGE_LOCAL/lib/R/bin/R.tmp" && mv "$SAGE_LOCAL/lib/R/bin/R.tmp" "$SAGE_LOCAL/lib/R/bin/R" && chmod a+x "$SAGE_LOCAL/lib/R/bin/R"
```
(It's too bad that the `-i` flag for sed is not portable.) `libR.pc` already uses SAGE_ROOT. What else needs to be done?



---

archive/issue_comments_084710.json:
```json
{
    "body": "Author: **John Palmieri**",
    "created_at": "2012-10-26T20:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84710",
    "user": "https://github.com/jhpalmieri"
}
```

Author: **John Palmieri**



---

archive/issue_comments_084711.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,3 +25,8 @@\n * #9847\n * #8274\n * #10967\n+\n+---\n+\n+New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)\n+\n``````\n",
    "created_at": "2012-10-26T20:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84711",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,3 +25,8 @@
 * #9847
 * #8274
 * #10967
+
+---
+
+New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)
+
``````




---

archive/issue_events_123646.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2012-10-26T20:27:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123646"
}
```



---

archive/issue_comments_084712.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nI've posted a new spkg, along with the corresponding patch.",
    "created_at": "2012-10-26T20:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84712",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:17" align="right">comment:17</div>

I've posted a new spkg, along with the corresponding patch.



---

archive/issue_comments_084713.json:
```json
{
    "body": "Changed work issues from **Provide an R 2.10.1.p6 spkg.** to none",
    "created_at": "2012-10-26T20:29:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84713",
    "user": "https://github.com/jhpalmieri"
}
```

Changed work issues from **Provide an R 2.10.1.p6 spkg.** to none



---

archive/issue_comments_084714.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nReplying to [@nexttime](#comment%3A9):\n> * Address / check the following (copied from [comment:ticket:10967:14]):\n> \n> ```\n> The problem was with hard-coded paths, not the \n> permissions.  Anyway, the fix was easy.  I opened all the files listed \n> above by George: \n> sage/local/lib/R/bin/R \n> sage/local/lib/R/bin/libtool \n> sage/local/lib/R/etc/Makeconf \n> sage/local/lib/R/etc/ldpath \n> sage/local/lib/R/etc/Renviron \n> sage/local/bin/R \n> and edited obvious lines containing hardcoded paths (using find- \n> replace-all at once). \n> ```\n\nIt's easy enough to add these to the \"for\" loop that I added to spkg-install, so I might as well do that. For what it's worth, the binary files `Rscript` in both local/bin and local/lib/R/bin also have the path hard-coded in them, but I don't know how to fix this, or whether it's important. When are those files used?",
    "created_at": "2012-10-26T20:41:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84714",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:19" align="right">comment:19</div>

Replying to [@nexttime](#comment%3A9):
> * Address / check the following (copied from [comment:ticket:10967:14]):
> 
> ```
> The problem was with hard-coded paths, not the 
> permissions.  Anyway, the fix was easy.  I opened all the files listed 
> above by George: 
> sage/local/lib/R/bin/R 
> sage/local/lib/R/bin/libtool 
> sage/local/lib/R/etc/Makeconf 
> sage/local/lib/R/etc/ldpath 
> sage/local/lib/R/etc/Renviron 
> sage/local/bin/R 
> and edited obvious lines containing hardcoded paths (using find- 
> replace-all at once). 
> ```

It's easy enough to add these to the "for" loop that I added to spkg-install, so I might as well do that. For what it's worth, the binary files `Rscript` in both local/bin and local/lib/R/bin also have the path hard-coded in them, but I don't know how to fix this, or whether it's important. When are those files used?



---

archive/issue_comments_084715.json:
```json
{
    "body": "Attachment: **[trac_9668-r.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.patch.gz)**\n\npatch for R spkg; for review only",
    "created_at": "2012-10-26T21:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84715",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_9668-r.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.patch.gz)**

patch for R spkg; for review only



---

archive/issue_comments_084716.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nThis patch for the spkg makes sense to me, anyway.\n\nDid you end up changing the libR.pc stuff in [comment:10](#comment%3A10)?  Or was that done elsewhere?",
    "created_at": "2013-01-03T21:17:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84716",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:20" align="right">comment:20</div>

This patch for the spkg makes sense to me, anyway.

Did you end up changing the libR.pc stuff in [comment:10](#comment%3A10)?  Or was that done elsewhere?



---

archive/issue_comments_084717.json:
```json
{
    "body": "Changed dependencies from **#9906** to none",
    "created_at": "2013-01-03T21:17:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84717",
    "user": "https://github.com/kcrisman"
}
```

Changed dependencies from **#9906** to none



---

archive/issue_comments_084718.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nThe \".pc\" files are handled by the `sage-location` script, I think. In any case, I believe that if you run `make build` on a fresh Sage tarball, then libR.pc should be in good shape.",
    "created_at": "2013-01-03T21:36:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84718",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:21" align="right">comment:21</div>

The ".pc" files are handled by the `sage-location` script, I think. In any case, I believe that if you run `make build` on a fresh Sage tarball, then libR.pc should be in good shape.



---

archive/issue_comments_084719.json:
```json
{
    "body": "Reviewer: **Karl-Dieter Crisman**",
    "created_at": "2013-01-03T21:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84719",
    "user": "https://github.com/kcrisman"
}
```

Reviewer: **Karl-Dieter Crisman**



---

archive/issue_events_123647.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-01-03T21:58:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123647"
}
```



---

archive/issue_events_123648.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-01-03T21:58:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123648"
}
```



---

archive/issue_comments_084720.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nThis looks good, and I now recall the sage-location discussion.  I think this is ready to go; it behaves as advertised.   I can't check whether this fixes the problems on Solaris directly, but it should fix the problem in the original post too - well, if such a person were to upgrade the spkg without just downloading a new Sage.",
    "created_at": "2013-01-03T21:58:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84720",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:22" align="right">comment:22</div>

This looks good, and I now recall the sage-location discussion.  I think this is ready to go; it behaves as advertised.   I can't check whether this fixes the problems on Solaris directly, but it should fix the problem in the original post too - well, if such a person were to upgrade the spkg without just downloading a new Sage.



---

archive/issue_comments_084721.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nA slight correction to what I said before: just doing `make build` doesn't fix libR.pc, but running Sage once takes care of it.",
    "created_at": "2013-01-03T22:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84721",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:23" align="right">comment:23</div>

A slight correction to what I said before: just doing `make build` doesn't fix libR.pc, but running Sage once takes care of it.



---

archive/issue_comments_084722.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nOr anything else that triggers `sage-location` (nowadays, any spkg upgrade even), yes.",
    "created_at": "2013-01-04T01:26:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84722",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:24" align="right">comment:24</div>

Or anything else that triggers `sage-location` (nowadays, any spkg upgrade even), yes.



---

archive/issue_comments_084723.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nI think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better solution would be to patch the R sources. This is already partially done (see `R.sh.patch` in the R sources) to allow for basic relocation of R, but apparently installing R packages doesn't work.",
    "created_at": "2013-01-04T12:39:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84723",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

I think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better solution would be to patch the R sources. This is already partially done (see `R.sh.patch` in the R sources) to allow for basic relocation of R, but apparently installing R packages doesn't work.



---

archive/issue_events_123649.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-04T12:39:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123649"
}
```



---

archive/issue_events_123650.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-01-04T12:39:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123650"
}
```



---

archive/issue_comments_084724.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jdemeyer](#comment%3A25):\n> I think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better \n\nOut of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?  I feel like we already don't allow whitespace, though that might be an old memory.  Does Sage work in non-ASCII paths as well, say with Cyrillic characters?",
    "created_at": "2013-01-04T14:55:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84724",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jdemeyer](#comment%3A25):
> I think using `sed` for this is very fragile, as any special characters in `$SAGE_ROOT` might cause this script to malfunction. A better 

Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?  I feel like we already don't allow whitespace, though that might be an old memory.  Does Sage work in non-ASCII paths as well, say with Cyrillic characters?



---

archive/issue_comments_084725.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@kcrisman](#comment%3A26):\n> Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?\n\nWe certainly do, although only \"no spaces\" is documented.\n\nBut I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|\"+*=@$'` (which is a valid UNIX filename)",
    "created_at": "2013-01-04T15:05:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84725",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@kcrisman](#comment%3A26):
> Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?

We certainly do, although only "no spaces" is documented.

But I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|"+*=@$'` (which is a valid UNIX filename)



---

archive/issue_comments_084726.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n> > Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?\n> \n> We certainly do, although only \"no spaces\" is documented.\n> \n> But I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|\"+*=@$'` (which is a valid UNIX filename)\n\nYou sound like you're arguing that we might as well use `sed` :-)  If I wasn't lazy I'd try to grep through other spkgs to see if it's used elsewhere - I'm almost sure I've seen it in use before...",
    "created_at": "2013-01-04T15:09:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84726",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:28" align="right">comment:28</div>

> > Out of curiosity, do we have any current restrictions on the characters in `$SAGE_ROOT`?
> 
> We certainly do, although only "no spaces" is documented.
> 
> But I doubt Sage will work correctly with a directory like `/home/jdemeyer/.#|"+*=@$'` (which is a valid UNIX filename)

You sound like you're arguing that we might as well use `sed` :-)  If I wasn't lazy I'd try to grep through other spkgs to see if it's used elsewhere - I'm almost sure I've seen it in use before...



---

archive/issue_comments_084727.json:
```json
{
    "body": "Attachment: **[trac_9668-r.v2.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch.gz)**\n\npatch for R spkg; for review only",
    "created_at": "2013-02-01T02:12:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84727",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_9668-r.v2.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch.gz)**

patch for R spkg; for review only



---

archive/issue_events_123651.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T02:13:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123651"
}
```



---

archive/issue_events_123652.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T02:13:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123652"
}
```



---

archive/issue_comments_084728.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nHere is another attempt at fixing this.",
    "created_at": "2013-02-01T02:13:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84728",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:29" align="right">comment:29</div>

Here is another attempt at fixing this.



---

archive/issue_events_123653.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:55:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123653"
}
```



---

archive/issue_events_123654.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:55:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123654"
}
```



---

archive/issue_comments_084729.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nWishful thinking: I accidentally set this to \"positive review\". Oops.\n\nI think the changes in [attachment: trac_9668-r.v2.patch](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch.gz) could be polished a bit, but I'm not going to bother until people agree with the general approach.",
    "created_at": "2013-02-01T06:56:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84729",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:31" align="right">comment:31</div>

Wishful thinking: I accidentally set this to "positive review". Oops.

I think the changes in [attachment: trac_9668-r.v2.patch](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v2.patch.gz) could be polished a bit, but I'm not going to bother until people agree with the general approach.



---

archive/issue_events_123655.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:56:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123655"
}
```



---

archive/issue_events_123656.json:
```json
{
    "actor": "https://github.com/jhpalmieri",
    "created_at": "2013-02-01T06:56:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123656"
}
```



---

archive/issue_comments_084730.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI don't like this at all:\n\n```\n./configure --prefix=\"\\$SAGE_LOCAL\"\n```\nIf it works, you're probably relying on a bug. Why is it needed?\n\nAlso, the first hunk in `Makefile.in.patch` is not needed.\n\nIn any case, this needs to be rebased as R has been upgraded.",
    "created_at": "2013-03-16T22:27:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84730",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:32" align="right">comment:32</div>

I don't like this at all:

```
./configure --prefix="\$SAGE_LOCAL"
```
If it works, you're probably relying on a bug. Why is it needed?

Also, the first hunk in `Makefile.in.patch` is not needed.

In any case, this needs to be rebased as R has been upgraded.



---

archive/issue_comments_084731.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@jdemeyer](#comment%3A32):\n> I don't like this at all:\n> \n> ```\n> ./configure --prefix=\"\\$SAGE_LOCAL\"\n> ```\n> If it works, you're probably relying on a bug. Why is it needed?\n\nIf I remember correctly, the prefix directory gets written into various of the files in `SAGE_LOCAL/lib/R/bin/`, so using `\\$SAGE_LOCAL` instead of `$SAGE_LOCAL` means that \"$SAGE_LOCAL\" gets written verbatim to the file, instead of expanded first and then written. This makes those files relocatable.\n\nWhy don't you like it?",
    "created_at": "2013-03-16T23:55:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84731",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@jdemeyer](#comment%3A32):
> I don't like this at all:
> 
> ```
> ./configure --prefix="\$SAGE_LOCAL"
> ```
> If it works, you're probably relying on a bug. Why is it needed?

If I remember correctly, the prefix directory gets written into various of the files in `SAGE_LOCAL/lib/R/bin/`, so using `\$SAGE_LOCAL` instead of `$SAGE_LOCAL` means that "$SAGE_LOCAL" gets written verbatim to the file, instead of expanded first and then written. This makes those files relocatable.

Why don't you like it?



---

archive/issue_comments_084732.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jhpalmieri](#comment%3A33):\n> Why don't you like it?\n\nBecause the fact that it works looks like a bug rather than a feature.",
    "created_at": "2013-03-17T10:07:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84732",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jhpalmieri](#comment%3A33):
> Why don't you like it?

Because the fact that it works looks like a bug rather than a feature.



---

archive/issue_comments_084733.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nIf you look at `src/scripts/R.sh.in`, it has lines like\n\n```\n        R_HOME_DIR=\"@prefix@/${libnn}/R\"\n```\nMy understanding is that `prefix` gets set by the configure script, stored in `Makefile.conf`, and then read by `src/scripts/Makefile` so this variable's value can get used when making the R script. In particular, the R people are deliberately using the `prefix` variable here. So it looks like their design decision, not a bug. But I'm not sure I understand your point.",
    "created_at": "2013-03-17T15:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84733",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">comment:35</div>

If you look at `src/scripts/R.sh.in`, it has lines like

```
        R_HOME_DIR="@prefix@/${libnn}/R"
```
My understanding is that `prefix` gets set by the configure script, stored in `Makefile.conf`, and then read by `src/scripts/Makefile` so this variable's value can get used when making the R script. In particular, the R people are deliberately using the `prefix` variable here. So it looks like their design decision, not a bug. But I'm not sure I understand your point.



---

archive/issue_comments_084734.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@jhpalmieri](#comment%3A35):\n> If you look at `src/scripts/R.sh.in`, it has lines like\n> \n> ```\n>         R_HOME_DIR=\"@prefix@/${libnn}/R\"\n> ```\n\nThis line is completely irrelevant, as we already patch `R.sh.in` to overwrite `R_HOME_DIR`.",
    "created_at": "2013-03-17T15:50:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84734",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@jhpalmieri](#comment%3A35):
> If you look at `src/scripts/R.sh.in`, it has lines like
> 
> ```
>         R_HOME_DIR="@prefix@/${libnn}/R"
> ```

This line is completely irrelevant, as we already patch `R.sh.in` to overwrite `R_HOME_DIR`.



---

archive/issue_comments_084735.json:
```json
{
    "body": "Attachment: **[trac_9668-r.v3.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v3.patch.gz)**",
    "created_at": "2013-03-18T01:02:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84735",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment: **[trac_9668-r.v3.patch.gz](https://github.com/sagemath/sage/files/ticket9668/trac_9668-r.v3.patch.gz)**



---

archive/issue_comments_084736.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nI'll post a new version of the spkg when sage.math is back up. I've attached the patch. This has the effect of changing lines in `local/bin/R` (and the corresponding file `local/lib/R/bin/R`) from\n\n```\nR_SHARE_DIR=.../sage-5.8.beta4/local/lib/R/share\nexport R_SHARE_DIR\nR_INCLUDE_DIR=.../sage-5.8.beta4/local/lib/R/include\nexport R_INCLUDE_DIR\nR_DOC_DIR=.../sage-5.8.beta4/local/lib/R/doc\nexport R_DOC_DIR\n```\nto\n\n```\nR_SHARE_DIR=\"${R_HOME_DIR}/share\"\nexport R_SHARE_DIR\nR_INCLUDE_DIR=\"${R_HOME_DIR}/include\"\nexport R_INCLUDE_DIR\nR_DOC_DIR=\"${R_HOME_DIR}/doc\"\nexport R_DOC_DIR\n```\nWith this change, running `sage -R` and then `install.packages(\"automap\")` seems to work.",
    "created_at": "2013-03-18T01:05:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84736",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:37" align="right">comment:37</div>

I'll post a new version of the spkg when sage.math is back up. I've attached the patch. This has the effect of changing lines in `local/bin/R` (and the corresponding file `local/lib/R/bin/R`) from

```
R_SHARE_DIR=.../sage-5.8.beta4/local/lib/R/share
export R_SHARE_DIR
R_INCLUDE_DIR=.../sage-5.8.beta4/local/lib/R/include
export R_INCLUDE_DIR
R_DOC_DIR=.../sage-5.8.beta4/local/lib/R/doc
export R_DOC_DIR
```
to

```
R_SHARE_DIR="${R_HOME_DIR}/share"
export R_SHARE_DIR
R_INCLUDE_DIR="${R_HOME_DIR}/include"
export R_INCLUDE_DIR
R_DOC_DIR="${R_HOME_DIR}/doc"
export R_DOC_DIR
```
With this change, running `sage -R` and then `install.packages("automap")` seems to work.



---

archive/issue_comments_084737.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,5 +28,4 @@\n \n ---\n \n-New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)\n-\n+New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)\n``````\n",
    "created_at": "2013-03-18T17:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84737",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,5 +28,4 @@
 
 ---
 
-New spkg: [http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg](http://sage.math.washington.edu/home/palmieri/SPKG/r-2.14.0.p7.spkg)
-
+New spkg: [http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg](http://boxen.math.washington.edu/home/palmieri/SPKG/r-2.15.2.p2.spkg)
``````




---

archive/issue_comments_084738.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nNew spkg posted.",
    "created_at": "2013-03-18T17:38:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84738",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:38" align="right">comment:38</div>

New spkg posted.



---

archive/issue_comments_084739.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nReplying to [@jhpalmieri](#comment%3A37):\n> I'll post a new version of the spkg when sage.math is back up.\n\nReplying to [@jhpalmieri](#comment%3A38):\n> New spkg posted.\n\nI still cannot log into sage.math... ;-)",
    "created_at": "2013-03-18T18:12:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84739",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:39" align="right">comment:39</div>

Replying to [@jhpalmieri](#comment%3A37):
> I'll post a new version of the spkg when sage.math is back up.

Replying to [@jhpalmieri](#comment%3A38):
> New spkg posted.

I still cannot log into sage.math... ;-)



---

archive/issue_comments_084740.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@nexttime](#comment%3A39):\n> Replying to [@jhpalmieri](#comment%3A37):\n> > I'll post a new version of the spkg when sage.math is back up.\n> \n> \n> Replying to [@jhpalmieri](#comment%3A38):\n> > New spkg posted.\n> \n> \n> I still cannot log into sage.math... ;-)\n\nI did an `scp` to boxen. If you want, I can try to keep my promise by posting the new version (again) when sage.math comes back up...",
    "created_at": "2013-03-18T18:33:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84740",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@nexttime](#comment%3A39):
> Replying to [@jhpalmieri](#comment%3A37):
> > I'll post a new version of the spkg when sage.math is back up.
> 
> 
> Replying to [@jhpalmieri](#comment%3A38):
> > New spkg posted.
> 
> 
> I still cannot log into sage.math... ;-)

I did an `scp` to boxen. If you want, I can try to keep my promise by posting the new version (again) when sage.math comes back up...



---

archive/issue_comments_084741.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nFor what it's worth, someone reported on [ask.sagemath.org](http://ask.sagemath.org/question/2476/cant-install-r-packages-in-sage) that this spkg fixed their problem with installing an R package.",
    "created_at": "2013-04-16T17:34:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84741",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:41" align="right">comment:41</div>

For what it's worth, someone reported on [ask.sagemath.org](http://ask.sagemath.org/question/2476/cant-install-r-packages-in-sage) that this spkg fixed their problem with installing an R package.



---

archive/issue_comments_084742.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nI think that sounds like a positive review, combined with Jeroen's good comments... What do you think?",
    "created_at": "2013-04-16T17:48:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84742",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:42" align="right">comment:42</div>

I think that sounds like a positive review, combined with Jeroen's good comments... What do you think?



---

archive/issue_comments_084743.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.",
    "created_at": "2013-04-16T17:54:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84743",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:43" align="right">comment:43</div>

I think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.



---

archive/issue_comments_084744.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\n> I think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.\n\nI can do this.",
    "created_at": "2013-04-16T19:30:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84744",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:44" align="right">comment:44</div>

> I think that someone should confirm that with the new spkg, in the script `local/bin/R`, the variables `R_SHARE_DIR`, `R_INCLUDE_DIR`, and `R_DOC_DIR` are now defined in terms of `R_HOME_DIR` rather than being hard-coded paths as they are with the current spkg.

I can do this.



---

archive/issue_comments_084745.json:
```json
{
    "body": "Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Jeroen Demeyer**",
    "created_at": "2013-04-16T19:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84745",
    "user": "https://github.com/kcrisman"
}
```

Changed reviewer from **Karl-Dieter Crisman** to **Karl-Dieter Crisman, Jeroen Demeyer**



---

archive/issue_events_123657.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T19:47:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123657"
}
```



---

archive/issue_events_123658.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T19:47:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123658"
}
```



---

archive/issue_comments_084746.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nI confirmed that moving a Sage install (not just binary) caused installing an R package to fail with precisely the problems one would expect if these were incorrectly defined (e.g. \n\n```\nWarning: R include directory is empty -- perhaps need to install R-devel.rpm or similar\n```\nwith appropriate nonexistent directory referenced).  The script `local/bin/R` had the (now incorrect) paths.  \n\nThen installing this spkg and retrying caused success, and `local/bin/R` looks right now too.  Nice work!",
    "created_at": "2013-04-16T19:47:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84746",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:45" align="right">comment:45</div>

I confirmed that moving a Sage install (not just binary) caused installing an R package to fail with precisely the problems one would expect if these were incorrectly defined (e.g. 

```
Warning: R include directory is empty -- perhaps need to install R-devel.rpm or similar
```
with appropriate nonexistent directory referenced).  The script `local/bin/R` had the (now incorrect) paths.  

Then installing this spkg and retrying caused success, and `local/bin/R` looks right now too.  Nice work!



---

archive/issue_comments_084747.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nOne question, though... when I move Sage back and run Sage, it doesn't change `R_HOME_DIR` back.\n\n```\nR_HOME_DIR=/Users/.../Downloads/tempR/sage-5.9.beta5/local/lib/R\n```\nwhen it should be\n\n```\nR_HOME_DIR=/Users/.../Downloads/sage-5.9.beta5/local/lib/R\n```\nSo this was changed, presumably, when I reinstalled the spkg.  It doesn't impact installing new R packages, by the way, nor functionality of R.\n\nIn particular, moving a *different* Sage installation and starting Sage changes some things, but doesn't change the location of `R_HOME_DIR` in `local/bin/R`.    I'm not sure why that doesn't affect functionality, but presumably this should somehow be taken care of.  On this ticket?",
    "created_at": "2013-04-16T20:09:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84747",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:46" align="right">comment:46</div>

One question, though... when I move Sage back and run Sage, it doesn't change `R_HOME_DIR` back.

```
R_HOME_DIR=/Users/.../Downloads/tempR/sage-5.9.beta5/local/lib/R
```
when it should be

```
R_HOME_DIR=/Users/.../Downloads/sage-5.9.beta5/local/lib/R
```
So this was changed, presumably, when I reinstalled the spkg.  It doesn't impact installing new R packages, by the way, nor functionality of R.

In particular, moving a *different* Sage installation and starting Sage changes some things, but doesn't change the location of `R_HOME_DIR` in `local/bin/R`.    I'm not sure why that doesn't affect functionality, but presumably this should somehow be taken care of.  On this ticket?



---

archive/issue_events_123659.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T20:09:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123659"
}
```



---

archive/issue_events_123660.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-16T20:09:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123660"
}
```



---

archive/issue_comments_084748.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nIt took me a little while to understand this, too. Right before the lines defining `R_SHARE_DIR`, etc., there are lines\n\n```sh\nif test x$SAGE_BUILDING_R = x; then\n    R_HOME_DIR=\"$SAGE_LOCAL/lib/R/\"\nfi\n```\nIf you're not *building* the R spkg, then this will be executed, overriding the hard-coded path earlier in the script, and setting `R_HOME_DIR` to the desired portable setting. I don't know R, so I don't know how to test this: if you run `sage -R`, can you execute some R command to tell you the current setting of `R_HOME_DIR`?",
    "created_at": "2013-04-16T22:20:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84748",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:47" align="right">comment:47</div>

It took me a little while to understand this, too. Right before the lines defining `R_SHARE_DIR`, etc., there are lines

```sh
if test x$SAGE_BUILDING_R = x; then
    R_HOME_DIR="$SAGE_LOCAL/lib/R/"
fi
```
If you're not *building* the R spkg, then this will be executed, overriding the hard-coded path earlier in the script, and setting `R_HOME_DIR` to the desired portable setting. I don't know R, so I don't know how to test this: if you run `sage -R`, can you execute some R command to tell you the current setting of `R_HOME_DIR`?



---

archive/issue_events_123661.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123661"
}
```



---

archive/issue_events_123662.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123662"
}
```



---

archive/issue_comments_084749.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nWell, that is a Sage-specific thing, I think, but we have\n\n```\nR_HOME=\"${R_HOME_DIR}\"\n```\nlater on and also\n\n```\n$ ./sage -R RHOME\n/Users/.../Downloads/sage-5.9.beta5/local/lib/R/\n```\nSo all is well, I think.",
    "created_at": "2013-04-17T01:36:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84749",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:48" align="right">comment:48</div>

Well, that is a Sage-specific thing, I think, but we have

```
R_HOME="${R_HOME_DIR}"
```
later on and also

```
$ ./sage -R RHOME
/Users/.../Downloads/sage-5.9.beta5/local/lib/R/
```
So all is well, I think.



---

archive/issue_events_123663.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123663"
}
```



---

archive/issue_events_123664.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2013-04-17T01:36:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123664"
}
```



---

archive/issue_events_123665.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-18T10:07:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123665"
}
```



---

archive/issue_events_123666.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-04-18T10:07:58Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9668#event-123666"
}
```



---

archive/issue_comments_084750.json:
```json
{
    "body": "Merged: **sage-5.9.rc0**",
    "created_at": "2013-04-18T10:07:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9668",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9668#issuecomment-84750",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.9.rc0**
