# Issue 9202: update matplotlib

archive/issues_009202.json:
```json
{
    "body": "This spkg updates matplotlib to 0.99.3.  I've attached the patch as well (don't apply; it's just for reviewing purposes).\n\nThe new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3.spkg (md5 checksum 2c8660d9d40f6759ece89c074bc0a351)\n\nAssignee: drkirkby\n\nCC:  drkirkby @kcrisman\n\nResolution: fixed\n\nAuthor: Jason Grout\n\nReviewer: David Kirkby\n\nUpstream: Reported upstream. Little or no feedback.\n\nMerged: sage-4.5.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/9202\n\n",
    "closed_at": "2010-06-25T15:44:52Z",
    "created_at": "2010-06-10T12:17:15Z",
    "labels": [
        "component: packages: standard"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5",
    "title": "update matplotlib",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9202",
    "user": "https://github.com/jasongrout"
}
```
This spkg updates matplotlib to 0.99.3.  I've attached the patch as well (don't apply; it's just for reviewing purposes).

The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3.spkg (md5 checksum 2c8660d9d40f6759ece89c074bc0a351)

Assignee: drkirkby

CC:  drkirkby @kcrisman

Resolution: fixed

Author: Jason Grout

Reviewer: David Kirkby

Upstream: Reported upstream. Little or no feedback.

Merged: sage-4.5.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/9202





---

archive/issue_comments_102561.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2010-06-10T12:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102561",
    "user": "https://github.com/jasongrout"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_102562.json:
```json
{
    "body": "<a id='comment:1'></a>Hmmm...trying to run something from matplotlib says:\n\n```\nTraceback (most recent call last):    q=ax.scatter(x,y)\n  File \"\", line 1, in <module>\n    \n  File \"/private/var/folders/2J/2JGMKXefHFWmTZ1Ln92Z4U+++TI/-Tmp-/tmp_3GqZ9/___code___.py\", line 3, in <module>\n    import matplotlib.pyplot as plt\n  File \"/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/pyplot.py\", line 6, in <module>\n    from matplotlib.figure import Figure, figaspect\n  File \"/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/figure.py\", line 18, in <module>\n    from axes import Axes, SubplotBase, subplot_class_factory\n  File \"/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/axes.py\", line 12, in <module>\n    import matplotlib.axis as maxis\n  File \"/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/axis.py\", line 10, in <module>\n    import matplotlib.font_manager as font_manager\n  File \"/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/font_manager.py\", line 52, in <module>\n    from matplotlib import ft2font\nImportError: dlopen(/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/ft2font.so, 2): Library not loaded: /opt/local/lib/libfreetype.6.dylib\n  Referenced from: /Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/ft2font.so\n  Reason: Incompatible library version: ft2font.so requires version 11.0.0 or later, but libfreetype.6.dylib provides version 10.0.0\n```\n\nSo somehow this is picking up my macports version of freetype.  That's a problem.",
    "created_at": "2010-06-10T12:26:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102562",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:1'></a>Hmmm...trying to run something from matplotlib says:

```
Traceback (most recent call last):    q=ax.scatter(x,y)
  File "", line 1, in <module>
    
  File "/private/var/folders/2J/2JGMKXefHFWmTZ1Ln92Z4U+++TI/-Tmp-/tmp_3GqZ9/___code___.py", line 3, in <module>
    import matplotlib.pyplot as plt
  File "/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/pyplot.py", line 6, in <module>
    from matplotlib.figure import Figure, figaspect
  File "/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/figure.py", line 18, in <module>
    from axes import Axes, SubplotBase, subplot_class_factory
  File "/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/axes.py", line 12, in <module>
    import matplotlib.axis as maxis
  File "/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/axis.py", line 10, in <module>
    import matplotlib.font_manager as font_manager
  File "/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/font_manager.py", line 52, in <module>
    from matplotlib import ft2font
ImportError: dlopen(/Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/ft2font.so, 2): Library not loaded: /opt/local/lib/libfreetype.6.dylib
  Referenced from: /Users/grout/sage/local/lib/python2.6/site-packages/matplotlib/ft2font.so
  Reason: Incompatible library version: ft2font.so requires version 11.0.0 or later, but libfreetype.6.dylib provides version 10.0.0
```

So somehow this is picking up my macports version of freetype.  That's a problem.



---

archive/issue_comments_102563.json:
```json
{
    "body": "<a id='comment:2'></a>Not working on Solaris either. It still reports:\n\n```\nREQUIRED DEPENDENCIES\n                 numpy: 1.3.0\n             freetype2: 9.7.3\n```\n\nFreetype is really confusing in that there are 3 numbers associated with a release. Then to make matters worst, sometimes it called freetype, and other times freetype2. I think they are the same. \n\n```\n   release    libtool      so\n  -------------------------------\n     2.3.12     10.0.4    6.4.0\n     2.3.11     9.22.3    6.3.22\n     2.3.10     9.21.3    6.3.21\n     2.3.9      9.20.3    6.3.20\n     2.3.8      9.19.3    6.3.19\n     2.3.7      9.18.3    6.3.18\n     2.3.6      9.17.3    6.3.17\n     2.3.5      9.16.3    6.3.16\n     2.3.4      9.15.3    6.3.15\n     2.3.3      9.14.3    6.3.14\n     2.3.2      9.13.3    6.3.13\n     2.3.1      9.12.3    6.3.12\n     2.3.0      9.11.3    6.3.11\n     2.2.1      9.10.3    6.3.10\n     2.2.0      9.9.3     6.3.9\n     2.1.10     9.8.3     6.3.8\n     2.1.9      9.7.3     6.3.7\n     2.1.8      9.6.3     6.3.6 \n```\n\nfreetype2 9.7.3 is also known as version 2.1.8. Since Sage 4.4.3 includes freetype 2.3.5, matplotlib should report it has found freetype2 version 9.16.3 and not 9.7.3 as it does. \n\nRather inconveniently, the version of freetype globally installed on sage.math and boxen.math are the same as in Sage. This makes the message from matplotlib about the version of freetype will be the same in either case. \n\n||                   |                   |\n||-------------------|-------------------|\n||**release version**|**libtool version**|\n|Latest freeetype2|2.3.12|10.0.4|\n|sage.math|2.3.5|9.16.3|\n|In Sage 4.4.3|2.3.5|9.16.3|\n|As supplied on Solaris 10 03/05|2.1.9|9.7.3|\n**I think if you manage to get matplotlib to indicate it has found freetype2, but is unable to determine the version, I think you will have solved it.** At the moment matplotlib seems to be using pkg-config on Solaris and Linux (but not OS X) to look up the version, and find the directories of the include and library files. \n\nDave",
    "created_at": "2010-06-10T13:06:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102563",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:2'></a>Not working on Solaris either. It still reports:

```
REQUIRED DEPENDENCIES
                 numpy: 1.3.0
             freetype2: 9.7.3
```

Freetype is really confusing in that there are 3 numbers associated with a release. Then to make matters worst, sometimes it called freetype, and other times freetype2. I think they are the same. 

```
   release    libtool      so
  -------------------------------
     2.3.12     10.0.4    6.4.0
     2.3.11     9.22.3    6.3.22
     2.3.10     9.21.3    6.3.21
     2.3.9      9.20.3    6.3.20
     2.3.8      9.19.3    6.3.19
     2.3.7      9.18.3    6.3.18
     2.3.6      9.17.3    6.3.17
     2.3.5      9.16.3    6.3.16
     2.3.4      9.15.3    6.3.15
     2.3.3      9.14.3    6.3.14
     2.3.2      9.13.3    6.3.13
     2.3.1      9.12.3    6.3.12
     2.3.0      9.11.3    6.3.11
     2.2.1      9.10.3    6.3.10
     2.2.0      9.9.3     6.3.9
     2.1.10     9.8.3     6.3.8
     2.1.9      9.7.3     6.3.7
     2.1.8      9.6.3     6.3.6 
```

freetype2 9.7.3 is also known as version 2.1.8. Since Sage 4.4.3 includes freetype 2.3.5, matplotlib should report it has found freetype2 version 9.16.3 and not 9.7.3 as it does. 

Rather inconveniently, the version of freetype globally installed on sage.math and boxen.math are the same as in Sage. This makes the message from matplotlib about the version of freetype will be the same in either case. 

||                   |                   |
||-------------------|-------------------|
||**release version**|**libtool version**|
|Latest freeetype2|2.3.12|10.0.4|
|sage.math|2.3.5|9.16.3|
|In Sage 4.4.3|2.3.5|9.16.3|
|As supplied on Solaris 10 03/05|2.1.9|9.7.3|
**I think if you manage to get matplotlib to indicate it has found freetype2, but is unable to determine the version, I think you will have solved it.** At the moment matplotlib seems to be using pkg-config on Solaris and Linux (but not OS X) to look up the version, and find the directories of the include and library files. 

Dave



---

archive/issue_comments_102564.json:
```json
{
    "body": "<a id='comment:3'></a>I forgot to add, one other change that is needed, is a revised spkg-install, to ensure matplotlib builds 64-bit. \n\n```\nif [ `uname` = \"Darwin\" -a \"$SAGE64\" = \"yes\" ]; then\n   echo \"64 bit MacIntel\"\n   CFLAGS=\"-O2 -g -m64 \"; export CFLAGS\n   LDFLAGS=\"-m64 \"; export LDFLAGS\nfi\n```\n\nshould be changed to:\n\n```\nif [ \"x$SAGE64\" = xyes ]; then\n   echo \"Building a 64-bit version of matplotlib\"\n   CFLAGS=\"-O2 -g -m64 \"; export CFLAGS\n   LDFLAGS=\"-m64 \"; export LDFLAGS\nfi\n```",
    "created_at": "2010-06-10T13:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102564",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:3'></a>I forgot to add, one other change that is needed, is a revised spkg-install, to ensure matplotlib builds 64-bit. 

```
if [ `uname` = "Darwin" -a "$SAGE64" = "yes" ]; then
   echo "64 bit MacIntel"
   CFLAGS="-O2 -g -m64 "; export CFLAGS
   LDFLAGS="-m64 "; export LDFLAGS
fi
```

should be changed to:

```
if [ "x$SAGE64" = xyes ]; then
   echo "Building a 64-bit version of matplotlib"
   CFLAGS="-O2 -g -m64 "; export CFLAGS
   LDFLAGS="-m64 "; export LDFLAGS
fi
```



---

archive/issue_comments_102565.json:
```json
{
    "body": "Changing assignee from tbd to drkirkby.",
    "created_at": "2010-06-10T13:36:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102565",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing assignee from tbd to drkirkby.



---

archive/issue_comments_102566.json:
```json
{
    "body": "<a id='comment:4'></a>See #9208 for an update to sage-env which fixes the problem of matplotlib finding the wrong version of freetype - it requires no modification to the matplotlib source at all. This will probably not work on OS X, as OS X does not appear to have the pkg-config command that both Solaris and Linux have. (This is based on observations on sage.math, boxen.math, t2.math, bsd.math and my own Sun Blade 1000 running Solaris 10 03/05)",
    "created_at": "2010-06-10T23:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102566",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:4'></a>See #9208 for an update to sage-env which fixes the problem of matplotlib finding the wrong version of freetype - it requires no modification to the matplotlib source at all. This will probably not work on OS X, as OS X does not appear to have the pkg-config command that both Solaris and Linux have. (This is based on observations on sage.math, boxen.math, t2.math, bsd.math and my own Sun Blade 1000 running Solaris 10 03/05)



---

archive/issue_comments_102567.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:2 drkirkby]:\n\n> **I think if you manage to get matplotlib to indicate it has found freetype2, but is unable to determine the version, I think you will have solved it.** At the moment matplotlib seems to be using pkg-config on Solaris and Linux (but not OS X) to look up the version, and find the directories of the include and library files. \n> \n> Dave \n\n\nThe best solution looks to be to get pkg-config to work properly, which requires it knows where the Sage files are to be found. That is done by setting the variable PKG_CONFIG_PATH. \n\nDave",
    "created_at": "2010-06-10T23:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102567",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:5'></a>Replying to [comment:2 drkirkby]:

> **I think if you manage to get matplotlib to indicate it has found freetype2, but is unable to determine the version, I think you will have solved it.** At the moment matplotlib seems to be using pkg-config on Solaris and Linux (but not OS X) to look up the version, and find the directories of the include and library files. 
> 
> Dave 


The best solution looks to be to get pkg-config to work properly, which requires it knows where the Sage files are to be found. That is done by setting the variable PKG_CONFIG_PATH. 

Dave



---

archive/issue_comments_102568.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-06-11T06:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102568",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_102569.json:
```json
{
    "body": "<a id='comment:6'></a>I've uploaded a new spkg (same URL as in the description), and updated the patch attached to this ticket to reflect the total changes in this spkg.\n\nDepends on #9208 and #9210 (both applied to the sage-scripts repository!) to correctly identify freetype, even after moving the Sage directory.",
    "created_at": "2010-06-11T06:14:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102569",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:6'></a>I've uploaded a new spkg (same URL as in the description), and updated the patch attached to this ticket to reflect the total changes in this spkg.

Depends on #9208 and #9210 (both applied to the sage-scripts repository!) to correctly identify freetype, even after moving the Sage directory.



---

archive/issue_comments_102570.json:
```json
{
    "body": "<a id='comment:7'></a>This spkg probably also solves #5873.",
    "created_at": "2010-06-11T06:31:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102570",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>This spkg probably also solves #5873.



---

archive/issue_comments_102571.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,7 @@\n This spkg updates matplotlib to 0.99.3.  I've attached the patch as well (don't apply; it's just for reviewing purposes).\n \n-The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3.spkg\n+The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3-svn8415.spkg\n \n-Assignee: tbd\n \n Author: Jason Grout\n \n``````\n",
    "created_at": "2010-06-11T20:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102571",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,7 @@
 This spkg updates matplotlib to 0.99.3.  I've attached the patch as well (don't apply; it's just for reviewing purposes).
 
-The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3.spkg
+The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3-svn8415.spkg
 
-Assignee: tbd
 
 Author: Jason Grout
 
``````




---

archive/issue_comments_102572.json:
```json
{
    "body": "<a id='comment:8'></a>Yet another update, this time cleaning out a lot of the patches and replacing our kludges with matplotlib-supported setup config files.  I also put in the latest SVN, which has some fixes we've requested, and make the setup config files work.\n\nThe link in the description points to the new spkg: http://sage.math.washington.edu/home/jason/matplotlib-0.99.3-svn8415.spkg",
    "created_at": "2010-06-11T20:01:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102572",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:8'></a>Yet another update, this time cleaning out a lot of the patches and replacing our kludges with matplotlib-supported setup config files.  I also put in the latest SVN, which has some fixes we've requested, and make the setup config files work.

The link in the description points to the new spkg: http://sage.math.washington.edu/home/jason/matplotlib-0.99.3-svn8415.spkg



---

archive/issue_events_022660.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2010-06-11T20:01:39Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "milestone": "sage-4.4.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9202#event-22660"
}
```



---

archive/issue_comments_102573.json:
```json
{
    "body": "<a id='comment:10'></a>This version from svn is causing a problem on the following system, which we should report to the developers. \n\n* Sun Blade 1000\n* 2 x 900 MHz\n* 2 GB RAM\n* Solaris 10 03/05 \n \n```\n/usr/include/stdlib.h:144: error: declaration of C function 'void swab(const char*, char*, ssize_t)' conflicts with\n/usr/include/unistd.h:480: error: previous declaration 'void swab(const void*, void*, ssize_t)' here\nerror: command 'gcc' failed with exit status 1\nError building matplotlib package.\n```\n\nThe Solaris header files are a lot stricter about what they do/do not declare than most systems, depending on the mode of compilation. An inspection of stdlib.h shows the problem. \n\n```\nextern int putenv(char *);\nextern void setkey(const char *);\n#endif /* defined(__EXTENSIONS__) || !defined(_STRICT_STDC) ... */\n\n/*\n * swab() has historically been in <stdlib.h> as delivered from AT&T\n * and continues to be visible in the default compilation environment.\n * As of Issue 4 of the X/Open Portability Guides, swab() was declared\n * in <unistd.h>. As a result, with respect to X/Open namespace the\n * swab() declaration in this header is only visible for the XPG3\n * environment.\n */\n#if (defined(__EXTENSIONS__) || \\\n        (!defined(_STRICT_STDC__) && !defined(_POSIX_C_SOURCE))) && \\\n        (!defined(_XOPEN_SOURCE) || (defined(_XPG3) && !defined(_XPG4)))\n#ifndef _SSIZE_T\n#define _SSIZE_T\n#if defined(_LP64) || defined(_I32LPx)\ntypedef long    ssize_t;        /* size of something in bytes or -1 */\n#else\ntypedef int     ssize_t;        /* (historical version) */\n#endif\n#endif  /* !_SSIZE_T */\n\nextern void swab(const char *, char *, ssize_t);\n#endif /* defined(__EXTENSIONS__) || !defined(_STRICT_STDC) ... */\n```\n\nand in unistd.h\n\n```\n#if defined(_XPG4)\n/* __EXTENSIONS__ makes the SVID Third Edition prototype in stdlib.h visible */\nextern void swab(const void *_RESTRICT_KYWD, void *_RESTRICT_KYWD, ssize_t);\n#endif /* defined(_XPG4) */\n```\n\nAs such, I think your previous version, based on the stable release, rather than a SVN snapshot is preferable. \n\nI'm attaching the two relevant header files to this ticket.",
    "created_at": "2010-06-11T20:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102573",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:10'></a>This version from svn is causing a problem on the following system, which we should report to the developers. 

* Sun Blade 1000
* 2 x 900 MHz
* 2 GB RAM
* Solaris 10 03/05 
 
```
/usr/include/stdlib.h:144: error: declaration of C function 'void swab(const char*, char*, ssize_t)' conflicts with
/usr/include/unistd.h:480: error: previous declaration 'void swab(const void*, void*, ssize_t)' here
error: command 'gcc' failed with exit status 1
Error building matplotlib package.
```

The Solaris header files are a lot stricter about what they do/do not declare than most systems, depending on the mode of compilation. An inspection of stdlib.h shows the problem. 

```
extern int putenv(char *);
extern void setkey(const char *);
#endif /* defined(__EXTENSIONS__) || !defined(_STRICT_STDC) ... */

/*
 * swab() has historically been in <stdlib.h> as delivered from AT&T
 * and continues to be visible in the default compilation environment.
 * As of Issue 4 of the X/Open Portability Guides, swab() was declared
 * in <unistd.h>. As a result, with respect to X/Open namespace the
 * swab() declaration in this header is only visible for the XPG3
 * environment.
 */
#if (defined(__EXTENSIONS__) || \
        (!defined(_STRICT_STDC__) && !defined(_POSIX_C_SOURCE))) && \
        (!defined(_XOPEN_SOURCE) || (defined(_XPG3) && !defined(_XPG4)))
#ifndef _SSIZE_T
#define _SSIZE_T
#if defined(_LP64) || defined(_I32LPx)
typedef long    ssize_t;        /* size of something in bytes or -1 */
#else
typedef int     ssize_t;        /* (historical version) */
#endif
#endif  /* !_SSIZE_T */

extern void swab(const char *, char *, ssize_t);
#endif /* defined(__EXTENSIONS__) || !defined(_STRICT_STDC) ... */
```

and in unistd.h

```
#if defined(_XPG4)
/* __EXTENSIONS__ makes the SVID Third Edition prototype in stdlib.h visible */
extern void swab(const void *_RESTRICT_KYWD, void *_RESTRICT_KYWD, ssize_t);
#endif /* defined(_XPG4) */
```

As such, I think your previous version, based on the stable release, rather than a SVN snapshot is preferable. 

I'm attaching the two relevant header files to this ticket.



---

archive/issue_comments_102574.json:
```json
{
    "body": "Changing reviewer from \"\" to \"David Kirkby\"",
    "created_at": "2010-06-11T20:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102574",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing reviewer from "" to "David Kirkby"



---

archive/issue_comments_102575.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2010-06-11T20:42:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102575",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_102576.json:
```json
{
    "body": "/usr/include/unistd.h from Solaris 10 on SPARC (03/05 release)",
    "created_at": "2010-06-11T20:43:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102576",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

/usr/include/unistd.h from Solaris 10 on SPARC (03/05 release)



---

archive/issue_comments_102577.json:
```json
{
    "body": "Attachment [unistd.h](tarball://root/attachments/some-uuid/ticket9202/unistd.h) by drkirkby created at 2010-06-11 20:44:54\n\n/usr/include/stdlib.h from Solaris 10 on SPARC (03/05 release)",
    "created_at": "2010-06-11T20:44:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102577",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Attachment [unistd.h](tarball://root/attachments/some-uuid/ticket9202/unistd.h) by drkirkby created at 2010-06-11 20:44:54

/usr/include/stdlib.h from Solaris 10 on SPARC (03/05 release)



---

archive/issue_comments_102578.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Reported upstream. Little or no feedback.\"",
    "created_at": "2010-06-11T20:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102578",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing upstream from "N/A" to "Reported upstream. Little or no feedback."



---

archive/issue_comments_102579.json:
```json
{
    "body": "<a id='comment:11'></a>Attachment [stdlib.h](tarball://root/attachments/some-uuid/ticket9202/stdlib.h) by drkirkby created at 2010-06-11 20:56:00\n\nI've stuck a bug report, with a link to this on the matplotlib mailing list.",
    "created_at": "2010-06-11T20:56:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102579",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:11'></a>Attachment [stdlib.h](tarball://root/attachments/some-uuid/ticket9202/stdlib.h) by drkirkby created at 2010-06-11 20:56:00

I've stuck a bug report, with a link to this on the matplotlib mailing list.



---

archive/issue_comments_102580.json:
```json
{
    "body": "<a id='comment:12'></a>I'd be happy to give your previous package, matplotlib-0.99.3.spkg (md5 checksum 2c8660d9d40f6759ece89c074bc0a351) positive review\n\nDave",
    "created_at": "2010-06-11T21:31:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102580",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:12'></a>I'd be happy to give your previous package, matplotlib-0.99.3.spkg (md5 checksum 2c8660d9d40f6759ece89c074bc0a351) positive review

Dave



---

archive/issue_comments_102581.json:
```json
{
    "body": "<a id='comment:13'></a>Why don't you go ahead and do that, and I'll open up another ticket for the svn version.",
    "created_at": "2010-06-11T21:32:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102581",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:13'></a>Why don't you go ahead and do that, and I'll open up another ticket for the svn version.



---

archive/issue_comments_102582.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2010-06-11T21:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102582",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_102583.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n+This spkg updates matplotlib to 0.99.3.  I've attached the patch as well (don't apply; it's just for reviewing purposes).\n \n+The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3.spkg (md5 checksum 2c8660d9d40f6759ece89c074bc0a351)\n \n Author: Jason Grout\n \n``````\n",
    "created_at": "2010-06-11T21:37:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102583",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
+This spkg updates matplotlib to 0.99.3.  I've attached the patch as well (don't apply; it's just for reviewing purposes).
 
+The new spkg is at http://sage.math.washington.edu/home/jason/matplotlib-0.99.3.spkg (md5 checksum 2c8660d9d40f6759ece89c074bc0a351)
 
 Author: Jason Grout
 
``````




---

archive/issue_comments_102584.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-06-11T21:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102584",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_102585.json:
```json
{
    "body": "<a id='comment:15'></a>Done. This is fine.",
    "created_at": "2010-06-11T21:39:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102585",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:15'></a>Done. This is fine.



---

archive/issue_comments_102586.json:
```json
{
    "body": "Changing type from defect to enhancement.",
    "created_at": "2010-06-11T21:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102586",
    "user": "https://github.com/jasongrout"
}
```

Changing type from defect to enhancement.



---

archive/issue_comments_102587.json:
```json
{
    "body": "<a id='comment:16'></a>I've opened up #9221 for the SVN spkg.  Future updates for matplotlib should probably be based on the spkg up at #9221.",
    "created_at": "2010-06-11T21:40:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102587",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:16'></a>I've opened up #9221 for the SVN spkg.  Future updates for matplotlib should probably be based on the spkg up at #9221.



---

archive/issue_events_022661.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T15:44:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9202#event-22661"
}
```



---

archive/issue_comments_102588.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.5.alpha0\"",
    "created_at": "2010-06-25T15:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102588",
    "user": "https://github.com/rlmill"
}
```

Changing merged from "" to "sage-4.5.alpha0"



---

archive/issue_comments_102589.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-06-25T15:44:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102589",
    "user": "https://github.com/rlmill"
}
```

Resolution: fixed



---

archive/issue_comments_102590.json:
```json
{
    "body": "<a id='comment:18'></a>Replying to [comment:7 jason]:\n> This spkg probably also solves #5873.\n\nOr at least some of it?  The [ticket](https://github.com/matplotlib/matplotlib/issues/225) upstream for one piece of it is now at github, but did this fix the searching for matplotlib issue?  \n\nSorry for the necropost.",
    "created_at": "2011-08-19T16:44:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9202",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9202#issuecomment-102590",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>Replying to [comment:7 jason]:
> This spkg probably also solves #5873.

Or at least some of it?  The [ticket](https://github.com/matplotlib/matplotlib/issues/225) upstream for one piece of it is now at github, but did this fix the searching for matplotlib issue?  

Sorry for the necropost.
