# Issue 9065: Add support for facade parents

archive/issues_009065.json:
```json
{
    "body": "The goal of this tickets is to add support for facade parents; see:\n[This thread](http://groups.google.com/group/sage-devel/browse_thread/thread/a5ea008c24c17956/00ab8c6d2a16f57a)\n\nThe main issue currently is that facade parents (`Primes, NonNegativeIntegers, SymmetricFunctions,` ...) are not aware that they are, which breaks some of the generic `TestSuite` tests.\n\nThis involves:\n- Adding a new optional argument for `Parent.__init__`: `Parent.__init__(self, facade = [ZZ])`\n- Creating a category or abstract class for facade parents\n- Adding a method `P.is_parent_of(x)` in `Sets.ParentMethods` which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.\n- Fix `P._test_one(), P._test_zero(), P._test_an_element()` (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.\n- Updating a couple parents to use it\n\n**Assignee:** @nthiery\n\n**CC:**  sage-combinat\n\n**Keywords:** facade, parent, TestSuite\n\n**Author:** Nicolas M. Thi\u00e9ry\n\n**Reviewer:** Florent Hivert\n\n**Merged:** sage-4.7.1.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/9065\n\n",
    "closed_at": "2011-05-03T12:28:29Z",
    "created_at": "2010-05-27T13:02:37Z",
    "labels": [
        "component: categories",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "Add support for facade parents",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9065",
    "user": "https://trac.sagemath.org/admin/accounts/users/nborie"
}
```
The goal of this tickets is to add support for facade parents; see:
[This thread](http://groups.google.com/group/sage-devel/browse_thread/thread/a5ea008c24c17956/00ab8c6d2a16f57a)

The main issue currently is that facade parents (`Primes, NonNegativeIntegers, SymmetricFunctions,` ...) are not aware that they are, which breaks some of the generic `TestSuite` tests.

This involves:
- Adding a new optional argument for `Parent.__init__`: `Parent.__init__(self, facade = [ZZ])`
- Creating a category or abstract class for facade parents
- Adding a method `P.is_parent_of(x)` in `Sets.ParentMethods` which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.
- Fix `P._test_one(), P._test_zero(), P._test_an_element()` (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.
- Updating a couple parents to use it

**Assignee:** @nthiery

**CC:**  sage-combinat

**Keywords:** facade, parent, TestSuite

**Author:** Nicolas M. Thiéry

**Reviewer:** Florent Hivert

**Merged:** sage-4.7.1.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/9065





---

archive/issue_comments_076809.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,9 +4,8 @@\n The main issue currently is that facade parents (Primes, NonNegativeIntegers, SymmetricFunctions, ...) are not aware that they are, which breaks some of the generic TestSuite tests.\n \n This involves:\n+- Adding a new optional argument for Parent.__init__: `Parent.__init__(self, facade = [ZZ])`\n - Creating a category or abstract class for facade parents\n-  Such parents should declare a list of parents they are facade\n-  for.\n-- Adding a method P.check_element(x) (find a better name!) in Sets.ParentMethods which checks that the parent of x is P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.\n-- Fix P._test_one(), P._test_zero(), P._test_an_element() (and maybe others) to use P.check_element(x) instead of x in P.\n+- Adding a method P.is_parent_of(x) in Sets.ParentMethods which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.\n+- Fix P._test_one(), P._test_zero(), P._test_an_element() (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.\n \n``````\n",
    "created_at": "2010-05-31T10:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76809",
    "user": "https://github.com/nthiery"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,9 +4,8 @@
 The main issue currently is that facade parents (Primes, NonNegativeIntegers, SymmetricFunctions, ...) are not aware that they are, which breaks some of the generic TestSuite tests.
 
 This involves:
+- Adding a new optional argument for Parent.__init__: `Parent.__init__(self, facade = [ZZ])`
 - Creating a category or abstract class for facade parents
-  Such parents should declare a list of parents they are facade
-  for.
-- Adding a method P.check_element(x) (find a better name!) in Sets.ParentMethods which checks that the parent of x is P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.
-- Fix P._test_one(), P._test_zero(), P._test_an_element() (and maybe others) to use P.check_element(x) instead of x in P.
+- Adding a method P.is_parent_of(x) in Sets.ParentMethods which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.
+- Fix P._test_one(), P._test_zero(), P._test_an_element() (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.
 
``````




---

archive/issue_comments_076810.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,11 +1,11 @@\n The goal of this tickets is to add support for facade parents; see:\n-http://groups.google.com/group/sage-devel/browse_thread/thread/a5ea008c24c17956/00ab8c6d2a16f57a\n+[This thread](http://groups.google.com/group/sage-devel/browse_thread/thread/a5ea008c24c17956/00ab8c6d2a16f57a)\n \n-The main issue currently is that facade parents (Primes, NonNegativeIntegers, SymmetricFunctions, ...) are not aware that they are, which breaks some of the generic TestSuite tests.\n+The main issue currently is that facade parents (`Primes, NonNegativeIntegers, SymmetricFunctions,` ...) are not aware that they are, which breaks some of the generic `TestSuite` tests.\n \n This involves:\n-- Adding a new optional argument for Parent.__init__: `Parent.__init__(self, facade = [ZZ])`\n+- Adding a new optional argument for `Parent.__init__`: `Parent.__init__(self, facade = [ZZ])`\n - Creating a category or abstract class for facade parents\n-- Adding a method P.is_parent_of(x) in Sets.ParentMethods which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.\n-- Fix P._test_one(), P._test_zero(), P._test_an_element() (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.\n+- Adding a method `P.is_parent_of(x)` in `Sets.ParentMethods` which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.\n+- Fix `P._test_one(), P._test_zero(), P._test_an_element()` (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.\n \n``````\n",
    "created_at": "2010-06-02T17:39:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76810",
    "user": "https://github.com/hivert"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,11 +1,11 @@
 The goal of this tickets is to add support for facade parents; see:
-http://groups.google.com/group/sage-devel/browse_thread/thread/a5ea008c24c17956/00ab8c6d2a16f57a
+[This thread](http://groups.google.com/group/sage-devel/browse_thread/thread/a5ea008c24c17956/00ab8c6d2a16f57a)
 
-The main issue currently is that facade parents (Primes, NonNegativeIntegers, SymmetricFunctions, ...) are not aware that they are, which breaks some of the generic TestSuite tests.
+The main issue currently is that facade parents (`Primes, NonNegativeIntegers, SymmetricFunctions,` ...) are not aware that they are, which breaks some of the generic `TestSuite` tests.
 
 This involves:
-- Adding a new optional argument for Parent.__init__: `Parent.__init__(self, facade = [ZZ])`
+- Adding a new optional argument for `Parent.__init__`: `Parent.__init__(self, facade = [ZZ])`
 - Creating a category or abstract class for facade parents
-- Adding a method P.is_parent_of(x) in Sets.ParentMethods which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.
-- Fix P._test_one(), P._test_zero(), P._test_an_element() (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.
+- Adding a method `P.is_parent_of(x)` in `Sets.ParentMethods` which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.
+- Fix `P._test_one(), P._test_zero(), P._test_an_element()` (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.
 
``````




---

archive/issue_events_065754.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2011-03-28T14:49:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9065#event-65754"
}
```



---

archive/issue_comments_076811.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n - Creating a category or abstract class for facade parents\n - Adding a method `P.is_parent_of(x)` in `Sets.ParentMethods` which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.\n - Fix `P._test_one(), P._test_zero(), P._test_an_element()` (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.\n-\n+- Updating a couple parents to use it\n``````\n",
    "created_at": "2011-03-28T14:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76811",
    "user": "https://github.com/nthiery"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 - Creating a category or abstract class for facade parents
 - Adding a method `P.is_parent_of(x)` in `Sets.ParentMethods` which checks that the parent of x is (equal to) P. Override this method for facade parents to check that the parent of x is one of the declared parents of P.
 - Fix `P._test_one(), P._test_zero(), P._test_an_element()` (and maybe others) to use `P.is_parent_of(x)` instead of `x in P`.
-
+- Updating a couple parents to use it
``````




---

archive/issue_comments_076812.json:
```json
{
    "body": "**Author:** Nicolas M. Thi\u00e9ry",
    "created_at": "2011-03-28T14:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76812",
    "user": "https://github.com/nthiery"
}
```

**Author:** Nicolas M. Thiéry



---

archive/issue_comments_076813.json:
```json
{
    "body": "<a id='comment:5'></a>\nHi Nicolas, \n\nI started to review this. I currently have only the following interface\nremark: id there a reason why you need to pass a tuple for parameter\n`facade` whereas for `category` you can pass either a category or a\ntuple ? For example, why do you force the user to write \n\n```\nParent.__init__(self, facade = (IntegerRing(), ), category = Sets()) \n```\ninstead of\n\n```\nParent.__init__(self, facade = IntegerRing(), category = Sets()) \n```",
    "created_at": "2011-04-04T20:43:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76813",
    "user": "https://github.com/hivert"
}
```

<a id='comment:5'></a>
Hi Nicolas, 

I started to review this. I currently have only the following interface
remark: id there a reason why you need to pass a tuple for parameter
`facade` whereas for `category` you can pass either a category or a
tuple ? For example, why do you force the user to write 

```
Parent.__init__(self, facade = (IntegerRing(), ), category = Sets()) 
```
instead of

```
Parent.__init__(self, facade = IntegerRing(), category = Sets()) 
```



---

archive/issue_comments_076814.json:
```json
{
    "body": "<a id='comment:6'></a>\nSorry for replying to myself...\n\n> I started to review this. I currently have only the following interface\n> remark: id there a reason why you need to pass a tuple for parameter\n> `facade` whereas for `category` you can pass either a category or a\n> tuple ?\n\n\nActually, it seems that the code in `Parent` allows for it. So I guess\nthat the example where the one parameter tuple occur could be simplified. I'm\nwriting a review patch on the sage-combinat queue.",
    "created_at": "2011-04-04T20:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76814",
    "user": "https://github.com/hivert"
}
```

<a id='comment:6'></a>
Sorry for replying to myself...

> I started to review this. I currently have only the following interface
> remark: id there a reason why you need to pass a tuple for parameter
> `facade` whereas for `category` you can pass either a category or a
> tuple ?


Actually, it seems that the code in `Parent` allows for it. So I guess
that the example where the one parameter tuple occur could be simplified. I'm
writing a review patch on the sage-combinat queue.



---

archive/issue_comments_076815.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [hivert](#comment%3A6):\n> \n> Actually, it seems that the code in `Parent` allows for it. So I guess\n> that the example where the one parameter tuple occur could be simplified. I'm\n> writing a review patch on the sage-combinat queue.\n\n\nGood point :-) +1 on that change.",
    "created_at": "2011-04-05T11:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76815",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:7'></a>
Replying to [hivert](#comment%3A6):
> 
> Actually, it seems that the code in `Parent` allows for it. So I guess
> that the example where the one parameter tuple occur could be simplified. I'm
> writing a review patch on the sage-combinat queue.


Good point :-) +1 on that change.



---

archive/issue_comments_076816.json:
```json
{
    "body": "**Reviewer:** Florent Hivert",
    "created_at": "2011-04-05T11:38:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76816",
    "user": "https://github.com/nthiery"
}
```

**Reviewer:** Florent Hivert



---

archive/issue_comments_076817.json:
```json
{
    "body": "<a id='comment:8'></a>\nHi!\n\nI folded in Florent's reviewer patch for the above issue, added facade option in SearchForest, updated an example there as well as NN and Primes to be facades, and fixed some trivially failing tests reported by the patchbot. The patch should be good to go. Florent: can you confirm?",
    "created_at": "2011-04-21T10:51:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76817",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:8'></a>
Hi!

I folded in Florent's reviewer patch for the above issue, added facade option in SearchForest, updated an example there as well as NN and Primes to be facades, and fixed some trivially failing tests reported by the patchbot. The patch should be good to go. Florent: can you confirm?



---

archive/issue_comments_076818.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [nthiery](#comment%3A8):\n> I folded in Florent's reviewer patch for the above issue, added facade option in SearchForest, updated an example there as well as NN and Primes to be facades, and fixed some trivially failing tests reported by the patchbot. The patch should be good to go. Florent: can you confirm?\n\n\nUnfortunately not ! I spotted a few more wrong sphinx markup. Please have a look at my review patch on trac. Otherwise, it is ready to go.",
    "created_at": "2011-04-22T22:17:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76818",
    "user": "https://github.com/hivert"
}
```

<a id='comment:9'></a>
Replying to [nthiery](#comment%3A8):
> I folded in Florent's reviewer patch for the above issue, added facade option in SearchForest, updated an example there as well as NN and Primes to be facades, and fixed some trivially failing tests reported by the patchbot. The patch should be good to go. Florent: can you confirm?


Unfortunately not ! I spotted a few more wrong sphinx markup. Please have a look at my review patch on trac. Otherwise, it is ready to go.



---

archive/issue_comments_076819.json:
```json
{
    "body": "<a id='comment:10'></a>\nI checked your patch, folded it in, and reuploaded. Thanks!",
    "created_at": "2011-04-23T01:44:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76819",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:10'></a>
I checked your patch, folded it in, and reuploaded. Thanks!



---

archive/issue_events_065755.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2011-04-23T01:44:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9065#event-65755"
}
```



---

archive/issue_events_065756.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2011-04-23T01:44:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9065#event-65756"
}
```



---

archive/issue_events_065757.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-25T10:52:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "milestone": "sage-4.7",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9065#event-65757"
}
```



---

archive/issue_events_065758.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-04-25T10:52:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9065#event-65758"
}
```



---

archive/attachments_011409.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9065-facade_parents-nt.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9065/trac_9065-facade_parents-nt.patch",
    "created_at": "2011-04-26T04:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nthiery"
}
```



---

archive/issue_comments_076820.json:
```json
{
    "body": "<a id='comment:12'></a>\nFixed another trivial failing test in a separate file. Hopefuly the last one!\n\nFlorent just checked it, and is ok to leave the positive review.",
    "created_at": "2011-04-26T04:34:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76820",
    "user": "https://github.com/nthiery"
}
```

<a id='comment:12'></a>
Fixed another trivial failing test in a separate file. Hopefuly the last one!

Florent just checked it, and is ok to leave the positive review.



---

archive/issue_comments_076821.json:
```json
{
    "body": "**Merged:** sage-4.7.1.alpha0",
    "created_at": "2011-05-03T12:28:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9065#issuecomment-76821",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.7.1.alpha0



---

archive/issue_events_065759.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-03T12:28:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9065#event-65759"
}
```



---

archive/issue_events_065760.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-03T12:28:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9065",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9065#event-65760"
}
```
