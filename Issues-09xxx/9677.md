# Issue 9677: Sage Sets don't implement genuine comparison

archive/issues_009677.json:
```json
{
    "assignees": [],
    "body": "Right now there is either equals, or less than. If `a != b`, then we get `a < b` but not `b > a`:\n\n```\nsage: a = Set([1])\nsage: b = Set([])\nsage: a == b\nFalse\nsage: a < b\nTrue\nsage: b > a\nFalse\n```\n\nThis came up in\n\nhttp://groups.google.com/group/sage-devel/browse_thread/thread/1c058efd05d3b91f\n\nAssignee: **@aghitza**\n\nCC:  @kini\n\nStopgaps: **todo**\n\nReviewer: **Mike Hansen**\n\nAuthor: **Robert Miller**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9677_\n\n",
    "created_at": "2010-08-03T20:41:08Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20basic%20arithmetic",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/needs%20work"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Sage Sets don't implement genuine comparison",
    "type": "issue",
    "updated_at": "2022-12-29T01:28:25Z",
    "url": "https://github.com/sagemath/sage/issues/9677",
    "user": "https://github.com/rlmill"
}
```
Right now there is either equals, or less than. If `a != b`, then we get `a < b` but not `b > a`:

```
sage: a = Set([1])
sage: b = Set([])
sage: a == b
False
sage: a < b
True
sage: b > a
False
```

This came up in

http://groups.google.com/group/sage-devel/browse_thread/thread/1c058efd05d3b91f

Assignee: **@aghitza**

CC:  @kini

Stopgaps: **todo**

Reviewer: **Mike Hansen**

Author: **Robert Miller**

_Issue created by migration from https://trac.sagemath.org/ticket/9677_





---

archive/issue_events_113971.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-08-03T20:41:08Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113971"
}
```



---

archive/issue_events_113972.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-08-03T20:41:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "component: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113972"
}
```



---

archive/issue_events_113973.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-08-03T20:41:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113973"
}
```



---

archive/issue_events_113974.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-08-03T20:41:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113974"
}
```



---

archive/issue_comments_086824.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nThe noted behaviour is definitely a bug. However, the attached patch solves this by introducing an attempt at inducing a total ordering on Sets by sorting them first by cardinality and then by lexicographic ordering on the sorted list of set elements. This only works if the elements of the set have a total ordering implemented.\n\nWhile python used to try to have a total ordering on all objects, this has been abandoned (e.g. python complex numbers and python sets)\n\nShouldn't the sage design follow python in this respect? See also\n\nhttp://groups.google.ca/group/sage-devel/msg/eab3aafb319a2769",
    "created_at": "2010-08-04T02:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86824",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:1" align="right">Comment 1</div>

The noted behaviour is definitely a bug. However, the attached patch solves this by introducing an attempt at inducing a total ordering on Sets by sorting them first by cardinality and then by lexicographic ordering on the sorted list of set elements. This only works if the elements of the set have a total ordering implemented.

While python used to try to have a total ordering on all objects, this has been abandoned (e.g. python complex numbers and python sets)

Shouldn't the sage design follow python in this respect? See also

http://groups.google.ca/group/sage-devel/msg/eab3aafb319a2769



---

archive/issue_comments_086825.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI completely, emphatically disagree. I think that total orderings are very important to try to preserve wherever possible, especially in this case.",
    "created_at": "2010-08-04T11:01:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86825",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:2" align="right">Comment 2</div>

I completely, emphatically disagree. I think that total orderings are very important to try to preserve wherever possible, especially in this case.



---

archive/issue_comments_086826.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nReplying to [@rlmill](#comment%3A2):\n> I completely, emphatically disagree. I think that total orderings are very important to try to preserve wherever possible, especially in this case.\n\nSee also my comments on the thread referenced above.",
    "created_at": "2010-08-04T11:24:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86826",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:3" align="right">Comment 3</div>

Replying to [@rlmill](#comment%3A2):
> I completely, emphatically disagree. I think that total orderings are very important to try to preserve wherever possible, especially in this case.

See also my comments on the thread referenced above.



---

archive/issue_events_113975.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-08-04T12:57:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113975"
}
```



---

archive/issue_comments_086827.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI don't understand why you have these lines:\n\n```\n            if len_self != len_other: \n\t                return cmp(len_self, len_other) \n```\nthat just makes it so that the comparison is incompatible with what it is for lists.  Why not just make it the same?",
    "created_at": "2010-08-04T17:02:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86827",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:5" align="right">Comment 5</div>

I don't understand why you have these lines:

```
            if len_self != len_other: 
	                return cmp(len_self, len_other) 
```
that just makes it so that the comparison is incompatible with what it is for lists.  Why not just make it the same?



---

archive/issue_comments_086828.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nYou mean just remove those lines? That's fine with me. This was just meant to be an optimization.",
    "created_at": "2010-08-04T18:00:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86828",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:6" align="right">Comment 6</div>

You mean just remove those lines? That's fine with me. This was just meant to be an optimization.



---

archive/issue_comments_086829.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nPatch is updated.",
    "created_at": "2010-08-04T18:02:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86829",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:7" align="right">Comment 7</div>

Patch is updated.



---

archive/issue_comments_086830.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI guess you didn't test your patch?\nI just applied it and ran tests on sage.math, and got:\n\n```\n----------------------------------------------------------------------\nThe following tests failed:\n\n        sage -t  devel/sage/sage/graphs/graph_generators.py # 2 doctests failed\n        sage -t  devel/sage/sage/graphs/digraph.py # 2 doctests failed\n        sage -t  devel/sage/sage/combinat/sf/powersum.py # 0 doctests failed\n        sage -t  devel/sage/sage/graphs/graph.py # Time out\n----------------------------------------------------------------------\nTimings have been updated.\nTotal time for all tests: 488.9 seconds\n```",
    "created_at": "2010-08-05T03:05:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86830",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:8" align="right">Comment 8</div>

I guess you didn't test your patch?
I just applied it and ran tests on sage.math, and got:

```
----------------------------------------------------------------------
The following tests failed:

        sage -t  devel/sage/sage/graphs/graph_generators.py # 2 doctests failed
        sage -t  devel/sage/sage/graphs/digraph.py # 2 doctests failed
        sage -t  devel/sage/sage/combinat/sf/powersum.py # 0 doctests failed
        sage -t  devel/sage/sage/graphs/graph.py # Time out
----------------------------------------------------------------------
Timings have been updated.
Total time for all tests: 488.9 seconds
```



---

archive/issue_events_113976.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-08-05T03:05:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113976"
}
```



---

archive/issue_events_113977.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-08-05T03:05:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113977"
}
```



---

archive/issue_comments_086831.json:
```json
{
    "body": "Attachment: **[trac_9677.patch.gz](https://github.com/sagemath/sage/files/ticket9677/trac_9677.patch.gz)**",
    "created_at": "2011-12-18T16:09:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86831",
    "user": "https://github.com/mwhansen"
}
```

Attachment: **[trac_9677.patch.gz](https://github.com/sagemath/sage/files/ticket9677/trac_9677.patch.gz)**



---

archive/issue_events_113978.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2011-12-18T16:09:49Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113978"
}
```



---

archive/issue_events_113979.json:
```json
{
    "actor": "https://github.com/mwhansen",
    "created_at": "2011-12-18T16:09:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113979"
}
```



---

archive/issue_comments_086832.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nI rebased the patch and ran the tests which do pass.  I think we can give this positive review.",
    "created_at": "2011-12-18T16:09:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86832",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:10" align="right">Comment 10</div>

I rebased the patch and ran the tests which do pass.  I think we can give this positive review.



---

archive/issue_comments_086833.json:
```json
{
    "body": "Reviewer: **Mike Hansen**",
    "created_at": "2011-12-18T16:09:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86833",
    "user": "https://github.com/mwhansen"
}
```

Reviewer: **Mike Hansen**



---

archive/issue_events_113980.json:
```json
{
    "actor": "https://github.com/sagetrac-dsm",
    "created_at": "2011-12-18T20:36:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113980"
}
```



---

archive/issue_events_113981.json:
```json
{
    "actor": "https://github.com/sagetrac-dsm",
    "created_at": "2011-12-18T20:36:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113981"
}
```



---

archive/issue_comments_086834.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nI think the patch behaviour of\n\n```\n\nsage: a = [2,3]\nsage: b = [2,3,4j]\nsage: set(a) < set(b)\nTrue\nsage: Set(a) < Set(b)\nFalse\n\n```\n\nis too dangerous to let pass unremarked.",
    "created_at": "2011-12-18T20:36:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86834",
    "user": "https://github.com/sagetrac-dsm"
}
```

<div id="comment:11" align="right">Comment 11</div>

I think the patch behaviour of

```

sage: a = [2,3]
sage: b = [2,3,4j]
sage: set(a) < set(b)
True
sage: Set(a) < Set(b)
False

```

is too dangerous to let pass unremarked.



---

archive/issue_comments_086835.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@sagetrac-dsm](#comment%3A11):\n> I think the patch behaviour of\n> \n> ```\n> \n> sage: a = [2,3]\n> sage: b = [2,3,4j]\n> sage: set(a) < set(b)\n> True\n> sage: Set(a) < Set(b)\n> False\n> \n> ```\n> \n> is too dangerous to let pass unremarked.\n\nIn Python (according to http://docs.python.org/library/sets.html) for the set type we have: \"The subset and equality comparisons do not generalize to a complete ordering function. For example, any two disjoint sets are not equal and are not subsets of each other, so all of the following return False: a<b, a==b, or a>b. Accordingly, sets do not implement the __cmp__() method.\"\n\nThe Python convention does make sense and is what most people would expect... and is the direction Sage should move in.\n\nRLM who wrote \"I completely, emphatically disagree.\" has got sucked up into an industry job, so isn't involved in Sage development right now, so I don't think he'll care much what happens with this ticket. \n\nThat said, having a total ordering -- which is different and inconsistent with set's order -- is useful (!).  However, it can be done as a separate explicit function or method, which can get passed to the sort method explicitly.",
    "created_at": "2012-02-26T17:05:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86835",
    "user": "https://github.com/williamstein"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@sagetrac-dsm](#comment%3A11):
> I think the patch behaviour of
> 
> ```
> 
> sage: a = [2,3]
> sage: b = [2,3,4j]
> sage: set(a) < set(b)
> True
> sage: Set(a) < Set(b)
> False
> 
> ```
> 
> is too dangerous to let pass unremarked.

In Python (according to http://docs.python.org/library/sets.html) for the set type we have: "The subset and equality comparisons do not generalize to a complete ordering function. For example, any two disjoint sets are not equal and are not subsets of each other, so all of the following return False: a<b, a==b, or a>b. Accordingly, sets do not implement the __cmp__() method."

The Python convention does make sense and is what most people would expect... and is the direction Sage should move in.

RLM who wrote "I completely, emphatically disagree." has got sucked up into an industry job, so isn't involved in Sage development right now, so I don't think he'll care much what happens with this ticket. 

That said, having a total ordering -- which is different and inconsistent with set's order -- is useful (!).  However, it can be done as a separate explicit function or method, which can get passed to the sort method explicitly.



---

archive/issue_events_113982.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113982"
}
```



---

archive/issue_events_113983.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113983"
}
```



---

archive/issue_events_113984.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113984"
}
```



---

archive/issue_events_113985.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113985"
}
```



---

archive/issue_events_113986.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113986"
}
```



---

archive/issue_events_113987.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113987"
}
```



---

archive/issue_events_113988.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113988"
}
```



---

archive/issue_events_113989.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113989"
}
```



---

archive/issue_comments_086836.json:
```json
{
    "body": "Stopgaps: **todo**",
    "created_at": "2015-08-25T14:01:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9677#issuecomment-86836",
    "user": "https://github.com/sagetrac-jakobkroeker"
}
```

Stopgaps: **todo**



---

archive/issue_events_113990.json:
```json
{
    "actor": "https://github.com/mkoeppe",
    "created_at": "2022-12-29T01:28:25Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9677",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9677#event-113990"
}
```
