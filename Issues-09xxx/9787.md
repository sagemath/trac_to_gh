# Issue 9787: lagrange_polynomial(algorithm='divided_difference') fails over finite fields

archive/issues_009786.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: R.<x>=GF(101)[]\nsage: R.lagrange_polynomial([[1,0],[2,0]])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/data/sage-4.5.1/<ipython console> in <module>()\n\n/data/sage-4.5.1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_ring.pyc in lagrange_polynomial(self, points, algorithm, previous_row)\n   1481             P = F[n-1]\n   1482             for i in xrange(n-2, -1, -1):\n-> 1483                 P *= (var - points[i][0])\n   1484                 P += F[i]\n   1485             return P\n\n/data/sage-4.5.1/local/lib/python2.6/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__imul__ (sage/structure/element.c:11631)()\n\n/data/sage-4.5.1/local/lib/python2.6/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6966)()\n\nTypeError: unsupported operand parent(s) for '*': 'Rational Field' and 'Univariate Polynomial Ring in x over Finite Field of size 101'\nsage: R.lagrange_polynomial([[1,0],[2,0]],'neville')\n[0, 0]\n```\n\nAssignee: **@aghitza**\n\nCC:  @miguelmarco\n\nBranch/Commit: **[b73cd8b](https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de)**\n\nReviewer: **Miguel Marco, Vincent Delecroix**\n\nAuthor: **Peter Bruin**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9787_\n\n",
    "closed_at": "2015-04-21T00:10:51Z",
    "created_at": "2010-08-23T13:09:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20algebra",
        "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.4",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "lagrange_polynomial(algorithm='divided_difference') fails over finite fields",
    "type": "issue",
    "updated_at": "2015-04-21T00:10:51Z",
    "url": "https://github.com/sagemath/sage/issues/9787",
    "user": "https://github.com/mezzarobba"
}
```

```
sage: R.<x>=GF(101)[]
sage: R.lagrange_polynomial([[1,0],[2,0]])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/data/sage-4.5.1/<ipython console> in <module>()

/data/sage-4.5.1/local/lib/python2.6/site-packages/sage/rings/polynomial/polynomial_ring.pyc in lagrange_polynomial(self, points, algorithm, previous_row)
   1481             P = F[n-1]
   1482             for i in xrange(n-2, -1, -1):
-> 1483                 P *= (var - points[i][0])
   1484                 P += F[i]
   1485             return P

/data/sage-4.5.1/local/lib/python2.6/site-packages/sage/structure/element.so in sage.structure.element.RingElement.__imul__ (sage/structure/element.c:11631)()

/data/sage-4.5.1/local/lib/python2.6/site-packages/sage/structure/coerce.so in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6966)()

TypeError: unsupported operand parent(s) for '*': 'Rational Field' and 'Univariate Polynomial Ring in x over Finite Field of size 101'
sage: R.lagrange_polynomial([[1,0],[2,0]],'neville')
[0, 0]
```

Assignee: **@aghitza**

CC:  @miguelmarco

Branch/Commit: **[b73cd8b](https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de)**

Reviewer: **Miguel Marco, Vincent Delecroix**

Author: **Peter Bruin**

_Issue created by migration from https://trac.sagemath.org/ticket/9787_





---

archive/issue_events_115650.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2010-08-23T13:09:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115650"
}
```



---

archive/issue_events_115651.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2010-08-23T13:09:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115651"
}
```



---

archive/issue_events_115652.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2010-08-23T13:09:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115652"
}
```



---

archive/issue_events_115653.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2010-08-23T13:09:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115653"
}
```



---

archive/issue_events_115654.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115654"
}
```



---

archive/issue_events_115655.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115655"
}
```



---

archive/issue_events_115656.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-08-30T15:34:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115656"
}
```



---

archive/issue_events_115657.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-08-30T15:34:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115657"
}
```



---

archive/issue_events_115658.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-08-30T15:34:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/invalid",
    "label_color": "a6a6a6",
    "label_name": "invalid",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115658"
}
```



---

archive/issue_events_115659.json:
```json
{
    "actor": "https://github.com/mezzarobba",
    "created_at": "2013-08-30T15:34:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115659"
}
```



---

archive/issue_comments_088737.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nThe issue does not exist anymore with sage-5.12\u03b23.",
    "created_at": "2013-08-30T15:34:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88737",
    "user": "https://github.com/mezzarobba"
}
```

<div id="comment:2" align="right">Comment 2</div>

The issue does not exist anymore with sage-5.12Î²3.



---

archive/issue_comments_088738.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nIn 5.12.beta5, the following still fails:\n\n```\nsage: R.<x>=GF(101)[]\nsage: sage: R.lagrange_polynomial([[1,0],[2,0],[3,0]])\n```",
    "created_at": "2013-09-22T18:34:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88738",
    "user": "https://github.com/fchapoton"
}
```

<div id="comment:3" align="right">Comment 3</div>

In 5.12.beta5, the following still fails:

```
sage: R.<x>=GF(101)[]
sage: sage: R.lagrange_polynomial([[1,0],[2,0],[3,0]])
```



---

archive/issue_events_115660.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-09-22T18:34:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115660"
}
```



---

archive/issue_events_115661.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-09-22T18:34:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115661"
}
```



---

archive/issue_events_115662.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-09-22T18:34:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-5.13",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115662"
}
```



---

archive/issue_events_115663.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115663"
}
```



---

archive/issue_events_115664.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115664"
}
```



---

archive/issue_events_115665.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115665"
}
```



---

archive/issue_events_115666.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115666"
}
```



---

archive/issue_events_115667.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115667"
}
```



---

archive/issue_events_115668.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115668"
}
```



---

archive/issue_comments_088739.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nHere is a branch that should fix the bug.  The only changes to the code are a few extra coercions (and one conversion, for reasons explained in a comment) to make sure everything lives in the right parent.  A few doctests had to be fixed because they started with the wrong base ring (`QQ` vs. `RR`) for the given input and output.  The other changes are documentation improvements.",
    "created_at": "2014-08-18T13:42:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88739",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:8" align="right">Comment 8</div>

Here is a branch that should fix the bug.  The only changes to the code are a few extra coercions (and one conversion, for reasons explained in a comment) to make sure everything lives in the right parent.  A few doctests had to be fixed because they started with the wrong base ring (`QQ` vs. `RR`) for the given input and output.  The other changes are documentation improvements.



---

archive/issue_events_115669.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-08-18T13:42:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115669"
}
```



---

archive/issue_events_115670.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2014-08-18T13:42:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115670"
}
```



---

archive/issue_comments_088740.json:
```json
{
    "body": "Branch: **[u/pbruin/9787-lagrange_polynomial](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/9787-lagrange_polynomial)**",
    "created_at": "2014-08-18T13:42:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88740",
    "user": "https://github.com/pjbruin"
}
```

Branch: **[u/pbruin/9787-lagrange_polynomial](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/9787-lagrange_polynomial)**



---

archive/issue_comments_088741.json:
```json
{
    "body": "Commit: **[57f432c](https://github.com/sagemath/sagetrac-mirror/commit/57f432cfe194c56c1b258a2d37046d67b15b82ab)**",
    "created_at": "2014-08-18T13:42:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88741",
    "user": "https://github.com/pjbruin"
}
```

Commit: **[57f432c](https://github.com/sagemath/sagetrac-mirror/commit/57f432cfe194c56c1b258a2d37046d67b15b82ab)**



---

archive/issue_comments_088742.json:
```json
{
    "body": "Author: **Peter Bruin**",
    "created_at": "2014-08-18T13:42:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88742",
    "user": "https://github.com/pjbruin"
}
```

Author: **Peter Bruin**



---

archive/issue_comments_088743.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nI would propose something like:\n\n```\nseqpoints = Sequence([self.base().an_element()]+list(points))\npoints = [seqpoints.universe()(p) for p in points]\n```\n\nThat way we make sure that all the operations happen in the right parent (be it the base ring of the parent, or some other parent where both the input and the parent fit)",
    "created_at": "2014-08-22T13:50:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88743",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:9" align="right">Comment 9</div>

I would propose something like:

```
seqpoints = Sequence([self.base().an_element()]+list(points))
points = [seqpoints.universe()(p) for p in points]
```

That way we make sure that all the operations happen in the right parent (be it the base ring of the parent, or some other parent where both the input and the parent fit)



---

archive/issue_comments_088744.json:
```json
{
    "body": "Reviewer: **Miguel Marco**",
    "created_at": "2014-08-22T13:50:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88744",
    "user": "https://github.com/miguelmarco"
}
```

Reviewer: **Miguel Marco**



---

archive/issue_comments_088745.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nReplying to [@miguelmarco](#comment%3A9):\n> I would propose something like:\n> \n> ```\n> seqpoints = Sequence([self.base().an_element()]+list(points))\n> points = [seqpoints.universe()(p) for p in points]\n> ```\n> \n> That way we make sure that all the operations happen in the right parent (be it the base ring of the parent, or some other parent where both the input and the parent fit)\n\nDo you mean that `R.lagrange_polynomial()` should potentially return an element of a different ring than `R`?  That would be unnecessarily confusing in my opinion.",
    "created_at": "2014-08-22T14:08:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88745",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:10" align="right">Comment 10</div>

Replying to [@miguelmarco](#comment%3A9):
> I would propose something like:
> 
> ```
> seqpoints = Sequence([self.base().an_element()]+list(points))
> points = [seqpoints.universe()(p) for p in points]
> ```
> 
> That way we make sure that all the operations happen in the right parent (be it the base ring of the parent, or some other parent where both the input and the parent fit)

Do you mean that `R.lagrange_polynomial()` should potentially return an element of a different ring than `R`?  That would be unnecessarily confusing in my opinion.



---

archive/issue_comments_088746.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nWell, you could have that even now:\n\n```\nsage: R.<x>=QQ[]\nsage: R.lagrange_polynomial(((1,1.75),(2,0.2),(3,1.5)))\n1.42500000000000*x^2 - 5.82500000000000*x + 6.15000000000000\n```\n\nYou can either catch that and raise an exception (which is probably the mathematically strictly correct), or be more flexible and allow situations like the previous (which, i think, can be useful in several cases).\n\nIn this case, i would vote for the second option, but i understand it is a matter of opinion.",
    "created_at": "2014-08-22T14:21:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88746",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:11" align="right">Comment 11</div>

Well, you could have that even now:

```
sage: R.<x>=QQ[]
sage: R.lagrange_polynomial(((1,1.75),(2,0.2),(3,1.5)))
1.42500000000000*x^2 - 5.82500000000000*x + 6.15000000000000
```

You can either catch that and raise an exception (which is probably the mathematically strictly correct), or be more flexible and allow situations like the previous (which, i think, can be useful in several cases).

In this case, i would vote for the second option, but i understand it is a matter of opinion.



---

archive/issue_comments_088747.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">Comment 12</div>\n\nReplying to [@miguelmarco](#comment%3A11):\n> Well, you could have that even now:\n> \n> ```\n> sage: R.<x>=QQ[]\n> sage: R.lagrange_polynomial(((1,1.75),(2,0.2),(3,1.5)))\n> 1.42500000000000*x^2 - 5.82500000000000*x + 6.15000000000000\n> ```\n\nActually, with this branch, you get\n\n```\nsage: R.<x>=QQ[]\nsage: R.lagrange_polynomial(((1,1.75),(2,0.2),(3,1.5)))\n57/40*x^2 - 233/40*x + 123/20\n```\nThis is not ideal from my point of view (I would prefer to use `coerce` to put the coefficients into the base field of `R`, so this example would raise an error), but a doctest in a published book unfortunately depends on it.\n> You can either catch that and raise an exception (which is probably the mathematically strictly correct), or be more flexible and allow situations like the previous (which, i think, can be useful in several cases).\n\nI see that this could be the expected behaviour given the general permissiveness in Sage with respect to extending parents, but I would still find it strange if `R.lagrange_polynomial()` did not return a value in `R` but in a different ring depending on the input.  It would mean that `lagrange_polynomial()` basically had no relation to `R`.  If there were a standalone function `lagrange_polynomial()`, then it would be logical if `lagrange_polynomial()` returned a polynomial in a parent depending on the input, but the explicit presence of `R` in the notation `R.lagrange_polynomial()` does suggest to me that it should always return a polynomial in `R`.",
    "created_at": "2014-08-22T15:56:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88747",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:12" align="right">Comment 12</div>

Replying to [@miguelmarco](#comment%3A11):
> Well, you could have that even now:
> 
> ```
> sage: R.<x>=QQ[]
> sage: R.lagrange_polynomial(((1,1.75),(2,0.2),(3,1.5)))
> 1.42500000000000*x^2 - 5.82500000000000*x + 6.15000000000000
> ```

Actually, with this branch, you get

```
sage: R.<x>=QQ[]
sage: R.lagrange_polynomial(((1,1.75),(2,0.2),(3,1.5)))
57/40*x^2 - 233/40*x + 123/20
```
This is not ideal from my point of view (I would prefer to use `coerce` to put the coefficients into the base field of `R`, so this example would raise an error), but a doctest in a published book unfortunately depends on it.
> You can either catch that and raise an exception (which is probably the mathematically strictly correct), or be more flexible and allow situations like the previous (which, i think, can be useful in several cases).

I see that this could be the expected behaviour given the general permissiveness in Sage with respect to extending parents, but I would still find it strange if `R.lagrange_polynomial()` did not return a value in `R` but in a different ring depending on the input.  It would mean that `lagrange_polynomial()` basically had no relation to `R`.  If there were a standalone function `lagrange_polynomial()`, then it would be logical if `lagrange_polynomial()` returned a polynomial in a parent depending on the input, but the explicit presence of `R` in the notation `R.lagrange_polynomial()` does suggest to me that it should always return a polynomial in `R`.



---

archive/issue_comments_088748.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nWell, if it is clearly stated that the result should be in R, conversion should also be allowed, from my point of view. I can see solid arguments for any of the possible choices: coerce to R.basis(), convert to R.basis(), or extend for the common universe of R.basis() and the input. My personal choice would be the last one, but as long as it is clearly documented, i could live with any.\n\nAnother option would be to include a keyword (like 'extend', for example) to control the behaviour in this aspect. That way you can have a default functionality, but also another option for the user to choose. Although, it seems a bit overkill for this.",
    "created_at": "2014-08-24T13:32:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88748",
    "user": "https://github.com/miguelmarco"
}
```

<div id="comment:13" align="right">Comment 13</div>

Well, if it is clearly stated that the result should be in R, conversion should also be allowed, from my point of view. I can see solid arguments for any of the possible choices: coerce to R.basis(), convert to R.basis(), or extend for the common universe of R.basis() and the input. My personal choice would be the last one, but as long as it is clearly documented, i could live with any.

Another option would be to include a keyword (like 'extend', for example) to control the behaviour in this aspect. That way you can have a default functionality, but also another option for the user to choose. Although, it seems a bit overkill for this.



---

archive/issue_comments_088749.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nReplying to [@miguelmarco](#comment%3A13):\n> Well, if it is clearly stated that the result should be in R, conversion should also be allowed, from my point of view.\n\nFair point, I'll change that and improve the documentation.\n> I can see solid arguments for any of the possible choices: coerce to R.basis(), convert to R.basis(), or extend for the common universe of R.basis() and the input. My personal choice would be the last one, but as long as it is clearly documented, i could live with any.\n\nI still think that `R.lagrange_polynomial(...)` should return something in `R`.  In practice it should be easy to convert the input into the base ring, unless the user made this ring too small for some reason.  In that case the user can easily enlarge the base ring.\n> Another option would be to include a keyword (like 'extend', for example) to control the behaviour in this aspect. That way you can have a default functionality, but also another option for the user to choose. Although, it seems a bit overkill for this.\n\nThis sounds like a reasonable option, but I do think it is a bit overkill, so someone who really wants it can implement it.",
    "created_at": "2014-08-25T11:32:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88749",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:14" align="right">Comment 14</div>

Replying to [@miguelmarco](#comment%3A13):
> Well, if it is clearly stated that the result should be in R, conversion should also be allowed, from my point of view.

Fair point, I'll change that and improve the documentation.
> I can see solid arguments for any of the possible choices: coerce to R.basis(), convert to R.basis(), or extend for the common universe of R.basis() and the input. My personal choice would be the last one, but as long as it is clearly documented, i could live with any.

I still think that `R.lagrange_polynomial(...)` should return something in `R`.  In practice it should be easy to convert the input into the base ring, unless the user made this ring too small for some reason.  In that case the user can easily enlarge the base ring.
> Another option would be to include a keyword (like 'extend', for example) to control the behaviour in this aspect. That way you can have a default functionality, but also another option for the user to choose. Although, it seems a bit overkill for this.

This sounds like a reasonable option, but I do think it is a bit overkill, so someone who really wants it can implement it.



---

archive/issue_comments_088750.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/68ce711a9ab7f5d0a972d8b6443e1fece4bc49e9\">68ce711</a></td><td><code>Trac 9787: use conversion into the base ring, clarify documentation</code></td></tr></table>\n",
    "created_at": "2014-08-25T11:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88750",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:15" align="right">Comment 15</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/68ce711a9ab7f5d0a972d8b6443e1fece4bc49e9">68ce711</a></td><td><code>Trac 9787: use conversion into the base ring, clarify documentation</code></td></tr></table>




---

archive/issue_comments_088751.json:
```json
{
    "body": "Changed commit from **[57f432c](https://github.com/sagemath/sagetrac-mirror/commit/57f432cfe194c56c1b258a2d37046d67b15b82ab)** to **[68ce711](https://github.com/sagemath/sagetrac-mirror/commit/68ce711a9ab7f5d0a972d8b6443e1fece4bc49e9)**",
    "created_at": "2014-08-25T11:39:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88751",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[57f432c](https://github.com/sagemath/sagetrac-mirror/commit/57f432cfe194c56c1b258a2d37046d67b15b82ab)** to **[68ce711](https://github.com/sagemath/sagetrac-mirror/commit/68ce711a9ab7f5d0a972d8b6443e1fece4bc49e9)**



---

archive/issue_comments_088752.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nHello,\n\nOn sage-6.5 at least, I got the right answer.\n\n```\nsage: R.<x>=GF(101)[]\nsage: R.lagrange_polynomial([[1,0],[2,0]])\n0\n```\nIt would be cool to add it to the documentation since it was the initial purpose of the ticket.\n\nVincent",
    "created_at": "2015-04-18T12:26:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88752",
    "user": "https://github.com/videlec"
}
```

<div id="comment:16" align="right">Comment 16</div>

Hello,

On sage-6.5 at least, I got the right answer.

```
sage: R.<x>=GF(101)[]
sage: R.lagrange_polynomial([[1,0],[2,0]])
0
```
It would be cool to add it to the documentation since it was the initial purpose of the ticket.

Vincent



---

archive/issue_comments_088753.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de\">b73cd8b</a></td><td><code>Trac 9787: add doctest</code></td></tr></table>\n",
    "created_at": "2015-04-20T08:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88753",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:17" align="right">Comment 17</div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de">b73cd8b</a></td><td><code>Trac 9787: add doctest</code></td></tr></table>




---

archive/issue_comments_088754.json:
```json
{
    "body": "Changed commit from **[68ce711](https://github.com/sagemath/sagetrac-mirror/commit/68ce711a9ab7f5d0a972d8b6443e1fece4bc49e9)** to **[b73cd8b](https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de)**",
    "created_at": "2015-04-20T08:24:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88754",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[68ce711](https://github.com/sagemath/sagetrac-mirror/commit/68ce711a9ab7f5d0a972d8b6443e1fece4bc49e9)** to **[b73cd8b](https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de)**



---

archive/issue_comments_088755.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nReplying to [@videlec](#comment%3A16):\n> On sage-6.5 at least, I got the right answer.\n> \n> ```\n> sage: R.<x>=GF(101)[]\n> sage: R.lagrange_polynomial([[1,0],[2,0]])\n> 0\n> ```\n\nThis one was fixed at some point (see [comment:2](#comment%3A2)), but I added a doctest anyway.",
    "created_at": "2015-04-20T08:25:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88755",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:18" align="right">Comment 18</div>

Replying to [@videlec](#comment%3A16):
> On sage-6.5 at least, I got the right answer.
> 
> ```
> sage: R.<x>=GF(101)[]
> sage: R.lagrange_polynomial([[1,0],[2,0]])
> 0
> ```

This one was fixed at some point (see [comment:2](#comment%3A2)), but I added a doctest anyway.



---

archive/issue_comments_088756.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nHello,\n\nLooks good! Concerning the [comment:12](#comment%3A12), where is this example in the sage book (I was not able to find it)? Should it be added to the documentation as an example with a warning?\n\nVincent\n\nPS: Note that using coerce is justified... but not from the viewpoint of performances\n\n```\nsage: R.<x> = ZZ[]\nsage: n = 2**123\nsage: timeit(\"a = R(n)\", number=300000)\n300000 loops, best of 3: 633 ns per loop\nsage: timeit(\"a = R.coerce(n)\", number=300000)\n300000 loops, best of 3: 936 ns per loop\n```",
    "created_at": "2015-04-20T09:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88756",
    "user": "https://github.com/videlec"
}
```

<div id="comment:19" align="right">Comment 19</div>

Hello,

Looks good! Concerning the [comment:12](#comment%3A12), where is this example in the sage book (I was not able to find it)? Should it be added to the documentation as an example with a warning?

Vincent

PS: Note that using coerce is justified... but not from the viewpoint of performances

```
sage: R.<x> = ZZ[]
sage: n = 2**123
sage: timeit("a = R(n)", number=300000)
300000 loops, best of 3: 633 ns per loop
sage: timeit("a = R.coerce(n)", number=300000)
300000 loops, best of 3: 936 ns per loop
```



---

archive/issue_comments_088757.json:
```json
{
    "body": "Changed reviewer from **Miguel Marco** to **Miguel Marco, Vincent Delecroix**",
    "created_at": "2015-04-20T09:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88757",
    "user": "https://github.com/videlec"
}
```

Changed reviewer from **Miguel Marco** to **Miguel Marco, Vincent Delecroix**



---

archive/issue_comments_088758.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nWhen making the change\n\n```diff\n--- a/src/sage/rings/polynomial/polynomial_ring.py\n+++ b/src/sage/rings/polynomial/polynomial_ring.py\n@@ -1698,7 +1698,7 @@ class PolynomialRing_field(PolynomialRing_integral_domain,\n            MATLAB*.  3rd edition, Prentice-Hall, 1999.\n \n         \"\"\"\n-        to_base_ring = self.base_ring()\n+        to_base_ring = self.base_ring().coerce\n         points = map(lambda x: map(to_base_ring, x), points)\n         n = len(points)\n         F = [[points[i][1]] for i in xrange(n)]\n@@ -1859,12 +1859,7 @@ class PolynomialRing_field(PolynomialRing_integral_domain,\n            8th edition, Thomson Brooks/Cole, 2005.\n \n         \"\"\"\n-        # Perhaps we should be slightly stricter on the input and use\n-        # self.base_ring().coerce here and in the divided_difference()\n-        # method above.  However, this breaks an example in\n-        # sage.tests.french_book.nonlinear_doctest where the base ring\n-        # is CC, but the function values lie in the symbolic ring.\n-        to_base_ring = self.base_ring()\n+        to_base_ring = self.base_ring().coerce\n         points = map(lambda x: map(to_base_ring, x), points)\n         var = self.gen()\n \n```\nI get\n\n```\nFile \"src/sage/tests/french_book/nonlinear_doctest.py\", line 426, in sage.tests.french_book.nonlinear_doctest\nFailed example:\n    iterate(generator, check=checkconv)\nException raised:\n    Traceback (most recent call last):\n    ...\n    TypeError: no canonical coercion from Symbolic Ring to Complex Field with 53 bits of precision\n```",
    "created_at": "2015-04-20T10:03:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88758",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:20" align="right">Comment 20</div>

When making the change

```diff
--- a/src/sage/rings/polynomial/polynomial_ring.py
+++ b/src/sage/rings/polynomial/polynomial_ring.py
@@ -1698,7 +1698,7 @@ class PolynomialRing_field(PolynomialRing_integral_domain,
            MATLAB*.  3rd edition, Prentice-Hall, 1999.
 
         """
-        to_base_ring = self.base_ring()
+        to_base_ring = self.base_ring().coerce
         points = map(lambda x: map(to_base_ring, x), points)
         n = len(points)
         F = [[points[i][1]] for i in xrange(n)]
@@ -1859,12 +1859,7 @@ class PolynomialRing_field(PolynomialRing_integral_domain,
            8th edition, Thomson Brooks/Cole, 2005.
 
         """
-        # Perhaps we should be slightly stricter on the input and use
-        # self.base_ring().coerce here and in the divided_difference()
-        # method above.  However, this breaks an example in
-        # sage.tests.french_book.nonlinear_doctest where the base ring
-        # is CC, but the function values lie in the symbolic ring.
-        to_base_ring = self.base_ring()
+        to_base_ring = self.base_ring().coerce
         points = map(lambda x: map(to_base_ring, x), points)
         var = self.gen()
 
```
I get

```
File "src/sage/tests/french_book/nonlinear_doctest.py", line 426, in sage.tests.french_book.nonlinear_doctest
Failed example:
    iterate(generator, check=checkconv)
Exception raised:
    Traceback (most recent call last):
    ...
    TypeError: no canonical coercion from Symbolic Ring to Complex Field with 53 bits of precision
```



---

archive/issue_comments_088759.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nThanks for pointing the example! Once again the symbolic ring is wrong\n\n```\nsage: f(x) = 4 * sin(x) - exp(x) / 2 + 1\nsage: f(1.2)\n3.06809788250063\nsage: parent(_)\nSymbolic Ring\n```\nParent should be `RR` as it is already the case for\n\n```\nsage: parent(exp(1.2))\nReal Field with 53 bits of precision\nsage: parent(sin(1.2))\nReal Field with 53 bits of precision\n```\nBut\n\n```\nsage: f(x) = x\nsage: parent(f(1.2))\n<type 'sage.symbolic.expression.Expression'>\n```",
    "created_at": "2015-04-20T10:10:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88759",
    "user": "https://github.com/videlec"
}
```

<div id="comment:21" align="right">Comment 21</div>

Thanks for pointing the example! Once again the symbolic ring is wrong

```
sage: f(x) = 4 * sin(x) - exp(x) / 2 + 1
sage: f(1.2)
3.06809788250063
sage: parent(_)
Symbolic Ring
```
Parent should be `RR` as it is already the case for

```
sage: parent(exp(1.2))
Real Field with 53 bits of precision
sage: parent(sin(1.2))
Real Field with 53 bits of precision
```
But

```
sage: f(x) = x
sage: parent(f(1.2))
<type 'sage.symbolic.expression.Expression'>
```



---

archive/issue_comments_088760.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nReplying to [@videlec](#comment%3A21):\n> Once again the symbolic ring is wrong\n> \n> ```\n> sage: f(x) = 4 * sin(x) - exp(x) / 2 + 1\n> sage: f(1.2)\n> 3.06809788250063\n> sage: parent(_)\n> Symbolic Ring\n> ```\n> Parent should be `RR`\n\nIndeed; compare\n\n```\nsage: f(x) = exp(x)\nsage: parent(f(1.2))\nSymbolic Ring\nsage: parent(exp(1.2))\nReal Field with 53 bits of precision\n```\nRelated ticket: #18092",
    "created_at": "2015-04-20T10:51:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88760",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:22" align="right">Comment 22</div>

Replying to [@videlec](#comment%3A21):
> Once again the symbolic ring is wrong
> 
> ```
> sage: f(x) = 4 * sin(x) - exp(x) / 2 + 1
> sage: f(1.2)
> 3.06809788250063
> sage: parent(_)
> Symbolic Ring
> ```
> Parent should be `RR`

Indeed; compare

```
sage: f(x) = exp(x)
sage: parent(f(1.2))
Symbolic Ring
sage: parent(exp(1.2))
Real Field with 53 bits of precision
```
Related ticket: #18092



---

archive/issue_comments_088761.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nReplying to [@pjbruin](#comment%3A22):\n> Replying to [@videlec](#comment%3A21):\n\nShould we set a dependency and use `.coerce`? If you feel that it is too much, this ticket is good to go as it is.",
    "created_at": "2015-04-20T11:08:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88761",
    "user": "https://github.com/videlec"
}
```

<div id="comment:23" align="right">Comment 23</div>

Replying to [@pjbruin](#comment%3A22):
> Replying to [@videlec](#comment%3A21):

Should we set a dependency and use `.coerce`? If you feel that it is too much, this ticket is good to go as it is.



---

archive/issue_comments_088762.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nReplying to [@videlec](#comment%3A23):\n> Should we set a dependency and use `.coerce`?\n\nIf I understand #18092 correctly, it will only make `f.evaluate(x=1.2)` return an element of `RR`, while `f(1.2)` will remain a symbolic expression.  Hence I think #18092 would not automatically (transparently) solve this issue.\n\n> If you feel that it is too much, this ticket is good to go as it is.\n\nI interpret this as a positive review, correct me if I'm wrong.",
    "created_at": "2015-04-20T11:14:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88762",
    "user": "https://github.com/pjbruin"
}
```

<div id="comment:24" align="right">Comment 24</div>

Replying to [@videlec](#comment%3A23):
> Should we set a dependency and use `.coerce`?

If I understand #18092 correctly, it will only make `f.evaluate(x=1.2)` return an element of `RR`, while `f(1.2)` will remain a symbolic expression.  Hence I think #18092 would not automatically (transparently) solve this issue.

> If you feel that it is too much, this ticket is good to go as it is.

I interpret this as a positive review, correct me if I'm wrong.



---

archive/issue_events_115671.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-04-20T11:14:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115671"
}
```



---

archive/issue_events_115672.json:
```json
{
    "actor": "https://github.com/pjbruin",
    "created_at": "2015-04-20T11:14:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115672"
}
```



---

archive/issue_comments_088763.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nReplying to [@pjbruin](#comment%3A24):\n> If I understand #18092 correctly, it will only make `f.evaluate(x=1.2)` return an element of `RR`, while `f(1.2)` will remain a symbolic expression.  Hence I think #18092 would not automatically (transparently) solve this issue.\n\nCorrect.",
    "created_at": "2015-04-20T11:18:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88763",
    "user": "https://github.com/dkrenn"
}
```

<div id="comment:25" align="right">Comment 25</div>

Replying to [@pjbruin](#comment%3A24):
> If I understand #18092 correctly, it will only make `f.evaluate(x=1.2)` return an element of `RR`, while `f(1.2)` will remain a symbolic expression.  Hence I think #18092 would not automatically (transparently) solve this issue.

Correct.



---

archive/issue_comments_088764.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">Comment 26</div>\n\nReplying to [@pjbruin](#comment%3A24):\n> Replying to [@videlec](#comment%3A23):\n> > Should we set a dependency and use `.coerce`?\n\n> If I understand #18092 correctly, it will only make `f.evaluate(x=1.2)` return an element of `RR`, while `f(1.2)` will remain a symbolic expression.  Hence I think #18092 would not automatically (transparently) solve this issue.\n\nI thought that `.evaluate` would be a modification of `.subs`!! With functions, this behavior would be **wrong**. It should be what it has to be\n\n```\nsage: f(x) = 2*x\nsage: f.subs(x=3)\nx |--> 6\n```\nIn other words `f.evaluate(x=3)` should be a constant function!\n\n> > If you feel that it is too much, this ticket is good to go as it is.\n\n> I interpret this as a positive review, correct me if I'm wrong.\n\nPerfect!\n\nVincent",
    "created_at": "2015-04-20T11:41:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88764",
    "user": "https://github.com/videlec"
}
```

<div id="comment:26" align="right">Comment 26</div>

Replying to [@pjbruin](#comment%3A24):
> Replying to [@videlec](#comment%3A23):
> > Should we set a dependency and use `.coerce`?

> If I understand #18092 correctly, it will only make `f.evaluate(x=1.2)` return an element of `RR`, while `f(1.2)` will remain a symbolic expression.  Hence I think #18092 would not automatically (transparently) solve this issue.

I thought that `.evaluate` would be a modification of `.subs`!! With functions, this behavior would be **wrong**. It should be what it has to be

```
sage: f(x) = 2*x
sage: f.subs(x=3)
x |--> 6
```
In other words `f.evaluate(x=3)` should be a constant function!

> > If you feel that it is too much, this ticket is good to go as it is.

> I interpret this as a positive review, correct me if I'm wrong.

Perfect!

Vincent



---

archive/issue_events_115673.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-21T00:10:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115673"
}
```



---

archive/issue_events_115674.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "a1617f999ce11a34dd727f939e0beeeb6f236947",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-04-21T00:10:51Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9787#event-115674"
}
```



---

archive/issue_comments_088765.json:
```json
{
    "body": "Changed branch from **[u/pbruin/9787-lagrange_polynomial](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/9787-lagrange_polynomial)** to **[b73cd8b](https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de)**",
    "created_at": "2015-04-21T00:10:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9787",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9787#issuecomment-88765",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/pbruin/9787-lagrange_polynomial](https://github.com/sagemath/sagetrac-mirror/tree/u/pbruin/9787-lagrange_polynomial)** to **[b73cd8b](https://github.com/sagemath/sagetrac-mirror/commit/b73cd8b97cc96c2c4373c91633aeed7ba7f8d9de)**
