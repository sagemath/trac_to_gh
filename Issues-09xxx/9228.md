# Issue 9228: Bring doctests for interfaces/mwrank.py up to 100% (from 20% (2 of 10)  )

archive/issues_009228.json:
```json
{
    "body": "\n```\ndevel/sage-main/sage/interfaces/mwrank.py\nERROR: Please add a `TestSuite(s).run()` doctest.\nSCORE devel/sage-main/sage/interfaces/mwrank.py: 20% (2 of 10)\n\nMissing documentation:\n* __getattr__(self, attrname):\n* __reduce__(self):\n* __call__(self, cmd):\n* console(self):\n* _reduce_load_mwrank():\n* mwrank_console():\n\n\nMissing doctests:\n* Mwrank(options=\"\", server=None, server_tmpdir=None):\n* __init__(self, options=\"\", server=None,server_tmpdir=None):\n```\n\n\nAssignee: @JohnCremona\n\nKeywords: mwrank\n\nResolution: fixed\n\nAuthor: John Cremona\n\nReviewer: Aly Deines, Jeroen Demeyer\n\nMerged: sage-4.6.2.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/9228\n\n",
    "closed_at": "2011-01-25T08:14:46Z",
    "created_at": "2010-06-12T13:42:01Z",
    "labels": [
        "component: doctest coverage",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.2",
    "title": "Bring doctests for interfaces/mwrank.py up to 100% (from 20% (2 of 10)  )",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9228",
    "user": "https://github.com/JohnCremona"
}
```

```
devel/sage-main/sage/interfaces/mwrank.py
ERROR: Please add a `TestSuite(s).run()` doctest.
SCORE devel/sage-main/sage/interfaces/mwrank.py: 20% (2 of 10)

Missing documentation:
* __getattr__(self, attrname):
* __reduce__(self):
* __call__(self, cmd):
* console(self):
* _reduce_load_mwrank():
* mwrank_console():


Missing doctests:
* Mwrank(options="", server=None, server_tmpdir=None):
* __init__(self, options="", server=None,server_tmpdir=None):
```


Assignee: @JohnCremona

Keywords: mwrank

Resolution: fixed

Author: John Cremona

Reviewer: Aly Deines, Jeroen Demeyer

Merged: sage-4.6.2.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/9228





---

archive/issue_comments_101362.json:
```json
{
    "body": "<a id='comment:1'></a>\nAfter the patch:\n\n```\n%sage -coverage sage/interfaces/mwrank.py \n----------------------------------------------------------------------\nsage/interfaces/mwrank.py\nSCORE sage/interfaces/mwrank.py: 100% (10 of 10)\n----------------------------------------------------------------------\n```\nand the reference manual markup has also been corrected.",
    "created_at": "2010-12-21T17:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101362",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:1'></a>
After the patch:

```
%sage -coverage sage/interfaces/mwrank.py 
----------------------------------------------------------------------
sage/interfaces/mwrank.py
SCORE sage/interfaces/mwrank.py: 100% (10 of 10)
----------------------------------------------------------------------
```
and the reference manual markup has also been corrected.



---

archive/issue_comments_101363.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-12-21T17:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101363",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_101364.json:
```json
{
    "body": "Changing author from \"\" to \"John Cremona\"",
    "created_at": "2010-12-21T17:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101364",
    "user": "https://github.com/JohnCremona"
}
```

Changing author from "" to "John Cremona"



---

archive/issue_comments_101365.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,5 @@\n \n ```\n-\n devel/sage-main/sage/interfaces/mwrank.py\n ERROR: Please add a `TestSuite(s).run()` doctest.\n SCORE devel/sage-main/sage/interfaces/mwrank.py: 20% (2 of 10)\n``````\n",
    "created_at": "2010-12-21T17:23:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101365",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,5 @@
 
 ```
-
 devel/sage-main/sage/interfaces/mwrank.py
 ERROR: Please add a `TestSuite(s).run()` doctest.
 SCORE devel/sage-main/sage/interfaces/mwrank.py: 20% (2 of 10)
``````




---

archive/issue_events_035384.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-12-21T17:23:49Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9228#event-35384"
}
```



---

archive/issue_comments_101366.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-01-09T23:48:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101366",
    "user": "https://github.com/adeines"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_101367.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Aly Deines\"",
    "created_at": "2011-01-11T17:08:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101367",
    "user": "https://github.com/adeines"
}
```

Changing reviewer from "" to "Aly Deines"



---

archive/issue_comments_101368.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-01-19T22:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101368",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_101369.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.6.2.alpha1\"",
    "created_at": "2011-01-19T22:20:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101369",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.6.2.alpha1"



---

archive/issue_events_035385.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:20:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9228#event-35385"
}
```



---

archive/issue_comments_101370.json:
```json
{
    "body": "Changing merged from \"sage-4.6.2.alpha1\" to \"\"",
    "created_at": "2011-01-20T09:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101370",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "sage-4.6.2.alpha1" to ""



---

archive/issue_comments_101371.json:
```json
{
    "body": "Resolution changed from fixed to ",
    "created_at": "2011-01-20T09:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101371",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from fixed to 



---

archive/issue_comments_101372.json:
```json
{
    "body": "<a id='comment:5'></a>\nFor some reason, the '\\t' (tab) is replaced by a series of spaces on Solaris, giving doctest errors:\n\n```\n**********************************************************************\nFile \"/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.6.2.alpha1/devel/sage-main/sage/interfaces/mwrank.py\", line 107:\n    sage: M('0 -1 1 0 0')\nExpected:\n    'Curve [0,-1,1,0,0] :\\tRank = 0\\n\\n\\nRegulator = 1\\n'\nGot:\n    'Curve [0,-1,1,0,0] :    Rank = 0\\n\\n\\nRegulator = 1\\n'\n**********************************************************************\n```",
    "created_at": "2011-01-20T09:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101372",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:5'></a>
For some reason, the '\t' (tab) is replaced by a series of spaces on Solaris, giving doctest errors:

```
**********************************************************************
File "/export/home/buildbot/build/sage/hawk-1/hawk_full/build/sage-4.6.2.alpha1/devel/sage-main/sage/interfaces/mwrank.py", line 107:
    sage: M('0 -1 1 0 0')
Expected:
    'Curve [0,-1,1,0,0] :\tRank = 0\n\n\nRegulator = 1\n'
Got:
    'Curve [0,-1,1,0,0] :    Rank = 0\n\n\nRegulator = 1\n'
**********************************************************************
```



---

archive/issue_comments_101373.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2011-01-20T09:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101373",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_035386.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-20T09:01:23Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9228#event-35386"
}
```



---

archive/issue_comments_101374.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2011-01-20T09:01:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101374",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_101375.json:
```json
{
    "body": "<a id='comment:7'></a>\nOK, so I know that some people don't like my programs putting tabs into output, which I do so the output looks pretty when viewed by humans!\n\nI suppose that one solution is to post-process the long string output by mwrank, replacing its tabs by an appropriate number of spaces.\n\nThis is just the sort of annoying triviality which makes adding doctests take so much longer than it ought!\n\nI'll post a revised patch shortly.",
    "created_at": "2011-01-20T09:30:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101375",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'></a>
OK, so I know that some people don't like my programs putting tabs into output, which I do so the output looks pretty when viewed by humans!

I suppose that one solution is to post-process the long string output by mwrank, replacing its tabs by an appropriate number of spaces.

This is just the sort of annoying triviality which makes adding doctests take so much longer than it ought!

I'll post a revised patch shortly.



---

archive/issue_comments_101376.json:
```json
{
    "body": "Applies to 4.6.2.alpha0",
    "created_at": "2011-01-20T11:20:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101376",
    "user": "https://github.com/JohnCremona"
}
```

Applies to 4.6.2.alpha0



---

archive/issue_comments_101377.json:
```json
{
    "body": "<a id='comment:8'></a>\nAttachment [trac_9228-mwrank-doctest.patch](tarball://root/attachments/some-uuid/ticket9228/trac_9228-mwrank-doctest.patch) by @JohnCremona created at 2011-01-20 11:22:00\n\nThe new version of the patch does what I suggested, i.e. replaces all tabs in mwrank output by three spaces;  the doctest which failed before has been adjusted accordingly.\n\nI could not find any other doctest which would be affected by this, and tested all sage/interfaces and sage/schemes/elliptic_curves.",
    "created_at": "2011-01-20T11:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101377",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>
Attachment [trac_9228-mwrank-doctest.patch](tarball://root/attachments/some-uuid/ticket9228/trac_9228-mwrank-doctest.patch) by @JohnCremona created at 2011-01-20 11:22:00

The new version of the patch does what I suggested, i.e. replaces all tabs in mwrank output by three spaces;  the doctest which failed before has been adjusted accordingly.

I could not find any other doctest which would be affected by this, and tested all sage/interfaces and sage/schemes/elliptic_curves.



---

archive/issue_comments_101378.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-01-20T11:22:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101378",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_101379.json:
```json
{
    "body": "<a id='comment:9'></a>\nI can't help noticing that you've replaced tabs with 3 spaces, but Solaris seems to replace them with 4 spaces -- so I suspect that it still won't work (groan).",
    "created_at": "2011-01-20T12:13:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101379",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:9'></a>
I can't help noticing that you've replaced tabs with 3 spaces, but Solaris seems to replace them with 4 spaces -- so I suspect that it still won't work (groan).



---

archive/issue_comments_101380.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [davidloeffler](#comment%3A9):\n> I can't help noticing that you've replaced tabs with 3 spaces, but Solaris seems to replace them with 4 spaces -- so I suspect that it still won't work (groan).\n\n\nThink again.  I have removed the tabs so Solaris will not need to do anything!",
    "created_at": "2011-01-20T12:36:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101380",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:10'></a>
Replying to [davidloeffler](#comment%3A9):
> I can't help noticing that you've replaced tabs with 3 spaces, but Solaris seems to replace them with 4 spaces -- so I suspect that it still won't work (groan).


Think again.  I have removed the tabs so Solaris will not need to do anything!



---

archive/issue_comments_101381.json:
```json
{
    "body": "<a id='comment:11'></a>\nThe question is: why is the output on Solaris different in the first place?  Is it the `mwrank` program itself?  Is it pexpect?  Is it Python?",
    "created_at": "2011-01-20T12:39:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101381",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>
The question is: why is the output on Solaris different in the first place?  Is it the `mwrank` program itself?  Is it pexpect?  Is it Python?



---

archive/issue_comments_101382.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [jdemeyer](#comment%3A11):\n> The question is: why is the output on Solaris different in the first place?  Is it the `mwrank` program itself?  Is it pexpect?  Is it Python?\n\n\nHere's a test:  on the solaris machine, do\n\n```\necho 0 -1 1 0 0 0 0 0 0 0 | sage -mwrank -v 0 -q -l > t\n```\nand see if the file t contains any tab characters.  If it does, then mwrank is behaving normally and the tab conversion is happening further downstream.",
    "created_at": "2011-01-20T13:02:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101382",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:12'></a>
Replying to [jdemeyer](#comment%3A11):
> The question is: why is the output on Solaris different in the first place?  Is it the `mwrank` program itself?  Is it pexpect?  Is it Python?


Here's a test:  on the solaris machine, do

```
echo 0 -1 1 0 0 0 0 0 0 0 | sage -mwrank -v 0 -q -l > t
```
and see if the file t contains any tab characters.  If it does, then mwrank is behaving normally and the tab conversion is happening further downstream.



---

archive/issue_comments_101383.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [cremona](#comment%3A12):\n> Here's a test:  on the solaris machine, do\n> \n> ```\n> echo 0 -1 1 0 0 0 0 0 0 0 | sage -mwrank -v 0 -q -l\n> ```\n\n\nThis is producing an actual tab character.",
    "created_at": "2011-01-20T20:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101383",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:13'></a>
Replying to [cremona](#comment%3A12):
> Here's a test:  on the solaris machine, do
> 
> ```
> echo 0 -1 1 0 0 0 0 0 0 0 | sage -mwrank -v 0 -q -l
> ```


This is producing an actual tab character.



---

archive/issue_comments_101384.json:
```json
{
    "body": "Changing reviewer from \"Aly Deines\" to \"Aly Deines, Jeroen Demeyer\"",
    "created_at": "2011-01-20T20:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101384",
    "user": "https://github.com/jdemeyer"
}
```

Changing reviewer from "Aly Deines" to "Aly Deines, Jeroen Demeyer"



---

archive/issue_comments_101385.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-01-20T20:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101385",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_101386.json:
```json
{
    "body": "<a id='comment:14'></a>\nTested on fulvia (i386 Solaris).",
    "created_at": "2011-01-20T20:47:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101386",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>
Tested on fulvia (i386 Solaris).



---

archive/issue_comments_101387.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-01-25T08:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101387",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_101388.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.6.2.alpha2\"",
    "created_at": "2011-01-25T08:14:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9228#issuecomment-101388",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.6.2.alpha2"



---

archive/issue_events_035387.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-25T08:14:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9228",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9228#event-35387"
}
```
