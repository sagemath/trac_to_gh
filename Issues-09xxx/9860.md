# Issue 9860: Port changes in PARI 2.3.5.p4 (#9722) to current 2.4.3

archive/issues_009859.json:
```json
{
    "assignees": [
        "https://github.com/nexttime"
    ],
    "body": "Some fixes to PARI 2.3.5.p2 from #9722 had to be ported to the current [NewPARI](http://wiki.sagemath.org/wiki/NewPARI) spkg. The new PARI 2.4.3.p5 spkg here contains some further changes (including some on Sage's side, mostly clean-up), while other issues have meanwhile been fixed upstream.\n\nThis package is intended to be tested with Sage **4.6.prealpha3**. If you want to test it with Sage 4.5.3.*, apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343. See [the wiki page](http://wiki.sagemath.org/NewPARI) for detailed instructions. You can also download [Sage 4.6.prealpha4](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha4.tar), which includes the new package with all changes made here.\n\n**New (complete) spkg up at [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg)**\n\n---\n\n### pari-2.4.3.svn-12577.p5 (Leif Leonhardy, Jeroen Demeyer, September 5th, 2010)\n* Added patches to:\n  - config/get_config_options:\n    * Make invalid arguments to \"--graphic\" a \"Configure\" error\n      (rather than potentially running into *compilation* errors\n      later).\n  - config/get_fltk: (see also/ported from #9722)\n    * Add libstdc++ to the libraries (to support Fedora 13 et al.).\n    * Also check the presence of the FLTK include directory to\n      prevent compilation errors on broken installations.\n  - config/get_X11: (see also/ported from #9722)\n    * Also search */lib64/* directories when doing a 64-bit build.\n    * Give more specific messages.\n* Slightly extended existing patch to src/kernel/gmp/mp.c:\n  - Allow disabling PARI's use of \"GMP internals\" by preprocessor\n    directive (i.e. by adding \"-DPARI_DONT_USE_GMP_INTERNALS\" to\n    CFLAGS). Brief explanation added.\n* spkg-install:\n  - Don't override user-specified CFLAGS (w.r.t. optimization, unless\n    SAGE_DEBUG=yes).\n  - Handle PARI_EXTRA_OPTS properly, and print informative messages\n    (regarding graphics support for plotting).\n  - Recognize SAGE_TUNE_PARI in addition to SAGE_TUNE_pari, and\n    add \"--tune\" to PARI_EXTRA_OPTS if self-tuning was requested.\n  - Clear/unset lots of (environment) variables used by PARI that might\n    unintentionally get their values from user settings.\n  - Quote *all* occurrences of SAGE_LOCAL (and some other expressions).\n  - Use $UNAME instead of `uname` everywhere, use \"elif ...\".\n  - *Always* use $MAKE (changed for \"install-data\").\n  - Begin all error messages with \"Error\".\n  - Removed useless tests of $? at end.\n  - Some clean-up (typos, formatting); some comments, some messages added.\n* spkg-check:\n  - Use $MAKE instead of \"make\".\n  - Don't override user-specified CFLAGS (w.r.t. optimization, unless\n    SAGE_DEBUG=yes).\n  - Begin error message with \"Error\".\n  - Some clean-up.\n* Slight corrections to SPKG.txt.\n* Updated patches/README.txt, some cosmetic changes.\n* Remove patch for config/Makefile.SH and add upstream fix instead\n  in spkg-make.\n* Add upstream fix for src/tune/tune.c which should fix tuning.\n* Add -O0 to CFLAGS in spkg-make to speed up compiling (the output of the compiling is not used anyway).\n\n\nComponent: **packages: standard**\n\nAuthor: **Leif Leonhardy, Jeroen Demeyer**\n\nReviewer: **Jeroen Demeyer, Leif Leonhardy**\n\nMerged: **sage-4.6.alpha0**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9860_\n\n",
    "closed_at": "2010-09-10T10:45:26Z",
    "created_at": "2010-09-06T11:47:15Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Port changes in PARI 2.3.5.p4 (#9722) to current 2.4.3",
    "type": "issue",
    "updated_at": "2010-09-10T10:45:26Z",
    "url": "https://github.com/sagemath/sage/issues/9860",
    "user": "https://github.com/nexttime"
}
```
Some fixes to PARI 2.3.5.p2 from #9722 had to be ported to the current [NewPARI](http://wiki.sagemath.org/wiki/NewPARI) spkg. The new PARI 2.4.3.p5 spkg here contains some further changes (including some on Sage's side, mostly clean-up), while other issues have meanwhile been fixed upstream.

This package is intended to be tested with Sage **4.6.prealpha3**. If you want to test it with Sage 4.5.3.*, apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343. See [the wiki page](http://wiki.sagemath.org/NewPARI) for detailed instructions. You can also download [Sage 4.6.prealpha4](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha4.tar), which includes the new package with all changes made here.

**New (complete) spkg up at [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg)**

---

### pari-2.4.3.svn-12577.p5 (Leif Leonhardy, Jeroen Demeyer, September 5th, 2010)
* Added patches to:
  - config/get_config_options:
    * Make invalid arguments to "--graphic" a "Configure" error
      (rather than potentially running into *compilation* errors
      later).
  - config/get_fltk: (see also/ported from #9722)
    * Add libstdc++ to the libraries (to support Fedora 13 et al.).
    * Also check the presence of the FLTK include directory to
      prevent compilation errors on broken installations.
  - config/get_X11: (see also/ported from #9722)
    * Also search */lib64/* directories when doing a 64-bit build.
    * Give more specific messages.
* Slightly extended existing patch to src/kernel/gmp/mp.c:
  - Allow disabling PARI's use of "GMP internals" by preprocessor
    directive (i.e. by adding "-DPARI_DONT_USE_GMP_INTERNALS" to
    CFLAGS). Brief explanation added.
* spkg-install:
  - Don't override user-specified CFLAGS (w.r.t. optimization, unless
    SAGE_DEBUG=yes).
  - Handle PARI_EXTRA_OPTS properly, and print informative messages
    (regarding graphics support for plotting).
  - Recognize SAGE_TUNE_PARI in addition to SAGE_TUNE_pari, and
    add "--tune" to PARI_EXTRA_OPTS if self-tuning was requested.
  - Clear/unset lots of (environment) variables used by PARI that might
    unintentionally get their values from user settings.
  - Quote *all* occurrences of SAGE_LOCAL (and some other expressions).
  - Use $UNAME instead of `uname` everywhere, use "elif ...".
  - *Always* use $MAKE (changed for "install-data").
  - Begin all error messages with "Error".
  - Removed useless tests of $? at end.
  - Some clean-up (typos, formatting); some comments, some messages added.
* spkg-check:
  - Use $MAKE instead of "make".
  - Don't override user-specified CFLAGS (w.r.t. optimization, unless
    SAGE_DEBUG=yes).
  - Begin error message with "Error".
  - Some clean-up.
* Slight corrections to SPKG.txt.
* Updated patches/README.txt, some cosmetic changes.
* Remove patch for config/Makefile.SH and add upstream fix instead
  in spkg-make.
* Add upstream fix for src/tune/tune.c which should fix tuning.
* Add -O0 to CFLAGS in spkg-make to speed up compiling (the output of the compiling is not used anyway).


Component: **packages: standard**

Author: **Leif Leonhardy, Jeroen Demeyer**

Reviewer: **Jeroen Demeyer, Leif Leonhardy**

Merged: **sage-4.6.alpha0**

_Issue created by migration from https://trac.sagemath.org/ticket/9860_





---

archive/issue_events_126768.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-06T11:47:15Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "milestone_number": null,
    "milestone_title": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126768"
}
```



---

archive/issue_events_126769.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-06T11:47:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126769"
}
```



---

archive/issue_events_126770.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-06T11:47:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126770"
}
```



---

archive/issue_events_126771.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-06T11:47:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126771"
}
```



---

archive/issue_events_126772.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-06T11:47:15Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "subject": "https://github.com/nexttime",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126772"
}
```



---

archive/issue_comments_088112.json:
```json
{
    "body": "Apply to pari-2.4.3.svn-12577.p4.spkg. Note that added/changed files in `patches/files` are not included here!",
    "created_at": "2010-09-06T11:59:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88112",
    "user": "https://github.com/nexttime"
}
```

Apply to pari-2.4.3.svn-12577.p4.spkg. Note that added/changed files in `patches/files` are not included here!



---

archive/issue_comments_088113.json:
```json
{
    "body": "Attachment: **[trac_9860-pari-2.4.3.svn-12577.p4-p5.spkg.patch.gz](https://github.com/sagemath/sage/files/ticket9860/trac_9860-pari-2.4.3.svn-12577.p4-p5.spkg.patch.gz)**\n\nDiff of files in `patches/files`. Apply with `patch -p1` inside spkg directory.",
    "created_at": "2010-09-06T12:12:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88113",
    "user": "https://github.com/nexttime"
}
```

Attachment: **[trac_9860-pari-2.4.3.svn-12577.p4-p5.spkg.patch.gz](https://github.com/sagemath/sage/files/ticket9860/trac_9860-pari-2.4.3.svn-12577.p4-p5.spkg.patch.gz)**

Diff of files in `patches/files`. Apply with `patch -p1` inside spkg directory.



---

archive/issue_events_126773.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-06T12:38:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126773"
}
```



---

archive/issue_comments_088114.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[trac_9860-patched_files_not_under_revision_control.p4-p5.spkg.diff.gz](https://github.com/sagemath/sage/files/ticket9860/trac_9860-patched_files_not_under_revision_control.p4-p5.spkg.diff.gz)**",
    "created_at": "2010-09-06T12:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88114",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[trac_9860-patched_files_not_under_revision_control.p4-p5.spkg.diff.gz](https://github.com/sagemath/sage/files/ticket9860/trac_9860-patched_files_not_under_revision_control.p4-p5.spkg.diff.gz)**



---

archive/issue_comments_088115.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -43,3 +43,6 @@\n * Slight corrections to SPKG.txt.\n * Updated patches/README.txt, some cosmetic changes.\n \n+---\n+\n+**New (complete) spkg up at http://spkg-upload.googlecode.com/files/pari-2.4.3.svn-12577.p5.spkg**\n``````\n",
    "created_at": "2010-09-06T12:38:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88115",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -43,3 +43,6 @@
 * Slight corrections to SPKG.txt.
 * Updated patches/README.txt, some cosmetic changes.
 
+---
+
+**New (complete) spkg up at http://spkg-upload.googlecode.com/files/pari-2.4.3.svn-12577.p5.spkg**
``````




---

archive/issue_comments_088116.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI've only tested this with a couple of variations on parameters and installed libraries / graphics packages on Ubuntu 10.04 x86_64 and Fedora 13 x86.\n\n*Should* work on other systems as well... ;-)",
    "created_at": "2010-09-06T12:54:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88116",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:2" align="right">comment:2</div>

I've only tested this with a couple of variations on parameters and installed libraries / graphics packages on Ubuntu 10.04 x86_64 and Fedora 13 x86.

*Should* work on other systems as well... ;-)



---

archive/issue_comments_088117.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nWhat do I need to do to test this - **just** download the package - do I need to patch anything else? \n\nI've done:\n\n* Downloaded and installed  http://spkg-upload.googlecode.com/files/pari-2.4.3.svn-12577.p5.spkg\n* Nothing else changed from 4.5.3.alpha2\n* No attempt to tune code\n \n\n```\ndrkirkby@hawk:~/5/sage-4.5.3.alpha2$ ./sage -b\n\n----------------------------------------------------------\nsage: Building and installing modified Sage library files.\n\n\nInstalling c_lib\ngcc -o src/convert.pic.o -c -fPIC -I/export/home/drkirkby/5/sage-4.5.3.alpha2/local/include -I/export/home/drkirkby/5/sage-4.5.3.alpha2/local/include/python2.6 -I/export/home/drkirkby/5/sage-4.5.3.alpha2/local/include/NTL -Iinclude src/convert.c\ng++ -o libcsage.so -shared src/convert.pic.o src/interrupt.pic.o src/mpn_pylong.pic.o src/mpz_pylong.pic.o src/mpz_longlong.pic.o src/stdsage.pic.o src/gmp_globals.pic.o src/ZZ_pylong.pic.o src/ntl_wrap.pic.o -L/export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib -L/export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib/python/config -lntl -lgmp -lpari -lpython2.6\nUpdating Cython code....\nExecute 0 commands (using 0 threads)\nTime to execute 0 commands: 0.0976297855377 seconds\nFinished compiling Cython code (time = 3.07916307449 seconds)\nrunning install\nrunning build\nrunning build_py\nrunning build_ext\nTotal time spent compiling C/C++ extensions:  0.913223028183 seconds.\nrunning install_lib\nrunning install_egg_info\nRemoving /export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib/python2.6/site-packages/sage-0.0.0-py2.6.egg-info\nWriting /export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib/python2.6/site-packages/sage-0.0.0-py2.6.egg-info\n\nreal\t0m8.727s\nuser\t0m1.339s\nsys\t0m0.727s\ndrkirkby@hawk:~/5/sage-4.5.3.alpha2$ make ptestlong\ncd spkg && ./install all 2>&1 | tee -a ../install.log\nmake[1]: Entering directory `/export/home/drkirkby/5/sage-4.5.3.alpha2/spkg'\nmake[1]: Nothing to be done for `all'.\nmake[1]: Leaving directory `/export/home/drkirkby/5/sage-4.5.3.alpha2/spkg'\n\nreal\t0m0.018s\nuser\t0m0.003s\nsys\t0m0.003s\nTo install gap, gp, singular, etc., scripts\nin a standard bin directory, start sage and\ntype something like\n   sage: install_scripts('/usr/local/bin')\nat the Sage command prompt.\n\nTo build the documentation, run\n   make doc\n\nSage build/upgrade complete!\n./sage -docbuild all html  2>&1 | tee -a dochtml.log\nsphinx-build -b html -d /export/home/drkirkby/5/sage-4.5.3.alpha2/devel/sage/doc/output/doctrees/en/website    /export/home/drkirkby/5/sage-4.5.3.alpha2/devel/sage/doc/en/website /export/home/drkirkby/5/sage-4.5.3.alpha2/devel/sage/doc/output/html/en/website\n  ***   bug in PARI/GP (Segmentation Fault), please report\n^Cmake: *** [doc-html] Interrupt\n```\n\nIIRC, the changes from `sage-4.5.3.alpha2` to `sage-4.5.3.rc0` were just a few Solaris-specific changes which would not all all doc tests to pass, but were not need to actually get things working. \n\nThis is on an OpenSolaris (Xeon processor) machine. I've not tried on anything else. \n\nI'm rather hoping I've forgot something - in which case you have time to review #9603 !\n\nDave",
    "created_at": "2010-09-06T15:59:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88117",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:3" align="right">comment:3</div>

What do I need to do to test this - **just** download the package - do I need to patch anything else? 

I've done:

* Downloaded and installed  http://spkg-upload.googlecode.com/files/pari-2.4.3.svn-12577.p5.spkg
* Nothing else changed from 4.5.3.alpha2
* No attempt to tune code
 

```
drkirkby@hawk:~/5/sage-4.5.3.alpha2$ ./sage -b

----------------------------------------------------------
sage: Building and installing modified Sage library files.


Installing c_lib
gcc -o src/convert.pic.o -c -fPIC -I/export/home/drkirkby/5/sage-4.5.3.alpha2/local/include -I/export/home/drkirkby/5/sage-4.5.3.alpha2/local/include/python2.6 -I/export/home/drkirkby/5/sage-4.5.3.alpha2/local/include/NTL -Iinclude src/convert.c
g++ -o libcsage.so -shared src/convert.pic.o src/interrupt.pic.o src/mpn_pylong.pic.o src/mpz_pylong.pic.o src/mpz_longlong.pic.o src/stdsage.pic.o src/gmp_globals.pic.o src/ZZ_pylong.pic.o src/ntl_wrap.pic.o -L/export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib -L/export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib/python/config -lntl -lgmp -lpari -lpython2.6
Updating Cython code....
Execute 0 commands (using 0 threads)
Time to execute 0 commands: 0.0976297855377 seconds
Finished compiling Cython code (time = 3.07916307449 seconds)
running install
running build
running build_py
running build_ext
Total time spent compiling C/C++ extensions:  0.913223028183 seconds.
running install_lib
running install_egg_info
Removing /export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib/python2.6/site-packages/sage-0.0.0-py2.6.egg-info
Writing /export/home/drkirkby/5/sage-4.5.3.alpha2/local/lib/python2.6/site-packages/sage-0.0.0-py2.6.egg-info

real	0m8.727s
user	0m1.339s
sys	0m0.727s
drkirkby@hawk:~/5/sage-4.5.3.alpha2$ make ptestlong
cd spkg && ./install all 2>&1 | tee -a ../install.log
make[1]: Entering directory `/export/home/drkirkby/5/sage-4.5.3.alpha2/spkg'
make[1]: Nothing to be done for `all'.
make[1]: Leaving directory `/export/home/drkirkby/5/sage-4.5.3.alpha2/spkg'

real	0m0.018s
user	0m0.003s
sys	0m0.003s
To install gap, gp, singular, etc., scripts
in a standard bin directory, start sage and
type something like
   sage: install_scripts('/usr/local/bin')
at the Sage command prompt.

To build the documentation, run
   make doc

Sage build/upgrade complete!
./sage -docbuild all html  2>&1 | tee -a dochtml.log
sphinx-build -b html -d /export/home/drkirkby/5/sage-4.5.3.alpha2/devel/sage/doc/output/doctrees/en/website    /export/home/drkirkby/5/sage-4.5.3.alpha2/devel/sage/doc/en/website /export/home/drkirkby/5/sage-4.5.3.alpha2/devel/sage/doc/output/html/en/website
  ***   bug in PARI/GP (Segmentation Fault), please report
^Cmake: *** [doc-html] Interrupt
```

IIRC, the changes from `sage-4.5.3.alpha2` to `sage-4.5.3.rc0` were just a few Solaris-specific changes which would not all all doc tests to pass, but were not need to actually get things working. 

This is on an OpenSolaris (Xeon processor) machine. I've not tried on anything else. 

I'm rather hoping I've forgot something - in which case you have time to review #9603 !

Dave



---

archive/issue_comments_088118.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@sagetrac-drkirkby](#comment%3A3):\n> What do I need to do to test this - **just** download the package - do I need to patch anything else? \n\nYou also need to apply the sagelib and extcode patches from #9343.  Or easier: download [http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar), install that and *then* install the new pari spkg.",
    "created_at": "2010-09-06T16:14:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88118",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@sagetrac-drkirkby](#comment%3A3):
> What do I need to do to test this - **just** download the package - do I need to patch anything else? 

You also need to apply the sagelib and extcode patches from #9343.  Or easier: download [http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar), install that and *then* install the new pari spkg.



---

archive/issue_comments_088119.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,8 +1,12 @@\n Some fixes to PARI 2.3.5.p2 from #9722 had to be ported to the current [NewPARI](http://wiki.sagemath.org/wiki/NewPARI) spkg. The new PARI 2.4.3.p5 spkg here contains some further changes (including some on Sage's side, mostly clean-up), while other issues have meanwhile been fixed upstream.\n+\n+Apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343.\n+\n+**New (complete) spkg up at [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg)**\n \n ---\n \n-### pari-2.4.3.svn-12577.p5 (Leif Leonhardy, September 5th, 2010)\n+### pari-2.4.3.svn-12577.p5 (Leif Leonhardy, Jeroen Demeyer, September 5th, 2010)\n * Added patches to:\n   - config/get_config_options:\n     * Make invalid arguments to \"--graphic\" a \"Configure\" error\n@@ -42,7 +46,8 @@\n   - Some clean-up.\n * Slight corrections to SPKG.txt.\n * Updated patches/README.txt, some cosmetic changes.\n+* Remove patch for config/Makefile.SH and add upstream fix instead\n+  in spkg-make.\n+* Add upstream fix for src/tune/tune.c which should fix tuning.\n+* Add -O0 to CFLAGS in spkg-make to speed up compiling (the output of the compiling is not used anyway).\n \n----\n-\n-**New (complete) spkg up at http://spkg-upload.googlecode.com/files/pari-2.4.3.svn-12577.p5.spkg**\n``````\n",
    "created_at": "2010-09-06T16:17:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88119",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,8 +1,12 @@
 Some fixes to PARI 2.3.5.p2 from #9722 had to be ported to the current [NewPARI](http://wiki.sagemath.org/wiki/NewPARI) spkg. The new PARI 2.4.3.p5 spkg here contains some further changes (including some on Sage's side, mostly clean-up), while other issues have meanwhile been fixed upstream.
+
+Apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343.
+
+**New (complete) spkg up at [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg)**
 
 ---
 
-### pari-2.4.3.svn-12577.p5 (Leif Leonhardy, September 5th, 2010)
+### pari-2.4.3.svn-12577.p5 (Leif Leonhardy, Jeroen Demeyer, September 5th, 2010)
 * Added patches to:
   - config/get_config_options:
     * Make invalid arguments to "--graphic" a "Configure" error
@@ -42,7 +46,8 @@
   - Some clean-up.
 * Slight corrections to SPKG.txt.
 * Updated patches/README.txt, some cosmetic changes.
+* Remove patch for config/Makefile.SH and add upstream fix instead
+  in spkg-make.
+* Add upstream fix for src/tune/tune.c which should fix tuning.
+* Add -O0 to CFLAGS in spkg-make to speed up compiling (the output of the compiling is not used anyway).
 
----
-
-**New (complete) spkg up at http://spkg-upload.googlecode.com/files/pari-2.4.3.svn-12577.p5.spkg**
``````




---

archive/issue_comments_088120.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI have made a few small changes to the pari spkg and put the result at  http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg (I kept the p5 version number).",
    "created_at": "2010-09-06T16:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88120",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

I have made a few small changes to the pari spkg and put the result at  http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg (I kept the p5 version number).



---

archive/issue_comments_088121.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@jdemeyer](#comment%3A4):\n> Replying to [@sagetrac-drkirkby](#comment%3A3):\n> > What do I need to do to test this - **just** download the package - do I need to patch anything else? \n\n> You also need to apply the sagelib and extcode patches from #9343.  Or easier: download [http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar), install that and *then* install the new pari spkg.\n\nIt would be good if you could make a new tar file with all the changes in place - i.e. make a `sage-4.6.prealpha4.tar`\n\n\n\nDave",
    "created_at": "2010-09-06T16:26:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88121",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@jdemeyer](#comment%3A4):
> Replying to [@sagetrac-drkirkby](#comment%3A3):
> > What do I need to do to test this - **just** download the package - do I need to patch anything else? 

> You also need to apply the sagelib and extcode patches from #9343.  Or easier: download [http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha3.tar), install that and *then* install the new pari spkg.

It would be good if you could make a new tar file with all the changes in place - i.e. make a `sage-4.6.prealpha4.tar`



Dave



---

archive/issue_comments_088122.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@sagetrac-drkirkby](#comment%3A7):\n> It would be good if you could make a new tar file with all the changes in place - i.e. make a `sage-4.6.prealpha4.tar`\n\nI will now make a new 4.6-prealpha4 based on 4.5.3-rc0 with the new spkgs (I will also update genus2reduction, see #9591 and lcalc, see #9845).",
    "created_at": "2010-09-06T16:32:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88122",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@sagetrac-drkirkby](#comment%3A7):
> It would be good if you could make a new tar file with all the changes in place - i.e. make a `sage-4.6.prealpha4.tar`

I will now make a new 4.6-prealpha4 based on 4.5.3-rc0 with the new spkgs (I will also update genus2reduction, see #9591 and lcalc, see #9845).



---

archive/issue_comments_088123.json:
```json
{
    "body": "Attachment: **[pari.p5.patch.gz](https://github.com/sagemath/sage/files/ticket9860/pari.p5.patch.gz)**\n\nAdditional spkg patches by me",
    "created_at": "2010-09-06T19:32:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88123",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[pari.p5.patch.gz](https://github.com/sagemath/sage/files/ticket9860/pari.p5.patch.gz)**

Additional spkg patches by me



---

archive/issue_comments_088124.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,6 @@\n Some fixes to PARI 2.3.5.p2 from #9722 had to be ported to the current [NewPARI](http://wiki.sagemath.org/wiki/NewPARI) spkg. The new PARI 2.4.3.p5 spkg here contains some further changes (including some on Sage's side, mostly clean-up), while other issues have meanwhile been fixed upstream.\n \n-Apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343.\n+This package is intended to be tested with Sage **4.6.prealpha3**. If you want to test it with Sage 4.5.3.*, apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343. See [the wiki page](http://wiki.sagemath.org/NewPARI) for detailed instructions. You can also download [Sage 4.6.prealpha4](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha4.tar), which includes the new package with all changes made here.\n \n **New (complete) spkg up at [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg)**\n \n``````\n",
    "created_at": "2010-09-07T07:32:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88124",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,6 @@
 Some fixes to PARI 2.3.5.p2 from #9722 had to be ported to the current [NewPARI](http://wiki.sagemath.org/wiki/NewPARI) spkg. The new PARI 2.4.3.p5 spkg here contains some further changes (including some on Sage's side, mostly clean-up), while other issues have meanwhile been fixed upstream.
 
-Apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343.
+This package is intended to be tested with Sage **4.6.prealpha3**. If you want to test it with Sage 4.5.3.*, apart from installing this spkg here, you also need to apply the sagelib and extcode patches from #9343. See [the wiki page](http://wiki.sagemath.org/NewPARI) for detailed instructions. You can also download [Sage 4.6.prealpha4](http://sage.math.washington.edu/home/jdemeyer/dist/sage-4.6.prealpha4.tar), which includes the new package with all changes made here.
 
 **New (complete) spkg up at [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg)**
 
``````




---

archive/issue_comments_088125.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@jdemeyer](#comment%3A6):\n> I have made a few small changes to the pari spkg and put the result at  http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg (I kept the p5 version number).\n\nI'm ok with your changes (\"positive review\"). Not very surprisingly Sage 4.6.prealpha4 also passed all tests. Tuning on a Core2 worked, too, at least did pass without errors. ;-)\n\nThe way we handle the patches now (without the patched *replacement files* being under revision control) is a bit dangerous though. Perhaps we should also add some script to *generate the patches* from `patches/files/*` and one to just make sure they're in sync.",
    "created_at": "2010-09-07T07:52:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88125",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@jdemeyer](#comment%3A6):
> I have made a few small changes to the pari spkg and put the result at  http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p5.spkg (I kept the p5 version number).

I'm ok with your changes ("positive review"). Not very surprisingly Sage 4.6.prealpha4 also passed all tests. Tuning on a Core2 worked, too, at least did pass without errors. ;-)

The way we handle the patches now (without the patched *replacement files* being under revision control) is a bit dangerous though. Perhaps we should also add some script to *generate the patches* from `patches/files/*` and one to just make sure they're in sync.



---

archive/issue_comments_088126.json:
```json
{
    "body": "Reviewer: **Leif Leonhardy, Jeroen Demeyer**",
    "created_at": "2010-09-07T10:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88126",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Leif Leonhardy, Jeroen Demeyer**



---

archive/issue_comments_088127.json:
```json
{
    "body": "Changed author from **Leif Leonhardy** to **Leif Leonhardy, Jeroen Demeyer**",
    "created_at": "2010-09-07T10:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88127",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Leif Leonhardy** to **Leif Leonhardy, Jeroen Demeyer**



---

archive/issue_comments_088128.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nLeif: your patch looks good on visual inspection.  Since it fixes all known build issues, I give it positive review.",
    "created_at": "2010-09-07T10:05:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88128",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:11" align="right">comment:11</div>

Leif: your patch looks good on visual inspection.  Since it fixes all known build issues, I give it positive review.



---

archive/issue_events_126774.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-07T10:05:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126774"
}
```



---

archive/issue_events_126775.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-07T10:05:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126775"
}
```



---

archive/issue_comments_088129.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nOtherwise looks a bit funny. Thanks though. ;-)\n\nI think we should report some of the changes upstream when our PARI has successfully reached some Sage 4.6.{alpha,rc}.",
    "created_at": "2010-09-07T10:28:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88129",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

Otherwise looks a bit funny. Thanks though. ;-)

I think we should report some of the changes upstream when our PARI has successfully reached some Sage 4.6.{alpha,rc}.



---

archive/issue_comments_088130.json:
```json
{
    "body": "Changed reviewer from **Leif Leonhardy, Jeroen Demeyer** to **Jeroen Demeyer, Leif Leonhardy**",
    "created_at": "2010-09-07T10:28:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88130",
    "user": "https://github.com/nexttime"
}
```

Changed reviewer from **Leif Leonhardy, Jeroen Demeyer** to **Jeroen Demeyer, Leif Leonhardy**



---

archive/issue_comments_088131.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@nexttime](#comment%3A12):\n> I think we should report some of the changes upstream when our PARI has successfully reached some Sage 4.6.{alpha,rc}.\n\nAgreed.",
    "created_at": "2010-09-07T10:36:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88131",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@nexttime](#comment%3A12):
> I think we should report some of the changes upstream when our PARI has successfully reached some Sage 4.6.{alpha,rc}.

Agreed.



---

archive/issue_comments_088132.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nP.S.: Attempting to build with Qt as the graphics back-end is still broken in some constellations (i.e. may lead to build errors, too), since the code apparently expects Qt <= 3 and some (Qt) tools PARI doesn't look for. I haven't yet worked on `config/get_Qt` though.",
    "created_at": "2010-09-07T10:38:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88132",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:14" align="right">comment:14</div>

P.S.: Attempting to build with Qt as the graphics back-end is still broken in some constellations (i.e. may lead to build errors, too), since the code apparently expects Qt <= 3 and some (Qt) tools PARI doesn't look for. I haven't yet worked on `config/get_Qt` though.



---

archive/issue_events_126776.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-10T10:45:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126776"
}
```



---

archive/issue_events_126777.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-10T10:45:26Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9860#event-126777"
}
```



---

archive/issue_comments_088133.json:
```json
{
    "body": "Merged: **sage-4.6.alpha0**",
    "created_at": "2010-09-10T10:45:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9860",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9860#issuecomment-88133",
    "user": "https://github.com/qed777"
}
```

Merged: **sage-4.6.alpha0**
