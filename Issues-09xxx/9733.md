# Issue 9733: Parallel build of Singular 3-1-1-4-package fails in rare case

archive/issues_009733.json:
```json
{
    "assignees": [],
    "body": "It was discovered in #8059 , that the parallel build of the Singular 3-1-1-4 packages still breaks in rare cases (many CPU cores, slow hard disk).\n\nThere are two patches which should fix this issue upstream:\nhttp://www.singular.uni-kl.de:8002/trac/ticket/250, see\n\n```\nsvn diff -r 13112:13110 http://www.singular.uni-kl.de/svn/\n```\n\n## Release manager\nMerge just this package:\n\n http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg\n\n\nAssignee: **@alexanderdreyer**\n\nCC:  PolyBoRi drkirkby @malb @burcin @nexttime\n\nAuthor: **Alexander Dreyer, Fran\u00e7ois Bissey**\n\nReviewer: **Mitesh Patel, Leif Leonhardy, David Kirkby**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nMerged: **sage-4.6.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9733_\n\n",
    "closed_at": "2010-09-17T21:32:29Z",
    "created_at": "2010-08-12T12:18:45Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Parallel build of Singular 3-1-1-4-package fails in rare case",
    "type": "issue",
    "updated_at": "2010-09-19T05:56:00Z",
    "url": "https://github.com/sagemath/sage/issues/9733",
    "user": "https://github.com/alexanderdreyer"
}
```
It was discovered in #8059 , that the parallel build of the Singular 3-1-1-4 packages still breaks in rare cases (many CPU cores, slow hard disk).

There are two patches which should fix this issue upstream:
http://www.singular.uni-kl.de:8002/trac/ticket/250, see

```
svn diff -r 13112:13110 http://www.singular.uni-kl.de/svn/
```

## Release manager
Merge just this package:

 http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg


Assignee: **@alexanderdreyer**

CC:  PolyBoRi drkirkby @malb @burcin @nexttime

Author: **Alexander Dreyer, Fran√ßois Bissey**

Reviewer: **Mitesh Patel, Leif Leonhardy, David Kirkby**

Upstream: **Fixed upstream, in a later stable release.**

Merged: **sage-4.6.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/9733_





---

archive/issue_events_111114.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2010-08-12T12:18:45Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "milestone_number": null,
    "milestone_title": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111114"
}
```



---

archive/issue_events_111115.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2010-08-12T12:18:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111115"
}
```



---

archive/issue_events_111116.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2010-08-12T12:18:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111116"
}
```



---

archive/issue_events_111117.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2010-08-12T12:18:45Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111117"
}
```



---

archive/issue_comments_087831.json:
```json
{
    "body": "svn diff -r 13112:13110 http://www.singular.uni-kl.de/svn/",
    "created_at": "2010-08-12T12:20:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87831",
    "user": "https://github.com/alexanderdreyer"
}
```

svn diff -r 13112:13110 http://www.singular.uni-kl.de/svn/



---

archive/issue_comments_087832.json:
```json
{
    "body": "<a id='comment:1'>Comment 1:</a>\nAttachment: **[SingularSvn13111-13112.patch.gz](https://github.com/sagemath/sage/files/ticket9733/SingularSvn13111-13112.patch.gz)**",
    "created_at": "2010-08-12T12:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87832",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:1'>Comment 1:</a>
Attachment: **[SingularSvn13111-13112.patch.gz](https://github.com/sagemath/sage/files/ticket9733/SingularSvn13111-13112.patch.gz)**



---

archive/issue_comments_087833.json:
```json
{
    "body": "Changed assignee from **@aghitza** to **@alexanderdreyer**",
    "created_at": "2010-08-12T12:20:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87833",
    "user": "https://github.com/alexanderdreyer"
}
```

Changed assignee from **@aghitza** to **@alexanderdreyer**



---

archive/issue_events_111118.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2010-08-12T12:21:21Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20algebra",
    "label_color": "0000ff",
    "label_name": "component: algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111118"
}
```



---

archive/issue_events_111119.json:
```json
{
    "actor": "https://github.com/alexanderdreyer",
    "created_at": "2010-08-12T12:21:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111119"
}
```



---

archive/issue_comments_087834.json:
```json
{
    "body": "<a id='comment:4'>Comment 4:</a>\nI repeated the tests in [comment:ticket:8059:112 comment 112] at #8059, this time under `/dev/shm` (a fast RAM disk, I think) on sage.math.  Thirteen of 50 runs failed, all apparently caused by the `gentable*` problem, which should be fixed by [this upstream comment](http://www.singular.uni-kl.de:8002/trac/ticket/250#comment:2).\n\nThanks for filing the fixes!",
    "created_at": "2010-08-13T01:05:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87834",
    "user": "https://github.com/qed777"
}
```

<a id='comment:4'>Comment 4:</a>
I repeated the tests in [comment:ticket:8059:112 comment 112] at #8059, this time under `/dev/shm` (a fast RAM disk, I think) on sage.math.  Thirteen of 50 runs failed, all apparently caused by the `gentable*` problem, which should be fixed by [this upstream comment](http://www.singular.uni-kl.de:8002/trac/ticket/250#comment:2).

Thanks for filing the fixes!



---

archive/issue_comments_087835.json:
```json
{
    "body": "<a id='comment:5'>Comment 5:</a>\nI will add a small patch to this ticket. While I worked on the Gentoo ebuild\nI discovered that parallel make is disabled itself (jobserver not available using -j1) on libsingular and the test because make is called directly as \"make\" and not $(MAKE) or ${MAKE}.\n\nSo while it looks all fine and dandy you are actually not building libsingular in parallel, feel free to forward upstream as I don't have an account with them.",
    "created_at": "2010-08-13T11:15:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87835",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:5'>Comment 5:</a>
I will add a small patch to this ticket. While I worked on the Gentoo ebuild
I discovered that parallel make is disabled itself (jobserver not available using -j1) on libsingular and the test because make is called directly as "make" and not $(MAKE) or ${MAKE}.

So while it looks all fine and dandy you are actually not building libsingular in parallel, feel free to forward upstream as I don't have an account with them.



---

archive/issue_comments_087836.json:
```json
{
    "body": "replace make by ${MAKE} in top Makefile.in",
    "created_at": "2010-08-13T11:16:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87836",
    "user": "https://github.com/kiwifb"
}
```

replace make by ${MAKE} in top Makefile.in



---

archive/issue_comments_087837.json:
```json
{
    "body": "<a id='comment:6'>Comment 6:</a>\nAttachment: **[singular-3.1.1.4-MAKE.patch.gz](https://github.com/sagemath/sage/files/ticket9733/singular-3.1.1.4-MAKE.patch.gz)**\n\nBut that's actually not a problem for the spkg, because the `spkg-install` does not call these target from the top-level `Makefile`.",
    "created_at": "2010-08-13T11:35:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87837",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:6'>Comment 6:</a>
Attachment: **[singular-3.1.1.4-MAKE.patch.gz](https://github.com/sagemath/sage/files/ticket9733/singular-3.1.1.4-MAKE.patch.gz)**

But that's actually not a problem for the spkg, because the `spkg-install` does not call these target from the top-level `Makefile`.



---

archive/issue_comments_087838.json:
```json
{
    "body": "<a id='comment:7'>Comment 7:</a>\nReplying to [@alexanderdreyer](#comment%3A6):\n> But that's actually not a problem for the spkg, because the `spkg-install` does not call these target from the top-level `Makefile`.\n\nThen I missed something because I just checked spkg-install from the latest available spkg in #8059 and it does build libsingular by calling the top makefile:\n\n```\nbuild_libsingular()\n{\n    cd $SRC\n    if [ $? -ne 0 ]; then\n        echo \"Unable to change to directory $SRC\"\n        exit 1\n    fi\n\n    make libsingular\n```",
    "created_at": "2010-08-13T11:44:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87838",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:7'>Comment 7:</a>
Replying to [@alexanderdreyer](#comment%3A6):
> But that's actually not a problem for the spkg, because the `spkg-install` does not call these target from the top-level `Makefile`.

Then I missed something because I just checked spkg-install from the latest available spkg in #8059 and it does build libsingular by calling the top makefile:

```
build_libsingular()
{
    cd $SRC
    if [ $? -ne 0 ]; then
        echo "Unable to change to directory $SRC"
        exit 1
    fi

    make libsingular
```



---

archive/issue_comments_087839.json:
```json
{
    "body": "<a id='comment:8'>Comment 8:</a>\nYou're right, it's the case for factory and libfac, but not libsingular. But it will not change much, because most of the dependencies of libsingular are already built, when the spkg calls build_libsingular().",
    "created_at": "2010-08-13T11:57:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87839",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:8'>Comment 8:</a>
You're right, it's the case for factory and libfac, but not libsingular. But it will not change much, because most of the dependencies of libsingular are already built, when the spkg calls build_libsingular().



---

archive/issue_comments_087840.json:
```json
{
    "body": "<a id='comment:9'>Comment 9:</a>\nWhile it probably doesn't improve much the build time, it should be also thought as a QA patch. You should never ever call make directly from a makefile. That give rise to a pile of problems. The first one being that \"make\" may not be the original Make program invoked.\nI didn't originally think about this but it is in fact a much bigger concern than the build time.",
    "created_at": "2010-08-13T12:43:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87840",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:9'>Comment 9:</a>
While it probably doesn't improve much the build time, it should be also thought as a QA patch. You should never ever call make directly from a makefile. That give rise to a pile of problems. The first one being that "make" may not be the original Make program invoked.
I didn't originally think about this but it is in fact a much bigger concern than the build time.



---

archive/issue_comments_087841.json:
```json
{
    "body": "<a id='comment:10'>Comment 10:</a>\nRight, I'll report it upstream.",
    "created_at": "2010-08-13T12:51:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87841",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:10'>Comment 10:</a>
Right, I'll report it upstream.



---

archive/issue_comments_087842.json:
```json
{
    "body": "<a id='comment:11'>Comment 11:</a>\nJust to report back: for the gentable issue, there will be a better solution upstream. But the patch should be a reasonable workaround for sage.",
    "created_at": "2010-08-15T14:26:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87842",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:11'>Comment 11:</a>
Just to report back: for the gentable issue, there will be a better solution upstream. But the patch should be a reasonable workaround for sage.



---

archive/issue_comments_087843.json:
```json
{
    "body": "Changed author from **AlexanderDreyer** to **Alexander Dreyer, Fran\u00e7ois Bissey**",
    "created_at": "2010-08-16T21:09:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87843",
    "user": "https://github.com/nexttime"
}
```

Changed author from **AlexanderDreyer** to **Alexander Dreyer, Fran√ßois Bissey**



---

archive/issue_events_111120.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-09T01:35:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111120"
}
```



---

archive/issue_comments_087844.json:
```json
{
    "body": "<a id='comment:13'>Comment 13:</a>\nping",
    "created_at": "2010-09-09T01:35:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87844",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'>Comment 13:</a>
ping



---

archive/issue_comments_087845.json:
```json
{
    "body": "<a id='comment:14'>Comment 14:</a>\nWorks for me on Gentoo linux for x86, amd64 and ppc.",
    "created_at": "2010-09-09T01:48:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87845",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:14'>Comment 14:</a>
Works for me on Gentoo linux for x86, amd64 and ppc.



---

archive/issue_comments_087846.json:
```json
{
    "body": "<a id='comment:15'>Comment 15:</a>\nCan someone make a new spkg and post a link to it?",
    "created_at": "2010-09-09T02:13:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87846",
    "user": "https://github.com/qed777"
}
```

<a id='comment:15'>Comment 15:</a>
Can someone make a new spkg and post a link to it?



---

archive/issue_comments_087847.json:
```json
{
    "body": "<a id='comment:16'>Comment 16:</a>\nPlease try out this one:\nhttp://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg",
    "created_at": "2010-09-09T08:41:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87847",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:16'>Comment 16:</a>
Please try out this one:
http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg



---

archive/issue_comments_087848.json:
```json
{
    "body": "<a id='comment:17'>Comment 17:</a>\nReplying to [@alexanderdreyer](#comment%3A16):\n> Please try out this one:\n> http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg\n\n```sh\n$ hg status\n? spkg-install~\n```\n\nInstalls ok with `MAKE=\"make -j16\"` on an already loaded system (Sage 4.5.3, Ubuntu 10.04, Core2). I haven't had any problems previously with parallel builds though, and I don't have slow harddisks... ;-)\n\nUnrelated:\n* Any reason to look for `bison` (despite `--without-bison` btw.), but then hardcoding `bison` instead of using `@BISON@`?\n* `CFLAGS` and `CXXFLAGS` are *partly* ignored. (Instead [only] `CPPFLAGS` are used for compiling C and C++ code.)",
    "created_at": "2010-09-09T16:55:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87848",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'>Comment 17:</a>
Replying to [@alexanderdreyer](#comment%3A16):
> Please try out this one:
> http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg

```sh
$ hg status
? spkg-install~
```

Installs ok with `MAKE="make -j16"` on an already loaded system (Sage 4.5.3, Ubuntu 10.04, Core2). I haven't had any problems previously with parallel builds though, and I don't have slow harddisks... ;-)

Unrelated:
* Any reason to look for `bison` (despite `--without-bison` btw.), but then hardcoding `bison` instead of using `@BISON@`?
* `CFLAGS` and `CXXFLAGS` are *partly* ignored. (Instead [only] `CPPFLAGS` are used for compiling C and C++ code.)



---

archive/issue_comments_087849.json:
```json
{
    "body": "<a id='comment:18'>Comment 18:</a>\nI think you'll also need to revert changeset 102:017aa4e4766e (\"#8059: Restore building in serial, because of parallel build problems\"), in order to test parallel builds.",
    "created_at": "2010-09-09T21:53:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87849",
    "user": "https://github.com/qed777"
}
```

<a id='comment:18'>Comment 18:</a>
I think you'll also need to revert changeset 102:017aa4e4766e ("#8059: Restore building in serial, because of parallel build problems"), in order to test parallel builds.



---

archive/issue_comments_087850.json:
```json
{
    "body": "<a id='comment:19'>Comment 19:</a>\nD'oh! Yeah, I had to revert changeset 102 and removed the tilde-file.\nPlease have a look at: http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg (same place as above)",
    "created_at": "2010-09-09T22:23:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87850",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:19'>Comment 19:</a>
D'oh! Yeah, I had to revert changeset 102 and removed the tilde-file.
Please have a look at: http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg (same place as above)



---

archive/issue_comments_087851.json:
```json
{
    "body": "<a id='comment:20'>Comment 20:</a>\nDespite being significantly faster, same result. ;-)",
    "created_at": "2010-09-09T22:53:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87851",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'>Comment 20:</a>
Despite being significantly faster, same result. ;-)



---

archive/issue_comments_087852.json:
```json
{
    "body": "<a id='comment:21'>Comment 21:</a>\n* 50 of 50 serial installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  After the last run, I ran the long doctests.  They pass.\n\n  * 50 of 50 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  However, 5 of the runs (not including the last) have the message `ranlib: 'libkernel_g.a': No such file`.  Is this a problem?  [Here's](http://sage.math.washington.edu/home/mpatel/trac/9733/singular-3-1-1-4-j20.log.6) a sample log file.  After the last run, I ran the long doctests.  They pass.  \n\n  * 25 of 25 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *disabled*.  None gives the ranlib message above.  I'll run the tests after the other 25 runs are done and add a comment if there are problems.\n\n  * Are the object files for `libcf.a`, `libsingcf_g.a`, `libfac.a`, and `libsingfac.a` built in parallel?\n\n  * Is the message `install:  libsingcf_p.a does not exist` harmless?  It's printed three times per install.\n\nI did all of the runs above under `/scratch`.",
    "created_at": "2010-09-10T01:22:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87852",
    "user": "https://github.com/qed777"
}
```

<a id='comment:21'>Comment 21:</a>
* 50 of 50 serial installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  After the last run, I ran the long doctests.  They pass.

  * 50 of 50 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  However, 5 of the runs (not including the last) have the message `ranlib: 'libkernel_g.a': No such file`.  Is this a problem?  [Here's](http://sage.math.washington.edu/home/mpatel/trac/9733/singular-3-1-1-4-j20.log.6) a sample log file.  After the last run, I ran the long doctests.  They pass.  

  * 25 of 25 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *disabled*.  None gives the ranlib message above.  I'll run the tests after the other 25 runs are done and add a comment if there are problems.

  * Are the object files for `libcf.a`, `libsingcf_g.a`, `libfac.a`, and `libsingfac.a` built in parallel?

  * Is the message `install:  libsingcf_p.a does not exist` harmless?  It's printed three times per install.

I did all of the runs above under `/scratch`.



---

archive/issue_comments_087853.json:
```json
{
    "body": "<a id='comment:22'>Comment 22:</a>\n> Is the message install: libsingcf_p.a does not exist harmless? It's printed three times per install.\n\nI see this in logs from older versions of singular, too, for what that's worth.",
    "created_at": "2010-09-10T03:40:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87853",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:22'>Comment 22:</a>
> Is the message install: libsingcf_p.a does not exist harmless? It's printed three times per install.

I see this in logs from older versions of singular, too, for what that's worth.



---

archive/issue_comments_087854.json:
```json
{
    "body": "<a id='comment:23'>Comment 23:</a>\nReplying to [@jhpalmieri](#comment%3A22):\n> > Is the message install: libsingcf_p.a does not exist harmless? It's printed three times per install.\n\n> \n> I see this in logs from older versions of singular, too, for what that's worth.\n> \n\nAnd it is not used by sage itself or macaulay2 as far as I know. I think that's old cruft in the Makefile.",
    "created_at": "2010-09-10T04:11:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87854",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:23'>Comment 23:</a>
Replying to [@jhpalmieri](#comment%3A22):
> > Is the message install: libsingcf_p.a does not exist harmless? It's printed three times per install.

> 
> I see this in logs from older versions of singular, too, for what that's worth.
> 

And it is not used by sage itself or macaulay2 as far as I know. I think that's old cruft in the Makefile.



---

archive/issue_comments_087855.json:
```json
{
    "body": "THis patch adresses ranlib issue of comment 21",
    "created_at": "2010-09-10T07:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87855",
    "user": "https://github.com/alexanderdreyer"
}
```

THis patch adresses ranlib issue of comment 21



---

archive/issue_comments_087856.json:
```json
{
    "body": "<a id='comment:24'>Comment 24:</a>\nAttachment: **[ranlib_libkernel.patch.gz](https://github.com/sagemath/sage/files/ticket9733/ranlib_libkernel.patch.gz)**\n\n> * 50 of 50 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  However, 5 of the runs (not including the last) have the message `ranlib: 'libkernel_g.a': No such file`.  Is this a problem?  [Here's](http://sage.math.washington.edu/home/mpatel/trac/9733/singular-3-1-1-4-j20.log.6) a sample log file.  After the last run, I ran the long doctests.  They pass.  \n\nI think I have fixed that issue, see the patche above and the new spkg at http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg (same place)\n\n> * Are the object files for `libcf.a`, `libsingcf_g.a`, `libfac.a`, and `libsingfac.a` built in parallel?\n\nFrom the Makefiles there's no restriction, so the dependencies of each of which can be build in parallel. But there may be dependencies, that that there is no parallel build in fact.\n\n> * Is the message `install:  libsingcf_p.a does not exist` harmless?  It's printed three times per install.\n> \n> I did all of the runs above under `/scratch`.\n\nAs fbissey said, this should not cause problems here.",
    "created_at": "2010-09-10T08:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87856",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:24'>Comment 24:</a>
Attachment: **[ranlib_libkernel.patch.gz](https://github.com/sagemath/sage/files/ticket9733/ranlib_libkernel.patch.gz)**

> * 50 of 50 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  However, 5 of the runs (not including the last) have the message `ranlib: 'libkernel_g.a': No such file`.  Is this a problem?  [Here's](http://sage.math.washington.edu/home/mpatel/trac/9733/singular-3-1-1-4-j20.log.6) a sample log file.  After the last run, I ran the long doctests.  They pass.  

I think I have fixed that issue, see the patche above and the new spkg at http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg (same place)

> * Are the object files for `libcf.a`, `libsingcf_g.a`, `libfac.a`, and `libsingfac.a` built in parallel?

From the Makefiles there's no restriction, so the dependencies of each of which can be build in parallel. But there may be dependencies, that that there is no parallel build in fact.

> * Is the message `install:  libsingcf_p.a does not exist` harmless?  It's printed three times per install.
> 
> I did all of the runs above under `/scratch`.

As fbissey said, this should not cause problems here.



---

archive/issue_comments_087857.json:
```json
{
    "body": "<a id='comment:25'>Comment 25:</a>\nReplying to [@alexanderdreyer](#comment%3A24):\n> > * 50 of 50 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  However, 5 of the runs (not including the last) have the message `ranlib: 'libkernel_g.a': No such file`.  Is this a problem?  [Here's](http://sage.math.washington.edu/home/mpatel/trac/9733/singular-3-1-1-4-j20.log.6) a sample log file.  After the last run, I ran the long doctests.  They pass.  \n\n> I think I have fixed that issue, see the patche above and the new spkg at http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg (same place)\n\nI repeated the three 50-run tests above.  The new package fixes the ranlib problem for me.\n\nCould you fix this:\n\n```sh\n$ hg stat\n? patches/kernel-Makefile.in.orig\n? spkg-install~\n```\n?",
    "created_at": "2010-09-11T06:08:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87857",
    "user": "https://github.com/qed777"
}
```

<a id='comment:25'>Comment 25:</a>
Replying to [@alexanderdreyer](#comment%3A24):
> > * 50 of 50 parallel installs of `singular-3-1-1-4.p1.spkg` succeed on sage.math with [ccache](http://ccache.samba.org/) *enabled*.  However, 5 of the runs (not including the last) have the message `ranlib: 'libkernel_g.a': No such file`.  Is this a problem?  [Here's](http://sage.math.washington.edu/home/mpatel/trac/9733/singular-3-1-1-4-j20.log.6) a sample log file.  After the last run, I ran the long doctests.  They pass.  

> I think I have fixed that issue, see the patche above and the new spkg at http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg (same place)

I repeated the three 50-run tests above.  The new package fixes the ranlib problem for me.

Could you fix this:

```sh
$ hg stat
? patches/kernel-Makefile.in.orig
? spkg-install~
```
?



---

archive/issue_comments_087858.json:
```json
{
    "body": "Reviewer: **Mitesh Patel**",
    "created_at": "2010-09-11T06:08:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87858",
    "user": "https://github.com/qed777"
}
```

Reviewer: **Mitesh Patel**



---

archive/issue_comments_087859.json:
```json
{
    "body": "<a id='comment:26'>Comment 26:</a>\nOk, I fixed this also. Is this a positive review then?",
    "created_at": "2010-09-12T21:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87859",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:26'>Comment 26:</a>
Ok, I fixed this also. Is this a positive review then?



---

archive/issue_comments_087860.json:
```json
{
    "body": "<a id='comment:27'>Comment 27:</a>\nCould you change the permissions so the package is accessible?\n\n```sh\n$ ls -l ~dreyer/spkg/singular-3-1-1-4.p1.spkg\n7.9M -rw-r----- 1 dreyer dreyer 7.8M 2010-09-12 14:14 /home/dreyer/spkg/singular-3-1-1-4.p1.spkg\n```",
    "created_at": "2010-09-12T21:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87860",
    "user": "https://github.com/qed777"
}
```

<a id='comment:27'>Comment 27:</a>
Could you change the permissions so the package is accessible?

```sh
$ ls -l ~dreyer/spkg/singular-3-1-1-4.p1.spkg
7.9M -rw-r----- 1 dreyer dreyer 7.8M 2010-09-12 14:14 /home/dreyer/spkg/singular-3-1-1-4.p1.spkg
```



---

archive/issue_comments_087861.json:
```json
{
    "body": "<a id='comment:28'>Comment 28:</a>\nOh, sorry! It readable now.",
    "created_at": "2010-09-13T07:23:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87861",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:28'>Comment 28:</a>
Oh, sorry! It readable now.



---

archive/issue_events_111121.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-13T07:39:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20build",
    "label_color": "000080",
    "label_name": "component: build",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111121"
}
```



---

archive/issue_events_111122.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-13T07:39:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20packages",
    "label_color": "000080",
    "label_name": "component: packages",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111122"
}
```



---

archive/issue_events_111123.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-13T07:39:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111123"
}
```



---

archive/issue_events_111124.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-13T07:39:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111124"
}
```



---

archive/issue_comments_087862.json:
```json
{
    "body": "<a id='comment:29'>Comment 29:</a>\nThanks!\n\n## Release manager\n\nMerge just this package:\n\n http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg",
    "created_at": "2010-09-13T07:39:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87862",
    "user": "https://github.com/qed777"
}
```

<a id='comment:29'>Comment 29:</a>
Thanks!

## Release manager

Merge just this package:

 http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg



---

archive/issue_events_111125.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-13T07:39:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "milestone_number": null,
    "milestone_title": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111125"
}
```



---

archive/issue_comments_087863.json:
```json
{
    "body": "<a id='comment:30'>Comment 30:</a>\nReplying to [@nexttime](#comment%3A17):\n> Unrelated:\n> * Any reason to look for `bison` (despite `--without-bison` btw.), but then hardcoding `bison` instead of using `@BISON@`?\n> * `CFLAGS` and `CXXFLAGS` are *partly* ignored. (Instead [only] `CPPFLAGS` are used for compiling C and C++ code.)\n\nShould we try to push these upstream?",
    "created_at": "2010-09-13T07:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87863",
    "user": "https://github.com/qed777"
}
```

<a id='comment:30'>Comment 30:</a>
Replying to [@nexttime](#comment%3A17):
> Unrelated:
> * Any reason to look for `bison` (despite `--without-bison` btw.), but then hardcoding `bison` instead of using `@BISON@`?
> * `CFLAGS` and `CXXFLAGS` are *partly* ignored. (Instead [only] `CPPFLAGS` are used for compiling C and C++ code.)

Should we try to push these upstream?



---

archive/issue_comments_087864.json:
```json
{
    "body": "Changed reviewer from **Mitesh Patel** to **Mitesh Patel, Leif Leonhardy**",
    "created_at": "2010-09-13T07:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87864",
    "user": "https://github.com/qed777"
}
```

Changed reviewer from **Mitesh Patel** to **Mitesh Patel, Leif Leonhardy**



---

archive/issue_comments_087865.json:
```json
{
    "body": "<a id='comment:31'>Comment 31:</a>\nSure, I can report this to Singular's trac.\n\nThe bison issue is - at least - confusion. For the flags, I need some additional information; The meaning (and names) of flags highly depend on the build system of a given software. So, each spkg-maintainer does need this knowledge for the system he/she maintains anyway. But `CFLAGS` and `CXXFLAGS` would be more standard-conforming, right?\n\nBTW Singular compiles a lot of C-like code using the C++ compiler. This may result in the observation, that the `CFLAGS` were ignored.",
    "created_at": "2010-09-13T08:00:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87865",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:31'>Comment 31:</a>
Sure, I can report this to Singular's trac.

The bison issue is - at least - confusion. For the flags, I need some additional information; The meaning (and names) of flags highly depend on the build system of a given software. So, each spkg-maintainer does need this knowledge for the system he/she maintains anyway. But `CFLAGS` and `CXXFLAGS` would be more standard-conforming, right?

BTW Singular compiles a lot of C-like code using the C++ compiler. This may result in the observation, that the `CFLAGS` were ignored.



---

archive/issue_comments_087866.json:
```json
{
    "body": "<a id='comment:32'>Comment 32:</a>\nReplying to [@qed777](#comment%3A30):\n> Replying to [@nexttime](#comment%3A17):\n> > Unrelated:\n> > * Any reason to look for `bison` (despite `--without-bison` btw.), but then hardcoding `bison` instead of using `@BISON@`?\n> > \n> > * `CFLAGS` and `CXXFLAGS` are *partly* ignored. (Instead [only] `CPPFLAGS` are used for compiling C and C++ code.)\n\n> \n> Should we try to push these upstream?\n\nThat's why I mentioned it here, considering Alexander upstream (or at least an upstream proxy)... ;-)",
    "created_at": "2010-09-13T09:47:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87866",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:32'>Comment 32:</a>
Replying to [@qed777](#comment%3A30):
> Replying to [@nexttime](#comment%3A17):
> > Unrelated:
> > * Any reason to look for `bison` (despite `--without-bison` btw.), but then hardcoding `bison` instead of using `@BISON@`?
> > 
> > * `CFLAGS` and `CXXFLAGS` are *partly* ignored. (Instead [only] `CPPFLAGS` are used for compiling C and C++ code.)

> 
> Should we try to push these upstream?

That's why I mentioned it here, considering Alexander upstream (or at least an upstream proxy)... ;-)



---

archive/issue_comments_087867.json:
```json
{
    "body": "<a id='comment:33'>Comment 33:</a>\nReplying to [@alexanderdreyer](#comment%3A31):\n> Sure, I can report this to Singular's trac.\n\nThanks, that would be nice.\n\n> [...] For the flags, I need some additional information; The meaning (and names) of flags highly depend on the build system of a given software.\n\nThe names shouldn't, they're standard. *How* a package uses them might differ, i.e. *some* flags might intentionally get overridden, but they should never be ignored. Also, some packages won't e.g. use `LDFLAGS` because they use `libtool` or use the C compiler driver for linking.\n \n> So, each spkg-maintainer does need this knowledge for the system he/she maintains anyway.\n\nI agree an spkg maintainer should know the upstream's build process... ;-)\n\n> But `CFLAGS` and `CXXFLAGS` would be more standard-conforming, right?\n\n? If this refers to (the use of) `CPPFLAGS`, these are the flags for the C preprocessor, `cpp`. The preprocessor is rarely used directly, but in the other case one should either pass them directly to the compiler driver as well, or e.g. prepend them to `CFLAGS` and `CXXFLAGS`.\n\n> BTW Singular compiles a lot of C-like code using the C++ compiler. This may result in the observation, that the `CFLAGS` were ignored.\n\nI haven't noticed that (but haven't inspected that either).\n\nIn that case, `CXXFLAGS` should have been used (when compiling C code with e.g. `g++`), but that's not the case. I can give more details on which files were compiled only using `CPPFLAGS` later. (To see which flags are actually used, simply `export CFLAGS=-DHONORS_CFLAGS` etc.)",
    "created_at": "2010-09-13T10:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87867",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:33'>Comment 33:</a>
Replying to [@alexanderdreyer](#comment%3A31):
> Sure, I can report this to Singular's trac.

Thanks, that would be nice.

> [...] For the flags, I need some additional information; The meaning (and names) of flags highly depend on the build system of a given software.

The names shouldn't, they're standard. *How* a package uses them might differ, i.e. *some* flags might intentionally get overridden, but they should never be ignored. Also, some packages won't e.g. use `LDFLAGS` because they use `libtool` or use the C compiler driver for linking.
 
> So, each spkg-maintainer does need this knowledge for the system he/she maintains anyway.

I agree an spkg maintainer should know the upstream's build process... ;-)

> But `CFLAGS` and `CXXFLAGS` would be more standard-conforming, right?

? If this refers to (the use of) `CPPFLAGS`, these are the flags for the C preprocessor, `cpp`. The preprocessor is rarely used directly, but in the other case one should either pass them directly to the compiler driver as well, or e.g. prepend them to `CFLAGS` and `CXXFLAGS`.

> BTW Singular compiles a lot of C-like code using the C++ compiler. This may result in the observation, that the `CFLAGS` were ignored.

I haven't noticed that (but haven't inspected that either).

In that case, `CXXFLAGS` should have been used (when compiling C code with e.g. `g++`), but that's not the case. I can give more details on which files were compiled only using `CPPFLAGS` later. (To see which flags are actually used, simply `export CFLAGS=-DHONORS_CFLAGS` etc.)



---

archive/issue_comments_087868.json:
```json
{
    "body": "<a id='comment:34'>Comment 34:</a>\nNow I understand: there are *compiled* targets in Singular, for instance the .og files, which do obey `CPPFLAGS`, but neither `CFLAGS` not `CXXFLAGS`.\nI think, these files are intentionally compiled with other options than \"ordinary\" targets. For the .og files there is a `CXXFLAGSG` in the `Makefile.in`, but it is not managed by the `./configure` script.\n\nIs there a best practice for such special targets?",
    "created_at": "2010-09-13T11:20:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87868",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:34'>Comment 34:</a>
Now I understand: there are *compiled* targets in Singular, for instance the .og files, which do obey `CPPFLAGS`, but neither `CFLAGS` not `CXXFLAGS`.
I think, these files are intentionally compiled with other options than "ordinary" targets. For the .og files there is a `CXXFLAGSG` in the `Makefile.in`, but it is not managed by the `./configure` script.

Is there a best practice for such special targets?



---

archive/issue_comments_087869.json:
```json
{
    "body": "<a id='comment:35'>Comment 35:</a>\nFor the purpose of Sage (I think) we should anyway compile with `-g` (and not build the \"special\" targets).\n\n`CXXFLAGSG` should perhaps simply be `\"$CXXFLAGS -g\"` (or `-g` replaced by the appropriate option, depending on the compiler used), if `CXXFLAGS` do not already contain that. Otherwise one could drop the \".og\" targets, or just build those; a matter of taste.\n\nIf nothing else than adding debug symbols differentiates the normal targets from their \".og\" versions, one should simply build **once** *with* debug symbols, copy the generated files, and create \"non-.og\" versions by stripping the made copies, then installing both (if requested).\n\nI haven't yet looked at the sources (`configure`, `Makefile.in` etc.) though.",
    "created_at": "2010-09-13T13:08:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87869",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:35'>Comment 35:</a>
For the purpose of Sage (I think) we should anyway compile with `-g` (and not build the "special" targets).

`CXXFLAGSG` should perhaps simply be `"$CXXFLAGS -g"` (or `-g` replaced by the appropriate option, depending on the compiler used), if `CXXFLAGS` do not already contain that. Otherwise one could drop the ".og" targets, or just build those; a matter of taste.

If nothing else than adding debug symbols differentiates the normal targets from their ".og" versions, one should simply build **once** *with* debug symbols, copy the generated files, and create "non-.og" versions by stripping the made copies, then installing both (if requested).

I haven't yet looked at the sources (`configure`, `Makefile.in` etc.) though.



---

archive/issue_comments_087870.json:
```json
{
    "body": "<a id='comment:36'>Comment 36:</a>\n> If nothing else than adding debug symbols differentiates the normal targets from their \".og\" versions, one should simply build **once** *with* debug symbols, copy the generated files, and create \"non-.og\" versions by stripping the made copies, then installing both (if requested).\n\nUnfortunately it's not that easy. Singular's debug version is build via completely different targets. This might change somewhen in the (hopefully) not to far future. (This would obsolete our `CPPFLAGS` issue here also.)",
    "created_at": "2010-09-13T13:23:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87870",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:36'>Comment 36:</a>
> If nothing else than adding debug symbols differentiates the normal targets from their ".og" versions, one should simply build **once** *with* debug symbols, copy the generated files, and create "non-.og" versions by stripping the made copies, then installing both (if requested).

Unfortunately it's not that easy. Singular's debug version is build via completely different targets. This might change somewhen in the (hopefully) not to far future. (This would obsolete our `CPPFLAGS` issue here also.)



---

archive/issue_comments_087871.json:
```json
{
    "body": "<a id='comment:37'>Comment 37:</a>\nUpstream reports:\n\n* http://www.singular.uni-kl.de:8002/trac/ticket/269\n* http://www.singular.uni-kl.de:8002/trac/ticket/270",
    "created_at": "2010-09-13T13:59:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87871",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:37'>Comment 37:</a>
Upstream reports:

* http://www.singular.uni-kl.de:8002/trac/ticket/269
* http://www.singular.uni-kl.de:8002/trac/ticket/270



---

archive/issue_comments_087872.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,3 +7,8 @@\n svn diff -r 13112:13110 http://www.singular.uni-kl.de/svn/\n ```\n \n+## Release manager\n+Merge just this package:\n+\n+  http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg\n+\n``````\n",
    "created_at": "2010-09-13T14:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87872",
    "user": "https://github.com/alexanderdreyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,3 +7,8 @@
 svn diff -r 13112:13110 http://www.singular.uni-kl.de/svn/
 ```
 
+## Release manager
+Merge just this package:
+
+  http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg
+
``````




---

archive/issue_comments_087873.json:
```json
{
    "body": "<a id='comment:39'>Comment 39:</a>\nFirst responde: the option `--without-bison` is not a valid option of Singular's `./configure` (See `./configure --help`). Bison is not used in the normal build process. (The Singular sources already include the processed files.)",
    "created_at": "2010-09-13T21:12:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87873",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:39'>Comment 39:</a>
First responde: the option `--without-bison` is not a valid option of Singular's `./configure` (See `./configure --help`). Bison is not used in the normal build process. (The Singular sources already include the processed files.)



---

archive/issue_comments_087874.json:
```json
{
    "body": "Merged: **sage-4.6.alpha1**",
    "created_at": "2010-09-16T00:48:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87874",
    "user": "https://github.com/qed777"
}
```

Merged: **sage-4.6.alpha1**



---

archive/issue_events_111126.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-16T00:48:42Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111126"
}
```



---

archive/issue_events_111127.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-16T00:48:42Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111127"
}
```



---

archive/issue_comments_087875.json:
```json
{
    "body": "<a id='comment:41'>Comment 41:</a>\nDespite this being closed as fixed, this has failed for me on OpenSolaris 06/2009, with a missing header file, which would indicate the problem has not been solved. I suggest you might want to revisit this. \n\nI'm attaching a log. \n\nDave",
    "created_at": "2010-09-17T07:27:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87875",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:41'>Comment 41:</a>
Despite this being closed as fixed, this has failed for me on OpenSolaris 06/2009, with a missing header file, which would indicate the problem has not been solved. I suggest you might want to revisit this. 

I'm attaching a log. 

Dave



---

archive/issue_comments_087876.json:
```json
{
    "body": "Attachment: **[singular-3-1-1-4.p1.log](https://github.com/sagemath/sage/files/ticket9733/singular-3-1-1-4.p1.log)**\n\nLog of a failed build on a Sun Ultra 27 (4 cores, hyperthreaded), using MAKKE=\"make -j12\"",
    "created_at": "2010-09-17T07:28:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87876",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Attachment: **[singular-3-1-1-4.p1.log](https://github.com/sagemath/sage/files/ticket9733/singular-3-1-1-4.p1.log)**

Log of a failed build on a Sun Ultra 27 (4 cores, hyperthreaded), using MAKKE="make -j12"



---

archive/issue_comments_087877.json:
```json
{
    "body": "<a id='comment:42'>Comment 42:</a>\nDave, thanks for reporting this problem.  Could someone please investigate it?  I'll \"unmerge\" this ticket from 4.6.alpha1, unless there's a positively reviewed fix within about a day or so.  I'm also waiting for a response to a build error at #4000.",
    "created_at": "2010-09-17T08:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87877",
    "user": "https://github.com/qed777"
}
```

<a id='comment:42'>Comment 42:</a>
Dave, thanks for reporting this problem.  Could someone please investigate it?  I'll "unmerge" this ticket from 4.6.alpha1, unless there's a positively reviewed fix within about a day or so.  I'm also waiting for a response to a build error at #4000.



---

archive/issue_events_111128.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-17T08:30:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111128"
}
```



---

archive/issue_comments_087878.json:
```json
{
    "body": "<a id='comment:43'>Comment 43:</a>\nThe patch I just posted has unforseen issues, so don't use it.",
    "created_at": "2010-09-17T11:27:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87878",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:43'>Comment 43:</a>
The patch I just posted has unforseen issues, so don't use it.



---

archive/issue_comments_087879.json:
```json
{
    "body": "Attachment: **[singular-3.1.1.4-parrallelmake-2.patch.gz](https://github.com/sagemath/sage/files/ticket9733/singular-3.1.1.4-parrallelmake-2.patch.gz)**\n\ntentative patch for the latest parallel make issue (bis repetitas)",
    "created_at": "2010-09-17T11:47:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87879",
    "user": "https://github.com/kiwifb"
}
```

Attachment: **[singular-3.1.1.4-parrallelmake-2.patch.gz](https://github.com/sagemath/sage/files/ticket9733/singular-3.1.1.4-parrallelmake-2.patch.gz)**

tentative patch for the latest parallel make issue (bis repetitas)



---

archive/issue_comments_087880.json:
```json
{
    "body": "<a id='comment:44'>Comment 44:</a>\nDave, can you test Fran\u00e7ois' latest patch? It cannot confirm it solves \"your\" problem (though it should).",
    "created_at": "2010-09-17T12:20:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87880",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:44'>Comment 44:</a>
Dave, can you test Fran√ßois' latest patch? It cannot confirm it solves "your" problem (though it should).



---

archive/issue_comments_087881.json:
```json
{
    "body": "<a id='comment:45'>Comment 45:</a>\nReplying to [@nexttime](#comment%3A44):\n> Dave, can you test Fran\u00e7ois' latest patch? It cannot confirm it solves \"your\" problem (though it should).\n\nI was in the process of answering. It has to be applied after SingularSvn13111-13112.patch because it touches a neighboring area of code.",
    "created_at": "2010-09-17T12:22:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87881",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:45'>Comment 45:</a>
Replying to [@nexttime](#comment%3A44):
> Dave, can you test Fran√ßois' latest patch? It cannot confirm it solves "your" problem (though it should).

I was in the process of answering. It has to be applied after SingularSvn13111-13112.patch because it touches a neighboring area of code.



---

archive/issue_comments_087882.json:
```json
{
    "body": "<a id='comment:46'>Comment 46:</a>\nWorks for me with `make -j` (unlimited). I've in addition changed the rule for `libsingcf_p.a`, but this might be superfluous.",
    "created_at": "2010-09-17T12:56:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87882",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:46'>Comment 46:</a>
Works for me with `make -j` (unlimited). I've in addition changed the rule for `libsingcf_p.a`, but this might be superfluous.



---

archive/issue_comments_087883.json:
```json
{
    "body": "<a id='comment:47'>Comment 47:</a>\n(We do not build `libsingcf_p.a`.)\n\nThere are however race conditions (?) in deleting files and directories:\n\n```\ncd ftest && make -j distclean\nmake[1]: Entering directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'\nrm -f commonden degree deriv divides divrem extgcd factorize fbinops feval gcd gcd.ntl insert norm resultant revert sqrfree size totaldegree commonden.cc degree.cc deriv.cc divides.cc divrem.cc extgcd.cc factorize.cc fbinops.cc feval.cc gcd.cc gcd.ntl.cc insert.cc norm.cc resultant.cc revert.cc sqrfree.cc size.cc totaldegree.cc *.o\nrm -f GNUmakefile\nmake[1]: Leaving directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'\nrmdir ftest\nrmdir: failed to remove `ftest': Directory not empty\nmake: [ftestdistclean] Error 1 (ignored)\ncd ftest && make -j clean\nmake[1]: Entering directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'\nmake[1]: *** No rule to make target `clean'.  Stop.\nmake[1]: Leaving directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'\nmake: [ftestclean] Error 2 (ignored)\n```\nOr perhaps just the list of files isn't complete.\n\nThough ignored, should probably be fixed upstream, too.",
    "created_at": "2010-09-17T13:10:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87883",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:47'>Comment 47:</a>
(We do not build `libsingcf_p.a`.)

There are however race conditions (?) in deleting files and directories:

```
cd ftest && make -j distclean
make[1]: Entering directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'
rm -f commonden degree deriv divides divrem extgcd factorize fbinops feval gcd gcd.ntl insert norm resultant revert sqrfree size totaldegree commonden.cc degree.cc deriv.cc divides.cc divrem.cc extgcd.cc factorize.cc fbinops.cc feval.cc gcd.cc gcd.ntl.cc insert.cc norm.cc resultant.cc revert.cc sqrfree.cc size.cc totaldegree.cc *.o
rm -f GNUmakefile
make[1]: Leaving directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'
rmdir ftest
rmdir: failed to remove `ftest': Directory not empty
make: [ftestdistclean] Error 1 (ignored)
cd ftest && make -j clean
make[1]: Entering directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'
make[1]: *** No rule to make target `clean'.  Stop.
make[1]: Leaving directory `/home/leif/Sage/sage-4.6.alpha1/spkg/build/singular-3-1-1-4.p1-new/src/factory/ftest'
make: [ftestclean] Error 2 (ignored)
```
Or perhaps just the list of files isn't complete.

Though ignored, should probably be fixed upstream, too.



---

archive/issue_comments_087884.json:
```json
{
    "body": "Another missing dependency",
    "created_at": "2010-09-17T13:17:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87884",
    "user": "https://github.com/alexanderdreyer"
}
```

Another missing dependency



---

archive/issue_comments_087885.json:
```json
{
    "body": "<a id='comment:48'>Comment 48:</a>\nAttachment: **[factory-GNUmakefile.in.patch.gz](https://github.com/sagemath/sage/files/ticket9733/factory-GNUmakefile.in.patch.gz)**\n\nI attached another patch, which should fix this issue.\nThe spkg is here:\nhttp://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg",
    "created_at": "2010-09-17T13:20:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87885",
    "user": "https://github.com/alexanderdreyer"
}
```

<a id='comment:48'>Comment 48:</a>
Attachment: **[factory-GNUmakefile.in.patch.gz](https://github.com/sagemath/sage/files/ticket9733/factory-GNUmakefile.in.patch.gz)**

I attached another patch, which should fix this issue.
The spkg is here:
http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg



---

archive/issue_comments_087886.json:
```json
{
    "body": "<a id='comment:49'>Comment 49:</a>\nReplying to [@alexanderdreyer](#comment%3A48):\n> I attached another patch, which should fix this issue.\n> The spkg is here:\n> http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg\n\nWorks for me as well (`make -j`).",
    "created_at": "2010-09-17T13:40:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87886",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:49'>Comment 49:</a>
Replying to [@alexanderdreyer](#comment%3A48):
> I attached another patch, which should fix this issue.
> The spkg is here:
> http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg

Works for me as well (`make -j`).



---

archive/issue_comments_087887.json:
```json
{
    "body": "<a id='comment:50'>Comment 50:</a>\nAnd all changes committed... :)",
    "created_at": "2010-09-17T13:41:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87887",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:50'>Comment 50:</a>
And all changes committed... :)



---

archive/issue_events_111129.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-17T13:59:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111129"
}
```



---

archive/issue_events_111130.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-17T13:59:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111130"
}
```



---

archive/issue_comments_087888.json:
```json
{
    "body": "<a id='comment:52'>Comment 52:</a>\nI'm building this in a loop 100 times. I'll let you know if it fails at all\n\nDave",
    "created_at": "2010-09-17T15:20:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87888",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:52'>Comment 52:</a>
I'm building this in a loop 100 times. I'll let you know if it fails at all

Dave



---

archive/issue_comments_087889.json:
```json
{
    "body": "<a id='comment:53'>Comment 53:</a>\nThis is looking good. Built this package 50 times so far without failure. \n\nShould have 100 done in about 1 hour and 20 minutes from now. \n\nDave",
    "created_at": "2010-09-17T17:11:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87889",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:53'>Comment 53:</a>
This is looking good. Built this package 50 times so far without failure. 

Should have 100 done in about 1 hour and 20 minutes from now. 

Dave



---

archive/issue_comments_087890.json:
```json
{
    "body": "<a id='comment:54'>Comment 54:</a>\nI've now built this 110 times, on the following hardware: \n\n* Sun Ultra 27\n* 3.33 GHz Intel Xeon processor\n* 12 GB RAM\n* OpenSolaris 06/2009. \n* Local hard drives using 128-bit ZFS file system. \n\nThe method used was: \n\n* Use 4 previous builds of Sage (different, but fairly recent versions)\n* Copied the `singular-3-1-1-4.p2.spkg` package to `$SAGE_ROOT/spkg/standard`\n* Created a script to run ` sage -f singular-3-1-1-4.p2.spkg`\n* set MAKE=\"make -j2\" in one directory\n* set MAKE=\"make -j12\" in two different directories. \n* set MAKE=\"make -j30\" in another directory. \n\nI did *'not*\n* Test the package with `SAGE_CHECK=yes`\n* Run any doctests. \n\nSo at any one time, 4 builds of singular would take place, each in parallel, with either 2, 12 or 30 threads. The load average of the machine changed from around 9 to 11, but averaged about 10.  Each build took just over 6 minutes, but since 4 builds were taking place in parallel, this was an average build time of about 1.5 minutes/build. \n\nSo there does not appear to be any parallel build issues. \n\nSo positive review.",
    "created_at": "2010-09-17T18:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87890",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<a id='comment:54'>Comment 54:</a>
I've now built this 110 times, on the following hardware: 

* Sun Ultra 27
* 3.33 GHz Intel Xeon processor
* 12 GB RAM
* OpenSolaris 06/2009. 
* Local hard drives using 128-bit ZFS file system. 

The method used was: 

* Use 4 previous builds of Sage (different, but fairly recent versions)
* Copied the `singular-3-1-1-4.p2.spkg` package to `$SAGE_ROOT/spkg/standard`
* Created a script to run ` sage -f singular-3-1-1-4.p2.spkg`
* set MAKE="make -j2" in one directory
* set MAKE="make -j12" in two different directories. 
* set MAKE="make -j30" in another directory. 

I did *'not*
* Test the package with `SAGE_CHECK=yes`
* Run any doctests. 

So at any one time, 4 builds of singular would take place, each in parallel, with either 2, 12 or 30 threads. The load average of the machine changed from around 9 to 11, but averaged about 10.  Each build took just over 6 minutes, but since 4 builds were taking place in parallel, this was an average build time of about 1.5 minutes/build. 

So there does not appear to be any parallel build issues. 

So positive review.



---

archive/issue_comments_087891.json:
```json
{
    "body": "Changed reviewer from **Mitesh Patel, Leif Leonhardy** to **Mitesh Patel, Leif Leonhardy, David Kirkby**",
    "created_at": "2010-09-17T18:46:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87891",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

Changed reviewer from **Mitesh Patel, Leif Leonhardy** to **Mitesh Patel, Leif Leonhardy, David Kirkby**



---

archive/issue_events_111131.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-09-17T18:46:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111131"
}
```



---

archive/issue_events_111132.json:
```json
{
    "actor": "https://github.com/sagetrac-drkirkby",
    "created_at": "2010-09-17T18:46:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111132"
}
```



---

archive/issue_comments_087892.json:
```json
{
    "body": "<a id='comment:55'>Comment 55:</a>\nHope you don't spend the weekend reading the build logs... ;-)",
    "created_at": "2010-09-17T19:02:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87892",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:55'>Comment 55:</a>
Hope you don't spend the weekend reading the build logs... ;-)



---

archive/issue_comments_087893.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,5 +10,5 @@\n ## Release manager\n Merge just this package:\n \n-  http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg\n+ http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg\n \n``````\n",
    "created_at": "2010-09-17T21:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87893",
    "user": "https://github.com/qed777"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,5 +10,5 @@
 ## Release manager
 Merge just this package:
 
-  http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p1.spkg
+ http://sage.math.washington.edu/home/dreyer/spkg/singular-3-1-1-4.p2.spkg
 
``````




---

archive/issue_events_111133.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-17T21:32:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111133"
}
```



---

archive/issue_events_111134.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-17T21:32:29Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9733#event-111134"
}
```



---

archive/issue_comments_087894.json:
```json
{
    "body": "<a id='comment:56'>Comment 56:</a>\nMany thanks to everyone for reporting, patching, reviewing, and testing.  I apologize for not having caught this problem.",
    "created_at": "2010-09-17T21:32:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87894",
    "user": "https://github.com/qed777"
}
```

<a id='comment:56'>Comment 56:</a>
Many thanks to everyone for reporting, patching, reviewing, and testing.  I apologize for not having caught this problem.



---

archive/issue_comments_087895.json:
```json
{
    "body": "<a id='comment:57'>Comment 57:</a>\nWould you believe it. I committed the latest patch to the sage-on-gentoo tree 3 hours ago and 1 hour ago about one of our users reported a new parallel make failure at -j2 on x86.... in libfac this time.\n\n```\nar cr libsingcf_g.a canonicalform.og cf_algorithm.og cf_binom.og cf_char.og cf_chinese.og cf_cyclo.og cf_eval.og cf_factor.og cf_factory.og cf_gcd.og cf_gcd_charp.og cf_gcd_smallp.og cf_generator.og cf_globals.og cf_inline.og cf_irred.og cf_iter.og cf_iter_inline.og cf_linsys.og cf_map.og cf_map_ext.og cf_ops.og cf_primes.og cf_random.og cf_resultant.og cf_reval.og cf_switches.og cf_util.og debug.og DegreePattern.og ExtensionInfo.og fac_berlekamp.og fac_cantzass.og fac_distrib.og fac_ezgcd.og fac_iterfor.og fac_multihensel.og fac_multivar.og fac_sqrfree.og fac_univar.og fac_util.og facFqBivar.og facFqBivarUtil.og facFqFactorize.og facFqFactorizeUtil.og facFqSquarefree.og facHensel.og fieldGCD.og ffops.og ffreval.og gf_tabutil.og gfops.og imm.og initgmp.og int_cf.og int_int.og int_intdiv.og int_poly.og int_pp.og int_rat.og sm_sparsemod.og sm_util.og variable.og NTLconvert.og abs_fac.og bifac.og lgs.og singext.og\nranlib libsingcf_g.a\nar cr libsingcf.a canonicalform.o cf_algorithm.o cf_binom.o cf_char.o cf_chinese.o cf_cyclo.o cf_eval.o cf_factor.o cf_factory.o cf_gcd.o cf_gcd_charp.o cf_gcd_smallp.o cf_generator.o cf_globals.o cf_inline.o cf_irred.o cf_iter.o cf_iter_inline.o cf_linsys.o cf_map.o cf_map_ext.o cf_ops.o cf_primes.o cf_random.o cf_resultant.o cf_reval.o cf_switches.o cf_util.o debug.o DegreePattern.o ExtensionInfo.o fac_berlekamp.o fac_cantzass.o fac_distrib.o fac_ezgcd.o fac_iterfor.o fac_multihensel.o fac_multivar.o fac_sqrfree.o fac_univar.o fac_util.o facFqBivar.o facFqBivarUtil.o facFqFactorize.o facFqFactorizeUtil.o facFqSquarefree.o facHensel.o fieldGCD.o ffops.o ffreval.o gf_tabutil.o gfops.o imm.o initgmp.o int_cf.o int_int.o int_intdiv.o int_poly.o int_pp.o int_rat.o sm_sparsemod.o sm_util.o variable.o NTLconvert.o abs_fac.o bifac.o lgs.o singext.o\nranlib libsingcf.a\n./bin/mkinstalldirs /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib\n./bin/mkinstalldirs /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include\n./bin/mkinstalldirs /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates\nmkdir /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates\n./bin/install-sh -c -m 644 libsingcf.a /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf.a\n./bin/install-sh -c -m 644 libsingcf_g.a /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf_g.a\n./bin/install-sh -c -m 644 libsingcf_p.a /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf_p.a\ninstall:  libsingcf_p.a does not exist\nmake[2]: [installcf] Error 1 (ignored)\n./bin/install-sh -c -m 644 factory.h /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/factory.h\n./bin/install-sh -c -m 644 cf_gmp.h /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/cf_gmp.h\n./bin/install-sh -c -m 644 factoryconf.h /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/factoryconf.h\n./bin/install-sh -c -m 644 ./ftmpl_inst.cc /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates/ftmpl_inst.cc\nfor file in ftmpl_array.cc ftmpl_factor.cc ftmpl_functions.h ftmpl_list.cc ftmpl_matrix.cc ftmpl_array.h ftmpl_factor.h ftmpl_list.h ftmpl_matrix.h; do \\\n\t\t  ./bin/install-sh -c -m 644 ./templates/$file /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates/$file; \\\n\t\tdone\nranlib /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf.a\nmake[2]: Leaving directory `/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/factory'\nmake install in libfac\nmake[2]: Entering directory `/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/libfac'\n./mkinstalldirs OPTOBJ\ni686-pc-linux-gnu-g++ -O2 -march=athlon-xp -msse2 -pipe -fomit-frame-pointer -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include   -DHAVE_CONFIG_H  -c factor/SqrFree.cc -o OPTOBJ/SqrFree.o\nmkdir OPTOBJ\nAssembler messages:\nFatal error: can't create OPTOBJ/SqrFree.o: No such file or directory\ni686-pc-linux-gnu-g++ -O2 -march=athlon-xp -msse2 -pipe -fomit-frame-pointer -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include   -DHAVE_CONFIG_H  -c factor/Factor.cc -o OPTOBJ/Factor.o\nmake[2]: *** [OPTOBJ/SqrFree.o] Error 2\nmake[2]: *** Waiting for unfinished jobs....\nmake[2]: Leaving directory `/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/libfac'\nmake[1]: *** [install] Error 1\n```\n\nI have a fix for him to try, I'll report back when I know the fix works for him.",
    "created_at": "2010-09-19T02:03:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87895",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:57'>Comment 57:</a>
Would you believe it. I committed the latest patch to the sage-on-gentoo tree 3 hours ago and 1 hour ago about one of our users reported a new parallel make failure at -j2 on x86.... in libfac this time.

```
ar cr libsingcf_g.a canonicalform.og cf_algorithm.og cf_binom.og cf_char.og cf_chinese.og cf_cyclo.og cf_eval.og cf_factor.og cf_factory.og cf_gcd.og cf_gcd_charp.og cf_gcd_smallp.og cf_generator.og cf_globals.og cf_inline.og cf_irred.og cf_iter.og cf_iter_inline.og cf_linsys.og cf_map.og cf_map_ext.og cf_ops.og cf_primes.og cf_random.og cf_resultant.og cf_reval.og cf_switches.og cf_util.og debug.og DegreePattern.og ExtensionInfo.og fac_berlekamp.og fac_cantzass.og fac_distrib.og fac_ezgcd.og fac_iterfor.og fac_multihensel.og fac_multivar.og fac_sqrfree.og fac_univar.og fac_util.og facFqBivar.og facFqBivarUtil.og facFqFactorize.og facFqFactorizeUtil.og facFqSquarefree.og facHensel.og fieldGCD.og ffops.og ffreval.og gf_tabutil.og gfops.og imm.og initgmp.og int_cf.og int_int.og int_intdiv.og int_poly.og int_pp.og int_rat.og sm_sparsemod.og sm_util.og variable.og NTLconvert.og abs_fac.og bifac.og lgs.og singext.og
ranlib libsingcf_g.a
ar cr libsingcf.a canonicalform.o cf_algorithm.o cf_binom.o cf_char.o cf_chinese.o cf_cyclo.o cf_eval.o cf_factor.o cf_factory.o cf_gcd.o cf_gcd_charp.o cf_gcd_smallp.o cf_generator.o cf_globals.o cf_inline.o cf_irred.o cf_iter.o cf_iter_inline.o cf_linsys.o cf_map.o cf_map_ext.o cf_ops.o cf_primes.o cf_random.o cf_resultant.o cf_reval.o cf_switches.o cf_util.o debug.o DegreePattern.o ExtensionInfo.o fac_berlekamp.o fac_cantzass.o fac_distrib.o fac_ezgcd.o fac_iterfor.o fac_multihensel.o fac_multivar.o fac_sqrfree.o fac_univar.o fac_util.o facFqBivar.o facFqBivarUtil.o facFqFactorize.o facFqFactorizeUtil.o facFqSquarefree.o facHensel.o fieldGCD.o ffops.o ffreval.o gf_tabutil.o gfops.o imm.o initgmp.o int_cf.o int_int.o int_intdiv.o int_poly.o int_pp.o int_rat.o sm_sparsemod.o sm_util.o variable.o NTLconvert.o abs_fac.o bifac.o lgs.o singext.o
ranlib libsingcf.a
./bin/mkinstalldirs /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib
./bin/mkinstalldirs /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include
./bin/mkinstalldirs /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates
mkdir /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates
./bin/install-sh -c -m 644 libsingcf.a /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf.a
./bin/install-sh -c -m 644 libsingcf_g.a /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf_g.a
./bin/install-sh -c -m 644 libsingcf_p.a /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf_p.a
install:  libsingcf_p.a does not exist
make[2]: [installcf] Error 1 (ignored)
./bin/install-sh -c -m 644 factory.h /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/factory.h
./bin/install-sh -c -m 644 cf_gmp.h /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/cf_gmp.h
./bin/install-sh -c -m 644 factoryconf.h /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/factoryconf.h
./bin/install-sh -c -m 644 ./ftmpl_inst.cc /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates/ftmpl_inst.cc
for file in ftmpl_array.cc ftmpl_factor.cc ftmpl_functions.h ftmpl_list.cc ftmpl_matrix.cc ftmpl_array.h ftmpl_factor.h ftmpl_list.h ftmpl_matrix.h; do \
		  ./bin/install-sh -c -m 644 ./templates/$file /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include/templates/$file; \
		done
ranlib /var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/lib/libsingcf.a
make[2]: Leaving directory `/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/factory'
make install in libfac
make[2]: Entering directory `/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/libfac'
./mkinstalldirs OPTOBJ
i686-pc-linux-gnu-g++ -O2 -march=athlon-xp -msse2 -pipe -fomit-frame-pointer -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include   -DHAVE_CONFIG_H  -c factor/SqrFree.cc -o OPTOBJ/SqrFree.o
mkdir OPTOBJ
Assembler messages:
Fatal error: can't create OPTOBJ/SqrFree.o: No such file or directory
i686-pc-linux-gnu-g++ -O2 -march=athlon-xp -msse2 -pipe -fomit-frame-pointer -fPIC -fno-implicit-templates -I./factor -I./charset -I. -I./factor -I/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/build/include   -DHAVE_CONFIG_H  -c factor/Factor.cc -o OPTOBJ/Factor.o
make[2]: *** [OPTOBJ/SqrFree.o] Error 2
make[2]: *** Waiting for unfinished jobs....
make[2]: Leaving directory `/var/tmp/portage/sci-mathematics/singular-3.1.1.4-r1/work/Singular-3-1-1/libfac'
make[1]: *** [install] Error 1
```

I have a fix for him to try, I'll report back when I know the fix works for him.



---

archive/issue_comments_087896.json:
```json
{
    "body": "fixing parallel make issue in libfac",
    "created_at": "2010-09-19T03:11:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87896",
    "user": "https://github.com/kiwifb"
}
```

fixing parallel make issue in libfac



---

archive/issue_comments_087897.json:
```json
{
    "body": "<a id='comment:58'>Comment 58:</a>\nAttachment: **[singular-3.1.1.4-parrallelmake-3.patch.gz](https://github.com/sagemath/sage/files/ticket9733/singular-3.1.1.4-parrallelmake-3.patch.gz)**\n\nSo he reported back and the patch worked for him.",
    "created_at": "2010-09-19T03:17:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87897",
    "user": "https://github.com/kiwifb"
}
```

<a id='comment:58'>Comment 58:</a>
Attachment: **[singular-3.1.1.4-parrallelmake-3.patch.gz](https://github.com/sagemath/sage/files/ticket9733/singular-3.1.1.4-parrallelmake-3.patch.gz)**

So he reported back and the patch worked for him.



---

archive/issue_comments_087898.json:
```json
{
    "body": "<a id='comment:59'>Comment 59:</a>\nReplying to [@kiwifb](#comment%3A58):\n> So he reported back and the patch worked for him.\n\nFran\u00e7ois, could you add your patch to #9946?\n\nI'm going to release 4.6.alpha1 with #9946 as a known problem, since alpha1 *is* an alpha and we need more real-world tests.",
    "created_at": "2010-09-19T05:56:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9733",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9733#issuecomment-87898",
    "user": "https://github.com/qed777"
}
```

<a id='comment:59'>Comment 59:</a>
Replying to [@kiwifb](#comment%3A58):
> So he reported back and the patch worked for him.

Fran√ßois, could you add your patch to #9946?

I'm going to release 4.6.alpha1 with #9946 as a known problem, since alpha1 *is* an alpha and we need more real-world tests.
