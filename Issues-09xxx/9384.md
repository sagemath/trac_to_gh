# Issue 9384: descend_to method for elliptic curves

archive/issues_009384.json:
```json
{
    "assignees": [
        "https://github.com/JohnCremona"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nGiven a subfield K and an elliptic curve E defined over a field L, this function determines whether there exists an elliptic curve over K which is isomorphic over L to E. If one exists, it finds it.\n\nCC:  @adeines @JohnCremona @sagetrac-jeremywest\n\nComponent: **elliptic curves**\n\nKeywords: **descend, subfield, isomorphic**\n\nAuthor: **Erin Beyerstedt, Jeremy West**\n\nReviewer: **Aly Deines**\n\nMerged: **sage-4.5.2.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9384_\n\n",
    "closed_at": "2010-07-27T00:51:24Z",
    "created_at": "2010-06-29T22:24:01Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
        "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.5.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "descend_to method for elliptic curves",
    "type": "issue",
    "updated_at": "2023-01-08T10:05:37Z",
    "url": "https://github.com/sagemath/sage/issues/9384",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```
<div id="comment:0"></div>

Given a subfield K and an elliptic curve E defined over a field L, this function determines whether there exists an elliptic curve over K which is isomorphic over L to E. If one exists, it finds it.

CC:  @adeines @JohnCremona @sagetrac-jeremywest

Component: **elliptic curves**

Keywords: **descend, subfield, isomorphic**

Author: **Erin Beyerstedt, Jeremy West**

Reviewer: **Aly Deines**

Merged: **sage-4.5.2.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/9384_





---

archive/issue_events_119114.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-06-29T22:24:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119114"
}
```



---

archive/issue_events_119115.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-06-29T22:24:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119115"
}
```



---

archive/issue_events_119116.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-06-29T22:24:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119116"
}
```



---

archive/issue_events_119117.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-06-29T22:24:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119117"
}
```



---

archive/issue_events_119118.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-06-29T22:24:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20elliptic%20curves",
    "label_color": "0000ff",
    "label_name": "c: elliptic curves",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119118"
}
```



---

archive/issue_events_119119.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-06-29T22:24:01Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "subject": "https://github.com/sagetrac-ebeyerstedt",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119119"
}
```



---

archive/issue_events_119120.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-06-29T23:46:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119120"
}
```



---

archive/issue_comments_080023.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThis has been implemented in the patch. Please review.",
    "created_at": "2010-06-29T23:46:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80023",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```

<div id="comment:1" align="right">comment:1</div>

This has been implemented in the patch. Please review.



---

archive/issue_comments_080024.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nNote: This function does not yet work when j = 0, 1728.",
    "created_at": "2010-06-30T02:26:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80024",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```

<div id="comment:2" align="right">comment:2</div>

Note: This function does not yet work when j = 0, 1728.



---

archive/issue_comments_080025.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nAttachment: **[trac_9384.patch.gz](https://github.com/sagemath/sage/files/ticket9384/trac_9384.patch.gz)**\n\nThe update handles the cases for j=0,1728.",
    "created_at": "2010-06-30T03:46:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80025",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```

<div id="comment:3" align="right">comment:3</div>

Attachment: **[trac_9384.patch.gz](https://github.com/sagemath/sage/files/ticket9384/trac_9384.patch.gz)**

The update handles the cases for j=0,1728.



---

archive/issue_events_119121.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-30T04:35:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119121"
}
```



---

archive/issue_events_119122.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-30T04:35:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119122"
}
```



---

archive/issue_comments_080026.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThe code for handling j=0,1728 needs to be cleaned up a little. Also, this function currently does not properly handle the following case\n\nF.<b> = QuadraticField(23)\nK.<a> = F.extension(x^3+5)\nE = EllipticCurve(j = 1728*b).change_ring(K)\nE.descend_to(F)\n\nIt returns none when it should descend to the subfield F.",
    "created_at": "2010-06-30T04:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80026",
    "user": "https://github.com/adeines"
}
```

<div id="comment:6" align="right">comment:6</div>

The code for handling j=0,1728 needs to be cleaned up a little. Also, this function currently does not properly handle the following case

F.<b> = QuadraticField(23)
K.<a> = F.extension(x^3+5)
E = EllipticCurve(j = 1728*b).change_ring(K)
E.descend_to(F)

It returns none when it should descend to the subfield F.



---

archive/issue_comments_080027.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nIt looks to me as though the curve returned is (sometimes) a twist of the original, rather than isomorphic -- but I have been flying all night so am not reliable!\n\nYou can check if there is an embedding of K in self.base_ring() like this:\n\n```\nsage: X = polygen(QQ)\nsage: K.<a> = NumberField(X^4 - X^3 + 2*X^2 + X + 1)\nsage: QQ.embeddings(K)\n[Ring Coercion morphism:\n  From: Rational Field\n  To:   Number Field in a with defining polynomial x^4 - x^3 + 2*x^2 + x + 1]\n```",
    "created_at": "2010-06-30T11:33:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80027",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

It looks to me as though the curve returned is (sometimes) a twist of the original, rather than isomorphic -- but I have been flying all night so am not reliable!

You can check if there is an embedding of K in self.base_ring() like this:

```
sage: X = polygen(QQ)
sage: K.<a> = NumberField(X^4 - X^3 + 2*X^2 + X + 1)
sage: QQ.embeddings(K)
[Ring Coercion morphism:
  From: Rational Field
  To:   Number Field in a with defining polynomial x^4 - x^3 + 2*x^2 + x + 1]
```



---

archive/issue_events_119123.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-07-02T05:14:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119123"
}
```



---

archive/issue_events_119124.json:
```json
{
    "actor": "https://github.com/sagetrac-ebeyerstedt",
    "created_at": "2010-07-02T05:14:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119124"
}
```



---

archive/issue_comments_080028.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThis new patch should work in general. It uses the newly implemented preimage function for number field homomorphisms. Be sure to apply the patch from #9403 first.",
    "created_at": "2010-07-02T05:14:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80028",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```

<div id="comment:8" align="right">comment:8</div>

This new patch should work in general. It uses the newly implemented preimage function for number field homomorphisms. Be sure to apply the patch from #9403 first.



---

archive/issue_comments_080029.json:
```json
{
    "body": "Attachment: **[trac_9384_update.patch.gz](https://github.com/sagemath/sage/files/ticket9384/trac_9384_update.patch.gz)**\n\nReplaces previous patch.",
    "created_at": "2010-07-02T18:49:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80029",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```

Attachment: **[trac_9384_update.patch.gz](https://github.com/sagemath/sage/files/ticket9384/trac_9384_update.patch.gz)**

Replaces previous patch.



---

archive/issue_events_119125.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-07-02T19:57:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119125"
}
```



---

archive/issue_events_119126.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-07-02T19:57:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119126"
}
```



---

archive/issue_events_119127.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-07-27T00:51:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119127"
}
```



---

archive/issue_events_119128.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-07-27T00:51:24Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119128"
}
```



---

archive/issue_comments_080030.json:
```json
{
    "body": "Merged: **sage-4.5.2.alpha1**",
    "created_at": "2010-07-27T00:51:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80030",
    "user": "https://github.com/dandrake"
}
```

Merged: **sage-4.5.2.alpha1**



---

archive/issue_events_119129.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-07-27T04:33:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119129"
}
```



---

archive/issue_events_119130.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-07-27T04:33:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "milestone_number": null,
    "milestone_title": "sage-4.5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9384#event-119130"
}
```



---

archive/issue_comments_080031.json:
```json
{
    "body": "Reviewer: **Alyson Deines**",
    "created_at": "2010-07-27T04:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80031",
    "user": "https://github.com/qed777"
}
```

Reviewer: **Alyson Deines**



---

archive/issue_comments_080032.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nI'm entering a guess for the Reviewer(s) field.  Please correct me if I'm wrong.",
    "created_at": "2010-07-27T04:35:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80032",
    "user": "https://github.com/qed777"
}
```

<div id="comment:12" align="right">comment:12</div>

I'm entering a guess for the Reviewer(s) field.  Please correct me if I'm wrong.



---

archive/issue_comments_080033.json:
```json
{
    "body": "Changed reviewer from **Alyson Deines** to **Aly Deines**",
    "created_at": "2011-01-13T07:16:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80033",
    "user": "https://github.com/adeines"
}
```

Changed reviewer from **Alyson Deines** to **Aly Deines**



---

archive/issue_comments_080034.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nSee follow-up ticket at #16456 where it is explained why the implementation here is deficient and needs fixing.",
    "created_at": "2014-06-07T17:07:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9384",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9384#issuecomment-80034",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:14" align="right">comment:14</div>

See follow-up ticket at #16456 where it is explained why the implementation here is deficient and needs fixing.
