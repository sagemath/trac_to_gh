# Issue 9803: Generalize and document the random_matrix constructor

archive/issues_009802.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout",
        "https://github.com/williamstein"
    ],
    "body": "This will vastly improve the documentation of the `random_matrix` command in common use cases (integers, rationals,...).\n\nIt will also allow for new, more specialized constructions, such as Billy Wonderly's work at #9720, #9754, #9802.\n\nSee #9720 for motivating discussion.\n\nCC:  @sagetrac-bwonderly @mwhansen @wdjoyner @jasongrout\n\nComponent: **linear algebra**\n\nAuthor: **Rob Beezer**\n\nReviewer: **David Joyner, Mike Hansen**\n\nMerged: **sage-4.6.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9803_\n\n",
    "closed_at": "2010-09-15T09:52:57Z",
    "created_at": "2010-08-26T00:27:48Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
        "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Generalize and document the random_matrix constructor",
    "type": "issue",
    "updated_at": "2010-09-15T09:52:57Z",
    "url": "https://github.com/sagemath/sage/issues/9803",
    "user": "https://github.com/rbeezer"
}
```
This will vastly improve the documentation of the `random_matrix` command in common use cases (integers, rationals,...).

It will also allow for new, more specialized constructions, such as Billy Wonderly's work at #9720, #9754, #9802.

See #9720 for motivating discussion.

CC:  @sagetrac-bwonderly @mwhansen @wdjoyner @jasongrout

Component: **linear algebra**

Author: **Rob Beezer**

Reviewer: **David Joyner, Mike Hansen**

Merged: **sage-4.6.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/9803_





---

archive/issue_events_127177.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2010-08-26T00:27:48Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "milestone_number": null,
    "milestone_title": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127177"
}
```



---

archive/issue_events_127178.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2010-08-26T00:27:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20linear%20algebra",
    "label_color": "0000ff",
    "label_name": "c: linear algebra",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127178"
}
```



---

archive/issue_events_127179.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2010-08-26T00:27:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "label": "https://github.com/sagemath/sage/labels/p%3A%203%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p: 3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127179"
}
```



---

archive/issue_events_127180.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2010-08-26T00:27:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127180"
}
```



---

archive/issue_events_127181.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2010-08-26T00:27:48Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "subject": "https://github.com/rbeezer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127181"
}
```



---

archive/issue_events_127182.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-08-26T00:27:48Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "subject": "https://github.com/rbeezer",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127182"
}
```



---

archive/issue_comments_087084.json:
```json
{
    "body": "Attachment: **[trac_9803-random-matrix-constructor-v1.patch.gz](https://github.com/sagemath/sage/files/ticket9803/trac_9803-random-matrix-constructor-v1.patch.gz)**",
    "created_at": "2010-08-26T22:16:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87084",
    "user": "https://github.com/rbeezer"
}
```

Attachment: **[trac_9803-random-matrix-constructor-v1.patch.gz](https://github.com/sagemath/sage/files/ticket9803/trac_9803-random-matrix-constructor-v1.patch.gz)**



---

archive/issue_comments_087085.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nPatch expands the functionality of the `random_matrix` routine.  A matrix space is used to accumulate the base ring, dimensions and representation (sparse/dense).  This can then be passed to the new `random_*_matrix` routines where a matrix can actually be constructed and returned.\n\nDocumentation for previous behavior greatly expanded, notably for integer and rational matrices.  New routines are demonstrated, with clear directions (links, imports) to expanded documentation.\n\nHad to handle density and sparse keywords in a backwards-compatible fashion, so they are \"popped\" out of the `kwds` dictionary and passed as before to the matrix randomize() routine.  The keywords are now required and won't work as positional arguments.  Had to adjust code in the group theory isomorphism code in a couple of modules as a result.  Also the `random_matrix` command was employed coincidentally in a doctest in the lazy import routine.  I think the new version works just as well as a test, so I changed the output.\n\nThis code below looks like some artifact of the switch to allowing/disallowing zero entries.  I've left it in, though it *never* gets called in any of the tests (I checked).  Before my changes, `density` had a default value of 1, so you would have to consciously pass in `None` to make this happen.  It was not documented.\n\n```\n        if density is None:\n            A.randomize(density=float(1), nonzero=False, *args, **kwds)\n        else:\n            A.randomize(density=density, nonzero=True, *args, **kwds)\n```\n\nOne fix in mod n dense matrix code.  Could not figure out how `range(25)` was doing anything useful, and it was ending up in the algorithm argument, so in the end I just removed it and the affected test passes.",
    "created_at": "2010-08-26T22:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87085",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:1" align="right">comment:1</div>

Patch expands the functionality of the `random_matrix` routine.  A matrix space is used to accumulate the base ring, dimensions and representation (sparse/dense).  This can then be passed to the new `random_*_matrix` routines where a matrix can actually be constructed and returned.

Documentation for previous behavior greatly expanded, notably for integer and rational matrices.  New routines are demonstrated, with clear directions (links, imports) to expanded documentation.

Had to handle density and sparse keywords in a backwards-compatible fashion, so they are "popped" out of the `kwds` dictionary and passed as before to the matrix randomize() routine.  The keywords are now required and won't work as positional arguments.  Had to adjust code in the group theory isomorphism code in a couple of modules as a result.  Also the `random_matrix` command was employed coincidentally in a doctest in the lazy import routine.  I think the new version works just as well as a test, so I changed the output.

This code below looks like some artifact of the switch to allowing/disallowing zero entries.  I've left it in, though it *never* gets called in any of the tests (I checked).  Before my changes, `density` had a default value of 1, so you would have to consciously pass in `None` to make this happen.  It was not documented.

```
        if density is None:
            A.randomize(density=float(1), nonzero=False, *args, **kwds)
        else:
            A.randomize(density=density, nonzero=True, *args, **kwds)
```

One fix in mod n dense matrix code.  Could not figure out how `range(25)` was doing anything useful, and it was ending up in the algorithm argument, so in the end I just removed it and the affected test passes.



---

archive/issue_comments_087086.json:
```json
{
    "body": "Author: **Rob Beezer**",
    "created_at": "2010-08-26T22:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87086",
    "user": "https://github.com/rbeezer"
}
```

Author: **Rob Beezer**



---

archive/issue_events_127183.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2010-08-26T22:19:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127183"
}
```



---

archive/issue_comments_087087.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,5 +1,5 @@\n This will vastly improve the documentation of the `random_matrix` command in common use cases (integers, rationals,...).\n \n-It will also allow for new, more specialized constructions, such as Billy Wonderly's work at #9720, #9754, #9820.\n+It will also allow for new, more specialized constructions, such as Billy Wonderly's work at #9720, #9754, #9802.\n \n See #9720 for motivating discussion.\n``````\n",
    "created_at": "2010-08-26T22:19:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87087",
    "user": "https://github.com/rbeezer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,5 +1,5 @@
 This will vastly improve the documentation of the `random_matrix` command in common use cases (integers, rationals,...).
 
-It will also allow for new, more specialized constructions, such as Billy Wonderly's work at #9720, #9754, #9820.
+It will also allow for new, more specialized constructions, such as Billy Wonderly's work at #9720, #9754, #9802.
 
 See #9720 for motivating discussion.
``````




---

archive/issue_comments_087088.json:
```json
{
    "body": "Attachment: **[trac_9803-random-matrix-constructor-v2.patch.gz](https://github.com/sagemath/sage/files/ticket9803/trac_9803-random-matrix-constructor-v2.patch.gz)**\n\nStandalone patch",
    "created_at": "2010-08-27T01:43:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87088",
    "user": "https://github.com/rbeezer"
}
```

Attachment: **[trac_9803-random-matrix-constructor-v2.patch.gz](https://github.com/sagemath/sage/files/ticket9803/trac_9803-random-matrix-constructor-v2.patch.gz)**

Standalone patch



---

archive/issue_comments_087089.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nFirst patch contained:\n\n```\ncolumns = parent.nrows()\n```\n\nwhich is just plain wrong, but also `columns` was never referenced (which is why the doctests were unaffected).  Its gone now.  Use just the v2 patch.",
    "created_at": "2010-08-27T01:45:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87089",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:2" align="right">comment:2</div>

First patch contained:

```
columns = parent.nrows()
```

which is just plain wrong, but also `columns` was never referenced (which is why the doctests were unaffected).  Its gone now.  Use just the v2 patch.



---

archive/issue_comments_087090.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nDoes this patch depend on any other patches?",
    "created_at": "2010-08-27T17:16:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87090",
    "user": "https://github.com/wdjoyner"
}
```

<div id="comment:3" align="right">comment:3</div>

Does this patch depend on any other patches?



---

archive/issue_comments_087091.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nReplying to [@wdjoyner](#comment:3):\n> Does this patch depend on any other patches?\n\nAh, yes, totally forgot.  It needs to have #9720 (just the v4 patch) applied first.  Thanks.",
    "created_at": "2010-08-27T17:40:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87091",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:4" align="right">comment:4</div>

Replying to [@wdjoyner](#comment:3):
> Does this patch depend on any other patches?

Ah, yes, totally forgot.  It needs to have #9720 (just the v4 patch) applied first.  Thanks.



---

archive/issue_comments_087092.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nApplied (with #9720) to 4.5.1 and passed sage -testall. Positive review as far as I see, but maybe Mike Hansen should weight in.",
    "created_at": "2010-08-28T19:56:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87092",
    "user": "https://github.com/wdjoyner"
}
```

<div id="comment:5" align="right">comment:5</div>

Applied (with #9720) to 4.5.1 and passed sage -testall. Positive review as far as I see, but maybe Mike Hansen should weight in.



---

archive/issue_comments_087093.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nThis looks good to me.",
    "created_at": "2010-08-30T03:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87093",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:6" align="right">comment:6</div>

This looks good to me.



---

archive/issue_comments_087094.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@mwhansen](#comment:6):\n> This looks good to me.\n\nThanks for your input.  I think this is much improved organized this way, and I finally did something about the documentation for the `random_matrix()` command.  ;-)\n\nLooks like this can go to positive review along with the rest of Billy's work.",
    "created_at": "2010-08-30T03:55:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87094",
    "user": "https://github.com/rbeezer"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@mwhansen](#comment:6):
> This looks good to me.

Thanks for your input.  I think this is much improved organized this way, and I finally did something about the documentation for the `random_matrix()` command.  ;-)

Looks like this can go to positive review along with the rest of Billy's work.



---

archive/issue_events_127184.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2010-08-30T03:55:13Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127184"
}
```



---

archive/issue_events_127185.json:
```json
{
    "actor": "https://github.com/rbeezer",
    "created_at": "2010-08-30T03:55:13Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127185"
}
```



---

archive/issue_comments_087095.json:
```json
{
    "body": "Reviewer: **David Joyner, Mike Hansen**",
    "created_at": "2010-09-02T02:17:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87095",
    "user": "https://github.com/rbeezer"
}
```

Reviewer: **David Joyner, Mike Hansen**



---

archive/issue_comments_087096.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\n## Release Manager\n\n#9720, #9803, #9802, #9754 is each dependent on the predecessor, merge in this\norder.",
    "created_at": "2010-09-03T06:27:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87096",
    "user": "https://github.com/sagetrac-bwonderly"
}
```

<div id="comment:9" align="right">comment:9</div>

## Release Manager

#9720, #9803, #9802, #9754 is each dependent on the predecessor, merge in this
order.



---

archive/issue_events_127186.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-15T09:52:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127186"
}
```



---

archive/issue_events_127187.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-15T09:52:57Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9803#event-127187"
}
```



---

archive/issue_comments_087097.json:
```json
{
    "body": "Merged: **sage-4.6.alpha1**",
    "created_at": "2010-09-15T09:52:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9803",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9803#issuecomment-87097",
    "user": "https://github.com/qed777"
}
```

Merged: **sage-4.6.alpha1**
