# Issue 9891: substitute goes too far: (5-e^x).substitute(x=log(x)) -> 5-log(x)

archive/issues_009890.json:
```json
{
    "body": "Reported by Kees on sage-support:\n\nhttp://groups.google.com/group/sage-support/t/bfa34b077dd31b73\n\n```\nRunning the following few lines:\n\neq=5-e^x\nprint \"1:\",eq.substitute(x=3*x)\nprint \"2:\",eq.substitute(x=log(x))\n\nyields the output (Sage 4.5.2 with Ubuntu):\n\n1: -e^(3*x) + 5\n2: -log(x) + 5\n```\n\nThis is also present in GiNaC:\n\n```\nginsh - GiNaC Interactive Shell (ginac V1.5.7)\n  __,  _______  Copyright (C) 1999-2010 Johannes Gutenberg University Mainz,\n (__) *       | Germany.  This is free software with ABSOLUTELY NO WARRANTY.\n  ._) i N a C | You are welcome to redistribute it under certain conditions.\n<-------------' For details type `warranty;'.\n\nType ?? for a list of help topics.\n> subs(5-exp(x),x==log(x));\n5-log(x)\n```\n\n\nAssignee: @burcin\n\nCC:  @RBKreckel\n\nKeywords: pynac\n\nResolution: fixed\n\nDependencies: #11317\n\nAuthor: Richard Kreckel\n\nReviewer: Karl-Dieter Crisman\n\nUpstream: Fixed upstream, in a later stable release.\n\nMerged: sage-4.7.1.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/9891\n\n",
    "closed_at": "2011-05-27T12:01:22Z",
    "created_at": "2010-09-10T19:53:23Z",
    "labels": [
        "component: symbolics",
        "critical",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.7.1",
    "title": "substitute goes too far: (5-e^x).substitute(x=log(x)) -> 5-log(x)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9891",
    "user": "https://github.com/burcin"
}
```
Reported by Kees on sage-support:

http://groups.google.com/group/sage-support/t/bfa34b077dd31b73

```
Running the following few lines:

eq=5-e^x
print "1:",eq.substitute(x=3*x)
print "2:",eq.substitute(x=log(x))

yields the output (Sage 4.5.2 with Ubuntu):

1: -e^(3*x) + 5
2: -log(x) + 5
```

This is also present in GiNaC:

```
ginsh - GiNaC Interactive Shell (ginac V1.5.7)
  __,  _______  Copyright (C) 1999-2010 Johannes Gutenberg University Mainz,
 (__) *       | Germany.  This is free software with ABSOLUTELY NO WARRANTY.
  ._) i N a C | You are welcome to redistribute it under certain conditions.
<-------------' For details type `warranty;'.

Type ?? for a list of help topics.
> subs(5-exp(x),x==log(x));
5-log(x)
```


Assignee: @burcin

CC:  @RBKreckel

Keywords: pynac

Resolution: fixed

Dependencies: #11317

Author: Richard Kreckel

Reviewer: Karl-Dieter Crisman

Upstream: Fixed upstream, in a later stable release.

Merged: sage-4.7.1.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/9891





---

archive/issue_comments_117463.json:
```json
{
    "body": "Changing upstream from \"Not yet reported upstream; Will do shortly.\" to \"Reported upstream. Developers acknowledge bug.\"",
    "created_at": "2010-09-14T08:30:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117463",
    "user": "https://github.com/RBKreckel"
}
```

Changing upstream from "Not yet reported upstream; Will do shortly." to "Reported upstream. Developers acknowledge bug."



---

archive/issue_comments_117464.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2010-09-19T14:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117464",
    "user": "https://github.com/burcin"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_117465.json:
```json
{
    "body": "<a id='comment:2'></a>This was fixed in GiNaC by Richard Kreckel:\n\nhttp://www.ginac.de/pipermail/ginac-list/2010-September/001738.html\n\nI merged his changes to pynac, so it will be available in the next release.",
    "created_at": "2010-09-19T14:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117465",
    "user": "https://github.com/burcin"
}
```

<a id='comment:2'></a>This was fixed in GiNaC by Richard Kreckel:

http://www.ginac.de/pipermail/ginac-list/2010-September/001738.html

I merged his changes to pynac, so it will be available in the next release.



---

archive/issue_comments_117466.json:
```json
{
    "body": "Changing author from \"\" to \"Richard Kreckel\"",
    "created_at": "2010-09-19T14:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117466",
    "user": "https://github.com/burcin"
}
```

Changing author from "" to "Richard Kreckel"



---

archive/issue_comments_117467.json:
```json
{
    "body": "Changing upstream from \"Reported upstream. Developers acknowledge bug.\" to \"Fixed upstream, in a later stable release.\"",
    "created_at": "2010-09-19T14:35:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117467",
    "user": "https://github.com/burcin"
}
```

Changing upstream from "Reported upstream. Developers acknowledge bug." to "Fixed upstream, in a later stable release."



---

archive/issue_comments_117468.json:
```json
{
    "body": "Attachment [trac_9891-substitute.patch](tarball://root/attachments/some-uuid/ticket9891/trac_9891-substitute.patch) by @burcin created at 2010-09-19 23:07:06\n\nadd doctest",
    "created_at": "2010-09-19T23:07:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117468",
    "user": "https://github.com/burcin"
}
```

Attachment [trac_9891-substitute.patch](tarball://root/attachments/some-uuid/ticket9891/trac_9891-substitute.patch) by @burcin created at 2010-09-19 23:07:06

add doctest



---

archive/issue_comments_117469.json:
```json
{
    "body": "<a id='comment:3'></a>Burcin, I'm still getting\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\nsage: (5-e^x).substitute(x=log(x))\n-log(x) + 5\n```\nWhich version of Pynac is this in?",
    "created_at": "2011-02-17T01:39:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117469",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>Burcin, I'm still getting

```
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
sage: (5-e^x).substitute(x=log(x))
-log(x) + 5
```
Which version of Pynac is this in?



---

archive/issue_comments_117470.json:
```json
{
    "body": "<a id='comment:4'></a>For reference, here is a link to the upstream patch:\nhttp://www.ginac.de/ginac.git?p=ginac.git;a=commitdiff;h=90ad10b58d02365a407b2d84d8b93e50030feaa5",
    "created_at": "2011-02-17T07:44:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117470",
    "user": "https://github.com/RBKreckel"
}
```

<a id='comment:4'></a>For reference, here is a link to the upstream patch:
http://www.ginac.de/ginac.git?p=ginac.git;a=commitdiff;h=90ad10b58d02365a407b2d84d8b93e50030feaa5



---

archive/issue_comments_117471.json:
```json
{
    "body": "<a id='comment:5'></a>I can confirm this is not in the latest version of Pynac in Sage or on its website (0.2.1), by looking at container.h.",
    "created_at": "2011-02-17T14:09:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117471",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>I can confirm this is not in the latest version of Pynac in Sage or on its website (0.2.1), by looking at container.h.



---

archive/issue_comments_117472.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2011-05-09T15:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117472",
    "user": "https://github.com/burcin"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_117473.json:
```json
{
    "body": "Changing dependencies from \"\" to \"11317\"",
    "created_at": "2011-05-09T15:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117473",
    "user": "https://github.com/burcin"
}
```

Changing dependencies from "" to "11317"



---

archive/issue_comments_117474.json:
```json
{
    "body": "<a id='comment:6'></a>New pynac package with the fix is at #11317.",
    "created_at": "2011-05-09T15:08:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117474",
    "user": "https://github.com/burcin"
}
```

<a id='comment:6'></a>New pynac package with the fix is at #11317.



---

archive/issue_comments_117475.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-05-09T18:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117475",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_117476.json:
```json
{
    "body": "<a id='comment:7'></a>Okay, this is fine.\n\nBurcin, I have to say I feel a little odd saying that I'm reviewing Kreckel's work, when I'm really reviewing your merging his work and your doctest (though I looked at the actual patch, naturally).  Is there a different way to put the author in?  You are the author of the actual patch here, not the Ginac update; I don't think any other spkgs put upstream people who committed things in this way.",
    "created_at": "2011-05-09T18:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117476",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:7'></a>Okay, this is fine.

Burcin, I have to say I feel a little odd saying that I'm reviewing Kreckel's work, when I'm really reviewing your merging his work and your doctest (though I looked at the actual patch, naturally).  Is there a different way to put the author in?  You are the author of the actual patch here, not the Ginac update; I don't think any other spkgs put upstream people who committed things in this way.



---

archive/issue_comments_117477.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Karl-Dieter Crisman\"",
    "created_at": "2011-05-09T18:33:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117477",
    "user": "https://github.com/kcrisman"
}
```

Changing reviewer from "" to "Karl-Dieter Crisman"



---

archive/issue_comments_117478.json:
```json
{
    "body": "<a id='comment:8'></a>Thanks for the review!\n\nReplying to [comment:7 kcrisman]:\n> Burcin, I have to say I feel a little odd saying that I'm reviewing Kreckel's work, when I'm really reviewing your merging his work and your doctest (though I looked at the actual patch, naturally).  Is there a different way to put the author in?  You are the author of the actual patch here, not the Ginac update; I don't think any other spkgs put upstream people who committed things in this way.\n\n\nI put Richard's name in the authors list since he should get the credit for fixing this in the Sage release notes. I think we should give more credit to upstream developers. Are you suggesting my name should be in the authors or the reviewers field? :)",
    "created_at": "2011-05-09T19:04:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117478",
    "user": "https://github.com/burcin"
}
```

<a id='comment:8'></a>Thanks for the review!

Replying to [comment:7 kcrisman]:
> Burcin, I have to say I feel a little odd saying that I'm reviewing Kreckel's work, when I'm really reviewing your merging his work and your doctest (though I looked at the actual patch, naturally).  Is there a different way to put the author in?  You are the author of the actual patch here, not the Ginac update; I don't think any other spkgs put upstream people who committed things in this way.


I put Richard's name in the authors list since he should get the credit for fixing this in the Sage release notes. I think we should give more credit to upstream developers. Are you suggesting my name should be in the authors or the reviewers field? :)



---

archive/issue_events_024909.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-10T07:32:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9891#event-24909"
}
```



---

archive/issue_comments_117479.json:
```json
{
    "body": "Changing dependencies from \"11317\" to \"#11317\"",
    "created_at": "2011-05-10T07:32:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117479",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "11317" to "#11317"



---

archive/issue_comments_117480.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.7.1.alpha1\"",
    "created_at": "2011-05-27T12:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117480",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-4.7.1.alpha1"



---

archive/issue_events_024910.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-05-27T12:01:22Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9891#event-24910"
}
```



---

archive/issue_comments_117481.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2011-05-27T12:01:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9891",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9891#issuecomment-117481",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
