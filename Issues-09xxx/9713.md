# Issue 9713: Add toric Chow group

archive/issues_009713.json:
```json
{
    "body": "The toric Chow group is a useful version of a homology theory for toric varieties, especially for singular varieties. The attached patch provides support for computing the toric Chow group as well as elementary intersection theory.\n\nSee tracker bug at #9604 to for related patches.\n\n**Apply**:\n1. [attachment:trac_9713_fix_cardinality.patch]\n2. [attachment:trac_9713_fix_fg_pid.2.patch]\n3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]\n4. [attachment:trac_9713_toric_chow_group.patch]\n5. [attachment:9713_hash.patch]\n\nDepends on #8948.\n\n**Assignee:** @aghitza\n\n**CC:**  @novoselt\n\n**Author:** Volker Braun\n\n**Reviewer:** Andrey Novoseltsev, Simon King, Jeroen Demeyer\n\n**Merged:** sage-4.6.2.alpha4\n\nIssue created by migration from https://trac.sagemath.org/ticket/9713\n\n",
    "closed_at": "2011-02-07T08:13:46Z",
    "created_at": "2010-08-09T22:54:14Z",
    "labels": [
        "component: algebraic geometry",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.6.2",
    "title": "Add toric Chow group",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9713",
    "user": "https://github.com/vbraun"
}
```
The toric Chow group is a useful version of a homology theory for toric varieties, especially for singular varieties. The attached patch provides support for computing the toric Chow group as well as elementary intersection theory.

See tracker bug at #9604 to for related patches.

**Apply**:
1. [attachment:trac_9713_fix_cardinality.patch]
2. [attachment:trac_9713_fix_fg_pid.2.patch]
3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]
4. [attachment:trac_9713_toric_chow_group.patch]
5. [attachment:9713_hash.patch]

Depends on #8948.

**Assignee:** @aghitza

**CC:**  @novoselt

**Author:** Volker Braun

**Reviewer:** Andrey Novoseltsev, Simon King, Jeroen Demeyer

**Merged:** sage-4.6.2.alpha4

Issue created by migration from https://trac.sagemath.org/ticket/9713





---

archive/issue_events_072265.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-09-10T02:58:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72265"
}
```



---

archive/issue_comments_087372.json:
```json
{
    "body": "<a id='comment:1'></a>\nVolker, is this one ready for review? (It needs a little rebasement on top of new #9337.)",
    "created_at": "2010-09-10T02:58:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87372",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:1'></a>
Volker, is this one ready for review? (It needs a little rebasement on top of new #9337.)



---

archive/issue_comments_087373.json:
```json
{
    "body": "<a id='comment:2'></a>\nI think its ready, but you will probably soon find something to disagree on ;-)\n\nRebased patch is attached.",
    "created_at": "2010-09-10T08:49:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87373",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:2'></a>
I think its ready, but you will probably soon find something to disagree on ;-)

Rebased patch is attached.



---

archive/issue_events_072266.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-09-10T08:49:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72266"
}
```



---

archive/issue_events_072267.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-09-10T08:49:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72267"
}
```



---

archive/issue_comments_087374.json:
```json
{
    "body": "**Reviewer:** Andrey Novoseltsev",
    "created_at": "2010-09-10T08:49:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87374",
    "user": "https://github.com/vbraun"
}
```

**Reviewer:** Andrey Novoseltsev



---

archive/issue_comments_087375.json:
```json
{
    "body": "<a id='comment:3'></a>\nSome preliminary comments:\n\n1. The new module is not completely documented yet, `sage -coverage` shows some issues.\n2. It seems to me that it is more common to use A<sup>k</sup> rather than A<sub>d-k</sub>, so I think it would be better to stick with it in the documentation.\n3. I'd prefer to drop \"The \" from \"The Chow cycle ...\" in `_repr_` as was done for divisor classes.\n4. It is not clear how to construct Chow cycles (except for those that correspond to cones).\n5. It is not clear what do numbers mean in the representation - i.e. how the basis is chosen?\n6. Regardless of the chosen basis, I think it would be more useful to see cycles as linear combination of cones (perhaps with cones represented by their `ambient_ray_indices`), without seeing those that got zero coefficients, of course. This issue is also relevant for divisor/cohomology classes and for divisor classes we do use coordinates in some basis, but I think that it makes more sense there, while here basis elements can be given by cycles of different dimension and having no separation between them makes it difficult to interpret the output.",
    "created_at": "2010-09-17T02:52:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87375",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:3'></a>
Some preliminary comments:

1. The new module is not completely documented yet, `sage -coverage` shows some issues.
2. It seems to me that it is more common to use A<sup>k</sup> rather than A<sub>d-k</sub>, so I think it would be better to stick with it in the documentation.
3. I'd prefer to drop "The " from "The Chow cycle ..." in `_repr_` as was done for divisor classes.
4. It is not clear how to construct Chow cycles (except for those that correspond to cones).
5. It is not clear what do numbers mean in the representation - i.e. how the basis is chosen?
6. Regardless of the chosen basis, I think it would be more useful to see cycles as linear combination of cones (perhaps with cones represented by their `ambient_ray_indices`), without seeing those that got zero coefficients, of course. This issue is also relevant for divisor/cohomology classes and for divisor classes we do use coordinates in some basis, but I think that it makes more sense there, while here basis elements can be given by cycles of different dimension and having no separation between them makes it difficult to interpret the output.



---

archive/issue_events_072268.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-09-17T02:52:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72268"
}
```



---

archive/issue_events_072269.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-09-17T02:52:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72269"
}
```



---

archive/issue_comments_087376.json:
```json
{
    "body": "<a id='comment:4'></a>\nI'll try to add the missing docstrings.\n\nI was intentionally using `A_k` and not `A^{d-k}` because this patch implements the Chow homology and not the cohomology. I'm not sure to which extend they are the same over singular/noncompact varieties over ZZ.\n\nI'm not entirely happy with the output either. But printing all the cones (even if we abbreviate them) will very quickly produce multi-line output. Right now, the output is essentially in a random basis corresponding to `cycle.parent().degree()`. \n\n```\nsage: cycle = X.Chow_group().gen(1)\nsage: cycle\nThe Chow cycle (0, 1, 0, 0, 0, 0)\nsage: cycle.parent().degree()\n(Z, Z x Z, Z x Z, Z)\nsage: cycle.lift()\n(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0)\n```\nFor all practical purposes, the user should use `lift()` to get the coefficients of the cones in the given order `flatten(toric_variety.fan().cones())`. Would printing\n\n```\nChow cycle ((0,), (1, 0), (0, 0), (0,))\n```\nmake you more happy? Note that some methods (in particular, intersection with a divisor) need to change the cycle within its Chow class, so even \"simple\" cycles will  produce output where all coefficients are turned on. This is part of why I don't want to print the cone information explicitly.",
    "created_at": "2010-09-17T14:38:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87376",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:4'></a>
I'll try to add the missing docstrings.

I was intentionally using `A_k` and not `A^{d-k}` because this patch implements the Chow homology and not the cohomology. I'm not sure to which extend they are the same over singular/noncompact varieties over ZZ.

I'm not entirely happy with the output either. But printing all the cones (even if we abbreviate them) will very quickly produce multi-line output. Right now, the output is essentially in a random basis corresponding to `cycle.parent().degree()`. 

```
sage: cycle = X.Chow_group().gen(1)
sage: cycle
The Chow cycle (0, 1, 0, 0, 0, 0)
sage: cycle.parent().degree()
(Z, Z x Z, Z x Z, Z)
sage: cycle.lift()
(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0)
```
For all practical purposes, the user should use `lift()` to get the coefficients of the cones in the given order `flatten(toric_variety.fan().cones())`. Would printing

```
Chow cycle ((0,), (1, 0), (0, 0), (0,))
```
make you more happy? Note that some methods (in particular, intersection with a divisor) need to change the cycle within its Chow class, so even "simple" cycles will  produce output where all coefficients are turned on. This is part of why I don't want to print the cone information explicitly.



---

archive/issue_comments_087377.json:
```json
{
    "body": "<a id='comment:5'></a>\nOK, let's stick to A_k.\n\n```\nChow cycle ((0,), (1, 0), (0, 0), (0,))\n```\nis a bit ugly ;-) Maybe to have it as a vector but separate degrees something like this may work:\n\n```\nChow cycle (0 | 1, 0 | 0, 0 | 0)\n```\n\nMy concern is that if I create the Chow cycle corresponding to a cone generated by rays 2 and 5, it would be nice to see it clearly in the output, say\n\n```\nChow cycle {2, 5}\n```\nwith combinations printed as\n\n```\nChow cycle 2*{2, 5} - 7*{1, 2, 3}\n```\nBut to have it nicely will require storing the original cone combination, since lift algorithm from a quotient element will involve a lot of cones, as you pointed out. I don't know if it worths the benefits. But it would be nice at least to have some markers between degrees.",
    "created_at": "2010-09-17T15:35:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87377",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:5'></a>
OK, let's stick to A_k.

```
Chow cycle ((0,), (1, 0), (0, 0), (0,))
```
is a bit ugly ;-) Maybe to have it as a vector but separate degrees something like this may work:

```
Chow cycle (0 | 1, 0 | 0, 0 | 0)
```

My concern is that if I create the Chow cycle corresponding to a cone generated by rays 2 and 5, it would be nice to see it clearly in the output, say

```
Chow cycle {2, 5}
```
with combinations printed as

```
Chow cycle 2*{2, 5} - 7*{1, 2, 3}
```
But to have it nicely will require storing the original cone combination, since lift algorithm from a quotient element will involve a lot of cones, as you pointed out. I don't know if it worths the benefits. But it would be nice at least to have some markers between degrees.



---

archive/issue_comments_087378.json:
```json
{
    "body": "<a id='comment:6'></a>\nI've changed the printing of Chow cycles to the following:\n\n```\nsage: X = toric_varieties.Cube_deformation(7)\nsage: A = X.Chow_group()\nsage: A.degree()\n(Z, C7, Z^5 x C2 x C2, Z)\nsage: a = sum( A.gen(i) * (i+1) for i in range(0,A.ngens()) )   # an element of A\nsage: a\n( 3 | 1 mod 7 | 0 mod 2, 1 mod 2, 4, 5, 6, 7, 8 | 9 )\n```\nI'll upload a new patch when #9972 is finished, as this patch will require some rediffing.",
    "created_at": "2010-10-06T18:34:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87378",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:6'></a>
I've changed the printing of Chow cycles to the following:

```
sage: X = toric_varieties.Cube_deformation(7)
sage: A = X.Chow_group()
sage: A.degree()
(Z, C7, Z^5 x C2 x C2, Z)
sage: a = sum( A.gen(i) * (i+1) for i in range(0,A.ngens()) )   # an element of A
sage: a
( 3 | 1 mod 7 | 0 mod 2, 1 mod 2, 4, 5, 6, 7, 8 | 9 )
```
I'll upload a new patch when #9972 is finished, as this patch will require some rediffing.



---

archive/issue_comments_087379.json:
```json
{
    "body": "<a id='comment:7'></a>\nUpdated patch now applies cleanly. Ready for review...",
    "created_at": "2010-11-25T09:26:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87379",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:7'></a>
Updated patch now applies cleanly. Ready for review...



---

archive/issue_events_072270.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-11-25T09:26:29Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72270"
}
```



---

archive/issue_events_072271.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-11-25T09:26:29Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72271"
}
```



---

archive/issue_comments_087380.json:
```json
{
    "body": "<a id='comment:8'></a>\nI am a bit confused by the first example:\n\n```\nsage: A.degree()\n(Z, C7, Z^5 x C2 x C2, Z)\nsage: a = sum( A.gen(i) * (i+1) for i in range(0,A.ngens()) )   # an element of A\nsage: a\n( 3 | 1 mod 7 | 0 mod 2, 1 mod 2, 4, 5, 6, 7, 8 | 9 )\n```\nwith explanation \"The Chow group elements are printed as ( a0 | a1 mod 7 | a2 mod 2, a3 mod 2, a4, a5, a6, a7, a8 | a9 ), which denotes the element of the Chow group in the same basis as A.degree().\"\n\n`A.degree()` shows the third component as `Z^5 x C2 x C2`, yet it seems that elements put cyclic groups first, or maybe it is the reverse order (which would matter for several cyclic groups of different degrees).",
    "created_at": "2010-12-01T06:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87380",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:8'></a>
I am a bit confused by the first example:

```
sage: A.degree()
(Z, C7, Z^5 x C2 x C2, Z)
sage: a = sum( A.gen(i) * (i+1) for i in range(0,A.ngens()) )   # an element of A
sage: a
( 3 | 1 mod 7 | 0 mod 2, 1 mod 2, 4, 5, 6, 7, 8 | 9 )
```
with explanation "The Chow group elements are printed as ( a0 | a1 mod 7 | a2 mod 2, a3 mod 2, a4, a5, a6, a7, a8 | a9 ), which denotes the element of the Chow group in the same basis as A.degree()."

`A.degree()` shows the third component as `Z^5 x C2 x C2`, yet it seems that elements put cyclic groups first, or maybe it is the reverse order (which would matter for several cyclic groups of different degrees).



---

archive/issue_comments_087381.json:
```json
{
    "body": "**Work_Issues:** coordinate order of components",
    "created_at": "2010-12-01T06:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87381",
    "user": "https://github.com/novoselt"
}
```

**Work_Issues:** coordinate order of components



---

archive/issue_events_072272.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-01T06:01:41Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72272"
}
```



---

archive/issue_events_072273.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-01T06:01:41Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72273"
}
```



---

archive/issue_comments_087382.json:
```json
{
    "body": "<a id='comment:9'></a>\nA little optional note: it may be better to use `\\QQ` etc. rather than `\\mathbb{Q}`. I personally prefer the look of the last variant, but using standard macros brings more uniformity to the whole Sage documentation.",
    "created_at": "2010-12-01T16:39:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87382",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:9'></a>
A little optional note: it may be better to use `\QQ` etc. rather than `\mathbb{Q}`. I personally prefer the look of the last variant, but using standard macros brings more uniformity to the whole Sage documentation.



---

archive/issue_comments_087383.json:
```json
{
    "body": "<a id='comment:10'></a>\nDone. Now prints as\n\n```\nsage: A.degree()\n(Z, C7, C2 x C2 x Z^5, Z)\n```\nbecause thats how `FGP_Module` organizes its generators (first torsion, then free generators).",
    "created_at": "2010-12-01T19:47:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87383",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:10'></a>
Done. Now prints as

```
sage: A.degree()
(Z, C7, C2 x C2 x Z^5, Z)
```
because thats how `FGP_Module` organizes its generators (first torsion, then free generators).



---

archive/issue_events_072274.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-01T19:47:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72274"
}
```



---

archive/issue_events_072275.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-01T19:47:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72275"
}
```



---

archive/issue_comments_087384.json:
```json
{
    "body": "<a id='comment:11'></a>\nJust a minor point - there is a lot of reference to the Chow group of this and that, but it's apparently only the 'toric' Chow group, as noted at the beginning of the file.  Is it typical in the literature to conflate these notions - or is there a theorem that they are equivalent for toric varieties?  This should be clarified somehow, maybe even with an example of where they are not the same.  It would be unfortunate if they were *not* the same and someone later wanted to implement regular Chow groups!\n\nForgive me if the question is naive; I am fairly familiar with 'regular' Chow groups but hadn't encountered this (natural) version before.  If there is a foundational paper, it would be helpful to refer to that in the documentation as well; the Wikipedia page referenced doesn't actually refer to the 'toric' variety at all.",
    "created_at": "2010-12-02T16:17:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87384",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>
Just a minor point - there is a lot of reference to the Chow group of this and that, but it's apparently only the 'toric' Chow group, as noted at the beginning of the file.  Is it typical in the literature to conflate these notions - or is there a theorem that they are equivalent for toric varieties?  This should be clarified somehow, maybe even with an example of where they are not the same.  It would be unfortunate if they were *not* the same and someone later wanted to implement regular Chow groups!

Forgive me if the question is naive; I am fairly familiar with 'regular' Chow groups but hadn't encountered this (natural) version before.  If there is a foundational paper, it would be helpful to refer to that in the documentation as well; the Wikipedia page referenced doesn't actually refer to the 'toric' variety at all.



---

archive/issue_comments_087385.json:
```json
{
    "body": "<a id='comment:12'></a>\nThe **toric** Chow cycles are the torus-invariant subvarieties only. Its a standard construction, see e.g. Fultons book. I don't think that there is any hope of it being the same as the full Chow group. But then the Chow group is in general huge and there is little hope of a complete description, and even less of a toric algorithm. I guess we could sprinkle some more \"toric_\" prefixes around in anticipation of someone inventing the requisite mathematics. But I think its clear enough...",
    "created_at": "2010-12-02T19:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87385",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:12'></a>
The **toric** Chow cycles are the torus-invariant subvarieties only. Its a standard construction, see e.g. Fultons book. I don't think that there is any hope of it being the same as the full Chow group. But then the Chow group is in general huge and there is little hope of a complete description, and even less of a toric algorithm. I guess we could sprinkle some more "toric_" prefixes around in anticipation of someone inventing the requisite mathematics. But I think its clear enough...



---

archive/issue_comments_087386.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [vbraun](#comment%3A12):\n> The **toric** Chow cycles are the torus-invariant subvarieties only.\n\nYes, I got that. \n> Its a standard construction, see e.g. Fultons book. I don't think that there is any hope of it being the same as the full Chow group. \n\nAh, when you say \"Fulton's book\" I first got out Intersection Theory :) but here it is.  Sections 3.3 and 3.4 seem quite relevant.  Page 63 says that Pic and the divisor piece of the Chow group can be computed only with what Fulton consistently calls \"T-Weil\" and \"T-Cartier\" divisors.  Further, the first proposition in Chapter 5 certainly seems to imply that this is in fact true in general for toric varieties.  The 'orbit closures' seem to be toric subvarieties by definition, and they generate the Chow group.  Am I reading this wrong?",
    "created_at": "2010-12-02T20:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87386",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>
Replying to [vbraun](#comment%3A12):
> The **toric** Chow cycles are the torus-invariant subvarieties only.

Yes, I got that. 
> Its a standard construction, see e.g. Fultons book. I don't think that there is any hope of it being the same as the full Chow group. 

Ah, when you say "Fulton's book" I first got out Intersection Theory :) but here it is.  Sections 3.3 and 3.4 seem quite relevant.  Page 63 says that Pic and the divisor piece of the Chow group can be computed only with what Fulton consistently calls "T-Weil" and "T-Cartier" divisors.  Further, the first proposition in Chapter 5 certainly seems to imply that this is in fact true in general for toric varieties.  The 'orbit closures' seem to be toric subvarieties by definition, and they generate the Chow group.  Am I reading this wrong?



---

archive/issue_comments_087387.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe T-Weil divisor class group is the divisor part of the toric Chow group, and the T-Cartier divisor class group is the Pic (not the other way round).  And the orbit closures are the toric subvarieties. As usual, the divisor part of the Chow group is easy; the higher Chow groups become more complicated. Once you understand these, the Hodge conjecture follows easily ;-)",
    "created_at": "2010-12-02T22:07:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87387",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:14'></a>
The T-Weil divisor class group is the divisor part of the toric Chow group, and the T-Cartier divisor class group is the Pic (not the other way round).  And the orbit closures are the toric subvarieties. As usual, the divisor part of the Chow group is easy; the higher Chow groups become more complicated. Once you understand these, the Hodge conjecture follows easily ;-)



---

archive/issue_comments_087388.json:
```json
{
    "body": "<a id='comment:15'></a>\nYes, I didn't intend to switch those but did by accident.   Sorry.\n\nMaybe I wasn't clear.  I'm saying that the propositions I reference seem to imply that the regular Chow groups ARE the toric Chow groups, because the free Abelian group on p-cycles turns out to be generated by the toric p-cycles in a toric subvariety.  But again, maybe I'm misreading them somehow - are there fewer relations?  But the definitions there seem to have the same notion of rational equivalence (?).  Unfortunately, I don't have it on me, it was at work I checked this out.\n\nOh, and don't call them higher Chow groups; that is something else again :) unless you want to start talking about the so-called Beilinson-Hodge conjecture",
    "created_at": "2010-12-03T03:53:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87388",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>
Yes, I didn't intend to switch those but did by accident.   Sorry.

Maybe I wasn't clear.  I'm saying that the propositions I reference seem to imply that the regular Chow groups ARE the toric Chow groups, because the free Abelian group on p-cycles turns out to be generated by the toric p-cycles in a toric subvariety.  But again, maybe I'm misreading them somehow - are there fewer relations?  But the definitions there seem to have the same notion of rational equivalence (?).  Unfortunately, I don't have it on me, it was at work I checked this out.

Oh, and don't call them higher Chow groups; that is something else again :) unless you want to start talking about the so-called Beilinson-Hodge conjecture



---

archive/issue_comments_087389.json:
```json
{
    "body": "**Changing work_issues** from \"coordinate order of components\" to \"\".",
    "created_at": "2010-12-03T04:30:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87389",
    "user": "https://github.com/novoselt"
}
```

**Changing work_issues** from "coordinate order of components" to "".



---

archive/issue_comments_087390.json:
```json
{
    "body": "<a id='comment:16'></a>\nHere it is, I called the fan Sigma rather than Delta:\n\n**Proposition** The Chow group A_k_(X) of an arbitrary toric variety X = X(Sigma) is generated by the classes of the orbit closures V(sigma) of the cones of dimension n-k of Sigma.\n\nSo yes, the patch does implement the \"honest Chow group\" with the exception that arbitrary subvarieties cannot be translated into their Chow cycles (I think).\n\nKarl, do you plan to review the patch completely? It is fine if no, I am going to do it in the near future. But if yes, it certainly will be great to have more people looking at our toric stuff ;-)",
    "created_at": "2010-12-03T04:30:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87390",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:16'></a>
Here it is, I called the fan Sigma rather than Delta:

**Proposition** The Chow group A_k_(X) of an arbitrary toric variety X = X(Sigma) is generated by the classes of the orbit closures V(sigma) of the cones of dimension n-k of Sigma.

So yes, the patch does implement the "honest Chow group" with the exception that arbitrary subvarieties cannot be translated into their Chow cycles (I think).

Karl, do you plan to review the patch completely? It is fine if no, I am going to do it in the near future. But if yes, it certainly will be great to have more people looking at our toric stuff ;-)



---

archive/issue_comments_087391.json:
```json
{
    "body": "<a id='comment:17'></a>\nYes, I think that is the case - nicely summed up.\n\nNo, I am not at all an expert on toric varieties (though I wish I had learned more about them in graduate school now, they are so  concrete), so I can't help review.  The title of the ticket was just too good not to click on, and then I had this minor point which ballooned into a conversation.  Since of course lots of stuff IS toric that one might care about, I am glad you are doing it, but I'm sorry that it's above my pay grade for now.   If I had a sabbatical right now we might be talking ;)",
    "created_at": "2010-12-03T13:56:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87391",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:17'></a>
Yes, I think that is the case - nicely summed up.

No, I am not at all an expert on toric varieties (though I wish I had learned more about them in graduate school now, they are so  concrete), so I can't help review.  The title of the ticket was just too good not to click on, and then I had this minor point which ballooned into a conversation.  Since of course lots of stuff IS toric that one might care about, I am glad you are doing it, but I'm sorry that it's above my pay grade for now.   If I had a sabbatical right now we might be talking ;)



---

archive/issue_comments_087392.json:
```json
{
    "body": "<a id='comment:18'></a>\nBy \"higher\", I mean of course \"lower degree\" Chow groups. I'm pretty sure its correct in the module documentation :-)\n\nBut the free Abelian group of p-cycles is not generated by the toric p-cycles; The former is never finitely generated while the latter always is. In the case of divisors, the relations save you (the `Pic^0` is a point). But already for the curves part of the Chow group of a three-dimensional variety its not clear to me that the full Chow group is finitely generated.",
    "created_at": "2010-12-03T15:00:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87392",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:18'></a>
By "higher", I mean of course "lower degree" Chow groups. I'm pretty sure its correct in the module documentation :-)

But the free Abelian group of p-cycles is not generated by the toric p-cycles; The former is never finitely generated while the latter always is. In the case of divisors, the relations save you (the `Pic^0` is a point). But already for the curves part of the Chow group of a three-dimensional variety its not clear to me that the full Chow group is finitely generated.



---

archive/issue_comments_087393.json:
```json
{
    "body": "<a id='comment:19'></a>\nWell, Fulton claims that quotients are the same even though the starting free groups are very different ;-)\n\nSo I think we should include this proposition in the top of the module level documentation and comment that this allows us to worry only about orbit closures.",
    "created_at": "2010-12-03T16:11:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87393",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:19'></a>
Well, Fulton claims that quotients are the same even though the starting free groups are very different ;-)

So I think we should include this proposition in the top of the module level documentation and comment that this allows us to worry only about orbit closures.



---

archive/issue_comments_087394.json:
```json
{
    "body": "<a id='comment:20'></a>\nThe relevant paper is Fulton/MacPherson/Sottile/Sturmfels: Intersection theory on spherical varieties. The bottom line is that, for any connected solvable linear algebraic group G acting on a scheme, the G-Chow group (made out of G-invariant cycles) is canonically the same as the ordinary Chow group. I think I knew this paper at one point, but then obviously forgot ;-)",
    "created_at": "2010-12-03T16:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87394",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:20'></a>
The relevant paper is Fulton/MacPherson/Sottile/Sturmfels: Intersection theory on spherical varieties. The bottom line is that, for any connected solvable linear algebraic group G acting on a scheme, the G-Chow group (made out of G-invariant cycles) is canonically the same as the ordinary Chow group. I think I knew this paper at one point, but then obviously forgot ;-)



---

archive/issue_comments_087395.json:
```json
{
    "body": "<a id='comment:21'></a>\n1. The discussed above fact that this patch implement the full Chow group should be reflected in module level documentation.\n   1. Documentation from `ChowCycle.__init__` should be moved to the class docstring, otherwise it is invisible.\n   2. Behaviour of `check=False` is strange for it: usually such an option omits validity checks assuming that user will take care of it. Here it seems to allow a different form of input. Is it inherited from the base class? If so, maybe it should be fixed there...\n   3. Line 170 misses the second \":\" in the end.\n   4. The first words of some docstrings have extra s'es, like \"Returns\" and \"Intersects\".\n   5. It would be nice if the documentation and example for `count_points` were expanded/clarified a little bit more. The phrase \"integral over the dual cohomology class\" does not make it clear what is the integrand and to what the cohomology class is dual. Is it the Chow cycle in both cases? The example starts with a divisor and then integrates the square of this divisor and counts points on the intersection of the Chow cycle of this divisor with the original divisor. How about starting with some Chow cycle with non-zero point count and then showing how to get a corresponding cohomology class and integrate it?\n   6. For `intersect_with_divisor` it would be nice to give a reference to the used algorithm (Fulton p.97?). I think also that `intersection_with_divisor` would be a better name, since the function returns the intersection rather than updates the original cycle. (I do realize now that the same consideration should have been applied to some methods that I have added...) By the way, this function has no input/output description. And perhaps `i = I_gamma.pop()` does the same thing as `i = iter(I_gamma).next()` in a little cleaner fashion. (It does alter the set, but it is not used anyway.) What exactly is tested by the long test with many zeros in this function? This function says that divisor must be Cartier, but it is not checked, is it intended? Am I right that it actually makes sense to use it with Q-Cartier divisors if the Chow group is also rational?\n   7. `Chow_cycle` method of toric divisors does not have a doctest and input/output description.\n   8. Line 394 misses closing quotes after True.\n\nI didn't go over actual Chow group code yet, but will do it. Soon ;-)",
    "created_at": "2010-12-05T04:24:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87395",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:21'></a>
1. The discussed above fact that this patch implement the full Chow group should be reflected in module level documentation.
   1. Documentation from `ChowCycle.__init__` should be moved to the class docstring, otherwise it is invisible.
   2. Behaviour of `check=False` is strange for it: usually such an option omits validity checks assuming that user will take care of it. Here it seems to allow a different form of input. Is it inherited from the base class? If so, maybe it should be fixed there...
   3. Line 170 misses the second ":" in the end.
   4. The first words of some docstrings have extra s'es, like "Returns" and "Intersects".
   5. It would be nice if the documentation and example for `count_points` were expanded/clarified a little bit more. The phrase "integral over the dual cohomology class" does not make it clear what is the integrand and to what the cohomology class is dual. Is it the Chow cycle in both cases? The example starts with a divisor and then integrates the square of this divisor and counts points on the intersection of the Chow cycle of this divisor with the original divisor. How about starting with some Chow cycle with non-zero point count and then showing how to get a corresponding cohomology class and integrate it?
   6. For `intersect_with_divisor` it would be nice to give a reference to the used algorithm (Fulton p.97?). I think also that `intersection_with_divisor` would be a better name, since the function returns the intersection rather than updates the original cycle. (I do realize now that the same consideration should have been applied to some methods that I have added...) By the way, this function has no input/output description. And perhaps `i = I_gamma.pop()` does the same thing as `i = iter(I_gamma).next()` in a little cleaner fashion. (It does alter the set, but it is not used anyway.) What exactly is tested by the long test with many zeros in this function? This function says that divisor must be Cartier, but it is not checked, is it intended? Am I right that it actually makes sense to use it with Q-Cartier divisors if the Chow group is also rational?
   7. `Chow_cycle` method of toric divisors does not have a doctest and input/output description.
   8. Line 394 misses closing quotes after True.

I didn't go over actual Chow group code yet, but will do it. Soon ;-)



---

archive/issue_events_072276.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-05T04:24:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72276"
}
```



---

archive/issue_events_072277.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-05T04:24:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72277"
}
```



---

archive/issue_comments_087396.json:
```json
{
    "body": "<a id='comment:22'></a>\n10. It is probably worth mentioning what is the point of `A(Cone(cone))` after `A(cone)`. I actually didn't even know that `Cone(cone)` works! Fortunately, it works as expected ;-)\n   11. In `_rational_equivalence_relations` I find it very difficult to understand the LaTeX expression, which does not get typeset in the documentation (since it is a private method), especially since it does not explain what is \"! over =\", what is `n_{\\rho, \\sigma}`, and how d, k, n, and p are related (I guess pairs of them are equal). I think that this description should be moved to some visible place (module documentation or `relation_gens`?) and there should be a reference to where it was taken from.\n   22. What is the purpose of the super call in `__eq__` for Chow groups? Do we want anything but a Chow group equal to a Chow group?\n   33. I think that `_cone_to_V` would be more efficient if it was implemented via a dictionary. I don't know how significant such a speed up will be in real computations, but I think it is worthwhile to do this change.\n   44. There is a note in `degree` method about smooth varieties: \"Using the cohomology ring instead of the Chow group will be much faster.\" I think that this is a very important point and it should be also mentioned in the module level documentation and in the Chow group method of toric varieties. (Perhaps with explanations of why this is the case.) Examples of this method are very nice! I'd remove the sentence \"The resulting fan is not the fan over a convex cube.\"\n   55. I think it would be more natural if `gens` without parameters returned the union of all `gens` of specified degree. Is it possible to implement? (I.e. is it possible to force the quotient module to use these generators? I definitely don't suggest \"just\" returning union of degree generators.)\n   66. For `relation_gens` wouldn't it be more natural to return elements of the covering module, i.e. lifts of the current output?\n   77. Line 979: you meant `== QQ`.\n   88. Would it make sense to derive `ChowGroup_degree_class` from some kind of a group rather than `SageObject`?\n\nThat's it for the current patch!",
    "created_at": "2010-12-07T06:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87396",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:22'></a>
10. It is probably worth mentioning what is the point of `A(Cone(cone))` after `A(cone)`. I actually didn't even know that `Cone(cone)` works! Fortunately, it works as expected ;-)
   11. In `_rational_equivalence_relations` I find it very difficult to understand the LaTeX expression, which does not get typeset in the documentation (since it is a private method), especially since it does not explain what is "! over =", what is `n_{\rho, \sigma}`, and how d, k, n, and p are related (I guess pairs of them are equal). I think that this description should be moved to some visible place (module documentation or `relation_gens`?) and there should be a reference to where it was taken from.
   22. What is the purpose of the super call in `__eq__` for Chow groups? Do we want anything but a Chow group equal to a Chow group?
   33. I think that `_cone_to_V` would be more efficient if it was implemented via a dictionary. I don't know how significant such a speed up will be in real computations, but I think it is worthwhile to do this change.
   44. There is a note in `degree` method about smooth varieties: "Using the cohomology ring instead of the Chow group will be much faster." I think that this is a very important point and it should be also mentioned in the module level documentation and in the Chow group method of toric varieties. (Perhaps with explanations of why this is the case.) Examples of this method are very nice! I'd remove the sentence "The resulting fan is not the fan over a convex cube."
   55. I think it would be more natural if `gens` without parameters returned the union of all `gens` of specified degree. Is it possible to implement? (I.e. is it possible to force the quotient module to use these generators? I definitely don't suggest "just" returning union of degree generators.)
   66. For `relation_gens` wouldn't it be more natural to return elements of the covering module, i.e. lifts of the current output?
   77. Line 979: you meant `== QQ`.
   88. Would it make sense to derive `ChowGroup_degree_class` from some kind of a group rather than `SageObject`?

That's it for the current patch!



---

archive/issue_comments_087397.json:
```json
{
    "body": "<a id='comment:23'></a>\nOne more global question: did you think about having most of the functionality in `ChowGroup_degree_class` with Chow cycles being tuples of elements from all of them, i.e. without having the total quotient module? That would take care of some of the issues above (like gens vs. gens(degree=k)) and would avoid `flatten(fan.cones())` which I don't really like. It would also make sense to let fans determine indices of the cones in the lists in this case, i.e. `fan._index_of(cone)` would return the index of cone in `fan.cones(dim=cone.dim())`.",
    "created_at": "2010-12-07T16:24:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87397",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:23'></a>
One more global question: did you think about having most of the functionality in `ChowGroup_degree_class` with Chow cycles being tuples of elements from all of them, i.e. without having the total quotient module? That would take care of some of the issues above (like gens vs. gens(degree=k)) and would avoid `flatten(fan.cones())` which I don't really like. It would also make sense to let fans determine indices of the cones in the lists in this case, i.e. `fan._index_of(cone)` would return the index of cone in `fan.cones(dim=cone.dim())`.



---

archive/issue_comments_087398.json:
```json
{
    "body": "<a id='comment:24'></a>\nWhen I wrote the code I tried to make `gens()` return the union of the the fixed-degree generators but that did not work. I don't remember what exactly went wrong, but bad things happen if `gens()` is different from the generators that `FGP_Module` choses.\n\nI mostly added `ChowGroup_degree_class` so that the individual degree pieces can `_repr_()` themselves nicely. One could make them parents again with some coercion in the full Chow group, but that seems to be a big effort. I definitely want to allow mixed-degree Chow group elements, so we can't get rid of the whole Chow group.",
    "created_at": "2010-12-07T17:00:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87398",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:24'></a>
When I wrote the code I tried to make `gens()` return the union of the the fixed-degree generators but that did not work. I don't remember what exactly went wrong, but bad things happen if `gens()` is different from the generators that `FGP_Module` choses.

I mostly added `ChowGroup_degree_class` so that the individual degree pieces can `_repr_()` themselves nicely. One could make them parents again with some coercion in the full Chow group, but that seems to be a big effort. I definitely want to allow mixed-degree Chow group elements, so we can't get rid of the whole Chow group.



---

archive/issue_comments_087399.json:
```json
{
    "body": "<a id='comment:25'></a>\nA1. The discussed above fact that this patch implement the full Chow group should be reflected in module level documentation.\n\n    OK\n\n\nA2. Documentation from `ChowCycle.__init__` should be moved to the class docstring, otherwise it is invisible.\n\n    I've added a note to the `ChowCycle` class documentation that you are not supposed to manually construct them. The `__init__` docstring is hidden on purpose.\n\n\nA3. Behaviour of check=False is strange for it: usually such an option omits validity checks assuming that user will take care of it. Here it seems to allow a different form of input. Is it inherited from the base class? If so, maybe it should be fixed there...\n\n    Yes, it is inherited from `FGP_Element`. I tried to fix it there, but then I ended up trying to rewrite it for the new coercion model. And that attempt was quite unsuccessful, all of sage.modules is interrelated and you can't just change one class...\n\n\nA4. Line 170 misses the second `\":\"` in the end.\n\n    OK\n\n\nA5. The first words of some docstrings have extra `s`'es, like \"Returns\" and \"Intersects\".\n\n    OK\n\n\nA6. It would be nice if the documentation and example for `count_points` were expanded/clarified a little bit more. The  phrase `\"integral over the dual cohomology class\"` does not make it clear what is the integrand and to what the cohomology class is dual. Is it the Chow cycle in both cases? The example starts with a divisor and then integrates the square of this divisor and counts points on the intersection of the Chow cycle of this divisor with the original divisor. How about starting with some Chow cycle with non-zero point count and then showing how to get a corresponding cohomology class and integrate it?\n\n    There is no easy way to get the Poincare dual (In fact, it exists only if the variety is smooth). I've clarified the example a bit.\n\n\nA7. For `intersect_with_divisor` it would be nice to give a reference to the used algorithm (Fulton p.97?). I think also that `intersection_with_divisor` would be a better name, since the function returns the intersection rather than updates the original cycle. (I do realize now that the same consideration should have been applied to some methods that I have added...) By the way, this function has no input/output description. And perhaps `i = _gamma.pop()` does the same thing as `i = iter(I_gamma).next()` in a little cleaner fashion. (It does alter the set, but it is not used anyway.) What exactly is tested by the long test with many zeros in this function? This function says that divisor must be Cartier, but it is not checked, is it intended?  Am I right that it actually makes sense to use it with Q-Cartier divisors if the Chow group is also rational?\n\n    I renamed it to `intersection_with_divisor()` and expanded on the documentation which should now answer your questions...\n\n\n    In principle you are right with the Q-Cartier divisors, but in practice this will not work because multiplication QQ * QQ-Chow cycle is broken. The problem is that the parent does not adhere to the new coercion model. I could hack around it, but then this should really be fixed elsewhere.\n\n\nA8. `Chow_cycle` method of toric divisors does not have a doctest and input/output description.\n\n    OK\n\n\nA9. Line 394 misses closing quotes after True.\n\n    OK\n\n\nB1. It is probably worth mentioning what is the point of A(Cone(cone)) after A(cone). I actually didn't even know that Cone(cone) works! Fortunately, it works as expected ;-)\n\n    OK\n\n\nB2. In `_rational_equivalence_relations` I find it very difficult to understand the LaTeX expression, which does not get typeset in the documentation (since it is a private method), especially since it does not explain what is `\"! over =\"`, what is `n_{\\rho, \\sigma}`, and how d, k, n, and p are related (I guess pairs of them are  equal). I think that this description should be moved to some  visible place (module documentation or relation_gens?) and there should be a reference to where it was taken from.\n\n    I moved it to `relation_gens` and added more explanations.\n\n\nB3. What is the purpose of the super call in `__eq__` for Chow groups? Do we want anything but a Chow group equal to a Chow group?\n\n    Now it only returns `self is other`.\n\n\nB4. I think that `_cone_to_V` would be more efficient if it was implemented via a dictionary. I don't know how significant such a speed up will be in real computations, but I think it is worthwhile to do this change.\n\n    Its only constructing a unit vector. Surely the run time for intersection computations is dominated by the matrix normal form computations and not the construction of unit vectors?\n\n\nB5. There is a note in degree method about smooth varieties: \"Using the cohomology ring instead of the Chow group will be much faster.\" I think that this is a very important point and it should be also mentioned in the module level documentation and in the Chow group method of toric varieties. (Perhaps with explanations of why this is the case.) Examples of this method are very nice! I'd remove the sentence \"The resulting fan is not the fan over a convex cube.\"\n\n    OK\n\nB6. I think it would be more natural if gens without parameters returned the union of all gens of specified degree. Is it possible to implement? (I.e. is it possible to force the quotient module to use these generators? I definitely don't suggest \"just\" returning union of degree generators.)\n\n    I tried it but couldn't get it to work. The base `FGP_Module` has no provision to explicitly set the generators, and bad things happen if they are different from the internal normal form of the basis matrix.\n\n\nB7. For `relation_gens` wouldn't it be more natural to return elements of the covering module, i.e. lifts of the current output?\n\n    You can do that with `A.relations().gens()`. I added a note to `relation_gens`.\n\n\nB8. Line 979: you meant `== QQ`.\n \n    Yes, fixed.\n\n\nB9. Would it make sense to derive `ChowGroup_degree_class` from some kind of a group rather than `SageObject`?\n\n    Ideally they would be some other parents with coercions into the full (mixed-degree) Chow group. But then thats a lot of work for very little benefit. Not to mention that the base `FGP_Module` does not adhere to the new coercion model, so it'll be hackisch...",
    "created_at": "2010-12-15T21:02:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87399",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:25'></a>
A1. The discussed above fact that this patch implement the full Chow group should be reflected in module level documentation.

    OK


A2. Documentation from `ChowCycle.__init__` should be moved to the class docstring, otherwise it is invisible.

    I've added a note to the `ChowCycle` class documentation that you are not supposed to manually construct them. The `__init__` docstring is hidden on purpose.


A3. Behaviour of check=False is strange for it: usually such an option omits validity checks assuming that user will take care of it. Here it seems to allow a different form of input. Is it inherited from the base class? If so, maybe it should be fixed there...

    Yes, it is inherited from `FGP_Element`. I tried to fix it there, but then I ended up trying to rewrite it for the new coercion model. And that attempt was quite unsuccessful, all of sage.modules is interrelated and you can't just change one class...


A4. Line 170 misses the second `":"` in the end.

    OK


A5. The first words of some docstrings have extra `s`'es, like "Returns" and "Intersects".

    OK


A6. It would be nice if the documentation and example for `count_points` were expanded/clarified a little bit more. The  phrase `"integral over the dual cohomology class"` does not make it clear what is the integrand and to what the cohomology class is dual. Is it the Chow cycle in both cases? The example starts with a divisor and then integrates the square of this divisor and counts points on the intersection of the Chow cycle of this divisor with the original divisor. How about starting with some Chow cycle with non-zero point count and then showing how to get a corresponding cohomology class and integrate it?

    There is no easy way to get the Poincare dual (In fact, it exists only if the variety is smooth). I've clarified the example a bit.


A7. For `intersect_with_divisor` it would be nice to give a reference to the used algorithm (Fulton p.97?). I think also that `intersection_with_divisor` would be a better name, since the function returns the intersection rather than updates the original cycle. (I do realize now that the same consideration should have been applied to some methods that I have added...) By the way, this function has no input/output description. And perhaps `i = _gamma.pop()` does the same thing as `i = iter(I_gamma).next()` in a little cleaner fashion. (It does alter the set, but it is not used anyway.) What exactly is tested by the long test with many zeros in this function? This function says that divisor must be Cartier, but it is not checked, is it intended?  Am I right that it actually makes sense to use it with Q-Cartier divisors if the Chow group is also rational?

    I renamed it to `intersection_with_divisor()` and expanded on the documentation which should now answer your questions...


    In principle you are right with the Q-Cartier divisors, but in practice this will not work because multiplication QQ * QQ-Chow cycle is broken. The problem is that the parent does not adhere to the new coercion model. I could hack around it, but then this should really be fixed elsewhere.


A8. `Chow_cycle` method of toric divisors does not have a doctest and input/output description.

    OK


A9. Line 394 misses closing quotes after True.

    OK


B1. It is probably worth mentioning what is the point of A(Cone(cone)) after A(cone). I actually didn't even know that Cone(cone) works! Fortunately, it works as expected ;-)

    OK


B2. In `_rational_equivalence_relations` I find it very difficult to understand the LaTeX expression, which does not get typeset in the documentation (since it is a private method), especially since it does not explain what is `"! over ="`, what is `n_{\rho, \sigma}`, and how d, k, n, and p are related (I guess pairs of them are  equal). I think that this description should be moved to some  visible place (module documentation or relation_gens?) and there should be a reference to where it was taken from.

    I moved it to `relation_gens` and added more explanations.


B3. What is the purpose of the super call in `__eq__` for Chow groups? Do we want anything but a Chow group equal to a Chow group?

    Now it only returns `self is other`.


B4. I think that `_cone_to_V` would be more efficient if it was implemented via a dictionary. I don't know how significant such a speed up will be in real computations, but I think it is worthwhile to do this change.

    Its only constructing a unit vector. Surely the run time for intersection computations is dominated by the matrix normal form computations and not the construction of unit vectors?


B5. There is a note in degree method about smooth varieties: "Using the cohomology ring instead of the Chow group will be much faster." I think that this is a very important point and it should be also mentioned in the module level documentation and in the Chow group method of toric varieties. (Perhaps with explanations of why this is the case.) Examples of this method are very nice! I'd remove the sentence "The resulting fan is not the fan over a convex cube."

    OK

B6. I think it would be more natural if gens without parameters returned the union of all gens of specified degree. Is it possible to implement? (I.e. is it possible to force the quotient module to use these generators? I definitely don't suggest "just" returning union of degree generators.)

    I tried it but couldn't get it to work. The base `FGP_Module` has no provision to explicitly set the generators, and bad things happen if they are different from the internal normal form of the basis matrix.


B7. For `relation_gens` wouldn't it be more natural to return elements of the covering module, i.e. lifts of the current output?

    You can do that with `A.relations().gens()`. I added a note to `relation_gens`.


B8. Line 979: you meant `== QQ`.
 
    Yes, fixed.


B9. Would it make sense to derive `ChowGroup_degree_class` from some kind of a group rather than `SageObject`?

    Ideally they would be some other parents with coercions into the full (mixed-degree) Chow group. But then thats a lot of work for very little benefit. Not to mention that the base `FGP_Module` does not adhere to the new coercion model, so it'll be hackisch...



---

archive/issue_events_072278.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-16T18:16:07Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "milestone": "sage-4.6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72278"
}
```



---

archive/issue_events_072279.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-16T18:16:07Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "milestone": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72279"
}
```



---

archive/issue_events_072280.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-16T18:16:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72280"
}
```



---

archive/issue_events_072281.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-12-16T18:16:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72281"
}
```



---

archive/issue_comments_087400.json:
```json
{
    "body": "<a id='comment:26'></a>\nFor the buildbot: Depends on #9972 and #10325",
    "created_at": "2010-12-16T18:16:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87400",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:26'></a>
For the buildbot: Depends on #9972 and #10325



---

archive/issue_comments_087401.json:
```json
{
    "body": "<a id='comment:27'></a>\nWait, I'm still meddling with the coercions...",
    "created_at": "2010-12-16T20:20:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87401",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:27'></a>
Wait, I'm still meddling with the coercions...



---

archive/issue_events_072282.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-16T20:20:59Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72282"
}
```



---

archive/issue_events_072283.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-16T20:20:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72283"
}
```



---

archive/issue_comments_087402.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [vbraun](#comment%3A25):\n\nA3. OK, let's hope it will get fixed eventually...\n\nA6. Am I right that it is integral OF the dual cohomology class, not OVER? That's how I interpret `integrate` method of toric varieties. Also it seems that we need completeness in addition to smoothness.\n\nA7. Let it be fixed elsewhere!\n\nB9. Ok, let it be as is.\n\nFresh comments:\n\n1. Why `get_degree` and not just `degree` for Chow cycles?\n2. What will `cohomology_class` of a Chow cycle produce in the case when there is no Poincare duality? I think this should be either explained in the documentation, or an exception should be raised varieties which are not smooth and complete.\n\nI have done some documentation prettification, feel free to fold it into your patch, if is still applies to your current version.",
    "created_at": "2010-12-16T21:07:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87402",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:28'></a>
Replying to [vbraun](#comment%3A25):

A3. OK, let's hope it will get fixed eventually...

A6. Am I right that it is integral OF the dual cohomology class, not OVER? That's how I interpret `integrate` method of toric varieties. Also it seems that we need completeness in addition to smoothness.

A7. Let it be fixed elsewhere!

B9. Ok, let it be as is.

Fresh comments:

1. Why `get_degree` and not just `degree` for Chow cycles?
2. What will `cohomology_class` of a Chow cycle produce in the case when there is no Poincare duality? I think this should be either explained in the documentation, or an exception should be raised varieties which are not smooth and complete.

I have done some documentation prettification, feel free to fold it into your patch, if is still applies to your current version.



---

archive/attachments_012473.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9713_reviewer.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/trac_9713_reviewer.patch",
    "created_at": "2010-12-16T21:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/novoselt"
}
```



---

archive/issue_comments_087403.json:
```json
{
    "body": "",
    "created_at": "2010-12-16T21:07:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87403",
    "user": "https://github.com/novoselt"
}
```





---

archive/issue_comments_087404.json:
```json
{
    "body": "<a id='comment:29'></a>\nA6. Yes, integral \"of\". Will fix it ;-)\n\n1. `ChowGroup.degree()` is probably a stupid name... ideas for better names? But I wanted to distinguish it from `ChowCycle.degree()`.\n\n2. There is no `ChowCycle.cohomology_class()` method nor any coercion to the `CohomologyRing`.",
    "created_at": "2010-12-16T22:01:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87404",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:29'></a>
A6. Yes, integral "of". Will fix it ;-)

1. `ChowGroup.degree()` is probably a stupid name... ideas for better names? But I wanted to distinguish it from `ChowCycle.degree()`.

2. There is no `ChowCycle.cohomology_class()` method nor any coercion to the `CohomologyRing`.



---

archive/issue_comments_087405.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [vbraun](#comment%3A29):\n> 1. `ChowGroup.degree()` is probably a stupid name... ideas for better names? But I wanted to distinguish it from `ChowCycle.degree()`.\n\n\nI meant that `ChowCycle.degree()` is better than `ChowCycle.get_degree()` defined on line 243. It seems fine to me, why don't you like it?\n \n> 2. There is no `ChowCycle.cohomology_class()` method nor any coercion to the `CohomologyRing`.\n\n\nWhat about line 444?..",
    "created_at": "2010-12-16T22:30:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87405",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:30'></a>
Replying to [vbraun](#comment%3A29):
> 1. `ChowGroup.degree()` is probably a stupid name... ideas for better names? But I wanted to distinguish it from `ChowCycle.degree()`.


I meant that `ChowCycle.degree()` is better than `ChowCycle.get_degree()` defined on line 243. It seems fine to me, why don't you like it?
 
> 2. There is no `ChowCycle.cohomology_class()` method nor any coercion to the `CohomologyRing`.


What about line 444?..



---

archive/issue_comments_087406.json:
```json
{
    "body": "<a id='comment:31'></a>\nOops I totally forgot that I implemented the `cohomology_class()` method :-)\n\nI ported the bases Module and FGP_Module over to the new coercion model. The patch touches a lot of files but mostly small fixes, only `sage/modules/module.py` and `sage/modules/fg_pid/*py` are modified big time.\n\nFor the tracbot: Apply trac_9713_fix_cardinality.patch, trac_9713_fix_fg_pid.patch, trac_9713_toric_chow_group.patch",
    "created_at": "2010-12-17T19:02:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87406",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:31'></a>
Oops I totally forgot that I implemented the `cohomology_class()` method :-)

I ported the bases Module and FGP_Module over to the new coercion model. The patch touches a lot of files but mostly small fixes, only `sage/modules/module.py` and `sage/modules/fg_pid/*py` are modified big time.

For the tracbot: Apply trac_9713_fix_cardinality.patch, trac_9713_fix_fg_pid.patch, trac_9713_toric_chow_group.patch



---

archive/issue_events_072284.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-20T11:15:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72284"
}
```



---

archive/issue_events_072285.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2010-12-20T11:15:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72285"
}
```



---

archive/issue_comments_087407.json:
```json
{
    "body": "<a id='comment:33'></a>\nI am about to create a new ticket whose purpose is to implement the new parent and coercion framework not only for the base class `sage.modules.module.Module`, but also for the most derived classes. In that regard, it goes beyond what is done in the patches here.\n\nMy to-be-created ticket will leave the `FGP_*` stuff almost unchanged. I suggest to include that to-be-created ticket as a new dependency (mentioning it in #9604 as well), so that the ticket here can concentrate on its \"real\" purpose, which is not coercion but toric Chow group.\n\nThen I would also provide a replacement of trac_9713_toric_chow_group.patch relative to the to-be-created ticket.\n\nA few words on trac_9713_toric_chow_group.patch: The `element_class` attribute of Parent is in fact a *lazy* attribute, that takes another attribute `Element` and mixes it with some category stuff before it turns `element_class` into an actual attribute. Hence, one should *not* directly set `element_class` (which is done in the patch), but should provide an attribute `Element` instead.\n\nMy to-be-created patch would actually preserve the `_element_class` (leading underscore) method, since it chooses the right element class and is already implemented for all sub-classes. But I would call it in the `__init__` method of the base class `sage.modules.module.Module` and assign its output to the `Element` attribute. In that way, it is most easy to implement the lazy `element_class` (no leading underscore) attribute as one is supposed to.\n\nAlso, the `__call__` method of fgp morphisms should probably be replaces by `_call_`, `_call_with_args` and perhaps `pushforward` (likely depending on #10496).\n\n\nBest regards, Simon",
    "created_at": "2010-12-22T08:20:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87407",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:33'></a>
I am about to create a new ticket whose purpose is to implement the new parent and coercion framework not only for the base class `sage.modules.module.Module`, but also for the most derived classes. In that regard, it goes beyond what is done in the patches here.

My to-be-created ticket will leave the `FGP_*` stuff almost unchanged. I suggest to include that to-be-created ticket as a new dependency (mentioning it in #9604 as well), so that the ticket here can concentrate on its "real" purpose, which is not coercion but toric Chow group.

Then I would also provide a replacement of trac_9713_toric_chow_group.patch relative to the to-be-created ticket.

A few words on trac_9713_toric_chow_group.patch: The `element_class` attribute of Parent is in fact a *lazy* attribute, that takes another attribute `Element` and mixes it with some category stuff before it turns `element_class` into an actual attribute. Hence, one should *not* directly set `element_class` (which is done in the patch), but should provide an attribute `Element` instead.

My to-be-created patch would actually preserve the `_element_class` (leading underscore) method, since it chooses the right element class and is already implemented for all sub-classes. But I would call it in the `__init__` method of the base class `sage.modules.module.Module` and assign its output to the `Element` attribute. In that way, it is most easy to implement the lazy `element_class` (no leading underscore) attribute as one is supposed to.

Also, the `__call__` method of fgp morphisms should probably be replaces by `_call_`, `_call_with_args` and perhaps `pushforward` (likely depending on #10496).


Best regards, Simon



---

archive/issue_events_072286.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-22T08:20:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72286"
}
```



---

archive/issue_events_072287.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-22T08:20:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72287"
}
```



---

archive/attachments_012474.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9713_fix_fg_pid_relative_10513.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/trac_9713_fix_fg_pid_relative_10513.patch",
    "created_at": "2010-12-22T09:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/simon-king-jena"
}
```



---

archive/issue_comments_087408.json:
```json
{
    "body": "Rebases trac_9713_fix_fg_pid.patch relative to #10513",
    "created_at": "2010-12-22T09:27:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87408",
    "user": "https://github.com/simon-king-jena"
}
```

Rebases trac_9713_fix_fg_pid.patch relative to #10513



---

archive/issue_comments_087409.json:
```json
{
    "body": "<a id='comment:34'></a>\nI just attached a version of trac_9713_fix_fg_pid.patch that is based on #10513. I'll add #10513 to the dependencies that are listed in #9604.\n\nI can not vouch for any passing doc tests, as I merely rebased the patch.",
    "created_at": "2010-12-22T09:31:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87409",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:34'></a>
I just attached a version of trac_9713_fix_fg_pid.patch that is based on #10513. I'll add #10513 to the dependencies that are listed in #9604.

I can not vouch for any passing doc tests, as I merely rebased the patch.



---

archive/issue_events_072288.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-22T09:31:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72288"
}
```



---

archive/issue_events_072289.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-22T09:31:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72289"
}
```



---

archive/issue_comments_087410.json:
```json
{
    "body": "<a id='comment:35'></a>\nSorry! Since #10513 needs much work, I should not make it a dependency for the ticket here. So, please disregard the patch trac_9713_fix_fg_pid_relative_10513.patch!\n\nI understood that you just want to implement the parent and category framework to an extent that allows you to implement the toric Chow group. Right? Then I think my remark on `_call_` and `pushforward` and `_call_with_args` of morphisms should be moved to a different ticket.\n\nSo, it remains \"needs review\".\n\nCheers,\nSimon",
    "created_at": "2010-12-22T13:32:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87410",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:35'></a>
Sorry! Since #10513 needs much work, I should not make it a dependency for the ticket here. So, please disregard the patch trac_9713_fix_fg_pid_relative_10513.patch!

I understood that you just want to implement the parent and category framework to an extent that allows you to implement the toric Chow group. Right? Then I think my remark on `_call_` and `pushforward` and `_call_with_args` of morphisms should be moved to a different ticket.

So, it remains "needs review".

Cheers,
Simon



---

archive/issue_comments_087411.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n The toric Chow group is a useful version of a homology theory for toric varieties, especially for singular varieties. The attached patch provides support for computing the toric Chow group as well as elementary intersection theory.\n \n-See tracker bug at #9604 to for the patch queue/dependencies.\n+See tracker bug at #9604 to for related patches.\n \n``````\n",
    "created_at": "2010-12-22T15:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87411",
    "user": "https://github.com/novoselt"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
 The toric Chow group is a useful version of a homology theory for toric varieties, especially for singular varieties. The attached patch provides support for computing the toric Chow group as well as elementary intersection theory.
 
-See tracker bug at #9604 to for the patch queue/dependencies.
+See tracker bug at #9604 to for related patches.
 
``````




---

archive/issue_comments_087412.json:
```json
{
    "body": "<a id='comment:36'></a>\nJust to make it clear: so far this ticket depends on #9972 and #10325 (both positively reviewed) on top of sage-4.6.1.alpha3, nothing else.",
    "created_at": "2010-12-22T15:53:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87412",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:36'></a>
Just to make it clear: so far this ticket depends on #9972 and #10325 (both positively reviewed) on top of sage-4.6.1.alpha3, nothing else.



---

archive/issue_comments_087413.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [novoselt](#comment%3A36):\n> Just to make it clear: so far this ticket depends on #9972 and #10325 (both positively reviewed) on top of sage-4.6.1.alpha3, nothing else.\n\n\nThank you for the clarification! I thought I had to apply *all* patches mentioned at #9604.",
    "created_at": "2010-12-22T17:24:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87413",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:37'></a>
Replying to [novoselt](#comment%3A36):
> Just to make it clear: so far this ticket depends on #9972 and #10325 (both positively reviewed) on top of sage-4.6.1.alpha3, nothing else.


Thank you for the clarification! I thought I had to apply *all* patches mentioned at #9604.



---

archive/attachments_012475.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9713_fix_fg_pid.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/trac_9713_fix_fg_pid.patch",
    "created_at": "2010-12-22T18:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_087414.json:
```json
{
    "body": "Renamed element_class -> Element",
    "created_at": "2010-12-22T18:16:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87414",
    "user": "https://github.com/vbraun"
}
```

Renamed element_class -> Element



---

archive/issue_comments_087415.json:
```json
{
    "body": "<a id='comment:38'></a>\nI've renamed `element_class` -> `Element` as per Simon's comment, thanks!\n\nMaybe Simon would be interested in reviewing the first two patches (`trac_9713_fix_cardinality.patch`, `trac_9713_fix_fg_pid.patch`) and Andrey the ` trac_9713_toric_chow_group.patch`? :-) Then we should make it into Sage-4.6.2...",
    "created_at": "2010-12-22T18:24:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87415",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:38'></a>
I've renamed `element_class` -> `Element` as per Simon's comment, thanks!

Maybe Simon would be interested in reviewing the first two patches (`trac_9713_fix_cardinality.patch`, `trac_9713_fix_fg_pid.patch`) and Andrey the ` trac_9713_toric_chow_group.patch`? :-) Then we should make it into Sage-4.6.2...



---

archive/issue_comments_087416.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [vbraun](#comment%3A38):\n> I've renamed `element_class` -> `Element` as per Simon's comment, thanks!\n> \n> Maybe Simon would be interested in reviewing the first two patches (`trac_9713_fix_cardinality.patch`, `trac_9713_fix_fg_pid.patch`) and Andrey the ` trac_9713_toric_chow_group.patch`? :-) Then we should make it into Sage-4.6.2...\n\n\nIn what order should the patches be applied? I first applied the patches from #9972 and #10325, then proceeded with `trac_9713_toric_chow_group.patch`, but one hunk of `trac_9713_fix_fg_pid.patch` failed.",
    "created_at": "2010-12-24T11:59:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87416",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:39'></a>
Replying to [vbraun](#comment%3A38):
> I've renamed `element_class` -> `Element` as per Simon's comment, thanks!
> 
> Maybe Simon would be interested in reviewing the first two patches (`trac_9713_fix_cardinality.patch`, `trac_9713_fix_fg_pid.patch`) and Andrey the ` trac_9713_toric_chow_group.patch`? :-) Then we should make it into Sage-4.6.2...


In what order should the patches be applied? I first applied the patches from #9972 and #10325, then proceeded with `trac_9713_toric_chow_group.patch`, but one hunk of `trac_9713_fix_fg_pid.patch` failed.



---

archive/issue_comments_087417.json:
```json
{
    "body": "<a id='comment:40'></a>\nSee also comment 31:\n\n* `trac_9713_fix_cardinality.patch`\n* `trac_9713_fix_fg_pid.patch`\n* `trac_9713_toric_chow_group.patch`",
    "created_at": "2010-12-24T14:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87417",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:40'></a>
See also comment 31:

* `trac_9713_fix_cardinality.patch`
* `trac_9713_fix_fg_pid.patch`
* `trac_9713_toric_chow_group.patch`



---

archive/issue_comments_087418.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [vbraun](#comment%3A40):\n> See also comment 31:\n> \n> * `trac_9713_fix_cardinality.patch`\n> * `trac_9713_fix_fg_pid.patch`\n\n\nNo, when I apply `trac_9713_fix_fg_pid.patch`, one out of 17 hunks fails, namely:\n\n```\n--- fgp_module.py\n+++ fgp_module.py\n@@ -539,7 +578,8 @@\n         \"\"\"\n         return other.is_submodule(self)\n\n-    def __call__(self, x, check=True):\n+\n+    def _element_constructor_(self, x, check=True):\n         \"\"\"\n         INPUT:\n\n```\n\nCheers,\nSimon",
    "created_at": "2010-12-24T20:11:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87418",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:41'></a>
Replying to [vbraun](#comment%3A40):
> See also comment 31:
> 
> * `trac_9713_fix_cardinality.patch`
> * `trac_9713_fix_fg_pid.patch`


No, when I apply `trac_9713_fix_fg_pid.patch`, one out of 17 hunks fails, namely:

```
--- fgp_module.py
+++ fgp_module.py
@@ -539,7 +578,8 @@
         """
         return other.is_submodule(self)

-    def __call__(self, x, check=True):
+
+    def _element_constructor_(self, x, check=True):
         """
         INPUT:

```

Cheers,
Simon



---

archive/issue_comments_087419.json:
```json
{
    "body": "<a id='comment:42'></a>\nWorks for me, which sage version are you trying to apply it to?\n\n```\n/home/vbraun/opt/sage-4.6.1.rc0/devel/sage\n[vbraun@volker-desktop sage]$ hg qpush -a\napplying trac_9972_add_cone_embedding.patch\napplying trac_9972_improve_element_constructors.patch\napplying trac_9972_remove_enhanced_cones_and_fans.patch\napplying trac_9972_add_fan_morphisms.patch\napplying trac_9972_fix_fan_warning.patch\napplying trac_10325_make_toric_CohomologyRing_unique.patch\napplying trac_9713_fix_cardinality.patch\napplying trac_9713_fix_fg_pid.patch\napplying trac_9713_toric_chow_group.patch\nnow at: trac_9713_toric_chow_group.patch\n```",
    "created_at": "2010-12-24T20:18:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87419",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:42'></a>
Works for me, which sage version are you trying to apply it to?

```
/home/vbraun/opt/sage-4.6.1.rc0/devel/sage
[vbraun@volker-desktop sage]$ hg qpush -a
applying trac_9972_add_cone_embedding.patch
applying trac_9972_improve_element_constructors.patch
applying trac_9972_remove_enhanced_cones_and_fans.patch
applying trac_9972_add_fan_morphisms.patch
applying trac_9972_fix_fan_warning.patch
applying trac_10325_make_toric_CohomologyRing_unique.patch
applying trac_9713_fix_cardinality.patch
applying trac_9713_fix_fg_pid.patch
applying trac_9713_toric_chow_group.patch
now at: trac_9713_toric_chow_group.patch
```



---

archive/issue_comments_087420.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [SimonKing](#comment%3A41):\n> No, when I apply `trac_9713_fix_fg_pid.patch`, one out of 17 hunks fails\n\n\nIt seems to me that this hunk has a totally wrong line number. The line\n\n```\n    def __call__(self, x, check=True):\n```\nis line number 446 in `fgp_module.py`.",
    "created_at": "2010-12-24T20:21:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87420",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:43'></a>
Replying to [SimonKing](#comment%3A41):
> No, when I apply `trac_9713_fix_fg_pid.patch`, one out of 17 hunks fails


It seems to me that this hunk has a totally wrong line number. The line

```
    def __call__(self, x, check=True):
```
is line number 446 in `fgp_module.py`.



---

archive/issue_comments_087421.json:
```json
{
    "body": "<a id='comment:44'></a>\nNo the `__call__` in `FGP_Module` is at line 542. Maybe you forgot to revert something in your sage library?\n\n```\n[vbraun@volker-desktop sage]$ hg qpop -a\nno patches applied\n[vbraun@volker-desktop sage]$ head -542 sage/modules/fg_pid/fgp_module.py | tail -1\n    def __call__(self, x, check=True):\n[vbraun@volker-desktop sage]$ \n```",
    "created_at": "2010-12-24T20:27:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87421",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:44'></a>
No the `__call__` in `FGP_Module` is at line 542. Maybe you forgot to revert something in your sage library?

```
[vbraun@volker-desktop sage]$ hg qpop -a
no patches applied
[vbraun@volker-desktop sage]$ head -542 sage/modules/fg_pid/fgp_module.py | tail -1
    def __call__(self, x, check=True):
[vbraun@volker-desktop sage]$ 
```



---

archive/issue_comments_087422.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [vbraun](#comment%3A42):\n> Works for me, which sage version are you trying to apply it to?\n\n\nsage-4.6\n\nSo, perhaps I should try to upgrade to sage-4.6.1.alpha3 first.\n\nIs there an easy way to use `sage -upgrade` for a development version?",
    "created_at": "2010-12-24T20:31:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87422",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:45'></a>
Replying to [vbraun](#comment%3A42):
> Works for me, which sage version are you trying to apply it to?


sage-4.6

So, perhaps I should try to upgrade to sage-4.6.1.alpha3 first.

Is there an easy way to use `sage -upgrade` for a development version?



---

archive/issue_comments_087423.json:
```json
{
    "body": "<a id='comment:46'></a>\nI usually build from scratch, but I believe the following should work:\n\n```\nsage -upgrade http://sage.math.washington.edu/home/release/sage-4.6.1.rc0/sage-4.6.1.rc0/\n```",
    "created_at": "2010-12-24T20:39:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87423",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:46'></a>
I usually build from scratch, but I believe the following should work:

```
sage -upgrade http://sage.math.washington.edu/home/release/sage-4.6.1.rc0/sage-4.6.1.rc0/
```



---

archive/issue_comments_087424.json:
```json
{
    "body": "<a id='comment:47'></a>\nReplying to [vbraun](#comment%3A46):\n> I usually build from scratch, but I believe the following should work:\n\n\nThanks, it did kind of work. At some point the process got stuck, but when I then did `make` in `SAGE_ROOT`, the upgrade did succeed (at least so it seems).\n\nThe patches apply. I don't know if I will be able to do reviewing any time soon, since currently I only have remote access to my computer via rather slow internet (237 kB/s).\n\nCheers, Simon",
    "created_at": "2010-12-25T09:21:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87424",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:47'></a>
Replying to [vbraun](#comment%3A46):
> I usually build from scratch, but I believe the following should work:


Thanks, it did kind of work. At some point the process got stuck, but when I then did `make` in `SAGE_ROOT`, the upgrade did succeed (at least so it seems).

The patches apply. I don't know if I will be able to do reviewing any time soon, since currently I only have remote access to my computer via rather slow internet (237 kB/s).

Cheers, Simon



---

archive/issue_comments_087425.json:
```json
{
    "body": "**Work_Issues:** element class",
    "created_at": "2010-12-25T21:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87425",
    "user": "https://github.com/simon-king-jena"
}
```

**Work_Issues:** element class



---

archive/issue_comments_087426.json:
```json
{
    "body": "<a id='comment:48'></a>\nI applied the patches on top of `sage-4.6.1.alpha3`, and the good news is that all tests pass.\n\nHowever, I have some criticism concerning `trac_9713_fix_fg_pid.patch`.\n\nIn several cases I see things like\n\n```\n        return self.parent().Element(self.parent(), self._x - other._x)\n```\n\nThat's not how the attribute `Element` is supposed to be used. As far as I know, the story is like this:\n\n* One provides an attribute `Element`, which is supposed to be a class.\n\n* `Parent.element_class` is a so-called lazy attribute. That's to say, if one does `self.element_class` then the *method* `self.element_class()` is called, which computes a *new* class out of `self.Element` and `self.category()`, assigns this new class to an actual (not lazy) attribute `self.element_class`, and returns that new class.\n\n* When one requests `self.element_class` is called the next time then it is already a usual attribute, which is of course much faster than calling a method.\n\nHence, you should define `self.Element`. But then you should do\n\n```\n        P = self.parent()\n        return P.element_class(P, self._x - other._x) \n```\nsince `P.element_class` (in contrast to `P.Element`) also inherits stuff from the category. Note that additionally the code snipped spares a little time compared with your patch since `self.parent()` is called only once instead of twice.\n\nAs I mentioned, my bandwith is a bit restricted at the moment. So, this post might be incomplete, it is just what I found by a little reading of the patch.",
    "created_at": "2010-12-25T21:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87426",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:48'></a>
I applied the patches on top of `sage-4.6.1.alpha3`, and the good news is that all tests pass.

However, I have some criticism concerning `trac_9713_fix_fg_pid.patch`.

In several cases I see things like

```
        return self.parent().Element(self.parent(), self._x - other._x)
```

That's not how the attribute `Element` is supposed to be used. As far as I know, the story is like this:

* One provides an attribute `Element`, which is supposed to be a class.

* `Parent.element_class` is a so-called lazy attribute. That's to say, if one does `self.element_class` then the *method* `self.element_class()` is called, which computes a *new* class out of `self.Element` and `self.category()`, assigns this new class to an actual (not lazy) attribute `self.element_class`, and returns that new class.

* When one requests `self.element_class` is called the next time then it is already a usual attribute, which is of course much faster than calling a method.

Hence, you should define `self.Element`. But then you should do

```
        P = self.parent()
        return P.element_class(P, self._x - other._x) 
```
since `P.element_class` (in contrast to `P.Element`) also inherits stuff from the category. Note that additionally the code snipped spares a little time compared with your patch since `self.parent()` is called only once instead of twice.

As I mentioned, my bandwith is a bit restricted at the moment. So, this post might be incomplete, it is just what I found by a little reading of the patch.



---

archive/issue_comments_087427.json:
```json
{
    "body": "**Changing reviewer** from \"Andrey Novoseltsev\" to \"Andrey Novoseltsev, Simon King\".",
    "created_at": "2010-12-25T21:06:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87427",
    "user": "https://github.com/simon-king-jena"
}
```

**Changing reviewer** from "Andrey Novoseltsev" to "Andrey Novoseltsev, Simon King".



---

archive/issue_events_072290.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-25T21:06:34Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72290"
}
```



---

archive/issue_events_072291.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-25T21:06:34Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72291"
}
```



---

archive/attachments_012476.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9713_fix_fg_pid_reviewer.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/trac_9713_fix_fg_pid_reviewer.patch",
    "created_at": "2010-12-27T16:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/simon-king-jena"
}
```



---

archive/issue_comments_087428.json:
```json
{
    "body": "Apply after  trac_9713_fix_fg_pid.patch: Element vs. element_class; indirect doctests",
    "created_at": "2010-12-27T16:35:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87428",
    "user": "https://github.com/simon-king-jena"
}
```

Apply after  trac_9713_fix_fg_pid.patch: Element vs. element_class; indirect doctests



---

archive/issue_comments_087429.json:
```json
{
    "body": "<a id='comment:49'></a>\nHi Volker and Andrey!\n\nReplying to [vbraun](#comment%3A38):\n> I've renamed `element_class` -> `Element` as per Simon's comment, thanks!\n\n\nAs I've pointed out in my previous post, one should *define* `self.Element`, but then the actual element class is `self.element_class`. This is taken care of in my reviewer patch, `trac_9713_fix_fg_pid_reviewer.patch`. Some doctests needed to be modified accordingly. The reviewer patch also raises the doctest coverage of `sage.modules.fg_pid` to 100% (some indirect tests had not been marked as such).\n\n> Maybe Simon would be interested in reviewing the first two patches (`trac_9713_fix_cardinality.patch`, `trac_9713_fix_fg_pid.patch`) and Andrey the ` trac_9713_toric_chow_group.patch`?\n\n\nI give `trac_9713_fix_cardinality.patch` and `trac_9713_fix_fg_pid.patch` (modulo my reviewer patch) a positive review. Of course, we all know that it does not provide a full implementation of the new parent and coercion model for modules; after all, that is not the purpose of this ticket. But apparently it is enough for implementing the toric chow group. So, I suggest to build a full implementation of coercion for modules on top of these patches.\n\n> Then we should make it into Sage-4.6.2...\n\n\nMy job is done. Andrey, your turn... :)",
    "created_at": "2010-12-27T16:51:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87429",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:49'></a>
Hi Volker and Andrey!

Replying to [vbraun](#comment%3A38):
> I've renamed `element_class` -> `Element` as per Simon's comment, thanks!


As I've pointed out in my previous post, one should *define* `self.Element`, but then the actual element class is `self.element_class`. This is taken care of in my reviewer patch, `trac_9713_fix_fg_pid_reviewer.patch`. Some doctests needed to be modified accordingly. The reviewer patch also raises the doctest coverage of `sage.modules.fg_pid` to 100% (some indirect tests had not been marked as such).

> Maybe Simon would be interested in reviewing the first two patches (`trac_9713_fix_cardinality.patch`, `trac_9713_fix_fg_pid.patch`) and Andrey the ` trac_9713_toric_chow_group.patch`?


I give `trac_9713_fix_cardinality.patch` and `trac_9713_fix_fg_pid.patch` (modulo my reviewer patch) a positive review. Of course, we all know that it does not provide a full implementation of the new parent and coercion model for modules; after all, that is not the purpose of this ticket. But apparently it is enough for implementing the toric chow group. So, I suggest to build a full implementation of coercion for modules on top of these patches.

> Then we should make it into Sage-4.6.2...


My job is done. Andrey, your turn... :)



---

archive/issue_events_072292.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-27T16:51:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72292"
}
```



---

archive/issue_events_072293.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2010-12-27T16:51:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72293"
}
```



---

archive/issue_comments_087430.json:
```json
{
    "body": "**Changing work_issues** from \"element class\" to \"\".",
    "created_at": "2010-12-27T16:51:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87430",
    "user": "https://github.com/simon-king-jena"
}
```

**Changing work_issues** from "element class" to "".



---

archive/issue_comments_087431.json:
```json
{
    "body": "<a id='comment:51'></a>\nThank you for the `element_class` explanation! I'm happy with the reviewer patch. I've updated the remaining (and final) patch to also use `element_class` in the Chow group, so we should be all set. Andrey, can you set this ticket to positive review?\n\nFor the tracbot: Apply trac_9713_fix_cardinality.patch, trac_9713_fix_fg_pid.patch, trac_9713_fix_fg_pid_reviewer.patch, trac_9713_toric_chow_group.patch",
    "created_at": "2010-12-27T19:11:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87431",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:51'></a>
Thank you for the `element_class` explanation! I'm happy with the reviewer patch. I've updated the remaining (and final) patch to also use `element_class` in the Chow group, so we should be all set. Andrey, can you set this ticket to positive review?

For the tracbot: Apply trac_9713_fix_cardinality.patch, trac_9713_fix_fg_pid.patch, trac_9713_fix_fg_pid_reviewer.patch, trac_9713_toric_chow_group.patch



---

archive/issue_comments_087432.json:
```json
{
    "body": "<a id='comment:52'></a>\nSimon, thanks a lot for your help!\n\nVolker, shouldn't variety be complete for Poincare duality in `cohomology_class`?\n\nIn its documentation \"will be not always match intersection numbers.\" should be \"will not always match intersection numbers.\" (or \"may not match intersection numbers.\")\n\nOtherwise tests pass and all issues above seem to be resolved!",
    "created_at": "2011-01-12T00:43:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87432",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:52'></a>
Simon, thanks a lot for your help!

Volker, shouldn't variety be complete for Poincare duality in `cohomology_class`?

In its documentation "will be not always match intersection numbers." should be "will not always match intersection numbers." (or "may not match intersection numbers.")

Otherwise tests pass and all issues above seem to be resolved!



---

archive/issue_comments_087433.json:
```json
{
    "body": "<a id='comment:53'></a>\nSo - do we need completeness and a check for it?-)",
    "created_at": "2011-01-14T01:14:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87433",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:53'></a>
So - do we need completeness and a check for it?-)



---

archive/issue_events_072294.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-14T01:14:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72294"
}
```



---

archive/issue_events_072295.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-14T01:14:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72295"
}
```



---

archive/issue_comments_087434.json:
```json
{
    "body": "<a id='comment:54'></a>\nI've extended the docstring to clarify when `cohomology_class()` is Poincare dual and when not. The added example should also clarify things.",
    "created_at": "2011-01-24T19:37:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87434",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:54'></a>
I've extended the docstring to clarify when `cohomology_class()` is Poincare dual and when not. The added example should also clarify things.



---

archive/issue_comments_087435.json:
```json
{
    "body": "<a id='comment:55'></a>\nCan we rephrase \"We can associate a degree-`d` polynomial in the homogeneous coordinates by taking the product of the variables corresponding to the rays.\" to something else? My concern is that these variables may have different weight and, in general, there is no Z-grading on a toric variety. Maybe \"We can associate to it the product of homogeneous coordinates corresponding to its rays.\"?\n\nRight before OUTPUT \"will be not always\" should be \"will not always\"",
    "created_at": "2011-01-24T20:43:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87435",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:55'></a>
Can we rephrase "We can associate a degree-`d` polynomial in the homogeneous coordinates by taking the product of the variables corresponding to the rays." to something else? My concern is that these variables may have different weight and, in general, there is no Z-grading on a toric variety. Maybe "We can associate to it the product of homogeneous coordinates corresponding to its rays."?

Right before OUTPUT "will be not always" should be "will not always"



---

archive/issue_comments_087436.json:
```json
{
    "body": "<a id='comment:56'></a>\nOk I've rewritten it to be more careful with \"degrees\".",
    "created_at": "2011-01-24T21:21:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87436",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:56'></a>
Ok I've rewritten it to be more careful with "degrees".



---

archive/issue_events_072296.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-24T22:44:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72296"
}
```



---

archive/issue_events_072297.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-24T22:44:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72297"
}
```



---

archive/issue_comments_087437.json:
```json
{
    "body": "<a id='comment:58'></a>\nHooray!",
    "created_at": "2011-01-24T22:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87437",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:58'></a>
Hooray!



---

archive/issue_events_072298.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-24T22:49:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72298"
}
```



---

archive/issue_events_072299.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-24T22:49:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72299"
}
```



---

archive/issue_comments_087438.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,3 +2,8 @@\n \n See tracker bug at #9604 to for related patches.\n \n+**Apply**:\n+1. [attachment:trac_9713_fix_cardinality.patch]\n+2. [attachment:trac_9713_fix_fg_pid.patch]\n+3. [attachment:trac_9713_fix_fg_pid_reviewer.patch]\n+4. [attachment:trac_9713_toric_chow_group.patch]\n``````\n",
    "created_at": "2011-01-26T10:25:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87438",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,3 +2,8 @@
 
 See tracker bug at #9604 to for related patches.
 
+**Apply**:
+1. [attachment:trac_9713_fix_cardinality.patch]
+2. [attachment:trac_9713_fix_fg_pid.patch]
+3. [attachment:trac_9713_fix_fg_pid_reviewer.patch]
+4. [attachment:trac_9713_toric_chow_group.patch]
``````




---

archive/issue_comments_087439.json:
```json
{
    "body": "**Work_Issues:** rebase",
    "created_at": "2011-01-26T10:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87439",
    "user": "https://github.com/jdemeyer"
}
```

**Work_Issues:** rebase



---

archive/issue_events_072300.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-26T10:39:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72300"
}
```



---

archive/issue_events_072301.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-26T10:39:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72301"
}
```



---

archive/issue_comments_087440.json:
```json
{
    "body": "<a id='comment:60'></a>\nNeeds to be rebased to sage-4.6.2.alpha2",
    "created_at": "2011-01-26T10:39:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87440",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:60'></a>
Needs to be rebased to sage-4.6.2.alpha2



---

archive/issue_comments_087441.json:
```json
{
    "body": "Rebased against sage-4.6.2.alpha2",
    "created_at": "2011-01-26T14:08:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87441",
    "user": "https://github.com/vbraun"
}
```

Rebased against sage-4.6.2.alpha2



---

archive/attachments_012477.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9713_fix_cardinality.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/trac_9713_fix_cardinality.patch",
    "created_at": "2011-01-26T14:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_087442.json:
```json
{
    "body": "Rebased against sage-4.6.2.alpha2",
    "created_at": "2011-01-26T14:08:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87442",
    "user": "https://github.com/vbraun"
}
```

Rebased against sage-4.6.2.alpha2



---

archive/issue_events_072302.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-01-26T14:09:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72302"
}
```



---

archive/issue_events_072303.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-01-26T14:09:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72303"
}
```



---

archive/issue_comments_087443.json:
```json
{
    "body": "<a id='comment:61'></a>\nRebased against sage-4.6.2.alpha2",
    "created_at": "2011-01-26T14:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87443",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:61'></a>
Rebased against sage-4.6.2.alpha2



---

archive/issue_comments_087444.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,5 +5,5 @@\n **Apply**:\n 1. [attachment:trac_9713_fix_cardinality.patch]\n 2. [attachment:trac_9713_fix_fg_pid.patch]\n-3. [attachment:trac_9713_fix_fg_pid_reviewer.patch]\n+3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]\n 4. [attachment:trac_9713_toric_chow_group.patch]\n``````\n",
    "created_at": "2011-01-26T14:09:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87444",
    "user": "https://github.com/vbraun"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,5 +5,5 @@
 **Apply**:
 1. [attachment:trac_9713_fix_cardinality.patch]
 2. [attachment:trac_9713_fix_fg_pid.patch]
-3. [attachment:trac_9713_fix_fg_pid_reviewer.patch]
+3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]
 4. [attachment:trac_9713_toric_chow_group.patch]
``````




---

archive/issue_comments_087445.json:
```json
{
    "body": "<a id='comment:62'></a>\nWhat was necessary in rebasing??? I still have my queue applied smoothly on alpha2!",
    "created_at": "2011-01-26T14:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87445",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:62'></a>
What was necessary in rebasing??? I still have my queue applied smoothly on alpha2!



---

archive/issue_comments_087446.json:
```json
{
    "body": "<a id='comment:63'></a>\nI haven't actually checked whether anything broke. I don't remember if I had to refresh any patches for 4.6.2.alpha2, I just believed Jeroen that there was a problem. In any case, can't hurt.",
    "created_at": "2011-01-26T14:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87446",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:63'></a>
I haven't actually checked whether anything broke. I don't remember if I had to refresh any patches for 4.6.2.alpha2, I just believed Jeroen that there was a problem. In any case, can't hurt.



---

archive/issue_comments_087447.json:
```json
{
    "body": "**Changing work_issues** from \"rebase\" to \"\".",
    "created_at": "2011-01-26T14:35:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87447",
    "user": "https://github.com/vbraun"
}
```

**Changing work_issues** from "rebase" to "".



---

archive/issue_comments_087448.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -4,6 +4,6 @@\n \n **Apply**:\n 1. [attachment:trac_9713_fix_cardinality.patch]\n-2. [attachment:trac_9713_fix_fg_pid.patch]\n+2. [attachment:trac_9713_fix_fg_pid.2.patch]\n 3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]\n 4. [attachment:trac_9713_toric_chow_group.patch]\n``````\n",
    "created_at": "2011-01-26T17:19:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87448",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -4,6 +4,6 @@
 
 **Apply**:
 1. [attachment:trac_9713_fix_cardinality.patch]
-2. [attachment:trac_9713_fix_fg_pid.patch]
+2. [attachment:trac_9713_fix_fg_pid.2.patch]
 3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]
 4. [attachment:trac_9713_toric_chow_group.patch]
``````




---

archive/issue_comments_087449.json:
```json
{
    "body": "<a id='comment:65'></a>\nOkay, there problem is slightly more involved: there is a conflict with #8948 (which is not yet merged in any alpha).  For totally arbitrary reasons I've decided to merge #8948 first, so could you please rebase your patches (at least [attachment:trac_9713_fix_fg_pid.2.patch]) to apply on top of #8948?",
    "created_at": "2011-01-26T17:23:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87449",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:65'></a>
Okay, there problem is slightly more involved: there is a conflict with #8948 (which is not yet merged in any alpha).  For totally arbitrary reasons I've decided to merge #8948 first, so could you please rebase your patches (at least [attachment:trac_9713_fix_fg_pid.2.patch]) to apply on top of #8948?



---

archive/issue_events_072304.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-26T17:23:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72304"
}
```



---

archive/issue_events_072305.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-26T17:23:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72305"
}
```



---

archive/attachments_012478.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9713_fix_fg_pid.2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/trac_9713_fix_fg_pid.2.patch",
    "created_at": "2011-01-26T22:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_087450.json:
```json
{
    "body": "Rebased patch.",
    "created_at": "2011-01-26T22:37:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87450",
    "user": "https://github.com/vbraun"
}
```

Rebased patch.



---

archive/issue_comments_087451.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,3 +7,5 @@\n 2. [attachment:trac_9713_fix_fg_pid.2.patch]\n 3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]\n 4. [attachment:trac_9713_toric_chow_group.patch]\n+\n+Depends on #8948.\n``````\n",
    "created_at": "2011-01-26T22:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87451",
    "user": "https://github.com/vbraun"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,3 +7,5 @@
 2. [attachment:trac_9713_fix_fg_pid.2.patch]
 3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]
 4. [attachment:trac_9713_toric_chow_group.patch]
+
+Depends on #8948.
``````




---

archive/issue_comments_087452.json:
```json
{
    "body": "<a id='comment:66'></a>\nRebased on top of Sage-4.6.2.alpha2+#8948.",
    "created_at": "2011-01-26T22:38:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87452",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:66'></a>
Rebased on top of Sage-4.6.2.alpha2+#8948.



---

archive/issue_events_072306.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-01-26T22:38:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72306"
}
```



---

archive/issue_events_072307.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-01-26T22:38:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72307"
}
```



---

archive/issue_comments_087453.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [vbraun](#comment%3A66):\n> Rebased on top of Sage-4.6.2.alpha2+#8948.\n\n\nThanks!  Patches apply fine now.  Sorry for the mess.",
    "created_at": "2011-01-26T22:47:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87453",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:68'></a>
Replying to [vbraun](#comment%3A66):
> Rebased on top of Sage-4.6.2.alpha2+#8948.


Thanks!  Patches apply fine now.  Sorry for the mess.



---

archive/issue_events_072308.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-27T09:13:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72308"
}
```



---

archive/issue_events_072309.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-27T09:13:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72309"
}
```



---

archive/issue_comments_087454.json:
```json
{
    "body": "**Merged:** sage-4.6.2.alpha3",
    "created_at": "2011-01-27T09:13:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87454",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.2.alpha3



---

archive/issue_comments_087455.json:
```json
{
    "body": "<a id='comment:70'></a>\nA doctest like this will **clearly** break on 32-bit systems:\n\n```\n    def __hash__(self):\n        \"\"\"\n        Return a hash value for the :class:`Module` instance.\n\n        OUTPUT:\n\n        An integer.\n\n        EXAMPLES::\n\n            sage: from sage.modules.module import Module\n            sage: M = Module(ZZ)\n            sage: M.__hash__()\n            6190647798068218210\n        \"\"\"\n        return hash(self.__repr__())\n```",
    "created_at": "2011-01-29T09:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87455",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:70'></a>
A doctest like this will **clearly** break on 32-bit systems:

```
    def __hash__(self):
        """
        Return a hash value for the :class:`Module` instance.

        OUTPUT:

        An integer.

        EXAMPLES::

            sage: from sage.modules.module import Module
            sage: M = Module(ZZ)
            sage: M.__hash__()
            6190647798068218210
        """
        return hash(self.__repr__())
```



---

archive/issue_comments_087456.json:
```json
{
    "body": "**Changing merged** from \"sage-4.6.2.alpha3\" to \"\".",
    "created_at": "2011-01-29T09:21:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87456",
    "user": "https://github.com/jdemeyer"
}
```

**Changing merged** from "sage-4.6.2.alpha3" to "".



---

archive/issue_events_072310.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-29T09:21:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72310"
}
```



---

archive/issue_comments_087457.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,5 +7,6 @@\n 2. [attachment:trac_9713_fix_fg_pid.2.patch]\n 3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]\n 4. [attachment:trac_9713_toric_chow_group.patch]\n+5. [attachment:9713_hash.patch]\n \n Depends on #8948.\n``````\n",
    "created_at": "2011-01-29T09:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87457",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,5 +7,6 @@
 2. [attachment:trac_9713_fix_fg_pid.2.patch]
 3. [attachment:trac_9713_fix_fg_pid_reviewer.2.patch]
 4. [attachment:trac_9713_toric_chow_group.patch]
+5. [attachment:9713_hash.patch]
 
 Depends on #8948.
``````




---

archive/issue_events_072311.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-29T09:45:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72311"
}
```



---

archive/issue_events_072312.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-29T09:45:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72312"
}
```



---

archive/issue_comments_087458.json:
```json
{
    "body": "**Changing reviewer** from \"Andrey Novoseltsev, Simon King\" to \"Andrey Novoseltsev, Simon King, Jeroen Demeyer\".",
    "created_at": "2011-01-29T09:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87458",
    "user": "https://github.com/jdemeyer"
}
```

**Changing reviewer** from "Andrey Novoseltsev, Simon King" to "Andrey Novoseltsev, Simon King, Jeroen Demeyer".



---

archive/attachments_012479.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "9713_hash.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/9713_hash.patch",
    "created_at": "2011-01-29T09:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/jdemeyer"
}
```



---

archive/issue_comments_087459.json:
```json
{
    "body": "<a id='comment:72'></a>\n",
    "created_at": "2011-01-29T09:45:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87459",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:72'></a>




---

archive/issue_events_072313.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-29T17:13:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72313"
}
```



---

archive/issue_events_072314.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2011-01-29T17:13:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72314"
}
```



---

archive/issue_comments_087460.json:
```json
{
    "body": "<a id='comment:73'></a>\nThanks for catching this!",
    "created_at": "2011-01-29T17:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87460",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:73'></a>
Thanks for catching this!



---

archive/issue_comments_087461.json:
```json
{
    "body": "<a id='comment:74'></a>\nI'm afraid I have to bother you again.  With this patch, the pdf reference manual fails to build:\n\n```\n! Missing $ inserted.\n<inserted text>\n                $\nl.532163 \\bibitem[wp:Chow_ring]{wp:Chow_ring}\n                                             {\\phantomsection\\label{sage/sch...\n\n?\n! Emergency stop.\n<inserted text>\n                $\nl.532163 \\bibitem[wp:Chow_ring]{wp:Chow_ring}\n                                             {\\phantomsection\\label{sage/sch...\n\n!  ==> Fatal error occurred, no output PDF file produced!\n```",
    "created_at": "2011-02-01T08:21:58Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87461",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:74'></a>
I'm afraid I have to bother you again.  With this patch, the pdf reference manual fails to build:

```
! Missing $ inserted.
<inserted text>
                $
l.532163 \bibitem[wp:Chow_ring]{wp:Chow_ring}
                                             {\phantomsection\label{sage/sch...

?
! Emergency stop.
<inserted text>
                $
l.532163 \bibitem[wp:Chow_ring]{wp:Chow_ring}
                                             {\phantomsection\label{sage/sch...

!  ==> Fatal error occurred, no output PDF file produced!
```



---

archive/issue_events_072315.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-01T08:21:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72315"
}
```



---

archive/issue_events_072316.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-01T08:21:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72316"
}
```



---

archive/attachments_012480.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9713_toric_chow_group.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9713/trac_9713_toric_chow_group.patch",
    "created_at": "2011-02-01T12:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/vbraun"
}
```



---

archive/issue_comments_087462.json:
```json
{
    "body": "Updated patch",
    "created_at": "2011-02-01T12:08:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87462",
    "user": "https://github.com/vbraun"
}
```

Updated patch



---

archive/issue_events_072317.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-02-01T12:11:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72317"
}
```



---

archive/issue_events_072318.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2011-02-01T12:11:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72318"
}
```



---

archive/issue_comments_087463.json:
```json
{
    "body": "<a id='comment:75'></a>\nI removed the underscore in the offending reference name. The pdf developer reference builds now if #10721 (Increase LaTeX POOL_SIZE) is applied.",
    "created_at": "2011-02-01T12:11:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87463",
    "user": "https://github.com/vbraun"
}
```

<a id='comment:75'></a>
I removed the underscore in the offending reference name. The pdf developer reference builds now if #10721 (Increase LaTeX POOL_SIZE) is applied.



---

archive/issue_comments_087464.json:
```json
{
    "body": "**Merged:** sage-4.6.2.alpha4",
    "created_at": "2011-02-07T08:13:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9713#issuecomment-87464",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.2.alpha4



---

archive/issue_events_072319.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-07T08:13:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72319"
}
```



---

archive/issue_events_072320.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-02-07T08:13:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9713",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9713#event-72320"
}
```
