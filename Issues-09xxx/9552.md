# Issue 9552: cython.py references the old sage notebook code

archive/issues_009552.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout"
    ],
    "body": " I noticed to my surprise that misc/cython.py has these lines in it (which should be fixed, of course):\n\n```\n import sage.server.support\n    d = {}\n    sage.server.support.cython_import_all(tmpfile, d,\n                                         verbose=verbose, compile_message=compile_message,\n                                         use_cache=use_cache,\n                                         create_local_c_file=False)\n```\n\nCC:  @kiwifb\n\nBranch/Commit: **[1fc034e](https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586)**\n\nReviewer: **Fran\u00e7ois Bissey**\n\nAuthor: **Jeroen Demeyer**\n\nComponent: **misc**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9552_\n\n",
    "closed_at": "2015-05-30T22:48:30Z",
    "created_at": "2010-07-19T19:59:21Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "cython.py references the old sage notebook code",
    "type": "issue",
    "updated_at": "2015-05-30T22:48:30Z",
    "url": "https://github.com/sagemath/sage/issues/9552",
    "user": "https://github.com/williamstein"
}
```
 I noticed to my surprise that misc/cython.py has these lines in it (which should be fixed, of course):

```
 import sage.server.support
    d = {}
    sage.server.support.cython_import_all(tmpfile, d,
                                         verbose=verbose, compile_message=compile_message,
                                         use_cache=use_cache,
                                         create_local_c_file=False)
```

CC:  @kiwifb

Branch/Commit: **[1fc034e](https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586)**

Reviewer: **Fran√ßois Bissey**

Author: **Jeroen Demeyer**

Component: **misc**

_Issue created by migration from https://trac.sagemath.org/ticket/9552_





---

archive/issue_events_123083.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-07-19T19:59:21Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123083"
}
```



---

archive/issue_events_123084.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-07-19T19:59:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "label": "https://github.com/sagemath/sage/labels/p%3A%204%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p: 4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123084"
}
```



---

archive/issue_events_123085.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-07-19T19:59:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123085"
}
```



---

archive/issue_events_123086.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2010-07-19T19:59:21Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "subject": "https://github.com/williamstein",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123086"
}
```



---

archive/issue_events_123087.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123087"
}
```



---

archive/issue_events_123088.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123088"
}
```



---

archive/issue_events_123089.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123089"
}
```



---

archive/issue_events_123090.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123090"
}
```



---

archive/issue_events_123091.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123091"
}
```



---

archive/issue_events_123092.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123092"
}
```



---

archive/issue_events_123093.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123093"
}
```



---

archive/issue_events_123094.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123094"
}
```



---

archive/issue_events_123095.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2014-08-15T05:41:39Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "title_is": "cython.py references the old sage notebook code",
    "title_was": "cython.pyx references the old sage notebook code",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123095"
}
```



---

archive/issue_comments_082865.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n- I noticed to my surprise that misc/cython.pyx has these lines in it (which should be fixed, of course):\n+ I noticed to my surprise that misc/cython.py has these lines in it (which should be fixed, of course):\n \n ```\n  import sage.server.support\n``````\n",
    "created_at": "2014-08-15T05:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82865",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
- I noticed to my surprise that misc/cython.pyx has these lines in it (which should be fixed, of course):
+ I noticed to my surprise that misc/cython.py has these lines in it (which should be fixed, of course):
 
 ```
  import sage.server.support
``````




---

archive/issue_comments_082866.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nYeah, I think a lot of that stuff could go elsewhere, it's just support...\n\nIn this case the \"right\" fix is to move the whole Cython stuff somewhere else, probably just to cython.py (which is not a pyx file, at least not any more).",
    "created_at": "2014-08-15T05:41:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82866",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:5" align="right">comment:5</div>

Yeah, I think a lot of that stuff could go elsewhere, it's just support...

In this case the "right" fix is to move the whole Cython stuff somewhere else, probably just to cython.py (which is not a pyx file, at least not any more).



---

archive/issue_comments_082867.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIndeed, this wouldn't be hard to do.  Worst-case we could move them but leave a deprecation that points to the new location (cython.py seems best).\n\n```\nsage: search_src('cython_import')\nmisc/cython.py:657:    sage.server.support.cython_import_all(tmpfile, d,\nmisc/cython.py:756:    from sage.server.support import cython_import\nmisc/cython.py:757:    return cython_import(file, create_local_c_file=False)\nmisc/cython_c.pyx:61:    sage.server.support.cython_import_all(tmpfile, globals(),\nserver/support.py:425:def cython_import(filename, verbose=False, compile_message=False,\nserver/support.py:452:def cython_import_all(filename, globals, verbose=False, compile_message=False,\nserver/support.py:468:    m = cython_import(filename, verbose=verbose, compile_message=compile_message,\n```\nThe notebook already has its own versions of these two functions so that is not a problem, as far as I can tell (though it wouldn't hurt testing it can still Cythonize after doing this).",
    "created_at": "2014-08-15T05:46:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82867",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:6" align="right">comment:6</div>

Indeed, this wouldn't be hard to do.  Worst-case we could move them but leave a deprecation that points to the new location (cython.py seems best).

```
sage: search_src('cython_import')
misc/cython.py:657:    sage.server.support.cython_import_all(tmpfile, d,
misc/cython.py:756:    from sage.server.support import cython_import
misc/cython.py:757:    return cython_import(file, create_local_c_file=False)
misc/cython_c.pyx:61:    sage.server.support.cython_import_all(tmpfile, globals(),
server/support.py:425:def cython_import(filename, verbose=False, compile_message=False,
server/support.py:452:def cython_import_all(filename, globals, verbose=False, compile_message=False,
server/support.py:468:    m = cython_import(filename, verbose=verbose, compile_message=compile_message,
```
The notebook already has its own versions of these two functions so that is not a problem, as far as I can tell (though it wouldn't hurt testing it can still Cythonize after doing this).



---

archive/issue_comments_082868.json:
```json
{
    "body": "Branch: **[u/jdemeyer/ticket/9552](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/9552)**",
    "created_at": "2015-03-25T16:58:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82868",
    "user": "https://github.com/jdemeyer"
}
```

Branch: **[u/jdemeyer/ticket/9552](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/9552)**



---

archive/issue_comments_082869.json:
```json
{
    "body": "Commit: **[325ca9c](https://github.com/sagemath/sagetrac-mirror/commit/325ca9ca11b9ade262297562989a8ca1ff398eab)**",
    "created_at": "2015-03-25T17:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82869",
    "user": "https://github.com/jdemeyer"
}
```

Commit: **[325ca9c](https://github.com/sagemath/sagetrac-mirror/commit/325ca9ca11b9ade262297562989a8ca1ff398eab)**



---

archive/issue_comments_082870.json:
```json
{
    "body": "<div id=\"comment:8\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/325ca9ca11b9ade262297562989a8ca1ff398eab\">325ca9c</a></td><td><code>Move Cython functions from server/support.py to misc/cython.py</code></td></tr></table>\n",
    "created_at": "2015-03-25T17:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82870",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/325ca9ca11b9ade262297562989a8ca1ff398eab">325ca9c</a></td><td><code>Move Cython functions from server/support.py to misc/cython.py</code></td></tr></table>




---

archive/issue_comments_082871.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2015-03-25T17:00:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82871",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_events_123096.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-03-25T17:00:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123096"
}
```



---

archive/issue_events_123097.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-03-25T17:00:00Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123097"
}
```



---

archive/issue_events_123098.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-03-25T17:00:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123098"
}
```



---

archive/issue_comments_082872.json:
```json
{
    "body": "<div id=\"comment:9\"></div>\n\nBranch pushed to git repo; I updated commit sha1. This was a forced push. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586\">1fc034e</a></td><td><code>Move Cython functions from server/support.py to misc/cython.py</code></td></tr></table>\n",
    "created_at": "2015-05-05T21:02:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82872",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:9"></div>

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586">1fc034e</a></td><td><code>Move Cython functions from server/support.py to misc/cython.py</code></td></tr></table>




---

archive/issue_comments_082873.json:
```json
{
    "body": "Changed commit from **[325ca9c](https://github.com/sagemath/sagetrac-mirror/commit/325ca9ca11b9ade262297562989a8ca1ff398eab)** to **[1fc034e](https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586)**",
    "created_at": "2015-05-05T21:02:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82873",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[325ca9c](https://github.com/sagemath/sagetrac-mirror/commit/325ca9ca11b9ade262297562989a8ca1ff398eab)** to **[1fc034e](https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586)**



---

archive/issue_events_123099.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-30T07:51:01Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123099"
}
```



---

archive/issue_events_123100.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-30T07:51:01Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "milestone_number": null,
    "milestone_title": "sage-6.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123100"
}
```



---

archive/issue_comments_082874.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nLooks good to me.",
    "created_at": "2015-05-30T11:09:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82874",
    "user": "https://github.com/kiwifb"
}
```

<div id="comment:11" align="right">comment:11</div>

Looks good to me.



---

archive/issue_comments_082875.json:
```json
{
    "body": "Reviewer: **Fran\u00e7ois Bissey**",
    "created_at": "2015-05-30T11:09:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82875",
    "user": "https://github.com/kiwifb"
}
```

Reviewer: **Fran√ßois Bissey**



---

archive/issue_events_123101.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2015-05-30T11:09:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123101"
}
```



---

archive/issue_events_123102.json:
```json
{
    "actor": "https://github.com/kiwifb",
    "created_at": "2015-05-30T11:09:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123102"
}
```



---

archive/issue_events_123103.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-30T22:48:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123103"
}
```



---

archive/issue_events_123104.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "82d2d88d9bafc3070f80244f6bee4912fb54b823",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2015-05-30T22:48:30Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9552#event-123104"
}
```



---

archive/issue_comments_082876.json:
```json
{
    "body": "Changed branch from **[u/jdemeyer/ticket/9552](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/9552)** to **[1fc034e](https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586)**",
    "created_at": "2015-05-30T22:48:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9552",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9552#issuecomment-82876",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[u/jdemeyer/ticket/9552](https://github.com/sagemath/sagetrac-mirror/tree/u/jdemeyer/ticket/9552)** to **[1fc034e](https://github.com/sagemath/sagetrac-mirror/commit/1fc034eda517210fee9afa56b60dfe4ff39f6586)**
