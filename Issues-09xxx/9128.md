# Issue 9128: Sphinx should be aware of all.py to find its links

archive/issues_009128.json:
```json
{
    "assignees": [
        "https://github.com/hivert"
    ],
    "body": "Though sphinx is perfectly working with target in the local module he isn't\nable to find reference target from other modules even if they are exported in\nall.py. For example, if I want to link Parent from anywhere but parent.pyx, I\nhave to write the full path (ie. <code>:class:\\`~sage.structure.parent.Parent</code>`)\neven if it is imported in my module. I find this extremely annoying since, in\nthe task of improving the category doc, I'm setting up a lot of huge cross\nreferences such as:\n\n```\n    :meth:`Algebras.ParentMethods.algebra_generators()\n    <sage.categories.algebras.Algebras.ParentMethods.algebra_generators>`.\n```\nI would be very happy if I had to write only\n\n```\n    :meth:`Algebras.ParentMethods.algebra_generators`\n```\nThe following patch should solve this issue\n\nI set up `intersphinx` so that links to Python's doc are correctly\nresolved. The patch\n[attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains Python's\ncrossref database downloaded from http://docs.python.org/objects.inv I'm also\nusing intersphinx to solve links to the reference manual from the other\ndocuments.\n\n## New option for docbuild\n\nI added the option `--warn-links` to the documentation build command as in\n\n```\n    sage -docbuild --warn-links reference htm\n```\nWhen the option is used, Sphinx will issue a warning, whenever a link is not resolved.\n\n## Extra features\n\nMoreover, I add a reference target to every automatically created `.rst`\nfile associated to python source files. It can by used to set-up a link toward\nthe file and thus get the title rather than the module. For example\n`:ref:sage.categories.primer` setup a link to the help page with title\n`\"Elements, parents, and categories in Sage: a (draft of) primer\"` rather\nthan\n`sage.categories.primer` which you get with the link\n`:mod:sage.categories.primer`.\n\n## Apply both:\n\nNote: order is irrelevant\n\n- [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)\n- [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)\n- [attachment: trac_9128-MANIFEST-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz)\n\nDepends on #11251\nDepends on #12490\nDepends on #12572\n\nCC:  @nthiery @nexttime @novoselt @mwhansen\n\nComponent: **documentation**\n\nKeywords: **Sphinx links**\n\nAuthor: **Florent Hivert**\n\nReviewer: **Andrey Novoseltsev, Nicolas M. Thi\u00e9ry**\n\nMerged: **sage-5.0.beta8**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9128_\n\n",
    "closed_at": "2012-03-13T08:21:27Z",
    "created_at": "2010-06-03T12:47:46Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20documentation",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.0",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Sphinx should be aware of all.py to find its links",
    "type": "issue",
    "updated_at": "2012-05-31T18:51:45Z",
    "url": "https://github.com/sagemath/sage/issues/9128",
    "user": "https://github.com/hivert"
}
```
Though sphinx is perfectly working with target in the local module he isn't
able to find reference target from other modules even if they are exported in
all.py. For example, if I want to link Parent from anywhere but parent.pyx, I
have to write the full path (ie. <code>:class:\`~sage.structure.parent.Parent</code>`)
even if it is imported in my module. I find this extremely annoying since, in
the task of improving the category doc, I'm setting up a lot of huge cross
references such as:

```
    :meth:`Algebras.ParentMethods.algebra_generators()
    <sage.categories.algebras.Algebras.ParentMethods.algebra_generators>`.
```
I would be very happy if I had to write only

```
    :meth:`Algebras.ParentMethods.algebra_generators`
```
The following patch should solve this issue

I set up `intersphinx` so that links to Python's doc are correctly
resolved. The patch
[attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains Python's
crossref database downloaded from http://docs.python.org/objects.inv I'm also
using intersphinx to solve links to the reference manual from the other
documents.

## New option for docbuild

I added the option `--warn-links` to the documentation build command as in

```
    sage -docbuild --warn-links reference htm
```
When the option is used, Sphinx will issue a warning, whenever a link is not resolved.

## Extra features

Moreover, I add a reference target to every automatically created `.rst`
file associated to python source files. It can by used to set-up a link toward
the file and thus get the title rather than the module. For example
`:ref:sage.categories.primer` setup a link to the help page with title
`"Elements, parents, and categories in Sage: a (draft of) primer"` rather
than
`sage.categories.primer` which you get with the link
`:mod:sage.categories.primer`.

## Apply both:

Note: order is irrelevant

- [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)
- [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)
- [attachment: trac_9128-MANIFEST-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz)

Depends on #11251
Depends on #12490
Depends on #12572

CC:  @nthiery @nexttime @novoselt @mwhansen

Component: **documentation**

Keywords: **Sphinx links**

Author: **Florent Hivert**

Reviewer: **Andrey Novoseltsev, Nicolas M. Thi√©ry**

Merged: **sage-5.0.beta8**

_Issue created by migration from https://trac.sagemath.org/ticket/9128_





---

archive/issue_events_115304.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T12:47:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115304"
}
```



---

archive/issue_events_115305.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T12:47:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20documentation",
    "label_color": "0075ca",
    "label_name": "c: documentation",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115305"
}
```



---

archive/issue_events_115306.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T12:47:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115306"
}
```



---

archive/issue_events_115307.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T12:47:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115307"
}
```



---

archive/issue_events_115308.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-06-03T12:47:46Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "subject": "https://github.com/hivert",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115308"
}
```



---

archive/issue_comments_075764.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nThe patch here is a prototype, not yet ready for review. Comments or suggestions are mostly welcome.",
    "created_at": "2010-06-03T12:51:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75764",
    "user": "https://github.com/hivert"
}
```

<div id="comment:1" align="right">comment:1</div>

The patch here is a prototype, not yet ready for review. Comments or suggestions are mostly welcome.



---

archive/issue_events_115309.json:
```json
{
    "actor": "https://github.com/sagetrac-mvngu",
    "created_at": "2010-06-03T12:51:26Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "subject": "https://github.com/hivert",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115309"
}
```



---

archive/issue_events_115310.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T12:51:26Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "subject": "https://github.com/hivert",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115310"
}
```



---

archive/issue_events_115311.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T12:51:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115311"
}
```



---

archive/issue_comments_075765.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,3 +17,11 @@\n ```\n The following patch should solve this issue\n \n+I also added an option `SAGE_DOC_WARN_DANGLING_LINKS` which raises some\n+warnings if some links aren't resolved. For example:\n+\n+```\n+WARNING: symbol :meth:`ModulesWithBasis.HomCategory.ElementMethods.on_basis` linked from sage.categories.modules_with_basis is defined in sage.categories.modules_with_basis but not documented\n+WARNING: undefined symbol :class:`CartesianProducts.ParentMethods` in module sage.categories.modules_with_basis\n+```\n+Note those two warnings aren't raised because of a wrong doc but due to #9107.\n``````\n",
    "created_at": "2010-06-03T22:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75765",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,3 +17,11 @@
 ```
 The following patch should solve this issue
 
+I also added an option `SAGE_DOC_WARN_DANGLING_LINKS` which raises some
+warnings if some links aren't resolved. For example:
+
+```
+WARNING: symbol :meth:`ModulesWithBasis.HomCategory.ElementMethods.on_basis` linked from sage.categories.modules_with_basis is defined in sage.categories.modules_with_basis but not documented
+WARNING: undefined symbol :class:`CartesianProducts.ParentMethods` in module sage.categories.modules_with_basis
+```
+Note those two warnings aren't raised because of a wrong doc but due to #9107.
``````




---

archive/issue_comments_075766.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nThe submitted patch seems to behave as I want. So I put needs review. However if I receive some good advice on sage-devel or sphinx-users I may still change it. Anyway, Please comment.",
    "created_at": "2010-06-03T22:22:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75766",
    "user": "https://github.com/hivert"
}
```

<div id="comment:4" align="right">comment:4</div>

The submitted patch seems to behave as I want. So I put needs review. However if I receive some good advice on sage-devel or sphinx-users I may still change it. Anyway, Please comment.



---

archive/issue_events_115312.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T22:22:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115312"
}
```



---

archive/issue_events_115313.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-03T22:22:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115313"
}
```



---

archive/issue_comments_075767.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nI have just upgraded an installation of sage-4.4.2 to 4.4.3, applied this patch, set SAGE_DOC_WARN_DANGLING_LINKS to 1, and then got the following error:\n\n```\nnovoselt@sage:/scratch/novoselt/sage/devel/sage-main$ ../../sage -docbuild reference html\nsphinx-build -b html -d /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/doctrees/en/reference    /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/en/reference /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference\nRunning Sphinx v0.6.3\nloading pickled environment... done\nbuilding [html]: targets for 798 source files that are out of date\nupdating environment: [config changed] 802 added, 0 changed, 0 removed\nreading sources... [100%] structure\n/mnt/usb1/scratch/novoselt/sage/local/lib/python2.6/site-packages/sage/schemes/elliptic_curves/sha_tate.py:docstring of sage.schemes.elliptic_curves.sha_tate.Sha.bound_kato:12: (WARNING/2) Definition list ends without a blank line; unexpected unindent.\nlooking for now-outdated files... none found\npickling environment... done\nchecking consistency... done\npreparing documents... done\nwriting output... [  0%] coercion\nException occurred:\n  File \"/mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/conf.py\", line 444, in find_sage_dangling_links\n    fromdocname = getattr(sys.modules[modname], basename).__module__\nKeyError: None\nThe full traceback has been saved in /tmp/sphinx-err-Unu279.log, if you want to report the issue to the author.\nPlease also report this if it was a user error, so that a better error message can be provided next time.\nSend reports to sphinx-dev@googlegroups.com. Thanks!\nBuild finished.  The built documents can be found in /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference\nnovoselt@sage:/scratch/novoselt/sage/devel/sage-main$\n```\nThen I removed this patch, built documentation successfully, pushed this and some other patches and now it seems to work fine. Perhaps it was an unreproducible glitch unrelated to the patch. In general it seems to work as expected and showed me a couple of mistakes in my modules.\n\nI hesitate to switch status to positive review because of the error above and because I don't really understand the code, but I think that this is a great addition and will use this patch from now on!",
    "created_at": "2010-06-07T02:14:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75767",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:6" align="right">comment:6</div>

I have just upgraded an installation of sage-4.4.2 to 4.4.3, applied this patch, set SAGE_DOC_WARN_DANGLING_LINKS to 1, and then got the following error:

```
novoselt@sage:/scratch/novoselt/sage/devel/sage-main$ ../../sage -docbuild reference html
sphinx-build -b html -d /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/doctrees/en/reference    /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/en/reference /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference
Running Sphinx v0.6.3
loading pickled environment... done
building [html]: targets for 798 source files that are out of date
updating environment: [config changed] 802 added, 0 changed, 0 removed
reading sources... [100%] structure
/mnt/usb1/scratch/novoselt/sage/local/lib/python2.6/site-packages/sage/schemes/elliptic_curves/sha_tate.py:docstring of sage.schemes.elliptic_curves.sha_tate.Sha.bound_kato:12: (WARNING/2) Definition list ends without a blank line; unexpected unindent.
looking for now-outdated files... none found
pickling environment... done
checking consistency... done
preparing documents... done
writing output... [  0%] coercion
Exception occurred:
  File "/mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/conf.py", line 444, in find_sage_dangling_links
    fromdocname = getattr(sys.modules[modname], basename).__module__
KeyError: None
The full traceback has been saved in /tmp/sphinx-err-Unu279.log, if you want to report the issue to the author.
Please also report this if it was a user error, so that a better error message can be provided next time.
Send reports to sphinx-dev@googlegroups.com. Thanks!
Build finished.  The built documents can be found in /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference
novoselt@sage:/scratch/novoselt/sage/devel/sage-main$
```
Then I removed this patch, built documentation successfully, pushed this and some other patches and now it seems to work fine. Perhaps it was an unreproducible glitch unrelated to the patch. In general it seems to work as expected and showed me a couple of mistakes in my modules.

I hesitate to switch status to positive review because of the error above and because I don't really understand the code, but I think that this is a great addition and will use this patch from now on!



---

archive/issue_comments_075768.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nI tried the same thing on my own computer - upgraded from 4.4.2 to 4.4.3, applied this patch and tried to build documentation (without setting the environment variable this time). Same error repeatedly, but after popping the patch out everything goes OK. So something has to be done ;-)",
    "created_at": "2010-06-07T02:53:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75768",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:7" align="right">comment:7</div>

I tried the same thing on my own computer - upgraded from 4.4.2 to 4.4.3, applied this patch and tried to build documentation (without setting the environment variable this time). Same error repeatedly, but after popping the patch out everything goes OK. So something has to be done ;-)



---

archive/issue_events_115314.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-06-07T02:53:52Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115314"
}
```



---

archive/issue_events_115315.json:
```json
{
    "actor": "https://github.com/novoselt",
    "created_at": "2010-06-07T02:53:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115315"
}
```



---

archive/issue_comments_075769.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nHi Andrey\n\nReplying to [@novoselt](#comment%3A7):\n> I tried the same thing on my own computer - upgraded from 4.4.2 to 4.4.3, applied this patch and tried to build documentation (without setting the environment variable this time). Same error repeatedly, but after popping the patch out everything goes OK. So something has to be done ;-)\n\nThanks for looking at that. My patch was working for `.py` and `.pyx`\nfile but not `.rst` file. The new updated file should work. I didn't get\nany comment from `#sphinx-devel` except that `missing-reference` is\nthe good entry point. So except if some expert pop up and suggest some more\nimprovements, I consider this proposal as a good one. Please review.",
    "created_at": "2010-06-07T16:06:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75769",
    "user": "https://github.com/hivert"
}
```

<div id="comment:8" align="right">comment:8</div>

Hi Andrey

Replying to [@novoselt](#comment%3A7):
> I tried the same thing on my own computer - upgraded from 4.4.2 to 4.4.3, applied this patch and tried to build documentation (without setting the environment variable this time). Same error repeatedly, but after popping the patch out everything goes OK. So something has to be done ;-)

Thanks for looking at that. My patch was working for `.py` and `.pyx`
file but not `.rst` file. The new updated file should work. I didn't get
any comment from `#sphinx-devel` except that `missing-reference` is
the good entry point. So except if some expert pop up and suggest some more
improvements, I consider this proposal as a good one. Please review.



---

archive/issue_events_115316.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-07T16:06:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115316"
}
```



---

archive/issue_events_115317.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-07T16:06:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115317"
}
```



---

archive/issue_comments_075770.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nNow I upgraded from 4.4.3 to 4.4.4.alpha0. The new patch works better, but not perfect:\n\n```\nWARNING: undefined symbol :meth:`dual` in module sage.categories.dual\nwriting output... [ 13%] sage/categories/examples/algebras_with_basis\nException occurred:\n  File \"/mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/conf.py\", line 453, in find_sage_dangling_links\n    current_module = sys.modules[modname]\nKeyError: u'sage.categories.examples.algebras_with_basis'\nThe full traceback has been saved in /tmp/sphinx-err-rFQQUv.log, if you want to report the issue to the author.\nPlease also report this if it was a user error, so that a better error message can be provided next time.\nSend reports to sphinx-dev@googlegroups.com. Thanks!\nBuild finished.  The built documents can be found in /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference\n```",
    "created_at": "2010-06-07T20:00:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75770",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:9" align="right">comment:9</div>

Now I upgraded from 4.4.3 to 4.4.4.alpha0. The new patch works better, but not perfect:

```
WARNING: undefined symbol :meth:`dual` in module sage.categories.dual
writing output... [ 13%] sage/categories/examples/algebras_with_basis
Exception occurred:
  File "/mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/conf.py", line 453, in find_sage_dangling_links
    current_module = sys.modules[modname]
KeyError: u'sage.categories.examples.algebras_with_basis'
The full traceback has been saved in /tmp/sphinx-err-rFQQUv.log, if you want to report the issue to the author.
Please also report this if it was a user error, so that a better error message can be provided next time.
Send reports to sphinx-dev@googlegroups.com. Thanks!
Build finished.  The built documents can be found in /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference
```



---

archive/issue_comments_075771.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@novoselt](#comment%3A9):\n> Now I upgraded from 4.4.3 to 4.4.4.alpha0. The new patch works better, but not perfect:\n\nHum ! I know how to workaround those problems but I don't understand why this is happening ! Unfortunately, I don't want to upgrade and I can't reproduce the bug... Can you try to remove the directory `$SAGE_ROOT/devel/sage/doc/output` and relaunch the compilation. Does it still bug ? \n\nFlorent",
    "created_at": "2010-06-07T20:36:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75771",
    "user": "https://github.com/hivert"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@novoselt](#comment%3A9):
> Now I upgraded from 4.4.3 to 4.4.4.alpha0. The new patch works better, but not perfect:

Hum ! I know how to workaround those problems but I don't understand why this is happening ! Unfortunately, I don't want to upgrade and I can't reproduce the bug... Can you try to remove the directory `$SAGE_ROOT/devel/sage/doc/output` and relaunch the compilation. Does it still bug ? 

Florent



---

archive/issue_comments_075772.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nSuccessful built with 552 warnings!",
    "created_at": "2010-06-07T22:34:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75772",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:11" align="right">comment:11</div>

Successful built with 552 warnings!



---

archive/issue_comments_075773.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nWhile working on my patches, I am getting the following from this one:\n\n```\nWARNING: undefined symbol :meth:`sage.geometry.fan.RationalPolyhedralFan._compute_cone_lattice` in module sage.geometry.cone \n```\nI don't understand what is wrong. There are no typos and this module does exist in my installation. Is it because I don't import this class/module? Or because it is an underscore method and so there is no record of it in the documentation? (In this case, I actually make a reference to the source code of this method, so I just want the name to be typeset in the same way as other methods, I don't care that the link will not work.)",
    "created_at": "2010-06-08T15:33:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75773",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:12" align="right">comment:12</div>

While working on my patches, I am getting the following from this one:

```
WARNING: undefined symbol :meth:`sage.geometry.fan.RationalPolyhedralFan._compute_cone_lattice` in module sage.geometry.cone 
```
I don't understand what is wrong. There are no typos and this module does exist in my installation. Is it because I don't import this class/module? Or because it is an underscore method and so there is no record of it in the documentation? (In this case, I actually make a reference to the source code of this method, so I just want the name to be typeset in the same way as other methods, I don't care that the link will not work.)



---

archive/issue_comments_075774.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nReplying to [@novoselt](#comment%3A12):\n> While working on my patches, I am getting the following from this one:\n> \n> ```\n> WARNING: undefined symbol :meth:`sage.geometry.fan.RationalPolyhedralFan._compute_cone_lattice` in module sage.geometry.cone \n> ```\n> I don't understand what is wrong. There are no typos and this module does exist in my installation. Is it because I don't import this class/module? Or because it is an underscore method and so there is no record of it in the documentation? (In this case, I actually make a reference to the source code of this method, so I just want the name to be typeset in the same way as other methods, I don't care that the link will not work.)\n\nHi Andrey,\n\nThanks for beta testing my patch ! It this module included in the documentation ? More precisely is there a link in some `.rst` file (probably `doc/en/reference/geometry.rst`) ? Because if it is not imported nor linked from the doc, Sphinx as no way to find it but importing the module. This is something I tried to avoid for performance reason... If you are still having some problem, can you please make your patch accessible so that I can debug with it. I don't care if the code is not working...\n\nYou probably already figured that out, but I must confess that I put this patch here for comment but it is clear that it has not sufficiently been shaken. So many thanks for helping me on that and sorry to cause some trouble.",
    "created_at": "2010-06-08T17:03:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75774",
    "user": "https://github.com/hivert"
}
```

<div id="comment:13" align="right">comment:13</div>

Replying to [@novoselt](#comment%3A12):
> While working on my patches, I am getting the following from this one:
> 
> ```
> WARNING: undefined symbol :meth:`sage.geometry.fan.RationalPolyhedralFan._compute_cone_lattice` in module sage.geometry.cone 
> ```
> I don't understand what is wrong. There are no typos and this module does exist in my installation. Is it because I don't import this class/module? Or because it is an underscore method and so there is no record of it in the documentation? (In this case, I actually make a reference to the source code of this method, so I just want the name to be typeset in the same way as other methods, I don't care that the link will not work.)

Hi Andrey,

Thanks for beta testing my patch ! It this module included in the documentation ? More precisely is there a link in some `.rst` file (probably `doc/en/reference/geometry.rst`) ? Because if it is not imported nor linked from the doc, Sphinx as no way to find it but importing the module. This is something I tried to avoid for performance reason... If you are still having some problem, can you please make your patch accessible so that I can debug with it. I don't care if the code is not working...

You probably already figured that out, but I must confess that I put this patch here for comment but it is clear that it has not sufficiently been shaken. So many thanks for helping me on that and sorry to cause some trouble.



---

archive/issue_comments_075775.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nHi Florent!\n\nI have figured out that the problem is with the underscore - if I use a \"common\" method from the same non-imported patch, link is determined just fine.\n\nIt may be a good idea not to give warnings in such cases, but on the other hand it is probably quite rare and there is no need to make logic of this patch more convoluted. (In my case the docstring of one of the functions says \"see the source code of ... for more involved examples\", since those examples cannot be easily written as standalone code and I didn't want to write something \"involved, but artificial.\")\n\nSince I really like this functionality, I will continue using your patch (and its fresh versions if they become available) and report new problems, if there will be any. But for the final review we will need someone else, since I don't know how Sphinx works and cannot comment on the code itself.\n\nThank you!\nAndrey",
    "created_at": "2010-06-08T22:14:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75775",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:14" align="right">comment:14</div>

Hi Florent!

I have figured out that the problem is with the underscore - if I use a "common" method from the same non-imported patch, link is determined just fine.

It may be a good idea not to give warnings in such cases, but on the other hand it is probably quite rare and there is no need to make logic of this patch more convoluted. (In my case the docstring of one of the functions says "see the source code of ... for more involved examples", since those examples cannot be easily written as standalone code and I didn't want to write something "involved, but artificial.")

Since I really like this functionality, I will continue using your patch (and its fresh versions if they become available) and report new problems, if there will be any. But for the final review we will need someone else, since I don't know how Sphinx works and cannot comment on the code itself.

Thank you!
Andrey



---

archive/issue_comments_075776.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\n> It may be a good idea not to give warnings in such cases, but on the other hand it is probably quite rare and there is no need to make logic of this patch more convoluted. (In my case the docstring of one of the functions says \"see the source code of ... for more involved examples\", since those examples cannot be easily written as standalone code and I didn't want to write something \"involved, but artificial.\")\n\nCan you describe more precisely what's happening ? Maybe with a very small example... I'm not sure to understand what you are doing... I have the impression that you are requesting me to remove warnings about private methods (i.e.: starting with underscore). \n \n> Since I really like this functionality, I will continue using your patch (and its fresh versions if they become available) and report new problems, if there will be any. But for the final review we will need someone else, since I don't know how Sphinx works and cannot comment on the code itself.\n\nI'll try to ping some on sage-devel.",
    "created_at": "2010-06-11T15:27:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75776",
    "user": "https://github.com/hivert"
}
```

<div id="comment:15" align="right">comment:15</div>

> It may be a good idea not to give warnings in such cases, but on the other hand it is probably quite rare and there is no need to make logic of this patch more convoluted. (In my case the docstring of one of the functions says "see the source code of ... for more involved examples", since those examples cannot be easily written as standalone code and I didn't want to write something "involved, but artificial.")

Can you describe more precisely what's happening ? Maybe with a very small example... I'm not sure to understand what you are doing... I have the impression that you are requesting me to remove warnings about private methods (i.e.: starting with underscore). 
 
> Since I really like this functionality, I will continue using your patch (and its fresh versions if they become available) and report new problems, if there will be any. But for the final review we will need someone else, since I don't know how Sphinx works and cannot comment on the code itself.

I'll try to ping some on sage-devel.



---

archive/issue_comments_075777.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nI think that I want to have a distinction between \"totally wrong names\" and names which were successfully found in the Sage library (therefore, it makes sense to reference them), but do not have corresponding entries in the documentation files (therefore, it is not possible to convert them into a working hyperlink). Private/underscore methods are one example (I would like actually to seem them in the documentation \"on demand\", but maybe there are arguments against it), another is reference to objects in modules which are not included into documentation (maybe there will be no such modules eventually). I hope this is more clear, but in any way it is a small point.",
    "created_at": "2010-06-11T15:42:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75777",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:16" align="right">comment:16</div>

I think that I want to have a distinction between "totally wrong names" and names which were successfully found in the Sage library (therefore, it makes sense to reference them), but do not have corresponding entries in the documentation files (therefore, it is not possible to convert them into a working hyperlink). Private/underscore methods are one example (I would like actually to seem them in the documentation "on demand", but maybe there are arguments against it), another is reference to objects in modules which are not included into documentation (maybe there will be no such modules eventually). I hope this is more clear, but in any way it is a small point.



---

archive/issue_comments_075778.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nReplying to [@novoselt](#comment%3A16):\n> I think that I want to have a distinction between \"totally wrong names\" and names which were successfully found in the Sage library (therefore, it makes sense to reference them), but do not have corresponding entries in the documentation files (therefore, it is not possible to convert them into a working hyperlink). Private/underscore methods are one example (I would like actually to seem them in the documentation \"on demand\", but maybe there are arguments against it), another is reference to objects in modules which are not included into documentation (maybe there will be no such modules eventually). I hope this is more clear, but in any way it is a small point.\n\nThis should be exactly what I'm doing: I issue two different kinds of warning:\n \n- <code>undefined symbol :%s:\\`%s\\` in %s</code> \n- <code>symbol :%s:\\`%s\\` linked from %s is defined in %s but not documented</code>\n\nBu maybe sometime I fail finding a symbol and therefore issue the first warning instead of the second one... Is this happening for you ? \n\nFlorent",
    "created_at": "2010-06-11T15:56:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75778",
    "user": "https://github.com/hivert"
}
```

<div id="comment:17" align="right">comment:17</div>

Replying to [@novoselt](#comment%3A16):
> I think that I want to have a distinction between "totally wrong names" and names which were successfully found in the Sage library (therefore, it makes sense to reference them), but do not have corresponding entries in the documentation files (therefore, it is not possible to convert them into a working hyperlink). Private/underscore methods are one example (I would like actually to seem them in the documentation "on demand", but maybe there are arguments against it), another is reference to objects in modules which are not included into documentation (maybe there will be no such modules eventually). I hope this is more clear, but in any way it is a small point.

This should be exactly what I'm doing: I issue two different kinds of warning:
 
- <code>undefined symbol :%s:\`%s\` in %s</code> 
- <code>symbol :%s:\`%s\` linked from %s is defined in %s but not documented</code>

Bu maybe sometime I fail finding a symbol and therefore issue the first warning instead of the second one... Is this happening for you ? 

Florent



---

archive/issue_comments_075779.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nI get the first kind of warning and now the class is actually imported (although in the end of the module to avoid circular imports).\n\nI have just uploaded a fresh patch to #8987 (so fresh, that it is actually very raw ;-)) if you want to reproduce the issue. Beware that it is a chain of patches, I think it is possible to apply only those listed in #9062, #8986, and #8987 (especially if you are working with 4.4.4.alpha0, where all prerequisites but one are merged).",
    "created_at": "2010-06-11T19:12:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75779",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:18" align="right">comment:18</div>

I get the first kind of warning and now the class is actually imported (although in the end of the module to avoid circular imports).

I have just uploaded a fresh patch to #8987 (so fresh, that it is actually very raw ;-)) if you want to reproduce the issue. Beware that it is a chain of patches, I think it is possible to apply only those listed in #9062, #8986, and #8987 (especially if you are working with 4.4.4.alpha0, where all prerequisites but one are merged).



---

archive/issue_comments_075780.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI have discovered that\n\n```\n:class:`tuple`\n```\nin the documentation translates now into a black link\n\n```\n__builtin__.tuple\n```\nin the output. I think it would be better to display links exactly as they were written originally and \"expand\" only the actual link, if it is working.",
    "created_at": "2010-06-15T19:15:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75780",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:19" align="right">comment:19</div>

I have discovered that

```
:class:`tuple`
```
in the documentation translates now into a black link

```
__builtin__.tuple
```
in the output. I think it would be better to display links exactly as they were written originally and "expand" only the actual link, if it is working.



---

archive/issue_comments_075781.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@novoselt](#comment%3A19):\n> I have discovered that\n\n\n```\n:class:`tuple`\n```\n> in the documentation translates now into a black link\n\n\n```\n__builtin__.tuple\n```\n> in the output. I think it would be better to display links exactly as they were written originally and \"expand\" only the actual link, if it is working.\n\nYes ! That was before I know how to resolve those with `intersphinx`. See my new patches",
    "created_at": "2010-06-16T08:28:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75781",
    "user": "https://github.com/hivert"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@novoselt](#comment%3A19):
> I have discovered that


```
:class:`tuple`
```
> in the documentation translates now into a black link


```
__builtin__.tuple
```
> in the output. I think it would be better to display links exactly as they were written originally and "expand" only the actual link, if it is working.

Yes ! That was before I know how to resolve those with `intersphinx`. See my new patches



---

archive/issue_comments_075782.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -25,3 +25,9 @@\n WARNING: undefined symbol :class:`CartesianProducts.ParentMethods` in module sage.categories.modules_with_basis\n ```\n Note those two warnings aren't raised because of a wrong doc but due to #9107.\n+\n+I finally set up `intersphinx` so that links to Python's doc are correctly\n+resolved. The file\n+[trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains\n+Python's crossref database downloaded from http://docs.python.org/objects.inv\n+\n``````\n",
    "created_at": "2010-06-16T08:45:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75782",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -25,3 +25,9 @@
 WARNING: undefined symbol :class:`CartesianProducts.ParentMethods` in module sage.categories.modules_with_basis
 ```
 Note those two warnings aren't raised because of a wrong doc but due to #9107.
+
+I finally set up `intersphinx` so that links to Python's doc are correctly
+resolved. The file
+[trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains
+Python's crossref database downloaded from http://docs.python.org/objects.inv
+
``````




---

archive/issue_events_115318.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-16T10:57:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115318"
}
```



---

archive/issue_events_115319.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-06-16T10:57:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115319"
}
```



---

archive/issue_comments_075783.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nReplying to [@hivert](#comment%3A20):\n> Yes ! That was before I know how to resolve those with `intersphinx`. See my new patches\n\nThere is still a problem: currently when linking to python, I raise a warning **before** intersphinx tries to find the link in Python's database.",
    "created_at": "2010-06-16T10:57:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75783",
    "user": "https://github.com/hivert"
}
```

<div id="comment:22" align="right">comment:22</div>

Replying to [@hivert](#comment%3A20):
> Yes ! That was before I know how to resolve those with `intersphinx`. See my new patches

There is still a problem: currently when linking to python, I raise a warning **before** intersphinx tries to find the link in Python's database.



---

archive/issue_comments_075784.json:
```json
{
    "body": "Work Issues: **Upgrade to Sphinx 1.0**",
    "created_at": "2010-06-17T20:37:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75784",
    "user": "https://github.com/hivert"
}
```

Work Issues: **Upgrade to Sphinx 1.0**



---

archive/issue_comments_075785.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\n> There is still a problem: currently when linking to python, I raise a warning **before** intersphinx tries to find the link in Python's database.\n\nSome update: It is not possible to achieve what I want in Sphinx 0.6 without hacking into sphinx. However Sphinx 1.0 should be out very soon (they released 1.0beta2 last week). At raising warning is builtin in sphinx 1.0 with the correct configuration option. So I'll probably wait until sphinx 1.0 is out to finish this one, unless someone insist to have it very soon.",
    "created_at": "2010-06-17T20:37:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75785",
    "user": "https://github.com/hivert"
}
```

<div id="comment:23" align="right">comment:23</div>

> There is still a problem: currently when linking to python, I raise a warning **before** intersphinx tries to find the link in Python's database.

Some update: It is not possible to achieve what I want in Sphinx 0.6 without hacking into sphinx. However Sphinx 1.0 should be out very soon (they released 1.0beta2 last week). At raising warning is builtin in sphinx 1.0 with the correct configuration option. So I'll probably wait until sphinx 1.0 is out to finish this one, unless someone insist to have it very soon.



---

archive/issue_comments_075786.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nMy opinion is that upgrading Sphinx is the way to go, it may have other benefits (and hopefully no drawbacks). I really want this functionality but I am quite happy with the availability of these patches here, thank you for writing them, Florent! \n\nAndrey",
    "created_at": "2010-06-17T20:47:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75786",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:24" align="right">comment:24</div>

My opinion is that upgrading Sphinx is the way to go, it may have other benefits (and hopefully no drawbacks). I really want this functionality but I am quite happy with the availability of these patches here, thank you for writing them, Florent! 

Andrey



---

archive/issue_comments_075787.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nFor the record, here is another bad side effect of this patch: \n\n```\nsage: PolynomialRing?\n\nType:\t\tfunction\nBase Class:\t<type 'function'>\nString Form:\t<function PolynomialRing at 0x16a2758>\nNamespace:\tInteractive\nFile:\t\t/usr/devel/sage/sage/rings/polynomial/polynomial_ring_constructor.py\nDefinition:\tPolynomialRing(base_ring, arg1=None, arg2=None, sparse=False, order='degrevlex', names=None, name=None, implementation=None)\nDocstring:\n    <no docstring>\n```",
    "created_at": "2010-06-18T11:59:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75787",
    "user": "https://github.com/hivert"
}
```

<div id="comment:25" align="right">comment:25</div>

For the record, here is another bad side effect of this patch: 

```
sage: PolynomialRing?

Type:		function
Base Class:	<type 'function'>
String Form:	<function PolynomialRing at 0x16a2758>
Namespace:	Interactive
File:		/usr/devel/sage/sage/rings/polynomial/polynomial_ring_constructor.py
Definition:	PolynomialRing(base_ring, arg1=None, arg2=None, sparse=False, order='degrevlex', names=None, name=None, implementation=None)
Docstring:
    <no docstring>
```



---

archive/issue_comments_075788.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nIs it possible to display line numbers in warnings about bad links?",
    "created_at": "2010-08-25T00:33:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75788",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:26" align="right">comment:26</div>

Is it possible to display line numbers in warnings about bad links?



---

archive/issue_comments_075789.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nI guess it was expected: these patches do not work anymore in Sage-4.6.1.alpha3 due to Sphinx upgrade. On a fresh installation I got\n\n```\nnovoselt@sage:/scratch/novoselt/sage/devel/sage-main$ hg qapplied\nnovoselt@sage:/scratch/novoselt/sage/devel/sage-main$ hg qpush\napplying trac_9128-sphinx_links_all-fh.patch\nnow at: trac_9128-sphinx_links_all-fh.patch\nnovoselt@sage:/scratch/novoselt/sage/devel/sage-main$ hg qpush\napplying trac_9128-intersphinx_python_database-fh.patch\nnow at: trac_9128-intersphinx_python_database-fh.patch\nnovoselt@sage:/scratch/novoselt/sage/devel/sage-main$ ../../sage -b\n...\nnovoselt@sage:/scratch/novoselt/sage/devel/sage-main$ ../../sage -docbuild reference html\nsphinx-build -b html -d /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/doctrees/en/reference    /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/en/reference /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference\nRunning Sphinx v1.0.4\nloading pickled environment... done\nloading intersphinx inventory from /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/python-inv.txt...\nbuilding [html]: targets for 1 source files that are out of date\nupdating environment: [extensions changed] 882 added, 0 changed, 0 removed\nreading sources... [100%] tensor                                                                                                                              \nlooking for now-outdated files... none found\npickling environment... done\nchecking consistency... done\npreparing documents... done\nwriting output... [  0%] coercion                                                                                                                             \nException occurred:\n  File \"/mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/conf.py\", line 446, in find_sage_dangling_links\n    modname = nodeattr['modname']\nKeyError: 'modname'\nThe full traceback has been saved in /tmp/sphinx-err-5Yrzg5.log, if you want to report the issue to the developers.\nPlease also report this if it was a user error, so that a better error message can be provided next time.\nEither send bugs to the mailing list at <http://groups.google.com/group/sphinx-dev/>,\nor report them in the tracker at <http://bitbucket.org/birkenfeld/sphinx/issues/>. Thanks!\nBuild finished.  The built documents can be found in /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference\n```",
    "created_at": "2010-12-16T16:15:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75789",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:27" align="right">comment:27</div>

I guess it was expected: these patches do not work anymore in Sage-4.6.1.alpha3 due to Sphinx upgrade. On a fresh installation I got

```
novoselt@sage:/scratch/novoselt/sage/devel/sage-main$ hg qapplied
novoselt@sage:/scratch/novoselt/sage/devel/sage-main$ hg qpush
applying trac_9128-sphinx_links_all-fh.patch
now at: trac_9128-sphinx_links_all-fh.patch
novoselt@sage:/scratch/novoselt/sage/devel/sage-main$ hg qpush
applying trac_9128-intersphinx_python_database-fh.patch
now at: trac_9128-intersphinx_python_database-fh.patch
novoselt@sage:/scratch/novoselt/sage/devel/sage-main$ ../../sage -b
...
novoselt@sage:/scratch/novoselt/sage/devel/sage-main$ ../../sage -docbuild reference html
sphinx-build -b html -d /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/doctrees/en/reference    /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/en/reference /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference
Running Sphinx v1.0.4
loading pickled environment... done
loading intersphinx inventory from /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/python-inv.txt...
building [html]: targets for 1 source files that are out of date
updating environment: [extensions changed] 882 added, 0 changed, 0 removed
reading sources... [100%] tensor                                                                                                                              
looking for now-outdated files... none found
pickling environment... done
checking consistency... done
preparing documents... done
writing output... [  0%] coercion                                                                                                                             
Exception occurred:
  File "/mnt/usb1/scratch/novoselt/sage/devel/sage/doc/common/conf.py", line 446, in find_sage_dangling_links
    modname = nodeattr['modname']
KeyError: 'modname'
The full traceback has been saved in /tmp/sphinx-err-5Yrzg5.log, if you want to report the issue to the developers.
Please also report this if it was a user error, so that a better error message can be provided next time.
Either send bugs to the mailing list at <http://groups.google.com/group/sphinx-dev/>,
or report them in the tracker at <http://bitbucket.org/birkenfeld/sphinx/issues/>. Thanks!
Build finished.  The built documents can be found in /mnt/usb1/scratch/novoselt/sage/devel/sage/doc/output/html/en/reference
```



---

archive/issue_events_115320.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2011-04-27T21:17:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115320"
}
```



---

archive/issue_events_115321.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2011-04-27T21:17:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115321"
}
```



---

archive/issue_comments_075790.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nI upgraded my patch to the new sphinx. I'm not sure the patch is completely finished but I'd be very interesting to have feedback.",
    "created_at": "2011-04-27T21:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75790",
    "user": "https://github.com/hivert"
}
```

<div id="comment:28" align="right">comment:28</div>

I upgraded my patch to the new sphinx. I'm not sure the patch is completely finished but I'd be very interesting to have feedback.



---

archive/issue_comments_075791.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,17 +17,18 @@\n ```\n The following patch should solve this issue\n \n-I also added an option `SAGE_DOC_WARN_DANGLING_LINKS` which raises some\n-warnings if some links aren't resolved. For example:\n+I set up `intersphinx` so that links to Python's doc are correctly\n+resolved. The patch\n+[attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains Python's\n+crossref database downloaded from http://docs.python.org/objects.inv I'm also\n+using intersphinx to solve links to the reference manual from the other\n+documents.\n \n-```\n-WARNING: symbol :meth:`ModulesWithBasis.HomCategory.ElementMethods.on_basis` linked from sage.categories.modules_with_basis is defined in sage.categories.modules_with_basis but not documented\n-WARNING: undefined symbol :class:`CartesianProducts.ParentMethods` in module sage.categories.modules_with_basis\n-```\n-Note those two warnings aren't raised because of a wrong doc but due to #9107.\n+I finally setup the extension extlinks to allows links to trac as in\n+<code>:trac:\\`9128\\`</code>.\n \n-I finally set up `intersphinx` so that links to Python's doc are correctly\n-resolved. The file\n-[trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains\n-Python's crossref database downloaded from http://docs.python.org/objects.inv\n+Apply both:\n \n+- [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)\n+- [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)\n+\n``````\n",
    "created_at": "2011-04-27T21:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75791",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,17 +17,18 @@
 ```
 The following patch should solve this issue
 
-I also added an option `SAGE_DOC_WARN_DANGLING_LINKS` which raises some
-warnings if some links aren't resolved. For example:
+I set up `intersphinx` so that links to Python's doc are correctly
+resolved. The patch
+[attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains Python's
+crossref database downloaded from http://docs.python.org/objects.inv I'm also
+using intersphinx to solve links to the reference manual from the other
+documents.
 
-```
-WARNING: symbol :meth:`ModulesWithBasis.HomCategory.ElementMethods.on_basis` linked from sage.categories.modules_with_basis is defined in sage.categories.modules_with_basis but not documented
-WARNING: undefined symbol :class:`CartesianProducts.ParentMethods` in module sage.categories.modules_with_basis
-```
-Note those two warnings aren't raised because of a wrong doc but due to #9107.
+I finally setup the extension extlinks to allows links to trac as in
+<code>:trac:\`9128\`</code>.
 
-I finally set up `intersphinx` so that links to Python's doc are correctly
-resolved. The file
-[trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz) contains
-Python's crossref database downloaded from http://docs.python.org/objects.inv
+Apply both:
 
+- [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)
+- [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)
+
``````




---

archive/issue_comments_075792.json:
```json
{
    "body": "Changed work issues from **Upgrade to Sphinx 1.0** to none",
    "created_at": "2011-04-27T21:17:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75792",
    "user": "https://github.com/hivert"
}
```

Changed work issues from **Upgrade to Sphinx 1.0** to none



---

archive/issue_comments_075793.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,6 +24,11 @@\n using intersphinx to solve links to the reference manual from the other\n documents.\n \n+Moreover, I add a reference target to every automatically created `.rst`\n+file associated to python source files. It can by used to set-up a link toward\n+the file. For example `:ref:sage.combinat.partition` setup a link to the\n+help page.\n+\n I finally setup the extension extlinks to allows links to trac as in\n <code>:trac:\\`9128\\`</code>.\n \n``````\n",
    "created_at": "2011-04-29T00:27:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75793",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,6 +24,11 @@
 using intersphinx to solve links to the reference manual from the other
 documents.
 
+Moreover, I add a reference target to every automatically created `.rst`
+file associated to python source files. It can by used to set-up a link toward
+the file. For example `:ref:sage.combinat.partition` setup a link to the
+help page.
+
 I finally setup the extension extlinks to allows links to trac as in
 <code>:trac:\`9128\`</code>.
 
``````




---

archive/issue_comments_075794.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nHi Florent,\n\nI have enjoyed using your patch in the past and I am going to start using it again but so far it does not apply to sage-4.7.rc0:\n\n```\nnovoselt@tx2-LM:~/sage/devel/sage-main$ hg qimport https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz\nadding trac_9128-intersphinx_python_database-fh.patch to series file\nnovoselt@tx2-LM:~/sage/devel/sage-main$ hg qpush\napplying trac_9128-intersphinx_python_database-fh.patch\nnow at: trac_9128-intersphinx_python_database-fh.patch\nnovoselt@tx2-LM:~/sage/devel/sage-main$ hg qimport https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz\nadding trac_9128-sphinx_links_all-fh.patch to series file\nnovoselt@tx2-LM:~/sage/devel/sage-main$ hg qpush\napplying trac_9128-sphinx_links_all-fh.patch\npatching file doc/common/conf.py\nHunk #2 FAILED at 19\nHunk #3 succeeded at 97 with fuzz 2 (offset -7 lines).\n1 out of 6 hunks FAILED -- saving rejects to file doc/common/conf.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh trac_9128-sphinx_links_all-fh.patch\nnovoselt@tx2-LM:~/sage/devel/sage-main$ \n```\nThis is on a just built installation without any other patches.",
    "created_at": "2011-04-30T04:27:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75794",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:30" align="right">comment:30</div>

Hi Florent,

I have enjoyed using your patch in the past and I am going to start using it again but so far it does not apply to sage-4.7.rc0:

```
novoselt@tx2-LM:~/sage/devel/sage-main$ hg qimport https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz
adding trac_9128-intersphinx_python_database-fh.patch to series file
novoselt@tx2-LM:~/sage/devel/sage-main$ hg qpush
applying trac_9128-intersphinx_python_database-fh.patch
now at: trac_9128-intersphinx_python_database-fh.patch
novoselt@tx2-LM:~/sage/devel/sage-main$ hg qimport https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz
adding trac_9128-sphinx_links_all-fh.patch to series file
novoselt@tx2-LM:~/sage/devel/sage-main$ hg qpush
applying trac_9128-sphinx_links_all-fh.patch
patching file doc/common/conf.py
Hunk #2 FAILED at 19
Hunk #3 succeeded at 97 with fuzz 2 (offset -7 lines).
1 out of 6 hunks FAILED -- saving rejects to file doc/common/conf.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh trac_9128-sphinx_links_all-fh.patch
novoselt@tx2-LM:~/sage/devel/sage-main$ 
```
This is on a just built installation without any other patches.



---

archive/issue_comments_075795.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,15 +24,27 @@\n using intersphinx to solve links to the reference manual from the other\n documents.\n \n+## Extra features\n+\n Moreover, I add a reference target to every automatically created `.rst`\n file associated to python source files. It can by used to set-up a link toward\n-the file. For example `:ref:sage.combinat.partition` setup a link to the\n-help page.\n+the file and thus get the title rather than the module. For example\n+`:ref:sage.categories.primer` setup a link to the help page with title\n+`\"Elements, parents, and categories in Sage: a (draft of) primer\"` rather\n+than\n+`sage.categories.primer` which you get with the link\n+`:mod:sage.categories.primer`.\n \n I finally setup the extension extlinks to allows links to trac as in\n <code>:trac:\\`9128\\`</code>.\n \n-Apply both:\n+## Depend on:\n+\n+- #11251\n+\n+## Apply both:\n+\n+Note: order is irrelevant\n \n - [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)\n - [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)\n``````\n",
    "created_at": "2011-04-30T13:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75795",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,15 +24,27 @@
 using intersphinx to solve links to the reference manual from the other
 documents.
 
+## Extra features
+
 Moreover, I add a reference target to every automatically created `.rst`
 file associated to python source files. It can by used to set-up a link toward
-the file. For example `:ref:sage.combinat.partition` setup a link to the
-help page.
+the file and thus get the title rather than the module. For example
+`:ref:sage.categories.primer` setup a link to the help page with title
+`"Elements, parents, and categories in Sage: a (draft of) primer"` rather
+than
+`sage.categories.primer` which you get with the link
+`:mod:sage.categories.primer`.
 
 I finally setup the extension extlinks to allows links to trac as in
 <code>:trac:\`9128\`</code>.
 
-Apply both:
+## Depend on:
+
+- #11251
+
+## Apply both:
+
+Note: order is irrelevant
 
 - [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)
 - [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)
``````




---

archive/issue_comments_075796.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nHi Andrey,\n\nReplying to [@novoselt](#comment%3A30):\n> I have enjoyed using your patch in the past and I am going to start using it again but so far it does not apply to sage-4.7.rc0:\n\nOops !!! I should have said that this depend on #11251. Thanks for pointing it out and for testing my patch.",
    "created_at": "2011-04-30T13:21:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75796",
    "user": "https://github.com/hivert"
}
```

<div id="comment:31" align="right">comment:31</div>

Hi Andrey,

Replying to [@novoselt](#comment%3A30):
> I have enjoyed using your patch in the past and I am going to start using it again but so far it does not apply to sage-4.7.rc0:

Oops !!! I should have said that this depend on #11251. Thanks for pointing it out and for testing my patch.



---

archive/issue_comments_075797.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nI updated a little my patch to make sure that the reference guide is compiled first. This is needed so that other documentation can link to the reference guide. Please review.",
    "created_at": "2011-05-02T13:15:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75797",
    "user": "https://github.com/hivert"
}
```

<div id="comment:32" align="right">comment:32</div>

I updated a little my patch to make sure that the reference guide is compiled first. This is needed so that other documentation can link to the reference guide. Please review.



---

archive/issue_comments_075798.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -38,10 +38,6 @@\n I finally setup the extension extlinks to allows links to trac as in\n <code>:trac:\\`9128\\`</code>.\n \n-## Depend on:\n-\n-- #11251\n-\n ## Apply both:\n \n Note: order is irrelevant\n``````\n",
    "created_at": "2011-06-07T19:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75798",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -38,10 +38,6 @@
 I finally setup the extension extlinks to allows links to trac as in
 <code>:trac:\`9128\`</code>.
 
-## Depend on:
-
-- #11251
-
 ## Apply both:
 
 Note: order is irrelevant
``````




---

archive/issue_comments_075799.json:
```json
{
    "body": "Dependencies: **#11251**",
    "created_at": "2011-06-07T19:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75799",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#11251**



---

archive/issue_comments_075800.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nHi Mike, \n\nI just added you in CC remembering that you are the Sphinx expert. If you can be kind enough to give me some feedback on that one, I'd very appreciate. It was a very though one for me as sphinx doesn't expose the necessary interface. So I had to dig in the internal. I think it is very useful and it could greatly help improving the documentation. \n\nThanks for your help.",
    "created_at": "2011-06-13T20:28:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75800",
    "user": "https://github.com/hivert"
}
```

<div id="comment:34" align="right">comment:34</div>

Hi Mike, 

I just added you in CC remembering that you are the Sphinx expert. If you can be kind enough to give me some feedback on that one, I'd very appreciate. It was a very though one for me as sphinx doesn't expose the necessary interface. So I had to dig in the internal. I think it is very useful and it could greatly help improving the documentation. 

Thanks for your help.



---

archive/issue_comments_075801.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nBy the way, note that #6495 also touches some of the same files, and for builder.py, in a conflicting way.  I think that #6495 could be rebased on top of this one.",
    "created_at": "2011-09-24T18:10:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75801",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">comment:35</div>

By the way, note that #6495 also touches some of the same files, and for builder.py, in a conflicting way.  I think that #6495 could be rebased on top of this one.



---

archive/issue_comments_075802.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@jhpalmieri](#comment%3A35):\n> By the way, note that #6495 also touches some of the same files, and for builder.py, in a conflicting way.  I think that #6495 could be rebased on top of this one.\n\n(Although I'm not sure, since #6495 completely changes how the reference manual is built.  Can you take a look at that one to see what you think and whether the two approaches can be combined?)",
    "created_at": "2011-09-24T18:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75802",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@jhpalmieri](#comment%3A35):
> By the way, note that #6495 also touches some of the same files, and for builder.py, in a conflicting way.  I think that #6495 could be rebased on top of this one.

(Although I'm not sure, since #6495 completely changes how the reference manual is built.  Can you take a look at that one to see what you think and whether the two approaches can be combined?)



---

archive/issue_comments_075803.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nPatches do not apply anymore on top of Sage-5.0.beta4. (Perhaps because of recent :trac: addition in another ticket?) What are actually the plans for this ticket?..",
    "created_at": "2012-02-15T22:27:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75803",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:37" align="right">comment:37</div>

Patches do not apply anymore on top of Sage-5.0.beta4. (Perhaps because of recent :trac: addition in another ticket?) What are actually the plans for this ticket?..



---

archive/issue_comments_075804.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nReplying to [@novoselt](#comment%3A37):\n> Patches do not apply anymore on top of Sage-5.0.beta4. (Perhaps because of recent :trac: addition in another ticket?) What are actually the plans for this ticket?..\n\nYes there is a conflict with :trac:. I have a rebased patch in the sage-combinat queue which should applies. However I didn't test if it still works. I check it tomorrow and repost it. I'll be more that happy to have a review for this one. It has been a huge pain to get to a working solution, so I'll end up very frustrated if it goes to the garbage.\n\nFlorent",
    "created_at": "2012-02-15T22:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75804",
    "user": "https://github.com/hivert"
}
```

<div id="comment:38" align="right">comment:38</div>

Replying to [@novoselt](#comment%3A37):
> Patches do not apply anymore on top of Sage-5.0.beta4. (Perhaps because of recent :trac: addition in another ticket?) What are actually the plans for this ticket?..

Yes there is a conflict with :trac:. I have a rebased patch in the sage-combinat queue which should applies. However I didn't test if it still works. I check it tomorrow and repost it. I'll be more that happy to have a review for this one. It has been a huge pain to get to a working solution, so I'll end up very frustrated if it goes to the garbage.

Florent



---

archive/issue_comments_075805.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -35,9 +35,6 @@\n `sage.categories.primer` which you get with the link\n `:mod:sage.categories.primer`.\n \n-I finally setup the extension extlinks to allows links to trac as in\n-<code>:trac:\\`9128\\`</code>.\n-\n ## Apply both:\n \n Note: order is irrelevant\n``````\n",
    "created_at": "2012-02-18T11:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75805",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -35,9 +35,6 @@
 `sage.categories.primer` which you get with the link
 `:mod:sage.categories.primer`.
 
-I finally setup the extension extlinks to allows links to trac as in
-<code>:trac:\`9128\`</code>.
-
 ## Apply both:
 
 Note: order is irrelevant
``````




---

archive/issue_comments_075806.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nHi there,\n\nI'm uploading two new patches:\n \n- `trac_9128-intersphinx_python_database-fh.patch` updated to Python 2.7\n \n- `trac_9128-sphinx_links_all-fh.patch` rebased for Sage-5.0.alpha4 and in particular on top of #12490 which was previously in this ticket.\n\nAs I already said, I'm not sure if this should enter Sage in the present status but I need a Sphinx expert (if not George Brandl himself) to try to polish and simplify my code. However, I think the feature is quite important in order to improve Sage's doc, so I suggest that if no expert jump up to let the code enter Sage as such and to improve it in a former ticket. I therefore leave it as need-review.",
    "created_at": "2012-02-18T11:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75806",
    "user": "https://github.com/hivert"
}
```

<div id="comment:39" align="right">comment:39</div>

Hi there,

I'm uploading two new patches:
 
- `trac_9128-intersphinx_python_database-fh.patch` updated to Python 2.7
 
- `trac_9128-sphinx_links_all-fh.patch` rebased for Sage-5.0.alpha4 and in particular on top of #12490 which was previously in this ticket.

As I already said, I'm not sure if this should enter Sage in the present status but I need a Sphinx expert (if not George Brandl himself) to try to polish and simplify my code. However, I think the feature is quite important in order to improve Sage's doc, so I suggest that if no expert jump up to let the code enter Sage as such and to improve it in a former ticket. I therefore leave it as need-review.



---

archive/issue_comments_075807.json:
```json
{
    "body": "Changed dependencies from **#11251** to **#11251, #12490**",
    "created_at": "2012-02-18T11:11:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75807",
    "user": "https://github.com/hivert"
}
```

Changed dependencies from **#11251** to **#11251, #12490**



---

archive/issue_comments_075808.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nAttachment: **[trac_9128-intersphinx_python_database-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)**\n\n+1 on getting it merged in 5.0, that is as soon as possible! As it is, it already helps much improving the Sage documentation, and it can be improved later. Besides, we want to use it for working with the Sage-Combinat patches, but it's a pain to have it in the queue since it forces recompiling all the documentation.\n\nI have been through the patch, and it looks reasonnable, though I am not by far a Sphinx expert. Just a detail: several of the functions do not have doctests. Now I am not sure if it is anyway really possible to doctest them; if not, I guess that's ok as is.\n\nAndrei or John: would you agree to put a positive review?\n\nCheers,\n                           Nicolas",
    "created_at": "2012-02-18T14:27:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75808",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:40" align="right">comment:40</div>

Attachment: **[trac_9128-intersphinx_python_database-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)**

+1 on getting it merged in 5.0, that is as soon as possible! As it is, it already helps much improving the Sage documentation, and it can be improved later. Besides, we want to use it for working with the Sage-Combinat patches, but it's a pain to have it in the queue since it forces recompiling all the documentation.

I have been through the patch, and it looks reasonnable, though I am not by far a Sphinx expert. Just a detail: several of the functions do not have doctests. Now I am not sure if it is anyway really possible to doctest them; if not, I guess that's ok as is.

Andrei or John: would you agree to put a positive review?

Cheers,
                           Nicolas



---

archive/issue_comments_075809.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI never tried to figure out how Sphinx works, so I cannot say much about the code itself. However, I have been following this ticket from the very beginning, having it on the top of my queue whenever it was cleanly applicable. I have never had any issues with it and it helped me to catch some dangling links. I didn't try to use it for short links in documentation, since I didn't want to be dependent on this ticket, but I surely do want to avoid figuring out and typing every full path. This also makes the documentation resistant to refactoring and moving functions around.\n\nSo - as a user I like this patch a lot, give it positive review, and vote for inclusion as is!",
    "created_at": "2012-02-18T15:51:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75809",
    "user": "https://github.com/novoselt"
}
```

<div id="comment:41" align="right">comment:41</div>

I never tried to figure out how Sphinx works, so I cannot say much about the code itself. However, I have been following this ticket from the very beginning, having it on the top of my queue whenever it was cleanly applicable. I have never had any issues with it and it helped me to catch some dangling links. I didn't try to use it for short links in documentation, since I didn't want to be dependent on this ticket, but I surely do want to avoid figuring out and typing every full path. This also makes the documentation resistant to refactoring and moving functions around.

So - as a user I like this patch a lot, give it positive review, and vote for inclusion as is!



---

archive/issue_comments_075810.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\n> I have been through the patch, and it looks reasonnable, though I am not by far a Sphinx expert. Just a detail: several of the functions do not have doctests. Now I am not sure if it is anyway really possible to doctest them; if not, I guess that's ok as is.\n\nUnfortunately, I've no idea how to doctests those. As you can see from the\ncode, I wrote my patch using log backtrace and `pdb`. At several point,\nI'm using call to sphinx or docutils internal which are not really\ndocumented. So this is some kind of reverse engineering. I tried several time\nto ask for some help on sphinx-user and never got any answer on that. My\ndiagnostic is that Sphinx doesn't expose a sufficiently flexible API to\nachieve what we want.\n\nProbably a good solution would be to have a Sage-days whose subject is Sphinx\nand doc-compiling and invite George Brandl. We could also solve the Sphinx\nparallel build ticket at the same occasion. Unfortunately, I just organized a\nSage-days and I'm invited to two other until summer so I won't organize such a\ndays and if organized, I don't think I'll be able to attend.\n\nBy the way, I'll CC this on Sage-devel.",
    "created_at": "2012-02-18T18:54:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75810",
    "user": "https://github.com/hivert"
}
```

<div id="comment:42" align="right">comment:42</div>

> I have been through the patch, and it looks reasonnable, though I am not by far a Sphinx expert. Just a detail: several of the functions do not have doctests. Now I am not sure if it is anyway really possible to doctest them; if not, I guess that's ok as is.

Unfortunately, I've no idea how to doctests those. As you can see from the
code, I wrote my patch using log backtrace and `pdb`. At several point,
I'm using call to sphinx or docutils internal which are not really
documented. So this is some kind of reverse engineering. I tried several time
to ask for some help on sphinx-user and never got any answer on that. My
diagnostic is that Sphinx doesn't expose a sufficiently flexible API to
achieve what we want.

Probably a good solution would be to have a Sage-days whose subject is Sphinx
and doc-compiling and invite George Brandl. We could also solve the Sphinx
parallel build ticket at the same occasion. Unfortunately, I just organized a
Sage-days and I'm invited to two other until summer so I won't organize such a
days and if organized, I don't think I'll be able to attend.

By the way, I'll CC this on Sage-devel.



---

archive/issue_comments_075811.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\nI just added the following diff which should resolve many more dependance to python itself.\n\n```diff\ndiff --git a/doc/common/conf.py b/doc/common/conf.py\n--- a/doc/common/conf.py\n+++ b/doc/common/conf.py\n@@ -490,6 +490,11 @@ def call_intersphinx(app, env, node, con\n         debug_inf(app, \"---- Intersphinx: %s not Found\"%node['reftarget'])\n     return res\n \n+# lists of basic Python class which are documented as functions\n+base_class_as_func = [\n+    'bool', 'complex', 'dict', 'file', 'float',\n+    'frozenset', 'int', 'list', 'long', 'object',\n+    'set', 'slice', 'str', 'tuple', 'type', 'unicode', 'xrange']\n \n def find_sage_dangling_links(app, env, node, contnode):\n     \"\"\"\n@@ -507,9 +512,9 @@ def find_sage_dangling_links(app, env, n\n \n     debug_inf(app, \"Searching %s from %s\"%(reftarget, doc))\n \n-    # Workaround: in Python's doc 'object' is documented as a function rather\n-    # than a class\n-    if reftarget == 'object' and reftype == 'class':\n+    # Workaround: in Python's doc 'object', 'list', ... are documented as a\n+    # function rather than a class\n+    if reftarget in base_class_as_func and reftype == 'class':\n         node['reftype'] = 'func'\n \n     res = call_intersphinx(app, env, node, contnode)\n```",
    "created_at": "2012-02-18T19:54:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75811",
    "user": "https://github.com/hivert"
}
```

<div id="comment:43" align="right">comment:43</div>

I just added the following diff which should resolve many more dependance to python itself.

```diff
diff --git a/doc/common/conf.py b/doc/common/conf.py
--- a/doc/common/conf.py
+++ b/doc/common/conf.py
@@ -490,6 +490,11 @@ def call_intersphinx(app, env, node, con
         debug_inf(app, "---- Intersphinx: %s not Found"%node['reftarget'])
     return res
 
+# lists of basic Python class which are documented as functions
+base_class_as_func = [
+    'bool', 'complex', 'dict', 'file', 'float',
+    'frozenset', 'int', 'list', 'long', 'object',
+    'set', 'slice', 'str', 'tuple', 'type', 'unicode', 'xrange']
 
 def find_sage_dangling_links(app, env, node, contnode):
     """
@@ -507,9 +512,9 @@ def find_sage_dangling_links(app, env, n
 
     debug_inf(app, "Searching %s from %s"%(reftarget, doc))
 
-    # Workaround: in Python's doc 'object' is documented as a function rather
-    # than a class
-    if reftarget == 'object' and reftype == 'class':
+    # Workaround: in Python's doc 'object', 'list', ... are documented as a
+    # function rather than a class
+    if reftarget in base_class_as_func and reftype == 'class':
         node['reftype'] = 'func'
 
     res = call_intersphinx(app, env, node, contnode)
```



---

archive/issue_comments_075812.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nThe way we called Sphinx, it wasn't honoring the `SPHINXOPTS` environment variable anymore. As a consequence option `-n` wasn't working anymore. I just uploaded a patch which fixes this. Maybe this should be added to the dev-guide.",
    "created_at": "2012-02-19T00:56:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75812",
    "user": "https://github.com/hivert"
}
```

<div id="comment:44" align="right">comment:44</div>

The way we called Sphinx, it wasn't honoring the `SPHINXOPTS` environment variable anymore. As a consequence option `-n` wasn't working anymore. I just uploaded a patch which fixes this. Maybe this should be added to the dev-guide.



---

archive/issue_comments_075813.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nOk, unless someone comments before that, I'll set a positive review tomorrow morning.",
    "created_at": "2012-02-19T10:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75813",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:45" align="right">comment:45</div>

Ok, unless someone comments before that, I'll set a positive review tomorrow morning.



---

archive/issue_comments_075814.json:
```json
{
    "body": "Reviewer: **Andrey Novoseltsev, Nicolas M. Thi\u00e9ry**",
    "created_at": "2012-02-19T10:37:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75814",
    "user": "https://github.com/nthiery"
}
```

Reviewer: **Andrey Novoseltsev, Nicolas M. Thi√©ry**



---

archive/issue_events_115322.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-02-20T14:58:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115322"
}
```



---

archive/issue_events_115323.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-02-20T14:58:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115323"
}
```



---

archive/issue_events_115324.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2012-02-20T15:55:43Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115324"
}
```



---

archive/issue_events_115325.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2012-02-20T15:55:43Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115325"
}
```



---

archive/issue_comments_075815.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nThere is a little problem in the handling of the environment + Usefull sphinx options should be better documented. I need to rework this a little.\n\nFlorent",
    "created_at": "2012-02-20T15:55:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75815",
    "user": "https://github.com/hivert"
}
```

<div id="comment:47" align="right">comment:47</div>

There is a little problem in the handling of the environment + Usefull sphinx options should be better documented. I need to rework this a little.

Florent



---

archive/issue_events_115326.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2012-02-20T17:00:37Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115326"
}
```



---

archive/issue_events_115327.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2012-02-20T17:00:37Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115327"
}
```



---

archive/issue_comments_075816.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -24,6 +24,15 @@\n using intersphinx to solve links to the reference manual from the other\n documents.\n \n+## New option for docbuild\n+\n+I added the option `--warn-links` to the documentation build command as in\n+\n+```\n+    sage -docbuild --warn-links reference htm\n+```\n+When the option is used, Sphinx will issue a warning, whenever a link is not resolved.\n+\n ## Extra features\n \n Moreover, I add a reference target to every automatically created `.rst`\n``````\n",
    "created_at": "2012-02-20T17:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75816",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -24,6 +24,15 @@
 using intersphinx to solve links to the reference manual from the other
 documents.
 
+## New option for docbuild
+
+I added the option `--warn-links` to the documentation build command as in
+
+```
+    sage -docbuild --warn-links reference htm
+```
+When the option is used, Sphinx will issue a warning, whenever a link is not resolved.
+
 ## Extra features
 
 Moreover, I add a reference target to every automatically created `.rst`
``````




---

archive/issue_comments_075817.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nAttachment: **[trac_9128-doc_option-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-doc_option-fh.patch.gz)**\n\nHi there,\n\nI finalized the doc of this patch. I also took the chance to add a extra option 'warn-links' which make Sphinx complains for dangling links. To ease the review, I uploaded my changes in [attachment: trac_9128-doc_option-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-doc_option-fh.patch.gz). Those changes are folded in [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz) so that you only need to apply this one and the database patch.",
    "created_at": "2012-02-20T17:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75817",
    "user": "https://github.com/hivert"
}
```

<div id="comment:48" align="right">comment:48</div>

Attachment: **[trac_9128-doc_option-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-doc_option-fh.patch.gz)**

Hi there,

I finalized the doc of this patch. I also took the chance to add a extra option 'warn-links' which make Sphinx complains for dangling links. To ease the review, I uploaded my changes in [attachment: trac_9128-doc_option-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-doc_option-fh.patch.gz). Those changes are folded in [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz) so that you only need to apply this one and the database patch.



---

archive/issue_comments_075818.json:
```json
{
    "body": "Attachment: **[trac_9128-sphinx_links_all-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)**",
    "created_at": "2012-02-20T17:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75818",
    "user": "https://github.com/nthiery"
}
```

Attachment: **[trac_9128-sphinx_links_all-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)**



---

archive/issue_events_115328.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-02-20T17:33:05Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115328"
}
```



---

archive/issue_events_115329.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-02-20T17:33:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115329"
}
```



---

archive/issue_comments_075819.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nI made two last minor changes to Florent's patch, with his agreement, and reposted it.\nGood to go!",
    "created_at": "2012-02-20T17:33:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75819",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:49" align="right">comment:49</div>

I made two last minor changes to Florent's patch, with his agreement, and reposted it.
Good to go!



---

archive/issue_events_115330.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-22T14:49:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115330"
}
```



---

archive/issue_events_115331.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-22T14:49:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115331"
}
```



---

archive/issue_comments_075820.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nUnfortunately, this breaks the pdf reference manual:\n\n```\n! TeX capacity exceeded, sorry [main memory size=1500000].\n<argument> ...\\endcsname \\current@color {0.40,0.40\n                                                  ,0.40}\\set@color\nl.47055 ...1}\\PYG{o}{/}\\PYG{l+m+mf}{0.1}\\PYG{p}{)}\n\n!  ==> Fatal error occurred, no output PDF file produced!\nTranscript written on reference.log.\nmake[1]: *** [reference.pdf] Error 1\nmake[1]: Leaving directory `/mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta5-9128/devel/sage-main/doc/output/latex/en/reference'\nBuild finished.  The built documents can be found in /mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta5-9128/devel/sage/doc/output/pdf/en/reference\n```\n\nThis is using\n\n```\n$ latex --version\npdfTeX using libpoppler 3.141592-1.40.3-2.2 (Web2C 7.5.6)\nkpathsea version 3.5.6\nCopyright 2007 Peter Breitenlohner (eTeX)/Han The Thanh (pdfTeX).\nKpathsea is copyright 2007 Karl Berry and Olaf Weber.\nThere is NO warranty.  Redistribution of this software is\ncovered by the terms of both the pdfTeX using libpoppler copyright and\nthe Lesser GNU General Public License.\nFor more information about these matters, see the file\nnamed COPYING and the pdfTeX using libpoppler source.\nPrimary author of pdfTeX using libpoppler: Peter Breitenlohner (eTeX)/Han The Thanh (pdfTeX).\nKpathsea written by Karl Berry, Olaf Weber, and others.\n\nCompiled with libpng 1.2.15beta5; using libpng 1.2.15beta5\nCompiled with zlib 1.2.3.3; using zlib 1.2.3.3\nCompiled with libpoppler version 3.00\n\n```\n\nFrom Googling around, this might not even be fixable without recompiling LaTeX or at least changing LaTeX's configuration files.",
    "created_at": "2012-02-22T14:49:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75820",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:50" align="right">comment:50</div>

Unfortunately, this breaks the pdf reference manual:

```
! TeX capacity exceeded, sorry [main memory size=1500000].
<argument> ...\endcsname \current@color {0.40,0.40
                                                  ,0.40}\set@color
l.47055 ...1}\PYG{o}{/}\PYG{l+m+mf}{0.1}\PYG{p}{)}

!  ==> Fatal error occurred, no output PDF file produced!
Transcript written on reference.log.
make[1]: *** [reference.pdf] Error 1
make[1]: Leaving directory `/mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta5-9128/devel/sage-main/doc/output/latex/en/reference'
Build finished.  The built documents can be found in /mnt/usb1/scratch/jdemeyer/merger/sage-5.0.beta5-9128/devel/sage/doc/output/pdf/en/reference
```

This is using

```
$ latex --version
pdfTeX using libpoppler 3.141592-1.40.3-2.2 (Web2C 7.5.6)
kpathsea version 3.5.6
Copyright 2007 Peter Breitenlohner (eTeX)/Han The Thanh (pdfTeX).
Kpathsea is copyright 2007 Karl Berry and Olaf Weber.
There is NO warranty.  Redistribution of this software is
covered by the terms of both the pdfTeX using libpoppler copyright and
the Lesser GNU General Public License.
For more information about these matters, see the file
named COPYING and the pdfTeX using libpoppler source.
Primary author of pdfTeX using libpoppler: Peter Breitenlohner (eTeX)/Han The Thanh (pdfTeX).
Kpathsea written by Karl Berry, Olaf Weber, and others.

Compiled with libpng 1.2.15beta5; using libpng 1.2.15beta5
Compiled with zlib 1.2.3.3; using zlib 1.2.3.3
Compiled with libpoppler version 3.00

```

From Googling around, this might not even be fixable without recompiling LaTeX or at least changing LaTeX's configuration files.



---

archive/issue_comments_075821.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nLet me clarify that this happened on sage.math, where the memory size is set to 1500000.  On a different system with 3000000 as limit, it compiled.  The end of that pdflatex log file shows:\n\n```\nHere is how much of TeX's memory you used:\n 59038 strings out of 494632\n 2184818 string characters out of 3923881\n 1820512 words of memory out of 3000000\n 34726 multiletter control sequences out of 10000+50000\n 99604 words of font info for 164 fonts, out of 3000000 for 5000\n 298 hyphenation exceptions out of 8191\n 43i,25n,51p,6802b,946s stack positions out of 5000i,500n,10000p,200000b,50000s\n```\n\nI don't really see a solution besides requiring people to change their LaTeX installs, or splitting up the reference manual (would #6495 fix this?)",
    "created_at": "2012-02-22T16:25:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75821",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">comment:51</div>

Let me clarify that this happened on sage.math, where the memory size is set to 1500000.  On a different system with 3000000 as limit, it compiled.  The end of that pdflatex log file shows:

```
Here is how much of TeX's memory you used:
 59038 strings out of 494632
 2184818 string characters out of 3923881
 1820512 words of memory out of 3000000
 34726 multiletter control sequences out of 10000+50000
 99604 words of font info for 164 fonts, out of 3000000 for 5000
 298 hyphenation exceptions out of 8191
 43i,25n,51p,6802b,946s stack positions out of 5000i,500n,10000p,200000b,50000s
```

I don't really see a solution besides requiring people to change their LaTeX installs, or splitting up the reference manual (would #6495 fix this?)



---

archive/issue_comments_075822.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\n#6495 might fix this, since it breaks the reference manual up into smaller pieces.  The only question is whether the pieces are small enough...",
    "created_at": "2012-02-22T17:47:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75822",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:52" align="right">comment:52</div>

#6495 might fix this, since it breaks the reference manual up into smaller pieces.  The only question is whether the pieces are small enough...



---

archive/issue_comments_075823.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nHi,\n\nReplying to [@jdemeyer](#comment%3A51):\n> Let me clarify that this happened on sage.math, where the memory size is set\n> to 1500000.  On a different system with 3000000 as limit, it compiled.  The\n> end of that pdflatex log file shows:\n\n**`\\begin{GROUMPH}`**\nFirst of all, I need to express my feelings: Fucking Sphinx, Fucking\nLatex. None of these two software where seriously designed to scale to a\nproject of Sage size. That's a shame.\n\nWhile I'm at it, fucking Sagemath distro. It worked without any problem on my\nlaptop.\n**`\\end{GROUMPH}`**\n\nSorry for this non useful comment.\n\nI'm quite angry and frustrated because what my patch does is only to fix a\nhuge bunch of missing links in Sage doc way before they are sent to the\ndocutil writer for HTML or TeX. My patch is working at the level of docutil\nabstract syntax tree, but I could have fixed those link by editing Sage source\nas well.  This means that **if** the doc of Sage was correct, it **won't** compile\neither ! And now because I tried to fix the doc, I'm asked to fix LaTeX. I\ndon't think it is really fair.\n\n> I don't really see a solution besides requiring people to change their LaTeX\n> installs, or splitting up the reference manual (would #6495 fix this?)\n\nThis also means that, whether or not we apply this patch, we **will** hit the\nsame problem again, as the doc of Sage is expected to grow.\n\n---\n\nLet's try to be more constructive. I see several solution:\n\n- add a comment in Sage installation instructions saying that TeX limitation\nshould be enhanced to compile the PDF doc (by the way, are there any people\nreally using the PDF doc out there ?)\n\n- is it really a hard limitation. Couldn't this be fixed by a shell variable ?\nI had the following script in my `~/bin` when I was using `XY-pic`:\n\n```\npopcorn-*binat/doc/common $ cat ~/bin/hugetex\n#!/bin/sh\n#####################################\n# Boosted TeX to compile withc XY-pic\nexport extra_mem_bot=8000000; tex $*\n```\nJeroen: will you be so kind to try if this works ?\n\n- I can maybe disable my link fixing code when we are compiling to PDF, but I\nthink this is really a temporary bugware solution. Considering the time I\nalready lost on this ticket and the fact that this doesn't solve the problem\nbut barely hide it, I don't think this is an acceptable solution.\n\nFlorent",
    "created_at": "2012-02-22T19:08:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75823",
    "user": "https://github.com/hivert"
}
```

<div id="comment:53" align="right">comment:53</div>

Hi,

Replying to [@jdemeyer](#comment%3A51):
> Let me clarify that this happened on sage.math, where the memory size is set
> to 1500000.  On a different system with 3000000 as limit, it compiled.  The
> end of that pdflatex log file shows:

**`\begin{GROUMPH}`**
First of all, I need to express my feelings: Fucking Sphinx, Fucking
Latex. None of these two software where seriously designed to scale to a
project of Sage size. That's a shame.

While I'm at it, fucking Sagemath distro. It worked without any problem on my
laptop.
**`\end{GROUMPH}`**

Sorry for this non useful comment.

I'm quite angry and frustrated because what my patch does is only to fix a
huge bunch of missing links in Sage doc way before they are sent to the
docutil writer for HTML or TeX. My patch is working at the level of docutil
abstract syntax tree, but I could have fixed those link by editing Sage source
as well.  This means that **if** the doc of Sage was correct, it **won't** compile
either ! And now because I tried to fix the doc, I'm asked to fix LaTeX. I
don't think it is really fair.

> I don't really see a solution besides requiring people to change their LaTeX
> installs, or splitting up the reference manual (would #6495 fix this?)

This also means that, whether or not we apply this patch, we **will** hit the
same problem again, as the doc of Sage is expected to grow.

---

Let's try to be more constructive. I see several solution:

- add a comment in Sage installation instructions saying that TeX limitation
should be enhanced to compile the PDF doc (by the way, are there any people
really using the PDF doc out there ?)

- is it really a hard limitation. Couldn't this be fixed by a shell variable ?
I had the following script in my `~/bin` when I was using `XY-pic`:

```
popcorn-*binat/doc/common $ cat ~/bin/hugetex
#!/bin/sh
#####################################
# Boosted TeX to compile withc XY-pic
export extra_mem_bot=8000000; tex $*
```
Jeroen: will you be so kind to try if this works ?

- I can maybe disable my link fixing code when we are compiling to PDF, but I
think this is really a temporary bugware solution. Considering the time I
already lost on this ticket and the fact that this doesn't solve the problem
but barely hide it, I don't think this is an acceptable solution.

Florent



---

archive/issue_comments_075824.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nHi,\n\nReplying to [@jdemeyer](#comment%3A51):\n> Let me clarify that this happened on sage.math, where the memory size is set\n> to 1500000.  On a different system with 3000000 as limit, it compiled.  The\n> end of that pdflatex log file shows:\n\n**`\\begin{GROUMPH}`**\n\nFirst of all, I need to express my feelings: Fucking Sphinx, Fucking\nLatex. None of these two software where seriously designed to scale to a\nproject of Sage's size. That's a shame.\n\nWhile I'm at it, fucking Sagemath distro. It worked without any problem on my\nlaptop.\n\n**`\\end{GROUMPH}`**\n\nSorry for this non useful comment.\n\nI'm quite angry and frustrated because what my patch does is only to fix a\nhuge bunch of missing links in Sage doc, way before they are sent to the\ndocutil writer for HTML or TeX. My patch is working at the level of docutil\nabstract syntax tree, but I could have fixed those link by editing Sage source\nas well.  This means that **if** the doc of Sage was correct, it\n**wouldn't** compile either ! And now because I tried to fix the doc, I'm\nasked to fix LaTeX. I don't think it is really fair.\n\n> I don't really see a solution besides requiring people to change their LaTeX\n> installs, or splitting up the reference manual (would #6495 fix this?)\n\nThis also means that, whether or not we apply this patch, we **will** hit the\nsame problem again, as the doc of Sage is expected to grow.\n\n---\n\nLet's try to be more constructive. I see several solutions:\n\n- add a comment in Sage installation instructions saying that TeX limitation\nshould be enhanced to compile the PDF doc (by the way, are there any people\nreally using the PDF doc out there ?)\n\n- is it really a hard limitation ? Couldn't this be fixed by a shell variable ?\nI had the following script in my `~/bin` when I was using `XY-pic`:\n\n```\n#!/bin/sh\n#####################################\n# Boosted TeX to compile withc XY-pic\nexport extra_mem_bot=8000000; tex $*\n```\nJeroen: will you be so kind to try if this works ?\n\n- I can maybe disable my link fixing code when we are compiling to PDF, but I\nthink this is really a temporary bugware solution. Considering the time I\nalready lost on this ticket and the fact that this doesn't solve the problem\nbut barely hide it under the carpet, I don't think this is an acceptable\nsolution.\n\nWhat do you think ?\n\nFlorent",
    "created_at": "2012-02-22T19:16:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75824",
    "user": "https://github.com/hivert"
}
```

<div id="comment:54" align="right">comment:54</div>

Hi,

Replying to [@jdemeyer](#comment%3A51):
> Let me clarify that this happened on sage.math, where the memory size is set
> to 1500000.  On a different system with 3000000 as limit, it compiled.  The
> end of that pdflatex log file shows:

**`\begin{GROUMPH}`**

First of all, I need to express my feelings: Fucking Sphinx, Fucking
Latex. None of these two software where seriously designed to scale to a
project of Sage's size. That's a shame.

While I'm at it, fucking Sagemath distro. It worked without any problem on my
laptop.

**`\end{GROUMPH}`**

Sorry for this non useful comment.

I'm quite angry and frustrated because what my patch does is only to fix a
huge bunch of missing links in Sage doc, way before they are sent to the
docutil writer for HTML or TeX. My patch is working at the level of docutil
abstract syntax tree, but I could have fixed those link by editing Sage source
as well.  This means that **if** the doc of Sage was correct, it
**wouldn't** compile either ! And now because I tried to fix the doc, I'm
asked to fix LaTeX. I don't think it is really fair.

> I don't really see a solution besides requiring people to change their LaTeX
> installs, or splitting up the reference manual (would #6495 fix this?)

This also means that, whether or not we apply this patch, we **will** hit the
same problem again, as the doc of Sage is expected to grow.

---

Let's try to be more constructive. I see several solutions:

- add a comment in Sage installation instructions saying that TeX limitation
should be enhanced to compile the PDF doc (by the way, are there any people
really using the PDF doc out there ?)

- is it really a hard limitation ? Couldn't this be fixed by a shell variable ?
I had the following script in my `~/bin` when I was using `XY-pic`:

```
#!/bin/sh
#####################################
# Boosted TeX to compile withc XY-pic
export extra_mem_bot=8000000; tex $*
```
Jeroen: will you be so kind to try if this works ?

- I can maybe disable my link fixing code when we are compiling to PDF, but I
think this is really a temporary bugware solution. Considering the time I
already lost on this ticket and the fact that this doesn't solve the problem
but barely hide it under the carpet, I don't think this is an acceptable
solution.

What do you think ?

Florent



---

archive/issue_comments_075825.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nSorry for the double answer. Please only look at the second one.",
    "created_at": "2012-02-22T19:17:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75825",
    "user": "https://github.com/hivert"
}
```

<div id="comment:55" align="right">comment:55</div>

Sorry for the double answer. Please only look at the second one.



---

archive/issue_comments_075826.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@hivert](#comment%3A53):\n> First of all, I need to express my feelings: Fucking Sphinx, Fucking\n> Latex.\n\nI never understood why [Donald Knuth](http://en.wikipedia.org/wiki/Donald_Knuth), who has written so much about algorithms, apparently doesn't know about dynamic memory allocation...",
    "created_at": "2012-02-23T10:38:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75826",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@hivert](#comment%3A53):
> First of all, I need to express my feelings: Fucking Sphinx, Fucking
> Latex.

I never understood why [Donald Knuth](http://en.wikipedia.org/wiki/Donald_Knuth), who has written so much about algorithms, apparently doesn't know about dynamic memory allocation...



---

archive/issue_comments_075827.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@hivert](#comment%3A54):\n> export extra_mem_bot=8000000; tex $*\n\n>\n> Jeroen: will you be so kind to try if this works ?\n\nThis sort of works.  It builds the manual, but here's the strange thing: every run of pdflatex consumes more and more memory.  That is, if I run pdflatex 10 times in a row on `reference.tex` with that extra environment variable, I will certainly hit the error again.",
    "created_at": "2012-02-23T11:23:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75827",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@hivert](#comment%3A54):
> export extra_mem_bot=8000000; tex $*

>
> Jeroen: will you be so kind to try if this works ?

This sort of works.  It builds the manual, but here's the strange thing: every run of pdflatex consumes more and more memory.  That is, if I run pdflatex 10 times in a row on `reference.tex` with that extra environment variable, I will certainly hit the error again.



---

archive/issue_comments_075828.json:
```json
{
    "body": "Changed dependencies from **#11251, #12490** to **#11251, #12490, #12572**",
    "created_at": "2012-02-23T11:29:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75828",
    "user": "https://github.com/jdemeyer"
}
```

Changed dependencies from **#11251, #12490** to **#11251, #12490, #12572**



---

archive/issue_events_115332.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-23T11:29:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115332"
}
```



---

archive/issue_events_115333.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-02-23T11:29:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115333"
}
```



---

archive/issue_comments_075829.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nWith extra_mem_top=2000000 (note bot vs. top), it seems to work as it should:\n\n```\nHere is how much of TeX's memory you used:\n 57776 strings out of 94101\n 2165001 string characters out of 3915810\n 1541607 words of memory out of 2966904\n 33568 multiletter control sequences out of 10000+50000\n 99604 words of font info for 164 fonts, out of 1200000 for 2000\n 638 hyphenation exceptions out of 8191\n 38i,25n,51p,6802b,946s stack positions out of 5000i,500n,6000p,200000b,50000s\n```\n\nSee #12572.",
    "created_at": "2012-02-23T11:29:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75829",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">comment:58</div>

With extra_mem_top=2000000 (note bot vs. top), it seems to work as it should:

```
Here is how much of TeX's memory you used:
 57776 strings out of 94101
 2165001 string characters out of 3915810
 1541607 words of memory out of 2966904
 33568 multiletter control sequences out of 10000+50000
 99604 words of font info for 164 fonts, out of 1200000 for 2000
 638 hyphenation exceptions out of 8191
 38i,25n,51p,6802b,946s stack positions out of 5000i,500n,6000p,200000b,50000s
```

See #12572.



---

archive/issue_comments_075830.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThe new Sphinx spkg to add extra memory to latex is ready for review at #12572.",
    "created_at": "2012-02-29T10:20:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75830",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

The new Sphinx spkg to add extra memory to latex is ready for review at #12572.



---

archive/issue_comments_075831.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nThe files\n\n```\ndoc/common/python.inv\ndoc/common/update-python-inv.sh\n```\nshould be put in `SAGE_ROOT/devel/sage/MANIFEST.in`",
    "created_at": "2012-02-29T11:30:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75831",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

The files

```
doc/common/python.inv
doc/common/update-python-inv.sh
```
should be put in `SAGE_ROOT/devel/sage/MANIFEST.in`



---

archive/issue_comments_075832.json:
```json
{
    "body": "Work Issues: **MANIFEST.in**",
    "created_at": "2012-03-01T17:19:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75832",
    "user": "https://github.com/jdemeyer"
}
```

Work Issues: **MANIFEST.in**



---

archive/issue_events_115334.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-01T17:19:01Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115334"
}
```



---

archive/issue_events_115335.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-01T17:19:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115335"
}
```



---

archive/issue_comments_075833.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -50,4 +50,4 @@\n \n - [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)\n - [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)\n-\n+- [attachment: trac_9128-MANIFEST-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz)\n``````\n",
    "created_at": "2012-03-04T22:19:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75833",
    "user": "https://github.com/hivert"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -50,4 +50,4 @@
 
 - [attachment: trac_9128-intersphinx_python_database-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-intersphinx_python_database-fh.patch.gz)
 - [attachment: trac_9128-sphinx_links_all-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-sphinx_links_all-fh.patch.gz)
-
+- [attachment: trac_9128-MANIFEST-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz)
``````




---

archive/issue_events_115336.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2012-03-04T22:19:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115336"
}
```



---

archive/issue_events_115337.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2012-03-04T22:19:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115337"
}
```



---

archive/issue_comments_075834.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nAttachment: **[trac_9128-MANIFEST-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz)**\n\nReplying to [@jdemeyer](#comment%3A60):\n> The files\n\n\n```\ndoc/common/python.inv\ndoc/common/update-python-inv.sh\n```\n> should be put in `SAGE_ROOT/devel/sage/MANIFEST.in`\n\nThanks for pointing this out. I just added a patch [attachment: trac_9128-MANIFEST-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz) which should do that. Please double check as I don't really know what should be there.\n\nFlorent",
    "created_at": "2012-03-04T22:19:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75834",
    "user": "https://github.com/hivert"
}
```

<div id="comment:62" align="right">comment:62</div>

Attachment: **[trac_9128-MANIFEST-fh.patch.gz](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz)**

Replying to [@jdemeyer](#comment%3A60):
> The files


```
doc/common/python.inv
doc/common/update-python-inv.sh
```
> should be put in `SAGE_ROOT/devel/sage/MANIFEST.in`

Thanks for pointing this out. I just added a patch [attachment: trac_9128-MANIFEST-fh.patch](https://github.com/sagemath/sage/files/ticket9128/trac_9128-MANIFEST-fh.patch.gz) which should do that. Please double check as I don't really know what should be there.

Florent



---

archive/issue_comments_075835.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nThis looks good. Back to positive review!",
    "created_at": "2012-03-06T12:09:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75835",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:63" align="right">comment:63</div>

This looks good. Back to positive review!



---

archive/issue_events_115338.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-03-06T12:09:33Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115338"
}
```



---

archive/issue_events_115339.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2012-03-06T12:09:33Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115339"
}
```



---

archive/issue_comments_075836.json:
```json
{
    "body": "Changed work issues from **MANIFEST.in** to none",
    "created_at": "2012-03-07T08:59:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75836",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **MANIFEST.in** to none



---

archive/issue_events_115340.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-13T08:21:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115340"
}
```



---

archive/issue_events_115341.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-03-13T08:21:27Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9128#event-115341"
}
```



---

archive/issue_comments_075837.json:
```json
{
    "body": "Merged: **sage-5.0.beta8**",
    "created_at": "2012-03-13T08:21:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75837",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-5.0.beta8**



---

archive/issue_comments_075838.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nYippee, a good thing done! \n\nThanks Florent for all the energy you put into this ticket :-)\nThanks everyone for the review and support.",
    "created_at": "2012-03-13T08:34:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75838",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:66" align="right">comment:66</div>

Yippee, a good thing done! 

Thanks Florent for all the energy you put into this ticket :-)
Thanks everyone for the review and support.



---

archive/issue_comments_075839.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nSee #12849 for a blocker follow-up: The argspecs of extension function/methods is broken in the Sphinx documentation.",
    "created_at": "2012-04-18T18:59:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75839",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:67" align="right">comment:67</div>

See #12849 for a blocker follow-up: The argspecs of extension function/methods is broken in the Sphinx documentation.



---

archive/issue_comments_075840.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nSee #13057 for a speed regression followup. It seems that this ticket slowed down introspection quite a bit.",
    "created_at": "2012-05-29T10:02:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75840",
    "user": "https://github.com/sagetrac-bober"
}
```

<div id="comment:68" align="right">comment:68</div>

See #13057 for a speed regression followup. It seems that this ticket slowed down introspection quite a bit.



---

archive/issue_comments_075841.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nThis ticket also introduced a memory leak - 56 MB per docstring lookup. See #13057 and [sage-devel](http://thread.gmane.org/gmane.comp.mathematics.sage.devel/59498).",
    "created_at": "2012-05-31T18:51:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9128",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9128#issuecomment-75841",
    "user": "https://github.com/kini"
}
```

<div id="comment:69" align="right">comment:69</div>

This ticket also introduced a memory leak - 56 MB per docstring lookup. See #13057 and [sage-devel](http://thread.gmane.org/gmane.comp.mathematics.sage.devel/59498).
