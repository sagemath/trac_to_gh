# Issue 9369: make verbose command flush its output

archive/issues_009369.json:
```json
{
    "body": "\n\n**Assignee:** @jasongrout\n\n**Author:** William Stein\n\n**Reviewer:** Robert Miller\n\n**Merged:** sage-4.6.2.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/9369\n\n",
    "closed_at": "2011-01-19T22:21:09Z",
    "created_at": "2010-06-28T23:43:29Z",
    "labels": [
        "component: misc",
        "minor",
        "enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6.2",
    "title": "make verbose command flush its output",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/9369",
    "user": "https://github.com/williamstein"
}
```


**Assignee:** @jasongrout

**Author:** William Stein

**Reviewer:** Robert Miller

**Merged:** sage-4.6.2.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/9369





---

archive/attachments_011884.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9369.patch",
    "asset_url": "tarball://root/attachments/ticket9369/trac_9369.patch",
    "created_at": "2010-06-28T23:49:05Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket9369/trac_9369.patch",
    "user": "https://github.com/williamstein"
}
```



---

archive/issue_comments_081687.json:
```json
{
    "body": "Attachment [trac_9369.patch](https://github.com/sagemath/sage/files/ticket9369/trac_9369.patch) by @williamstein created at 2010-06-28 23:49:05",
    "created_at": "2010-06-28T23:49:05Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81687",
    "user": "https://github.com/williamstein"
}
```

Attachment [trac_9369.patch](https://github.com/sagemath/sage/files/ticket9369/trac_9369.patch) by @williamstein created at 2010-06-28 23:49:05



---

archive/issue_events_068629.json:
```json
{
    "actor": "https://github.com/williamstein",
    "created_at": "2010-06-28T23:50:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9369#event-68629"
}
```



---

archive/issue_comments_081688.json:
```json
{
    "body": "<a id='comment:1'></a>\nThe point of this is that if you do\n\n```\nsage foo.sage > output.out\ntail -f output.out\n```\n\nand use verbose(...) in foo.sage, you'll see nothing for a while, which sucks.",
    "created_at": "2010-06-28T23:50:01Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81688",
    "user": "https://github.com/williamstein"
}
```

<a id='comment:1'></a>
The point of this is that if you do

```
sage foo.sage > output.out
tail -f output.out
```

and use verbose(...) in foo.sage, you'll see nothing for a while, which sucks.



---

archive/issue_comments_081689.json:
```json
{
    "body": "<a id='comment:2'></a>\nThis might or might not be slightly off topic. Without verbose, it doesn't seem to be flushing at all. I tried the following in a file called `test.sage` with `./sage test.sage > ~/foo.txt` and `tail -f ~/foo.txt` only showed the output once I interrupted the loop.\n\n```\nfor E in cremona_optimal_curves(range(10000)):\n    print E.label(), E.sha().an()\n```\n\nI remember doing something like this a long time ago and it working. Wassupwiddat?",
    "created_at": "2010-06-29T18:28:34Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81689",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:2'></a>
This might or might not be slightly off topic. Without verbose, it doesn't seem to be flushing at all. I tried the following in a file called `test.sage` with `./sage test.sage > ~/foo.txt` and `tail -f ~/foo.txt` only showed the output once I interrupted the loop.

```
for E in cremona_optimal_curves(range(10000)):
    print E.label(), E.sha().an()
```

I remember doing something like this a long time ago and it working. Wassupwiddat?



---

archive/issue_comments_081690.json:
```json
{
    "body": "<a id='comment:3'></a>\nAlso, if I don't stream the output to a file, it does print in real time. Am I missing a linux-ism here?",
    "created_at": "2010-06-29T18:29:22Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81690",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:3'></a>
Also, if I don't stream the output to a file, it does print in real time. Am I missing a linux-ism here?



---

archive/issue_comments_081691.json:
```json
{
    "body": "<a id='comment:4'></a>\nThis sort of behaviour is standard in most programming languages for efficiency: whenever the OS is asked to print to a file (and in some cases, also if it is to a terminal), it collects output until some buffer is filled, and this entire buffer is then output in one go. If flushing is needed (e.g. for when output is only produced rarely between heavy computations), it should be explicitly stated.\n\nI am not completely sure if the above usage corresponds well to the intended workflow of the verbose function, but this concern should at least be considered before adding the mandatory flush statement. After all, the flush statement could just have been manually added in foo.sage.",
    "created_at": "2010-07-30T14:14:27Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81691",
    "user": "https://github.com/johanrosenkilde"
}
```

<a id='comment:4'></a>
This sort of behaviour is standard in most programming languages for efficiency: whenever the OS is asked to print to a file (and in some cases, also if it is to a terminal), it collects output until some buffer is filled, and this entire buffer is then output in one go. If flushing is needed (e.g. for when output is only produced rarely between heavy computations), it should be explicitly stated.

I am not completely sure if the above usage corresponds well to the intended workflow of the verbose function, but this concern should at least be considered before adding the mandatory flush statement. After all, the flush statement could just have been manually added in foo.sage.



---

archive/issue_comments_081692.json:
```json
{
    "body": "<a id='comment:5'></a>\nThis is definitely an improvement, regardless. Let's get this merged.",
    "created_at": "2011-01-19T06:55:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81692",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:5'></a>
This is definitely an improvement, regardless. Let's get this merged.



---

archive/issue_events_068630.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-19T06:55:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9369#event-68630"
}
```



---

archive/issue_events_068631.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-19T06:55:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9369#event-68631"
}
```



---

archive/issue_comments_081693.json:
```json
{
    "body": "**Reviewer:** Robert Miller",
    "created_at": "2011-01-19T06:55:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81693",
    "user": "https://github.com/rlmill"
}
```

**Reviewer:** Robert Miller



---

archive/issue_comments_081694.json:
```json
{
    "body": "**Author:** William Stein",
    "created_at": "2011-01-19T06:55:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81694",
    "user": "https://github.com/rlmill"
}
```

**Author:** William Stein



---

archive/issue_comments_081695.json:
```json
{
    "body": "**Merged:** sage-4.6.2.alpha1",
    "created_at": "2011-01-19T22:21:09Z",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9369#issuecomment-81695",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.2.alpha1



---

archive/issue_events_068632.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:21:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9369#event-68632"
}
```



---

archive/issue_events_068633.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:21:09Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9369",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9369#event-68633"
}
```
