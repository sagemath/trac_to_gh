# Issue 9877: Add is_sturmian_factor, is_tangent methods for finite words

archive/issues_009876.json:
```json
{
    "assignees": [],
    "body": "Add 3 methods to `sage/combinat/words/finite_word.py`:\n\n1. sturmian_desubstitute_as_possible\n2. is_sturmian_factor\n3. is_tangent\n\nAdd a protecting `is_tangent` method to `sage/combinat/words/paths.py`.\n\n```\nsage: w = Word('01110110110111011101',alphabet='01')\nsage: w.is_tangent()                  \nTrue\n```\nDepends on #8739.\n\nApply:\n* [attachment:trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch) \n* [attachment:trac_9777-sturm-review-fc.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9777-sturm-review-fc.patch)\n\n**Assignee:** tmonteil\n\n**CC:**  sage-combinat abmasse @seblabbe\n\n**Keywords:** sturmian word, tangent word\n\n**Reviewer:** Alexandre Blondin Mass\u00e9, S\u00e9bastien Labb\u00e9, Vincent Delecroix\n\n**Author:** Thierry Monteil, Fr\u00e9d\u00e9ric Chapoton\n\n**Merged:** sage-5.9.beta1\n\nIssue created by migration from https://trac.sagemath.org/ticket/9877\n\n",
    "closed_at": "2013-03-20T14:43:23Z",
    "created_at": "2010-09-08T21:05:26Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20combinatorics",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-5.9",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Add is_sturmian_factor, is_tangent methods for finite words",
    "type": "issue",
    "updated_at": "2013-03-20T14:43:23Z",
    "url": "https://github.com/sagemath/sage/issues/9877",
    "user": "https://github.com/sagetrac-tmonteil"
}
```
Add 3 methods to `sage/combinat/words/finite_word.py`:

1. sturmian_desubstitute_as_possible
2. is_sturmian_factor
3. is_tangent

Add a protecting `is_tangent` method to `sage/combinat/words/paths.py`.

```
sage: w = Word('01110110110111011101',alphabet='01')
sage: w.is_tangent()                  
True
```
Depends on #8739.

Apply:
* [attachment:trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch) 
* [attachment:trac_9777-sturm-review-fc.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9777-sturm-review-fc.patch)

**Assignee:** tmonteil

**CC:**  sage-combinat abmasse @seblabbe

**Keywords:** sturmian word, tangent word

**Reviewer:** Alexandre Blondin Massé, Sébastien Labbé, Vincent Delecroix

**Author:** Thierry Monteil, Frédéric Chapoton

**Merged:** sage-5.9.beta1

Issue created by migration from https://trac.sagemath.org/ticket/9877





---

archive/issue_events_073944.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2010-09-24T16:17:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73944"
}
```



---

archive/issue_comments_090486.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-Add 3 methods to the `sage/combinat/words/finite_word.py`:\n+Add 3 methods to `sage/combinat/words/finite_word.py`:\n \n 1. sturmian_desubstitute_as_possible\n 2. is_sturmian_factor\n``````\n",
    "created_at": "2010-09-24T16:17:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90486",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-Add 3 methods to the `sage/combinat/words/finite_word.py`:
+Add 3 methods to `sage/combinat/words/finite_word.py`:
 
 1. sturmian_desubstitute_as_possible
 2. is_sturmian_factor
``````




---

archive/issue_events_073945.json:
```json
{
    "actor": "https://github.com/sagetrac-abmasse",
    "created_at": "2010-10-01T18:31:44Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73945"
}
```



---

archive/issue_events_073946.json:
```json
{
    "actor": "https://github.com/sagetrac-abmasse",
    "created_at": "2010-10-01T18:31:44Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73946"
}
```



---

archive/issue_comments_090487.json:
```json
{
    "body": "<a id='comment:2'></a>\nI'm testing your patch in the next two hours. Before testing it explicitly, just some comments:\n\n1. Could you add a reference where one can find the proof that a word is finite sturmian if and only if you can desubstitute it to the empy word?\n2. As I told you when you were in Montreal, I think I prefer the name `is_finite_sturmian` (or just `is_sturmian`) over the name  `is_sturmian_factor`. I feel that the last one implies an argument like in `w.is_sturmian_factor(u)` and it seems to be used in many articles (just googling it, you find a big list).\n3. Not very important, but there are two comment `# print <something>` that should be removed from the code in the function `is_sturmian_factor`.\n\nI'm waiting for sage-combinat to install and I'll test and look more thoroughly at your code.",
    "created_at": "2010-10-01T18:31:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90487",
    "user": "https://github.com/sagetrac-abmasse"
}
```

<a id='comment:2'></a>
I'm testing your patch in the next two hours. Before testing it explicitly, just some comments:

1. Could you add a reference where one can find the proof that a word is finite sturmian if and only if you can desubstitute it to the empy word?
2. As I told you when you were in Montreal, I think I prefer the name `is_finite_sturmian` (or just `is_sturmian`) over the name  `is_sturmian_factor`. I feel that the last one implies an argument like in `w.is_sturmian_factor(u)` and it seems to be used in many articles (just googling it, you find a big list).
3. Not very important, but there are two comment `# print <something>` that should be removed from the code in the function `is_sturmian_factor`.

I'm waiting for sage-combinat to install and I'll test and look more thoroughly at your code.



---

archive/issue_comments_090488.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere is another problem with your function:\n\n```\nTypeError: Your word must be defined on a binary alphabet\nsage: \nsage: \nsage: Word('ababab', alphabet='ab').is_sturmian_factor()\nTrue\nsage: Word('ababab').is_sturmian_factor()\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n\n/Users/alexandre/Applications/sage/devel/sage-combinat/sage/combinat/words/<ipython console> in <module>()\n\n/Users/alexandre/Applications/sage/local/lib/python2.6/site-packages/sage/combinat/words/finite_word.pyc in is_sturmian_factor(self)\n   4197         - Thierry Monteil\n   4198         \"\"\"\n-> 4199         return self.sturmian_desubstitute_as_possible().is_empty()\n   4200 \n   4201 \n\n/Users/alexandre/Applications/sage/local/lib/python2.6/site-packages/sage/combinat/words/finite_word.pyc in sturmian_desubstitute_as_possible(self)\n   4086         W = self.parent()\n   4087         if (W.size_of_alphabet() != 2):\n-> 4088             raise TypeError, 'Your word must be defined on a binary alphabet'\n   4089         alphabet = W.alphabet()\n   4090         if self.is_empty():\n\nTypeError: Your word must be defined on a binary alphabet\n```\n\nI think this shouldn't be the case. In fact, this is interesting, because it raises another problem I had when working on another patch. What I suggest is that you could first verify if the parent has size 2 and, if it's not the case, you check if its *real* alphabet has size 2 by using the expression\nlen(set(self)) == 2\n\nI think the clean solution would be to replace the deprecated function `alphabet()` by a new one that would compute the *real alphabet* in question, so that there would be two kinds of alphabet:\n\n1. The one corresponding to the parent of the word (for instance `aaab` might be a word defined on the alphabet `{a,b,c}`).\n2. The one corresponding to the alphabet realized by the word `Alph(aaab) = {a,b}`\n\nThe first one is called by `w.parent().alphabet()` while the second one would be obtained from `w.alphabet()`. But this is for another ticket.\n\nWhat I suggest is that you simply add the `len(set(w)) == 2` condition to your code and we'll clean it eventually.",
    "created_at": "2010-10-01T19:59:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90488",
    "user": "https://github.com/sagetrac-abmasse"
}
```

<a id='comment:3'></a>
There is another problem with your function:

```
TypeError: Your word must be defined on a binary alphabet
sage: 
sage: 
sage: Word('ababab', alphabet='ab').is_sturmian_factor()
True
sage: Word('ababab').is_sturmian_factor()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/alexandre/Applications/sage/devel/sage-combinat/sage/combinat/words/<ipython console> in <module>()

/Users/alexandre/Applications/sage/local/lib/python2.6/site-packages/sage/combinat/words/finite_word.pyc in is_sturmian_factor(self)
   4197         - Thierry Monteil
   4198         """
-> 4199         return self.sturmian_desubstitute_as_possible().is_empty()
   4200 
   4201 

/Users/alexandre/Applications/sage/local/lib/python2.6/site-packages/sage/combinat/words/finite_word.pyc in sturmian_desubstitute_as_possible(self)
   4086         W = self.parent()
   4087         if (W.size_of_alphabet() != 2):
-> 4088             raise TypeError, 'Your word must be defined on a binary alphabet'
   4089         alphabet = W.alphabet()
   4090         if self.is_empty():

TypeError: Your word must be defined on a binary alphabet
```

I think this shouldn't be the case. In fact, this is interesting, because it raises another problem I had when working on another patch. What I suggest is that you could first verify if the parent has size 2 and, if it's not the case, you check if its *real* alphabet has size 2 by using the expression
len(set(self)) == 2

I think the clean solution would be to replace the deprecated function `alphabet()` by a new one that would compute the *real alphabet* in question, so that there would be two kinds of alphabet:

1. The one corresponding to the parent of the word (for instance `aaab` might be a word defined on the alphabet `{a,b,c}`).
2. The one corresponding to the alphabet realized by the word `Alph(aaab) = {a,b}`

The first one is called by `w.parent().alphabet()` while the second one would be obtained from `w.alphabet()`. But this is for another ticket.

What I suggest is that you simply add the `len(set(w)) == 2` condition to your code and we'll clean it eventually.



---

archive/issue_comments_090489.json:
```json
{
    "body": "<a id='comment:4'></a>\nI might be wrong, but it seems that the code for the `desubstitute_as_possible` is long and should be cut into smaller functions that maybe already exist in Sage. Could you provide me the pseudocode of the function?",
    "created_at": "2010-10-01T20:32:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90489",
    "user": "https://github.com/sagetrac-abmasse"
}
```

<a id='comment:4'></a>
I might be wrong, but it seems that the code for the `desubstitute_as_possible` is long and should be cut into smaller functions that maybe already exist in Sage. Could you provide me the pseudocode of the function?



---

archive/issue_comments_090490.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [abmasse](#comment%3A2):\n> 1. Could you add a reference where one can find the proof that a word is finite sturmian if and only if you can desubstitute it to the empy word?\n\nSure. This is a well known result (though there are many variants of this idea, i do not know whether this exact one is written somewhere), but i will add at least in the Arnoux chapter of the Pytheas Fogg book. I guess i will also add a reference to a recent article of Smillie and Ulcigrai which explains this in a nice way.",
    "created_at": "2010-10-01T22:53:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90490",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:5'></a>
Replying to [abmasse](#comment%3A2):
> 1. Could you add a reference where one can find the proof that a word is finite sturmian if and only if you can desubstitute it to the empy word?

Sure. This is a well known result (though there are many variants of this idea, i do not know whether this exact one is written somewhere), but i will add at least in the Arnoux chapter of the Pytheas Fogg book. I guess i will also add a reference to a recent article of Smillie and Ulcigrai which explains this in a nice way.



---

archive/issue_comments_090491.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [abmasse](#comment%3A2):\n> 2. Not very important, but there are two comment `# print <something>` that should be removed from the code in the function `is_sturmian_factor`.\n\nok.",
    "created_at": "2010-10-01T22:56:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90491",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:6'></a>
Replying to [abmasse](#comment%3A2):
> 2. Not very important, but there are two comment `# print <something>` that should be removed from the code in the function `is_sturmian_factor`.

ok.



---

archive/issue_comments_090492.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [abmasse](#comment%3A2):\n> 2. As I told you when you were in Montreal, I think I prefer the name `is_finite_sturmian` (or just `is_sturmian`) over the name `is_sturmian_factor`. I feel that the last one implies an argument like in `w.is_sturmian_factor(u)` and it seems to be used in many articles (just googling it, you find a big list).\n\nActually, those words are the balanced one, but the method `is_balanced` already exists with a slower (quadratic complexity) implementation (that implements the definition of the balanced word). The first name of my method was `is_factor_of_a_sturmian_word`, which describes precisely the method but is too long.\n\nI do not really like `is_finite_sturmian`, and i am completely opposed to the name `is_sturmian` because the word Sturmian is reserved for infinite words (and this is not the role of sage to change historical notations). Also `is_finite_sturmian` will not be well positioned in the automatic completion.\n\nAnother possibility could be to add a parameter `algorithm` with values `default`, `desubstitution` or `definition` and merge this method into the existing slow method `is_balanced` (with the `desubstitution` algorithm only applying for 1-balanced words).",
    "created_at": "2010-10-01T23:21:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90492",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:7'></a>
Replying to [abmasse](#comment%3A2):
> 2. As I told you when you were in Montreal, I think I prefer the name `is_finite_sturmian` (or just `is_sturmian`) over the name `is_sturmian_factor`. I feel that the last one implies an argument like in `w.is_sturmian_factor(u)` and it seems to be used in many articles (just googling it, you find a big list).

Actually, those words are the balanced one, but the method `is_balanced` already exists with a slower (quadratic complexity) implementation (that implements the definition of the balanced word). The first name of my method was `is_factor_of_a_sturmian_word`, which describes precisely the method but is too long.

I do not really like `is_finite_sturmian`, and i am completely opposed to the name `is_sturmian` because the word Sturmian is reserved for infinite words (and this is not the role of sage to change historical notations). Also `is_finite_sturmian` will not be well positioned in the automatic completion.

Another possibility could be to add a parameter `algorithm` with values `default`, `desubstitution` or `definition` and merge this method into the existing slow method `is_balanced` (with the `desubstitution` algorithm only applying for 1-balanced words).



---

archive/issue_comments_090493.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [tmonteil](#comment%3A7):\n\n> \n> Another possibility could be to add a parameter `algorithm` with values `default`, `desubstitution` or `definition` and merge this method into the existing slow method `is_balanced` (with the `desubstitution` algorithm only applying for 1-balanced words).\n\nThis is a very good idea. I think you should do it.",
    "created_at": "2010-10-01T23:38:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90493",
    "user": "https://github.com/sagetrac-abmasse"
}
```

<a id='comment:8'></a>
Replying to [tmonteil](#comment%3A7):

> 
> Another possibility could be to add a parameter `algorithm` with values `default`, `desubstitution` or `definition` and merge this method into the existing slow method `is_balanced` (with the `desubstitution` algorithm only applying for 1-balanced words).

This is a very good idea. I think you should do it.



---

archive/issue_comments_090494.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [abmasse](#comment%3A3):\n> There is another problem with your function:\n\n\n```\n[cut]\nTypeError: Your word must be defined on a binary alphabet\n```\n> \n> I think this shouldn't be the case. In fact, this is interesting, because it raises another problem I had when working on another patch. What I suggest is that you could first verify if the parent has size 2 and, if it's not the case, you check if its *real* alphabet has size 2 by using the expression\n> len(set(self)) == 2\n> \n> I think the clean solution would be to replace the deprecated function `alphabet()` by a new one that would compute the *real alphabet* in question, so that there would be two kinds of alphabet:\n> \n> 1. The one corresponding to the parent of the word (for instance `aaab` might be a word defined on the alphabet `{a,b,c}`).\n> 2. The one corresponding to the alphabet realized by the word `Alph(aaab) = {a,b}`\n> \n> The first one is called by `w.parent().alphabet()` while the second one would be obtained from `w.alphabet()`. But this is for another ticket.\n> \n> What I suggest is that you simply add the `len(set(w)) == 2` condition to your code and we'll clean it eventually.\n\n\nSince it is explained in the documentation, this is not a bug but a feature ;)\n\nI was thinking about this alphabet problem, and i am willing to write a ticket about that issue. I think that such a decision should be made for the whole word directory, with its whole community. Here are some bits.\n\nIf i start to do such tests in such a method, then almost every method of the FiniteWords class will have to do it as well, and the faster parent().alphabet() method will become useless. So there is a problem of code replication.\n\nAnother problem is that a test like `len(set(w)) == 2` takes probably a linear time whereas `size_of_alphabet` is just looking into the parent, which is constant time. \n\nSome programmer (user) should know where his/her words are living and should be warned if not. Making \"friendly code\" does not mean to pass over dirty programmer's inconsistencies, because then it won't detect the clean programmer's mistakes anymore. Fore those lazy ways of programming, we can imagine a global option which tells how the methods should care about the alphabet, so that both kinds of behavior are possible.\n\nAs for me, this may look Bourbachist (in particular not `bash`-ist ;), but i would like the empty word defined on a 2-letter alphabet to be recognized as a factor of a Sturmian word and not necessarily the empty word defined on a three letter alphabet (or at least to be warned if i do so). This may be, a contrario, an argument to make a difference between `is_sturmian_factor` (or `is_finite_sturmian`) and `is_balanced(1)`.\n\n\nIf in some very few occasion, the user will indeed need to use such a method on some words defined on some non-two-letter alphabet, but then there should be some general coerce methods like `redefine_alphabet` or `minimize_alphabet_to_actually_used_letters` that s-he can use in his/her code.\n\nAnother example of why the alphabet question deals with the whole `word` directory, and why there should be an overall policy is the following:\n\n```\nsage: words.LowerMechanicalWord(1/sqrt(2)).parent()\nWords\nsage: words.CharacteristicSturmianWord(1/sqrt(2)).parent()\nWords over Ordered Alphabet [0, 1]\n```",
    "created_at": "2010-10-02T00:32:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90494",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:9'></a>
Replying to [abmasse](#comment%3A3):
> There is another problem with your function:


```
[cut]
TypeError: Your word must be defined on a binary alphabet
```
> 
> I think this shouldn't be the case. In fact, this is interesting, because it raises another problem I had when working on another patch. What I suggest is that you could first verify if the parent has size 2 and, if it's not the case, you check if its *real* alphabet has size 2 by using the expression
> len(set(self)) == 2
> 
> I think the clean solution would be to replace the deprecated function `alphabet()` by a new one that would compute the *real alphabet* in question, so that there would be two kinds of alphabet:
> 
> 1. The one corresponding to the parent of the word (for instance `aaab` might be a word defined on the alphabet `{a,b,c}`).
> 2. The one corresponding to the alphabet realized by the word `Alph(aaab) = {a,b}`
> 
> The first one is called by `w.parent().alphabet()` while the second one would be obtained from `w.alphabet()`. But this is for another ticket.
> 
> What I suggest is that you simply add the `len(set(w)) == 2` condition to your code and we'll clean it eventually.


Since it is explained in the documentation, this is not a bug but a feature ;)

I was thinking about this alphabet problem, and i am willing to write a ticket about that issue. I think that such a decision should be made for the whole word directory, with its whole community. Here are some bits.

If i start to do such tests in such a method, then almost every method of the FiniteWords class will have to do it as well, and the faster parent().alphabet() method will become useless. So there is a problem of code replication.

Another problem is that a test like `len(set(w)) == 2` takes probably a linear time whereas `size_of_alphabet` is just looking into the parent, which is constant time. 

Some programmer (user) should know where his/her words are living and should be warned if not. Making "friendly code" does not mean to pass over dirty programmer's inconsistencies, because then it won't detect the clean programmer's mistakes anymore. Fore those lazy ways of programming, we can imagine a global option which tells how the methods should care about the alphabet, so that both kinds of behavior are possible.

As for me, this may look Bourbachist (in particular not `bash`-ist ;), but i would like the empty word defined on a 2-letter alphabet to be recognized as a factor of a Sturmian word and not necessarily the empty word defined on a three letter alphabet (or at least to be warned if i do so). This may be, a contrario, an argument to make a difference between `is_sturmian_factor` (or `is_finite_sturmian`) and `is_balanced(1)`.


If in some very few occasion, the user will indeed need to use such a method on some words defined on some non-two-letter alphabet, but then there should be some general coerce methods like `redefine_alphabet` or `minimize_alphabet_to_actually_used_letters` that s-he can use in his/her code.

Another example of why the alphabet question deals with the whole `word` directory, and why there should be an overall policy is the following:

```
sage: words.LowerMechanicalWord(1/sqrt(2)).parent()
Words
sage: words.CharacteristicSturmianWord(1/sqrt(2)).parent()
Words over Ordered Alphabet [0, 1]
```



---

archive/issue_comments_090495.json:
```json
{
    "body": "<a id='comment:10'></a>\n> The first one is called by `w.parent().alphabet()` while the second one would be obtained from `w.alphabet()`. But this is for another ticket.\n> \n> What I suggest is that you simply add the `len(set(w)) == 2` condition to your code and we'll clean it eventually.\n\nI think this is a very good suggestion.\n\nS\u00e9bastien",
    "created_at": "2010-10-15T22:15:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90495",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:10'></a>
> The first one is called by `w.parent().alphabet()` while the second one would be obtained from `w.alphabet()`. But this is for another ticket.
> 
> What I suggest is that you simply add the `len(set(w)) == 2` condition to your code and we'll clean it eventually.

I think this is a very good suggestion.

Sébastien



---

archive/issue_comments_090496.json:
```json
{
    "body": "<a id='comment:11'></a>\nHi, Thierry !\n\nSorry if I haven't been available lately (busy, you know, the usual justification...).\n\nIf I'm not mistaken, there were last minor issues with your ticket that haven't been completely solved. To recap:\n\n1. Cleaning some commented code.\n2. Adding the `len(set(w)) == 2` condition. I understand your point of view that this should be done by many other functions in Sage, but for now, it will be cleaner if we do so.\n3. Finally, I agree with you about keeping the name `is_sturmian_factor`.\n4. Providing a reference for the theorem that desubstituting as possible to the empty word is equivalent to being Sturmian.\n \nThis is pretty much it!",
    "created_at": "2010-11-13T16:07:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90496",
    "user": "https://github.com/sagetrac-abmasse"
}
```

<a id='comment:11'></a>
Hi, Thierry !

Sorry if I haven't been available lately (busy, you know, the usual justification...).

If I'm not mistaken, there were last minor issues with your ticket that haven't been completely solved. To recap:

1. Cleaning some commented code.
2. Adding the `len(set(w)) == 2` condition. I understand your point of view that this should be done by many other functions in Sage, but for now, it will be cleaner if we do so.
3. Finally, I agree with you about keeping the name `is_sturmian_factor`.
4. Providing a reference for the theorem that desubstituting as possible to the empty word is equivalent to being Sturmian.
 
This is pretty much it!



---

archive/issue_comments_090497.json:
```json
{
    "body": "<a id='comment:12'></a>\nWe were on strike my friend.",
    "created_at": "2010-12-29T15:58:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90497",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:12'></a>
We were on strike my friend.



---

archive/issue_comments_090498.json:
```json
{
    "body": "Tested on Sage 4.6",
    "created_at": "2010-12-29T16:02:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90498",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

Tested on Sage 4.6



---

archive/issue_comments_090499.json:
```json
{
    "body": "<a id='comment:13'></a>\n**Attachment:** [trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch.gz](https://github.com/sagemath/sage/files/ticket9877/trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch.gz)\n\nHi Alexandre,\n\ni started to work back on this ticket. This new patch is supposed to solve your four points. \n\nSince the `is_tangent()` method can now be applied to a word with more than 2 letters, i added a protection in the `FiniteWordPath_all` class into the file `paths.py` so that `is_tangent()` could not be applied for such word paths. Indeed, there is an extended definition for them, which is not yet written (see the paper).\n\nAlso, concerning a previous comment on using existing sage code, i looked for some \"run\" method and the only similar code i found was the `_delta_iterator()` method in the `Word_class` class. I tried to use it, but it seems that the use of the `groupby` itertool followed by `len` makes a slower code:\n\n```\nfrom itertools import groupby\n\ndef runs_groupby(self):\n    for letter, run in groupby(self):\n        yield letter, len(list(run))\n\ndef runs_homemade(self):\n    try:\n        previous_letter = self[0]\n    except IndexError:\n        return\n    current_run_length = 0\n    for i in self:\n        if i == previous_letter:\n            current_run_length += 1\n        else:\n            yield previous_letter , current_run_length\n            current_run_length = 1\n            previous_letter = i\n    yield previous_letter , current_run_length\n\ntimeit('for i in runs_groupby(words.FibonacciWord()[:1000]):\\n    print i')\n\ntimeit('for i in runs_homemade(words.FibonacciWord()[:1000]):\\n    print i')\n\n```\n\nThe first takes 28.6 ms per loop whereas the second takes 18.2 ms per loop. The problem is that the first method, though more low-level, is like passing twice on the word, which seems to be slower than the second (high-level) one-pass method.\n\nCiao,\nThierry",
    "created_at": "2010-12-29T16:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90499",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

<a id='comment:13'></a>
**Attachment:** [trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch.gz](https://github.com/sagemath/sage/files/ticket9877/trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch.gz)

Hi Alexandre,

i started to work back on this ticket. This new patch is supposed to solve your four points. 

Since the `is_tangent()` method can now be applied to a word with more than 2 letters, i added a protection in the `FiniteWordPath_all` class into the file `paths.py` so that `is_tangent()` could not be applied for such word paths. Indeed, there is an extended definition for them, which is not yet written (see the paper).

Also, concerning a previous comment on using existing sage code, i looked for some "run" method and the only similar code i found was the `_delta_iterator()` method in the `Word_class` class. I tried to use it, but it seems that the use of the `groupby` itertool followed by `len` makes a slower code:

```
from itertools import groupby

def runs_groupby(self):
    for letter, run in groupby(self):
        yield letter, len(list(run))

def runs_homemade(self):
    try:
        previous_letter = self[0]
    except IndexError:
        return
    current_run_length = 0
    for i in self:
        if i == previous_letter:
            current_run_length += 1
        else:
            yield previous_letter , current_run_length
            current_run_length = 1
            previous_letter = i
    yield previous_letter , current_run_length

timeit('for i in runs_groupby(words.FibonacciWord()[:1000]):\n    print i')

timeit('for i in runs_homemade(words.FibonacciWord()[:1000]):\n    print i')

```

The first takes 28.6 ms per loop whereas the second takes 18.2 ms per loop. The problem is that the first method, though more low-level, is like passing twice on the word, which seems to be slower than the second (high-level) one-pass method.

Ciao,
Thierry



---

archive/issue_comments_090500.json:
```json
{
    "body": "**Author:** Thierry Monteil",
    "created_at": "2010-12-29T16:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90500",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Author:** Thierry Monteil



---

archive/issue_comments_090501.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -3,6 +3,9 @@\n 1. sturmian_desubstitute_as_possible\n 2. is_sturmian_factor\n 3. is_tangent\n+\n+Add a protecting `is_tangent` method to `sage/combinat/words/paths.py`.\n+\n \n ```\n sage: w = Word('01110110110111011101',alphabet='01')\n``````\n",
    "created_at": "2010-12-29T16:56:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90501",
    "user": "https://github.com/sagetrac-tmonteil"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -3,6 +3,9 @@
 1. sturmian_desubstitute_as_possible
 2. is_sturmian_factor
 3. is_tangent
+
+Add a protecting `is_tangent` method to `sage/combinat/words/paths.py`.
+
 
 ```
 sage: w = Word('01110110110111011101',alphabet='01')
``````




---

archive/issue_events_073947.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2010-12-29T16:56:11Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73947"
}
```



---

archive/issue_events_073948.json:
```json
{
    "actor": "https://github.com/sagetrac-tmonteil",
    "created_at": "2010-12-29T16:56:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73948"
}
```



---

archive/issue_comments_090502.json:
```json
{
    "body": "<a id='comment:14'></a>\nPlease fix the **5 test errors**. Four of them are the same :\n\nAttributeError: 'WordGenerator' object has no attribute 'KolakoskiWord'\n\nSee the report of the patchbot.",
    "created_at": "2011-01-27T12:13:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90502",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:14'></a>
Please fix the **5 test errors**. Four of them are the same :

AttributeError: 'WordGenerator' object has no attribute 'KolakoskiWord'

See the report of the patchbot.



---

archive/issue_comments_090503.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,3 +13,4 @@\n True\n ```\n \n+Depends on #8739.\n``````\n",
    "created_at": "2011-01-27T16:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90503",
    "user": "https://github.com/sagetrac-abmasse"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,3 +13,4 @@
 True
 ```
 
+Depends on #8739.
``````




---

archive/issue_comments_090504.json:
```json
{
    "body": "<a id='comment:16'></a>\nSalut Thierry,\n\n1.\n\n> Since the `is_tangent()` method can now be applied to a word with more than 2 letters, i added a protection in the `FiniteWordPath_all` class into the file `paths.py` so that `is_tangent()` could not be applied for such word paths. Indeed, there is an extended definition for them, which is not yet written (see the paper).\n\nWhy? Can you explain more? I don't think the protection is needed.\n\n2. \n\nThe patch is having the following lines::\n\n```\nw_isolated = W(l_isolated,datatype='letter') #the word associated to the isolated letter\nw_running = W(l_running,datatype='letter') #the word associated to the running letter\n```\n\nI remember I suggested you to use datatype = 'letter'. But I realized today that this was supported only for the old sage words objects saved in the pickle jar. So, by introducing it now in this patch, we would have to keep it. So we need to make a decision if we keep it or not. If we don't keep it, you can do the following instead:\n\n```\nw_isolated = W([l_isolated]) #the word associated to the isolated letter\nw_running = W([l_running]) #the word associated to the running letter\n```\n\n3. I think we should redefine the function alphabet for finite words and return the letter occuring in the word and caching the result (I can post a patch for this). And so, the function `is_tangent` could look if this method return a two letter alphabet when the parent don't.",
    "created_at": "2011-01-28T15:00:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90504",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:16'></a>
Salut Thierry,

1.

> Since the `is_tangent()` method can now be applied to a word with more than 2 letters, i added a protection in the `FiniteWordPath_all` class into the file `paths.py` so that `is_tangent()` could not be applied for such word paths. Indeed, there is an extended definition for them, which is not yet written (see the paper).

Why? Can you explain more? I don't think the protection is needed.

2. 

The patch is having the following lines::

```
w_isolated = W(l_isolated,datatype='letter') #the word associated to the isolated letter
w_running = W(l_running,datatype='letter') #the word associated to the running letter
```

I remember I suggested you to use datatype = 'letter'. But I realized today that this was supported only for the old sage words objects saved in the pickle jar. So, by introducing it now in this patch, we would have to keep it. So we need to make a decision if we keep it or not. If we don't keep it, you can do the following instead:

```
w_isolated = W([l_isolated]) #the word associated to the isolated letter
w_running = W([l_running]) #the word associated to the running letter
```

3. I think we should redefine the function alphabet for finite words and return the letter occuring in the word and caching the result (I can post a patch for this). And so, the function `is_tangent` could look if this method return a two letter alphabet when the parent don't.



---

archive/issue_events_073949.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2011-01-28T15:00:26Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73949"
}
```



---

archive/issue_events_073950.json:
```json
{
    "actor": "https://github.com/seblabbe",
    "created_at": "2011-01-28T15:00:26Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73950"
}
```



---

archive/issue_comments_090505.json:
```json
{
    "body": "<a id='comment:17'></a>\nI get the following error while building the documentation :\n\n```\n/Users/slabbe/Applications/sage-4.6.2/local/lib/python2.6/site-packages/sage/combinat/words/finite_word.\npy:docstring of sage.combinat.words.finite_word.FiniteWord_class.is_sturmian_factor:47: (ERROR/3) Unexpected indentation.                                                                                      \n```",
    "created_at": "2011-03-16T18:55:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90505",
    "user": "https://github.com/seblabbe"
}
```

<a id='comment:17'></a>
I get the following error while building the documentation :

```
/Users/slabbe/Applications/sage-4.6.2/local/lib/python2.6/site-packages/sage/combinat/words/finite_word.
py:docstring of sage.combinat.words.finite_word.FiniteWord_class.is_sturmian_factor:47: (ERROR/3) Unexpected indentation.                                                                                      
```



---

archive/issue_comments_090506.json:
```json
{
    "body": "<a id='comment:18'></a>\nTrying to help the build bot\n\nApply trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch",
    "created_at": "2011-06-12T07:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90506",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:18'></a>
Trying to help the build bot

Apply trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch



---

archive/issue_comments_090507.json:
```json
{
    "body": "<a id='comment:19'></a>\nHello,\n\nSome comments to motivate the author of the patch.\n\n1) The problem with datatype=letter may be fixed by the following. At the begining of the function, create a dictionnary \"word_from_letter\" with keys the two letters and values as words of length 1. It is the best way to do as a call to the parent for the creation of an object is always time consuming. With that done, all tests pass on sage-5.0.beta7.\n\n2) It would be nice to put a \"reverse engineering\" example (random or not) as follows:\n\n```\nsage: s1 = WordMorphism('a->ab,b->b')\nsage: s2 = WordMorphism('a->ba,b->b')\nsage: s3 = WordMorphism('a->a,b->ba')\nsage: s4 = WordMorphism('a->a,b->ab')\nsage: W=Words('ab')\nsage: w=W('ab')\nsage: for i in xrange(8): w = choice([s1,s2,s3,s4])(w)   \nsage: w\nword: aabaaabaabaaabaabaabaaabaabaabaaabaabaaa...\nsage: w.is_sturmian_factor()\nTrue\n```\n\n3) There is still the doctest problem mentionned in comment: 17\n\nIt would be great to have this patch integrated in sage-5.0!",
    "created_at": "2012-03-23T23:38:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90507",
    "user": "https://github.com/videlec"
}
```

<a id='comment:19'></a>
Hello,

Some comments to motivate the author of the patch.

1) The problem with datatype=letter may be fixed by the following. At the begining of the function, create a dictionnary "word_from_letter" with keys the two letters and values as words of length 1. It is the best way to do as a call to the parent for the creation of an object is always time consuming. With that done, all tests pass on sage-5.0.beta7.

2) It would be nice to put a "reverse engineering" example (random or not) as follows:

```
sage: s1 = WordMorphism('a->ab,b->b')
sage: s2 = WordMorphism('a->ba,b->b')
sage: s3 = WordMorphism('a->a,b->ba')
sage: s4 = WordMorphism('a->a,b->ab')
sage: W=Words('ab')
sage: w=W('ab')
sage: for i in xrange(8): w = choice([s1,s2,s3,s4])(w)   
sage: w
word: aabaaabaabaaabaabaabaaabaabaabaaabaabaaa...
sage: w.is_sturmian_factor()
True
```

3) There is still the doctest problem mentionned in comment: 17

It would be great to have this patch integrated in sage-5.0!



---

archive/issue_comments_090508.json:
```json
{
    "body": "<a id='comment:20'></a>\n**ping**\n\nIt would be great to have this patch integrated in sage-5.7!",
    "created_at": "2013-02-15T17:14:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90508",
    "user": "https://github.com/videlec"
}
```

<a id='comment:20'></a>
**ping**

It would be great to have this patch integrated in sage-5.7!



---

archive/issue_events_073951.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-02-15T20:27:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73951"
}
```



---

archive/issue_events_073952.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-02-15T20:27:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73952"
}
```



---

archive/issue_comments_090509.json:
```json
{
    "body": "<a id='comment:21'></a>\nI have made the necessary changes for 1) and 3). \n\nShould I incorporate 2) ?",
    "created_at": "2013-02-15T20:27:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90509",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:21'></a>
I have made the necessary changes for 1) and 3). 

Should I incorporate 2) ?



---

archive/issue_comments_090510.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [@fchapoton](#comment%3A21):\n> I have made the necessary changes for 1) and 3). \n> \n> Should I incorporate 2) ?\n\nI would. You do not like the example ?",
    "created_at": "2013-02-15T21:01:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90510",
    "user": "https://github.com/videlec"
}
```

<a id='comment:22'></a>
Replying to [@fchapoton](#comment%3A21):
> I have made the necessary changes for 1) and 3). 
> 
> Should I incorporate 2) ?

I would. You do not like the example ?



---

archive/issue_comments_090511.json:
```json
{
    "body": "<a id='comment:23'></a>\nHere it is. I had to change the result to\n\n```\nword: abaaabaaabaabaaabaaabaabaaabaabaaabaaaba...\n```\nfor the doctest to pass.\n\nPlease review.",
    "created_at": "2013-02-15T21:11:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90511",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:23'></a>
Here it is. I had to change the result to

```
word: abaaabaaabaabaaabaaabaabaaabaabaaabaaaba...
```
for the doctest to pass.

Please review.



---

archive/issue_comments_090512.json:
```json
{
    "body": "<a id='comment:24'></a>\nSome last docstring comments:\n\n* for expressions that refer to Python variables or reserved names (in particular self) you may use double quotes (at some places it is ok and at some other it is not)\n* line 5179: \"desubstitution consist\" -> \"desubstitution consists\"\n* lines 5190, 5340, 5419: self is **not** a part of the input\n* is_tangent doc: the word tangent, where it is defined, must be bold (put the word between two *). The definition is not very english, I suggest: A binary word is said to be *tangent* if it can appear in infintely many cutting sequences of a smooth curve, where each cutting sequence is observed on a progressively smaller grid.\n\nBest,\nVincent",
    "created_at": "2013-02-15T22:15:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90512",
    "user": "https://github.com/videlec"
}
```

<a id='comment:24'></a>
Some last docstring comments:

* for expressions that refer to Python variables or reserved names (in particular self) you may use double quotes (at some places it is ok and at some other it is not)
* line 5179: "desubstitution consist" -> "desubstitution consists"
* lines 5190, 5340, 5419: self is **not** a part of the input
* is_tangent doc: the word tangent, where it is defined, must be bold (put the word between two *). The definition is not very english, I suggest: A binary word is said to be *tangent* if it can appear in infintely many cutting sequences of a smooth curve, where each cutting sequence is observed on a progressively smaller grid.

Best,
Vincent



---

archive/issue_comments_090513.json:
```json
{
    "body": "<a id='comment:25'></a>\nNew patch, with previous points corrected. Please review.",
    "created_at": "2013-02-18T09:57:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90513",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:25'></a>
New patch, with previous points corrected. Please review.



---

archive/issue_comments_090514.json:
```json
{
    "body": "<a id='comment:26'></a>\nVincent, do you think that this ticket is ready to go ?",
    "created_at": "2013-03-05T19:30:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90514",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:26'></a>
Vincent, do you think that this ticket is ready to go ?



---

archive/issue_events_073953.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2013-03-05T21:57:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73953"
}
```



---

archive/issue_events_073954.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2013-03-05T21:57:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73954"
}
```



---

archive/issue_comments_090515.json:
```json
{
    "body": "**Changing keywords** from \"\" to \"sturmian word, tangent word\".",
    "created_at": "2013-03-05T21:57:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90515",
    "user": "https://github.com/videlec"
}
```

**Changing keywords** from "" to "sturmian word, tangent word".



---

archive/issue_comments_090516.json:
```json
{
    "body": "**Changing author** from \"Thierry Monteil\" to \"Thierry Monteil, Fr\u00e9d\u00e9ric Chapoton\".",
    "created_at": "2013-03-05T21:57:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90516",
    "user": "https://github.com/videlec"
}
```

**Changing author** from "Thierry Monteil" to "Thierry Monteil, Frédéric Chapoton".



---

archive/issue_comments_090517.json:
```json
{
    "body": "**Reviewer:** Vincent Delecroix",
    "created_at": "2013-03-05T21:57:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90517",
    "user": "https://github.com/videlec"
}
```

**Reviewer:** Vincent Delecroix



---

archive/issue_comments_090518.json:
```json
{
    "body": "<a id='comment:27'></a>\nYes it is. Thanks Fr\u00e9d\u00e9ric for the finalization !",
    "created_at": "2013-03-05T21:57:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90518",
    "user": "https://github.com/videlec"
}
```

<a id='comment:27'></a>
Yes it is. Thanks Frédéric for the finalization !



---

archive/issue_comments_090519.json:
```json
{
    "body": "**Changing reviewer** from \"Vincent Delecroix\" to \"Alexandre Blondin Mass\u00e9, S\u00e9bastien Labb\u00e9, Vincent Delecroix\".",
    "created_at": "2013-03-06T05:54:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90519",
    "user": "https://github.com/videlec"
}
```

**Changing reviewer** from "Vincent Delecroix" to "Alexandre Blondin Massé, Sébastien Labbé, Vincent Delecroix".



---

archive/issue_events_073955.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-06T10:31:55Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "milestone_number": null,
    "milestone_title": "sage-5.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73955"
}
```



---

archive/issue_events_073956.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-06T10:31:55Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "milestone_number": null,
    "milestone_title": "sage-5.9",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73956"
}
```



---

archive/issue_comments_090520.json:
```json
{
    "body": "<a id='comment:30'></a>\nPlease clarify which patch(es) must be applied.",
    "created_at": "2013-03-07T08:07:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90520",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Please clarify which patch(es) must be applied.



---

archive/issue_events_073957.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-07T08:07:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73957"
}
```



---

archive/issue_events_073958.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-07T08:07:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73958"
}
```



---

archive/issue_comments_090521.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -6,11 +6,13 @@\n \n Add a protecting `is_tangent` method to `sage/combinat/words/paths.py`.\n \n-\n ```\n sage: w = Word('01110110110111011101',alphabet='01')\n sage: w.is_tangent()                  \n True\n ```\n+Depends on #8739.\n \n-Depends on #8739.\n+Apply:\n+* [attachment:trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch) \n+* [attachment:trac_9777-sturm-review-fc.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9777-sturm-review-fc.patch)\n``````\n",
    "created_at": "2013-03-07T08:52:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90521",
    "user": "https://github.com/fchapoton"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -6,11 +6,13 @@
 
 Add a protecting `is_tangent` method to `sage/combinat/words/paths.py`.
 
-
 ```
 sage: w = Word('01110110110111011101',alphabet='01')
 sage: w.is_tangent()                  
 True
 ```
+Depends on #8739.
 
-Depends on #8739.
+Apply:
+* [attachment:trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9877_words_sturmian_desubstitution_attempt_2-tm.patch) 
+* [attachment:trac_9777-sturm-review-fc.patch](https://github.com/sagemath/sage/files/ticket9877/trac_9777-sturm-review-fc.patch)
``````




---

archive/issue_events_073959.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-03-07T08:52:02Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "008080",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73959"
}
```



---

archive/issue_events_073960.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-03-07T08:52:02Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73960"
}
```



---

archive/issue_events_073961.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-03-07T08:52:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73961"
}
```



---

archive/issue_events_073962.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-03-07T08:52:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73962"
}
```



---

archive/issue_events_073963.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-13T14:13:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73963"
}
```



---

archive/issue_events_073964.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-13T14:13:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73964"
}
```



---

archive/issue_comments_090522.json:
```json
{
    "body": "<a id='comment:33'></a>\nThere is a problem building the documentation:\n\n```\n[combinat ] /release/merger/sage-5.9.beta0/local/lib/python2.7/site-packages/sage/combinat/words/finite_word.py:docstring of sage.combinat.words.finite_word:47: WARNING: Enumerated list ends without a blank line; unexpected unindent.\n```",
    "created_at": "2013-03-13T14:13:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90522",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:33'></a>
There is a problem building the documentation:

```
[combinat ] /release/merger/sage-5.9.beta0/local/lib/python2.7/site-packages/sage/combinat/words/finite_word.py:docstring of sage.combinat.words.finite_word:47: WARNING: Enumerated list ends without a blank line; unexpected unindent.
```



---

archive/issue_comments_090523.json:
```json
{
    "body": "<a id='comment:34'></a>\n**Attachment:** [trac_9777-sturm-review-fc.patch.gz](https://github.com/sagemath/sage/files/ticket9877/trac_9777-sturm-review-fc.patch.gz)\n\nI have corrected the doc, back to positive review",
    "created_at": "2013-03-13T15:35:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90523",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:34'></a>
**Attachment:** [trac_9777-sturm-review-fc.patch.gz](https://github.com/sagemath/sage/files/ticket9877/trac_9777-sturm-review-fc.patch.gz)

I have corrected the doc, back to positive review



---

archive/issue_events_073965.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-03-13T15:35:22Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73965"
}
```



---

archive/issue_events_073966.json:
```json
{
    "actor": "https://github.com/fchapoton",
    "created_at": "2013-03-13T15:35:22Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73966"
}
```



---

archive/issue_events_073967.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-20T14:43:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73967"
}
```



---

archive/issue_events_073968.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-20T14:43:23Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9877#event-73968"
}
```



---

archive/issue_comments_090524.json:
```json
{
    "body": "**Merged:** sage-5.9.beta1",
    "created_at": "2013-03-20T14:43:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9877",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9877#issuecomment-90524",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.9.beta1
