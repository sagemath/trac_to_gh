# Issue 9769: symbolic function do not work with numpy.int64 arguments

archive/issues_009768.json:
```json
{
    "body": "There seems to be some problems with the coercion of some datatypes to the symbolic ring:\n\n\n```\nsage: cos(MatrixSpace(ZZ, 2)([1, 2, -4, 7]))\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n.......\nTypeError: cannot coerce arguments: no canonical coercion from Full MatrixSpace of 2 by 2 dense matrices over Integer Ring to Symbolic Ring\n\nsage: import numpy\nsage: vec = numpy.array([1,2])\nsage: sin(vec)\narray([ 0.84147098,  0.90929743])\nsage: sin(vec[0])\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n....\nTypeError: cannot coerce arguments: no canonical coercion from <type 'numpy.int64'> to Symbolic Ring\n\n\nAssignee: @burcin\n\nReviewer: Jeroen Demeyer\n\nResolution: duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/9769\n\n",
    "closed_at": "2015-04-23T14:51:46Z",
    "created_at": "2010-08-19T23:47:28Z",
    "labels": [
        "component: symbolics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-duplicate/invalid/wontfix",
    "title": "symbolic function do not work with numpy.int64 arguments",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9769",
    "user": "https://trac.sagemath.org/admin/accounts/users/maldun"
}
```
There seems to be some problems with the coercion of some datatypes to the symbolic ring:


```
sage: cos(MatrixSpace(ZZ, 2)([1, 2, -4, 7]))
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
.......
TypeError: cannot coerce arguments: no canonical coercion from Full MatrixSpace of 2 by 2 dense matrices over Integer Ring to Symbolic Ring

sage: import numpy
sage: vec = numpy.array([1,2])
sage: sin(vec)
array([ 0.84147098,  0.90929743])
sage: sin(vec[0])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
....
TypeError: cannot coerce arguments: no canonical coercion from <type 'numpy.int64'> to Symbolic Ring


Assignee: @burcin

Reviewer: Jeroen Demeyer

Resolution: duplicate

Issue created by migration from https://trac.sagemath.org/ticket/9769





---

archive/issue_comments_099791.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,8 +1,9 @@\n There seems to be some problems with the coercion of some datatypes to the symbolic ring:\n \n+\n+\\`\\`\\`\n sage: cos(MatrixSpace(ZZ, 2)([1, 2, -4, 7]))\n-\n----\n+---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n .......\n TypeError: cannot coerce arguments: no canonical coercion from Full MatrixSpace of 2 by 2 dense matrices over Integer Ring to Symbolic Ring\n@@ -12,27 +13,26 @@\n sage: sin(vec)\n array([ 0.84147098,  0.90929743])\n sage: sin(vec[0])\n-\n----\n+---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n ....\n TypeError: cannot coerce arguments: no canonical coercion from <type 'numpy.int64'> to Symbolic Ring\n-\n----\n+----\n \n sage: x = PolynomialRing(QQ, 'x').gen()\n sage: sin(x)\n sin(x)\n sage: x = PolynomialRing(RR, 'x').gen()\n sage: sin(x)\n-\n----\n+---------------------------------------------------------------------------\n TypeError                                 Traceback (most recent call last)\n .....\n TypeError: cannot coerce arguments: __call__() takes exactly 1 positional argument (0 given)\n sage: x = PolynomialRing(CC, 'x').gen()\n sage: sin(x)\n sin(x)\n+\\`\\`\\`\n+\n \n Comment: 1\n \n```\n",
    "created_at": "2010-08-19T23:51:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99791",
    "user": "https://trac.sagemath.org/admin/accounts/users/maldun"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,8 +1,9 @@
 There seems to be some problems with the coercion of some datatypes to the symbolic ring:
 
+
+\`\`\`
 sage: cos(MatrixSpace(ZZ, 2)([1, 2, -4, 7]))
-
----
+---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
 .......
 TypeError: cannot coerce arguments: no canonical coercion from Full MatrixSpace of 2 by 2 dense matrices over Integer Ring to Symbolic Ring
@@ -12,27 +13,26 @@
 sage: sin(vec)
 array([ 0.84147098,  0.90929743])
 sage: sin(vec[0])
-
----
+---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
 ....
 TypeError: cannot coerce arguments: no canonical coercion from <type 'numpy.int64'> to Symbolic Ring
-
----
+----
 
 sage: x = PolynomialRing(QQ, 'x').gen()
 sage: sin(x)
 sin(x)
 sage: x = PolynomialRing(RR, 'x').gen()
 sage: sin(x)
-
----
+---------------------------------------------------------------------------
 TypeError                                 Traceback (most recent call last)
 .....
 TypeError: cannot coerce arguments: __call__() takes exactly 1 positional argument (0 given)
 sage: x = PolynomialRing(CC, 'x').gen()
 sage: sin(x)
 sin(x)
+\`\`\`
+
 
 Comment: 1
 
```




---

archive/issue_comments_099792.json:
```json
{
    "body": "<a id='comment:2'></a>Note that there is no coercion when you call\n\n```\nsage: import numpy\nsage: vec = numpy.array([1,2])\nsage: sin(vec)\narray([ 0.84147098,  0.90929743])\n```\n\nThe `__call__()` function for `sin` checks if the argument is a numpy array and calls the right numpy function on this input. See line 349 of `sage/symbolic/function.pyx`. We can handle other numpy types there.\n\nWe cannot work with matrices as numeric objects in symbolics. I suppose you expect the sin() function to be applied to each entry of the matrix. The `apply_map()` method should be used for this purpose:\n\n```\nsage: t = Matrix(ZZ, 2,2)\nsage: t.randomize()\nsage: t.apply_map(lambda x: sin(x))\n[      0 -sin(1)]\n[ sin(4)       0]\n```\n\n---\n\n```\nsage: x = PolynomialRing(RR, 'x').gen()\nsage: sin(x)\n<boom>\n```\n\nThe problem here is really coercion, but it should be copied to another ticket (in the basic_arithmetic component):\n\nThe `__call__()` function of RR[x] doesn't conform to the generic definition. You should be able to give the parameters as a keyword argument as well. This should be made to work:\n\n```\nsage: R.<x> = RR[]\nsage: (x^2+1)(x=5)\n11\n```",
    "created_at": "2011-05-10T17:58:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99792",
    "user": "https://github.com/burcin"
}
```

<a id='comment:2'></a>Note that there is no coercion when you call

```
sage: import numpy
sage: vec = numpy.array([1,2])
sage: sin(vec)
array([ 0.84147098,  0.90929743])
```

The `__call__()` function for `sin` checks if the argument is a numpy array and calls the right numpy function on this input. See line 349 of `sage/symbolic/function.pyx`. We can handle other numpy types there.

We cannot work with matrices as numeric objects in symbolics. I suppose you expect the sin() function to be applied to each entry of the matrix. The `apply_map()` method should be used for this purpose:

```
sage: t = Matrix(ZZ, 2,2)
sage: t.randomize()
sage: t.apply_map(lambda x: sin(x))
[      0 -sin(1)]
[ sin(4)       0]
```

---

```
sage: x = PolynomialRing(RR, 'x').gen()
sage: sin(x)
<boom>
```

The problem here is really coercion, but it should be copied to another ticket (in the basic_arithmetic component):

The `__call__()` function of RR[x] doesn't conform to the generic definition. You should be able to give the parameters as a keyword argument as well. This should be made to work:

```
sage: R.<x> = RR[]
sage: (x^2+1)(x=5)
11
```



---

archive/issue_events_024476.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2011-05-10T17:58:29Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24476"
}
```



---

archive/issue_events_024477.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-4.7.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24477"
}
```



---

archive/issue_events_024478.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24478"
}
```



---

archive/issue_events_024479.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24479"
}
```



---

archive/issue_events_024480.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24480"
}
```



---

archive/issue_comments_099793.json:
```json
{
    "body": "<a id='comment:5'></a>Replying to [comment:2 burcin]:\n> {{{\n> sage: x = PolynomialRing(RR, 'x').gen()\n> sage: sin(x)\n> <boom>\n> }}}\n> \n> The problem here is really coercion, but it should be copied to another ticket (in the basic_arithmetic component):\n\nIncidentally the same with power series is part of #16197.\n\n> The `__call__()` function of RR[x] doesn't conform to the generic definition. You should be able to give the parameters as a keyword argument as well. This should be made to work:\n> \n> \n> ```\n> sage: R.<x> = RR[]\n> sage: (x^2+1)(x=5)\n> 11\n> ```\n\n\nEdit: confused poly with series, sorry",
    "created_at": "2014-04-22T16:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99793",
    "user": "https://github.com/rwst"
}
```

<a id='comment:5'></a>Replying to [comment:2 burcin]:
> {{{
> sage: x = PolynomialRing(RR, 'x').gen()
> sage: sin(x)
> <boom>
> }}}
> 
> The problem here is really coercion, but it should be copied to another ticket (in the basic_arithmetic component):

Incidentally the same with power series is part of #16197.

> The `__call__()` function of RR[x] doesn't conform to the generic definition. You should be able to give the parameters as a keyword argument as well. This should be made to work:
> 
> 
> ```
> sage: R.<x> = RR[]
> sage: (x^2+1)(x=5)
> 11
> ```


Edit: confused poly with series, sorry



---

archive/issue_comments_099794.json:
```json
{
    "body": "Description changed:\n```diff\n--- \n+++ \n@@ -1,3 +1,22 @@\n+There seems to be some problems with the coercion of some datatypes to the symbolic ring:\n+\n+\n+\\`\\`\\`\n+sage: cos(MatrixSpace(ZZ, 2)([1, 2, -4, 7]))\n+---------------------------------------------------------------------------\n+TypeError                                 Traceback (most recent call last)\n+.......\n+TypeError: cannot coerce arguments: no canonical coercion from Full MatrixSpace of 2 by 2 dense matrices over Integer Ring to Symbolic Ring\n+\n+sage: import numpy\n+sage: vec = numpy.array([1,2])\n+sage: sin(vec)\n+array([ 0.84147098,  0.90929743])\n+sage: sin(vec[0])\n+---------------------------------------------------------------------------\n+TypeError                                 Traceback (most recent call last)\n+....\n+TypeError: cannot coerce arguments: no canonical coercion from <type 'numpy.int64'> to Symbolic Ring\n \n \n Comment: 1\n```\n",
    "created_at": "2014-04-22T16:47:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99794",
    "user": "https://github.com/rwst"
}
```

Description changed:
```diff
--- 
+++ 
@@ -1,3 +1,22 @@
+There seems to be some problems with the coercion of some datatypes to the symbolic ring:
+
+
+\`\`\`
+sage: cos(MatrixSpace(ZZ, 2)([1, 2, -4, 7]))
+---------------------------------------------------------------------------
+TypeError                                 Traceback (most recent call last)
+.......
+TypeError: cannot coerce arguments: no canonical coercion from Full MatrixSpace of 2 by 2 dense matrices over Integer Ring to Symbolic Ring
+
+sage: import numpy
+sage: vec = numpy.array([1,2])
+sage: sin(vec)
+array([ 0.84147098,  0.90929743])
+sage: sin(vec[0])
+---------------------------------------------------------------------------
+TypeError                                 Traceback (most recent call last)
+....
+TypeError: cannot coerce arguments: no canonical coercion from <type 'numpy.int64'> to Symbolic Ring
 
 
 Comment: 1
```




---

archive/issue_events_024481.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24481"
}
```



---

archive/issue_events_024482.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24482"
}
```



---

archive/issue_events_024483.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24483"
}
```



---

archive/issue_events_024484.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24484"
}
```



---

archive/issue_comments_099795.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [comment:2 burcin]:\n> The `__call__()` function of RR[x] doesn't conform to the generic definition. You should be able to give the parameters as a keyword argument as well. This should be made to work:\n> \n> \n> ```\n> sage: R.<x> = RR[]\n> sage: (x^2+1)(x=5)\n> 11\n> ```\n\nThis is now #17311",
    "created_at": "2014-11-10T10:01:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99795",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>Replying to [comment:2 burcin]:
> The `__call__()` function of RR[x] doesn't conform to the generic definition. You should be able to give the parameters as a keyword argument as well. This should be made to work:
> 
> 
> ```
> sage: R.<x> = RR[]
> sage: (x^2+1)(x=5)
> 11
> ```

This is now #17311



---

archive/issue_comments_099796.json:
```json
{
    "body": "<a id='comment:9'></a>Hello,\n\nI propose to close this ticket as duplicate because of #18076. With the branch applied\n\n```\nsage: import numpy\nsage: cos(numpy.int32('12'))\ncos(12)\nsage: cos(numpy.float32('1.1'))\n0.453596100177538\n```",
    "created_at": "2015-03-28T12:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99796",
    "user": "https://github.com/videlec"
}
```

<a id='comment:9'></a>Hello,

I propose to close this ticket as duplicate because of #18076. With the branch applied

```
sage: import numpy
sage: cos(numpy.int32('12'))
cos(12)
sage: cos(numpy.float32('1.1'))
0.453596100177538
```



---

archive/issue_events_024485.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-03-28T12:03:51Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24485"
}
```



---

archive/issue_events_024486.json:
```json
{
    "actor": "https://github.com/videlec",
    "created_at": "2015-03-28T12:03:51Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24486"
}
```



---

archive/issue_comments_099797.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2015-03-28T12:03:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99797",
    "user": "https://github.com/videlec"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_099798.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2015-04-23T10:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99798",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_024487.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-04-23T14:51:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9769#event-24487"
}
```



---

archive/issue_comments_099799.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2015-04-23T14:51:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9769",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9769#issuecomment-99799",
    "user": "https://github.com/vbraun"
}
```

Resolution: duplicate
