# Issue 9906: Move the RPy package outside of the R package

archive/issues_009905.json:
```json
{
    "body": "We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.\n\nThe necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out. Apply the following patch **to the Sage root repository** to activate them:\n\n [attachment:trac_9906-Activate_separate_RPy_spkg.root-repo.patch]\n\n---\n\n**spkg**:\n1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg) (diff: [attachment:r-2.14.0.p5.diff])\n2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg) (diff: [attachment:rpy2-2.0.8.p0.diff])\n\n---\n\nRelated: #3086 (closed as duplicate).  See also #9668 and #9847 for what could or should be addressed, too.  Previous R upgrade: #12057.\n\nAssignee: @nexttime\n\nCC:  @nexttime @kcrisman @vbraun @kini\n\nKeywords: r-project spkg\n\nReviewer: Karl-Dieter Crisman, John Palmieri\n\nAuthor: Leif Leonhardy, Jeroen Demeyer\n\nMerged: sage-5.4.beta1\n\nDependencies: #13428, #13395\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/9906\n\n",
    "closed_at": "2012-09-06T05:23:52Z",
    "created_at": "2010-09-13T23:08:55Z",
    "labels": [
        "component: packages: standard",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.4",
    "title": "Move the RPy package outside of the R package",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9906",
    "user": "https://github.com/qed777"
}
```
We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.

The necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out. Apply the following patch **to the Sage root repository** to activate them:

 [attachment:trac_9906-Activate_separate_RPy_spkg.root-repo.patch]

---

**spkg**:
1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg) (diff: [attachment:r-2.14.0.p5.diff])
2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg) (diff: [attachment:rpy2-2.0.8.p0.diff])

---

Related: #3086 (closed as duplicate).  See also #9668 and #9847 for what could or should be addressed, too.  Previous R upgrade: #12057.

Assignee: @nexttime

CC:  @nexttime @kcrisman @vbraun @kini

Keywords: r-project spkg

Reviewer: Karl-Dieter Crisman, John Palmieri

Author: Leif Leonhardy, Jeroen Demeyer

Merged: sage-5.4.beta1

Dependencies: #13428, #13395

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/9906





---

archive/issue_comments_124180.json:
```json
{
    "body": "<a id='comment:1'></a>\nIt would also allow independent updates and potentially improve compression.",
    "created_at": "2010-09-14T07:05:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124180",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:1'></a>
It would also allow independent updates and potentially improve compression.



---

archive/issue_comments_124181.json:
```json
{
    "body": "<a id='comment:2'></a>\nWhen touching the R package, one should also consider #9847 (i.e. R environment variables potentially disturbing the build).",
    "created_at": "2010-09-20T22:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124181",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>
When touching the R package, one should also consider #9847 (i.e. R environment variables potentially disturbing the build).



---

archive/issue_events_030216.json:
```json
{
    "event": "labeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9906#event-30216"
}
```



---

archive/issue_comments_124182.json:
```json
{
    "body": "<a id='comment:3'></a>\nSee [comment:ticket:9896:95 this comment] for another important reason.",
    "created_at": "2010-09-25T18:04:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124182",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:3'></a>
See [comment:ticket:9896:95 this comment] for another important reason.



---

archive/issue_comments_124183.json:
```json
{
    "body": "<a id='comment:4'></a>\n(Having Rpy in R's spkg is the culprit of [comment:ticket:8306:29 this build error].)",
    "created_at": "2010-09-25T18:10:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124183",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>
(Having Rpy in R's spkg is the culprit of [comment:ticket:8306:29 this build error].)



---

archive/issue_comments_124184.json:
```json
{
    "body": "<a id='comment:5'></a>\nI've created a separate RPy 2.0.8.p1 spkg and an R 2.10.1.p5 (follow-up of p4 at #10016) spkg with the RPy spkg removed; both coming soon... (including updated `deps` and `spkg/install`)\n\nI also cleaned up both packages a little, and tried to address #9847, too.",
    "created_at": "2010-09-26T04:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124184",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>
I've created a separate RPy 2.0.8.p1 spkg and an R 2.10.1.p5 (follow-up of p4 at #10016) spkg with the RPy spkg removed; both coming soon... (including updated `deps` and `spkg/install`)

I also cleaned up both packages a little, and tried to address #9847, too.



---

archive/issue_comments_124185.json:
```json
{
    "body": "Changing assignee from tbd to @nexttime.",
    "created_at": "2010-09-26T04:07:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124185",
    "user": "https://github.com/nexttime"
}
```

Changing assignee from tbd to @nexttime.



---

archive/issue_comments_124186.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [leif](#comment%3A5):\n> I've created a separate RPy 2.0.8.p1 spkg and an R 2.10.1.p5 (follow-up of p4 at #10016) spkg with the RPy spkg removed; both coming soon... \n\n\nHow soon is soon? \n\nIf you can make these available, it will help those that want to update the source code. \n\nDave",
    "created_at": "2010-10-01T13:43:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124186",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:6'></a>
Replying to [leif](#comment%3A5):
> I've created a separate RPy 2.0.8.p1 spkg and an R 2.10.1.p5 (follow-up of p4 at #10016) spkg with the RPy spkg removed; both coming soon... 


How soon is soon? 

If you can make these available, it will help those that want to update the source code. 

Dave



---

archive/issue_comments_124187.json:
```json
{
    "body": "<a id='comment:7'></a>\nPersonal note:\n\n* Add patching `libR.pc` to `spkg-install`, making `rhome` and `rincludedir` relative to `$SAGE_ROOT`. (Currently no `prefix=...` definition.)",
    "created_at": "2010-11-03T01:41:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124187",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
Personal note:

* Add patching `libR.pc` to `spkg-install`, making `rhome` and `rincludedir` relative to `$SAGE_ROOT`. (Currently no `prefix=...` definition.)



---

archive/issue_comments_124188.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,6 @@\n We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.\n \n-Related: #3086.\n+Related: #3086 (closed as duplicate).\n+\n+See also #8274 for what could or should be addressed, too.\n+\n``````\n",
    "created_at": "2011-04-20T00:29:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124188",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,6 @@
 We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.
 
-Related: #3086.
+Related: #3086 (closed as duplicate).
+
+See also #8274 for what could or should be addressed, too.
+
``````




---

archive/issue_events_030217.json:
```json
{
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9906#event-30217"
}
```



---

archive/issue_comments_124189.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,12 @@\n We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.\n+\n+(The necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out.)\n+\n+---\n \n Related: #3086 (closed as duplicate).\n \n-See also #8274 for what could or should be addressed, too.\n+See also #8274 and #9668 for what could or should be addressed, too.\n \n+Other related (R) tickets: #9847 (see comments below)\n+\n``````\n",
    "created_at": "2011-08-03T14:41:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124189",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,12 @@
 We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.
+
+(The necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out.)
+
+---
 
 Related: #3086 (closed as duplicate).
 
-See also #8274 for what could or should be addressed, too.
+See also #8274 and #9668 for what could or should be addressed, too.
 
+Other related (R) tickets: #9847 (see comments below)
+
``````




---

archive/issue_comments_124190.json:
```json
{
    "body": "<a id='comment:11'></a>\nSo... does this activity mean you will be posting something on e.g. spkg-upload? \n\n:)",
    "created_at": "2011-08-03T15:06:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124190",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>
So... does this activity mean you will be posting something on e.g. spkg-upload? 

:)



---

archive/issue_comments_124191.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-08-05T10:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124191",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_124192.json:
```json
{
    "body": "Changing author from \"\" to \"Leif Leonhardy\"",
    "created_at": "2011-08-05T10:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124192",
    "user": "https://github.com/nexttime"
}
```

Changing author from "" to "Leif Leonhardy"



---

archive/issue_comments_124193.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,44 @@\n We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.\n \n-(The necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out.)\n+The necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out. Apply the following patch **to the Sage root repository** to activate them:\n+\n+ [attachment:trac_9906-Activate_separate_RPy_spkg.root-repo.patch]\n+\n+---\n+\n+**New R spkg: http://spkg-upload.googlecode.com/files/r-2.10.1.p5.spkg**\n+\n+**md5sum:** `5c47527326872143563b31317e2d044c  r-2.10.1.p5.spkg`\n+\n+### r-2.10.1.p5 (Leif Leonhardy, September 26th 2010)\n+* #9906: Move the RPy spkg out of R's.\n+* Unset R_PROFILE in both spkg-install and spkg-check since this caused\n+  trouble when pointing to system-wide / site-specific installations\n+  (cf. #9847).\n+* Clean up spkg-install and spkg-check.\n+* Only delete old installations if the build succeeded.\n+* Disable parallel make install properly.\n+* Use $MAKE in spkg-check.\n+* Use CFLAG64 if defined rather than hardcoded -m64.\n+* Don't override user-specified flags unless necessary.\n+* Disable optimization if SAGE_DEBUG=yes, add debug symbols by default.\n+* Also respect SAGE_FAT_BINARY in second attempt to configure.\n+* Add more error checks.\n+* Add further dependencies, \"Patches\" section in SPKG.txt.\n+* Remove some garbage from src/ (see Special Update/Build Instructions).\n+\n+\n+**New Rpy spkg: http://spkg-upload.googlecode.com/files/rpy2-2.0.8.p1.spkg**\n+\n+**md5sum:** `e171d3641feaf1d3993c0a972675e1f7  rpy2-2.0.8.p1.spkg`\n+\n+### rpy2-2.0.8.p1 (Leif Leonhardy, September 26th 2010)\n+* #9906: Moved the spkg out of R's. Since setup.py is patched, the\n+  previous version in Sage should have been 2.0.8.p0.\n+* Added usual sanity check to spkg-install, changed #!/bin/sh\n+  to #!/usr/bin/env bash.\n+* Renamed patches/setup.patch to patches/setup.py.patch.\n+* Updated SPKG.txt, added dependencies.\n \n ---\n \n@@ -8,5 +46,5 @@\n \n See also #8274 and #9668 for what could or should be addressed, too.\n \n-Other related (R) tickets: #9847 (see comments below)\n+Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)\n \n``````\n",
    "created_at": "2011-08-05T10:21:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124193",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,44 @@
 We include the RPy spkg in the R spkg and install the former from the latter.  It would be less potentially confusing to move RPy outside of R but make it depend on R and any other prerequisites in `spkg/standard/deps`.
 
-(The necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out.)
+The necessary changes to `spkg/install` and `spkg/standard/deps` are already there, but currently commented out. Apply the following patch **to the Sage root repository** to activate them:
+
+ [attachment:trac_9906-Activate_separate_RPy_spkg.root-repo.patch]
+
+---
+
+**New R spkg: http://spkg-upload.googlecode.com/files/r-2.10.1.p5.spkg**
+
+**md5sum:** `5c47527326872143563b31317e2d044c  r-2.10.1.p5.spkg`
+
+### r-2.10.1.p5 (Leif Leonhardy, September 26th 2010)
+* #9906: Move the RPy spkg out of R's.
+* Unset R_PROFILE in both spkg-install and spkg-check since this caused
+  trouble when pointing to system-wide / site-specific installations
+  (cf. #9847).
+* Clean up spkg-install and spkg-check.
+* Only delete old installations if the build succeeded.
+* Disable parallel make install properly.
+* Use $MAKE in spkg-check.
+* Use CFLAG64 if defined rather than hardcoded -m64.
+* Don't override user-specified flags unless necessary.
+* Disable optimization if SAGE_DEBUG=yes, add debug symbols by default.
+* Also respect SAGE_FAT_BINARY in second attempt to configure.
+* Add more error checks.
+* Add further dependencies, "Patches" section in SPKG.txt.
+* Remove some garbage from src/ (see Special Update/Build Instructions).
+
+
+**New Rpy spkg: http://spkg-upload.googlecode.com/files/rpy2-2.0.8.p1.spkg**
+
+**md5sum:** `e171d3641feaf1d3993c0a972675e1f7  rpy2-2.0.8.p1.spkg`
+
+### rpy2-2.0.8.p1 (Leif Leonhardy, September 26th 2010)
+* #9906: Moved the spkg out of R's. Since setup.py is patched, the
+  previous version in Sage should have been 2.0.8.p0.
+* Added usual sanity check to spkg-install, changed #!/bin/sh
+  to #!/usr/bin/env bash.
+* Renamed patches/setup.patch to patches/setup.py.patch.
+* Updated SPKG.txt, added dependencies.
 
 ---
 
@@ -8,5 +46,5 @@
 
 See also #8274 and #9668 for what could or should be addressed, too.
 
-Other related (R) tickets: #9847 (see comments below)
+Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)
 
``````




---

archive/issue_comments_124194.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [kcrisman](#comment%3A11):\n> So... does this activity mean you will be posting something on e.g. spkg-upload? \n\n\nLooks like. Before the spkgs have their first anniversary...\n\nThere are (still) some things that could be done, e.g. using `patch` and patching the `pkg-config` file (`libR.pc`) from `spkg-install`.\n\nWe could also perhaps either recompress the contained recommended R packages (`.tar.gz`) with `bzip2` or decompress them to plain `tar` files, as we compress the whole spkg with `bzip2` anyway. Haven't yet tried that though.\n\nRPy (and perhaps R) should IMHO be upgraded on a follow-up ticket.",
    "created_at": "2011-08-05T10:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124194",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:13'></a>
Replying to [kcrisman](#comment%3A11):
> So... does this activity mean you will be posting something on e.g. spkg-upload? 


Looks like. Before the spkgs have their first anniversary...

There are (still) some things that could be done, e.g. using `patch` and patching the `pkg-config` file (`libR.pc`) from `spkg-install`.

We could also perhaps either recompress the contained recommended R packages (`.tar.gz`) with `bzip2` or decompress them to plain `tar` files, as we compress the whole spkg with `bzip2` anyway. Haven't yet tried that though.

RPy (and perhaps R) should IMHO be upgraded on a follow-up ticket.



---

archive/issue_comments_124195.json:
```json
{
    "body": "<a id='comment:14'></a>\nI see the hardcoding issues shouldn't be hard to fix; the current (more or less superfluous) patch to `R.sh.in` and the corresponding Python script do only half of the job, namely setting `R_HOME_DIR` to `$SAGE_LOCAL/lib/R/`, but not changing `R_SHARE_DIR`, `R_INCLUDE_DIR` and `R_DOC_DIR`.\n\nBut before I do so, I think the new spkgs should first be tested as they are.\n\nI'll then make a p6, either here or (preferably) on a follow-up ticket if no other issues arise with the p5.",
    "created_at": "2011-08-05T11:24:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124195",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
I see the hardcoding issues shouldn't be hard to fix; the current (more or less superfluous) patch to `R.sh.in` and the corresponding Python script do only half of the job, namely setting `R_HOME_DIR` to `$SAGE_LOCAL/lib/R/`, but not changing `R_SHARE_DIR`, `R_INCLUDE_DIR` and `R_DOC_DIR`.

But before I do so, I think the new spkgs should first be tested as they are.

I'll then make a p6, either here or (preferably) on a follow-up ticket if no other issues arise with the p5.



---

archive/issue_comments_124196.json:
```json
{
    "body": "<a id='comment:15'></a>\nYes, a different ticket would be fine.    I didn't realize these spkgs were actually ready :)\n\nComments/questions:\n* The rpy2 patch looks fine, and those are nice additions (the sanity checks, I mean).  \n* Really excellent work clarifying things on the r patch, adding all those checks etc.  I wouldn't have thought of any of them, but they all make loads of sense, though probably won't affect a million users.  I'm probably the one responsible for the .DS* stuff - I always try to check, but sometimes one forgets.\n* Do we need to unset `R_PROFILE` completely, or can we save that in a temp variable, unset it, then reset it after the spkg installs?  (If not because it would mess up RPy, we would have to do that there too.)\n* Do we need an 'echo' regarding the comment about the `$MAKE check` so that if it does fail, people know what to do?\n* What happened to Dave's favorite `\"x$SAGE64\" = xyes` (you removed the 'x's)?\n* Any reason to include the old RPy installation in the `if false` block?  Presumably if one really wanted to, the HG is there - I can't imagine this being very interesting to anyone.\n\nNote I have not actually installed or tested this yet :)",
    "created_at": "2011-08-05T17:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124196",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>
Yes, a different ticket would be fine.    I didn't realize these spkgs were actually ready :)

Comments/questions:
* The rpy2 patch looks fine, and those are nice additions (the sanity checks, I mean).  
* Really excellent work clarifying things on the r patch, adding all those checks etc.  I wouldn't have thought of any of them, but they all make loads of sense, though probably won't affect a million users.  I'm probably the one responsible for the .DS* stuff - I always try to check, but sometimes one forgets.
* Do we need to unset `R_PROFILE` completely, or can we save that in a temp variable, unset it, then reset it after the spkg installs?  (If not because it would mess up RPy, we would have to do that there too.)
* Do we need an 'echo' regarding the comment about the `$MAKE check` so that if it does fail, people know what to do?
* What happened to Dave's favorite `"x$SAGE64" = xyes` (you removed the 'x's)?
* Any reason to include the old RPy installation in the `if false` block?  Presumably if one really wanted to, the HG is there - I can't imagine this being very interesting to anyone.

Note I have not actually installed or tested this yet :)



---

archive/issue_comments_124197.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Karl-Dieter Crisman\"",
    "created_at": "2011-08-05T17:54:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124197",
    "user": "https://github.com/kcrisman"
}
```

Changing reviewer from "" to "Karl-Dieter Crisman"



---

archive/issue_comments_124198.json:
```json
{
    "body": "<a id='comment:16'></a>\n*Sorry for the delay, no trac notifications...* >B-|\n\nReplying to [kcrisman](#comment%3A15):\n> Yes, a different ticket would be fine.\n\n\n#9668 if you don't object...\n\n\n\n> I didn't realize these spkgs were actually ready :)\n\n\nI didn't know either. ;-)\n\nMore or less just completed the Changelog entries.\n\n\n\n> Comments/questions: \n\n\n>  * Do we need to unset `R_PROFILE` completely, or can we save that in a temp variable, unset it, then reset it after the spkg installs?  (If not because it would mess up RPy, we would have to do that there too.)\n\n\nIt's not fully clear to me what you mean by that. Unsetting `R_PROFILE` there only lasts until we leave `spkg-install`, i.e., is only effective within `spkg-install` and everything that's called from it. (Same applies to `spkg-check`.)\n\nActually I apparently didn't think of unsetting (or forgot to unset) `R_PROFILE` also in *RPy's* `spkg-install`; I'm not sure if RPy could break otherwise, but doing so shouldn't hurt.\n\nIIRC there were also problems with `R_PROFILE` when *using* Sage's R, which would have to be addressed in e.g. `sage-env` and/or the Sage library, not [necessarily] the spkg itself.\n\n\n\n>  * Do we need an 'echo' regarding the comment about the `$MAKE check` so that if it does fail, people know what to do?\n\n\nWell, I was expecting testing this being part of the review process, so I just added a comment. I can of course also print an appropriate message in case the (parallel) test should fail, but perhaps in the p6 on another ticket. (Automatically rerunning the test suite sequentially would IMHO be a less good idea.)\n\n\n\n>  * What happened to Dave's favorite `\"x$SAGE64\" = xyes` (you removed the 'x's)?\n\n\nI get eye cancer from such, it's worse readable and hence error-prone. If `test \"\" = foo` would evaluate to `true` (on some supported systems) Sage would certainly break in many places, not just because *we* use that all around. *Quoting* is important.\n\n(The broken instance of `test` was btw. a shell built-in version [besides some *really very old* `test` implementations which were less robust w.r.t. invalid expressions], and we explicitly use `bash` anyway. Prepending characters to variable expansions can make sense in different contexts, and is sometimes used to save the quotes, though the latter is also quite ugly. Similar applies to *not* using `-o` and `-a`.)\n\nIf one wanted to go really safe, one would either explicitly use `bash`'s built-in version of `test` (`[This is the Trac macro *\"$SAGE64\" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#\"$SAGE64\" = yes -macro)`), use `case \"$SAGE64\" in yes) ...`, or perhaps\n\n```sh\n[ \"${SAGE64:-no}\" = yes ]\n```\nwhich is the equivalent of Python's\n\n```python\nos.environ.get(\"SAGE64\", \"no\") == \"yes\"\n```\n\n\n\n>  * Any reason to include the old RPy installation in the `if false` block?\n\n\nNot really.\n\n> Presumably if one really wanted to, the HG is there - I can't imagine this being very interesting to anyone.\n\n\nSure, though it is buried by lots of other changes in the same changeset. I intended to remove it later, temporarily kept it just for documentation purposes.\n\n\n\n> Note I have not actually installed or tested this yet :)\n\n\nHope you'll do so later. :)",
    "created_at": "2011-08-07T03:53:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124198",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>
*Sorry for the delay, no trac notifications...* >B-|

Replying to [kcrisman](#comment%3A15):
> Yes, a different ticket would be fine.


#9668 if you don't object...



> I didn't realize these spkgs were actually ready :)


I didn't know either. ;-)

More or less just completed the Changelog entries.



> Comments/questions: 


>  * Do we need to unset `R_PROFILE` completely, or can we save that in a temp variable, unset it, then reset it after the spkg installs?  (If not because it would mess up RPy, we would have to do that there too.)


It's not fully clear to me what you mean by that. Unsetting `R_PROFILE` there only lasts until we leave `spkg-install`, i.e., is only effective within `spkg-install` and everything that's called from it. (Same applies to `spkg-check`.)

Actually I apparently didn't think of unsetting (or forgot to unset) `R_PROFILE` also in *RPy's* `spkg-install`; I'm not sure if RPy could break otherwise, but doing so shouldn't hurt.

IIRC there were also problems with `R_PROFILE` when *using* Sage's R, which would have to be addressed in e.g. `sage-env` and/or the Sage library, not [necessarily] the spkg itself.



>  * Do we need an 'echo' regarding the comment about the `$MAKE check` so that if it does fail, people know what to do?


Well, I was expecting testing this being part of the review process, so I just added a comment. I can of course also print an appropriate message in case the (parallel) test should fail, but perhaps in the p6 on another ticket. (Automatically rerunning the test suite sequentially would IMHO be a less good idea.)



>  * What happened to Dave's favorite `"x$SAGE64" = xyes` (you removed the 'x's)?


I get eye cancer from such, it's worse readable and hence error-prone. If `test "" = foo` would evaluate to `true` (on some supported systems) Sage would certainly break in many places, not just because *we* use that all around. *Quoting* is important.

(The broken instance of `test` was btw. a shell built-in version [besides some *really very old* `test` implementations which were less robust w.r.t. invalid expressions], and we explicitly use `bash` anyway. Prepending characters to variable expansions can make sense in different contexts, and is sometimes used to save the quotes, though the latter is also quite ugly. Similar applies to *not* using `-o` and `-a`.)

If one wanted to go really safe, one would either explicitly use `bash`'s built-in version of `test` (`[This is the Trac macro *"$SAGE64" = yes * that was inherited from the migration](https://trac.sagemath.org/wiki/WikiMacros#"$SAGE64" = yes -macro)`), use `case "$SAGE64" in yes) ...`, or perhaps

```sh
[ "${SAGE64:-no}" = yes ]
```
which is the equivalent of Python's

```python
os.environ.get("SAGE64", "no") == "yes"
```



>  * Any reason to include the old RPy installation in the `if false` block?


Not really.

> Presumably if one really wanted to, the HG is there - I can't imagine this being very interesting to anyone.


Sure, though it is buried by lots of other changes in the same changeset. I intended to remove it later, temporarily kept it just for documentation purposes.



> Note I have not actually installed or tested this yet :)


Hope you'll do so later. :)



---

archive/issue_comments_124199.json:
```json
{
    "body": "<a id='comment:17'></a>\n> > Yes, a different ticket would be fine.\n\n> #9668 if you don't object...\nNo, that is quite natural.\n> >  * Do we need to unset `R_PROFILE` completely, or can we save that in a temp variable, unset it, then reset it after the spkg installs?  (If not because it would mess up RPy, we would have to do that there too.)\n \n> It's not fully clear to me what you mean by that. Unsetting `R_PROFILE` there only lasts until we leave `spkg-install`, i.e., is only effective within `spkg-install` and everything that's called from it. (Same applies to `spkg-check`.)\nI didn't realize that.  \n> Actually I apparently didn't think of unsetting (or forgot to unset) `R_PROFILE` also in *RPy's* `spkg-install`; I'm not sure if RPy could break otherwise, but doing so shouldn't hurt.\n\nSo maybe that's a \"needs work\"?\n> IIRC there were also problems with `R_PROFILE` when *using* Sage's R, which would have to be addressed in e.g. `sage-env` and/or the Sage library, not [necessarily] the spkg itself.\n\nYes, that's a different ticket, and notoriously hard to track down at times.\n> >  * Do we need an 'echo' regarding the comment about the `$MAKE check` so that if it does fail, people know what to do?\n \n> \n> Well, I was expecting testing this being part of the review process, so I just added a comment. I can of course also print an appropriate message in case the (parallel) test should fail, but perhaps in the p6 on another ticket. (Automatically rerunning the test suite sequentially would IMHO be a less good idea.)\n\nOk.\n> >  * Any reason to include the old RPy installation in the `if false` block?\n \n> Not really.\n> > Presumably if one really wanted to, the HG is there - I can't imagine this being very interesting to anyone.\n\n> Sure, though it is buried by lots of other changes in the same changeset. I intended to remove it later, temporarily kept it just for documentation purposes.\nWell, either way that wouldn't hold up this ticket.\n> > Note I have not actually installed or tested this yet :)\n\n> Hope you'll do so later. :)\nBut not today :(",
    "created_at": "2011-08-08T14:11:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124199",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:17'></a>
> > Yes, a different ticket would be fine.

> #9668 if you don't object...
No, that is quite natural.
> >  * Do we need to unset `R_PROFILE` completely, or can we save that in a temp variable, unset it, then reset it after the spkg installs?  (If not because it would mess up RPy, we would have to do that there too.)
 
> It's not fully clear to me what you mean by that. Unsetting `R_PROFILE` there only lasts until we leave `spkg-install`, i.e., is only effective within `spkg-install` and everything that's called from it. (Same applies to `spkg-check`.)
I didn't realize that.  
> Actually I apparently didn't think of unsetting (or forgot to unset) `R_PROFILE` also in *RPy's* `spkg-install`; I'm not sure if RPy could break otherwise, but doing so shouldn't hurt.

So maybe that's a "needs work"?
> IIRC there were also problems with `R_PROFILE` when *using* Sage's R, which would have to be addressed in e.g. `sage-env` and/or the Sage library, not [necessarily] the spkg itself.

Yes, that's a different ticket, and notoriously hard to track down at times.
> >  * Do we need an 'echo' regarding the comment about the `$MAKE check` so that if it does fail, people know what to do?
 
> 
> Well, I was expecting testing this being part of the review process, so I just added a comment. I can of course also print an appropriate message in case the (parallel) test should fail, but perhaps in the p6 on another ticket. (Automatically rerunning the test suite sequentially would IMHO be a less good idea.)

Ok.
> >  * Any reason to include the old RPy installation in the `if false` block?
 
> Not really.
> > Presumably if one really wanted to, the HG is there - I can't imagine this being very interesting to anyone.

> Sure, though it is buried by lots of other changes in the same changeset. I intended to remove it later, temporarily kept it just for documentation purposes.
Well, either way that wouldn't hold up this ticket.
> > Note I have not actually installed or tested this yet :)

> Hope you'll do so later. :)
But not today :(



---

archive/issue_comments_124200.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [kcrisman](#comment%3A17):\n> > > Yes, a different ticket would be fine.\n\n> > #9668 if you don't object...\n> No, that is quite natural.\n\n\nOk.\n\n\n\n\n> > Actually I apparently didn't think of unsetting (or forgot to unset) `R_PROFILE` also in *RPy's* `spkg-install`; I'm not sure if RPy could break otherwise, but doing so shouldn't hurt.\n\n> So maybe that's a \"needs work\"?\n\n`R_PROFILE` doesn't appear in any of RPy's source files, so I don't think so. (I perhaps checked that last year, but forgot about it. :D )",
    "created_at": "2011-08-09T05:46:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124200",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>
Replying to [kcrisman](#comment%3A17):
> > > Yes, a different ticket would be fine.

> > #9668 if you don't object...
> No, that is quite natural.


Ok.




> > Actually I apparently didn't think of unsetting (or forgot to unset) `R_PROFILE` also in *RPy's* `spkg-install`; I'm not sure if RPy could break otherwise, but doing so shouldn't hurt.

> So maybe that's a "needs work"?

`R_PROFILE` doesn't appear in any of RPy's source files, so I don't think so. (I perhaps checked that last year, but forgot about it. :D )



---

archive/issue_comments_124201.json:
```json
{
    "body": "<a id='comment:19'></a>\nJust a note to self/any other reviewer of what would have to be tested.\n* Upgrading rpy2 by itself.\n* Upgrading r by itself.\n* Then upgrading rpy2 after having upgraded r.\n* And test R and rpy2 after each step.\n* Test with and without `R_PROFILE` set.\n* Test with and without `SAGE_CHECK` set.\n* Test with `SAGE_CHECK` yes with and without parallel make.\n* Test on (at least) Linux and Mac.\n* Test with and without spaces in the path.\nRemind me why this is needed again?  :-)",
    "created_at": "2011-08-10T21:16:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124201",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:19'></a>
Just a note to self/any other reviewer of what would have to be tested.
* Upgrading rpy2 by itself.
* Upgrading r by itself.
* Then upgrading rpy2 after having upgraded r.
* And test R and rpy2 after each step.
* Test with and without `R_PROFILE` set.
* Test with and without `SAGE_CHECK` set.
* Test with `SAGE_CHECK` yes with and without parallel make.
* Test on (at least) Linux and Mac.
* Test with and without spaces in the path.
Remind me why this is needed again?  :-)



---

archive/issue_comments_124202.json:
```json
{
    "body": "<a id='comment:20'></a>\nHere is another somewhat related ticket - #10967.   I don't think that is fixed, at least not in the same way, by this p5.",
    "created_at": "2011-08-19T13:48:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124202",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:20'></a>
Here is another somewhat related ticket - #10967.   I don't think that is fixed, at least not in the same way, by this p5.



---

archive/issue_comments_124203.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -44,7 +44,7 @@\n \n Related: #3086 (closed as duplicate).\n \n-See also #8274 and #9668 for what could or should be addressed, too.\n+See also #8274, #9668 and #10967 for what could or should be addressed, too.\n \n Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)\n \n``````\n",
    "created_at": "2011-08-19T14:32:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124203",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -44,7 +44,7 @@
 
 Related: #3086 (closed as duplicate).
 
-See also #8274 and #9668 for what could or should be addressed, too.
+See also #8274, #9668 and #10967 for what could or should be addressed, too.
 
 Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)
 
``````




---

archive/issue_comments_124204.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -44,7 +44,7 @@\n \n Related: #3086 (closed as duplicate).\n \n-See also #8274, #9668 and #10967 for what could or should be addressed, too.\n+See also #8274, #9668 and #10967 for what could or should be addressed, too. #9668 will now function as a follow-up ticket, providing an R 2.10.1.p6 spkg, also fixing #10967.\n \n Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)\n \n``````\n",
    "created_at": "2011-08-21T00:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124204",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -44,7 +44,7 @@
 
 Related: #3086 (closed as duplicate).
 
-See also #8274, #9668 and #10967 for what could or should be addressed, too.
+See also #8274, #9668 and #10967 for what could or should be addressed, too. #9668 will now function as a follow-up ticket, providing an R 2.10.1.p6 spkg, also fixing #10967.
 
 Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)
 
``````




---

archive/issue_comments_124205.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [kcrisman](#comment%3A20):\n> Here is another somewhat related ticket - #10967.   I don't think that is fixed, at least not in the same way, by this p5.\n\n\nFor the record: #10967 will be addressed at #9668, by an R 2.10.1.p6 spkg there, so I've made the former ticket depend on the latter, and changed its milestone to *\"duplicate/invalid/won't fix\"*.",
    "created_at": "2011-08-21T00:57:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124205",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:22'></a>
Replying to [kcrisman](#comment%3A20):
> Here is another somewhat related ticket - #10967.   I don't think that is fixed, at least not in the same way, by this p5.


For the record: #10967 will be addressed at #9668, by an R 2.10.1.p6 spkg there, so I've made the former ticket depend on the latter, and changed its milestone to *"duplicate/invalid/won't fix"*.



---

archive/issue_comments_124206.json:
```json
{
    "body": "<a id='comment:23'></a>\nPing.\n\nI think we should merge this before it further rottens; I'll not be able to finish #9668 in the next days (and right now don't know when I'll do that), but it's not a dependency anyway, just a further improvement...",
    "created_at": "2011-10-09T15:49:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124206",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:23'></a>
Ping.

I think we should merge this before it further rottens; I'll not be able to finish #9668 in the next days (and right now don't know when I'll do that), but it's not a dependency anyway, just a further improvement...



---

archive/issue_comments_124207.json:
```json
{
    "body": "<a id='comment:24'></a>\nSorry, I just won't have time to do that laundry list of testing in the near future.  (As you may have noticed from my relative lack of activity elsewhere.)   And there isn't really anything breaking because of this weirdness, thankfully... My apologies :(",
    "created_at": "2011-10-10T02:13:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124207",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:24'></a>
Sorry, I just won't have time to do that laundry list of testing in the near future.  (As you may have noticed from my relative lack of activity elsewhere.)   And there isn't really anything breaking because of this weirdness, thankfully... My apologies :(



---

archive/issue_comments_124208.json:
```json
{
    "body": "<a id='comment:25'></a>\nWow.  I just upgraded my rpy2 spkg to 2.2.4, and was tempted to work on upgrading R to 2.14.  But then I saw this ticket.  I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above), and it feels like this work should go in before upgrading to 2.14, etc.",
    "created_at": "2011-11-15T05:15:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124208",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:25'></a>
Wow.  I just upgraded my rpy2 spkg to 2.2.4, and was tempted to work on upgrading R to 2.14.  But then I saw this ticket.  I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above), and it feels like this work should go in before upgrading to 2.14, etc.



---

archive/issue_comments_124209.json:
```json
{
    "body": "Changing keywords from \"\" to \"r-project\".",
    "created_at": "2011-11-20T01:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124209",
    "user": "https://github.com/kcrisman"
}
```

Changing keywords from "" to "r-project".



---

archive/issue_comments_124210.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [jason](#comment%3A25):\n> Wow.  I just upgraded my rpy2 spkg to 2.2.4, and was tempted to work on upgrading R to 2.14.  But then I saw this ticket.  I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above), and it feels like this work should go in before upgrading to 2.14, etc.\n\n\nRegarding this, see #12057.",
    "created_at": "2011-11-20T01:18:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124210",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:27'></a>
Replying to [jason](#comment%3A25):
> Wow.  I just upgraded my rpy2 spkg to 2.2.4, and was tempted to work on upgrading R to 2.14.  But then I saw this ticket.  I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above), and it feels like this work should go in before upgrading to 2.14, etc.


Regarding this, see #12057.



---

archive/issue_comments_124211.json:
```json
{
    "body": "Changing work_issues from \"\" to \"Rebase the spkg to #12057\"",
    "created_at": "2011-12-09T10:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124211",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "" to "Rebase the spkg to #12057"



---

archive/issue_comments_124212.json:
```json
{
    "body": "<a id='comment:28'></a>\nReplying to [jason](#comment%3A25):\n> Wow.  I just upgraded my rpy2 spkg to 2.2.4, and was tempted to work on upgrading R to 2.14.  But then I saw this ticket.  I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above), and it feels like this work should go in before upgrading to 2.14, etc.\n\n\nWell, this didn't happen.  R will be upgraded to version 2.14 in #12057 which will normally be merged in sage-4.8.alpha4.  So, this ticket needs to be rebased...",
    "created_at": "2011-12-09T10:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124212",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:28'></a>
Replying to [jason](#comment%3A25):
> Wow.  I just upgraded my rpy2 spkg to 2.2.4, and was tempted to work on upgrading R to 2.14.  But then I saw this ticket.  I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above), and it feels like this work should go in before upgrading to 2.14, etc.


Well, this didn't happen.  R will be upgraded to version 2.14 in #12057 which will normally be merged in sage-4.8.alpha4.  So, this ticket needs to be rebased...



---

archive/issue_comments_124213.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2011-12-09T10:49:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124213",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124214.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -42,9 +42,8 @@\n \n ---\n \n-Related: #3086 (closed as duplicate).\n+Related: #3086, #9847 (both closed as duplicate).\n \n-See also #8274, #9668 and #10967 for what could or should be addressed, too. #9668 will now function as a follow-up ticket, providing an R 2.10.1.p6 spkg, also fixing #10967.\n+See also #9668 for what could or should be addressed, too. #9668 will now function as a follow-up ticket.\n \n-Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)\n-\n+Previous R upgrade: #12057.\n``````\n",
    "created_at": "2011-12-09T10:57:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124214",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -42,9 +42,8 @@
 
 ---
 
-Related: #3086 (closed as duplicate).
+Related: #3086, #9847 (both closed as duplicate).
 
-See also #8274, #9668 and #10967 for what could or should be addressed, too. #9668 will now function as a follow-up ticket, providing an R 2.10.1.p6 spkg, also fixing #10967.
+See also #9668 for what could or should be addressed, too. #9668 will now function as a follow-up ticket.
 
-Other related (R) tickets: #9847 (see comments below; can IMHO be closed as duplicate when this ticket gets merged)
-
+Previous R upgrade: #12057.
``````




---

archive/issue_comments_124215.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [jason](#comment%3A25):\n> I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above)\n\nTesting is easy, I wouldn't mind doing that.",
    "created_at": "2011-12-09T11:03:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124215",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:30'></a>
Replying to [jason](#comment%3A25):
> I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above)

Testing is easy, I wouldn't mind doing that.



---

archive/issue_comments_124216.json:
```json
{
    "body": "<a id='comment:31'></a>\n> > I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above)\n\n> Testing is easy, I wouldn't mind doing that.\nI had the same problem, because it would require a lot of manual stuff, but if you can use the buildbot to test a rebased version of this that would be fantastic.",
    "created_at": "2011-12-09T14:55:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124216",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:31'></a>
> > I don't have time either right now to do the extensive testing this ticket appears to need (according to comments above)

> Testing is easy, I wouldn't mind doing that.
I had the same problem, because it would require a lot of manual stuff, but if you can use the buildbot to test a rebased version of this that would be fantastic.



---

archive/issue_comments_124217.json:
```json
{
    "body": "<a id='comment:32'></a>\nApparently we also should take care of some references to sage-env or something which are soon to disappear - see #11073, in particular [comment:73:ticket:11073 this comment].",
    "created_at": "2012-01-17T14:55:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124217",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:32'></a>
Apparently we also should take care of some references to sage-env or something which are soon to disappear - see #11073, in particular [comment:73:ticket:11073 this comment].



---

archive/issue_comments_124218.json:
```json
{
    "body": "Changing work_issues from \"Rebase the spkg to #12057\" to \"Rebase the spkg to #12172\"",
    "created_at": "2012-03-21T13:10:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124218",
    "user": "https://github.com/nexttime"
}
```

Changing work_issues from "Rebase the spkg to #12057" to "Rebase the spkg to #12172"



---

archive/issue_comments_124219.json:
```json
{
    "body": "<a id='comment:33'></a>\nArgh!",
    "created_at": "2012-03-21T13:10:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124219",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:33'></a>
Argh!



---

archive/issue_comments_124220.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#12172, #10492\"",
    "created_at": "2012-03-21T13:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124220",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "" to "#12172, #10492"



---

archive/issue_comments_124221.json:
```json
{
    "body": "Changing dependencies from \"#12172, #10492\" to \"#12172, #10492, #12787\"",
    "created_at": "2012-03-30T15:42:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124221",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#12172, #10492" to "#12172, #10492, #12787"



---

archive/issue_comments_124222.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,44 +6,10 @@\n \n ---\n \n-**New R spkg: http://spkg-upload.googlecode.com/files/r-2.10.1.p5.spkg**\n-\n-**md5sum:** `5c47527326872143563b31317e2d044c  r-2.10.1.p5.spkg`\n-\n-### r-2.10.1.p5 (Leif Leonhardy, September 26th 2010)\n-* #9906: Move the RPy spkg out of R's.\n-* Unset R_PROFILE in both spkg-install and spkg-check since this caused\n-  trouble when pointing to system-wide / site-specific installations\n-  (cf. #9847).\n-* Clean up spkg-install and spkg-check.\n-* Only delete old installations if the build succeeded.\n-* Disable parallel make install properly.\n-* Use $MAKE in spkg-check.\n-* Use CFLAG64 if defined rather than hardcoded -m64.\n-* Don't override user-specified flags unless necessary.\n-* Disable optimization if SAGE_DEBUG=yes, add debug symbols by default.\n-* Also respect SAGE_FAT_BINARY in second attempt to configure.\n-* Add more error checks.\n-* Add further dependencies, \"Patches\" section in SPKG.txt.\n-* Remove some garbage from src/ (see Special Update/Build Instructions).\n-\n-\n-**New Rpy spkg: http://spkg-upload.googlecode.com/files/rpy2-2.0.8.p1.spkg**\n-\n-**md5sum:** `e171d3641feaf1d3993c0a972675e1f7  rpy2-2.0.8.p1.spkg`\n-\n-### rpy2-2.0.8.p1 (Leif Leonhardy, September 26th 2010)\n-* #9906: Moved the spkg out of R's. Since setup.py is patched, the\n-  previous version in Sage should have been 2.0.8.p0.\n-* Added usual sanity check to spkg-install, changed #!/bin/sh\n-  to #!/usr/bin/env bash.\n-* Renamed patches/setup.patch to patches/setup.py.patch.\n-* Updated SPKG.txt, added dependencies.\n+**spkg**:\n+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg)\n+2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg)\n \n ---\n \n-Related: #3086, #9847 (both closed as duplicate).\n-\n-See also #9668 for what could or should be addressed, too. #9668 will now function as a follow-up ticket.\n-\n-Previous R upgrade: #12057.\n+Related: #3086, #9847 (both closed as duplicate).  See also #9668 for what could or should be addressed, too.  Previous R upgrade: #12057.\n``````\n",
    "created_at": "2012-09-04T10:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124222",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,44 +6,10 @@
 
 ---
 
-**New R spkg: http://spkg-upload.googlecode.com/files/r-2.10.1.p5.spkg**
-
-**md5sum:** `5c47527326872143563b31317e2d044c  r-2.10.1.p5.spkg`
-
-### r-2.10.1.p5 (Leif Leonhardy, September 26th 2010)
-* #9906: Move the RPy spkg out of R's.
-* Unset R_PROFILE in both spkg-install and spkg-check since this caused
-  trouble when pointing to system-wide / site-specific installations
-  (cf. #9847).
-* Clean up spkg-install and spkg-check.
-* Only delete old installations if the build succeeded.
-* Disable parallel make install properly.
-* Use $MAKE in spkg-check.
-* Use CFLAG64 if defined rather than hardcoded -m64.
-* Don't override user-specified flags unless necessary.
-* Disable optimization if SAGE_DEBUG=yes, add debug symbols by default.
-* Also respect SAGE_FAT_BINARY in second attempt to configure.
-* Add more error checks.
-* Add further dependencies, "Patches" section in SPKG.txt.
-* Remove some garbage from src/ (see Special Update/Build Instructions).
-
-
-**New Rpy spkg: http://spkg-upload.googlecode.com/files/rpy2-2.0.8.p1.spkg**
-
-**md5sum:** `e171d3641feaf1d3993c0a972675e1f7  rpy2-2.0.8.p1.spkg`
-
-### rpy2-2.0.8.p1 (Leif Leonhardy, September 26th 2010)
-* #9906: Moved the spkg out of R's. Since setup.py is patched, the
-  previous version in Sage should have been 2.0.8.p0.
-* Added usual sanity check to spkg-install, changed #!/bin/sh
-  to #!/usr/bin/env bash.
-* Renamed patches/setup.patch to patches/setup.py.patch.
-* Updated SPKG.txt, added dependencies.
+**spkg**:
+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg)
+2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg)
 
 ---
 
-Related: #3086, #9847 (both closed as duplicate).
-
-See also #9668 for what could or should be addressed, too. #9668 will now function as a follow-up ticket.
-
-Previous R upgrade: #12057.
+Related: #3086, #9847 (both closed as duplicate).  See also #9668 for what could or should be addressed, too.  Previous R upgrade: #12057.
``````




---

archive/issue_comments_124223.json:
```json
{
    "body": "Changing dependencies from \"#12172, #10492, #12787\" to \"#13428\"",
    "created_at": "2012-09-04T10:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124223",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#12172, #10492, #12787" to "#13428"



---

archive/issue_comments_124224.json:
```json
{
    "body": "Changing work_issues from \"Rebase the spkg to #12172\" to \"\"",
    "created_at": "2012-09-04T10:28:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124224",
    "user": "https://github.com/jdemeyer"
}
```

Changing work_issues from "Rebase the spkg to #12172" to ""



---

archive/issue_comments_124225.json:
```json
{
    "body": "Changing dependencies from \"#13428\" to \"#13428, #13395\"",
    "created_at": "2012-09-04T10:37:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124225",
    "user": "https://github.com/jdemeyer"
}
```

Changing dependencies from "#13428" to "#13428, #13395"



---

archive/issue_comments_124226.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,7 +7,7 @@\n ---\n \n **spkg**:\n-1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg)\n+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg)\n 2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg)\n \n ---\n``````\n",
    "created_at": "2012-09-04T10:43:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124226",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,7 +7,7 @@
 ---
 
 **spkg**:
-1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p4.spkg)
+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg)
 2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg)
 
 ---
``````




---

archive/issue_comments_124227.json:
```json
{
    "body": "Apply to SAGE_ROOT. Activates RPY in spkg/install and spkg/standard/deps",
    "created_at": "2012-09-04T12:04:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124227",
    "user": "https://github.com/jdemeyer"
}
```

Apply to SAGE_ROOT. Activates RPY in spkg/install and spkg/standard/deps



---

archive/issue_comments_124228.json:
```json
{
    "body": "<a id='comment:40'></a>\nAttachment [trac_9906-Activate_separate_RPy_spkg.root-repo.patch](tarball://root/attachments/some-uuid/ticket9906/trac_9906-Activate_separate_RPy_spkg.root-repo.patch) by @jdemeyer created at 2012-09-04 12:06:03\n\nWhy should `R` depend on `PYTHON`?  The old `spkg/standard/deps` claims \"Note that even with a separate RPy spkg (#9906), Sage's R will still depend on \"Python, but I see no reason for this.  So I removed the explicit PYTHON dependency.  But it still indirectly depends on PYTHON via PYTHON->ATLAS->R.",
    "created_at": "2012-09-04T12:06:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124228",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:40'></a>
Attachment [trac_9906-Activate_separate_RPy_spkg.root-repo.patch](tarball://root/attachments/some-uuid/ticket9906/trac_9906-Activate_separate_RPy_spkg.root-repo.patch) by @jdemeyer created at 2012-09-04 12:06:03

Why should `R` depend on `PYTHON`?  The old `spkg/standard/deps` claims "Note that even with a separate RPy spkg (#9906), Sage's R will still depend on "Python, but I see no reason for this.  So I removed the explicit PYTHON dependency.  But it still indirectly depends on PYTHON via PYTHON->ATLAS->R.



---

archive/issue_comments_124229.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,7 +8,7 @@\n \n **spkg**:\n 1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg)\n-2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg)\n+2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg) (taken from the old R spkg)\n \n ---\n \n``````\n",
    "created_at": "2012-09-04T12:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124229",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,7 +8,7 @@
 
 **spkg**:
 1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg)
-2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg)
+2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg) (taken from the old R spkg)
 
 ---
 
``````




---

archive/issue_events_030218.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-04T12:08:16Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "milestone": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9906#event-30218"
}
```



---

archive/issue_comments_124230.json:
```json
{
    "body": "Changing keywords from \"r-project\" to \"r-project spkg\".",
    "created_at": "2012-09-04T12:08:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124230",
    "user": "https://github.com/jdemeyer"
}
```

Changing keywords from "r-project" to "r-project spkg".



---

archive/issue_comments_124231.json:
```json
{
    "body": "Attachment [r-2.14.0.p5.diff](tarball://root/attachments/some-uuid/ticket9906/r-2.14.0.p5.diff) by @jdemeyer created at 2012-09-04 12:09:29\n\nDiff for the R spkg. For reference / review only.",
    "created_at": "2012-09-04T12:09:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124231",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [r-2.14.0.p5.diff](tarball://root/attachments/some-uuid/ticket9906/r-2.14.0.p5.diff) by @jdemeyer created at 2012-09-04 12:09:29

Diff for the R spkg. For reference / review only.



---

archive/issue_comments_124232.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-09-04T13:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124232",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124233.json:
```json
{
    "body": "Changing author from \"Leif Leonhardy\" to \"Leif Leonhardy, Jeroen Demeyer\"",
    "created_at": "2012-09-04T13:36:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124233",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "Leif Leonhardy" to "Leif Leonhardy, Jeroen Demeyer"



---

archive/issue_comments_124234.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,4 +12,4 @@\n \n ---\n \n-Related: #3086, #9847 (both closed as duplicate).  See also #9668 for what could or should be addressed, too.  Previous R upgrade: #12057.\n+Related: #3086 (closed as duplicate).  See also #9668 and #9847 for what could or should be addressed, too.  Previous R upgrade: #12057.\n``````\n",
    "created_at": "2012-09-04T15:31:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124234",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,4 +12,4 @@
 
 ---
 
-Related: #3086, #9847 (both closed as duplicate).  See also #9668 for what could or should be addressed, too.  Previous R upgrade: #12057.
+Related: #3086 (closed as duplicate).  See also #9668 and #9847 for what could or should be addressed, too.  Previous R upgrade: #12057.
``````




---

archive/issue_comments_124235.json:
```json
{
    "body": "<a id='comment:44'></a>\nThere is also some general cleanup that could happen; for example:\n\n```diff\ndiff --git a/spkg-install b/spkg-install\n--- a/spkg-install\n+++ b/spkg-install\n@@ -67,15 +67,6 @@ if [ \"$UNAME\" = \"SunOS\" ]; then\n     SUN_FLAGS=\"--without-ICU\"; export SUN_FLAGS\n fi\n \n-# let's remove old install, even the wrongly installed ones\n-rm -rf \"$SAGE_LOCAL\"/lib/r\n-rm -rf \"$SAGE_LOCAL\"/lib/R\n-rm -rf \"$SAGE_LOCAL\"/lib64/R\n-rm -rf \"$SAGE_LOCAL\"/lib64/r\n-# and let's also nuke some leftovers on SAGE_LOCAL/lib\n-rm -rf \"$SAGE_LOCAL\"/lib/libRblas.so \"$SAGE_LOCAL\"/lib/libRlapack.so \"$SAGE_LOCAL\"/lib/libR.so\n-rm -rf \"$SAGE_LOCAL\"/lib/libRblas.dylib \"$SAGE_LOCAL\"/lib/libRlapack.dylib \"$SAGE_LOCAL\"/lib/libR.dylib\n-\n cd src\n \n # Apply patches.  See SPKG.txt for information about what each patch\n@@ -131,6 +122,15 @@ if [ $? -ne 0 ]; then\n     exit 1\n fi\n \n+# Before installing, remove old install, even the wrongly installed ones.\n+rm -rf \"$SAGE_LOCAL\"/lib/r\n+rm -rf \"$SAGE_LOCAL\"/lib/R\n+rm -rf \"$SAGE_LOCAL\"/lib64/R\n+rm -rf \"$SAGE_LOCAL\"/lib64/r\n+# and let's also nuke some leftovers on SAGE_LOCAL/lib\n+rm -rf \"$SAGE_LOCAL\"/lib/libRblas.so \"$SAGE_LOCAL\"/lib/libRlapack.so \"$SAGE_LOCAL\"/lib/libR.so\n+rm -rf \"$SAGE_LOCAL\"/lib/libRblas.dylib \"$SAGE_LOCAL\"/lib/libRlapack.dylib \"$SAGE_LOCAL\"/lib/libR.dylib\n+\n # Disable parallel make install, which is supposedly broken\n $MAKE -j1 vignettes  # Needed for help system\n $MAKE -j1 install\n@@ -168,7 +168,7 @@ if [ $? -ne 0 ] || [ ! -f \"$SAGE_ROOT\"/s\n fi\n \n if [ \"$UNAME\" = \"Darwin\" ]; then\n-    echo \"Copying fake java and javac compiler on OSX\"\n+    echo \"Removing fake java and javac compiler on OSX.\"\n     rm -f \"$SAGE_LOCAL\"/bin/java\n     rm -f \"$SAGE_LOCAL\"/bin/javac\n fi\n```\nShould this happen on another ticket?",
    "created_at": "2012-09-04T19:39:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124235",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:44'></a>
There is also some general cleanup that could happen; for example:

```diff
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -67,15 +67,6 @@ if [ "$UNAME" = "SunOS" ]; then
     SUN_FLAGS="--without-ICU"; export SUN_FLAGS
 fi
 
-# let's remove old install, even the wrongly installed ones
-rm -rf "$SAGE_LOCAL"/lib/r
-rm -rf "$SAGE_LOCAL"/lib/R
-rm -rf "$SAGE_LOCAL"/lib64/R
-rm -rf "$SAGE_LOCAL"/lib64/r
-# and let's also nuke some leftovers on SAGE_LOCAL/lib
-rm -rf "$SAGE_LOCAL"/lib/libRblas.so "$SAGE_LOCAL"/lib/libRlapack.so "$SAGE_LOCAL"/lib/libR.so
-rm -rf "$SAGE_LOCAL"/lib/libRblas.dylib "$SAGE_LOCAL"/lib/libRlapack.dylib "$SAGE_LOCAL"/lib/libR.dylib
-
 cd src
 
 # Apply patches.  See SPKG.txt for information about what each patch
@@ -131,6 +122,15 @@ if [ $? -ne 0 ]; then
     exit 1
 fi
 
+# Before installing, remove old install, even the wrongly installed ones.
+rm -rf "$SAGE_LOCAL"/lib/r
+rm -rf "$SAGE_LOCAL"/lib/R
+rm -rf "$SAGE_LOCAL"/lib64/R
+rm -rf "$SAGE_LOCAL"/lib64/r
+# and let's also nuke some leftovers on SAGE_LOCAL/lib
+rm -rf "$SAGE_LOCAL"/lib/libRblas.so "$SAGE_LOCAL"/lib/libRlapack.so "$SAGE_LOCAL"/lib/libR.so
+rm -rf "$SAGE_LOCAL"/lib/libRblas.dylib "$SAGE_LOCAL"/lib/libRlapack.dylib "$SAGE_LOCAL"/lib/libR.dylib
+
 # Disable parallel make install, which is supposedly broken
 $MAKE -j1 vignettes  # Needed for help system
 $MAKE -j1 install
@@ -168,7 +168,7 @@ if [ $? -ne 0 ] || [ ! -f "$SAGE_ROOT"/s
 fi
 
 if [ "$UNAME" = "Darwin" ]; then
-    echo "Copying fake java and javac compiler on OSX"
+    echo "Removing fake java and javac compiler on OSX."
     rm -f "$SAGE_LOCAL"/bin/java
     rm -f "$SAGE_LOCAL"/bin/javac
 fi
```
Should this happen on another ticket?



---

archive/issue_comments_124236.json:
```json
{
    "body": "<a id='comment:45'></a>\nReplying to [jhpalmieri](#comment%3A44):\n> Should this happen on another ticket?\n\nYes please.  I specifically didn't do any kind of cleanup just to ensure this would finally be merged.",
    "created_at": "2012-09-04T19:43:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124236",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:45'></a>
Replying to [jhpalmieri](#comment%3A44):
> Should this happen on another ticket?

Yes please.  I specifically didn't do any kind of cleanup just to ensure this would finally be merged.



---

archive/issue_comments_124237.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-09-04T20:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124237",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_124238.json:
```json
{
    "body": "<a id='comment:46'></a>\nrpy2 needs a version bump, otherwise it won't be downloaded when upgrading.",
    "created_at": "2012-09-04T20:00:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124238",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:46'></a>
rpy2 needs a version bump, otherwise it won't be downloaded when upgrading.



---

archive/issue_comments_124239.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-09-04T20:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124239",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_124240.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,8 +7,8 @@\n ---\n \n **spkg**:\n-1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg)\n-2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg) (taken from the old R spkg)\n+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg) (diff: [attachment:r-2.14.0.p5.diff])\n+2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg) (diff: [attachment:rpy2-2.0.8.p0.diff])\n \n ---\n \n``````\n",
    "created_at": "2012-09-04T20:09:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124240",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,8 +7,8 @@
 ---
 
 **spkg**:
-1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg)
-2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.spkg) (taken from the old R spkg)
+1. [http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/r-2.14.0.p5.spkg) (diff: [attachment:r-2.14.0.p5.diff])
+2. [http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/rpy2-2.0.8.p0.spkg) (diff: [attachment:rpy2-2.0.8.p0.diff])
 
 ---
 
``````




---

archive/issue_comments_124241.json:
```json
{
    "body": "Attachment [rpy2-2.0.8.p0.diff](tarball://root/attachments/some-uuid/ticket9906/rpy2-2.0.8.p0.diff) by @jdemeyer created at 2012-09-04 20:26:08\n\nDiff for the rpy2 spkg (w.r.t. to the one in the current R spkg). For reference / review only.",
    "created_at": "2012-09-04T20:26:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124241",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [rpy2-2.0.8.p0.diff](tarball://root/attachments/some-uuid/ticket9906/rpy2-2.0.8.p0.diff) by @jdemeyer created at 2012-09-04 20:26:08

Diff for the rpy2 spkg (w.r.t. to the one in the current R spkg). For reference / review only.



---

archive/issue_comments_124242.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-09-05T04:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124242",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_124243.json:
```json
{
    "body": "<a id='comment:48'></a>\nLooks good to me. Builds and passes tests, and works when upgrading.",
    "created_at": "2012-09-05T04:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124243",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:48'></a>
Looks good to me. Builds and passes tests, and works when upgrading.



---

archive/issue_comments_124244.json:
```json
{
    "body": "Changing reviewer from \"Karl-Dieter Crisman\" to \"Karl-Dieter Crisman, John Palmieri\"",
    "created_at": "2012-09-05T04:41:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124244",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "Karl-Dieter Crisman" to "Karl-Dieter Crisman, John Palmieri"



---

archive/issue_events_030219.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-06T05:23:52Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9906#event-30219"
}
```



---

archive/issue_comments_124245.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-09-06T05:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124245",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_comments_124246.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.4.beta1\"",
    "created_at": "2012-09-06T05:23:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124246",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.4.beta1"



---

archive/issue_comments_124247.json:
```json
{
    "body": "<a id='comment:50'></a>\n> > Should this happen on another ticket?\n\n> Yes please.  I specifically didn't do any kind of cleanup just to ensure this would finally be merged.\nYou can cc: me on this new ticket too when you make it.",
    "created_at": "2012-09-06T19:19:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124247",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:50'></a>
> > Should this happen on another ticket?

> Yes please.  I specifically didn't do any kind of cleanup just to ensure this would finally be merged.
You can cc: me on this new ticket too when you make it.



---

archive/issue_comments_124248.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [kcrisman](#comment%3A50):\n> You can cc: me on this new ticket too when you make it.\n\nTo be honest, this is not something I feel like working on, so I'm going to make that ticket.",
    "created_at": "2012-09-07T09:49:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124248",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:51'></a>
Replying to [kcrisman](#comment%3A50):
> You can cc: me on this new ticket too when you make it.

To be honest, this is not something I feel like working on, so I'm going to make that ticket.



---

archive/issue_comments_124249.json:
```json
{
    "body": "<a id='comment:52'></a>\nOkay, I'm making the follow-up anyway: #13443.",
    "created_at": "2012-09-10T14:03:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9906",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9906#issuecomment-124249",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:52'></a>
Okay, I'm making the follow-up anyway: #13443.
