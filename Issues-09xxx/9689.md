# Issue 9689: Numerical noise on devel/sage-main/sage/symbolic/expression.pyx computing sinh(1)

archive/issues_009689.json:
```json
{
    "body": "Whilst there is no complete 64-bit build of Sage on Solaris x86, a sufficiently large part of Sage does build (with a few changes) on Solaris 10 x86. When built on 'fulvia', a Dell Optiplex with Xeon processors, there was a numerical noise issue - see #9099\n\n```\nsage -t  -long devel/sage/sage/symbolic/expression.pyx\n**********************************************************************\nFile \"/home/palmieri/fulvia/sage-4.5.2.rc0/devel/sage-main/sage/symbolic/expression.pyx\", line 498\\\n3:\n    sage: maxima('sinh(1.0)')\nExpected:\n    1.175201193643801\nGot:\n    1.175201193643802\n```\n\nA computation with Mathematica, using 60 digits of precision gives \n\n```\nIn[2]:= N[Sinh[1],60]\n\nOut[2]= 1.17520119364380145688238185059560081515571798133409587022957\n```\n\nThe absolute error on Solaris x86 is slightly higher than seen on some other systems, but this is still a perfectly acceptable result.\n\nThis should be fairly easy to fix. I'll make a patch later today\n\nDave \n\n\nAssignee: mvngu\n\nCC:  @jhpalmieri\n\nResolution: fixed\n\nAuthor: David Kirkby\n\nReviewer: John Cremona\n\nMerged: sage-4.5.3.alpha2\n\nIssue created by migration from https://trac.sagemath.org/ticket/9689\n\n",
    "closed_at": "2010-08-24T02:51:17Z",
    "created_at": "2010-08-05T08:27:45Z",
    "labels": [
        "component: doctest coverage",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5.3",
    "title": "Numerical noise on devel/sage-main/sage/symbolic/expression.pyx computing sinh(1)",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9689",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```
Whilst there is no complete 64-bit build of Sage on Solaris x86, a sufficiently large part of Sage does build (with a few changes) on Solaris 10 x86. When built on 'fulvia', a Dell Optiplex with Xeon processors, there was a numerical noise issue - see #9099

```
sage -t  -long devel/sage/sage/symbolic/expression.pyx
**********************************************************************
File "/home/palmieri/fulvia/sage-4.5.2.rc0/devel/sage-main/sage/symbolic/expression.pyx", line 498\
3:
    sage: maxima('sinh(1.0)')
Expected:
    1.175201193643801
Got:
    1.175201193643802
```

A computation with Mathematica, using 60 digits of precision gives 

```
In[2]:= N[Sinh[1],60]

Out[2]= 1.17520119364380145688238185059560081515571798133409587022957
```

The absolute error on Solaris x86 is slightly higher than seen on some other systems, but this is still a perfectly acceptable result.

This should be fairly easy to fix. I'll make a patch later today

Dave 


Assignee: mvngu

CC:  @jhpalmieri

Resolution: fixed

Author: David Kirkby

Reviewer: John Cremona

Merged: sage-4.5.3.alpha2

Issue created by migration from https://trac.sagemath.org/ticket/9689





---

archive/issue_comments_118985.json:
```json
{
    "body": "<a id='comment:1'></a>\nI just realise the second failure shown on #9099\n\n```\nExpected:\n    0.881373587019543\nGot:\n    .8813735870195429\n```\n\nis the same file (devel/sage-main/sage/symbolic/expression.pyx) as this simple numerical noise issue. Hopefully be solved too. That's a less obvious problem to solve though. \n\nAny ideas anyone?",
    "created_at": "2010-08-05T17:10:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118985",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:1'></a>
I just realise the second failure shown on #9099

```
Expected:
    0.881373587019543
Got:
    .8813735870195429
```

is the same file (devel/sage-main/sage/symbolic/expression.pyx) as this simple numerical noise issue. Hopefully be solved too. That's a less obvious problem to solve though. 

Any ideas anyone?



---

archive/issue_comments_118986.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2010-08-05T22:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118986",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_118987.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -20,7 +20,7 @@\n Out[2]= 1.17520119364380145688238185059560081515571798133409587022957\n ```\n \n-The absolute error on Solaris x86 is slighly higher than seen on some other systems, but this is still a perfectly acceptable result.\n+The absolute error on Solaris x86 is slightly higher than seen on some other systems, but this is still a perfectly acceptable result.\n \n This should be fairly easy to fix. I'll make a patch later today\n \n``````\n",
    "created_at": "2010-08-05T22:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118987",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -20,7 +20,7 @@
 Out[2]= 1.17520119364380145688238185059560081515571798133409587022957
 ```
 
-The absolute error on Solaris x86 is slighly higher than seen on some other systems, but this is still a perfectly acceptable result.
+The absolute error on Solaris x86 is slightly higher than seen on some other systems, but this is still a perfectly acceptable result.
 
 This should be fairly easy to fix. I'll make a patch later today
 
``````




---

archive/issue_events_029384.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "rename": {
        "from": "Numerical noise on devel/sage-main/sage/symbolic/expression.pyx",
        "to": "Numerical noise on devel/sage-main/sage/symbolic/expression.pyx computing sinh(1)"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9689#event-29384"
}
```



---

archive/issue_comments_118988.json:
```json
{
    "body": "Attachment [9689-sinh-noise-fix.patch](tarball://root/attachments/some-uuid/ticket9689/9689-sinh-noise-fix.patch) by drkirkby created at 2010-08-05 22:39:19\n\nSolves the numerical noise issue computing sinh(1.0). The archsinh case is more complex, and will be on another ticket.",
    "created_at": "2010-08-05T22:39:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118988",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Attachment [9689-sinh-noise-fix.patch](tarball://root/attachments/some-uuid/ticket9689/9689-sinh-noise-fix.patch) by drkirkby created at 2010-08-05 22:39:19

Solves the numerical noise issue computing sinh(1.0). The archsinh case is more complex, and will be on another ticket.



---

archive/issue_comments_118989.json:
```json
{
    "body": "<a id='comment:3'></a>\nIt's not very pretty, but \n\n```\nabs(float(maxima('asinh(1.0)')) - 0.881373587019543) < 1e-15\n```\nor\n\n```\nmaxima('abs(asinh(1.0) - 0.881373587019543)') < 1e-15\n```\nwork for the other test.  Or:\n\n```\nsage: float(maxima('asinh(1.0)'))\n0.8813735870195429...\n```",
    "created_at": "2010-08-05T23:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118989",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:3'></a>
It's not very pretty, but 

```
abs(float(maxima('asinh(1.0)')) - 0.881373587019543) < 1e-15
```
or

```
maxima('abs(asinh(1.0) - 0.881373587019543)') < 1e-15
```
work for the other test.  Or:

```
sage: float(maxima('asinh(1.0)'))
0.8813735870195429...
```



---

archive/issue_comments_118990.json:
```json
{
    "body": "<a id='comment:4'></a>\nOr replace \"float\" with \"RR\", etc.",
    "created_at": "2010-08-05T23:03:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118990",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:4'></a>
Or replace "float" with "RR", etc.



---

archive/issue_comments_118991.json:
```json
{
    "body": "<a id='comment:5'></a>\nYes, we can get this to pass, but that is just covering up a bug, as the number should never be printed as `.8813735870195429` It is a numerically correct result, but it is not printed the way one would expect a piece of software to print the number. \n \t \t\nCarl Witty is of the opinion this is either a Maxima or ECL bug\n\nhttp://groups.google.com/group/sage-devel/msg/aa318e11e84afe8d?hl=en\n\nI think its better to leave the `asinh(1.0)` case failing. It will be a constant reminder we need to get a real solution, not hack the doctest to get it to pass. \n\nUltimately, I feel the doctest has discovered a bug, which is what a good test should do. \n\nDave",
    "created_at": "2010-08-05T23:19:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118991",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:5'></a>
Yes, we can get this to pass, but that is just covering up a bug, as the number should never be printed as `.8813735870195429` It is a numerically correct result, but it is not printed the way one would expect a piece of software to print the number. 
 	 	
Carl Witty is of the opinion this is either a Maxima or ECL bug

http://groups.google.com/group/sage-devel/msg/aa318e11e84afe8d?hl=en

I think its better to leave the `asinh(1.0)` case failing. It will be a constant reminder we need to get a real solution, not hack the doctest to get it to pass. 

Ultimately, I feel the doctest has discovered a bug, which is what a good test should do. 

Dave



---

archive/issue_comments_118992.json:
```json
{
    "body": "Changing author from \"\" to \"David Kirkby\"",
    "created_at": "2010-08-05T23:24:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118992",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Changing author from "" to "David Kirkby"



---

archive/issue_comments_118993.json:
```json
{
    "body": "<a id='comment:7'></a>\nI created #9693 to resolve the leading zero problem and are going to copy the problem to the ECL and Maxima mailing lists, to see if we get any response. \n\nDave",
    "created_at": "2010-08-05T23:48:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118993",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:7'></a>
I created #9693 to resolve the leading zero problem and are going to copy the problem to the ECL and Maxima mailing lists, to see if we get any response. 

Dave



---

archive/issue_comments_118994.json:
```json
{
    "body": "<a id='comment:8'></a>\nThis looks fine to me and passed tests (in that file) on both 32-bit and 64-bit ubuntu.",
    "created_at": "2010-08-12T17:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118994",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:8'></a>
This looks fine to me and passed tests (in that file) on both 32-bit and 64-bit ubuntu.



---

archive/issue_comments_118995.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2010-08-12T17:49:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118995",
    "user": "https://github.com/JohnCremona"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_118996.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [cremona](#comment%3A8):\n> This looks fine to me and passed tests (in that file) on both 32-bit and 64-bit ubuntu.\n\n\nThank you for the review John. \n\nDave",
    "created_at": "2010-08-12T18:22:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118996",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:9'></a>
Replying to [cremona](#comment%3A8):
> This looks fine to me and passed tests (in that file) on both 32-bit and 64-bit ubuntu.


Thank you for the review John. 

Dave



---

archive/issue_comments_118997.json:
```json
{
    "body": "Changing reviewer from \"\" to \"John Cremona\"",
    "created_at": "2010-08-16T21:49:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118997",
    "user": "https://github.com/qed777"
}
```

Changing reviewer from "" to "John Cremona"



---

archive/issue_events_029385.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-24T02:51:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9689#event-29385"
}
```



---

archive/issue_comments_118998.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-4.5.3.alpha2\"",
    "created_at": "2010-08-24T02:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118998",
    "user": "https://github.com/qed777"
}
```

Changing merged from "" to "sage-4.5.3.alpha2"



---

archive/issue_comments_118999.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2010-08-24T02:51:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9689",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9689#issuecomment-118999",
    "user": "https://github.com/qed777"
}
```

Resolution: fixed
