# Issue 9472: Remove (duplicate) BOOST and M4RI source trees from PolyBoRi spkg, some clean-up

archive/issues_009472.json:
```json
{
    "body": "`SPKG.txt` excerpt from the *modified* spkg:\n\n```\n### polybori-0.6.4.p2 (Leif Leonhardy, July 10th, 2010)\n * Removed Michael Abshoff from maintainer list (see #7738)\n * Deleted Boost source tree again since it was split off into a separate\n   spkg (see below, 0.5.rc.p7), modified spkg-install accordingly\n * Deleted M4RI source tree, because it is a standard Sage package\n * Little clean-up and minor fixes in patches/custom.py\n   - Note that CFLAGS etc. are still *overwritten* rather than modified!\n * Updated \"Dependencies\" section above\n```\n\nSlightly more readable:\n* Removed *Michael Abshoff* from maintainer list (see #7738)\n* Deleted Boost source tree again since it was split off into a separate\n  spkg (see below, 0.5.rc.p7), modified `spkg-install` accordingly\n* Deleted M4RI source tree, because it is a standard Sage package\n* Little clean-up and minor fixes in `patches/custom.py`\n  - Note that `CFLAGS` etc. are still **overwritten** rather than modified!\n* Updated *\"Dependencies\"* section above\n\n\nDuring upgrade to 0.6.x, the Boost source unintentionally got in again. The new spkg is about 1.7MB, i.e. 300KB smaller.\n\n---\n\n**The new PolyBoRi 0.6.4.p2 spkg is [here](http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg).**\n\n(To test *the patch*, the directories have to be removed manually, since the attached patch doesn't delete them from 0.6.4.p1; see [comment below](http://trac.sagemath.org/sage_trac/ticket/9472#comment:1).)\n\n---\n\nSince PolyBoRi also uses GD, `$SAGE_ROOT/spkg/standard/deps` should be updated (but there seem to have been no issues with that in the past).\n\n\n**CC:**  @kcrisman\n\n**Resolution:** fixed\n\n**Author:** Leif Leonhardy\n\n**Reviewer:** Martin Albrecht\n\n**Merged:** sage-4.5.3.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/9472\n\n",
    "closed_at": "2010-08-09T09:39:13Z",
    "created_at": "2010-07-11T00:05:23Z",
    "labels": [
        "component: packages: standard",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5.3",
    "title": "Remove (duplicate) BOOST and M4RI source trees from PolyBoRi spkg, some clean-up",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9472",
    "user": "https://github.com/nexttime"
}
```
`SPKG.txt` excerpt from the *modified* spkg:

```
### polybori-0.6.4.p2 (Leif Leonhardy, July 10th, 2010)
 * Removed Michael Abshoff from maintainer list (see #7738)
 * Deleted Boost source tree again since it was split off into a separate
   spkg (see below, 0.5.rc.p7), modified spkg-install accordingly
 * Deleted M4RI source tree, because it is a standard Sage package
 * Little clean-up and minor fixes in patches/custom.py
   - Note that CFLAGS etc. are still *overwritten* rather than modified!
 * Updated "Dependencies" section above
```

Slightly more readable:
* Removed *Michael Abshoff* from maintainer list (see #7738)
* Deleted Boost source tree again since it was split off into a separate
  spkg (see below, 0.5.rc.p7), modified `spkg-install` accordingly
* Deleted M4RI source tree, because it is a standard Sage package
* Little clean-up and minor fixes in `patches/custom.py`
  - Note that `CFLAGS` etc. are still **overwritten** rather than modified!
* Updated *"Dependencies"* section above


During upgrade to 0.6.x, the Boost source unintentionally got in again. The new spkg is about 1.7MB, i.e. 300KB smaller.

---

**The new PolyBoRi 0.6.4.p2 spkg is [here](http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg).**

(To test *the patch*, the directories have to be removed manually, since the attached patch doesn't delete them from 0.6.4.p1; see [comment below](http://trac.sagemath.org/sage_trac/ticket/9472#comment:1).)

---

Since PolyBoRi also uses GD, `$SAGE_ROOT/spkg/standard/deps` should be updated (but there seem to have been no issues with that in the past).


**CC:**  @kcrisman

**Resolution:** fixed

**Author:** Leif Leonhardy

**Reviewer:** Martin Albrecht

**Merged:** sage-4.5.3.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/9472





---

archive/attachments_012111.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "polybori-0.6.4.p1-p2.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9472/polybori-0.6.4.p1-p2.patch",
    "created_at": "2010-07-11T00:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nexttime"
}
```



---

archive/issue_comments_114761.json:
```json
{
    "body": "Apply to polybori-0.6.4.p1. Source trees have to be removed manually.",
    "created_at": "2010-07-11T00:12:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114761",
    "user": "https://github.com/nexttime"
}
```

Apply to polybori-0.6.4.p1. Source trees have to be removed manually.



---

archive/issue_comments_114762.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2010-07-11T01:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114762",
    "user": "https://github.com/nexttime"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_114763.json:
```json
{
    "body": "<a id='comment:1'></a>\n\n```\n$ diff -qr polybori-0.6.4.p1/ polybori-0.6.4.p2/\n...\nFiles polybori-0.6.4.p1/SPKG.txt and polybori-0.6.4.p2/SPKG.txt differ\nFiles polybori-0.6.4.p1/patches/custom.py and polybori-0.6.4.p2/patches/custom.py differ\nFiles polybori-0.6.4.p1/spkg-install and polybori-0.6.4.p2/spkg-install differ\nOnly in polybori-0.6.4.p1/src: boost_1_34_1.cropped\nOnly in polybori-0.6.4.p1/src/polybori-0.6.4: M4RI\n```\nI.e., to remove the Boost and M4RI source trees, do:\n\n```sh\nrm -rv polybori-0.6.4.p1/src/boost_1_34_1.cropped\nrm -rv polybori-0.6.4.p1/src/polybori-0.6.4/M4RI\n```\n\nI've tested the spkg with Sage 4.5.alpha4 (with SageNB 0.8.1 and zodb3 3.7.0.p4) on Ubuntu 9.04 x86_64; all tests, including long ones, passed.",
    "created_at": "2010-07-11T01:00:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114763",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:1'></a>

```
$ diff -qr polybori-0.6.4.p1/ polybori-0.6.4.p2/
...
Files polybori-0.6.4.p1/SPKG.txt and polybori-0.6.4.p2/SPKG.txt differ
Files polybori-0.6.4.p1/patches/custom.py and polybori-0.6.4.p2/patches/custom.py differ
Files polybori-0.6.4.p1/spkg-install and polybori-0.6.4.p2/spkg-install differ
Only in polybori-0.6.4.p1/src: boost_1_34_1.cropped
Only in polybori-0.6.4.p1/src/polybori-0.6.4: M4RI
```
I.e., to remove the Boost and M4RI source trees, do:

```sh
rm -rv polybori-0.6.4.p1/src/boost_1_34_1.cropped
rm -rv polybori-0.6.4.p1/src/polybori-0.6.4/M4RI
```

I've tested the spkg with Sage 4.5.alpha4 (with SageNB 0.8.1 and zodb3 3.7.0.p4) on Ubuntu 9.04 x86_64; all tests, including long ones, passed.



---

archive/issue_comments_114764.json:
```json
{
    "body": "<a id='comment:2'></a>\nleif's updated spkg: [polybori-0.6.4.p2.spkg](http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg)",
    "created_at": "2010-07-11T10:04:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114764",
    "user": "https://github.com/haraldschilly"
}
```

<a id='comment:2'></a>
leif's updated spkg: [polybori-0.6.4.p2.spkg](http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg)



---

archive/issue_comments_114765.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -23,7 +23,13 @@\n \n During upgrade to 0.6.x, the Boost source unintentionally got in again. The new spkg is about 1.7MB, i.e. 300KB smaller.\n \n-To test *the patch*, the directories have to be removed manually (the attached patch doesn't delete them from 0.6.4.p1), but **the new spkg will be uploaded to sage.math soon**.\n+---\n+\n+**The new PolyBoRi 0.6.4.p2 spkg is [here](http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg).**\n+\n+(To test *the patch*, the directories have to be removed manually, since the attached patch doesn't delete them from 0.6.4.p1; see [comment below](http://trac.sagemath.org/sage_trac/ticket/9472#comment:1).)\n+\n+---\n \n Since PolyBoRi also uses GD, `$SAGE_ROOT/spkg/standard/deps` should be updated (but there seem to have been no issues with that in the past).\n \n``````\n",
    "created_at": "2010-07-11T10:24:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114765",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -23,7 +23,13 @@
 
 During upgrade to 0.6.x, the Boost source unintentionally got in again. The new spkg is about 1.7MB, i.e. 300KB smaller.
 
-To test *the patch*, the directories have to be removed manually (the attached patch doesn't delete them from 0.6.4.p1), but **the new spkg will be uploaded to sage.math soon**.
+---
+
+**The new PolyBoRi 0.6.4.p2 spkg is [here](http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg).**
+
+(To test *the patch*, the directories have to be removed manually, since the attached patch doesn't delete them from 0.6.4.p1; see [comment below](http://trac.sagemath.org/sage_trac/ticket/9472#comment:1).)
+
+---
 
 Since PolyBoRi also uses GD, `$SAGE_ROOT/spkg/standard/deps` should be updated (but there seem to have been no issues with that in the past).
 
``````




---

archive/issue_comments_114766.json:
```json
{
    "body": "<a id='comment:4'></a>\nI replaced thePolyBoRi SPKG in Sage 4.5.alpha4 with the one linked above and built Sage from scratch without problems. All doctests also pass on sage.math. I checked the install log andPolyBoRi reports M4RI found (and wouldn't build without Boost anyway).",
    "created_at": "2010-07-11T18:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114766",
    "user": "https://github.com/malb"
}
```

<a id='comment:4'></a>
I replaced thePolyBoRi SPKG in Sage 4.5.alpha4 with the one linked above and built Sage from scratch without problems. All doctests also pass on sage.math. I checked the install log andPolyBoRi reports M4RI found (and wouldn't build without Boost anyway).



---

archive/issue_comments_114767.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2010-07-11T18:58:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114767",
    "user": "https://github.com/malb"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_114768.json:
```json
{
    "body": "<a id='comment:5'></a>\nIt seems that we can install PolyBoRi in parallel with, e.g.,\n\n```sh\n$ env MAKEOPTS=\"-j20\" ./sage -f http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg\n```\nBut I haven't tested this extensively.",
    "created_at": "2010-08-07T11:04:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114768",
    "user": "https://github.com/qed777"
}
```

<a id='comment:5'></a>
It seems that we can install PolyBoRi in parallel with, e.g.,

```sh
$ env MAKEOPTS="-j20" ./sage -f http://sage.math.washington.edu/home/schilly/sage/spkg/polybori-0.6.4.p2.spkg
```
But I haven't tested this extensively.



---

archive/issue_comments_114769.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2010-08-09T09:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114769",
    "user": "https://github.com/qed777"
}
```

**Resolution:** fixed



---

archive/issue_events_028615.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-08-09T09:39:13Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9472#event-28615"
}
```



---

archive/issue_comments_114770.json:
```json
{
    "body": "**Reviewer:** Martin Albrecht",
    "created_at": "2010-08-09T09:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114770",
    "user": "https://github.com/qed777"
}
```

**Reviewer:** Martin Albrecht



---

archive/issue_comments_114771.json:
```json
{
    "body": "**Merged:** sage-4.5.3.alpha0",
    "created_at": "2010-08-09T09:39:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114771",
    "user": "https://github.com/qed777"
}
```

**Merged:** sage-4.5.3.alpha0



---

archive/issue_comments_114772.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [mpatel](#comment%3A6):\n\nDid you also update/correct `standard/deps` to reflect the GD dependency (cf. bottom note in the ticket's description)?",
    "created_at": "2010-08-09T17:09:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114772",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
Replying to [mpatel](#comment%3A6):

Did you also update/correct `standard/deps` to reflect the GD dependency (cf. bottom note in the ticket's description)?



---

archive/issue_comments_114773.json:
```json
{
    "body": "<a id='comment:8'></a>\nReplying to [leif](#comment%3A7):\n> Replying to [mpatel](#comment%3A6):\n> \n> Did you also update/correct `standard/deps` to reflect the GD dependency (cf. bottom note in the ticket's description)?\n\n\nNo, I didn't.  I apologize for that.  (We should have, for the record, an updated `deps` file, or a `deps.diff` *at minimum*, attached to trac.)\n\nSince \"there seem to have been no issues with that [the missing GD dependency] in the past\" and I'm nearly ready to release the current trial 4.5.3.alpha0, I've opened #9712 and suggest that we merge it in 4.5.3.alpha1.\n\nI assume the GD change itself is already reviewed, so I can review #9712 fairly quickly.  Or, if I have a spare moment, I'll post a new `deps` and `deps.diff`.\n\n(Ticket #9433 should help with these types of changes.)",
    "created_at": "2010-08-09T22:45:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114773",
    "user": "https://github.com/qed777"
}
```

<a id='comment:8'></a>
Replying to [leif](#comment%3A7):
> Replying to [mpatel](#comment%3A6):
> 
> Did you also update/correct `standard/deps` to reflect the GD dependency (cf. bottom note in the ticket's description)?


No, I didn't.  I apologize for that.  (We should have, for the record, an updated `deps` file, or a `deps.diff` *at minimum*, attached to trac.)

Since "there seem to have been no issues with that [the missing GD dependency] in the past" and I'm nearly ready to release the current trial 4.5.3.alpha0, I've opened #9712 and suggest that we merge it in 4.5.3.alpha1.

I assume the GD change itself is already reviewed, so I can review #9712 fairly quickly.  Or, if I have a spare moment, I'll post a new `deps` and `deps.diff`.

(Ticket #9433 should help with these types of changes.)



---

archive/issue_comments_114774.json:
```json
{
    "body": "<a id='comment:9'></a>\nKarl-Dieter (kcrisman) has just reported on sage-release updating from 4.5.2 to 4.5.3.alpha0 failed on MacOS X 10.6 because this new PolyBoRi package failed to build:\n\n```\n...\nChecking for C library m4ri... no\nChecking for C header file gd.h... yes\nChecking for C library gd... no\nSymlinking to M4RI/m4ri ...\nOSError: [Errno 2] No such file or directory:\n  File \"/Users/.../sage-4.5.2/spkg/build/polybori-0.6.4.p2/src/\npolybori-0.6.4/SConstruct\", line 421:\n    os.symlink('.', m4ri_inc)\nError building PolyBoRi.\n \nreal\t0m1.425s\nuser\t0m0.860s\nsys\t0m0.473s\nsage: An error occurred while installing polybori-0.6.4.p2\n...\n```\n\nI'll open a new ticket for that shortly (unless someone else is faster).",
    "created_at": "2010-08-10T22:01:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114774",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>
Karl-Dieter (kcrisman) has just reported on sage-release updating from 4.5.2 to 4.5.3.alpha0 failed on MacOS X 10.6 because this new PolyBoRi package failed to build:

```
...
Checking for C library m4ri... no
Checking for C header file gd.h... yes
Checking for C library gd... no
Symlinking to M4RI/m4ri ...
OSError: [Errno 2] No such file or directory:
  File "/Users/.../sage-4.5.2/spkg/build/polybori-0.6.4.p2/src/
polybori-0.6.4/SConstruct", line 421:
    os.symlink('.', m4ri_inc)
Error building PolyBoRi.
 
real	0m1.425s
user	0m0.860s
sys	0m0.473s
sage: An error occurred while installing polybori-0.6.4.p2
...
```

I'll open a new ticket for that shortly (unless someone else is faster).



---

archive/issue_comments_114775.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [leif](#comment%3A9):\n> I'll open a new ticket for that shortly (unless someone else is faster).\n\n\nI've opened #9721 for this.",
    "created_at": "2010-08-11T01:18:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9472",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9472#issuecomment-114775",
    "user": "https://github.com/qed777"
}
```

<a id='comment:10'></a>
Replying to [leif](#comment%3A9):
> I'll open a new ticket for that shortly (unless someone else is faster).


I've opened #9721 for this.
