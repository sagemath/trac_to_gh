# Issue 9774: Use MathJax instead of jsMath

archive/issues_009773.json:
```json
{
    "body": "[MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).\n\n**apply**: \n* [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n* [attachment:trac_9774-mathjax-try7.patch] to the sage library repository\n\nAlso install the new notebook from #13121\n\nAssignee: jason, was\n\nCC:  @rbeezer @robert-marik @jhpalmieri rkirov @kcrisman @kini\n\nKeywords: sd41\n\nUpstream: Fixed upstream, but not in a stable release.\n\nReviewer: Jason Grout, John Palmieri, Punarbasu Purkayastha, Keshav Kini\n\nAuthor: Rob Beezer, Davide Cervone, John Palmieri, Jason Grout, Nathan Carter\n\nMerged: sage-5.4.beta0\n\nDependencies: #13121\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/9774\n\n",
    "closed_at": "2012-09-05T18:05:17Z",
    "created_at": "2010-08-21T09:36:05Z",
    "labels": [
        "component: notebook"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.4",
    "title": "Use MathJax instead of jsMath",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9774",
    "user": "https://github.com/qed777"
}
```
[MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).

**apply**: 
* [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
* [attachment:trac_9774-mathjax-try7.patch] to the sage library repository

Also install the new notebook from #13121

Assignee: jason, was

CC:  @rbeezer @robert-marik @jhpalmieri rkirov @kcrisman @kini

Keywords: sd41

Upstream: Fixed upstream, but not in a stable release.

Reviewer: Jason Grout, John Palmieri, Punarbasu Purkayastha, Keshav Kini

Author: Rob Beezer, Davide Cervone, John Palmieri, Jason Grout, Nathan Carter

Merged: sage-5.4.beta0

Dependencies: #13121

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/9774





---

archive/issue_comments_120877.json:
```json
{
    "body": "<a id='comment:2'></a>\nI've been experimenting a bit with `MathJax`, outside of the notebook.  Mostly thinking about how it will handle tex4ht output in jsMath mode, but here are some some observations that might be useful:\n\n1.  Easier in most ways to structure a page to use `MathJax`.  Just insert something like\n\n```\n<script type=\"text/javascript\" src=\"path-to-MathJax/MathJax.js\"></script>\n```\n\nNo need for a \"process()\" call at the end, etc.\n\n\n2.  Default is to not recognize single dollar-signs as delimiters.  Alternative is  `\\(..\\)`.  This would be a good thing, since if a user adds text (via TinyMCE) right now jsMath tries to parse the following as math.  `$$..$$` and  `\\[..\\]` both work for display math.  We would break lots of old worksheets if we stopped recognizing `$..$`.\n\n3.  There is a jsMath compatibility mode.  I believe I've found one bug in this already (reported upstream).  I'd imagine this is not a development priority, but who knows?\n\n4.  Modes and configuration is controlled globally by  `config/MathJax.js`  which is just one huge well-commented Javascript object.  It can be overridden in a web page by adding a new version into the script block mentioned above.  Maybe we want to make this easy for users to access, or maybe it is easy already, or maybe we don't want to bother.\n\n5.  This looks to me like the best introduction to the types of decisions we will want to make about what to cut over to:\nhttp://www.mathjax.org/resources/docs/?configuration.html\n\n6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.\n\n7.  I just noticed this morning that `html.table()` uses  `class=\"math\"` which is a jsMath way to tag span's or div's for processing.  I haven't found how to do something similiar in `MathJax`, though this will work in jsMath compatibility mode.  A very small test would indicate that the two modes can be used at the same time.\n\n8.  Consonant with (2) and (7), I'd love to see the notebook formatting move to something closer to rigorous XML (ie XHTML, I guess).  Certain types of processing would be easier if we did, but that is not really what this ticket is all about.",
    "created_at": "2010-08-24T18:52:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120877",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:2'></a>
I've been experimenting a bit with `MathJax`, outside of the notebook.  Mostly thinking about how it will handle tex4ht output in jsMath mode, but here are some some observations that might be useful:

1.  Easier in most ways to structure a page to use `MathJax`.  Just insert something like

```
<script type="text/javascript" src="path-to-MathJax/MathJax.js"></script>
```

No need for a "process()" call at the end, etc.


2.  Default is to not recognize single dollar-signs as delimiters.  Alternative is  `\(..\)`.  This would be a good thing, since if a user adds text (via TinyMCE) right now jsMath tries to parse the following as math.  `$$..$$` and  `\[..\]` both work for display math.  We would break lots of old worksheets if we stopped recognizing `$..$`.

3.  There is a jsMath compatibility mode.  I believe I've found one bug in this already (reported upstream).  I'd imagine this is not a development priority, but who knows?

4.  Modes and configuration is controlled globally by  `config/MathJax.js`  which is just one huge well-commented Javascript object.  It can be overridden in a web page by adding a new version into the script block mentioned above.  Maybe we want to make this easy for users to access, or maybe it is easy already, or maybe we don't want to bother.

5.  This looks to me like the best introduction to the types of decisions we will want to make about what to cut over to:
http://www.mathjax.org/resources/docs/?configuration.html

6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.

7.  I just noticed this morning that `html.table()` uses  `class="math"` which is a jsMath way to tag span's or div's for processing.  I haven't found how to do something similiar in `MathJax`, though this will work in jsMath compatibility mode.  A very small test would indicate that the two modes can be used at the same time.

8.  Consonant with (2) and (7), I'd love to see the notebook formatting move to something closer to rigorous XML (ie XHTML, I guess).  Certain types of processing would be easier if we did, but that is not really what this ticket is all about.



---

archive/issue_comments_120878.json:
```json
{
    "body": "<a id='comment:3'></a>\nThanks for comment, I feel that MathJax is much slower on cheap/older computer. This could be an important issue for using Sage in highschools and universities. Is it possible to keep both MathJax and jsMath and let the notebook admin to choose, which one will be used?",
    "created_at": "2010-08-24T19:57:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120878",
    "user": "https://github.com/robert-marik"
}
```

<a id='comment:3'></a>
Thanks for comment, I feel that MathJax is much slower on cheap/older computer. This could be an important issue for using Sage in highschools and universities. Is it possible to keep both MathJax and jsMath and let the notebook admin to choose, which one will be used?



---

archive/issue_comments_120879.json:
```json
{
    "body": "<a id='comment:4'></a>\nReplying to [rbeezer](#comment%3A2):\n\n> 6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.\n\n\n\nI think MathJax includes the equivalent of our jsmath-image-fonts spkg.  If we added MathJax to Sage, it might be good to strip out the image fonts and distribute them separately as a mathjax-image-fonts spkg (mathjax faq tells how to do this, I believe).  Somewhere I have a half-finished prototype of this solution.",
    "created_at": "2010-08-25T22:34:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120879",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:4'></a>
Replying to [rbeezer](#comment%3A2):

> 6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.



I think MathJax includes the equivalent of our jsmath-image-fonts spkg.  If we added MathJax to Sage, it might be good to strip out the image fonts and distribute them separately as a mathjax-image-fonts spkg (mathjax faq tells how to do this, I believe).  Somewhere I have a half-finished prototype of this solution.



---

archive/issue_comments_120880.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n [MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).\n+\n+This will also fix #1608\n``````\n",
    "created_at": "2010-10-15T01:23:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120880",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 [MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).
+
+This will also fix #1608
``````




---

archive/issue_comments_120881.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,9 @@\n [MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).\n \n This will also fix #1608\n+\n+Jason Grout says:\n+\n+I have a half-finished patch up at http://sage.math.washington.edu/home/jason/sagenb-mathjax.patch.gz (gzipped because it's so big).\n+\n+I had a mathjax_imagefonts-1.0.spkg somewhere, I but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.\n``````\n",
    "created_at": "2010-10-15T01:50:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120881",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,9 @@
 [MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).
 
 This will also fix #1608
+
+Jason Grout says:
+
+I have a half-finished patch up at http://sage.math.washington.edu/home/jason/sagenb-mathjax.patch.gz (gzipped because it's so big).
+
+I had a mathjax_imagefonts-1.0.spkg somewhere, I but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.
``````




---

archive/issue_comments_120882.json:
```json
{
    "body": "Changing status from new to needs_work.",
    "created_at": "2010-10-15T01:50:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120882",
    "user": "https://github.com/jasongrout"
}
```

Changing status from new to needs_work.



---

archive/issue_comments_120883.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,4 +6,4 @@\n \n I have a half-finished patch up at http://sage.math.washington.edu/home/jason/sagenb-mathjax.patch.gz (gzipped because it's so big).\n \n-I had a mathjax_imagefonts-1.0.spkg somewhere, I but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.\n+I had a mathjax_imagefonts-1.0.spkg somewhere, but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.\n``````\n",
    "created_at": "2010-10-15T01:50:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120883",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,4 +6,4 @@
 
 I have a half-finished patch up at http://sage.math.washington.edu/home/jason/sagenb-mathjax.patch.gz (gzipped because it's so big).
 
-I had a mathjax_imagefonts-1.0.spkg somewhere, I but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.
+I had a mathjax_imagefonts-1.0.spkg somewhere, but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.
``````




---

archive/issue_comments_120884.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [jason](#comment%3A4):\n> Replying to [rbeezer](#comment%3A2):\n> \n> > 6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.\n  \n> \n> \n> I think MathJax includes the equivalent of our jsmath-image-fonts spkg.  If we added MathJax to Sage, it might be good to strip out the image fonts and distribute them separately as a mathjax-image-fonts spkg (mathjax faq tells how to do this, I believe).  Somewhere I have a half-finished prototype of this solution.\n\n\nJust in case you haven't thought of this, what Gollum (the [GitHub](GitHub) forum) folks did was host the MathJax fonts on Amazon S3, and then not include them in their distribution.  I don't know if that would work for you, but I wanted to point it out.",
    "created_at": "2010-10-21T20:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120884",
    "user": "https://trac.sagemath.org/admin/accounts/users/rminer"
}
```

<a id='comment:10'></a>
Replying to [jason](#comment%3A4):
> Replying to [rbeezer](#comment%3A2):
> 
> > 6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.
  
> 
> 
> I think MathJax includes the equivalent of our jsmath-image-fonts spkg.  If we added MathJax to Sage, it might be good to strip out the image fonts and distribute them separately as a mathjax-image-fonts spkg (mathjax faq tells how to do this, I believe).  Somewhere I have a half-finished prototype of this solution.


Just in case you haven't thought of this, what Gollum (the [GitHub](GitHub) forum) folks did was host the MathJax fonts on Amazon S3, and then not include them in their distribution.  I don't know if that would work for you, but I wanted to point it out.



---

archive/issue_comments_120885.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [rminer](#comment%3A10):\n> Replying to [jason](#comment%3A4):\n> > Replying to [rbeezer](#comment%3A2):\n> > \n> > > 6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.\n  \n> > \n> > \n> > I think MathJax includes the equivalent of our jsmath-image-fonts spkg.  If we added MathJax to Sage, it might be good to strip out the image fonts and distribute them separately as a mathjax-image-fonts spkg (mathjax faq tells how to do this, I believe).  Somewhere I have a half-finished prototype of this solution.\n\n> \n> Just in case you haven't thought of this, what Gollum (the [GitHub](GitHub) forum) folks did was host the MathJax fonts on Amazon S3, and then not include them in their distribution.  I don't know if that would work for you, but I wanted to point it out.\n\n\nThat's a very interesting solution.  I suppose we could host them on the main sage webserver, for example.  Or maybe Google Code or something like that so we had redundant sources.",
    "created_at": "2010-10-21T20:44:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120885",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:11'></a>
Replying to [rminer](#comment%3A10):
> Replying to [jason](#comment%3A4):
> > Replying to [rbeezer](#comment%3A2):
> > 
> > > 6.  `MathJax` is HUGE.  Fonts for lots of Unicode points, I guess.  SVN checkout is 53 MB, after unzipping  fonts.zip  it all occupies  171 MB.
  
> > 
> > 
> > I think MathJax includes the equivalent of our jsmath-image-fonts spkg.  If we added MathJax to Sage, it might be good to strip out the image fonts and distribute them separately as a mathjax-image-fonts spkg (mathjax faq tells how to do this, I believe).  Somewhere I have a half-finished prototype of this solution.

> 
> Just in case you haven't thought of this, what Gollum (the [GitHub](GitHub) forum) folks did was host the MathJax fonts on Amazon S3, and then not include them in their distribution.  I don't know if that would work for you, but I wanted to point it out.


That's a very interesting solution.  I suppose we could host them on the main sage webserver, for example.  Or maybe Google Code or something like that so we had redundant sources.



---

archive/issue_comments_120886.json:
```json
{
    "body": "<a id='comment:12'></a>\nI just found the web page [http://bitbucket.org/kevindunn/sphinx-extension-mathjax/wiki/Home](http://bitbucket.org/kevindunn/sphinx-extension-mathjax/wiki/Home), which allows the use of Sphinx with MathJax.  Assuming it works, we could upgrade all of Sage (not just the notebook but also the docs), to use MathJax instead of jsMath.",
    "created_at": "2010-11-10T22:11:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120886",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:12'></a>
I just found the web page [http://bitbucket.org/kevindunn/sphinx-extension-mathjax/wiki/Home](http://bitbucket.org/kevindunn/sphinx-extension-mathjax/wiki/Home), which allows the use of Sphinx with MathJax.  Assuming it works, we could upgrade all of Sage (not just the notebook but also the docs), to use MathJax instead of jsMath.



---

archive/issue_comments_120887.json:
```json
{
    "body": "<a id='comment:13'></a>\n[MathJax](http://www.mathjax.org/) is very impressive looking. I like the idea the user does not have to have any fonts installed on his computer, which is a major advantage over [jsMath](http://www.math.union.edu/~dpvc/jsMath/)\n\nDave",
    "created_at": "2011-03-02T20:26:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120887",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:13'></a>
[MathJax](http://www.mathjax.org/) is very impressive looking. I like the idea the user does not have to have any fonts installed on his computer, which is a major advantage over [jsMath](http://www.math.union.edu/~dpvc/jsMath/)

Dave



---

archive/issue_comments_120888.json:
```json
{
    "body": "Screenshot of double integral",
    "created_at": "2011-03-22T22:49:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120888",
    "user": "https://github.com/rbeezer"
}
```

Screenshot of double integral



---

archive/issue_comments_120889.json:
```json
{
    "body": "Attachment [mathjax-matrix-20110322.png](tarball://root/attachments/some-uuid/ticket9774/mathjax-matrix-20110322.png) by @rbeezer created at 2011-03-22 22:49:31\n\nScreenshot of matrix",
    "created_at": "2011-03-22T22:49:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120889",
    "user": "https://github.com/rbeezer"
}
```

Attachment [mathjax-matrix-20110322.png](tarball://root/attachments/some-uuid/ticket9774/mathjax-matrix-20110322.png) by @rbeezer created at 2011-03-22 22:49:31

Screenshot of matrix



---

archive/issue_comments_120890.json:
```json
{
    "body": "<a id='comment:14'></a>\nSteps that will install `MathJax` with the new Flask notebook.  \n\n1. Install the Flask version of the notebook.\n   {{{\n   http://code.google.com/r/rkirov-flask/\n   }}}\n\n2. Download v1.1 of `MathJax` as zip file (from bottom of page).\n   {{{\n   http://www.mathjax.org/download/\n   }}}\n\n3.  Unzip the MathJax distribution into\n\n   $SAGE_ROOT/devel/sagenb/sagenb/data\n\n   and\n\n   rename the new directory: `mathjax-MathJax-5a7e4d7` (or whatever)\n\n   to be just the directory:  `MathJax`\n\n4.  jsmath compatibility.  Edit\n   {{{\n   $SAGE_ROOT/devel/sagenb/sagenb/data/MathJax/config/default.js\n   }}}\n   by adding \"`jsMath2jax.js`\" as the first entry of the \"extensions\" list, so it becomes\n   {{{\n   extensions: [\"jsMath2jax.js\", \"tex2jax.js\"]\n   }}}\n\n5. Edit\n   {{{\n   $SAGE_ROOT/devel/sagenb/sagenb/data/sage/html/notebook/base.html\n   }}}\n   and change\n   {{{\n   <script type=\"text/javascript\" src=\"/javascript/sage/jsmath.js\"></script>\n   }}}\n   to\n   {{{\n   <script type=\"text/javascript\" src=\"/static/MathJax/MathJax.js?config=default\"></script>\n   }}}\n\n\nThis will install `MathJax` and the notebook will use it.  But the setup is buggy, so needs work.  I'm sure there is some configuration on the Sage side and/or the `MathJax` side that will need changes.\n\n* A mix of black and green symbols.\n\n* Only renders on a reload - adding new TeX via TinyMCE returns with an error about not finding fonts.\n\n* Some stray tags are being rendered, or something.\n\nScreenshots attached:\n\nDouble Integral:\n\nhttp://wiki.math.toronto.edu/TorontoMathWiki/index.php/JsMath/MathJax_%28TeX_for_Web%29\n\n```\n$$ (2\\pi h)^{-d}\\iint_{\\{H(x,\\xi) <\\tau\\}} dx d\\xi $$\n```\n\nMatrix:\n\n```\n$\\begin{bmatrix}\nx^2 & y^2\\\\\nx^3 & \\cos(z)\n\\end{bmatrix}$\n```",
    "created_at": "2011-03-22T22:53:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120890",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:14'></a>
Steps that will install `MathJax` with the new Flask notebook.  

1. Install the Flask version of the notebook.
   {{{
   http://code.google.com/r/rkirov-flask/
   }}}

2. Download v1.1 of `MathJax` as zip file (from bottom of page).
   {{{
   http://www.mathjax.org/download/
   }}}

3.  Unzip the MathJax distribution into

   $SAGE_ROOT/devel/sagenb/sagenb/data

   and

   rename the new directory: `mathjax-MathJax-5a7e4d7` (or whatever)

   to be just the directory:  `MathJax`

4.  jsmath compatibility.  Edit
   {{{
   $SAGE_ROOT/devel/sagenb/sagenb/data/MathJax/config/default.js
   }}}
   by adding "`jsMath2jax.js`" as the first entry of the "extensions" list, so it becomes
   {{{
   extensions: ["jsMath2jax.js", "tex2jax.js"]
   }}}

5. Edit
   {{{
   $SAGE_ROOT/devel/sagenb/sagenb/data/sage/html/notebook/base.html
   }}}
   and change
   {{{
   <script type="text/javascript" src="/javascript/sage/jsmath.js"></script>
   }}}
   to
   {{{
   <script type="text/javascript" src="/static/MathJax/MathJax.js?config=default"></script>
   }}}


This will install `MathJax` and the notebook will use it.  But the setup is buggy, so needs work.  I'm sure there is some configuration on the Sage side and/or the `MathJax` side that will need changes.

* A mix of black and green symbols.

* Only renders on a reload - adding new TeX via TinyMCE returns with an error about not finding fonts.

* Some stray tags are being rendered, or something.

Screenshots attached:

Double Integral:

http://wiki.math.toronto.edu/TorontoMathWiki/index.php/JsMath/MathJax_%28TeX_for_Web%29

```
$$ (2\pi h)^{-d}\iint_{\{H(x,\xi) <\tau\}} dx d\xi $$
```

Matrix:

```
$\begin{bmatrix}
x^2 & y^2\\
x^3 & \cos(z)
\end{bmatrix}$
```



---

archive/issue_comments_120891.json:
```json
{
    "body": "<a id='comment:16'></a>\nI'm attaching a draft of a patch for the Sage library.  The integration with Sphinx is completely untested, and is probably broken.  See the top of the patch file for a list of things to do.",
    "created_at": "2011-06-14T22:04:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120891",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>
I'm attaching a draft of a patch for the Sage library.  The integration with Sphinx is completely untested, and is probably broken.  See the top of the patch file for a list of things to do.



---

archive/issue_comments_120892.json:
```json
{
    "body": "Attachment [trac_9774-mathjax-flask-notebook.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-notebook.patch) by @rbeezer created at 2011-06-16 03:25:09",
    "created_at": "2011-06-16T03:25:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120892",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_9774-mathjax-flask-notebook.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-notebook.patch) by @rbeezer created at 2011-06-16 03:25:09



---

archive/issue_comments_120893.json:
```json
{
    "body": "<a id='comment:17'></a>\nAdded patch to Flask notebook code to support `MathJax`, built with Davide Cervone's help.\n\n1.  This is a hand-edited patch to recover from an hg mess-up.  I think it is OK, but be wary.\n2.  Fonts are coming from `MathJax` CDN.  Comment in code indicates change for local `MathJax` installation.\n3.  `<script>` tags added by Palmieri's Sage library patch need to be handled with care on notebook side, so notebook does not evaluate them.  Right now when \"Typeset\" box is checked, evaluated cells raise a Javascript error in `evaluate_script_tags` (or a function with a similar name).",
    "created_at": "2011-06-16T03:35:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120893",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:17'></a>
Added patch to Flask notebook code to support `MathJax`, built with Davide Cervone's help.

1.  This is a hand-edited patch to recover from an hg mess-up.  I think it is OK, but be wary.
2.  Fonts are coming from `MathJax` CDN.  Comment in code indicates change for local `MathJax` installation.
3.  `<script>` tags added by Palmieri's Sage library patch need to be handled with care on notebook side, so notebook does not evaluate them.  Right now when "Typeset" box is checked, evaluated cells raise a Javascript error in `evaluate_script_tags` (or a function with a similar name).



---

archive/issue_comments_120894.json:
```json
{
    "body": "<a id='comment:18'></a>\nJohn's patch doesn't apply cleanly to stock 4.7; does it apply to the most recent alpha of 4.7.1?\n\n```\napplying mathjax.patch\npatching file sage/misc/latex.py\nHunk #15 succeeded at 1750 with fuzz 2 (offset 2 lines).\nHunk #23 FAILED at 2382\n1 out of 25 hunks FAILED -- saving rejects to file sage/misc/latex.py.rej\npatch failed, unable to continue (try -v)\npatch failed, rejects left in working dir\nerrors during apply, please fix and refresh mathjax.patch\n\n\n```",
    "created_at": "2011-06-16T04:15:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120894",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:18'></a>
John's patch doesn't apply cleanly to stock 4.7; does it apply to the most recent alpha of 4.7.1?

```
applying mathjax.patch
patching file sage/misc/latex.py
Hunk #15 succeeded at 1750 with fuzz 2 (offset 2 lines).
Hunk #23 FAILED at 2382
1 out of 25 hunks FAILED -- saving rejects to file sage/misc/latex.py.rej
patch failed, unable to continue (try -v)
patch failed, rejects left in working dir
errors during apply, please fix and refresh mathjax.patch


```



---

archive/issue_comments_120895.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [jason](#comment%3A18):\n> John's patch doesn't apply cleanly to stock 4.7; does it apply to the most recent alpha of 4.7.1?\n\n\nYes.\n\n```\nrob@tiger:/sage/dev/devel/sage$ ../../sage -version\n* Warning: this is a prerelease version, and it may be unstable.     *\nrob@tiger:/sage/dev/devel/sage$ hg qimport -P http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9774/mathjax.patch\nadding mathjax.patch to series file\napplying mathjax.patch\nnow at: mathjax.patch\n```\n| Sage Version 4.7.1.alpha2, Release Date: 2011-06-07                |",
    "created_at": "2011-06-16T05:18:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120895",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:19'></a>
Replying to [jason](#comment%3A18):
> John's patch doesn't apply cleanly to stock 4.7; does it apply to the most recent alpha of 4.7.1?


Yes.

```
rob@tiger:/sage/dev/devel/sage$ ../../sage -version
* Warning: this is a prerelease version, and it may be unstable.     *
rob@tiger:/sage/dev/devel/sage$ hg qimport -P http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9774/mathjax.patch
adding mathjax.patch to series file
applying mathjax.patch
now at: mathjax.patch
```
| Sage Version 4.7.1.alpha2, Release Date: 2011-06-07                |



---

archive/issue_comments_120896.json:
```json
{
    "body": "<a id='comment:20'></a>\nDon't we need the actual MathJax spkg or files somewhere?  Rob: do you have instructions for putting these in the directory, or do we use my half-finished patch mentioned in the description, or something else?",
    "created_at": "2011-06-16T05:29:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120896",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:20'></a>
Don't we need the actual MathJax spkg or files somewhere?  Rob: do you have instructions for putting these in the directory, or do we use my half-finished patch mentioned in the description, or something else?



---

archive/issue_comments_120897.json:
```json
{
    "body": "Attachment [trac_9774-mathjax-flask-notebook-file-add.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-notebook-file-add.patch) by @rbeezer created at 2011-06-16 05:30:09",
    "created_at": "2011-06-16T05:30:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120897",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_9774-mathjax-flask-notebook-file-add.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-notebook-file-add.patch) by @rbeezer created at 2011-06-16 05:30:09



---

archive/issue_comments_120898.json:
```json
{
    "body": "<a id='comment:21'></a>\nAttached a patch to add `sagenb/notebook/mathjax.py`\n\nNew file is similar to, but not identical to, `sagenb/notebook/jsmath.py`\n\nWe did not delete the latter, but I think it can safely go away.",
    "created_at": "2011-06-16T05:33:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120898",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:21'></a>
Attached a patch to add `sagenb/notebook/mathjax.py`

New file is similar to, but not identical to, `sagenb/notebook/jsmath.py`

We did not delete the latter, but I think it can safely go away.



---

archive/issue_comments_120899.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [jason](#comment%3A20):\n> Don't we need the actual MathJax spkg or files somewhere?  Rob: do you have instructions for putting these in the directory, or do we use my half-finished patch mentioned in the description, or something else?\n\n\nWe need an spkg to be Internet-independent.  \n\nWe did not experiment with your old one.  I think it would be best to make a new one.  This requires a small edit (once you are sure all works with CDN version).\n\nFont suggestions coming up.",
    "created_at": "2011-06-16T05:35:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120899",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:22'></a>
Replying to [jason](#comment%3A20):
> Don't we need the actual MathJax spkg or files somewhere?  Rob: do you have instructions for putting these in the directory, or do we use my half-finished patch mentioned in the description, or something else?


We need an spkg to be Internet-independent.  

We did not experiment with your old one.  I think it would be best to make a new one.  This requires a small edit (once you are sure all works with CDN version).

Font suggestions coming up.



---

archive/issue_comments_120900.json:
```json
{
    "body": "<a id='comment:23'></a>\nDavide Cervone says for an spkg we need only keep font subdirectories called\n\n```\notf,  eot,  svg\n```\n\nIn particular `png` subdirectories are huge-est and can go away.\n\nRob",
    "created_at": "2011-06-16T05:45:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120900",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:23'></a>
Davide Cervone says for an spkg we need only keep font subdirectories called

```
otf,  eot,  svg
```

In particular `png` subdirectories are huge-est and can go away.

Rob



---

archive/issue_comments_120901.json:
```json
{
    "body": "<a id='comment:24'></a>\nah; I bet it's because the svg fonts replace the png fonts for all browsers we care about, or something.  Okay, Davide is the final authority on what browsers support what...",
    "created_at": "2011-06-16T05:50:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120901",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:24'></a>
ah; I bet it's because the svg fonts replace the png fonts for all browsers we care about, or something.  Okay, Davide is the final authority on what browsers support what...



---

archive/issue_comments_120902.json:
```json
{
    "body": "<a id='comment:25'></a>\nI get an error from the line: `response = make_response(render_template('js/mathjax.js', theme_mathjax_macros=mathjax_macros))` in flask_version/base.py.  I see a jsmath.js template in `sagenb/data/sage/js/jsmath.js` template.  Is this another file that didn't get added to the patch?",
    "created_at": "2011-06-16T06:01:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120902",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:25'></a>
I get an error from the line: `response = make_response(render_template('js/mathjax.js', theme_mathjax_macros=mathjax_macros))` in flask_version/base.py.  I see a jsmath.js template in `sagenb/data/sage/js/jsmath.js` template.  Is this another file that didn't get added to the patch?



---

archive/issue_comments_120903.json:
```json
{
    "body": "Attachment [trac_9774-mathjax-flask-notebook-file-add-two.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-notebook-file-add-two.patch) by @rbeezer created at 2011-06-16 06:33:03",
    "created_at": "2011-06-16T06:33:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120903",
    "user": "https://github.com/rbeezer"
}
```

Attachment [trac_9774-mathjax-flask-notebook-file-add-two.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-notebook-file-add-two.patch) by @rbeezer created at 2011-06-16 06:33:03



---

archive/issue_comments_120904.json:
```json
{
    "body": "<a id='comment:26'></a>\nReplying to [jason](#comment%3A25):\n> Is this another file that didn't get added to the patch?\n\n\nYes, same situation - \"old\" file could be removed.\n\n\"file-add-two\" should create the missing file.  Sorry about all the problems - my `hg status` is useless with the hg mess-up.\n\nThis file will require an edit when we move from CDN to spkg.\n\nThank-you!!!!!!!!!!!!!!",
    "created_at": "2011-06-16T06:35:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120904",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:26'></a>
Replying to [jason](#comment%3A25):
> Is this another file that didn't get added to the patch?


Yes, same situation - "old" file could be removed.

"file-add-two" should create the missing file.  Sorry about all the problems - my `hg status` is useless with the hg mess-up.

This file will require an edit when we move from CDN to spkg.

Thank-you!!!!!!!!!!!!!!



---

archive/issue_comments_120905.json:
```json
{
    "body": "<a id='comment:27'></a>\nI have a working version, but there still seems to be something slightly different about Typeset mode compared to before. I'm posting my patch, but there is still *lots* of debugging stuff in the patch that should be taken out before a final version is posted.",
    "created_at": "2011-06-16T09:07:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120905",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:27'></a>
I have a working version, but there still seems to be something slightly different about Typeset mode compared to before. I'm posting my patch, but there is still *lots* of debugging stuff in the patch that should be taken out before a final version is posted.



---

archive/issue_comments_120906.json:
```json
{
    "body": "apply to sagenb repository; apply on top of previous patches",
    "created_at": "2011-06-16T09:08:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120906",
    "user": "https://github.com/jasongrout"
}
```

apply to sagenb repository; apply on top of previous patches



---

archive/issue_comments_120907.json:
```json
{
    "body": "<a id='comment:28'></a>\nAttachment [trac_9774-mathjax-flask-eval-script.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-eval-script.patch) by @rbeezer created at 2011-06-17 17:37:44\n\nThe problem with the Sage notebook code intercepting (and evaluating) the contents of `<script>,</script>` tags can probably be rectified in one, or both, of the functions of the Flask notebook:\n\n```\nIn sagenb/data/sage/js/notebook_lib.js:\n\neval_script_tags\nseparate_script_tags\n```",
    "created_at": "2011-06-17T17:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120907",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:28'></a>
Attachment [trac_9774-mathjax-flask-eval-script.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-flask-eval-script.patch) by @rbeezer created at 2011-06-17 17:37:44

The problem with the Sage notebook code intercepting (and evaluating) the contents of `<script>,</script>` tags can probably be rectified in one, or both, of the functions of the Flask notebook:

```
In sagenb/data/sage/js/notebook_lib.js:

eval_script_tags
separate_script_tags
```



---

archive/issue_comments_120908.json:
```json
{
    "body": "<a id='comment:29'></a>\nrbeezer: yes, that's what my patch does.  The current remaining problem is something different.",
    "created_at": "2011-06-17T19:38:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120908",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:29'></a>
rbeezer: yes, that's what my patch does.  The current remaining problem is something different.



---

archive/issue_comments_120909.json:
```json
{
    "body": "<a id='comment:30'></a>\nIn the current version of [attachment:mathjax.patch], look at the top of the file for some unfinished business.  For example, the pathname at the end of doc/common/themes/sage/static/mathjax_sage.js_t might be wrong, which might break MathJax in the Sphinx documentation.",
    "created_at": "2011-06-20T18:55:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120909",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:30'></a>
In the current version of [attachment:mathjax.patch], look at the top of the file for some unfinished business.  For example, the pathname at the end of doc/common/themes/sage/static/mathjax_sage.js_t might be wrong, which might break MathJax in the Sphinx documentation.



---

archive/issue_comments_120910.json:
```json
{
    "body": "<a id='comment:31'></a>\nIn the current state, the --mathjax  switch seems to work with a build of the html version of the reference manual.\n\nMathematics in the documentation is being wrapped with `\\(, \\)` pairs, which are the default MathJax delimiters for inline mathematics.  However these snippets are not being rendered when viewed in a browser.\n\nIn the page source of a page of the html documentation, I see a script in a file named `mathjax_sage.js` which we are not generating.  We do have `jsmath_sage.js` lying about in the doc directories, which have the full jsmath configuration information.  So this likely needs repair before an HTML documentation page with MathJax support is built properly.",
    "created_at": "2011-06-20T19:23:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120910",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:31'></a>
In the current state, the --mathjax  switch seems to work with a build of the html version of the reference manual.

Mathematics in the documentation is being wrapped with `\(, \)` pairs, which are the default MathJax delimiters for inline mathematics.  However these snippets are not being rendered when viewed in a browser.

In the page source of a page of the html documentation, I see a script in a file named `mathjax_sage.js` which we are not generating.  We do have `jsmath_sage.js` lying about in the doc directories, which have the full jsmath configuration information.  So this likely needs repair before an HTML documentation page with MathJax support is built properly.



---

archive/issue_comments_120911.json:
```json
{
    "body": "<a id='comment:32'></a>\nOK, I can force `mathjax_sage.js` to be created by totally trashing some of the documentation output with\n\n```\ndevel/sage/doc/output/html$ rm -rf en\n```\n\nbefore rebuilding the HTML reference documentation. It comes from a template file `mathjax_sage.js_t` that one of the patches creates properly.\n\nMathematics still does not render, but I think the MathJax configuration is looking locally.  Time for a local MathJax install, I think.",
    "created_at": "2011-06-20T21:29:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120911",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:32'></a>
OK, I can force `mathjax_sage.js` to be created by totally trashing some of the documentation output with

```
devel/sage/doc/output/html$ rm -rf en
```

before rebuilding the HTML reference documentation. It comes from a template file `mathjax_sage.js_t` that one of the patches creates properly.

Mathematics still does not render, but I think the MathJax configuration is looking locally.  Time for a local MathJax install, I think.



---

archive/issue_comments_120912.json:
```json
{
    "body": "<a id='comment:33'></a>\nIn a page of the documentation, I inserted manually\n\n```\n<script type=\"text/javascript\" src=\"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full\">\n```\n\nand the mathematics rendered properly with MathJax.\n\nThen I installed the mathjax 1.1a distribution alongside jsmath in the Flask notebook tree and used\n\n```\n<script type=\"text/javascript\" src=\"http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full\">\n```\n\nwhich also caused the math to render properly.  (/sage/notebook is my `SAGE_ROOT`)\n\nIn both cases the fonts did not look too great to my eye.\n\nQuestions:\n\n(a) How do we get these scripts commands to be placed properly in each page of the docs, with a proper relative path?\n\n(b) Is there really a clean separation between Sage and the notebook if  --mathjax  mode for documentation requires the MathJax code from the notebook?",
    "created_at": "2011-06-20T23:50:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120912",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:33'></a>
In a page of the documentation, I inserted manually

```
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full">
```

and the mathematics rendered properly with MathJax.

Then I installed the mathjax 1.1a distribution alongside jsmath in the Flask notebook tree and used

```
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full">
```

which also caused the math to render properly.  (/sage/notebook is my `SAGE_ROOT`)

In both cases the fonts did not look too great to my eye.

Questions:

(a) How do we get these scripts commands to be placed properly in each page of the docs, with a proper relative path?

(b) Is there really a clean separation between Sage and the notebook if  --mathjax  mode for documentation requires the MathJax code from the notebook?



---

archive/issue_comments_120913.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [rbeezer](#comment%3A33):\n> Then I installed the mathjax 1.1a distribution alongside jsmath in the Flask notebook tree and \n\n\n> which also caused the math to render properly.  (/sage/notebook is my `SAGE_ROOT`)\n\n\nOops, the incantation for a local install of MathJax should have been\n\n```\n<script type=\"text/javascript\" src=\"/sage/notebook/devel/rkirov-flask/sagenb/data/mathjax/MathJax.js?config=TeX-AMS_HTML-full\"></script>\n```",
    "created_at": "2011-06-21T00:04:09Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120913",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:34'></a>
Replying to [rbeezer](#comment%3A33):
> Then I installed the mathjax 1.1a distribution alongside jsmath in the Flask notebook tree and 


> which also caused the math to render properly.  (/sage/notebook is my `SAGE_ROOT`)


Oops, the incantation for a local install of MathJax should have been

```
<script type="text/javascript" src="/sage/notebook/devel/rkirov-flask/sagenb/data/mathjax/MathJax.js?config=TeX-AMS_HTML-full"></script>
```



---

archive/issue_comments_120914.json:
```json
{
    "body": "<a id='comment:35'></a>\nHere's a new version of my patch.  With a locally installed version of MathJax, the documentation seems to render properly.  I don't know if this is the best solution, but at least it seems to work.\n\n(I installed MathJax by downloading a zip file: [https://github.com/mathjax/MathJax/zipball/v1.1a](https://github.com/mathjax/MathJax/zipball/v1.1a).  I unzipped it and renamed the resulting directory to `mathjax`, and moved it to `SAGE_ROOT/local/lib/python/site-packages/sagenb-0.9.0-py2.6.egg/sagenb/data/`, alongside of the old `jsmath` directory.  I also put a copy of the `mathjax` directory in `SAGE_ROOT/devel/sagenb/sagenb/data/`.  I haven't tried to install local fonts.)",
    "created_at": "2011-07-01T02:07:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120914",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:35'></a>
Here's a new version of my patch.  With a locally installed version of MathJax, the documentation seems to render properly.  I don't know if this is the best solution, but at least it seems to work.

(I installed MathJax by downloading a zip file: [https://github.com/mathjax/MathJax/zipball/v1.1a](https://github.com/mathjax/MathJax/zipball/v1.1a).  I unzipped it and renamed the resulting directory to `mathjax`, and moved it to `SAGE_ROOT/local/lib/python/site-packages/sagenb-0.9.0-py2.6.egg/sagenb/data/`, alongside of the old `jsmath` directory.  I also put a copy of the `mathjax` directory in `SAGE_ROOT/devel/sagenb/sagenb/data/`.  I haven't tried to install local fonts.)



---

archive/issue_comments_120915.json:
```json
{
    "body": "Attachment [mathjax.patch](tarball://root/attachments/some-uuid/ticket9774/mathjax.patch) by @jhpalmieri created at 2011-07-01 02:22:35\n\n(experimental) patch for Sage library",
    "created_at": "2011-07-01T02:22:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120915",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [mathjax.patch](tarball://root/attachments/some-uuid/ticket9774/mathjax.patch) by @jhpalmieri created at 2011-07-01 02:22:35

(experimental) patch for Sage library



---

archive/issue_comments_120916.json:
```json
{
    "body": "<a id='comment:36'></a>\nBy the way, one comment about the latest version of my patch: it fixes the problem Rob mentioned about getting the appropriate invocation to MathJax in each piece of documentation.  It does this by setting the variable `mathjax_path` to\n\n```\nfile://[path to MathJax.js]?config=TeX-AMS_HTML-full,file://[path to mathjax_sage.js]\n```\nThe paths here are absolute ones, in `SAGE_ROOT/devel/sage/doc/output/html/en/_static/`.  This directory is created by `sage -docbuild website html`, so now if you build the docs with the `-j` flag (to enable MathJax), it first builds the website target, then builds whatever you requested.  There might be a better way to do this, using relative paths, but I couldn't get it to work.    For example, using \n\n```\n    <script type=\"text/javascript\" src=\"_static/MathJax.js?config=TeX-AMS_HTML-full\"></script>\n```\nsuccessfully turns on MathJax, but without the local configuration turning on the custom macros.  Using\n\n```\n    <script type=\"text/javascript\" src=\"_static/MathJax.js?config=TeX-AMS_HTML-full,mathjax_sage.js\"></script>\n```\ndoesn't work, nor does any variation of it that I tried.  (Note that when you change the path specifying the local configuration file, you also need to change the last line of that configuration file to match it, according to [http://www.mathjax.org/docs/1.1/configuration.html](http://www.mathjax.org/docs/1.1/configuration.html).)  If we could copy the file `mathjax_sage.js` to `_static/config/local/`, then we could use \n\n```\n    <script type=\"text/javascript\" src=\"_static/MathJax.js?config=TeX-AMS_HTML-full,local/mathjax_sage.js\"></script>\n```\nfor the invocation, and \n\n```\nMathJax.Ajax.loadComplete(\"[MathJax]/config/local/mathjax_sage.js\")\n```\nfor the last line in mathjax_sage.js.  But I don't know how to put this file in the right place: it's autogenerated, so we can't put it in the MathJax local directory ahead of time, and I can't figure out how to get Sphinx to do it when it's building the documentation.\n\nAnother option would be to try to get Sphinx to write this into each html file:\n\n```\n<script type=\"text/x-mathjax-config\">\n[contents of mathjax_sage.js]\n</script>\n<script type=\"text/javascript\" src=\"_static/MathJax.js?config=TeX-AMS_HTML-full\"></script>\n```\nWe can get the last line by specifing mathjax_path in conf.py, but I don't know how to get the first part.\n\nI'll keep working on it...",
    "created_at": "2011-07-01T03:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120916",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:36'></a>
By the way, one comment about the latest version of my patch: it fixes the problem Rob mentioned about getting the appropriate invocation to MathJax in each piece of documentation.  It does this by setting the variable `mathjax_path` to

```
file://[path to MathJax.js]?config=TeX-AMS_HTML-full,file://[path to mathjax_sage.js]
```
The paths here are absolute ones, in `SAGE_ROOT/devel/sage/doc/output/html/en/_static/`.  This directory is created by `sage -docbuild website html`, so now if you build the docs with the `-j` flag (to enable MathJax), it first builds the website target, then builds whatever you requested.  There might be a better way to do this, using relative paths, but I couldn't get it to work.    For example, using 

```
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full"></script>
```
successfully turns on MathJax, but without the local configuration turning on the custom macros.  Using

```
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,mathjax_sage.js"></script>
```
doesn't work, nor does any variation of it that I tried.  (Note that when you change the path specifying the local configuration file, you also need to change the last line of that configuration file to match it, according to [http://www.mathjax.org/docs/1.1/configuration.html](http://www.mathjax.org/docs/1.1/configuration.html).)  If we could copy the file `mathjax_sage.js` to `_static/config/local/`, then we could use 

```
    <script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full,local/mathjax_sage.js"></script>
```
for the invocation, and 

```
MathJax.Ajax.loadComplete("[MathJax]/config/local/mathjax_sage.js")
```
for the last line in mathjax_sage.js.  But I don't know how to put this file in the right place: it's autogenerated, so we can't put it in the MathJax local directory ahead of time, and I can't figure out how to get Sphinx to do it when it's building the documentation.

Another option would be to try to get Sphinx to write this into each html file:

```
<script type="text/x-mathjax-config">
[contents of mathjax_sage.js]
</script>
<script type="text/javascript" src="_static/MathJax.js?config=TeX-AMS_HTML-full"></script>
```
We can get the last line by specifing mathjax_path in conf.py, but I don't know how to get the first part.

I'll keep working on it...



---

archive/issue_comments_120917.json:
```json
{
    "body": "<a id='comment:37'></a>\nHi John,\n\nAre you testing with the Flask notebook?  If not, it might be easier to build what look like absolute paths to the MathJax files in the data directory of the notebook, because of the way Flask sets up paths with the \"route()\" command?  I can't tell if this will solve the problem you are wrestling with or not.\n\nThe `<script>` tags were being messed with by the notebook on the server side just before being dispatched.  But then the client sees two versions - wrapped and unwrapped, and totally trashes one of them to prevent running a script twice.  I thought Jason had a patch for this too, but I haven't seen it.  The symptom would be when you cycle through wrap, no-wrap, and hide for some output, then one of them is missing.  I guess we can press on and fix this eventually.\n\nAbout to go off-line shortly for the long weekend, but will come back to this when I can stick with it.\n\nRob",
    "created_at": "2011-07-01T04:50:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120917",
    "user": "https://github.com/rbeezer"
}
```

<a id='comment:37'></a>
Hi John,

Are you testing with the Flask notebook?  If not, it might be easier to build what look like absolute paths to the MathJax files in the data directory of the notebook, because of the way Flask sets up paths with the "route()" command?  I can't tell if this will solve the problem you are wrestling with or not.

The `<script>` tags were being messed with by the notebook on the server side just before being dispatched.  But then the client sees two versions - wrapped and unwrapped, and totally trashes one of them to prevent running a script twice.  I thought Jason had a patch for this too, but I haven't seen it.  The symptom would be when you cycle through wrap, no-wrap, and hide for some output, then one of them is missing.  I guess we can press on and fix this eventually.

About to go off-line shortly for the long weekend, but will come back to this when I can stick with it.

Rob



---

archive/issue_comments_120918.json:
```json
{
    "body": "<a id='comment:38'></a>\nFor building the documentation, the notebook isn't relevant: they get built from the command line.  I think that when trying to make MathJax work with the notebook, we'll want to construct the URLs differently than I'm doing for the docs, but I don't know enough about the paths, etc., in the notebook to say exactly how to do it.  For what it's worth, though, I have been using the flask notebook.",
    "created_at": "2011-07-01T05:17:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120918",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:38'></a>
For building the documentation, the notebook isn't relevant: they get built from the command line.  I think that when trying to make MathJax work with the notebook, we'll want to construct the URLs differently than I'm doing for the docs, but I don't know enough about the paths, etc., in the notebook to say exactly how to do it.  For what it's worth, though, I have been using the flask notebook.



---

archive/issue_comments_120919.json:
```json
{
    "body": "<a id='comment:39'></a>\nI've uploaded my current flask patch queue here: http://sage.math.washington.edu/home/jason/mathjax-flask-patches.tar.gz  My current (probably non-working) patch queue for my sage library, including two mathjax patches, is here: \nhttp://sage.math.washington.edu/home/jason/mathjax-sage-patches.tar.gz\n\nThese are both works-in-progress, but currently stalled for at least a week or two.",
    "created_at": "2011-07-01T06:07:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120919",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:39'></a>
I've uploaded my current flask patch queue here: http://sage.math.washington.edu/home/jason/mathjax-flask-patches.tar.gz  My current (probably non-working) patch queue for my sage library, including two mathjax patches, is here: 
http://sage.math.washington.edu/home/jason/mathjax-sage-patches.tar.gz

These are both works-in-progress, but currently stalled for at least a week or two.



---

archive/issue_comments_120920.json:
```json
{
    "body": "<a id='comment:40'></a>\nI stalled working on it because of other time pressures with the single-cell, but also because I realized that the *next* version of Sphinx supports Mathjax out of the box, while I thought the current version would require patches.",
    "created_at": "2011-07-01T06:08:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120920",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:40'></a>
I stalled working on it because of other time pressures with the single-cell, but also because I realized that the *next* version of Sphinx supports Mathjax out of the box, while I thought the current version would require patches.



---

archive/issue_comments_120921.json:
```json
{
    "body": "<a id='comment:41'></a>\nI think that the implementation of MathJax in Sphinx comes from the file mathjax.py, which is available for download separately.  So my patch just adds it.\n\nI'm attaching another version (\"v2\") of my patch; this one writes the MathJax local configuration file to a file in `SAGE_ROOT/local/lib/python/site-libraries/sagenb.../`, which may not be a good idea.  But it allows for a simpler invocation of MathJax.  I'm really not sure which approach is better.",
    "created_at": "2011-07-01T06:12:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120921",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:41'></a>
I think that the implementation of MathJax in Sphinx comes from the file mathjax.py, which is available for download separately.  So my patch just adds it.

I'm attaching another version ("v2") of my patch; this one writes the MathJax local configuration file to a file in `SAGE_ROOT/local/lib/python/site-libraries/sagenb.../`, which may not be a good idea.  But it allows for a simpler invocation of MathJax.  I'm really not sure which approach is better.



---

archive/issue_comments_120922.json:
```json
{
    "body": "Attachment [mathjax.v2.patch](tarball://root/attachments/some-uuid/ticket9774/mathjax.v2.patch) by @jhpalmieri created at 2011-07-01 06:12:32\n\n(experimental) patch for Sage library, alternate version",
    "created_at": "2011-07-01T06:12:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120922",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [mathjax.v2.patch](tarball://root/attachments/some-uuid/ticket9774/mathjax.v2.patch) by @jhpalmieri created at 2011-07-01 06:12:32

(experimental) patch for Sage library, alternate version



---

archive/issue_comments_120923.json:
```json
{
    "body": "<a id='comment:42'></a>\nWhat is the current status on this now?  Where should we start working on it again?",
    "created_at": "2012-01-09T20:13:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120923",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:42'></a>
What is the current status on this now?  Where should we start working on it again?



---

archive/issue_comments_120924.json:
```json
{
    "body": "<a id='comment:43'></a>\nThe last patch involving MathJax, that I rebased from the ones here is on google code:\n\nhttp://code.google.com/p/sagenb/issues/detail?id=46\n\nUnless Jonathan Gutow did something else on top of it, this is latest work.",
    "created_at": "2012-01-10T03:43:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120924",
    "user": "https://trac.sagemath.org/admin/accounts/users/rkirov"
}
```

<a id='comment:43'></a>
The last patch involving MathJax, that I rebased from the ones here is on google code:

http://code.google.com/p/sagenb/issues/detail?id=46

Unless Jonathan Gutow did something else on top of it, this is latest work.



---

archive/issue_comments_120925.json:
```json
{
    "body": "Rebased version of comprehensive mathjax patch to 4.8.alpha4",
    "created_at": "2012-01-11T06:50:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120925",
    "user": "https://github.com/jasongrout"
}
```

Rebased version of comprehensive mathjax patch to 4.8.alpha4



---

archive/issue_comments_120926.json:
```json
{
    "body": "Attachment [mathjax-try2.patch](tarball://root/attachments/some-uuid/ticket9774/mathjax-try2.patch) by @jasongrout created at 2012-01-12 23:16:31\n\nApply only this patch",
    "created_at": "2012-01-12T23:16:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120926",
    "user": "https://github.com/jasongrout"
}
```

Attachment [mathjax-try2.patch](tarball://root/attachments/some-uuid/ticket9774/mathjax-try2.patch) by @jasongrout created at 2012-01-12 23:16:31

Apply only this patch



---

archive/issue_comments_120927.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,8 +2,5 @@\n \n This will also fix #1608\n \n-Jason Grout says:\n-\n-I have a half-finished patch up at http://sage.math.washington.edu/home/jason/sagenb-mathjax.patch.gz (gzipped because it's so big).\n-\n-I had a mathjax_imagefonts-1.0.spkg somewhere, but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.\n+**apply**: [attachment:mathjax-try2.patch]\n+This depends on the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax\n``````\n",
    "created_at": "2012-01-12T23:18:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120927",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,8 +2,5 @@
 
 This will also fix #1608
 
-Jason Grout says:
-
-I have a half-finished patch up at http://sage.math.washington.edu/home/jason/sagenb-mathjax.patch.gz (gzipped because it's so big).
-
-I had a mathjax_imagefonts-1.0.spkg somewhere, but I think I deleted it.  Sorry!  The mathjax patch above does not include the large fonts directory in mathjax (following [these](http://www.mathjax.org/resources/faqs/#fonts-too-big) instructions), which the mathjax_imagefonts spkg restores.
+**apply**: [attachment:mathjax-try2.patch]
+This depends on the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax
``````




---

archive/issue_events_029713.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2012-01-12T23:18:00Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29713"
}
```



---

archive/issue_comments_120928.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,4 +3,5 @@\n This will also fix #1608\n \n **apply**: [attachment:mathjax-try2.patch]\n+\n This depends on the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax\n``````\n",
    "created_at": "2012-01-12T23:18:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120928",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,4 +3,5 @@
 This will also fix #1608
 
 **apply**: [attachment:mathjax-try2.patch]
+
 This depends on the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax
``````




---

archive/issue_comments_120929.json:
```json
{
    "body": "Reviewer: Jason Grout",
    "created_at": "2012-01-13T21:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120929",
    "user": "https://github.com/jasongrout"
}
```

Reviewer: Jason Grout



---

archive/issue_comments_120930.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,8 @@\n \n This will also fix #1608\n \n-**apply**: [attachment:mathjax-try2.patch]\n+**apply**: [attachment:mathjax-try3.patch]\n \n-This depends on the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax\n+**spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg\n+\n+(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax\n``````\n",
    "created_at": "2012-01-13T21:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120930",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,8 @@
 
 This will also fix #1608
 
-**apply**: [attachment:mathjax-try2.patch]
+**apply**: [attachment:mathjax-try3.patch]
 
-This depends on the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax
+**spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg
+
+(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax
``````




---

archive/issue_comments_120931.json:
```json
{
    "body": "Author: Rob Beezer, Davide Cervone, John Palmieri, Jason Grout",
    "created_at": "2012-01-13T21:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120931",
    "user": "https://github.com/jasongrout"
}
```

Author: Rob Beezer, Davide Cervone, John Palmieri, Jason Grout



---

archive/issue_comments_120932.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-01-13T21:49:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120932",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120933.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,9 @@\n \n This will also fix #1608\n \n-**apply**: [attachment:mathjax-try3.patch]\n+**apply**: [attachment:mathjax-try3.patch] to the sage repository\n+\n+Also install the following spkg:\n \n **spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg\n \n``````\n",
    "created_at": "2012-01-13T21:50:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120933",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,9 @@
 
 This will also fix #1608
 
-**apply**: [attachment:mathjax-try3.patch]
+**apply**: [attachment:mathjax-try3.patch] to the sage repository
+
+Also install the following spkg:
 
 **spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg
 
``````




---

archive/issue_comments_120934.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -8,4 +8,4 @@\n \n **spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg\n \n-(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax\n+(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax; note that jmol won't work unless you also install the dependencies listed at #11080 for the new sage notebook).\n``````\n",
    "created_at": "2012-01-13T21:54:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120934",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -8,4 +8,4 @@
 
 **spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg
 
-(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax
+(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax; note that jmol won't work unless you also install the dependencies listed at #11080 for the new sage notebook).
``````




---

archive/issue_comments_120935.json:
```json
{
    "body": "Changing author from \"Rob Beezer, Davide Cervone, John Palmieri, Jason Grout\" to \"Rob Beezer, Davide Cervone, John Palmieri, Jason Grout, Nathan Carter\"",
    "created_at": "2012-01-13T22:28:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120935",
    "user": "https://github.com/jasongrout"
}
```

Changing author from "Rob Beezer, Davide Cervone, John Palmieri, Jason Grout" to "Rob Beezer, Davide Cervone, John Palmieri, Jason Grout, Nathan Carter"



---

archive/issue_comments_120936.json:
```json
{
    "body": "apply to **scripts** repository",
    "created_at": "2012-01-13T22:29:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120936",
    "user": "https://github.com/jasongrout"
}
```

apply to **scripts** repository



---

archive/issue_comments_120937.json:
```json
{
    "body": "Attachment [trac_9774-scripts-mathjax.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-scripts-mathjax.patch) by @jasongrout created at 2012-01-13 22:30:18\n\napply to **sage** repository",
    "created_at": "2012-01-13T22:30:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120937",
    "user": "https://github.com/jasongrout"
}
```

Attachment [trac_9774-scripts-mathjax.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-scripts-mathjax.patch) by @jasongrout created at 2012-01-13 22:30:18

apply to **sage** repository



---

archive/issue_comments_120938.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,7 +2,9 @@\n \n This will also fix #1608\n \n-**apply**: [attachment:mathjax-try3.patch] to the sage repository\n+**apply**: \n+* [attachment:trac_9774-scripts-mathjax.patch] to the sage repository\n+* [attachment:trac_9774-mathjax-try3.patch] to the scripts repository\n \n Also install the following spkg:\n \n``````\n",
    "created_at": "2012-01-13T22:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120938",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,7 +2,9 @@
 
 This will also fix #1608
 
-**apply**: [attachment:mathjax-try3.patch] to the sage repository
+**apply**: 
+* [attachment:trac_9774-scripts-mathjax.patch] to the sage repository
+* [attachment:trac_9774-mathjax-try3.patch] to the scripts repository
 
 Also install the following spkg:
 
``````




---

archive/issue_comments_120939.json:
```json
{
    "body": "<a id='comment:50'></a>\nAttachment [trac_9774-mathjax-try3.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try3.patch) by @jasongrout created at 2012-01-13 22:42:12",
    "created_at": "2012-01-13T22:42:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120939",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:50'></a>
Attachment [trac_9774-mathjax-try3.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try3.patch) by @jasongrout created at 2012-01-13 22:42:12



---

archive/issue_comments_120940.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,8 +3,8 @@\n This will also fix #1608\n \n **apply**: \n-* [attachment:trac_9774-scripts-mathjax.patch] to the sage repository\n-* [attachment:trac_9774-mathjax-try3.patch] to the scripts repository\n+* [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n+* [attachment:trac_9774-mathjax-try3.patch] to the sage library repository\n \n Also install the following spkg:\n \n``````\n",
    "created_at": "2012-01-14T11:28:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120940",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,8 +3,8 @@
 This will also fix #1608
 
 **apply**: 
-* [attachment:trac_9774-scripts-mathjax.patch] to the sage repository
-* [attachment:trac_9774-mathjax-try3.patch] to the scripts repository
+* [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
+* [attachment:trac_9774-mathjax-try3.patch] to the sage library repository
 
 Also install the following spkg:
 
``````




---

archive/issue_comments_120941.json:
```json
{
    "body": "<a id='comment:52'></a>\nI assume the description was incorrect, but even with the correction I made, [attachment:trac_9774-mathjax-try3.patch] does not apply cleanly on top of 4.8.alpha6. On 4.8.alpha4 (at least by `hg up 4.8.alpha4 && sage -b`) it fails a couple of doctests. Rebasing and fixing doctests now.",
    "created_at": "2012-01-14T11:28:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120941",
    "user": "https://github.com/kini"
}
```

<a id='comment:52'></a>
I assume the description was incorrect, but even with the correction I made, [attachment:trac_9774-mathjax-try3.patch] does not apply cleanly on top of 4.8.alpha6. On 4.8.alpha4 (at least by `hg up 4.8.alpha4 && sage -b`) it fails a couple of doctests. Rebasing and fixing doctests now.



---

archive/issue_comments_120942.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-01-14T11:28:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120942",
    "user": "https://github.com/kini"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120943.json:
```json
{
    "body": "<a id='comment:53'></a>\nWhoops, looks like \"a couple of doctests\" was an understatement. I guess it should be done in a separate patch. Here's the new patch, rebased only.",
    "created_at": "2012-01-14T11:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120943",
    "user": "https://github.com/kini"
}
```

<a id='comment:53'></a>
Whoops, looks like "a couple of doctests" was an understatement. I guess it should be done in a separate patch. Here's the new patch, rebased only.



---

archive/issue_comments_120944.json:
```json
{
    "body": "apply to $SAGE_ROOT/devel/sage",
    "created_at": "2012-01-14T11:59:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120944",
    "user": "https://github.com/kini"
}
```

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_120945.json:
```json
{
    "body": "<a id='comment:54'></a>\nAttachment [trac_9774-mathjax-try4.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try4.patch) by @jasongrout created at 2012-01-14 14:42:49\n\nThe try3 patches were against alpha4.  Late last night I patched 5.0.beta1, and realized there were some patch failures, which I fixed.  I'll compare your rebase with mine.\n\nI also realized last night during dinner that I hadn't run doctests, so those should be run on sage and sagenb.  Thanks for checking this.",
    "created_at": "2012-01-14T14:42:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120945",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:54'></a>
Attachment [trac_9774-mathjax-try4.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try4.patch) by @jasongrout created at 2012-01-14 14:42:49

The try3 patches were against alpha4.  Late last night I patched 5.0.beta1, and realized there were some patch failures, which I fixed.  I'll compare your rebase with mine.

I also realized last night during dinner that I hadn't run doctests, so those should be run on sage and sagenb.  Thanks for checking this.



---

archive/issue_comments_120946.json:
```json
{
    "body": "<a id='comment:55'></a>\nYou don't happen to have your changes as a separate patch on top of mine, do you?  I'd love to review your changes, but it's a bit hard to see where your additions are.\n\nIf you don't have it, I'll just diff the two patches, but that's a little harder to read than a separate patch.",
    "created_at": "2012-01-14T14:44:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120946",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:55'></a>
You don't happen to have your changes as a separate patch on top of mine, do you?  I'd love to review your changes, but it's a bit hard to see where your additions are.

If you don't have it, I'll just diff the two patches, but that's a little harder to read than a separate patch.



---

archive/issue_comments_120947.json:
```json
{
    "body": "<a id='comment:56'></a>\nI wonder if the reported problems with \"<\" and \">\" are due to line 1685 in latex.py:\n\n```\nx = x.replace('<', '&lt;').replace('>', '&gt;')\n```\nThis was put in for use with jsMath, but maybe MathJax doesn't have the same issues.",
    "created_at": "2012-01-14T18:11:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120947",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:56'></a>
I wonder if the reported problems with "<" and ">" are due to line 1685 in latex.py:

```
x = x.replace('<', '&lt;').replace('>', '&gt;')
```
This was put in for use with jsMath, but maybe MathJax doesn't have the same issues.



---

archive/issue_comments_120948.json:
```json
{
    "body": "<a id='comment:57'></a>\nIt was more complicated than that, but I've fixed it by getting rid of the math_parse function and conditional typesetting we were doing.  We've configured MathJax to make the math_parse function obsolete, and it's inconsistent to typeset only conditionally.  See https://github.com/jasongrout/sagenb/commit/6a4eed4d6baf78cd19fe634144c727843d1af08d and https://github.com/jasongrout/sagenb/commit/8d6b0a071c13850cea983faaa6b910be498cd0ae\n\n\n\nI've updated test.sagenb.org with the newest mathjax changes.",
    "created_at": "2012-01-14T18:15:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120948",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:57'></a>
It was more complicated than that, but I've fixed it by getting rid of the math_parse function and conditional typesetting we were doing.  We've configured MathJax to make the math_parse function obsolete, and it's inconsistent to typeset only conditionally.  See https://github.com/jasongrout/sagenb/commit/6a4eed4d6baf78cd19fe634144c727843d1af08d and https://github.com/jasongrout/sagenb/commit/8d6b0a071c13850cea983faaa6b910be498cd0ae



I've updated test.sagenb.org with the newest mathjax changes.



---

archive/issue_comments_120949.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [jason](#comment%3A55):\n> You don't happen to have your changes as a separate patch on top of mine, do you?  I'd love to review your changes, but it's a bit hard to see where your additions are.\n> \n> If you don't have it, I'll just diff the two patches, but that's a little harder to read than a separate patch.\n\n\nEr, no, I don't, unfortunately. You can get such a diff by doing `hg qfinish` on my patch on top of 4.8.alpha6, then `hg up 4.8.alpha4`, then `hg qimport -P [your patch]`, then `hg diff -r tip -r [revid of my patch]` (you would probably want to `hg strip [revid of my patch]` later).\n\nBut I don't see how that's very useful to you since it will be some gigantic patch subsuming everything that was merged in alpha5 and alpha6. In your position I would just diff the two patches, but maybe I don't understand what you're asking for. If you just want diffs for the files touched by the patch, that would also be possible, but maybe a bit messier. Do as above, except also qfinish your patch, and then merge the two qfinished patches' commits into a new commit, with your patch as the primary parent. Then do `hg log -r [the merge commit] -p [the file names]`. (I think that should work.) Or I guess you could just make the gigantic patch and ignore the parts that are on irrelevant files.",
    "created_at": "2012-01-15T07:03:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120949",
    "user": "https://github.com/kini"
}
```

<a id='comment:58'></a>
Replying to [jason](#comment%3A55):
> You don't happen to have your changes as a separate patch on top of mine, do you?  I'd love to review your changes, but it's a bit hard to see where your additions are.
> 
> If you don't have it, I'll just diff the two patches, but that's a little harder to read than a separate patch.


Er, no, I don't, unfortunately. You can get such a diff by doing `hg qfinish` on my patch on top of 4.8.alpha6, then `hg up 4.8.alpha4`, then `hg qimport -P [your patch]`, then `hg diff -r tip -r [revid of my patch]` (you would probably want to `hg strip [revid of my patch]` later).

But I don't see how that's very useful to you since it will be some gigantic patch subsuming everything that was merged in alpha5 and alpha6. In your position I would just diff the two patches, but maybe I don't understand what you're asking for. If you just want diffs for the files touched by the patch, that would also be possible, but maybe a bit messier. Do as above, except also qfinish your patch, and then merge the two qfinished patches' commits into a new commit, with your patch as the primary parent. Then do `hg log -r [the merge commit] -p [the file names]`. (I think that should work.) Or I guess you could just make the gigantic patch and ignore the parts that are on irrelevant files.



---

archive/issue_comments_120950.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n **apply**: \n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n-* [attachment:trac_9774-mathjax-try3.patch] to the sage library repository\n+* [attachment:trac_9774-mathjax-try4.patch] to the sage library repository\n \n Also install the following spkg:\n \n``````\n",
    "created_at": "2012-01-16T22:07:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120950",
    "user": "https://github.com/jasongrout"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 **apply**: 
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
-* [attachment:trac_9774-mathjax-try3.patch] to the sage library repository
+* [attachment:trac_9774-mathjax-try4.patch] to the sage library repository
 
 Also install the following spkg:
 
``````




---

archive/issue_comments_120951.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-01-16T22:07:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120951",
    "user": "https://github.com/jasongrout"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120952.json:
```json
{
    "body": "<a id='comment:59'></a>\nkini: your try4 patch looks fine to me.  It applies cleanly on 5.0.some_version_of_prealpha1_or_beta1",
    "created_at": "2012-01-16T22:07:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120952",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:59'></a>
kini: your try4 patch looks fine to me.  It applies cleanly on 5.0.some_version_of_prealpha1_or_beta1



---

archive/issue_comments_120953.json:
```json
{
    "body": "<a id='comment:60'></a>\nI seem to have a broken install here (2nd try). I followed this sequence of steps to install mathjax + jmol (output of `history` in zsh).\n\n```\n  663  local/bin\n  664  ../../sage -hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9774/trac_9774-scripts-mathjax.patch\n  ***  ../../sage -hg qpush  # This line is missing because of my zsh setup\n  666  ../../\n  667  l\n  668  cd devel/sage\n  669  ../../sage -hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9774/trac_9774-mathjax-try4.patch\n  670  ../../sage -hg qpush\n  671  ../../sage -b\n  672  ../..\n  674  ./sage -f http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg\n  675  ./sage -f http://sage.math.washington.edu/home/jason/jmol/jmol-12.0.45.p4.spkg\n  676  ./sage -b\n  678  ./sage -n\n  679  BROWSER=\"firefox\" ./sage -n\n```\nMathjax is broken and so is jmol. Do I need to install something extra for mathjax + jmol to work? These steps were followed on a freshly compiled sage-4.8. Screenshot: http://i.imgur.com/A6wrQ.png",
    "created_at": "2012-02-06T13:32:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120953",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:60'></a>
I seem to have a broken install here (2nd try). I followed this sequence of steps to install mathjax + jmol (output of `history` in zsh).

```
  663  local/bin
  664  ../../sage -hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9774/trac_9774-scripts-mathjax.patch
  ***  ../../sage -hg qpush  # This line is missing because of my zsh setup
  666  ../../
  667  l
  668  cd devel/sage
  669  ../../sage -hg qimport http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9774/trac_9774-mathjax-try4.patch
  670  ../../sage -hg qpush
  671  ../../sage -b
  672  ../..
  674  ./sage -f http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg
  675  ./sage -f http://sage.math.washington.edu/home/jason/jmol/jmol-12.0.45.p4.spkg
  676  ./sage -b
  678  ./sage -n
  679  BROWSER="firefox" ./sage -n
```
Mathjax is broken and so is jmol. Do I need to install something extra for mathjax + jmol to work? These steps were followed on a freshly compiled sage-4.8. Screenshot: http://i.imgur.com/A6wrQ.png



---

archive/issue_comments_120954.json:
```json
{
    "body": "<a id='comment:61'></a>\nI only tested it on a 5.0 beta.  I see that #11080 isn't explicitly listed as a dependency (though it is mentioned in the description).\n\nSo please follow the directions on #11080 first (which involves a lot more patches).  My guess is that things won't apply cleanly to 4.8, and you'll need a 5.0 beta.",
    "created_at": "2012-02-06T13:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120954",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:61'></a>
I only tested it on a 5.0 beta.  I see that #11080 isn't explicitly listed as a dependency (though it is mentioned in the description).

So please follow the directions on #11080 first (which involves a lot more patches).  My guess is that things won't apply cleanly to 4.8, and you'll need a 5.0 beta.



---

archive/issue_comments_120955.json:
```json
{
    "body": "Dependencies: #11080",
    "created_at": "2012-02-06T13:39:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120955",
    "user": "https://github.com/jasongrout"
}
```

Dependencies: #11080



---

archive/issue_comments_120956.json:
```json
{
    "body": "<a id='comment:62'></a>\nAnd thanks for looking at this!  This ticket is also live at test.sagenb.org.",
    "created_at": "2012-02-06T13:40:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120956",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:62'></a>
And thanks for looking at this!  This ticket is also live at test.sagenb.org.



---

archive/issue_comments_120957.json:
```json
{
    "body": "<a id='comment:63'></a>\nThere seems to be some problem with mathjax rendering with `LatexExpr`. Compare the jsmath rendering here: http://sagenb.org/home/pub/4337/ to the mathjax here: http://test.sagenb.org/home/pub/19/",
    "created_at": "2012-02-19T15:38:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120957",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:63'></a>
There seems to be some problem with mathjax rendering with `LatexExpr`. Compare the jsmath rendering here: http://sagenb.org/home/pub/4337/ to the mathjax here: http://test.sagenb.org/home/pub/19/



---

archive/issue_comments_120958.json:
```json
{
    "body": "<a id='comment:64'></a>\nSome doctest failures with this patch:\n\n```\n...sage-5.0.beta2/devel/sage> ../../sage -t sage/misc/latex.py \nsage -t  \"devel/sage-main-backup/sage/misc/latex.py\"        \n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-5.0.beta2/devel/sage-main-backup/sage/misc/latex.py\", line 1765:\n    sage: MathJax().eval(type(3), mode='inline')\nExpected:\n    <html><script type=\"math/tex\">\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\hbox{ < type 'sage.rings.integer.Integer' > }</script></html>\nGot:\n    <html><script type=\"math/tex\">\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb|&lt;type|\\phantom{\\verb!x!}\\verb|'sage.rings.integer.Integer'&gt;|</script></html>\n**********************************************************************\nFile \"/home/punarbasu/Installations/sage-5.0.beta2/devel/sage-main-backup/sage/misc/latex.py\", line 2199:\n    sage: sys.displayhook\nExpected:\n    <html>...\\verb|&lt;function|\\phantom{x}\\verb|pretty_print|...</html>\nGot:\n    <html><script type=\"math/tex\">\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\verb|&lt;function|\\phantom{\\verb!x!}\\verb|pretty_print|\\phantom{\\verb!x!}\\verb|at|\\phantom{\\verb!x!}\\verb|0x150b050&gt;|</script></html>\n**********************************************************************\n2 items had failures:\n   1 of   7 in __main__.example_52\n   1 of   7 in __main__.example_59\n***Test Failed*** 2 failures.\nFor whitespace errors, see the file /home/punarbasu/.sage//tmp/latex_7938.py\n\t [3.1 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n\tsage -t  \"devel/sage-main-backup/sage/misc/latex.py\"\nTotal time for all tests: 3.1 seconds\n```",
    "created_at": "2012-02-25T16:56:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120958",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:64'></a>
Some doctest failures with this patch:

```
...sage-5.0.beta2/devel/sage> ../../sage -t sage/misc/latex.py 
sage -t  "devel/sage-main-backup/sage/misc/latex.py"        
**********************************************************************
File "/home/punarbasu/Installations/sage-5.0.beta2/devel/sage-main-backup/sage/misc/latex.py", line 1765:
    sage: MathJax().eval(type(3), mode='inline')
Expected:
    <html><script type="math/tex">\newcommand{\Bold}[1]{\mathbf{#1}}\hbox{ < type 'sage.rings.integer.Integer' > }</script></html>
Got:
    <html><script type="math/tex">\newcommand{\Bold}[1]{\mathbf{#1}}\verb|&lt;type|\phantom{\verb!x!}\verb|'sage.rings.integer.Integer'&gt;|</script></html>
**********************************************************************
File "/home/punarbasu/Installations/sage-5.0.beta2/devel/sage-main-backup/sage/misc/latex.py", line 2199:
    sage: sys.displayhook
Expected:
    <html>...\verb|&lt;function|\phantom{x}\verb|pretty_print|...</html>
Got:
    <html><script type="math/tex">\newcommand{\Bold}[1]{\mathbf{#1}}\verb|&lt;function|\phantom{\verb!x!}\verb|pretty_print|\phantom{\verb!x!}\verb|at|\phantom{\verb!x!}\verb|0x150b050&gt;|</script></html>
**********************************************************************
2 items had failures:
   1 of   7 in __main__.example_52
   1 of   7 in __main__.example_59
***Test Failed*** 2 failures.
For whitespace errors, see the file /home/punarbasu/.sage//tmp/latex_7938.py
	 [3.1 s]
 
----------------------------------------------------------------------
The following tests failed:


	sage -t  "devel/sage-main-backup/sage/misc/latex.py"
Total time for all tests: 3.1 seconds
```



---

archive/issue_comments_120959.json:
```json
{
    "body": "Apply to devel/sage",
    "created_at": "2012-06-09T09:49:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120959",
    "user": "https://github.com/ppurka"
}
```

Apply to devel/sage



---

archive/issue_comments_120960.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2012-06-09T10:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120960",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_120961.json:
```json
{
    "body": "Work_Issues: does not work in DOT_SAGE",
    "created_at": "2012-06-09T10:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120961",
    "user": "https://github.com/ppurka"
}
```

Work_Issues: does not work in DOT_SAGE



---

archive/issue_comments_120962.json:
```json
{
    "body": "<a id='comment:65'></a>\nAttachment [trac_9774-mathjax-try5.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try5.patch) by @ppurka created at 2012-06-09 10:05:13\n\nrebased patch to sage-5.1beta2.\n\nThere is however a very weird problem with mathjax, both 1.0 and 2.0 branches. The math is not rendered as long as the sagenb directory is under `DOT_SAGE`. To reproduce, try the steps below. Use any branch (mathjax-1 or mathjax-2) for instance jasongrout/mathjax (mathjax-1) in github.\n1. `mkdir /tmp/a`\n2. `DOT_SAGE=/tmp/a sage -n`.\n3. First, note that the above command launches the nb in port 8000 instead of 8080. But if we use some other command such as the one below, then it does open in port 8080.\n\n```\nsage -n directory=/tmp/a.sagenb\n```\n4. Open a new worksheet, and try to print latex, for instance run the command `view('?')`. You will get a js error popup saying (in Opera 12.00RC, and Opera-11.64)\n\n```\nSyntaxError: at index 0 in \"\\newcommand{\\Bold}[1]{\\mathbf{#1}}?\": invalid character escape sequence\n```\n\nIn firefox-10.0.4 I simply get the error: `SyntaxError: illegal character`. This error is not present if I run sage instead as `sage -n directory=/tmp/a.sagenb`, and the mathjax output is all good.",
    "created_at": "2012-06-09T10:05:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120962",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:65'></a>
Attachment [trac_9774-mathjax-try5.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try5.patch) by @ppurka created at 2012-06-09 10:05:13

rebased patch to sage-5.1beta2.

There is however a very weird problem with mathjax, both 1.0 and 2.0 branches. The math is not rendered as long as the sagenb directory is under `DOT_SAGE`. To reproduce, try the steps below. Use any branch (mathjax-1 or mathjax-2) for instance jasongrout/mathjax (mathjax-1) in github.
1. `mkdir /tmp/a`
2. `DOT_SAGE=/tmp/a sage -n`.
3. First, note that the above command launches the nb in port 8000 instead of 8080. But if we use some other command such as the one below, then it does open in port 8080.

```
sage -n directory=/tmp/a.sagenb
```
4. Open a new worksheet, and try to print latex, for instance run the command `view('?')`. You will get a js error popup saying (in Opera 12.00RC, and Opera-11.64)

```
SyntaxError: at index 0 in "\newcommand{\Bold}[1]{\mathbf{#1}}?": invalid character escape sequence
```

In firefox-10.0.4 I simply get the error: `SyntaxError: illegal character`. This error is not present if I run sage instead as `sage -n directory=/tmp/a.sagenb`, and the mathjax output is all good.



---

archive/issue_comments_120963.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,7 +4,7 @@\n \n **apply**: \n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n-* [attachment:trac_9774-mathjax-try4.patch] to the sage library repository\n+* [attachment:trac_9774-mathjax-try5.patch] to the sage library repository\n \n Also install the following spkg:\n \n``````\n",
    "created_at": "2012-06-09T10:34:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120963",
    "user": "https://github.com/ppurka"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,7 +4,7 @@
 
 **apply**: 
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
-* [attachment:trac_9774-mathjax-try4.patch] to the sage library repository
+* [attachment:trac_9774-mathjax-try5.patch] to the sage library repository
 
 Also install the following spkg:
 
``````




---

archive/issue_comments_120964.json:
```json
{
    "body": "<a id='comment:67'></a>\nIt looks like Samuel Ainsworth has independently got MathJax working in his \"newui\" branch (I haven't tested it). At a glance it seems he's using the MathJax CDN.",
    "created_at": "2012-06-09T17:26:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120964",
    "user": "https://github.com/kini"
}
```

<a id='comment:67'></a>
It looks like Samuel Ainsworth has independently got MathJax working in his "newui" branch (I haven't tested it). At a glance it seems he's using the MathJax CDN.



---

archive/issue_comments_120965.json:
```json
{
    "body": "<a id='comment:68'></a>\nReplying to [kini](#comment%3A67):\n> It looks like Samuel Ainsworth has independently got MathJax working in his \"newui\" branch (I haven't tested it). At a glance it seems he's using the MathJax CDN.\n\n\nHas he applied the mathjax patches to the sage repo? Without those patches it won't work. And these patches were not applying for quite sometime. I just updated one today.\n\nThere are more changes to make actually. `SAGE_ROOT/devel/sage/doc` has lots of jsmath references, which all need to be converted to mathjax.\n\nIf you can independently confirm the behavior in[comment:65](#comment%3A65) then it will be good.",
    "created_at": "2012-06-09T19:40:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120965",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:68'></a>
Replying to [kini](#comment%3A67):
> It looks like Samuel Ainsworth has independently got MathJax working in his "newui" branch (I haven't tested it). At a glance it seems he's using the MathJax CDN.


Has he applied the mathjax patches to the sage repo? Without those patches it won't work. And these patches were not applying for quite sometime. I just updated one today.

There are more changes to make actually. `SAGE_ROOT/devel/sage/doc` has lots of jsmath references, which all need to be converted to mathjax.

If you can independently confirm the behavior in[comment:65](#comment%3A65) then it will be good.



---

archive/issue_comments_120966.json:
```json
{
    "body": "<a id='comment:69'></a>\nRegarding [your comment](#comment%3A65): the spkg in the ticket description is quite old, and that was probably the problem. The notebook has now been upgraded to use MathJax, and it does not have the problem you described.",
    "created_at": "2012-06-12T19:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120966",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:69'></a>
Regarding [your comment](#comment%3A65): the spkg in the ticket description is quite old, and that was probably the problem. The notebook has now been upgraded to use MathJax, and it does not have the problem you described.



---

archive/issue_comments_120967.json:
```json
{
    "body": "Changing reviewer from \"Jason Grout\" to \"Jason Grout, John Palmieri\"",
    "created_at": "2012-06-12T19:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120967",
    "user": "https://github.com/jhpalmieri"
}
```

Changing reviewer from "Jason Grout" to "Jason Grout, John Palmieri"



---

archive/issue_comments_120968.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -6,8 +6,4 @@\n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n * [attachment:trac_9774-mathjax-try5.patch] to the sage library repository\n \n-Also install the following spkg:\n-\n-**spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg\n-\n-(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax; note that jmol won't work unless you also install the dependencies listed at #11080 for the new sage notebook).\n+Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).\n``````\n",
    "created_at": "2012-06-12T19:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120968",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -6,8 +6,4 @@
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
 * [attachment:trac_9774-mathjax-try5.patch] to the sage library repository
 
-Also install the following spkg:
-
-**spkg**: http://sage.math.washington.edu/home/jason/mathjax/sagenb-0.9.0.spkg
-
-(the spkg is an spkg made from the mathjax branch of my sagenb git fork: https://github.com/jasongrout/sagenb/tree/mathjax; note that jmol won't work unless you also install the dependencies listed at #11080 for the new sage notebook).
+Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).
``````




---

archive/issue_comments_120969.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-06-12T19:43:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120969",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_120970.json:
```json
{
    "body": "Changing work_issues from \"does not work in DOT_SAGE\" to \"\"",
    "created_at": "2012-06-12T19:45:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120970",
    "user": "https://github.com/jhpalmieri"
}
```

Changing work_issues from "does not work in DOT_SAGE" to ""



---

archive/issue_comments_120971.json:
```json
{
    "body": "<a id='comment:71'></a>\nFantastic news!\n\nThis was merged in the notebook at [this github pull request](https://github.com/sagemath/sagenb/pull/30), just for completeness.\n\nSince #11080 is for Sage 5.2, this should be too.",
    "created_at": "2012-06-12T20:28:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120971",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:71'></a>
Fantastic news!

This was merged in the notebook at [this github pull request](https://github.com/sagemath/sagenb/pull/30), just for completeness.

Since #11080 is for Sage 5.2, this should be too.



---

archive/issue_events_029714.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-12T20:28:40Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "milestone": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29714"
}
```



---

archive/issue_events_029715.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-12T20:28:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29715"
}
```



---

archive/issue_comments_120972.json:
```json
{
    "body": "Changing reviewer from \"Jason Grout, John Palmieri\" to \"Jason Grout, John Palmieri, Punarbasu Purkayastha, Keshav Kini\"",
    "created_at": "2012-06-12T20:30:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120972",
    "user": "https://github.com/kcrisman"
}
```

Changing reviewer from "Jason Grout, John Palmieri" to "Jason Grout, John Palmieri, Punarbasu Purkayastha, Keshav Kini"



---

archive/issue_comments_120973.json:
```json
{
    "body": "<a id='comment:73'></a>\nJust checking on this - Jason, will this indeed fix #1608?  That is, will we be shipping (the relevant) MathJax fonts?  From what I'm reading above, that seems to be the case.  Anyone who confirms this, please give positive review to #1608 and add your name as a reviewer.",
    "created_at": "2012-06-12T20:38:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120973",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:73'></a>
Just checking on this - Jason, will this indeed fix #1608?  That is, will we be shipping (the relevant) MathJax fonts?  From what I'm reading above, that seems to be the case.  Anyone who confirms this, please give positive review to #1608 and add your name as a reviewer.



---

archive/issue_comments_120974.json:
```json
{
    "body": "<a id='comment:74'></a>\nWe have doctest failures:\n\n```\n        sage -t  --long -force_lib devel/sagenb-main/sagenb/notebook/jsmath.py # 5 doctests failed\n        sage -t  --long -force_lib devel/sagenb-main/sagenb/misc/sphinxify.py # 1 doctests failed\n        sage -t  --long -force_lib devel/sage/doc/de/tutorial/latex.rst # 27 doctests failed\n        sage -t  --long -force_lib devel/sage/doc/en/tutorial/latex.rst # 27 doctests failed\n        sage -t  --long -force_lib devel/sage/sage/matrix/matrix0.pyx # 1 doctests failed\n```\nThe problem with sphinxify is easy to fix. Should we delete jsmath.py, or is it still needed for something?\n\nThe problems with the tutorial are a bit more involved, since (a) it explicitly discusses using JSMath and (b) I don't speak German.\n\nI don't understand the matrix0.pyx problem at all, at least not yet.",
    "created_at": "2012-06-12T23:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120974",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:74'></a>
We have doctest failures:

```
        sage -t  --long -force_lib devel/sagenb-main/sagenb/notebook/jsmath.py # 5 doctests failed
        sage -t  --long -force_lib devel/sagenb-main/sagenb/misc/sphinxify.py # 1 doctests failed
        sage -t  --long -force_lib devel/sage/doc/de/tutorial/latex.rst # 27 doctests failed
        sage -t  --long -force_lib devel/sage/doc/en/tutorial/latex.rst # 27 doctests failed
        sage -t  --long -force_lib devel/sage/sage/matrix/matrix0.pyx # 1 doctests failed
```
The problem with sphinxify is easy to fix. Should we delete jsmath.py, or is it still needed for something?

The problems with the tutorial are a bit more involved, since (a) it explicitly discusses using JSMath and (b) I don't speak German.

I don't understand the matrix0.pyx problem at all, at least not yet.



---

archive/issue_comments_120975.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-06-12T23:35:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120975",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_120976.json:
```json
{
    "body": "<a id='comment:75'></a>\n> The problems with the tutorial are a bit more involved, since (a) it explicitly discusses using JSMath and (b) I don't speak German.\n\nThere are a number of Sage folks who do, though, so hopefully the second one won't be a problem.  Once you fix the English one let us know. \n\nI wonder why the other tutorial versions don't cause problems?  In particular, there is a tutorial in Russian and one in French in 5.1.beta3 that you don't mention as having caused problems - maybe they're based on different versions of the English tutorial.",
    "created_at": "2012-06-12T23:55:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120976",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:75'></a>
> The problems with the tutorial are a bit more involved, since (a) it explicitly discusses using JSMath and (b) I don't speak German.

There are a number of Sage folks who do, though, so hopefully the second one won't be a problem.  Once you fix the English one let us know. 

I wonder why the other tutorial versions don't cause problems?  In particular, there is a tutorial in Russian and one in French in 5.1.beta3 that you don't mention as having caused problems - maybe they're based on different versions of the English tutorial.



---

archive/issue_comments_120977.json:
```json
{
    "body": "Attachment [trac_9774-doctests.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-doctests.patch) by @jhpalmieri created at 2012-06-13 05:50:25",
    "created_at": "2012-06-13T05:50:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120977",
    "user": "https://github.com/jhpalmieri"
}
```

Attachment [trac_9774-doctests.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-doctests.patch) by @jhpalmieri created at 2012-06-13 05:50:25



---

archive/issue_comments_120978.json:
```json
{
    "body": "Work_Issues: fix sagenb",
    "created_at": "2012-06-13T05:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120978",
    "user": "https://github.com/jhpalmieri"
}
```

Work_Issues: fix sagenb



---

archive/issue_comments_120979.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,6 +4,6 @@\n \n **apply**: \n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n-* [attachment:trac_9774-mathjax-try5.patch] to the sage library repository\n+* [attachment:trac_9774-mathjax-try5.patch] and [attachment:trac_9774-doctests.patch] to the sage library repository\n \n Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).\n``````\n",
    "created_at": "2012-06-13T05:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120979",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,6 +4,6 @@
 
 **apply**: 
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
-* [attachment:trac_9774-mathjax-try5.patch] to the sage library repository
+* [attachment:trac_9774-mathjax-try5.patch] and [attachment:trac_9774-doctests.patch] to the sage library repository
 
 Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).
``````




---

archive/issue_comments_120980.json:
```json
{
    "body": "<a id='comment:76'></a>\nHere is a patch fixing the doctests in the Sage library. For the English tutorial, I did a little bit more than a search-and-replace, changing \"JSMath\" to \"MathJax\". For the German tutorial, that's essentially all I did. \n\nsagenb also needs fixing, and I don't have the energy to do this right now. If someone else wants to, that would be great. Here's what I think should be done: delete notebook/jsmath.py, and patch misc/sphinxify.py:\n\n```diff\ndiff --git a/sagenb/misc/sphinxify.py b/sagenb/misc/sphinxify.py\nindex 837b40a..85c9f4d 100644\n--- a/sagenb/misc/sphinxify.py\n+++ b/sagenb/misc/sphinxify.py\n@@ -71,7 +71,7 @@ def sphinxify(docstring, format='html'):\n         sage: sphinxify('**Testing**\\n`monospace`')\n         '\\n<div class=\"docstring\"...<strong>Testing</strong>\\n<span class=\"math\"...</p>\\n\\n\\n</div\n         sage: sphinxify('`x=y`')\n-        '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">x=y</span></p>\\n\\n\\n</div>'\n+        '\\n<div class=\"docstring\">\\n    \\n  <p><span class=\"math\">\\\\(x=y\\\\)</span></p>\\n\\n\\n</div>\n         sage: sphinxify('`x=y`', format='text')\n         'x=y\\n'\n         sage: sphinxify(':math:`x=y`', format='text')\n```",
    "created_at": "2012-06-13T05:54:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120980",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:76'></a>
Here is a patch fixing the doctests in the Sage library. For the English tutorial, I did a little bit more than a search-and-replace, changing "JSMath" to "MathJax". For the German tutorial, that's essentially all I did. 

sagenb also needs fixing, and I don't have the energy to do this right now. If someone else wants to, that would be great. Here's what I think should be done: delete notebook/jsmath.py, and patch misc/sphinxify.py:

```diff
diff --git a/sagenb/misc/sphinxify.py b/sagenb/misc/sphinxify.py
index 837b40a..85c9f4d 100644
--- a/sagenb/misc/sphinxify.py
+++ b/sagenb/misc/sphinxify.py
@@ -71,7 +71,7 @@ def sphinxify(docstring, format='html'):
         sage: sphinxify('**Testing**\n`monospace`')
         '\n<div class="docstring"...<strong>Testing</strong>\n<span class="math"...</p>\n\n\n</div
         sage: sphinxify('`x=y`')
-        '\n<div class="docstring">\n    \n  <p><span class="math">x=y</span></p>\n\n\n</div>'
+        '\n<div class="docstring">\n    \n  <p><span class="math">\\(x=y\\)</span></p>\n\n\n</div>
         sage: sphinxify('`x=y`', format='text')
         'x=y\n'
         sage: sphinxify(':math:`x=y`', format='text')
```



---

archive/issue_comments_120981.json:
```json
{
    "body": "<a id='comment:77'></a>\nRegarding the change in matrix0.py: the main patch already modified that file, and this doctest was missed. (jsMath can't handle the command `\\hline`, so matrices with subdivisions had to be handled specially in the notebook. MathJax handles this command just fine, so the special-casing went away, so the extra doctest for the notebook needed to go away, too.)",
    "created_at": "2012-06-13T05:58:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120981",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:77'></a>
Regarding the change in matrix0.py: the main patch already modified that file, and this doctest was missed. (jsMath can't handle the command `\hline`, so matrices with subdivisions had to be handled specially in the notebook. MathJax handles this command just fine, so the special-casing went away, so the extra doctest for the notebook needed to go away, too.)



---

archive/issue_comments_120982.json:
```json
{
    "body": "<a id='comment:78'></a>\ntest.sagenb.org and alpha.sagenb.org are running these patches up through try5 (but not the doctest patch just posted).",
    "created_at": "2012-06-13T06:53:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120982",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:78'></a>
test.sagenb.org and alpha.sagenb.org are running these patches up through try5 (but not the doctest patch just posted).



---

archive/issue_comments_120983.json:
```json
{
    "body": "<a id='comment:79'></a>\nRegarding my comment about sagenb: apparently jsmath.py is already gone in the new sagenb; I don't know why I thought otherwise. sphinxify.py still needs to be patched.",
    "created_at": "2012-06-13T17:44:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120983",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:79'></a>
Regarding my comment about sagenb: apparently jsmath.py is already gone in the new sagenb; I don't know why I thought otherwise. sphinxify.py still needs to be patched.



---

archive/issue_comments_120984.json:
```json
{
    "body": "<a id='comment:80'></a>\n> Here is a patch fixing the doctests in the Sage library. For the English tutorial, I did a little bit more than a search-and-replace, changing \"JSMath\" to \"MathJax\". For the German tutorial, that's essentially all I did. \n\n\nThat looks to have been enough.  I have no idea if all the stuff in English is actually *true* any more, of course.  As long as\n\n```\nIn the \ncase of Sage, the notebook is always connected to a server used to \nexecute the Sage commands, and this server also provides the necessary \njsMath fonts.  So there is nothing extra to set up to have typeset \nmathematics in your web browser when you use the Sage notebook.\n```\nis still true for MathJax you should be fine.",
    "created_at": "2012-06-13T18:29:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120984",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:80'></a>
> Here is a patch fixing the doctests in the Sage library. For the English tutorial, I did a little bit more than a search-and-replace, changing "JSMath" to "MathJax". For the German tutorial, that's essentially all I did. 


That looks to have been enough.  I have no idea if all the stuff in English is actually *true* any more, of course.  As long as

```
In the 
case of Sage, the notebook is always connected to a server used to 
execute the Sage commands, and this server also provides the necessary 
jsMath fonts.  So there is nothing extra to set up to have typeset 
mathematics in your web browser when you use the Sage notebook.
```
is still true for MathJax you should be fine.



---

archive/issue_comments_120985.json:
```json
{
    "body": "<a id='comment:81'></a>\nI just [submitted a pull request](https://github.com/sagemath/sagenb/pull/60) for the sphinxify change in sagenb. So I think this is ready for review. The only thing that needs review is the doctest patch, which just fixes doctests. I'm running doctests now.",
    "created_at": "2012-06-13T18:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120985",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:81'></a>
I just [submitted a pull request](https://github.com/sagemath/sagenb/pull/60) for the sphinxify change in sagenb. So I think this is ready for review. The only thing that needs review is the doctest patch, which just fixes doctests. I'm running doctests now.



---

archive/issue_comments_120986.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-06-13T18:46:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120986",
    "user": "https://github.com/jhpalmieri"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_120987.json:
```json
{
    "body": "Changing work_issues from \"fix sagenb\" to \"\"",
    "created_at": "2012-06-13T18:46:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120987",
    "user": "https://github.com/jhpalmieri"
}
```

Changing work_issues from "fix sagenb" to ""



---

archive/issue_comments_120988.json:
```json
{
    "body": "<a id='comment:83'></a>\nAll tests pass with the new patches.",
    "created_at": "2012-06-13T20:11:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120988",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:83'></a>
All tests pass with the new patches.



---

archive/issue_comments_120989.json:
```json
{
    "body": "<a id='comment:84'></a>\nReplying to [kcrisman](#comment%3A80):\n> As long as\n> \n> ```\n> In the \n> case of Sage, the notebook is always connected to a server used to \n> execute the Sage commands, and this server also provides the necessary \n> jsMath fonts.  So there is nothing extra to set up to have typeset \n> mathematics in your web browser when you use the Sage notebook.\n> ```\n> is still true for MathJax you should be fine.\n\n\nAs far as I can tell, it still is. If it's not, it's close enough.",
    "created_at": "2012-06-13T22:14:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120989",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:84'></a>
Replying to [kcrisman](#comment%3A80):
> As long as
> 
> ```
> In the 
> case of Sage, the notebook is always connected to a server used to 
> execute the Sage commands, and this server also provides the necessary 
> jsMath fonts.  So there is nothing extra to set up to have typeset 
> mathematics in your web browser when you use the Sage notebook.
> ```
> is still true for MathJax you should be fine.


As far as I can tell, it still is. If it's not, it's close enough.



---

archive/issue_comments_120990.json:
```json
{
    "body": "<a id='comment:85'></a>\nI see that after this mathjax-1.1 is merged into sagenb. Shouldn't we move to mathjax-2 directly?",
    "created_at": "2012-06-14T03:59:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120990",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:85'></a>
I see that after this mathjax-1.1 is merged into sagenb. Shouldn't we move to mathjax-2 directly?



---

archive/issue_comments_120991.json:
```json
{
    "body": "<a id='comment:86'></a>\nMathJax 2.0 should be a separate patch.  Let's not delay this year-in-the-making positively-reviewed patch any longer.",
    "created_at": "2012-06-14T04:59:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120991",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:86'></a>
MathJax 2.0 should be a separate patch.  Let's not delay this year-in-the-making positively-reviewed patch any longer.



---

archive/issue_events_029716.json:
```json
{
    "event": "renamed",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "rename": {
        "from": "Upgrade the notebook to use MathJax instead of jsMath",
        "to": "Use MathJax instead of jsMath"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29716"
}
```



---

archive/issue_comments_120992.json:
```json
{
    "body": "<a id='comment:88'></a>\nOnce my `make ptestlong` finishes, I'm just going to give this positive review. The pull request has already been merged into sagenb (and so everyone will need to apply these patches anyway if they want to test the latest revision of the notebook), the patch looks good to me (though I don't know much about the code it touches), and from some poking around it seems to work as advertised.",
    "created_at": "2012-06-14T22:59:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120992",
    "user": "https://github.com/kini"
}
```

<a id='comment:88'></a>
Once my `make ptestlong` finishes, I'm just going to give this positive review. The pull request has already been merged into sagenb (and so everyone will need to apply these patches anyway if they want to test the latest revision of the notebook), the patch looks good to me (though I don't know much about the code it touches), and from some poking around it seems to work as advertised.



---

archive/issue_comments_120993.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-15T00:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120993",
    "user": "https://github.com/kini"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_120994.json:
```json
{
    "body": "<a id='comment:89'></a>\nAll systems go!",
    "created_at": "2012-06-15T00:22:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120994",
    "user": "https://github.com/kini"
}
```

<a id='comment:89'></a>
All systems go!



---

archive/issue_comments_120995.json:
```json
{
    "body": "Changing keywords from \"\" to \"sd41\".",
    "created_at": "2012-06-15T00:29:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120995",
    "user": "https://github.com/kini"
}
```

Changing keywords from "" to "sd41".



---

archive/issue_comments_120996.json:
```json
{
    "body": "<a id='comment:91'></a>\nThis obviously needs a proper sagenb spkg before it can be merged.",
    "created_at": "2012-06-15T21:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120996",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:91'></a>
This obviously needs a proper sagenb spkg before it can be merged.



---

archive/issue_comments_120997.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-06-15T21:03:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120997",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_120998.json:
```json
{
    "body": "<a id='comment:92'></a>\nImportant note: if the sagenb people can write me a script which *automatically* creates a new sagenb spkg from a git repository, I'll be happy to use it.",
    "created_at": "2012-06-15T21:05:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120998",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:92'></a>
Important note: if the sagenb people can write me a script which *automatically* creates a new sagenb spkg from a git repository, I'll be happy to use it.



---

archive/issue_comments_120999.json:
```json
{
    "body": "Changing upstream from \"N/A\" to \"Fixed upstream, but not in a stable release.\"",
    "created_at": "2012-06-15T21:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-120999",
    "user": "https://github.com/kini"
}
```

Changing upstream from "N/A" to "Fixed upstream, but not in a stable release."



---

archive/issue_comments_121000.json:
```json
{
    "body": "Changing dependencies from \"#11080\" to \"#13121\"",
    "created_at": "2012-06-15T21:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121000",
    "user": "https://github.com/kini"
}
```

Changing dependencies from "#11080" to "#13121"



---

archive/issue_comments_121001.json:
```json
{
    "body": "Changing status from needs_work to positive_review.",
    "created_at": "2012-06-15T21:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121001",
    "user": "https://github.com/kini"
}
```

Changing status from needs_work to positive_review.



---

archive/issue_comments_121002.json:
```json
{
    "body": "<a id='comment:93'></a>\nNo, we'll (I'll) do it manually. SPKGs being autogenerated is at odds with having repositories for SPKGs.\n\nI have written scripts which at least simplify the process, though - they create a directory which can be used as the new SPKG's `src/` directory without modification of the `spkg-install` script. Those are at [this pull request](https://github.com/sagemath/sagenb/pull/63), which I'd appreciate it if someone reviewed :)\n\nI'm setting this ticket to positive review because there is nothing left to be done on the Sage end other than wait for #13121 to get in (i.e. Sage to upgrade to sagenb 0.9.1).",
    "created_at": "2012-06-15T21:54:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121002",
    "user": "https://github.com/kini"
}
```

<a id='comment:93'></a>
No, we'll (I'll) do it manually. SPKGs being autogenerated is at odds with having repositories for SPKGs.

I have written scripts which at least simplify the process, though - they create a directory which can be used as the new SPKG's `src/` directory without modification of the `spkg-install` script. Those are at [this pull request](https://github.com/sagemath/sagenb/pull/63), which I'd appreciate it if someone reviewed :)

I'm setting this ticket to positive review because there is nothing left to be done on the Sage end other than wait for #13121 to get in (i.e. Sage to upgrade to sagenb 0.9.1).



---

archive/issue_comments_121003.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,4 @@\n [MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).\n-\n-This will also fix #1608\n \n **apply**: \n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n``````\n",
    "created_at": "2012-06-16T04:14:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121003",
    "user": "https://github.com/kini"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,4 @@
 [MathJax](http://www.mathjax.org/) is the successor to [jsMath](http://www.math.union.edu/~dpvc/jsMath/).
-
-This will also fix #1608
 
 **apply**: 
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
``````




---

archive/issue_events_029717.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T22:12:42Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29717"
}
```



---

archive/issue_events_029718.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-18T22:12:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29718"
}
```



---

archive/issue_comments_121004.json:
```json
{
    "body": "<a id='comment:96'></a>\nRebased to Sage 5.1.beta5 (because of #11775).",
    "created_at": "2012-06-20T19:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121004",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:96'></a>
Rebased to Sage 5.1.beta5 (because of #11775).



---

archive/issue_comments_121005.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n **apply**: \n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n-* [attachment:trac_9774-mathjax-try5.patch] and [attachment:trac_9774-doctests.patch] to the sage library repository\n+* [attachment:trac_9774-mathjax-try6.patch] to the sage library repository\n \n Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).\n``````\n",
    "created_at": "2012-06-20T19:07:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121005",
    "user": "https://github.com/jhpalmieri"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 **apply**: 
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
-* [attachment:trac_9774-mathjax-try5.patch] and [attachment:trac_9774-doctests.patch] to the sage library repository
+* [attachment:trac_9774-mathjax-try6.patch] to the sage library repository
 
 Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).
``````




---

archive/issue_comments_121006.json:
```json
{
    "body": "Sage library",
    "created_at": "2012-06-25T16:54:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121006",
    "user": "https://github.com/jasongrout"
}
```

Sage library



---

archive/issue_comments_121007.json:
```json
{
    "body": "<a id='comment:97'></a>\nAttachment [trac_9774-mathjax-try6.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try6.patch) by @jasongrout created at 2012-06-25 16:54:32\n\nI rebased [attachment:trac_9774-mathjax-try6.patch] to sage 5.1beta6",
    "created_at": "2012-06-25T16:54:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121007",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:97'></a>
Attachment [trac_9774-mathjax-try6.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try6.patch) by @jasongrout created at 2012-06-25 16:54:32

I rebased [attachment:trac_9774-mathjax-try6.patch] to sage 5.1beta6



---

archive/issue_comments_121008.json:
```json
{
    "body": "<a id='comment:98'></a>\nDumb question.  If the changes to the latex of some vectors is to work around a jsmath bug, maybe we shouldn't remove that comment; after all, maybe that workaround is no longer needed, but now no one will no that it was a workaround in the first place...  Maybe it works now completely, and we should change it or remove it!\n\nThis was apparently introduced in the try3 patch.",
    "created_at": "2012-07-05T16:28:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121008",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:98'></a>
Dumb question.  If the changes to the latex of some vectors is to work around a jsmath bug, maybe we shouldn't remove that comment; after all, maybe that workaround is no longer needed, but now no one will no that it was a workaround in the first place...  Maybe it works now completely, and we should change it or remove it!

This was apparently introduced in the try3 patch.



---

archive/issue_comments_121009.json:
```json
{
    "body": "<a id='comment:99'></a>\nCan you tell which part is \"weird\"? Is it the braces around ``\\mapsto``? If I remove those braces, it works with both jsMath and MathJax.",
    "created_at": "2012-07-05T16:40:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121009",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:99'></a>
Can you tell which part is "weird"? Is it the braces around ``\mapsto``? If I remove those braces, it works with both jsMath and MathJax.



---

archive/issue_comments_121010.json:
```json
{
    "body": "<a id='comment:100'></a>\n> Can you tell which part is \"weird\"? Is it the braces around ``\\mapsto``? If I remove those braces, it works with both jsMath and MathJax.\n\nI wish I could tell you!  I didn't write it.  I was just trying to point this out, in case it was clear to someone else.  If it's not clear what the problem is, maybe we leave the comment in?  Maybe Jason can explain.\n\nAlso, both representations have the braces, and braces are fine for demarcating things in TeX, so I don't think that's the issue.  hg blame says that this dates from before the symbolics switch to Pynac.\n\nAnyway, not a huge deal, but pointing it out.",
    "created_at": "2012-07-05T17:45:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121010",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:100'></a>
> Can you tell which part is "weird"? Is it the braces around ``\mapsto``? If I remove those braces, it works with both jsMath and MathJax.

I wish I could tell you!  I didn't write it.  I was just trying to point this out, in case it was clear to someone else.  If it's not clear what the problem is, maybe we leave the comment in?  Maybe Jason can explain.

Also, both representations have the braces, and braces are fine for demarcating things in TeX, so I don't think that's the issue.  hg blame says that this dates from before the symbolics switch to Pynac.

Anyway, not a huge deal, but pointing it out.



---

archive/issue_comments_121011.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n **apply**: \n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n-* [attachment:trac_9774-mathjax-try6.patch] to the sage library repository\n+* [attachment:trac_9774-mathjax-try7.patch] to the sage library repository\n \n Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).\n``````\n",
    "created_at": "2012-07-14T00:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121011",
    "user": "https://github.com/ppurka"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 **apply**: 
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
-* [attachment:trac_9774-mathjax-try6.patch] to the sage library repository
+* [attachment:trac_9774-mathjax-try7.patch] to the sage library repository
 
 Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).
``````




---

archive/issue_comments_121012.json:
```json
{
    "body": "<a id='comment:1'></a>\nUpdated patch to the changes introduced in #11775. Otherwise, typeset was broken.",
    "created_at": "2012-07-14T00:58:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121012",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:1'></a>
Updated patch to the changes introduced in #11775. Otherwise, typeset was broken.



---

archive/issue_comments_121013.json:
```json
{
    "body": "Changing status from positive_review to needs_work.",
    "created_at": "2012-07-26T09:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121013",
    "user": "https://github.com/kini"
}
```

Changing status from positive_review to needs_work.



---

archive/issue_comments_121014.json:
```json
{
    "body": "<a id='comment:2'></a>\nPatch needs rebasing on #13109 - doing that now.",
    "created_at": "2012-07-26T09:08:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121014",
    "user": "https://github.com/kini"
}
```

<a id='comment:2'></a>
Patch needs rebasing on #13109 - doing that now.



---

archive/issue_comments_121015.json:
```json
{
    "body": "<a id='comment:3'></a>\nHmm. There is a failing doctest caused by #11775. Did you attempt to fix doctests when you made try7, ppurka? Or is this failing doctest somehow new or caused by my rebasing? Looking at a diff between the try7 patch and my new try8 patch, I don't see anything suspicious...",
    "created_at": "2012-07-26T10:28:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121015",
    "user": "https://github.com/kini"
}
```

<a id='comment:3'></a>
Hmm. There is a failing doctest caused by #11775. Did you attempt to fix doctests when you made try7, ppurka? Or is this failing doctest somehow new or caused by my rebasing? Looking at a diff between the try7 patch and my new try8 patch, I don't see anything suspicious...



---

archive/issue_comments_121016.json:
```json
{
    "body": "<a id='comment:4'></a>\nIn particular this doctest fails, on Sage 5.2.rc1: \n\n```\n[3] fs@boone /opt/sage/devel/sage $ sage -t --long --force_lib sage/misc/latex.py\nsage -t --long --force_lib \"devel/sage-main/sage/misc/latex.py\"\n**********************************************************************\nFile \"/opt/sage-5.2.rc1/devel/sage-main/sage/misc/latex.py\", line 1972:\n    sage: view((x,2), combine_all=True) # trac 11775\nExpected:\n    <html><script type=\"math/tex\">\\newcommand{\\Bold}[1]{\\mathbf{#1}}\\left(x, 2\\right)</script></html>\nGot:\n    <html><script type=\"math/tex\">\\newcommand{\\Bold}[1]{\\mathbf{#1}}x 2</script></html>\n**********************************************************************\n1 items had failures:\n   1 of  17 in __main__.example_54\n***Test Failed*** 1 failures.\nFor whitespace errors, see the file /home/fs/.sage//tmp/latex_17232.py\n         [1.3 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t --long --force_lib \"devel/sage-main/sage/misc/latex.py\"\nTotal time for all tests: 1.3 seconds\n```",
    "created_at": "2012-07-26T11:01:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121016",
    "user": "https://github.com/kini"
}
```

<a id='comment:4'></a>
In particular this doctest fails, on Sage 5.2.rc1: 

```
[3] fs@boone /opt/sage/devel/sage $ sage -t --long --force_lib sage/misc/latex.py
sage -t --long --force_lib "devel/sage-main/sage/misc/latex.py"
**********************************************************************
File "/opt/sage-5.2.rc1/devel/sage-main/sage/misc/latex.py", line 1972:
    sage: view((x,2), combine_all=True) # trac 11775
Expected:
    <html><script type="math/tex">\newcommand{\Bold}[1]{\mathbf{#1}}\left(x, 2\right)</script></html>
Got:
    <html><script type="math/tex">\newcommand{\Bold}[1]{\mathbf{#1}}x 2</script></html>
**********************************************************************
1 items had failures:
   1 of  17 in __main__.example_54
***Test Failed*** 1 failures.
For whitespace errors, see the file /home/fs/.sage//tmp/latex_17232.py
         [1.3 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t --long --force_lib "devel/sage-main/sage/misc/latex.py"
Total time for all tests: 1.3 seconds
```



---

archive/issue_comments_121017.json:
```json
{
    "body": "<a id='comment:5'></a>\nHmm.. I had updated to try7 exactly because it was failing the doctests and in the notebook. I thought I had fixed all the doctests. Updating try7 again  soon.",
    "created_at": "2012-07-26T15:47:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121017",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:5'></a>
Hmm.. I had updated to try7 exactly because it was failing the doctests and in the notebook. I thought I had fixed all the doctests. Updating try7 again  soon.



---

archive/issue_comments_121018.json:
```json
{
    "body": "<a id='comment:6'></a>\nUpdated try7. Please test.",
    "created_at": "2012-07-26T16:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121018",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:6'></a>
Updated try7. Please test.



---

archive/issue_comments_121019.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2012-07-26T16:21:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121019",
    "user": "https://github.com/ppurka"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_121020.json:
```json
{
    "body": "<a id='comment:7'></a>\nupdated the try7 patch again, to changes in #13109. To make the review easier, the diff between this and earlier patch [is here](https://github.com/ppurka/sage-patches/commit/f1253cc6d3f5d0051e5192d17678425b3029e879).",
    "created_at": "2012-08-03T10:07:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121020",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:7'></a>
updated the try7 patch again, to changes in #13109. To make the review easier, the diff between this and earlier patch [is here](https://github.com/ppurka/sage-patches/commit/f1253cc6d3f5d0051e5192d17678425b3029e879).



---

archive/issue_comments_121021.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository\n * [attachment:trac_9774-mathjax-try7.patch] to the sage library repository\n \n-Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).\n+Also install the new notebook from #13121\n``````\n",
    "created_at": "2012-08-03T10:12:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121021",
    "user": "https://github.com/ppurka"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 * [attachment:trac_9774-scripts-mathjax.patch] to the scripts repository
 * [attachment:trac_9774-mathjax-try7.patch] to the sage library repository
 
-Also install the new notebook from the sagenb git fork [https://github.com/jasongrout/sagenb/tree/mathjax](https://github.com/jasongrout/sagenb/tree/mathjax).
+Also install the new notebook from #13121
``````




---

archive/issue_comments_121022.json:
```json
{
    "body": "<a id='comment:9'></a>\nThe patch has fuzz against 5.3.beta2.",
    "created_at": "2012-08-22T06:55:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121022",
    "user": "https://github.com/kini"
}
```

<a id='comment:9'></a>
The patch has fuzz against 5.3.beta2.



---

archive/issue_comments_121023.json:
```json
{
    "body": "<a id='comment:0'></a>\nThe fuzz is caused by #13310 which was merged in 5.3.beta1 and is harmless.",
    "created_at": "2012-08-22T07:00:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121023",
    "user": "https://github.com/kini"
}
```

<a id='comment:0'></a>
The fuzz is caused by #13310 which was merged in 5.3.beta1 and is harmless.



---

archive/issue_comments_121024.json:
```json
{
    "body": "<a id='comment:1'></a>\nFixed.",
    "created_at": "2012-08-22T07:01:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121024",
    "user": "https://github.com/kini"
}
```

<a id='comment:1'></a>
Fixed.



---

archive/issue_comments_121025.json:
```json
{
    "body": "Attachment [trac_9774-mathjax-try7.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try7.patch) by @kini created at 2012-08-22 07:02:28\n\napply to $SAGE_ROOT/devel/sage",
    "created_at": "2012-08-22T07:02:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121025",
    "user": "https://github.com/kini"
}
```

Attachment [trac_9774-mathjax-try7.patch](tarball://root/attachments/some-uuid/ticket9774/trac_9774-mathjax-try7.patch) by @kini created at 2012-08-22 07:02:28

apply to $SAGE_ROOT/devel/sage



---

archive/issue_comments_121026.json:
```json
{
    "body": "<a id='comment:2'></a>\nWhat thing needs \"review\" here?",
    "created_at": "2012-08-22T07:07:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121026",
    "user": "https://github.com/ppurka"
}
```

<a id='comment:2'></a>
What thing needs "review" here?



---

archive/issue_comments_121027.json:
```json
{
    "body": "<a id='comment:3'></a>\nUh... hmm. The rebasing, I guess? Whatever, looks fine to me ;)",
    "created_at": "2012-08-22T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121027",
    "user": "https://github.com/kini"
}
```

<a id='comment:3'></a>
Uh... hmm. The rebasing, I guess? Whatever, looks fine to me ;)



---

archive/issue_comments_121028.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-08-22T07:18:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121028",
    "user": "https://github.com/kini"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_029719.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-02T21:43:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "milestone": "sage-pending",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29719"
}
```



---

archive/issue_events_029720.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-02T21:43:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "milestone": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29720"
}
```



---

archive/issue_comments_121029.json:
```json
{
    "body": "Merged: sage-5.4.beta0",
    "created_at": "2012-09-05T18:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121029",
    "user": "https://github.com/jdemeyer"
}
```

Merged: sage-5.4.beta0



---

archive/issue_comments_121030.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-09-05T18:05:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121030",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed



---

archive/issue_events_029721.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-05T18:05:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9774#event-29721"
}
```



---

archive/issue_comments_121031.json:
```json
{
    "body": "<a id='comment:6'></a>\nThis document does not compile anymore with SageTeX\n\n```\n\\documentclass[12pt,letterpaper]{article}\n\\usepackage[utf8]{inputenc}\n\\usepackage[english]{babel}\n\\usepackage{sagetex}\n\\begin{document}\n$\\sage{\"1 2\"}$\n\\end{document}\n```\nbecause someone has replaced a verbatim spacer with a version that does not work, as was explicitly explained in the surrounding comment, and then deleted the comment altogether:\n\n```diff\n--- a/sage/misc/latex.py\n+++ b/sage/misc/latex.py\n@@ -323,11 +323,7 @@\n     # 2) wrap each line into \\verb;\n     # 3) assemble lines into a left-justified array.\n     \n-    # There is a bug in verb-space treatment in jsMath...\n-    spacer = \"\\\\phantom{%s}\"\n-    # \\phantom{\\verb!%s!} is more accurate and it works, but it is not a valid\n-    # LaTeX and may cause problems, so let's live with the above variant until\n-    # spaces are properly treated in jsMath/MathJax and we don't need to worry.\n+    spacer = r\"\\phantom{\\verb!%s!}\"\n     lines = []\n     for line in x.split(\"\\n\"):\n         parts = []\n```\nWhat was the motivation for this???",
    "created_at": "2012-09-19T16:14:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121031",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:6'></a>
This document does not compile anymore with SageTeX

```
\documentclass[12pt,letterpaper]{article}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{sagetex}
\begin{document}
$\sage{"1 2"}$
\end{document}
```
because someone has replaced a verbatim spacer with a version that does not work, as was explicitly explained in the surrounding comment, and then deleted the comment altogether:

```diff
--- a/sage/misc/latex.py
+++ b/sage/misc/latex.py
@@ -323,11 +323,7 @@
     # 2) wrap each line into \verb;
     # 3) assemble lines into a left-justified array.
     
-    # There is a bug in verb-space treatment in jsMath...
-    spacer = "\\phantom{%s}"
-    # \phantom{\verb!%s!} is more accurate and it works, but it is not a valid
-    # LaTeX and may cause problems, so let's live with the above variant until
-    # spaces are properly treated in jsMath/MathJax and we don't need to worry.
+    spacer = r"\phantom{\verb!%s!}"
     lines = []
     for line in x.split("\n"):
         parts = []
```
What was the motivation for this???



---

archive/issue_comments_121032.json:
```json
{
    "body": "<a id='comment:7'></a>\nDo you by chance see who changed it?  If it was me, I don't recall the motivation.  So +1 to making sure things work.",
    "created_at": "2012-09-19T16:22:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121032",
    "user": "https://github.com/jasongrout"
}
```

<a id='comment:7'></a>
Do you by chance see who changed it?  If it was me, I don't recall the motivation.  So +1 to making sure things work.



---

archive/issue_comments_121033.json:
```json
{
    "body": "<a id='comment:8'></a>\nIt is in the jumbo patch to Sage library uploaded by Keshav, I guess it is a flattening of others. Most of it was automatic, I imagine, but this part is definitely made by hand.",
    "created_at": "2012-09-19T16:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121033",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:8'></a>
It is in the jumbo patch to Sage library uploaded by Keshav, I guess it is a flattening of others. Most of it was automatic, I imagine, but this part is definitely made by hand.



---

archive/issue_comments_121034.json:
```json
{
    "body": "<a id='comment:9'></a>\nAnother reason why we shouldn't flatten patches...",
    "created_at": "2012-09-20T13:40:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121034",
    "user": "https://github.com/kini"
}
```

<a id='comment:9'></a>
Another reason why we shouldn't flatten patches...



---

archive/issue_comments_121035.json:
```json
{
    "body": "<a id='comment:0'></a>\n#14382 finally reverts the change, sorry for delay.",
    "created_at": "2013-03-29T17:31:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9774",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9774#issuecomment-121035",
    "user": "https://github.com/novoselt"
}
```

<a id='comment:0'></a>
#14382 finally reverts the change, sorry for delay.
