# Issue 9544: Fix flintqs on FreeBSD

archive/issues_009544.json:
```json
{
    "body": "TonelliShanks.h references `int32_t` but does not directly include <stdint.h> (where it is defined).  On FreeBSD using gcc45 (but not the base gcc), this causes compilation to fail.\n\n**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/flintqs-20070817.p8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/flintqs-20070817.p8.spkg)\n\nAssignee: @peterjeremy\n\nUpstream: None of the above - read trac for reasoning.\n\nReviewer: Stephen Montgomery-Smith, Jeroen Demeyer, Karl-Dieter Crisman\n\nAuthor: Peter Jeremy, Jeroen Demeyer\n\nMerged: sage-5.1.rc0\n\nDependencies: #12855\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/9544\n\n",
    "closed_at": "2012-06-28T09:36:36Z",
    "created_at": "2010-07-18T20:01:27Z",
    "labels": [
        "component: porting: bsd"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.1",
    "title": "Fix flintqs on FreeBSD",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9544",
    "user": "https://github.com/peterjeremy"
}
```
TonelliShanks.h references `int32_t` but does not directly include <stdint.h> (where it is defined).  On FreeBSD using gcc45 (but not the base gcc), this causes compilation to fail.

**spkg**: [http://boxen.math.washington.edu/home/jdemeyer/spkg/flintqs-20070817.p8.spkg](http://boxen.math.washington.edu/home/jdemeyer/spkg/flintqs-20070817.p8.spkg)

Assignee: @peterjeremy

Upstream: None of the above - read trac for reasoning.

Reviewer: Stephen Montgomery-Smith, Jeroen Demeyer, Karl-Dieter Crisman

Author: Peter Jeremy, Jeroen Demeyer

Merged: sage-5.1.rc0

Dependencies: #12855

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/9544





---

archive/issue_events_023738.json:
```json
{
    "actor": "https://github.com/peterjeremy",
    "created_at": "2010-07-18T20:47:34Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "milestone": "sage-4.5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9544#event-23738"
}
```



---

archive/issue_comments_091842.json:
```json
{
    "body": "<a id='comment:3'></a>Apparently at least once [Stephen Montgomery-Smith](http://groups.google.com/group/sage-devel/browse_thread/thread/2feec7c5511c4ae5/857a00a9aa271f17) compiled Sage on a \"port\" successfully on FreeBSD without this.",
    "created_at": "2012-01-31T02:00:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91842",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>Apparently at least once [Stephen Montgomery-Smith](http://groups.google.com/group/sage-devel/browse_thread/thread/2feec7c5511c4ae5/857a00a9aa271f17) compiled Sage on a "port" successfully on FreeBSD without this.



---

archive/issue_comments_091843.json:
```json
{
    "body": "<a id='comment:4'></a>Stephen Montgomery-Smith reports that this patch is absolutely necessary for building under FreeBSD.",
    "created_at": "2012-04-08T14:51:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91843",
    "user": "https://trac.sagemath.org/admin/accounts/users/stephen"
}
```

<a id='comment:4'></a>Stephen Montgomery-Smith reports that this patch is absolutely necessary for building under FreeBSD.



---

archive/issue_comments_091844.json:
```json
{
    "body": "<a id='comment:5'></a>Just for the record:  There'll be a new FLINTQS spkg at #12855 soon...",
    "created_at": "2012-04-19T21:29:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91844",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>Just for the record:  There'll be a new FLINTQS spkg at #12855 soon...



---

archive/issue_comments_091845.json:
```json
{
    "body": "<a id='comment:6'></a>The current spkg-install change being used in the port is\n\n```diff\n--- flintqs-20070817.p6/spkg-install-orig\t2012-04-08 00:46:21.000000000 +0000\n+++ flintqs-20070817.p6/spkg-install\t2012-04-08 00:55:33.000000000 +0000\n@@ -7,6 +7,7 @@\n fi\n \n cp patches/lanczos.h  src/\n+patch -p0 < patches/TonelliShanks.h.patch\n \n cd src\n```\n\nbut we'll have to check the exit status on that.  Or just add this into #12855 or something.",
    "created_at": "2012-06-20T19:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91845",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>The current spkg-install change being used in the port is

```diff
--- flintqs-20070817.p6/spkg-install-orig	2012-04-08 00:46:21.000000000 +0000
+++ flintqs-20070817.p6/spkg-install	2012-04-08 00:55:33.000000000 +0000
@@ -7,6 +7,7 @@
 fi
 
 cp patches/lanczos.h  src/
+patch -p0 < patches/TonelliShanks.h.patch
 
 cd src
```

but we'll have to check the exit status on that.  Or just add this into #12855 or something.



---

archive/issue_comments_091846.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2012-06-21T10:25:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91846",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from new to needs_review.



---

archive/issue_events_023739.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-21T10:25:06Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "milestone": "sage-4.5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9544#event-23739"
}
```



---

archive/issue_events_023740.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-21T10:25:06Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9544#event-23740"
}
```



---

archive/issue_comments_091847.json:
```json
{
    "body": "<a id='comment:8'></a>Rebased to #12855.",
    "created_at": "2012-06-21T10:25:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91847",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:8'></a>Rebased to #12855.



---

archive/issue_comments_091848.json:
```json
{
    "body": "Attachment [flintqs-20070817.p8.diff](tarball://root/attachments/some-uuid/ticket9544/flintqs-20070817.p8.diff) by @jdemeyer created at 2012-06-21 10:26:49\n\nDiff for the flintqs spkg. For reference / review only.",
    "created_at": "2012-06-21T10:26:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91848",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [flintqs-20070817.p8.diff](tarball://root/attachments/some-uuid/ticket9544/flintqs-20070817.p8.diff) by @jdemeyer created at 2012-06-21 10:26:49

Diff for the flintqs spkg. For reference / review only.



---

archive/issue_comments_091849.json:
```json
{
    "body": "<a id='comment:9'></a>This looks good, but since it's applied universally and not just on FreeBSD I am hesitant to give it positive review.  Jeroen, did you try this out on some of the buildbots?\n\nAlso, is there even an \"upstream\"?  This is a five-year-old program, and some searching indicates that maybe a newer version is included in flint itself?  Anyway, I figure that the age makes reporting upstream inappropriate.",
    "created_at": "2012-06-21T12:58:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91849",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>This looks good, but since it's applied universally and not just on FreeBSD I am hesitant to give it positive review.  Jeroen, did you try this out on some of the buildbots?

Also, is there even an "upstream"?  This is a five-year-old program, and some searching indicates that maybe a newer version is included in flint itself?  Anyway, I figure that the age makes reporting upstream inappropriate.



---

archive/issue_comments_091850.json:
```json
{
    "body": "<a id='comment:10'></a>Replying to [comment:9 kcrisman]:\n> Jeroen, did you try this out on some of the buildbots?\n\nNo, but I don't expect problems. What harm could an additional header file do?",
    "created_at": "2012-06-21T13:02:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91850",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:10'></a>Replying to [comment:9 kcrisman]:
> Jeroen, did you try this out on some of the buildbots?

No, but I don't expect problems. What harm could an additional header file do?



---

archive/issue_comments_091851.json:
```json
{
    "body": "<a id='comment:11'></a>> > Jeroen, did you try this out on some of the buildbots?\n\n> No, but I don't expect problems. What harm could an additional header file do?\nI don't know, that's why I asked!  Extra imports in Python sometimes cause all kinds of circularity issues or slowdowns, and I don't know enough about C to say either way.\n\nBut since you just repackaged this, I think it's appropriate for you to be a reviewer as well.  And I checked that the package is well-formed and installs on OS X.\n\nI also notice that you included stdint after stdlib, while Stephen does the opposite in his patch [here](http://www.freebsd.org/cgi/cvsweb.cgi/ports/math/sage/files/spkg-patch-flintqs-20070817.p6_-_patches_TonelliShanks.h.patch?rev=1.1;content-type=text%2Fplain).  I assume this also doesn't matter?  Sorry for the very stupid questions.\n\n---\nSee also #11792?",
    "created_at": "2012-06-21T13:09:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91851",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>> > Jeroen, did you try this out on some of the buildbots?

> No, but I don't expect problems. What harm could an additional header file do?
I don't know, that's why I asked!  Extra imports in Python sometimes cause all kinds of circularity issues or slowdowns, and I don't know enough about C to say either way.

But since you just repackaged this, I think it's appropriate for you to be a reviewer as well.  And I checked that the package is well-formed and installs on OS X.

I also notice that you included stdint after stdlib, while Stephen does the opposite in his patch [here](http://www.freebsd.org/cgi/cvsweb.cgi/ports/math/sage/files/spkg-patch-flintqs-20070817.p6_-_patches_TonelliShanks.h.patch?rev=1.1;content-type=text%2Fplain).  I assume this also doesn't matter?  Sorry for the very stupid questions.

---
See also #11792?



---

archive/issue_comments_091852.json:
```json
{
    "body": "<a id='comment:12'></a>Replying to [comment:11 kcrisman]:\n> > > Jeroen, did you try this out on some of the buildbots?\n\n> > No, but I don't expect problems. What harm could an additional header file do?\n> I don't know, that's why I asked!  Extra imports in Python sometimes cause all kinds of circularity issues or slowdowns, and I don't know enough about C to say either way.\n\nIn theory this could cause problems, but presumably the C headers are well-designed such that these problems don't occur.\n\n> I also notice that you included stdint after stdlib, while Stephen does the opposite in his patch\n\nIt also shouldn't matter. The way I did it looked more natural, but there's really no reason.",
    "created_at": "2012-06-21T13:14:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91852",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:12'></a>Replying to [comment:11 kcrisman]:
> > > Jeroen, did you try this out on some of the buildbots?

> > No, but I don't expect problems. What harm could an additional header file do?
> I don't know, that's why I asked!  Extra imports in Python sometimes cause all kinds of circularity issues or slowdowns, and I don't know enough about C to say either way.

In theory this could cause problems, but presumably the C headers are well-designed such that these problems don't occur.

> I also notice that you included stdint after stdlib, while Stephen does the opposite in his patch

It also shouldn't matter. The way I did it looked more natural, but there's really no reason.



---

archive/issue_comments_091853.json:
```json
{
    "body": "<a id='comment:13'></a>> It also shouldn't matter. The way I did it looked more natural, but there's really no reason.\nOk. \n\nI'm even having trouble finding where this is used.  `sage -grep` with various upper/lowercase of flintqs does nothing, it's not in `module_list.py`, in `spkg/standard/deps` it only has dependencies...  and I'm going to need CPU firepower in a few minutes, can't do a full doctest right now.  Weird.",
    "created_at": "2012-06-21T13:37:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91853",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:13'></a>> It also shouldn't matter. The way I did it looked more natural, but there's really no reason.
Ok. 

I'm even having trouble finding where this is used.  `sage -grep` with various upper/lowercase of flintqs does nothing, it's not in `module_list.py`, in `spkg/standard/deps` it only has dependencies...  and I'm going to need CPU firepower in a few minutes, can't do a full doctest right now.  Weird.



---

archive/issue_comments_091854.json:
```json
{
    "body": "<a id='comment:14'></a>Replying to [comment:13 kcrisman]:\n> I'm even having trouble finding where this is used.  `sage -grep` with various upper/lowercase of flintqs does nothing, it's not in `module_list.py`, in `spkg/standard/deps` it only has dependencies...  and I'm going to need CPU firepower in a few minutes, can't do a full doctest right now.  Weird.\n\n\nThe interface is `sage/interfaces/qsieve.py`.",
    "created_at": "2012-06-21T19:04:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91854",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:14'></a>Replying to [comment:13 kcrisman]:
> I'm even having trouble finding where this is used.  `sage -grep` with various upper/lowercase of flintqs does nothing, it's not in `module_list.py`, in `spkg/standard/deps` it only has dependencies...  and I'm going to need CPU firepower in a few minutes, can't do a full doctest right now.  Weird.


The interface is `sage/interfaces/qsieve.py`.



---

archive/issue_comments_091855.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2012-06-21T19:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91855",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_events_023741.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T19:17:13Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "milestone": "sage-5.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9544#event-23741"
}
```



---

archive/issue_events_023742.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2012-06-21T19:17:13Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "milestone": "sage-5.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9544#event-23742"
}
```



---

archive/issue_comments_091856.json:
```json
{
    "body": "<a id='comment:15'></a>> > I'm even having trouble finding where this is used.  `sage -grep` with various upper/lowercase of flintqs does nothing, it's not in `module_list.py`, in `spkg/standard/deps` it only has dependencies...  and I'm going to need CPU firepower in a few minutes, can't do a full doctest right now.  Weird.\n\n> \n> The interface is `sage/interfaces/qsieve.py`.\n\n\nGreat, thanks.  That passes long tests, so since there really isn't any reason anything should be bad, we are good to go.  (Yes, I did `sage -b`.)\n\nSince p7 is also 5.1, tentatively putting it there, but feel free to do whatever is convenient.",
    "created_at": "2012-06-21T19:17:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91856",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:15'></a>> > I'm even having trouble finding where this is used.  `sage -grep` with various upper/lowercase of flintqs does nothing, it's not in `module_list.py`, in `spkg/standard/deps` it only has dependencies...  and I'm going to need CPU firepower in a few minutes, can't do a full doctest right now.  Weird.

> 
> The interface is `sage/interfaces/qsieve.py`.


Great, thanks.  That passes long tests, so since there really isn't any reason anything should be bad, we are good to go.  (Yes, I did `sage -b`.)

Since p7 is also 5.1, tentatively putting it there, but feel free to do whatever is convenient.



---

archive/issue_comments_091857.json:
```json
{
    "body": "<a id='comment:16'></a>Replying to [comment:15 kcrisman]:\n> Since p7 is also 5.1, tentatively putting it there, but feel free to do whatever is convenient.\n\n.p7 still needs review...",
    "created_at": "2012-06-21T19:33:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91857",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>Replying to [comment:15 kcrisman]:
> Since p7 is also 5.1, tentatively putting it there, but feel free to do whatever is convenient.

.p7 still needs review...



---

archive/issue_events_023743.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-06-28T09:36:36Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9544#event-23743"
}
```



---

archive/issue_comments_091858.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2012-06-28T09:36:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9544",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9544#issuecomment-91858",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
