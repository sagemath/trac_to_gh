# Issue 9421: desolve mixes user parameters and integration constants

archive/issues_009421.json:
```json
{
    "body": "Consider\n\n```\nsage: var('t')\nsage: x=function('x',t)\nsage: var('c')\nsage: desolve(diff(x,t)+2*x==t^2-2*t+c,x,ivar=t).expand()\nc*e^(-2*t) + 1/2*t^2 + 1/2*c - 3/2*t + 3/4\n```\nHere the first occurrence of `c` is an integration constant,\nwhereas the second one is the parameter in the ODE:\n\n```\nsage: var('d')\nsage: desolve(diff(x,t)+2*x==t^2-2*t+d,x,ivar=t).expand()\nc*e^(-2*t) + 1/2*t^2 + 1/2*d - 3/2*t + 3/4\n```\nIn case the ODE contains `c`, desolve should choose another\nname for the integration constant.\n\nAssignee: @burcin\n\nCC:  @robert-marik @kcrisman\n\nReviewer: Ralf Stephan\n\nAuthor: Paul Zimmermann\n\nResolution: duplicate\n\nIssue created by migration from https://trac.sagemath.org/ticket/9421\n\n",
    "closed_at": "2014-03-31T15:03:53Z",
    "created_at": "2010-07-03T13:56:02Z",
    "labels": [
        "component: calculus",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-6.2",
    "title": "desolve mixes user parameters and integration constants",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9421",
    "user": "https://github.com/zimmermann6"
}
```
Consider

```
sage: var('t')
sage: x=function('x',t)
sage: var('c')
sage: desolve(diff(x,t)+2*x==t^2-2*t+c,x,ivar=t).expand()
c*e^(-2*t) + 1/2*t^2 + 1/2*c - 3/2*t + 3/4
```
Here the first occurrence of `c` is an integration constant,
whereas the second one is the parameter in the ODE:

```
sage: var('d')
sage: desolve(diff(x,t)+2*x==t^2-2*t+d,x,ivar=t).expand()
c*e^(-2*t) + 1/2*t^2 + 1/2*d - 3/2*t + 3/4
```
In case the ODE contains `c`, desolve should choose another
name for the integration constant.

Assignee: @burcin

CC:  @robert-marik @kcrisman

Reviewer: Ralf Stephan

Author: Paul Zimmermann

Resolution: duplicate

Issue created by migration from https://trac.sagemath.org/ticket/9421





---

archive/issue_comments_107221.json:
```json
{
    "body": "<a id='comment:1'></a>This is a part of more general problem which has been reported in #6882.",
    "created_at": "2010-07-04T15:52:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107221",
    "user": "https://github.com/robert-marik"
}
```

<a id='comment:1'></a>This is a part of more general problem which has been reported in #6882.



---

archive/issue_events_023259.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9421#event-23259"
}
```



---

archive/issue_comments_107222.json:
```json
{
    "body": "Attachment [trac_9421.patch](tarball://root/attachments/some-uuid/ticket9421/trac_9421.patch) by @zimmermann6 created at 2013-08-25 13:25:17",
    "created_at": "2013-08-25T13:25:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107222",
    "user": "https://github.com/zimmermann6"
}
```

Attachment [trac_9421.patch](tarball://root/attachments/some-uuid/ticket9421/trac_9421.patch) by @zimmermann6 created at 2013-08-25 13:25:17



---

archive/issue_comments_107223.json:
```json
{
    "body": "Changing author from \"\" to \"Paul Zimmermann\"",
    "created_at": "2013-08-25T13:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107223",
    "user": "https://github.com/zimmermann6"
}
```

Changing author from "" to "Paul Zimmermann"



---

archive/issue_comments_107224.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-08-25T13:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107224",
    "user": "https://github.com/zimmermann6"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_107225.json:
```json
{
    "body": "<a id='comment:4'></a>waiting for the general problem to be solved, the attached patch prints a warning if the given equation contains the variable `c`.\n\nPaul",
    "created_at": "2013-08-25T13:27:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107225",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:4'></a>waiting for the general problem to be solved, the attached patch prints a warning if the given equation contains the variable `c`.

Paul



---

archive/issue_events_023260.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9421#event-23260"
}
```



---

archive/issue_events_023261.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9421#event-23261"
}
```



---

archive/issue_comments_107226.json:
```json
{
    "body": "<a id='comment:6'></a>I will OK this if you have a look at #8734 in turn, please 8)  See also #16007",
    "created_at": "2014-03-25T10:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107226",
    "user": "https://github.com/rwst"
}
```

<a id='comment:6'></a>I will OK this if you have a look at #8734 in turn, please 8)  See also #16007



---

archive/issue_comments_107227.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Ralf Stephan\"",
    "created_at": "2014-03-25T10:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107227",
    "user": "https://github.com/rwst"
}
```

Changing reviewer from "" to "Ralf Stephan"



---

archive/issue_comments_107228.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2014-03-25T10:15:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107228",
    "user": "https://github.com/rwst"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_107229.json:
```json
{
    "body": "<a id='comment:7'></a>thus should we have a dependency on #8734?\n\nPaul",
    "created_at": "2014-03-25T21:07:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107229",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:7'></a>thus should we have a dependency on #8734?

Paul



---

archive/issue_comments_107230.json:
```json
{
    "body": "<a id='comment:8'></a>Replying to [zimmerma](#comment%3A7):\n> thus should we have a dependency on #8734?\n\n\nThen everything waits for that review, which could take forever. But I want the warning now.",
    "created_at": "2014-03-26T04:42:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107230",
    "user": "https://github.com/rwst"
}
```

<a id='comment:8'></a>Replying to [zimmerma](#comment%3A7):
> thus should we have a dependency on #8734?


Then everything waits for that review, which could take forever. But I want the warning now.



---

archive/issue_comments_107231.json:
```json
{
    "body": "<a id='comment:9'></a>You might want to consider this one too:\n\n```\nsage: desolve(diff(f(x),x,x)-f(x),f(x))\nk2*e^(-x) + k1*e^x\n```\nWe can recognize the variables as distinct before they are converted from maxima:\n\n```\nsage: function('f',x)\nf(x)\nsage: var('c')\nc\nsage: V=diff(f(x),x)-f(x)+c\nsage: v=maxima_calculus(V)\nsage: v.ode2(f(x),x)\n'f(x)=(c*%e^-x+%c)*%e^x\nsage: v.ode2(f(x),x).ecl()\n<ECL: ((MEQUAL SIMP) ((%F SIMP) $X)\n ((MTIMES SIMP)\n  ((MPLUS SIMP) $%C\n   ((MTIMES SIMP) $C ((MEXPT SIMP) $%E ((MTIMES SIMP) -1 $X))))\n  ((MEXPT SIMP) $%E $X)))>\n```\nso perhaps the right solution is to warn when sage's \"forget the %\" causes a name collision (with the righter solution being: making sage's \"forget the %\" more intelligent, so that collisions can be avoided)",
    "created_at": "2014-03-26T05:48:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107231",
    "user": "https://github.com/nbruin"
}
```

<a id='comment:9'></a>You might want to consider this one too:

```
sage: desolve(diff(f(x),x,x)-f(x),f(x))
k2*e^(-x) + k1*e^x
```
We can recognize the variables as distinct before they are converted from maxima:

```
sage: function('f',x)
f(x)
sage: var('c')
c
sage: V=diff(f(x),x)-f(x)+c
sage: v=maxima_calculus(V)
sage: v.ode2(f(x),x)
'f(x)=(c*%e^-x+%c)*%e^x
sage: v.ode2(f(x),x).ecl()
<ECL: ((MEQUAL SIMP) ((%F SIMP) $X)
 ((MTIMES SIMP)
  ((MPLUS SIMP) $%C
   ((MTIMES SIMP) $C ((MEXPT SIMP) $%E ((MTIMES SIMP) -1 $X))))
  ((MEXPT SIMP) $%E $X)))>
```
so perhaps the right solution is to warn when sage's "forget the %" causes a name collision (with the righter solution being: making sage's "forget the %" more intelligent, so that collisions can be avoided)



---

archive/issue_comments_107232.json:
```json
{
    "body": "<a id='comment:10'></a>With #16007 the output is now\n\n```\nsage: sage: x=function('x',t)\nsage: sage: var('c')\nc\nsage: sage: desolve(diff(x,t)+2*x==t^2-2*t+c,x,ivar=t).expand()\n1/2*t^2 + _C*e^(-2*t) + 1/2*c - 3/2*t + 3/4\n\nsage: desolve(diff(f(x),x,x)-f(x),f(x))\n_K2*e^(-x) + _K1*e^x\n```\nAs that's a simple and fine solution instead of a warning or an extended patch I would be glad if someone could review that one-liner.",
    "created_at": "2014-03-26T16:03:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107232",
    "user": "https://github.com/rwst"
}
```

<a id='comment:10'></a>With #16007 the output is now

```
sage: sage: x=function('x',t)
sage: sage: var('c')
c
sage: sage: desolve(diff(x,t)+2*x==t^2-2*t+c,x,ivar=t).expand()
1/2*t^2 + _C*e^(-2*t) + 1/2*c - 3/2*t + 3/4

sage: desolve(diff(f(x),x,x)-f(x),f(x))
_K2*e^(-x) + _K1*e^x
```
As that's a simple and fine solution instead of a warning or an extended patch I would be glad if someone could review that one-liner.



---

archive/issue_comments_107233.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2014-03-31T15:03:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9421#issuecomment-107233",
    "user": "https://github.com/vbraun"
}
```

Resolution: duplicate



---

archive/issue_events_023262.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-03-31T15:03:53Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9421",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9421#event-23262"
}
```
