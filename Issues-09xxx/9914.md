# Issue 9914: Remove some libraries from Cython modules in module_list.py

archive/issues_009913.json:
```json
{
    "body": "Many extension modules in `devel/sage/module_list.py` are linked against libraries they do not use, some at least not directly.\n\nThis ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.\n\n---\n\nApply [attachment:trac_9914.patch]\n\n**Assignee:** @nexttime\n\n**CC:**  @jhpalmieri @mwhansen @qed777 @kcrisman jpflori\n\n**Keywords:** module_list.py PARI ImportError newforms homspace mwrank upgrade update\n\n**Reviewer:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/9914\n\n",
    "closed_at": "2014-02-04T21:10:19Z",
    "created_at": "2010-09-16T08:16:45Z",
    "labels": [
        "component: build",
        "bug",
        "wontfix"
    ],
    "title": "Remove some libraries from Cython modules in module_list.py",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/9914",
    "user": "https://github.com/nexttime"
}
```
Many extension modules in `devel/sage/module_list.py` are linked against libraries they do not use, some at least not directly.

This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.

---

Apply [attachment:trac_9914.patch]

**Assignee:** @nexttime

**CC:**  @jhpalmieri @mwhansen @qed777 @kcrisman jpflori

**Keywords:** module_list.py PARI ImportError newforms homspace mwrank upgrade update

**Reviewer:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/9914





---

archive/issue_comments_091383.json:
```json
{
    "body": "**Changing keywords** from \"module_list.py\" to \"module_list.py PARI ImportError newforms homspace mwrank upgrade update\".",
    "created_at": "2010-09-16T10:44:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91383",
    "user": "https://github.com/nexttime"
}
```

**Changing keywords** from "module_list.py" to "module_list.py PARI ImportError newforms homspace mwrank upgrade update".



---

archive/issue_events_074344.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-16T10:44:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74344"
}
```



---

archive/issue_comments_091384.json:
```json
{
    "body": "**Author:** Leif Leonhardy",
    "created_at": "2010-09-16T10:44:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91384",
    "user": "https://github.com/nexttime"
}
```

**Author:** Leif Leonhardy



---

archive/issue_comments_091385.json:
```json
{
    "body": "<a id='comment:1'></a>\nI've attached a first patch that removes PARI from `libraries` of:\n* `sage.libs.cremona.homspace`\n* `sage.libs.cremona.newforms`\n* `sage.libs.mwrank.mwrank`\n\nHope this doesn't cause trouble on non-Unices (like e.g. Cygwin), otherwise we would have to add `uname_specific(...)` (which is defined in `module_list.py` for such purposes).\n\n(This patch fixes *one* of the upgrade issues discussed at #9896; these are in general not limited to MacOS X.)\n\nSetting this to \"needs review\" to perhaps get it merged (early) into Sage 4.6.*, though more changes (to `module_list.py`) are desirable.",
    "created_at": "2010-09-16T10:44:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91385",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:1'></a>
I've attached a first patch that removes PARI from `libraries` of:
* `sage.libs.cremona.homspace`
* `sage.libs.cremona.newforms`
* `sage.libs.mwrank.mwrank`

Hope this doesn't cause trouble on non-Unices (like e.g. Cygwin), otherwise we would have to add `uname_specific(...)` (which is defined in `module_list.py` for such purposes).

(This patch fixes *one* of the upgrade issues discussed at #9896; these are in general not limited to MacOS X.)

Setting this to "needs review" to perhaps get it merged (early) into Sage 4.6.*, though more changes (to `module_list.py`) are desirable.



---

archive/issue_comments_091386.json:
```json
{
    "body": "<a id='comment:2'></a>\nReplying to [leif](#comment%3A1):\n\n> Hope this doesn't cause trouble on non-Unices (like e.g. Cygwin),\n\n\nI assume you tested this on Linux - that is a non-Unix! \n\nSolaris, recent OS X, AIX 5.3 or later and one of the more recent HP-UX releases are Unix. \n\nEven the {{{df}} command of Linux violates the Unix standard. \n\nDave",
    "created_at": "2010-09-16T13:04:43Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91386",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:2'></a>
Replying to [leif](#comment%3A1):

> Hope this doesn't cause trouble on non-Unices (like e.g. Cygwin),


I assume you tested this on Linux - that is a non-Unix! 

Solaris, recent OS X, AIX 5.3 or later and one of the more recent HP-UX releases are Unix. 

Even the {{{df}} command of Linux violates the Unix standard. 

Dave



---

archive/issue_comments_091387.json:
```json
{
    "body": "<a id='comment:3'></a>\nReplying to [drkirkby](#comment%3A2):\n> Replying to [leif](#comment%3A1):\n> \n> > Hope this doesn't cause trouble on non-Unices (like e.g. Cygwin),\n\n> \n> I assume you tested this on Linux\n\n\nI did.\n\n> - that is a non-Unix! \n\n\nU[nN][iI][xX] is a trademark, but also a stretchable term. ;-)\n\nShould I say U**x-like OSs?",
    "created_at": "2010-09-16T13:13:10Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91387",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:3'></a>
Replying to [drkirkby](#comment%3A2):
> Replying to [leif](#comment%3A1):
> 
> > Hope this doesn't cause trouble on non-Unices (like e.g. Cygwin),

> 
> I assume you tested this on Linux


I did.

> - that is a non-Unix! 


U[nN][iI][xX] is a trademark, but also a stretchable term. ;-)

Should I say U**x-like OSs?



---

archive/issue_comments_091388.json:
```json
{
    "body": "<a id='comment:4'></a>\nSorry, but this will certainly break on Cygwin!\n\nJust have a look at the Makefile for the \"g0nntl\" library (in the eclib spkg, see the file /src/g0n/Makefile, line 41):\n\nNTLLFLAGS = -L$(NTLLIBDIR) -lntl -lgmp -lpari\n\nThis means that the g0nntl library has the pari library as a dependency. And on Cywgin (Windows in general), not only the \"primary\" libraries have to be declared as dependencies during compile time (i.e. for building e.g. an extension module) --- but *all* libraries, i.e. also the \"secondary\", \"tertiary\", and so on ... (one may consider this a bug, a deficiency, a nuisance, whatever --- we have to live with it)\n\nI've changed the title of the ticket somewhat, to reflect this, and added a line to the description.\n\nIf this ticket is meant to fix some OS X specific issue (see the main ticket at trac #9896), I'd propose to use the \"uname_specific\" feature in such a way, that the change to the module_list.py affects Darwin --- and only Darwin.\n\nEnsuring that the change is visible on only as few system as possible, as few systems as possible are affected of a possible breakage by such a change.",
    "created_at": "2010-09-16T19:14:24Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91388",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

<a id='comment:4'></a>
Sorry, but this will certainly break on Cygwin!

Just have a look at the Makefile for the "g0nntl" library (in the eclib spkg, see the file /src/g0n/Makefile, line 41):

NTLLFLAGS = -L$(NTLLIBDIR) -lntl -lgmp -lpari

This means that the g0nntl library has the pari library as a dependency. And on Cywgin (Windows in general), not only the "primary" libraries have to be declared as dependencies during compile time (i.e. for building e.g. an extension module) --- but *all* libraries, i.e. also the "secondary", "tertiary", and so on ... (one may consider this a bug, a deficiency, a nuisance, whatever --- we have to live with it)

I've changed the title of the ticket somewhat, to reflect this, and added a line to the description.

If this ticket is meant to fix some OS X specific issue (see the main ticket at trac #9896), I'd propose to use the "uname_specific" feature in such a way, that the change to the module_list.py affects Darwin --- and only Darwin.

Ensuring that the change is visible on only as few system as possible, as few systems as possible are affected of a possible breakage by such a change.



---

archive/issue_comments_091389.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,7 +1,9 @@\n Many extension modules in `devel/sage/module_list.py` are linked against libraries they do not use, some at least not directly.\n \n-This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble. \n+This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.\n \n See e.g. [this comment](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) for a discussion why.\n \n This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.\n+\n+ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...\n``````\n",
    "created_at": "2010-09-16T19:14:24Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91389",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,7 +1,9 @@
 Many extension modules in `devel/sage/module_list.py` are linked against libraries they do not use, some at least not directly.
 
-This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble. 
+This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.
 
 See e.g. [this comment](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) for a discussion why.
 
 This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.
+
+ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...
``````




---

archive/issue_events_074345.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber",
    "created_at": "2010-09-16T19:14:24Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "rename": {
        "from": "Remove unused libraries from extension modules",
        "to": "Remove libraries from extension modules when they are not needed there at build time"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74345"
}
```



---

archive/issue_events_074346.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber",
    "created_at": "2010-09-16T19:14:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74346"
}
```



---

archive/issue_events_074347.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber",
    "created_at": "2010-09-16T19:14:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74347"
}
```



---

archive/issue_comments_091390.json:
```json
{
    "body": "<a id='comment:5'></a>\nReplying to [GeorgSWeber](#comment%3A4):\n> Sorry, but this will certainly break on Cygwin!\n\n\nDid you read the comments here or at the other ticket? I explicitly asked if this is needed on Cygwin (twice), cc'ed Mike, and suggested to use `uname_specific()` in that case.\n\n> Just have a look at the Makefile for the \"g0nntl\" library (in the eclib spkg, see the file /src/g0n/Makefile, line 41):\n> \n\n\n> NTLLFLAGS = -L$(NTLLIBDIR) -lntl -lgmp -lpari\n\n\nBad example, since you can safely remove PARI there (too; and also from `NTLLFLAGS` in all other Makefiles); NTL uses GMP, but not PARI. (Only `procs/parifact.*` uses PARI, so PARI has to be linked to all executables and shared libraries that contain / use *that*, e.g. `libjcntl.{so,dylib,dll`}, which in turn is linked to `libg0nntl.*`.)\n\n(Note that \"pari\" is **not** listed in the `libraries` of `sage.libs.cremona.mat`, though \"jcntl\" is, and \"g0nntl\", too.)\n\nEven if e.g. `libg0nntl.so` directly depended on PARI, none of the extension modules whose `libraries` I've changed does.\n\nThere's a difference between dynamically and statically linking btw.\n\n> I've changed the title of the ticket somewhat, to reflect this, and added a line to the description.\n\n\nBy *\"removing ... from the extension modules\"* I meant removing the in fact (locally) unused libraries from the dynamic (dependencies) section, i.e. for example the `NEEDED` entries in ELF.\n\n> If this ticket is meant to fix some OS X specific issue (see the main ticket at trac #9896), I'd propose to use the \"uname_specific\" feature in such a way, that the change to the module_list.py affects Darwin --- and only Darwin.\n\n\nAgain, as mentioned in my first comment here, and also at #9896, this is a *general* problem which is unrelated to Darwin as the OS.\n\n> Ensuring that the change is visible on only as few system as possible, as few systems as possible are affected of a possible breakage by such a change.\n\n\nThe opposite is closer to what is needed: if at all, PARI has to be listed in `libraries` *only on Cygwin* (or MS Windows) if you're right (but see above); I'm not sure if it would be required on older Darwins as well.\n\nSo I'll update the patch to use `uname_specific()` (if that makes you happy ;-) - I'd really like to give it a try *as is* on Cygwin), which then should be tested (also) on MacOS X 10.4 (Tiger).",
    "created_at": "2010-09-17T00:05:25Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91390",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:5'></a>
Replying to [GeorgSWeber](#comment%3A4):
> Sorry, but this will certainly break on Cygwin!


Did you read the comments here or at the other ticket? I explicitly asked if this is needed on Cygwin (twice), cc'ed Mike, and suggested to use `uname_specific()` in that case.

> Just have a look at the Makefile for the "g0nntl" library (in the eclib spkg, see the file /src/g0n/Makefile, line 41):
> 


> NTLLFLAGS = -L$(NTLLIBDIR) -lntl -lgmp -lpari


Bad example, since you can safely remove PARI there (too; and also from `NTLLFLAGS` in all other Makefiles); NTL uses GMP, but not PARI. (Only `procs/parifact.*` uses PARI, so PARI has to be linked to all executables and shared libraries that contain / use *that*, e.g. `libjcntl.{so,dylib,dll`}, which in turn is linked to `libg0nntl.*`.)

(Note that "pari" is **not** listed in the `libraries` of `sage.libs.cremona.mat`, though "jcntl" is, and "g0nntl", too.)

Even if e.g. `libg0nntl.so` directly depended on PARI, none of the extension modules whose `libraries` I've changed does.

There's a difference between dynamically and statically linking btw.

> I've changed the title of the ticket somewhat, to reflect this, and added a line to the description.


By *"removing ... from the extension modules"* I meant removing the in fact (locally) unused libraries from the dynamic (dependencies) section, i.e. for example the `NEEDED` entries in ELF.

> If this ticket is meant to fix some OS X specific issue (see the main ticket at trac #9896), I'd propose to use the "uname_specific" feature in such a way, that the change to the module_list.py affects Darwin --- and only Darwin.


Again, as mentioned in my first comment here, and also at #9896, this is a *general* problem which is unrelated to Darwin as the OS.

> Ensuring that the change is visible on only as few system as possible, as few systems as possible are affected of a possible breakage by such a change.


The opposite is closer to what is needed: if at all, PARI has to be listed in `libraries` *only on Cygwin* (or MS Windows) if you're right (but see above); I'm not sure if it would be required on older Darwins as well.

So I'll update the patch to use `uname_specific()` (if that makes you happy ;-) - I'd really like to give it a try *as is* on Cygwin), which then should be tested (also) on MacOS X 10.4 (Tiger).



---

archive/issue_comments_091391.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [leif](#comment%3A5):\n> \n> Even if e.g. `libg0nntl.so` directly depended on PARI, none of the extension modules whose `libraries` I've changed does.\n> \n\n\nEven if the -lpari dependency in the build/compile call of the libg0nntl is technically superfluous, and/or none of the extension modules used libpari functionality in the end --- this parameter -lpari is *there* (in the Makefile line mentioned). This might be a bug in this eclib Makefile. Which probably doesn't matter on most systems, but might very well matter on Cygwin (and the presence of lpari in the module_list.py entries just a q'n'd workaround). Put in other words: the module_list.py patch might be incomplete without also updating (correcting?) this Makefile.\n\n> \n> So I'll update the patch to use `uname_specific()` (if that makes you happy ;-) - I'd really like to give it a try *as is* on Cygwin), which then should be tested (also) on MacOS X 10.4 (Tiger).\n\n\nSo both of us are kind of stuck here --- neither of us seems to have access to some Cygwin system, to do \"real life\" testing. Personally, I do have access to Mac OS X 10.4 systems (both MacIntel and MacPPC), but does that suffice to work on the ticket? I mean, wouldn't updating Sage-4.5.3 to Sage-4.6 still break on Cygwin (even if we fixed all other OS's)?\n\nIn general, such update problems are not new. The Sage build/update mechanisms have shortcomings that are well known. In the past, one had to (and did) give hints to them. I can't put my finger to a specific release or sage-devel thread right now, but the idea is as simple as powerful, I'll explain it at the example at hand.\n\nSolution:\n\nJust artificially bump up the version number of the eclib spkg.\n(No real changes are done to its contents --- and often in the past, even the update of the SPKG.txt was forgotten, but that's another matter, one should do that always).\n\nAs a result, during an update, the eclib spkg *will* be built anew, and as a consequence, also during \"sage -b\" the mentioned extensions are rebuilt. Et voila.\n\nLeif, I couldn't follow each and every of the recent threads on sage-devel and sage-release, let alone trac. Has this \"old way\" been discussed, or even considered (for Sage-4.6)? If not, should a message thread on sage-release be opened?\n\nI think there's a very good chance to get the update from Sage-4.5.3 to Sage-4.6 working, just by artificially bumping up the version numbers of a handful spkg's (in the sense I described above). \n\nCheers,\n\nGeorg",
    "created_at": "2010-09-17T10:36:19Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91391",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

<a id='comment:6'></a>
Replying to [leif](#comment%3A5):
> 
> Even if e.g. `libg0nntl.so` directly depended on PARI, none of the extension modules whose `libraries` I've changed does.
> 


Even if the -lpari dependency in the build/compile call of the libg0nntl is technically superfluous, and/or none of the extension modules used libpari functionality in the end --- this parameter -lpari is *there* (in the Makefile line mentioned). This might be a bug in this eclib Makefile. Which probably doesn't matter on most systems, but might very well matter on Cygwin (and the presence of lpari in the module_list.py entries just a q'n'd workaround). Put in other words: the module_list.py patch might be incomplete without also updating (correcting?) this Makefile.

> 
> So I'll update the patch to use `uname_specific()` (if that makes you happy ;-) - I'd really like to give it a try *as is* on Cygwin), which then should be tested (also) on MacOS X 10.4 (Tiger).


So both of us are kind of stuck here --- neither of us seems to have access to some Cygwin system, to do "real life" testing. Personally, I do have access to Mac OS X 10.4 systems (both MacIntel and MacPPC), but does that suffice to work on the ticket? I mean, wouldn't updating Sage-4.5.3 to Sage-4.6 still break on Cygwin (even if we fixed all other OS's)?

In general, such update problems are not new. The Sage build/update mechanisms have shortcomings that are well known. In the past, one had to (and did) give hints to them. I can't put my finger to a specific release or sage-devel thread right now, but the idea is as simple as powerful, I'll explain it at the example at hand.

Solution:

Just artificially bump up the version number of the eclib spkg.
(No real changes are done to its contents --- and often in the past, even the update of the SPKG.txt was forgotten, but that's another matter, one should do that always).

As a result, during an update, the eclib spkg *will* be built anew, and as a consequence, also during "sage -b" the mentioned extensions are rebuilt. Et voila.

Leif, I couldn't follow each and every of the recent threads on sage-devel and sage-release, let alone trac. Has this "old way" been discussed, or even considered (for Sage-4.6)? If not, should a message thread on sage-release be opened?

I think there's a very good chance to get the update from Sage-4.5.3 to Sage-4.6 working, just by artificially bumping up the version numbers of a handful spkg's (in the sense I described above). 

Cheers,

Georg



---

archive/issue_comments_091392.json:
```json
{
    "body": "<a id='comment:7'></a>\nReplying to [GeorgSWeber](#comment%3A6):\n> Solution:\n> \n> Just artificially bump up the version number of the eclib spkg.\n> (No real changes are done to its contents --- and often in the past, even the update of the SPKG.txt was forgotten, but that's another matter, one should do that always).\n> \n> As a result, during an update, the eclib spkg *will* be built anew, and as a consequence, also during \"sage -b\" the mentioned extensions are rebuilt. Et voila.\n\n\nThis doesn't work either, see http://trac.sagemath.org/sage_trac/ticket/9896#comment:16. (Bumping the patch level is equivalent to doing `./sage -f ...`.)\n\n\n> I think there's a very good chance to get the update from Sage-4.5.3 to Sage-4.6 working, just by artificially bumping up the version numbers of a handful spkg's (in the sense I described above). \n\n\nNevertheless, imagine upgrading MPIR (#8664). Do you want to bump the version numbers of dozens of packages? Changing `sage-spkg` to `sage-spkg -f` in `spkg/standard/deps` avoids this, but doesn't solve all problems we have with (re)building the Sage library.\n\nRobert B. wanted to make Cython smarter such that more of what's manually provided in `module_list.py` gets deduced automatically from the Cython source files (through pragmas), but the new Cython 0.13 doesn't yet support these enhancements.\n\nSo unfortunately we currently have to keep hacking `module_list.py` and `setup.py` to get around subtle dependency issues...\n\nWe might as an alternative add `depends = [ ... ]` to these extension modules to get them updated when ECLIB gets (I think in general not a bad idea), but this doesn't really address the PARI issue, i.e. that the library should IMHO not be listed there.\n\nThere are or have been btw. other weird things like `libcsage` and `libstdc++` being linked to each and every module, regardless of the language or if the module referenced symbols from there at all.\n\nI started cleaning up `module_list.py` month ago (which is quite tedious), but then Robert said we'd have a better solution in the near future...",
    "created_at": "2010-09-17T14:56:57Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91392",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
Replying to [GeorgSWeber](#comment%3A6):
> Solution:
> 
> Just artificially bump up the version number of the eclib spkg.
> (No real changes are done to its contents --- and often in the past, even the update of the SPKG.txt was forgotten, but that's another matter, one should do that always).
> 
> As a result, during an update, the eclib spkg *will* be built anew, and as a consequence, also during "sage -b" the mentioned extensions are rebuilt. Et voila.


This doesn't work either, see http://trac.sagemath.org/sage_trac/ticket/9896#comment:16. (Bumping the patch level is equivalent to doing `./sage -f ...`.)


> I think there's a very good chance to get the update from Sage-4.5.3 to Sage-4.6 working, just by artificially bumping up the version numbers of a handful spkg's (in the sense I described above). 


Nevertheless, imagine upgrading MPIR (#8664). Do you want to bump the version numbers of dozens of packages? Changing `sage-spkg` to `sage-spkg -f` in `spkg/standard/deps` avoids this, but doesn't solve all problems we have with (re)building the Sage library.

Robert B. wanted to make Cython smarter such that more of what's manually provided in `module_list.py` gets deduced automatically from the Cython source files (through pragmas), but the new Cython 0.13 doesn't yet support these enhancements.

So unfortunately we currently have to keep hacking `module_list.py` and `setup.py` to get around subtle dependency issues...

We might as an alternative add `depends = [ ... ]` to these extension modules to get them updated when ECLIB gets (I think in general not a bad idea), but this doesn't really address the PARI issue, i.e. that the library should IMHO not be listed there.

There are or have been btw. other weird things like `libcsage` and `libstdc++` being linked to each and every module, regardless of the language or if the module referenced symbols from there at all.

I started cleaning up `module_list.py` month ago (which is quite tedious), but then Robert said we'd have a better solution in the near future...



---

archive/issue_events_074348.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-17T14:56:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs work",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74348"
}
```



---

archive/issue_events_074349.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-17T14:56:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74349"
}
```



---

archive/issue_comments_091393.json:
```json
{
    "body": "<a id='comment:8'></a>\nMike, do you think the changes above will cause problems on Cygwin?",
    "created_at": "2010-09-22T23:40:30Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91393",
    "user": "https://github.com/qed777"
}
```

<a id='comment:8'></a>
Mike, do you think the changes above will cause problems on Cygwin?



---

archive/issue_comments_091394.json:
```json
{
    "body": "<a id='comment:9'></a>\nIncidentally there came up a related discussion in an otherwise unrelated [sage-devel thread](http://groups.google.com/group/sage-devel/msg/28dedefe6d85eaa3).",
    "created_at": "2010-10-26T22:34:02Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91394",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>
Incidentally there came up a related discussion in an otherwise unrelated [sage-devel thread](http://groups.google.com/group/sage-devel/msg/28dedefe6d85eaa3).



---

archive/issue_comments_091395.json:
```json
{
    "body": "<a id='comment:10'></a>\nThese (three) changes don't cause any problem on Cygwin with Sage 4.6.",
    "created_at": "2010-11-10T18:33:51Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91395",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:10'></a>
These (three) changes don't cause any problem on Cygwin with Sage 4.6.



---

archive/issue_events_074350.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber",
    "created_at": "2010-11-13T20:20:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74350"
}
```



---

archive/issue_events_074351.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber",
    "created_at": "2010-11-13T20:20:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74351"
}
```



---

archive/issue_comments_091396.json:
```json
{
    "body": "<a id='comment:11'></a>\nGood to know,\n\nsorry that I was wrong, Leif: please accept my apologies!\n\n\nCheers,\nGeorg",
    "created_at": "2010-11-13T20:20:58Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91396",
    "user": "https://trac.sagemath.org/admin/accounts/users/GeorgSWeber"
}
```

<a id='comment:11'></a>
Good to know,

sorry that I was wrong, Leif: please accept my apologies!


Cheers,
Georg



---

archive/attachments_012858.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9914.patch",
    "asset_url": "tarball://root/attachments/ticket9914/trac_9914.patch",
    "created_at": "2012-03-29T05:18:40Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket9914/trac_9914.patch",
    "user": "https://github.com/mwhansen"
}
```



---

archive/issue_comments_091397.json:
```json
{
    "body": "<a id='comment:12'></a>\nAttachment [trac_9914.patch](https://github.com/sagemath/sage/files/ticket9914/trac_9914.patch) by @mwhansen created at 2012-03-29 05:18:40\n\nI've added a rebased patch.\n\nApply trac_9914.patch\n\nAssuming tests pass, I'll give this a positive review.",
    "created_at": "2012-03-29T05:18:40Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91397",
    "user": "https://github.com/mwhansen"
}
```

<a id='comment:12'></a>
Attachment [trac_9914.patch](https://github.com/sagemath/sage/files/ticket9914/trac_9914.patch) by @mwhansen created at 2012-03-29 05:18:40

I've added a rebased patch.

Apply trac_9914.patch

Assuming tests pass, I'll give this a positive review.



---

archive/issue_comments_091398.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,3 +7,6 @@\n This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.\n \n ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...\n+\n+Apply trac_9914.patch\n+\n``````\n",
    "created_at": "2012-03-29T05:18:40Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91398",
    "user": "https://github.com/mwhansen"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,3 +7,6 @@
 This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.
 
 ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...
+
+Apply trac_9914.patch
+
``````




---

archive/issue_events_074352.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-05T21:20:37Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "rename": {
        "from": "Remove libraries from extension modules when they are not needed there at build time",
        "to": "Remove some libraries from Cython modules in module_list.py"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74352"
}
```



---

archive/issue_comments_091399.json:
```json
{
    "body": "<a id='comment:14'></a>\nThe original title was *\"Remove unused libraries from extension modules\"*. ;-)\n\n(Wasn't me who changed that.)",
    "created_at": "2012-04-05T22:05:31Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91399",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:14'></a>
The original title was *"Remove unused libraries from extension modules"*. ;-)

(Wasn't me who changed that.)



---

archive/issue_events_074353.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-07T06:58:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74353"
}
```



---

archive/issue_events_074354.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-04-07T06:58:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74354"
}
```



---

archive/issue_comments_091400.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,12 +1,7 @@\n Many extension modules in `devel/sage/module_list.py` are linked against libraries they do not use, some at least not directly.\n-\n-This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.\n-\n-See e.g. [this comment](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) for a discussion why.\n \n This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.\n \n ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...\n \n-Apply trac_9914.patch\n-\n+Apply [attachment:trac_9914.patch]\n``````\n",
    "created_at": "2012-04-07T06:58:51Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91400",
    "user": "https://github.com/jdemeyer"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,12 +1,7 @@
 Many extension modules in `devel/sage/module_list.py` are linked against libraries they do not use, some at least not directly.
-
-This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.
-
-See e.g. [this comment](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) for a discussion why.
 
 This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.
 
 ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...
 
-Apply trac_9914.patch
-
+Apply [attachment:trac_9914.patch]
``````




---

archive/issue_comments_091401.json:
```json
{
    "body": "<a id='comment:15'></a>\nPlease explain the rationale for this patch.  [The comment you linked to](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) does not explain this.  And the following sentence is also very vague: \"\n> This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.\n",
    "created_at": "2012-04-07T06:58:51Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91401",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:15'></a>
Please explain the rationale for this patch.  [The comment you linked to](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) does not explain this.  And the following sentence is also very vague: "
> This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.




---

archive/issue_comments_091402.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe modules you are removing \"-lpari\" from are actually linked against pari, so I think \"pari\" should be kept.\n\nThe following have been built with this patch applied:\n\n```\n(sage-sh) jdemeyer@boxen:lib.linux-x86_64-2.7$ ldd sage/libs/mwrank/mwrank.so\n        linux-vdso.so.1 =>  (0x00007ffff6dfd000)\n        libcsage.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcsage.so (0x00007febee7b5000)\n        libcurvesntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcurvesntl.so (0x00007febee49a000)\n        libg0nntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libg0nntl.so (0x00007febee23c000)\n        libjcntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libjcntl.so (0x00007febedf3b000)\n        librankntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/librankntl.so (0x00007febedc8a000)\n        libntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libntl.so (0x00007febed8a5000)\n        libgmp.so.7 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmp.so.7 (0x00007febed62d000)\n        libgmpxx.so.1 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmpxx.so.1 (0x00007febed426000)\n        libstdc++.so.6 => /home/jdemeyer/local/lib64/libstdc++.so.6 (0x00007febed121000)\n        libpython2.7.so.1.0 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpython2.7.so.1.0 (0x00007febecd4d000)\n        libm.so.6 => /lib/libm.so.6 (0x00007febecab7000)\n        libgcc_s.so.1 => /home/jdemeyer/local/lib64/libgcc_s.so.1 (0x00007febec8a2000)\n        libpthread.so.0 => /lib/libpthread.so.0 (0x00007febec686000)\n        libc.so.6 => /lib/libc.so.6 (0x00007febec323000)\n        libpari-gmp.so.3 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpari-gmp.so.3 (0x00007febebc61000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007febeebf0000)\n        libdl.so.2 => /lib/libdl.so.2 (0x00007febeba5c000)\n        libutil.so.1 => /lib/libutil.so.1 (0x00007febeb859000)\n```\n\n```\n(sage-sh) jdemeyer@boxen:lib.linux-x86_64-2.7$ ldd sage/libs/cremona/homspace.so\n        linux-vdso.so.1 =>  (0x00007fff8adfd000)\n        libcsage.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcsage.so (0x00007fa382917000)\n        libg0nntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libg0nntl.so (0x00007fa3826b8000)\n        libjcntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libjcntl.so (0x00007fa3823b7000)\n        libgmpxx.so.1 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmpxx.so.1 (0x00007fa3821b1000)\n        libntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libntl.so (0x00007fa381dcb000)\n        libgmp.so.7 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmp.so.7 (0x00007fa381b53000)\n        libstdc++.so.6 => /home/jdemeyer/local/lib64/libstdc++.so.6 (0x00007fa38184e000)\n        libcurvesntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcurvesntl.so (0x00007fa381533000)\n        libpython2.7.so.1.0 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpython2.7.so.1.0 (0x00007fa38115f000)\n        libm.so.6 => /lib/libm.so.6 (0x00007fa380eca000)\n        libgcc_s.so.1 => /home/jdemeyer/local/lib64/libgcc_s.so.1 (0x00007fa380cb4000)\n        libpthread.so.0 => /lib/libpthread.so.0 (0x00007fa380a98000)\n        libc.so.6 => /lib/libc.so.6 (0x00007fa380736000)\n        libpari-gmp.so.3 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpari-gmp.so.3 (0x00007fa380073000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007fa382d38000)\n        libdl.so.2 => /lib/libdl.so.2 (0x00007fa37fe6f000)\n        libutil.so.1 => /lib/libutil.so.1 (0x00007fa37fc6b000)\n```\n\n```\n(sage-sh) jdemeyer@boxen:lib.linux-x86_64-2.7$ ldd sage/libs/cremona/newforms.so\n        linux-vdso.so.1 =>  (0x00007fff60bfd000)\n        libcsage.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcsage.so (0x00007fcc585fb000)\n        libg0nntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libg0nntl.so (0x00007fcc5839c000)\n        libjcntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libjcntl.so (0x00007fcc5809b000)\n        libgmpxx.so.1 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmpxx.so.1 (0x00007fcc57e95000)\n        libntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libntl.so (0x00007fcc57aaf000)\n        libgmp.so.7 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmp.so.7 (0x00007fcc57837000)\n        libstdc++.so.6 => /home/jdemeyer/local/lib64/libstdc++.so.6 (0x00007fcc57532000)\n        libcurvesntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcurvesntl.so (0x00007fcc57217000)\n        libpython2.7.so.1.0 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpython2.7.so.1.0 (0x00007fcc56e43000)\n        libm.so.6 => /lib/libm.so.6 (0x00007fcc56bae000)\n        libgcc_s.so.1 => /home/jdemeyer/local/lib64/libgcc_s.so.1 (0x00007fcc56998000)\n        libpthread.so.0 => /lib/libpthread.so.0 (0x00007fcc5677c000)\n        libc.so.6 => /lib/libc.so.6 (0x00007fcc5641a000)\n        libpari-gmp.so.3 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpari-gmp.so.3 (0x00007fcc55d57000)\n        /lib64/ld-linux-x86-64.so.2 (0x00007fcc58a1e000)\n        libdl.so.2 => /lib/libdl.so.2 (0x00007fcc55b53000)\n        libutil.so.1 => /lib/libutil.so.1 (0x00007fcc5594f000)\n```",
    "created_at": "2012-04-07T06:59:28Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91402",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:16'></a>
The modules you are removing "-lpari" from are actually linked against pari, so I think "pari" should be kept.

The following have been built with this patch applied:

```
(sage-sh) jdemeyer@boxen:lib.linux-x86_64-2.7$ ldd sage/libs/mwrank/mwrank.so
        linux-vdso.so.1 =>  (0x00007ffff6dfd000)
        libcsage.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcsage.so (0x00007febee7b5000)
        libcurvesntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcurvesntl.so (0x00007febee49a000)
        libg0nntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libg0nntl.so (0x00007febee23c000)
        libjcntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libjcntl.so (0x00007febedf3b000)
        librankntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/librankntl.so (0x00007febedc8a000)
        libntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libntl.so (0x00007febed8a5000)
        libgmp.so.7 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmp.so.7 (0x00007febed62d000)
        libgmpxx.so.1 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmpxx.so.1 (0x00007febed426000)
        libstdc++.so.6 => /home/jdemeyer/local/lib64/libstdc++.so.6 (0x00007febed121000)
        libpython2.7.so.1.0 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpython2.7.so.1.0 (0x00007febecd4d000)
        libm.so.6 => /lib/libm.so.6 (0x00007febecab7000)
        libgcc_s.so.1 => /home/jdemeyer/local/lib64/libgcc_s.so.1 (0x00007febec8a2000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x00007febec686000)
        libc.so.6 => /lib/libc.so.6 (0x00007febec323000)
        libpari-gmp.so.3 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpari-gmp.so.3 (0x00007febebc61000)
        /lib64/ld-linux-x86-64.so.2 (0x00007febeebf0000)
        libdl.so.2 => /lib/libdl.so.2 (0x00007febeba5c000)
        libutil.so.1 => /lib/libutil.so.1 (0x00007febeb859000)
```

```
(sage-sh) jdemeyer@boxen:lib.linux-x86_64-2.7$ ldd sage/libs/cremona/homspace.so
        linux-vdso.so.1 =>  (0x00007fff8adfd000)
        libcsage.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcsage.so (0x00007fa382917000)
        libg0nntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libg0nntl.so (0x00007fa3826b8000)
        libjcntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libjcntl.so (0x00007fa3823b7000)
        libgmpxx.so.1 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmpxx.so.1 (0x00007fa3821b1000)
        libntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libntl.so (0x00007fa381dcb000)
        libgmp.so.7 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmp.so.7 (0x00007fa381b53000)
        libstdc++.so.6 => /home/jdemeyer/local/lib64/libstdc++.so.6 (0x00007fa38184e000)
        libcurvesntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcurvesntl.so (0x00007fa381533000)
        libpython2.7.so.1.0 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpython2.7.so.1.0 (0x00007fa38115f000)
        libm.so.6 => /lib/libm.so.6 (0x00007fa380eca000)
        libgcc_s.so.1 => /home/jdemeyer/local/lib64/libgcc_s.so.1 (0x00007fa380cb4000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x00007fa380a98000)
        libc.so.6 => /lib/libc.so.6 (0x00007fa380736000)
        libpari-gmp.so.3 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpari-gmp.so.3 (0x00007fa380073000)
        /lib64/ld-linux-x86-64.so.2 (0x00007fa382d38000)
        libdl.so.2 => /lib/libdl.so.2 (0x00007fa37fe6f000)
        libutil.so.1 => /lib/libutil.so.1 (0x00007fa37fc6b000)
```

```
(sage-sh) jdemeyer@boxen:lib.linux-x86_64-2.7$ ldd sage/libs/cremona/newforms.so
        linux-vdso.so.1 =>  (0x00007fff60bfd000)
        libcsage.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcsage.so (0x00007fcc585fb000)
        libg0nntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libg0nntl.so (0x00007fcc5839c000)
        libjcntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libjcntl.so (0x00007fcc5809b000)
        libgmpxx.so.1 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmpxx.so.1 (0x00007fcc57e95000)
        libntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libntl.so (0x00007fcc57aaf000)
        libgmp.so.7 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libgmp.so.7 (0x00007fcc57837000)
        libstdc++.so.6 => /home/jdemeyer/local/lib64/libstdc++.so.6 (0x00007fcc57532000)
        libcurvesntl.so => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libcurvesntl.so (0x00007fcc57217000)
        libpython2.7.so.1.0 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpython2.7.so.1.0 (0x00007fcc56e43000)
        libm.so.6 => /lib/libm.so.6 (0x00007fcc56bae000)
        libgcc_s.so.1 => /home/jdemeyer/local/lib64/libgcc_s.so.1 (0x00007fcc56998000)
        libpthread.so.0 => /lib/libpthread.so.0 (0x00007fcc5677c000)
        libc.so.6 => /lib/libc.so.6 (0x00007fcc5641a000)
        libpari-gmp.so.3 => /padic/scratch/jdemeyer/merger/sage-5.0.beta14/local/lib/libpari-gmp.so.3 (0x00007fcc55d57000)
        /lib64/ld-linux-x86-64.so.2 (0x00007fcc58a1e000)
        libdl.so.2 => /lib/libdl.so.2 (0x00007fcc55b53000)
        libutil.so.1 => /lib/libutil.so.1 (0x00007fcc5594f000)
```



---

archive/issue_events_074355.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2012-04-07T08:13:00Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74355"
}
```



---

archive/issue_events_074356.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2012-04-07T08:13:00Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74356"
}
```



---

archive/issue_comments_091403.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -2,6 +2,6 @@\n \n This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.\n \n-ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...\n+---\n \n Apply [attachment:trac_9914.patch]\n``````\n",
    "created_at": "2012-04-07T08:13:00Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91403",
    "user": "https://github.com/nexttime"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -2,6 +2,6 @@
 
 This ticket will only address the removal of *some* unnecessary libraries listed; there are most probably more.
 
-ADDED LATER: See however the later remarks about that claim of *being unnecessary* ...
+---
 
 Apply [attachment:trac_9914.patch]
``````




---

archive/issue_comments_091404.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [jdemeyer](#comment%3A15):\n> Please explain the rationale for this patch.\n\n\nIs this so hard to understand?\n\n> [The comment you linked to](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) does not explain this.\n\n\nIt does, as does the further discussion on this ticket (and #9896).\n\n> And the following sentence is also very vague: \"\n> > This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.\n\n\nWhy specify libraries to link to if they aren't used / needed at all?\n\nThis **is** simply confusing, obviously inefficient, and causes trouble if the (unused) libraries the extension modules (i.e., their `.so`s) refer to get updated, since they'll still pull in the old, obsolete ones (which may also have already been deleted, in which case at least less weird errors are raised), for no reason.\n\nAs mentioned earlier and elsewhere, the eclib spkg is a special case anyway (also regarding the list of libraries its modules are linked to; cf. [my comment above](#comment%3A5)).",
    "created_at": "2012-04-07T08:13:00Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91404",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:17'></a>
Replying to [jdemeyer](#comment%3A15):
> Please explain the rationale for this patch.


Is this so hard to understand?

> [The comment you linked to](http://trac.sagemath.org/sage_trac/ticket/9896#comment:18) does not explain this.


It does, as does the further discussion on this ticket (and #9896).

> And the following sentence is also very vague: "
> > This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.


Why specify libraries to link to if they aren't used / needed at all?

This **is** simply confusing, obviously inefficient, and causes trouble if the (unused) libraries the extension modules (i.e., their `.so`s) refer to get updated, since they'll still pull in the old, obsolete ones (which may also have already been deleted, in which case at least less weird errors are raised), for no reason.

As mentioned earlier and elsewhere, the eclib spkg is a special case anyway (also regarding the list of libraries its modules are linked to; cf. [my comment above](#comment%3A5)).



---

archive/issue_comments_091405.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [jdemeyer](#comment%3A16):\n> The modules you are removing \"-lpari\" from are actually linked against pari, so I think \"pari\" should be kept.\n\n\n??? If you can safely remove `-lpari` in `module_list.py`, what's the problem?\n\nYour `ldd` dumps just show that eclib's modules also have the PARI library in their NEEDED tags, so what?  (Doesn't matter here whether they really need / use them or not.)",
    "created_at": "2012-04-07T08:16:26Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91405",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:18'></a>
Replying to [jdemeyer](#comment%3A16):
> The modules you are removing "-lpari" from are actually linked against pari, so I think "pari" should be kept.


??? If you can safely remove `-lpari` in `module_list.py`, what's the problem?

Your `ldd` dumps just show that eclib's modules also have the PARI library in their NEEDED tags, so what?  (Doesn't matter here whether they really need / use them or not.)



---

archive/issue_comments_091406.json:
```json
{
    "body": "<a id='comment:19'></a>\nI still don't see the problem...  anyway, has this patch been tested on Cygwin?",
    "created_at": "2012-04-07T08:26:24Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91406",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:19'></a>
I still don't see the problem...  anyway, has this patch been tested on Cygwin?



---

archive/issue_comments_091407.json:
```json
{
    "body": "<a id='comment:20'></a>\nReplying to [leif](#comment%3A17):\n> Replying to [jdemeyer](#comment%3A15):\n> > Please explain the rationale for this patch.\n> > And the following sentence is also very vague: \"\n> > > This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.\n\n> \n> Why specify libraries to link to if they aren't used / needed at all?\n> \n> This **is** simply confusing, obviously inefficient, and causes trouble if the (unused) libraries the extension modules (i.e., their `.so`s) refer to get updated, since they'll still pull in the old, obsolete ones (which may also have already been deleted, in which case at least less weird errors are raised), for no reason.\n\n\n\n```sh\n# This is your (unused) library:\necho \"void foo(){}\" > foo.c\ngcc -c foo.c\ngcc -shared -o libfoo.so.1 -Wl,-soname,libfoo.so.1 foo.o\nln -sf libfoo.so.1 libfoo.so\n\n# Now build your \"extension module\" bar (which doesn't *need* libfoo):\necho \"int main(){}\" > bar.c\ngcc -o bar bar.c -L. -lfoo\n\n# \"Load\" it:\nLD_LIBRARY_PATH=. ./bar # fine\n\n# Now update the unused foo library:\nrm -f libfoo.so*\n# Don't have to recompile foo.c, but one usually would of course.\ngcc -shared -o libfoo.so.2 -Wl,-soname,libfoo.so.2 foo.o\nln -sf libfoo.so.2 libfoo.so\n\n# Now load / run your \"extension module\" again:\nLD_LIBRARY_PATH=. ./bar # boom\n```",
    "created_at": "2012-04-07T09:04:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91407",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'></a>
Replying to [leif](#comment%3A17):
> Replying to [jdemeyer](#comment%3A15):
> > Please explain the rationale for this patch.
> > And the following sentence is also very vague: "
> > > This is inefficient, isn't nice or at least confusing and can (actually does) cause trouble.

> 
> Why specify libraries to link to if they aren't used / needed at all?
> 
> This **is** simply confusing, obviously inefficient, and causes trouble if the (unused) libraries the extension modules (i.e., their `.so`s) refer to get updated, since they'll still pull in the old, obsolete ones (which may also have already been deleted, in which case at least less weird errors are raised), for no reason.



```sh
# This is your (unused) library:
echo "void foo(){}" > foo.c
gcc -c foo.c
gcc -shared -o libfoo.so.1 -Wl,-soname,libfoo.so.1 foo.o
ln -sf libfoo.so.1 libfoo.so

# Now build your "extension module" bar (which doesn't *need* libfoo):
echo "int main(){}" > bar.c
gcc -o bar bar.c -L. -lfoo

# "Load" it:
LD_LIBRARY_PATH=. ./bar # fine

# Now update the unused foo library:
rm -f libfoo.so*
# Don't have to recompile foo.c, but one usually would of course.
gcc -shared -o libfoo.so.2 -Wl,-soname,libfoo.so.2 foo.o
ln -sf libfoo.so.2 libfoo.so

# Now load / run your "extension module" again:
LD_LIBRARY_PATH=. ./bar # boom
```



---

archive/issue_comments_091408.json:
```json
{
    "body": "<a id='comment:21'></a>\nOoops, missed the last lines:\n\n```sh\n# (You'll certainly agree that rebuilding bar doesn't make sense\n# since it doesn't really use / need libfoo at all.)\n\n# Things get weirder if you use bar (as a module / library) and have\n# another module baz which actually uses libfoo, and refers to the new\n# version.  If the old libfoo.so.1 wasn't deleted, you'll most probably\n# get name clashs, or baz tries to use symbols the obsolete libfoo\n# doesn't have, but bar pulled in the older version. \n```\n\n:-)",
    "created_at": "2012-04-07T09:08:40Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91408",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:21'></a>
Ooops, missed the last lines:

```sh
# (You'll certainly agree that rebuilding bar doesn't make sense
# since it doesn't really use / need libfoo at all.)

# Things get weirder if you use bar (as a module / library) and have
# another module baz which actually uses libfoo, and refers to the new
# version.  If the old libfoo.so.1 wasn't deleted, you'll most probably
# get name clashs, or baz tries to use symbols the obsolete libfoo
# doesn't have, but bar pulled in the older version. 
```

:-)



---

archive/issue_comments_091409.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [jdemeyer](#comment%3A19):\n> anyway, has this patch been tested on Cygwin?\n\n\nYes, it used to work on Cygwin as well; see [Mike's 17 months old comment above](#comment%3A10).",
    "created_at": "2012-04-07T09:14:42Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91409",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:22'></a>
Replying to [jdemeyer](#comment%3A19):
> anyway, has this patch been tested on Cygwin?


Yes, it used to work on Cygwin as well; see [Mike's 17 months old comment above](#comment%3A10).



---

archive/issue_events_074357.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-06T15:01:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74357"
}
```



---

archive/issue_events_074358.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-06T15:01:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74358"
}
```



---

archive/issue_comments_091410.json:
```json
{
    "body": "<a id='comment:23'></a>\nReplying to [leif](#comment%3A18):\n> Your `ldd` dumps just show that eclib's modules also have the PARI library in their NEEDED tags, so what?  (Doesn't matter here whether they really need / use them or not.)\n\neclib actually uses PARI.\n\nGiven that the modules link against `-lpari` anyway, the issue mentioned in [comment:20] can still happen.\n\nTherefore, I see absolutely no problem.",
    "created_at": "2013-03-06T15:01:27Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91410",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
Replying to [leif](#comment%3A18):
> Your `ldd` dumps just show that eclib's modules also have the PARI library in their NEEDED tags, so what?  (Doesn't matter here whether they really need / use them or not.)

eclib actually uses PARI.

Given that the modules link against `-lpari` anyway, the issue mentioned in [comment:20] can still happen.

Therefore, I see absolutely no problem.



---

archive/issue_events_074359.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74359"
}
```



---

archive/issue_events_074360.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74360"
}
```



---

archive/issue_events_074361.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74361"
}
```



---

archive/issue_events_074362.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74362"
}
```



---

archive/issue_events_074363.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-02-04T08:10:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74363"
}
```



---

archive/issue_comments_091411.json:
```json
{
    "body": "**Changing author** from \"Leif Leonhardy\" to \"\".",
    "created_at": "2014-02-04T08:10:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91411",
    "user": "https://github.com/jdemeyer"
}
```

**Changing author** from "Leif Leonhardy" to "".



---

archive/issue_events_074364.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-02-04T08:10:47Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "needs info",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74364"
}
```



---

archive/issue_events_074365.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2014-02-04T08:10:47Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74365"
}
```



---

archive/issue_comments_091412.json:
```json
{
    "body": "<a id='comment:27'></a>\nI still see no problem here and didn't get a reply to my last question => close as \"wontfix\".",
    "created_at": "2014-02-04T08:10:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91412",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:27'></a>
I still see no problem here and didn't get a reply to my last question => close as "wontfix".



---

archive/issue_comments_091413.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2014-02-04T08:10:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9914#issuecomment-91413",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_events_074366.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-04T21:10:19Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74366"
}
```



---

archive/issue_events_074367.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-04T21:10:19Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74367"
}
```



---

archive/issue_events_074368.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-02-04T21:10:19Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9914",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9914#event-74368"
}
```
