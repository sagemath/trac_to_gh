# Issue 9329: Improve documentation of how to access parts of the expression tree of a symbolic expression

archive/issues_009329.json:
```json
{
    "assignees": [],
    "body": "\n```\nsage: var('n')\nn\nsage: g=e^((n*pi-pi*2))\n```\nThe desire is to have clear documentation on how to apply (e.g.) factor() to just some piece of this, such as the exponent.\n\nAssignee: **@burcin**\n\nCC:  @sagetrac-rossk @mforets @slel\n\nKeywords: **expression tree, symbolic expression**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9329_\n\n",
    "created_at": "2010-06-24T13:03:40Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement",
        "https://github.com/sagemath/sage/labels/wishlist%20item"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Improve documentation of how to access parts of the expression tree of a symbolic expression",
    "type": "issue",
    "updated_at": "2019-01-18T19:32:45Z",
    "url": "https://github.com/sagemath/sage/issues/9329",
    "user": "https://github.com/kcrisman"
}
```

```
sage: var('n')
n
sage: g=e^((n*pi-pi*2))
```
The desire is to have clear documentation on how to apply (e.g.) factor() to just some piece of this, such as the exponent.

Assignee: **@burcin**

CC:  @sagetrac-rossk @mforets @slel

Keywords: **expression tree, symbolic expression**

_Issue created by migration from https://trac.sagemath.org/ticket/9329_





---

archive/issue_events_108797.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-06-24T13:03:40Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108797"
}
```



---

archive/issue_events_108798.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-06-24T13:03:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "component: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108798"
}
```



---

archive/issue_events_108799.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-06-24T13:03:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108799"
}
```



---

archive/issue_events_108800.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-06-24T13:03:40Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108800"
}
```



---

archive/issue_comments_080703.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nDid you have something specific in mind?  You can always get at the underlying tree with operand() and operands()\n\n```\nsage: var('n')\nn\nsage: g = e^((n*pi-pi*2))\nsage: g.operator(), g.operands()\n(exp, [-2*pi + pi*n])\n```\n\nThis is what is done in expression_conversions.py",
    "created_at": "2010-06-25T00:41:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80703",
    "user": "https://github.com/mwhansen"
}
```

<div id="comment:1" align="right">Comment 1</div>

Did you have something specific in mind?  You can always get at the underlying tree with operand() and operands()

```
sage: var('n')
n
sage: g = e^((n*pi-pi*2))
sage: g.operator(), g.operands()
(exp, [-2*pi + pi*n])
```

This is what is done in expression_conversions.py



---

archive/issue_comments_080704.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI think the original request from a user was in order to access the whole tree at once as a \"parsed tree\", since here of course `g.operands()` is itself something with an operator and operands.   Maybe there isn't such an object per se?",
    "created_at": "2010-06-25T13:07:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80704",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:2" align="right">Comment 2</div>

I think the original request from a user was in order to access the whole tree at once as a "parsed tree", since here of course `g.operands()` is itself something with an operator and operands.   Maybe there isn't such an object per se?



---

archive/issue_comments_080705.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nSee http://sagenb.org/home/pub/1760/ for a simple implementation.\n\n```\n\ndef tree(expr): \n    if expr.operator() is None: \n        return expr \n    else: \n        return [expr.operator()]+map(tree, expr.operands()) \n```",
    "created_at": "2010-06-27T03:47:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80705",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:3" align="right">Comment 3</div>

See http://sagenb.org/home/pub/1760/ for a simple implementation.

```

def tree(expr): 
    if expr.operator() is None: 
        return expr 
    else: 
        return [expr.operator()]+map(tree, expr.operands()) 
```



---

archive/issue_comments_080706.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nHere is the thread:\n\nhttp://groups.google.com/group/sage-support/t/e4b769a26269b6ed\n\n\nI think this is more of a documentation problem. We don't have any explanation of how to work with symbolic expressions, either traversing the tree using `operator()` and `operands()` or pattern matching with `find()` and `match()`.\n\nI don't think adding a function like Jason suggests in [comment:3](#comment%3A3) would provide anything more than that is already there. Note that in the example worksheet Jason also doesn't use this function.\n\nI suggest to close this ticket unless there is a more concrete suggestion.",
    "created_at": "2010-06-30T12:24:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80706",
    "user": "https://github.com/burcin"
}
```

<div id="comment:4" align="right">Comment 4</div>

Here is the thread:

http://groups.google.com/group/sage-support/t/e4b769a26269b6ed


I think this is more of a documentation problem. We don't have any explanation of how to work with symbolic expressions, either traversing the tree using `operator()` and `operands()` or pattern matching with `find()` and `match()`.

I don't think adding a function like Jason suggests in [comment:3](#comment%3A3) would provide anything more than that is already there. Note that in the example worksheet Jason also doesn't use this function.

I suggest to close this ticket unless there is a more concrete suggestion.



---

archive/issue_comments_080707.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nWell, this seems very reasonable; I certainly wouldn't have ever figured out the way you do it in that thread.  This probably belongs either at the top of one of expression.pyx or in the documentation for SymbolicExpression, huh?  It would be nice to do an example with simplification as well as substitution.  \n\nChanging ticket summary",
    "created_at": "2010-06-30T13:12:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80707",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:5" align="right">Comment 5</div>

Well, this seems very reasonable; I certainly wouldn't have ever figured out the way you do it in that thread.  This probably belongs either at the top of one of expression.pyx or in the documentation for SymbolicExpression, huh?  It would be nice to do an example with simplification as well as substitution.  

Changing ticket summary



---

archive/issue_events_108801.json:
```json
{
    "actor": "https://github.com/kcrisman",
    "created_at": "2010-06-30T13:12:33Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "title_is": "Improve documentation of how to access parts of the expression tree of a symbolic expression",
    "title_was": "Make it easy to access expression tree of a symbolic expression",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108801"
}
```



---

archive/issue_comments_080708.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,4 +4,4 @@\n n\n sage: g=e^((n*pi-pi*2))\n ```\n-But there doesn't seem to be an easy (i.e. not via `fast_callable`) way to access the underlying expression tree.\n+The desire is to have clear documentation on how to apply (e.g.) factor() to just some piece of this, such as the exponent.\n``````\n",
    "created_at": "2010-06-30T13:12:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80708",
    "user": "https://github.com/kcrisman"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,4 +4,4 @@
 n
 sage: g=e^((n*pi-pi*2))
 ```
-But there doesn't seem to be an easy (i.e. not via `fast_callable`) way to access the underlying expression tree.
+The desire is to have clear documentation on how to apply (e.g.) factor() to just some piece of this, such as the exponent.
``````




---

archive/issue_comments_080709.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nResurrecting the original idea because I want this for my discrete math class in a couple days and realize that even having a very basic example of how to use `Converter` to make an expression tree - say one I could plot! - would be really useful.  Right now I'm stuck with Jason's idea, which works but perhaps isn't as \"Sage-ic\".\n\n```\nsage: from sage.symbolic.random_tests import random_expr\nsage: S = random_expr(20,nvars=2)\nsage: S\nsinh_integral(-sec(-4*abs(e))/((kronecker_delta(e, v1) - 52)*arctan(elliptic_kc(-2) - 2)))\nsage: def tree(expr):\n....:     if expr.operator() is None:\n....:         return expr\n....:     else:\n....:         return [expr.operator()]+map(tree,expr.operands())\n....:     \nsage: tree(S)\n[sinh_integral, [<built-in function mul>, [<built-in function pow>, [<built-in function add>, [kronecker_delta, [exp, 1], v1], -52], -1], [<built-in function pow>, [arctan, [<built-in function add>, [elliptic_kc, -2], -2]], -1], [sec, [<built-in function mul>, [abs, [exp, 1]], -4]], -1]]\n```\nI'm realizing it might even be useful to have a (binary) tree returned from a list of lists... but that wouldn't be here.",
    "created_at": "2012-12-06T03:52:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80709",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:7" align="right">Comment 7</div>

Resurrecting the original idea because I want this for my discrete math class in a couple days and realize that even having a very basic example of how to use `Converter` to make an expression tree - say one I could plot! - would be really useful.  Right now I'm stuck with Jason's idea, which works but perhaps isn't as "Sage-ic".

```
sage: from sage.symbolic.random_tests import random_expr
sage: S = random_expr(20,nvars=2)
sage: S
sinh_integral(-sec(-4*abs(e))/((kronecker_delta(e, v1) - 52)*arctan(elliptic_kc(-2) - 2)))
sage: def tree(expr):
....:     if expr.operator() is None:
....:         return expr
....:     else:
....:         return [expr.operator()]+map(tree,expr.operands())
....:     
sage: tree(S)
[sinh_integral, [<built-in function mul>, [<built-in function pow>, [<built-in function add>, [kronecker_delta, [exp, 1], v1], -52], -1], [<built-in function pow>, [arctan, [<built-in function add>, [elliptic_kc, -2], -2]], -1], [sec, [<built-in function mul>, [abs, [exp, 1]], -4]], -1]]
```
I'm realizing it might even be useful to have a (binary) tree returned from a list of lists... but that wouldn't be here.



---

archive/issue_comments_080710.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nBy the way, http://interact.sagemath.org/node/76 might be a nice example too (that's an extremely simple expression->Java translator...)",
    "created_at": "2012-12-06T12:43:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80710",
    "user": "https://github.com/jasongrout"
}
```

<div id="comment:8" align="right">Comment 8</div>

By the way, http://interact.sagemath.org/node/76 might be a nice example too (that's an extremely simple expression->Java translator...)



---

archive/issue_comments_080711.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nDoes\n\n```\nsage: S._maxima_lib_().ecl().python()\n```\ncount?",
    "created_at": "2012-12-08T00:39:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80711",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:9" align="right">Comment 9</div>

Does

```
sage: S._maxima_lib_().ecl().python()
```
count?



---

archive/issue_comments_080712.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\n> Does\n> \n> ```\n> sage: S._maxima_lib_().ecl().python()\n> ```\n> count?\n\nThat certainly counts as one example.   I don't know that people will know what to do with `'MTIMES'` :-)\n\nBasically, an introduction to how to write something like this for people who don't know jack about expression trees (like me, though teaching it certainly helped) is what would be helpful here.",
    "created_at": "2012-12-08T04:16:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80712",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:10" align="right">Comment 10</div>

> Does
> 
> ```
> sage: S._maxima_lib_().ecl().python()
> ```
> count?

That certainly counts as one example.   I don't know that people will know what to do with `'MTIMES'` :-)

Basically, an introduction to how to write something like this for people who don't know jack about expression trees (like me, though teaching it certainly helped) is what would be helpful here.



---

archive/issue_events_108802.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108802"
}
```



---

archive/issue_events_108803.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108803"
}
```



---

archive/issue_events_108804.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108804"
}
```



---

archive/issue_events_108805.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108805"
}
```



---

archive/issue_events_108806.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108806"
}
```



---

archive/issue_events_108807.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108807"
}
```



---

archive/issue_events_108808.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108808"
}
```



---

archive/issue_events_108809.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108809"
}
```



---

archive/issue_comments_080713.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nSee also #9424.",
    "created_at": "2015-02-10T16:06:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80713",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:15" align="right">Comment 15</div>

See also #9424.



---

archive/issue_comments_080714.json:
```json
{
    "body": "Changed keywords from none to **expression tree, symbolic expression**",
    "created_at": "2018-05-21T17:10:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80714",
    "user": "https://github.com/slel"
}
```

Changed keywords from none to **expression tree, symbolic expression**



---

archive/issue_events_108810.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-05-21T17:10:21Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108810"
}
```



---

archive/issue_events_108811.json:
```json
{
    "actor": "https://github.com/slel",
    "created_at": "2018-05-21T17:10:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9329#event-108811"
}
```



---

archive/issue_comments_080715.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nNote: the worksheet mentioned by jason in [comment:3](#comment%3A3), originally at\n\n- http://sagenb.org/home/pub/1760/\n\nis now available, translated into a .sagews worksheet, at:\n\n- https://share.cocalc.com/share/19575ea0-317e-402b-be57-368d04c113db/pub/1701-1801/1760.sagews?viewer=share",
    "created_at": "2019-01-18T19:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9329",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9329#issuecomment-80715",
    "user": "https://github.com/slel"
}
```

<div id="comment:18" align="right">Comment 18</div>

Note: the worksheet mentioned by jason in [comment:3](#comment%3A3), originally at

- http://sagenb.org/home/pub/1760/

is now available, translated into a .sagews worksheet, at:

- https://share.cocalc.com/share/19575ea0-317e-402b-be57-368d04c113db/pub/1701-1801/1760.sagews?viewer=share
