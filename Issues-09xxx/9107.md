# Issue 9107: Nested class name mangling can be wrong in case of double nesting

archive/issues_009107.json:
```json
{
    "assignees": [
        "https://github.com/nthiery"
    ],
    "body": "In the following class tree:\n\n```\nclass Bla(UniqueRepresentation):\n    class Bla1(UniqueRepresentation):\n        class Bla11:\n            Pass\n    class Bla2:\n        class Bla21:\n            Pass\n```\nThe names are set to\n\n```\n        sage: Bla.Bla1.__name__\n        'Bla.Bla1'\n        sage: Bla.Bla2.__name__\n        'Bla.Bla2'\n        sage: Bla.Bla2.Bla21.__name__\n        'Bla.Bla2.Bla21'\n```\nBut\n\n```\n        sage: Bla.Bla1.Bla11.__name__\n        'Bla1.Bla11'\n```\nwhereas one would expect `'Bla.Bla1.Bla11'`\nThis breaks a lot of doc in categories and in particular in functorial constructions.\n\n__Apply__\n\n- [attachment: trac9107_nesting_nested_classes.patch](https://github.com/sagemath/sage/files/ticket9107/trac9107_nesting_nested_classes.patch.gz)\n- [attachment: trac_9107_fix_cross_reference.patch](https://github.com/sagemath/sage/files/ticket9107/trac_9107_fix_cross_reference.patch.gz)\n\nDepends on #12808\n\nCC:  @simon-king-jena @zabrocki\n\nComponent: **categories**\n\nAuthor: **Simon King, Nicolas M. Thi\u00e9ry**\n\nBranch: **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)**\n\nReviewer: **Volker Braun, Florent Hivert, Travis Scrimshaw**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9107_\n\n",
    "closed_at": "2014-06-18T14:11:28Z",
    "created_at": "2010-05-31T20:52:31Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20categories",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.3",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Nested class name mangling can be wrong in case of double nesting",
    "type": "issue",
    "updated_at": "2015-09-06T17:10:16Z",
    "url": "https://github.com/sagemath/sage/issues/9107",
    "user": "https://github.com/hivert"
}
```
In the following class tree:

```
class Bla(UniqueRepresentation):
    class Bla1(UniqueRepresentation):
        class Bla11:
            Pass
    class Bla2:
        class Bla21:
            Pass
```
The names are set to

```
        sage: Bla.Bla1.__name__
        'Bla.Bla1'
        sage: Bla.Bla2.__name__
        'Bla.Bla2'
        sage: Bla.Bla2.Bla21.__name__
        'Bla.Bla2.Bla21'
```
But

```
        sage: Bla.Bla1.Bla11.__name__
        'Bla1.Bla11'
```
whereas one would expect `'Bla.Bla1.Bla11'`
This breaks a lot of doc in categories and in particular in functorial constructions.

__Apply__

- [attachment: trac9107_nesting_nested_classes.patch](https://github.com/sagemath/sage/files/ticket9107/trac9107_nesting_nested_classes.patch.gz)
- [attachment: trac_9107_fix_cross_reference.patch](https://github.com/sagemath/sage/files/ticket9107/trac_9107_fix_cross_reference.patch.gz)

Depends on #12808

CC:  @simon-king-jena @zabrocki

Component: **categories**

Author: **Simon King, Nicolas M. Thi√©ry**

Branch: **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)**

Reviewer: **Volker Braun, Florent Hivert, Travis Scrimshaw**

_Issue created by migration from https://trac.sagemath.org/ticket/9107_





---

archive/issue_events_114983.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-05-31T20:52:31Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114983"
}
```



---

archive/issue_events_114984.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-05-31T20:52:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20categories",
    "label_color": "0000ff",
    "label_name": "c: categories",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114984"
}
```



---

archive/issue_events_114985.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-05-31T20:52:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114985"
}
```



---

archive/issue_events_114986.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2010-05-31T20:52:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114986"
}
```



---

archive/issue_events_114987.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2010-05-31T20:52:31Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "subject": "https://github.com/hivert",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114987"
}
```



---

archive/issue_comments_075452.json:
```json
{
    "body": "Dependencies: **#12808**",
    "created_at": "2012-05-02T14:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75452",
    "user": "https://github.com/simon-king-jena"
}
```

Dependencies: **#12808**



---

archive/issue_comments_075453.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI think we should make this depend on #12808, because it cythonises nested classes.\n\nHere is my analysis:\n\n1. In sage.misc.nested_class.modify_for_nested_pickling, only those attributes of a class are (recursively) renamed that are instances of type or of `ClassType`. However, ironically, instances of `NestedClassMetaclass` are ignored.\n2. It is verified that the name of the to-be-changed class is identical with its name as an attribute of the calling class. But the renaming breaks the identity.",
    "created_at": "2012-05-02T14:42:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75453",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:2" align="right">comment:2</div>

I think we should make this depend on #12808, because it cythonises nested classes.

Here is my analysis:

1. In sage.misc.nested_class.modify_for_nested_pickling, only those attributes of a class are (recursively) renamed that are instances of type or of `ClassType`. However, ironically, instances of `NestedClassMetaclass` are ignored.
2. It is verified that the name of the to-be-changed class is identical with its name as an attribute of the calling class. But the renaming breaks the identity.



---

archive/issue_comments_075454.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI think the attached patch solves the problem. I get:\n\n```\nsage: class Bla(UniqueRepresentation):\n....:     class Bla1(UniqueRepresentation):\n....:         class Bla11:\n....:             pass\n....:     class Bla2:                   \n....:         class Bla21:   \n....:             pass\n....:         \nsage: Bla.Bla1.Bla11\n<class __main__.Bla.Bla1.Bla11 at 0x46e7808>\n```\n\nThe change is in `modify_for_nested_pickle`, which is called recursively. The idea is that the function should have an extra argument `first_run`, that is True by default. If the extra argument is False, then it is assumed that it is not applied for the first time.\n\nHere: Since Bla.Bla1 is an instance of `NestedClassMetaclass`, `modify_for_nested_pickle` is called on `Bla.Bla1.Bla11`, resulting in `Bla.Bla1.Bla11.__name__=='Bla1.Bla11'`. However, since Bla is an instance of `NestedClassMetaclass` as well, the function is applied to `Bla.Bla1` and thus recursively to `Bla.Bla1.Bla11` another time.\n\nNow, without my patch, in the second run, `modify_for_nested_pickle` would be confused by the fact that `Bla.Bla1.__dict__` lists `Bla.Bla1.Bla11` under the name `Bla11`, but `Bla11.__name__=='Bla1.Bla11'`. With my patch, `modify_for_nested_pickle` expects exactly that naming scheme, and is thus changing `Bla.Bla1.Bla11.__name__` into `\"Bla.Bla1.Bla11\"`.\n\nMuch BlaBla, but I think it works...\n\n**__Potential problems__**\n\n```\nsage: module = sys.modules['__main__']\nsage: getattr(module, 'Bla1.Bla11')                      \n<class __main__.Bla.Bla1.Bla11 at 0x46e7808>\nsage: getattr(module, 'Bla.Bla1.Bla11')\n<class __main__.Bla.Bla1.Bla11 at 0x46e7808>\n```\nHence, Bla.Bla1.Bla11 is listed in the module under two different names. If you think it is bad, then one could probably modify the function when first_run is false, such that the name given in the first run is erased from the module.\n\nMoreover, the reviewer will likely find a speed regression, when excessively creating nested unique representations. But that's hardly realistic...",
    "created_at": "2012-05-02T16:37:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75454",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:3" align="right">comment:3</div>

I think the attached patch solves the problem. I get:

```
sage: class Bla(UniqueRepresentation):
....:     class Bla1(UniqueRepresentation):
....:         class Bla11:
....:             pass
....:     class Bla2:                   
....:         class Bla21:   
....:             pass
....:         
sage: Bla.Bla1.Bla11
<class __main__.Bla.Bla1.Bla11 at 0x46e7808>
```

The change is in `modify_for_nested_pickle`, which is called recursively. The idea is that the function should have an extra argument `first_run`, that is True by default. If the extra argument is False, then it is assumed that it is not applied for the first time.

Here: Since Bla.Bla1 is an instance of `NestedClassMetaclass`, `modify_for_nested_pickle` is called on `Bla.Bla1.Bla11`, resulting in `Bla.Bla1.Bla11.__name__=='Bla1.Bla11'`. However, since Bla is an instance of `NestedClassMetaclass` as well, the function is applied to `Bla.Bla1` and thus recursively to `Bla.Bla1.Bla11` another time.

Now, without my patch, in the second run, `modify_for_nested_pickle` would be confused by the fact that `Bla.Bla1.__dict__` lists `Bla.Bla1.Bla11` under the name `Bla11`, but `Bla11.__name__=='Bla1.Bla11'`. With my patch, `modify_for_nested_pickle` expects exactly that naming scheme, and is thus changing `Bla.Bla1.Bla11.__name__` into `"Bla.Bla1.Bla11"`.

Much BlaBla, but I think it works...

**__Potential problems__**

```
sage: module = sys.modules['__main__']
sage: getattr(module, 'Bla1.Bla11')                      
<class __main__.Bla.Bla1.Bla11 at 0x46e7808>
sage: getattr(module, 'Bla.Bla1.Bla11')
<class __main__.Bla.Bla1.Bla11 at 0x46e7808>
```
Hence, Bla.Bla1.Bla11 is listed in the module under two different names. If you think it is bad, then one could probably modify the function when first_run is false, such that the name given in the first run is erased from the module.

Moreover, the reviewer will likely find a speed regression, when excessively creating nested unique representations. But that's hardly realistic...



---

archive/issue_events_114988.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2012-05-02T16:37:49Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114988"
}
```



---

archive/issue_comments_075455.json:
```json
{
    "body": "Author: **Simon King**",
    "created_at": "2012-05-02T16:37:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75455",
    "user": "https://github.com/simon-king-jena"
}
```

Author: **Simon King**



---

archive/issue_comments_075456.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nAnother problem: Source inspection does not work yet in the following example.\n\n```\nsage: cython_code = [\n... \"from sage.structure.unique_representation import UniqueRepresentation\",\n... \"class A1(UniqueRepresentation):\",\n... \"    class B1(UniqueRepresentation):\",\n... \"        class C1: pass\",\n... \"    class B2:\",\n... \"        class C2: pass\"]\nsage: import os\nsage: cython(os.linesep.join(cython_code))\nsage: A1.B1.C1??          \nError getting source: class A1.B1.C1 has no attribute '__class__'\nType:\t\tclassobj\nString Form:\t_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx_0.A1.B1.C1\nNamespace:\tInteractive\nLoaded File:\t/mnt/local/king/.sage/temp/mpc622/6475/spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx_0.so\nSource File:\t/mnt/local/king/.sage/temp/mpc622/6475/spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx_0.so\n```\nEven #11768 does not solve the problem.\n\nShall that be dealt with on a different ticket? Or in one go?\n\nProbably on a different ticket, since I just find that even source inspection for A1 (which has a usual name) does not work...",
    "created_at": "2012-05-02T16:46:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75456",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:4" align="right">comment:4</div>

Another problem: Source inspection does not work yet in the following example.

```
sage: cython_code = [
... "from sage.structure.unique_representation import UniqueRepresentation",
... "class A1(UniqueRepresentation):",
... "    class B1(UniqueRepresentation):",
... "        class C1: pass",
... "    class B2:",
... "        class C2: pass"]
sage: import os
sage: cython(os.linesep.join(cython_code))
sage: A1.B1.C1??          
Error getting source: class A1.B1.C1 has no attribute '__class__'
Type:		classobj
String Form:	_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx_0.A1.B1.C1
Namespace:	Interactive
Loaded File:	/mnt/local/king/.sage/temp/mpc622/6475/spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx_0.so
Source File:	/mnt/local/king/.sage/temp/mpc622/6475/spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx/_mnt_local_king__sage_temp_mpc622_6475_tmp_0_spyx_0.so
```
Even #11768 does not solve the problem.

Shall that be dealt with on a different ticket? Or in one go?

Probably on a different ticket, since I just find that even source inspection for A1 (which has a usual name) does not work...



---

archive/issue_comments_075457.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nFor the record: If #11791 is applied after this ticket, source inspection in the example above works (and is doctested).",
    "created_at": "2012-05-03T16:16:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75457",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:5" align="right">comment:5</div>

For the record: If #11791 is applied after this ticket, source inspection in the example above works (and is doctested).



---

archive/issue_comments_075458.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nIs there a reviewer to fix name mangling of nested classes (needed in the category framework)?",
    "created_at": "2012-08-13T13:10:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75458",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:6" align="right">comment:6</div>

Is there a reviewer to fix name mangling of nested classes (needed in the category framework)?



---

archive/issue_comments_075459.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThis patch also fixes an issue that came up in #8899 regarding documentation of nested classes not appearing in the reference manual.\n\nSee here for a description of the issue, see the [thread on sage-combinat-devel](https://groups.google.com/d/topic/sage-combinat-devel/gWVx1It60ao/discussion).\n\nSee here for the confirmation that this works: https://github.com/sagemath/sage/issues/8899#comment:31",
    "created_at": "2012-08-23T01:01:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75459",
    "user": "https://github.com/saliola"
}
```

<div id="comment:7" align="right">comment:7</div>

This patch also fixes an issue that came up in #8899 regarding documentation of nested classes not appearing in the reference manual.

See here for a description of the issue, see the [thread on sage-combinat-devel](https://groups.google.com/d/topic/sage-combinat-devel/gWVx1It60ao/discussion).

See here for the confirmation that this works: https://github.com/sagemath/sage/issues/8899#comment:31



---

archive/issue_comments_075460.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nLGTM!",
    "created_at": "2012-11-27T10:42:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75460",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:8" align="right">comment:8</div>

LGTM!



---

archive/issue_comments_075461.json:
```json
{
    "body": "Reviewer: **Volker Braun**",
    "created_at": "2012-11-27T10:42:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75461",
    "user": "https://github.com/vbraun"
}
```

Reviewer: **Volker Braun**



---

archive/issue_events_114989.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-27T10:42:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114989"
}
```



---

archive/issue_events_114990.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2012-11-27T10:42:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114990"
}
```



---

archive/issue_comments_075462.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThis causes trouble when building the documentation from scratch (i.e. after deleting 'devel/sage/doc/output`):\n\n```\n/usr/local/src/sage-5.5.rc1/local/lib/python2.7/site-packages/sage/categories/algebras_with_basis.py:docstring of sage.categories.algebras_with_basis.AlgebrasWithBasis.CartesianProducts.ParentMethods.one_from_cartesian_product_of_one_basis:3: WARNING: more than one target found for cross-reference u'one_basis': sage.combinat.sf.new_kschur.KBoundedSubspaceBases.ParentMethods.one_basis, sage.categories.algebras_with_basis.AlgebrasWithBasis.ParentMethods.one_basis, sage.combinat.ncsf_qsym.generic_basis_code.BasesOfQSymOrNCSF.ParentMethods.one_basis, sage.algebras.steenrod.steenrod_algebra.SteenrodAlgebra_generic.one_basis, sage.categories.examples.with_realizations.SubsetAlgebra.Fundamental.one_basis, sage.combinat.root_system.weyl_characters.WeightRing.one_basis, sage.categories.monoids.Monoids.Algebras.ParentMethods.one_basis, sage.categories.examples.hopf_algebras_with_basis.MyGroupAlgebra.one_basis, sage.categories.algebras_with_basis.AlgebrasWithBasis.TensorProducts.ParentMethods.one_basis, sage.algebras.affine_nil_temperley_lieb.AffineNilTemperleyLiebTypeA.one_basis, sage.categories.examples.algebras_with_basis.FreeAlgebra.one_basis, sage.combinat.symmetric_group_algebra.SymmetricGroupAlgebra_n.one_basis, sage.algebras.iwahori_hecke_algebra.IwahoriHeckeAlgebraT.one_basis, sage.algebras.group_algebra_new.GroupAlgebra.one_basis, sage.combinat.sf.sfa.SymmetricFunctionsBases.ParentMethods.one_basis, sage.combinat.root_system.weyl_characters.WeylCharacterRing.one_basis, sage.combinat.combinatorial_algebra.CombinatorialAlgebra.one_basis\n```",
    "created_at": "2012-12-19T15:37:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75462",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:9" align="right">comment:9</div>

This causes trouble when building the documentation from scratch (i.e. after deleting 'devel/sage/doc/output`):

```
/usr/local/src/sage-5.5.rc1/local/lib/python2.7/site-packages/sage/categories/algebras_with_basis.py:docstring of sage.categories.algebras_with_basis.AlgebrasWithBasis.CartesianProducts.ParentMethods.one_from_cartesian_product_of_one_basis:3: WARNING: more than one target found for cross-reference u'one_basis': sage.combinat.sf.new_kschur.KBoundedSubspaceBases.ParentMethods.one_basis, sage.categories.algebras_with_basis.AlgebrasWithBasis.ParentMethods.one_basis, sage.combinat.ncsf_qsym.generic_basis_code.BasesOfQSymOrNCSF.ParentMethods.one_basis, sage.algebras.steenrod.steenrod_algebra.SteenrodAlgebra_generic.one_basis, sage.categories.examples.with_realizations.SubsetAlgebra.Fundamental.one_basis, sage.combinat.root_system.weyl_characters.WeightRing.one_basis, sage.categories.monoids.Monoids.Algebras.ParentMethods.one_basis, sage.categories.examples.hopf_algebras_with_basis.MyGroupAlgebra.one_basis, sage.categories.algebras_with_basis.AlgebrasWithBasis.TensorProducts.ParentMethods.one_basis, sage.algebras.affine_nil_temperley_lieb.AffineNilTemperleyLiebTypeA.one_basis, sage.categories.examples.algebras_with_basis.FreeAlgebra.one_basis, sage.combinat.symmetric_group_algebra.SymmetricGroupAlgebra_n.one_basis, sage.algebras.iwahori_hecke_algebra.IwahoriHeckeAlgebraT.one_basis, sage.algebras.group_algebra_new.GroupAlgebra.one_basis, sage.combinat.sf.sfa.SymmetricFunctionsBases.ParentMethods.one_basis, sage.combinat.root_system.weyl_characters.WeylCharacterRing.one_basis, sage.combinat.combinatorial_algebra.CombinatorialAlgebra.one_basis
```



---

archive/issue_events_114991.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-19T15:38:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114991"
}
```



---

archive/issue_events_114992.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-12-19T15:38:07Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114992"
}
```



---

archive/issue_comments_075463.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nJeroen, can you elaborate a bit what went wrong?",
    "created_at": "2013-01-19T18:30:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75463",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:11" align="right">comment:11</div>

Jeroen, can you elaborate a bit what went wrong?



---

archive/issue_comments_075464.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAha, now I see that the very long single line contains warnings about cross references that were not found. I'll try to identify them.",
    "created_at": "2013-01-19T20:27:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75464",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:12" align="right">comment:12</div>

Aha, now I see that the very long single line contains warnings about cross references that were not found. I'll try to identify them.



---

archive/issue_comments_075465.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">comment:13</div>\n\nAha, here is an example:\n\nThe docstring of `sage.categories.algebras_with_basis.AlgebrasWithBasis.CartesianProducts.ParentMethods.one_from_cartesian_product_of_one_basis` is as follows:\n\n```\n            @cached_method   # todo: reinstate once #5843 is fixed\n            def one_from_cartesian_product_of_one_basis(self):\n                \"\"\"\n                Returns the one of this cartesian product of algebras, as per ``Monoids.ParentMethods.one``\n\n                It is constructed as the cartesian product of the ones of the\n                summands, using their :meth:`.one_basis` methods.\n\n                This implementation does not require multiplication by\n                scalars nor calling cartesian_product. This might help keeping\n                things as lazy as possible upon initialization.\n...\n```\n\nCould this simply be a misspelling? Note that it is written\n\n```\n:meth:`.one_basis`\n```\nbut should certainly be\n\n```\n:meth:`one_basis`\n```\n\nIf that's the case for the other warnings as well, then my patch would just uncover mistakes that happened earlier.",
    "created_at": "2013-01-19T20:33:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75465",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:13" align="right">comment:13</div>

Aha, here is an example:

The docstring of `sage.categories.algebras_with_basis.AlgebrasWithBasis.CartesianProducts.ParentMethods.one_from_cartesian_product_of_one_basis` is as follows:

```
            @cached_method   # todo: reinstate once #5843 is fixed
            def one_from_cartesian_product_of_one_basis(self):
                """
                Returns the one of this cartesian product of algebras, as per ``Monoids.ParentMethods.one``

                It is constructed as the cartesian product of the ones of the
                summands, using their :meth:`.one_basis` methods.

                This implementation does not require multiplication by
                scalars nor calling cartesian_product. This might help keeping
                things as lazy as possible upon initialization.
...
```

Could this simply be a misspelling? Note that it is written

```
:meth:`.one_basis`
```
but should certainly be

```
:meth:`one_basis`
```

If that's the case for the other warnings as well, then my patch would just uncover mistakes that happened earlier.



---

archive/issue_comments_075466.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nThe same issue arose in #13851 (see [comment 10](https://github.com/sagemath/sage/issues/13851#comment:10)). I'm not sure why those dots are there, and I personally think they should be removed, but someone intentionally put them there.",
    "created_at": "2013-01-19T20:49:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75466",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:14" align="right">comment:14</div>

The same issue arose in #13851 (see [comment 10](https://github.com/sagemath/sage/issues/13851#comment:10)). I'm not sure why those dots are there, and I personally think they should be removed, but someone intentionally put them there.



---

archive/issue_comments_075467.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nReplying to [@jhpalmieri](#comment%3A14):\n> The same issue arose in #13851 (see [comment 10](https://github.com/sagemath/sage/issues/13851#comment:10)). I'm not sure why those dots are there, and I personally think they should be removed, but someone intentionally put them there.\n\nI think the dot is simply wrong - or is it ignored by Sphinx?\n\nActually here it is even worse. The text is documentation of a functorial construction, but refers to a parent method - that can't possibly work without an explicit reference to the method which must include the class which the method belongs to.",
    "created_at": "2013-01-19T20:54:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75467",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:15" align="right">comment:15</div>

Replying to [@jhpalmieri](#comment%3A14):
> The same issue arose in #13851 (see [comment 10](https://github.com/sagemath/sage/issues/13851#comment:10)). I'm not sure why those dots are there, and I personally think they should be removed, but someone intentionally put them there.

I think the dot is simply wrong - or is it ignored by Sphinx?

Actually here it is even worse. The text is documentation of a functorial construction, but refers to a parent method - that can't possibly work without an explicit reference to the method which must include the class which the method belongs to.



---

archive/issue_comments_075468.json:
```json
{
    "body": "Attachment: **[trac_9107_fix_cross_reference.patch.gz](https://github.com/sagemath/sage/files/ticket9107/trac_9107_fix_cross_reference.patch.gz)**\n\nFix a cross reference in some functorial construction",
    "created_at": "2013-01-19T21:12:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75468",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment: **[trac_9107_fix_cross_reference.patch.gz](https://github.com/sagemath/sage/files/ticket9107/trac_9107_fix_cross_reference.patch.gz)**

Fix a cross reference in some functorial construction



---

archive/issue_comments_075469.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nDoes the second patch fix the problem? I am now explicitly referring to the `one_basis` method of `AlgebrasWithBasis.ParentMethods`.",
    "created_at": "2013-01-19T21:13:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75469",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:16" align="right">comment:16</div>

Does the second patch fix the problem? I am now explicitly referring to the `one_basis` method of `AlgebrasWithBasis.ParentMethods`.



---

archive/issue_events_114993.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-01-19T21:13:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114993"
}
```



---

archive/issue_events_114994.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-01-19T21:13:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114994"
}
```



---

archive/issue_events_114995.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2013-03-20T15:25:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114995"
}
```



---

archive/issue_events_114996.json:
```json
{
    "actor": "https://github.com/hivert",
    "created_at": "2013-03-20T15:25:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114996"
}
```



---

archive/issue_comments_075470.json:
```json
{
    "body": "Changed reviewer from **Volker Braun** to **Volker Braun, Florent Hivert**",
    "created_at": "2013-03-20T15:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75470",
    "user": "https://github.com/hivert"
}
```

Changed reviewer from **Volker Braun** to **Volker Braun, Florent Hivert**



---

archive/issue_comments_075471.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nHi Simon,\n\nI again hit this one compiling the doc. Your patches look all good to me, including the one problem.\n\nThanks,\n\nFlorent",
    "created_at": "2013-03-20T15:25:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75471",
    "user": "https://github.com/hivert"
}
```

<div id="comment:17" align="right">comment:17</div>

Hi Simon,

I again hit this one compiling the doc. Your patches look all good to me, including the one problem.

Thanks,

Florent



---

archive/issue_events_114997.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-21T06:36:57Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114997"
}
```



---

archive/issue_events_114998.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-21T06:36:57Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114998"
}
```



---

archive/issue_comments_075472.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nApplying this patch causes the PDF docbuilder to hang after it's done building all documents. All documents are built but there are still 6 (I'm building with `MAKE=\"make -j6\"`) child processes which are stuck in the `multiprocessing.Pool` code. Interrupting those child processes simply causes new child processes to start which are then stuck again. It might be a bug in `multiprocessing.Pool` which is somehow triggered, I have no idea...",
    "created_at": "2013-03-21T06:36:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75472",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:18" align="right">comment:18</div>

Applying this patch causes the PDF docbuilder to hang after it's done building all documents. All documents are built but there are still 6 (I'm building with `MAKE="make -j6"`) child processes which are stuck in the `multiprocessing.Pool` code. Interrupting those child processes simply causes new child processes to start which are then stuck again. It might be a bug in `multiprocessing.Pool` which is somehow triggered, I have no idea...



---

archive/issue_comments_075473.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nPerhaps an instance of #14323 (wild guess)?",
    "created_at": "2013-03-21T06:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75473",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:19" align="right">comment:19</div>

Perhaps an instance of #14323 (wild guess)?



---

archive/issue_comments_075474.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nNo, #14323 doesn't help.",
    "created_at": "2013-03-24T12:31:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75474",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

No, #14323 doesn't help.



---

archive/issue_comments_075475.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nJeroen, does the problem persist with the new doc builder? I have just applied the two patches, and succeeded with `export MAKE=\"make -j2\"` followed by `make`.\n\nHowever, there is continuation by `...` that needs fixing.",
    "created_at": "2013-05-22T11:06:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75475",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:21" align="right">comment:21</div>

Jeroen, does the problem persist with the new doc builder? I have just applied the two patches, and succeeded with `export MAKE="make -j2"` followed by `make`.

However, there is continuation by `...` that needs fixing.



---

archive/issue_comments_075476.json:
```json
{
    "body": "Attachment: **[trac9107_nesting_nested_classes.patch.gz](https://github.com/sagemath/sage/files/ticket9107/trac9107_nesting_nested_classes.patch.gz)**",
    "created_at": "2013-05-22T12:56:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75476",
    "user": "https://github.com/simon-king-jena"
}
```

Attachment: **[trac9107_nesting_nested_classes.patch.gz](https://github.com/sagemath/sage/files/ticket9107/trac9107_nesting_nested_classes.patch.gz)**



---

archive/issue_comments_075477.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -28,4 +28,7 @@\n whereas one would expect `'Bla.Bla1.Bla11'`\n This breaks a lot of doc in categories and in particular in functorial constructions.\n \n-Florent\n+__Apply__\n+\n+- [attachment: trac9107_nesting_nested_classes.patch](https://github.com/sagemath/sage/files/ticket9107/trac9107_nesting_nested_classes.patch.gz)\n+- [attachment: trac_9107_fix_cross_reference.patch](https://github.com/sagemath/sage/files/ticket9107/trac_9107_fix_cross_reference.patch.gz)\n``````\n",
    "created_at": "2013-05-22T13:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75477",
    "user": "https://github.com/simon-king-jena"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -28,4 +28,7 @@
 whereas one would expect `'Bla.Bla1.Bla11'`
 This breaks a lot of doc in categories and in particular in functorial constructions.
 
-Florent
+__Apply__
+
+- [attachment: trac9107_nesting_nested_classes.patch](https://github.com/sagemath/sage/files/ticket9107/trac9107_nesting_nested_classes.patch.gz)
+- [attachment: trac_9107_fix_cross_reference.patch](https://github.com/sagemath/sage/files/ticket9107/trac_9107_fix_cross_reference.patch.gz)
``````




---

archive/issue_events_114999.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-05-22T13:00:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-114999"
}
```



---

archive/issue_events_115000.json:
```json
{
    "actor": "https://github.com/simon-king-jena",
    "created_at": "2013-05-22T13:00:25Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115000"
}
```



---

archive/issue_comments_075478.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nBuilding the docs works for me, and the `...` should be fixed now. Hence: Needs review!\n\nApply trac9107_nesting_nested_classes.patch trac_9107_fix_cross_reference.patch",
    "created_at": "2013-05-22T13:00:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75478",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:22" align="right">comment:22</div>

Building the docs works for me, and the `...` should be fixed now. Hence: Needs review!

Apply trac9107_nesting_nested_classes.patch trac_9107_fix_cross_reference.patch



---

archive/issue_comments_075479.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@simon-king-jena](#comment%3A22):\n> Building the docs works for me\n\nAlso the PDF docs?",
    "created_at": "2013-05-22T15:05:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75479",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@simon-king-jena](#comment%3A22):
> Building the docs works for me

Also the PDF docs?



---

archive/issue_comments_075480.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThere is a problem with latex and the fact that the docbuilder *hangs* is a bug in the new docbuilder: #14626\n\n```\n! LaTeX Error: Too deeply nested.\n\nSee the LaTeX manual or LaTeX Companion for explanation.\nType  H <return>  for immediate help.\n ...                                              \n                                                  \nl.27819 \\begin{Verbatim}[commandchars=\\\\\\{\\}]\n                                             \n? \nImplicit mode ON; LaTeX internals redefined\n(/usr/share/texmf-texlive/tex/latex/ltxmisc/url.sty\n(/usr/share/texmf-texlive/tex/latex/base/t1enc.def)\n! Emergency stop.\n ...                                              \n                                                  \nl.27819 \\begin{Verbatim}[commandchars=\\\\\\{\\}]\n                                             \n!  ==> Fatal error occurred, no output PDF file produced!\nTranscript written on categories.log.\n)make[1]: *** [categories.pdf] Error 1\n```",
    "created_at": "2013-05-22T15:08:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75480",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:24" align="right">comment:24</div>

There is a problem with latex and the fact that the docbuilder *hangs* is a bug in the new docbuilder: #14626

```
! LaTeX Error: Too deeply nested.

See the LaTeX manual or LaTeX Companion for explanation.
Type  H <return>  for immediate help.
 ...                                              
                                                  
l.27819 \begin{Verbatim}[commandchars=\\\{\}]
                                             
? 
Implicit mode ON; LaTeX internals redefined
(/usr/share/texmf-texlive/tex/latex/ltxmisc/url.sty
(/usr/share/texmf-texlive/tex/latex/base/t1enc.def)
! Emergency stop.
 ...                                              
                                                  
l.27819 \begin{Verbatim}[commandchars=\\\{\}]
                                             
!  ==> Fatal error occurred, no output PDF file produced!
Transcript written on categories.log.
)make[1]: *** [categories.pdf] Error 1
```



---

archive/issue_events_115001.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-22T15:10:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115001"
}
```



---

archive/issue_events_115002.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-22T15:10:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115002"
}
```



---

archive/issue_comments_075481.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nYes, I did not consider the pdf docs.\n\nIf I understand correctly, we have two problems. The first problem is that with this patch, `LaTeX` is produced that can not be processed because it is two deeply nested. The second problem is independent, namely if latex fails, then the docbuilder hangs.\n\nDo you have any clue what object is being processed when things hang?",
    "created_at": "2013-05-22T15:23:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75481",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:26" align="right">comment:26</div>

Yes, I did not consider the pdf docs.

If I understand correctly, we have two problems. The first problem is that with this patch, `LaTeX` is produced that can not be processed because it is two deeply nested. The second problem is independent, namely if latex fails, then the docbuilder hangs.

Do you have any clue what object is being processed when things hang?



---

archive/issue_comments_075482.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nReplying to [@simon-king-jena](#comment%3A26):\n> The second problem is independent, namely if latex fails, then the docbuilder hangs.\n\nWhich is #14626 and indeed has nothing to do with this ticket.\n\n> Do you have any clue what object is being processed when things hang?\n\nNot yet, I will reproduce the `.tex` file and then it should be clear.",
    "created_at": "2013-05-22T15:29:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75482",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:27" align="right">comment:27</div>

Replying to [@simon-king-jena](#comment%3A26):
> The second problem is independent, namely if latex fails, then the docbuilder hangs.

Which is #14626 and indeed has nothing to do with this ticket.

> Do you have any clue what object is being processed when things hang?

Not yet, I will reproduce the `.tex` file and then it should be clear.



---

archive/issue_comments_075483.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nOffending `.tex` file: [http://boxen.math.washington.edu/home/jdemeyer/badlatex/categories.tex](http://boxen.math.washington.edu/home/jdemeyer/badlatex/categories.tex)\n\nThe relevant lines are\n\n```\n\\begin{fulllineitems}\n\\phantomsection\\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods}\\pysigline{\\strong{class }\\bfcode{ParentMethods}}~\\index{Sets.WithRealizations.ParentMethods.Realizations (class in sage.categories.sets\\_cat)}\n\n\\begin{fulllineitems}\n\\phantomsection\\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations}\\pysiglinewithargsret{\\strong{class }\\bfcode{Realizations}}{\\emph{parent\\_with\\_realization}}{}\nBases: {\\hyperref[sage/categories/realizations:sage.categories.realizations.Category_realization_of_parent]{\\code{sage.categories.realizations.Category\\_realization\\_of\\_parent}}}\n\nTESTS:\n\n\\begin{Verbatim}[commandchars=\\\\\\{\\}]\n\\PYG{g+gp}{sage: }\\PYG{k+kn}{from} \\PYG{n+nn}{sage.categories.realizations} \\PYG{k+kn}{import} \\PYG{n}{Category\\PYGZus{}realization\\PYGZus{}of\\PYGZus{}parent}\n\\PYG{g+gp}{sage: }\\PYG{n}{A} \\PYG{o}{=} \\PYG{n}{Sets}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{WithRealizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{example}\\PYG{p}{(}\\PYG{p}{)}\\PYG{p}{;} \\PYG{n}{A}\n\\PYG{g+go}{The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n}{C} \\PYG{o}{=} \\PYG{n}{A}\\PYG{o}{.}\\PYG{n}{Realizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{p}{;} \\PYG{n}{C}\n\\PYG{g+go}{Category of realizations of The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n+nb}{isinstance}\\PYG{p}{(}\\PYG{n}{C}\\PYG{p}{,} \\PYG{n}{Category\\PYGZus{}realization\\PYGZus{}of\\PYGZus{}parent}\\PYG{p}{)}\n\\PYG{g+go}{True}\n\\PYG{g+gp}{sage: }\\PYG{n}{C}\\PYG{o}{.}\\PYG{n}{parent\\PYGZus{}with\\PYGZus{}realization}\n\\PYG{g+go}{The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n}{TestSuite}\\PYG{p}{(}\\PYG{n}{C}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{run}\\PYG{p}{(}\\PYG{p}{)}\n\\end{Verbatim}\n\\index{super\\_categories() (sage.categories.sets\\_cat.Sets.WithRealizations.ParentMethods.Realizations method)}\n\n\\begin{fulllineitems}\n\\phantomsection\\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations.super_categories}\\pysiglinewithargsret{\\bfcode{super\\_categories}}{}{}\nEXAMPLES:\n\n\\begin{Verbatim}[commandchars=\\\\\\{\\}]   %% PROBLEM IS THIS LINE %%\n\\PYG{g+gp}{sage: }\\PYG{n}{A} \\PYG{o}{=} \\PYG{n}{Sets}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{WithRealizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{example}\\PYG{p}{(}\\PYG{p}{)}\\PYG{p}{;} \\PYG{n}{A}\n\\PYG{g+go}{The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n}{A}\\PYG{o}{.}\\PYG{n}{Realizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{super\\PYGZus{}categories}\\PYG{p}{(}\\PYG{p}{)}\n\\PYG{g+go}{[Category of realizations of sets]}\n\\end{Verbatim}\n\n\\end{fulllineitems}\n\n\n\\end{fulllineitems}\n\n\\index{facade\\_for() (sage.categories.sets\\_cat.Sets.WithRealizations.ParentMethods method)}\n```",
    "created_at": "2013-05-22T15:48:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75483",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Offending `.tex` file: [http://boxen.math.washington.edu/home/jdemeyer/badlatex/categories.tex](http://boxen.math.washington.edu/home/jdemeyer/badlatex/categories.tex)

The relevant lines are

```
\begin{fulllineitems}
\phantomsection\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods}\pysigline{\strong{class }\bfcode{ParentMethods}}~\index{Sets.WithRealizations.ParentMethods.Realizations (class in sage.categories.sets\_cat)}

\begin{fulllineitems}
\phantomsection\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations}\pysiglinewithargsret{\strong{class }\bfcode{Realizations}}{\emph{parent\_with\_realization}}{}
Bases: {\hyperref[sage/categories/realizations:sage.categories.realizations.Category_realization_of_parent]{\code{sage.categories.realizations.Category\_realization\_of\_parent}}}

TESTS:

\begin{Verbatim}[commandchars=\\\{\}]
\PYG{g+gp}{sage: }\PYG{k+kn}{from} \PYG{n+nn}{sage.categories.realizations} \PYG{k+kn}{import} \PYG{n}{Category\PYGZus{}realization\PYGZus{}of\PYGZus{}parent}
\PYG{g+gp}{sage: }\PYG{n}{A} \PYG{o}{=} \PYG{n}{Sets}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{WithRealizations}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{example}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;} \PYG{n}{A}
\PYG{g+go}{The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n}{C} \PYG{o}{=} \PYG{n}{A}\PYG{o}{.}\PYG{n}{Realizations}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;} \PYG{n}{C}
\PYG{g+go}{Category of realizations of The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n}{C}\PYG{p}{,} \PYG{n}{Category\PYGZus{}realization\PYGZus{}of\PYGZus{}parent}\PYG{p}{)}
\PYG{g+go}{True}
\PYG{g+gp}{sage: }\PYG{n}{C}\PYG{o}{.}\PYG{n}{parent\PYGZus{}with\PYGZus{}realization}
\PYG{g+go}{The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n}{TestSuite}\PYG{p}{(}\PYG{n}{C}\PYG{p}{)}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}
\index{super\_categories() (sage.categories.sets\_cat.Sets.WithRealizations.ParentMethods.Realizations method)}

\begin{fulllineitems}
\phantomsection\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations.super_categories}\pysiglinewithargsret{\bfcode{super\_categories}}{}{}
EXAMPLES:

\begin{Verbatim}[commandchars=\\\{\}]   %% PROBLEM IS THIS LINE %%
\PYG{g+gp}{sage: }\PYG{n}{A} \PYG{o}{=} \PYG{n}{Sets}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{WithRealizations}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{example}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;} \PYG{n}{A}
\PYG{g+go}{The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n}{A}\PYG{o}{.}\PYG{n}{Realizations}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{super\PYGZus{}categories}\PYG{p}{(}\PYG{p}{)}
\PYG{g+go}{[Category of realizations of sets]}
\end{Verbatim}

\end{fulllineitems}


\end{fulllineitems}

\index{facade\_for() (sage.categories.sets\_cat.Sets.WithRealizations.ParentMethods method)}
```



---

archive/issue_comments_075484.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\n**before** this patch (good):\n\n```\n\\phantomsection\\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods}\\pysigline{\\bfcode{ParentMethods}}\nalias of \\code{WithRealizations.ParentMethods}\n```\n**after** this patch (bad):\n\n```\n\\phantomsection\\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations}\\pysiglinewithargsret{\\strong{class }\\bfcode{Realizations}}{\\emph{parent\\_with\\_realization}}{}\nBases: {\\hyperref[sage/categories/realizations:sage.categories.realizations.Category_realization_of_parent]{\\code{sage.categories.realizations.Category\\_realization\\_of\\_parent}}}\n```",
    "created_at": "2013-05-22T15:54:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75484",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

**before** this patch (good):

```
\phantomsection\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods}\pysigline{\bfcode{ParentMethods}}
alias of \code{WithRealizations.ParentMethods}
```
**after** this patch (bad):

```
\phantomsection\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations}\pysiglinewithargsret{\strong{class }\bfcode{Realizations}}{\emph{parent\_with\_realization}}{}
Bases: {\hyperref[sage/categories/realizations:sage.categories.realizations.Category_realization_of_parent]{\code{sage.categories.realizations.Category\_realization\_of\_parent}}}
```



---

archive/issue_comments_075485.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nReplying to [@jdemeyer](#comment%3A29):\n> **before** this patch (good):\n> \n> ```\n> \\phantomsection\\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods}\\pysigline{\\bfcode{ParentMethods}}\n> alias of \\code{WithRealizations.ParentMethods}\n> ```\n> **after** this patch (bad):\n> \n> ```\n> \\phantomsection\\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations}\\pysiglinewithargsret{\\strong{class }\\bfcode{Realizations}}{\\emph{parent\\_with\\_realization}}{}\n> Bases: {\\hyperref[sage/categories/realizations:sage.categories.realizations.Category_realization_of_parent]{\\code{sage.categories.realizations.Category\\_realization\\_of\\_parent}}}\n> ```\n\nThree questions:\n\n1. Why is it bad? I don't see why latex should have a problem with it.\n2. Isn't the \"good\" output without my patch just plain wrong? After all, we do have\n\n   ```\n   sage: sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations.__bases__\n   (sage.categories.realizations.Category_realization_of_parent,)\n   ```\n   and also `sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations` is certainly *not* simply an alias of `WithRealizations.ParentMethods`.\n3. Can you also point me to the code that created the latex output?",
    "created_at": "2013-05-22T19:35:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75485",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:30" align="right">comment:30</div>

Replying to [@jdemeyer](#comment%3A29):
> **before** this patch (good):
> 
> ```
> \phantomsection\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods}\pysigline{\bfcode{ParentMethods}}
> alias of \code{WithRealizations.ParentMethods}
> ```
> **after** this patch (bad):
> 
> ```
> \phantomsection\label{sage/categories/sets_cat:sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations}\pysiglinewithargsret{\strong{class }\bfcode{Realizations}}{\emph{parent\_with\_realization}}{}
> Bases: {\hyperref[sage/categories/realizations:sage.categories.realizations.Category_realization_of_parent]{\code{sage.categories.realizations.Category\_realization\_of\_parent}}}
> ```

Three questions:

1. Why is it bad? I don't see why latex should have a problem with it.
2. Isn't the "good" output without my patch just plain wrong? After all, we do have

   ```
   sage: sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations.__bases__
   (sage.categories.realizations.Category_realization_of_parent,)
   ```
   and also `sage.categories.sets_cat.Sets.WithRealizations.ParentMethods.Realizations` is certainly *not* simply an alias of `WithRealizations.ParentMethods`.
3. Can you also point me to the code that created the latex output?



---

archive/issue_comments_075486.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nWhen I build the pdf docs, it works. On what machine do you see the failure? If it's on sage.math, it might have to do with the fact that the LaTeX installation is quite old...\n\nEdit: maybe I'm seeing the failure now. Never mind.",
    "created_at": "2013-05-22T22:21:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75486",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:31" align="right">comment:31</div>

When I build the pdf docs, it works. On what machine do you see the failure? If it's on sage.math, it might have to do with the fact that the LaTeX installation is quite old...

Edit: maybe I'm seeing the failure now. Never mind.



---

archive/issue_comments_075487.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nOK, I see it, too.\n\n```\n../../sage -docbuild reference pdf\n...\nOutput written on tensor.pdf (24 pages, 144532 bytes).\nTranscript written on tensor.log.\nBuild finished.  The built documents can be found in /home/simon/SAGE/prerelease/sage-5.9.rc0/devel/sage/doc/output/pdf/en/reference/tensor\n```\nand then it hangs.\n\nNevertheless, I have no clue what is happening here. See my three questions in [comment:30](#comment%3A30).",
    "created_at": "2013-05-23T05:32:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75487",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:32" align="right">comment:32</div>

OK, I see it, too.

```
../../sage -docbuild reference pdf
...
Output written on tensor.pdf (24 pages, 144532 bytes).
Transcript written on tensor.log.
Build finished.  The built documents can be found in /home/simon/SAGE/prerelease/sage-5.9.rc0/devel/sage/doc/output/pdf/en/reference/tensor
```
and then it hangs.

Nevertheless, I have no clue what is happening here. See my three questions in [comment:30](#comment%3A30).



---

archive/issue_comments_075488.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nReplying to [@simon-king-jena](#comment%3A30):\n> 1. Why is it bad?\n\nI just used \"bad\" because `latex` doesn't compile it correctly.\n\n> 3. Can you also point me to the code that created the latex output?\n\nI guess that's Sphinx, but I don't know much about it.",
    "created_at": "2013-05-23T08:03:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75488",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:33" align="right">comment:33</div>

Replying to [@simon-king-jena](#comment%3A30):
> 1. Why is it bad?

I just used "bad" because `latex` doesn't compile it correctly.

> 3. Can you also point me to the code that created the latex output?

I guess that's Sphinx, but I don't know much about it.



---

archive/issue_comments_075489.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">comment:34</div>\n\nReplying to [@jdemeyer](#comment%3A33):\n> Replying to [@simon-king-jena](#comment%3A30):\n> > 1. Why is it bad?\n\n> I just used \"bad\" because `latex` doesn't compile it correctly.\n\nThat was my question: Why does `latex` not compile it correctly?\n\nAnd we should keep in mind that the old output has simply been wrong.",
    "created_at": "2013-05-23T09:35:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75489",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:34" align="right">comment:34</div>

Replying to [@jdemeyer](#comment%3A33):
> Replying to [@simon-king-jena](#comment%3A30):
> > 1. Why is it bad?

> I just used "bad" because `latex` doesn't compile it correctly.

That was my question: Why does `latex` not compile it correctly?

And we should keep in mind that the old output has simply been wrong.



---

archive/issue_comments_075490.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nI think that the first line in the LaTeX error message is correct:\n\n```\n! LaTeX Error: Too deeply nested.\n```\nI think that there are too many levels of nesting of lists (from the `fulllineitems` environment). If I comment out the `Verbatim` environment that it's complaining about, I don't get an error message any more.",
    "created_at": "2013-05-23T19:20:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75490",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:35" align="right">comment:35</div>

I think that the first line in the LaTeX error message is correct:

```
! LaTeX Error: Too deeply nested.
```
I think that there are too many levels of nesting of lists (from the `fulllineitems` environment). If I comment out the `Verbatim` environment that it's complaining about, I don't get an error message any more.



---

archive/issue_comments_075491.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">comment:36</div>\n\nReplying to [@jhpalmieri](#comment%3A35):\n> I think that the first line in the LaTeX error message is correct:\n> \n> ```\n> ! LaTeX Error: Too deeply nested.\n> ```\n> I think that there are too many levels of nesting of lists (from the `fulllineitems` environment). If I comment out the `Verbatim` environment that it's complaining about, I don't get an error message any more.\n\nPlease, where is the nesting? I suppose by \"comment out the `Verbatim` environment that it's complaining about\", you mean one of two `Verbatim` environments that were cited in [comment:28](#comment%3A28).\n\nThe first is\n\n```\n\\begin{Verbatim}[commandchars=\\\\\\{\\}]\n\\PYG{g+gp}{sage: }\\PYG{k+kn}{from} \\PYG{n+nn}{sage.categories.realizations} \\PYG{k+kn}{import} \\PYG{n}{Category\\PYGZus{}realization\\PYGZus{}of\\PYGZus{}parent}\n\\PYG{g+gp}{sage: }\\PYG{n}{A} \\PYG{o}{=} \\PYG{n}{Sets}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{WithRealizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{example}\\PYG{p}{(}\\PYG{p}{)}\\PYG{p}{;} \\PYG{n}{A}\n\\PYG{g+go}{The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n}{C} \\PYG{o}{=} \\PYG{n}{A}\\PYG{o}{.}\\PYG{n}{Realizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{p}{;} \\PYG{n}{C}\n\\PYG{g+go}{Category of realizations of The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n+nb}{isinstance}\\PYG{p}{(}\\PYG{n}{C}\\PYG{p}{,} \\PYG{n}{Category\\PYGZus{}realization\\PYGZus{}of\\PYGZus{}parent}\\PYG{p}{)}\n\\PYG{g+go}{True}\n\\PYG{g+gp}{sage: }\\PYG{n}{C}\\PYG{o}{.}\\PYG{n}{parent\\PYGZus{}with\\PYGZus{}realization}\n\\PYG{g+go}{The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n}{TestSuite}\\PYG{p}{(}\\PYG{n}{C}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{run}\\PYG{p}{(}\\PYG{p}{)}\n\\end{Verbatim}\n```\nthe second is\n\n```\n\\begin{Verbatim}[commandchars=\\\\\\{\\}]   %% PROBLEM IS THIS LINE %%\n\\PYG{g+gp}{sage: }\\PYG{n}{A} \\PYG{o}{=} \\PYG{n}{Sets}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{WithRealizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{example}\\PYG{p}{(}\\PYG{p}{)}\\PYG{p}{;} \\PYG{n}{A}\n\\PYG{g+go}{The subset algebra of \\PYGZob{}1, 2, 3\\PYGZcb{} over Rational Field}\n\\PYG{g+gp}{sage: }\\PYG{n}{A}\\PYG{o}{.}\\PYG{n}{Realizations}\\PYG{p}{(}\\PYG{p}{)}\\PYG{o}{.}\\PYG{n}{super\\PYGZus{}categories}\\PYG{p}{(}\\PYG{p}{)}\n\\PYG{g+go}{[Category of realizations of sets]}\n\\end{Verbatim}\n```\n\nI suppose `%% PROBLEM IS THIS LINE %%` in the second environment was Jeroen's addition.\n\nSo, what is \"too deeply nested\"? I can't believe that such a short piece of text has even enough characters to nest too deeply for latex!",
    "created_at": "2013-05-23T20:35:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75491",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:36" align="right">comment:36</div>

Replying to [@jhpalmieri](#comment%3A35):
> I think that the first line in the LaTeX error message is correct:
> 
> ```
> ! LaTeX Error: Too deeply nested.
> ```
> I think that there are too many levels of nesting of lists (from the `fulllineitems` environment). If I comment out the `Verbatim` environment that it's complaining about, I don't get an error message any more.

Please, where is the nesting? I suppose by "comment out the `Verbatim` environment that it's complaining about", you mean one of two `Verbatim` environments that were cited in [comment:28](#comment%3A28).

The first is

```
\begin{Verbatim}[commandchars=\\\{\}]
\PYG{g+gp}{sage: }\PYG{k+kn}{from} \PYG{n+nn}{sage.categories.realizations} \PYG{k+kn}{import} \PYG{n}{Category\PYGZus{}realization\PYGZus{}of\PYGZus{}parent}
\PYG{g+gp}{sage: }\PYG{n}{A} \PYG{o}{=} \PYG{n}{Sets}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{WithRealizations}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{example}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;} \PYG{n}{A}
\PYG{g+go}{The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n}{C} \PYG{o}{=} \PYG{n}{A}\PYG{o}{.}\PYG{n}{Realizations}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;} \PYG{n}{C}
\PYG{g+go}{Category of realizations of The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n}{C}\PYG{p}{,} \PYG{n}{Category\PYGZus{}realization\PYGZus{}of\PYGZus{}parent}\PYG{p}{)}
\PYG{g+go}{True}
\PYG{g+gp}{sage: }\PYG{n}{C}\PYG{o}{.}\PYG{n}{parent\PYGZus{}with\PYGZus{}realization}
\PYG{g+go}{The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n}{TestSuite}\PYG{p}{(}\PYG{n}{C}\PYG{p}{)}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{)}
\end{Verbatim}
```
the second is

```
\begin{Verbatim}[commandchars=\\\{\}]   %% PROBLEM IS THIS LINE %%
\PYG{g+gp}{sage: }\PYG{n}{A} \PYG{o}{=} \PYG{n}{Sets}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{WithRealizations}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{example}\PYG{p}{(}\PYG{p}{)}\PYG{p}{;} \PYG{n}{A}
\PYG{g+go}{The subset algebra of \PYGZob{}1, 2, 3\PYGZcb{} over Rational Field}
\PYG{g+gp}{sage: }\PYG{n}{A}\PYG{o}{.}\PYG{n}{Realizations}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{super\PYGZus{}categories}\PYG{p}{(}\PYG{p}{)}
\PYG{g+go}{[Category of realizations of sets]}
\end{Verbatim}
```

I suppose `%% PROBLEM IS THIS LINE %%` in the second environment was Jeroen's addition.

So, what is "too deeply nested"? I can't believe that such a short piece of text has even enough characters to nest too deeply for latex!



---

archive/issue_comments_075492.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nIf I take the file categories.tex in `SAGE_ROOT/devel/sage/doc/output/latex/en/reference/categories/` and truncate it just before the line starting `\\index{facade\\_for() ...`, then I need to add in a few lines of the form\n\n```\n\\end{fulllineitems}\n```\nto get it to compile (after I comment out the last Verbatim block before the line `\\index{facade\\_for() ...`). So there are several `fulllineitems` environments nested within each other. Maybe too many, and maybe that's the problem. That's my current guess.",
    "created_at": "2013-05-23T23:25:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75492",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:37" align="right">comment:37</div>

If I take the file categories.tex in `SAGE_ROOT/devel/sage/doc/output/latex/en/reference/categories/` and truncate it just before the line starting `\index{facade\_for() ...`, then I need to add in a few lines of the form

```
\end{fulllineitems}
```
to get it to compile (after I comment out the last Verbatim block before the line `\index{facade\_for() ...`). So there are several `fulllineitems` environments nested within each other. Maybe too many, and maybe that's the problem. That's my current guess.



---

archive/issue_events_115003.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115003"
}
```



---

archive/issue_events_115004.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115004"
}
```



---

archive/issue_comments_075493.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nHey Nicolas and Simon,\n\nThe problem comes from the fact that there is a 4 level deep class nesting with a method (which is 5 levels deep) in the `Sets.WithRealizations.ParentMethods.Realizations.super_categories`. I've tried moving this subclass into a separate class, and this solves the pdf build issue but introduces some doctesting errors. I don't think there is a  to extend the nesting level since that is a latex thing, nor do I think we should try since 4 nested classes is a lot IMO. I'm guessing beforehand because of the improper naming, latex did the environments differently...?\n\nAnyways the fix for the pdf build is to remove a level (or two) of class nesting.\n\nBest,\n\nTravis\n\nEdit: Here are the errors I get when I move `Sets.WithRealizations` out as a separate class and then assign it into `Sets`:\n\n```\nsage -t ../categories/sets_cat.py\n**********************************************************************\nFile \"../categories/sets_cat.py\", line 1408, in sage.categories.sets_cat.ParentMethodsForWithRealizations.realizations\nFailed example:\n    A.realizations()\nExpected:\n    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis]\nGot:\n    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis, The subset algebra of {1, 2, 3} over Rational Field in the realization Blah]\n**********************************************************************\nFile \"../categories/sets_cat.py\", line 1428, in sage.categories.sets_cat.ParentMethodsForWithRealizations.facade_for\nFailed example:\n    A.facade_for()\nExpected:\n    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis]\nGot:\n    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis, The subset algebra of {1, 2, 3} over Rational Field in the realization Blah]\n**********************************************************************\n2 items had failures:\n   1 of   8 in sage.categories.sets_cat.ParentMethodsForWithRealizations.facade_for\n   1 of   3 in sage.categories.sets_cat.ParentMethodsForWithRealizations.realizations\n    [241 tests, 2 failures, 0.76 s]\n----------------------------------------------------------------------\nsage -t ../categories/sets_cat.py  # 2 doctests failed\n----------------------------------------------------------------------\n```\nAny ideas why moving the class out of the nesting doesn't work?",
    "created_at": "2013-08-22T19:13:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75493",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:39" align="right">comment:39</div>

Hey Nicolas and Simon,

The problem comes from the fact that there is a 4 level deep class nesting with a method (which is 5 levels deep) in the `Sets.WithRealizations.ParentMethods.Realizations.super_categories`. I've tried moving this subclass into a separate class, and this solves the pdf build issue but introduces some doctesting errors. I don't think there is a  to extend the nesting level since that is a latex thing, nor do I think we should try since 4 nested classes is a lot IMO. I'm guessing beforehand because of the improper naming, latex did the environments differently...?

Anyways the fix for the pdf build is to remove a level (or two) of class nesting.

Best,

Travis

Edit: Here are the errors I get when I move `Sets.WithRealizations` out as a separate class and then assign it into `Sets`:

```
sage -t ../categories/sets_cat.py
**********************************************************************
File "../categories/sets_cat.py", line 1408, in sage.categories.sets_cat.ParentMethodsForWithRealizations.realizations
Failed example:
    A.realizations()
Expected:
    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis]
Got:
    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis, The subset algebra of {1, 2, 3} over Rational Field in the realization Blah]
**********************************************************************
File "../categories/sets_cat.py", line 1428, in sage.categories.sets_cat.ParentMethodsForWithRealizations.facade_for
Failed example:
    A.facade_for()
Expected:
    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis]
Got:
    [The subset algebra of {1, 2, 3} over Rational Field in the Fundamental basis, The subset algebra of {1, 2, 3} over Rational Field in the In basis, The subset algebra of {1, 2, 3} over Rational Field in the Out basis, The subset algebra of {1, 2, 3} over Rational Field in the realization Blah]
**********************************************************************
2 items had failures:
   1 of   8 in sage.categories.sets_cat.ParentMethodsForWithRealizations.facade_for
   1 of   3 in sage.categories.sets_cat.ParentMethodsForWithRealizations.realizations
    [241 tests, 2 failures, 0.76 s]
----------------------------------------------------------------------
sage -t ../categories/sets_cat.py  # 2 doctests failed
----------------------------------------------------------------------
```
Any ideas why moving the class out of the nesting doesn't work?



---

archive/issue_comments_075494.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nReplying to [@tscrim](#comment%3A39):\n> I don't think there is a  to extend the nesting level since that is a latex thing,\n\nShame on LaTeX!\n\n> Anyways the fix for the pdf build is to remove a level (or two) of class nesting.\n\nWhat exactly are we talking about? `Sets.WithRealizations.ParentMethods.Realizations`?\n\nInterestingly, there is the comment\n\n```\n# Do we really want this feature?\n```\n\nSo, can we do without this feature? Nicolas?",
    "created_at": "2013-08-22T19:27:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75494",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:40" align="right">comment:40</div>

Replying to [@tscrim](#comment%3A39):
> I don't think there is a  to extend the nesting level since that is a latex thing,

Shame on LaTeX!

> Anyways the fix for the pdf build is to remove a level (or two) of class nesting.

What exactly are we talking about? `Sets.WithRealizations.ParentMethods.Realizations`?

Interestingly, there is the comment

```
# Do we really want this feature?
```

So, can we do without this feature? Nicolas?



---

archive/issue_comments_075495.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nReplying to [@simon-king-jena](#comment%3A40):\n> Replying to [@tscrim](#comment%3A39):\n> > Anyways the fix for the pdf build is to remove a level (or two) of class nesting.\n\n> \n> What exactly are we talking about? `Sets.WithRealizations.ParentMethods.Realizations`?\n\nYes. Removing a level of nesting allowed the pdf for categories to build for me.",
    "created_at": "2013-08-23T04:02:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75495",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:41" align="right">comment:41</div>

Replying to [@simon-king-jena](#comment%3A40):
> Replying to [@tscrim](#comment%3A39):
> > Anyways the fix for the pdf build is to remove a level (or two) of class nesting.

> 
> What exactly are we talking about? `Sets.WithRealizations.ParentMethods.Realizations`?

Yes. Removing a level of nesting allowed the pdf for categories to build for me.



---

archive/issue_comments_075496.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nThanks much Travis for investigating!\n\nI agree that there should be a recommendation for not nesting classes\ntoo deep, for the sake of readability. But having a hard arbitrary\nlimit -- especially that small -- is annoying. Shame on LaTeX. Of\ncourse, one can always spin off a subtree of nested classes into a\nseparate tree, but there are cases where one has a deep tree with very\nfew lines and no natural splitting point. For example, #10963\nintroduces\n\n```\n    DistributiveMagmasAndAdditiveMagmas.AdditiveAssociative.AdditiveCommutative.AdditiveUnital.AdditiveInverse\n```\n\nHmm. Altogether, I would call this a LaTeX arbitrary hard\nlimitation. Luckily there seems to be an easy solution to increase\nthis limitation to something large enough to cover our current use\ncases, namely to use the package enumitem [1]. By itself, it brings\nthe nesting level to 6, and we could even increase it further (10\nshould be really safe) using \\setlistdepth{9}.\n\nI have attached the little latex file I used for testing.\n\nWhat do you think? Shall we add enumitems to the list of latex\npackages loaded by Sphinx? Is this standard enough, or shall we add\nenumitem.sty to the Sage distribution?\n\nCheers,\n                                     Nicolas\n\n[1] http://stackoverflow.com/questions/1935952/maximum-nesting-level-of-lists-in-latex",
    "created_at": "2013-08-23T08:52:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75496",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:42" align="right">comment:42</div>

Thanks much Travis for investigating!

I agree that there should be a recommendation for not nesting classes
too deep, for the sake of readability. But having a hard arbitrary
limit -- especially that small -- is annoying. Shame on LaTeX. Of
course, one can always spin off a subtree of nested classes into a
separate tree, but there are cases where one has a deep tree with very
few lines and no natural splitting point. For example, #10963
introduces

```
    DistributiveMagmasAndAdditiveMagmas.AdditiveAssociative.AdditiveCommutative.AdditiveUnital.AdditiveInverse
```

Hmm. Altogether, I would call this a LaTeX arbitrary hard
limitation. Luckily there seems to be an easy solution to increase
this limitation to something large enough to cover our current use
cases, namely to use the package enumitem [1]. By itself, it brings
the nesting level to 6, and we could even increase it further (10
should be really safe) using \setlistdepth{9}.

I have attached the little latex file I used for testing.

What do you think? Shall we add enumitems to the list of latex
packages loaded by Sphinx? Is this standard enough, or shall we add
enumitem.sty to the Sage distribution?

Cheers,
                                     Nicolas

[1] http://stackoverflow.com/questions/1935952/maximum-nesting-level-of-lists-in-latex



---

archive/issue_comments_075497.json:
```json
{
    "body": "Attachment: **[test-deep-itemize-nesting.tex.gz](https://github.com/sagemath/sage/files/ticket9107/test-deep-itemize-nesting.tex.gz)**",
    "created_at": "2013-08-23T08:53:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75497",
    "user": "https://github.com/nthiery"
}
```

Attachment: **[test-deep-itemize-nesting.tex.gz](https://github.com/sagemath/sage/files/ticket9107/test-deep-itemize-nesting.tex.gz)**



---

archive/issue_comments_075498.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">comment:43</div>\n\n`enumitem.sty` looks pretty standard, so I'd say it's fine to use it.",
    "created_at": "2013-08-23T09:02:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75498",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:43" align="right">comment:43</div>

`enumitem.sty` looks pretty standard, so I'd say it's fine to use it.



---

archive/issue_comments_075499.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nReplying to [@jdemeyer](#comment%3A43):\n> `enumitem.sty` looks pretty standard, so I'd say it's fine to use it.\n\n... which means there should be a separate ticket for adding it?",
    "created_at": "2013-08-23T10:31:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75499",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:44" align="right">comment:44</div>

Replying to [@jdemeyer](#comment%3A43):
> `enumitem.sty` looks pretty standard, so I'd say it's fine to use it.

... which means there should be a separate ticket for adding it?



---

archive/issue_comments_075500.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nReplying to [@simon-king-jena](#comment%3A44):\n\n> ... which means there should be a separate ticket for adding it?\n\nAdding an `\\usepackage{}` somewhere (don't ask me where) should be trivial enough that it can be done on this ticket.",
    "created_at": "2013-08-23T11:28:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75500",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

Replying to [@simon-king-jena](#comment%3A44):

> ... which means there should be a separate ticket for adding it?

Adding an `\usepackage{}` somewhere (don't ask me where) should be trivial enough that it can be done on this ticket.



---

archive/issue_comments_075501.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nReplying to [@jdemeyer](#comment%3A45):\n> Replying to [@simon-king-jena](#comment%3A44):\n> > ... which means there should be a separate ticket for adding it?\n\n> Adding an `\\usepackage{}` somewhere (don't ask me where) should be trivial enough that it can be done on this ticket.\n\nSo, whom *do* we ask?",
    "created_at": "2013-08-23T11:55:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75501",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:46" align="right">comment:46</div>

Replying to [@jdemeyer](#comment%3A45):
> Replying to [@simon-king-jena](#comment%3A44):
> > ... which means there should be a separate ticket for adding it?

> Adding an `\usepackage{}` somewhere (don't ask me where) should be trivial enough that it can be done on this ticket.

So, whom *do* we ask?



---

archive/issue_comments_075502.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nMe; I just did this with Ben on #14787. You need to add it to `doc/common/conf.py`, and we also added it to `misc/latex.py`, which might be some overkill, but it doesn't really hurt to be extra safe here.",
    "created_at": "2013-08-23T15:31:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75502",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:47" align="right">comment:47</div>

Me; I just did this with Ben on #14787. You need to add it to `doc/common/conf.py`, and we also added it to `misc/latex.py`, which might be some overkill, but it doesn't really hurt to be extra safe here.



---

archive/issue_comments_075503.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nReplying to [@tscrim](#comment%3A47):\n> Me; I just did this with Ben on #14787. You need to add it to `doc/common/conf.py`, and we also added it to `misc/latex.py`, which might be some overkill, but it doesn't really hurt to be extra safe here.\n\nAre you saying that the problem is fixed by #14787? Then I suggest to add it as dependency.",
    "created_at": "2013-08-23T19:39:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75503",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:48" align="right">comment:48</div>

Replying to [@tscrim](#comment%3A47):
> Me; I just did this with Ben on #14787. You need to add it to `doc/common/conf.py`, and we also added it to `misc/latex.py`, which might be some overkill, but it doesn't really hurt to be extra safe here.

Are you saying that the problem is fixed by #14787? Then I suggest to add it as dependency.



---

archive/issue_comments_075504.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nReplying to [@simon-king-jena](#comment%3A48):\n> Replying to [@tscrim](#comment%3A47):\n> > Me; I just did this with Ben on #14787. You need to add it to `doc/common/conf.py`, and we also added it to `misc/latex.py`, which might be some overkill, but it doesn't really hurt to be extra safe here.\n\n> \n> Are you saying that the problem is fixed by #14787? Then I suggest to add it as dependency.\n\nSorry, that was phrased badly. Ben and I added a latex package to the pdf builder in #14787, but it was not `enumitem.sty`.",
    "created_at": "2013-08-23T23:44:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75504",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:49" align="right">comment:49</div>

Replying to [@simon-king-jena](#comment%3A48):
> Replying to [@tscrim](#comment%3A47):
> > Me; I just did this with Ben on #14787. You need to add it to `doc/common/conf.py`, and we also added it to `misc/latex.py`, which might be some overkill, but it doesn't really hurt to be extra safe here.

> 
> Are you saying that the problem is fixed by #14787? Then I suggest to add it as dependency.

Sorry, that was phrased badly. Ben and I added a latex package to the pdf builder in #14787, but it was not `enumitem.sty`.



---

archive/issue_comments_075505.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nFor the record: someone else got a similar issue when using sphinx [1], and suggested the same fix. Alas this fix does not seem to be enough. I am still getting a \"Too deeply nested\" with the attached file categories.tex (obtained by reducing that produced by sphinx). I am working on reducing it further.\n\n\n[1] http://mail.scipy.org/pipermail/ipython-user/2012-May/010144.html",
    "created_at": "2013-08-27T11:04:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75505",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:51" align="right">comment:51</div>

For the record: someone else got a similar issue when using sphinx [1], and suggested the same fix. Alas this fix does not seem to be enough. I am still getting a "Too deeply nested" with the attached file categories.tex (obtained by reducing that produced by sphinx). I am working on reducing it further.


[1] http://mail.scipy.org/pipermail/ipython-user/2012-May/010144.html



---

archive/issue_comments_075506.json:
```json
{
    "body": "Attachment: **[categories.tex.gz](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)**",
    "created_at": "2013-08-27T11:05:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75506",
    "user": "https://github.com/nthiery"
}
```

Attachment: **[categories.tex.gz](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)**



---

archive/issue_comments_075507.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nHi Nicolas,\n\nReplying to [@nthiery](#comment%3A51):\n> For the record: someone else got a similar issue when using sphinx [1], and suggested the same fix. Alas this fix does not seem to be enough.\n\nWhat exactly did you do? Change sphinx.sty, as in the source you are giving? Or change doc/common/conf.py and misc/latex.py, as advised by Travis in [comment:47](#comment%3A47)?\n\nCould it be that the following comment from [the page you are citing](http://mail.scipy.org/pipermail/ipython-user/2012-May/010144.html) applies?\n\n```\nHowever this requires version 3.0 of enumitem, which doesn't yet ship\nwith many linux latex distributions.\n```",
    "created_at": "2013-08-27T11:11:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75507",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:52" align="right">comment:52</div>

Hi Nicolas,

Replying to [@nthiery](#comment%3A51):
> For the record: someone else got a similar issue when using sphinx [1], and suggested the same fix. Alas this fix does not seem to be enough.

What exactly did you do? Change sphinx.sty, as in the source you are giving? Or change doc/common/conf.py and misc/latex.py, as advised by Travis in [comment:47](#comment%3A47)?

Could it be that the following comment from [the page you are citing](http://mail.scipy.org/pipermail/ipython-user/2012-May/010144.html) applies?

```
However this requires version 3.0 of enumitem, which doesn't yet ship
with many linux latex distributions.
```



---

archive/issue_comments_075508.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\nReplying to [@simon-king-jena](#comment%3A52):\n> Replying to [@nthiery](#comment%3A51):\n> > For the record: someone else got a similar issue when using sphinx [1], and suggested the same fix. Alas this fix does not seem to be enough.\n\n> \n> What exactly did you do? Change sphinx.sty, as in the source you are giving? Or change doc/common/conf.py and misc/latex.py, as advised by Travis in [comment:47](#comment%3A47)?\n\nI changed conf.py which properly added it to the generated\ncategories.tex file (see the top of that file).\n\n> Could it be that the following comment from [the page you are citing](http://mail.scipy.org/pipermail/ipython-user/2012-May/010144.html) applies?\n> \n> ```\n> However this requires version 3.0 of enumitem, which doesn't yet ship\n> with many linux latex distributions.\n> ```\n> \n\nI have 3.5.2 ...",
    "created_at": "2013-08-27T12:36:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75508",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:53" align="right">comment:53</div>

Replying to [@simon-king-jena](#comment%3A52):
> Replying to [@nthiery](#comment%3A51):
> > For the record: someone else got a similar issue when using sphinx [1], and suggested the same fix. Alas this fix does not seem to be enough.

> 
> What exactly did you do? Change sphinx.sty, as in the source you are giving? Or change doc/common/conf.py and misc/latex.py, as advised by Travis in [comment:47](#comment%3A47)?

I changed conf.py which properly added it to the generated
categories.tex file (see the top of that file).

> Could it be that the following comment from [the page you are citing](http://mail.scipy.org/pipermail/ipython-user/2012-May/010144.html) applies?
> 
> ```
> However this requires version 3.0 of enumitem, which doesn't yet ship
> with many linux latex distributions.
> ```
> 

I have 3.5.2 ...



---

archive/issue_comments_075509.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@nthiery](#comment%3A53):\n> Replying to [@simon-king-jena](#comment%3A52):\n> > What exactly did you do? Change sphinx.sty, as in the source you are giving? Or change doc/common/conf.py and misc/latex.py, as advised by Travis in [comment:47](#comment%3A47)?\n\n> \n> I changed conf.py which properly added it to the generated\n> categories.tex file (see the top of that file).\n\nHm. Then, we are back to the question: What the heck is going wrong? Could we\nperhaps ask on some `LaTeX` forum about the problem? I mean, if we have a tex\nfile that does not compile, even though nesting should not be the problem any\nmore, then I think `LaTeX` people should be made aware.",
    "created_at": "2013-08-27T12:53:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75509",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@nthiery](#comment%3A53):
> Replying to [@simon-king-jena](#comment%3A52):
> > What exactly did you do? Change sphinx.sty, as in the source you are giving? Or change doc/common/conf.py and misc/latex.py, as advised by Travis in [comment:47](#comment%3A47)?

> 
> I changed conf.py which properly added it to the generated
> categories.tex file (see the top of that file).

Hm. Then, we are back to the question: What the heck is going wrong? Could we
perhaps ask on some `LaTeX` forum about the problem? I mean, if we have a tex
file that does not compile, even though nesting should not be the problem any
more, then I think `LaTeX` people should be made aware.



---

archive/issue_comments_075510.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nHow can one test [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)? I can not run pdflatex on it, because it can't find `sphinxmanual.cls`. Where do I get this file (and probably other files) from?",
    "created_at": "2013-08-27T12:56:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75510",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:55" align="right">comment:55</div>

How can one test [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)? I can not run pdflatex on it, because it can't find `sphinxmanual.cls`. Where do I get this file (and probably other files) from?



---

archive/issue_comments_075511.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@simon-king-jena](#comment%3A55):\n> How can one test [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)? I can not run pdflatex on it, because it can't find `sphinxmanual.cls`. Where do I get this file (and probably other files) from?\n\nWhen I do `declare -x TEXINPUTS=.:$SAGE_ROOT/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/` then it does find sphinxmanual.cls, but the next attempt to call pdflatex on categories.tex fails as well. This time, it can't find `report.cls`.\n\nSo, please tell me how one is supposed to run pdflatex on this file, so that I can reproduce the problem.",
    "created_at": "2013-08-27T14:55:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75511",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@simon-king-jena](#comment%3A55):
> How can one test [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)? I can not run pdflatex on it, because it can't find `sphinxmanual.cls`. Where do I get this file (and probably other files) from?

When I do `declare -x TEXINPUTS=.:$SAGE_ROOT/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/` then it does find sphinxmanual.cls, but the next attempt to call pdflatex on categories.tex fails as well. This time, it can't find `report.cls`.

So, please tell me how one is supposed to run pdflatex on this file, so that I can reproduce the problem.



---

archive/issue_comments_075512.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@simon-king-jena](#comment%3A56):\n> Replying to [@simon-king-jena](#comment%3A55):\n> > How can one test [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)? I can not run pdflatex on it, because it can't find `sphinxmanual.cls`. Where do I get this file (and probably other files) from?\n\n> When I do `declare -x TEXINPUTS=.:$SAGE_ROOT/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/` then it does find sphinxmanual.cls, but the next attempt to call pdflatex on categories.tex fails as well. This time, it can't find `report.cls`.\n\nYou are missing a : at the end of TEXINPUT to let latex use its own library (report.cls is a standard class). \n\nOr you can just be lazy and put the categories.tex file in the directory \n\n```\n        <SAGE>/devel/sage/doc/output/latex/en/reference/categories\n```\nand run pdflatex from there.",
    "created_at": "2013-08-28T09:23:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75512",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@simon-king-jena](#comment%3A56):
> Replying to [@simon-king-jena](#comment%3A55):
> > How can one test [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz)? I can not run pdflatex on it, because it can't find `sphinxmanual.cls`. Where do I get this file (and probably other files) from?

> When I do `declare -x TEXINPUTS=.:$SAGE_ROOT/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/` then it does find sphinxmanual.cls, but the next attempt to call pdflatex on categories.tex fails as well. This time, it can't find `report.cls`.

You are missing a : at the end of TEXINPUT to let latex use its own library (report.cls is a standard class). 

Or you can just be lazy and put the categories.tex file in the directory 

```
        <SAGE>/devel/sage/doc/output/latex/en/reference/categories
```
and run pdflatex from there.



---

archive/issue_comments_075513.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nReplying to [@nthiery](#comment%3A57):\n> Replying to [@simon-king-jena](#comment%3A56):\n> > When I do `declare -x TEXINPUTS=.:$SAGE_ROOT/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/` then it does find sphinxmanual.cls, but the next attempt to call pdflatex on categories.tex fails as well. This time, it can't find `report.cls`.\n\n>\n> You are missing a : at the end of TEXINPUT to let latex use its own library (report.cls is a standard class). \n\nNope. After\n\n```\ndeclare -x TEXINPUTS=.:~/SAGE/prerelease/sage-5.11.beta3/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/:\n```\n`pdflatex categories.tex` results in\n\n```\n! Undefined control sequence.\n<recently read> \\setlistdepth \n                              \nl.19 \\setlistdepth\n                  {9}\n? \n! Emergency stop.\n<recently read> \\setlistdepth \n                              \nl.19 \\setlistdepth\n                  {9}\n!  ==> Fatal error occurred, no output PDF file produced!\n```\n\n > Or you can just be lazy and put the categories.tex file in the directory \n> \n> ```\n>         <SAGE>/devel/sage/doc/output/latex/en/reference/categories\n> ```\n> and run pdflatex from there.\n\nNope, because this folder doesn't exist. Do I need to attempt building the pdf documentation first?",
    "created_at": "2013-08-28T09:43:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75513",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:58" align="right">comment:58</div>

Replying to [@nthiery](#comment%3A57):
> Replying to [@simon-king-jena](#comment%3A56):
> > When I do `declare -x TEXINPUTS=.:$SAGE_ROOT/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/` then it does find sphinxmanual.cls, but the next attempt to call pdflatex on categories.tex fails as well. This time, it can't find `report.cls`.

>
> You are missing a : at the end of TEXINPUT to let latex use its own library (report.cls is a standard class). 

Nope. After

```
declare -x TEXINPUTS=.:~/SAGE/prerelease/sage-5.11.beta3/local/lib/python2.7/site-packages/Sphinx-1.1.2-py2.7.egg/sphinx/texinputs/:
```
`pdflatex categories.tex` results in

```
! Undefined control sequence.
<recently read> \setlistdepth 
                              
l.19 \setlistdepth
                  {9}
? 
! Emergency stop.
<recently read> \setlistdepth 
                              
l.19 \setlistdepth
                  {9}
!  ==> Fatal error occurred, no output PDF file produced!
```

 > Or you can just be lazy and put the categories.tex file in the directory 
> 
> ```
>         <SAGE>/devel/sage/doc/output/latex/en/reference/categories
> ```
> and run pdflatex from there.

Nope, because this folder doesn't exist. Do I need to attempt building the pdf documentation first?



---

archive/issue_comments_075514.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nPS: Changing\n\n```\n\\RequirePackage{enumitem}\n```\ninto\n\n```\n\\usepackage{enumitem}\n```\ndid not help.",
    "created_at": "2013-08-28T09:45:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75514",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:59" align="right">comment:59</div>

PS: Changing

```
\RequirePackage{enumitem}
```
into

```
\usepackage{enumitem}
```
did not help.



---

archive/issue_comments_075515.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nAha. The log shows:\n\n```\nenumitem 2009/05/18 v2.2 Customized lists\n```\nand I guess that's too old.",
    "created_at": "2013-08-28T10:24:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75515",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:60" align="right">comment:60</div>

Aha. The log shows:

```
enumitem 2009/05/18 v2.2 Customized lists
```
and I guess that's too old.



---

archive/issue_comments_075516.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nOK, after getting a more recent version of the enumitem package, I first get a \"too deeply nested\" error on [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz). However, after doing\n\n```\n\\setlistdepth{10}\n```\n(and not just depth 9), it compiles fine.\n\nSo, in other words, the problem *can* be solved. But I really wonder about the requirement that the user has to have a latex installation with a very recent enumitem. Can this be really required? Or would we be allowed to ship enumitem.sty with Sage?",
    "created_at": "2013-08-28T10:41:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75516",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:61" align="right">comment:61</div>

OK, after getting a more recent version of the enumitem package, I first get a "too deeply nested" error on [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz). However, after doing

```
\setlistdepth{10}
```
(and not just depth 9), it compiles fine.

So, in other words, the problem *can* be solved. But I really wonder about the requirement that the user has to have a latex installation with a very recent enumitem. Can this be really required? Or would we be allowed to ship enumitem.sty with Sage?



---

archive/issue_comments_075517.json:
```json
{
    "body": "Output of pdflatex after doing setlistdept(10) in categories.tex",
    "created_at": "2013-08-28T10:44:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75517",
    "user": "https://github.com/simon-king-jena"
}
```

Output of pdflatex after doing setlistdept(10) in categories.tex



---

archive/issue_comments_075518.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nAttachment: **[categories.pdf.gz](https://github.com/sagemath/sage/files/ticket9107/categories.pdf.gz)**\n\nWell, it does compile, but it does not work. Look at the ugly output in [attachment: categories.pdf](https://github.com/sagemath/sage/files/ticket9107/categories.pdf.gz).",
    "created_at": "2013-08-28T10:45:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75518",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:62" align="right">comment:62</div>

Attachment: **[categories.pdf.gz](https://github.com/sagemath/sage/files/ticket9107/categories.pdf.gz)**

Well, it does compile, but it does not work. Look at the ugly output in [attachment: categories.pdf](https://github.com/sagemath/sage/files/ticket9107/categories.pdf.gz).



---

archive/issue_comments_075519.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@simon-king-jena](#comment%3A61):\n> OK, after getting a more recent version of the enumitem package, I first get a \"too deeply nested\" error on [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz). However, after doing\n> \n> ```\n> \\setlistdepth{10}\n> ```\n> (and not just depth 9), it compiles fine.\n> So, in other words, the problem *can* be solved.\n\nWhat? Really? I thought I had tried that. Ah, I see, the level that\nyou have to put seems to actually have nothing to do with the actual\ndepth of your itemize. Now I can compile the full categories\ndocumentation, but that requires `\\setlistdepth{275`}!!! There\nmust be something wrong in the depth-counting logic of enumitem ...\n\n> But I really wonder about the requirement that the user has to have\n> a latex installation with a very recent enumitem. Can this be really\n> required? Or would we be allowed to ship enumitem.sty with Sage?\n\nI would vote for shipping enumitem.sty if that's easy. Jeroen/Volker/..., can we just throw it in\n`/opt/sage-dev/local/share/texmf/tex/generic` ?\n\n\nCheers,\n                                Nicolas",
    "created_at": "2013-08-28T12:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75519",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@simon-king-jena](#comment%3A61):
> OK, after getting a more recent version of the enumitem package, I first get a "too deeply nested" error on [attachment: categories.tex](https://github.com/sagemath/sage/files/ticket9107/categories.tex.gz). However, after doing
> 
> ```
> \setlistdepth{10}
> ```
> (and not just depth 9), it compiles fine.
> So, in other words, the problem *can* be solved.

What? Really? I thought I had tried that. Ah, I see, the level that
you have to put seems to actually have nothing to do with the actual
depth of your itemize. Now I can compile the full categories
documentation, but that requires `\setlistdepth{275`}!!! There
must be something wrong in the depth-counting logic of enumitem ...

> But I really wonder about the requirement that the user has to have
> a latex installation with a very recent enumitem. Can this be really
> required? Or would we be allowed to ship enumitem.sty with Sage?

I would vote for shipping enumitem.sty if that's easy. Jeroen/Volker/..., can we just throw it in
`/opt/sage-dev/local/share/texmf/tex/generic` ?


Cheers,
                                Nicolas



---

archive/issue_comments_075520.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nReplying to [@simon-king-jena](#comment%3A62):\n> Well, it does compile, but it does not work. Look at the ugly output in [attachment: categories.pdf](https://github.com/sagemath/sage/files/ticket9107/categories.pdf.gz).\n\nNothing to worry about: this filed was obtained by stripping lots of stuff from an actual tex file; I am not surprised it does not look good. On the other hand, I had a look at the full categories.pdf produced by sphinx, and it looked reasonable.",
    "created_at": "2013-08-28T12:59:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75520",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:64" align="right">comment:64</div>

Replying to [@simon-king-jena](#comment%3A62):
> Well, it does compile, but it does not work. Look at the ugly output in [attachment: categories.pdf](https://github.com/sagemath/sage/files/ticket9107/categories.pdf.gz).

Nothing to worry about: this filed was obtained by stripping lots of stuff from an actual tex file; I am not surprised it does not look good. On the other hand, I had a look at the full categories.pdf produced by sphinx, and it looked reasonable.



---

archive/issue_comments_075521.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nReplying to [@nthiery](#comment%3A63):\n> Now I can compile the full categories\n> documentation, but that requires `\\setlistdepth{275`}!!! There\n> must be something wrong in the depth-counting logic of enumitem ...\n\nOuch. So, if it really turns out that the depth-counting is broken (did you check that the nesting of lists in the created tex file are not broken?), then we should perhaps consider to search for an alternative solution.\n\nFor example, is it really needed to use nesting in the resulting tex file? Or could one create a nice layout without nesting? If I understand correctly, *we* (i.e., Sage) are creating the tex file. Hence, we can control what happens.\n\n> I would vote for shipping enumitem.sty if that's easy. Jeroen/Volker/..., can we just throw it in\n> `/opt/sage-dev/local/share/texmf/tex/generic` ?\n\nI have already asked on [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/8Q-I0e2OESE)...",
    "created_at": "2013-08-28T13:06:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75521",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:65" align="right">comment:65</div>

Replying to [@nthiery](#comment%3A63):
> Now I can compile the full categories
> documentation, but that requires `\setlistdepth{275`}!!! There
> must be something wrong in the depth-counting logic of enumitem ...

Ouch. So, if it really turns out that the depth-counting is broken (did you check that the nesting of lists in the created tex file are not broken?), then we should perhaps consider to search for an alternative solution.

For example, is it really needed to use nesting in the resulting tex file? Or could one create a nice layout without nesting? If I understand correctly, *we* (i.e., Sage) are creating the tex file. Hence, we can control what happens.

> I would vote for shipping enumitem.sty if that's easy. Jeroen/Volker/..., can we just throw it in
> `/opt/sage-dev/local/share/texmf/tex/generic` ?

I have already asked on [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/8Q-I0e2OESE)...



---

archive/issue_comments_075522.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nReplying to [@simon-king-jena](#comment%3A65):\n> I have already asked on [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/8Q-I0e2OESE)...\n\nThanks for the pointer. I answered there.",
    "created_at": "2013-08-29T16:14:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75522",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:66" align="right">comment:66</div>

Replying to [@simon-king-jena](#comment%3A65):
> I have already asked on [sage-devel](https://groups.google.com/forum/#!topic/sage-devel/8Q-I0e2OESE)...

Thanks for the pointer. I answered there.



---

archive/issue_events_115005.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115005"
}
```



---

archive/issue_events_115006.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115006"
}
```



---

archive/issue_events_115007.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115007"
}
```



---

archive/issue_events_115008.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115008"
}
```



---

archive/issue_comments_075523.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nJust require enumitems, geez... Afair we already require a number of packages that are not part of a \"small\"/\"medium\" TeXLive install. One more doesn't make a difference.",
    "created_at": "2014-06-12T14:01:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75523",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:69" align="right">comment:69</div>

Just require enumitems, geez... Afair we already require a number of packages that are not part of a "small"/"medium" TeXLive install. One more doesn't make a difference.



---

archive/issue_comments_075524.json:
```json
{
    "body": "Branch: **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)**",
    "created_at": "2014-06-12T14:54:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75524",
    "user": "https://github.com/nthiery"
}
```

Branch: **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)**



---

archive/issue_comments_075525.json:
```json
{
    "body": "Changed branch from **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)** to none",
    "created_at": "2014-06-12T14:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75525",
    "user": "https://github.com/nthiery"
}
```

Changed branch from **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)** to none



---

archive/issue_comments_075526.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nYeah, you are right, let's make it simple. I for example had to install a bunch of language packages (russian, ...) to get the pdf doc to install a couple days ago.\n\nFirst attempt pushed. Compiling the doc and running the tests now.\n\nCheers,\n                            Nicolas",
    "created_at": "2014-06-12T14:55:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75526",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:71" align="right">comment:71</div>

Yeah, you are right, let's make it simple. I for example had to install a bunch of language packages (russian, ...) to get the pdf doc to install a couple days ago.

First attempt pushed. Compiling the doc and running the tests now.

Cheers,
                            Nicolas



---

archive/issue_comments_075527.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nReplying to [@vbraun](#comment%3A69):\n> Just require enumitems, geez... \n\nWhat exactly do you mean? Would it be sufficient to let Sage insert `usepackage{enumitem}` (I have not heard about the plural, `enumitems`), or will we also need to change the latex code emitted for nested classes? And how?",
    "created_at": "2014-06-12T15:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75527",
    "user": "https://github.com/simon-king-jena"
}
```

<div id="comment:72" align="right">comment:72</div>

Replying to [@vbraun](#comment%3A69):
> Just require enumitems, geez... 

What exactly do you mean? Would it be sufficient to let Sage insert `usepackage{enumitem}` (I have not heard about the plural, `enumitems`), or will we also need to change the latex code emitted for nested classes? And how?



---

archive/issue_comments_075528.json:
```json
{
    "body": "<div id=\"comment:73\" align=\"right\">comment:73</div>\n\nReplying to [@simon-king-jena](#comment%3A72):\n> What exactly do you mean? Would it be sufficient to let Sage insert `usepackage{enumitem}`\n\nThat's my understanding and what I did in my latest commit. Plus raising the depth limit to a stupidly high value.\n\nThere seems to still be some compilation issue, but I guess they are just due to more stuff getting compiled, hence catching glitches that had gone unnoticed so far. I'll check this out tomorrow.\n\nCheers,\n                                Nicolas",
    "created_at": "2014-06-12T21:50:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75528",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:73" align="right">comment:73</div>

Replying to [@simon-king-jena](#comment%3A72):
> What exactly do you mean? Would it be sufficient to let Sage insert `usepackage{enumitem}`

That's my understanding and what I did in my latest commit. Plus raising the depth limit to a stupidly high value.

There seems to still be some compilation issue, but I guess they are just due to more stuff getting compiled, hence catching glitches that had gone unnoticed so far. I'll check this out tomorrow.

Cheers,
                                Nicolas



---

archive/issue_comments_075529.json:
```json
{
    "body": "Branch: **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)**",
    "created_at": "2014-06-13T09:18:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75529",
    "user": "https://github.com/nthiery"
}
```

Branch: **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)**



---

archive/issue_comments_075530.json:
```json
{
    "body": "Commit: **[`891c3fa`](https://github.com/sagemath/sagetrac-mirror/commit/891c3fad654e89e6b96bcf8f79114f631c8b7bba)**",
    "created_at": "2014-06-13T09:24:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75530",
    "user": "https://github.com/nthiery"
}
```

Commit: **[`891c3fa`](https://github.com/sagemath/sagetrac-mirror/commit/891c3fad654e89e6b96bcf8f79114f631c8b7bba)**



---

archive/issue_comments_075531.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nGosh, it turned out that using `\\setlistdepth{275}` was not sufficient\nanymore: I had to use `\\setlistdepth{2000}`! This meant the problem\nwould just keep going to be worst and worst with time.\n\nSo I investigated a further and got lucky this time: if we replace\nlist by trivlist in the customized Verbatim defined by `sphinx.sty`,\nthen our documenation compiles smoothly, without even using enumitem.\n\nI proposed this fix upstream:\n\nhttps://bitbucket.org/birkenfeld/sphinx/issue/777/latex-output-too-deeply-nested\n\nFor the time being, I tweaked our conf.py to redefine and fix sphinx's\nVerbatim.\n\nOk, now there just remains to check that all tests pass, and this will\nbe a needs review.\n\nCheers,\n                              Nicolas\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/727bd6a3ce1c577295a5fd421c257ae89618e989\"><code>727bd6a</code></a></td><td><code>#9107: Enable nesting of a nested class into a nested class</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/213e3b1a612b7e34933432fdd01d0d3f61fe7016\"><code>213e3b1</code></a></td><td><code>#9107: Fix one cross reference in the documentation of a functorial construction</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/66b7e72505a6683f246535083f071a3963b11104\"><code>66b7e72</code></a></td><td><code>#9107: fix a docstring (missing example and raw)</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/891c3fad654e89e6b96bcf8f79114f631c8b7bba\"><code>891c3fa</code></a></td><td><code>#9107: monkey patch a fix for deeply nested pdflatex compilation error until it's merged upstream (Sphinx #777)</code></td></tr></table>\n",
    "created_at": "2014-06-13T09:24:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75531",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:75" align="right">comment:75</div>

Gosh, it turned out that using `\setlistdepth{275}` was not sufficient
anymore: I had to use `\setlistdepth{2000}`! This meant the problem
would just keep going to be worst and worst with time.

So I investigated a further and got lucky this time: if we replace
list by trivlist in the customized Verbatim defined by `sphinx.sty`,
then our documenation compiles smoothly, without even using enumitem.

I proposed this fix upstream:

https://bitbucket.org/birkenfeld/sphinx/issue/777/latex-output-too-deeply-nested

For the time being, I tweaked our conf.py to redefine and fix sphinx's
Verbatim.

Ok, now there just remains to check that all tests pass, and this will
be a needs review.

Cheers,
                              Nicolas

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/727bd6a3ce1c577295a5fd421c257ae89618e989"><code>727bd6a</code></a></td><td><code>#9107: Enable nesting of a nested class into a nested class</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/213e3b1a612b7e34933432fdd01d0d3f61fe7016"><code>213e3b1</code></a></td><td><code>#9107: Fix one cross reference in the documentation of a functorial construction</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/66b7e72505a6683f246535083f071a3963b11104"><code>66b7e72</code></a></td><td><code>#9107: fix a docstring (missing example and raw)</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/891c3fad654e89e6b96bcf8f79114f631c8b7bba"><code>891c3fa</code></a></td><td><code>#9107: monkey patch a fix for deeply nested pdflatex compilation error until it's merged upstream (Sphinx #777)</code></td></tr></table>




---

archive/issue_comments_075532.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nIs there a reason why you don't patch the sphinx spkg directly?",
    "created_at": "2014-06-13T16:52:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75532",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:76" align="right">comment:76</div>

Is there a reason why you don't patch the sphinx spkg directly?



---

archive/issue_comments_075533.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nReplying to [@tscrim](#comment%3A76):\n> Is there a reason why you don't patch the sphinx spkg directly?\n\nLazyness mostly. If someone whats to create a patch, adapt the spkg, ... please go ahead!",
    "created_at": "2014-06-13T19:35:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75533",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:77" align="right">comment:77</div>

Replying to [@tscrim](#comment%3A76):
> Is there a reason why you don't patch the sphinx spkg directly?

Lazyness mostly. If someone whats to create a patch, adapt the spkg, ... please go ahead!



---

archive/issue_comments_075534.json:
```json
{
    "body": "Changed commit from **[`891c3fa`](https://github.com/sagemath/sagetrac-mirror/commit/891c3fad654e89e6b96bcf8f79114f631c8b7bba)** to **[`ed2c704`](https://github.com/sagemath/sagetrac-mirror/commit/ed2c7047aab14dce0abbf22eb531fa0667179982)**",
    "created_at": "2014-06-13T19:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75534",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`891c3fa`](https://github.com/sagemath/sagetrac-mirror/commit/891c3fad654e89e6b96bcf8f79114f631c8b7bba)** to **[`ed2c704`](https://github.com/sagemath/sagetrac-mirror/commit/ed2c7047aab14dce0abbf22eb531fa0667179982)**



---

archive/issue_comments_075535.json:
```json
{
    "body": "<div id=\"comment:78\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/ed2c7047aab14dce0abbf22eb531fa0667179982\"><code>ed2c704</code></a></td><td><code>#9107: updated doctests now that the name of deeply nested classes is finaly correct</code></td></tr></table>\n",
    "created_at": "2014-06-13T19:43:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75535",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:78"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/ed2c7047aab14dce0abbf22eb531fa0667179982"><code>ed2c704</code></a></td><td><code>#9107: updated doctests now that the name of deeply nested classes is finaly correct</code></td></tr></table>




---

archive/issue_comments_075536.json:
```json
{
    "body": "<div id=\"comment:79\" align=\"right\">comment:79</div>\n\nOk, there were a couple doctest failures, all to be expected since nested classes now have a correct name. Fixed now. So that's a needs review!",
    "created_at": "2014-06-13T19:44:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75536",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:79" align="right">comment:79</div>

Ok, there were a couple doctest failures, all to be expected since nested classes now have a correct name. Fixed now. So that's a needs review!



---

archive/issue_events_115009.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2014-06-13T19:44:51Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115009"
}
```



---

archive/issue_events_115010.json:
```json
{
    "actor": "https://github.com/nthiery",
    "created_at": "2014-06-13T19:44:51Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115010"
}
```



---

archive/issue_comments_075537.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nHere's a version with a patched version of the sphinx spkg. Although I think your pull request is based on v1.2 (but it still applied (for me) to our current v1.1). Could someone check to make sure I created the patch correctly (and tell me what I should do instead if it isn't right).\n\n---\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/d6b432b24b3f1fbfc5298fe096a13e095dda8b1f\"><code>d6b432b</code></a></td><td><code>Moved hack conf.py to proper patch.</code></td></tr></table>\n",
    "created_at": "2014-06-13T21:05:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75537",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:80" align="right">comment:80</div>

Here's a version with a patched version of the sphinx spkg. Although I think your pull request is based on v1.2 (but it still applied (for me) to our current v1.1). Could someone check to make sure I created the patch correctly (and tell me what I should do instead if it isn't right).

---
New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/d6b432b24b3f1fbfc5298fe096a13e095dda8b1f"><code>d6b432b</code></a></td><td><code>Moved hack conf.py to proper patch.</code></td></tr></table>




---

archive/issue_comments_075538.json:
```json
{
    "body": "Changed commit from **[`ed2c704`](https://github.com/sagemath/sagetrac-mirror/commit/ed2c7047aab14dce0abbf22eb531fa0667179982)** to **[`d6b432b`](https://github.com/sagemath/sagetrac-mirror/commit/d6b432b24b3f1fbfc5298fe096a13e095dda8b1f)**",
    "created_at": "2014-06-13T21:05:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75538",
    "user": "https://github.com/tscrim"
}
```

Changed commit from **[`ed2c704`](https://github.com/sagemath/sagetrac-mirror/commit/ed2c7047aab14dce0abbf22eb531fa0667179982)** to **[`d6b432b`](https://github.com/sagemath/sagetrac-mirror/commit/d6b432b24b3f1fbfc5298fe096a13e095dda8b1f)**



---

archive/issue_comments_075539.json:
```json
{
    "body": "Changed branch from **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)** to **[public/nested_class-9107](https://github.com/sagemath/sagetrac-mirror/tree/public/nested_class-9107)**",
    "created_at": "2014-06-13T21:05:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75539",
    "user": "https://github.com/tscrim"
}
```

Changed branch from **[u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting](https://github.com/sagemath/sagetrac-mirror/tree/u/nthiery/nested_class_name_mangling_can_be_wrong_in_case_of_double_nesting)** to **[public/nested_class-9107](https://github.com/sagemath/sagetrac-mirror/tree/public/nested_class-9107)**



---

archive/issue_comments_075540.json:
```json
{
    "body": "<div id=\"comment:81\"></div>\n\nBranch pushed to git repo; I updated commit sha1. New commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4\"><code>8b14e05</code></a></td><td><code>#9107: improved description of Sphinx's patch nested.patch</code></td></tr></table>\n",
    "created_at": "2014-06-16T19:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75540",
    "user": "https://github.com/sagetrac-git"
}
```

<div id="comment:81"></div>

Branch pushed to git repo; I updated commit sha1. New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4"><code>8b14e05</code></a></td><td><code>#9107: improved description of Sphinx's patch nested.patch</code></td></tr></table>




---

archive/issue_comments_075541.json:
```json
{
    "body": "Changed commit from **[`d6b432b`](https://github.com/sagemath/sagetrac-mirror/commit/d6b432b24b3f1fbfc5298fe096a13e095dda8b1f)** to **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)**",
    "created_at": "2014-06-16T19:57:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75541",
    "user": "https://github.com/sagetrac-git"
}
```

Changed commit from **[`d6b432b`](https://github.com/sagemath/sagetrac-mirror/commit/d6b432b24b3f1fbfc5298fe096a13e095dda8b1f)** to **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)**



---

archive/issue_comments_075542.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nReplying to [@tscrim](#comment%3A80):\n> Here's a version with a patched version of the sphinx spkg.\n\nAh, that's nice: modifying standard spkgs is much simpler now that we have a single repository. Thanks!\n\n> Although I think your pull request is based on v1.2 (but it still applied (for me) to our current v1.1). Could someone check to make sure I created the patch correctly (and tell me what I should do instead if it isn't right).\n\nIt seems to apply as it's supposed to (modulo trivial line offset).\n\nI have made some minor improvement to the patch description.\n\nI am a bit nervous about the removal of the former change log in SPKG.txt. But if someone can confirm that this is the right thing to do, that's ok for me.\n\nOther than this, this sounds good to go!\n\nThanks again,\n                                            Nicolas",
    "created_at": "2014-06-16T20:03:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75542",
    "user": "https://github.com/nthiery"
}
```

<div id="comment:82" align="right">comment:82</div>

Replying to [@tscrim](#comment%3A80):
> Here's a version with a patched version of the sphinx spkg.

Ah, that's nice: modifying standard spkgs is much simpler now that we have a single repository. Thanks!

> Although I think your pull request is based on v1.2 (but it still applied (for me) to our current v1.1). Could someone check to make sure I created the patch correctly (and tell me what I should do instead if it isn't right).

It seems to apply as it's supposed to (modulo trivial line offset).

I have made some minor improvement to the patch description.

I am a bit nervous about the removal of the former change log in SPKG.txt. But if someone can confirm that this is the right thing to do, that's ok for me.

Other than this, this sounds good to go!

Thanks again,
                                            Nicolas



---

archive/issue_comments_075543.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nReplying to [@nthiery](#comment%3A82):\n> I am a bit nervous about the removal of the former change log in SPKG.txt. But if someone can confirm that this is the right thing to do, that's ok for me.\n\nDo it! ;-)",
    "created_at": "2014-06-16T21:02:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75543",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:83" align="right">comment:83</div>

Replying to [@nthiery](#comment%3A82):
> I am a bit nervous about the removal of the former change log in SPKG.txt. But if someone can confirm that this is the right thing to do, that's ok for me.

Do it! ;-)



---

archive/issue_comments_075544.json:
```json
{
    "body": "Changed reviewer from **Volker Braun, Florent Hivert** to **Volker Braun, Florent Hivert, Travis Scrimshaw**",
    "created_at": "2014-06-17T02:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75544",
    "user": "https://github.com/tscrim"
}
```

Changed reviewer from **Volker Braun, Florent Hivert** to **Volker Braun, Florent Hivert, Travis Scrimshaw**



---

archive/issue_comments_075545.json:
```json
{
    "body": "Changed author from **Simon King** to **Simon King, Nicolas M. Thi\u00e9ry**",
    "created_at": "2014-06-17T02:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75545",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Simon King** to **Simon King, Nicolas M. Thi√©ry**



---

archive/issue_comments_075546.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nThen away we go.",
    "created_at": "2014-06-17T02:03:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75546",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:84" align="right">comment:84</div>

Then away we go.



---

archive/issue_events_115011.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-06-17T02:03:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115011"
}
```



---

archive/issue_events_115012.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2014-06-17T02:03:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115012"
}
```



---

archive/issue_comments_075547.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nThanks for fixing this !!!",
    "created_at": "2014-06-18T12:39:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75547",
    "user": "https://github.com/nathanncohen"
}
```

<div id="comment:85" align="right">comment:85</div>

Thanks for fixing this !!!



---

archive/issue_events_115013.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2014-06-18T14:11:28Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115013"
}
```



---

archive/issue_events_115014.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "d23f8bf4f91aeab2cc64f3cacbd75e2fa65e8ffd",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2014-06-18T14:11:28Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9107#event-115014"
}
```



---

archive/issue_comments_075548.json:
```json
{
    "body": "Changed branch from **[public/nested_class-9107](https://github.com/sagemath/sagetrac-mirror/tree/public/nested_class-9107)** to **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)**",
    "created_at": "2014-06-18T14:11:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75548",
    "user": "https://github.com/vbraun"
}
```

Changed branch from **[public/nested_class-9107](https://github.com/sagemath/sagetrac-mirror/tree/public/nested_class-9107)** to **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)**



---

archive/issue_comments_075549.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -4,10 +4,10 @@\n class Bla(UniqueRepresentation):\n     class Bla1(UniqueRepresentation):\n         class Bla11:\n-\t    Pass\n+            Pass\n     class Bla2:\n         class Bla21:\n-\t    Pass\n+            Pass\n ```\n The names are set to\n \n``````\n",
    "created_at": "2015-09-06T17:10:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75549",
    "user": "https://github.com/fchapoton"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -4,10 +4,10 @@
 class Bla(UniqueRepresentation):
     class Bla1(UniqueRepresentation):
         class Bla11:
-	    Pass
+            Pass
     class Bla2:
         class Bla21:
-	    Pass
+            Pass
 ```
 The names are set to
 
``````




---

archive/issue_comments_075550.json:
```json
{
    "body": "Changed commit from **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)** to none",
    "created_at": "2015-09-06T17:10:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9107",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9107#issuecomment-75550",
    "user": "https://github.com/fchapoton"
}
```

Changed commit from **[`8b14e05`](https://github.com/sagemath/sagetrac-mirror/commit/8b14e051c933f2ec2ae9891efbf329e7f0f2cba4)** to none
