# Issue 9530: Improve/fix readline workarounds for Arch Linux and openSUSE, again broken on OpenSUSE 11.2 and 11.3

archive/issues_009530.json:
```json
{
    "body": "Sage currently has workarounds against building an incompatible libreadline on openSuSE 11.1 and Arch Linux - instead of building it, the system version is copied.\n\nThe SuSE workaround should be applied to openSuSE 11.2 and 11.3, too. Furthermore, SuSE offers libreadline.so.5 in addition to .so.6, so we only copy .6.\n\nThe workaround on Arch Linux is unreliable, as it detects Arch Linux by \"-ARCH\" in the kernel version (which is the default, but might be different). Instead, the presence of /etc/arch-release should be used to determine that.\n\nI am attaching a patch that fixes those problems and changes 'cp' to 'cp -a' to not turn a symlink into a file. Without this patch, sage fails to build on my SuSE or Arch systems.\n\nNew spkg:\n\n http://spkg-upload.googlecode.com/files/readline-6.0.p4.spkg\n\n**Assignee:** GeorgSWeber\n\n**CC:**  @nexttime drkirkby @qed777 @hivert\n\n**Keywords:** Arch Linux SuSE readline\n\n**Author:** Thomas B\u00e4chler, Leif Leonhardy\n\n**Reviewer:** David Kirkby\n\n**Merged:** sage-4.6\n\nIssue created by migration from https://trac.sagemath.org/ticket/9530\n\n",
    "closed_at": "2010-10-30T10:38:40Z",
    "created_at": "2010-07-17T14:31:52Z",
    "labels": [
        "component: build",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6",
    "title": "Improve/fix readline workarounds for Arch Linux and openSUSE, again broken on OpenSUSE 11.2 and 11.3",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/9530",
    "user": "https://trac.sagemath.org/admin/accounts/users/baechler"
}
```
Sage currently has workarounds against building an incompatible libreadline on openSuSE 11.1 and Arch Linux - instead of building it, the system version is copied.

The SuSE workaround should be applied to openSuSE 11.2 and 11.3, too. Furthermore, SuSE offers libreadline.so.5 in addition to .so.6, so we only copy .6.

The workaround on Arch Linux is unreliable, as it detects Arch Linux by "-ARCH" in the kernel version (which is the default, but might be different). Instead, the presence of /etc/arch-release should be used to determine that.

I am attaching a patch that fixes those problems and changes 'cp' to 'cp -a' to not turn a symlink into a file. Without this patch, sage fails to build on my SuSE or Arch systems.

New spkg:

 http://spkg-upload.googlecode.com/files/readline-6.0.p4.spkg

**Assignee:** GeorgSWeber

**CC:**  @nexttime drkirkby @qed777 @hivert

**Keywords:** Arch Linux SuSE readline

**Author:** Thomas Bächler, Leif Leonhardy

**Reviewer:** David Kirkby

**Merged:** sage-4.6

Issue created by migration from https://trac.sagemath.org/ticket/9530





---

archive/attachments_012628.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "readline-6.0.p2.spkg.patch",
    "asset_url": "tarball://root/attachments/ticket9530/readline-6.0.p2.spkg.patch",
    "created_at": "2010-07-17T21:36:55Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket9530/readline-6.0.p2.spkg.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/cwitty"
}
```



---

archive/issue_comments_084344.json:
```json
{
    "body": "<a id='comment:1'></a>\n**Attachment:** [readline-6.0.p2.spkg.patch](https://github.com/sagemath/sage/files/ticket9530/readline-6.0.p2.spkg.patch)\n\nIs it actually worth fixing the workarounds?  It seems like upgrading readline (#9523) wouldn't be much more work, and then we could probably just remove the workarounds.",
    "created_at": "2010-07-17T21:36:55Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84344",
    "user": "https://trac.sagemath.org/admin/accounts/users/cwitty"
}
```

<a id='comment:1'></a>
**Attachment:** [readline-6.0.p2.spkg.patch](https://github.com/sagemath/sage/files/ticket9530/readline-6.0.p2.spkg.patch)

Is it actually worth fixing the workarounds?  It seems like upgrading readline (#9523) wouldn't be much more work, and then we could probably just remove the workarounds.



---

archive/issue_comments_084345.json:
```json
{
    "body": "<a id='comment:2'></a>\nIt might fix the problem for now. And when the system readline is upgraded again, everything is broken again.\n\nI don't like that situation that sage wants to build its own version of libreadline - in my opinion it causes more problems than it solves. As long as sage wants to use its own readline version in favor of the system library, this problem will never fully go away.",
    "created_at": "2010-07-18T06:31:48Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84345",
    "user": "https://trac.sagemath.org/admin/accounts/users/baechler"
}
```

<a id='comment:2'></a>
It might fix the problem for now. And when the system readline is upgraded again, everything is broken again.

I don't like that situation that sage wants to build its own version of libreadline - in my opinion it causes more problems than it solves. As long as sage wants to use its own readline version in favor of the system library, this problem will never fully go away.



---

archive/issue_comments_084346.json:
```json
{
    "body": "<a id='comment:3'></a>\nWhat if you used symlinks to the native libreadline instead of copying it?\n\nSo instead of:\n\ncp -a /lib64/libreadline.so.6* \"$SAGE_LOCAL\"/lib\ncp -a /lib/libreadline.so.6* \"$SAGE_LOCAL\"/lib\ncp -r /usr/include/readline  \"$SAGE_LOCAL\"/include \ncp /lib/libreadline.so.* \"$SAGE_LOCAL\"/lib \ncp -a /lib/libreadline.so.6* \"$SAGE_LOCAL\"/lib \n\nIt does:\n\nln -s /lib64/libreadline.so.6* \"$SAGE_LOCAL\"/lib\nln -s /lib/libreadline.so.6* \"$SAGE_LOCAL\"/lib\nln -s /usr/include/readline  \"$SAGE_LOCAL\"/include\nln -s /lib/libreadline.so.* \"$SAGE_LOCAL\"/lib \nln -s /lib/libreadline.so.6* \"$SAGE_LOCAL\"/lib \n\nThis should avoid the problem with upgrades changing libreadline again, and will save a little space.",
    "created_at": "2010-08-09T16:17:20Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84346",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:3'></a>
What if you used symlinks to the native libreadline instead of copying it?

So instead of:

cp -a /lib64/libreadline.so.6* "$SAGE_LOCAL"/lib
cp -a /lib/libreadline.so.6* "$SAGE_LOCAL"/lib
cp -r /usr/include/readline  "$SAGE_LOCAL"/include 
cp /lib/libreadline.so.* "$SAGE_LOCAL"/lib 
cp -a /lib/libreadline.so.6* "$SAGE_LOCAL"/lib 

It does:

ln -s /lib64/libreadline.so.6* "$SAGE_LOCAL"/lib
ln -s /lib/libreadline.so.6* "$SAGE_LOCAL"/lib
ln -s /usr/include/readline  "$SAGE_LOCAL"/include
ln -s /lib/libreadline.so.* "$SAGE_LOCAL"/lib 
ln -s /lib/libreadline.so.6* "$SAGE_LOCAL"/lib 

This should avoid the problem with upgrades changing libreadline again, and will save a little space.



---

archive/issue_comments_084347.json:
```json
{
    "body": "<a id='comment:4'></a>\nThe formatting got messed up.\u00a0 Here is an example:\n\nThis:\n\ncp -a /lib64/libreadline.so.6* \"$SAGE_LOCAL\"/lib \n\nbecomes:\n\nln -s /lib64/libreadline.so.6* \"$SAGE_LOCAL\"/lib",
    "created_at": "2010-08-09T16:19:22Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84347",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:4'></a>
The formatting got messed up.  Here is an example:

This:

cp -a /lib64/libreadline.so.6* "$SAGE_LOCAL"/lib 

becomes:

ln -s /lib64/libreadline.so.6* "$SAGE_LOCAL"/lib



---

archive/issue_comments_084348.json:
```json
{
    "body": "<a id='comment:6'></a>\nSince the update for readline has been pushed back to at least 4.6.1, can we get this workaround in 4.6?  We have a patch that fixes the problem, is small, and is low-risk.  With the switch from 4.5 to 4.6 I think it is important that it successfully compiles on significant distributions like openSUSE and Arch.",
    "created_at": "2010-10-07T15:35:27Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84348",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:6'></a>
Since the update for readline has been pushed back to at least 4.6.1, can we get this workaround in 4.6?  We have a patch that fixes the problem, is small, and is low-risk.  With the switch from 4.5 to 4.6 I think it is important that it successfully compiles on significant distributions like openSUSE and Arch.



---

archive/issue_events_070388.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-10-24T16:59:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70388"
}
```



---

archive/issue_comments_084349.json:
```json
{
    "body": "<a id='comment:7'></a>\nThough the patch is not a Mercurial changeset...\n\nIf we keep using the system's readline on OpenSuSE 11[.1], we could incorporate the patch into #9523 (upgrade to readline 6.1).",
    "created_at": "2010-10-24T16:59:20Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84349",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>
Though the patch is not a Mercurial changeset...

If we keep using the system's readline on OpenSuSE 11[.1], we could incorporate the patch into #9523 (upgrade to readline 6.1).



---

archive/issue_comments_084350.json:
```json
{
    "body": "<a id='comment:8'></a>\nI was thinking this made more as temporary workaround until 9523 render the workarounds unnecessary.\n\nI should add that I tried this patch and it worked.",
    "created_at": "2010-10-24T17:14:25Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84350",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:8'></a>
I was thinking this made more as temporary workaround until 9523 render the workarounds unnecessary.

I should add that I tried this patch and it worked.



---

archive/issue_comments_084351.json:
```json
{
    "body": "<a id='comment:9'></a>\nWell, the milestone of #9523 has been set to Sage 4.6.1.\n\nAlso, it's not clear to me if we should use the system's readline on OpenSuSE 11.1, and Sage's new readline 6.1 on OpenSuSE >11.1.",
    "created_at": "2010-10-24T17:29:17Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84351",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:9'></a>
Well, the milestone of #9523 has been set to Sage 4.6.1.

Also, it's not clear to me if we should use the system's readline on OpenSuSE 11.1, and Sage's new readline 6.1 on OpenSuSE >11.1.



---

archive/issue_comments_084352.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [@nexttime](#comment%3A9):\n> Well, the milestone of #9523 has been set to Sage 4.6.1.\n\nYes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.\n\nI think having it build successfully on the current version of major distributions would be a worthwhile goal for 4.6.  Optimizing that could wait until later.\n\nAnd that is assuming #9523 isn't bushed back again.  It was originally a 4.6 blocker.",
    "created_at": "2010-10-24T18:04:38Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84352",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:10'></a>
Replying to [@nexttime](#comment%3A9):
> Well, the milestone of #9523 has been set to Sage 4.6.1.

Yes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.

I think having it build successfully on the current version of major distributions would be a worthwhile goal for 4.6.  Optimizing that could wait until later.

And that is assuming #9523 isn't bushed back again.  It was originally a 4.6 blocker.



---

archive/issue_comments_084353.json:
```json
{
    "body": "<a id='comment:11'></a>\nReplying to [TheBlackCat](#comment%3A10):\n> Replying to [@nexttime](#comment%3A9):\n> > Well, the milestone of #9523 has been set to Sage 4.6.1.\n\n> \n> Yes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.\n\nThat's what I meant or intended: include #9530 into 4.6 (which requires a positive review), but *also* merge (some of) the changes here into #9530.",
    "created_at": "2010-10-24T18:24:00Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84353",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:11'></a>
Replying to [TheBlackCat](#comment%3A10):
> Replying to [@nexttime](#comment%3A9):
> > Well, the milestone of #9523 has been set to Sage 4.6.1.

> 
> Yes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.

That's what I meant or intended: include #9530 into 4.6 (which requires a positive review), but *also* merge (some of) the changes here into #9530.



---

archive/issue_comments_084354.json:
```json
{
    "body": "<a id='comment:12'></a>\nReplying to [@nexttime](#comment%3A11):\n> ... include #9530 into 4.6 (which requires a positive review)\n\n... and also a patched new spkg. I do not even know the name of the author, *baechler*.",
    "created_at": "2010-10-24T18:27:16Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84354",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:12'></a>
Replying to [@nexttime](#comment%3A11):
> ... include #9530 into 4.6 (which requires a positive review)

... and also a patched new spkg. I do not even know the name of the author, *baechler*.



---

archive/issue_comments_084355.json:
```json
{
    "body": "<a id='comment:13'></a>\nReplying to [TheBlackCat](#comment%3A10):\n> Replying to [@nexttime](#comment%3A9):\n> > Well, the milestone of #9523 has been set to Sage 4.6.1.\n\n> \n> Yes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.\n\n\nDespite trying - see for example \n\nhttp://wiki.sagemath.org/suggested-for-supported-platforms\n\nI've never managed to get any agreement on what is \"supported\". But it we believe README.txt, both ArchLinux and !OpenSUSE are supported. However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version. But if a change in Sage has broken one of these systems, then I think it should be addressed in 4.6. But if the breakages are caused by updated versions of Linux, then I think these systems will just have to accept that.",
    "created_at": "2010-10-24T18:39:00Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84355",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:13'></a>
Replying to [TheBlackCat](#comment%3A10):
> Replying to [@nexttime](#comment%3A9):
> > Well, the milestone of #9523 has been set to Sage 4.6.1.

> 
> Yes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.


Despite trying - see for example 

http://wiki.sagemath.org/suggested-for-supported-platforms

I've never managed to get any agreement on what is "supported". But it we believe README.txt, both ArchLinux and !OpenSUSE are supported. However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version. But if a change in Sage has broken one of these systems, then I think it should be addressed in 4.6. But if the breakages are caused by updated versions of Linux, then I think these systems will just have to accept that.



---

archive/issue_comments_084356.json:
```json
{
    "body": "<a id='comment:14'></a>\nReplying to [drkirkby](#comment%3A13):\n> However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version.\n\nYou don't understand the problem at all. Sage overrides the system libreadline with an older version, one that lacks features that the system shell requires. This is a problem that affects EVERY Linux distribution that is not terribly outdated (if I would say \"it doesn't build on Ubuntu\", you would probably suddenly take this seriously, but as long as it works on Ubuntu, it can't be not broken, right? It's not Ubuntu, so I have to keep repeating myself, until the problem eventually also affects Ubuntu)\n\nAs long as sage does not build its own shell for the build process, overriding the system libreadline is simply plain stupid, and will keep breaking again and again. In my opinion, sage should not ship its own libreadline if the system already provides readline version 6 or newer - eliminating all the mentioned problems.\n\nReplying to [@nexttime](#comment%3A12):\n> ... and also a patched new spkg. I do not even know the name of the author, baechler.\n\nSince when does that matter? If you must know:\nhttp://wwwb.math.rwth-aachen.de/Mitarbeiter/baechler.php?lang=eng\nhttp://www.archlinux.org/developers/#thomas",
    "created_at": "2010-10-24T19:07:40Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84356",
    "user": "https://trac.sagemath.org/admin/accounts/users/baechler"
}
```

<a id='comment:14'></a>
Replying to [drkirkby](#comment%3A13):
> However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version.

You don't understand the problem at all. Sage overrides the system libreadline with an older version, one that lacks features that the system shell requires. This is a problem that affects EVERY Linux distribution that is not terribly outdated (if I would say "it doesn't build on Ubuntu", you would probably suddenly take this seriously, but as long as it works on Ubuntu, it can't be not broken, right? It's not Ubuntu, so I have to keep repeating myself, until the problem eventually also affects Ubuntu)

As long as sage does not build its own shell for the build process, overriding the system libreadline is simply plain stupid, and will keep breaking again and again. In my opinion, sage should not ship its own libreadline if the system already provides readline version 6 or newer - eliminating all the mentioned problems.

Replying to [@nexttime](#comment%3A12):
> ... and also a patched new spkg. I do not even know the name of the author, baechler.

Since when does that matter? If you must know:
http://wwwb.math.rwth-aachen.de/Mitarbeiter/baechler.php?lang=eng
http://www.archlinux.org/developers/#thomas



---

archive/issue_comments_084357.json:
```json
{
    "body": "<a id='comment:15'></a>\nReplying to [drkirkby](#comment%3A13):\n> > Yes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.\n\n> I've never managed to get any agreement on what is \"supported\". But it we believe README.txt, both ArchLinux and !OpenSUSE are supported. However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version. But if a change in Sage has broken one of these systems, then I think it should be addressed in 4.6. But if the breakages are caused by updated versions of Linux, then I think these systems will just have to accept that. \n\nI agree we should not hold a release because of the lack of a fix for a new break caused by the distribution. However, neither is the case here.\n\nThe breakage first appeared in openSUSE 11.2, which was released almost a year ago.  openSUSE 11.3, which also has the problem, was released over 3 months ago.  So it is a long-standing issue.\n\nFurther, a fix is available, and has been for over 3 months now (shortly after openSUSE 11.3 was released).  The fix was published several weeks before sage 4.5.2 was released, over a month and a half before 4.5.3.\n\nSo this is a long-standing issue for which a fix has been available for a while.  Given that, I do not think holding 4.6 until the existing fix has been incorporated is outlandish.",
    "created_at": "2010-10-24T19:21:51Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84357",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:15'></a>
Replying to [drkirkby](#comment%3A13):
> > Yes, that is the problem.  As it stand now, Sage 4.6 will be released without being able to build as-is on a major distribution and won't build reliably on another.  We have a small, simple, low-risk fix available right now.  I think it would be good to incorporate the fix now rather than pushing it back again.

> I've never managed to get any agreement on what is "supported". But it we believe README.txt, both ArchLinux and !OpenSUSE are supported. However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version. But if a change in Sage has broken one of these systems, then I think it should be addressed in 4.6. But if the breakages are caused by updated versions of Linux, then I think these systems will just have to accept that. 

I agree we should not hold a release because of the lack of a fix for a new break caused by the distribution. However, neither is the case here.

The breakage first appeared in openSUSE 11.2, which was released almost a year ago.  openSUSE 11.3, which also has the problem, was released over 3 months ago.  So it is a long-standing issue.

Further, a fix is available, and has been for over 3 months now (shortly after openSUSE 11.3 was released).  The fix was published several weeks before sage 4.5.2 was released, over a month and a half before 4.5.3.

So this is a long-standing issue for which a fix has been available for a while.  Given that, I do not think holding 4.6 until the existing fix has been incorporated is outlandish.



---

archive/issue_comments_084358.json:
```json
{
    "body": "<a id='comment:16'></a>\nReplying to [baechler](#comment%3A14):\n> Replying to [@nexttime](#comment%3A12):\n> > ... and also a patched new spkg. I do not even know the name of the author, baechler.\n\n> \n> Since when does that matter?\n\nIt's just because we put the real names into the *Authors* field of the ticket, the changelogs of the spkgs and usually also into the Mercurial change sets.\n\n> If you must know:\n> http://wwwb.math.rwth-aachen.de/Mitarbeiter/baechler.php?lang=eng\n> http://www.archlinux.org/developers/#thomas\n\nYou can add your name to http://trac.sagemath.org/sage_trac/wiki#AccountNamesmappedtoRealNames\n\nIf you'd been listed there, I would perhaps have created a new spkg from your patch.\n\nReplying to [TheBlackCat](#comment%3A15):\n> Further, a fix is available, and has been for over 3 months now (shortly after openSUSE 11.3 was released). The fix was published several weeks before sage 4.5.2 was released, over a month and a half before 4.5.3.\n\nUnfortunately, the ticket hadn't been set to \"needs review\", there are apparently only a few Sage *developers* dealing with OpenSuSE, and there hasn't been activity on the ticket for a while.",
    "created_at": "2010-10-24T19:51:41Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84358",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:16'></a>
Replying to [baechler](#comment%3A14):
> Replying to [@nexttime](#comment%3A12):
> > ... and also a patched new spkg. I do not even know the name of the author, baechler.

> 
> Since when does that matter?

It's just because we put the real names into the *Authors* field of the ticket, the changelogs of the spkgs and usually also into the Mercurial change sets.

> If you must know:
> http://wwwb.math.rwth-aachen.de/Mitarbeiter/baechler.php?lang=eng
> http://www.archlinux.org/developers/#thomas

You can add your name to http://trac.sagemath.org/sage_trac/wiki#AccountNamesmappedtoRealNames

If you'd been listed there, I would perhaps have created a new spkg from your patch.

Replying to [TheBlackCat](#comment%3A15):
> Further, a fix is available, and has been for over 3 months now (shortly after openSUSE 11.3 was released). The fix was published several weeks before sage 4.5.2 was released, over a month and a half before 4.5.3.

Unfortunately, the ticket hadn't been set to "needs review", there are apparently only a few Sage *developers* dealing with OpenSuSE, and there hasn't been activity on the ticket for a while.



---

archive/issue_comments_084359.json:
```json
{
    "body": "<a id='comment:17'></a>\nReplying to [baechler](#comment%3A14):\n> Replying to [drkirkby](#comment%3A13):\n> > However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version.\n\n> \n> You don't understand the problem at all. Sage overrides the system libreadline with an older version, one that lacks features that the system shell requires. This is a problem that affects EVERY Linux distribution that is not terribly outdated (if I would say \"it doesn't build on Ubuntu\", you would probably suddenly take this seriously, but as long as it works on Ubuntu, it can't be not broken, right? It's not Ubuntu, so I have to keep repeating myself, until the problem eventually also affects Ubuntu)\n\nI suggest you do some homework on what operating systems I use, then you might draw a different conclusion about me and Ubunta. \n\nDave \n\nDave",
    "created_at": "2010-10-24T22:08:20Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84359",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:17'></a>
Replying to [baechler](#comment%3A14):
> Replying to [drkirkby](#comment%3A13):
> > However, in my opinion we should not hold a release of Sage just because on Linux distro has bought at yet another backwards incompatible version.

> 
> You don't understand the problem at all. Sage overrides the system libreadline with an older version, one that lacks features that the system shell requires. This is a problem that affects EVERY Linux distribution that is not terribly outdated (if I would say "it doesn't build on Ubuntu", you would probably suddenly take this seriously, but as long as it works on Ubuntu, it can't be not broken, right? It's not Ubuntu, so I have to keep repeating myself, until the problem eventually also affects Ubuntu)

I suggest you do some homework on what operating systems I use, then you might draw a different conclusion about me and Ubunta. 

Dave 

Dave



---

archive/issue_comments_084360.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [@nexttime](#comment%3A16):\n> Replying to [TheBlackCat](#comment%3A15):\n> > Further, a fix is available, and has been for over 3 months now (shortly after openSUSE 11.3 was released). The fix was published several weeks before sage 4.5.2 was released, over a month and a half before 4.5.3.\n\n> Unfortunately, the ticket hadn't been set to \"needs review\", there are apparently only a few Sage *developers* dealing with OpenSuSE, \n\nThat indicates that something is wrong with the patch handling process.  It is one thing if developers do not fix a problem because they cannot reproduce it.  But the patch was available and just sat here.  Further, it is a patch for a \"major\" issue.  Shouldn't such patches receive particular attention from developers?\n\n> and there hasn't been activity on the ticket for a while.\n\nYes, that is exactly the problem.  Why did did it take this long for such a simple patch for a major issue to receive any attention?  If I hadn't posted the comment, how long would it have taken for developers to act on it?",
    "created_at": "2010-10-25T00:10:16Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84360",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:18'></a>
Replying to [@nexttime](#comment%3A16):
> Replying to [TheBlackCat](#comment%3A15):
> > Further, a fix is available, and has been for over 3 months now (shortly after openSUSE 11.3 was released). The fix was published several weeks before sage 4.5.2 was released, over a month and a half before 4.5.3.

> Unfortunately, the ticket hadn't been set to "needs review", there are apparently only a few Sage *developers* dealing with OpenSuSE, 

That indicates that something is wrong with the patch handling process.  It is one thing if developers do not fix a problem because they cannot reproduce it.  But the patch was available and just sat here.  Further, it is a patch for a "major" issue.  Shouldn't such patches receive particular attention from developers?

> and there hasn't been activity on the ticket for a while.

Yes, that is exactly the problem.  Why did did it take this long for such a simple patch for a major issue to receive any attention?  If I hadn't posted the comment, how long would it have taken for developers to act on it?



---

archive/issue_comments_084361.json:
```json
{
    "body": "<a id='comment:19'></a>\nReplying to [TheBlackCat](#comment%3A18):\n> Replying to [@nexttime](#comment%3A16):\n> > Unfortunately, the ticket hadn't been set to \"needs review\", there are apparently only a few Sage *developers* dealing with OpenSuSE, \n\n> \n> That indicates that something is wrong with the patch handling process.\n\nIf somebody provides a patch, the status should be changed from \"new\" to \"needs review\" (by the author / the one that uploaded a patch).\n\n> It is one thing if developers do not fix a problem because they cannot reproduce it.  But the patch was available and just sat here.  Further, it is a patch for a \"major\" issue.\n\n\"major\" is the default priority. It should perhaps have been at least critical. Also, the title doesn't suggest higher importance (it's \"improve...\", which doesn't sound like fixing a major bug).\n\n> Shouldn't such patches receive particular attention from developers?\n\nIt's more likely that people search for tickets e.g. needing review, or \"new\" ones that are marked \"crtitical\" or \"blocker\".\n\n> > and there hasn't been activity on the ticket for a while.\n\n> \n> Yes, that is exactly the problem.  Why did did it take this long for such a simple patch for a major issue to receive any attention?  If I hadn't posted the comment, how long would it have taken for developers to act on it?\n\nSee above. Posting just \"ping\" on the ticket also causes attention by those people involved (owner, reporter, cc'ed people and everyone who commented on a ticket, at least if they have e-mail notification enabled, which should be the case for most, if not all).\n\nAlso, I haven't seen recent build [failure] reports regarding OpenSuSE and that issue on sage-release, which is another way to bring back attention.\n\nFlorent's post on sage-release (and incidentally? Dave's activity on #9530) brought me back to this.",
    "created_at": "2010-10-25T00:35:42Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84361",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:19'></a>
Replying to [TheBlackCat](#comment%3A18):
> Replying to [@nexttime](#comment%3A16):
> > Unfortunately, the ticket hadn't been set to "needs review", there are apparently only a few Sage *developers* dealing with OpenSuSE, 

> 
> That indicates that something is wrong with the patch handling process.

If somebody provides a patch, the status should be changed from "new" to "needs review" (by the author / the one that uploaded a patch).

> It is one thing if developers do not fix a problem because they cannot reproduce it.  But the patch was available and just sat here.  Further, it is a patch for a "major" issue.

"major" is the default priority. It should perhaps have been at least critical. Also, the title doesn't suggest higher importance (it's "improve...", which doesn't sound like fixing a major bug).

> Shouldn't such patches receive particular attention from developers?

It's more likely that people search for tickets e.g. needing review, or "new" ones that are marked "crtitical" or "blocker".

> > and there hasn't been activity on the ticket for a while.

> 
> Yes, that is exactly the problem.  Why did did it take this long for such a simple patch for a major issue to receive any attention?  If I hadn't posted the comment, how long would it have taken for developers to act on it?

See above. Posting just "ping" on the ticket also causes attention by those people involved (owner, reporter, cc'ed people and everyone who commented on a ticket, at least if they have e-mail notification enabled, which should be the case for most, if not all).

Also, I haven't seen recent build [failure] reports regarding OpenSuSE and that issue on sage-release, which is another way to bring back attention.

Florent's post on sage-release (and incidentally? Dave's activity on #9530) brought me back to this.



---

archive/issue_comments_084362.json:
```json
{
    "body": "<a id='comment:20'></a>\ns/#9530/#9523/",
    "created_at": "2010-10-25T00:40:21Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84362",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:20'></a>
s/#9530/#9523/



---

archive/issue_events_070389.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-10-25T00:42:36Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "rename": {
        "from": "Improve/fix readline workarounds for Arch Linux and openSuSE",
        "to": "Improve/fix readline workarounds for Arch Linux and openSuSE, again broken on OpenSuSE 11.2 and 11.3"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70389"
}
```



---

archive/issue_events_070390.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-10-25T00:42:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70390"
}
```



---

archive/issue_comments_084363.json:
```json
{
    "body": "**Work Issues:** Provide a readline-6.0.p3 spkg with the patch applied",
    "created_at": "2010-10-25T01:01:01Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84363",
    "user": "https://github.com/nexttime"
}
```

**Work Issues:** Provide a readline-6.0.p3 spkg with the patch applied



---

archive/issue_comments_084364.json:
```json
{
    "body": "<a id='comment:23'></a>\nWould a `readline-6.0.p3.spkg` with the attached patch definitely fix the broken builds on Arch Linux and/or openSUSE, at least in the short term?  I'm willing to merge this into 4.6.",
    "created_at": "2010-10-25T02:00:17Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84364",
    "user": "https://github.com/qed777"
}
```

<a id='comment:23'></a>
Would a `readline-6.0.p3.spkg` with the attached patch definitely fix the broken builds on Arch Linux and/or openSUSE, at least in the short term?  I'm willing to merge this into 4.6.



---

archive/issue_comments_084365.json:
```json
{
    "body": "**Changing work issues** from \"Provide a readline-6.0.p3 spkg with the patch applied\" to \"\".",
    "created_at": "2010-10-25T02:20:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84365",
    "user": "https://github.com/qed777"
}
```

**Changing work issues** from "Provide a readline-6.0.p3 spkg with the patch applied" to "".



---

archive/issue_comments_084366.json:
```json
{
    "body": "**Author:** Thomas B\u00e4chler",
    "created_at": "2010-10-25T02:20:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84366",
    "user": "https://github.com/qed777"
}
```

**Author:** Thomas Bächler



---

archive/issue_comments_084367.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -5,3 +5,8 @@\n The workaround on Arch Linux is unreliable, as it detects Arch Linux by \"-ARCH\" in the kernel version (which is the default, but might be different). Instead, the presence of /etc/arch-release should be used to determine that.\n \n I am attaching a patch that fixes those problems and changes 'cp' to 'cp -a' to not turn a symlink into a file. Without this patch, sage fails to build on my SuSE or Arch systems.\n+\n+New spkg:\n+\n+ http://sage.math.washington.edu/home/mpatel/trac/9530/readline-6.0.p3.spkg\n+\n``````\n",
    "created_at": "2010-10-25T02:20:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84367",
    "user": "https://github.com/qed777"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -5,3 +5,8 @@
 The workaround on Arch Linux is unreliable, as it detects Arch Linux by "-ARCH" in the kernel version (which is the default, but might be different). Instead, the presence of /etc/arch-release should be used to determine that.
 
 I am attaching a patch that fixes those problems and changes 'cp' to 'cp -a' to not turn a symlink into a file. Without this patch, sage fails to build on my SuSE or Arch systems.
+
+New spkg:
+
+ http://sage.math.washington.edu/home/mpatel/trac/9530/readline-6.0.p3.spkg
+
``````




---

archive/issue_comments_084368.json:
```json
{
    "body": "<a id='comment:24'></a>\nSee the description for a link to a p3 spkg with Thomas' patch.  I'll attach a Mercurial spkg patch shortly.  Note: I have not tested the new package.  Please do this!",
    "created_at": "2010-10-25T02:20:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84368",
    "user": "https://github.com/qed777"
}
```

<a id='comment:24'></a>
See the description for a link to a p3 spkg with Thomas' patch.  I'll attach a Mercurial spkg patch shortly.  Note: I have not tested the new package.  Please do this!



---

archive/issue_comments_084369.json:
```json
{
    "body": "SPKG Mercurial patch of changes from p2 to p3",
    "created_at": "2010-10-25T02:22:51Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84369",
    "user": "https://github.com/qed777"
}
```

SPKG Mercurial patch of changes from p2 to p3



---

archive/attachments_012629.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9530-spkg_update_openSUSE_Arch_workarounds.patch",
    "asset_url": "tarball://root/attachments/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.patch",
    "created_at": "2010-10-25T02:41:30Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```



---

archive/issue_comments_084370.json:
```json
{
    "body": "<a id='comment:25'></a>\n**Attachment:** [trac_9530-spkg_update_openSUSE_Arch_workarounds.patch](https://github.com/sagemath/sage/files/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.patch)\n\nThis should work at least through openSUSE 11.4.  The earliest it could be broken is an openSUSE release labeled 12.0.  That will not happen until at least 8 months after the release of 11.4, which is in March, so at least a year total.",
    "created_at": "2010-10-25T02:41:30Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84370",
    "user": "https://trac.sagemath.org/admin/accounts/users/TheBlackCat"
}
```

<a id='comment:25'></a>
**Attachment:** [trac_9530-spkg_update_openSUSE_Arch_workarounds.patch](https://github.com/sagemath/sage/files/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.patch)

This should work at least through openSUSE 11.4.  The earliest it could be broken is an openSUSE release labeled 12.0.  That will not happen until at least 8 months after the release of 11.4, which is in March, so at least a year total.



---

archive/issue_comments_084371.json:
```json
{
    "body": "<a id='comment:26'></a>\nWell, the current patch(es) will only work if a *development* version of readline is already installed.\n\nIs it installed by default on these systems? (To me that's rather unlikely.)\n\nIf not, on Arch the build will fail *later* because of that (with a compilation or perhaps `configure` error), while on OpenSuSE, we then build Sage's one which IMHO causes the same problem we had previously: bash will crash if it requires a newer 6.0 than we ship.",
    "created_at": "2010-10-25T05:58:58Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84371",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:26'></a>
Well, the current patch(es) will only work if a *development* version of readline is already installed.

Is it installed by default on these systems? (To me that's rather unlikely.)

If not, on Arch the build will fail *later* because of that (with a compilation or perhaps `configure` error), while on OpenSuSE, we then build Sage's one which IMHO causes the same problem we had previously: bash will crash if it requires a newer 6.0 than we ship.



---

archive/issue_comments_084372.json:
```json
{
    "body": "<a id='comment:27'></a>\nP.S.: Anyway, probably better than what we currently have in Sage (the p2).",
    "created_at": "2010-10-25T06:01:41Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84372",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:27'></a>
P.S.: Anyway, probably better than what we currently have in Sage (the p2).



---

archive/issue_comments_084373.json:
```json
{
    "body": "<a id='comment:28'></a>\nI  believe the `cp -a` will only be executed on Linux, so it's not a massive problem here, but note that is note that `-a` is not an option defined by POSIX, so is unportable and will break on some systems. Was there a good reason for using `-a`? Unless there was, it would be good to get into the habbit of using a more portable alternative - I suspect `-p` would have done the job here. \n\nAs always, one can get an alphabetical list of the commands at:\n\nhttp://opengroup.org/onlinepubs/007908799/idx/index.html\n\nand in particular for 'cp':\n\nhttp://opengroup.org/onlinepubs/007908799/xcu/cp.html\n\nNote the **only** portable options are `-f`, `-i`, `-p` , `-r` and `-R`. \n\n\nDave",
    "created_at": "2010-10-25T07:06:02Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84373",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:28'></a>
I  believe the `cp -a` will only be executed on Linux, so it's not a massive problem here, but note that is note that `-a` is not an option defined by POSIX, so is unportable and will break on some systems. Was there a good reason for using `-a`? Unless there was, it would be good to get into the habbit of using a more portable alternative - I suspect `-p` would have done the job here. 

As always, one can get an alphabetical list of the commands at:

http://opengroup.org/onlinepubs/007908799/idx/index.html

and in particular for 'cp':

http://opengroup.org/onlinepubs/007908799/xcu/cp.html

Note the **only** portable options are `-f`, `-i`, `-p` , `-r` and `-R`. 


Dave



---

archive/issue_comments_084374.json:
```json
{
    "body": "<a id='comment:29'></a>\ndrkirkby, cp -a is a rough equivalent to cp -dpR - as -d is (according to your post) not portable, this might be problematic, as -d copies symlinks as symlinks, instead of copying the underlying file (this is what I intended there).\n\nTwo more comments:\n1) On Arch, the development headers for libreadline are always installed. On openSuSE not by default.\n2) I am thinking to extend this test further: Instead of testing for a particular distribution, test whether libreadline.so.6 is installed and the development headers are present - and in those cases, never build libreadline. This way, only systems lacking libreadline or providing the old libreadline.so.5 would have to build libreadline, all others would use the system's library.",
    "created_at": "2010-10-25T09:16:23Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84374",
    "user": "https://trac.sagemath.org/admin/accounts/users/baechler"
}
```

<a id='comment:29'></a>
drkirkby, cp -a is a rough equivalent to cp -dpR - as -d is (according to your post) not portable, this might be problematic, as -d copies symlinks as symlinks, instead of copying the underlying file (this is what I intended there).

Two more comments:
1) On Arch, the development headers for libreadline are always installed. On openSuSE not by default.
2) I am thinking to extend this test further: Instead of testing for a particular distribution, test whether libreadline.so.6 is installed and the development headers are present - and in those cases, never build libreadline. This way, only systems lacking libreadline or providing the old libreadline.so.5 would have to build libreadline, all others would use the system's library.



---

archive/issue_comments_084375.json:
```json
{
    "body": "<a id='comment:30'></a>\nReplying to [baechler](#comment%3A29):\n> drkirkby, cp -a is a rough equivalent to cp -dpR - as -d is (according to your post) not portable, this might be problematic, as -d copies symlinks as symlinks, instead of copying the underlying file (this is what I intended there).\n\nTwo other options are to use `tar` or `pax`. Since I assume you are more familiar with `tar`, that might be your preference. You could use a temporary file, or you copy stdout of one tar command to stdin of another using a pipe. \n\nA third option might be to use `mv` instead of `cp`. \n\n> Two more comments:\n> 1) On Arch, the development headers for libreadline are always installed. On openSuSE not by default.\n\nLinux is a moving target - that can change at any time. \n\n> 2) I am thinking to extend this test further: Instead of testing for a particular distribution, test whether libreadline.so.6 is installed and the development headers are present - and in those cases, never build libreadline. This way, only systems lacking libreadline or providing the old libreadline.so.5 would have to build libreadline, all others would use the system's library.\n\nIn general I am not over keen on Sages system of installing everything. However, if you do this on every platform not just Linux, have you thought about how you would do this on Solaris and OpenSolaris, for 64-bit builds, where the libraries would not reside in `/usr/lib`, but in a subdirectory which depends on the type of CPU? How about if only static libraries are installed? \n\nHave you thought about it when someone has an older version of readline in `/usr/local`, but a later one in `/usr/local/lib`, or some other random directory? \n\nBasically I'm saying I don't think this is quite as easy as you might be thinking it is. To make a change on every system, where there are only one or two Linux distributions having this problem, is probably unwise. \n\nDave",
    "created_at": "2010-10-25T13:17:58Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84375",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:30'></a>
Replying to [baechler](#comment%3A29):
> drkirkby, cp -a is a rough equivalent to cp -dpR - as -d is (according to your post) not portable, this might be problematic, as -d copies symlinks as symlinks, instead of copying the underlying file (this is what I intended there).

Two other options are to use `tar` or `pax`. Since I assume you are more familiar with `tar`, that might be your preference. You could use a temporary file, or you copy stdout of one tar command to stdin of another using a pipe. 

A third option might be to use `mv` instead of `cp`. 

> Two more comments:
> 1) On Arch, the development headers for libreadline are always installed. On openSuSE not by default.

Linux is a moving target - that can change at any time. 

> 2) I am thinking to extend this test further: Instead of testing for a particular distribution, test whether libreadline.so.6 is installed and the development headers are present - and in those cases, never build libreadline. This way, only systems lacking libreadline or providing the old libreadline.so.5 would have to build libreadline, all others would use the system's library.

In general I am not over keen on Sages system of installing everything. However, if you do this on every platform not just Linux, have you thought about how you would do this on Solaris and OpenSolaris, for 64-bit builds, where the libraries would not reside in `/usr/lib`, but in a subdirectory which depends on the type of CPU? How about if only static libraries are installed? 

Have you thought about it when someone has an older version of readline in `/usr/local`, but a later one in `/usr/local/lib`, or some other random directory? 

Basically I'm saying I don't think this is quite as easy as you might be thinking it is. To make a change on every system, where there are only one or two Linux distributions having this problem, is probably unwise. 

Dave



---

archive/issue_comments_084376.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [baechler](#comment%3A29):\n> 2) I am thinking to extend this test further: Instead of testing for a particular distribution, test whether libreadline.so.6 is installed and the development headers are present - and in those cases, never build libreadline. This way, only systems lacking libreadline or providing the old libreadline.so.5 would have to build libreadline, all others would use the system's library.\n\nSounds reasonable, but we'd have to take care of that when building binary distributions (`./sage -bdist`), too, since the build system might have a (suitable) system libreadline, but we cannot assume every target system (where a bdist gets installed) to also have it.\n\nIn general, I'd like to not (ship and) build Sage-specific versions of basic tools and libraries like readline (at least by default), but that's a long-lasting discussion and there are different reasons to do so for each individual package.\n\nThe situation with readline and bash is even more specific, since it's IMHO a bad idea to dynamically link the system shell against it, which is only the case on OpenSuSE and Arch. But it's also the readline developers' fault, because they changed the library's interface without bumping the version number.",
    "created_at": "2010-10-25T16:04:15Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84376",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:31'></a>
Replying to [baechler](#comment%3A29):
> 2) I am thinking to extend this test further: Instead of testing for a particular distribution, test whether libreadline.so.6 is installed and the development headers are present - and in those cases, never build libreadline. This way, only systems lacking libreadline or providing the old libreadline.so.5 would have to build libreadline, all others would use the system's library.

Sounds reasonable, but we'd have to take care of that when building binary distributions (`./sage -bdist`), too, since the build system might have a (suitable) system libreadline, but we cannot assume every target system (where a bdist gets installed) to also have it.

In general, I'd like to not (ship and) build Sage-specific versions of basic tools and libraries like readline (at least by default), but that's a long-lasting discussion and there are different reasons to do so for each individual package.

The situation with readline and bash is even more specific, since it's IMHO a bad idea to dynamically link the system shell against it, which is only the case on OpenSuSE and Arch. But it's also the readline developers' fault, because they changed the library's interface without bumping the version number.



---

archive/issue_comments_084377.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [@nexttime](#comment%3A31):\n> The situation with readline and bash is even more specific, since it's IMHO a bad idea to dynamically link the system shell against it, which is only the case on OpenSuSE and Arch.\n\nLinking the shell dynamically, as far as I know, has been readline's default for a long time - other distributions just still use libreadline.so.5 for this.\n\n> But it's also the readline developers' fault, because they changed the library's interface without bumping the version number.\n\nYou are wrong, this is standard and expected behaviour, at least in the GNU ld world. Increasing the library SONAME version is only required when a binary compiled against an older library version will fail to work with a newer version.\n\nIn this case, a binary (bash) compiled against a newer library version does not work with an older library version. This is normal and will be the case with all system libraries, even the C library in some cases. The reason is simple: Nobody ever downgrades system libraries.",
    "created_at": "2010-10-25T16:17:15Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84377",
    "user": "https://trac.sagemath.org/admin/accounts/users/baechler"
}
```

<a id='comment:32'></a>
Replying to [@nexttime](#comment%3A31):
> The situation with readline and bash is even more specific, since it's IMHO a bad idea to dynamically link the system shell against it, which is only the case on OpenSuSE and Arch.

Linking the shell dynamically, as far as I know, has been readline's default for a long time - other distributions just still use libreadline.so.5 for this.

> But it's also the readline developers' fault, because they changed the library's interface without bumping the version number.

You are wrong, this is standard and expected behaviour, at least in the GNU ld world. Increasing the library SONAME version is only required when a binary compiled against an older library version will fail to work with a newer version.

In this case, a binary (bash) compiled against a newer library version does not work with an older library version. This is normal and will be the case with all system libraries, even the C library in some cases. The reason is simple: Nobody ever downgrades system libraries.



---

archive/issue_comments_084378.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [baechler](#comment%3A32):\n> Replying to [@nexttime](#comment%3A31):\n> > The situation with readline and bash is even more specific, since it's IMHO a bad idea to dynamically link the system shell against it, which is only the case on OpenSuSE and Arch.\n\n> \n> Linking the shell dynamically, as far as I know, has been readline's default for a long time - other distributions just still use libreadline.so.5 for this.\n\nNo, at least some *statically* link bash against readline, which is much safer.\n\n> > But it's also the readline developers' fault, because they changed the library's interface without bumping the version number.\n\n> \n> You are wrong, this is standard and expected behaviour, at least in the GNU ld world. Increasing the library SONAME version is only required when a binary compiled against an older library version will fail to work with a newer version.\n\nIn principle, the opposite (a binary requiring some newer version) is the more common use case.\n\n> In this case, a binary (bash) compiled against a newer library version does not work with an older library version. This is normal and will be the case with all system libraries, even the C library in some cases.\n\nYes, and *that* should be catched as well, see above. Therefore one keeps older library versions installed, with a different \"name\". But here, both are \"6.0\", or worse, the soname recorded as required by bash simply contains the major number, \"6\".\n \n> The reason is simple: Nobody ever downgrades system libraries.\n\nThis will frequently happen when people install dynamically linked executables (or even libraries) built on newer systems; usually a packet manager will take care of also installing the needed libraries, but not all programs come as packages. into which more specific dependencies are coded.",
    "created_at": "2010-10-25T16:56:48Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84378",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:33'></a>
Replying to [baechler](#comment%3A32):
> Replying to [@nexttime](#comment%3A31):
> > The situation with readline and bash is even more specific, since it's IMHO a bad idea to dynamically link the system shell against it, which is only the case on OpenSuSE and Arch.

> 
> Linking the shell dynamically, as far as I know, has been readline's default for a long time - other distributions just still use libreadline.so.5 for this.

No, at least some *statically* link bash against readline, which is much safer.

> > But it's also the readline developers' fault, because they changed the library's interface without bumping the version number.

> 
> You are wrong, this is standard and expected behaviour, at least in the GNU ld world. Increasing the library SONAME version is only required when a binary compiled against an older library version will fail to work with a newer version.

In principle, the opposite (a binary requiring some newer version) is the more common use case.

> In this case, a binary (bash) compiled against a newer library version does not work with an older library version. This is normal and will be the case with all system libraries, even the C library in some cases.

Yes, and *that* should be catched as well, see above. Therefore one keeps older library versions installed, with a different "name". But here, both are "6.0", or worse, the soname recorded as required by bash simply contains the major number, "6".
 
> The reason is simple: Nobody ever downgrades system libraries.

This will frequently happen when people install dynamically linked executables (or even libraries) built on newer systems; usually a packet manager will take care of also installing the needed libraries, but not all programs come as packages. into which more specific dependencies are coded.



---

archive/issue_comments_084379.json:
```json
{
    "body": "<a id='comment:34'></a>\nReplying to [drkirkby](#comment%3A28):\n> I  believe the `cp -a` will only be executed on Linux, so it's not a massive problem here, but note that is note that `-a` is not an option defined by POSIX, so is unportable and will break on some systems. Was there a good reason for using `-a`? Unless there was, it would be good to get into the habbit of using a more portable alternative\n\n<code>[ \\`uname -p\\` = \"x86_64\" ]</code> isn't portable either, this might give \"unknown\" even on Linux; `uname -m` should be better.\n\nAlso, I think `ln -s ...` should be `ln -snf ...` (or at least `ln -sf ...`).",
    "created_at": "2010-10-25T21:22:11Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84379",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:34'></a>
Replying to [drkirkby](#comment%3A28):
> I  believe the `cp -a` will only be executed on Linux, so it's not a massive problem here, but note that is note that `-a` is not an option defined by POSIX, so is unportable and will break on some systems. Was there a good reason for using `-a`? Unless there was, it would be good to get into the habbit of using a more portable alternative

<code>[ \`uname -p\` = "x86_64" ]</code> isn't portable either, this might give "unknown" even on Linux; `uname -m` should be better.

Also, I think `ln -s ...` should be `ln -snf ...` (or at least `ln -sf ...`).



---

archive/issue_comments_084380.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [@nexttime](#comment%3A34):\n> Also, I think `ln -s ...` should be `ln -snf ...` (or at least `ln -sf ...`).\n\nOk, *currently* the libs are deleted prior to [re]installation, so the `-f` is superfluous, but doesn't hurt either, since we want the link to be created in any case.",
    "created_at": "2010-10-25T21:28:11Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84380",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:35'></a>
Replying to [@nexttime](#comment%3A34):
> Also, I think `ln -s ...` should be `ln -snf ...` (or at least `ln -sf ...`).

Ok, *currently* the libs are deleted prior to [re]installation, so the `-f` is superfluous, but doesn't hurt either, since we want the link to be created in any case.



---

archive/issue_comments_084381.json:
```json
{
    "body": "<a id='comment:36'></a>\nCan someone (Thomas?) please update a patch or the spkg with the suggested improvements?\n\nThe main remaining potential blockers to releasing 4.6 are this ticket and the other problem Florent Hivert reported on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/bb636656e2153332) (cf. [comment:ticket:10097:16 comment 16ff] at #10097).\n\nI'll investigate the latter later today.",
    "created_at": "2010-10-27T08:30:46Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84381",
    "user": "https://github.com/qed777"
}
```

<a id='comment:36'></a>
Can someone (Thomas?) please update a patch or the spkg with the suggested improvements?

The main remaining potential blockers to releasing 4.6 are this ticket and the other problem Florent Hivert reported on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/bb636656e2153332) (cf. [comment:ticket:10097:16 comment 16ff] at #10097).

I'll investigate the latter later today.



---

archive/issue_comments_084382.json:
```json
{
    "body": "<a id='comment:37'></a>\nReplying to [@qed777](#comment%3A36):\n> The main remaining potential blockers to releasing 4.6 are this ticket and the other problem Florent Hivert reported on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/bb636656e2153332) (cf. [comment:ticket:10097:16 comment 16ff] at #10097).\n> \n> I'll investigate the latter later today.\n\nThat's now #10176, currently needing review. There's a new SageNB spkg to get around strange behavoir on **some** OpenSuSE (11.1 and 11.3, both x86_64) installations (i.e., the problem did not arise on an OpenSuSE 11.1 x86_64 machine on Skynet, unless the buildbot cheated).",
    "created_at": "2010-10-28T01:07:34Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84382",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:37'></a>
Replying to [@qed777](#comment%3A36):
> The main remaining potential blockers to releasing 4.6 are this ticket and the other problem Florent Hivert reported on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/bb636656e2153332) (cf. [comment:ticket:10097:16 comment 16ff] at #10097).
> 
> I'll investigate the latter later today.

That's now #10176, currently needing review. There's a new SageNB spkg to get around strange behavoir on **some** OpenSuSE (11.1 and 11.3, both x86_64) installations (i.e., the problem did not arise on an OpenSuSE 11.1 x86_64 machine on Skynet, unless the buildbot cheated).



---

archive/issue_comments_084383.json:
```json
{
    "body": "Use `uname -m` and `ln -snf` but leave `cp -a`.  Updated SPKG patch.  Replaces previous.",
    "created_at": "2010-10-28T02:17:49Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84383",
    "user": "https://github.com/qed777"
}
```

Use `uname -m` and `ln -snf` but leave `cp -a`.  Updated SPKG patch.  Replaces previous.



---

archive/attachments_012630.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9530-spkg_update_openSUSE_Arch_workarounds.2.patch",
    "asset_url": "tarball://root/attachments/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.2.patch",
    "created_at": "2010-10-28T02:28:56Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.2.patch",
    "user": "https://github.com/qed777"
}
```



---

archive/issue_comments_084384.json:
```json
{
    "body": "<a id='comment:38'></a>\n**Attachment:** [trac_9530-spkg_update_openSUSE_Arch_workarounds.2.patch](https://github.com/sagemath/sage/files/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.2.patch)\n\nI've updated the patch to use `uname -m` and `ln -snf`.  I've left `cp -a` in it, since the enclosing block is Linux-specific.\n\nThe new spkg is at the same link in the description.  Florent and Thomas, could you please tell us if it works for you?\n\nAlso, Thomas, could you add yourself to the [account name-real name map](http://trac.sagemath.org/sage_trac/wiki/WikiStart#AccountNamesmappedtoRealNames)?",
    "created_at": "2010-10-28T02:28:56Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84384",
    "user": "https://github.com/qed777"
}
```

<a id='comment:38'></a>
**Attachment:** [trac_9530-spkg_update_openSUSE_Arch_workarounds.2.patch](https://github.com/sagemath/sage/files/ticket9530/trac_9530-spkg_update_openSUSE_Arch_workarounds.2.patch)

I've updated the patch to use `uname -m` and `ln -snf`.  I've left `cp -a` in it, since the enclosing block is Linux-specific.

The new spkg is at the same link in the description.  Florent and Thomas, could you please tell us if it works for you?

Also, Thomas, could you add yourself to the [account name-real name map](http://trac.sagemath.org/sage_trac/wiki/WikiStart#AccountNamesmappedtoRealNames)?



---

archive/issue_comments_084385.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [@qed777](#comment%3A38):\n> I've updated the patch to use `uname -m` and `ln -snf`.  I've left `cp -a` in it, since the enclosing block is Linux-specific.\n\nArgh, I've just created a .p4 with some \"reviewer patch\"... :/\n\n(But Firefox crashed, my fault.)",
    "created_at": "2010-10-28T03:02:13Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84385",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:39'></a>
Replying to [@qed777](#comment%3A38):
> I've updated the patch to use `uname -m` and `ln -snf`.  I've left `cp -a` in it, since the enclosing block is Linux-specific.

Argh, I've just created a .p4 with some "reviewer patch"... :/

(But Firefox crashed, my fault.)



---

archive/issue_comments_084386.json:
```json
{
    "body": "SPKG reviewer patch, based on the **previous** p3. (The new, perhaps now alternate spkg is p4.) See commit message for an overview of the changes.",
    "created_at": "2010-10-28T03:37:51Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84386",
    "user": "https://github.com/nexttime"
}
```

SPKG reviewer patch, based on the **previous** p3. (The new, perhaps now alternate spkg is p4.) See commit message for an overview of the changes.



---

archive/issue_events_070391.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/drkirkby",
    "created_at": "2010-10-28T03:45:53Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "rename": {
        "from": "Improve/fix readline workarounds for Arch Linux and openSuSE, again broken on OpenSuSE 11.2 and 11.3",
        "to": "Improve/fix readline workarounds for Arch Linux and openSUSE, again broken on OpenSuSE 11.2 and 11.3"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70391"
}
```



---

archive/attachments_012631.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9530-old_p3_vs_p4_reviewer.patch",
    "asset_url": "tarball://root/attachments/ticket9530/trac_9530-old_p3_vs_p4_reviewer.patch",
    "created_at": "2010-10-28T03:45:53Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "attachment",
    "url": "https://github.com/sagemath/sage/files/ticket9530/trac_9530-old_p3_vs_p4_reviewer.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```



---

archive/issue_comments_084387.json:
```json
{
    "body": "<a id='comment:40'></a>\n**Attachment:** [trac_9530-old_p3_vs_p4_reviewer.patch](https://github.com/sagemath/sage/files/ticket9530/trac_9530-old_p3_vs_p4_reviewer.patch)\n\nReplying to [@qed777](#comment%3A38):\n> I've updated the patch to use `uname -m` and `ln -snf`.  I've left `cp -a` in it, since the enclosing block is Linux-specific.\n\nNote also that the '`n`' option to '`ln`' is not portable either. \n\nhttp://www.opengroup.org/onlinepubs/009695399/utilities/ln.html\n\nI'd be very weary of using non-portable options, even on Linux, as there have been reports of some of the cut-down linux distributions failing to recognise some of the unportable options. See for example #8566, where the '`m`' option to  '`tar`' is failing on a minimal linux distribution. I should remove that option, as it is totally unnecessary in the bit of code that uses it. \n\nI would at least comment any such non-portable code. \n\n> The new spkg is at the same link in the description.  Florent and Thomas, could you please tell us if it works for you?\n> \n> Also, Thomas, could you add yourself to the [account name-real name map](http://trac.sagemath.org/sage_trac/wiki/WikiStart#AccountNamesmappedtoRealNames)?\n\nI've installed openSUSE 11.3, but hit a problem in that g++ is called g++-4.5. Since I know setting CXX is unreliable in Sage, I need to mess around creating links to call it g++. I wish Sage would respect values for CC and CXX. Currently setting those will work for some packages, but not all of them. \n\nDave",
    "created_at": "2010-10-28T03:45:53Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84387",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:40'></a>
**Attachment:** [trac_9530-old_p3_vs_p4_reviewer.patch](https://github.com/sagemath/sage/files/ticket9530/trac_9530-old_p3_vs_p4_reviewer.patch)

Replying to [@qed777](#comment%3A38):
> I've updated the patch to use `uname -m` and `ln -snf`.  I've left `cp -a` in it, since the enclosing block is Linux-specific.

Note also that the '`n`' option to '`ln`' is not portable either. 

http://www.opengroup.org/onlinepubs/009695399/utilities/ln.html

I'd be very weary of using non-portable options, even on Linux, as there have been reports of some of the cut-down linux distributions failing to recognise some of the unportable options. See for example #8566, where the '`m`' option to  '`tar`' is failing on a minimal linux distribution. I should remove that option, as it is totally unnecessary in the bit of code that uses it. 

I would at least comment any such non-portable code. 

> The new spkg is at the same link in the description.  Florent and Thomas, could you please tell us if it works for you?
> 
> Also, Thomas, could you add yourself to the [account name-real name map](http://trac.sagemath.org/sage_trac/wiki/WikiStart#AccountNamesmappedtoRealNames)?

I've installed openSUSE 11.3, but hit a problem in that g++ is called g++-4.5. Since I know setting CXX is unreliable in Sage, I need to mess around creating links to call it g++. I wish Sage would respect values for CC and CXX. Currently setting those will work for some packages, but not all of them. 

Dave



---

archive/issue_events_070392.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/drkirkby",
    "created_at": "2010-10-28T03:46:48Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "rename": {
        "from": "Improve/fix readline workarounds for Arch Linux and openSUSE, again broken on OpenSuSE 11.2 and 11.3",
        "to": "Improve/fix readline workarounds for Arch Linux and openSUSE, again broken on OpenSUSE 11.2 and 11.3"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70392"
}
```



---

archive/issue_comments_084388.json:
```json
{
    "body": "<a id='comment:42'></a>\nI'm happy to go with Leif's patch and make a p4 with it.  Leif, do you want to remove `-n` from the `ln` commands?",
    "created_at": "2010-10-28T03:51:39Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84388",
    "user": "https://github.com/qed777"
}
```

<a id='comment:42'></a>
I'm happy to go with Leif's patch and make a p4 with it.  Leif, do you want to remove `-n` from the `ln` commands?



---

archive/issue_comments_084389.json:
```json
{
    "body": "<a id='comment:43'></a>\n**New alternate spkg: http://spkg-upload.googlecode.com/files/readline-6.0.p4.spkg**\n\n**md5sum:** `9f5a955d4d6b4240e5ba7e23e6193160  readline-6.0.p4.spkg`\n\n(Contains my reviewer patch which is based on Mitesh's **previous** p3.)\n\nFeel free to test and review this one or Mitesh's new one.",
    "created_at": "2010-10-28T03:54:53Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84389",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:43'></a>
**New alternate spkg: http://spkg-upload.googlecode.com/files/readline-6.0.p4.spkg**

**md5sum:** `9f5a955d4d6b4240e5ba7e23e6193160  readline-6.0.p4.spkg`

(Contains my reviewer patch which is based on Mitesh's **previous** p3.)

Feel free to test and review this one or Mitesh's new one.



---

archive/issue_comments_084390.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [@qed777](#comment%3A42):\n> I'm happy to go with Leif's patch and make a p4 with it.  Leif, do you want to remove `-n` from the `ln` commands?\n\nNot really. We have it all around by the way...",
    "created_at": "2010-10-28T03:55:45Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84390",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:44'></a>
Replying to [@qed777](#comment%3A42):
> I'm happy to go with Leif's patch and make a p4 with it.  Leif, do you want to remove `-n` from the `ln` commands?

Not really. We have it all around by the way...



---

archive/issue_comments_084391.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -8,5 +8,4 @@\n \n New spkg:\n \n- http://sage.math.washington.edu/home/mpatel/trac/9530/readline-6.0.p3.spkg\n-\n+ http://spkg-upload.googlecode.com/files/readline-6.0.p4.spkg\n``````\n",
    "created_at": "2010-10-28T03:57:11Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84391",
    "user": "https://github.com/qed777"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -8,5 +8,4 @@
 
 New spkg:
 
- http://sage.math.washington.edu/home/mpatel/trac/9530/readline-6.0.p3.spkg
-
+ http://spkg-upload.googlecode.com/files/readline-6.0.p4.spkg
``````




---

archive/issue_comments_084392.json:
```json
{
    "body": "**Changing author** from \"Thomas B\u00e4chler\" to \"Thomas B\u00e4chler, Leif Leonhardy\".",
    "created_at": "2010-10-28T03:57:11Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84392",
    "user": "https://github.com/qed777"
}
```

**Changing author** from "Thomas Bächler" to "Thomas Bächler, Leif Leonhardy".



---

archive/issue_comments_084393.json:
```json
{
    "body": "<a id='comment:46'></a>\nI just got this on openSUSE 11.3\n\n```\nDeleting old readline headers and libs\nOpenSuSE detected\nOpenSuSE 11 detected\nNo readline headers found. Please install OpenSuSE's development\nversion of libreadline 6.x since building the version currently\nshipped with Sage would break your shell (bash). Sorry.\n\nreal    0m0.010s\nuser    0m0.004s\nsys     0m0.001s\nsage: An error occurred while installing readline-6.0.p4\n```\n\nso I'll follow the instructions. \n\nWhy do people keep calling this openSuSE? It was in the title, and now I see it in Leif's comments. According to the openSUSE web page, it is openSUSE. \n\nDave",
    "created_at": "2010-10-28T04:04:53Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84393",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:46'></a>
I just got this on openSUSE 11.3

```
Deleting old readline headers and libs
OpenSuSE detected
OpenSuSE 11 detected
No readline headers found. Please install OpenSuSE's development
version of libreadline 6.x since building the version currently
shipped with Sage would break your shell (bash). Sorry.

real    0m0.010s
user    0m0.004s
sys     0m0.001s
sage: An error occurred while installing readline-6.0.p4
```

so I'll follow the instructions. 

Why do people keep calling this openSuSE? It was in the title, and now I see it in Leif's comments. According to the openSUSE web page, it is openSUSE. 

Dave



---

archive/issue_comments_084394.json:
```json
{
    "body": "<a id='comment:47'></a>\nFYI, \n\n```\n$ sudo zypper install readline-devel\n```\n\ninstalls the headers, and allows sqlite to build, which I think was the program that was causing problems. I'm just installing this, but like an idiot I only allocated one CPU to the virtual machine, not 8. It might be quicker to shut down and allocate more CPUs to the virtual machine. \n\nDave",
    "created_at": "2010-10-28T04:12:51Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84394",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:47'></a>
FYI, 

```
$ sudo zypper install readline-devel
```

installs the headers, and allows sqlite to build, which I think was the program that was causing problems. I'm just installing this, but like an idiot I only allocated one CPU to the virtual machine, not 8. It might be quicker to shut down and allocate more CPUs to the virtual machine. 

Dave



---

archive/issue_comments_084395.json:
```json
{
    "body": "<a id='comment:48'></a>\nUndoubtadly unrelated, but I can't get ATLAS to build, in the virtual machine:\n\n```\ngcc -DL2SIZE=4194304 -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include/contrib -DAdd_ -DF77_INTEGER=int -DStringSunStyle -DATL_OS_Linux -DATL_ARCH_Corei7 -DATL_CPUMHZ=3324 -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664  -fomit-frame-pointer -mfpmath=sse -msse3 -O2 -fno-schedule-insns2 -fPIC -m64 -DATL_BETA=1 -c dmm.c \ngcc -DL2SIZE=4194304 -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include/contrib -DAdd_ -DF77_INTEGER=int -DStringSunStyle -DATL_OS_Linux -DATL_ARCH_Corei7 -DATL_CPUMHZ=3324 -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664  -fomit-frame-pointer -mfpmath=sse -msse3 -O2 -fno-schedule-insns2 -fPIC -m64 -o xdfc dfc.o dmm.o \\\n                                    /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/sysinfo/time.o \n/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin/ATLrun.sh /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm xdfc \nNear-zero time 0.000000e+00 rejected\nNear-zero time 0.000000e+00 rejected\nNear-zero time 0.000000e+00 rejected\nNear-zero time 0.000000e+00 rejected\nNear-zero time 0.000000e+00 rejected\nToo many zero-time values, dying\nmake[7]: *** [dmmcase0] Error 255\nmake[7]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\nmake[6]: *** [mmcase] Error 2\nmake[6]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\nError in command:  make mmcase pre=d loopO=JIK ta=T tb=N M=60 N=60 K=60 mb=60 nb=60 kb=60 lda=60 ldb=60 ldc=0 lda2=60 ldb2=60 ldc2=0 mu=4 nu=2 ku=60 alpha=1 beta=1 muladd=1 lat=5 cleanup=1 ff=1 if=8 nf=1 pfA=513 \nmmnreg = 19\n\nNB's to try: 60   \n\n\npre=d, muladd=0, lat=1, pf=0, nb=35, mu=5, nu=1, ku=35, mflop=2269.50\n\npre=d, muladd=0, lat=1, pf=0, nb=35, mu=5, nu=1, ku=35, mflop=2269.50\n\npre=d, muladd=0, lat=1, pf=0, nb=36, mu=4, nu=1, ku=36, mflop=7056.25\n\npre=d, muladd=1, lat=1, pf=0, nb=36, mu=4, nu=1, ku=36, mflop=15572.92\nmake[5]: *** [RunMMDef] Error 255\nmake[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\nmake[4]: *** [IRunMMDef] Error 2\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dMMRES INSTALL_LOG/.\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dNCNB INSTALL_LOG/.\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestNN_44x44x44 INSTALL_LOG/.\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestNT_44x44x44 INSTALL_LOG/.\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestTN_44x44x44 INSTALL_LOG/.\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestTT_44x44x44 INSTALL_LOG/.\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm ; make dinstall\nmake[5]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\n./xemit_mm  -p d -R -2\npre=d, CU=0, ma=0, ff=0, if=-1, nf=-1, lo=1, ta=112, tb=111, lat=4, mu=4, nu=4, ku=1, m=0, n=0, k=0, lda=0, ldb=0, ldc=0, csA=1, csB=1, csC=1, alpha=1, beta=1\n\nline 4023 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c\nline 4025 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c\nline 4027 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c\nline 3770 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c\nline 3772 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c\nline 3774 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c\ncat: CASES/: Is a directory\nxemit_mm: /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c:3737: GenAllUNBCases: Assertion `system(ln) == 0' failed.\nmake[5]: *** [dinstall] Aborted\nmake[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\nmake[4]: *** [MMinstall] Error 2\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm ; make res/atlas_cacheedge.h pre=d\nmake[5]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\nmake dRunFindCE\nmake[6]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\ncd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm ; make dlib\nmake[7]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'\nmake auxillib dcleanuplib dusergemm\nmake[8]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'\ncd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/auxil ; make lib\nmake[9]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/auxil'\nmake[9]: Nothing to be done for `lib'.\nmake[9]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/auxil'\ncd KERNEL ; make -f dMakefile dlib\nmake[9]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm/KERNEL'\nmake[9]: dMakefile: No such file or directory\nmake[9]: *** No rule to make target `dMakefile'.  Stop.\nmake[9]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm/KERNEL'\nmake[8]: *** [dcleanuplib] Error 2\nmake[8]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'\nmake[7]: *** [dlib] Error 2\nmake[7]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'\nmake[6]: *** [dmmlib] Error 2\nmake[6]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\nmake[5]: *** [res/atlas_cacheedge.h] Error 2\nmake[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'\nmake[4]: *** [/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/atlas_cachedge.h] Error 2\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nERROR 639 DURING CACHE EDGE DETECTION!!.\nmake[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\ncd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build ; make error_report\nmake[5]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'\nmake -f Make.top error_report\nmake[6]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'\nuname -a 2>&1 >> bin/INSTALL_LOG/ERROR.LOG\ngcc -v 2>&1  >> bin/INSTALL_LOG/ERROR.LOG\nUsing built-in specs.\nCOLLECT_GCC=gcc\nCOLLECT_LTO_WRAPPER=/usr/lib64/gcc/x86_64-suse-linux/4.5/lto-wrapper\nTarget: x86_64-suse-linux\nConfigured with: ../configure --prefix=/usr --infodir=/usr/share/info --mandir=/usr/share/man --libdir=/usr/lib64 --libexecdir=/usr/lib64 --enable-languages=c,c++,objc,fortran,obj-c++,java,ada --enable-checking=release --with-gxx-include-dir=/usr/include/c++/4.5 --enable-ssp --disable-libssp --disable-plugin --with-bugurl=http://bugs.opensuse.org/ --with-pkgversion='SUSE Linux' --disable-libgcj --disable-libmudflap --with-slibdir=/lib64 --with-system-zlib --enable-__cxa_atexit --enable-libstdcxx-allocator=new --disable-libstdcxx-pch --enable-version-specific-runtime-libs --program-suffix=-4.5 --enable-linux-futex --without-system-libunwind --enable-gold --with-plugin-ld=/usr/bin/gold --with-arch-32=i586 --with-tune=generic --build=x86_64-suse-linux\nThread model: posix\ngcc version 4.5.0 20100604 [gcc-4_5-branch revision 160292] (SUSE Linux) \ngcc -V 2>&1  >> bin/INSTALL_LOG/ERROR.LOG\ngcc: '-V' option must have argument\nmake[6]: [error_report] Error 1 (ignored)\ngcc --version 2>&1  >> bin/INSTALL_LOG/ERROR.LOG\ntar cf error_Corei764SSE3.tar Make.inc bin/INSTALL_LOG/*\ngzip --best error_Corei764SSE3.tar\nmv error_Corei764SSE3.tar.gz error_Corei764SSE3.tgz\nmake[6]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'\nmake[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'\nmake[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'\nError report error_<ARCH>.tgz has been created in your top-level ATLAS\ndirectory.  Be sure to include this file in any help request.\ncat: ../../CONFIG/error.txt: No such file or directory\ncat: ../../CONFIG/error.txt: No such file or directory\n\n\nIN STAGE 1 INSTALL:  SYSTEM PROBE/AUX COMPILE\n\n\n   Level 1 cache size calculated as 32KB\n   dFPU: Separate multiply and add instructions with 5 cycle pipeline.\n         Apparent number of registers : 17\n         Register-register performance=802.87MFLOPS\n   sFPU: Separate multiply and add instructions with 4 cycle pipeline.\n         Apparent number of registers : 17\n         Register-register performance=877.97MFLOPS\n\n\nIN STAGE 2 INSTALL:  TYPE-DEPENDENT TUNING\n\n\nSTAGE 2-1: TUNING PREC='d' (precision 1 of 4)\n\n\n   STAGE 2-1-1 : BUILDING BLOCK MATMUL TUNE\nmake -f Makefile IRunMMDef pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG\nmake -f Makefile INSTALL_LOG/dMMRES pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG\n      dL1MATMUL: lat=5, nb=60, pf=513, mu=4, nu=2, ku=60, if=8, nf=1;\n                 Performance: -4730.15 (-142.30 percent of of detected clock rate)\nmake -f Makefile INSTALL_LOG/dNCNB pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOGmake -f Makefile INSTALL_LOG/dbestNN_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmNN : muladd=1, lat=8, pf=513, nb=44, mu=4, nu=2 ku=44,\n                 ForceFetch=1, ifetch=8 nfetch=1\n                 Performance = -4637.83 (98.05 of copy matmul, -139.53 of clock)\nmake -f Makefile INSTALL_LOG/dbestNT_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmNT : muladd=1, lat=8, pf=513, nb=44, mu=4, nu=2 ku=44,\n                 ForceFetch=1, ifetch=8 nfetch=1\n                 Performance = -4328.51 (91.51 of copy matmul, -130.22 of clock)\nmake -f Makefile INSTALL_LOG/dbestTN_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmTN : muladd=1, lat=5, pf=513, nb=44, mu=4, nu=2 ku=44,\n                 ForceFetch=1, ifetch=8 nfetch=1\n                 Performance = -4296.23 (90.83 of copy matmul, -129.25 of clock)\nmake -f Makefile INSTALL_LOG/dbestTT_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmTT : muladd=1, lat=2, pf=513, nb=44, mu=4, nu=2 ku=44,\n                 ForceFetch=1, ifetch=8 nfetch=1\n                 Performance = -4511.62 (95.38 of copy matmul, -135.73 of clock)\nmake -f Makefile MMinstall pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG\n\n\n   STAGE 2-1-2: CacheEdge DETECTION\nmake -f Makefile INSTALL_LOG/atlas_cacheedge.h pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMCACHEEDGE.LOG\nmake[3]: *** [build] Error 255\nmake[3]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'\nmake[2]: *** [build] Error 2\nmake[2]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'\nFailed to build ATLAS\n```\n\nso I can't check this myself. \n\nDave",
    "created_at": "2010-10-28T04:29:00Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84395",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:48'></a>
Undoubtadly unrelated, but I can't get ATLAS to build, in the virtual machine:

```
gcc -DL2SIZE=4194304 -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include/contrib -DAdd_ -DF77_INTEGER=int -DStringSunStyle -DATL_OS_Linux -DATL_ARCH_Corei7 -DATL_CPUMHZ=3324 -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664  -fomit-frame-pointer -mfpmath=sse -msse3 -O2 -fno-schedule-insns2 -fPIC -m64 -DATL_BETA=1 -c dmm.c 
gcc -DL2SIZE=4194304 -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include -I/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//include/contrib -DAdd_ -DF77_INTEGER=int -DStringSunStyle -DATL_OS_Linux -DATL_ARCH_Corei7 -DATL_CPUMHZ=3324 -DATL_SSE3 -DATL_SSE2 -DATL_SSE1 -DATL_USE64BITS -DATL_GAS_x8664  -fomit-frame-pointer -mfpmath=sse -msse3 -O2 -fno-schedule-insns2 -fPIC -m64 -o xdfc dfc.o dmm.o \
                                    /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/sysinfo/time.o 
/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin/ATLrun.sh /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm xdfc 
Near-zero time 0.000000e+00 rejected
Near-zero time 0.000000e+00 rejected
Near-zero time 0.000000e+00 rejected
Near-zero time 0.000000e+00 rejected
Near-zero time 0.000000e+00 rejected
Too many zero-time values, dying
make[7]: *** [dmmcase0] Error 255
make[7]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
make[6]: *** [mmcase] Error 2
make[6]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
Error in command:  make mmcase pre=d loopO=JIK ta=T tb=N M=60 N=60 K=60 mb=60 nb=60 kb=60 lda=60 ldb=60 ldc=0 lda2=60 ldb2=60 ldc2=0 mu=4 nu=2 ku=60 alpha=1 beta=1 muladd=1 lat=5 cleanup=1 ff=1 if=8 nf=1 pfA=513 
mmnreg = 19

NB's to try: 60   


pre=d, muladd=0, lat=1, pf=0, nb=35, mu=5, nu=1, ku=35, mflop=2269.50

pre=d, muladd=0, lat=1, pf=0, nb=35, mu=5, nu=1, ku=35, mflop=2269.50

pre=d, muladd=0, lat=1, pf=0, nb=36, mu=4, nu=1, ku=36, mflop=7056.25

pre=d, muladd=1, lat=1, pf=0, nb=36, mu=4, nu=1, ku=36, mflop=15572.92
make[5]: *** [RunMMDef] Error 255
make[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
make[4]: *** [IRunMMDef] Error 2
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dMMRES INSTALL_LOG/.
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dNCNB INSTALL_LOG/.
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestNN_44x44x44 INSTALL_LOG/.
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestNT_44x44x44 INSTALL_LOG/.
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestTN_44x44x44 INSTALL_LOG/.
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cp /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/dbestTT_44x44x44 INSTALL_LOG/.
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm ; make dinstall
make[5]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
./xemit_mm  -p d -R -2
pre=d, CU=0, ma=0, ff=0, if=-1, nf=-1, lo=1, ta=112, tb=111, lat=4, mu=4, nu=4, ku=1, m=0, n=0, k=0, lda=0, ldb=0, ldc=0, csA=1, csB=1, csC=1, alpha=1, beta=1

line 4023 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c
line 4025 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c
line 4027 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c
line 3770 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c
line 3772 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c
line 3774 of /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c
cat: CASES/: Is a directory
xemit_mm: /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/../src//tune/blas/gemm/emit_mm.c:3737: GenAllUNBCases: Assertion `system(ln) == 0' failed.
make[5]: *** [dinstall] Aborted
make[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
make[4]: *** [MMinstall] Error 2
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm ; make res/atlas_cacheedge.h pre=d
make[5]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
make dRunFindCE
make[6]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
cd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm ; make dlib
make[7]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'
make auxillib dcleanuplib dusergemm
make[8]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'
cd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/auxil ; make lib
make[9]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/auxil'
make[9]: Nothing to be done for `lib'.
make[9]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/auxil'
cd KERNEL ; make -f dMakefile dlib
make[9]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm/KERNEL'
make[9]: dMakefile: No such file or directory
make[9]: *** No rule to make target `dMakefile'.  Stop.
make[9]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm/KERNEL'
make[8]: *** [dcleanuplib] Error 2
make[8]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'
make[7]: *** [dlib] Error 2
make[7]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/src/blas/gemm'
make[6]: *** [dmmlib] Error 2
make[6]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
make[5]: *** [res/atlas_cacheedge.h] Error 2
make[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm'
make[4]: *** [/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/tune/blas/gemm/res/atlas_cachedge.h] Error 2
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
ERROR 639 DURING CACHE EDGE DETECTION!!.
make[4]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
cd /home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build ; make error_report
make[5]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'
make -f Make.top error_report
make[6]: Entering directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'
uname -a 2>&1 >> bin/INSTALL_LOG/ERROR.LOG
gcc -v 2>&1  >> bin/INSTALL_LOG/ERROR.LOG
Using built-in specs.
COLLECT_GCC=gcc
COLLECT_LTO_WRAPPER=/usr/lib64/gcc/x86_64-suse-linux/4.5/lto-wrapper
Target: x86_64-suse-linux
Configured with: ../configure --prefix=/usr --infodir=/usr/share/info --mandir=/usr/share/man --libdir=/usr/lib64 --libexecdir=/usr/lib64 --enable-languages=c,c++,objc,fortran,obj-c++,java,ada --enable-checking=release --with-gxx-include-dir=/usr/include/c++/4.5 --enable-ssp --disable-libssp --disable-plugin --with-bugurl=http://bugs.opensuse.org/ --with-pkgversion='SUSE Linux' --disable-libgcj --disable-libmudflap --with-slibdir=/lib64 --with-system-zlib --enable-__cxa_atexit --enable-libstdcxx-allocator=new --disable-libstdcxx-pch --enable-version-specific-runtime-libs --program-suffix=-4.5 --enable-linux-futex --without-system-libunwind --enable-gold --with-plugin-ld=/usr/bin/gold --with-arch-32=i586 --with-tune=generic --build=x86_64-suse-linux
Thread model: posix
gcc version 4.5.0 20100604 [gcc-4_5-branch revision 160292] (SUSE Linux) 
gcc -V 2>&1  >> bin/INSTALL_LOG/ERROR.LOG
gcc: '-V' option must have argument
make[6]: [error_report] Error 1 (ignored)
gcc --version 2>&1  >> bin/INSTALL_LOG/ERROR.LOG
tar cf error_Corei764SSE3.tar Make.inc bin/INSTALL_LOG/*
gzip --best error_Corei764SSE3.tar
mv error_Corei764SSE3.tar.gz error_Corei764SSE3.tgz
make[6]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'
make[5]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'
make[4]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build/bin'
Error report error_<ARCH>.tgz has been created in your top-level ATLAS
directory.  Be sure to include this file in any help request.
cat: ../../CONFIG/error.txt: No such file or directory
cat: ../../CONFIG/error.txt: No such file or directory


IN STAGE 1 INSTALL:  SYSTEM PROBE/AUX COMPILE


   Level 1 cache size calculated as 32KB
   dFPU: Separate multiply and add instructions with 5 cycle pipeline.
         Apparent number of registers : 17
         Register-register performance=802.87MFLOPS
   sFPU: Separate multiply and add instructions with 4 cycle pipeline.
         Apparent number of registers : 17
         Register-register performance=877.97MFLOPS


IN STAGE 2 INSTALL:  TYPE-DEPENDENT TUNING


STAGE 2-1: TUNING PREC='d' (precision 1 of 4)


   STAGE 2-1-1 : BUILDING BLOCK MATMUL TUNE
make -f Makefile IRunMMDef pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG
make -f Makefile INSTALL_LOG/dMMRES pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG
      dL1MATMUL: lat=5, nb=60, pf=513, mu=4, nu=2, ku=60, if=8, nf=1;
                 Performance: -4730.15 (-142.30 percent of of detected clock rate)
make -f Makefile INSTALL_LOG/dNCNB pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOGmake -f Makefile INSTALL_LOG/dbestNN_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmNN : muladd=1, lat=8, pf=513, nb=44, mu=4, nu=2 ku=44,
                 ForceFetch=1, ifetch=8 nfetch=1
                 Performance = -4637.83 (98.05 of copy matmul, -139.53 of clock)
make -f Makefile INSTALL_LOG/dbestNT_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmNT : muladd=1, lat=8, pf=513, nb=44, mu=4, nu=2 ku=44,
                 ForceFetch=1, ifetch=8 nfetch=1
                 Performance = -4328.51 (91.51 of copy matmul, -130.22 of clock)
make -f Makefile INSTALL_LOG/dbestTN_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmTN : muladd=1, lat=5, pf=513, nb=44, mu=4, nu=2 ku=44,
                 ForceFetch=1, ifetch=8 nfetch=1
                 Performance = -4296.23 (90.83 of copy matmul, -129.25 of clock)
make -f Makefile INSTALL_LOG/dbestTT_44x44x44 pre=d nb=44 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG      NCgemmTT : muladd=1, lat=2, pf=513, nb=44, mu=4, nu=2 ku=44,
                 ForceFetch=1, ifetch=8 nfetch=1
                 Performance = -4511.62 (95.38 of copy matmul, -135.73 of clock)
make -f Makefile MMinstall pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMSEARCH.LOG


   STAGE 2-1-2: CacheEdge DETECTION
make -f Makefile INSTALL_LOG/atlas_cacheedge.h pre=d 2>&1 | ./xatlas_tee INSTALL_LOG/dMMCACHEEDGE.LOG
make[3]: *** [build] Error 255
make[3]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'
make[2]: *** [build] Error 2
make[2]: Leaving directory `/home/drkirkby/sage-4.6.rc0/spkg/build/atlas-3.8.3.p16/ATLAS-build'
Failed to build ATLAS
```

so I can't check this myself. 

Dave



---

archive/issue_comments_084396.json:
```json
{
    "body": "<a id='comment:49'></a>\nReplying to [drkirkby](#comment%3A46):\n> I'll follow the instructions.\n\nFine. I just added this (otherwise your bash would have crashed).\n\n> Why do people keep calling this openSuSE? It was in the title, and now I see it in Leif's comments. According to the openSUSE web page, it is openSUSE.\n\nOh, I noticed that. It's because openSUSE started as SuSE Linux, a distribution created by the S.u.S.E. GmbH (the \"u\" meaning \"&\", German \"und\", since the \"S\"s stand for the given names of the founders of the company, which happened to be siblings).\n\n---\n\nW.r.t. `ln -a` and `-n`:\n\nI really wonder if we should make GNU coreutils (and perhaps some more) prerequisites for Sage (or even ship coreutils as an spkg), since there seems to be not much progress with POSIX commands.\n\nOr build at least some of our own commands (as part of the scripts spkg).\n\n`sed -i` is also quite useful, though one can relatively easily work around that, in contrast to other not-yet-POSIX features of some other commands.",
    "created_at": "2010-10-28T04:56:43Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84396",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:49'></a>
Replying to [drkirkby](#comment%3A46):
> I'll follow the instructions.

Fine. I just added this (otherwise your bash would have crashed).

> Why do people keep calling this openSuSE? It was in the title, and now I see it in Leif's comments. According to the openSUSE web page, it is openSUSE.

Oh, I noticed that. It's because openSUSE started as SuSE Linux, a distribution created by the S.u.S.E. GmbH (the "u" meaning "&", German "und", since the "S"s stand for the given names of the founders of the company, which happened to be siblings).

---

W.r.t. `ln -a` and `-n`:

I really wonder if we should make GNU coreutils (and perhaps some more) prerequisites for Sage (or even ship coreutils as an spkg), since there seems to be not much progress with POSIX commands.

Or build at least some of our own commands (as part of the scripts spkg).

`sed -i` is also quite useful, though one can relatively easily work around that, in contrast to other not-yet-POSIX features of some other commands.



---

archive/issue_comments_084397.json:
```json
{
    "body": "<a id='comment:50'></a>\nHmmm, though it doesn't hurt here, we don't need the `-n` when creating the symbolic links to the libraries. It's only relevant for directories.\n\nBut I'm not going to change the spkg again; there's always a #9523...",
    "created_at": "2010-10-28T05:35:32Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84397",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:50'></a>
Hmmm, though it doesn't hurt here, we don't need the `-n` when creating the symbolic links to the libraries. It's only relevant for directories.

But I'm not going to change the spkg again; there's always a #9523...



---

archive/issue_comments_084398.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [@nexttime](#comment%3A49):\n> Replying to [drkirkby](#comment%3A46):\n> > I'll follow the instructions.\n\n> \n> Fine. I just added this (otherwise your bash would have crashed).\n> \n> > Why do people keep calling this openSuSE? It was in the title, and now I see it in Leif's comments. According to the openSUSE web page, it is openSUSE.\n\n> \n> Oh, I noticed that. It's because openSUSE started as SuSE Linux, \n\nI see. But it would be sensible to call it by the correct name now. Not that it should be a major hassle. \n\n> W.r.t. `ln -a` and `-n`:\n> \n> I really wonder if we should make GNU coreutils (and perhaps some more) prerequisites for Sage (or even ship coreutils as an spkg), since there seems to be not much progress with POSIX commands.\n> \n> Or build at least some of our own commands (as part of the scripts spkg).\n\nIt just encourages people to write non-portable code. So they write non-portable code for Sage, then if they write code for other projects, they do the same there. At least Sage being cross-platform encourages developers to think about portability. I'm sure it has contributed to the education of many. \n\nBTW, I don't see the need to copy the readline files to $SAGE_LOCAL - why not create links? It saves disk space and CPU cycles. \n\nDave",
    "created_at": "2010-10-28T05:59:20Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84398",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:51'></a>
Replying to [@nexttime](#comment%3A49):
> Replying to [drkirkby](#comment%3A46):
> > I'll follow the instructions.

> 
> Fine. I just added this (otherwise your bash would have crashed).
> 
> > Why do people keep calling this openSuSE? It was in the title, and now I see it in Leif's comments. According to the openSUSE web page, it is openSUSE.

> 
> Oh, I noticed that. It's because openSUSE started as SuSE Linux, 

I see. But it would be sensible to call it by the correct name now. Not that it should be a major hassle. 

> W.r.t. `ln -a` and `-n`:
> 
> I really wonder if we should make GNU coreutils (and perhaps some more) prerequisites for Sage (or even ship coreutils as an spkg), since there seems to be not much progress with POSIX commands.
> 
> Or build at least some of our own commands (as part of the scripts spkg).

It just encourages people to write non-portable code. So they write non-portable code for Sage, then if they write code for other projects, they do the same there. At least Sage being cross-platform encourages developers to think about portability. I'm sure it has contributed to the education of many. 

BTW, I don't see the need to copy the readline files to $SAGE_LOCAL - why not create links? It saves disk space and CPU cycles. 

Dave



---

archive/issue_comments_084399.json:
```json
{
    "body": "<a id='comment:52'></a>\nReplying to [drkirkby](#comment%3A51):\n> BTW, I don't see the need to copy the readline files to $SAGE_LOCAL - why not create links? It saves disk space and CPU cycles. \n\nWell, we copy the library, and the user might decide to upgrade the system libreadline (devel version) later, perhaps even \"unintentionally\" by installing a bunch of upgraded packages.\n\nWe then might use newer headers that do not match the library we copied, which would break a later [re]build. So it's safer to copy them, too. My readline 6.1 headers are 80 KB btw.\n\n(For the same reason I prefer **copying** the library, since otherwise an upgrade of the system library might break **our**, the Sage installation.)",
    "created_at": "2010-10-28T06:29:10Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84399",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:52'></a>
Replying to [drkirkby](#comment%3A51):
> BTW, I don't see the need to copy the readline files to $SAGE_LOCAL - why not create links? It saves disk space and CPU cycles. 

Well, we copy the library, and the user might decide to upgrade the system libreadline (devel version) later, perhaps even "unintentionally" by installing a bunch of upgraded packages.

We then might use newer headers that do not match the library we copied, which would break a later [re]build. So it's safer to copy them, too. My readline 6.1 headers are 80 KB btw.

(For the same reason I prefer **copying** the library, since otherwise an upgrade of the system library might break **our**, the Sage installation.)



---

archive/issue_comments_084400.json:
```json
{
    "body": "<a id='comment:53'></a>\nReplying to [drkirkby](#comment%3A48):\n\n> Undoubtadly unrelated, but I can't get ATLAS to build, in the virtual machine: ... so I can't check this myself.\n\nWould it help to build with `SAGE_FAT_BINARY=yes`?\n\nBy the way, how large is the VM image?",
    "created_at": "2010-10-28T08:51:44Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84400",
    "user": "https://github.com/qed777"
}
```

<a id='comment:53'></a>
Replying to [drkirkby](#comment%3A48):

> Undoubtadly unrelated, but I can't get ATLAS to build, in the virtual machine: ... so I can't check this myself.

Would it help to build with `SAGE_FAT_BINARY=yes`?

By the way, how large is the VM image?



---

archive/issue_comments_084401.json:
```json
{
    "body": "<a id='comment:54'></a>\nReplying to [@qed777](#comment%3A53):\n> Replying to [drkirkby](#comment%3A48):\n> \n> > Undoubtadly unrelated, but I can't get ATLAS to build, in the virtual machine: ... so I can't check this myself.\n\n> \n> Would it help to build with `SAGE_FAT_BINARY=yes`?\n\nWorth a try I guess\n \n> By the way, how large is the VM image?\n\n3.4 GB. This is VirtualBox, not VMWare. \n\nDave",
    "created_at": "2010-10-28T08:59:16Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84401",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:54'></a>
Replying to [@qed777](#comment%3A53):
> Replying to [drkirkby](#comment%3A48):
> 
> > Undoubtadly unrelated, but I can't get ATLAS to build, in the virtual machine: ... so I can't check this myself.

> 
> Would it help to build with `SAGE_FAT_BINARY=yes`?

Worth a try I guess
 
> By the way, how large is the VM image?

3.4 GB. This is VirtualBox, not VMWare. 

Dave



---

archive/issue_comments_084402.json:
```json
{
    "body": "**Reviewer:** David Kirkby",
    "created_at": "2010-10-28T09:02:09Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84402",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Reviewer:** David Kirkby



---

archive/issue_comments_084403.json:
```json
{
    "body": "<a id='comment:55'></a>\nDespite being unable to check this fully, I'm going to give it a positive review. \n\nI'm sure Leif has checked it builds on his Linux. I've checked it builds on OpenSolaris and Solaris. I've also checked it builds on openSUSE 11.3, though I was unable to build on openSUSE fully, as ATLAS would not build - totally unrelated to this. \n\nLooking at #9523, I can see the old readline was causing issues with building sqlite. I can confirm there are no issues building sqlite on openSUSE any more. \n\nI don't have access to ArchLinux and can't be bothered to install it, but in any case that's not a supported platform. \n\nI do wish people would not use `grep -q` though - as it will break on Solaris. \n\nSo I think given all this, I'm reasonably confident this is OK. I can't possibly imagine it would break any supported platform.\n\nDave",
    "created_at": "2010-10-28T09:02:09Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84403",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:55'></a>
Despite being unable to check this fully, I'm going to give it a positive review. 

I'm sure Leif has checked it builds on his Linux. I've checked it builds on OpenSolaris and Solaris. I've also checked it builds on openSUSE 11.3, though I was unable to build on openSUSE fully, as ATLAS would not build - totally unrelated to this. 

Looking at #9523, I can see the old readline was causing issues with building sqlite. I can confirm there are no issues building sqlite on openSUSE any more. 

I don't have access to ArchLinux and can't be bothered to install it, but in any case that's not a supported platform. 

I do wish people would not use `grep -q` though - as it will break on Solaris. 

So I think given all this, I'm reasonably confident this is OK. I can't possibly imagine it would break any supported platform.

Dave



---

archive/issue_events_070393.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/drkirkby",
    "created_at": "2010-10-28T09:02:09Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70393"
}
```



---

archive/issue_events_070394.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/drkirkby",
    "created_at": "2010-10-28T09:02:09Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70394"
}
```



---

archive/issue_comments_084404.json:
```json
{
    "body": "<a id='comment:56'></a>\nReplying to [@qed777](#comment%3A53):\n> Replying to [drkirkby](#comment%3A48):\n> \n> > Undoubtedly unrelated, but I can't get ATLAS to build, in the virtual machine: ... so I can't check this myself.\n\n> \n> Would it help to build with `SAGE_FAT_BINARY=yes`?\n\nIt did not help. I also tried unsetting MAKE - again no help. \n\nI've not managed to build ATLAS on Debian either in a virtual machine. I have the latest version of VirtualBox. I did wonder if I loaded the machine up, so the CPU usage was high, if this would increase the times and so hopefully get non-zero values.",
    "created_at": "2010-10-28T09:14:05Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84404",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:56'></a>
Replying to [@qed777](#comment%3A53):
> Replying to [drkirkby](#comment%3A48):
> 
> > Undoubtedly unrelated, but I can't get ATLAS to build, in the virtual machine: ... so I can't check this myself.

> 
> Would it help to build with `SAGE_FAT_BINARY=yes`?

It did not help. I also tried unsetting MAKE - again no help. 

I've not managed to build ATLAS on Debian either in a virtual machine. I have the latest version of VirtualBox. I did wonder if I loaded the machine up, so the CPU usage was high, if this would increase the times and so hopefully get non-zero values.



---

archive/issue_comments_084405.json:
```json
{
    "body": "<a id='comment:57'></a>\nReplying to [drkirkby](#comment%3A55):\n> I'm sure Leif has checked it builds on his Linux.\n\nOf course. (Ubuntu 10.04 x86_64)\n\n> I've also checked it builds on openSUSE 11.3, though I was unable to build on openSUSE fully, as ATLAS would not build - totally unrelated to this.\n\nYou could perhaps steal an ATLAS library from Florent, if you don't care about its performance.\n\n> I do wish people would not use `grep -q` though - as it will break on Solaris.\n\nI really think Sage users on [Open]Solaris should set up their path to have the POSIX versions first in it. Sage's `configure` could check that. (Or we could modify `PATH` in `sage-env` accordingly.)",
    "created_at": "2010-10-28T09:25:42Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84405",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:57'></a>
Replying to [drkirkby](#comment%3A55):
> I'm sure Leif has checked it builds on his Linux.

Of course. (Ubuntu 10.04 x86_64)

> I've also checked it builds on openSUSE 11.3, though I was unable to build on openSUSE fully, as ATLAS would not build - totally unrelated to this.

You could perhaps steal an ATLAS library from Florent, if you don't care about its performance.

> I do wish people would not use `grep -q` though - as it will break on Solaris.

I really think Sage users on [Open]Solaris should set up their path to have the POSIX versions first in it. Sage's `configure` could check that. (Or we could modify `PATH` in `sage-env` accordingly.)



---

archive/issue_comments_084406.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [@nexttime](#comment%3A57):\n> Replying to [drkirkby](#comment%3A55):\n\n> > I do wish people would not use `grep -q` though - as it will break on Solaris.\n\n> \n> I really think Sage users on [Open]Solaris should set up their path to have the POSIX versions first in it. Sage's `configure` could check that. (Or we could modify `PATH` in `sage-env` accordingly.)\n> \n\nI don't think Solaris is the only system which lacks the -q by default. In any case, it is very easy to work around. \n\nDave",
    "created_at": "2010-10-28T09:35:28Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84406",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:58'></a>
Replying to [@nexttime](#comment%3A57):
> Replying to [drkirkby](#comment%3A55):

> > I do wish people would not use `grep -q` though - as it will break on Solaris.

> 
> I really think Sage users on [Open]Solaris should set up their path to have the POSIX versions first in it. Sage's `configure` could check that. (Or we could modify `PATH` in `sage-env` accordingly.)
> 

I don't think Solaris is the only system which lacks the -q by default. In any case, it is very easy to work around. 

Dave



---

archive/issue_comments_084407.json:
```json
{
    "body": "<a id='comment:59'></a>\nFormality.",
    "created_at": "2010-10-28T10:41:56Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84407",
    "user": "https://github.com/qed777"
}
```

<a id='comment:59'></a>
Formality.



---

archive/issue_events_070395.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-28T10:41:56Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "label": "critical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70395"
}
```



---

archive/issue_events_070396.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-28T10:41:56Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "label": "blocker",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70396"
}
```



---

archive/issue_events_070397.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-30T10:38:40Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70397"
}
```



---

archive/issue_events_070398.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-30T10:38:40Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70398"
}
```



---

archive/issue_events_070399.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-30T23:14:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "milestone": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70399"
}
```



---

archive/issue_events_070400.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-30T23:14:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "milestone": "sage-4.6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70400"
}
```



---

archive/issue_events_070401.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-30T23:14:47Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "milestone": "sage-4.6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70401"
}
```



---

archive/issue_events_070402.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-10-30T23:14:47Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "milestone": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9530#event-70402"
}
```



---

archive/issue_comments_084408.json:
```json
{
    "body": "**Merged:** sage-4.6",
    "created_at": "2010-10-30T23:14:47Z",
    "issue": "https://github.com/sagemath/sage/issues/9530",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9530#issuecomment-84408",
    "user": "https://github.com/qed777"
}
```

**Merged:** sage-4.6
