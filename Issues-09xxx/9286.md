# Issue 9286: Add an spkg-check file for boehm_gc

archive/issues_009286.json:
```json
{
    "body": "boehm_gc is one of the many standard packages in Sage (see #9281 for a list), which do not have a spkg-check file. This means that if one builds Sage with the environment variable SAGE_CHECK set to \"yes\", no self-tests of the package will be run. This is silly, as boehm_gc  has a test suite. \n\nAfter adding the required file, the test suite is run. This has been checked on OpenSolaris x64 in 64-bit mode and Solaris 10 SPARC in 32-bit mode. \n\n ```\n creating threadleaktest\n make[2]: Leaving directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'\n make  check-TESTS\n make[2]: Entering directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'\n Completed 3 tests\n Allocated 4030601 collectable objects\n Allocated 306 uncollectable objects\n Allocated 2527886 atomic objects\n Allocated 34362 stubborn objects\n Finalized 6761/6761 objects - finalization is probably ok\n Total number of bytes allocated is 227907342\n Final heap size is 19632128 bytes\n Collector appears to work\n Completed 106 collections\n PASS: gctest\n Leaked composite object at 4daec0 (tests/leak_test.c:19, sz=8, NORMAL)\n \n PASS: leaktest\n Final heap size is 524288\n PASS: middletest\n GC_check_heap_block: found smashed heap objects:\n 4e8fe8 in or near object at 4e8fc0(tests/smash_test.c:21, sz=40)\n GC_check_heap_block: found smashed heap objects:\n 55bae8 in or near object at 55bac0(tests/smash_test.c:21, sz=40)\n 4e8fe8 in or near object at 4e8fc0(tests/smash_test.c:21, sz=40)\n PASS: smashtest\n GC Warning: Out of Memory!  Returning NIL!\n GC Warning: Out of Memory!  Returning NIL!\n GC Warning: Out of Memory!  Returning NIL!\n PASS: hugetest\n Leaked composite object at 4daf80 (tests/thread_leak_test.c:14, sz=4, NORMAL)\n \n Leaked composite object at start: 4daf90, appr. length: 48\n Leaked composite object at 4dae00 (tests/thread_leak_test.c:14, sz=4, NORMAL)\n \n Leaked composite object at 4daef0 (tests/thread_leak_test.c:14, sz=4, NORMAL)\n \n Leaked composite object at start: 4dae10, appr. length: 48\n Leaked composite object at 4dadd0 (tests/thread_leak_test.c:14, sz=4, NORMAL)\n \n Leaked composite object at 4dae90 (tests/thread_leak_test.c:14, sz=4, NORMAL)\n \n PASS: threadleaktest\n ==================\n All 6 tests passed\n ==================\n make[2]: Leaving directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'\n make[1]: Leaving directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'\n Now cleaning up tmp files.\n rm: Cannot remove any directory in the path of the current working directory\n /export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6\n Making Sage/Python scripts relocatable...\n Making script relocatable\n Finished installing boehm_gc-7.1.p6.spkg\n ```\n\n\n**Author:** David Kirkby\n\n**Reviewer:** Ivan Andrus\n\n**Merged:** sage-4.5.alpha0\n\nIssue created by migration from https://trac.sagemath.org/ticket/9286\n\n",
    "closed_at": "2010-06-25T15:52:39Z",
    "created_at": "2010-06-20T21:41:54Z",
    "labels": [
        "component: spkg-check",
        "minor",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5",
    "title": "Add an spkg-check file for boehm_gc",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9286",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```
boehm_gc is one of the many standard packages in Sage (see #9281 for a list), which do not have a spkg-check file. This means that if one builds Sage with the environment variable SAGE_CHECK set to "yes", no self-tests of the package will be run. This is silly, as boehm_gc  has a test suite. 

After adding the required file, the test suite is run. This has been checked on OpenSolaris x64 in 64-bit mode and Solaris 10 SPARC in 32-bit mode. 

 ```
 creating threadleaktest
 make[2]: Leaving directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'
 make  check-TESTS
 make[2]: Entering directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'
 Completed 3 tests
 Allocated 4030601 collectable objects
 Allocated 306 uncollectable objects
 Allocated 2527886 atomic objects
 Allocated 34362 stubborn objects
 Finalized 6761/6761 objects - finalization is probably ok
 Total number of bytes allocated is 227907342
 Final heap size is 19632128 bytes
 Collector appears to work
 Completed 106 collections
 PASS: gctest
 Leaked composite object at 4daec0 (tests/leak_test.c:19, sz=8, NORMAL)
 
 PASS: leaktest
 Final heap size is 524288
 PASS: middletest
 GC_check_heap_block: found smashed heap objects:
 4e8fe8 in or near object at 4e8fc0(tests/smash_test.c:21, sz=40)
 GC_check_heap_block: found smashed heap objects:
 55bae8 in or near object at 55bac0(tests/smash_test.c:21, sz=40)
 4e8fe8 in or near object at 4e8fc0(tests/smash_test.c:21, sz=40)
 PASS: smashtest
 GC Warning: Out of Memory!  Returning NIL!
 GC Warning: Out of Memory!  Returning NIL!
 GC Warning: Out of Memory!  Returning NIL!
 PASS: hugetest
 Leaked composite object at 4daf80 (tests/thread_leak_test.c:14, sz=4, NORMAL)
 
 Leaked composite object at start: 4daf90, appr. length: 48
 Leaked composite object at 4dae00 (tests/thread_leak_test.c:14, sz=4, NORMAL)
 
 Leaked composite object at 4daef0 (tests/thread_leak_test.c:14, sz=4, NORMAL)
 
 Leaked composite object at start: 4dae10, appr. length: 48
 Leaked composite object at 4dadd0 (tests/thread_leak_test.c:14, sz=4, NORMAL)
 
 Leaked composite object at 4dae90 (tests/thread_leak_test.c:14, sz=4, NORMAL)
 
 PASS: threadleaktest
 ==================
 All 6 tests passed
 ==================
 make[2]: Leaving directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'
 make[1]: Leaving directory `/export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6/src'
 Now cleaning up tmp files.
 rm: Cannot remove any directory in the path of the current working directory
 /export/home/drkirkby/sage-4.4.4.alpha1/spkg/build/boehm_gc-7.1.p6
 Making Sage/Python scripts relocatable...
 Making script relocatable
 Finished installing boehm_gc-7.1.p6.spkg
 ```


**Author:** David Kirkby

**Reviewer:** Ivan Andrus

**Merged:** sage-4.5.alpha0

Issue created by migration from https://trac.sagemath.org/ticket/9286





---

archive/attachments_011718.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "9286.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9286/9286.patch",
    "created_at": "2010-06-20T21:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```



---

archive/issue_comments_101836.json:
```json
{
    "body": "Mercurial patch to add an spkg-check to enable self-tests",
    "created_at": "2010-06-20T21:49:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101836",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

Mercurial patch to add an spkg-check to enable self-tests



---

archive/issue_comments_101837.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-boehm_gc is one of many files in Sage (see #9281 for a list), which do not have a spkg-check file. This means that if one builds Sage with the environment variable SAGE_CHECK set to \"yes\", no self-tests of the package will be run. This is silly, as boehm_gc  has a test suite. \n+boehm_gc is one of the many standard packages in Sage (see #9281 for a list), which do not have a spkg-check file. This means that if one builds Sage with the environment variable SAGE_CHECK set to \"yes\", no self-tests of the package will be run. This is silly, as boehm_gc  has a test suite. \n \n After adding the required file, the test suite is run. This has been checked on OpenSolaris x64 in 64-bit mode and Solaris 10 SPARC in 32-bit mode. \n \n``````\n",
    "created_at": "2010-06-20T22:01:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101837",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-boehm_gc is one of many files in Sage (see #9281 for a list), which do not have a spkg-check file. This means that if one builds Sage with the environment variable SAGE_CHECK set to "yes", no self-tests of the package will be run. This is silly, as boehm_gc  has a test suite. 
+boehm_gc is one of the many standard packages in Sage (see #9281 for a list), which do not have a spkg-check file. This means that if one builds Sage with the environment variable SAGE_CHECK set to "yes", no self-tests of the package will be run. This is silly, as boehm_gc  has a test suite. 
 
 After adding the required file, the test suite is run. This has been checked on OpenSolaris x64 in 64-bit mode and Solaris 10 SPARC in 32-bit mode. 
 
``````




---

archive/issue_comments_101838.json:
```json
{
    "body": "<a id='comment:2'></a>\nHere's the package, which will perform some self-tsts if SAGE_CHECK is exported to \"yes\"\n\nhttp://boxen.math.washington.edu/home/kirkby/patches/boehm_gc-7.1.p6.spkg",
    "created_at": "2010-06-20T22:24:26Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101838",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:2'></a>
Here's the package, which will perform some self-tsts if SAGE_CHECK is exported to "yes"

http://boxen.math.washington.edu/home/kirkby/patches/boehm_gc-7.1.p6.spkg



---

archive/issue_events_027501.json:
```json
{
    "actor": "https://github.com/gvol",
    "created_at": "2010-06-24T03:09:16Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9286#event-27501"
}
```



---

archive/issue_comments_101839.json:
```json
{
    "body": "<a id='comment:3'></a>\nI read the patch and I approve.  I ran\n\n```\nsage -i http://boxen.math.washington.edu/home/kirkby/patches/boehm_gc-7.1.p6.spkg\n```\nwhich did not run any tests, and then \n\n```\nSAGE_CHECK=yes sage -f -i http://boxen.math.washington.edu/home/kirkby/patches/boehm_gc-7.1.p6.spkg\n```\nwhich did.  All tests passed on \n\n```\nuname -a\nDarwin parduc.home 10.4.0 Darwin Kernel Version 10.4.0: Fri Apr 23 18:28:53 PDT 2010; root:xnu-1504.7.4~1/RELEASE_I386 i386 i386\n```\n\nCongratulations, you are now the proud owner of a brand new Positive Review!",
    "created_at": "2010-06-24T03:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101839",
    "user": "https://github.com/gvol"
}
```

<a id='comment:3'></a>
I read the patch and I approve.  I ran

```
sage -i http://boxen.math.washington.edu/home/kirkby/patches/boehm_gc-7.1.p6.spkg
```
which did not run any tests, and then 

```
SAGE_CHECK=yes sage -f -i http://boxen.math.washington.edu/home/kirkby/patches/boehm_gc-7.1.p6.spkg
```
which did.  All tests passed on 

```
uname -a
Darwin parduc.home 10.4.0 Darwin Kernel Version 10.4.0: Fri Apr 23 18:28:53 PDT 2010; root:xnu-1504.7.4~1/RELEASE_I386 i386 i386
```

Congratulations, you are now the proud owner of a brand new Positive Review!



---

archive/issue_comments_101840.json:
```json
{
    "body": "**Reviewer:** Ivan Andrus",
    "created_at": "2010-06-24T03:09:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101840",
    "user": "https://github.com/gvol"
}
```

**Reviewer:** Ivan Andrus



---

archive/issue_comments_101841.json:
```json
{
    "body": "**Changing status** from closed to new.",
    "created_at": "2010-06-24T03:13:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101841",
    "user": "https://github.com/gvol"
}
```

**Changing status** from closed to new.



---

archive/issue_comments_101842.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2010-06-24T03:13:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101842",
    "user": "https://github.com/gvol"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_101843.json:
```json
{
    "body": "<a id='comment:6'></a>\nOops, I closed it instead of giving positive review.",
    "created_at": "2010-06-24T03:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101843",
    "user": "https://github.com/gvol"
}
```

<a id='comment:6'></a>
Oops, I closed it instead of giving positive review.



---

archive/issue_comments_101844.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2010-06-24T03:14:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101844",
    "user": "https://github.com/gvol"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_events_027502.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T15:52:39Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9286#event-27502"
}
```



---

archive/issue_comments_101845.json:
```json
{
    "body": "**Merged:** sage-4.5.alpha0",
    "created_at": "2010-06-25T15:52:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9286",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9286#issuecomment-101845",
    "user": "https://github.com/rlmill"
}
```

**Merged:** sage-4.5.alpha0
