# Issue 9332: S_class_group() should return a group

archive/issues_009332.json:
```json
{
    "assignees": [],
    "body": "\n\n**Assignee:** @loefflerd\n\n**CC:**  adeines @JohnCremona jeremywest\n\n**Author:** Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler\n\n**Reviewer:** John Cremona\n\n**Merged:** sage-4.6.2.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/9332\n\n",
    "closed_at": "2011-01-19T22:20:48Z",
    "created_at": "2010-06-24T21:23:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "S_class_group() should return a group",
    "type": "issue",
    "updated_at": "2011-01-19T22:20:48Z",
    "url": "https://github.com/sagemath/sage/issues/9332",
    "user": "https://github.com/sagetrac-stankewicz"
}
```


**Assignee:** @loefflerd

**CC:**  adeines @JohnCremona jeremywest

**Author:** Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler

**Reviewer:** John Cremona

**Merged:** sage-4.6.2.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/9332





---

archive/issue_events_100109.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T21:23:42Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "milestone_number": null,
    "milestone_title": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100109"
}
```



---

archive/issue_events_100110.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T21:23:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
    "label_color": "08517b",
    "label_name": "component: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100110"
}
```



---

archive/issue_events_100111.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T21:23:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "008080",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100111"
}
```



---

archive/issue_events_100112.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T23:10:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100112"
}
```



---

archive/issue_comments_080725.json:
```json
{
    "body": "<a id='comment:2'>**Comment 2:**</a>\nI don't think there's a point to adding a TestSuite doctest that doesn't work. We can always add that in once #7945 is fixed. You also need to make good on your IOU. I would also suggest a shorter `repr` string-- you don't want it line-wrapping on the terminal unnecessarily.",
    "created_at": "2010-06-25T03:15:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80725",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:2'>**Comment 2:**</a>
I don't think there's a point to adding a TestSuite doctest that doesn't work. We can always add that in once #7945 is fixed. You also need to make good on your IOU. I would also suggest a shorter `repr` string-- you don't want it line-wrapping on the terminal unnecessarily.



---

archive/issue_events_100113.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T03:15:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100113"
}
```



---

archive/issue_events_100114.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T03:15:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100114"
}
```



---

archive/issue_comments_080726.json:
```json
{
    "body": "<a id='comment:3'>**Comment 3:**</a>\nThere are still some doctest failures in number_field.py, but we've added documentation and improved the way S_class_groups print.  Joint work with Erin Beyerstedt, Robert Miller, H.",
    "created_at": "2010-06-25T06:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80726",
    "user": "https://github.com/annahaensch"
}
```

<a id='comment:3'>**Comment 3:**</a>
There are still some doctest failures in number_field.py, but we've added documentation and improved the way S_class_groups print.  Joint work with Erin Beyerstedt, Robert Miller, H.



---

archive/issue_comments_080727.json:
```json
{
    "body": "**Changing author** from \"stankewicz\" to \"Jim Stankewicz, Erin Beyerstedt, Anna Haensch\".",
    "created_at": "2010-06-25T06:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80727",
    "user": "https://github.com/annahaensch"
}
```

**Changing author** from "stankewicz" to "Jim Stankewicz, Erin Beyerstedt, Anna Haensch".



---

archive/issue_comments_080728.json:
```json
{
    "body": "<a id='comment:4'>**Comment 4:**</a>\nGood work so far!\n\nI think the repr string for a (s-)class group should not mention its order or structure at all.  The user can always ask for that.\n\nI'm not sure about the S() function returning None for a straight class group.  I would be happy with it returning [] when S is None.\n\nIn the number field file, there is no need to add the parameter None for straght class groups, since that is the default value;  so take those out.\n\nI will now try the patches out...",
    "created_at": "2010-06-25T06:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80728",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:4'>**Comment 4:**</a>
Good work so far!

I think the repr string for a (s-)class group should not mention its order or structure at all.  The user can always ask for that.

I'm not sure about the S() function returning None for a straight class group.  I would be happy with it returning [] when S is None.

In the number field file, there is no need to add the parameter None for straght class groups, since that is the default value;  so take those out.

I will now try the patches out...



---

archive/issue_comments_080729.json:
```json
{
    "body": "<a id='comment:5'>**Comment 5:**</a>\n(After testing)  When you have simplified the string output of an S-class group you can adjust the doctest outputs in number_field.py.  (Don't worry about those Minkowski warnings -- they will disappear when the doctest passes!)",
    "created_at": "2010-06-25T06:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80729",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:5'>**Comment 5:**</a>
(After testing)  When you have simplified the string output of an S-class group you can adjust the doctest outputs in number_field.py.  (Don't worry about those Minkowski warnings -- they will disappear when the doctest passes!)



---

archive/issue_comments_080730.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-The title says it all. I have a fix ready to go\n+Apply all three patches in order.\n``````\n",
    "created_at": "2010-06-25T23:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80730",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-The title says it all. I have a fix ready to go
+Apply all three patches in order.
``````




---

archive/issue_comments_080731.json:
```json
{
    "body": "<a id='comment:7'>**Comment 7:**</a>\nFor me the 3rd patch does not apply on top of the first two.  It also looks strange -- does it mix tabs and spaces?  (You should use only spaces, some editors put tabs in).",
    "created_at": "2010-06-26T05:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80731",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:7'>**Comment 7:**</a>
For me the 3rd patch does not apply on top of the first two.  It also looks strange -- does it mix tabs and spaces?  (You should use only spaces, some editors put tabs in).



---

archive/issue_comments_080732.json:
```json
{
    "body": "<a id='comment:8'>**Comment 8:**</a>\nThe newest patch is something that I've been working on for the last several days, but I'm making no progress. There's a phantom attribute error which comes up under the following code:\n\n```\nsage: K.<a> = QuadraticField(-14)                             \nsage: K.testSclassgroup(tuple([K.ideal(2,a)]))                \nClass group of order 2 with structure C2 of Number Field in a with defining polynomial x^2 + 14\nsage: K.testSclassgroup(tuple([K.ideal(2,a)]))(K.ideal(3,a+1))\nERROR: An unexpected error occurred ...\n```\n\nPerhaps there's something stupid I'm missing and someone else can point it out. Otherwise, I'm going to work on something else for a while and come back to this with a fresh head.",
    "created_at": "2010-06-30T04:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80732",
    "user": "https://github.com/sagetrac-stankewicz"
}
```

<a id='comment:8'>**Comment 8:**</a>
The newest patch is something that I've been working on for the last several days, but I'm making no progress. There's a phantom attribute error which comes up under the following code:

```
sage: K.<a> = QuadraticField(-14)                             
sage: K.testSclassgroup(tuple([K.ideal(2,a)]))                
Class group of order 2 with structure C2 of Number Field in a with defining polynomial x^2 + 14
sage: K.testSclassgroup(tuple([K.ideal(2,a)]))(K.ideal(3,a+1))
ERROR: An unexpected error occurred ...
```

Perhaps there's something stupid I'm missing and someone else can point it out. Otherwise, I'm going to work on something else for a while and come back to this with a fresh head.



---

archive/issue_comments_080733.json:
```json
{
    "body": "<a id='comment:9'>**Comment 9:**</a>\nThe AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are \"very private\" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).\n\nBut there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.\n\nThis is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.",
    "created_at": "2010-06-30T11:26:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80733",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:9'>**Comment 9:**</a>
The AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are "very private" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).

But there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.

This is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.



---

archive/issue_comments_080734.json:
```json
{
    "body": "<a id='comment:10'>**Comment 10:**</a>\nReplying to [@loefflerd](#comment%3A9):\n> The AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are \"very private\" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).\n> \n> But there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.\n> \n> This is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.\n\nDavid, you should have been at Sage Days!",
    "created_at": "2010-06-30T11:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80734",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:10'>**Comment 10:**</a>
Replying to [@loefflerd](#comment%3A9):
> The AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are "very private" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).
> 
> But there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.
> 
> This is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.

David, you should have been at Sage Days!



---

archive/issue_comments_080735.json:
```json
{
    "body": "<a id='comment:11'>**Comment 11:**</a>\nHere's a patch that does the equivalent of `_ideal_class_log` for S-class groups; you might find it useful.",
    "created_at": "2010-06-30T13:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80735",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:11'>**Comment 11:**</a>
Here's a patch that does the equivalent of `_ideal_class_log` for S-class groups; you might find it useful.



---

archive/issue_comments_080736.json:
```json
{
    "body": "<a id='comment:12'>**Comment 12:**</a>\nHere's patch that finally makes the S-class-group work as a group, on top of Loeffler's patch(in this ticket). Soon to come will be a single patch that gets it all done, and actually has acceptable documentation.",
    "created_at": "2010-07-01T15:42:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80736",
    "user": "https://github.com/sagetrac-stankewicz"
}
```

<a id='comment:12'>**Comment 12:**</a>
Here's patch that finally makes the S-class-group work as a group, on top of Loeffler's patch(in this ticket). Soon to come will be a single patch that gets it all done, and actually has acceptable documentation.



---

archive/issue_events_100115.json:
```json
{
    "actor": "https://github.com/annahaensch",
    "created_at": "2010-07-02T20:00:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100115"
}
```



---

archive/issue_events_100116.json:
```json
{
    "actor": "https://github.com/annahaensch",
    "created_at": "2010-07-02T20:00:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100116"
}
```



---

archive/issue_comments_080737.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Apply all three patches in order.\n+trac_9332_v3 should be applied only on trac_9244_ver4\n``````\n",
    "created_at": "2010-07-02T20:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80737",
    "user": "https://github.com/annahaensch"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-Apply all three patches in order.
+trac_9332_v3 should be applied only on trac_9244_ver4
``````




---

archive/issue_comments_080738.json:
```json
{
    "body": "<a id='comment:14'>**Comment 14:**</a>\nCorrection: trac_9332_v3 should be applied only on trac_9244_ver4.  Sorry for the confusion, trac_9332_v3 includes changes made in previous patches, so there's no need to apply them.  Cheers.",
    "created_at": "2010-07-02T20:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80738",
    "user": "https://github.com/annahaensch"
}
```

<a id='comment:14'>**Comment 14:**</a>
Correction: trac_9332_v3 should be applied only on trac_9244_ver4.  Sorry for the confusion, trac_9332_v3 includes changes made in previous patches, so there's no need to apply them.  Cheers.



---

archive/issue_comments_080739.json:
```json
{
    "body": "<a id='comment:15'>**Comment 15:**</a>\nLet's clean up this ticket. Shall I delete the patches other than `trac_9332_v3` and `trac_9244_ver4`?",
    "created_at": "2010-07-02T21:20:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80739",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:15'>**Comment 15:**</a>
Let's clean up this ticket. Shall I delete the patches other than `trac_9332_v3` and `trac_9244_ver4`?



---

archive/issue_comments_080740.json:
```json
{
    "body": "<a id='comment:16'>**Comment 16:**</a>\nAll patches here can be deleted except `trac_9332_v3`. (`trac_9244_ver4` is from another ticket. )",
    "created_at": "2010-07-02T21:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80740",
    "user": "https://github.com/loefflerd"
}
```

<a id='comment:16'>**Comment 16:**</a>
All patches here can be deleted except `trac_9332_v3`. (`trac_9244_ver4` is from another ticket. )



---

archive/issue_comments_080741.json:
```json
{
    "body": "<a id='comment:17'>**Comment 17:**</a>\nCleaned up the other one as well.",
    "created_at": "2010-07-02T21:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80741",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:17'>**Comment 17:**</a>
Cleaned up the other one as well.



---

archive/issue_comments_080742.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-trac_9332_v3 should be applied only on trac_9244_ver4\n+Depends on #9244.\n``````\n",
    "created_at": "2010-07-02T21:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80742",
    "user": "https://github.com/rlmill"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-trac_9332_v3 should be applied only on trac_9244_ver4
+Depends on #9244.
``````




---

archive/issue_events_100117.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-10-31T21:10:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100117"
}
```



---

archive/issue_events_100118.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-10-31T21:10:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100118"
}
```



---

archive/issue_comments_080743.json:
```json
{
    "body": "<a id='comment:18'>**Comment 18:**</a>\nCan we get this ticket moving again?  The one and only patch still here does not apply cleanly to 4.6.rc0, so the first step is to fix that.",
    "created_at": "2010-10-31T21:10:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80743",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:18'>**Comment 18:**</a>
Can we get this ticket moving again?  The one and only patch still here does not apply cleanly to 4.6.rc0, so the first step is to fix that.



---

archive/issue_comments_080744.json:
```json
{
    "body": "<a id='comment:19'>**Comment 19:**</a>\nI'm uploading a rebased (on sage-4.6) patch which modifies printing in class fields to not print the structure when size is 1, fixes some caching bugs, updates several doctests, etc...\n\nHowever, this happens, and I'm not sure whether this is okay or not:\n\n```\nsage -t sage/rings/number_field/number_field_ideal.py\n**********************************************************************\nFile \"/home/rlmill/sage-4.6/devel/sage-main/sage/rings/number_field/number_field\n_ideal.py\", line 1017:\n    sage: I._S_ideal_class_log([])\nExpected:\n    [3]\nGot:\n    [1]\n**********************************************************************\n```",
    "created_at": "2010-11-25T00:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80744",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:19'>**Comment 19:**</a>
I'm uploading a rebased (on sage-4.6) patch which modifies printing in class fields to not print the structure when size is 1, fixes some caching bugs, updates several doctests, etc...

However, this happens, and I'm not sure whether this is okay or not:

```
sage -t sage/rings/number_field/number_field_ideal.py
**********************************************************************
File "/home/rlmill/sage-4.6/devel/sage-main/sage/rings/number_field/number_field
_ideal.py", line 1017:
    sage: I._S_ideal_class_log([])
Expected:
    [3]
Got:
    [1]
**********************************************************************
```



---

archive/issue_comments_080745.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Depends on #9244.\n+\n``````\n",
    "created_at": "2010-11-25T00:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80745",
    "user": "https://github.com/rlmill"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -1 +1 @@
-Depends on #9244.
+
``````




---

archive/issue_comments_080746.json:
```json
{
    "body": "**Changing author** from \"Jim Stankewicz, Erin Beyerstedt, Anna Haensch\" to \"Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler\".",
    "created_at": "2010-11-25T00:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80746",
    "user": "https://github.com/rlmill"
}
```

**Changing author** from "Jim Stankewicz, Erin Beyerstedt, Anna Haensch" to "Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler".



---

archive/issue_comments_080747.json:
```json
{
    "body": "<a id='comment:20'>**Comment 20:**</a>\nI applied the patch (no problems) to 4.6.1.alpha2.  The thing you observed does not happen:\n\n```\nsage: K.<a> = QuadraticField(-14) \nsage: S = K.primes_above(2) \nsage: S\n[Fractional ideal (2, a)]\nsage: I = K.ideal(3, a-1)\nsage: I._S_ideal_class_log(S) \n[1]\nsage: I._S_ideal_class_log([]) \n[1]\n```\n\nI am now testing...",
    "created_at": "2010-11-25T09:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80747",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:20'>**Comment 20:**</a>
I applied the patch (no problems) to 4.6.1.alpha2.  The thing you observed does not happen:

```
sage: K.<a> = QuadraticField(-14) 
sage: S = K.primes_above(2) 
sage: S
[Fractional ideal (2, a)]
sage: I = K.ideal(3, a-1)
sage: I._S_ideal_class_log(S) 
[1]
sage: I._S_ideal_class_log([]) 
[1]
```

I am now testing...



---

archive/issue_events_100119.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-11-25T09:37:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100119"
}
```



---

archive/issue_events_100120.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-11-25T09:37:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100120"
}
```



---

archive/issue_comments_080748.json:
```json
{
    "body": "**Reviewer:** John Cremona",
    "created_at": "2010-11-25T10:15:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80748",
    "user": "https://github.com/JohnCremona"
}
```

**Reviewer:** John Cremona



---

archive/issue_comments_080749.json:
```json
{
    "body": "<a id='comment:21'>**Comment 21:**</a>\nTwo trivial doctest failures \n\n```\nsage -t -long sage/rings/polynomial/polynomial_quotient_ring.py\n**********************************************************************\nFile \"/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/polynomial/polynomial_quotient_ring.py\", line 737:\n    sage: K.class_group()\nExpected:\n    Class group of order 1 with structure  of Number Field in a with defining polynomial x^2 + 3\nGot:\n    Class group of order 1 of Number Field in a with defining polynomial x^2 + 3\n```\nand\n\n```\nsage -t -long sage/rings/number_field/number_field_ideal.py\n**********************************************************************\nFile \"/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/number_field/number_field_ideal.py\", line 1051:\n    sage: I._S_ideal_class_log([])\nExpected:\n    [3]\nGot:\n    [1]\n```\nwhere in both cases the \"Expected \" does not look right anyway!\n\nI am leaving this as needs review since I have not looked closely again at the code, but I can assert that apart from the above two things all (long) tests pass with 4.6.1.alpha2.",
    "created_at": "2010-11-25T10:15:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80749",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:21'>**Comment 21:**</a>
Two trivial doctest failures 

```
sage -t -long sage/rings/polynomial/polynomial_quotient_ring.py
**********************************************************************
File "/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/polynomial/polynomial_quotient_ring.py", line 737:
    sage: K.class_group()
Expected:
    Class group of order 1 with structure  of Number Field in a with defining polynomial x^2 + 3
Got:
    Class group of order 1 of Number Field in a with defining polynomial x^2 + 3
```
and

```
sage -t -long sage/rings/number_field/number_field_ideal.py
**********************************************************************
File "/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/number_field/number_field_ideal.py", line 1051:
    sage: I._S_ideal_class_log([])
Expected:
    [3]
Got:
    [1]
```
where in both cases the "Expected " does not look right anyway!

I am leaving this as needs review since I have not looked closely again at the code, but I can assert that apart from the above two things all (long) tests pass with 4.6.1.alpha2.



---

archive/issue_comments_080750.json:
```json
{
    "body": "<a id='comment:22'>**Comment 22:**</a>\nI also believe the actual output is correct. Evidence:\n\n```\nsage: K.<a> = QuadraticField(-14)\nsage: S = K.primes_above(2)\nsage: I = K.ideal(3,a+2)\nsage: I\nFractional ideal (3, a + 2)\nsage: I._ideal_class_log()\n[1]\nsage: I._S_ideal_class_log([])\n[1]\n```\n\nI am uploading a fresh patch, which will fix all the above issues.",
    "created_at": "2010-11-26T15:54:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80750",
    "user": "https://github.com/rlmill"
}
```

<a id='comment:22'>**Comment 22:**</a>
I also believe the actual output is correct. Evidence:

```
sage: K.<a> = QuadraticField(-14)
sage: S = K.primes_above(2)
sage: I = K.ideal(3,a+2)
sage: I
Fractional ideal (3, a + 2)
sage: I._ideal_class_log()
[1]
sage: I._S_ideal_class_log([])
[1]
```

I am uploading a fresh patch, which will fix all the above issues.



---

archive/issue_events_100121.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-12-04T18:30:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "008080",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100121"
}
```



---

archive/issue_events_100122.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-12-04T18:30:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100122"
}
```



---

archive/issue_comments_080751.json:
```json
{
    "body": "<a id='comment:23'>**Comment 23:**</a>\nNew patch is fine!",
    "created_at": "2010-12-04T18:30:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80751",
    "user": "https://github.com/JohnCremona"
}
```

<a id='comment:23'>**Comment 23:**</a>
New patch is fine!



---

archive/issue_events_100123.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-04T22:33:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "milestone_number": null,
    "milestone_title": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100123"
}
```



---

archive/issue_comments_080752.json:
```json
{
    "body": "<a id='comment:25'>**Comment 25:**</a>\nNice patch but you should change the commit message :-)",
    "created_at": "2011-01-13T06:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80752",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:25'>**Comment 25:**</a>
Nice patch but you should change the commit message :-)



---

archive/issue_events_100124.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-13T06:34:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100124"
}
```



---

archive/issue_events_100125.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-13T06:34:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100125"
}
```



---

archive/issue_comments_080753.json:
```json
{
    "body": "**Attachment:** [trac_9332.patch.gz](https://github.com/sagemath/sage/files/ticket9332/trac_9332.patch.gz)\n\nrebased on sage-4.6.1.alpha2",
    "created_at": "2011-01-14T21:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80753",
    "user": "https://github.com/rlmill"
}
```

**Attachment:** [trac_9332.patch.gz](https://github.com/sagemath/sage/files/ticket9332/trac_9332.patch.gz)

rebased on sage-4.6.1.alpha2



---

archive/issue_events_100126.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-14T21:27:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "008080",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100126"
}
```



---

archive/issue_events_100127.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-14T21:27:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100127"
}
```



---

archive/issue_comments_080754.json:
```json
{
    "body": "**Merged:** sage-4.6.2.alpha1",
    "created_at": "2011-01-19T22:20:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-80754",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-4.6.2.alpha1



---

archive/issue_events_100128.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:20:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "008080",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100128"
}
```



---

archive/issue_events_100129.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:20:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-100129"
}
```
