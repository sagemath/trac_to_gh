# Issue 9332: S_class_group() should return a group

archive/issues_009332.json:
```json
{
    "assignees": [
        "https://github.com/loefflerd"
    ],
    "body": "\n\nCC:  @adeines @JohnCremona @sagetrac-jeremywest\n\nReviewer: **John Cremona**\n\nAuthor: **Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler**\n\nMerged: **sage-4.6.2.alpha1**\n\nComponent: **number fields**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9332_\n\n",
    "closed_at": "2011-01-19T22:20:48Z",
    "created_at": "2010-06-24T21:23:42Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6.2",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "S_class_group() should return a group",
    "type": "issue",
    "updated_at": "2023-01-08T10:05:29Z",
    "url": "https://github.com/sagemath/sage/issues/9332",
    "user": "https://github.com/sagetrac-stankewicz"
}
```


CC:  @adeines @JohnCremona @sagetrac-jeremywest

Reviewer: **John Cremona**

Author: **Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler**

Merged: **sage-4.6.2.alpha1**

Component: **number fields**

_Issue created by migration from https://trac.sagemath.org/ticket/9332_





---

archive/issue_events_118288.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T21:23:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "c: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118288"
}
```



---

archive/issue_events_118289.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T21:23:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118289"
}
```



---

archive/issue_events_118290.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T21:23:42Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118290"
}
```



---

archive/issue_events_118291.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-06-24T21:23:42Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "subject": "https://github.com/sagetrac-stankewicz",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118291"
}
```



---

archive/issue_events_118292.json:
```json
{
    "actor": "https://github.com/sagetrac-stankewicz",
    "created_at": "2010-06-24T23:10:21Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118292"
}
```



---

archive/issue_comments_078848.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nI don't think there's a point to adding a TestSuite doctest that doesn't work. We can always add that in once #7945 is fixed. You also need to make good on your IOU. I would also suggest a shorter `repr` string-- you don't want it line-wrapping on the terminal unnecessarily.",
    "created_at": "2010-06-25T03:15:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78848",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:2" align="right">comment:2</div>

I don't think there's a point to adding a TestSuite doctest that doesn't work. We can always add that in once #7945 is fixed. You also need to make good on your IOU. I would also suggest a shorter `repr` string-- you don't want it line-wrapping on the terminal unnecessarily.



---

archive/issue_events_118293.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T03:15:35Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118293"
}
```



---

archive/issue_events_118294.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-06-25T03:15:35Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118294"
}
```



---

archive/issue_comments_078849.json:
```json
{
    "body": "Changed author from **stankewicz** to **Jim Stankewicz, Erin Beyerstedt, Anna Haensch**",
    "created_at": "2010-06-25T06:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78849",
    "user": "https://github.com/annahaensch"
}
```

Changed author from **stankewicz** to **Jim Stankewicz, Erin Beyerstedt, Anna Haensch**



---

archive/issue_comments_078850.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere are still some doctest failures in number_field.py, but we've added documentation and improved the way S_class_groups print.  Joint work with Erin Beyerstedt, Robert Miller, H.",
    "created_at": "2010-06-25T06:09:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78850",
    "user": "https://github.com/annahaensch"
}
```

<div id="comment:3" align="right">comment:3</div>

There are still some doctest failures in number_field.py, but we've added documentation and improved the way S_class_groups print.  Joint work with Erin Beyerstedt, Robert Miller, H.



---

archive/issue_comments_078851.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nGood work so far!\n\nI think the repr string for a (s-)class group should not mention its order or structure at all.  The user can always ask for that.\n\nI'm not sure about the S() function returning None for a straight class group.  I would be happy with it returning [] when S is None.\n\nIn the number field file, there is no need to add the parameter None for straght class groups, since that is the default value;  so take those out.\n\nI will now try the patches out...",
    "created_at": "2010-06-25T06:28:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78851",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:4" align="right">comment:4</div>

Good work so far!

I think the repr string for a (s-)class group should not mention its order or structure at all.  The user can always ask for that.

I'm not sure about the S() function returning None for a straight class group.  I would be happy with it returning [] when S is None.

In the number field file, there is no need to add the parameter None for straght class groups, since that is the default value;  so take those out.

I will now try the patches out...



---

archive/issue_comments_078852.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n(After testing)  When you have simplified the string output of an S-class group you can adjust the doctest outputs in number_field.py.  (Don't worry about those Minkowski warnings -- they will disappear when the doctest passes!)",
    "created_at": "2010-06-25T06:35:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78852",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:5" align="right">comment:5</div>

(After testing)  When you have simplified the string output of an S-class group you can adjust the doctest outputs in number_field.py.  (Don't worry about those Minkowski warnings -- they will disappear when the doctest passes!)



---

archive/issue_comments_078853.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-The title says it all. I have a fix ready to go\n+Apply all three patches in order.\n``````\n",
    "created_at": "2010-06-25T23:04:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78853",
    "user": "https://github.com/sagetrac-ebeyerstedt"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-The title says it all. I have a fix ready to go
+Apply all three patches in order.
``````




---

archive/issue_comments_078854.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nFor me the 3rd patch does not apply on top of the first two.  It also looks strange -- does it mix tabs and spaces?  (You should use only spaces, some editors put tabs in).",
    "created_at": "2010-06-26T05:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78854",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:7" align="right">comment:7</div>

For me the 3rd patch does not apply on top of the first two.  It also looks strange -- does it mix tabs and spaces?  (You should use only spaces, some editors put tabs in).



---

archive/issue_comments_078855.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThe newest patch is something that I've been working on for the last several days, but I'm making no progress. There's a phantom attribute error which comes up under the following code:\n\n```\nsage: K.<a> = QuadraticField(-14)                             \nsage: K.testSclassgroup(tuple([K.ideal(2,a)]))                \nClass group of order 2 with structure C2 of Number Field in a with defining polynomial x^2 + 14\nsage: K.testSclassgroup(tuple([K.ideal(2,a)]))(K.ideal(3,a+1))\nERROR: An unexpected error occurred ...\n```\n\nPerhaps there's something stupid I'm missing and someone else can point it out. Otherwise, I'm going to work on something else for a while and come back to this with a fresh head.",
    "created_at": "2010-06-30T04:35:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78855",
    "user": "https://github.com/sagetrac-stankewicz"
}
```

<div id="comment:8" align="right">comment:8</div>

The newest patch is something that I've been working on for the last several days, but I'm making no progress. There's a phantom attribute error which comes up under the following code:

```
sage: K.<a> = QuadraticField(-14)                             
sage: K.testSclassgroup(tuple([K.ideal(2,a)]))                
Class group of order 2 with structure C2 of Number Field in a with defining polynomial x^2 + 14
sage: K.testSclassgroup(tuple([K.ideal(2,a)]))(K.ideal(3,a+1))
ERROR: An unexpected error occurred ...
```

Perhaps there's something stupid I'm missing and someone else can point it out. Otherwise, I'm going to work on something else for a while and come back to this with a fresh head.



---

archive/issue_comments_078856.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nThe AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are \"very private\" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).\n\nBut there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.\n\nThis is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.",
    "created_at": "2010-06-30T11:26:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78856",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:9" align="right">comment:9</div>

The AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are "very private" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).

But there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.

This is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.



---

archive/issue_comments_078857.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@loefflerd](#comment%3A9):\n> The AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are \"very private\" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).\n> \n> But there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.\n> \n> This is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.\n\nDavid, you should have been at Sage Days!",
    "created_at": "2010-06-30T11:38:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78857",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@loefflerd](#comment%3A9):
> The AttributeError comes up because attributes whose names start with an underscore are private, and ones with two underscores are "very private" -- so private that they aren't even accessible to subclasses. So when code in `FractionalIdealClass` sets `__ideal`, code in the subclass `SFractionalIdealClass`. In fact it is still accessible but under a mangled name: see [http://docs.python.org/tutorial/classes.html#private-variables](http://docs.python.org/tutorial/classes.html#private-variables).
> 
> But there is another, deeper, bug which will be uncovered when you fix this. After my changes at #9244, a `FractionalIdealClass` stores both a representing ideal of that class, accessed via `self.ideal()`, and an expression for self in terms of the generators of its parent class group, accessed via `self.list()`. The way you've set this up, elements of an S-class group use the same data structure, but the data which `list()` uses is set completely wrongly: it's set to the exponents of the given ideal in terms of the generators of the class group, but it should be in terms of the generators of the **S-class group**. What you need to do is to store somewhere the expressions for the generators of the S-class group in terms of the generators of the class group (i.e. the matrix of the quotient map) and then multiply the output of `_ideal_class_log` by this.
> 
> This is the sort of stuff that #6449 was intended to solve: quotients of abelian groups should be automatically handled by general code, rather than having to do it by hand in every specific example.

David, you should have been at Sage Days!



---

archive/issue_comments_078858.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nHere's a patch that does the equivalent of `_ideal_class_log` for S-class groups; you might find it useful.",
    "created_at": "2010-06-30T13:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78858",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:11" align="right">comment:11</div>

Here's a patch that does the equivalent of `_ideal_class_log` for S-class groups; you might find it useful.



---

archive/issue_comments_078859.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nHere's patch that finally makes the S-class-group work as a group, on top of Loeffler's patch(in this ticket). Soon to come will be a single patch that gets it all done, and actually has acceptable documentation.",
    "created_at": "2010-07-01T15:42:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78859",
    "user": "https://github.com/sagetrac-stankewicz"
}
```

<div id="comment:12" align="right">comment:12</div>

Here's patch that finally makes the S-class-group work as a group, on top of Loeffler's patch(in this ticket). Soon to come will be a single patch that gets it all done, and actually has acceptable documentation.



---

archive/issue_events_118295.json:
```json
{
    "actor": "https://github.com/annahaensch",
    "created_at": "2010-07-02T20:00:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118295"
}
```



---

archive/issue_events_118296.json:
```json
{
    "actor": "https://github.com/annahaensch",
    "created_at": "2010-07-02T20:00:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118296"
}
```



---

archive/issue_comments_078860.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Apply all three patches in order.\n+trac_9332_v3 should be applied only on trac_9244_ver4\n``````\n",
    "created_at": "2010-07-02T20:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78860",
    "user": "https://github.com/annahaensch"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-Apply all three patches in order.
+trac_9332_v3 should be applied only on trac_9244_ver4
``````




---

archive/issue_comments_078861.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nCorrection: trac_9332_v3 should be applied only on trac_9244_ver4.  Sorry for the confusion, trac_9332_v3 includes changes made in previous patches, so there's no need to apply them.  Cheers.",
    "created_at": "2010-07-02T20:04:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78861",
    "user": "https://github.com/annahaensch"
}
```

<div id="comment:14" align="right">comment:14</div>

Correction: trac_9332_v3 should be applied only on trac_9244_ver4.  Sorry for the confusion, trac_9332_v3 includes changes made in previous patches, so there's no need to apply them.  Cheers.



---

archive/issue_comments_078862.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nLet's clean up this ticket. Shall I delete the patches other than `trac_9332_v3` and `trac_9244_ver4`?",
    "created_at": "2010-07-02T21:20:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78862",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:15" align="right">comment:15</div>

Let's clean up this ticket. Shall I delete the patches other than `trac_9332_v3` and `trac_9244_ver4`?



---

archive/issue_comments_078863.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nAll patches here can be deleted except `trac_9332_v3`. (`trac_9244_ver4` is from another ticket. )",
    "created_at": "2010-07-02T21:36:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78863",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:16" align="right">comment:16</div>

All patches here can be deleted except `trac_9332_v3`. (`trac_9244_ver4` is from another ticket. )



---

archive/issue_comments_078864.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nCleaned up the other one as well.",
    "created_at": "2010-07-02T21:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78864",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:17" align="right">comment:17</div>

Cleaned up the other one as well.



---

archive/issue_comments_078865.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-trac_9332_v3 should be applied only on trac_9244_ver4\n+Depends on #9244.\n``````\n",
    "created_at": "2010-07-02T21:44:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78865",
    "user": "https://github.com/rlmill"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-trac_9332_v3 should be applied only on trac_9244_ver4
+Depends on #9244.
``````




---

archive/issue_events_118297.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-10-31T21:10:14Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118297"
}
```



---

archive/issue_events_118298.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-10-31T21:10:14Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118298"
}
```



---

archive/issue_comments_078866.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nCan we get this ticket moving again?  The one and only patch still here does not apply cleanly to 4.6.rc0, so the first step is to fix that.",
    "created_at": "2010-10-31T21:10:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78866",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:18" align="right">comment:18</div>

Can we get this ticket moving again?  The one and only patch still here does not apply cleanly to 4.6.rc0, so the first step is to fix that.



---

archive/issue_comments_078867.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nI'm uploading a rebased (on sage-4.6) patch which modifies printing in class fields to not print the structure when size is 1, fixes some caching bugs, updates several doctests, etc...\n\nHowever, this happens, and I'm not sure whether this is okay or not:\n\n```\nsage -t sage/rings/number_field/number_field_ideal.py\n**********************************************************************\nFile \"/home/rlmill/sage-4.6/devel/sage-main/sage/rings/number_field/number_field\n_ideal.py\", line 1017:\n    sage: I._S_ideal_class_log([])\nExpected:\n    [3]\nGot:\n    [1]\n**********************************************************************\n```",
    "created_at": "2010-11-25T00:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78867",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:19" align="right">comment:19</div>

I'm uploading a rebased (on sage-4.6) patch which modifies printing in class fields to not print the structure when size is 1, fixes some caching bugs, updates several doctests, etc...

However, this happens, and I'm not sure whether this is okay or not:

```
sage -t sage/rings/number_field/number_field_ideal.py
**********************************************************************
File "/home/rlmill/sage-4.6/devel/sage-main/sage/rings/number_field/number_field
_ideal.py", line 1017:
    sage: I._S_ideal_class_log([])
Expected:
    [3]
Got:
    [1]
**********************************************************************
```



---

archive/issue_comments_078868.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Depends on #9244.\n+\n``````\n",
    "created_at": "2010-11-25T00:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78868",
    "user": "https://github.com/rlmill"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-Depends on #9244.
+
``````




---

archive/issue_comments_078869.json:
```json
{
    "body": "Changed author from **Jim Stankewicz, Erin Beyerstedt, Anna Haensch** to **Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler**",
    "created_at": "2010-11-25T00:01:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78869",
    "user": "https://github.com/rlmill"
}
```

Changed author from **Jim Stankewicz, Erin Beyerstedt, Anna Haensch** to **Jim Stankewicz, Erin Beyerstedt, Anna Haensch, Robert Miller, David Loeffler**



---

archive/issue_events_118299.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-11-25T09:37:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118299"
}
```



---

archive/issue_events_118300.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-11-25T09:37:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118300"
}
```



---

archive/issue_comments_078870.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nI applied the patch (no problems) to 4.6.1.alpha2.  The thing you observed does not happen:\n\n```\nsage: K.<a> = QuadraticField(-14) \nsage: S = K.primes_above(2) \nsage: S\n[Fractional ideal (2, a)]\nsage: I = K.ideal(3, a-1)\nsage: I._S_ideal_class_log(S) \n[1]\nsage: I._S_ideal_class_log([]) \n[1]\n```\n\nI am now testing...",
    "created_at": "2010-11-25T09:37:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78870",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:20" align="right">comment:20</div>

I applied the patch (no problems) to 4.6.1.alpha2.  The thing you observed does not happen:

```
sage: K.<a> = QuadraticField(-14) 
sage: S = K.primes_above(2) 
sage: S
[Fractional ideal (2, a)]
sage: I = K.ideal(3, a-1)
sage: I._S_ideal_class_log(S) 
[1]
sage: I._S_ideal_class_log([]) 
[1]
```

I am now testing...



---

archive/issue_comments_078871.json:
```json
{
    "body": "Reviewer: **John Cremona**",
    "created_at": "2010-11-25T10:15:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78871",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **John Cremona**



---

archive/issue_comments_078872.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nTwo trivial doctest failures \n\n```\nsage -t -long sage/rings/polynomial/polynomial_quotient_ring.py\n**********************************************************************\nFile \"/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/polynomial/polynomial_quotient_ring.py\", line 737:\n    sage: K.class_group()\nExpected:\n    Class group of order 1 with structure  of Number Field in a with defining polynomial x^2 + 3\nGot:\n    Class group of order 1 of Number Field in a with defining polynomial x^2 + 3\n```\nand\n\n```\nsage -t -long sage/rings/number_field/number_field_ideal.py\n**********************************************************************\nFile \"/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/number_field/number_field_ideal.py\", line 1051:\n    sage: I._S_ideal_class_log([])\nExpected:\n    [3]\nGot:\n    [1]\n```\nwhere in both cases the \"Expected \" does not look right anyway!\n\nI am leaving this as needs review since I have not looked closely again at the code, but I can assert that apart from the above two things all (long) tests pass with 4.6.1.alpha2.",
    "created_at": "2010-11-25T10:15:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78872",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:21" align="right">comment:21</div>

Two trivial doctest failures 

```
sage -t -long sage/rings/polynomial/polynomial_quotient_ring.py
**********************************************************************
File "/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/polynomial/polynomial_quotient_ring.py", line 737:
    sage: K.class_group()
Expected:
    Class group of order 1 with structure  of Number Field in a with defining polynomial x^2 + 3
Got:
    Class group of order 1 of Number Field in a with defining polynomial x^2 + 3
```
and

```
sage -t -long sage/rings/number_field/number_field_ideal.py
**********************************************************************
File "/home/jec/sage-4.6.1.alpha2/devel/sage-main/sage/rings/number_field/number_field_ideal.py", line 1051:
    sage: I._S_ideal_class_log([])
Expected:
    [3]
Got:
    [1]
```
where in both cases the "Expected " does not look right anyway!

I am leaving this as needs review since I have not looked closely again at the code, but I can assert that apart from the above two things all (long) tests pass with 4.6.1.alpha2.



---

archive/issue_comments_078873.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nI also believe the actual output is correct. Evidence:\n\n```\nsage: K.<a> = QuadraticField(-14)\nsage: S = K.primes_above(2)\nsage: I = K.ideal(3,a+2)\nsage: I\nFractional ideal (3, a + 2)\nsage: I._ideal_class_log()\n[1]\nsage: I._S_ideal_class_log([])\n[1]\n```\n\nI am uploading a fresh patch, which will fix all the above issues.",
    "created_at": "2010-11-26T15:54:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78873",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:22" align="right">comment:22</div>

I also believe the actual output is correct. Evidence:

```
sage: K.<a> = QuadraticField(-14)
sage: S = K.primes_above(2)
sage: I = K.ideal(3,a+2)
sage: I
Fractional ideal (3, a + 2)
sage: I._ideal_class_log()
[1]
sage: I._S_ideal_class_log([])
[1]
```

I am uploading a fresh patch, which will fix all the above issues.



---

archive/issue_events_118301.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-12-04T18:30:20Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118301"
}
```



---

archive/issue_events_118302.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-12-04T18:30:20Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118302"
}
```



---

archive/issue_comments_078874.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nNew patch is fine!",
    "created_at": "2010-12-04T18:30:20Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78874",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:23" align="right">comment:23</div>

New patch is fine!



---

archive/issue_events_118303.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-12-04T22:33:46Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "milestone_number": null,
    "milestone_title": "sage-4.6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118303"
}
```



---

archive/issue_comments_078875.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nNice patch but you should change the commit message :-)",
    "created_at": "2011-01-13T06:34:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78875",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Nice patch but you should change the commit message :-)



---

archive/issue_events_118304.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-13T06:34:12Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118304"
}
```



---

archive/issue_events_118305.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-13T06:34:12Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118305"
}
```



---

archive/issue_comments_078876.json:
```json
{
    "body": "rebased on sage-4.6.1.alpha2",
    "created_at": "2011-01-14T21:27:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78876",
    "user": "https://github.com/rlmill"
}
```

rebased on sage-4.6.1.alpha2



---

archive/issue_comments_078877.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAttachment: **[trac_9332.patch.gz](https://github.com/sagemath/sage/files/ticket9332/trac_9332.patch.gz)**",
    "created_at": "2011-01-14T21:27:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78877",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:26" align="right">comment:26</div>

Attachment: **[trac_9332.patch.gz](https://github.com/sagemath/sage/files/ticket9332/trac_9332.patch.gz)**



---

archive/issue_events_118306.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-14T21:27:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118306"
}
```



---

archive/issue_events_118307.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2011-01-14T21:27:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118307"
}
```



---

archive/issue_comments_078878.json:
```json
{
    "body": "Merged: **sage-4.6.2.alpha1**",
    "created_at": "2011-01-19T22:20:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9332#issuecomment-78878",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.6.2.alpha1**



---

archive/issue_events_118308.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:20:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118308"
}
```



---

archive/issue_events_118309.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-01-19T22:20:48Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9332",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9332#event-118309"
}
```
