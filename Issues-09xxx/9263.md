# Issue 9263: Some special functions don't work with arbitrary precision

archive/issues_009263.json:
```json
{
    "assignees": [
        "https://github.com/jasongrout",
        "https://github.com/sagetrac-jkantor"
    ],
    "body": "\n```\n----------------------------------------------------------------------\n| Sage Version 4.4.2, Release Date: 2010-05-19                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nsage: n(airy_ai(1),digits=100)\n0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000\n```\n\nClearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.\n\nThe following functions should be changed to a different default backend (mpmath probably):\n* `airy_ai` and `airy_bi` (will be fixed with #12455)\n* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)\n* `spherical_bessel_Y` (same as `spherical_bessel_J`)\n* `spherical_harmonic`\n* the elliptic integrals\n* `spherical_hankel1` and `spherical_hankel2`\n* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)\n* `bessel_K` and `bessel_Y` (now fixed with #4102)\n* `inverse_jacobi`\n\nCC:  @eviatarbach\n\nComponent: **numerical**\n\nReviewer: **Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9263_\n\n",
    "closed_at": "2015-05-19T06:43:17Z",
    "created_at": "2010-06-18T11:33:59Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/bug",
        "https://github.com/sagemath/sage/labels/c%3A%20numerical",
        "https://github.com/sagemath/sage/labels/worksforme"
    ],
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Some special functions don't work with arbitrary precision",
    "type": "issue",
    "updated_at": "2015-05-19T06:43:17Z",
    "url": "https://github.com/sagemath/sage/issues/9263",
    "user": "https://github.com/zimmermann6"
}
```

```
----------------------------------------------------------------------
| Sage Version 4.4.2, Release Date: 2010-05-19                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
sage: n(airy_ai(1),digits=100)
0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000
```

Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.

The following functions should be changed to a different default backend (mpmath probably):
* `airy_ai` and `airy_bi` (will be fixed with #12455)
* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)
* `spherical_bessel_Y` (same as `spherical_bessel_J`)
* `spherical_harmonic`
* the elliptic integrals
* `spherical_hankel1` and `spherical_hankel2`
* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)
* `bessel_K` and `bessel_Y` (now fixed with #4102)
* `inverse_jacobi`

CC:  @eviatarbach

Component: **numerical**

Reviewer: **Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/9263_





---

archive/issue_events_117390.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-06-18T11:33:59Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117390"
}
```



---

archive/issue_events_117391.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-06-18T11:33:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117391"
}
```



---

archive/issue_events_117392.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-06-18T11:33:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117392"
}
```



---

archive/issue_events_117393.json:
```json
{
    "actor": "https://github.com/zimmermann6",
    "created_at": "2010-06-18T11:33:59Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117393"
}
```



---

archive/issue_events_117394.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2010-06-18T11:33:59Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "subject": "https://github.com/zimmermann6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117394"
}
```



---

archive/issue_comments_077949.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\none solution would be to use mpmath:\n\n```\nsage: import mpmath\nsage: mpmath.mp.dps = 100\nsage: mpmath.airyai(1)\nmpf('0.1352924163128814155241474235154663061749441429883307060091020547576335348022657236634871099087486832138')\n```",
    "created_at": "2010-06-18T23:54:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77949",
    "user": "https://github.com/sagetrac-ylchapuy"
}
```

<div id="comment:1" align="right">comment:1</div>

one solution would be to use mpmath:

```
sage: import mpmath
sage: mpmath.mp.dps = 100
sage: mpmath.airyai(1)
mpf('0.1352924163128814155241474235154663061749441429883307060091020547576335348022657236634871099087486832138')
```



---

archive/issue_comments_077950.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nThere appear to be two different problems related to numerical evaluation with Maxima. First, that some functions are locked to float precision. In Maxima:\n\n```\n(%i15) airy_ai(bfloat(%pi)),fpprec:20;\n(%o15)                 airy_ai(3.1415926535897932385b0)\n```\n\nI think it's returning unevaluated because `airy_ai` doesn't know how to operate on `bigfloat`s.\n\nOther functions do know how to operate on `bigfloat`s:\n\n```\n(%i18) bfloat(spherical_bessel_j(4, bfloat(%pi))),fpprec:200;\n(%o18) 6.471630031847746208103870635408583211756194941699504852294921875b-2\n```\n\nBut, the interface is losing precision:\n\n```\nsage: spherical_bessel_J(4, pi.n(digits=1000)).n(digits=100)\n0.06471630031847745712081376723290304653346538543701171875000000000000000000000000000000000000000000000\n```\n\nThis is because Maxima truncates to float precision:\n\n\n```\n(%i20) 3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825,fpprec:200;\n(%o20)                         3.141592653589793\n```\n\nOne way of avoiding this is converting to an exact rational and passing it to `bfloat`, which may not be worth the overhead. Maybe something like the patch in #11643?",
    "created_at": "2013-06-14T08:23:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77950",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:3" align="right">comment:3</div>

There appear to be two different problems related to numerical evaluation with Maxima. First, that some functions are locked to float precision. In Maxima:

```
(%i15) airy_ai(bfloat(%pi)),fpprec:20;
(%o15)                 airy_ai(3.1415926535897932385b0)
```

I think it's returning unevaluated because `airy_ai` doesn't know how to operate on `bigfloat`s.

Other functions do know how to operate on `bigfloat`s:

```
(%i18) bfloat(spherical_bessel_j(4, bfloat(%pi))),fpprec:200;
(%o18) 6.471630031847746208103870635408583211756194941699504852294921875b-2
```

But, the interface is losing precision:

```
sage: spherical_bessel_J(4, pi.n(digits=1000)).n(digits=100)
0.06471630031847745712081376723290304653346538543701171875000000000000000000000000000000000000000000000
```

This is because Maxima truncates to float precision:


```
(%i20) 3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825,fpprec:200;
(%o20)                         3.141592653589793
```

One way of avoiding this is converting to an exact rational and passing it to `bfloat`, which may not be worth the overhead. Maybe something like the patch in #11643?



---

archive/issue_comments_077951.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI believe the \"correct\" solution (for Sage) for now is to use #12455 and mpmath for (at least default) evaluation.  I've cc:ed you on that ticket.",
    "created_at": "2013-06-14T12:13:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77951",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:4" align="right">comment:4</div>

I believe the "correct" solution (for Sage) for now is to use #12455 and mpmath for (at least default) evaluation.  I've cc:ed you on that ticket.



---

archive/issue_comments_077952.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nOh, thank you. I guess there's not much use working on the Maxima problems when mpmath works well. I'll change this ticket to apply to all Maxima-evaluated functions.",
    "created_at": "2013-06-14T18:24:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77952",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:5" align="right">comment:5</div>

Oh, thank you. I guess there's not much use working on the Maxima problems when mpmath works well. I'll change this ticket to apply to all Maxima-evaluated functions.



---

archive/issue_events_117395.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20basic%20arithmetic",
    "label_color": "0000ff",
    "label_name": "c: basic arithmetic",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117395"
}
```



---

archive/issue_events_117396.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20numerical",
    "label_color": "0000ff",
    "label_name": "c: numerical",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117396"
}
```



---

archive/issue_comments_077953.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -7,11 +7,13 @@\n sage: n(airy_ai(1),digits=100)\n 0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000\n ```\n-Clearly the last digits are wrong. It looks like Sage only knows how\n-to compute Ai(x) in double precision, and then extended the double\n-precision result to 100 digits.\n \n-This is a *defect*: an error should be raised if the target precision cannot be attained (or Sage should be able to compute\n-Ai(x) to arbitrary precision).\n+Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.\n \n-I guess this problem concerns other functions than Ai.\n+The following functions should be changed to a different default backend (mpmath probably):\n+* `airy_ai`\n+* `airy_bi`\n+* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n+* `spherical_bessel_y` (same as `spherical_bessel_j`)\n+* `spherical_harmonic`\n+* \n``````\n",
    "created_at": "2013-06-14T18:32:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77953",
    "user": "https://github.com/eviatarbach"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -7,11 +7,13 @@
 sage: n(airy_ai(1),digits=100)
 0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000
 ```
-Clearly the last digits are wrong. It looks like Sage only knows how
-to compute Ai(x) in double precision, and then extended the double
-precision result to 100 digits.
 
-This is a *defect*: an error should be raised if the target precision cannot be attained (or Sage should be able to compute
-Ai(x) to arbitrary precision).
+Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.
 
-I guess this problem concerns other functions than Ai.
+The following functions should be changed to a different default backend (mpmath probably):
+* `airy_ai`
+* `airy_bi`
+* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
+* `spherical_bessel_y` (same as `spherical_bessel_j`)
+* `spherical_harmonic`
+* 
``````




---

archive/issue_events_117397.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "title_is": "Maxima-evaluated functions don't work with arbitrary precision",
    "title_was": "airy_ai yields wrong results in arbitrary precision",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117397"
}
```



---

archive/issue_events_117398.json:
```json
{
    "actor": "https://github.com/aghitza",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "unassigned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "subject": "https://github.com/eviatarbach",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117398"
}
```



---

archive/issue_events_117399.json:
```json
{
    "actor": "https://github.com/jasongrout",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "subject": "https://github.com/eviatarbach",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117399"
}
```



---

archive/issue_events_117400.json:
```json
{
    "actor": "https://github.com/sagetrac-jkantor",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "subject": "https://github.com/eviatarbach",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117400"
}
```



---

archive/issue_comments_077954.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,4 +16,3 @@\n * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n * `spherical_bessel_y` (same as `spherical_bessel_j`)\n * `spherical_harmonic`\n-* \n``````\n",
    "created_at": "2013-06-14T18:33:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77954",
    "user": "https://github.com/eviatarbach"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,4 +16,3 @@
 * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
 * `spherical_bessel_y` (same as `spherical_bessel_j`)
 * `spherical_harmonic`
-* 
``````




---

archive/issue_comments_077955.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThat is a good change.  However, we don't have that many of those left, and so probably it will have to wait until we reliably have a keyword for evaluation algorithm.",
    "created_at": "2013-06-14T18:40:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77955",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:8" align="right">comment:8</div>

That is a good change.  However, we don't have that many of those left, and so probably it will have to wait until we reliably have a keyword for evaluation algorithm.



---

archive/issue_comments_077956.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nMaybe there is a way to sense whether we are passing in something other than regular precision and then ask Maxima to use a bfloat.",
    "created_at": "2013-06-14T18:41:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77956",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:9" align="right">comment:9</div>

Maybe there is a way to sense whether we are passing in something other than regular precision and then ask Maxima to use a bfloat.



---

archive/issue_comments_077957.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nDo you mean #12289? What would be the problem with changing the backend before that's implemented though?\n\nActually, this ticket applies to many more functions than I thought initially. I added them to the description.\n\nI also changed it again to apply to all special functions that don't work with arbitrary precision.",
    "created_at": "2013-06-14T19:09:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77957",
    "user": "https://github.com/eviatarbach"
}
```

<div id="comment:10" align="right">comment:10</div>

Do you mean #12289? What would be the problem with changing the backend before that's implemented though?

Actually, this ticket applies to many more functions than I thought initially. I added them to the description.

I also changed it again to apply to all special functions that don't work with arbitrary precision.



---

archive/issue_comments_077958.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -11,8 +11,12 @@\n Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.\n \n The following functions should be changed to a different default backend (mpmath probably):\n-* `airy_ai`\n-* `airy_bi`\n+* `airy_ai` and `airy_bi` (will be fixed with #12455)\n * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n * `spherical_bessel_y` (same as `spherical_bessel_j`)\n * `spherical_harmonic`\n+* the elliptic integrals\n+* `spherical_hankel1` and `spherical_hankel2`\n+* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)\n+* `bessel_K` and `bessel_Y` (will be fixed with #4102)\n+* `inverse_jacobi`\n``````\n",
    "created_at": "2013-06-14T19:09:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77958",
    "user": "https://github.com/eviatarbach"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -11,8 +11,12 @@
 Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.
 
 The following functions should be changed to a different default backend (mpmath probably):
-* `airy_ai`
-* `airy_bi`
+* `airy_ai` and `airy_bi` (will be fixed with #12455)
 * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
 * `spherical_bessel_y` (same as `spherical_bessel_j`)
 * `spherical_harmonic`
+* the elliptic integrals
+* `spherical_hankel1` and `spherical_hankel2`
+* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)
+* `bessel_K` and `bessel_Y` (will be fixed with #4102)
+* `inverse_jacobi`
``````




---

archive/issue_events_117401.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T19:09:39Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "title_is": "Some special functions don't work with arbitrary precision",
    "title_was": "Maxima-evaluated functions don't work with arbitrary precision",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117401"
}
```



---

archive/issue_comments_077959.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\n> Do you mean #12289? What would be the problem with changing the backend before that's implemented though?\n\nNo problem at all, I just meant that it would make more sense to switch them to mpmath first, and then worry about getting Maxima to have the right precision after that ticket.  Though I guess even spherical Bessel hasn't been implemented in mpmath yet...",
    "created_at": "2013-06-14T19:22:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77959",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:11" align="right">comment:11</div>

> Do you mean #12289? What would be the problem with changing the backend before that's implemented though?

No problem at all, I just meant that it would make more sense to switch them to mpmath first, and then worry about getting Maxima to have the right precision after that ticket.  Though I guess even spherical Bessel hasn't been implemented in mpmath yet...



---

archive/issue_events_117402.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117402"
}
```



---

archive/issue_events_117403.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117403"
}
```



---

archive/issue_comments_077960.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -12,8 +12,8 @@\n \n The following functions should be changed to a different default backend (mpmath probably):\n * `airy_ai` and `airy_bi` (will be fixed with #12455)\n-* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n-* `spherical_bessel_y` (same as `spherical_bessel_j`)\n+* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)\n+* `spherical_bessel_Y` (same as `spherical_bessel_j`)\n * `spherical_harmonic`\n * the elliptic integrals\n * `spherical_hankel1` and `spherical_hankel2`\n``````\n",
    "created_at": "2013-08-24T12:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77960",
    "user": "https://github.com/zimmermann6"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -12,8 +12,8 @@
 
 The following functions should be changed to a different default backend (mpmath probably):
 * `airy_ai` and `airy_bi` (will be fixed with #12455)
-* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
-* `spherical_bessel_y` (same as `spherical_bessel_j`)
+* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)
+* `spherical_bessel_Y` (same as `spherical_bessel_j`)
 * `spherical_harmonic`
 * the elliptic integrals
 * `spherical_hankel1` and `spherical_hankel2`
``````




---

archive/issue_comments_077961.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n The following functions should be changed to a different default backend (mpmath probably):\n * `airy_ai` and `airy_bi` (will be fixed with #12455)\n * `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)\n-* `spherical_bessel_Y` (same as `spherical_bessel_j`)\n+* `spherical_bessel_Y` (same as `spherical_bessel_J`)\n * `spherical_harmonic`\n * the elliptic integrals\n * `spherical_hankel1` and `spherical_hankel2`\n``````\n",
    "created_at": "2013-08-24T12:51:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77961",
    "user": "https://github.com/zimmermann6"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 The following functions should be changed to a different default backend (mpmath probably):
 * `airy_ai` and `airy_bi` (will be fixed with #12455)
 * `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)
-* `spherical_bessel_Y` (same as `spherical_bessel_j`)
+* `spherical_bessel_Y` (same as `spherical_bessel_J`)
 * `spherical_harmonic`
 * the elliptic integrals
 * `spherical_hankel1` and `spherical_hankel2`
``````




---

archive/issue_comments_077962.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nabout `hypergeometric_U`, the documentation (in Sage 5.11) says that Pari is the default, contrary to what is said in the description of this ticket. Which one is correct?\n\nPaul",
    "created_at": "2013-08-24T12:55:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77962",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:15" align="right">comment:15</div>

about `hypergeometric_U`, the documentation (in Sage 5.11) says that Pari is the default, contrary to what is said in the description of this ticket. Which one is correct?

Paul



---

archive/issue_comments_077963.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,5 +18,5 @@\n * the elliptic integrals\n * `spherical_hankel1` and `spherical_hankel2`\n * `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)\n-* `bessel_K` and `bessel_Y` (will be fixed with #4102)\n+* `bessel_K` and `bessel_Y` (now fixed with #4102)\n * `inverse_jacobi`\n``````\n",
    "created_at": "2013-08-24T12:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77963",
    "user": "https://github.com/zimmermann6"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,5 +18,5 @@
 * the elliptic integrals
 * `spherical_hankel1` and `spherical_hankel2`
 * `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)
-* `bessel_K` and `bessel_Y` (will be fixed with #4102)
+* `bessel_K` and `bessel_Y` (now fixed with #4102)
 * `inverse_jacobi`
``````




---

archive/issue_comments_077964.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\n`bessel_K` and `bessel_Y` are fixed in Sage 5.11 thanks to #4102, thus I update the description:\n\n```\nsage: n(bessel_K(1,2), prec=100)\n0.13986588181652242728459880704\nsage: n(bessel_Y(1,2), prec=100)\n-0.10703243154093754688837077228\n```\nPaul",
    "created_at": "2013-08-24T12:58:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77964",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:16" align="right">comment:16</div>

`bessel_K` and `bessel_Y` are fixed in Sage 5.11 thanks to #4102, thus I update the description:

```
sage: n(bessel_K(1,2), prec=100)
0.13986588181652242728459880704
sage: n(bessel_Y(1,2), prec=100)
-0.10703243154093754688837077228
```
Paul



---

archive/issue_events_117404.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117404"
}
```



---

archive/issue_events_117405.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117405"
}
```



---

archive/issue_events_117406.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117406"
}
```



---

archive/issue_events_117407.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117407"
}
```



---

archive/issue_events_117408.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117408"
}
```



---

archive/issue_events_117409.json:
```json
{
    "actor": "https://github.com/sagetrac-vbraun-spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117409"
}
```



---

archive/issue_events_117410.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone_number": null,
    "milestone_title": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117410"
}
```



---

archive/issue_comments_077965.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nWorks for me.",
    "created_at": "2015-05-06T09:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77965",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:20" align="right">comment:20</div>

Works for me.



---

archive/issue_comments_077966.json:
```json
{
    "body": "Reviewer: **Jeroen Demeyer**",
    "created_at": "2015-05-06T09:54:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77966",
    "user": "https://github.com/jdemeyer"
}
```

Reviewer: **Jeroen Demeyer**



---

archive/issue_events_117411.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117411"
}
```



---

archive/issue_events_117412.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117412"
}
```



---

archive/issue_events_117413.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117413"
}
```



---

archive/issue_comments_077967.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\n`hypergeometric_U` is strange, since the answer is always 53 bits:\n\n```\nsage: hypergeometric_U(1,2,3)\n0.333333333333333\nsage: R = RealField(1000)\nsage: hypergeometric_U(R(1), R(2), R(3))\n0.333333333333333\nsage: hypergeometric_U(R(1), R(2), R(3)).n(100)\n...\nTypeError: cannot approximate to a precision of 100 bits, use at most 53 bits\n```\n\nThe others work properly.",
    "created_at": "2015-05-06T10:00:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77967",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

`hypergeometric_U` is strange, since the answer is always 53 bits:

```
sage: hypergeometric_U(1,2,3)
0.333333333333333
sage: R = RealField(1000)
sage: hypergeometric_U(R(1), R(2), R(3))
0.333333333333333
sage: hypergeometric_U(R(1), R(2), R(3)).n(100)
...
TypeError: cannot approximate to a precision of 100 bits, use at most 53 bits
```

The others work properly.



---

archive/issue_comments_077968.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nAnd the issue with `hypergeometric_U` is #14896.",
    "created_at": "2015-05-06T10:06:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77968",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:23" align="right">comment:23</div>

And the issue with `hypergeometric_U` is #14896.



---

archive/issue_comments_077969.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nwith Sage 6.0 I get:\n\n```\nsage: R = RealField(1000)\nsage: hypergeometric_U(R(1), R(2), R(3)).n(100)\n0.33333333333333331482961625625\nsage: hypergeometric_U(1,2,3).n(100)\n0.33333333333333331482961625625\n```\nMaybe a regression?",
    "created_at": "2015-05-06T11:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77969",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:24" align="right">comment:24</div>

with Sage 6.0 I get:

```
sage: R = RealField(1000)
sage: hypergeometric_U(R(1), R(2), R(3)).n(100)
0.33333333333333331482961625625
sage: hypergeometric_U(1,2,3).n(100)
0.33333333333333331482961625625
```
Maybe a regression?



---

archive/issue_comments_077970.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nis the issue with `airy_ai` fixed? I still get with Sage 6.0:\n\n```\nsage: n(airy_ai(1),digits=75)\n0.135292416312881413897883930985699407756328582763671875000000000000000000000\n```",
    "created_at": "2015-05-06T11:53:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77970",
    "user": "https://github.com/zimmermann6"
}
```

<div id="comment:25" align="right">comment:25</div>

is the issue with `airy_ai` fixed? I still get with Sage 6.0:

```
sage: n(airy_ai(1),digits=75)
0.135292416312881413897883930985699407756328582763671875000000000000000000000
```



---

archive/issue_comments_077971.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nWell, Sage 6.0 is ancient.\n\nWith 6.7.beta4:\n\n```\nsage: n(airy_ai(1),digits=75)\n0.135292416312881415524147423515466306174944142988330706009102054757633534802\n```\nand\n\n```\nsage: hypergeometric_U(1,2,3).n(100)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-7c7c457a86be> in <module>()\n----> 1 hypergeometric_U(Integer(1),Integer(2),Integer(3)).n(Integer(100))\n\n/usr/local/src/sage-config/src/sage/structure/element.pyx in sage.structure.element.Element.numerical_approx (build/cythonized/sage/structure/element.c:7437)()\n    744         \"\"\"\n    745         from sage.misc.functional import numerical_approx\n--> 746         return numerical_approx(self, prec=prec, digits=digits,\n    747                                 algorithm=algorithm)\n    748     n = numerical_approx\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/functional.pyc in numerical_approx(x, prec, digits, algorithm)\n   1329 \n   1330     if prec > inprec:\n-> 1331         raise TypeError(\"cannot approximate to a precision of %s bits, use at most %s bits\" % (prec, inprec))\n   1332 \n   1333     # The issue is not precision, try conversion instead\n\nTypeError: cannot approximate to a precision of 100 bits, use at most 53 bits\n```",
    "created_at": "2015-05-06T12:14:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77971",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:26" align="right">comment:26</div>

Well, Sage 6.0 is ancient.

With 6.7.beta4:

```
sage: n(airy_ai(1),digits=75)
0.135292416312881415524147423515466306174944142988330706009102054757633534802
```
and

```
sage: hypergeometric_U(1,2,3).n(100)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-7c7c457a86be> in <module>()
----> 1 hypergeometric_U(Integer(1),Integer(2),Integer(3)).n(Integer(100))

/usr/local/src/sage-config/src/sage/structure/element.pyx in sage.structure.element.Element.numerical_approx (build/cythonized/sage/structure/element.c:7437)()
    744         """
    745         from sage.misc.functional import numerical_approx
--> 746         return numerical_approx(self, prec=prec, digits=digits,
    747                                 algorithm=algorithm)
    748     n = numerical_approx

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/functional.pyc in numerical_approx(x, prec, digits, algorithm)
   1329 
   1330     if prec > inprec:
-> 1331         raise TypeError("cannot approximate to a precision of %s bits, use at most %s bits" % (prec, inprec))
   1332 
   1333     # The issue is not precision, try conversion instead

TypeError: cannot approximate to a precision of 100 bits, use at most 53 bits
```



---

archive/issue_comments_077972.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nNote that Maxima functions we didn't usually have a good precision interface with, if that is what is going on with the hgu.",
    "created_at": "2015-05-06T15:20:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-77972",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:27" align="right">comment:27</div>

Note that Maxima functions we didn't usually have a good precision interface with, if that is what is going on with the hgu.



---

archive/issue_events_117414.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T06:43:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117414"
}
```



---

archive/issue_events_117415.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T06:43:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117415"
}
```



---

archive/issue_events_117416.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T06:43:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117416"
}
```



---

archive/issue_events_117417.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T06:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "https://github.com/sagemath/sage/labels/worksforme",
    "label_color": "c6c6c6",
    "label_name": "worksforme",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-117417"
}
```
