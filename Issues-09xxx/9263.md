# Issue 9263: Some special functions don't work with arbitrary precision

archive/issues_009263.json:
```json
{
    "body": "\n```\n----------------------------------------------------------------------\n| Sage Version 4.4.2, Release Date: 2010-05-19                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nsage: n(airy_ai(1),digits=100)\n0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000\n```\n\nClearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.\n\nThe following functions should be changed to a different default backend (mpmath probably):\n* `airy_ai` and `airy_bi` (will be fixed with #12455)\n* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)\n* `spherical_bessel_Y` (same as `spherical_bessel_J`)\n* `spherical_harmonic`\n* the elliptic integrals\n* `spherical_hankel1` and `spherical_hankel2`\n* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)\n* `bessel_K` and `bessel_Y` (now fixed with #4102)\n* `inverse_jacobi`\n\n**Assignee:** @jasongrout, jkantor\n\n**CC:**  @eviatarbach\n\n**Reviewer:** Jeroen Demeyer\n\nIssue created by migration from https://trac.sagemath.org/ticket/9263\n\n",
    "closed_at": "2015-05-19T06:43:17Z",
    "created_at": "2010-06-18T11:33:59Z",
    "labels": [
        "component: numerical",
        "bug",
        "worksforme",
        "invalid"
    ],
    "title": "Some special functions don't work with arbitrary precision",
    "type": "issue",
    "url": "https://github.com/sagemath/sage/issues/9263",
    "user": "https://github.com/zimmermann6"
}
```

```
----------------------------------------------------------------------
| Sage Version 4.4.2, Release Date: 2010-05-19                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
sage: n(airy_ai(1),digits=100)
0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000
```

Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.

The following functions should be changed to a different default backend (mpmath probably):
* `airy_ai` and `airy_bi` (will be fixed with #12455)
* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)
* `spherical_bessel_Y` (same as `spherical_bessel_J`)
* `spherical_harmonic`
* the elliptic integrals
* `spherical_hankel1` and `spherical_hankel2`
* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)
* `bessel_K` and `bessel_Y` (now fixed with #4102)
* `inverse_jacobi`

**Assignee:** @jasongrout, jkantor

**CC:**  @eviatarbach

**Reviewer:** Jeroen Demeyer

Issue created by migration from https://trac.sagemath.org/ticket/9263





---

archive/issue_comments_079817.json:
```json
{
    "body": "<a id='comment:1'></a>\none solution would be to use mpmath:\n\n```\nsage: import mpmath\nsage: mpmath.mp.dps = 100\nsage: mpmath.airyai(1)\nmpf('0.1352924163128814155241474235154663061749441429883307060091020547576335348022657236634871099087486832138')\n```",
    "created_at": "2010-06-18T23:54:38Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79817",
    "user": "https://trac.sagemath.org/admin/accounts/users/ylchapuy"
}
```

<a id='comment:1'></a>
one solution would be to use mpmath:

```
sage: import mpmath
sage: mpmath.mp.dps = 100
sage: mpmath.airyai(1)
mpf('0.1352924163128814155241474235154663061749441429883307060091020547576335348022657236634871099087486832138')
```



---

archive/issue_comments_079818.json:
```json
{
    "body": "<a id='comment:3'></a>\nThere appear to be two different problems related to numerical evaluation with Maxima. First, that some functions are locked to float precision. In Maxima:\n\n```\n(%i15) airy_ai(bfloat(%pi)),fpprec:20;\n(%o15)                 airy_ai(3.1415926535897932385b0)\n```\n\nI think it's returning unevaluated because `airy_ai` doesn't know how to operate on `bigfloat`s.\n\nOther functions do know how to operate on `bigfloat`s:\n\n```\n(%i18) bfloat(spherical_bessel_j(4, bfloat(%pi))),fpprec:200;\n(%o18) 6.471630031847746208103870635408583211756194941699504852294921875b-2\n```\n\nBut, the interface is losing precision:\n\n```\nsage: spherical_bessel_J(4, pi.n(digits=1000)).n(digits=100)\n0.06471630031847745712081376723290304653346538543701171875000000000000000000000000000000000000000000000\n```\n\nThis is because Maxima truncates to float precision:\n\n\n```\n(%i20) 3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825,fpprec:200;\n(%o20)                         3.141592653589793\n```\n\nOne way of avoiding this is converting to an exact rational and passing it to `bfloat`, which may not be worth the overhead. Maybe something like the patch in #11643?",
    "created_at": "2013-06-14T08:23:07Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79818",
    "user": "https://github.com/eviatarbach"
}
```

<a id='comment:3'></a>
There appear to be two different problems related to numerical evaluation with Maxima. First, that some functions are locked to float precision. In Maxima:

```
(%i15) airy_ai(bfloat(%pi)),fpprec:20;
(%o15)                 airy_ai(3.1415926535897932385b0)
```

I think it's returning unevaluated because `airy_ai` doesn't know how to operate on `bigfloat`s.

Other functions do know how to operate on `bigfloat`s:

```
(%i18) bfloat(spherical_bessel_j(4, bfloat(%pi))),fpprec:200;
(%o18) 6.471630031847746208103870635408583211756194941699504852294921875b-2
```

But, the interface is losing precision:

```
sage: spherical_bessel_J(4, pi.n(digits=1000)).n(digits=100)
0.06471630031847745712081376723290304653346538543701171875000000000000000000000000000000000000000000000
```

This is because Maxima truncates to float precision:


```
(%i20) 3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825,fpprec:200;
(%o20)                         3.141592653589793
```

One way of avoiding this is converting to an exact rational and passing it to `bfloat`, which may not be worth the overhead. Maybe something like the patch in #11643?



---

archive/issue_comments_079819.json:
```json
{
    "body": "<a id='comment:4'></a>\nI believe the \"correct\" solution (for Sage) for now is to use #12455 and mpmath for (at least default) evaluation.  I've cc:ed you on that ticket.",
    "created_at": "2013-06-14T12:13:39Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79819",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:4'></a>
I believe the "correct" solution (for Sage) for now is to use #12455 and mpmath for (at least default) evaluation.  I've cc:ed you on that ticket.



---

archive/issue_comments_079820.json:
```json
{
    "body": "<a id='comment:5'></a>\nOh, thank you. I guess there's not much use working on the Maxima problems when mpmath works well. I'll change this ticket to apply to all Maxima-evaluated functions.",
    "created_at": "2013-06-14T18:24:56Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79820",
    "user": "https://github.com/eviatarbach"
}
```

<a id='comment:5'></a>
Oh, thank you. I guess there's not much use working on the Maxima problems when mpmath works well. I'll change this ticket to apply to all Maxima-evaluated functions.



---

archive/issue_events_067686.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "component: basic arithmetic",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67686"
}
```



---

archive/issue_events_067687.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "component: numerical",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67687"
}
```



---

archive/issue_comments_079821.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -7,11 +7,13 @@\n sage: n(airy_ai(1),digits=100)\n 0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000\n ```\n-Clearly the last digits are wrong. It looks like Sage only knows how\n-to compute Ai(x) in double precision, and then extended the double\n-precision result to 100 digits.\n \n-This is a *defect*: an error should be raised if the target precision cannot be attained (or Sage should be able to compute\n-Ai(x) to arbitrary precision).\n+Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.\n \n-I guess this problem concerns other functions than Ai.\n+The following functions should be changed to a different default backend (mpmath probably):\n+* `airy_ai`\n+* `airy_bi`\n+* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n+* `spherical_bessel_y` (same as `spherical_bessel_j`)\n+* `spherical_harmonic`\n+* \n``````\n",
    "created_at": "2013-06-14T18:32:46Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79821",
    "user": "https://github.com/eviatarbach"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -7,11 +7,13 @@
 sage: n(airy_ai(1),digits=100)
 0.1352924163128813861423083153567858971655368804931640625000000000000000000000000000000000000000000000
 ```
-Clearly the last digits are wrong. It looks like Sage only knows how
-to compute Ai(x) in double precision, and then extended the double
-precision result to 100 digits.
 
-This is a *defect*: an error should be raised if the target precision cannot be attained (or Sage should be able to compute
-Ai(x) to arbitrary precision).
+Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.
 
-I guess this problem concerns other functions than Ai.
+The following functions should be changed to a different default backend (mpmath probably):
+* `airy_ai`
+* `airy_bi`
+* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
+* `spherical_bessel_y` (same as `spherical_bessel_j`)
+* `spherical_harmonic`
+* 
``````




---

archive/issue_events_067688.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T18:32:46Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "rename": {
        "from": "airy_ai yields wrong results in arbitrary precision",
        "to": "Maxima-evaluated functions don't work with arbitrary precision"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67688"
}
```



---

archive/issue_comments_079822.json:
```json
{
    "body": "**Changing assignee** from @aghitza to @jasongrout, jkantor.",
    "created_at": "2013-06-14T18:32:46Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79822",
    "user": "https://github.com/eviatarbach"
}
```

**Changing assignee** from @aghitza to @jasongrout, jkantor.



---

archive/issue_comments_079823.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -16,4 +16,3 @@\n * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n * `spherical_bessel_y` (same as `spherical_bessel_j`)\n * `spherical_harmonic`\n-* \n``````\n",
    "created_at": "2013-06-14T18:33:52Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79823",
    "user": "https://github.com/eviatarbach"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -16,4 +16,3 @@
 * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
 * `spherical_bessel_y` (same as `spherical_bessel_j`)
 * `spherical_harmonic`
-* 
``````




---

archive/issue_comments_079824.json:
```json
{
    "body": "<a id='comment:8'></a>\nThat is a good change.  However, we don't have that many of those left, and so probably it will have to wait until we reliably have a keyword for evaluation algorithm.",
    "created_at": "2013-06-14T18:40:29Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79824",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>
That is a good change.  However, we don't have that many of those left, and so probably it will have to wait until we reliably have a keyword for evaluation algorithm.



---

archive/issue_comments_079825.json:
```json
{
    "body": "<a id='comment:9'></a>\nMaybe there is a way to sense whether we are passing in something other than regular precision and then ask Maxima to use a bfloat.",
    "created_at": "2013-06-14T18:41:36Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79825",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:9'></a>
Maybe there is a way to sense whether we are passing in something other than regular precision and then ask Maxima to use a bfloat.



---

archive/issue_comments_079826.json:
```json
{
    "body": "<a id='comment:10'></a>\nDo you mean #12289? What would be the problem with changing the backend before that's implemented though?\n\nActually, this ticket applies to many more functions than I thought initially. I added them to the description.\n\nI also changed it again to apply to all special functions that don't work with arbitrary precision.",
    "created_at": "2013-06-14T19:09:39Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79826",
    "user": "https://github.com/eviatarbach"
}
```

<a id='comment:10'></a>
Do you mean #12289? What would be the problem with changing the backend before that's implemented though?

Actually, this ticket applies to many more functions than I thought initially. I added them to the description.

I also changed it again to apply to all special functions that don't work with arbitrary precision.



---

archive/issue_comments_079827.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -11,8 +11,12 @@\n Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.\n \n The following functions should be changed to a different default backend (mpmath probably):\n-* `airy_ai`\n-* `airy_bi`\n+* `airy_ai` and `airy_bi` (will be fixed with #12455)\n * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n * `spherical_bessel_y` (same as `spherical_bessel_j`)\n * `spherical_harmonic`\n+* the elliptic integrals\n+* `spherical_hankel1` and `spherical_hankel2`\n+* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)\n+* `bessel_K` and `bessel_Y` (will be fixed with #4102)\n+* `inverse_jacobi`\n``````\n",
    "created_at": "2013-06-14T19:09:39Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79827",
    "user": "https://github.com/eviatarbach"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -11,8 +11,12 @@
 Clearly the last digits are wrong. This is due to Maxima; currently we are not giving it bigfloats, and in any case some of the functions don't work with arbitrary precision.
 
 The following functions should be changed to a different default backend (mpmath probably):
-* `airy_ai`
-* `airy_bi`
+* `airy_ai` and `airy_bi` (will be fixed with #12455)
 * `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
 * `spherical_bessel_y` (same as `spherical_bessel_j`)
 * `spherical_harmonic`
+* the elliptic integrals
+* `spherical_hankel1` and `spherical_hankel2`
+* `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)
+* `bessel_K` and `bessel_Y` (will be fixed with #4102)
+* `inverse_jacobi`
``````




---

archive/issue_events_067689.json:
```json
{
    "actor": "https://github.com/eviatarbach",
    "created_at": "2013-06-14T19:09:39Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "rename": {
        "from": "Maxima-evaluated functions don't work with arbitrary precision",
        "to": "Some special functions don't work with arbitrary precision"
    },
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67689"
}
```



---

archive/issue_comments_079828.json:
```json
{
    "body": "<a id='comment:11'></a>\n> Do you mean #12289? What would be the problem with changing the backend before that's implemented though?\n\nNo problem at all, I just meant that it would make more sense to switch them to mpmath first, and then worry about getting Maxima to have the right precision after that ticket.  Though I guess even spherical Bessel hasn't been implemented in mpmath yet...",
    "created_at": "2013-06-14T19:22:03Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79828",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:11'></a>
> Do you mean #12289? What would be the problem with changing the backend before that's implemented though?

No problem at all, I just meant that it would make more sense to switch them to mpmath first, and then worry about getting Maxima to have the right precision after that ticket.  Though I guess even spherical Bessel hasn't been implemented in mpmath yet...



---

archive/issue_events_067690.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67690"
}
```



---

archive/issue_events_067691.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67691"
}
```



---

archive/issue_comments_079829.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -12,8 +12,8 @@\n \n The following functions should be changed to a different default backend (mpmath probably):\n * `airy_ai` and `airy_bi` (will be fixed with #12455)\n-* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)\n-* `spherical_bessel_y` (same as `spherical_bessel_j`)\n+* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)\n+* `spherical_bessel_Y` (same as `spherical_bessel_j`)\n * `spherical_harmonic`\n * the elliptic integrals\n * `spherical_hankel1` and `spherical_hankel2`\n``````\n",
    "created_at": "2013-08-24T12:50:06Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79829",
    "user": "https://github.com/zimmermann6"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -12,8 +12,8 @@
 
 The following functions should be changed to a different default backend (mpmath probably):
 * `airy_ai` and `airy_bi` (will be fixed with #12455)
-* `spherical_bessel_j` (it also has a SciPy option, but it also truncates the precision)
-* `spherical_bessel_y` (same as `spherical_bessel_j`)
+* `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)
+* `spherical_bessel_Y` (same as `spherical_bessel_j`)
 * `spherical_harmonic`
 * the elliptic integrals
 * `spherical_hankel1` and `spherical_hankel2`
``````




---

archive/issue_comments_079830.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -13,7 +13,7 @@\n The following functions should be changed to a different default backend (mpmath probably):\n * `airy_ai` and `airy_bi` (will be fixed with #12455)\n * `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)\n-* `spherical_bessel_Y` (same as `spherical_bessel_j`)\n+* `spherical_bessel_Y` (same as `spherical_bessel_J`)\n * `spherical_harmonic`\n * the elliptic integrals\n * `spherical_hankel1` and `spherical_hankel2`\n``````\n",
    "created_at": "2013-08-24T12:51:04Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79830",
    "user": "https://github.com/zimmermann6"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -13,7 +13,7 @@
 The following functions should be changed to a different default backend (mpmath probably):
 * `airy_ai` and `airy_bi` (will be fixed with #12455)
 * `spherical_bessel_J` (it also has a SciPy option, but it also truncates the precision)
-* `spherical_bessel_Y` (same as `spherical_bessel_j`)
+* `spherical_bessel_Y` (same as `spherical_bessel_J`)
 * `spherical_harmonic`
 * the elliptic integrals
 * `spherical_hankel1` and `spherical_hankel2`
``````




---

archive/issue_comments_079831.json:
```json
{
    "body": "<a id='comment:15'></a>\nabout `hypergeometric_U`, the documentation (in Sage 5.11) says that Pari is the default, contrary to what is said in the description of this ticket. Which one is correct?\n\nPaul",
    "created_at": "2013-08-24T12:55:03Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79831",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:15'></a>
about `hypergeometric_U`, the documentation (in Sage 5.11) says that Pari is the default, contrary to what is said in the description of this ticket. Which one is correct?

Paul



---

archive/issue_comments_079832.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -18,5 +18,5 @@\n * the elliptic integrals\n * `spherical_hankel1` and `spherical_hankel2`\n * `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)\n-* `bessel_K` and `bessel_Y` (will be fixed with #4102)\n+* `bessel_K` and `bessel_Y` (now fixed with #4102)\n * `inverse_jacobi`\n``````\n",
    "created_at": "2013-08-24T12:58:17Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79832",
    "user": "https://github.com/zimmermann6"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -18,5 +18,5 @@
 * the elliptic integrals
 * `spherical_hankel1` and `spherical_hankel2`
 * `hypergeometric_U` (PARI is implemented and works with arbitrary precision, but it's not the default)
-* `bessel_K` and `bessel_Y` (will be fixed with #4102)
+* `bessel_K` and `bessel_Y` (now fixed with #4102)
 * `inverse_jacobi`
``````




---

archive/issue_comments_079833.json:
```json
{
    "body": "<a id='comment:16'></a>\n`bessel_K` and `bessel_Y` are fixed in Sage 5.11 thanks to #4102, thus I update the description:\n\n```\nsage: n(bessel_K(1,2), prec=100)\n0.13986588181652242728459880704\nsage: n(bessel_Y(1,2), prec=100)\n-0.10703243154093754688837077228\n```\nPaul",
    "created_at": "2013-08-24T12:58:17Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79833",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:16'></a>
`bessel_K` and `bessel_Y` are fixed in Sage 5.11 thanks to #4102, thus I update the description:

```
sage: n(bessel_K(1,2), prec=100)
0.13986588181652242728459880704
sage: n(bessel_Y(1,2), prec=100)
-0.10703243154093754688837077228
```
Paul



---

archive/issue_events_067692.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-6.1",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67692"
}
```



---

archive/issue_events_067693.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-01-30T21:20:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67693"
}
```



---

archive/issue_events_067694.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-6.2",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67694"
}
```



---

archive/issue_events_067695.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-05-06T15:20:58Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67695"
}
```



---

archive/issue_events_067696.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-6.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67696"
}
```



---

archive/issue_events_067697.json:
```json
{
    "actor": "https://trac.sagemath.org/admin/accounts/users/vbraun_spam",
    "created_at": "2014-08-10T16:51:03Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67697"
}
```



---

archive/issue_events_067698.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:48Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "milestone": "sage-6.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67698"
}
```



---

archive/issue_comments_079834.json:
```json
{
    "body": "<a id='comment:20'></a>\nWorks for me.",
    "created_at": "2015-05-06T09:54:48Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79834",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:20'></a>
Works for me.



---

archive/issue_comments_079835.json:
```json
{
    "body": "**Reviewer:** Jeroen Demeyer",
    "created_at": "2015-05-06T09:54:48Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79835",
    "user": "https://github.com/jdemeyer"
}
```

**Reviewer:** Jeroen Demeyer



---

archive/issue_events_067699.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67699"
}
```



---

archive/issue_events_067700.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "needs review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67700"
}
```



---

archive/issue_events_067701.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2015-05-06T09:54:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67701"
}
```



---

archive/issue_comments_079836.json:
```json
{
    "body": "<a id='comment:22'></a>\n`hypergeometric_U` is strange, since the answer is always 53 bits:\n\n```\nsage: hypergeometric_U(1,2,3)\n0.333333333333333\nsage: R = RealField(1000)\nsage: hypergeometric_U(R(1), R(2), R(3))\n0.333333333333333\nsage: hypergeometric_U(R(1), R(2), R(3)).n(100)\n...\nTypeError: cannot approximate to a precision of 100 bits, use at most 53 bits\n```\n\nThe others work properly.",
    "created_at": "2015-05-06T10:00:34Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79836",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:22'></a>
`hypergeometric_U` is strange, since the answer is always 53 bits:

```
sage: hypergeometric_U(1,2,3)
0.333333333333333
sage: R = RealField(1000)
sage: hypergeometric_U(R(1), R(2), R(3))
0.333333333333333
sage: hypergeometric_U(R(1), R(2), R(3)).n(100)
...
TypeError: cannot approximate to a precision of 100 bits, use at most 53 bits
```

The others work properly.



---

archive/issue_comments_079837.json:
```json
{
    "body": "<a id='comment:23'></a>\nAnd the issue with `hypergeometric_U` is #14896.",
    "created_at": "2015-05-06T10:06:14Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79837",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:23'></a>
And the issue with `hypergeometric_U` is #14896.



---

archive/issue_comments_079838.json:
```json
{
    "body": "<a id='comment:24'></a>\nwith Sage 6.0 I get:\n\n```\nsage: R = RealField(1000)\nsage: hypergeometric_U(R(1), R(2), R(3)).n(100)\n0.33333333333333331482961625625\nsage: hypergeometric_U(1,2,3).n(100)\n0.33333333333333331482961625625\n```\nMaybe a regression?",
    "created_at": "2015-05-06T11:49:03Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79838",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:24'></a>
with Sage 6.0 I get:

```
sage: R = RealField(1000)
sage: hypergeometric_U(R(1), R(2), R(3)).n(100)
0.33333333333333331482961625625
sage: hypergeometric_U(1,2,3).n(100)
0.33333333333333331482961625625
```
Maybe a regression?



---

archive/issue_comments_079839.json:
```json
{
    "body": "<a id='comment:25'></a>\nis the issue with `airy_ai` fixed? I still get with Sage 6.0:\n\n```\nsage: n(airy_ai(1),digits=75)\n0.135292416312881413897883930985699407756328582763671875000000000000000000000\n```",
    "created_at": "2015-05-06T11:53:54Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79839",
    "user": "https://github.com/zimmermann6"
}
```

<a id='comment:25'></a>
is the issue with `airy_ai` fixed? I still get with Sage 6.0:

```
sage: n(airy_ai(1),digits=75)
0.135292416312881413897883930985699407756328582763671875000000000000000000000
```



---

archive/issue_comments_079840.json:
```json
{
    "body": "<a id='comment:26'></a>\nWell, Sage 6.0 is ancient.\n\nWith 6.7.beta4:\n\n```\nsage: n(airy_ai(1),digits=75)\n0.135292416312881415524147423515466306174944142988330706009102054757633534802\n```\nand\n\n```\nsage: hypergeometric_U(1,2,3).n(100)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-4-7c7c457a86be> in <module>()\n----> 1 hypergeometric_U(Integer(1),Integer(2),Integer(3)).n(Integer(100))\n\n/usr/local/src/sage-config/src/sage/structure/element.pyx in sage.structure.element.Element.numerical_approx (build/cythonized/sage/structure/element.c:7437)()\n    744         \"\"\"\n    745         from sage.misc.functional import numerical_approx\n--> 746         return numerical_approx(self, prec=prec, digits=digits,\n    747                                 algorithm=algorithm)\n    748     n = numerical_approx\n\n/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/functional.pyc in numerical_approx(x, prec, digits, algorithm)\n   1329 \n   1330     if prec > inprec:\n-> 1331         raise TypeError(\"cannot approximate to a precision of %s bits, use at most %s bits\" % (prec, inprec))\n   1332 \n   1333     # The issue is not precision, try conversion instead\n\nTypeError: cannot approximate to a precision of 100 bits, use at most 53 bits\n```",
    "created_at": "2015-05-06T12:14:04Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79840",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:26'></a>
Well, Sage 6.0 is ancient.

With 6.7.beta4:

```
sage: n(airy_ai(1),digits=75)
0.135292416312881415524147423515466306174944142988330706009102054757633534802
```
and

```
sage: hypergeometric_U(1,2,3).n(100)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-4-7c7c457a86be> in <module>()
----> 1 hypergeometric_U(Integer(1),Integer(2),Integer(3)).n(Integer(100))

/usr/local/src/sage-config/src/sage/structure/element.pyx in sage.structure.element.Element.numerical_approx (build/cythonized/sage/structure/element.c:7437)()
    744         """
    745         from sage.misc.functional import numerical_approx
--> 746         return numerical_approx(self, prec=prec, digits=digits,
    747                                 algorithm=algorithm)
    748     n = numerical_approx

/usr/local/src/sage-config/local/lib/python2.7/site-packages/sage/misc/functional.pyc in numerical_approx(x, prec, digits, algorithm)
   1329 
   1330     if prec > inprec:
-> 1331         raise TypeError("cannot approximate to a precision of %s bits, use at most %s bits" % (prec, inprec))
   1332 
   1333     # The issue is not precision, try conversion instead

TypeError: cannot approximate to a precision of 100 bits, use at most 53 bits
```



---

archive/issue_comments_079841.json:
```json
{
    "body": "<a id='comment:27'></a>\nNote that Maxima functions we didn't usually have a good precision interface with, if that is what is going on with the hgu.",
    "created_at": "2015-05-06T15:20:27Z",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9263#issuecomment-79841",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:27'></a>
Note that Maxima functions we didn't usually have a good precision interface with, if that is what is going on with the hgu.



---

archive/issue_events_067702.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T06:43:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "positive review",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67702"
}
```



---

archive/issue_events_067703.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T06:43:17Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67703"
}
```



---

archive/issue_events_067704.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2015-05-19T06:43:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9263",
    "label": "worksforme",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9263#event-67704"
}
```
