# Issue 9583: Unhandled SIGSEGV with 4.5.2.alpha0 on t2

archive/issues_009583.json:
```json
{
    "body": "Reported by John Palmieri on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/cc0b1929f66e0658/8c77081af31fc7ef#8c77081af31fc7ef):\n\n```\nt2.math: seems to build successfully, but I get the following when I\ntry to start sage:\n\n------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component\nof Sage has a bug in it (typically accessing invalid memory)\nor is not properly wrapped with _sig_on, _sig_off.\nYou might want to run Sage under gdb with 'sage -gdb' to debug this.\nSage will now terminate (sorry).\n------------------------------------------------------------\n\nI haven't tried to debug this.  I don't know how to use gdb, in any\ncase.  Any suggestions about what the problem might be?  You can find\nthe build in /scratch/palmieri/.\n```\n## Hardware and software configuration of t2.math.washington.edu\n* [Sun SPARC Enterprise T5240 Server](http://www.oracle.com/us/products/servers-storage/servers/sparc-enterprise/t-series/031584.htm) \n* 2 x 1167 MHz [UltraSPARC T2 PLUS](http://www.oracle.com/us/products/servers-storage/microelectronics/031459.htm) processors. (16 cores and 128 hardware threads in total). \n* 32 GB RAM\n* No swap devices configured. \n* Solaris 10 update 7 (5/09)\n* gcc 4.4.1 configured to use the Sun linker and Sun assembler. \n* Sage was built in on a local ZFS file system (/scratch) as a 32-bit application.\n\n**Assignee:** drkirkby\n\n**CC:**  drkirkby @jhpalmieri @johnperry-math @malb simonking @nexttime\n\n**Resolution:** fixed\n\n**Author:** Dan Drake\n\n**Reviewer:** Mitesh Patel\n\n**Merged:** sage-4.5.2.alpha1\n\nIssue created by migration from https://trac.sagemath.org/ticket/9583\n\n",
    "closed_at": "2010-07-27T00:43:46Z",
    "created_at": "2010-07-23T08:01:49Z",
    "labels": [
        "component: porting: solaris",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-4.5.2",
    "title": "Unhandled SIGSEGV with 4.5.2.alpha0 on t2",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9583",
    "user": "https://github.com/qed777"
}
```
Reported by John Palmieri on [sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/cc0b1929f66e0658/8c77081af31fc7ef#8c77081af31fc7ef):

```
t2.math: seems to build successfully, but I get the following when I
try to start sage:

------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component
of Sage has a bug in it (typically accessing invalid memory)
or is not properly wrapped with _sig_on, _sig_off.
You might want to run Sage under gdb with 'sage -gdb' to debug this.
Sage will now terminate (sorry).
------------------------------------------------------------

I haven't tried to debug this.  I don't know how to use gdb, in any
case.  Any suggestions about what the problem might be?  You can find
the build in /scratch/palmieri/.
```
## Hardware and software configuration of t2.math.washington.edu
* [Sun SPARC Enterprise T5240 Server](http://www.oracle.com/us/products/servers-storage/servers/sparc-enterprise/t-series/031584.htm) 
* 2 x 1167 MHz [UltraSPARC T2 PLUS](http://www.oracle.com/us/products/servers-storage/microelectronics/031459.htm) processors. (16 cores and 128 hardware threads in total). 
* 32 GB RAM
* No swap devices configured. 
* Solaris 10 update 7 (5/09)
* gcc 4.4.1 configured to use the Sun linker and Sun assembler. 
* Sage was built in on a local ZFS file system (/scratch) as a 32-bit application.

**Assignee:** drkirkby

**CC:**  drkirkby @jhpalmieri @johnperry-math @malb simonking @nexttime

**Resolution:** fixed

**Author:** Dan Drake

**Reviewer:** Mitesh Patel

**Merged:** sage-4.5.2.alpha1

Issue created by migration from https://trac.sagemath.org/ticket/9583





---

archive/issue_comments_116868.json:
```json
{
    "body": "<a id='comment:1'></a>\nI've seen this, too, with\n\n```sh\n$ env MAKE=\"make -j64\" SAGE_PARALLEL_SPKG_BUILD=\"yes\" make build\n```\n(I've deleted the build to make room in t2's /scratch.)\n\nIf it helps:  We merged only sage library patches (no new spkgs) in 4.5.2.alpha0.",
    "created_at": "2010-07-23T08:04:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116868",
    "user": "https://github.com/qed777"
}
```

<a id='comment:1'></a>
I've seen this, too, with

```sh
$ env MAKE="make -j64" SAGE_PARALLEL_SPKG_BUILD="yes" make build
```
(I've deleted the build to make room in t2's /scratch.)

If it helps:  We merged only sage library patches (no new spkgs) in 4.5.2.alpha0.



---

archive/issue_comments_116869.json:
```json
{
    "body": "<a id='comment:2'></a>\nI just checked if anything odd had happened on 't2'. There are no obvious errors in the log file - just the usual ones related to the fact 'disk.math' has been mis-configured. \n\n\n```\nJul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_GETATTR got error NFS4ERR_STALE causing recovery action NR_STALE.\nJul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_LOOKUP got error NFS4ERR_STALE causing recovery action NR_STALE.\nJul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_GETATTR got error NFS4ERR_STALE causing recovery action NR_STALE.\nJul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_LOOKUP got error NFS4ERR_STALE causing recovery action NR_STALE.\nJul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_GETATTR got error NFS4ERR_STALE causing recovery action NR_STALE.\nJul 22 05:56:37 t2 nfs: [ID 286389 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]File ./sergey/core (rnode_pt: 30107802420) was closed due to NFS recovery error on server disk(failed to recover from NFS4ERR_STALE NFS4ERR_STALE)\nJul 22 05:56:37 t2 nfs: [ID 941083 kern.info] NOTICE: NFS4 FACT SHEET: \nJul 22 05:56:37 t2  Action: NR_STALE \nJul 22 05:56:37 t2  NFS4 error: NFS4ERR_STALE   \nJul 22 06:26:59 t2 sshd[11907]: [ID 800047 auth.crit] fatal: Write failed: Broken pipe\nJul 22 07:40:45 t2 sshd[18797]: [ID 800047 auth.crit] fatal: Write failed: Broken pipe\nJul 22 09:16:24 t2 sshd[7318]: [ID 800047 auth.crit] fatal: Read from socket failed: Connection reset by peer\nJul 22 11:11:05 t2 sshd[6504]: [ID 800047 auth.crit] fatal: Read from socket failed: Connection reset by peer\n```\n\nNo messages today, so its probably not a problem on 't2'. \n\nDave",
    "created_at": "2010-07-23T09:39:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116869",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:2'></a>
I just checked if anything odd had happened on 't2'. There are no obvious errors in the log file - just the usual ones related to the fact 'disk.math' has been mis-configured. 


```
Jul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_GETATTR got error NFS4ERR_STALE causing recovery action NR_STALE.
Jul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_LOOKUP got error NFS4ERR_STALE causing recovery action NR_STALE.
Jul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_GETATTR got error NFS4ERR_STALE causing recovery action NR_STALE.
Jul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_LOOKUP got error NFS4ERR_STALE causing recovery action NR_STALE.
Jul 22 05:56:37 t2 nfs: [ID 236337 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]NFS op OP_GETATTR got error NFS4ERR_STALE causing recovery action NR_STALE.
Jul 22 05:56:37 t2 nfs: [ID 286389 kern.info] NOTICE: [NFS4][Server: disk][Mntpt: /home]File ./sergey/core (rnode_pt: 30107802420) was closed due to NFS recovery error on server disk(failed to recover from NFS4ERR_STALE NFS4ERR_STALE)
Jul 22 05:56:37 t2 nfs: [ID 941083 kern.info] NOTICE: NFS4 FACT SHEET: 
Jul 22 05:56:37 t2  Action: NR_STALE 
Jul 22 05:56:37 t2  NFS4 error: NFS4ERR_STALE   
Jul 22 06:26:59 t2 sshd[11907]: [ID 800047 auth.crit] fatal: Write failed: Broken pipe
Jul 22 07:40:45 t2 sshd[18797]: [ID 800047 auth.crit] fatal: Write failed: Broken pipe
Jul 22 09:16:24 t2 sshd[7318]: [ID 800047 auth.crit] fatal: Read from socket failed: Connection reset by peer
Jul 22 11:11:05 t2 sshd[6504]: [ID 800047 auth.crit] fatal: Read from socket failed: Connection reset by peer
```

No messages today, so its probably not a problem on 't2'. 

Dave



---

archive/issue_comments_116870.json:
```json
{
    "body": "<a id='comment:3'></a>\nBisection indicates that #1396 is the source of the problem:\n\n```\n[...]\ngood    trac_9012.patch\n        9114_doc_infinite_polynomial.patch\n        trac_9114-reviewer.patch\ngood    trac_9207.patch\ngood    trac%236922_final.patch\ngood    trac_9499.patch\nbad     trac1396-singular_options.2.patch\n        trac_9111.patch\n        trac_9111-doc-edits.patch\n        trac_9111-doc_addition.patch\n        trac_9373.patch\n        trac_9375-graph-doctests.patch\nbad     trac_9485-strongly_connected_componnents_digraph-fix-nt.patch\n[...]\n```",
    "created_at": "2010-07-24T00:16:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116870",
    "user": "https://github.com/qed777"
}
```

<a id='comment:3'></a>
Bisection indicates that #1396 is the source of the problem:

```
[...]
good    trac_9012.patch
        9114_doc_infinite_polynomial.patch
        trac_9114-reviewer.patch
good    trac_9207.patch
good    trac%236922_final.patch
good    trac_9499.patch
bad     trac1396-singular_options.2.patch
        trac_9111.patch
        trac_9111-doc-edits.patch
        trac_9111-doc_addition.patch
        trac_9373.patch
        trac_9375-graph-doctests.patch
bad     trac_9485-strongly_connected_componnents_digraph-fix-nt.patch
[...]
```



---

archive/issue_comments_116871.json:
```json
{
    "body": "<a id='comment:4'></a>\nWe merged #1396's [attachment:ticket:1396:trac1396-singular_options.2.patch trac1396-singular_options.2.patch] in the sage repository's revision 14701.",
    "created_at": "2010-07-24T00:24:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116871",
    "user": "https://github.com/qed777"
}
```

<a id='comment:4'></a>
We merged #1396's [attachment:ticket:1396:trac1396-singular_options.2.patch trac1396-singular_options.2.patch] in the sage repository's revision 14701.



---

archive/issue_comments_116872.json:
```json
{
    "body": "<a id='comment:5'></a>\nI got the same problem on a SPARC of mine, but managed to quite easily find the problem running \n\n```\nsage -gdb\n```\n\nHere we can see what line  causes the problem, though I expect it is auto generated by Cython, so knowing which line of python it is might be more difficult. \n\n```\ndrkirkby@redstart:~/32/sage-4.5.2.alpha0$ ./sage -gdb\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\n/export/home/drkirkby/32/sage-4.5.2.alpha0/local/bin/sage-ipython\nGNU gdb (GDB) 7.0.1\nCopyright (C) 2009 Free Software Foundation, Inc.\nLicense GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.  Type \"show copying\"\nand \"show warranty\" for details.\nThis GDB was configured as \"sparc-sun-solaris2.10\".\nFor bug reporting instructions, please see:\n<http://www.gnu.org/software/gdb/bugs/>...\nReading symbols from /export/home/drkirkby/32/sage-4.5.2.alpha0/local/bin/python...done.\n[Thread debugging using libthread_db enabled]\n[New Thread 1 (LWP 1)]\nPython 2.6.4 (r264:75706, Jul 23 2010, 17:40:08) \n[GCC 4.4.3] on sunos5\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n| Sage Version 4.5.2.alpha0, Release Date: 2010-07-21                |\n| Type notebook() for the GUI, and license() for information.        |\n\nProgram received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 1 (LWP 1)]\n0xfa660a74 in __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, \n    __pyx_args=0x1e58310, __pyx_kwds=<value optimized out>) at sage/libs/singular/option.cpp:1800\n1800      Kstd1_mu = __pyx_t_5;\nCurrent language:  auto\nThe current source language is \"auto; currently c++\".\n(gdb) br __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load\nBreakpoint 1 at 0xfa6606d8: file sage/libs/singular/option.cpp, line 1679.\n(gdb) run\nThe program being debugged has been started already.\nStart it from the beginning? (y or n) y\nStarting program: /export/home/drkirkby/32/sage-4.5.2.alpha0/local/bin/python -i\n[Thread debugging using libthread_db enabled]\n[New Thread 1 (LWP 1)]\nPython 2.6.4 (r264:75706, Jul 23 2010, 17:40:08) \n[GCC 4.4.3] on sunos5\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n[Switching to Thread 1 (LWP 1)]\n\nBreakpoint 1, __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, \n    __pyx_args=0x1e58310, __pyx_kwds=0x0) at sage/libs/singular/option.cpp:1679\n1679      if (unlikely(__pyx_kwds)) {\n(gdb) s\n1669    static PyObject *__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {\n(gdb) n\n0xfa6532d8 in call_frame_dummy ()\n   from /export/home/drkirkby/32/sage-4.5.2.alpha0/local/lib/python2.6/site-packages/sage/libs/singular/option.so\n(gdb) n\nSingle stepping until exit from function call_frame_dummy, \nwhich has no line number information.\n__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, __pyx_args=0x1e58310, \n    __pyx_kwds=0x0) at sage/libs/singular/option.cpp:1679\n1679      if (unlikely(__pyx_kwds)) {\n(gdb) n\n1701        switch (PyTuple_GET_SIZE(__pyx_args)) {\n(gdb) n\n1702          case  1: __pyx_v_value = PyTuple_GET_ITEM(__pyx_args, 0);\n(gdb) n\n1714      __Pyx_INCREF((PyObject *)__pyx_v_self);\n(gdb) \n1715      __Pyx_INCREF(__pyx_v_value);\n(gdb) \n1724      __pyx_t_1 = PyObject_RichCompare(__pyx_v_value, Py_None, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1715      __Pyx_INCREF(__pyx_v_value);\n(gdb) \n1724      __pyx_t_1 = PyObject_RichCompare(__pyx_v_value, Py_None, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1726      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1727      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;\n(gdb) \n1728      if (__pyx_t_2) {\n(gdb) \n1762      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_value, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1764      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1769      __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)&PyInt_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1766      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);\n(gdb) \n1769      __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)&PyInt_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1771      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;\n(gdb) \n5168        if (likely(PyInt_Check(x))) {\n(gdb) \n1773      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;\n(gdb) \n1774      (((struct __pyx_obj_4sage_4libs_8singular_6option_LibSingularOptions_abstract *)__pyx_v_self)->global_options[0]) = __pyx_t_4;\n(gdb) \n1783      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_value, 1, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1785      __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1786      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;\n(gdb) \n1787      Kstd1_deg = __pyx_t_5;\n(gdb) \n1796      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_value, 2, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1798      __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}\n(gdb) \n1799      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;\n(gdb) \n1802      __pyx_r = Py_None; __Pyx_INCREF(Py_None);\n(gdb) \n1800      Kstd1_mu = __pyx_t_5;\n(gdb) \n\nProgram received signal SIGSEGV, Segmentation fault.\n0xfa660a74 in __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, \n    __pyx_args=0x1e58310, __pyx_kwds=<value optimized out>) at sage/libs/singular/option.cpp:1800\n1800      Kstd1_mu = __pyx_t_5;\n(gdb) \n```\n\nDave",
    "created_at": "2010-07-24T01:16:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116872",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:5'></a>
I got the same problem on a SPARC of mine, but managed to quite easily find the problem running 

```
sage -gdb
```

Here we can see what line  causes the problem, though I expect it is auto generated by Cython, so knowing which line of python it is might be more difficult. 

```
drkirkby@redstart:~/32/sage-4.5.2.alpha0$ ./sage -gdb
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
/export/home/drkirkby/32/sage-4.5.2.alpha0/local/bin/sage-ipython
GNU gdb (GDB) 7.0.1
Copyright (C) 2009 Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.  Type "show copying"
and "show warranty" for details.
This GDB was configured as "sparc-sun-solaris2.10".
For bug reporting instructions, please see:
<http://www.gnu.org/software/gdb/bugs/>...
Reading symbols from /export/home/drkirkby/32/sage-4.5.2.alpha0/local/bin/python...done.
[Thread debugging using libthread_db enabled]
[New Thread 1 (LWP 1)]
Python 2.6.4 (r264:75706, Jul 23 2010, 17:40:08) 
[GCC 4.4.3] on sunos5
Type "help", "copyright", "credits" or "license" for more information.
| Sage Version 4.5.2.alpha0, Release Date: 2010-07-21                |
| Type notebook() for the GUI, and license() for information.        |

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 1 (LWP 1)]
0xfa660a74 in __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, 
    __pyx_args=0x1e58310, __pyx_kwds=<value optimized out>) at sage/libs/singular/option.cpp:1800
1800      Kstd1_mu = __pyx_t_5;
Current language:  auto
The current source language is "auto; currently c++".
(gdb) br __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load
Breakpoint 1 at 0xfa6606d8: file sage/libs/singular/option.cpp, line 1679.
(gdb) run
The program being debugged has been started already.
Start it from the beginning? (y or n) y
Starting program: /export/home/drkirkby/32/sage-4.5.2.alpha0/local/bin/python -i
[Thread debugging using libthread_db enabled]
[New Thread 1 (LWP 1)]
Python 2.6.4 (r264:75706, Jul 23 2010, 17:40:08) 
[GCC 4.4.3] on sunos5
Type "help", "copyright", "credits" or "license" for more information.
[Switching to Thread 1 (LWP 1)]

Breakpoint 1, __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, 
    __pyx_args=0x1e58310, __pyx_kwds=0x0) at sage/libs/singular/option.cpp:1679
1679      if (unlikely(__pyx_kwds)) {
(gdb) s
1669    static PyObject *__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load(PyObject *__pyx_v_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
(gdb) n
0xfa6532d8 in call_frame_dummy ()
   from /export/home/drkirkby/32/sage-4.5.2.alpha0/local/lib/python2.6/site-packages/sage/libs/singular/option.so
(gdb) n
Single stepping until exit from function call_frame_dummy, 
which has no line number information.
__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, __pyx_args=0x1e58310, 
    __pyx_kwds=0x0) at sage/libs/singular/option.cpp:1679
1679      if (unlikely(__pyx_kwds)) {
(gdb) n
1701        switch (PyTuple_GET_SIZE(__pyx_args)) {
(gdb) n
1702          case  1: __pyx_v_value = PyTuple_GET_ITEM(__pyx_args, 0);
(gdb) n
1714      __Pyx_INCREF((PyObject *)__pyx_v_self);
(gdb) 
1715      __Pyx_INCREF(__pyx_v_value);
(gdb) 
1724      __pyx_t_1 = PyObject_RichCompare(__pyx_v_value, Py_None, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1715      __Pyx_INCREF(__pyx_v_value);
(gdb) 
1724      __pyx_t_1 = PyObject_RichCompare(__pyx_v_value, Py_None, Py_EQ); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1726      __pyx_t_2 = __Pyx_PyObject_IsTrue(__pyx_t_1); if (unlikely(__pyx_t_2 < 0)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 280; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1727      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
(gdb) 
1728      if (__pyx_t_2) {
(gdb) 
1762      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_value, 0, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1764      __pyx_t_3 = PyTuple_New(1); if (unlikely(!__pyx_t_3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1769      __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)&PyInt_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1766      PyTuple_SET_ITEM(__pyx_t_3, 0, __pyx_t_1);
(gdb) 
1769      __pyx_t_1 = PyObject_Call(((PyObject *)((PyObject*)&PyInt_Type)), __pyx_t_3, NULL); if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 282; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1771      __Pyx_DECREF(__pyx_t_3); __pyx_t_3 = 0;
(gdb) 
5168        if (likely(PyInt_Check(x))) {
(gdb) 
1773      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
(gdb) 
1774      (((struct __pyx_obj_4sage_4libs_8singular_6option_LibSingularOptions_abstract *)__pyx_v_self)->global_options[0]) = __pyx_t_4;
(gdb) 
1783      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_value, 1, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1785      __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1786      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
(gdb) 
1787      Kstd1_deg = __pyx_t_5;
(gdb) 
1796      __pyx_t_1 = __Pyx_GetItemInt(__pyx_v_value, 2, sizeof(long), PyInt_FromLong); if (!__pyx_t_1) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1798      __pyx_t_5 = __Pyx_PyInt_AsInt(__pyx_t_1); if (unlikely((__pyx_t_5 == (int)-1) && PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 286; __pyx_clineno = __LINE__; goto __pyx_L1_error;}
(gdb) 
1799      __Pyx_DECREF(__pyx_t_1); __pyx_t_1 = 0;
(gdb) 
1802      __pyx_r = Py_None; __Pyx_INCREF(Py_None);
(gdb) 
1800      Kstd1_mu = __pyx_t_5;
(gdb) 

Program received signal SIGSEGV, Segmentation fault.
0xfa660a74 in __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load (__pyx_v_self=0x1f2b8f0, 
    __pyx_args=0x1e58310, __pyx_kwds=<value optimized out>) at sage/libs/singular/option.cpp:1800
1800      Kstd1_mu = __pyx_t_5;
(gdb) 
```

Dave



---

archive/issue_comments_116873.json:
```json
{
    "body": "<a id='comment:6'></a>\nReplying to [mpatel](#comment%3A4):\n> We merged #1396's [attachment:ticket:1396:trac1396-singular_options.2.patch trac1396-singular_options.2.patch] in the sage repository's revision 14701.\n\n\nWhat Mercuaial command could one use to reverse that? If I knew what I was going, perhaps I could revese it and rebuild the Sage library. But I don't know how to do this. \n\nDave",
    "created_at": "2010-07-24T01:22:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116873",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:6'></a>
Replying to [mpatel](#comment%3A4):
> We merged #1396's [attachment:ticket:1396:trac1396-singular_options.2.patch trac1396-singular_options.2.patch] in the sage repository's revision 14701.


What Mercuaial command could one use to reverse that? If I knew what I was going, perhaps I could revese it and rebuild the Sage library. But I don't know how to do this. 

Dave



---

archive/issue_comments_116874.json:
```json
{
    "body": "<a id='comment:7'></a>\nJohn said he did not know how to use GDB. These were the steps I took, which made finding this easy. I would add, it is often **much** more difficult to find the bugs - I perhaps got lucky here\n\n* Start Sage with `sage -gdb`\n* Lucilly it crashed immediately, saying it was at `__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load`\n* I put a breakpoint on that with ` br __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load`\n* Restarted the program. It broke at `__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load` as expected.\n* I stepped into that bit of code using `s` which is short for `step`\n* I used `n`, which is short for `next` to execute one line at a time.\n* After using `next` once, just hitting return will run `next again`. For some reason I typed it a few times, but that was not necessary.\n\nDave",
    "created_at": "2010-07-24T01:38:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116874",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:7'></a>
John said he did not know how to use GDB. These were the steps I took, which made finding this easy. I would add, it is often **much** more difficult to find the bugs - I perhaps got lucky here

* Start Sage with `sage -gdb`
* Lucilly it crashed immediately, saying it was at `__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load`
* I put a breakpoint on that with ` br __pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load`
* Restarted the program. It broke at `__pyx_pf_4sage_4libs_8singular_6option_27LibSingularOptions_abstract_load` as expected.
* I stepped into that bit of code using `s` which is short for `step`
* I used `n`, which is short for `next` to execute one line at a time.
* After using `next` once, just hitting return will run `next again`. For some reason I typed it a few times, but that was not necessary.

Dave



---

archive/issue_comments_116875.json:
```json
{
    "body": "<a id='comment:8'></a>\nAfter replacing `libs/singular/option.pyx` with the one from sage-4.5.rc1 (the version I happen to have lying around), and doing `sage -b`, sage started without segfaulting.  I assume that a bunch of doctests will break now since I haven't backed out all of the changes from #1396, but this file does seem to be the problem.",
    "created_at": "2010-07-24T05:02:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116875",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:8'></a>
After replacing `libs/singular/option.pyx` with the one from sage-4.5.rc1 (the version I happen to have lying around), and doing `sage -b`, sage started without segfaulting.  I assume that a bunch of doctests will break now since I haven't backed out all of the changes from #1396, but this file does seem to be the problem.



---

archive/issue_comments_116876.json:
```json
{
    "body": "<a id='comment:9'></a>\nReplying to [jhpalmieri](#comment%3A8):\n> After replacing `libs/singular/option.pyx` with the one from sage-4.5.rc1 (the version I happen to have lying around), and doing `sage -b`, sage started without segfaulting.  I assume that a bunch of doctests will break now since I haven't backed out all of the changes from #1396, but this file does seem to be the problem.\n\n\nThank you John. I will try that. \n\nIt would be nice to know if there was a good way to do this in Mercurial though. Adding patches is quite easy, but I assume there is a way to back them out even after they have been committed.",
    "created_at": "2010-07-24T09:29:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116876",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:9'></a>
Replying to [jhpalmieri](#comment%3A8):
> After replacing `libs/singular/option.pyx` with the one from sage-4.5.rc1 (the version I happen to have lying around), and doing `sage -b`, sage started without segfaulting.  I assume that a bunch of doctests will break now since I haven't backed out all of the changes from #1396, but this file does seem to be the problem.


Thank you John. I will try that. 

It would be nice to know if there was a good way to do this in Mercurial though. Adding patches is quite easy, but I assume there is a way to back them out even after they have been committed.



---

archive/issue_comments_116877.json:
```json
{
    "body": "<a id='comment:10'></a>\nReplying to [drkirkby](#comment%3A9):\n> It would be nice to know if there was a good way to do this in Mercurial though. Adding patches is quite easy, but I assume there is a way to back them out even after they have been committed. \n\n\nYou could try\n\n* `hg up 14700` to check out revision 14700.  To undo this, run `hg up`, which checks out the \"tip\" revision.\n* Or `hg revert -r 14700 libs/singular/option.pyx` to revert just `option.pyx`.  To undo this, run `hg revert --all`, which should revert all files to their \"tip\" version.\n\nYou also could try `patch -R` with the original patch, though I haven't done this.  But I think the complexity of undoing just a given patch depends on whether subsequent commits modified the same files.  \n\nBy the way, there's also `hg bisect`, which I didn't use above because I had 4.5.1 + an unfinished queue available.  But we might find it [useful](http://stackoverflow.com/questions/2511704/is-there-a-recommended-command-for-hg-bisect-command) for tracking down doctest failures, crashes, etc.",
    "created_at": "2010-07-24T10:56:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116877",
    "user": "https://github.com/qed777"
}
```

<a id='comment:10'></a>
Replying to [drkirkby](#comment%3A9):
> It would be nice to know if there was a good way to do this in Mercurial though. Adding patches is quite easy, but I assume there is a way to back them out even after they have been committed. 


You could try

* `hg up 14700` to check out revision 14700.  To undo this, run `hg up`, which checks out the "tip" revision.
* Or `hg revert -r 14700 libs/singular/option.pyx` to revert just `option.pyx`.  To undo this, run `hg revert --all`, which should revert all files to their "tip" version.

You also could try `patch -R` with the original patch, though I haven't done this.  But I think the complexity of undoing just a given patch depends on whether subsequent commits modified the same files.  

By the way, there's also `hg bisect`, which I didn't use above because I had 4.5.1 + an unfinished queue available.  But we might find it [useful](http://stackoverflow.com/questions/2511704/is-there-a-recommended-command-for-hg-bisect-command) for tracking down doctest failures, crashes, etc.



---

archive/issue_comments_116878.json:
```json
{
    "body": "<a id='comment:11'></a>\nI should add that it sometimes helps to run `hg qpop -a` before checking out or reverting to other revisions.",
    "created_at": "2010-07-24T10:58:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116878",
    "user": "https://github.com/qed777"
}
```

<a id='comment:11'></a>
I should add that it sometimes helps to run `hg qpop -a` before checking out or reverting to other revisions.



---

archive/issue_comments_116879.json:
```json
{
    "body": "**Description changed:**\n``````diff\n--- \n+++ \n@@ -17,4 +17,11 @@\n case.  Any suggestions about what the problem might be?  You can find\n the build in /scratch/palmieri/.\n ```\n-\n+## Hardware and software configuration of t2.math.washington.edu\n+* [Sun SPARC Enterprise T5240 Server](http://www.oracle.com/us/products/servers-storage/servers/sparc-enterprise/t-series/031584.htm) \n+* 2 x 1167 MHz [UltraSPARC T2 PLUS](http://www.oracle.com/us/products/servers-storage/microelectronics/031459.htm) processors. (16 cores and 128 hardware threads in total). \n+* 32 GB RAM\n+* No swap devices configured. \n+* Solaris 10 update 7 (5/09)\n+* gcc 4.4.1 configured to use the Sun linker and Sun assembler. \n+* Sage was built in on a local ZFS file system (/scratch) as a 32-bit application.\n``````\n",
    "created_at": "2010-07-24T11:36:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116879",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

**Description changed:**
``````diff
--- 
+++ 
@@ -17,4 +17,11 @@
 case.  Any suggestions about what the problem might be?  You can find
 the build in /scratch/palmieri/.
 ```
-
+## Hardware and software configuration of t2.math.washington.edu
+* [Sun SPARC Enterprise T5240 Server](http://www.oracle.com/us/products/servers-storage/servers/sparc-enterprise/t-series/031584.htm) 
+* 2 x 1167 MHz [UltraSPARC T2 PLUS](http://www.oracle.com/us/products/servers-storage/microelectronics/031459.htm) processors. (16 cores and 128 hardware threads in total). 
+* 32 GB RAM
+* No swap devices configured. 
+* Solaris 10 update 7 (5/09)
+* gcc 4.4.1 configured to use the Sun linker and Sun assembler. 
+* Sage was built in on a local ZFS file system (/scratch) as a 32-bit application.
``````




---

archive/issue_comments_116880.json:
```json
{
    "body": "<a id='comment:13'></a>\nHi!\n\nReplying to [mpatel](#comment%3A3):\n> Bisection indicates that #1396 is the source of the problem:\n\n\nThen I think I should explain what portion of that patch I think might be related, and my reasons for writing it.\n\nAs David find out using `sage -gdb`, the segfault occurs in `sage.libs.singular.option.LibSingularOptions_abstract.load`, and the C-code in the traceback suggests that it is exactly in line 286 of the Cython file,\n\n```\nKstd1_mu  = value[2] \n```\n\nWhat happens at startup?\n\nIn line 666 of option.pyx, some `LibSingularOptions` object is created, and in line 667, the method `reset_default()` is called. There, we have\n\n```\n    from sage.libs.singular.singular import _saved_options \n    self.load(_saved_options)\n```\n\nWhere does _saved_options come from?\n\n_saved_options is defined in line 51 of sage/libs/singular/singular.pyx. It is immediately initialised with some value, which I explicitly did in order to *prevent* a segfault caused by accessing an uninitialised C-variable. But the true initialisation (with the actual value used by libsingular) is then done at line 675.\n\nIn particular, `value[2]` in the segfaulting line should be initialised to the value 0. So, I don't see why it should be a problem to assign this to the int variable `Kstd1_mu`.\n\nI am not familiar with t2, and I don't know whether I would be able to build sage on it (I don't even know if I have an account). So, could you please test (by adding print commands in the appropriate places or so):\n\n1. Is _save_value indeed initialised in line 51 of sage/libs/singular/singular.pyx?\n2. Is the true initialisation in line 675 of sage/libs/singular/singular.pyx executed?\n3. What is the argument of the `load` function right before it segfaults? It should be a list of three int, the last two being zero.\n4. Could it be that I simply forgot to say `global _saved_options` before line 51 of sage/libs/singular/singular.pyx?\n\nCheers,\nSimon",
    "created_at": "2010-07-24T14:42:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116880",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:13'></a>
Hi!

Replying to [mpatel](#comment%3A3):
> Bisection indicates that #1396 is the source of the problem:


Then I think I should explain what portion of that patch I think might be related, and my reasons for writing it.

As David find out using `sage -gdb`, the segfault occurs in `sage.libs.singular.option.LibSingularOptions_abstract.load`, and the C-code in the traceback suggests that it is exactly in line 286 of the Cython file,

```
Kstd1_mu  = value[2] 
```

What happens at startup?

In line 666 of option.pyx, some `LibSingularOptions` object is created, and in line 667, the method `reset_default()` is called. There, we have

```
    from sage.libs.singular.singular import _saved_options 
    self.load(_saved_options)
```

Where does _saved_options come from?

_saved_options is defined in line 51 of sage/libs/singular/singular.pyx. It is immediately initialised with some value, which I explicitly did in order to *prevent* a segfault caused by accessing an uninitialised C-variable. But the true initialisation (with the actual value used by libsingular) is then done at line 675.

In particular, `value[2]` in the segfaulting line should be initialised to the value 0. So, I don't see why it should be a problem to assign this to the int variable `Kstd1_mu`.

I am not familiar with t2, and I don't know whether I would be able to build sage on it (I don't even know if I have an account). So, could you please test (by adding print commands in the appropriate places or so):

1. Is _save_value indeed initialised in line 51 of sage/libs/singular/singular.pyx?
2. Is the true initialisation in line 675 of sage/libs/singular/singular.pyx executed?
3. What is the argument of the `load` function right before it segfaults? It should be a list of three int, the last two being zero.
4. Could it be that I simply forgot to say `global _saved_options` before line 51 of sage/libs/singular/singular.pyx?

Cheers,
Simon



---

archive/issue_comments_116881.json:
```json
{
    "body": "<a id='comment:14'></a>\nI modified the \"load\" method to add some print statements:\n\n```\n    def load(self, value=None):\n        if value == None:\n            value = (None,0,0)\n        self.global_options[0] = int(value[0])\n        global Kstd1_deg\n        global Kstd1_mu\n\n        print value[0], value[1], value[2]\n\n        Kstd1_deg = value[1]\n        print \"Kstd1_deg defined\"\n        print Kstd1_deg\n\n        Kstd1_mu  = value[2]\n\n        print \"Kstd1_mu defined\"\n        print Kstd1_mu\n```\nThen when I run \"sage -br\", I get this: it's not happy about setting `Kstd1_mu`:\n\n```\n----------------------------------------------------------------------\n----------------------------------------------------------------------\n**********************************************************************\n*                                                                    *\n* Warning: this is a prerelease version, and it may be unstable.     *\n*                                                                    *\n**********************************************************************\n100663426 0 0\nKstd1_deg defined\n0\n| Sage Version 4.5.2.alpha0, Release Date: 2010-07-21                |\n| Type notebook() for the GUI, and license() for information.        |\n\n\n------------------------------------------------------------\nUnhandled SIGSEGV: A segmentation fault occurred in Sage.\nThis probably occurred because a *compiled* component\nof Sage has a bug in it (typically accessing invalid memory)\nor is not properly wrapped with _sig_on, _sig_off.\nYou might want to run Sage under gdb with 'sage -gdb' to debug this.\nSage will now terminate (sorry).\n------------------------------------------------------------\n```\nI tried changing the assignment for Kstd1_mu to `Kstd1_mu = 0` but it didn't help.\n\nIn the file `SAGE_ROOT/local/include/singular/kstd1.h`, the variables `Kstd1_deg` and `Kstd1_mu` are defined differently; could that be causing the problem?\n\n```\nextern int LazyPass,LazyDegree,mu,Kstd1_deg;\n#define Kstd1_mu mu\n```\n\nAs far as using t2, I think if you have an account on sage.math, you have one on t2.math, same password, same home directory.  Different /scratch directory.  My build is in /scratch/palmieri/sage..., and it should be world-readable.",
    "created_at": "2010-07-24T15:55:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116881",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:14'></a>
I modified the "load" method to add some print statements:

```
    def load(self, value=None):
        if value == None:
            value = (None,0,0)
        self.global_options[0] = int(value[0])
        global Kstd1_deg
        global Kstd1_mu

        print value[0], value[1], value[2]

        Kstd1_deg = value[1]
        print "Kstd1_deg defined"
        print Kstd1_deg

        Kstd1_mu  = value[2]

        print "Kstd1_mu defined"
        print Kstd1_mu
```
Then when I run "sage -br", I get this: it's not happy about setting `Kstd1_mu`:

```
----------------------------------------------------------------------
----------------------------------------------------------------------
**********************************************************************
*                                                                    *
* Warning: this is a prerelease version, and it may be unstable.     *
*                                                                    *
**********************************************************************
100663426 0 0
Kstd1_deg defined
0
| Sage Version 4.5.2.alpha0, Release Date: 2010-07-21                |
| Type notebook() for the GUI, and license() for information.        |


------------------------------------------------------------
Unhandled SIGSEGV: A segmentation fault occurred in Sage.
This probably occurred because a *compiled* component
of Sage has a bug in it (typically accessing invalid memory)
or is not properly wrapped with _sig_on, _sig_off.
You might want to run Sage under gdb with 'sage -gdb' to debug this.
Sage will now terminate (sorry).
------------------------------------------------------------
```
I tried changing the assignment for Kstd1_mu to `Kstd1_mu = 0` but it didn't help.

In the file `SAGE_ROOT/local/include/singular/kstd1.h`, the variables `Kstd1_deg` and `Kstd1_mu` are defined differently; could that be causing the problem?

```
extern int LazyPass,LazyDegree,mu,Kstd1_deg;
#define Kstd1_mu mu
```

As far as using t2, I think if you have an account on sage.math, you have one on t2.math, same password, same home directory.  Different /scratch directory.  My build is in /scratch/palmieri/sage..., and it should be world-readable.



---

archive/issue_comments_116882.json:
```json
{
    "body": "<a id='comment:15'></a>\nHi John!\n\nYes, I already found out that indeed I have an account on t2.math. I could see only part of the advices, but at least I added a .profile in my home dictionary containing\n\n```\nif [ `uname -n` = t2 ] ; then\n   . /usr/local/gcc-4.4.1-sun-linker/gcc441sun\nfi\n```\n\nThen, I unpacked the pre-built sage in some directory of mine (but not in /scratch, perhaps that would have been better), and Sage started.\n\nReplying to [jhpalmieri](#comment%3A14):\n> ...\n> In the file `SAGE_ROOT/local/include/singular/kstd1.h`, the variables `Kstd1_deg` and `Kstd1_mu` are defined differently; could that be causing the problem?\n> \n> ```\n> extern int LazyPass,LazyDegree,mu,Kstd1_deg;\n> #define Kstd1_mu mu\n> ```\n\n\nYes, this is something that we have been wondering about in Kaiserslautern at Sage Days 23.5.\n\nMy understanding is that the line `#define Kstd1_mu mu` has the same effect as replacing `Kstd1_mu` by `mu` in any C-file that includes the header `kstd1.h` - in particular, this should also hold for the Cython-generated C-files. Hans Sch\u00f6nemann (Singular developer) agreed that this should not be a problem. And I used similar `#define` tricks myself repeatedly, so far without problem. \n\nBut this was all using gcc -- Could it be that t2/Sun compiler behave differently in that regard?\n\nHowever, I would expect -- if `kstd1.h` really is to blame for it - that Singular would not build. Recall that this is a file verbously taken from Singular.\n\nCheers,\n\nSimon",
    "created_at": "2010-07-24T16:10:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116882",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:15'></a>
Hi John!

Yes, I already found out that indeed I have an account on t2.math. I could see only part of the advices, but at least I added a .profile in my home dictionary containing

```
if [ `uname -n` = t2 ] ; then
   . /usr/local/gcc-4.4.1-sun-linker/gcc441sun
fi
```

Then, I unpacked the pre-built sage in some directory of mine (but not in /scratch, perhaps that would have been better), and Sage started.

Replying to [jhpalmieri](#comment%3A14):
> ...
> In the file `SAGE_ROOT/local/include/singular/kstd1.h`, the variables `Kstd1_deg` and `Kstd1_mu` are defined differently; could that be causing the problem?
> 
> ```
> extern int LazyPass,LazyDegree,mu,Kstd1_deg;
> #define Kstd1_mu mu
> ```


Yes, this is something that we have been wondering about in Kaiserslautern at Sage Days 23.5.

My understanding is that the line `#define Kstd1_mu mu` has the same effect as replacing `Kstd1_mu` by `mu` in any C-file that includes the header `kstd1.h` - in particular, this should also hold for the Cython-generated C-files. Hans Sch√∂nemann (Singular developer) agreed that this should not be a problem. And I used similar `#define` tricks myself repeatedly, so far without problem. 

But this was all using gcc -- Could it be that t2/Sun compiler behave differently in that regard?

However, I would expect -- if `kstd1.h` really is to blame for it - that Singular would not build. Recall that this is a file verbously taken from Singular.

Cheers,

Simon



---

archive/issue_comments_116883.json:
```json
{
    "body": "<a id='comment:16'></a>\nThe compiler on t2 is gcc, but maybe on Solaris, compiler behavior is more strict, so things which are slightly sloppy and work on other systems may fail on Solaris.  But I know next to nothing about C and compilers and issues like that.",
    "created_at": "2010-07-24T16:26:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116883",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:16'></a>
The compiler on t2 is gcc, but maybe on Solaris, compiler behavior is more strict, so things which are slightly sloppy and work on other systems may fail on Solaris.  But I know next to nothing about C and compilers and issues like that.



---

archive/issue_comments_116884.json:
```json
{
    "body": "<a id='comment:17'></a>\nAre there any flags we could pass to the compiler for options.pyx (or singular.pyx) in SAGE_ROOT/devel/sage/module_list.py, which would help which this situation?",
    "created_at": "2010-07-24T16:28:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116884",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:17'></a>
Are there any flags we could pass to the compiler for options.pyx (or singular.pyx) in SAGE_ROOT/devel/sage/module_list.py, which would help which this situation?



---

archive/issue_comments_116885.json:
```json
{
    "body": "<a id='comment:18'></a>\nReplying to [SimonKing](#comment%3A15):\n \n> But this was all using gcc -- Could it be that t2/Sun compiler behave differently in that regard?\n\n\nThe compiler used to build Sage on t2.math.washington.edu is gcc. The Sun compilers are much stricter than gcc, and will not loads of Sage. So this code is presenting a problem with gcc. \n\nIf I build Sage 64-bit on Solaris SPARC it dumps core very easily. I've noticed the errors often seem to be singular related. Also, if I load a library for debugging, by the time we have got to the \n\n```\nsage:\n```\n\nprompt, there is already a couple of memory leaks. But those should not cause a crash, unless they exhaust too much memory, which I don't think they will do. But it does make me a bit suspicious of the Singular/Sage combination. \n\nOne thing worth doing is looking at compiler warnings. There are tons of them in Sage, but perhaps one near this problem might give us a clue. \n\nDave",
    "created_at": "2010-07-24T17:12:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116885",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:18'></a>
Replying to [SimonKing](#comment%3A15):
 
> But this was all using gcc -- Could it be that t2/Sun compiler behave differently in that regard?


The compiler used to build Sage on t2.math.washington.edu is gcc. The Sun compilers are much stricter than gcc, and will not loads of Sage. So this code is presenting a problem with gcc. 

If I build Sage 64-bit on Solaris SPARC it dumps core very easily. I've noticed the errors often seem to be singular related. Also, if I load a library for debugging, by the time we have got to the 

```
sage:
```

prompt, there is already a couple of memory leaks. But those should not cause a crash, unless they exhaust too much memory, which I don't think they will do. But it does make me a bit suspicious of the Singular/Sage combination. 

One thing worth doing is looking at compiler warnings. There are tons of them in Sage, but perhaps one near this problem might give us a clue. 

Dave



---

archive/issue_comments_116886.json:
```json
{
    "body": "<a id='comment:19'></a>\nI touched the files option.pyx and singular.pyx in devel/sage/sage/libs/singular/ and did \"sage -b\".  The only warnings seem to be these:\n\n```\ncc1plus: warning: command line option \"-Wstrict-prototypes\" is valid for Ada/C/ObjC but not for C++\ncc1plus: warning: command line option \"-Wstrict-prototypes\" is valid for Ada/C/ObjC but not for C++\n```",
    "created_at": "2010-07-24T17:37:49Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116886",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:19'></a>
I touched the files option.pyx and singular.pyx in devel/sage/sage/libs/singular/ and did "sage -b".  The only warnings seem to be these:

```
cc1plus: warning: command line option "-Wstrict-prototypes" is valid for Ada/C/ObjC but not for C++
cc1plus: warning: command line option "-Wstrict-prototypes" is valid for Ada/C/ObjC but not for C++
```



---

archive/issue_comments_116887.json:
```json
{
    "body": "<a id='comment:20'></a>\nFor the record: Instead of importing `Kstd1_mu` from `\"kstd1.h\"`, I imported `mu` (should be the same, by `#define Kstd1_mu mu`) and changed the rest of the code accordingly. But the segfault remains.",
    "created_at": "2010-07-24T21:25:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116887",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:20'></a>
For the record: Instead of importing `Kstd1_mu` from `"kstd1.h"`, I imported `mu` (should be the same, by `#define Kstd1_mu mu`) and changed the rest of the code accordingly. But the segfault remains.



---

archive/issue_comments_116888.json:
```json
{
    "body": "<a id='comment:21'></a>\nReplying to [jhpalmieri](#comment%3A19):\n> I touched the files option.pyx and singular.pyx in devel/sage/sage/libs/singular/ and did \"sage -b\".  The only warnings seem to be these:\n> \n> ```\n> cc1plus: warning: command line option \"-Wstrict-prototypes\" is valid for Ada/C/ObjC but not for C++\n> cc1plus: warning: command line option \"-Wstrict-prototypes\" is valid for Ada/C/ObjC but not for C++\n> ```\n\nWhen I touch one of the files and run `sage -b` I see: \n\n```\nbuilding 'sage.libs.singular.option' extension\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local/include/singular -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local//include -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local//include/csage -I/export/home/drkirkby/32/sage-4.5.2.alpha0/devel//sage/sage/ext -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local/include/python2.6 -c sage/libs/singular/option.cpp -o build/temp.solaris-2.10-sun4u-2.6/sage/libs/singular/option.o -w\ncc1plus: warning: command line option \"-Wstrict-prototypes\" is valid for Ada/C/ObjC but not for C++\n```\nWhat is certainly not a good idea is that the **C** compiler gcc is being invoked to compile a **C++** program. Since option.cpp is a C++ file, it should be compiled with g++, not gcc. \n\nI doubt that would be extensively checked by the gcc developers. It may be a case of you get away with it on some platforms some of the time, but not all platforms all of the time. \n\nDave",
    "created_at": "2010-07-25T08:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116888",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:21'></a>
Replying to [jhpalmieri](#comment%3A19):
> I touched the files option.pyx and singular.pyx in devel/sage/sage/libs/singular/ and did "sage -b".  The only warnings seem to be these:
> 
> ```
> cc1plus: warning: command line option "-Wstrict-prototypes" is valid for Ada/C/ObjC but not for C++
> cc1plus: warning: command line option "-Wstrict-prototypes" is valid for Ada/C/ObjC but not for C++
> ```

When I touch one of the files and run `sage -b` I see: 

```
building 'sage.libs.singular.option' extension
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local/include/singular -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local//include -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local//include/csage -I/export/home/drkirkby/32/sage-4.5.2.alpha0/devel//sage/sage/ext -I/export/home/drkirkby/32/sage-4.5.2.alpha0/local/include/python2.6 -c sage/libs/singular/option.cpp -o build/temp.solaris-2.10-sun4u-2.6/sage/libs/singular/option.o -w
cc1plus: warning: command line option "-Wstrict-prototypes" is valid for Ada/C/ObjC but not for C++
```
What is certainly not a good idea is that the **C** compiler gcc is being invoked to compile a **C++** program. Since option.cpp is a C++ file, it should be compiled with g++, not gcc. 

I doubt that would be extensively checked by the gcc developers. It may be a case of you get away with it on some platforms some of the time, but not all platforms all of the time. 

Dave



---

archive/issue_comments_116889.json:
```json
{
    "body": "<a id='comment:22'></a>\nReplying to [drkirkby](#comment%3A21):\n> Replying to [jhpalmieri](#comment%3A19):\n> ...\n> What is certainly not a good idea is that the **C** compiler gcc is being invoked to compile a **C++** program. Since option.cpp is a C++ file, it should be compiled with g++, not gcc. \n\n\nSo, the crucial question is: Why is Cython generating a C++ file rather than a C file?\n\nDoes it generate C++ since it is linked against Singular sources (which ostensibly are C++)?\n\nAnd what happens if one invokes g++ rather then gcc on the Cython-generated code?",
    "created_at": "2010-07-25T08:52:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116889",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:22'></a>
Replying to [drkirkby](#comment%3A21):
> Replying to [jhpalmieri](#comment%3A19):
> ...
> What is certainly not a good idea is that the **C** compiler gcc is being invoked to compile a **C++** program. Since option.cpp is a C++ file, it should be compiled with g++, not gcc. 


So, the crucial question is: Why is Cython generating a C++ file rather than a C file?

Does it generate C++ since it is linked against Singular sources (which ostensibly are C++)?

And what happens if one invokes g++ rather then gcc on the Cython-generated code?



---

archive/issue_comments_116890.json:
```json
{
    "body": "<a id='comment:23'></a>\n\n```\nlibpari-gmp.so.2}}} also exports a {{{mu}}} symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.",
    "created_at": "2010-07-25T13:12:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116890",
    "user": "https://github.com/wjp"
}
```

<a id='comment:23'></a>

```
libpari-gmp.so.2}}} also exports a {{{mu}}} symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.



---

archive/issue_comments_116891.json:
```json
{
    "body": "<a id='comment:24'></a>\nWhen I touch one of the files, I see \n\n```\ngcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/scratch/palmieri/sage-4.5.2.alpha0/local/include/singular -I/scratch/palmieri/sage-4.5.2.alpha0/local//include -I/scratch/palmieri/sage-4.5.2.alpha0/local//include/csage -I/scratch/palmieri/sage-4.5.2.alpha0/devel//sage/sage/ext -I/scratch/palmieri/sage-4.5.2.alpha0/local/include/python2.6 -c sage/libs/singular/option.cpp -o build/temp.solaris-2.10-sun4v-2.6/sage/libs/singular/option.o -w\n```\nthen a few lines later, \n\n```\ng++ -shared build/temp.solaris-2.10-sun4v-2.6/sage/libs/singular/option.o -L/scratch/palmieri/sage-4.5.2.alpha0/local//lib -L/scratch/palmieri/sage-4.5.2.alpha0/local/lib -lcsage -lm -lreadline -lsingular -lgivaro -lgmpxx -lgmp -lstdc++ -lntl -lpython2.6 -o build/lib.solaris-2.10-sun4v-2.6/sage/libs/singular/option.so\n```\n\n> So, the crucial question is: Why is Cython generating a C++ file rather than a C file?\n\n\nPresumably because in devel/sage/module_list.py, it says\n\n```\n    Extension('sage.libs.singular.option',\n              sources = ['sage/libs/singular/option.pyx'],\n              libraries = ['m', 'readline', 'singular', 'givaro', 'gmpxx', 'gmp'],\n              language=\"c++\",\n              include_dirs = [SAGE_ROOT +'/local/include/singular'],\n              depends = [SAGE_ROOT + \"/local/include/libsingular.h\"]),\n```\nNote the \"language\" line.\n\n> libpari-gmp.so.2 also exports a mu symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.\n\n\nThat's interesting; could that be the problem?  What can we do to fix it?",
    "created_at": "2010-07-25T14:31:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116891",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:24'></a>
When I touch one of the files, I see 

```
gcc -fno-strict-aliasing -g -O2 -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -fPIC -I/scratch/palmieri/sage-4.5.2.alpha0/local/include/singular -I/scratch/palmieri/sage-4.5.2.alpha0/local//include -I/scratch/palmieri/sage-4.5.2.alpha0/local//include/csage -I/scratch/palmieri/sage-4.5.2.alpha0/devel//sage/sage/ext -I/scratch/palmieri/sage-4.5.2.alpha0/local/include/python2.6 -c sage/libs/singular/option.cpp -o build/temp.solaris-2.10-sun4v-2.6/sage/libs/singular/option.o -w
```
then a few lines later, 

```
g++ -shared build/temp.solaris-2.10-sun4v-2.6/sage/libs/singular/option.o -L/scratch/palmieri/sage-4.5.2.alpha0/local//lib -L/scratch/palmieri/sage-4.5.2.alpha0/local/lib -lcsage -lm -lreadline -lsingular -lgivaro -lgmpxx -lgmp -lstdc++ -lntl -lpython2.6 -o build/lib.solaris-2.10-sun4v-2.6/sage/libs/singular/option.so
```

> So, the crucial question is: Why is Cython generating a C++ file rather than a C file?


Presumably because in devel/sage/module_list.py, it says

```
    Extension('sage.libs.singular.option',
              sources = ['sage/libs/singular/option.pyx'],
              libraries = ['m', 'readline', 'singular', 'givaro', 'gmpxx', 'gmp'],
              language="c++",
              include_dirs = [SAGE_ROOT +'/local/include/singular'],
              depends = [SAGE_ROOT + "/local/include/libsingular.h"]),
```
Note the "language" line.

> libpari-gmp.so.2 also exports a mu symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.


That's interesting; could that be the problem?  What can we do to fix it?



---

archive/issue_comments_116892.json:
```json
{
    "body": "<a id='comment:25'></a>\nReplying to [wjp](#comment%3A23):\n> \n> ```\n> libpari-gmp.so.2}}} also exports a {{{mu}}} symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.\n\n\nOK, but why would this only strike on t2?",
    "created_at": "2010-07-25T16:47:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116892",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:25'></a>
Replying to [wjp](#comment%3A23):
> 
> ```
> libpari-gmp.so.2}}} also exports a {{{mu}}} symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.


OK, but why would this only strike on t2?



---

archive/issue_comments_116893.json:
```json
{
    "body": "<a id='comment:26'></a>\nIf I comment out all assignments to `Kstd1_mu`, then Sage starts and for the directory sage/libs/singular, there is only one doctest failure:\n\n```\nsage -t  devel/sage/sage/libs/singular/option.pyx\n**********************************************************************\nFile \"/scratch/palmieri/sage-4.5.2.alpha0/devel/sage-main/sage/libs/singular/option.pyx\", line 415:\n    sage: J.groebner_basis(mult_bound=100)\nExpected:\n    [x^3*y^2 + y^3*z^2 + x^2*z^3, x^2*y^3 + x^3*z^2 + y^2*z^3, y^5, x^6 + x*y^4*z^5, x^4*z^2 - y^4*z^2 - x^2*y*z^3 + x*y^2*z^3, z^6 - x*y^4*z^4 - x^3*y*z^5]\nGot:\n    [x^3*y^2 + y^3*z^2 + x^2*z^3, x^2*y^3 + x^3*z^2 + y^2*z^3, y^5, x^6, x^4*z^2 - y^4*z^2 - x^2*y*z^3 + x*y^2*z^3, z^6, y^4*z^3 - y^3*z^4 - x^2*z^5, x^3*y*z^4 - x^2*y^2*z^4 + x*y^3*z^4, x^3*z^5, x^2*y*z^5 + y^3*z^5, x*y^3*z^5]\n```\nNot surprising, since it looks setting the multiplicative bound wants to set `Kstd1_mu`.\n\nIs something like this an option, if we can't fix the whole problem?",
    "created_at": "2010-07-25T18:26:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116893",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:26'></a>
If I comment out all assignments to `Kstd1_mu`, then Sage starts and for the directory sage/libs/singular, there is only one doctest failure:

```
sage -t  devel/sage/sage/libs/singular/option.pyx
**********************************************************************
File "/scratch/palmieri/sage-4.5.2.alpha0/devel/sage-main/sage/libs/singular/option.pyx", line 415:
    sage: J.groebner_basis(mult_bound=100)
Expected:
    [x^3*y^2 + y^3*z^2 + x^2*z^3, x^2*y^3 + x^3*z^2 + y^2*z^3, y^5, x^6 + x*y^4*z^5, x^4*z^2 - y^4*z^2 - x^2*y*z^3 + x*y^2*z^3, z^6 - x*y^4*z^4 - x^3*y*z^5]
Got:
    [x^3*y^2 + y^3*z^2 + x^2*z^3, x^2*y^3 + x^3*z^2 + y^2*z^3, y^5, x^6, x^4*z^2 - y^4*z^2 - x^2*y*z^3 + x*y^2*z^3, z^6, y^4*z^3 - y^3*z^4 - x^2*z^5, x^3*y*z^4 - x^2*y^2*z^4 + x*y^3*z^4, x^3*z^5, x^2*y*z^5 + y^3*z^5, x*y^3*z^5]
```
Not surprising, since it looks setting the multiplicative bound wants to set `Kstd1_mu`.

Is something like this an option, if we can't fix the whole problem?



---

archive/issue_comments_116894.json:
```json
{
    "body": "<a id='comment:27'></a>\nReplying to [SimonKing](#comment%3A25):\n> Replying to [wjp](#comment%3A23):\n> > \n> > ```\n> > libpari-gmp.so.2}}} also exports a {{{mu}}} symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.\n\n> \n> OK, but why would this only strike on t2?\n\nBugs that only show on one system are quite common. That's one of the big advantages in testing on multiple platforms. I have hit many such bugs over the years. \n\n * I recall writing some multi-threaded code which worked fine on numerous systems - Linux, HP-UX, Unicos, Solaris, tru64 and IRIX. But it occasionally failed on AIX. I suspected it was an AIX bug, but then I realised it was a bug in my code, which could have shown up on any operating system. It just never did. \n * I recall an ex-colleague writing some finite difference code that worked fine on hi Linux system, but crashed on a quad core Solaris machine. He then looked at his code carefully and found there was a genuine bug. \n\nI actually find that there are some bugs related to Singular and Pari that show up on 64-bit Solaris. I suspect they are genuine bugs and could cause problems on other system, but just have not to date\n\nDave",
    "created_at": "2010-07-25T18:44:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116894",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:27'></a>
Replying to [SimonKing](#comment%3A25):
> Replying to [wjp](#comment%3A23):
> > 
> > ```
> > libpari-gmp.so.2}}} also exports a {{{mu}}} symbol, by the way. But it's a function, not data, so assigning to that could cause that crash.

> 
> OK, but why would this only strike on t2?

Bugs that only show on one system are quite common. That's one of the big advantages in testing on multiple platforms. I have hit many such bugs over the years. 

 * I recall writing some multi-threaded code which worked fine on numerous systems - Linux, HP-UX, Unicos, Solaris, tru64 and IRIX. But it occasionally failed on AIX. I suspected it was an AIX bug, but then I realised it was a bug in my code, which could have shown up on any operating system. It just never did. 
 * I recall an ex-colleague writing some finite difference code that worked fine on hi Linux system, but crashed on a quad core Solaris machine. He then looked at his code carefully and found there was a genuine bug. 

I actually find that there are some bugs related to Singular and Pari that show up on 64-bit Solaris. I suspect they are genuine bugs and could cause problems on other system, but just have not to date

Dave



---

archive/issue_comments_116895.json:
```json
{
    "body": "<a id='comment:28'></a>\n\n```\nDrKirkby}}}: Please don't accuse other projects randomly and unconstructively. If there are 64 bit bugs in them, please report them in a separate ticket. (Or limit discussion of them to those tickets if you already made tickets.) This ticket is getting quite long enough already, and we haven't even fixed the problem in this one yet :-)\n\njhpalmieri: if doable, it would be good to rename {{{mu}}} entirely inside singular entirely to something less generic. It seems they already use {{{Kstd1_mu}}} internally everywhere with that {{{#define Kstd1_mu mu}}}, so hopefully it's as easy as renaming {{{mu}}} and removing the {{{#define}}}. I'll see if I can get it to work quickly and make a new singular spkg for that.",
    "created_at": "2010-07-25T19:08:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116895",
    "user": "https://github.com/wjp"
}
```

<a id='comment:28'></a>

```
DrKirkby}}}: Please don't accuse other projects randomly and unconstructively. If there are 64 bit bugs in them, please report them in a separate ticket. (Or limit discussion of them to those tickets if you already made tickets.) This ticket is getting quite long enough already, and we haven't even fixed the problem in this one yet :-)

jhpalmieri: if doable, it would be good to rename {{{mu}}} entirely inside singular entirely to something less generic. It seems they already use {{{Kstd1_mu}}} internally everywhere with that {{{#define Kstd1_mu mu}}}, so hopefully it's as easy as renaming {{{mu}}} and removing the {{{#define}}}. I'll see if I can get it to work quickly and make a new singular spkg for that.



---

archive/issue_comments_116896.json:
```json
{
    "body": "<a id='comment:29'></a>\nReplying to [wjp](#comment%3A28):\n\n> jhpalmieri: if doable, it would be good to rename `mu` entirely inside singular entirely to something less generic. It seems they already use `Kstd1_mu` internally everywhere with that `#define Kstd1_mu mu`, so hopefully it's as easy as renaming `mu` and removing the `#define`. I'll see if I can get it to work quickly and make a new singular spkg for that.\n\n\nThat sounds like a good plan, I'll inform upstream to see whether they have some insight to share.",
    "created_at": "2010-07-25T19:43:50Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116896",
    "user": "https://github.com/malb"
}
```

<a id='comment:29'></a>
Replying to [wjp](#comment%3A28):

> jhpalmieri: if doable, it would be good to rename `mu` entirely inside singular entirely to something less generic. It seems they already use `Kstd1_mu` internally everywhere with that `#define Kstd1_mu mu`, so hopefully it's as easy as renaming `mu` and removing the `#define`. I'll see if I can get it to work quickly and make a new singular spkg for that.


That sounds like a good plan, I'll inform upstream to see whether they have some insight to share.



---

archive/issue_comments_116897.json:
```json
{
    "body": "<a id='comment:30'></a>\nNew SPKG that renames `mu` to `Kstd1_mu` at:\n\nhttp://www.math.leidenuniv.nl/~wpalenst/sage/singular-3.1.0.4.p8.spkg\n\nIt builds ok on my 64 bit linux system, and all tests pass.\n\n\nmalb: Waiting for upstream's feedback would be good too; thanks for informing them.",
    "created_at": "2010-07-25T20:34:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116897",
    "user": "https://github.com/wjp"
}
```

<a id='comment:30'></a>
New SPKG that renames `mu` to `Kstd1_mu` at:

http://www.math.leidenuniv.nl/~wpalenst/sage/singular-3.1.0.4.p8.spkg

It builds ok on my 64 bit linux system, and all tests pass.


malb: Waiting for upstream's feedback would be good too; thanks for informing them.



---

archive/issue_comments_116898.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2010-07-25T20:34:02Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116898",
    "user": "https://github.com/wjp"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_116899.json:
```json
{
    "body": "<a id='comment:31'></a>\nReplying to [jhpalmieri](#comment%3A26):\n> If I comment out all assignments to `Kstd1_mu`, then Sage starts and for the directory sage/libs/singular, there is only one doctest failure:\n> ...\n> Not surprising, since it looks setting the multiplicative bound wants to set `Kstd1_mu`.\n> \n> Is something like this an option, if we can't fix the whole problem?\n\n\nUsage of `Kstd1_mu` was introduced by my patch at #1396. The aim of that patch was to make *all* Singular options available to libsingular. Two of Singular's options involve an int parameter: `degBound` and `multBound`. I used the former a lot, and it is kind of relieving that it doesn't cause a problem here. The latter, however, was new to me until two weeks ago. \n\nSo, personally, I'd say that your suggestion could be a short term solution. But still, I'd like to see all Singular options available in libsingular.\n\nI'd prefer to first test whether wjp's solution works.\n\n`@`wjp and `@`malb:\noption.pyx links against certain files of Singular, located in `SAGE_LOCAL`, if I'm not mistaken. Will installing the new spkg automatically put these files in place? Or do you say that the spkg actually fixes the problem already?\n\nOne general question: Is t2 really so slow, or am I getting a wrong impression? After touching option.pyx, it took about an hour to do `sage -br`.\n\nCheers, Simon",
    "created_at": "2010-07-25T20:52:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116899",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:31'></a>
Replying to [jhpalmieri](#comment%3A26):
> If I comment out all assignments to `Kstd1_mu`, then Sage starts and for the directory sage/libs/singular, there is only one doctest failure:
> ...
> Not surprising, since it looks setting the multiplicative bound wants to set `Kstd1_mu`.
> 
> Is something like this an option, if we can't fix the whole problem?


Usage of `Kstd1_mu` was introduced by my patch at #1396. The aim of that patch was to make *all* Singular options available to libsingular. Two of Singular's options involve an int parameter: `degBound` and `multBound`. I used the former a lot, and it is kind of relieving that it doesn't cause a problem here. The latter, however, was new to me until two weeks ago. 

So, personally, I'd say that your suggestion could be a short term solution. But still, I'd like to see all Singular options available in libsingular.

I'd prefer to first test whether wjp's solution works.

`@`wjp and `@`malb:
option.pyx links against certain files of Singular, located in `SAGE_LOCAL`, if I'm not mistaken. Will installing the new spkg automatically put these files in place? Or do you say that the spkg actually fixes the problem already?

One general question: Is t2 really so slow, or am I getting a wrong impression? After touching option.pyx, it took about an hour to do `sage -br`.

Cheers, Simon



---

archive/issue_comments_116900.json:
```json
{
    "body": "<a id='comment:32'></a>\nReplying to [SimonKing](#comment%3A31):\n> One general question: Is t2 really so slow, or am I getting a wrong impression? After touching option.pyx, it took about an hour to do `sage -br`.\n\n\n... or could the missing speed be caused by my not using /scratch? Now I unpacked the available Sage binary in /scratch, and it was much faster.",
    "created_at": "2010-07-25T21:00:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116900",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:32'></a>
Replying to [SimonKing](#comment%3A31):
> One general question: Is t2 really so slow, or am I getting a wrong impression? After touching option.pyx, it took about an hour to do `sage -br`.


... or could the missing speed be caused by my not using /scratch? Now I unpacked the available Sage binary in /scratch, and it was much faster.



---

archive/issue_comments_116901.json:
```json
{
    "body": "<a id='comment:33'></a>\nReplying to [wjp](#comment%3A30):\n> New SPKG that renames `mu` to `Kstd1_mu` at:\n> \n> http://www.math.leidenuniv.nl/~wpalenst/sage/singular-3.1.0.4.p8.spkg\n> \n\n\nIsn't there already a singular-3.1.1...spkg waiting for review (or already with a positive review)? Martin?",
    "created_at": "2010-07-25T21:02:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116901",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:33'></a>
Replying to [wjp](#comment%3A30):
> New SPKG that renames `mu` to `Kstd1_mu` at:
> 
> http://www.math.leidenuniv.nl/~wpalenst/sage/singular-3.1.0.4.p8.spkg
> 


Isn't there already a singular-3.1.1...spkg waiting for review (or already with a positive review)? Martin?



---

archive/issue_comments_116902.json:
```json
{
    "body": "<a id='comment:34'></a>\nThere is a ticket to create a newer version of Singular - see #8059. Although it had positive review, and I was marked as the reviewer, I never gave it positive review - the author did. I particularly asked if it worked properly on Solaris, but the only evidence presented was that the package built - not that Sage built, or Sage passed the doctests on Solaris. \n\nHowever, if I understand correctly, 4.5.2 is going to be library updates only, with no updates to .spkg files, so I do not believe an updated Singular.spkg is likely to be merged in 4.5.2, though it might if the update is seen as critical. Though changing variable names in one version, when another version is likely to be merged on the release after this, is perhaps not a great idea. \n\nSimon, you are correct, 't2' is slow. It's a shame really, as it is very nice hardware, which is totally unsuited for the task at hand. The CPUs are designed for a very different task. However, with parallel builds it is nowhere near as bad as it used to be. \n\nDave",
    "created_at": "2010-07-25T21:06:21Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116902",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:34'></a>
There is a ticket to create a newer version of Singular - see #8059. Although it had positive review, and I was marked as the reviewer, I never gave it positive review - the author did. I particularly asked if it worked properly on Solaris, but the only evidence presented was that the package built - not that Sage built, or Sage passed the doctests on Solaris. 

However, if I understand correctly, 4.5.2 is going to be library updates only, with no updates to .spkg files, so I do not believe an updated Singular.spkg is likely to be merged in 4.5.2, though it might if the update is seen as critical. Though changing variable names in one version, when another version is likely to be merged on the release after this, is perhaps not a great idea. 

Simon, you are correct, 't2' is slow. It's a shame really, as it is very nice hardware, which is totally unsuited for the task at hand. The CPUs are designed for a very different task. However, with parallel builds it is nowhere near as bad as it used to be. 

Dave



---

archive/issue_comments_116903.json:
```json
{
    "body": "<a id='comment:35'></a>\nReplying to [SimonKing](#comment%3A31):\n> One general question: Is t2 really so slow, or am I getting a wrong impression? After touching option.pyx, it took about an hour to do `sage -br`.\n\n\nBuilding in t2's `/scratch` should help, but it really is slow for our purposes.  It should also help to use, e.g.,\n\n```sh\n$ env MAKE=\"make -j48\" ./sage -br\n```",
    "created_at": "2010-07-25T21:11:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116903",
    "user": "https://github.com/qed777"
}
```

<a id='comment:35'></a>
Replying to [SimonKing](#comment%3A31):
> One general question: Is t2 really so slow, or am I getting a wrong impression? After touching option.pyx, it took about an hour to do `sage -br`.


Building in t2's `/scratch` should help, but it really is slow for our purposes.  It should also help to use, e.g.,

```sh
$ env MAKE="make -j48" ./sage -br
```



---

archive/issue_comments_116904.json:
```json
{
    "body": "<a id='comment:36'></a>\nReplying to [drkirkby](#comment%3A34):\n> However, if I understand correctly, 4.5.2 is going to be library updates only, with no updates to .spkg files, so I do not believe an updated Singular.spkg is likely to be merged in 4.5.2, though it might if the update is seen as critical. Though changing variable names in one version, when another version is likely to be merged on the release after this, is perhaps not a great idea. \n\n\nIs it really \"changning variable names\"? If I understood correctly, Singular does not use the variable name `mu` - it consistently uses `Kstd1_mu`, and so do I. So, I wouldn't call it  \"changing variable names\" but \"clearifying a variable definition\".",
    "created_at": "2010-07-25T21:18:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116904",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:36'></a>
Replying to [drkirkby](#comment%3A34):
> However, if I understand correctly, 4.5.2 is going to be library updates only, with no updates to .spkg files, so I do not believe an updated Singular.spkg is likely to be merged in 4.5.2, though it might if the update is seen as critical. Though changing variable names in one version, when another version is likely to be merged on the release after this, is perhaps not a great idea. 


Is it really "changning variable names"? If I understood correctly, Singular does not use the variable name `mu` - it consistently uses `Kstd1_mu`, and so do I. So, I wouldn't call it  "changing variable names" but "clearifying a variable definition".



---

archive/issue_comments_116905.json:
```json
{
    "body": "<a id='comment:37'></a>\nThanks to the link to #8059. The new version of Singular there actually already has done exactly the same thing, and renamed `mu` to `Kstd1_mu`. So that spkg supercedes this one.",
    "created_at": "2010-07-25T21:27:15Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116905",
    "user": "https://github.com/wjp"
}
```

<a id='comment:37'></a>
Thanks to the link to #8059. The new version of Singular there actually already has done exactly the same thing, and renamed `mu` to `Kstd1_mu`. So that spkg supercedes this one.



---

archive/issue_comments_116906.json:
```json
{
    "body": "<a id='comment:38'></a>\nReplying to [wjp](#comment%3A37):\n> Thanks to the link to #8059. The new version of Singular there actually already has done exactly the same thing, and renamed `mu` to `Kstd1_mu`. So that spkg supercedes this one.\n\n\nThat's good news!\n\nI already started to build your singular-3.1.0-spkg and will report whether it works. And then I'll try again with the spkg from #8059, also doing `make ptestlong`, so that hopefully a proper positive review for #8059 is possible.\n\nCheers,\nSimon",
    "created_at": "2010-07-25T21:34:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116906",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:38'></a>
Replying to [wjp](#comment%3A37):
> Thanks to the link to #8059. The new version of Singular there actually already has done exactly the same thing, and renamed `mu` to `Kstd1_mu`. So that spkg supercedes this one.


That's good news!

I already started to build your singular-3.1.0-spkg and will report whether it works. And then I'll try again with the spkg from #8059, also doing `make ptestlong`, so that hopefully a proper positive review for #8059 is possible.

Cheers,
Simon



---

archive/issue_comments_116907.json:
```json
{
    "body": "<a id='comment:39'></a>\nReplying to [SimonKing](#comment%3A36):\n\n> Is it really \"changning variable names\"? If I understood correctly, Singular does not use the variable name `mu` - it consistently uses `Kstd1_mu`, and so do I. So, I wouldn't call it  \"changing variable names\" but \"clearifying a variable definition\".\n\n\nSorry, I mis-understood. \n\nDave",
    "created_at": "2010-07-25T21:43:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116907",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:39'></a>
Replying to [SimonKing](#comment%3A36):

> Is it really "changning variable names"? If I understood correctly, Singular does not use the variable name `mu` - it consistently uses `Kstd1_mu`, and so do I. So, I wouldn't call it  "changing variable names" but "clearifying a variable definition".


Sorry, I mis-understood. 

Dave



---

archive/issue_comments_116908.json:
```json
{
    "body": "<a id='comment:40'></a>\nIt's not clear to me if the updated Singular can go into this release of Sage though. IIRC, William has specifically remarked that the updates to Pari and Singular would not be in this release. \n\nAnyway, I must do something else. Need to finish a job application, which needs to be done in less than than two hours!\n\nDave",
    "created_at": "2010-07-25T21:46:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116908",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:40'></a>
It's not clear to me if the updated Singular can go into this release of Sage though. IIRC, William has specifically remarked that the updates to Pari and Singular would not be in this release. 

Anyway, I must do something else. Need to finish a job application, which needs to be done in less than than two hours!

Dave



---

archive/issue_comments_116909.json:
```json
{
    "body": "<a id='comment:41'></a>\nReplying to [SimonKing](#comment%3A38):\n> I already started to build your singular-3.1.0-spkg and will report whether it works. \n\n\nI am afraid it didn't. It seems to me that local/include/singular/kstd1.h was not replaced when I installed the new spkg.\n\nSo, where does local/include/singular/kstd1.h come from? Where do I get the files in local/include/singular/ from?",
    "created_at": "2010-07-25T22:53:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116909",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:41'></a>
Replying to [SimonKing](#comment%3A38):
> I already started to build your singular-3.1.0-spkg and will report whether it works. 


I am afraid it didn't. It seems to me that local/include/singular/kstd1.h was not replaced when I installed the new spkg.

So, where does local/include/singular/kstd1.h come from? Where do I get the files in local/include/singular/ from?



---

archive/issue_comments_116910.json:
```json
{
    "body": "<a id='comment:42'></a>\nSorry, that was a very stupid mistake in `spkg-install`. I updated the spkg to fix that. (Same URL)",
    "created_at": "2010-07-25T23:21:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116910",
    "user": "https://github.com/wjp"
}
```

<a id='comment:42'></a>
Sorry, that was a very stupid mistake in `spkg-install`. I updated the spkg to fix that. (Same URL)



---

archive/issue_comments_116911.json:
```json
{
    "body": "<a id='comment:43'></a>\nReplying to [SimonKing](#comment%3A41):\n> Replying to [SimonKing](#comment%3A38):\n> > I already started to build your singular-3.1.0-spkg and will report whether it works. \n\n> \n> I am afraid it didn't. It seems to me that local/include/singular/kstd1.h was not replaced when I installed the new spkg.\n\n\nWillem's first `singular-3.1.0.4.p8.spkg` yields an \"Unhandled SIGSEGV\" for me on t2; I haven't tested the latest version.  However, Sage does start with the latest patch (I ignored the rejects) and package at #8059, after I run `./sage -b`.  I'm running the long doctests now.",
    "created_at": "2010-07-25T23:26:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116911",
    "user": "https://github.com/qed777"
}
```

<a id='comment:43'></a>
Replying to [SimonKing](#comment%3A41):
> Replying to [SimonKing](#comment%3A38):
> > I already started to build your singular-3.1.0-spkg and will report whether it works. 

> 
> I am afraid it didn't. It seems to me that local/include/singular/kstd1.h was not replaced when I installed the new spkg.


Willem's first `singular-3.1.0.4.p8.spkg` yields an "Unhandled SIGSEGV" for me on t2; I haven't tested the latest version.  However, Sage does start with the latest patch (I ignored the rejects) and package at #8059, after I run `./sage -b`.  I'm running the long doctests now.



---

archive/issue_comments_116912.json:
```json
{
    "body": "<a id='comment:44'></a>\nReplying to [mpatel](#comment%3A43):\n> Willem's first `singular-3.1.0.4.p8.spkg` yields an \"Unhandled SIGSEGV\" for me on t2; I haven't tested the latest version.  However, Sage does start with the latest patch (I ignored the rejects) and package at #8059, after I run `./sage -b`.  I'm running the long doctests now.\n\n\nThese pass, except for those fixed by #9590.  The suite for `sage/schemes/elliptic_curves/ell_rational_field.py` timed out (3602.4 s) and I'm rerunning it now.  I'll try to install and test the new p8 spkg in a separate copy of 4.5.2.alpha0.",
    "created_at": "2010-07-26T01:10:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116912",
    "user": "https://github.com/qed777"
}
```

<a id='comment:44'></a>
Replying to [mpatel](#comment%3A43):
> Willem's first `singular-3.1.0.4.p8.spkg` yields an "Unhandled SIGSEGV" for me on t2; I haven't tested the latest version.  However, Sage does start with the latest patch (I ignored the rejects) and package at #8059, after I run `./sage -b`.  I'm running the long doctests now.


These pass, except for those fixed by #9590.  The suite for `sage/schemes/elliptic_curves/ell_rational_field.py` timed out (3602.4 s) and I'm rerunning it now.  I'll try to install and test the new p8 spkg in a separate copy of 4.5.2.alpha0.



---

archive/issue_comments_116913.json:
```json
{
    "body": "<a id='comment:45'></a>\nWould Mitesh, (who is a release manager for 4.3.2), consider merging the package at #8059, despite it being a major update to Singular, if it fixes this problem? I know the plan was not to update .spkg files in Sage 4.3.2, but plans do sometimes change. \n\nIf my understanding is correct, \n\nhttp://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg\n\nwhich is the latest release, does not define Kstd1_mu to be mu, so this particular problem should not exist. However, since `singular-3-1-1-4.spkg` has not been checked properly on 't2', there may be other problems. \n\nIt seems to me that the policy the release managers adopt regarding the updating of .spkg files could have a major impact on what happens on this ticket. \n\n\n\nDave",
    "created_at": "2010-07-26T01:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116913",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:45'></a>
Would Mitesh, (who is a release manager for 4.3.2), consider merging the package at #8059, despite it being a major update to Singular, if it fixes this problem? I know the plan was not to update .spkg files in Sage 4.3.2, but plans do sometimes change. 

If my understanding is correct, 

http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg

which is the latest release, does not define Kstd1_mu to be mu, so this particular problem should not exist. However, since `singular-3-1-1-4.spkg` has not been checked properly on 't2', there may be other problems. 

It seems to me that the policy the release managers adopt regarding the updating of .spkg files could have a major impact on what happens on this ticket. 



Dave



---

archive/issue_comments_116914.json:
```json
{
    "body": "<a id='comment:46'></a>\nReplying to [drkirkby](#comment%3A45):\n> Would Mitesh, (who is a release manager for 4.3.2),\n\n\nI'm also a release manager for 4.5.2. :)\n\n> consider merging the package at #8059, despite it being a major update to Singular, if it fixes this problem? I know the plan was not to update .spkg files in Sage 4.3.2, but plans do sometimes change. \n\n\nWe are planning to merge a new sagenb spkg, but I would prefer to avoid merging a new Singular spkg. \n\nDid the patch from #1396 fix any bugs or failing doctests, or did it only add new functionality? If it only added new functionality, I would really prefer to back it out for now.\n> \n> If my understanding is correct, \n> \n> http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg\n> \n> which is the latest release, does not define Kstd1_mu to be mu, so this particular problem should not exist. However, since `singular-3-1-1-4.spkg` has not been checked properly on 't2', there may be other problems. \n> \n> It seems to me that the policy the release managers adopt regarding the updating of .spkg files could have a major impact on what happens on this ticket. \n> \n> \n> \n> Dave",
    "created_at": "2010-07-26T02:06:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116914",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:46'></a>
Replying to [drkirkby](#comment%3A45):
> Would Mitesh, (who is a release manager for 4.3.2),


I'm also a release manager for 4.5.2. :)

> consider merging the package at #8059, despite it being a major update to Singular, if it fixes this problem? I know the plan was not to update .spkg files in Sage 4.3.2, but plans do sometimes change. 


We are planning to merge a new sagenb spkg, but I would prefer to avoid merging a new Singular spkg. 

Did the patch from #1396 fix any bugs or failing doctests, or did it only add new functionality? If it only added new functionality, I would really prefer to back it out for now.
> 
> If my understanding is correct, 
> 
> http://sage.math.washington.edu/home/malb/spkgs/singular-3-1-1-4.spkg
> 
> which is the latest release, does not define Kstd1_mu to be mu, so this particular problem should not exist. However, since `singular-3-1-1-4.spkg` has not been checked properly on 't2', there may be other problems. 
> 
> It seems to me that the policy the release managers adopt regarding the updating of .spkg files could have a major impact on what happens on this ticket. 
> 
> 
> 
> Dave



---

archive/issue_comments_116915.json:
```json
{
    "body": "<a id='comment:47'></a>\nBy the way, the proper way in Mercurial to \"undo\" a changeset is the `backout` command. Here's how you can test 4.5.2.alpha0 without #1396:\n\n* build 4.5.2.alpha0\n* make a new branch\n* in that branch, do `hg backout --merge 14701` \n* do `hg commit` to commit the result of the merge\n* test Sage as usual\n\nSee http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html#id392287 for more info. I'm currently testing 4.5.2.alpha0 on t2.math after doing the above.",
    "created_at": "2010-07-26T02:13:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116915",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:47'></a>
By the way, the proper way in Mercurial to "undo" a changeset is the `backout` command. Here's how you can test 4.5.2.alpha0 without #1396:

* build 4.5.2.alpha0
* make a new branch
* in that branch, do `hg backout --merge 14701` 
* do `hg commit` to commit the result of the merge
* test Sage as usual

See http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html#id392287 for more info. I'm currently testing 4.5.2.alpha0 on t2.math after doing the above.



---

archive/issue_comments_116916.json:
```json
{
    "body": "<a id='comment:48'></a>\nReplying to [ddrake](#comment%3A47):\n> I'm currently testing 4.5.2.alpha0 on t2.math after doing the above.\n\n\nSage starts after backing out #1396. I'll see about doctests.",
    "created_at": "2010-07-26T02:43:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116916",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:48'></a>
Replying to [ddrake](#comment%3A47):
> I'm currently testing 4.5.2.alpha0 on t2.math after doing the above.


Sage starts after backing out #1396. I'll see about doctests.



---

archive/issue_comments_116917.json:
```json
{
    "body": "<a id='comment:49'></a>\n> Willem's first singular-3.1.0.4.p8.spkg yields an \"Unhandled SIGSEGV\" for me on t2.\n\n\nThe first one didn't make any changes.  After doing any of the others, you probably have to do \"sage -ba\" (or maybe you can get away with just rebuilding the pyx files in libs/singular?).",
    "created_at": "2010-07-26T02:47:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116917",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:49'></a>
> Willem's first singular-3.1.0.4.p8.spkg yields an "Unhandled SIGSEGV" for me on t2.


The first one didn't make any changes.  After doing any of the others, you probably have to do "sage -ba" (or maybe you can get away with just rebuilding the pyx files in libs/singular?).



---

archive/issue_comments_116918.json:
```json
{
    "body": "<a id='comment:50'></a>\nFor what it's worth, I've tested the spkg posted here on a bunch of different platforms, both building from scratch and upgrading (followed by \"sage -ba\"), and it seems to behave well: passes all tests (except for known, unrelated, failures) on sage.math, taurus, menas, lena, my OS X box, and some tests on t2.math -- I haven't had time to run all of them, but it passes all tests on libs/singular/ and rings/.  So I would give this a positive review.  If you feel like merging this spkg instead of backing out #1396, you have that option.  (For what it's worth, the package at #8059 does not work for me when I try to build 4.5.2.alpha0 with it; maybe it's not compatible with #1396?)\n\nI'll run all long tests on t2.math tonight, and if there are no problems, I'll mark this officially as \"positive review\".\n\nAs I said, after upgrading, you have to make sure to do \"sage -ba\".  Is this automatic in the upgrade process?",
    "created_at": "2010-07-26T03:38:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116918",
    "user": "https://github.com/jhpalmieri"
}
```

<a id='comment:50'></a>
For what it's worth, I've tested the spkg posted here on a bunch of different platforms, both building from scratch and upgrading (followed by "sage -ba"), and it seems to behave well: passes all tests (except for known, unrelated, failures) on sage.math, taurus, menas, lena, my OS X box, and some tests on t2.math -- I haven't had time to run all of them, but it passes all tests on libs/singular/ and rings/.  So I would give this a positive review.  If you feel like merging this spkg instead of backing out #1396, you have that option.  (For what it's worth, the package at #8059 does not work for me when I try to build 4.5.2.alpha0 with it; maybe it's not compatible with #1396?)

I'll run all long tests on t2.math tonight, and if there are no problems, I'll mark this officially as "positive review".

As I said, after upgrading, you have to make sure to do "sage -ba".  Is this automatic in the upgrade process?



---

archive/issue_comments_116919.json:
```json
{
    "body": "<a id='comment:51'></a>\nReplying to [ddrake](#comment%3A46):\n> ...\n> Did the patch from #1396 fix any bugs or failing doctests, or did it only add new functionality? \n\n\nIt is an enhancement.",
    "created_at": "2010-07-26T07:48:41Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116919",
    "user": "https://github.com/simon-king-jena"
}
```

<a id='comment:51'></a>
Replying to [ddrake](#comment%3A46):
> ...
> Did the patch from #1396 fix any bugs or failing doctests, or did it only add new functionality? 


It is an enhancement.



---

archive/issue_comments_116920.json:
```json
{
    "body": "<a id='comment:52'></a>\nReplying to [ddrake](#comment%3A47):\n> By the way, the proper way in Mercurial to \"undo\" a changeset is the `backout` command. Here's how you can test 4.5.2.alpha0 without #1396:\n\n\nThanks for the tip!  Thanks also to David for the GDB mini-lesson!",
    "created_at": "2010-07-26T07:56:30Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116920",
    "user": "https://github.com/qed777"
}
```

<a id='comment:52'></a>
Replying to [ddrake](#comment%3A47):
> By the way, the proper way in Mercurial to "undo" a changeset is the `backout` command. Here's how you can test 4.5.2.alpha0 without #1396:


Thanks for the tip!  Thanks also to David for the GDB mini-lesson!



---

archive/issue_comments_116921.json:
```json
{
    "body": "backout attachment:trac1396-singular_options.2.patch",
    "created_at": "2010-07-26T08:06:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116921",
    "user": "https://github.com/dandrake"
}
```

backout attachment:trac1396-singular_options.2.patch



---

archive/issue_comments_116922.json:
```json
{
    "body": "<a id='comment:53'></a>\nAttachment [trac_9583.patch](tarball://root/attachments/some-uuid/ticket9583/trac_9583.patch) by @dandrake created at 2010-07-26 08:10:38\n\nSince #1396 didn't fix any bugs or other failures, and since I'm not brave enough to merge any more spkgs than I already have, for 4.5.2 I propose that we backout attachment:trac1396-singular_options.2.patch. I will open a new ticket, in which we can re-merge #1396.\n\nThe patch here was obtained by using `hg backout`, so if we trust Mercurial, it will exactly reverse the patch from #1396.",
    "created_at": "2010-07-26T08:10:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116922",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:53'></a>
Attachment [trac_9583.patch](tarball://root/attachments/some-uuid/ticket9583/trac_9583.patch) by @dandrake created at 2010-07-26 08:10:38

Since #1396 didn't fix any bugs or other failures, and since I'm not brave enough to merge any more spkgs than I already have, for 4.5.2 I propose that we backout attachment:trac1396-singular_options.2.patch. I will open a new ticket, in which we can re-merge #1396.

The patch here was obtained by using `hg backout`, so if we trust Mercurial, it will exactly reverse the patch from #1396.



---

archive/issue_comments_116923.json:
```json
{
    "body": "<a id='comment:54'></a>\nThe new ticket for remerging is #9599.",
    "created_at": "2010-07-26T08:14:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116923",
    "user": "https://github.com/dandrake"
}
```

<a id='comment:54'></a>
The new ticket for remerging is #9599.



---

archive/issue_comments_116924.json:
```json
{
    "body": "**Author:** Dan Drake",
    "created_at": "2010-07-26T09:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116924",
    "user": "https://github.com/qed777"
}
```

**Author:** Dan Drake



---

archive/issue_comments_116925.json:
```json
{
    "body": "<a id='comment:55'></a>\nI'm now testing 4.5.2.alpha0 plus [comment 47's backout procedure](#comment%3A47) on bsd.math, sage.math, and t2, but I won't be able to report the results until after I wake up.",
    "created_at": "2010-07-26T09:04:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116925",
    "user": "https://github.com/qed777"
}
```

<a id='comment:55'></a>
I'm now testing 4.5.2.alpha0 plus [comment 47's backout procedure](#comment%3A47) on bsd.math, sage.math, and t2, but I won't be able to report the results until after I wake up.



---

archive/issue_comments_116926.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2010-07-26T21:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116926",
    "user": "https://github.com/qed777"
}
```

**Changing status** from needs_review to positive_review.



---

archive/issue_comments_116927.json:
```json
{
    "body": "**Reviewer:** Mitesh Patel",
    "created_at": "2010-07-26T21:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116927",
    "user": "https://github.com/qed777"
}
```

**Reviewer:** Mitesh Patel



---

archive/issue_comments_116928.json:
```json
{
    "body": "<a id='comment:57'></a>\nReplying to [mpatel](#comment%3A55):\n> I'm now testing 4.5.2.alpha0 plus [comment 47's backout procedure](#comment%3A47) on bsd.math, sage.math, and t2, but I won't be able to report the results until after I wake up.\n\n\nI get no new long doctest failures.  Also,\n\n```sh\n$ cd SAGE_ROOT/devel/sage\n$ wget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/1396/trac1396-singular_options.2.patch\n$ wget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9583/trac_9583.patch\n$ hg stat\n$ patch -p1 < trac1396-singular_options.2.patch\npatching file sage/interfaces/singular.py\npatching file sage/libs/singular/option.pyx\npatching file sage/libs/singular/singular-cdefs.pxi\npatching file sage/libs/singular/singular.pyx\npatching file sage/rings/polynomial/multi_polynomial_ideal.py\n$ hg stat\nM sage/interfaces/singular.py\nM sage/libs/singular/option.pyx\nM sage/libs/singular/singular-cdefs.pxi\nM sage/libs/singular/singular.pyx\nM sage/rings/polynomial/multi_polynomial_ideal.py\n$ patch -p1 < trac_9583.patch\npatching file sage/interfaces/singular.py\npatching file sage/libs/singular/option.pyx\npatching file sage/libs/singular/singular-cdefs.pxi\npatching file sage/libs/singular/singular.pyx\npatching file sage/rings/polynomial/multi_polynomial_ideal.py\n$ hg stat\n$ hg diff\n$\n```\nso I'm ready to give this a positive review.",
    "created_at": "2010-07-26T21:26:05Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116928",
    "user": "https://github.com/qed777"
}
```

<a id='comment:57'></a>
Replying to [mpatel](#comment%3A55):
> I'm now testing 4.5.2.alpha0 plus [comment 47's backout procedure](#comment%3A47) on bsd.math, sage.math, and t2, but I won't be able to report the results until after I wake up.


I get no new long doctest failures.  Also,

```sh
$ cd SAGE_ROOT/devel/sage
$ wget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/1396/trac1396-singular_options.2.patch
$ wget http://trac.sagemath.org/sage_trac/raw-attachment/ticket/9583/trac_9583.patch
$ hg stat
$ patch -p1 < trac1396-singular_options.2.patch
patching file sage/interfaces/singular.py
patching file sage/libs/singular/option.pyx
patching file sage/libs/singular/singular-cdefs.pxi
patching file sage/libs/singular/singular.pyx
patching file sage/rings/polynomial/multi_polynomial_ideal.py
$ hg stat
M sage/interfaces/singular.py
M sage/libs/singular/option.pyx
M sage/libs/singular/singular-cdefs.pxi
M sage/libs/singular/singular.pyx
M sage/rings/polynomial/multi_polynomial_ideal.py
$ patch -p1 < trac_9583.patch
patching file sage/interfaces/singular.py
patching file sage/libs/singular/option.pyx
patching file sage/libs/singular/singular-cdefs.pxi
patching file sage/libs/singular/singular.pyx
patching file sage/rings/polynomial/multi_polynomial_ideal.py
$ hg stat
$ hg diff
$
```
so I'm ready to give this a positive review.



---

archive/issue_comments_116929.json:
```json
{
    "body": "<a id='comment:58'></a>\nReplying to [jhpalmieri](#comment%3A50):\n> As I said, after upgrading, you have to make sure to do \"sage -ba\".  Is this automatic in the upgrade process?\n\n\nAs far as I can tell, `sage -upgrade` (which invoke `sage-upgrade` and `sage-update`) and `sage -f/i` (which call `sage-spkg`) do not check whether it's necessary to rebuild dependent packages (nor warn about or actually rebuild them), particularly those that are already installed (i.e., have a corresponding marker in `SAGE_ROOT/spkg/installed`).  Or am I misunderstanding your question?",
    "created_at": "2010-07-26T21:59:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116929",
    "user": "https://github.com/qed777"
}
```

<a id='comment:58'></a>
Replying to [jhpalmieri](#comment%3A50):
> As I said, after upgrading, you have to make sure to do "sage -ba".  Is this automatic in the upgrade process?


As far as I can tell, `sage -upgrade` (which invoke `sage-upgrade` and `sage-update`) and `sage -f/i` (which call `sage-spkg`) do not check whether it's necessary to rebuild dependent packages (nor warn about or actually rebuild them), particularly those that are already installed (i.e., have a corresponding marker in `SAGE_ROOT/spkg/installed`).  Or am I misunderstanding your question?



---

archive/issue_comments_116930.json:
```json
{
    "body": "<a id='comment:59'></a>\nReplying to [ddrake](#comment%3A47):\n> By the way, the proper way in Mercurial to \"undo\" a changeset is the `backout` command. Here's how you can test 4.5.2.alpha0 without #1396:\n> \n> * build 4.5.2.alpha0\n> * make a new branch\n> * in that branch, do `hg backout --merge 14701` \n> * do `hg commit` to commit the result of the merge\n> * test Sage as usual\n> \n> See http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html#id392287 for more info. I'm currently testing 4.5.2.alpha0 on t2.math after doing the above.\n\n\nThank you for that Dan. Its usefulness to me will extend well beyond the point this ticket gets closed. \n\nDave",
    "created_at": "2010-07-26T22:06:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116930",
    "user": "https://trac.sagemath.org/admin/accounts/users/drkirkby"
}
```

<a id='comment:59'></a>
Replying to [ddrake](#comment%3A47):
> By the way, the proper way in Mercurial to "undo" a changeset is the `backout` command. Here's how you can test 4.5.2.alpha0 without #1396:
> 
> * build 4.5.2.alpha0
> * make a new branch
> * in that branch, do `hg backout --merge 14701` 
> * do `hg commit` to commit the result of the merge
> * test Sage as usual
> 
> See http://hgbook.red-bean.com/read/finding-and-fixing-mistakes.html#id392287 for more info. I'm currently testing 4.5.2.alpha0 on t2.math after doing the above.


Thank you for that Dan. Its usefulness to me will extend well beyond the point this ticket gets closed. 

Dave



---

archive/issue_comments_116931.json:
```json
{
    "body": "**Merged:** sage-4.5.2.alpha1",
    "created_at": "2010-07-27T00:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116931",
    "user": "https://github.com/dandrake"
}
```

**Merged:** sage-4.5.2.alpha1



---

archive/issue_comments_116932.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2010-07-27T00:43:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9583#issuecomment-116932",
    "user": "https://github.com/dandrake"
}
```

**Resolution:** fixed



---

archive/issue_events_029027.json:
```json
{
    "actor": "https://github.com/dandrake",
    "created_at": "2010-07-27T00:43:46Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9583",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9583#event-29027"
}
```
