# Issue 9847: Handle preset R_PROFILE or R_HOME variables

archive/issues_009846.json:
```json
{
    "body": "A preset `R_PROFILE` variable can cause some R packages to fail to build/install and interfere with doctests.\n\nGeorg Grafendorfer [reported this problem on sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/b2827cba9319bfed/41eab313614e6d2a#41eab313614e6d2a).\n\nFor `R_HOME`, this yields a doctest failure if set:\n\n```\n**********************************************************************\nFile \"devel/sage/sage/misc/interpreter.py\", line 187, in sage.misc.interpreter.SageInteractiveShell.system_raw\nFailed example:\n    shell.system_raw('R --version')\nExpected:\n    R version ...\nGot:\n    WARNING: ignoring environment value of R_HOME\n    R version 2.15.2 (2012-10-26) -- \"Trick or Treat\"\n    Copyright (C) 2012 The R Foundation for Statistical Computing\n    ISBN 3-900051-07-0\n    Platform: x86_64-unknown-linux-gnu (64-bit)\n    <BLANKLINE>\n    R is free software and comes with ABSOLUTELY NO WARRANTY.\n    You are welcome to redistribute it under the terms of the\n    GNU General Public License versions 2 or 3.\n    For more information about these matters see\n    http://www.gnu.org/licenses/.\n    <BLANKLINE>\n**********************************************************************\n```\n\n**Apply** [attachment:9847_unset_R.patch] to `SAGE_ROOT`.\n\nAssignee: GeorgSWeber\n\nCC:  ggrafendorfer @kcrisman\n\nReviewer: Leif Leonhardy, Karl-Dieter Crisman\n\nAuthor: Jeroen Demeyer\n\nMerged: sage-5.9.beta2\n\nResolution: fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/9847\n\n",
    "closed_at": "2013-03-28T17:55:25Z",
    "created_at": "2010-09-01T09:45:22Z",
    "labels": [
        "component: build",
        "blocker",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.9",
    "title": "Handle preset R_PROFILE or R_HOME variables",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9847",
    "user": "https://github.com/qed777"
}
```
A preset `R_PROFILE` variable can cause some R packages to fail to build/install and interfere with doctests.

Georg Grafendorfer [reported this problem on sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/b2827cba9319bfed/41eab313614e6d2a#41eab313614e6d2a).

For `R_HOME`, this yields a doctest failure if set:

```
**********************************************************************
File "devel/sage/sage/misc/interpreter.py", line 187, in sage.misc.interpreter.SageInteractiveShell.system_raw
Failed example:
    shell.system_raw('R --version')
Expected:
    R version ...
Got:
    WARNING: ignoring environment value of R_HOME
    R version 2.15.2 (2012-10-26) -- "Trick or Treat"
    Copyright (C) 2012 The R Foundation for Statistical Computing
    ISBN 3-900051-07-0
    Platform: x86_64-unknown-linux-gnu (64-bit)
    <BLANKLINE>
    R is free software and comes with ABSOLUTELY NO WARRANTY.
    You are welcome to redistribute it under the terms of the
    GNU General Public License versions 2 or 3.
    For more information about these matters see
    http://www.gnu.org/licenses/.
    <BLANKLINE>
**********************************************************************
```

**Apply** [attachment:9847_unset_R.patch] to `SAGE_ROOT`.

Assignee: GeorgSWeber

CC:  ggrafendorfer @kcrisman

Reviewer: Leif Leonhardy, Karl-Dieter Crisman

Author: Jeroen Demeyer

Merged: sage-5.9.beta2

Resolution: fixed

Issue created by migration from https://trac.sagemath.org/ticket/9847





---

archive/issue_comments_116393.json:
```json
{
    "body": "<a id='comment:1'></a>From around line 180 of `SAGE_LOCAL/bin/sage-env`:\n\n```sh\nif [ -z \"$RHOME\" ]; then\n    RHOME=\"$SAGE_LOCAL/lib/R\" && export RHOME\nfi\n```\nShould we add a similar test for `R_PROFILE`?",
    "created_at": "2010-09-01T09:47:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116393",
    "user": "https://github.com/qed777"
}
```

<a id='comment:1'></a>From around line 180 of `SAGE_LOCAL/bin/sage-env`:

```sh
if [ -z "$RHOME" ]; then
    RHOME="$SAGE_LOCAL/lib/R" && export RHOME
fi
```
Should we add a similar test for `R_PROFILE`?



---

archive/issue_comments_116394.json:
```json
{
    "body": "<a id='comment:2'></a>I think we should perhaps\n\n```sh\nunset R_PROFILE\n```\nin R's `spkg-install`, too.",
    "created_at": "2010-09-01T13:59:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116394",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:2'></a>I think we should perhaps

```sh
unset R_PROFILE
```
in R's `spkg-install`, too.



---

archive/issue_comments_116395.json:
```json
{
    "body": "<a id='comment:3'></a>Apparently this might be addressed by a solution to #9906.",
    "created_at": "2010-10-01T14:08:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116395",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:3'></a>Apparently this might be addressed by a solution to #9906.



---

archive/issue_events_024783.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2011-08-05T10:13:18Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9847#event-24783"
}
```



---

archive/issue_comments_116396.json:
```json
{
    "body": "<a id='comment:4'></a>Replying to [comment:2 leif]:\n> I think we should perhaps\n\n{{{#!sh\nunset R_PROFILE\n}}}\n> in R's `spkg-install`, too.\n\n\n#9906 (R 2.10.1.p5) does this now.",
    "created_at": "2011-08-05T10:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116396",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:4'></a>Replying to [comment:2 leif]:
> I think we should perhaps

{{{#!sh
unset R_PROFILE
}}}
> in R's `spkg-install`, too.


#9906 (R 2.10.1.p5) does this now.



---

archive/issue_comments_116397.json:
```json
{
    "body": "Changing dependencies from \"\" to \"#9906\"",
    "created_at": "2011-08-05T10:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116397",
    "user": "https://github.com/nexttime"
}
```

Changing dependencies from "" to "#9906"



---

archive/issue_comments_116398.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2011-08-05T10:13:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116398",
    "user": "https://github.com/nexttime"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_116399.json:
```json
{
    "body": "<a id='comment:5'></a>Thanks.  Trac isn't sending emails, as you know, so I just saw this.  (Well, six hours isn't bad.)  I'll take a look at #9906 then.",
    "created_at": "2011-08-05T16:30:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116399",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:5'></a>Thanks.  Trac isn't sending emails, as you know, so I just saw this.  (Well, six hours isn't bad.)  I'll take a look at #9906 then.



---

archive/issue_comments_116400.json:
```json
{
    "body": "Changing reviewer from \"\" to \"Leif Leonhardy, Karl-Dieter Crisman\"",
    "created_at": "2011-08-18T02:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116400",
    "user": "https://github.com/kcrisman"
}
```

Changing reviewer from "" to "Leif Leonhardy, Karl-Dieter Crisman"



---

archive/issue_comments_116401.json:
```json
{
    "body": "<a id='comment:6'></a>Sorry I didn't come back to this.  It is correct that the spkgs at #9906 do this in the spkg scripts.  \n\nSo I can give this positive review as long as Leif promises that if I or some other reviewer find out that the fix at #9906 doesn't solve the type of problem above, that it will get addressed there and no longer here!  \n\nSound good?  ;-)  But I don't think that will be necessary.",
    "created_at": "2011-08-18T02:10:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116401",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:6'></a>Sorry I didn't come back to this.  It is correct that the spkgs at #9906 do this in the spkg scripts.  

So I can give this positive review as long as Leif promises that if I or some other reviewer find out that the fix at #9906 doesn't solve the type of problem above, that it will get addressed there and no longer here!  

Sound good?  ;-)  But I don't think that will be necessary.



---

archive/issue_comments_116402.json:
```json
{
    "body": "<a id='comment:7'></a>Replying to [comment:6 kcrisman]:\n> Sorry I didn't come back to this.  It is correct that the spkgs at #9906 do this in the spkg scripts.  \n> \n> So I can give this positive review as long as Leif promises that if I or some other reviewer find out that the fix at #9906 doesn't solve the type of problem above, that it will get addressed there and no longer here!\n\n\nIn that case, you should also give *this ticket* positive review, such that the release manager will close it, with \"resolution: duplicate\".\n\nIf issues with `R_PROFILE` should (re)arise unrelated to (the installation of) the R spkg, i.e., which would have to be fixed elsewhere, we can still reopen *this* ticket.\n\n(IIRC some of the problems showed up *during doctesting*, but because `R_PROFILE` had been set *during installation*, so are now fixed by the new spkg. If there needs to be done more w.r.t. this -- which I don't think -- this can be addressed at #9906 as Karl-Dieter suggests.)\n\nNote that this ticket already has #9906 as its dependency.",
    "created_at": "2011-08-18T17:15:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116402",
    "user": "https://github.com/nexttime"
}
```

<a id='comment:7'></a>Replying to [comment:6 kcrisman]:
> Sorry I didn't come back to this.  It is correct that the spkgs at #9906 do this in the spkg scripts.  
> 
> So I can give this positive review as long as Leif promises that if I or some other reviewer find out that the fix at #9906 doesn't solve the type of problem above, that it will get addressed there and no longer here!


In that case, you should also give *this ticket* positive review, such that the release manager will close it, with "resolution: duplicate".

If issues with `R_PROFILE` should (re)arise unrelated to (the installation of) the R spkg, i.e., which would have to be fixed elsewhere, we can still reopen *this* ticket.

(IIRC some of the problems showed up *during doctesting*, but because `R_PROFILE` had been set *during installation*, so are now fixed by the new spkg. If there needs to be done more w.r.t. this -- which I don't think -- this can be addressed at #9906 as Karl-Dieter suggests.)

Note that this ticket already has #9906 as its dependency.



---

archive/issue_comments_116403.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2011-08-18T17:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116403",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_116404.json:
```json
{
    "body": "<a id='comment:8'></a>> > So I can give this positive review as long as Leif promises that if I or some other reviewer find out that the fix at #9906 doesn't solve the type of problem above, that it will get addressed there and no longer here!\n\n> \n> In that case, you should also give *this ticket* positive review, such that the release manager will close it, with \"resolution: duplicate\".\n\n\nCorrect.  I just wanted to make sure :)  Great.\n\n> (IIRC some of the problems showed up *during doctesting*, but because `R_PROFILE` had been set *during installation*, so are now fixed by the new spkg. If there needs to be done more w.r.t. this -- which I don't think -- this can be addressed at #9906 as Karl-Dieter suggests.)\n\nYeah, I'm pretty sure that was the issue, or more precisely that `R_PROFILE` was *not* (re)set.\n> Note that this ticket already has #9906 as its dependency.\n\nWell, that wouldn't be necessary with a duplicate/wontfix one.\n\nSee you at #9906, eventually (when I get time to do all the many tests on that).",
    "created_at": "2011-08-18T17:46:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116404",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:8'></a>> > So I can give this positive review as long as Leif promises that if I or some other reviewer find out that the fix at #9906 doesn't solve the type of problem above, that it will get addressed there and no longer here!

> 
> In that case, you should also give *this ticket* positive review, such that the release manager will close it, with "resolution: duplicate".


Correct.  I just wanted to make sure :)  Great.

> (IIRC some of the problems showed up *during doctesting*, but because `R_PROFILE` had been set *during installation*, so are now fixed by the new spkg. If there needs to be done more w.r.t. this -- which I don't think -- this can be addressed at #9906 as Karl-Dieter suggests.)

Yeah, I'm pretty sure that was the issue, or more precisely that `R_PROFILE` was *not* (re)set.
> Note that this ticket already has #9906 as its dependency.

Well, that wouldn't be necessary with a duplicate/wontfix one.

See you at #9906, eventually (when I get time to do all the many tests on that).



---

archive/issue_comments_116405.json:
```json
{
    "body": "Resolution: duplicate",
    "created_at": "2011-11-15T09:21:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116405",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: duplicate



---

archive/issue_events_024784.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-15T09:21:56Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9847#event-24784"
}
```



---

archive/issue_comments_116406.json:
```json
{
    "body": "Resolution changed from duplicate to ",
    "created_at": "2012-09-04T13:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116406",
    "user": "https://github.com/jdemeyer"
}
```

Resolution changed from duplicate to 



---

archive/issue_events_024785.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-04T13:37:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "milestone": "sage-duplicate/invalid/wontfix",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9847#event-24785"
}
```



---

archive/issue_events_024786.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-04T13:37:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "milestone": "sage-5.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9847#event-24786"
}
```



---

archive/issue_comments_116407.json:
```json
{
    "body": "Changing status from closed to new.",
    "created_at": "2012-09-04T13:37:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116407",
    "user": "https://github.com/jdemeyer"
}
```

Changing status from closed to new.



---

archive/issue_events_024787.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2012-09-04T13:37:44Z",
    "event": "reopened",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9847#event-24787"
}
```



---

archive/issue_comments_116408.json:
```json
{
    "body": "<a id='comment:11'></a>I order to finally finish #9906, I decided not to add this change anymore.",
    "created_at": "2012-09-04T13:38:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116408",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:11'></a>I order to finally finish #9906, I decided not to add this change anymore.



---

archive/issue_comments_116409.json:
```json
{
    "body": "<a id='comment:12'></a>Ok.  What was the solution there - simply `unset R_PROFILE` in its spkg-install as suggested in comment:2, or something more involved like in comment:1 (sage-env), or both, or... after reading Leif's comments and Georg's diagnosis in the thread in the description, maybe the simplest solution will be best.",
    "created_at": "2012-09-19T01:21:19Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116409",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:12'></a>Ok.  What was the solution there - simply `unset R_PROFILE` in its spkg-install as suggested in comment:2, or something more involved like in comment:1 (sage-env), or both, or... after reading Leif's comments and Georg's diagnosis in the thread in the description, maybe the simplest solution will be best.



---

archive/issue_comments_116410.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,6 +1,31 @@\n A preset `R_PROFILE` variable can cause some R packages to fail to build/install and interfere with doctests.\n \n Georg Grafendorfer [reported this problem on sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/b2827cba9319bfed/41eab313614e6d2a#41eab313614e6d2a).\n+\n+For `R_HOME`, this yields a doctest failure if set:\n+\n+```\n+**********************************************************************\n+File \"devel/sage/sage/misc/interpreter.py\", line 187, in sage.misc.interpreter.SageInteractiveShell.system_raw\n+Failed example:\n+    shell.system_raw('R --version')\n+Expected:\n+    R version ...\n+Got:\n+    WARNING: ignoring environment value of R_HOME\n+    R version 2.15.2 (2012-10-26) -- \"Trick or Treat\"\n+    Copyright (C) 2012 The R Foundation for Statistical Computing\n+    ISBN 3-900051-07-0\n+    Platform: x86_64-unknown-linux-gnu (64-bit)\n+    <BLANKLINE>\n+    R is free software and comes with ABSOLUTELY NO WARRANTY.\n+    You are welcome to redistribute it under the terms of the\n+    GNU General Public License versions 2 or 3.\n+    For more information about these matters see\n+    http://www.gnu.org/licenses/.\n+    <BLANKLINE>\n+**********************************************************************\n+```\n \n Comment: 1\n \n``````\n",
    "created_at": "2013-03-27T00:52:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116410",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,6 +1,31 @@
 A preset `R_PROFILE` variable can cause some R packages to fail to build/install and interfere with doctests.
 
 Georg Grafendorfer [reported this problem on sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/b2827cba9319bfed/41eab313614e6d2a#41eab313614e6d2a).
+
+For `R_HOME`, this yields a doctest failure if set:
+
+```
+**********************************************************************
+File "devel/sage/sage/misc/interpreter.py", line 187, in sage.misc.interpreter.SageInteractiveShell.system_raw
+Failed example:
+    shell.system_raw('R --version')
+Expected:
+    R version ...
+Got:
+    WARNING: ignoring environment value of R_HOME
+    R version 2.15.2 (2012-10-26) -- "Trick or Treat"
+    Copyright (C) 2012 The R Foundation for Statistical Computing
+    ISBN 3-900051-07-0
+    Platform: x86_64-unknown-linux-gnu (64-bit)
+    <BLANKLINE>
+    R is free software and comes with ABSOLUTELY NO WARRANTY.
+    You are welcome to redistribute it under the terms of the
+    GNU General Public License versions 2 or 3.
+    For more information about these matters see
+    http://www.gnu.org/licenses/.
+    <BLANKLINE>
+**********************************************************************
+```
 
 Comment: 1
 
``````




---

archive/issue_comments_116411.json:
```json
{
    "body": "Changing priority from major to blocker.",
    "created_at": "2013-03-27T00:53:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116411",
    "user": "https://github.com/jdemeyer"
}
```

Changing priority from major to blocker.



---

archive/issue_comments_116412.json:
```json
{
    "body": "Attachment [9847_unset_R.patch](tarball://root/attachments/some-uuid/ticket9847/9847_unset_R.patch) by @jdemeyer created at 2013-03-27 01:12:07",
    "created_at": "2013-03-27T01:12:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116412",
    "user": "https://github.com/jdemeyer"
}
```

Attachment [9847_unset_R.patch](tarball://root/attachments/some-uuid/ticket9847/9847_unset_R.patch) by @jdemeyer created at 2013-03-27 01:12:07



---

archive/issue_comments_116413.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,33 @@\n+A preset `R_PROFILE` variable can cause some R packages to fail to build/install and interfere with doctests.\n \n+Georg Grafendorfer [reported this problem on sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/b2827cba9319bfed/41eab313614e6d2a#41eab313614e6d2a).\n+\n+For `R_HOME`, this yields a doctest failure if set:\n+\n+```\n+**********************************************************************\n+File \"devel/sage/sage/misc/interpreter.py\", line 187, in sage.misc.interpreter.SageInteractiveShell.system_raw\n+Failed example:\n+    shell.system_raw('R --version')\n+Expected:\n+    R version ...\n+Got:\n+    WARNING: ignoring environment value of R_HOME\n+    R version 2.15.2 (2012-10-26) -- \"Trick or Treat\"\n+    Copyright (C) 2012 The R Foundation for Statistical Computing\n+    ISBN 3-900051-07-0\n+    Platform: x86_64-unknown-linux-gnu (64-bit)\n+    <BLANKLINE>\n+    R is free software and comes with ABSOLUTELY NO WARRANTY.\n+    You are welcome to redistribute it under the terms of the\n+    GNU General Public License versions 2 or 3.\n+    For more information about these matters see\n+    http://www.gnu.org/licenses/.\n+    <BLANKLINE>\n+**********************************************************************\n+```\n+\n+**Apply** [attachment:9847_unset_R.patch] to `SAGE_ROOT`.\n \n Comment: 1\n \n``````\n",
    "created_at": "2013-03-27T01:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116413",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,33 @@
+A preset `R_PROFILE` variable can cause some R packages to fail to build/install and interfere with doctests.
 
+Georg Grafendorfer [reported this problem on sage-release](http://groups.google.com/group/sage-release/browse_thread/thread/b2827cba9319bfed/41eab313614e6d2a#41eab313614e6d2a).
+
+For `R_HOME`, this yields a doctest failure if set:
+
+```
+**********************************************************************
+File "devel/sage/sage/misc/interpreter.py", line 187, in sage.misc.interpreter.SageInteractiveShell.system_raw
+Failed example:
+    shell.system_raw('R --version')
+Expected:
+    R version ...
+Got:
+    WARNING: ignoring environment value of R_HOME
+    R version 2.15.2 (2012-10-26) -- "Trick or Treat"
+    Copyright (C) 2012 The R Foundation for Statistical Computing
+    ISBN 3-900051-07-0
+    Platform: x86_64-unknown-linux-gnu (64-bit)
+    <BLANKLINE>
+    R is free software and comes with ABSOLUTELY NO WARRANTY.
+    You are welcome to redistribute it under the terms of the
+    GNU General Public License versions 2 or 3.
+    For more information about these matters see
+    http://www.gnu.org/licenses/.
+    <BLANKLINE>
+**********************************************************************
+```
+
+**Apply** [attachment:9847_unset_R.patch] to `SAGE_ROOT`.
 
 Comment: 1
 
``````




---

archive/issue_comments_116414.json:
```json
{
    "body": "Changing author from \"\" to \"Jeroen Demeyer\"",
    "created_at": "2013-03-27T01:12:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116414",
    "user": "https://github.com/jdemeyer"
}
```

Changing author from "" to "Jeroen Demeyer"



---

archive/issue_comments_116415.json:
```json
{
    "body": "<a id='comment:16'></a>Looks good, based on the various discussions in question.\n\nAnd the `R_HOME` and `R_PROFILE` will be \"reset\" after one exits the Sage shell, correct?  I do know that some people use their own custom R packages (or try to) but I guess that isn't supported behavior, given the structure of Sage.\n\nIn that case, applies and presumably works (I certainly can't test this, but based on all the above) so we should get this in, at long last.",
    "created_at": "2013-03-27T01:19:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116415",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:16'></a>Looks good, based on the various discussions in question.

And the `R_HOME` and `R_PROFILE` will be "reset" after one exits the Sage shell, correct?  I do know that some people use their own custom R packages (or try to) but I guess that isn't supported behavior, given the structure of Sage.

In that case, applies and presumably works (I certainly can't test this, but based on all the above) so we should get this in, at long last.



---

archive/issue_comments_116416.json:
```json
{
    "body": "<a id='comment:17'></a>Replying to [comment:16 kcrisman]:\n> And the `R_HOME` and `R_PROFILE` will be \"reset\" after one exits the Sage shell, correct?\n\nSure, although nothing is really \"reset\", you just get your old shell back which never saw `sage-env`.",
    "created_at": "2013-03-27T01:36:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116416",
    "user": "https://github.com/jdemeyer"
}
```

<a id='comment:17'></a>Replying to [comment:16 kcrisman]:
> And the `R_HOME` and `R_PROFILE` will be "reset" after one exits the Sage shell, correct?

Sure, although nothing is really "reset", you just get your old shell back which never saw `sage-env`.



---

archive/issue_comments_116417.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2013-03-27T01:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116417",
    "user": "https://github.com/kcrisman"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_116418.json:
```json
{
    "body": "<a id='comment:18'></a>Fair enough.  I think this is a realistic solution to this; I don't think we have to support combinations of these environments.  If someone really wanted to, they could set these things in `init.sage`, right?",
    "created_at": "2013-03-27T01:40:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116418",
    "user": "https://github.com/kcrisman"
}
```

<a id='comment:18'></a>Fair enough.  I think this is a realistic solution to this; I don't think we have to support combinations of these environments.  If someone really wanted to, they could set these things in `init.sage`, right?



---

archive/issue_comments_116419.json:
```json
{
    "body": "Changing status from needs_review to positive_review.",
    "created_at": "2013-03-27T01:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116419",
    "user": "https://github.com/kcrisman"
}
```

Changing status from needs_review to positive_review.



---

archive/issue_comments_116420.json:
```json
{
    "body": "Changing dependencies from \"#9906\" to \"\"",
    "created_at": "2013-03-27T01:40:46Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116420",
    "user": "https://github.com/kcrisman"
}
```

Changing dependencies from "#9906" to ""



---

archive/issue_events_024788.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-03-28T17:55:25Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9847#event-24788"
}
```



---

archive/issue_comments_116421.json:
```json
{
    "body": "Changing merged from \"\" to \"sage-5.9.beta2\"",
    "created_at": "2013-03-28T17:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116421",
    "user": "https://github.com/jdemeyer"
}
```

Changing merged from "" to "sage-5.9.beta2"



---

archive/issue_comments_116422.json:
```json
{
    "body": "Resolution: fixed",
    "created_at": "2013-03-28T17:55:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9847",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9847#issuecomment-116422",
    "user": "https://github.com/jdemeyer"
}
```

Resolution: fixed
