# Issue 9706: Symbolic Chebyshev polynomials

archive/issues_009706.json:
```json
{
    "assignees": [
        "https://github.com/burcin",
        "https://github.com/sagetrac-maldun"
    ],
    "body": "<div id=\"comment:0\"></div>\n\nApply:\n\n* [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)\n* [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)\n* [attachment: trac_9706_new_base_classes.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)\n* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n\nDepends on #864\nDepends on #9640\nDepends on #10018\nDepends on #11868\nDepends on #15422\n\nCC:  @fredrik-johansson @sagetrac-fstan @kcrisman\n\nComponent: **symbolics**\n\nKeywords: **orthogonal polynomials, symbolics**\n\nAuthor: **Stefan Reiterer**\n\nBranch/Commit: **[u/vbraun/chebyshev](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/chebyshev) @ [`bb227b6`](https://github.com/sagemath/sagetrac-mirror/commit/bb227b60e93b7d8806b32b00874351b9201123cd)**\n\nReviewer: **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer, Jeroen Demeyer**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9706_\n\n",
    "closed_at": "2013-12-21T18:43:54Z",
    "created_at": "2010-08-08T00:37:05Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
        "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-6.1",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Symbolic Chebyshev polynomials",
    "type": "issue",
    "updated_at": "2013-12-21T18:43:54Z",
    "url": "https://github.com/sagemath/sage/issues/9706",
    "user": "https://github.com/sagetrac-maldun"
}
```
<div id="comment:0"></div>

Apply:

* [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)
* [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)
* [attachment: trac_9706_new_base_classes.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)
* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)

Depends on #864
Depends on #9640
Depends on #10018
Depends on #11868
Depends on #15422

CC:  @fredrik-johansson @sagetrac-fstan @kcrisman

Component: **symbolics**

Keywords: **orthogonal polynomials, symbolics**

Author: **Stefan Reiterer**

Branch/Commit: **[u/vbraun/chebyshev](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/chebyshev) @ [`bb227b6`](https://github.com/sagemath/sagetrac-mirror/commit/bb227b60e93b7d8806b32b00874351b9201123cd)**

Reviewer: **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer, Jeroen Demeyer**

_Issue created by migration from https://trac.sagemath.org/ticket/9706_





---

archive/issue_events_124296.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-08T00:37:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20symbolics",
    "label_color": "0000ff",
    "label_name": "c: symbolics",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124296"
}
```



---

archive/issue_events_124297.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-08T00:37:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124297"
}
```



---

archive/issue_events_124298.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-08T00:37:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124298"
}
```



---

archive/issue_events_124299.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-08-08T00:37:05Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "subject": "https://github.com/sagetrac-maldun",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124299"
}
```



---

archive/issue_comments_085249.json:
```json
{
    "body": "Attachment: **[orthogonal_polys.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.py.gz)**\n\nA new version of the orthogonal_polys.py file.",
    "created_at": "2010-08-09T00:13:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85249",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[orthogonal_polys.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.py.gz)**

A new version of the orthogonal_polys.py file.



---

archive/issue_comments_085250.json:
```json
{
    "body": "Newer version, with legendre_P, and faster evaluation of symbolic expressions",
    "created_at": "2010-08-09T00:13:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85250",
    "user": "https://github.com/sagetrac-maldun"
}
```

Newer version, with legendre_P, and faster evaluation of symbolic expressions



---

archive/issue_comments_085251.json:
```json
{
    "body": "Attachment: **[orthogonal_polys.2.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.2.py.gz)**\n\nAttachment: **[orthogonal_polys.3.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.3.py.gz)**\n\nVersion from 10. August 2010",
    "created_at": "2010-08-10T16:57:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85251",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[orthogonal_polys.2.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.2.py.gz)**

Attachment: **[orthogonal_polys.3.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.3.py.gz)**

Version from 10. August 2010



---

archive/issue_comments_085252.json:
```json
{
    "body": "Latest version. It holds classes of all polys (but not all completed yet)",
    "created_at": "2010-08-11T00:07:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85252",
    "user": "https://github.com/sagetrac-maldun"
}
```

Latest version. It holds classes of all polys (but not all completed yet)



---

archive/issue_comments_085253.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">comment:1</div>\n\nAttachment: **[orthogonal_polys.4.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.4.py.gz)**\n\nAll Polys now have their own class.\nMuch faster evaluation is added.\nNumerical evaluation is provided. \nExcept for legendre_Q, gen_legendre_P, and gen_legendre_Q these aren't ready yet",
    "created_at": "2010-08-11T00:09:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85253",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:1" align="right">comment:1</div>

Attachment: **[orthogonal_polys.4.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.4.py.gz)**

All Polys now have their own class.
Much faster evaluation is added.
Numerical evaluation is provided. 
Except for legendre_Q, gen_legendre_P, and gen_legendre_Q these aren't ready yet



---

archive/issue_comments_085254.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">comment:2</div>\n\nReplying to [@sagetrac-maldun](#comment%3A1):\n> All Polys now have their own class.\n> Much faster evaluation is added.\n> Numerical evaluation is provided. \n> Except for legendre_Q, gen_legendre_P, and gen_legendre_Q these aren't ready yet\n\northogonal_polys4.py hold all changes but is not a patch yet, because it holds old code fragments,\nwhich I have to clean up...",
    "created_at": "2010-08-11T00:11:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85254",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:2" align="right">comment:2</div>

Replying to [@sagetrac-maldun](#comment%3A1):
> All Polys now have their own class.
> Much faster evaluation is added.
> Numerical evaluation is provided. 
> Except for legendre_Q, gen_legendre_P, and gen_legendre_Q these aren't ready yet

orthogonal_polys4.py hold all changes but is not a patch yet, because it holds old code fragments,
which I have to clean up...



---

archive/issue_comments_085255.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nI added in the latest patch (and orthogonal_polys.4.py contains these changes also) a new symbolic evaluation method for the orthogonal polynomials: Instead of call Maxima or use of the recursion, the polynomial is evaluated just using explicit formulas from Abramowitz and Stegun. This is an O(n) algorithm of course.\n\na little comparison on my machine:\nold version:\n\nsage: time chebyshev_T(10,x);\nCPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s\nWall time: 0.04 s\nsage: time chebyshev_T(100,x);\nCPU times: user 0.13 s, sys: 0.01 s, total: 0.14 s\nWall time: 0.23 s\nsage: time chebyshev_T(1000,x);\nCPU times: user 5.01 s, sys: 0.01 s, total: 5.02 s\nWall time: 6.98 s\nsage time chebyshev_T(5000,x);\n??? (I got no output her after 2min)\n\nsage: time gegenbauer(10,5,x);\nCPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s\nWall time: 0.05 s\nsage: time gegenbauer(100,5,x);\nCPU times: user 0.19 s, sys: 0.00 s, total: 0.19 s\nWall time: 0.29 s\nsage: time gegenbauer(1000,5,x);\nCPU times: user 5.46 s, sys: 0.02 s, total: 5.48 s\nWall time: 7.79 s\n\n\nNew Version\nsage: time chebyshev_T(10,x);\nCPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s\nWall time: 0.01 s\nsage: time chebyshev_T(100,x);\nCPU times: user 0.06 s, sys: 0.00 s, total: 0.06 s\nWall time: 0.08 s\nsage: time chebyshev_T(1000,x);\nCPU times: user 1.22 s, sys: 0.00 s, total: 1.22 s\nWall time: 1.22 s\nsage: time chebyshev_T(5000,x);\nCPU times: user 27.17 s, sys: 0.15 s, total: 27.32 s\nWall time: 27.46 s\n\nsage: time gegenbauer(10,5,x);\nCPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s\nWall time: 0.01 s\nsage: time gegenbauer(100,5,x);\nCPU times: user 0.03 s, sys: 0.00 s, total: 0.03 s\nWall time: 0.04 s\nsage: time gegenbauer(1000,5,x);\nCPU times: user 1.08 s, sys: 0.01 s, total: 1.09 s\nWall time: 1.11 s\n\n \nA little bit faster :) I also don't need to spawn an instance of maxima which makes the initialisation faster.\n\nAnd now also wider symbolic evaluation is possible:\n\nold version:\nsage: var('a')\na\nsage: gegenbauer(3,a,x)\n...\nNameError: name 'a' is not defined\n\nnew version:\nsage: var('a')\na\nsage: gegenbauer(3,a,x)\n4/3*x^3*gamma(a + 3) - 2*x*gamma(a + 2)\n\nThe code needs now some cleanup, especially the documentations.\nThe complete versions for legendre_Q, gen_legendre_P, and gen_legendre_Q will not be finished\nsoon since the mpmath functions, don't seem to work correctly...\nI only provide a call function for maxima for them now.",
    "created_at": "2010-08-12T10:25:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85255",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:4" align="right">comment:4</div>

I added in the latest patch (and orthogonal_polys.4.py contains these changes also) a new symbolic evaluation method for the orthogonal polynomials: Instead of call Maxima or use of the recursion, the polynomial is evaluated just using explicit formulas from Abramowitz and Stegun. This is an O(n) algorithm of course.

a little comparison on my machine:
old version:

sage: time chebyshev_T(10,x);
CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s
Wall time: 0.04 s
sage: time chebyshev_T(100,x);
CPU times: user 0.13 s, sys: 0.01 s, total: 0.14 s
Wall time: 0.23 s
sage: time chebyshev_T(1000,x);
CPU times: user 5.01 s, sys: 0.01 s, total: 5.02 s
Wall time: 6.98 s
sage time chebyshev_T(5000,x);
??? (I got no output her after 2min)

sage: time gegenbauer(10,5,x);
CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s
Wall time: 0.05 s
sage: time gegenbauer(100,5,x);
CPU times: user 0.19 s, sys: 0.00 s, total: 0.19 s
Wall time: 0.29 s
sage: time gegenbauer(1000,5,x);
CPU times: user 5.46 s, sys: 0.02 s, total: 5.48 s
Wall time: 7.79 s


New Version
sage: time chebyshev_T(10,x);
CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s
Wall time: 0.01 s
sage: time chebyshev_T(100,x);
CPU times: user 0.06 s, sys: 0.00 s, total: 0.06 s
Wall time: 0.08 s
sage: time chebyshev_T(1000,x);
CPU times: user 1.22 s, sys: 0.00 s, total: 1.22 s
Wall time: 1.22 s
sage: time chebyshev_T(5000,x);
CPU times: user 27.17 s, sys: 0.15 s, total: 27.32 s
Wall time: 27.46 s

sage: time gegenbauer(10,5,x);
CPU times: user 0.01 s, sys: 0.00 s, total: 0.01 s
Wall time: 0.01 s
sage: time gegenbauer(100,5,x);
CPU times: user 0.03 s, sys: 0.00 s, total: 0.03 s
Wall time: 0.04 s
sage: time gegenbauer(1000,5,x);
CPU times: user 1.08 s, sys: 0.01 s, total: 1.09 s
Wall time: 1.11 s

 
A little bit faster :) I also don't need to spawn an instance of maxima which makes the initialisation faster.

And now also wider symbolic evaluation is possible:

old version:
sage: var('a')
a
sage: gegenbauer(3,a,x)
...
NameError: name 'a' is not defined

new version:
sage: var('a')
a
sage: gegenbauer(3,a,x)
4/3*x^3*gamma(a + 3) - 2*x*gamma(a + 2)

The code needs now some cleanup, especially the documentations.
The complete versions for legendre_Q, gen_legendre_P, and gen_legendre_Q will not be finished
soon since the mpmath functions, don't seem to work correctly...
I only provide a call function for maxima for them now.



---

archive/issue_comments_085256.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\n> The complete versions for legendre_Q, gen_legendre_P, and gen_legendre_Q will not be finished soon since the mpmath functions, don't seem to work correctly...\n\nCare to elaborate?",
    "created_at": "2010-08-12T11:12:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85256",
    "user": "https://github.com/fredrik-johansson"
}
```

<div id="comment:5" align="right">comment:5</div>

> The complete versions for legendre_Q, gen_legendre_P, and gen_legendre_Q will not be finished soon since the mpmath functions, don't seem to work correctly...

Care to elaborate?



---

archive/issue_comments_085257.json:
```json
{
    "body": "Attachment: **[orthogonal_polys.5.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.5.py.gz)**\n\nLatest version from 12. August 2010 (with bugfix in legendre_P)",
    "created_at": "2010-08-12T11:16:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85257",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[orthogonal_polys.5.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.5.py.gz)**

Latest version from 12. August 2010 (with bugfix in legendre_P)



---

archive/issue_comments_085258.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nKilled bug in legendre_P",
    "created_at": "2010-08-12T11:16:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85258",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:6" align="right">comment:6</div>

Killed bug in legendre_P



---

archive/issue_comments_085259.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nReplying to [@fredrik-johansson](#comment%3A5):\n> > The complete versions for legendre_Q, gen_legendre_P, and gen_legendre_Q will not be finished soon since the mpmath functions, don't seem to work correctly...\n> \n> \n> Care to elaborate?\n\nSorry for the late answer, I was on holidays.\n\nIn mpmath I have probs with the legenp and legenq functions. For some inputs I get this error:\n\n```\nsage: mpmath.call(mpmath.legenp,5,1,2)\n---------------------------------------------------------------------------\nOverflowError                             Traceback (most recent call last)\n\n/home/maldun/prog/sage/ortho/<ipython console> in <module>()\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/mpmath/utils.c:5021)()\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/functions/hypergeometric.pyc in legenp(ctx, n, m, z, type, **kwargs)\n   1481             T = [1+z, 1-z], [g, -g], [], [1-m], [-n, n+1], [1-m], 0.5*(1-z)\n   1482             return (T,)\n-> 1483         return ctx.hypercomb(h, [n,m], **kwargs)\n   1484     if type == 3:\n   1485         def h(n,m):\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/functions/hypergeometric.pyc in hypercomb(ctx, function, params, discard_known_zeros, **kwargs)\n    125                     [ctx.gamma(a) for a in alpha_s] + \\\n    126                     [ctx.rgamma(b) for b in beta_s] + \\\n--> 127                     [ctx.power(w,c) for (w,c) in zip(w_s,c_s)])\n    128                 if verbose:\n    129                     print \"    Value:\", v\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/ctx_base.pyc in power(ctx, x, y)\n    417             3.16470269330255923143453723949e+12978188\n    418         \"\"\"\n--> 419         return ctx.convert(x) ** ctx.convert(y)\n    420 \n    421     def _zeta_int(ctx, n):\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.mpnumber.__pow__ (sage/libs/mpmath/ext_main.c:13946)()\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.binop (sage/libs/mpmath/ext_main.c:4588)()\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in mpf_pow(s, t, prec, rnd)\n    340     # General formula: s**t = exp(t*log(s))\n    341     # TODO: handle rnd direction of the logarithm carefully\n--> 342     c = mpf_log(s, prec+10, rnd)\n    343     return mpf_exp(mpf_mul(t, c), prec, rnd)\n    344 \n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in mpf_log(x, prec, rnd)\n    725     # optimal between 1000 and 100,000 digits.\n    726     if wp <= LOG_TAYLOR_PREC:\n--> 727         m = log_taylor_cached(lshift(man, wp-bc), wp)\n    728         if mag:\n    729             m += mag*ln2_fixed(wp)\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in log_taylor_cached(x, prec)\n    643     else:\n    644         a = n << (cached_prec - LOG_TAYLOR_SHIFT)\n--> 645         log_a = log_taylor(a, cached_prec, 8)\n    646         log_taylor_cache[n, cached_prec] = (a, log_a)\n    647     a >>= dprec\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in log_taylor(x, prec, r)\n    607     \"\"\"\n    608     for i in xrange(r):\n--> 609         x = isqrt_fast(x<<prec)\n    610     one = MPZ_ONE << prec\n    611     v = ((x-one)<<prec)//(x+one)\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libintmath.pyc in isqrt_fast_python(x)\n    240                     y = (y + x//y) >> 1\n    241         return y\n--> 242     bc = bitcount(x)\n    243     guard_bits = 10\n    244     x <<= 2*guard_bits\n\n/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libintmath.pyc in python_bitcount(n)\n     78     if bc != 300:\n     79         return bc\n---> 80     bc = int(math.log(n, 2)) - 4\n     81     return bc + bctable[n>>bc]\n     82 \n\nOverflowError: cannot convert float infinity to integer\n```",
    "created_at": "2010-08-16T11:51:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85259",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:7" align="right">comment:7</div>

Replying to [@fredrik-johansson](#comment%3A5):
> > The complete versions for legendre_Q, gen_legendre_P, and gen_legendre_Q will not be finished soon since the mpmath functions, don't seem to work correctly...
> 
> 
> Care to elaborate?

Sorry for the late answer, I was on holidays.

In mpmath I have probs with the legenp and legenq functions. For some inputs I get this error:

```
sage: mpmath.call(mpmath.legenp,5,1,2)
---------------------------------------------------------------------------
OverflowError                             Traceback (most recent call last)

/home/maldun/prog/sage/ortho/<ipython console> in <module>()

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/mpmath/utils.c:5021)()

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/functions/hypergeometric.pyc in legenp(ctx, n, m, z, type, **kwargs)
   1481             T = [1+z, 1-z], [g, -g], [], [1-m], [-n, n+1], [1-m], 0.5*(1-z)
   1482             return (T,)
-> 1483         return ctx.hypercomb(h, [n,m], **kwargs)
   1484     if type == 3:
   1485         def h(n,m):

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/functions/hypergeometric.pyc in hypercomb(ctx, function, params, discard_known_zeros, **kwargs)
    125                     [ctx.gamma(a) for a in alpha_s] + \
    126                     [ctx.rgamma(b) for b in beta_s] + \
--> 127                     [ctx.power(w,c) for (w,c) in zip(w_s,c_s)])
    128                 if verbose:
    129                     print "    Value:", v

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/ctx_base.pyc in power(ctx, x, y)
    417             3.16470269330255923143453723949e+12978188
    418         """
--> 419         return ctx.convert(x) ** ctx.convert(y)
    420 
    421     def _zeta_int(ctx, n):

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.mpnumber.__pow__ (sage/libs/mpmath/ext_main.c:13946)()

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.binop (sage/libs/mpmath/ext_main.c:4588)()

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in mpf_pow(s, t, prec, rnd)
    340     # General formula: s**t = exp(t*log(s))
    341     # TODO: handle rnd direction of the logarithm carefully
--> 342     c = mpf_log(s, prec+10, rnd)
    343     return mpf_exp(mpf_mul(t, c), prec, rnd)
    344 

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in mpf_log(x, prec, rnd)
    725     # optimal between 1000 and 100,000 digits.
    726     if wp <= LOG_TAYLOR_PREC:
--> 727         m = log_taylor_cached(lshift(man, wp-bc), wp)
    728         if mag:
    729             m += mag*ln2_fixed(wp)

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in log_taylor_cached(x, prec)
    643     else:
    644         a = n << (cached_prec - LOG_TAYLOR_SHIFT)
--> 645         log_a = log_taylor(a, cached_prec, 8)
    646         log_taylor_cache[n, cached_prec] = (a, log_a)
    647     a >>= dprec

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libelefun.pyc in log_taylor(x, prec, r)
    607     """
    608     for i in xrange(r):
--> 609         x = isqrt_fast(x<<prec)
    610     one = MPZ_ONE << prec
    611     v = ((x-one)<<prec)//(x+one)

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libintmath.pyc in isqrt_fast_python(x)
    240                     y = (y + x//y) >> 1
    241         return y
--> 242     bc = bitcount(x)
    243     guard_bits = 10
    244     x <<= 2*guard_bits

/home/maldun/sage/sage-4.5.1/local/lib/python2.6/site-packages/mpmath/libmp/libintmath.pyc in python_bitcount(n)
     78     if bc != 300:
     79         return bc
---> 80     bc = int(math.log(n, 2)) - 4
     81     return bc + bctable[n>>bc]
     82 

OverflowError: cannot convert float infinity to integer
```



---

archive/issue_comments_085260.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nThat looks strange. I get:\n\n```\nsage: import sage.libs.mpmath.all as mpmath\nsage: mpmath.call(mpmath.legenp, 5,1,2)\n-2.96434298694874e-22 - 912.574269237852*I\nsage: mpmath.call(mpmath.legenp, 5,1,2, prec=100)\n-2.1062923756778274648015607872e-36 - 912.57426923785222402727329118*I\n```",
    "created_at": "2010-08-16T15:55:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85260",
    "user": "https://github.com/fredrik-johansson"
}
```

<div id="comment:8" align="right">comment:8</div>

That looks strange. I get:

```
sage: import sage.libs.mpmath.all as mpmath
sage: mpmath.call(mpmath.legenp, 5,1,2)
-2.96434298694874e-22 - 912.574269237852*I
sage: mpmath.call(mpmath.legenp, 5,1,2, prec=100)
-2.1062923756778274648015607872e-36 - 912.57426923785222402727329118*I
```



---

archive/issue_comments_085261.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nReplying to [@fredrik-johansson](#comment%3A8):\n> That looks strange. I get:\n> \n> ```\n> sage: import sage.libs.mpmath.all as mpmath\n> sage: mpmath.call(mpmath.legenp, 5,1,2)\n> -2.96434298694874e-22 - 912.574269237852*I\n> sage: mpmath.call(mpmath.legenp, 5,1,2, prec=100)\n> -2.1062923756778274648015607872e-36 - 912.57426923785222402727329118*I\n> ```\n\nHm strange. Today I install the new Sage version, perhaps it will then work again",
    "created_at": "2010-08-17T08:54:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85261",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:9" align="right">comment:9</div>

Replying to [@fredrik-johansson](#comment%3A8):
> That looks strange. I get:
> 
> ```
> sage: import sage.libs.mpmath.all as mpmath
> sage: mpmath.call(mpmath.legenp, 5,1,2)
> -2.96434298694874e-22 - 912.574269237852*I
> sage: mpmath.call(mpmath.legenp, 5,1,2, prec=100)
> -2.1062923756778274648015607872e-36 - 912.57426923785222402727329118*I
> ```

Hm strange. Today I install the new Sage version, perhaps it will then work again



---

archive/issue_comments_085262.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">comment:10</div>\n\nReplying to [@fredrik-johansson](#comment%3A8):\n> That looks strange. I get:\n> \n> ```\n> sage: import sage.libs.mpmath.all as mpmath\n> sage: mpmath.call(mpmath.legenp, 5,1,2)\n> -2.96434298694874e-22 - 912.574269237852*I\n> sage: mpmath.call(mpmath.legenp, 5,1,2, prec=100)\n> -2.1062923756778274648015607872e-36 - 912.57426923785222402727329118*I\n> ```\n\nIt was the old version!a Thanx for pointing that out, I will continue soon =)",
    "created_at": "2010-08-18T16:31:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85262",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:10" align="right">comment:10</div>

Replying to [@fredrik-johansson](#comment%3A8):
> That looks strange. I get:
> 
> ```
> sage: import sage.libs.mpmath.all as mpmath
> sage: mpmath.call(mpmath.legenp, 5,1,2)
> -2.96434298694874e-22 - 912.574269237852*I
> sage: mpmath.call(mpmath.legenp, 5,1,2, prec=100)
> -2.1062923756778274648015607872e-36 - 912.57426923785222402727329118*I
> ```

It was the old version!a Thanx for pointing that out, I will continue soon =)



---

archive/issue_comments_085263.json:
```json
{
    "body": "Version from 19. August 2010",
    "created_at": "2010-08-19T16:24:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85263",
    "user": "https://github.com/sagetrac-maldun"
}
```

Version from 19. August 2010



---

archive/issue_comments_085264.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nAttachment: **[orthogonal_polys.6.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.6.py.gz)**\n\nSo now a \"beta\" is ready with full support of all classes.\n\nOnly the Legendre functions are still using Maxima.\n\nsome advances for the future:\n\n-Zernike polys (this should be done in the next time, since explicit formulas are available)\n-support for numpy_eval. (But this will be done, when the scipy package is updated to 0.8, else it has no sense, because the current version of scipy does not support ortho polys well, but the newer can handle them)\n\nNow I need some people for testing this out =)",
    "created_at": "2010-08-19T16:30:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85264",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:11" align="right">comment:11</div>

Attachment: **[orthogonal_polys.6.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.6.py.gz)**

So now a "beta" is ready with full support of all classes.

Only the Legendre functions are still using Maxima.

some advances for the future:

-Zernike polys (this should be done in the next time, since explicit formulas are available)
-support for numpy_eval. (But this will be done, when the scipy package is updated to 0.8, else it has no sense, because the current version of scipy does not support ortho polys well, but the newer can handle them)

Now I need some people for testing this out =)



---

archive/issue_comments_085265.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nAnd there was an interisting bug:\n\nthe import of mpmath at the beginning of the file caused the whole trouble I had with the numeric evaluation of the legendre functions....\n\nI think I should report this..",
    "created_at": "2010-08-19T16:34:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85265",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:12" align="right">comment:12</div>

And there was an interisting bug:

the import of mpmath at the beginning of the file caused the whole trouble I had with the numeric evaluation of the legendre functions....

I think I should report this..



---

archive/issue_events_124300.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-19T16:35:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124300"
}
```



---

archive/issue_events_124301.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-19T16:35:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124301"
}
```



---

archive/issue_comments_085266.json:
```json
{
    "body": "Added numpy support, eliminated some bugs (19.08.2010)",
    "created_at": "2010-08-19T19:54:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85266",
    "user": "https://github.com/sagetrac-maldun"
}
```

Added numpy support, eliminated some bugs (19.08.2010)



---

archive/issue_comments_085267.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nAttachment: **[orthogonal_polys.7.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.7.py.gz)**\n\n> -support for numpy_eval. (But this will be done, when the scipy package is updated to 0.8, else it has no sense, because the current version of scipy does not support ortho polys well, but the newer can handle them)\n\nI decided to give at least some numpy support for compability reasons.\nBut this is a bad hack...when scipy 0.8 comes I use scipy itself, I change this to a better version :)",
    "created_at": "2010-08-19T20:09:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85267",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:14" align="right">comment:14</div>

Attachment: **[orthogonal_polys.7.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.7.py.gz)**

> -support for numpy_eval. (But this will be done, when the scipy package is updated to 0.8, else it has no sense, because the current version of scipy does not support ortho polys well, but the newer can handle them)

I decided to give at least some numpy support for compability reasons.
But this is a bad hack...when scipy 0.8 comes I use scipy itself, I change this to a better version :)



---

archive/issue_events_124302.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-19T23:56:01Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124302"
}
```



---

archive/issue_events_124303.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-19T23:57:41Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124303"
}
```



---

archive/issue_comments_085268.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nSome of the old doctests fail.\nBut it is not my fault, it seem's that it is a bug in the SymbolicFunction class.\n\nsee: https://github.com/sagemath/sage/issues/9769",
    "created_at": "2010-08-20T00:08:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85268",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:17" align="right">comment:17</div>

Some of the old doctests fail.
But it is not my fault, it seem's that it is a bug in the SymbolicFunction class.

see: https://github.com/sagemath/sage/issues/9769



---

archive/issue_events_124304.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-20T00:17:36Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124304"
}
```



---

archive/issue_events_124305.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-20T00:17:36Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "milestone_number": null,
    "milestone_title": "sage-4.5.3",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124305"
}
```



---

archive/issue_comments_085269.json:
```json
{
    "body": "Attachment: **[orthogonal_polys.8.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.8.py.gz)**\n\nLatest version with some code cleanup (no program changes)",
    "created_at": "2010-08-24T21:31:01Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85269",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[orthogonal_polys.8.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.8.py.gz)**

Latest version with some code cleanup (no program changes)



---

archive/issue_events_124306.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-08-26T14:50:26Z",
    "event": "assigned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "subject": "https://github.com/sagetrac-maldun",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124306"
}
```



---

archive/issue_comments_085270.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nHi Stefan,\n\ncan you post a patch corresponding to [attachment: orthogonal_polys.8.py](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.8.py.gz) for review?\n\nThanks,\n\nBurcin",
    "created_at": "2010-08-28T12:03:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85270",
    "user": "https://github.com/burcin"
}
```

<div id="comment:20" align="right">comment:20</div>

Hi Stefan,

can you post a patch corresponding to [attachment: orthogonal_polys.8.py](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.8.py.gz) for review?

Thanks,

Burcin



---

archive/issue_comments_085271.json:
```json
{
    "body": "Patch for latest version with some code cleanup (no program changes)",
    "created_at": "2010-08-28T16:49:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85271",
    "user": "https://github.com/sagetrac-maldun"
}
```

Patch for latest version with some code cleanup (no program changes)



---

archive/issue_comments_085272.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nAttachment: **[trac_9706_ortho_polys.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_ortho_polys.patch.gz)**\n\nReplying to [@burcin](#comment%3A20):\n> Hi Stefan,\n> \n> can you post a patch corresponding to [attachment: orthogonal_polys.8.py](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.8.py.gz) for review?\n> \n> Thanks,\n\n> Burcin\n\nDone!",
    "created_at": "2010-08-28T16:50:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85272",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:21" align="right">comment:21</div>

Attachment: **[trac_9706_ortho_polys.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_ortho_polys.patch.gz)**

Replying to [@burcin](#comment%3A20):
> Hi Stefan,
> 
> can you post a patch corresponding to [attachment: orthogonal_polys.8.py](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.8.py.gz) for review?
> 
> Thanks,

> Burcin

Done!



---

archive/issue_comments_085273.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nWhy is mpmath's precision used by default? Shouldn't the default be RR / CC precision? Actually, does `_evalf_` ever get called without this information?\n\nSome complex tests would be nice.",
    "created_at": "2010-09-03T13:07:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85273",
    "user": "https://github.com/fredrik-johansson"
}
```

<div id="comment:22" align="right">comment:22</div>

Why is mpmath's precision used by default? Shouldn't the default be RR / CC precision? Actually, does `_evalf_` ever get called without this information?

Some complex tests would be nice.



---

archive/issue_comments_085274.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@fredrik-johansson](#comment%3A22):\n> Why is mpmath's precision used by default? Shouldn't the default be RR / CC precision? Actually, does `_evalf_` ever get called without this information?\n> \n> Some complex tests would be nice.\n> \n\nThis is a good point, and it shouldn't be a problem to change that.\nBut I don't think it's a big deal, because the function takes the \"parents\" precision, which means, if my input is RR it evals it with RR's precision.\n\nOf course can you call `_evalf_` just with (), and then the default value is used.\n\nI just sticked to the old's version tests, and expanded it. Of course it's possible to expand the tests. I hope I will find some time for it soon, since I have some other more urgent things todo also.",
    "created_at": "2010-09-03T19:59:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85274",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@fredrik-johansson](#comment%3A22):
> Why is mpmath's precision used by default? Shouldn't the default be RR / CC precision? Actually, does `_evalf_` ever get called without this information?
> 
> Some complex tests would be nice.
> 

This is a good point, and it shouldn't be a problem to change that.
But I don't think it's a big deal, because the function takes the "parents" precision, which means, if my input is RR it evals it with RR's precision.

Of course can you call `_evalf_` just with (), and then the default value is used.

I just sticked to the old's version tests, and expanded it. Of course it's possible to expand the tests. I hope I will find some time for it soon, since I have some other more urgent things todo also.



---

archive/issue_comments_085275.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nReplying to [@sagetrac-maldun](#comment%3A23):\n> Replying to [@fredrik-johansson](#comment%3A22):\n> > Why is mpmath's precision used by default? Shouldn't the default be RR / CC precision? Actually, does `_evalf_` ever get called without this information?\n> > \n> > Some complex tests would be nice.\n> > \n> \n> \n> This is a good point, and it shouldn't be a problem to change that.\n> But I don't think it's a big deal, because the function takes the \"parents\" precision, which means, if my input is RR it evals it with RR's precision.\n> \n> Of course can you call `_evalf_` just with (), and then the default value is used.\n> \n\nOk sorry, wrong explination: when your input are exact data types like ZZ ore QQ then the parent has no precision, then you need a default value",
    "created_at": "2010-09-03T20:05:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85275",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:24" align="right">comment:24</div>

Replying to [@sagetrac-maldun](#comment%3A23):
> Replying to [@fredrik-johansson](#comment%3A22):
> > Why is mpmath's precision used by default? Shouldn't the default be RR / CC precision? Actually, does `_evalf_` ever get called without this information?
> > 
> > Some complex tests would be nice.
> > 
> 
> 
> This is a good point, and it shouldn't be a problem to change that.
> But I don't think it's a big deal, because the function takes the "parents" precision, which means, if my input is RR it evals it with RR's precision.
> 
> Of course can you call `_evalf_` just with (), and then the default value is used.
> 

Ok sorry, wrong explination: when your input are exact data types like ZZ ore QQ then the parent has no precision, then you need a default value



---

archive/issue_comments_085276.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nSince it seems that numpy-1.4.1, and scipy 0.8 should work now (see #9808) I programmed a version which uses scipy itself to evaluate the orthogonal polys for numpy arrays. \nWhen the new versions of numpy/scipy become merged into sage I will provide a patch for these.\n\nAnother thing I have to mention are these 2 failde doctests:\n* sage -t  -long \"devel/sage/sage/symbolic/random_tests.py\"\n* sage -t  -long \"devel/sage/sage/symbolic/pynac.pyx\"\n\n```\nsage -t -long \"devel/sage/sage/symbolic/random_tests.py\"    \n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/random_tests.py\", line 17:\n    sage: [f for (one,f,arity) in _mk_full_functions()]\nExpected:\n    [Ei, abs, arccos, arccosh, arccot, arccoth, arccsc, arccsch,\n    arcsec, arcsech, arcsin, arcsinh, arctan, arctan2, arctanh,\n    binomial, ceil, conjugate, cos, cosh, cot, coth, csc, csch,\n    dickman_rho, dilog, dirac_delta, elliptic_e, elliptic_ec,\n    elliptic_eu, elliptic_f, elliptic_kc, elliptic_pi, erf, exp,\n    factorial, floor, heaviside, imag_part, integrate,\n    kronecker_delta, log, polylog, real_part, sec, sech, sgn, sin,\n    sinh, tan, tanh, unit_step, zeta, zetaderiv]\nGot:\n    [Ei, abs, arccos, arccosh, arccot, arccoth, arccsc, arccsch, arcsec, arcsech, arcsin, arcsinh, arctan, arctan2, arctanh, binomial, ceil, chebyshev_T, chebyshev_U, conjugate, cos, cosh, cot, coth, csc, csch, dickman_rho, dilog, dirac_delta, elliptic_e, elliptic_ec, elliptic_eu, elliptic_f, elliptic_kc, elliptic_pi, erf, exp, factorial, floor, gegenbauer, gen_laguerre, gen_legendre_P, gen_legendre_Q, heaviside, hermite, imag_part, integrate, jacobi_P, kronecker_delta, laguerre, legendre_P, legendre_Q, log, polylog, real_part, sec, sech, sgn, sin, sinh, tan, tanh, unit_step, zeta, zetaderiv]\n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/random_tests.py\", line 237:\n    sage: random_expr(50, nvars=3, coeff_generator=CDF.random_element)\nExpected:\n    (euler_gamma - v3^(-e) + (v2 - factorial(-e/v2))^(((2.85879036573 - 1.18163393202*I)*v2 + (2.85879036573 - 1.18163393202*I)*v3)*pi - 0.247786879678 + 0.931826724898*I)*arccsc((0.891138386848 - 0.0936820840629*I)/v1) + (-0.553423153995 + 0.5481180572*I)*v3 + 0.149683576515 - 0.155746451854*I)*v1 + arccsch(pi + e)*elliptic_f(khinchin*v2, 1.4656989704 + 0.863754357069*I)\nGot:\n    -v1*e^((0.0666829501658 + 0.206976992303*I)/(v3 + e))/v3 + hermite(-(v3^(-0.48519994364 - 0.485764091302*I) - log((1.21734510331 - 1.22580558833*I)*pi*v1 + zeta((0.781366128261 + 0.957400336147*I)*v1*e + (-1.8919687109 + 0.753422167447*I)*elliptic_f(v1, v1))*arccsch(v3)))*v1, (-0.647983235144 + 1.20665952957*I)*v1 + (0.0909404921682 + 0.281538203756*I)/v3)\n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/random_tests.py\", line 239:\n    sage: random_expr(5, verbose=True)\nException raised:\n    Traceback (most recent call last):\n      File \"/home/maldun/sage/sage-4.5.2/local/bin/ncadoctest.py\", line 1231, in run_one_test\n        self.run_one_example(test, example, filename, compileflags)\n      File \"/home/maldun/sage/sage-4.5.2/local/bin/sagedoctest.py\", line 38, in run_one_example\n        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)\n      File \"/home/maldun/sage/sage-4.5.2/local/bin/ncadoctest.py\", line 1172, in run_one_example\n        compileflags, 1) in test.globs\n      File \"<doctest __main__.example_5[5]>\", line 1, in <module>\n        random_expr(Integer(5), verbose=True)###line 239:\n    sage: random_expr(5, verbose=True)\n      File \"/home/maldun/sage/sage-4.5.2/local/lib/python/site-packages/sage/symbolic/random_tests.py\", line 254, in random_expr\n        return random_expr_helper(size, internal, leaves, verbose)\n      File \"/home/maldun/sage/sage-4.5.2/local/lib/python/site-packages/sage/symbolic/random_tests.py\", line 210, in random_expr_helper\n        return r[1](*children)\n      File \"element.pyx\", line 1529, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:11992)\n      File \"coerce.pyx\", line 713, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6126)\n      File \"element.pyx\", line 1527, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:11973)\n      File \"expression.pyx\", line 2269, in sage.symbolic.expression.Expression._div_ (sage/symbolic/expression.cpp:11444)\n    ZeroDivisionError: Symbolic division by zero\n**********************************************************************\n2 items had failures:\n   1 of   4 in __main__.example_0\n   2 of   6 in __main__.example_5\n***Test Failed*** 3 failures.\nFor whitespace errors, see the file /home/maldun/.sage//tmp/.doctest_random_tests.py\n         [7.7 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -long \"devel/sage/sage/symbolic/random_tests.py\"\nTotal time for all tests: 7.8 seconds\n```\n\nI quite understand these, because we have introduced new functions, but I don't understand the exception in the last one\n\n```\nsage -t -long \"devel/sage/sage/symbolic/pynac.pyx\"          \n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx\", line 386:\n    sage: get_sfunction_from_serial(i) == foo\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx\", line 388:\n    sage: py_latex_function_pystring(i, (x,y^z))\nExpected:\n    'my args are: x, y^z'\nGot:\n    '\\\\mathrm{bar}\\\\left(x, y^{z}\\\\right)'\n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx\", line 478:\n    sage: get_sfunction_from_serial(i) == foo\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx\", line 480:\n    sage: py_print_fderivative(i, (0, 1, 0, 1), (x, y^z))\nExpected:\n    D[0, 1, 0, 1]func_with_args(x, y^z)\nGot:\n    D[0, 1, 0, 1](foo)(x, y^z)\n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx\", line 540:\n    sage: get_sfunction_from_serial(i) == foo\nExpected:\n    True\nGot:\n    False\n**********************************************************************\nFile \"/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx\", line 542:\n    sage: py_latex_fderivative(i, (0, 1, 0, 1), (x, y^z))\nExpected:\n    D[0, 1, 0, 1]func_with_args(x, y^z)\nGot:\n    D[0, 1, 0, 1]\\left(\\mathrm{bar}\\right)\\left(x, y^{z}\\right)\n**********************************************************************\n3 items had failures:\n   2 of  19 in __main__.example_14\n   2 of  14 in __main__.example_16\n   2 of  18 in __main__.example_18\n***Test Failed*** 6 failures.\nFor whitespace errors, see the file /home/maldun/.sage//tmp/.doctest_pynac.py\n         [7.3 s]\n \n----------------------------------------------------------------------\nThe following tests failed:\n\n\n        sage -t -long \"devel/sage/sage/symbolic/pynac.pyx\"\nTotal time for all tests: 7.3 seconds\n```\n\nAnd these are really strange, because when I type then into sage by hand everything works. wtf??\nCan anyone have a look at these?",
    "created_at": "2010-09-05T10:27:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85276",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:25" align="right">comment:25</div>

Since it seems that numpy-1.4.1, and scipy 0.8 should work now (see #9808) I programmed a version which uses scipy itself to evaluate the orthogonal polys for numpy arrays. 
When the new versions of numpy/scipy become merged into sage I will provide a patch for these.

Another thing I have to mention are these 2 failde doctests:
* sage -t  -long "devel/sage/sage/symbolic/random_tests.py"
* sage -t  -long "devel/sage/sage/symbolic/pynac.pyx"

```
sage -t -long "devel/sage/sage/symbolic/random_tests.py"    
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/random_tests.py", line 17:
    sage: [f for (one,f,arity) in _mk_full_functions()]
Expected:
    [Ei, abs, arccos, arccosh, arccot, arccoth, arccsc, arccsch,
    arcsec, arcsech, arcsin, arcsinh, arctan, arctan2, arctanh,
    binomial, ceil, conjugate, cos, cosh, cot, coth, csc, csch,
    dickman_rho, dilog, dirac_delta, elliptic_e, elliptic_ec,
    elliptic_eu, elliptic_f, elliptic_kc, elliptic_pi, erf, exp,
    factorial, floor, heaviside, imag_part, integrate,
    kronecker_delta, log, polylog, real_part, sec, sech, sgn, sin,
    sinh, tan, tanh, unit_step, zeta, zetaderiv]
Got:
    [Ei, abs, arccos, arccosh, arccot, arccoth, arccsc, arccsch, arcsec, arcsech, arcsin, arcsinh, arctan, arctan2, arctanh, binomial, ceil, chebyshev_T, chebyshev_U, conjugate, cos, cosh, cot, coth, csc, csch, dickman_rho, dilog, dirac_delta, elliptic_e, elliptic_ec, elliptic_eu, elliptic_f, elliptic_kc, elliptic_pi, erf, exp, factorial, floor, gegenbauer, gen_laguerre, gen_legendre_P, gen_legendre_Q, heaviside, hermite, imag_part, integrate, jacobi_P, kronecker_delta, laguerre, legendre_P, legendre_Q, log, polylog, real_part, sec, sech, sgn, sin, sinh, tan, tanh, unit_step, zeta, zetaderiv]
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/random_tests.py", line 237:
    sage: random_expr(50, nvars=3, coeff_generator=CDF.random_element)
Expected:
    (euler_gamma - v3^(-e) + (v2 - factorial(-e/v2))^(((2.85879036573 - 1.18163393202*I)*v2 + (2.85879036573 - 1.18163393202*I)*v3)*pi - 0.247786879678 + 0.931826724898*I)*arccsc((0.891138386848 - 0.0936820840629*I)/v1) + (-0.553423153995 + 0.5481180572*I)*v3 + 0.149683576515 - 0.155746451854*I)*v1 + arccsch(pi + e)*elliptic_f(khinchin*v2, 1.4656989704 + 0.863754357069*I)
Got:
    -v1*e^((0.0666829501658 + 0.206976992303*I)/(v3 + e))/v3 + hermite(-(v3^(-0.48519994364 - 0.485764091302*I) - log((1.21734510331 - 1.22580558833*I)*pi*v1 + zeta((0.781366128261 + 0.957400336147*I)*v1*e + (-1.8919687109 + 0.753422167447*I)*elliptic_f(v1, v1))*arccsch(v3)))*v1, (-0.647983235144 + 1.20665952957*I)*v1 + (0.0909404921682 + 0.281538203756*I)/v3)
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/random_tests.py", line 239:
    sage: random_expr(5, verbose=True)
Exception raised:
    Traceback (most recent call last):
      File "/home/maldun/sage/sage-4.5.2/local/bin/ncadoctest.py", line 1231, in run_one_test
        self.run_one_example(test, example, filename, compileflags)
      File "/home/maldun/sage/sage-4.5.2/local/bin/sagedoctest.py", line 38, in run_one_example
        OrigDocTestRunner.run_one_example(self, test, example, filename, compileflags)
      File "/home/maldun/sage/sage-4.5.2/local/bin/ncadoctest.py", line 1172, in run_one_example
        compileflags, 1) in test.globs
      File "<doctest __main__.example_5[5]>", line 1, in <module>
        random_expr(Integer(5), verbose=True)###line 239:
    sage: random_expr(5, verbose=True)
      File "/home/maldun/sage/sage-4.5.2/local/lib/python/site-packages/sage/symbolic/random_tests.py", line 254, in random_expr
        return random_expr_helper(size, internal, leaves, verbose)
      File "/home/maldun/sage/sage-4.5.2/local/lib/python/site-packages/sage/symbolic/random_tests.py", line 210, in random_expr_helper
        return r[1](*children)
      File "element.pyx", line 1529, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:11992)
      File "coerce.pyx", line 713, in sage.structure.coerce.CoercionModel_cache_maps.bin_op (sage/structure/coerce.c:6126)
      File "element.pyx", line 1527, in sage.structure.element.RingElement.__div__ (sage/structure/element.c:11973)
      File "expression.pyx", line 2269, in sage.symbolic.expression.Expression._div_ (sage/symbolic/expression.cpp:11444)
    ZeroDivisionError: Symbolic division by zero
**********************************************************************
2 items had failures:
   1 of   4 in __main__.example_0
   2 of   6 in __main__.example_5
***Test Failed*** 3 failures.
For whitespace errors, see the file /home/maldun/.sage//tmp/.doctest_random_tests.py
         [7.7 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -long "devel/sage/sage/symbolic/random_tests.py"
Total time for all tests: 7.8 seconds
```

I quite understand these, because we have introduced new functions, but I don't understand the exception in the last one

```
sage -t -long "devel/sage/sage/symbolic/pynac.pyx"          
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx", line 386:
    sage: get_sfunction_from_serial(i) == foo
Expected:
    True
Got:
    False
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx", line 388:
    sage: py_latex_function_pystring(i, (x,y^z))
Expected:
    'my args are: x, y^z'
Got:
    '\\mathrm{bar}\\left(x, y^{z}\\right)'
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx", line 478:
    sage: get_sfunction_from_serial(i) == foo
Expected:
    True
Got:
    False
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx", line 480:
    sage: py_print_fderivative(i, (0, 1, 0, 1), (x, y^z))
Expected:
    D[0, 1, 0, 1]func_with_args(x, y^z)
Got:
    D[0, 1, 0, 1](foo)(x, y^z)
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx", line 540:
    sage: get_sfunction_from_serial(i) == foo
Expected:
    True
Got:
    False
**********************************************************************
File "/home/maldun/sage/sage-4.5.2/devel/sage/sage/symbolic/pynac.pyx", line 542:
    sage: py_latex_fderivative(i, (0, 1, 0, 1), (x, y^z))
Expected:
    D[0, 1, 0, 1]func_with_args(x, y^z)
Got:
    D[0, 1, 0, 1]\left(\mathrm{bar}\right)\left(x, y^{z}\right)
**********************************************************************
3 items had failures:
   2 of  19 in __main__.example_14
   2 of  14 in __main__.example_16
   2 of  18 in __main__.example_18
***Test Failed*** 6 failures.
For whitespace errors, see the file /home/maldun/.sage//tmp/.doctest_pynac.py
         [7.3 s]
 
----------------------------------------------------------------------
The following tests failed:


        sage -t -long "devel/sage/sage/symbolic/pynac.pyx"
Total time for all tests: 7.3 seconds
```

And these are really strange, because when I type then into sage by hand everything works. wtf??
Can anyone have a look at these?



---

archive/issue_comments_085277.json:
```json
{
    "body": "ortho polys with scipy support",
    "created_at": "2010-09-05T10:30:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85277",
    "user": "https://github.com/sagetrac-maldun"
}
```

ortho polys with scipy support



---

archive/issue_events_124307.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-10-03T00:49:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124307"
}
```



---

archive/issue_events_124308.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-10-03T00:49:32Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124308"
}
```



---

archive/issue_comments_085278.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nAttachment: **[orthogonal_polys.9.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.9.py.gz)**",
    "created_at": "2010-10-03T00:49:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85278",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:26" align="right">comment:26</div>

Attachment: **[orthogonal_polys.9.py.gz](https://github.com/sagemath/sage/files/ticket9706/orthogonal_polys.9.py.gz)**



---

archive/issue_events_124309.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-10-03T00:49:32Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "milestone_number": null,
    "milestone_title": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124309"
}
```



---

archive/issue_events_124310.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-10-03T00:49:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124310"
}
```



---

archive/issue_comments_085279.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nJust cc:ing myself by commenting.  \n\nAlso, there seems to be a lot of stuff in the latest Python file that is the same as the original one (in terms of explanation, not code).  Maybe posting an updated patch (once the numpy/scipy-fest is over, which is hopefully the case) would help some of us figure this out.  Thanks for working on this - there is still a lot of overhauling that symbolics could use, but this is a great step.",
    "created_at": "2010-10-15T18:42:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85279",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:27" align="right">comment:27</div>

Just cc:ing myself by commenting.  

Also, there seems to be a lot of stuff in the latest Python file that is the same as the original one (in terms of explanation, not code).  Maybe posting an updated patch (once the numpy/scipy-fest is over, which is hopefully the case) would help some of us figure this out.  Thanks for working on this - there is still a lot of overhauling that symbolics could use, but this is a great step.



---

archive/issue_comments_085280.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\n@kcrisman thanks for paying attention. I added now an updated patch and extended instructions.\n\nthe doctest changes in **symbolic.random_tests.py** are easy to explain: new functions are involved -> new random expressions. But I had to change\n`random_expr(50, nvars=3, coeff_generator=CDF.random_element) ` to `random_expr(60, nvars=3, coeff_generator=CDF.random_element) ` or else one gets an expression generated where a division through zero occours.\n\nAs mentioned on sage-devel I repaired the doctests in **symbolic.pynac.pyx**, the trick is to enlarge the range of the for loop:\n`for i in range(get_ginac_serial(), get_ginac_serial()+50):`\nchanged to\n`for i in range(get_ginac_serial(), get_ginac_serial()+100):`\nnow it works. My explaination: since we have new functions we have longer to search, and then we reach our goal. What I can not explain is, that it works, when I type it in by hand.\n\nAll doctests pass now, so I think a review would be nice.\n\n-maldun",
    "created_at": "2010-10-15T23:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85280",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:28" align="right">comment:28</div>

@kcrisman thanks for paying attention. I added now an updated patch and extended instructions.

the doctest changes in **symbolic.random_tests.py** are easy to explain: new functions are involved -> new random expressions. But I had to change
`random_expr(50, nvars=3, coeff_generator=CDF.random_element) ` to `random_expr(60, nvars=3, coeff_generator=CDF.random_element) ` or else one gets an expression generated where a division through zero occours.

As mentioned on sage-devel I repaired the doctests in **symbolic.pynac.pyx**, the trick is to enlarge the range of the for loop:
`for i in range(get_ginac_serial(), get_ginac_serial()+50):`
changed to
`for i in range(get_ginac_serial(), get_ginac_serial()+100):`
now it works. My explaination: since we have new functions we have longer to search, and then we reach our goal. What I can not explain is, that it works, when I type it in by hand.

All doctests pass now, so I think a review would be nice.

-maldun



---

archive/issue_events_124311.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-10-15T23:31:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124311"
}
```



---

archive/issue_events_124312.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2010-10-15T23:31:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124312"
}
```



---

archive/issue_comments_085281.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,12 @@\n The current implementation of orthogonal polynomials is just a wrapper around maxima. (see http://wiki.sagemath.org/symbolics/)\n-There are the following improvements planed:\n+This update holds the following changes:\n \n--using of the pynac class for symbolic functions.\n--faster evaluation in general\n--evaluation of special values\n--mpmath for numeric evaluation\n+  *using of the pynac class for symbolic functions.\n+  *faster evaluation in general\n+  *evaluation of special values\n+  *mpmath for numeric evaluation\n \n-\n-\n+**Remarks:** \n+   *The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) \n+* Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)\n+* Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).\n``````\n",
    "created_at": "2010-10-15T23:31:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85281",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,12 @@
 The current implementation of orthogonal polynomials is just a wrapper around maxima. (see http://wiki.sagemath.org/symbolics/)
-There are the following improvements planed:
+This update holds the following changes:
 
--using of the pynac class for symbolic functions.
--faster evaluation in general
--evaluation of special values
--mpmath for numeric evaluation
+  *using of the pynac class for symbolic functions.
+  *faster evaluation in general
+  *evaluation of special values
+  *mpmath for numeric evaluation
 
-
-
+**Remarks:** 
+   *The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) 
+* Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)
+* Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).
``````




---

archive/issue_comments_085282.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,12 +1,12 @@\n The current implementation of orthogonal polynomials is just a wrapper around maxima. (see http://wiki.sagemath.org/symbolics/)\n This update holds the following changes:\n \n-  *using of the pynac class for symbolic functions.\n-  *faster evaluation in general\n-  *evaluation of special values\n-  *mpmath for numeric evaluation\n+* using of the pynac class for symbolic functions.\n+* faster evaluation in general\n+* evaluation of special values\n+* mpmath for numeric evaluation\n \n **Remarks:** \n-   *The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) \n+* The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) \n * Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)\n * Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).\n``````\n",
    "created_at": "2010-10-15T23:55:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85282",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,12 +1,12 @@
 The current implementation of orthogonal polynomials is just a wrapper around maxima. (see http://wiki.sagemath.org/symbolics/)
 This update holds the following changes:
 
-  *using of the pynac class for symbolic functions.
-  *faster evaluation in general
-  *evaluation of special values
-  *mpmath for numeric evaluation
+* using of the pynac class for symbolic functions.
+* faster evaluation in general
+* evaluation of special values
+* mpmath for numeric evaluation
 
 **Remarks:** 
-   *The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) 
+* The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) 
 * Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)
 * Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).
``````




---

archive/issue_comments_085283.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nCleaned up discription of the ticket and some comments in the ortho polys file.",
    "created_at": "2010-10-15T23:55:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85283",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:29" align="right">comment:29</div>

Cleaned up discription of the ticket and some comments in the ortho polys file.



---

archive/issue_comments_085284.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI don't have time to review this for a while, but did take a quick look - thanks for polishing that patch!  I don't think we are allowed to import numpy or scipy like that anymore, but rather have to do it in an individual function (lest startup times get huge).  I don't quite understand exactly how that works, but anyway such a blanket import statement probably isn't appropriate, the way I understand what others have said.",
    "created_at": "2010-10-16T03:27:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85284",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:30" align="right">comment:30</div>

I don't have time to review this for a while, but did take a quick look - thanks for polishing that patch!  I don't think we are allowed to import numpy or scipy like that anymore, but rather have to do it in an individual function (lest startup times get huge).  I don't quite understand exactly how that works, but anyway such a blanket import statement probably isn't appropriate, the way I understand what others have said.



---

archive/issue_comments_085285.json:
```json
{
    "body": "Latest version of orthogonal polys with scipy support, and changed doctests. Tested in sage-4.6.alpha3",
    "created_at": "2010-10-16T12:53:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85285",
    "user": "https://github.com/sagetrac-maldun"
}
```

Latest version of orthogonal polys with scipy support, and changed doctests. Tested in sage-4.6.alpha3



---

archive/issue_comments_085286.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nAttachment: **[trac_9706_orthogonal_polys.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz)**\n\nReplying to [@kcrisman](#comment%3A30):\n> I don't have time to review this for a while, but did take a quick look - thanks for polishing that patch!  I don't think we are allowed to import numpy or scipy like that anymore, but rather have to do it in an individual function (lest startup times get huge).  I don't quite understand exactly how that works, but anyway such a blanket import statement probably isn't appropriate, the way I understand what others have said.  \n\nBut thanks for giving feedback! I know that this patch isn't easy for review because the code grew from 650 to about 2300 lines of code. But I'm happy to get at least some info.\n\nYou are right the imports didn't change since I started this ticket and importing the whole numpy and scipy packages is to much. This isn't a very good Idea if one thinks about performance either.  I changed that now so that only functions that are really needed are importet. I did this also for mpmath but the problem with the global import remains.\n(see above). Also changed some errors in the discription I missed and repaired a wrong doctest.\n\nPS: If diffs or more changelogs are needed let me know. I'm keeping track with git on my machine of the changes.",
    "created_at": "2010-10-16T13:04:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85286",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:31" align="right">comment:31</div>

Attachment: **[trac_9706_orthogonal_polys.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz)**

Replying to [@kcrisman](#comment%3A30):
> I don't have time to review this for a while, but did take a quick look - thanks for polishing that patch!  I don't think we are allowed to import numpy or scipy like that anymore, but rather have to do it in an individual function (lest startup times get huge).  I don't quite understand exactly how that works, but anyway such a blanket import statement probably isn't appropriate, the way I understand what others have said.  

But thanks for giving feedback! I know that this patch isn't easy for review because the code grew from 650 to about 2300 lines of code. But I'm happy to get at least some info.

You are right the imports didn't change since I started this ticket and importing the whole numpy and scipy packages is to much. This isn't a very good Idea if one thinks about performance either.  I changed that now so that only functions that are really needed are importet. I did this also for mpmath but the problem with the global import remains.
(see above). Also changed some errors in the discription I missed and repaired a wrong doctest.

PS: If diffs or more changelogs are needed let me know. I'm keeping track with git on my machine of the changes.



---

archive/issue_events_124313.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-10-16T15:38:16Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124313"
}
```



---

archive/issue_events_124314.json:
```json
{
    "actor": "https://github.com/burcin",
    "created_at": "2010-10-16T15:38:16Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124314"
}
```



---

archive/issue_comments_085287.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nGreat work Stefan. Your patch looks good overall, but it needs a lot of polish. Thank you very much for this.\n\nHere are some quick comments after reading [attachment: trac_9706_orthogonal_polys.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz)I didn't try to apply and run the code yet. It would be better if other people try this as well since I am really short on time these days.\n\n* I suggest you use your real name in the HG headers. This information is used for copyright/license issues as well. In the future it might cause a lot of trouble if people have to chase down `maldun` for copyright questions.\n* You shouldn't import any part of `numpy` at the module level. This slows down startup too much. See #3561 for example. I'd say the same holds for `mpmath` and `scipy`.\n* line 385-386 has this:\n\n```\nThen after using one of these functions, it changes:: (The value is now  \nFalse for chebyshev_T because chebyshev_T uses clenshaw method instead...)\n```\n I don't think this is valid Sphinx.\n* delete line 412\n\n```\n#load /home/maldun/sage/sage-4.5.2/devel/sage-ortho/sage/functions/orthogonal_polys.py \n```\n* line 419: he -> the\n* There are no doctests for the `OrthogonalPolynomial` class, make sure your file passes `sage -coverage`\n* The commented timings in the docstring of `OrthogonalPolynomial._clenshaw_method_()` are confusing. It would be better if you provide a function in the same file that does these timings automatically and prints out the results. You should at least delete this from the documentation though.\n* In the docstring of `OrthogonalPolynomial._eval_()`\n  * remove the empty first line (line 494) of\n  * remove the commented out timings as well\n  * you need an empty line after `EXAMPLES::`\n  * the empty last line should be removed\n* add some comments to the `OrthogonalPolynomial._eval_()` method to indicate what you're trying to do with these tests.\n  * lines 583-593 have a confusing comment and a bug\n\n```\ntry: \n    #s = maxima(self._maxima_init_evaled_(*args)) \n    #This above is very inefficient! The older \n    #methods were much faster... \n    return self._maxima_init_evaled_(*args) \nexcept TypeError: \n    return None \nif self._maxima_name in repr(s): \n    return None \nelse: \n    return s.sage() \n```\n* You don't need to state \"Class for\" on line 598, \"The Chebyshev ...\" is enough.\n* Why do you delete the `chebyshev_T(2,x)` test on line 371? You can just add the new ones after that.\n* line 626, `EXAMPLES:` -> `EXAMPLES::`\n* Don't use `*args` or `**kwds` when you don't need them. Name the arguments and be explicit. Remember the \"Zen of Python\", \"Explicit is better than implicit.\"\n* OK, generally, fix the docstrings to conform to Sphinx standards. This should be documented somewhere in the developers guide.\n* line 673, `_maxima_init_evaled_()` doesn't have doctests.\n* line 678 - , `_clenshaw_method_()`\n  * docstring is not indented properly.\n  * It would be better to put the recursion formula in the docstring.\n* line 790 `_clenshaw_method_()` doesn't have doctests.\n* There is something wrong with the `_maxima_init_evaled_()` on line 821. Are you sure this function shouldn't just return a string to be run in maxima? How do we know that doctest actually calls this function? In any case, the right way to convert a maxima object to sage is to run `.sage()` on it. Never use `sage_eval()` on a string in the Sage library.\n* Calls to mpmath should be able to use the precision directly from the type of the argument now. Are you sure all this is necessary:\n\n```\ntry: \n    step_parent = kwds['parent'] \nexcept KeyError: \n    step_parent = parent(args[-1]) \n\ntry: \n    precision = step_parent.prec() \nexcept AttributeError: \n    precision = RR.prec() \n```\n See #9566.\n* line 924, change the error message to something more professional. \"Derivative w.r.t. to the index is not supported, yet, and perhaps never will be...\" is not acceptable. \"Derivatives with respect to the index is not supported.\" would be enough.\n* Document the derivative formula in the docstring, using proper math notation\n* What needs to be discussed from the comments on line 968-974?\n* Same for lines 1058-1060?\n* no doctests for `_clenshaw_method_()` on line 1156.\n* no doctests for `_maxima_init_evaled_()` on line 1189.\n\nI give up at this point. It seems that there are similar issues in the rest of the file as well.\n\nAfter you clean up the code according to the comments above, perhaps a native English speaker like Karl-Dieter or Minh can help with the documentation.\n\nThanks again for all your work.",
    "created_at": "2010-10-16T15:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85287",
    "user": "https://github.com/burcin"
}
```

<div id="comment:32" align="right">comment:32</div>

Great work Stefan. Your patch looks good overall, but it needs a lot of polish. Thank you very much for this.

Here are some quick comments after reading [attachment: trac_9706_orthogonal_polys.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz)I didn't try to apply and run the code yet. It would be better if other people try this as well since I am really short on time these days.

* I suggest you use your real name in the HG headers. This information is used for copyright/license issues as well. In the future it might cause a lot of trouble if people have to chase down `maldun` for copyright questions.
* You shouldn't import any part of `numpy` at the module level. This slows down startup too much. See #3561 for example. I'd say the same holds for `mpmath` and `scipy`.
* line 385-386 has this:

```
Then after using one of these functions, it changes:: (The value is now  
False for chebyshev_T because chebyshev_T uses clenshaw method instead...)
```
 I don't think this is valid Sphinx.
* delete line 412

```
#load /home/maldun/sage/sage-4.5.2/devel/sage-ortho/sage/functions/orthogonal_polys.py 
```
* line 419: he -> the
* There are no doctests for the `OrthogonalPolynomial` class, make sure your file passes `sage -coverage`
* The commented timings in the docstring of `OrthogonalPolynomial._clenshaw_method_()` are confusing. It would be better if you provide a function in the same file that does these timings automatically and prints out the results. You should at least delete this from the documentation though.
* In the docstring of `OrthogonalPolynomial._eval_()`
  * remove the empty first line (line 494) of
  * remove the commented out timings as well
  * you need an empty line after `EXAMPLES::`
  * the empty last line should be removed
* add some comments to the `OrthogonalPolynomial._eval_()` method to indicate what you're trying to do with these tests.
  * lines 583-593 have a confusing comment and a bug

```
try: 
    #s = maxima(self._maxima_init_evaled_(*args)) 
    #This above is very inefficient! The older 
    #methods were much faster... 
    return self._maxima_init_evaled_(*args) 
except TypeError: 
    return None 
if self._maxima_name in repr(s): 
    return None 
else: 
    return s.sage() 
```
* You don't need to state "Class for" on line 598, "The Chebyshev ..." is enough.
* Why do you delete the `chebyshev_T(2,x)` test on line 371? You can just add the new ones after that.
* line 626, `EXAMPLES:` -> `EXAMPLES::`
* Don't use `*args` or `**kwds` when you don't need them. Name the arguments and be explicit. Remember the "Zen of Python", "Explicit is better than implicit."
* OK, generally, fix the docstrings to conform to Sphinx standards. This should be documented somewhere in the developers guide.
* line 673, `_maxima_init_evaled_()` doesn't have doctests.
* line 678 - , `_clenshaw_method_()`
  * docstring is not indented properly.
  * It would be better to put the recursion formula in the docstring.
* line 790 `_clenshaw_method_()` doesn't have doctests.
* There is something wrong with the `_maxima_init_evaled_()` on line 821. Are you sure this function shouldn't just return a string to be run in maxima? How do we know that doctest actually calls this function? In any case, the right way to convert a maxima object to sage is to run `.sage()` on it. Never use `sage_eval()` on a string in the Sage library.
* Calls to mpmath should be able to use the precision directly from the type of the argument now. Are you sure all this is necessary:

```
try: 
    step_parent = kwds['parent'] 
except KeyError: 
    step_parent = parent(args[-1]) 

try: 
    precision = step_parent.prec() 
except AttributeError: 
    precision = RR.prec() 
```
 See #9566.
* line 924, change the error message to something more professional. "Derivative w.r.t. to the index is not supported, yet, and perhaps never will be..." is not acceptable. "Derivatives with respect to the index is not supported." would be enough.
* Document the derivative formula in the docstring, using proper math notation
* What needs to be discussed from the comments on line 968-974?
* Same for lines 1058-1060?
* no doctests for `_clenshaw_method_()` on line 1156.
* no doctests for `_maxima_init_evaled_()` on line 1189.

I give up at this point. It seems that there are similar issues in the rest of the file as well.

After you clean up the code according to the comments above, perhaps a native English speaker like Karl-Dieter or Minh can help with the documentation.

Thanks again for all your work.



---

archive/issue_comments_085288.json:
```json
{
    "body": "Reviewer: **Burcin Erocal**",
    "created_at": "2010-10-16T15:38:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85288",
    "user": "https://github.com/burcin"
}
```

Reviewer: **Burcin Erocal**



---

archive/issue_events_124315.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "milestone_number": null,
    "milestone_title": "sage-5.11",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124315"
}
```



---

archive/issue_events_124316.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-08-13T15:35:53Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "milestone_number": null,
    "milestone_title": "sage-5.12",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124316"
}
```



---

archive/issue_comments_085289.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">comment:35</div>\n\nHi!\n\nI will now retry to build the new orthogonal polynomials.\nThe last time I ran out of time due to my phd studies/theses\nthis time i will split the changes up into several patches. So it will be easier to \napply the changes step by step, and the review process gets simpler.\n\nHope this time everything will work out!",
    "created_at": "2013-11-09T22:29:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85289",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:35" align="right">comment:35</div>

Hi!

I will now retry to build the new orthogonal polynomials.
The last time I ran out of time due to my phd studies/theses
this time i will split the changes up into several patches. So it will be easier to 
apply the changes step by step, and the review process gets simpler.

Hope this time everything will work out!



---

archive/issue_events_124317.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-11-09T22:30:36Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124317"
}
```



---

archive/issue_events_124318.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-11-09T22:30:36Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124318"
}
```



---

archive/issue_comments_085290.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">comment:37</div>\n\nHere is a review patch which does a bunch of documentation formatting tweaks. There are probably one or two other things that will need to be addressed, but I'd like to get the ball rolling on this again (and I need some sleep right now).\n\nBest,\n\nTravis\n\nFor patchbot:\n\nApply: trac_9706_chebyshev.patch\u200b, trac_9706-review-ts.patch",
    "created_at": "2013-11-23T07:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85290",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:37" align="right">comment:37</div>

Here is a review patch which does a bunch of documentation formatting tweaks. There are probably one or two other things that will need to be addressed, but I'd like to get the ball rolling on this again (and I need some sleep right now).

Best,

Travis

For patchbot:

Apply: trac_9706_chebyshev.patch, trac_9706-review-ts.patch



---

archive/issue_comments_085291.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -10,3 +10,8 @@\n * The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) \n * Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)\n * Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).\n+\n+Apply:\n+\n+* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n+* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n``````\n",
    "created_at": "2013-11-23T07:58:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85291",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -10,3 +10,8 @@
 * The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) 
 * Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)
 * Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).
+
+Apply:
+
+* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
+* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)
``````




---

archive/issue_events_124319.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-11-29T16:44:09Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "title_is": "New Version of orthogonal Polynomials (Part I: Base Class and Chebyshev Polynomials)",
    "title_was": "New Version of orthogonal Polynomials",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124319"
}
```



---

archive/issue_comments_085292.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">comment:38</div>\n\nThanks for reviewing. It would be great if the new Chebyshev Polynomials could be added. If this ticket is done I will open the next issue and start working on the Legendre Polynomials",
    "created_at": "2013-11-29T16:44:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85292",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:38" align="right">comment:38</div>

Thanks for reviewing. It would be great if the new Chebyshev Polynomials could be added. If this ticket is done I will open the next issue and start working on the Legendre Polynomials



---

archive/issue_comments_085293.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">comment:39</div>\n\nOkay, I've done a few other tweaks and I'd okay with it. If you're happy with my changes, then go ahead and set this to positive review.\n\nFor patchbot:\n\nApply: trac_9706_chebyshev.patch\u200b, trac_9706-review-ts.patch",
    "created_at": "2013-12-02T23:45:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85293",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:39" align="right">comment:39</div>

Okay, I've done a few other tweaks and I'd okay with it. If you're happy with my changes, then go ahead and set this to positive review.

For patchbot:

Apply: trac_9706_chebyshev.patch, trac_9706-review-ts.patch



---

archive/issue_comments_085294.json:
```json
{
    "body": "Changed reviewer from **Burcin Erocal** to **Burcin Erocal, Travis Scrimshaw**",
    "created_at": "2013-12-03T12:15:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85294",
    "user": "https://github.com/sagetrac-maldun"
}
```

Changed reviewer from **Burcin Erocal** to **Burcin Erocal, Travis Scrimshaw**



---

archive/issue_events_124320.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-03T12:15:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124320"
}
```



---

archive/issue_events_124321.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-03T12:15:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124321"
}
```



---

archive/issue_comments_085295.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">comment:40</div>\n\nThanks for your hard work in correcting all those small mistakes!\n\nI'm very happy, that finally the new ortho polys are going into sage!",
    "created_at": "2013-12-03T12:15:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85295",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:40" align="right">comment:40</div>

Thanks for your hard work in correcting all those small mistakes!

I'm very happy, that finally the new ortho polys are going into sage!



---

archive/issue_comments_085296.json:
```json
{
    "body": "Changed author from **Stefan Reiterer** to **Stefan Reiterer, Travis Scrimshaw**",
    "created_at": "2013-12-03T16:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85296",
    "user": "https://github.com/kcrisman"
}
```

Changed author from **Stefan Reiterer** to **Stefan Reiterer, Travis Scrimshaw**



---

archive/issue_comments_085297.json:
```json
{
    "body": "Changed reviewer from **Burcin Erocal, Travis Scrimshaw** to **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer**",
    "created_at": "2013-12-03T16:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85297",
    "user": "https://github.com/kcrisman"
}
```

Changed reviewer from **Burcin Erocal, Travis Scrimshaw** to **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer**



---

archive/issue_comments_085298.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">comment:41</div>\n\nI'm elevating Travis to an author because these are quite substantial review changes - thanks for being so meticulous on the formatting etc!\n\nI'd love one final check from either of you.  There are a lot of imports added; I think most should be okay but the Maxima-related ones scare me, so if you can just check that startup time hasn't budged more than a couple milliseconds, that would be helpful.  I don't think this should import numpy, at least!",
    "created_at": "2013-12-03T16:07:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85298",
    "user": "https://github.com/kcrisman"
}
```

<div id="comment:41" align="right">comment:41</div>

I'm elevating Travis to an author because these are quite substantial review changes - thanks for being so meticulous on the formatting etc!

I'd love one final check from either of you.  There are a lot of imports added; I think most should be okay but the Maxima-related ones scare me, so if you can just check that startup time hasn't budged more than a couple milliseconds, that would be helpful.  I don't think this should import numpy, at least!



---

archive/issue_comments_085299.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">comment:42</div>\n\nSorry to spoil the party, but this is a regression:\n\n```\nsage: K.<a> = NumberField(x^3-x-1)\nsage: chebyshev_T(10^3,a)\n---------------------------------------------------------------------------\nTypeError                                 Traceback (most recent call last)\n<ipython-input-17-aa97c56dd147> in <module>()\n----> 1 chebyshev_T(Integer(10)**Integer(3),a)\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5279)()\n\nTypeError: cannot coerce arguments: no canonical coercion from Number Field in a with defining polynomial x^3 - x - 1 to Symbolic Ring\n```\n\n(and yes: Chebyshev polynomials are important in number theory)",
    "created_at": "2013-12-03T17:12:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85299",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">comment:42</div>

Sorry to spoil the party, but this is a regression:

```
sage: K.<a> = NumberField(x^3-x-1)
sage: chebyshev_T(10^3,a)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-17-aa97c56dd147> in <module>()
----> 1 chebyshev_T(Integer(10)**Integer(3),a)

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5279)()

TypeError: cannot coerce arguments: no canonical coercion from Number Field in a with defining polynomial x^3 - x - 1 to Symbolic Ring
```

(and yes: Chebyshev polynomials are important in number theory)



---

archive/issue_events_124322.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-03T17:12:15Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124322"
}
```



---

archive/issue_events_124323.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-03T17:12:15Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124323"
}
```



---

archive/issue_comments_085300.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">comment:44</div>\n\nI would also like to point out that PARI is faster at evaluating Chebyshev polynomials:\n\n```\nsage: timeit('''chebyshev_T(10^5,2)''')\n5 loops, best of 3: 270 ms per loop\nsage: timeit('''pari('polchebyshev (10^5,1,2)')''')\n625 loops, best of 3: 447 \u00b5s per loop\n```\n\n```\nsage: timeit('''chebyshev_T(10^5, Mod(2,1009))''')\n5 loops, best of 3: 208 ms per loop\nsage: timeit('''pari('polchebyshev(10^5, 1, Mod(2,1009))')''')\n625 loops, best of 3: 11.5 \u00b5s per loop\n```\n\nWe should definately use PARI to evaluate Chebyshev polynomials for certain types of input.",
    "created_at": "2013-12-03T17:18:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85300",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:44" align="right">comment:44</div>

I would also like to point out that PARI is faster at evaluating Chebyshev polynomials:

```
sage: timeit('''chebyshev_T(10^5,2)''')
5 loops, best of 3: 270 ms per loop
sage: timeit('''pari('polchebyshev (10^5,1,2)')''')
625 loops, best of 3: 447 s per loop
```

```
sage: timeit('''chebyshev_T(10^5, Mod(2,1009))''')
5 loops, best of 3: 208 ms per loop
sage: timeit('''pari('polchebyshev(10^5, 1, Mod(2,1009))')''')
625 loops, best of 3: 11.5 s per loop
```

We should definately use PARI to evaluate Chebyshev polynomials for certain types of input.



---

archive/issue_comments_085301.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">comment:45</div>\n\nAnother regression:\n\n```\nsage: parent(chebyshev_T(10^2, RIF(2)))\nReal Field with 53 bits of precision\n```",
    "created_at": "2013-12-03T17:19:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85301",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">comment:45</div>

Another regression:

```
sage: parent(chebyshev_T(10^2, RIF(2)))
Real Field with 53 bits of precision
```



---

archive/issue_comments_085302.json:
```json
{
    "body": "<div id=\"comment:46\" align=\"right\">comment:46</div>\n\nThe \"Clenshaw method\" uses a very naive method of evaluating the recursion which needs `O(n)` steps, while there is a much faster method (which compute `T_2n` and `U_2n` in function of `T_n` and `U_n`) which only needs `O(log(n))` steps.\n\nEven this is totally feasible:\n\n```\nsage: timeit('''pari('polchebyshev(10^10, 1, Mod(2,1009))')''')\n625 loops, best of 3: 16.3 \u00b5s per loop\n```",
    "created_at": "2013-12-03T17:29:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85302",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:46" align="right">comment:46</div>

The "Clenshaw method" uses a very naive method of evaluating the recursion which needs `O(n)` steps, while there is a much faster method (which compute `T_2n` and `U_2n` in function of `T_n` and `U_n`) which only needs `O(log(n))` steps.

Even this is totally feasible:

```
sage: timeit('''pari('polchebyshev(10^10, 1, Mod(2,1009))')''')
625 loops, best of 3: 16.3 s per loop
```



---

archive/issue_comments_085303.json:
```json
{
    "body": "<div id=\"comment:47\" align=\"right\">comment:47</div>\n\nThis is also bad:\n\n```\nsage: R.<x> = QQ[]\nsage: parent(chebyshev_T(5, x))\nSymbolic Ring\n```",
    "created_at": "2013-12-03T17:32:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85303",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:47" align="right">comment:47</div>

This is also bad:

```
sage: R.<x> = QQ[]
sage: parent(chebyshev_T(5, x))
Symbolic Ring
```



---

archive/issue_comments_085304.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">comment:48</div>\n\nAnother suggestion: why not make the base class more general and call it `SymbolicPolynomial`? I think that's a more natural class of functions, which could (in the future) also include cyclotomic polynomials for example.",
    "created_at": "2013-12-03T17:35:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85304",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:48" align="right">comment:48</div>

Another suggestion: why not make the base class more general and call it `SymbolicPolynomial`? I think that's a more natural class of functions, which could (in the future) also include cyclotomic polynomials for example.



---

archive/issue_comments_085305.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">comment:49</div>\n\nI propose the logic for evaluating `chebyshev_T(n, x)` should be:\n1. if `x` is symbolic, then use the method of the current patch.\n2. if `x` is not symbolic, try evaluation using PARI.\n3. if conversion to PARI fails (for example for `RIF`), use an efficient `O(log(n))` recursion algorithm.",
    "created_at": "2013-12-03T17:42:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85305",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">comment:49</div>

I propose the logic for evaluating `chebyshev_T(n, x)` should be:
1. if `x` is symbolic, then use the method of the current patch.
2. if `x` is not symbolic, try evaluation using PARI.
3. if conversion to PARI fails (for example for `RIF`), use an efficient `O(log(n))` recursion algorithm.



---

archive/issue_comments_085306.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">comment:50</div>\n\nJeroen: do you know a reference for the recursion pari uses?",
    "created_at": "2013-12-03T18:08:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85306",
    "user": "https://github.com/fredrik-johansson"
}
```

<div id="comment:50" align="right">comment:50</div>

Jeroen: do you know a reference for the recursion pari uses?



---

archive/issue_comments_085307.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">comment:51</div>\n\nReplying to [@fredrik-johansson](#comment%3A50):\n> Jeroen: do you know a reference for the recursion pari uses?\n\nNo, but it's pretty straight-forward (think doubling formulas for `cos` and `sin`).",
    "created_at": "2013-12-03T20:30:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85307",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:51" align="right">comment:51</div>

Replying to [@fredrik-johansson](#comment%3A50):
> Jeroen: do you know a reference for the recursion pari uses?

No, but it's pretty straight-forward (think doubling formulas for `cos` and `sin`).



---

archive/issue_comments_085308.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">comment:52</div>\n\nThank you all for the input! I think it is still a good idea that I only implement chebychev polys for now, since there are a lot of improvements out there.\n\n@jdemeyer\n\n`@`Bugs I will look into this. And yes I'm aware that Chebyshev Polynomials are important to number theory since there are quite interesting generalizations on general fields.\n\n`@`Clenshaw: PARI is a good hint, I will look into this. And I already think I know how to generalize the clenshaw method, to get O(log N). \nThe reason for this quite naive choice, was that the method can be applied to all ortho polys. Nevertheless I will adapt it on Chebychev Polys since there are more possibilities since we can use trigonometric formulas. I think the benefit of implementing it directly in sage is that there is less trouble if one wants to use more general data types, since there are no type casts. I will try to find an optimal way for this. (Maybe an additional switch)\n\n`@`SymbolicPolynomial: I don't think this is a good idea because ortho polys are quite special even among the polynomials. But If you really would like to have a SymbolicPolynomial class I would propose to introduce the SymbolicPolynomial class, and derive the OrthogonalPolynomials from that class.\nI make the following suggestion: I will finish the OrthogonalPolynomials with the current design. And then open an new ticket where we discuss the design of a general polynomial parent class. Fortunately, such design changes are very easy to implement in Python, and I don't see any big problem in introducing an intermediate class.\nBut if you want to introduce such a class there are some major decisions to make:\n-Where do we put this class? (such a general class should not belong to orthogonoal_polys.py )\n-What should all SymbolicPolynomials have in common?\n-What should they have concerning other general polynomials?\n\nBut it would be really good to add the ortho polys, and I really want to finish this task.",
    "created_at": "2013-12-04T07:47:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85308",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:52" align="right">comment:52</div>

Thank you all for the input! I think it is still a good idea that I only implement chebychev polys for now, since there are a lot of improvements out there.

@jdemeyer

`@`Bugs I will look into this. And yes I'm aware that Chebyshev Polynomials are important to number theory since there are quite interesting generalizations on general fields.

`@`Clenshaw: PARI is a good hint, I will look into this. And I already think I know how to generalize the clenshaw method, to get O(log N). 
The reason for this quite naive choice, was that the method can be applied to all ortho polys. Nevertheless I will adapt it on Chebychev Polys since there are more possibilities since we can use trigonometric formulas. I think the benefit of implementing it directly in sage is that there is less trouble if one wants to use more general data types, since there are no type casts. I will try to find an optimal way for this. (Maybe an additional switch)

`@`SymbolicPolynomial: I don't think this is a good idea because ortho polys are quite special even among the polynomials. But If you really would like to have a SymbolicPolynomial class I would propose to introduce the SymbolicPolynomial class, and derive the OrthogonalPolynomials from that class.
I make the following suggestion: I will finish the OrthogonalPolynomials with the current design. And then open an new ticket where we discuss the design of a general polynomial parent class. Fortunately, such design changes are very easy to implement in Python, and I don't see any big problem in introducing an intermediate class.
But if you want to introduce such a class there are some major decisions to make:
-Where do we put this class? (such a general class should not belong to orthogonoal_polys.py )
-What should all SymbolicPolynomials have in common?
-What should they have concerning other general polynomials?

But it would be really good to add the ortho polys, and I really want to finish this task.



---

archive/issue_comments_085309.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">comment:53</div>\n\n> `SymbolicPolynomial`: I don't think this is a good idea because ortho polys are quite special even among the polynomials.\n\nWhat's special about orthogonal polynomials from a **computer algebra** point of view? I can tell you that \"symbolic polynomials\" are special because you generally want to be able to evaluate them for any ring element (as opposed to other symbolic functions, which often only make sense in real or complex fields).\n\n> I make the following suggestion: I will finish the OrthogonalPolynomials with the current design.\n\nSure...",
    "created_at": "2013-12-04T08:38:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85309",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:53" align="right">comment:53</div>

> `SymbolicPolynomial`: I don't think this is a good idea because ortho polys are quite special even among the polynomials.

What's special about orthogonal polynomials from a **computer algebra** point of view? I can tell you that "symbolic polynomials" are special because you generally want to be able to evaluate them for any ring element (as opposed to other symbolic functions, which often only make sense in real or complex fields).

> I make the following suggestion: I will finish the OrthogonalPolynomials with the current design.

Sure...



---

archive/issue_comments_085310.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">comment:54</div>\n\nReplying to [@jdemeyer](#comment%3A53):\n> > `SymbolicPolynomial`: I don't think this is a good idea because ortho polys are quite special even among the polynomials.\n> \n> What's special about orthogonal polynomials from a **computer algebra** point of view? I can tell you that \"symbolic polynomials\" are special because you generally want to be able to evaluate them for any ring element (as opposed to other symbolic functions, which often only make sense in real or complex fields).\n> \n\nIt makes a difference in an **OO-Design** point of view, because you can apply a whole bunch of evaluation techniques and tricks due to the three term recursion (e.g. clenshaw method or the eval_numpy method are not needed for symbolic polynomials, since there are no methods for that). Thats the reason why I suggested to derive them from a base class on top to avoid redundant methods. That would be a clean solution. And I'm already thinking on some features, which I want to implement in future version, which are very specific to ortho polys. And if you want to introduce such a general class, you should not put it into orthogonal_polys.py, but somewhere else, were it fits better into the class hierarchy.\n\nPlease don't get me wrong, I'm not stating, that I think it is a bad idea to introduce such an abstract base class, but If you want a clean OO Design, it is not done by a simple renaming.",
    "created_at": "2013-12-04T09:08:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85310",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:54" align="right">comment:54</div>

Replying to [@jdemeyer](#comment%3A53):
> > `SymbolicPolynomial`: I don't think this is a good idea because ortho polys are quite special even among the polynomials.
> 
> What's special about orthogonal polynomials from a **computer algebra** point of view? I can tell you that "symbolic polynomials" are special because you generally want to be able to evaluate them for any ring element (as opposed to other symbolic functions, which often only make sense in real or complex fields).
> 

It makes a difference in an **OO-Design** point of view, because you can apply a whole bunch of evaluation techniques and tricks due to the three term recursion (e.g. clenshaw method or the eval_numpy method are not needed for symbolic polynomials, since there are no methods for that). Thats the reason why I suggested to derive them from a base class on top to avoid redundant methods. That would be a clean solution. And I'm already thinking on some features, which I want to implement in future version, which are very specific to ortho polys. And if you want to introduce such a general class, you should not put it into orthogonal_polys.py, but somewhere else, were it fits better into the class hierarchy.

Please don't get me wrong, I'm not stating, that I think it is a bad idea to introduce such an abstract base class, but If you want a clean OO Design, it is not done by a simple renaming.



---

archive/issue_comments_085311.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">comment:55</div>\n\nEvaluating `chebyshev_T(n,x)` can be done as\n\n```\n(Matrix(2,2,[x,x^2-1,1,x])^n)[0,0]\n```\n\nWhile `chebyshev_U(n-1,x)` equals\n\n```\n(Matrix(2,2,[x,x^2-1,1,x])^n)[1,0]\n```\n\nThese can be evaluated with `O(log(n))` operations.",
    "created_at": "2013-12-04T09:14:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85311",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:55" align="right">comment:55</div>

Evaluating `chebyshev_T(n,x)` can be done as

```
(Matrix(2,2,[x,x^2-1,1,x])^n)[0,0]
```

While `chebyshev_U(n-1,x)` equals

```
(Matrix(2,2,[x,x^2-1,1,x])^n)[1,0]
```

These can be evaluated with `O(log(n))` operations.



---

archive/issue_comments_085312.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">comment:56</div>\n\nReplying to [@sagetrac-maldun](#comment%3A54):\n> And I'm already thinking on some features, which I want to implement in future version, which are very specific to ortho polys.\n\nThat alone is a very good to keep the `OrthogonalPolynomial` class.",
    "created_at": "2013-12-04T09:16:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85312",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:56" align="right">comment:56</div>

Replying to [@sagetrac-maldun](#comment%3A54):
> And I'm already thinking on some features, which I want to implement in future version, which are very specific to ortho polys.

That alone is a very good to keep the `OrthogonalPolynomial` class.



---

archive/issue_comments_085313.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">comment:57</div>\n\nReplying to [@jdemeyer](#comment%3A55):\n> Evaluating `chebyshev_T(n,x)` can be done as\n> \n> ```\n> (Matrix(2,2,[x,x^2-1,1,x])^n)[0,0]\n> ```\n> \n> While `chebyshev_U(n-1,x)` equals\n> \n> ```\n> (Matrix(2,2,[x,x^2-1,1,x])^n)[1,0]\n> ```\n> \n> These can be evaluated with `O(log(n))` operations.\n\nThanks for the hint. I have also an own idea to implement this. My implementation   should be optimal with respect to the flop count, but yours could be faster since matrix multiplication and powers are well optimized. I will compare both methods and use the faster one.\n\nFor reference: The method which I mean is based on the generalized recursion formula (originating from the cosine addition theorem): \nT_{n+m} + T{n-m} = 2 T_n T_m \n\nFor T_N one can now use the binary representation of N to recursively build T_N in O(log N) time",
    "created_at": "2013-12-04T09:24:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85313",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:57" align="right">comment:57</div>

Replying to [@jdemeyer](#comment%3A55):
> Evaluating `chebyshev_T(n,x)` can be done as
> 
> ```
> (Matrix(2,2,[x,x^2-1,1,x])^n)[0,0]
> ```
> 
> While `chebyshev_U(n-1,x)` equals
> 
> ```
> (Matrix(2,2,[x,x^2-1,1,x])^n)[1,0]
> ```
> 
> These can be evaluated with `O(log(n))` operations.

Thanks for the hint. I have also an own idea to implement this. My implementation   should be optimal with respect to the flop count, but yours could be faster since matrix multiplication and powers are well optimized. I will compare both methods and use the faster one.

For reference: The method which I mean is based on the generalized recursion formula (originating from the cosine addition theorem): 
T_{n+m} + T{n-m} = 2 T_n T_m 

For T_N one can now use the binary representation of N to recursively build T_N in O(log N) time



---

archive/issue_comments_085314.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">comment:58</div>\n\nThis should be a `ValueError`:\n\n```\nsage: chebyshev_T(1/2,0)\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n<ipython-input-7-830f13ad2f0d> in <module>()\n----> 1 chebyshev_T(Integer(1)/Integer(2),Integer(0))\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()                                                                                                                                                               \n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5531)()                                                                                                                                                                      \n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _eval_(self, *args)\n    489                 if not is_Expression(args[-1]):\n    490                     try:\n--> 491                         return self._evalf_(*args)\n    492                     except AttributeError:\n    493                         pass\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _evalf_(self, *args, **kwds)\n    606             precision = step_parent.prec()\n    607         except AttributeError:\n--> 608             precision = RR.prec()\n    609 \n    610         from sage.libs.mpmath.all import call as mpcall\n\nNameError: global name 'RR' is not defined\n```",
    "created_at": "2013-12-04T11:59:36Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85314",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">comment:58</div>

This should be a `ValueError`:

```
sage: chebyshev_T(1/2,0)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-7-830f13ad2f0d> in <module>()
----> 1 chebyshev_T(Integer(1)/Integer(2),Integer(0))

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()                                                                                                                                                               

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5531)()                                                                                                                                                                      

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _eval_(self, *args)
    489                 if not is_Expression(args[-1]):
    490                     try:
--> 491                         return self._evalf_(*args)
    492                     except AttributeError:
    493                         pass

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _evalf_(self, *args, **kwds)
    606             precision = step_parent.prec()
    607         except AttributeError:
--> 608             precision = RR.prec()
    609 
    610         from sage.libs.mpmath.all import call as mpcall

NameError: global name 'RR' is not defined
```



---

archive/issue_comments_085315.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">comment:59</div>\n\nThis should be `ArithmeticError` (I guess), since deriving w.r.t. the index simply isn't defined:\n\n```\nsage: var('n,x')\n(n, x)\nsage: chebyshev_T(n,x).diff(n)\n---------------------------------------------------------------------------\nNotImplementedError                       Traceback (most recent call last)\n<ipython-input-14-a23f5209eb49> in <module>()\n----> 1 chebyshev_T(n,x).diff(n)\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.derivative (sage/symbolic/expression.cpp:16561)()\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/misc/derivative.so in sage.misc.derivative.multi_derivative (sage/misc/derivative.c:2715)()\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression._derivative (sage/symbolic/expression.cpp:16951)()\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _derivative_(self, *args, **kwds)\n    714         diff_param = kwds['diff_param']\n    715         if diff_param == 0:\n--> 716             raise NotImplementedError(\"derivative w.r.t. to the index is not supported yet\")\n    717 \n    718         return args[0]*chebyshev_U(args[0]-1,args[1])\n\nNotImplementedError: derivative w.r.t. to the index is not supported yet\n```\n\nAlso: doctest your exceptions.",
    "created_at": "2013-12-04T12:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85315",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:59" align="right">comment:59</div>

This should be `ArithmeticError` (I guess), since deriving w.r.t. the index simply isn't defined:

```
sage: var('n,x')
(n, x)
sage: chebyshev_T(n,x).diff(n)
---------------------------------------------------------------------------
NotImplementedError                       Traceback (most recent call last)
<ipython-input-14-a23f5209eb49> in <module>()
----> 1 chebyshev_T(n,x).diff(n)

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression.derivative (sage/symbolic/expression.cpp:16561)()

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/misc/derivative.so in sage.misc.derivative.multi_derivative (sage/misc/derivative.c:2715)()

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/expression.so in sage.symbolic.expression.Expression._derivative (sage/symbolic/expression.cpp:16951)()

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _derivative_(self, *args, **kwds)
    714         diff_param = kwds['diff_param']
    715         if diff_param == 0:
--> 716             raise NotImplementedError("derivative w.r.t. to the index is not supported yet")
    717 
    718         return args[0]*chebyshev_U(args[0]-1,args[1])

NotImplementedError: derivative w.r.t. to the index is not supported yet
```

Also: doctest your exceptions.



---

archive/issue_comments_085316.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">comment:60</div>\n\nI personally like to define `chebyshev_T(-n,x) = chebyshev_T(n,x)` and `chebyshev_U(-n,x) = -chebyshev_U(n-2,x)`. This makes sense from a number-theoretic point of view and is also consistent with `chebyshev_T(n,cos(x)) = cos(n*x)` and `chebyshev_U(n-1,cos(x)) = sin(n*x)/sin(x)`.",
    "created_at": "2013-12-04T12:07:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85316",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:60" align="right">comment:60</div>

I personally like to define `chebyshev_T(-n,x) = chebyshev_T(n,x)` and `chebyshev_U(-n,x) = -chebyshev_U(n-2,x)`. This makes sense from a number-theoretic point of view and is also consistent with `chebyshev_T(n,cos(x)) = cos(n*x)` and `chebyshev_U(n-1,cos(x)) = sin(n*x)/sin(x)`.



---

archive/issue_comments_085317.json:
```json
{
    "body": "<div id=\"comment:61\" align=\"right\">comment:61</div>\n\nFor real/complex fields, you should use\n\n```\nchebyshev_T(n,x) = ((x+sqrt(x^2-1))^n + (x-sqrt(x^2-1))^n)/2\nchebyshev_U(n-1,x) = ((x+sqrt(x^2-1))^n - (x-sqrt(x^2-1))^n)/(2*sqrt(x^2-1))\n```",
    "created_at": "2013-12-04T14:42:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85317",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:61" align="right">comment:61</div>

For real/complex fields, you should use

```
chebyshev_T(n,x) = ((x+sqrt(x^2-1))^n + (x-sqrt(x^2-1))^n)/2
chebyshev_U(n-1,x) = ((x+sqrt(x^2-1))^n - (x-sqrt(x^2-1))^n)/(2*sqrt(x^2-1))
```



---

archive/issue_comments_085318.json:
```json
{
    "body": "<div id=\"comment:62\" align=\"right\">comment:62</div>\n\nThe doubling recursion formulas should be better also for real/complex fields, I think: computing nth powers is basically the same amount of work, and it's best to avoid the square roots (especially for real |x| < 1).",
    "created_at": "2013-12-04T15:06:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85318",
    "user": "https://github.com/fredrik-johansson"
}
```

<div id="comment:62" align="right">comment:62</div>

The doubling recursion formulas should be better also for real/complex fields, I think: computing nth powers is basically the same amount of work, and it's best to avoid the square roots (especially for real |x| < 1).



---

archive/issue_comments_085319.json:
```json
{
    "body": "<div id=\"comment:63\" align=\"right\">comment:63</div>\n\nReplying to [@fredrik-johansson](#comment%3A62):\n> The doubling recursion formulas should be better also for real/complex fields, I think: computing nth powers is basically the same amount of work, and it's best to avoid the square roots (especially for real |x| < 1).\n\nThe matrix algorithm does seem more numerically stable (checked by using both algorithms inside `RIF`). So it's easy then, if there is one algorithm which is obviously the best.",
    "created_at": "2013-12-04T15:16:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85319",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:63" align="right">comment:63</div>

Replying to [@fredrik-johansson](#comment%3A62):
> The doubling recursion formulas should be better also for real/complex fields, I think: computing nth powers is basically the same amount of work, and it's best to avoid the square roots (especially for real |x| < 1).

The matrix algorithm does seem more numerically stable (checked by using both algorithms inside `RIF`). So it's easy then, if there is one algorithm which is obviously the best.



---

archive/issue_comments_085320.json:
```json
{
    "body": "<div id=\"comment:64\" align=\"right\">comment:64</div>\n\nI found an interesting paper on this topic: [http://www.mathematik.uni-kassel.de/~koepf/cheby.pdf](http://www.mathematik.uni-kassel.de/~koepf/cheby.pdf)\n\nMaybe this could give some input to the discussion.\n\nIt states that for an expanded representation the approach I have\ninitally chosen (series expansion) should be the best for the symbolic\nevaluation, since this is somehow that what the user expects from ohter CAS.\nHowever, the proposed recursive/symbolic method would be interesting too.\n(p16f), since it gives a more compact form for large n. Maybe a switch for \nn >= 100?\n\nConsidering rational numbers as input, the recursion formula works best, due to this paper. This should be considered too.\n\n`@`Matrix Multiplication: It's also my favorite, but I will compare first.",
    "created_at": "2013-12-04T15:33:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85320",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:64" align="right">comment:64</div>

I found an interesting paper on this topic: [http://www.mathematik.uni-kassel.de/~koepf/cheby.pdf](http://www.mathematik.uni-kassel.de/~koepf/cheby.pdf)

Maybe this could give some input to the discussion.

It states that for an expanded representation the approach I have
initally chosen (series expansion) should be the best for the symbolic
evaluation, since this is somehow that what the user expects from ohter CAS.
However, the proposed recursive/symbolic method would be interesting too.
(p16f), since it gives a more compact form for large n. Maybe a switch for 
n >= 100?

Considering rational numbers as input, the recursion formula works best, due to this paper. This should be considered too.

`@`Matrix Multiplication: It's also my favorite, but I will compare first.



---

archive/issue_comments_085321.json:
```json
{
    "body": "<div id=\"comment:65\" align=\"right\">comment:65</div>\n\nHere is an implementation of the divide-and-conquer algorithm that doesn't require caching (it only makes one recursive call). It might look even nicer if one rewrites it in iterative form. I think it's also equivalent to the code in pari. It should be faster than matrix powering by a constant factor, just like the analogous Fibonacci number algorithms.\n\n```\ndef chebyshev_t(n, x):\n    # returns (T(n,x), T(n-1,x)), or (T(n,x), _) if both=False\n    def recur(n, x, both=False):\n        if n == 0:\n            return 1, x\n        if n == 1:\n            return x, 1\n        a, b = recur((n+1)//2, x, both or n % 2)\n        if n % 2 == 0:\n            return 2*a^2 - 1, both and 2*a*b - x\n        else:\n            return 2*a*b - x, both and 2*b^2 - 1\n    return recur(n, x, False)[0]\n```\n\nCome to think of it, it might even be useful to publicly expose a method that returns both T(n,x) and T(n-1,x) simultaneously.\n\nSimilar code for U (using same algorithm as Pari):\n\n```\ndef chebyshev_u(n, x):\n    def recur(n, x, both=False):\n        if n == 0:\n            return 1, both and 2*x\n        if n == 1:\n            return 2*x, both and 4*x^2-1\n        a, b = recur((n-1)//2, x, True)\n        if n % 2 == 0:\n            return (b+a)*(b-a), both and 2*b*(x*b-a)\n        else:\n            return 2*a*(b-x*a), both and (b+a)*(b-a)\n    return recur(n, x, False)[0]\n```\n\nEdit: streamlined the code.",
    "created_at": "2013-12-04T16:45:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85321",
    "user": "https://github.com/fredrik-johansson"
}
```

<div id="comment:65" align="right">comment:65</div>

Here is an implementation of the divide-and-conquer algorithm that doesn't require caching (it only makes one recursive call). It might look even nicer if one rewrites it in iterative form. I think it's also equivalent to the code in pari. It should be faster than matrix powering by a constant factor, just like the analogous Fibonacci number algorithms.

```
def chebyshev_t(n, x):
    # returns (T(n,x), T(n-1,x)), or (T(n,x), _) if both=False
    def recur(n, x, both=False):
        if n == 0:
            return 1, x
        if n == 1:
            return x, 1
        a, b = recur((n+1)//2, x, both or n % 2)
        if n % 2 == 0:
            return 2*a^2 - 1, both and 2*a*b - x
        else:
            return 2*a*b - x, both and 2*b^2 - 1
    return recur(n, x, False)[0]
```

Come to think of it, it might even be useful to publicly expose a method that returns both T(n,x) and T(n-1,x) simultaneously.

Similar code for U (using same algorithm as Pari):

```
def chebyshev_u(n, x):
    def recur(n, x, both=False):
        if n == 0:
            return 1, both and 2*x
        if n == 1:
            return 2*x, both and 4*x^2-1
        a, b = recur((n-1)//2, x, True)
        if n % 2 == 0:
            return (b+a)*(b-a), both and 2*b*(x*b-a)
        else:
            return 2*a*(b-x*a), both and (b+a)*(b-a)
    return recur(n, x, False)[0]
```

Edit: streamlined the code.



---

archive/issue_comments_085322.json:
```json
{
    "body": "<div id=\"comment:66\" align=\"right\">comment:66</div>\n\nI think your recursive implementation is very good. If you try to implement it iteratively, you have to consider some cases (current in row even/odd and next in row even/odd), and the code gets quite ugly in my opinion. And I think Knuth is right. One should prefer readable code over over optimzed \"faster\" code...",
    "created_at": "2013-12-04T19:46:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85322",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:66" align="right">comment:66</div>

I think your recursive implementation is very good. If you try to implement it iteratively, you have to consider some cases (current in row even/odd and next in row even/odd), and the code gets quite ugly in my opinion. And I think Knuth is right. One should prefer readable code over over optimzed "faster" code...



---

archive/issue_comments_085323.json:
```json
{
    "body": "<div id=\"comment:67\" align=\"right\">comment:67</div>\n\nthis would be a functioning iterative algorithm:\n\n\n```\ndef chebyshev_t(n,x):\n    \n    if n == 0:\n        return 1\n    elif n == 1:\n        return x\n    elif n == 2:\n        return 2*x**2-1\n    else:\n        T_c = x\n        T_p = 2*x**2 -1\n        \n        for k in range(floor(log(n,2)),0,-1):\n            T_p_old = T_p\n            T_c_old = T_c\n            if (n//2**(k-1)) % 2 == 0: # next is even\n                T_p = 2*T_p_old*T_c_old - x\n                T_c = 2*T_c_old**2 - 1\n            elif (n//2**(k-1)) % 2  == 1: # next is odd\n                T_p = 2*T_p_old**2 - 1\n                T_c = 2*T_p_old*T_c_old - x\n        \n        # Cases for output\n        if log(n - 1,2) in ZZ or log(n-2,2) in ZZ:\n            return T_c\n        \n        elif n % 2 == 0:\n            if n//2 % 2 == 0:                   \n                return T_c\n            else:\n                return T_p\n        elif n % 2 == 1:\n            if n//2 % 2 == 0:                   \n                return T_p\n            else:\n                return T_c\n```\n\nI made it shorter. What is preferable? recursive or iterative? Normaly iterative, but in this case it is longer due to the indices battles ...\n\nEdit: I also measured time: recursive is faster, even if I do some optimization (e.g. xrange)",
    "created_at": "2013-12-04T20:39:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85323",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:67" align="right">comment:67</div>

this would be a functioning iterative algorithm:


```
def chebyshev_t(n,x):
    
    if n == 0:
        return 1
    elif n == 1:
        return x
    elif n == 2:
        return 2*x**2-1
    else:
        T_c = x
        T_p = 2*x**2 -1
        
        for k in range(floor(log(n,2)),0,-1):
            T_p_old = T_p
            T_c_old = T_c
            if (n//2**(k-1)) % 2 == 0: # next is even
                T_p = 2*T_p_old*T_c_old - x
                T_c = 2*T_c_old**2 - 1
            elif (n//2**(k-1)) % 2  == 1: # next is odd
                T_p = 2*T_p_old**2 - 1
                T_c = 2*T_p_old*T_c_old - x
        
        # Cases for output
        if log(n - 1,2) in ZZ or log(n-2,2) in ZZ:
            return T_c
        
        elif n % 2 == 0:
            if n//2 % 2 == 0:                   
                return T_c
            else:
                return T_p
        elif n % 2 == 1:
            if n//2 % 2 == 0:                   
                return T_p
            else:
                return T_c
```

I made it shorter. What is preferable? recursive or iterative? Normaly iterative, but in this case it is longer due to the indices battles ...

Edit: I also measured time: recursive is faster, even if I do some optimization (e.g. xrange)



---

archive/issue_comments_085324.json:
```json
{
    "body": "<div id=\"comment:68\" align=\"right\">comment:68</div>\n\nReplying to [@jdemeyer](#comment%3A42):\n> Sorry to spoil the party, but this is a regression:\n> \n> ```\n> sage: K.<a> = NumberField(x^3-x-1)\n> sage: chebyshev_T(10^3,a)\n> ---------------------------------------------------------------------------\n> TypeError                                 Traceback (most recent call last)\n> <ipython-input-17-aa97c56dd147> in <module>()\n> ----> 1 chebyshev_T(Integer(10)**Integer(3),a)\n> \n> /usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()\n> \n> /usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5279)()\n> \n> TypeError: cannot coerce arguments: no canonical coercion from Number Field in a with defining polynomial x^3 - x - 1 to Symbolic Ring\n> ```\n> \n> (and yes: Chebyshev polynomials are important in number theory)\n\nI had now a look on these regressions: The problem originates from the fact, tat the ortho polys are now symbolic functions instead of simple function call in maxima.\nthe symbolic functions have a lot more mechanisms concerning type coercions.\n\nThe only way around this would be a hack to chatch this coercion troubles, e.g.\n\n\n```\ndef __call__(self,n,x):\n\n    try:\n        super(Func_chebyshev_T,self).__call__(n,x)\n    except TypeError:\n        return self._clenshaw_method_(n,x)\n```\n\nwould work for that problem and some others. But how to catch such things correctly?\nUse a try catch, or make several is_instance checks? This could get a quite long list on coercions...",
    "created_at": "2013-12-04T22:01:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85324",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:68" align="right">comment:68</div>

Replying to [@jdemeyer](#comment%3A42):
> Sorry to spoil the party, but this is a regression:
> 
> ```
> sage: K.<a> = NumberField(x^3-x-1)
> sage: chebyshev_T(10^3,a)
> ---------------------------------------------------------------------------
> TypeError                                 Traceback (most recent call last)
> <ipython-input-17-aa97c56dd147> in <module>()
> ----> 1 chebyshev_T(Integer(10)**Integer(3),a)
> 
> /usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()
> 
> /usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5279)()
> 
> TypeError: cannot coerce arguments: no canonical coercion from Number Field in a with defining polynomial x^3 - x - 1 to Symbolic Ring
> ```
> 
> (and yes: Chebyshev polynomials are important in number theory)

I had now a look on these regressions: The problem originates from the fact, tat the ortho polys are now symbolic functions instead of simple function call in maxima.
the symbolic functions have a lot more mechanisms concerning type coercions.

The only way around this would be a hack to chatch this coercion troubles, e.g.


```
def __call__(self,n,x):

    try:
        super(Func_chebyshev_T,self).__call__(n,x)
    except TypeError:
        return self._clenshaw_method_(n,x)
```

would work for that problem and some others. But how to catch such things correctly?
Use a try catch, or make several is_instance checks? This could get a quite long list on coercions...



---

archive/issue_comments_085325.json:
```json
{
    "body": "new fixes and patches",
    "created_at": "2013-12-04T23:30:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85325",
    "user": "https://github.com/sagetrac-maldun"
}
```

new fixes and patches



---

archive/issue_comments_085326.json:
```json
{
    "body": "<div id=\"comment:69\" align=\"right\">comment:69</div>\n\nAttachment: **[trac_9706_new_clenshaw.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_clenshaw.patch.gz)**\n\nReplying to [@sagetrac-maldun](#comment%3A68):\n> would work for that problem and some others. But how to catch such things correctly?\n\nI think there are only two cases: the \"symbolic\" case and the \"algebraic\" case. The latter means that we really consider the polynomial as a polynomial, not a symbolic function. In `chebyshev(n,x)`, if either `n` or `x` is symbolic, we are in the symbolic case, otherwise we're in the algebraic case. In the algebraic case, the index `n` must be a concrete integer and we use the iterative algorithm.",
    "created_at": "2013-12-04T23:51:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85326",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:69" align="right">comment:69</div>

Attachment: **[trac_9706_new_clenshaw.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_clenshaw.patch.gz)**

Replying to [@sagetrac-maldun](#comment%3A68):
> would work for that problem and some others. But how to catch such things correctly?

I think there are only two cases: the "symbolic" case and the "algebraic" case. The latter means that we really consider the polynomial as a polynomial, not a symbolic function. In `chebyshev(n,x)`, if either `n` or `x` is symbolic, we are in the symbolic case, otherwise we're in the algebraic case. In the algebraic case, the index `n` must be a concrete integer and we use the iterative algorithm.



---

archive/issue_comments_085327.json:
```json
{
    "body": "<div id=\"comment:70\" align=\"right\">comment:70</div>\n\nmaldun: I don't like all the log's in your approach (I don't think you need them), but otherwise I'm happy with either the recursive or iterative approach.",
    "created_at": "2013-12-04T23:53:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85327",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:70" align="right">comment:70</div>

maldun: I don't like all the log's in your approach (I don't think you need them), but otherwise I'm happy with either the recursive or iterative approach.



---

archive/issue_comments_085328.json:
```json
{
    "body": "<div id=\"comment:71\" align=\"right\">comment:71</div>\n\nReplying to [@jdemeyer](#comment%3A69):\n> Replying to [@sagetrac-maldun](#comment%3A68):\n> > would work for that problem and some others. But how to catch such things correctly?\n> \n> \n> I think there are only two cases: the \"symbolic\" case and the \"algebraic\" case. The latter means that we really consider the polynomial as a polynomial, not a symbolic function. In `chebyshev(n,x)`, if either `n` or `x` is symbolic, we are in the symbolic case, otherwise we're in the algebraic case. In the algebraic case, the index `n` must be a concrete integer and we use the iterative algorithm.\n\nThank you for the input, that's a great idea!\n\nBased on that I propose the following switch:\n\n\n```\ndef __call__(self,n,x):\n    if n in ZZ: # check if n is integer -> consider polynomial as algebraic structure\n        self._eval_(n,x) # Let eval methode decide which is best\n    else:\n        super(OrthogonalPolynomial,self).__call__(n,x)\n```",
    "created_at": "2013-12-05T08:17:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85328",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:71" align="right">comment:71</div>

Replying to [@jdemeyer](#comment%3A69):
> Replying to [@sagetrac-maldun](#comment%3A68):
> > would work for that problem and some others. But how to catch such things correctly?
> 
> 
> I think there are only two cases: the "symbolic" case and the "algebraic" case. The latter means that we really consider the polynomial as a polynomial, not a symbolic function. In `chebyshev(n,x)`, if either `n` or `x` is symbolic, we are in the symbolic case, otherwise we're in the algebraic case. In the algebraic case, the index `n` must be a concrete integer and we use the iterative algorithm.

Thank you for the input, that's a great idea!

Based on that I propose the following switch:


```
def __call__(self,n,x):
    if n in ZZ: # check if n is integer -> consider polynomial as algebraic structure
        self._eval_(n,x) # Let eval methode decide which is best
    else:
        super(OrthogonalPolynomial,self).__call__(n,x)
```



---

archive/issue_comments_085329.json:
```json
{
    "body": "<div id=\"comment:72\" align=\"right\">comment:72</div>\n\nI think that `chebyshev_T(1/2, 2)` should raise a `ValueError` (or can we make sense of this?). So, in your code there should really be 3 cases: integer, symbolic and \"something else\" which is always an error.\n\nSo, I would do something like\n\n```\ndef __call__(self,n,x):\n    if is_Expression(n):\n        return super(OrthogonalPolynomial, self).__call__(n,x)\n    # We consider the polynomial really as a polynomial,\n    # not a symbolic expression.\n    try:\n        n = ZZ(n)\n    except StandardError:\n        raise ValueError(\"Index for symbolic polynomials must be an integer\")\n    return self._eval_polynomial(n, x)\n```",
    "created_at": "2013-12-05T08:43:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85329",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:72" align="right">comment:72</div>

I think that `chebyshev_T(1/2, 2)` should raise a `ValueError` (or can we make sense of this?). So, in your code there should really be 3 cases: integer, symbolic and "something else" which is always an error.

So, I would do something like

```
def __call__(self,n,x):
    if is_Expression(n):
        return super(OrthogonalPolynomial, self).__call__(n,x)
    # We consider the polynomial really as a polynomial,
    # not a symbolic expression.
    try:
        n = ZZ(n)
    except StandardError:
        raise ValueError("Index for symbolic polynomials must be an integer")
    return self._eval_polynomial(n, x)
```



---

archive/issue_comments_085330.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,4 @@\n \n * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n * [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n+* [attachment: trac_9706_new_clenshaw.patch\u200b](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)\n``````\n",
    "created_at": "2013-12-05T08:48:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85330",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,4 @@
 
 * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
 * [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)
+* [attachment: trac_9706_new_clenshaw.patch](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)
``````




---

archive/issue_comments_085331.json:
```json
{
    "body": "<div id=\"comment:74\" align=\"right\">comment:74</div>\n\nReplying to [@jdemeyer](#comment%3A70):\n> maldun: I don't like all the log's in your approach (I don't think you need them), but otherwise I'm happy with either the recursive or iterative approach.\n\nI removed the logs, it is much faster now, but still slower than the recursive implementation about a constant factor of 2 (which is not much considering that we are talking about \u00b5s, but still)",
    "created_at": "2013-12-05T08:54:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85331",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:74" align="right">comment:74</div>

Replying to [@jdemeyer](#comment%3A70):
> maldun: I don't like all the log's in your approach (I don't think you need them), but otherwise I'm happy with either the recursive or iterative approach.

I removed the logs, it is much faster now, but still slower than the recursive implementation about a constant factor of 2 (which is not much considering that we are talking about s, but still)



---

archive/issue_comments_085332.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,4 +15,3 @@\n \n * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n * [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n-* [attachment: trac_9706_new_clenshaw.patch\u200b](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)\n``````\n",
    "created_at": "2013-12-05T08:54:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85332",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,4 +15,3 @@
 
 * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
 * [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)
-* [attachment: trac_9706_new_clenshaw.patch](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)
``````




---

archive/issue_comments_085333.json:
```json
{
    "body": "<div id=\"comment:75\" align=\"right\">comment:75</div>\n\nReplying to [@jdemeyer](#comment%3A72):\n> I think that `chebyshev_T(1/2, 2)` should raise a `ValueError` (or can we make sense of this?). So, in your code there should really be 3 cases: integer, symbolic and \"something else\" which is always an error.\n> \n> So, I would do something like\n> \n> ```\n> def __call__(self,n,x):\n>     if is_Expression(n):\n>         return super(OrthogonalPolynomial, self).__call__(n,x)\n>     # We consider the polynomial really as a polynomial,\n>     # not a symbolic expression.\n>     try:\n>         n = ZZ(n)\n>     except StandardError:\n>         raise ValueError(\"Index for symbolic polynomials must be an integer\")\n>     return self._eval_polynomial(n, x)\n> ```\n\nNo there are several other cases to consider: You can also have complex and real input values if you consider a chebyshev polynomial as extension of the Hypergeometric function 1F2 like mpmath does: [http://mpmath.googlecode.com/svn/trunk/doc/build/functions/orthogonal.html#chebyt](http://mpmath.googlecode.com/svn/trunk/doc/build/functions/orthogonal.html#chebyt)\nThat's the reason for the message in the `_derive_` method, since it would be theoretically possible to differentiate a chebyshev polynomial with respect to the index.\n\nSo the way I proposed makes sense, since this could be important for symbolic computation purposes where hypergeometric functions play an important role (eg. Zeilberger algorithm), and of course for analytical considerations.",
    "created_at": "2013-12-05T09:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85333",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:75" align="right">comment:75</div>

Replying to [@jdemeyer](#comment%3A72):
> I think that `chebyshev_T(1/2, 2)` should raise a `ValueError` (or can we make sense of this?). So, in your code there should really be 3 cases: integer, symbolic and "something else" which is always an error.
> 
> So, I would do something like
> 
> ```
> def __call__(self,n,x):
>     if is_Expression(n):
>         return super(OrthogonalPolynomial, self).__call__(n,x)
>     # We consider the polynomial really as a polynomial,
>     # not a symbolic expression.
>     try:
>         n = ZZ(n)
>     except StandardError:
>         raise ValueError("Index for symbolic polynomials must be an integer")
>     return self._eval_polynomial(n, x)
> ```

No there are several other cases to consider: You can also have complex and real input values if you consider a chebyshev polynomial as extension of the Hypergeometric function 1F2 like mpmath does: [http://mpmath.googlecode.com/svn/trunk/doc/build/functions/orthogonal.html#chebyt](http://mpmath.googlecode.com/svn/trunk/doc/build/functions/orthogonal.html#chebyt)
That's the reason for the message in the `_derive_` method, since it would be theoretically possible to differentiate a chebyshev polynomial with respect to the index.

So the way I proposed makes sense, since this could be important for symbolic computation purposes where hypergeometric functions play an important role (eg. Zeilberger algorithm), and of course for analytical considerations.



---

archive/issue_comments_085334.json:
```json
{
    "body": "<div id=\"comment:76\" align=\"right\">comment:76</div>\n\nOK, I agree.\n\nWhat remains to do:\n- support [negative indices](#comment%3A60)\n- add many doctests (essentially, all the examples I mentioned on this ticket should become doctests)\n- for ease of reviewing, fold all the patches into one patch.",
    "created_at": "2013-12-05T09:27:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85334",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:76" align="right">comment:76</div>

OK, I agree.

What remains to do:
- support [negative indices](#comment%3A60)
- add many doctests (essentially, all the examples I mentioned on this ticket should become doctests)
- for ease of reviewing, fold all the patches into one patch.



---

archive/issue_comments_085335.json:
```json
{
    "body": "Patch in a whole with corrections etc.",
    "created_at": "2013-12-05T19:12:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85335",
    "user": "https://github.com/sagetrac-maldun"
}
```

Patch in a whole with corrections etc.



---

archive/issue_events_124324.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-05T19:14:23Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124324"
}
```



---

archive/issue_events_124325.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-05T19:14:23Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124325"
}
```



---

archive/issue_comments_085336.json:
```json
{
    "body": "<div id=\"comment:77\" align=\"right\">comment:77</div>\n\nAttachment: **[trac_9706_chebyshev_patch_new.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)**\n\nNew patch attached. I incorporated all changes discussed.\n\n`@`Pari I tried the evaluation with pari, but with Fredericks recursion, there is no gain in speed, due to the type checks beforehand. And the recursion in sage avoid type conversions.",
    "created_at": "2013-12-05T19:14:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85336",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:77" align="right">comment:77</div>

Attachment: **[trac_9706_chebyshev_patch_new.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)**

New patch attached. I incorporated all changes discussed.

`@`Pari I tried the evaluation with pari, but with Fredericks recursion, there is no gain in speed, due to the type checks beforehand. And the recursion in sage avoid type conversions.



---

archive/issue_comments_085337.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,5 +13,4 @@\n \n Apply:\n \n-* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n-* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n+* [attachment: trac_9706_chebyshev_patch_new.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)\n``````\n",
    "created_at": "2013-12-05T19:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85337",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,5 +13,4 @@
 
 Apply:
 
-* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
-* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)
+* [attachment: trac_9706_chebyshev_patch_new.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)
``````




---

archive/issue_comments_085338.json:
```json
{
    "body": "<div id=\"comment:78\" align=\"right\">comment:78</div>\n\nmeldun: please adjust the \"apply\" section in the ticket description so it's clear which patch(es) should be applied.",
    "created_at": "2013-12-05T19:40:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85338",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:78" align="right">comment:78</div>

meldun: please adjust the "apply" section in the ticket description so it's clear which patch(es) should be applied.



---

archive/issue_comments_085339.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,4 +13,7 @@\n \n Apply:\n \n+* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n+* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n+* [attachment: trac_9706_new_clenshaw.patch\u200b](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)\n * [attachment: trac_9706_chebyshev_patch_new.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)\n``````\n",
    "created_at": "2013-12-05T19:44:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85339",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,4 +13,7 @@
 
 Apply:
 
+* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
+* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)
+* [attachment: trac_9706_new_clenshaw.patch](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)
 * [attachment: trac_9706_chebyshev_patch_new.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)
``````




---

archive/issue_comments_085340.json:
```json
{
    "body": "Attachment: **[trac_9706_chebyshev.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)**\n\ncheby changes",
    "created_at": "2013-12-05T19:46:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85340",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[trac_9706_chebyshev.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)**

cheby changes



---

archive/issue_comments_085341.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,6 +14,3 @@\n Apply:\n \n * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n-* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n-* [attachment: trac_9706_new_clenshaw.patch\u200b](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)\n-* [attachment: trac_9706_chebyshev_patch_new.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)\n``````\n",
    "created_at": "2013-12-05T19:46:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85341",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,6 +14,3 @@
 Apply:
 
 * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
-* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)
-* [attachment: trac_9706_new_clenshaw.patch](https://github.com/sagemath/sage/files/ticket9706/92d8417838742f4fc31f28f66fb06843.gz)
-* [attachment: trac_9706_chebyshev_patch_new.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_patch_new.patch.gz)
``````




---

archive/issue_comments_085342.json:
```json
{
    "body": "<div id=\"comment:80\" align=\"right\">comment:80</div>\n\nFolded the 4 patches.",
    "created_at": "2013-12-05T19:46:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85342",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:80" align="right">comment:80</div>

Folded the 4 patches.



---

archive/issue_events_124326.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T19:47:04Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "title_is": "Symbolic Chebyshev polynomials",
    "title_was": "New Version of orthogonal Polynomials (Part I: Base Class and Chebyshev Polynomials)",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124326"
}
```



---

archive/issue_comments_085343.json:
```json
{
    "body": "<div id=\"comment:82\" align=\"right\">comment:82</div>\n\nWhat's the advantage of the `_clenshaw_method_` over the recursive method? I see no need for the two different implementations and suggest to remove `_clenshaw_method_`.",
    "created_at": "2013-12-05T19:50:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85343",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:82" align="right">comment:82</div>

What's the advantage of the `_clenshaw_method_` over the recursive method? I see no need for the two different implementations and suggest to remove `_clenshaw_method_`.



---

archive/issue_events_124327.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T19:52:17Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124327"
}
```



---

archive/issue_events_124328.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-05T19:52:17Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124328"
}
```



---

archive/issue_comments_085344.json:
```json
{
    "body": "<div id=\"comment:83\" align=\"right\">comment:83</div>\n\nMore doctests are needed, this still doesn't work:\n\n```\nsage: chebyshev_T(1/2, 0)\n---------------------------------------------------------------------------\nNameError                                 Traceback (most recent call last)\n<ipython-input-2-c142cc68c50b> in <module>()\n----> 1 chebyshev_T(Integer(1)/Integer(2), Integer(0))\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in __call__(self, n, x)\n    554             return self._eval_(n,x) # Let eval methode decide which is best\n    555         else: # Consider OrthogonalPolynomial as symbol\n--> 556             return super(OrthogonalPolynomial,self).__call__(n,x)\n    557 \n    558 \n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5531)()\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _eval_(self, *args)\n    493                 if not is_Expression(args[-1]):\n    494                     try:\n--> 495                         return self._evalf_(*args)\n    496                     except AttributeError:\n    497                         pass\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _evalf_(self, *args, **kwds)\n    641             precision = step_parent.prec()\n    642         except AttributeError:\n--> 643             precision = RR.prec()\n    644 \n    645         from sage.libs.mpmath.all import call as mpcall\n\nNameError: global name 'RR' is not defined\n```",
    "created_at": "2013-12-05T19:52:17Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85344",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:83" align="right">comment:83</div>

More doctests are needed, this still doesn't work:

```
sage: chebyshev_T(1/2, 0)
---------------------------------------------------------------------------
NameError                                 Traceback (most recent call last)
<ipython-input-2-c142cc68c50b> in <module>()
----> 1 chebyshev_T(Integer(1)/Integer(2), Integer(0))

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in __call__(self, n, x)
    554             return self._eval_(n,x) # Let eval methode decide which is best
    555         else: # Consider OrthogonalPolynomial as symbol
--> 556             return super(OrthogonalPolynomial,self).__call__(n,x)
    557 
    558 

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFunction.__call__ (sage/symbolic/function.cpp:8126)()

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function.__call__ (sage/symbolic/function.cpp:5531)()

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _eval_(self, *args)
    493                 if not is_Expression(args[-1]):
    494                     try:
--> 495                         return self._evalf_(*args)
    496                     except AttributeError:
    497                         pass

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _evalf_(self, *args, **kwds)
    641             precision = step_parent.prec()
    642         except AttributeError:
--> 643             precision = RR.prec()
    644 
    645         from sage.libs.mpmath.all import call as mpcall

NameError: global name 'RR' is not defined
```



---

archive/issue_comments_085345.json:
```json
{
    "body": "<div id=\"comment:84\" align=\"right\">comment:84</div>\n\nWhy do we have `__call__` and `_eval_` given they do essentially the same thing? Please keep in mind [comment:69] also in the `_eval_()` function (I really don't understand why it needs to be so complicated).\n\nThis is also still broken:\n\n```\nsage: parent(chebyshev_T(4, RIF(5)))\nReal Field with 53 bits of precision\n```\n\nPlease fix all issues that I mentioned **and turn them into doctests**.",
    "created_at": "2013-12-05T20:00:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85345",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:84" align="right">comment:84</div>

Why do we have `__call__` and `_eval_` given they do essentially the same thing? Please keep in mind [comment:69] also in the `_eval_()` function (I really don't understand why it needs to be so complicated).

This is also still broken:

```
sage: parent(chebyshev_T(4, RIF(5)))
Real Field with 53 bits of precision
```

Please fix all issues that I mentioned **and turn them into doctests**.



---

archive/issue_comments_085346.json:
```json
{
    "body": "<div id=\"comment:85\" align=\"right\">comment:85</div>\n\nFor the `REFERENCES`, see [http://sagemath.org/doc/developer/conventions.html#docstring-markup-with-rest-and-sphinx](http://sagemath.org/doc/developer/conventions.html#docstring-markup-with-rest-and-sphinx) for the right syntax.",
    "created_at": "2013-12-05T22:35:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85346",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:85" align="right">comment:85</div>

For the `REFERENCES`, see [http://sagemath.org/doc/developer/conventions.html#docstring-markup-with-rest-and-sphinx](http://sagemath.org/doc/developer/conventions.html#docstring-markup-with-rest-and-sphinx) for the right syntax.



---

archive/issue_comments_085347.json:
```json
{
    "body": "<div id=\"comment:86\" align=\"right\">comment:86</div>\n\n`@`clenshaw_method: there is a difference. clenshaw method also applies a direct formula for small n and calls the recursive method else. The difference is that the recursive evaluation does not give an expanded representation of the polynomial, which is wanted for small n, because that was the standard till now and people expect this, especially if you are used to mathematica or maxima. Expanding huge expressions costs a lot of time, and this approach is much faster in that situation. Of course it is a matter of naming. But the reason why I have 2 methods, is to avoid too long code segments, and splitting them apart is better for readability. It also is important concerning other orthogonal polynomials.\n\n@__call__ & `_eval_` : This convention is part of the BuiltinFunction structure.\n`__call__` does all the stuff like coercions, transforming into a symbolic expression (e.g. if n is a symbolic value don't return a polynomial but hold the closed form.)\n_eval cares about evaluating the polynomial (e.g return a number if x is a number etc.)\nLook into the symbolic.function module for more details\nAnd eval is so complicated because there are several cases to consider: correct evaluation of symbolic expressions, numerical expressions and numpy arrays etc.\nThis is also part of the BuiltinFunction structure. And you also have to keep in mind that this method should work for all ortho polys. \n\n`@`bugs Sorry, during the patch merging process I had forgotten to apply a patch, which I'm now missing, since I work on different machines ... I will correct this tomorrow.\nIt's annoying since I already had fixed it ...",
    "created_at": "2013-12-05T23:14:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85347",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:86" align="right">comment:86</div>

`@`clenshaw_method: there is a difference. clenshaw method also applies a direct formula for small n and calls the recursive method else. The difference is that the recursive evaluation does not give an expanded representation of the polynomial, which is wanted for small n, because that was the standard till now and people expect this, especially if you are used to mathematica or maxima. Expanding huge expressions costs a lot of time, and this approach is much faster in that situation. Of course it is a matter of naming. But the reason why I have 2 methods, is to avoid too long code segments, and splitting them apart is better for readability. It also is important concerning other orthogonal polynomials.

@__call__ & `_eval_` : This convention is part of the BuiltinFunction structure.
`__call__` does all the stuff like coercions, transforming into a symbolic expression (e.g. if n is a symbolic value don't return a polynomial but hold the closed form.)
_eval cares about evaluating the polynomial (e.g return a number if x is a number etc.)
Look into the symbolic.function module for more details
And eval is so complicated because there are several cases to consider: correct evaluation of symbolic expressions, numerical expressions and numpy arrays etc.
This is also part of the BuiltinFunction structure. And you also have to keep in mind that this method should work for all ortho polys. 

`@`bugs Sorry, during the patch merging process I had forgotten to apply a patch, which I'm now missing, since I work on different machines ... I will correct this tomorrow.
It's annoying since I already had fixed it ...



---

archive/issue_comments_085348.json:
```json
{
    "body": "Attachment: **[trac_9706_bugfixes_and_doctests.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)**\n\nincorporated things that were already been done ...",
    "created_at": "2013-12-05T23:55:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85348",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[trac_9706_bugfixes_and_doctests.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)**

incorporated things that were already been done ...



---

archive/issue_comments_085349.json:
```json
{
    "body": "<div id=\"comment:87\" align=\"right\">comment:87</div>\n\nOk I incorporated the bugfixes and doctests **again** ...\n\nthere are still some minor changes (formatting and new doctests) todo. Please let me know if you find more bugs.",
    "created_at": "2013-12-06T00:00:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85349",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:87" align="right">comment:87</div>

Ok I incorporated the bugfixes and doctests **again** ...

there are still some minor changes (formatting and new doctests) todo. Please let me know if you find more bugs.



---

archive/issue_comments_085350.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -14,3 +14,4 @@\n Apply:\n \n * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n+* [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)\n``````\n",
    "created_at": "2013-12-06T00:00:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85350",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -14,3 +14,4 @@
 Apply:
 
 * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
+* [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)
``````




---

archive/issue_comments_085351.json:
```json
{
    "body": "<div id=\"comment:88\" align=\"right\">comment:88</div>\n\nReplying to [@sagetrac-maldun](#comment%3A86):\n> `@`clenshaw_method: there is a difference. clenshaw method also applies a direct formula for small n and calls the recursive method else. The difference is that the recursive evaluation does not give an expanded representation of the polynomial, which is wanted for small n\n\nOK, fine. But for simplicity, you could simply call `_cheb_recur_(...).expand()` instead which would achieve the same thing without an additional method.\n\n> _eval cares about evaluating the polynomial (e.g return a number if x is a number etc.)\n> Look into the symbolic.function module for more details\n> And eval is so complicated because there are several cases to consider: correct evaluation of symbolic expressions, numerical expressions and numpy arrays etc.\n\nIf you really think the complexity is justified (I have a hard time believing that), you should add comments in the code to describe the various cases, because I'm having a hard time understanding the logic. A comment like `# A faster check would be nice...` doesn't mean much to me because I don't understand what you're trying to do.",
    "created_at": "2013-12-06T10:11:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85351",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:88" align="right">comment:88</div>

Replying to [@sagetrac-maldun](#comment%3A86):
> `@`clenshaw_method: there is a difference. clenshaw method also applies a direct formula for small n and calls the recursive method else. The difference is that the recursive evaluation does not give an expanded representation of the polynomial, which is wanted for small n

OK, fine. But for simplicity, you could simply call `_cheb_recur_(...).expand()` instead which would achieve the same thing without an additional method.

> _eval cares about evaluating the polynomial (e.g return a number if x is a number etc.)
> Look into the symbolic.function module for more details
> And eval is so complicated because there are several cases to consider: correct evaluation of symbolic expressions, numerical expressions and numpy arrays etc.

If you really think the complexity is justified (I have a hard time believing that), you should add comments in the code to describe the various cases, because I'm having a hard time understanding the logic. A comment like `# A faster check would be nice...` doesn't mean much to me because I don't understand what you're trying to do.



---

archive/issue_comments_085352.json:
```json
{
    "body": "<div id=\"comment:89\" align=\"right\">comment:89</div>\n\nI think `mpmath` should only be used for the \"pure\" `RealField()` and `ComplexField()` and `RDF` and `CDF`, nothing else.\n\nThis is bad:\n\n```\nsage: chebyshev_T(5,Qp(3)(2))\n...\nTypeError: unable to coerce to a ComplexNumber: <type 'sage.rings.padics.padic_capped_relative_element.pAdicCappedRelativeElement'>\n```\n\nand the way you use `RIF` is also kind of stupid since the computation should really be done using the recursive formula.",
    "created_at": "2013-12-06T10:14:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85352",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:89" align="right">comment:89</div>

I think `mpmath` should only be used for the "pure" `RealField()` and `ComplexField()` and `RDF` and `CDF`, nothing else.

This is bad:

```
sage: chebyshev_T(5,Qp(3)(2))
...
TypeError: unable to coerce to a ComplexNumber: <type 'sage.rings.padics.padic_capped_relative_element.pAdicCappedRelativeElement'>
```

and the way you use `RIF` is also kind of stupid since the computation should really be done using the recursive formula.



---

archive/issue_comments_085353.json:
```json
{
    "body": "<div id=\"comment:90\" align=\"right\">comment:90</div>\n\nAlso, you should never simply `print` stuff. Either delete those prints or use a [Python warning](http://docs.python.org/2/library/warnings.html#available-functions).\n\n```\nsage: chebyshev_T(10^6,RealField(256)(2))\nWarning: mpmath returns NoConvergence!\nSwitching to clenshaw_method, but it may not be stable!\n1.764019427245793968639371137094247875315949668035854027376792158135922267593e571947\n```\n\nThe message is also misleading, since for some inputs it retries `mpmath` anyway:\n\n```\nsage: chebyshev_T(100001/2, 2)\n---------------------------------------------------------------------------\nNoConvergence                             Traceback (most recent call last)\n<ipython-input-34-9c95a5ff4276> in <module>()\n----> 1 chebyshev_T(Integer(100001)/Integer(2), Integer(2))\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/ort\n    557             return self._eval_(n,x) # Let eval methode decide which is best\n    558         else: # Consider OrthogonalPolynomial as symbol\n--> 559             return super(OrthogonalPolynomial,self).__call__(n,x)\n    560 \n    561 \n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFp:8126)()                                                                                                                    \n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function()                                                                                                                           \n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orth\n    496                 if not is_Expression(args[-1]):\n    497                     try:\n--> 498                         return self._evalf_(*args)\n    499                     except AttributeError:\n    500                         pass\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _evalf_(self, *args, \n    651         from sage.libs.mpmath.all import chebyt as mpchebyt\n    652 \n--> 653         return mpcall(mpchebyt,args[0],args[-1],prec = precision)\n    654 \n    655     def _maxima_init_evaled_(self, *args):\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.wrapped_specfun.__call__ (sage/lit_main.c:17447)()                                                                                                                                           \n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/orthogonal.pyc in chebyt(ctx, n, x, **kwarg\n    444     if (not x) and ctx.isint(n) and int(ctx._re(n)) % 2 == 1:\n    445         return x * 0\n--> 446     return ctx.hyp2f1(-n,n,(1,2),(1-x)/2, **kwargs)\n    447 \n    448 @defun_wrapped\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/hypergeometric.pyc in hyp2f1(ctx, a, b, c, z, **kwargs)\n    248 @defun\n    249 def hyp2f1(ctx,a,b,c,z,**kwargs):\n--> 250     return ctx.hyper([a,b],[c],z,**kwargs)\n    251 \n    252 @defun\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/hypergeometric.pyc in hyper(ctx, a_s, b_s, z, **kwargs)\n    223         elif q == 0: return ctx._hyp1f0(a_s[0][0], z)\n    224     elif p == 2:\n--> 225         if   q == 1: return ctx._hyp2f1(a_s, b_s, z, **kwargs)\n    226         elif q == 2: return ctx._hyp2f2(a_s, b_s, z, **kwargs)\n    227         elif q == 3: return ctx._hyp2f3(a_s, b_s, z, **kwargs)\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/hypergeometric.pyc in _hyp2f1(ctx, a_s, b_s, z, **kwargs)\n    442     if absz <= 0.8 or (ctx.isint(a) and a <= 0 and a >= -1000) or \\\n    443                       (ctx.isint(b) and b <= 0 and b >= -1000):\n--> 444         return ctx.hypsum(2, 1, (atype, btype, ctype), [a, b, c], z, **kwargs)\n    445 \n    446     orig = ctx.prec\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/ctx_mp.pyc in hypsum(ctx, p, q, flags, coeffs, z, accurate_small, **kwargs)\n    640                 mag_dict = {}\n    641             zv, have_complex, magnitude = summator(coeffs, v, prec, wp, \\\n--> 642                 epsshift, mag_dict, **kwargs)\n    643             cancel = -magnitude\n    644             jumps_resolved = True\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/libmp/libhyper.pyc in _hypsum(coeffs, z, prec, wp, epsshift, magnitude_check, **kwargs)\n    319         def _hypsum(coeffs, z, prec, wp, epsshift, magnitude_check, **kwargs):\n    320             return hypsum_internal(p, q, param_types, ztype, coeffs, z,\n--> 321                 prec, wp, epsshift, magnitude_check, kwargs)\n    322 \n    323         return \"(none)\", _hypsum\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.hypsum_internal (sage/libs/mpmath/ext_main.c:24850)()\n\n/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/ext_impl.so in sage.libs.mpmath.ext_impl.MPF_hypsum (sage/libs/mpmath/ext_impl.c:20614)()\n\nNoConvergence: Hypergeometric series converges too slowly. Try increasing maxterms.\n```",
    "created_at": "2013-12-06T10:17:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85353",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:90" align="right">comment:90</div>

Also, you should never simply `print` stuff. Either delete those prints or use a [Python warning](http://docs.python.org/2/library/warnings.html#available-functions).

```
sage: chebyshev_T(10^6,RealField(256)(2))
Warning: mpmath returns NoConvergence!
Switching to clenshaw_method, but it may not be stable!
1.764019427245793968639371137094247875315949668035854027376792158135922267593e571947
```

The message is also misleading, since for some inputs it retries `mpmath` anyway:

```
sage: chebyshev_T(100001/2, 2)
---------------------------------------------------------------------------
NoConvergence                             Traceback (most recent call last)
<ipython-input-34-9c95a5ff4276> in <module>()
----> 1 chebyshev_T(Integer(100001)/Integer(2), Integer(2))

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/ort
    557             return self._eval_(n,x) # Let eval methode decide which is best
    558         else: # Consider OrthogonalPolynomial as symbol
--> 559             return super(OrthogonalPolynomial,self).__call__(n,x)
    560 
    561 

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.BuiltinFp:8126)()                                                                                                                    

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/symbolic/function.so in sage.symbolic.function.Function()                                                                                                                           

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orth
    496                 if not is_Expression(args[-1]):
    497                     try:
--> 498                         return self._evalf_(*args)
    499                     except AttributeError:
    500                         pass

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/functions/orthogonal_polys.pyc in _evalf_(self, *args, 
    651         from sage.libs.mpmath.all import chebyt as mpchebyt
    652 
--> 653         return mpcall(mpchebyt,args[0],args[-1],prec = precision)
    654 
    655     def _maxima_init_evaled_(self, *args):

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/utils.so in sage.libs.mpmath.utils.call (sage/libs/

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.wrapped_specfun.__call__ (sage/lit_main.c:17447)()                                                                                                                                           

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/orthogonal.pyc in chebyt(ctx, n, x, **kwarg
    444     if (not x) and ctx.isint(n) and int(ctx._re(n)) % 2 == 1:
    445         return x * 0
--> 446     return ctx.hyp2f1(-n,n,(1,2),(1-x)/2, **kwargs)
    447 
    448 @defun_wrapped

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/hypergeometric.pyc in hyp2f1(ctx, a, b, c, z, **kwargs)
    248 @defun
    249 def hyp2f1(ctx,a,b,c,z,**kwargs):
--> 250     return ctx.hyper([a,b],[c],z,**kwargs)
    251 
    252 @defun

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/hypergeometric.pyc in hyper(ctx, a_s, b_s, z, **kwargs)
    223         elif q == 0: return ctx._hyp1f0(a_s[0][0], z)
    224     elif p == 2:
--> 225         if   q == 1: return ctx._hyp2f1(a_s, b_s, z, **kwargs)
    226         elif q == 2: return ctx._hyp2f2(a_s, b_s, z, **kwargs)
    227         elif q == 3: return ctx._hyp2f3(a_s, b_s, z, **kwargs)

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/functions/hypergeometric.pyc in _hyp2f1(ctx, a_s, b_s, z, **kwargs)
    442     if absz <= 0.8 or (ctx.isint(a) and a <= 0 and a >= -1000) or \
    443                       (ctx.isint(b) and b <= 0 and b >= -1000):
--> 444         return ctx.hypsum(2, 1, (atype, btype, ctype), [a, b, c], z, **kwargs)
    445 
    446     orig = ctx.prec

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/ctx_mp.pyc in hypsum(ctx, p, q, flags, coeffs, z, accurate_small, **kwargs)
    640                 mag_dict = {}
    641             zv, have_complex, magnitude = summator(coeffs, v, prec, wp, \
--> 642                 epsshift, mag_dict, **kwargs)
    643             cancel = -magnitude
    644             jumps_resolved = True

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/mpmath/libmp/libhyper.pyc in _hypsum(coeffs, z, prec, wp, epsshift, magnitude_check, **kwargs)
    319         def _hypsum(coeffs, z, prec, wp, epsshift, magnitude_check, **kwargs):
    320             return hypsum_internal(p, q, param_types, ztype, coeffs, z,
--> 321                 prec, wp, epsshift, magnitude_check, kwargs)
    322 
    323         return "(none)", _hypsum

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/ext_main.so in sage.libs.mpmath.ext_main.hypsum_internal (sage/libs/mpmath/ext_main.c:24850)()

/usr/local/src/sage-5.13.beta1/local/lib/python2.7/site-packages/sage/libs/mpmath/ext_impl.so in sage.libs.mpmath.ext_impl.MPF_hypsum (sage/libs/mpmath/ext_impl.c:20614)()

NoConvergence: Hypergeometric series converges too slowly. Try increasing maxterms.
```



---

archive/issue_comments_085354.json:
```json
{
    "body": "<div id=\"comment:91\" align=\"right\">comment:91</div>\n\nDon't forget to fix the `REFERENCES`.",
    "created_at": "2013-12-06T10:24:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85354",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:91" align="right">comment:91</div>

Don't forget to fix the `REFERENCES`.



---

archive/issue_comments_085355.json:
```json
{
    "body": "<div id=\"comment:92\" align=\"right\">comment:92</div>\n\n\n```\nsage: chebyshev_U(-1, Mod(2,5))\n...\nRuntimeError: maximum recursion depth exceeded\n```",
    "created_at": "2013-12-06T13:27:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85355",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:92" align="right">comment:92</div>


```
sage: chebyshev_U(-1, Mod(2,5))
...
RuntimeError: maximum recursion depth exceeded
```



---

archive/issue_comments_085356.json:
```json
{
    "body": "<div id=\"comment:93\" align=\"right\">comment:93</div>\n\nThis is totally meaningless (this should be a `ValueError`):\n\n```\nsage: chebyshev_U(1.5, Mod(8,9))\n63.8753125671848\n```",
    "created_at": "2013-12-06T13:28:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85356",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:93" align="right">comment:93</div>

This is totally meaningless (this should be a `ValueError`):

```
sage: chebyshev_U(1.5, Mod(8,9))
63.8753125671848
```



---

archive/issue_comments_085357.json:
```json
{
    "body": "<div id=\"comment:94\" align=\"right\">comment:94</div>\n\n`mpmath` is slower than `_cheb_recur_()`, so I think `mpmath` should be only used in cases where the index is not an integer.\n\nPerhaps the `_eval_` logic should be\n1. `n` in `ZZ` => use recursion. If `x` is symbolic and `abs(n) <= 50`, `expand()` the result\n2. `n` or `x` symbolic => use symbolic evaluation\n3. `n` and `x` real/complex => use `mpmath`\n4. anything else => `raise ValueError`",
    "created_at": "2013-12-06T13:42:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85357",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:94" align="right">comment:94</div>

`mpmath` is slower than `_cheb_recur_()`, so I think `mpmath` should be only used in cases where the index is not an integer.

Perhaps the `_eval_` logic should be
1. `n` in `ZZ` => use recursion. If `x` is symbolic and `abs(n) <= 50`, `expand()` the result
2. `n` or `x` symbolic => use symbolic evaluation
3. `n` and `x` real/complex => use `mpmath`
4. anything else => `raise ValueError`



---

archive/issue_comments_085358.json:
```json
{
    "body": "<div id=\"comment:95\" align=\"right\">comment:95</div>\n\nOne should be able to convert to maxima (otherwise, what's the point of introducing symbolic Chebyshev polynomials):\n\n```\nsage: var('n,x')\n(n, x)\nsage: maxima( chebyshev_T(n, cos(x)) )\n...\nTypeError: unable to convert x (=n) to an integer\n```",
    "created_at": "2013-12-06T13:46:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85358",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:95" align="right">comment:95</div>

One should be able to convert to maxima (otherwise, what's the point of introducing symbolic Chebyshev polynomials):

```
sage: var('n,x')
(n, x)
sage: maxima( chebyshev_T(n, cos(x)) )
...
TypeError: unable to convert x (=n) to an integer
```



---

archive/issue_comments_085359.json:
```json
{
    "body": "<div id=\"comment:96\" align=\"right\">comment:96</div>\n\nReplying to [@jdemeyer](#comment%3A93):\n> This is totally meaningless (this should be a `ValueError`):\n> \n> ```\n> sage: chebyshev_U(1.5, Mod(8,9))\n> 63.8753125671848\n> ```\n\nIndeed, but it's not my fault. It appears, that the BuiltinFunction calls the `_eval_numpy_` method. E.g.\n\n```\nsage: csc(Mod(8,9))\n1.01075621840010\n```\nmakes no sense either but works. Maybe we should open a ticket on this?\n\nI have worked out now a new patch, where `_eval_` returns None, like expected, but still returns this numerical value. But it should be patched in the Symbolic function classes and not here.",
    "created_at": "2013-12-08T15:13:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85359",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:96" align="right">comment:96</div>

Replying to [@jdemeyer](#comment%3A93):
> This is totally meaningless (this should be a `ValueError`):
> 
> ```
> sage: chebyshev_U(1.5, Mod(8,9))
> 63.8753125671848
> ```

Indeed, but it's not my fault. It appears, that the BuiltinFunction calls the `_eval_numpy_` method. E.g.

```
sage: csc(Mod(8,9))
1.01075621840010
```
makes no sense either but works. Maybe we should open a ticket on this?

I have worked out now a new patch, where `_eval_` returns None, like expected, but still returns this numerical value. But it should be patched in the Symbolic function classes and not here.



---

archive/issue_comments_085360.json:
```json
{
    "body": "<div id=\"comment:97\" align=\"right\">comment:97</div>\n\nReplying to [@jdemeyer](#comment%3A95):\n> One should be able to convert to maxima (otherwise, what's the point of introducing symbolic Chebyshev polynomials):\n> \n> ```\n> sage: var('n,x')\n> (n, x)\n> sage: maxima( chebyshev_T(n, cos(x)) )\n> ...\n> TypeError: unable to convert x (=n) to an integer\n> ```\n\nOne of the reasons I started this rewriting buisness, was the fact, that Maxima is very limited in respect to Orthogonal polynomials. And if we consider advanced use for symbolic methods like 'Creative Telescoping' it makes perfect sense to allow a non\nMaxima conform representation, since Sage symbolic capabilities don't relie on Maxima allone.",
    "created_at": "2013-12-08T15:20:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85360",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:97" align="right">comment:97</div>

Replying to [@jdemeyer](#comment%3A95):
> One should be able to convert to maxima (otherwise, what's the point of introducing symbolic Chebyshev polynomials):
> 
> ```
> sage: var('n,x')
> (n, x)
> sage: maxima( chebyshev_T(n, cos(x)) )
> ...
> TypeError: unable to convert x (=n) to an integer
> ```

One of the reasons I started this rewriting buisness, was the fact, that Maxima is very limited in respect to Orthogonal polynomials. And if we consider advanced use for symbolic methods like 'Creative Telescoping' it makes perfect sense to allow a non
Maxima conform representation, since Sage symbolic capabilities don't relie on Maxima allone.



---

archive/issue_comments_085361.json:
```json
{
    "body": "<div id=\"comment:98\" align=\"right\">comment:98</div>\n\nReplying to [@sagetrac-maldun](#comment%3A97):\n> One of the reasons I started this rewriting buisness, was the fact, that Maxima is very limited in respect to Orthogonal polynomials. And if we consider advanced use for symbolic methods like 'Creative Telescoping' it makes perfect sense to allow a non\n> Maxima conform representation, since Sage symbolic capabilities don't relie on Maxima allone.\n\nThis looks like a poor excuse to me, since Maxima can deal with Chebyshev polynomials just fine. The following works:\n\n```\nsage: maxima('chebysheb_t(n,x)')\n```\nThe fact that the conversion to Maxima doesn't work is a fault of your patch, don't blame Maxima for that.",
    "created_at": "2013-12-08T17:17:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85361",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:98" align="right">comment:98</div>

Replying to [@sagetrac-maldun](#comment%3A97):
> One of the reasons I started this rewriting buisness, was the fact, that Maxima is very limited in respect to Orthogonal polynomials. And if we consider advanced use for symbolic methods like 'Creative Telescoping' it makes perfect sense to allow a non
> Maxima conform representation, since Sage symbolic capabilities don't relie on Maxima allone.

This looks like a poor excuse to me, since Maxima can deal with Chebyshev polynomials just fine. The following works:

```
sage: maxima('chebysheb_t(n,x)')
```
The fact that the conversion to Maxima doesn't work is a fault of your patch, don't blame Maxima for that.



---

archive/issue_comments_085362.json:
```json
{
    "body": "<div id=\"comment:99\" align=\"right\">comment:99</div>\n\nReplying to [@sagetrac-maldun](#comment%3A96):\n> \n> ```\n> sage: csc(Mod(8,9))\n> 1.01075621840010\n> ```\n> makes no sense either but works. Maybe we should open a ticket on this?\n\nI agree, this is a problem.",
    "created_at": "2013-12-08T17:17:45Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85362",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:99" align="right">comment:99</div>

Replying to [@sagetrac-maldun](#comment%3A96):
> 
> ```
> sage: csc(Mod(8,9))
> 1.01075621840010
> ```
> makes no sense either but works. Maybe we should open a ticket on this?

I agree, this is a problem.



---

archive/issue_comments_085363.json:
```json
{
    "body": "<div id=\"comment:100\" align=\"right\">comment:100</div>\n\nReplying to [@jdemeyer](#comment%3A98):\n> Replying to [@sagetrac-maldun](#comment%3A97):\n> > One of the reasons I started this rewriting buisness, was the fact, that Maxima is very limited in respect to Orthogonal polynomials. And if we consider advanced use for symbolic methods like 'Creative Telescoping' it makes perfect sense to allow a non\n> > Maxima conform representation, since Sage symbolic capabilities don't relie on Maxima allone.\n> \n> This looks like a poor excuse to me, since Maxima can deal with Chebyshev polynomials just fine. The following works:\n> \n> ```\n> sage: maxima('chebysheb_t(n,x)')\n> ```\n> The fact that the conversion to Maxima doesn't work is a fault of your patch, don't blame Maxima for that.\n\nI'm not blaming maxima, but this never worked on the main branch in the first place:\n\n\n```\nmaxima( chebyshev_T(n, cos(x)) )\n...\nTypeError: unable to convert x (=n) to an integer\n```\n\nso I did not break anything ...\n\nYou can argue that this is an open improvement, but it's definitely no regression.\nNevertheless it will be corrected in the next patch.",
    "created_at": "2013-12-08T18:14:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85363",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:100" align="right">comment:100</div>

Replying to [@jdemeyer](#comment%3A98):
> Replying to [@sagetrac-maldun](#comment%3A97):
> > One of the reasons I started this rewriting buisness, was the fact, that Maxima is very limited in respect to Orthogonal polynomials. And if we consider advanced use for symbolic methods like 'Creative Telescoping' it makes perfect sense to allow a non
> > Maxima conform representation, since Sage symbolic capabilities don't relie on Maxima allone.
> 
> This looks like a poor excuse to me, since Maxima can deal with Chebyshev polynomials just fine. The following works:
> 
> ```
> sage: maxima('chebysheb_t(n,x)')
> ```
> The fact that the conversion to Maxima doesn't work is a fault of your patch, don't blame Maxima for that.

I'm not blaming maxima, but this never worked on the main branch in the first place:


```
maxima( chebyshev_T(n, cos(x)) )
...
TypeError: unable to convert x (=n) to an integer
```

so I did not break anything ...

You can argue that this is an open improvement, but it's definitely no regression.
Nevertheless it will be corrected in the next patch.



---

archive/issue_comments_085364.json:
```json
{
    "body": "Bunch of corrections and new doctests",
    "created_at": "2013-12-08T21:04:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85364",
    "user": "https://github.com/sagetrac-maldun"
}
```

Bunch of corrections and new doctests



---

archive/issue_comments_085365.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -15,3 +15,4 @@\n \n * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n * [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)\n+* [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)\n``````\n",
    "created_at": "2013-12-08T21:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85365",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -15,3 +15,4 @@
 
 * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
 * [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)
+* [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)
``````




---

archive/issue_comments_085366.json:
```json
{
    "body": "<div id=\"comment:101\" align=\"right\">comment:101</div>\n\nAttachment: **[trac_9707_chebyshev_corrections.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9707_chebyshev_corrections.patch.gz)**\n\nI incorporated now the things you wished for, except things for ducumentation.\nI also added many new doctests.\n\nI also cleaned up the evaluation methods.",
    "created_at": "2013-12-08T21:06:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85366",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:101" align="right">comment:101</div>

Attachment: **[trac_9707_chebyshev_corrections.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9707_chebyshev_corrections.patch.gz)**

I incorporated now the things you wished for, except things for ducumentation.
I also added many new doctests.

I also cleaned up the evaluation methods.



---

archive/issue_comments_085367.json:
```json
{
    "body": "Attachment: **[trac_9706_chebyshev_corrections.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)**\n\ncorrected name of file",
    "created_at": "2013-12-08T22:22:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85367",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[trac_9706_chebyshev_corrections.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)**

corrected name of file



---

archive/issue_comments_085368.json:
```json
{
    "body": "Attachment: **[trac_9706_chebyshev_docu.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)**\n\ndocu changes",
    "created_at": "2013-12-08T22:22:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85368",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[trac_9706_chebyshev_docu.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)**

docu changes



---

archive/issue_comments_085369.json:
```json
{
    "body": "docu changes",
    "created_at": "2013-12-08T22:22:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85369",
    "user": "https://github.com/sagetrac-maldun"
}
```

docu changes



---

archive/issue_comments_085370.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -16,3 +16,4 @@\n * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n * [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)\n * [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)\n+* [attachment: trac_9706_chebyshev_docu.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)\n``````\n",
    "created_at": "2013-12-08T22:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85370",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -16,3 +16,4 @@
 * [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
 * [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)
 * [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)
+* [attachment: trac_9706_chebyshev_docu.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)
``````




---

archive/issue_events_124329.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-08T22:24:27Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124329"
}
```



---

archive/issue_events_124330.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-08T22:24:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124330"
}
```



---

archive/issue_comments_085371.json:
```json
{
    "body": "<div id=\"comment:102\" align=\"right\">comment:102</div>\n\nAttachment: **[trac_9706_chebyshev_docu.2.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.2.patch.gz)**\n\nadded changes in docu.\n\nStill one bug to fix",
    "created_at": "2013-12-08T22:24:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85371",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:102" align="right">comment:102</div>

Attachment: **[trac_9706_chebyshev_docu.2.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.2.patch.gz)**

added changes in docu.

Still one bug to fix



---

archive/issue_events_124331.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-08T22:27:03Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124331"
}
```



---

archive/issue_events_124332.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-08T22:27:03Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124332"
}
```



---

archive/issue_comments_085372.json:
```json
{
    "body": "fixed bugs with chebyshev_U(-1,...)",
    "created_at": "2013-12-08T22:41:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85372",
    "user": "https://github.com/sagetrac-maldun"
}
```

fixed bugs with chebyshev_U(-1,...)



---

archive/issue_comments_085373.json:
```json
{
    "body": "<div id=\"comment:104\" align=\"right\">comment:104</div>\n\nAttachment: **[trac_9706_chebyshev_U-1.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_U-1.patch.gz)**\n\nFinally fixed the chebyshev_U(-1,...) issue",
    "created_at": "2013-12-08T22:41:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85373",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:104" align="right">comment:104</div>

Attachment: **[trac_9706_chebyshev_U-1.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_U-1.patch.gz)**

Finally fixed the chebyshev_U(-1,...) issue



---

archive/issue_comments_085374.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,3 +17,4 @@\n * [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)\n * [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)\n * [attachment: trac_9706_chebyshev_docu.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)\n+* [attachment: trac_9706_chebyshev_U-1.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_U-1.patch.gz)\n``````\n",
    "created_at": "2013-12-08T22:41:58Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85374",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,3 +17,4 @@
 * [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)
 * [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)
 * [attachment: trac_9706_chebyshev_docu.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)
+* [attachment: trac_9706_chebyshev_U-1.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_U-1.patch.gz)
``````




---

archive/issue_events_124333.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-08T22:41:58Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124333"
}
```



---

archive/issue_events_124334.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-08T22:41:58Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124334"
}
```



---

archive/issue_comments_085375.json:
```json
{
    "body": "collection of all patches",
    "created_at": "2013-12-08T23:06:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85375",
    "user": "https://github.com/sagetrac-maldun"
}
```

collection of all patches



---

archive/issue_comments_085376.json:
```json
{
    "body": "<div id=\"comment:105\" align=\"right\">comment:105</div>\n\nAttachment: **[trac_9706_chebyshev_collection.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)**",
    "created_at": "2013-12-08T23:06:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85376",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:105" align="right">comment:105</div>

Attachment: **[trac_9706_chebyshev_collection.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)**



---

archive/issue_comments_085377.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -13,8 +13,4 @@\n \n Apply:\n \n-* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)\n-* [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)\n-* [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)\n-* [attachment: trac_9706_chebyshev_docu.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)\n-* [attachment: trac_9706_chebyshev_U-1.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_U-1.patch.gz)\n+* [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)\n``````\n",
    "created_at": "2013-12-08T23:06:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85377",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -13,8 +13,4 @@
 
 Apply:
 
-* [attachment: trac_9706_chebyshev.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev.patch.gz)
-* [attachment: trac_9706_bugfixes_and_doctests.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_bugfixes_and_doctests.patch.gz)
-* [attachment: trac_9706_chebyshev_corrections.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_corrections.patch.gz)
-* [attachment: trac_9706_chebyshev_docu.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_docu.patch.gz)
-* [attachment: trac_9706_chebyshev_U-1.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_U-1.patch.gz)
+* [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)
``````




---

archive/issue_comments_085378.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,16 +1,3 @@\n-The current implementation of orthogonal polynomials is just a wrapper around maxima. (see http://wiki.sagemath.org/symbolics/)\n-This update holds the following changes:\n-\n-* using of the pynac class for symbolic functions.\n-* faster evaluation in general\n-* evaluation of special values\n-* mpmath for numeric evaluation\n-\n-**Remarks:** \n-* The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) \n-* Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)\n-* Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).\n-\n Apply:\n \n * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)\n``````\n",
    "created_at": "2013-12-09T09:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85378",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,16 +1,3 @@
-The current implementation of orthogonal polynomials is just a wrapper around maxima. (see http://wiki.sagemath.org/symbolics/)
-This update holds the following changes:
-
-* using of the pynac class for symbolic functions.
-* faster evaluation in general
-* evaluation of special values
-* mpmath for numeric evaluation
-
-**Remarks:** 
-* The current patch needs scipy-0.8. One has to install it before testing (see #9808 for spkg's and installation instructions) 
-* Some of the old doctests in the old file don't work any more, due to coercion problems with pynac (see #9769)
-* Some doctests in Sage change, due to the fact that new BuiltIn functions are added. symbolic.random_test.py had output changes since the random expression creation changed of course. The tests in pynac.pyx also changed, but this has a strange behavior (see below).
-
 Apply:
 
 * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)
``````




---

archive/issue_comments_085379.json:
```json
{
    "body": "Changed reviewer from **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer** to **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer, Jeroen Demeyer**",
    "created_at": "2013-12-09T09:55:44Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85379",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer** to **Burcin Erocal, Travis Scrimshaw, Stefan Reiterer, Jeroen Demeyer**



---

archive/issue_comments_085380.json:
```json
{
    "body": "<div id=\"comment:107\" align=\"right\">comment:107</div>\n\nWorking on reviewer patch...",
    "created_at": "2013-12-09T10:59:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85380",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:107" align="right">comment:107</div>

Working on reviewer patch...



---

archive/issue_events_124335.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-09T14:31:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20minor%20/%204",
    "label_color": "ffe799",
    "label_name": "p: minor / 4",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124335"
}
```



---

archive/issue_events_124336.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-09T14:31:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20major%20/%203",
    "label_color": "ffbb00",
    "label_name": "p: major / 3",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124336"
}
```



---

archive/issue_comments_085381.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,4 @@\n Apply:\n \n * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)\n+* [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)\n``````\n",
    "created_at": "2013-12-09T14:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85381",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,4 @@
 Apply:
 
 * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)
+* [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)
``````




---

archive/issue_comments_085382.json:
```json
{
    "body": "Dependencies: **#864, #9640, #10018, #11868, #15422**",
    "created_at": "2013-12-09T14:31:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85382",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#864, #9640, #10018, #11868, #15422**



---

archive/issue_comments_085383.json:
```json
{
    "body": "<div id=\"comment:109\" align=\"right\">comment:109</div>\n\nReview patch, mainly simplifies the code: less special cases and use actual arguments instead of `args` and `kwds`. Also add some more doctests.",
    "created_at": "2013-12-09T14:34:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85383",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:109" align="right">comment:109</div>

Review patch, mainly simplifies the code: less special cases and use actual arguments instead of `args` and `kwds`. Also add some more doctests.



---

archive/issue_comments_085384.json:
```json
{
    "body": "<div id=\"comment:110\" align=\"right\">comment:110</div>\n\nReplying to [@jdemeyer](#comment%3A109):\n> Review patch, mainly simplifies the code: less special cases and use actual arguments instead of `args` and `kwds`. Also add some more doctests.\n\nIs it really a good idea to replace *args and **kwds in the OrthogonalPolynomial class?\n\nSince not all ortho polys only have 2 arguments, e.g. Gegenbauer polynomials [http://en.wikipedia.org/wiki/Gegenbauer_polynomials](http://en.wikipedia.org/wiki/Gegenbauer_polynomials) which have an additional parameter alpha\nIt makes perfect sense for the chebyshev polys though\n\nI know that the base class looks strange from the point of the Chebyshev polys,\nbut there is some reasoning behind this =)",
    "created_at": "2013-12-09T17:09:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85384",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:110" align="right">comment:110</div>

Replying to [@jdemeyer](#comment%3A109):
> Review patch, mainly simplifies the code: less special cases and use actual arguments instead of `args` and `kwds`. Also add some more doctests.

Is it really a good idea to replace *args and **kwds in the OrthogonalPolynomial class?

Since not all ortho polys only have 2 arguments, e.g. Gegenbauer polynomials [http://en.wikipedia.org/wiki/Gegenbauer_polynomials](http://en.wikipedia.org/wiki/Gegenbauer_polynomials) which have an additional parameter alpha
It makes perfect sense for the chebyshev polys though

I know that the base class looks strange from the point of the Chebyshev polys,
but there is some reasoning behind this =)



---

archive/issue_comments_085385.json:
```json
{
    "body": "<div id=\"comment:111\" align=\"right\">comment:111</div>\n\nAttachment: **[9706_review.patch.gz](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)**\n\nReplying to [@sagetrac-maldun](#comment%3A110):\n> Is it really a good idea to replace *args and **kwds in the OrthogonalPolynomial class?\n> \n> Since not all ortho polys only have 2 arguments, e.g. Gegenbauer polynomials [http://en.wikipedia.org/wiki/Gegenbauer_polynomials](http://en.wikipedia.org/wiki/Gegenbauer_polynomials) which have an additional parameter alpha\n> It makes perfect sense for the chebyshev polys though\n\nOk, it's always difficult to design an interface for something you don't have an implementation for, but I made the change such that the Gegenbauer polynomials should (in theory) work.",
    "created_at": "2013-12-09T18:43:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85385",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:111" align="right">comment:111</div>

Attachment: **[9706_review.patch.gz](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)**

Replying to [@sagetrac-maldun](#comment%3A110):
> Is it really a good idea to replace *args and **kwds in the OrthogonalPolynomial class?
> 
> Since not all ortho polys only have 2 arguments, e.g. Gegenbauer polynomials [http://en.wikipedia.org/wiki/Gegenbauer_polynomials](http://en.wikipedia.org/wiki/Gegenbauer_polynomials) which have an additional parameter alpha
> It makes perfect sense for the chebyshev polys though

Ok, it's always difficult to design an interface for something you don't have an implementation for, but I made the change such that the Gegenbauer polynomials should (in theory) work.



---

archive/issue_comments_085386.json:
```json
{
    "body": "<div id=\"comment:112\" align=\"right\">comment:112</div>\n\nReplying to [@jdemeyer](#comment%3A111):\n> Replying to [@sagetrac-maldun](#comment%3A110):\n> > Is it really a good idea to replace *args and **kwds in the OrthogonalPolynomial class?\n> > \n> > Since not all ortho polys only have 2 arguments, e.g. Gegenbauer polynomials [http://en.wikipedia.org/wiki/Gegenbauer_polynomials](http://en.wikipedia.org/wiki/Gegenbauer_polynomials) which have an additional parameter alpha\n> > It makes perfect sense for the chebyshev polys though\n> \n> Ok, it's always difficult to design an interface for something you don't have an implementation for, but I made the change such that the Gegenbauer polynomials should (in theory) work.\n\nMaybe you should have a short look ino this patch: [https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz)\nit contains already prototypes of the most ortho polys.\n\nI have some remarks concerning your patch:\n\n\n```\nsage: chebyshev_T(n,Mod(0,8))\n1/2*(-1)^(1/2*n)*((-1)^n + 1)\n```\nbut this makes no sense since 1/2 is not defined in Mod(8). This was the reason for the 0 in CC check at this point.\n\nYou evaluate numerical expressions for n in NN with recursion. this is favorable for chebyshev polynomials, but not for all ortho polys you can evaluate numeric values in O(log n). You have already problems with the legendre polynomials, since the coefficients depend on n, and the recursion is not stable. Thus other evaluation methods should be used. Thats the reason why `_evalf_` with mpmath should come first.\nIn case of chebyshev I catched this with an explicit call of the recursion in _evalf_.\n\nThe `_old_maxima_` method is used for some oddballs, where the only useful implementation is in maxima, and for some special cases. So removing is probably not a good idea.\n\nThe reason why negative values are checked in special values, is that in later versions, or for other polys non integral negative values can be treated analogously, as in the case of their algebraic counterpart. E.g negative legendre polynomials would return associated legendre functions, but have no algebraic sense.\n\nAnother reason to allow the special values check for non symbolic input, is that e.g. (-1)^100000000 is evaluated faster, than applying the recursion, or other special points.\nI use this feature sometimes to evaluate certain polynomials at the end points of an intervall e.g. [-1,1]\n\n**Question:** Since the Legendre Polynomials already conflicts with the design in the ortho poly class, should we add legendre_P too, to get a better overview, what actually should be kept in the orthogonal poly class? then we could also add more reasonable doctests, to understand the evaluation methods better. \n\nI have to admit, that about 3 years have passed since I wrote the initial version, and I'm not remembering why I took some design desicisions back then, but slowly my memories are coming back.",
    "created_at": "2013-12-09T20:10:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85386",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:112" align="right">comment:112</div>

Replying to [@jdemeyer](#comment%3A111):
> Replying to [@sagetrac-maldun](#comment%3A110):
> > Is it really a good idea to replace *args and **kwds in the OrthogonalPolynomial class?
> > 
> > Since not all ortho polys only have 2 arguments, e.g. Gegenbauer polynomials [http://en.wikipedia.org/wiki/Gegenbauer_polynomials](http://en.wikipedia.org/wiki/Gegenbauer_polynomials) which have an additional parameter alpha
> > It makes perfect sense for the chebyshev polys though
> 
> Ok, it's always difficult to design an interface for something you don't have an implementation for, but I made the change such that the Gegenbauer polynomials should (in theory) work.

Maybe you should have a short look ino this patch: [https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_orthogonal_polys.patch.gz)
it contains already prototypes of the most ortho polys.

I have some remarks concerning your patch:


```
sage: chebyshev_T(n,Mod(0,8))
1/2*(-1)^(1/2*n)*((-1)^n + 1)
```
but this makes no sense since 1/2 is not defined in Mod(8). This was the reason for the 0 in CC check at this point.

You evaluate numerical expressions for n in NN with recursion. this is favorable for chebyshev polynomials, but not for all ortho polys you can evaluate numeric values in O(log n). You have already problems with the legendre polynomials, since the coefficients depend on n, and the recursion is not stable. Thus other evaluation methods should be used. Thats the reason why `_evalf_` with mpmath should come first.
In case of chebyshev I catched this with an explicit call of the recursion in _evalf_.

The `_old_maxima_` method is used for some oddballs, where the only useful implementation is in maxima, and for some special cases. So removing is probably not a good idea.

The reason why negative values are checked in special values, is that in later versions, or for other polys non integral negative values can be treated analogously, as in the case of their algebraic counterpart. E.g negative legendre polynomials would return associated legendre functions, but have no algebraic sense.

Another reason to allow the special values check for non symbolic input, is that e.g. (-1)^100000000 is evaluated faster, than applying the recursion, or other special points.
I use this feature sometimes to evaluate certain polynomials at the end points of an intervall e.g. [-1,1]

**Question:** Since the Legendre Polynomials already conflicts with the design in the ortho poly class, should we add legendre_P too, to get a better overview, what actually should be kept in the orthogonal poly class? then we could also add more reasonable doctests, to understand the evaluation methods better. 

I have to admit, that about 3 years have passed since I wrote the initial version, and I'm not remembering why I took some design desicisions back then, but slowly my memories are coming back.



---

archive/issue_comments_085387.json:
```json
{
    "body": "<div id=\"comment:113\" align=\"right\">comment:113</div>\n\nReplying to [@sagetrac-maldun](#comment%3A112):\n> **Question:** Since the Legendre Polynomials already conflicts with the design in the ortho poly class, should we add legendre_P too, to get a better overview, what actually should be kept in the orthogonal poly class?\n\nAbsolutely not. The patch is already big enough now.",
    "created_at": "2013-12-09T20:26:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85387",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:113" align="right">comment:113</div>

Replying to [@sagetrac-maldun](#comment%3A112):
> **Question:** Since the Legendre Polynomials already conflicts with the design in the ortho poly class, should we add legendre_P too, to get a better overview, what actually should be kept in the orthogonal poly class?

Absolutely not. The patch is already big enough now.



---

archive/issue_comments_085388.json:
```json
{
    "body": "<div id=\"comment:114\" align=\"right\">comment:114</div>\n\nIf the various orthogonal polynomials are so different, then perhaps the simple answer is that we shouldn't try to force a generic `_eval_` which will work for all orthogonal polynomials.\n\nWe could have a common superclass for both kinds of Chebyshev polynomials and implement `_eval_()` there. For Legendre polynomials, we could implement a different `_eval_()`. That would be a much simpler solution than making an overly complicated generic `_eval_()`.",
    "created_at": "2013-12-09T20:30:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85388",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:114" align="right">comment:114</div>

If the various orthogonal polynomials are so different, then perhaps the simple answer is that we shouldn't try to force a generic `_eval_` which will work for all orthogonal polynomials.

We could have a common superclass for both kinds of Chebyshev polynomials and implement `_eval_()` there. For Legendre polynomials, we could implement a different `_eval_()`. That would be a much simpler solution than making an overly complicated generic `_eval_()`.



---

archive/issue_comments_085389.json:
```json
{
    "body": "<div id=\"comment:115\" align=\"right\">comment:115</div>\n\nReplying to [@jdemeyer](#comment%3A114):\n> If the various orthogonal polynomials are so different, then perhaps the simple answer is that we shouldn't try to force a generic `_eval_` which will work for all orthogonal polynomials.\n> \n> We could have a common superclass for both kinds of Chebyshev polynomials and implement `_eval_()` there. For Legendre polynomials, we could implement a different `_eval_()`. That would be a much simpler solution than making an overly complicated generic `_eval_()`.\n\nI think this would be a good course of action, and that we should put other orthogonal polynomials in other tickets. However, I think it might be worthwhile to at least diagram/pseudocode the overall class structure we want at the end of the day. Currently I believe the proposal is something like:\n\n```\n* Orthogonal polynomials\n\n  * Chebyshev polynomials\n    - general _evel_(x, n) method\n\n    * Chebyshev T\n      - specific code (ex. _evalf_() method), recursions, ...\n    * Chebyshev U\n      - specific code (ex. _evalf_() method), recursions, ...\n\n  * Legendre polynomials\n    - general _evel_(x, n) method\n\n    * Legendre P\n    * Legendre Q\n\n  * Gegenbauer polynomials\n    - an _evel_(x, n, alpha) method\n```\nHopefully my notation is clear",
    "created_at": "2013-12-09T20:47:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85389",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:115" align="right">comment:115</div>

Replying to [@jdemeyer](#comment%3A114):
> If the various orthogonal polynomials are so different, then perhaps the simple answer is that we shouldn't try to force a generic `_eval_` which will work for all orthogonal polynomials.
> 
> We could have a common superclass for both kinds of Chebyshev polynomials and implement `_eval_()` there. For Legendre polynomials, we could implement a different `_eval_()`. That would be a much simpler solution than making an overly complicated generic `_eval_()`.

I think this would be a good course of action, and that we should put other orthogonal polynomials in other tickets. However, I think it might be worthwhile to at least diagram/pseudocode the overall class structure we want at the end of the day. Currently I believe the proposal is something like:

```
* Orthogonal polynomials

  * Chebyshev polynomials
    - general _evel_(x, n) method

    * Chebyshev T
      - specific code (ex. _evalf_() method), recursions, ...
    * Chebyshev U
      - specific code (ex. _evalf_() method), recursions, ...

  * Legendre polynomials
    - general _evel_(x, n) method

    * Legendre P
    * Legendre Q

  * Gegenbauer polynomials
    - an _evel_(x, n, alpha) method
```
Hopefully my notation is clear



---

archive/issue_comments_085390.json:
```json
{
    "body": "Changed author from **Stefan Reiterer, Travis Scrimshaw** to **Stefan Reiterer**",
    "created_at": "2013-12-09T20:47:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85390",
    "user": "https://github.com/tscrim"
}
```

Changed author from **Stefan Reiterer, Travis Scrimshaw** to **Stefan Reiterer**



---

archive/issue_comments_085391.json:
```json
{
    "body": "<div id=\"comment:116\" align=\"right\">comment:116</div>\n\nSomething like that looks right indeed. maldun: what do you think?\n\nPerhaps the only code so far that could be truly generic is the `__call__` method.",
    "created_at": "2013-12-09T21:04:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85391",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:116" align="right">comment:116</div>

Something like that looks right indeed. maldun: what do you think?

Perhaps the only code so far that could be truly generic is the `__call__` method.



---

archive/issue_comments_085392.json:
```json
{
    "body": "<div id=\"comment:117\" align=\"right\">comment:117</div>\n\nSomething like that looks right indeed. maldun: what do you think?\n\nPerhaps the only code so far that could be truly generic is the `__call__` method.",
    "created_at": "2013-12-09T21:04:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85392",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:117" align="right">comment:117</div>

Something like that looks right indeed. maldun: what do you think?

Perhaps the only code so far that could be truly generic is the `__call__` method.



---

archive/issue_comments_085393.json:
```json
{
    "body": "<div id=\"comment:118\" align=\"right\">comment:118</div>\n\nafter some thinking, I guess you are right. A General OrthogonalPolynomial is sophisticated, but it needs too much tweaking, and too much exception cathing, which makes the code unsafe.\n\n@ `__call__` : I'm not even sure about that, since we check for negative integers, but some ortho polys get only an analytical expression with non negative integers, and no algebraic meaning.\n\nI propose the following\n\n* OrthogonalPolynomial: Naming Conventions and `__init__` method\n* ChebyshevPolynomial: base Class for Cheby_t and Cheby_u (Current Orthogonal Polynomials)\n* LegendrePolynomials\n.... etc.",
    "created_at": "2013-12-09T21:21:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85393",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:118" align="right">comment:118</div>

after some thinking, I guess you are right. A General OrthogonalPolynomial is sophisticated, but it needs too much tweaking, and too much exception cathing, which makes the code unsafe.

@ `__call__` : I'm not even sure about that, since we check for negative integers, but some ortho polys get only an analytical expression with non negative integers, and no algebraic meaning.

I propose the following

* OrthogonalPolynomial: Naming Conventions and `__init__` method
* ChebyshevPolynomial: base Class for Cheby_t and Cheby_u (Current Orthogonal Polynomials)
* LegendrePolynomials
.... etc.



---

archive/issue_comments_085394.json:
```json
{
    "body": "Attachment: **[trac_9706_new_base_classes.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)**\n\nproposed new structure",
    "created_at": "2013-12-09T22:02:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85394",
    "user": "https://github.com/sagetrac-maldun"
}
```

Attachment: **[trac_9706_new_base_classes.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)**

proposed new structure



---

archive/issue_comments_085395.json:
```json
{
    "body": "<div id=\"comment:119\" align=\"right\">comment:119</div>\n\nI added an intermediate class between OrthogonalPolynomials and the Chebyshev polynomals namely ChebyshevPolynomial.\n\nAny comments on that?",
    "created_at": "2013-12-11T06:01:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85395",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:119" align="right">comment:119</div>

I added an intermediate class between OrthogonalPolynomials and the Chebyshev polynomals namely ChebyshevPolynomial.

Any comments on that?



---

archive/issue_comments_085396.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -2,3 +2,4 @@\n \n * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)\n * [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)\n+* [attachment: trac_9706_new_base_classes.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)\n``````\n",
    "created_at": "2013-12-11T06:01:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85396",
    "user": "https://github.com/sagetrac-maldun"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -2,3 +2,4 @@
 
 * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)
 * [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)
+* [attachment: trac_9706_new_base_classes.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)
``````




---

archive/issue_comments_085397.json:
```json
{
    "body": "<div id=\"comment:120\" align=\"right\">comment:120</div>\n\nSorry for lagging behind on reviewing this, but I think the class structure is good. I'll write a small review patch tomorrow afternoon (in the US Pacific timezone) on a few tweaks (and pet peeves of mine).",
    "created_at": "2013-12-11T06:38:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85397",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:120" align="right">comment:120</div>

Sorry for lagging behind on reviewing this, but I think the class structure is good. I'll write a small review patch tomorrow afternoon (in the US Pacific timezone) on a few tweaks (and pet peeves of mine).



---

archive/issue_comments_085398.json:
```json
{
    "body": "<div id=\"comment:121\" align=\"right\">comment:121</div>\n\nI am currently working on finishing the Sage 5.13 release, so I don't feel like reviewing this now.",
    "created_at": "2013-12-11T07:22:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85398",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:121" align="right">comment:121</div>

I am currently working on finishing the Sage 5.13 release, so I don't feel like reviewing this now.



---

archive/issue_comments_085399.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -3,3 +3,4 @@\n * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)\n * [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)\n * [attachment: trac_9706_new_base_classes.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)\n+* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)\n``````\n",
    "created_at": "2013-12-11T22:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85399",
    "user": "https://github.com/tscrim"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -3,3 +3,4 @@
 * [attachment: trac_9706_chebyshev_collection.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_chebyshev_collection.patch.gz)
 * [attachment: 9706_review.patch](https://github.com/sagemath/sage/files/ticket9706/9706_review.patch.gz)
 * [attachment: trac_9706_new_base_classes.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706_new_base_classes.patch.gz)
+* [attachment: trac_9706-review-ts.patch](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)
``````




---

archive/issue_comments_085400.json:
```json
{
    "body": "<div id=\"comment:122\" align=\"right\">comment:122</div>\n\nOkay, I've made the tweaks I wanted to. So it's a positive review from me, and someone will just need to review my changes.",
    "created_at": "2013-12-11T22:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85400",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:122" align="right">comment:122</div>

Okay, I've made the tweaks I wanted to. So it's a positive review from me, and someone will just need to review my changes.



---

archive/issue_comments_085401.json:
```json
{
    "body": "<div id=\"comment:123\" align=\"right\">comment:123</div>\n\nOkay thanks. I set it on positive review then.\nAnd good idea to replace the old % format string operator, since it will be deprecated in Python 3 (although I will miss it ...)",
    "created_at": "2013-12-12T19:28:30Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85401",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:123" align="right">comment:123</div>

Okay thanks. I set it on positive review then.
And good idea to replace the old % format string operator, since it will be deprecated in Python 3 (although I will miss it ...)



---

archive/issue_events_124337.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-12T19:28:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124337"
}
```



---

archive/issue_events_124338.json:
```json
{
    "actor": "https://github.com/sagetrac-maldun",
    "created_at": "2013-12-12T19:28:30Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124338"
}
```



---

archive/issue_comments_085402.json:
```json
{
    "body": "<div id=\"comment:124\" align=\"right\">comment:124</div>\n\nReplying to [@sagetrac-maldun](#comment%3A123):\n> And good idea to replace the old % format string operator, since it will be deprecated in Python 3\n\nThis has been a rumour that didn't pan out. I don't think a time line has been set towards actual deprecation of %. The possibility of deprecation is mentioned in \nhttp://www.python.org/dev/peps/pep-3101/\nbut it's careful to argue that deprecation is not required at all. At some point it was planned to deprecate % in 3.0 and remove it in 3.1 but that hasn't happened. I suspect it's so ingrained by now that deprecation and removal is impractical.",
    "created_at": "2013-12-12T21:04:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85402",
    "user": "https://github.com/nbruin"
}
```

<div id="comment:124" align="right">comment:124</div>

Replying to [@sagetrac-maldun](#comment%3A123):
> And good idea to replace the old % format string operator, since it will be deprecated in Python 3

This has been a rumour that didn't pan out. I don't think a time line has been set towards actual deprecation of %. The possibility of deprecation is mentioned in 
http://www.python.org/dev/peps/pep-3101/
but it's careful to argue that deprecation is not required at all. At some point it was planned to deprecate % in 3.0 and remove it in 3.1 but that hasn't happened. I suspect it's so ingrained by now that deprecation and removal is impractical.



---

archive/issue_comments_085403.json:
```json
{
    "body": "<div id=\"comment:125\" align=\"right\">comment:125</div>\n\nTravis: are you sure you applied the dependency #15422? I am suspicious because you added\n\n```diff\n-            (2^7 + O(2^8))*t^5 + (O(2^8))*t^4 + (2^6 + O(2^8))*t^3 + (O(2^8))*t^2 + (1 + 2^6 + O(2^8))*t + (O(2^8))\n+            (2^7 + O(2^8))*t^5 + (2^6 + O(2^8))*t^3 + (1 + 2^6 + O(2^8))*t\n```\nwhich seems to be a doctest failure.",
    "created_at": "2013-12-16T09:30:48Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85403",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:125" align="right">comment:125</div>

Travis: are you sure you applied the dependency #15422? I am suspicious because you added

```diff
-            (2^7 + O(2^8))*t^5 + (O(2^8))*t^4 + (2^6 + O(2^8))*t^3 + (O(2^8))*t^2 + (1 + 2^6 + O(2^8))*t + (O(2^8))
+            (2^7 + O(2^8))*t^5 + (2^6 + O(2^8))*t^3 + (1 + 2^6 + O(2^8))*t
```
which seems to be a doctest failure.



---

archive/issue_comments_085404.json:
```json
{
    "body": "<div id=\"comment:126\" align=\"right\">comment:126</div>\n\nI also don't agree with all changes of\n\n```\nif condition:\n    return A\nelse:\n    return B\n```\nto\n\n```\nif condition:\n    return A\nreturn B\n```\nbut I guess that's one of your pet peeves.\n\nI personally prefer\n\n```\nif condition:\n    return A\nelse:\n    return B\n```\nif there are clearly two cases and the code might as well have been written as\n\n```\nif not condition:\n    return B\nelse:\n    return A\n```\n\nSo I personally would keep the `if/else` structure for the `if n % 2 == 0` test. And for the `n >= 0` test, I would say that\n\n```\nif n < 0:\n    return B\nreturn A\n```\nwould be a lot better that what you did:\n\n```\nif n >= 0:\n    return A\nreturn B\n```\nThe first feels much better to me because you put the normal case outside the `if` block and the special cases `if n == 0` and `if n < 0` would be inside `if`s.\n\n(Of course these are all personal preferences, I'm not asking you to change this, maybe just think about it.)",
    "created_at": "2013-12-16T09:44:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85404",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:126" align="right">comment:126</div>

I also don't agree with all changes of

```
if condition:
    return A
else:
    return B
```
to

```
if condition:
    return A
return B
```
but I guess that's one of your pet peeves.

I personally prefer

```
if condition:
    return A
else:
    return B
```
if there are clearly two cases and the code might as well have been written as

```
if not condition:
    return B
else:
    return A
```

So I personally would keep the `if/else` structure for the `if n % 2 == 0` test. And for the `n >= 0` test, I would say that

```
if n < 0:
    return B
return A
```
would be a lot better that what you did:

```
if n >= 0:
    return A
return B
```
The first feels much better to me because you put the normal case outside the `if` block and the special cases `if n == 0` and `if n < 0` would be inside `if`s.

(Of course these are all personal preferences, I'm not asking you to change this, maybe just think about it.)



---

archive/issue_events_124339.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-16T11:01:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124339"
}
```



---

archive/issue_events_124340.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-16T11:01:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124340"
}
```



---

archive/issue_comments_085405.json:
```json
{
    "body": "Attachment: **[trac_9706-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)**",
    "created_at": "2013-12-16T15:07:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85405",
    "user": "https://github.com/tscrim"
}
```

Attachment: **[trac_9706-review-ts.patch.gz](https://github.com/sagemath/sage/files/ticket9706/trac_9706-review-ts.patch.gz)**



---

archive/issue_comments_085406.json:
```json
{
    "body": "<div id=\"comment:128\" align=\"right\">comment:128</div>\n\nI had missed the #15422 dependency. Fixed.\n\nAs for the `if/else`, I've seen (sometimes long) `else` blocks that constitute the normal cases and I try to be uniform about it. Plus with the extra indents, I sometimes have difficulties knowing what the correct indent level should be (although not in this case). I do agree that the cases should be swapped -- I had only removed the `else:`. I added back in the `else` blocks for the `if n % 2 == 0`.",
    "created_at": "2013-12-16T15:15:04Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85406",
    "user": "https://github.com/tscrim"
}
```

<div id="comment:128" align="right">comment:128</div>

I had missed the #15422 dependency. Fixed.

As for the `if/else`, I've seen (sometimes long) `else` blocks that constitute the normal cases and I try to be uniform about it. Plus with the extra indents, I sometimes have difficulties knowing what the correct indent level should be (although not in this case). I do agree that the cases should be swapped -- I had only removed the `else:`. I added back in the `else` blocks for the `if n % 2 == 0`.



---

archive/issue_events_124341.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-12-16T15:15:04Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20info",
    "label_color": "ffff00",
    "label_name": "needs info",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124341"
}
```



---

archive/issue_events_124342.json:
```json
{
    "actor": "https://github.com/tscrim",
    "created_at": "2013-12-16T15:15:04Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124342"
}
```



---

archive/issue_events_124343.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-16T15:46:38Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124343"
}
```



---

archive/issue_events_124344.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-12-16T15:46:38Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124344"
}
```



---

archive/issue_comments_085407.json:
```json
{
    "body": "<div id=\"comment:130\" align=\"right\">comment:130</div>\n\nFirst stage done. Next step: Legendre Polys.\n\nI will keep up the new design + incorporate more doc tests next time. I guess it is important to look at the algebraic aspects too concerning doc tests.\n\nThank all reviewers for their hard work and the good input!",
    "created_at": "2013-12-17T12:01:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85407",
    "user": "https://github.com/sagetrac-maldun"
}
```

<div id="comment:130" align="right">comment:130</div>

First stage done. Next step: Legendre Polys.

I will keep up the new design + incorporate more doc tests next time. I guess it is important to look at the algebraic aspects too concerning doc tests.

Thank all reviewers for their hard work and the good input!



---

archive/issue_comments_085408.json:
```json
{
    "body": "<div id=\"comment:131\"></div>\n\nNew commits:\n<table><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/bb227b6\"><code>bb227b6</code></a></td><td><code>#9706: review patch.</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/51fcd6b\"><code>51fcd6b</code></a></td><td><code>trac 9706: Propose new class structure</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/4677a15\"><code>4677a15</code></a></td><td><code>Symbolic Chebyshev polynomials: reviewer patch</code></td></tr><tr><td><a href=\"https://github.com/sagemath/sagetrac-mirror/commit/75d1e43\"><code>75d1e43</code></a></td><td><code>trac 9706: Collective patch. Bugfixes, extensions, optimizations, documentation, doctests for chebyshev_T, chebyshev_U and base class for ortho polys</code></td></tr></table>\n",
    "created_at": "2013-12-21T14:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85408",
    "user": "https://github.com/vbraun"
}
```

<div id="comment:131"></div>

New commits:
<table><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/bb227b6"><code>bb227b6</code></a></td><td><code>#9706: review patch.</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/51fcd6b"><code>51fcd6b</code></a></td><td><code>trac 9706: Propose new class structure</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/4677a15"><code>4677a15</code></a></td><td><code>Symbolic Chebyshev polynomials: reviewer patch</code></td></tr><tr><td><a href="https://github.com/sagemath/sagetrac-mirror/commit/75d1e43"><code>75d1e43</code></a></td><td><code>trac 9706: Collective patch. Bugfixes, extensions, optimizations, documentation, doctests for chebyshev_T, chebyshev_U and base class for ortho polys</code></td></tr></table>




---

archive/issue_comments_085409.json:
```json
{
    "body": "Commit: **[`bb227b6`](https://github.com/sagemath/sagetrac-mirror/commit/bb227b60e93b7d8806b32b00874351b9201123cd)**",
    "created_at": "2013-12-21T14:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85409",
    "user": "https://github.com/vbraun"
}
```

Commit: **[`bb227b6`](https://github.com/sagemath/sagetrac-mirror/commit/bb227b60e93b7d8806b32b00874351b9201123cd)**



---

archive/issue_comments_085410.json:
```json
{
    "body": "Branch: **[u/vbraun/chebyshev](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/chebyshev)**",
    "created_at": "2013-12-21T14:30:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9706#issuecomment-85410",
    "user": "https://github.com/vbraun"
}
```

Branch: **[u/vbraun/chebyshev](https://github.com/sagemath/sagetrac-mirror/tree/u/vbraun/chebyshev)**



---

archive/issue_events_124345.json:
```json
{
    "actor": "https://github.com/vbraun",
    "created_at": "2013-12-21T18:43:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124345"
}
```



---

archive/issue_events_124346.json:
```json
{
    "actor": "https://github.com/vbraun",
    "commit_id": "1eeabc8ccf02aa07e857a3bc09735d4398de77a6",
    "commit_repository": "https://github.com/sagemath/sage",
    "created_at": "2013-12-21T18:43:54Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9706",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9706#event-124346"
}
```
