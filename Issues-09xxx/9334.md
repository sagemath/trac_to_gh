# Issue 9334: Implement Hilbert symbols over number fields

archive/issues_009334.json:
```json
{
    "assignees": [],
    "body": "PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.\n\nApply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: 9334_review_jdemeyer.patch](https://github.com/sagemath/sage/files/ticket9334/9334_review_jdemeyer.patch.gz).\n\nDepends on #11304\nDepends on #11540\nDepends on #11130\n\nAssignee: **@loefflerd**\n\nCC:  @mstreng @jdemeyer\n\nKeywords: **hilbert symbol**\n\nAuthor: **Aly Deines, Marco Streng, Jeroen Demeyer**\n\nReviewer: **David Loeffler, John Cremona, Marco Streng, Jeroen Demeyer**\n\nUpstream: **Fixed upstream, in a later stable release.**\n\nMerged: **sage-4.8.alpha1**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9334_\n\n",
    "closed_at": "2011-11-07T10:11:32Z",
    "created_at": "2010-06-25T03:51:53Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
        "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
        "https://github.com/sagemath/sage/labels/enhancement"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.8",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Implement Hilbert symbols over number fields",
    "type": "issue",
    "updated_at": "2011-11-07T10:11:32Z",
    "url": "https://github.com/sagemath/sage/issues/9334",
    "user": "https://github.com/adeines"
}
```
PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.

Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: 9334_review_jdemeyer.patch](https://github.com/sagemath/sage/files/ticket9334/9334_review_jdemeyer.patch.gz).

Depends on #11304
Depends on #11540
Depends on #11130

Assignee: **@loefflerd**

CC:  @mstreng @jdemeyer

Keywords: **hilbert symbol**

Author: **Aly Deines, Marco Streng, Jeroen Demeyer**

Reviewer: **David Loeffler, John Cremona, Marco Streng, Jeroen Demeyer**

Upstream: **Fixed upstream, in a later stable release.**

Merged: **sage-4.8.alpha1**

_Issue created by migration from https://trac.sagemath.org/ticket/9334_





---

archive/issue_events_108868.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-25T03:51:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/component%3A%20number%20fields",
    "label_color": "0000ff",
    "label_name": "component: number fields",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108868"
}
```



---

archive/issue_events_108869.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-25T03:51:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108869"
}
```



---

archive/issue_events_108870.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-25T03:51:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/enhancement",
    "label_color": "696969",
    "label_name": "enhancement",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108870"
}
```



---

archive/issue_events_108871.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-25T03:51:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108871"
}
```



---

archive/issue_comments_080786.json:
```json
{
    "body": "<div id=\"comment:1\" align=\"right\">Comment 1</div>\n\nHere all the functions are better placed.  I still need to fix the code so that generalized_hilbert_symbol(a,b,P) doesn't assume a.valuation(P) and b.valuation(P) are 0 or 1.",
    "created_at": "2010-06-25T06:50:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80786",
    "user": "https://github.com/adeines"
}
```

<div id="comment:1" align="right">Comment 1</div>

Here all the functions are better placed.  I still need to fix the code so that generalized_hilbert_symbol(a,b,P) doesn't assume a.valuation(P) and b.valuation(P) are 0 or 1.



---

archive/issue_events_108872.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-25T06:50:05Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108872"
}
```



---

archive/issue_comments_080787.json:
```json
{
    "body": "<div id=\"comment:2\" align=\"right\">Comment 2</div>\n\nI changed the code as Tim (correctly) suggested so as it doesn't assume reduced input.",
    "created_at": "2010-06-25T07:05:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80787",
    "user": "https://github.com/adeines"
}
```

<div id="comment:2" align="right">Comment 2</div>

I changed the code as Tim (correctly) suggested so as it doesn't assume reduced input.



---

archive/issue_events_108873.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-25T07:05:39Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108873"
}
```



---

archive/issue_events_108874.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-06-25T07:05:39Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108874"
}
```



---

archive/issue_comments_080788.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">Comment 3</div>\n\nThis has better uniformizer code.",
    "created_at": "2010-06-27T21:08:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80788",
    "user": "https://github.com/adeines"
}
```

<div id="comment:3" align="right">Comment 3</div>

This has better uniformizer code.



---

archive/issue_events_108875.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-06-28T18:01:50Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108875"
}
```



---

archive/issue_events_108876.json:
```json
{
    "actor": "https://github.com/loefflerd",
    "created_at": "2010-06-28T18:01:50Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108876"
}
```



---

archive/issue_comments_080789.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">Comment 4</div>\n\nThis doesn't seem to apply to 4.4.4. Does it require some other patch as a prerequisite? Also, the docstrings don't seem to be correctly ReST formatted (you should always run `sage -docbuild reference html` and check that there are no warnings before submitting a patch).",
    "created_at": "2010-06-28T18:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80789",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:4" align="right">Comment 4</div>

This doesn't seem to apply to 4.4.4. Does it require some other patch as a prerequisite? Also, the docstrings don't seem to be correctly ReST formatted (you should always run `sage -docbuild reference html` and check that there are no warnings before submitting a patch).



---

archive/issue_comments_080790.json:
```json
{
    "body": "Work Issues: **patch does not apply**",
    "created_at": "2010-06-28T18:01:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80790",
    "user": "https://github.com/loefflerd"
}
```

Work Issues: **patch does not apply**



---

archive/issue_comments_080791.json:
```json
{
    "body": "Changed work issues from **patch does not apply** to **ReST formatting issues**",
    "created_at": "2010-06-29T11:13:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80791",
    "user": "https://github.com/loefflerd"
}
```

Changed work issues from **patch does not apply** to **ReST formatting issues**



---

archive/issue_comments_080792.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">Comment 5</div>\n\nI see. So it's supposed to be applied on top of the patches at #9317. That's fine, but you should explain this in your trac upload messages. Don't repost random patches from other tickets on this ticket -- that's just unnecessary duplication, and it's confusing for the release maintainer when s/he has to merge stuff later.\n\nAnyway: with the #9317 patches in place these four patches apply fine, and all doctests pass. But they're quite hard to review, since you seem to have added code in one place in the first patch and then removed it and added it again somewhere else in the second. Could I suggest that you use the Mercurial \"qfold\" command to combine the four patches into one single patch? That would make the reviewer's job vastly easier. And don't forget those docstring formatting problems; the two that stand out most at a quick glance are that the LaTeX formulae should be in backticks not dollar signs (<code>\\`x^2 + 2\\`</code> etc), and the LaTeX fraction command is `\\frac` not `\\frak`.",
    "created_at": "2010-06-29T11:13:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80792",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:5" align="right">Comment 5</div>

I see. So it's supposed to be applied on top of the patches at #9317. That's fine, but you should explain this in your trac upload messages. Don't repost random patches from other tickets on this ticket -- that's just unnecessary duplication, and it's confusing for the release maintainer when s/he has to merge stuff later.

Anyway: with the #9317 patches in place these four patches apply fine, and all doctests pass. But they're quite hard to review, since you seem to have added code in one place in the first patch and then removed it and added it again somewhere else in the second. Could I suggest that you use the Mercurial "qfold" command to combine the four patches into one single patch? That would make the reviewer's job vastly easier. And don't forget those docstring formatting problems; the two that stand out most at a quick glance are that the LaTeX formulae should be in backticks not dollar signs (<code>\`x^2 + 2\`</code> etc), and the LaTeX fraction command is `\frac` not `\frak`.



---

archive/issue_comments_080793.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">Comment 6</div>\n\nHere is one single patch.  It does not depend on ticket #9317. This should have all the documentation fixed.  Thank you for your patience, I've learned a lot about Mercurial and ReST formatting recently.  \n\nI also applied this on a clean clone of 4.4.2 to check that it would build, all the doctest pass, and the -docbuild looks correct.",
    "created_at": "2010-06-29T22:11:57Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80793",
    "user": "https://github.com/adeines"
}
```

<div id="comment:6" align="right">Comment 6</div>

Here is one single patch.  It does not depend on ticket #9317. This should have all the documentation fixed.  Thank you for your patience, I've learned a lot about Mercurial and ReST formatting recently.  

I also applied this on a clean clone of 4.4.2 to check that it would build, all the doctest pass, and the -docbuild looks correct.



---

archive/issue_comments_080794.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">Comment 7</div>\n\nMost of this looks fine, and the docstring formatting is much better; but there are some technical issues.\n\n- The code in ` solver_mod_p ` is obviously wrong for n > 1: it calculates the inverse modulo P<sup>n</sup> but then takes the square root of this modulo P. You need some kind of Hensel lifting or suchlike to get an answer that's right modulo P<sup>n</sup>.\n\n- The code in ` uniformizer ` is a mess (e.g. it trivially fails for any non-principal ideal in a number field of degree > 2, because you've assumed ` self.integral_basis()` has length 2). But there's already a method ` sage.rings.number_field.number_field.NumberField_generic.uniformizer ` (taking a prime as an argument). I agree that it is worth having uniformizers accessible via a method of ideals as well, but it should just be a thin wrapper around the existing code.",
    "created_at": "2010-06-30T09:59:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80794",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:7" align="right">Comment 7</div>

Most of this looks fine, and the docstring formatting is much better; but there are some technical issues.

- The code in ` solver_mod_p ` is obviously wrong for n > 1: it calculates the inverse modulo P<sup>n</sup> but then takes the square root of this modulo P. You need some kind of Hensel lifting or suchlike to get an answer that's right modulo P<sup>n</sup>.

- The code in ` uniformizer ` is a mess (e.g. it trivially fails for any non-principal ideal in a number field of degree > 2, because you've assumed ` self.integral_basis()` has length 2). But there's already a method ` sage.rings.number_field.number_field.NumberField_generic.uniformizer ` (taking a prime as an argument). I agree that it is worth having uniformizers accessible via a method of ideals as well, but it should just be a thin wrapper around the existing code.



---

archive/issue_comments_080795.json:
```json
{
    "body": "Reviewer: **David Loeffler, John Cremona**",
    "created_at": "2010-07-06T20:06:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80795",
    "user": "https://github.com/JohnCremona"
}
```

Reviewer: **David Loeffler, John Cremona**



---

archive/issue_comments_080796.json:
```json
{
    "body": "Changed work issues from **ReST formatting issues** to **ReST formatting issues, and more**",
    "created_at": "2010-07-06T20:06:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80796",
    "user": "https://github.com/JohnCremona"
}
```

Changed work issues from **ReST formatting issues** to **ReST formatting issues, and more**



---

archive/issue_comments_080797.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">Comment 8</div>\n\nI generally agree with David's points. This code will be very useful for a topic begin done at SD23 (solving conics over various fields) so I am keen to get this in (suitably modified).\n\nIn generalized_legendre_symbol: (1) test P for primality first, before trying to construct its residue field. (2) instead of K(2).valuation(P) just test that n is odd. (3) don't raise run-time errors, make them ValueErrors?. (4) make the return types consistent: you return either +1 in k or -1 as a python int. I would return a Sage integer in either case. (5) you do not test if P divides self. If so, return 0 (as a Sage integer)>\n\nWhy are generalized_hilbert_symbol and _legendre_symbol in sage/rings/arith.py? I would put them both in number_fields -- where you put the even one in fact.\n\nIn generalized_even_hilbert_symbol you define but do not use iprime, so delete it. And do the simple calculation to get the coefficients of jprime**2 so you don't need to construct the quaternion algebra. (You can leave in a comment about that).\n\n_voight_alg_6_2 has some ^ symbols which should be **. Check for others.\n\nDo what David said about uniformizer -- just call the existing function.\n\nSort out the solve function.",
    "created_at": "2010-07-06T20:06:25Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80797",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:8" align="right">Comment 8</div>

I generally agree with David's points. This code will be very useful for a topic begin done at SD23 (solving conics over various fields) so I am keen to get this in (suitably modified).

In generalized_legendre_symbol: (1) test P for primality first, before trying to construct its residue field. (2) instead of K(2).valuation(P) just test that n is odd. (3) don't raise run-time errors, make them ValueErrors?. (4) make the return types consistent: you return either +1 in k or -1 as a python int. I would return a Sage integer in either case. (5) you do not test if P divides self. If so, return 0 (as a Sage integer)>

Why are generalized_hilbert_symbol and _legendre_symbol in sage/rings/arith.py? I would put them both in number_fields -- where you put the even one in fact.

In generalized_even_hilbert_symbol you define but do not use iprime, so delete it. And do the simple calculation to get the coefficients of jprime**2 so you don't need to construct the quaternion algebra. (You can leave in a comment about that).

_voight_alg_6_2 has some ^ symbols which should be **. Check for others.

Do what David said about uniformizer -- just call the existing function.

Sort out the solve function.



---

archive/issue_events_108877.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-07-06T20:06:25Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108877"
}
```



---

archive/issue_events_108878.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-07-06T20:06:25Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/wishlist%20item",
    "label_color": "e81ff9",
    "label_name": "wishlist item",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108878"
}
```



---

archive/issue_comments_080798.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">Comment 9</div>\n\nGreat, I could use this.\n\nWhile you are still at it, I have a small wish list as well. Could you\n\n* Let the generalized even Hilbert symbol accept fractions (as the odd one and the QQ one do)?\n\n   ```\n   sage: hilbert_symbol(1/3, 1, 2)\n   1\n   sage: K.<i> = QuadraticField(-1)\n   sage: O = K.maximal_order()\n   sage: generalized_hilbert_symbol(K(1/2), K(1), 3*O)\n   1\n   sage: generalized_hilbert_symbol(K(1/3), K(1), (1+i)*O)\n   NotImplementedError: inverse_mod is not implemented for non-integral elements\n  ```\n\n* Also add the Hilbert symbol for infinite places? See e.g.\n\n   ```\n   sage: hilbert_symbol(-1, -1, -1)\n   -1\n  ```\n  This is almost trivial compared to what you've already done. I have code, contact me if you have questions.\n\n* Correct the doc text. The doc of generalized_even_hilbert_symbol should say that P must divide 2, while generalized_hilbert_symbol should not say that P must be odd",
    "created_at": "2010-07-12T12:07:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80798",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:9" align="right">Comment 9</div>

Great, I could use this.

While you are still at it, I have a small wish list as well. Could you

* Let the generalized even Hilbert symbol accept fractions (as the odd one and the QQ one do)?

   ```
   sage: hilbert_symbol(1/3, 1, 2)
   1
   sage: K.<i> = QuadraticField(-1)
   sage: O = K.maximal_order()
   sage: generalized_hilbert_symbol(K(1/2), K(1), 3*O)
   1
   sage: generalized_hilbert_symbol(K(1/3), K(1), (1+i)*O)
   NotImplementedError: inverse_mod is not implemented for non-integral elements
  ```

* Also add the Hilbert symbol for infinite places? See e.g.

   ```
   sage: hilbert_symbol(-1, -1, -1)
   -1
  ```
  This is almost trivial compared to what you've already done. I have code, contact me if you have questions.

* Correct the doc text. The doc of generalized_even_hilbert_symbol should say that P must divide 2, while generalized_hilbert_symbol should not say that P must be odd



---

archive/issue_comments_080799.json:
```json
{
    "body": "<div id=\"comment:10\" align=\"right\">Comment 10</div>\n\nIn addition to the first part of my precious comment: generalized_even_hilbert_symbol should accept a and b to both be divisible by p.\n\n```\nsage: hilbert_symbol(2,2,2)\n1\nsage: K.<i>=QuadraticField(-1)\nsage: O=K.maximal_order()\nsage: generalized_hilbert_symbol(3,3,3*O)\n1\nsage: generalized_hilbert_symbol(2,2,2*O)\nValueError: P must be a prime\n```",
    "created_at": "2010-07-12T12:16:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80799",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:10" align="right">Comment 10</div>

In addition to the first part of my precious comment: generalized_even_hilbert_symbol should accept a and b to both be divisible by p.

```
sage: hilbert_symbol(2,2,2)
1
sage: K.<i>=QuadraticField(-1)
sage: O=K.maximal_order()
sage: generalized_hilbert_symbol(3,3,3*O)
1
sage: generalized_hilbert_symbol(2,2,2*O)
ValueError: P must be a prime
```



---

archive/issue_comments_080800.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">Comment 11</div>\n\nOops, the last two lines of my previous comment should of course read\n\n```\nsage: p = 1+i\nsage: generalized_hilbert_symbol(p,p,p*O)\nRuntimeError: ord_P(a) or ord_P(b) must be zero\n```",
    "created_at": "2010-07-12T12:17:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80800",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:11" align="right">Comment 11</div>

Oops, the last two lines of my previous comment should of course read

```
sage: p = 1+i
sage: generalized_hilbert_symbol(p,p,p*O)
RuntimeError: ord_P(a) or ord_P(b) must be zero
```



---

archive/issue_events_108879.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2010-07-12T14:08:48Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/p4%20%E2%80%93%20minor",
    "label_color": "ffe799",
    "label_name": "p4 \u2013 minor",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108879"
}
```



---

archive/issue_events_108880.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2010-07-12T14:08:48Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/p3%20%E2%80%93%20major",
    "label_color": "ffbb00",
    "label_name": "p3 \u2013 major",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108880"
}
```



---

archive/issue_comments_080801.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,2 @@\n-hilbert symbol over number fields\n+Hilbert symbol over number fields may be implemented using an algorithm described in John Voigt's paper \"Identifying the Matrix Ring: Algorithms for Quaternion Algebras and Quadratic Forms\".\n+\n``````\n",
    "created_at": "2010-08-11T20:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80801",
    "user": "https://github.com/JohnCremona"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,2 @@
-hilbert symbol over number fields
+Hilbert symbol over number fields may be implemented using an algorithm described in John Voigt's paper "Identifying the Matrix Ring: Algorithms for Quaternion Algebras and Quadratic Forms".
+
``````




---

archive/issue_comments_080802.json:
```json
{
    "body": "<div id=\"comment:13\" align=\"right\">Comment 13</div>\n\nAlyson, are you intending to fix the various points raised by reviewers here?  If not, someone else should.  Ticket #9320 is waiting on this one.",
    "created_at": "2010-08-11T20:48:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80802",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:13" align="right">Comment 13</div>

Alyson, are you intending to fix the various points raised by reviewers here?  If not, someone else should.  Ticket #9320 is waiting on this one.



---

archive/issue_events_108881.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2010-08-11T20:48:07Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "title_is": "Implement Hilbert symbols over number fields",
    "title_was": "hilbert symbols!!!",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108881"
}
```



---

archive/issue_comments_080803.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">Comment 14</div>\n\nHere are the changes I've made so far: \n1. in generalized_legendred_symbol I test for primality first\n2. instead of K(2).valuation(P) I just test that n is odd\n3. I've changed RunTime Errors to ValueErrors\n4. I return +/- 1 as sage integers\n5. I test if P|self and if so return 0 (as a sage integer)\n6. in generalized_hilbert_symbol I deleted iprime\n7. I did the calculation and have hard coded jprime^2\n8. I've replace ^ with ** where necessary in _voight_alg_6_2\n9. Things should work for fractions\n10. generalized_hilbert_symbol should also accept a,b, divisible by p\n\nOne question I have, does anyone know about hensel lifting in sage?",
    "created_at": "2010-08-11T22:18:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80803",
    "user": "https://github.com/adeines"
}
```

<div id="comment:14" align="right">Comment 14</div>

Here are the changes I've made so far: 
1. in generalized_legendred_symbol I test for primality first
2. instead of K(2).valuation(P) I just test that n is odd
3. I've changed RunTime Errors to ValueErrors
4. I return +/- 1 as sage integers
5. I test if P|self and if so return 0 (as a sage integer)
6. in generalized_hilbert_symbol I deleted iprime
7. I did the calculation and have hard coded jprime^2
8. I've replace ^ with ** where necessary in _voight_alg_6_2
9. Things should work for fractions
10. generalized_hilbert_symbol should also accept a,b, divisible by p

One question I have, does anyone know about hensel lifting in sage?



---

archive/issue_comments_080804.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">Comment 15</div>\n\nExcellent -- should it be \"needs review\" again then?\n\nThere must be places in Sage where Hensel lifting is done, but I do not know of any general framework for it.  You could try asking David Roe, who (I think) wrote a lot of the p-adic code.",
    "created_at": "2010-08-12T09:13:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80804",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:15" align="right">Comment 15</div>

Excellent -- should it be "needs review" again then?

There must be places in Sage where Hensel lifting is done, but I do not know of any general framework for it.  You could try asking David Roe, who (I think) wrote a lot of the p-adic code.



---

archive/issue_comments_080805.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">Comment 16</div>\n\nNo, it shouldn't be \"needs review\" yet.  I still need to fix solver_mod_p.",
    "created_at": "2010-08-12T17:56:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80805",
    "user": "https://github.com/adeines"
}
```

<div id="comment:16" align="right">Comment 16</div>

No, it shouldn't be "needs review" yet.  I still need to fix solver_mod_p.



---

archive/issue_comments_080806.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">Comment 17</div>\n\nI have fixed solver_mod so that it computes the square root mod P^n.",
    "created_at": "2010-08-19T18:20:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80806",
    "user": "https://github.com/adeines"
}
```

<div id="comment:17" align="right">Comment 17</div>

I have fixed solver_mod so that it computes the square root mod P^n.



---

archive/issue_events_108882.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-08-19T18:20:54Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108882"
}
```



---

archive/issue_events_108883.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-08-19T18:20:54Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108883"
}
```



---

archive/issue_comments_080807.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">Comment 18</div>\n\nFixes/added documentation.  Has the examples above in the documentation.",
    "created_at": "2010-08-19T21:04:47Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80807",
    "user": "https://github.com/adeines"
}
```

<div id="comment:18" align="right">Comment 18</div>

Fixes/added documentation.  Has the examples above in the documentation.



---

archive/issue_events_108884.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-08-20T00:36:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108884"
}
```



---

archive/issue_events_108885.json:
```json
{
    "actor": "https://github.com/rlmill",
    "created_at": "2010-08-20T00:36:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108885"
}
```



---

archive/issue_comments_080808.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">Comment 19</div>\n\nBased on 4.5.3.alpha1:\n\n```\nsage -t  sage/rings/number_field/number_field_ideal.py\n**********************************************************************\nFile \"/home/rlmill/sage-4.5.3.alpha1/devel/sage-main/sage/rings/number_field/number_field_ideal.py\", line 1212:\n    sage: P.uniformizer()\nExpected:\n    a + 4\nGot:\n    -2*a + 1\n**********************************************************************\nFile \"/home/rlmill/sage-4.5.3.alpha1/devel/sage-main/sage/rings/number_field/number_field_ideal.py\", line 1219:\n    sage: P.uniformizer()\nExpected:\n    -7*a^4 + 13*a^3 - 13*a^2 - 2*a + 50\nGot:\n    a^4 - a^3 + a^2 - a + 1\n**********************************************************************\n```",
    "created_at": "2010-08-20T00:36:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80808",
    "user": "https://github.com/rlmill"
}
```

<div id="comment:19" align="right">Comment 19</div>

Based on 4.5.3.alpha1:

```
sage -t  sage/rings/number_field/number_field_ideal.py
**********************************************************************
File "/home/rlmill/sage-4.5.3.alpha1/devel/sage-main/sage/rings/number_field/number_field_ideal.py", line 1212:
    sage: P.uniformizer()
Expected:
    a + 4
Got:
    -2*a + 1
**********************************************************************
File "/home/rlmill/sage-4.5.3.alpha1/devel/sage-main/sage/rings/number_field/number_field_ideal.py", line 1219:
    sage: P.uniformizer()
Expected:
    -7*a^4 + 13*a^3 - 13*a^2 - 2*a + 50
Got:
    a^4 - a^3 + a^2 - a + 1
**********************************************************************
```



---

archive/issue_comments_080809.json:
```json
{
    "body": "Fixes some documentation.",
    "created_at": "2010-08-20T01:19:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80809",
    "user": "https://github.com/adeines"
}
```

Fixes some documentation.



---

archive/issue_events_108886.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-08-20T01:20:53Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108886"
}
```



---

archive/issue_events_108887.json:
```json
{
    "actor": "https://github.com/adeines",
    "created_at": "2010-08-20T01:20:53Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108887"
}
```



---

archive/issue_comments_080810.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">Comment 20</div>\n\nAttachment: **[trac_9334-hilbert.patch.gz](https://github.com/sagemath/sage/files/ticket9334/trac_9334-hilbert.patch.gz)**\n\nOk, I checked at P.uniformizer() is just wrapping K.uniformizer(P).  So assuming K.uniformizer(P) is correct (which it appears to be), I've fixed the documentation for P.uniformizer().",
    "created_at": "2010-08-20T01:20:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80810",
    "user": "https://github.com/adeines"
}
```

<div id="comment:20" align="right">Comment 20</div>

Attachment: **[trac_9334-hilbert.patch.gz](https://github.com/sagemath/sage/files/ticket9334/trac_9334-hilbert.patch.gz)**

Ok, I checked at P.uniformizer() is just wrapping K.uniformizer(P).  So assuming K.uniformizer(P) is correct (which it appears to be), I've fixed the documentation for P.uniformizer().



---

archive/issue_events_108888.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2010-08-20T12:30:08Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108888"
}
```



---

archive/issue_events_108889.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2010-08-20T12:30:08Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108889"
}
```



---

archive/issue_comments_080811.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">Comment 21</div>\n\nHere are some comments have already been mentioned above:\n* why aren't generalized_hilbert_symbol and generalized_even_hilbert_symbol in the same file? (e.g. both in number_field as John suggested)\n* the documentation of generalized_hilbert_symbol says that the prime should be odd, which isn't necessary, in fact, it would be good to have an even example in the doctest so this functionality doesn't get broken\n* the documentation of generalized_even_hilbert_symbol doesn't say that the prime must be even, which it should!\n\nAlso, generalized_even_hilbert_symbol is less powerful than the general one:\n\n```\nsage: K.<i> = QuadraticField(-1)                            \nsage: O = K.maximal_order()\nsage: generalized_hilbert_symbol(K(1/3), K(1), (1+i)*O)     \n1\nsage: generalized_even_hilbert_symbol(K(1/3), K(1), (1+i)*O)\n...\nNotImplementedError: inverse_mod is not implemented for non-integral elements\n```\nSo I guess the documentation of generalized_even_hilbert_symbol should say that the input should consist of integral elements? Possibly the documentation of generalized_even_hilbert_symbol could say that this is simply an auxiliary function and the user should call generalized_hilbert_symbol instead?\n\nneeds_work because of the documentation issues for generalized_even_hilbert_symbol",
    "created_at": "2010-08-20T12:30:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80811",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:21" align="right">Comment 21</div>

Here are some comments have already been mentioned above:
* why aren't generalized_hilbert_symbol and generalized_even_hilbert_symbol in the same file? (e.g. both in number_field as John suggested)
* the documentation of generalized_hilbert_symbol says that the prime should be odd, which isn't necessary, in fact, it would be good to have an even example in the doctest so this functionality doesn't get broken
* the documentation of generalized_even_hilbert_symbol doesn't say that the prime must be even, which it should!

Also, generalized_even_hilbert_symbol is less powerful than the general one:

```
sage: K.<i> = QuadraticField(-1)                            
sage: O = K.maximal_order()
sage: generalized_hilbert_symbol(K(1/3), K(1), (1+i)*O)     
1
sage: generalized_even_hilbert_symbol(K(1/3), K(1), (1+i)*O)
...
NotImplementedError: inverse_mod is not implemented for non-integral elements
```
So I guess the documentation of generalized_even_hilbert_symbol should say that the input should consist of integral elements? Possibly the documentation of generalized_even_hilbert_symbol could say that this is simply an auxiliary function and the user should call generalized_hilbert_symbol instead?

needs_work because of the documentation issues for generalized_even_hilbert_symbol



---

archive/issue_comments_080812.json:
```json
{
    "body": "Changed reviewer from **David Loeffler, John Cremona** to **David Loeffler, John Cremona, Marco Streng**",
    "created_at": "2010-08-20T13:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80812",
    "user": "https://github.com/mstreng"
}
```

Changed reviewer from **David Loeffler, John Cremona** to **David Loeffler, John Cremona, Marco Streng**



---

archive/issue_comments_080813.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">Comment 22</div>\n\nhere's a non-documentation reason for `needs_work`:\n\n```\nsage: K.<i> = QuadraticField(-1)                           \nsage: O = K.maximal_order()\nsage: generalized_hilbert_symbol(K(-1/3), K(-2/3), (1+i)*O)\n...\nValueError: self is not a square root mod P^n\n```",
    "created_at": "2010-08-20T13:00:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80813",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:22" align="right">Comment 22</div>

here's a non-documentation reason for `needs_work`:

```
sage: K.<i> = QuadraticField(-1)                           
sage: O = K.maximal_order()
sage: generalized_hilbert_symbol(K(-1/3), K(-2/3), (1+i)*O)
...
ValueError: self is not a square root mod P^n
```



---

archive/issue_comments_080814.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">Comment 23</div>\n\nAnd here's another one. In Magma, I get:\n\n```\n> L := QuadraticField(5);\n> O := MaximalOrder(L);    \n> HilbertSymbol(L!-3, L!-2, 2*O);\n1 1/2 + 1/2*i j\n```\nIn pari, I get:\n\n```\n? k = nfinit(x^2-5)\n...\n? nfhilbert(k, -3, -2, idealprimedec(k, 2)[1])\n%2 = 1\n```\nBut the patch gives:\n\n```\nsage: L.<a> = QuadraticField(5)\nsage: generalized_hilbert_symbol(L(-3), L(-2), 2*O)\n-1\n```\nSomething is wrong...",
    "created_at": "2010-08-20T13:26:13Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80814",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:23" align="right">Comment 23</div>

And here's another one. In Magma, I get:

```
> L := QuadraticField(5);
> O := MaximalOrder(L);    
> HilbertSymbol(L!-3, L!-2, 2*O);
1 1/2 + 1/2*i j
```
In pari, I get:

```
? k = nfinit(x^2-5)
...
? nfhilbert(k, -3, -2, idealprimedec(k, 2)[1])
%2 = 1
```
But the patch gives:

```
sage: L.<a> = QuadraticField(5)
sage: generalized_hilbert_symbol(L(-3), L(-2), 2*O)
-1
```
Something is wrong...



---

archive/issue_comments_080815.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">Comment 24</div>\n\nIn fact, what are the reasons for implementing this independently rather than using pari's function?",
    "created_at": "2010-08-20T14:54:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80815",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:24" align="right">Comment 24</div>

In fact, what are the reasons for implementing this independently rather than using pari's function?



---

archive/issue_comments_080816.json:
```json
{
    "body": "interface to pari's nfhilbert, apply only this file",
    "created_at": "2010-12-08T09:48:00Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80816",
    "user": "https://github.com/mstreng"
}
```

interface to pari's nfhilbert, apply only this file



---

archive/issue_comments_080817.json:
```json
{
    "body": "Changed work issues from **ReST formatting issues, and more** to **bug in Pari 2.4.3**",
    "created_at": "2010-12-08T09:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80817",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **ReST formatting issues, and more** to **bug in Pari 2.4.3**



---

archive/issue_comments_080818.json:
```json
{
    "body": "Changed author from **aly.deines** to **Aly Deines, Marco Streng**",
    "created_at": "2010-12-08T09:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80818",
    "user": "https://github.com/mstreng"
}
```

Changed author from **aly.deines** to **Aly Deines, Marco Streng**



---

archive/issue_comments_080819.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">Comment 25</div>\n\nAttachment: **[trac_9334_nfhilbert.patch.gz](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz)**\n\nAll that needed to be done was wrap pari's nfhilbert function and copy Aly's doctests, but...\n\nOne of those doctests revealed yet another bug introduced by the pari upgrade. See [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1147](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1147)\n\nApply trac_9334_nfhilbert.patch once pari bug 1147 is fixed and that fix reaches Sage.\n\nPossible future improvements:\n\n* implement also for relative number fields by simply delegating to the absolute case\n\n* implement also for QQ by wrapping the global function hilbert_symbol as a member of QQ",
    "created_at": "2010-12-08T09:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80819",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:25" align="right">Comment 25</div>

Attachment: **[trac_9334_nfhilbert.patch.gz](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz)**

All that needed to be done was wrap pari's nfhilbert function and copy Aly's doctests, but...

One of those doctests revealed yet another bug introduced by the pari upgrade. See [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1147](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1147)

Apply trac_9334_nfhilbert.patch once pari bug 1147 is fixed and that fix reaches Sage.

Possible future improvements:

* implement also for relative number fields by simply delegating to the absolute case

* implement also for QQ by wrapping the global function hilbert_symbol as a member of QQ



---

archive/issue_comments_080820.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,2 +1 @@\n-Hilbert symbol over number fields may be implemented using an algorithm described in John Voigt's paper \"Identifying the Matrix Ring: Algorithms for Quaternion Algebras and Quadratic Forms\".\n-\n+Pari has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping pari's function `nfhilbert`.\n``````\n",
    "created_at": "2010-12-08T09:57:51Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80820",
    "user": "https://github.com/mstreng"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,2 +1 @@
-Hilbert symbol over number fields may be implemented using an algorithm described in John Voigt's paper "Identifying the Matrix Ring: Algorithms for Quaternion Algebras and Quadratic Forms".
-
+Pari has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping pari's function `nfhilbert`.
``````




---

archive/issue_comments_080821.json:
```json
{
    "body": "Upstream: **Reported upstream. Little or no feedback.**",
    "created_at": "2010-12-08T11:31:59Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80821",
    "user": "https://github.com/loefflerd"
}
```

Upstream: **Reported upstream. Little or no feedback.**



---

archive/issue_comments_080822.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2011-01-12T02:22:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80822",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_080823.json:
```json
{
    "body": "Changed work issues from **bug in Pari 2.4.3** to **either wait for Pari bug 1147 to be fixed, or finish Aly Deines' independent Sage implementation**",
    "created_at": "2011-02-16T10:19:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80823",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **bug in Pari 2.4.3** to **either wait for Pari bug 1147 to be fixed, or finish Aly Deines' independent Sage implementation**



---

archive/issue_comments_080824.json:
```json
{
    "body": "Changed work issues from **either wait for Pari bug 1147 to be fixed, or finish Aly Deines' independent Sage implementation** to **update pari in sage, and make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)**",
    "created_at": "2011-04-05T14:48:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80824",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **either wait for Pari bug 1147 to be fixed, or finish Aly Deines' independent Sage implementation** to **update pari in sage, and make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)**



---

archive/issue_comments_080825.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2011-04-05T14:48:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80825",
    "user": "https://github.com/mstreng"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_080826.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">Comment 29</div>\n\nThe pari bug resulting in incorrect outputs of nfhilbert was fixed in Pari svn revision 13063 2011-04-05 14:03:38 +0100 (Tue, 05 Apr 2011).\n\nHow do we get this fix into Sage?",
    "created_at": "2011-04-05T14:48:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80826",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:29" align="right">Comment 29</div>

The pari bug resulting in incorrect outputs of nfhilbert was fixed in Pari svn revision 13063 2011-04-05 14:03:38 +0100 (Tue, 05 Apr 2011).

How do we get this fix into Sage?



---

archive/issue_comments_080827.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">Comment 30</div>\n\nReplying to [@mstreng](#comment%3A29):\n> The pari bug resulting in incorrect outputs of nfhilbert was fixed in Pari svn revision 13063 2011-04-05 14:03:38 +0100 (Tue, 05 Apr 2011).\n> \n> How do we get this fix into Sage?\n\nI am currently maintaining the PARI spkg for Sage, so asking me is the best way.",
    "created_at": "2011-04-05T14:55:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80827",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">Comment 30</div>

Replying to [@mstreng](#comment%3A29):
> The pari bug resulting in incorrect outputs of nfhilbert was fixed in Pari svn revision 13063 2011-04-05 14:03:38 +0100 (Tue, 05 Apr 2011).
> 
> How do we get this fix into Sage?

I am currently maintaining the PARI spkg for Sage, so asking me is the best way.



---

archive/issue_comments_080828.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">Comment 31</div>\n\nSee #11130.",
    "created_at": "2011-04-05T15:01:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80828",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:31" align="right">Comment 31</div>

See #11130.



---

archive/issue_comments_080829.json:
```json
{
    "body": "Dependencies: **#11304, #11540, #11130**",
    "created_at": "2011-09-27T09:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80829",
    "user": "https://github.com/jdemeyer"
}
```

Dependencies: **#11304, #11540, #11130**



---

archive/issue_comments_080830.json:
```json
{
    "body": "Changed work issues from **update pari in sage, and make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)** to **make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)**",
    "created_at": "2011-09-27T09:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80830",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **update pari in sage, and make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)** to **make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)**



---

archive/issue_comments_080831.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**",
    "created_at": "2011-09-27T09:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80831",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **Fixed upstream, but not in a stable release.** to **Fixed upstream, in a later stable release.**



---

archive/issue_comments_080832.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1 @@\n-Pari has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping pari's function `nfhilbert`.\n+PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.\n``````\n",
    "created_at": "2011-09-27T09:45:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80832",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1 @@
-Pari has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping pari's function `nfhilbert`.
+PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.
``````




---

archive/issue_comments_080833.json:
```json
{
    "body": "Changed work issues from **make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)** to **correct the doctests**",
    "created_at": "2011-09-27T10:06:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80833",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **make sure all doctests in this patch are correct (or finish Aly Deines' independent implementation)** to **correct the doctests**



---

archive/issue_comments_080834.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">Comment 33</div>\n\napply trac_9334_nfhilbert.patch",
    "created_at": "2011-09-27T10:06:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80834",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:33" align="right">Comment 33</div>

apply trac_9334_nfhilbert.patch



---

archive/issue_comments_080835.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1 +1,3 @@\n PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.\n+\n+Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz)\n``````\n",
    "created_at": "2011-09-27T10:06:40Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80835",
    "user": "https://github.com/mstreng"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1 +1,3 @@
 PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.
+
+Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz)
``````




---

archive/issue_events_108890.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-09-27T10:46:31Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108890"
}
```



---

archive/issue_events_108891.json:
```json
{
    "actor": "https://github.com/JohnCremona",
    "created_at": "2011-09-27T10:46:31Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108891"
}
```



---

archive/issue_comments_080836.json:
```json
{
    "body": "<div id=\"comment:34\" align=\"right\">Comment 34</div>\n\nPatch applies fine to 4.7.2.alpha2 + #11130;  testing now.  Meanwhile, just a small point -- in the docstring it says that P must be a prime ideal of self, but it can also be (1) an element of self which generates a prime ideal, or (2) a real or complex place of self.  This is well illustrated in the examples, but it should also be stated in the INPUT block.\n\nAny chance you could change the docstring while I am doing the testing?",
    "created_at": "2011-09-27T10:46:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80836",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:34" align="right">Comment 34</div>

Patch applies fine to 4.7.2.alpha2 + #11130;  testing now.  Meanwhile, just a small point -- in the docstring it says that P must be a prime ideal of self, but it can also be (1) an element of self which generates a prime ideal, or (2) a real or complex place of self.  This is well illustrated in the examples, but it should also be stated in the INPUT block.

Any chance you could change the docstring while I am doing the testing?



---

archive/issue_events_108892.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-09-27T10:48:06Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108892"
}
```



---

archive/issue_events_108893.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-09-27T10:48:06Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108893"
}
```



---

archive/issue_comments_080837.json:
```json
{
    "body": "<div id=\"comment:35\" align=\"right\">Comment 35</div>\n\nSome doctests disagree with Magma, so I hope they will fail!",
    "created_at": "2011-09-27T10:48:06Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80837",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:35" align="right">Comment 35</div>

Some doctests disagree with Magma, so I hope they will fail!



---

archive/issue_comments_080838.json:
```json
{
    "body": "Changed work issues from **correct the doctests** to **correct the doctests, change the INPUT in the documentation**",
    "created_at": "2011-09-27T10:56:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80838",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **correct the doctests** to **correct the doctests, change the INPUT in the documentation**



---

archive/issue_comments_080839.json:
```json
{
    "body": "<div id=\"comment:36\" align=\"right\">Comment 36</div>\n\nAccording to Magma V2.17-9, the following changes make the doctests correct:\n\nreplace\n\n```\nsage: K.hilbert_symbol(p,p,p*O)  \n-1\n```\nby\n\n```\nsage: K.hilbert_symbol(p,p,p)  \n1\nsage: K.hilbert_symbol(p,3*p,p)\n-1\nsage: K.hilbert_symbol(3,p,p)\n-1\n```\n\nremove duplicate\n\n```\nsage: K.hilbert_symbol(a,b,P)\n-1\n```\nand for the remaining one, replace -1 by 1\n\nreplace -1 by 1 in\n\n```\nsage: K.hilbert_symbol(a, 2, P)  \n-1  \n```\n\nThen the \"various other examples\" contain a lot of uninteresting 1s, of which we can remove a few.",
    "created_at": "2011-09-27T10:56:38Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80839",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:36" align="right">Comment 36</div>

According to Magma V2.17-9, the following changes make the doctests correct:

replace

```
sage: K.hilbert_symbol(p,p,p*O)  
-1
```
by

```
sage: K.hilbert_symbol(p,p,p)  
1
sage: K.hilbert_symbol(p,3*p,p)
-1
sage: K.hilbert_symbol(3,p,p)
-1
```

remove duplicate

```
sage: K.hilbert_symbol(a,b,P)
-1
```
and for the remaining one, replace -1 by 1

replace -1 by 1 in

```
sage: K.hilbert_symbol(a, 2, P)  
-1  
```

Then the "various other examples" contain a lot of uninteresting 1s, of which we can remove a few.



---

archive/issue_comments_080840.json:
```json
{
    "body": "<div id=\"comment:37\" align=\"right\">Comment 37</div>\n\nTesting on 4.7.2.alpha2+#11130 I get these failures:\n\n```\nsage -t -long \"devel/sage-main/sage/rings/number_field/number_field.py\"\n**********************************************************************\nFile \"/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py\", line 6737:\n    sage: K.hilbert_symbol(p,p,p*O)\nExpected:\n    -1\nGot:\n    1\n**********************************************************************\nFile \"/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py\", line 6763:\n    sage: K.hilbert_symbol(a,b,P)\nExpected:\n    -1\nGot:\n    1\n**********************************************************************\nFile \"/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py\", line 6770:\n    sage: K.hilbert_symbol(a, b, P)\nExpected:\n    -1\nGot:\n    1\n**********************************************************************\nFile \"/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py\", line 6772:\n    sage: K.hilbert_symbol(a, 2, P)\nExpected:\n    -1\nGot:\n    1\n**********************************************************************\n```",
    "created_at": "2011-09-27T11:55:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80840",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:37" align="right">Comment 37</div>

Testing on 4.7.2.alpha2+#11130 I get these failures:

```
sage -t -long "devel/sage-main/sage/rings/number_field/number_field.py"
**********************************************************************
File "/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py", line 6737:
    sage: K.hilbert_symbol(p,p,p*O)
Expected:
    -1
Got:
    1
**********************************************************************
File "/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py", line 6763:
    sage: K.hilbert_symbol(a,b,P)
Expected:
    -1
Got:
    1
**********************************************************************
File "/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py", line 6770:
    sage: K.hilbert_symbol(a, b, P)
Expected:
    -1
Got:
    1
**********************************************************************
File "/home/jec/sage-4.7.2.alpha2.11130/devel/sage-main/sage/rings/number_field/number_field.py", line 6772:
    sage: K.hilbert_symbol(a, 2, P)
Expected:
    -1
Got:
    1
**********************************************************************
```



---

archive/issue_comments_080841.json:
```json
{
    "body": "<div id=\"comment:38\" align=\"right\">Comment 38</div>\n\nThis looks bad:\n\n```\nsage: K.<t> = NumberField(x^3 - x + 1)\nsage: K.pari_nf().nfhilbert(t,t+1)\n---------------------------------------------------------------------------\nRuntimeError                              Traceback (most recent call last)\n\n/usr/local/src/sage-4.7.2.alpha2/<ipython console> in <module>()\n\n/usr/local/src/sage-4.7.2.alpha2/local/lib/python2.6/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen.gen.nfhilbert (sage/libs/pari/gen.c:29966)()\n\nRuntimeError: Segmentation fault\n```\n\nI can't immediately figure out the cause, it is probably a bug somewhere in PARI or the Sage-PARI interface,",
    "created_at": "2011-09-27T12:23:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80841",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:38" align="right">Comment 38</div>

This looks bad:

```
sage: K.<t> = NumberField(x^3 - x + 1)
sage: K.pari_nf().nfhilbert(t,t+1)
---------------------------------------------------------------------------
RuntimeError                              Traceback (most recent call last)

/usr/local/src/sage-4.7.2.alpha2/<ipython console> in <module>()

/usr/local/src/sage-4.7.2.alpha2/local/lib/python2.6/site-packages/sage/libs/pari/gen.so in sage.libs.pari.gen.gen.nfhilbert (sage/libs/pari/gen.c:29966)()

RuntimeError: Segmentation fault
```

I can't immediately figure out the cause, it is probably a bug somewhere in PARI or the Sage-PARI interface,



---

archive/issue_comments_080842.json:
```json
{
    "body": "<div id=\"comment:39\" align=\"right\">Comment 39</div>\n\nThe Segmentation Fault is probably #11854.",
    "created_at": "2011-09-27T12:43:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80842",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:39" align="right">Comment 39</div>

The Segmentation Fault is probably #11854.



---

archive/issue_comments_080843.json:
```json
{
    "body": "<div id=\"comment:40\" align=\"right\">Comment 40</div>\n\nReplying to [@jdemeyer](#comment%3A38):\n> This looks bad:\n\nThis is about global Hilbert symbols, while all the doctests are about local ones. Thanks for noticing.\n\nDo you want to close this ticket at the same time as #11130? If not, then I'll wait until I can download a version with #11130 included, and then try to fix the problems here.",
    "created_at": "2011-09-27T15:09:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80843",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:40" align="right">Comment 40</div>

Replying to [@jdemeyer](#comment%3A38):
> This looks bad:

This is about global Hilbert symbols, while all the doctests are about local ones. Thanks for noticing.

Do you want to close this ticket at the same time as #11130? If not, then I'll wait until I can download a version with #11130 included, and then try to fix the problems here.



---

archive/issue_comments_080844.json:
```json
{
    "body": "Changed work issues from **correct the doctests, change the INPUT in the documentation** to **correct the doctests, change the INPUT in the documentation, fix problems with global hilbert symbols, check out seemingly unrelated doctest failures in other files**",
    "created_at": "2011-09-27T15:09:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80844",
    "user": "https://github.com/mstreng"
}
```

Changed work issues from **correct the doctests, change the INPUT in the documentation** to **correct the doctests, change the INPUT in the documentation, fix problems with global hilbert symbols, check out seemingly unrelated doctest failures in other files**



---

archive/issue_comments_080845.json:
```json
{
    "body": "<div id=\"comment:41\" align=\"right\">Comment 41</div>\n\nReplying to [@mstreng](#comment%3A40):\n> Do you want to close this ticket at the same time as #11130?\n\nI don't think there is any reason to do so.  I will leave it up to you to decide what to do.  For now, I will continue investigating the Segmentation Fault issue.",
    "created_at": "2011-09-27T16:32:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80845",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:41" align="right">Comment 41</div>

Replying to [@mstreng](#comment%3A40):
> Do you want to close this ticket at the same time as #11130?

I don't think there is any reason to do so.  I will leave it up to you to decide what to do.  For now, I will continue investigating the Segmentation Fault issue.



---

archive/issue_comments_080846.json:
```json
{
    "body": "<div id=\"comment:42\" align=\"right\">Comment 42</div>\n\nUnfortunately, #11854 does *not* fix the Segmentation Fault.",
    "created_at": "2011-09-28T07:20:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80846",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:42" align="right">Comment 42</div>

Unfortunately, #11854 does *not* fix the Segmentation Fault.



---

archive/issue_comments_080847.json:
```json
{
    "body": "<div id=\"comment:43\" align=\"right\">Comment 43</div>\n\nThe Segmentation Fault actually shows a major design problem with the Sage->PARI interface (essentially, the `t0GEN` system is broken by design).\n\nAs for this ticket, as far as I'm concerned you may ignore this.  It has essentially nothing to do with this ticket and (hopefully) it can only be reproduced by *directly* calling PARI (i.e. doing `K.pari_nf().nfhilbert(t,t+1)` instead of `K.hilbert_symbol(t,t+1)`.)",
    "created_at": "2011-09-28T08:05:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80847",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:43" align="right">Comment 43</div>

The Segmentation Fault actually shows a major design problem with the Sage->PARI interface (essentially, the `t0GEN` system is broken by design).

As for this ticket, as far as I'm concerned you may ignore this.  It has essentially nothing to do with this ticket and (hopefully) it can only be reproduced by *directly* calling PARI (i.e. doing `K.pari_nf().nfhilbert(t,t+1)` instead of `K.hilbert_symbol(t,t+1)`.)



---

archive/issue_comments_080848.json:
```json
{
    "body": "<div id=\"comment:44\" align=\"right\">Comment 44</div>\n\nReplying to [@jdemeyer](#comment%3A43):\n> The Segmentation Fault actually shows a major design problem with the Sage->PARI interface (essentially, the `t0GEN` system is broken by design).\n> \n\nSo there should be a new ticket made which explains this major design problem, so that it is on our todo-list at least.",
    "created_at": "2011-09-28T09:01:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80848",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:44" align="right">Comment 44</div>

Replying to [@jdemeyer](#comment%3A43):
> The Segmentation Fault actually shows a major design problem with the Sage->PARI interface (essentially, the `t0GEN` system is broken by design).
> 

So there should be a new ticket made which explains this major design problem, so that it is on our todo-list at least.



---

archive/issue_comments_080849.json:
```json
{
    "body": "<div id=\"comment:45\" align=\"right\">Comment 45</div>\n\nReplying to [@JohnCremona](#comment%3A44):\n> So there should be a new ticket made which explains this major design problem, so that it is on our todo-list at least.\n\nSee #11868.",
    "created_at": "2011-09-29T08:53:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80849",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:45" align="right">Comment 45</div>

Replying to [@JohnCremona](#comment%3A44):
> So there should be a new ticket made which explains this major design problem, so that it is on our todo-list at least.

See #11868.



---

archive/issue_comments_080850.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.\n \n-Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz)\n+Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz).\n``````\n",
    "created_at": "2011-09-29T09:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80850",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.
 
-Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz)
+Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz).
``````




---

archive/issue_comments_080851.json:
```json
{
    "body": "Changed work issues from **correct the doctests, change the INPUT in the documentation, fix problems with global hilbert symbols, check out seemingly unrelated doctest failures in other files** to **fix problems/add doctests with global hilbert symbols, check out seemingly unrelated doctest failures in other files**",
    "created_at": "2011-09-29T09:42:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80851",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **correct the doctests, change the INPUT in the documentation, fix problems with global hilbert symbols, check out seemingly unrelated doctest failures in other files** to **fix problems/add doctests with global hilbert symbols, check out seemingly unrelated doctest failures in other files**



---

archive/issue_comments_080852.json:
```json
{
    "body": "Changed reviewer from **David Loeffler, John Cremona, Marco Streng** to **David Loeffler, John Cremona, Marco Streng, Jeroen Demeyer**",
    "created_at": "2011-09-29T09:45:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80852",
    "user": "https://github.com/jdemeyer"
}
```

Changed reviewer from **David Loeffler, John Cremona, Marco Streng** to **David Loeffler, John Cremona, Marco Streng, Jeroen Demeyer**



---

archive/issue_comments_080853.json:
```json
{
    "body": "<div id=\"comment:48\" align=\"right\">Comment 48</div>\n\nI presume you didn't mean to apply two copies of the same patch! Is this ready for review again now?",
    "created_at": "2011-09-29T09:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80853",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:48" align="right">Comment 48</div>

I presume you didn't mean to apply two copies of the same patch! Is this ready for review again now?



---

archive/issue_comments_080854.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,3 +1,3 @@\n PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.\n \n-Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz).\n+Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: 9334_review_jdemeyer.patch](https://github.com/sagemath/sage/files/ticket9334/9334_review_jdemeyer.patch.gz).\n``````\n",
    "created_at": "2011-09-29T09:53:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80854",
    "user": "https://github.com/loefflerd"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,3 +1,3 @@
 PARI has Hilbert symbols for number fields. Hilbert symbols can be implemented by wrapping PARI's function `nfhilbert`.
 
-Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz).
+Apply [attachment: trac_9334_nfhilbert.patch](https://github.com/sagemath/sage/files/ticket9334/trac_9334_nfhilbert.patch.gz) and [attachment: 9334_review_jdemeyer.patch](https://github.com/sagemath/sage/files/ticket9334/9334_review_jdemeyer.patch.gz).
``````




---

archive/issue_comments_080855.json:
```json
{
    "body": "<div id=\"comment:49\" align=\"right\">Comment 49</div>\n\nI'm going to make some further changes.",
    "created_at": "2011-09-29T10:03:27Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80855",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:49" align="right">Comment 49</div>

I'm going to make some further changes.



---

archive/issue_comments_080856.json:
```json
{
    "body": "<div id=\"comment:50\" align=\"right\">Comment 50</div>\n\nReplying to [@loefflerd](#comment%3A48):\n> Is this ready for review again now?\n\nThere is still a duplicate example, and a lot of examples that return 1 now that they are corrected. I think we should remove some of these, and add some -1's such as the ones in my comment 2 days ago.\n\nAlso, what is the output type now? In my patch, I converted it to Integer. Jeroen removed that conversion, but what does cdef long give us?\n\nFinally, in my patch, I had self(a), but Jeroen turned this into a. How carefully does Pari check whether stuff is in the right field?",
    "created_at": "2011-09-29T10:12:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80856",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:50" align="right">Comment 50</div>

Replying to [@loefflerd](#comment%3A48):
> Is this ready for review again now?

There is still a duplicate example, and a lot of examples that return 1 now that they are corrected. I think we should remove some of these, and add some -1's such as the ones in my comment 2 days ago.

Also, what is the output type now? In my patch, I converted it to Integer. Jeroen removed that conversion, but what does cdef long give us?

Finally, in my patch, I had self(a), but Jeroen turned this into a. How carefully does Pari check whether stuff is in the right field?



---

archive/issue_comments_080857.json:
```json
{
    "body": "<div id=\"comment:51\" align=\"right\">Comment 51</div>\n\nReplying to [@mstreng](#comment%3A50):\n> Finally, in my patch, I had self(a), but Jeroen turned this into a. How carefully does Pari check whether stuff is in the right field?\n\nWow, even Sage doesn't check this:\n\n```\n----------------------------------------------------------------------\n| Sage Version 4.7.1, Release Date: 2011-08-11                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nsage: K.<a> = NumberField(x^3+x+1)\nsage: L.<b> = NumberField(x^3+2*x+2)\nsage: K(b)\na\n```\nso my `self(a)` was pretty useless and we may want to do this:\n\n```\nif not (a in self and b in self):\n    raise ValueError, ...\n```",
    "created_at": "2011-09-29T10:22:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80857",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:51" align="right">Comment 51</div>

Replying to [@mstreng](#comment%3A50):
> Finally, in my patch, I had self(a), but Jeroen turned this into a. How carefully does Pari check whether stuff is in the right field?

Wow, even Sage doesn't check this:

```
----------------------------------------------------------------------
| Sage Version 4.7.1, Release Date: 2011-08-11                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
sage: K.<a> = NumberField(x^3+x+1)
sage: L.<b> = NumberField(x^3+2*x+2)
sage: K(b)
a
```
so my `self(a)` was pretty useless and we may want to do this:

```
if not (a in self and b in self):
    raise ValueError, ...
```



---

archive/issue_comments_080858.json:
```json
{
    "body": "Attachment: **[9334_review_jdemeyer.patch.gz](https://github.com/sagemath/sage/files/ticket9334/9334_review_jdemeyer.patch.gz)**",
    "created_at": "2011-09-29T10:24:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80858",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[9334_review_jdemeyer.patch.gz](https://github.com/sagemath/sage/files/ticket9334/9334_review_jdemeyer.patch.gz)**



---

archive/issue_comments_080859.json:
```json
{
    "body": "Changed author from **Aly Deines, Marco Streng** to **Aly Deines, Marco Streng, Jeroen Demeyer**",
    "created_at": "2011-09-29T10:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80859",
    "user": "https://github.com/jdemeyer"
}
```

Changed author from **Aly Deines, Marco Streng** to **Aly Deines, Marco Streng, Jeroen Demeyer**



---

archive/issue_comments_080860.json:
```json
{
    "body": "Changed work issues from **fix problems/add doctests with global hilbert symbols, check out seemingly unrelated doctest failures in other files** to **add/remove some doctests**",
    "created_at": "2011-09-29T10:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80860",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **fix problems/add doctests with global hilbert symbols, check out seemingly unrelated doctest failures in other files** to **add/remove some doctests**



---

archive/issue_comments_080861.json:
```json
{
    "body": "<div id=\"comment:52\" align=\"right\">Comment 52</div>\n\nReplying to [@mstreng](#comment%3A50):\n> There is still a duplicate example, and a lot of examples that return 1 now that they are corrected. I think we should remove some of these, and add some -1's such as the ones in my comment 2 days ago.\n\nPlease do it!\n\n> Also, what is the output type now? In my patch, I converted it to Integer. Jeroen removed that conversion, but what does cdef long give us?\n\nIt will be Python `int`.  I see no reason to return a Sage Integer.\n\n> Finally, in my patch, I had self(a), but Jeroen turned this into a. How carefully does Pari check whether stuff is in the right field?\n\nI only *moved* ``a = self(a)`` up in the code.",
    "created_at": "2011-09-29T10:28:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80861",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:52" align="right">Comment 52</div>

Replying to [@mstreng](#comment%3A50):
> There is still a duplicate example, and a lot of examples that return 1 now that they are corrected. I think we should remove some of these, and add some -1's such as the ones in my comment 2 days ago.

Please do it!

> Also, what is the output type now? In my patch, I converted it to Integer. Jeroen removed that conversion, but what does cdef long give us?

It will be Python `int`.  I see no reason to return a Sage Integer.

> Finally, in my patch, I had self(a), but Jeroen turned this into a. How carefully does Pari check whether stuff is in the right field?

I only *moved* ``a = self(a)`` up in the code.



---

archive/issue_comments_080862.json:
```json
{
    "body": "<div id=\"comment:53\" align=\"right\">Comment 53</div>\n\nReplying to [@mstreng](#comment%3A51):\n\n```\n----------------------------------------------------------------------\n| Sage Version 4.7.1, Release Date: 2011-08-11                       |\n| Type notebook() for the GUI, and license() for information.        |\n----------------------------------------------------------------------\nsage: K.<a> = NumberField(x^3+x+1)\nsage: L.<b> = NumberField(x^3+2*x+2)\nsage: K(b)\na\n```\n\nI think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.",
    "created_at": "2011-09-29T10:35:46Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80862",
    "user": "https://github.com/JohnCremona"
}
```

<div id="comment:53" align="right">Comment 53</div>

Replying to [@mstreng](#comment%3A51):

```
----------------------------------------------------------------------
| Sage Version 4.7.1, Release Date: 2011-08-11                       |
| Type notebook() for the GUI, and license() for information.        |
----------------------------------------------------------------------
sage: K.<a> = NumberField(x^3+x+1)
sage: L.<b> = NumberField(x^3+2*x+2)
sage: K(b)
a
```

I think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.



---

archive/issue_comments_080863.json:
```json
{
    "body": "<div id=\"comment:54\" align=\"right\">Comment 54</div>\n\nReplying to [@JohnCremona](#comment%3A53):\n> Replying to [@mstreng](#comment%3A51):\n> \n> ```\n> ----------------------------------------------------------------------\n> | Sage Version 4.7.1, Release Date: 2011-08-11                       |\n> | Type notebook() for the GUI, and license() for information.        |\n> ----------------------------------------------------------------------\n> sage: K.<a> = NumberField(x^3+x+1)\n> sage: L.<b> = NumberField(x^3+2*x+2)\n> sage: K(b)\n> a\n> ```\n> \n> I think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.\n> \n\nI agree -- that's horrible! It's not so generic actually: the offending code is the  method `NumberField_absolute._coerce_from_other_number_field` which just converts to a polynomial and back: \n\n```\nf = self.polynomial_ring()(x.polynomial())\nreturn self._element_class(self, f)\n```\n\nThis is mathematically meaningless unless either the other field is isomorphic to self, or x is actually in Q. I suggest we raise this on sage-nt, and maybe open a ticket to fix it ASAP.",
    "created_at": "2011-09-29T10:39:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80863",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:54" align="right">Comment 54</div>

Replying to [@JohnCremona](#comment%3A53):
> Replying to [@mstreng](#comment%3A51):
> 
> ```
> ----------------------------------------------------------------------
> | Sage Version 4.7.1, Release Date: 2011-08-11                       |
> | Type notebook() for the GUI, and license() for information.        |
> ----------------------------------------------------------------------
> sage: K.<a> = NumberField(x^3+x+1)
> sage: L.<b> = NumberField(x^3+2*x+2)
> sage: K(b)
> a
> ```
> 
> I think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.
> 

I agree -- that's horrible! It's not so generic actually: the offending code is the  method `NumberField_absolute._coerce_from_other_number_field` which just converts to a polynomial and back: 

```
f = self.polynomial_ring()(x.polynomial())
return self._element_class(self, f)
```

This is mathematically meaningless unless either the other field is isomorphic to self, or x is actually in Q. I suggest we raise this on sage-nt, and maybe open a ticket to fix it ASAP.



---

archive/issue_comments_080864.json:
```json
{
    "body": "<div id=\"comment:55\" align=\"right\">Comment 55</div>\n\nReplying to [@jdemeyer](#comment%3A52):\n> It will be Python `int`.  I see no reason to return a Sage Integer.\n\nPython ints are fine with me, I was afraid it would be a pari object. I would have liked some uniformity, but that's missing already.\n\n```\nsage: type(legendre_symbol(3,5))\n<type 'int'>\nsage: type(hilbert_symbol(3,5,7))\n<type 'sage.rings.integer.Integer'>\nsage: type(jacobi_symbol(3,5))\n<type 'sage.rings.integer.Integer'>\n```\nI want all symbols to behave nicely with division by Sage integers, but that's fine with `int`\n\n```\nsage: int(1)/ZZ(2)\n1/2\n```",
    "created_at": "2011-09-29T10:46:26Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80864",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:55" align="right">Comment 55</div>

Replying to [@jdemeyer](#comment%3A52):
> It will be Python `int`.  I see no reason to return a Sage Integer.

Python ints are fine with me, I was afraid it would be a pari object. I would have liked some uniformity, but that's missing already.

```
sage: type(legendre_symbol(3,5))
<type 'int'>
sage: type(hilbert_symbol(3,5,7))
<type 'sage.rings.integer.Integer'>
sage: type(jacobi_symbol(3,5))
<type 'sage.rings.integer.Integer'>
```
I want all symbols to behave nicely with division by Sage integers, but that's fine with `int`

```
sage: int(1)/ZZ(2)
1/2
```



---

archive/issue_comments_080865.json:
```json
{
    "body": "<div id=\"comment:56\" align=\"right\">Comment 56</div>\n\nReplying to [@JohnCremona](#comment%3A53):\n> I think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.\n\nIs there a ticket for this yet?",
    "created_at": "2011-09-29T10:49:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80865",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:56" align="right">Comment 56</div>

Replying to [@JohnCremona](#comment%3A53):
> I think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.

Is there a ticket for this yet?



---

archive/issue_comments_080866.json:
```json
{
    "body": "<div id=\"comment:57\" align=\"right\">Comment 57</div>\n\nSage-nt thread here: http://groups.google.com/group/sage-nt/browse_thread/thread/9108218411e7f0a6",
    "created_at": "2011-09-29T10:57:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80866",
    "user": "https://github.com/loefflerd"
}
```

<div id="comment:57" align="right">Comment 57</div>

Sage-nt thread here: http://groups.google.com/group/sage-nt/browse_thread/thread/9108218411e7f0a6



---

archive/issue_comments_080867.json:
```json
{
    "body": "<div id=\"comment:58\" align=\"right\">Comment 58</div>\n\nReplying to [@mstreng](#comment%3A56):\n> Replying to [@JohnCremona](#comment%3A53):\n> > I think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.\n\n> \n> Is there a ticket for this yet? \n\nJust made one: #11869.",
    "created_at": "2011-09-29T12:13:56Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80867",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:58" align="right">Comment 58</div>

Replying to [@mstreng](#comment%3A56):
> Replying to [@JohnCremona](#comment%3A53):
> > I think this is a horrible bug. There is no embedding from L to K!  A very generic `__call__` method is used, and is definitely not doing the right thing here.

> 
> Is there a ticket for this yet? 

Just made one: #11869.



---

archive/issue_comments_080868.json:
```json
{
    "body": "<div id=\"comment:59\" align=\"right\">Comment 59</div>\n\nReplying to [@jdemeyer](#comment%3A52):\n> Replying to [@mstreng](#comment%3A50):\n> > There is still a duplicate example, and a lot of examples that return 1 now that they are corrected. I think we should remove some of these, and add some -1's such as the ones in my comment 2 days ago.\n\n> Please do it!\n\nI could, but I wouldn't be able to test it, and it may need to be rebased afterwards: I failed to install #11130.",
    "created_at": "2011-09-29T21:18:49Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80868",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:59" align="right">Comment 59</div>

Replying to [@jdemeyer](#comment%3A52):
> Replying to [@mstreng](#comment%3A50):
> > There is still a duplicate example, and a lot of examples that return 1 now that they are corrected. I think we should remove some of these, and add some -1's such as the ones in my comment 2 days ago.

> Please do it!

I could, but I wouldn't be able to test it, and it may need to be rebased afterwards: I failed to install #11130.



---

archive/issue_comments_080869.json:
```json
{
    "body": "<div id=\"comment:60\" align=\"right\">Comment 60</div>\n\nPositive review for the reviewer patch. I noticed that it included extra -1 examples and removed the duplicate example, and I did not find removing examples worth the trouble.\n\nI also managed to build #11130 and found that all tests pass. I'm assuming Jeroen gives a positive review to what he didn't change, and that his reviewer patch was ready for review, so I'm setting the whole ticket to positive review.",
    "created_at": "2011-09-30T19:24:10Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80869",
    "user": "https://github.com/mstreng"
}
```

<div id="comment:60" align="right">Comment 60</div>

Positive review for the reviewer patch. I noticed that it included extra -1 examples and removed the duplicate example, and I did not find removing examples worth the trouble.

I also managed to build #11130 and found that all tests pass. I'm assuming Jeroen gives a positive review to what he didn't change, and that his reviewer patch was ready for review, so I'm setting the whole ticket to positive review.



---

archive/issue_events_108894.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-09-30T19:24:10Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/needs%20work",
    "label_color": "ffff00",
    "label_name": "needs work",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108894"
}
```



---

archive/issue_events_108895.json:
```json
{
    "actor": "https://github.com/mstreng",
    "created_at": "2011-09-30T19:24:10Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108895"
}
```



---

archive/issue_events_108896.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-04T07:35:44Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "milestone_number": null,
    "milestone_title": "sage-5.0",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108896"
}
```



---

archive/issue_events_108897.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-04T07:35:44Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108897"
}
```



---

archive/issue_comments_080870.json:
```json
{
    "body": "Changed work issues from **add/remove some doctests** to none",
    "created_at": "2011-10-06T12:00:21Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80870",
    "user": "https://github.com/jdemeyer"
}
```

Changed work issues from **add/remove some doctests** to none



---

archive/issue_events_108898.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-22T16:49:27Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108898"
}
```



---

archive/issue_events_108899.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-10-22T16:49:27Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108899"
}
```



---

archive/issue_events_108900.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T09:10:30Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108900"
}
```



---

archive/issue_events_108901.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T09:10:30Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/pending",
    "label_color": "008080",
    "label_name": "pending",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108901"
}
```



---

archive/issue_comments_080871.json:
```json
{
    "body": "Milestone sage-4.7.3 deleted",
    "created_at": "2011-11-03T16:14:43Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80871",
    "user": "https://github.com/jdemeyer"
}
```

Milestone sage-4.7.3 deleted



---

archive/issue_events_108902.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-03T16:14:43Z",
    "event": "demilestoned",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108902"
}
```



---

archive/issue_events_108903.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:32Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "milestone_number": null,
    "milestone_title": "sage-4.8",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108903"
}
```



---

archive/issue_comments_080872.json:
```json
{
    "body": "Merged: **sage-4.8.alpha1**",
    "created_at": "2011-11-07T10:11:32Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9334#issuecomment-80872",
    "user": "https://github.com/jdemeyer"
}
```

Merged: **sage-4.8.alpha1**



---

archive/issue_events_108904.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:32Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108904"
}
```



---

archive/issue_events_108905.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2011-11-07T10:11:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9334",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9334#event-108905"
}
```
