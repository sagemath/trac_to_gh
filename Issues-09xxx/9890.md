# Issue 9890: A proper random_element() method for PerfectMatchings

archive/issues_009889.json:
```json
{
    "body": "At the moment, the method `random_element()` from PerfectMatchings computes a random matching by picking a random integer between 0 and the number of matchings on n elements, then (I presume) enumerating all the matchings according to some ordering until the `k`th has been computed. This is impressively useless.\n\n```\nsage: %timeit PerfectMatchings(12).random_element()\n5 loops, best of 3: 1.5 s per loop\n```\n\nBy the way, I was not able to write a method to obtain the list of pairs describing the matching from an PerfectMatching object.. I don't understand how this class is written, and I have no idea why it needs to be so complicated (but it would be nice to add it to this ticket during the review, if someone gets how it works).\n\nThe method random_element (and also an_element) both raise an exception when the set of elements is EMPTY. I also fixed the doctests.\n\n(I don't even get why you can build a PerfectMatchings class on an odd number of elements in the first place)\n\nI expect this ticket could be heavily modified during review, but there is a problem with these classes at the moment.\n\nNathann\n\n**Assignee:** sage-combinat\n\n**CC:**  @nthiery fhivert\n\n**Reviewer:** Fr\u00e9d\u00e9ric Chapoton\n\n**Author:** Nathann Cohen\n\n**Merged:** sage-5.10.beta5\n\n**Resolution:** fixed\n\nIssue created by migration from https://trac.sagemath.org/ticket/9890\n\n",
    "closed_at": "2013-05-22T08:18:32Z",
    "created_at": "2010-09-10T15:44:15Z",
    "labels": [
        "component: combinatorics",
        "bug"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-5.10",
    "title": "A proper random_element() method for PerfectMatchings",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/9890",
    "user": "https://github.com/nathanncohen"
}
```
At the moment, the method `random_element()` from PerfectMatchings computes a random matching by picking a random integer between 0 and the number of matchings on n elements, then (I presume) enumerating all the matchings according to some ordering until the `k`th has been computed. This is impressively useless.

```
sage: %timeit PerfectMatchings(12).random_element()
5 loops, best of 3: 1.5 s per loop
```

By the way, I was not able to write a method to obtain the list of pairs describing the matching from an PerfectMatching object.. I don't understand how this class is written, and I have no idea why it needs to be so complicated (but it would be nice to add it to this ticket during the review, if someone gets how it works).

The method random_element (and also an_element) both raise an exception when the set of elements is EMPTY. I also fixed the doctests.

(I don't even get why you can build a PerfectMatchings class on an odd number of elements in the first place)

I expect this ticket could be heavily modified during review, but there is a problem with these classes at the moment.

Nathann

**Assignee:** sage-combinat

**CC:**  @nthiery fhivert

**Reviewer:** Frédéric Chapoton

**Author:** Nathann Cohen

**Merged:** sage-5.10.beta5

**Resolution:** fixed

Issue created by migration from https://trac.sagemath.org/ticket/9890





---

archive/issue_comments_123619.json:
```json
{
    "body": "<a id='comment:1'></a>\nI forgot to click on `needs_review` three years ago `T_T`\n\nNathann",
    "created_at": "2013-03-23T11:21:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123619",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:1'></a>
I forgot to click on `needs_review` three years ago `T_T`

Nathann



---

archive/issue_comments_123620.json:
```json
{
    "body": "**Changing status** from new to needs_review.",
    "created_at": "2013-03-23T11:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123620",
    "user": "https://github.com/nathanncohen"
}
```

**Changing status** from new to needs_review.



---

archive/issue_comments_123621.json:
```json
{
    "body": "<a id='comment:2'></a>\nPatch updated ! On the way, I also fixed this \"small problem\" :\n\n```\nsage: PerfectMatchings(3).an_element()\n[(1, 2)]\n```\n\nNathann",
    "created_at": "2013-03-23T11:33:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123621",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:2'></a>
Patch updated ! On the way, I also fixed this "small problem" :

```
sage: PerfectMatchings(3).an_element()
[(1, 2)]
```

Nathann



---

archive/attachments_012820.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9890.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9890/trac_9890.patch",
    "created_at": "2013-03-23T11:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nathanncohen"
}
```



---

archive/issue_comments_123622.json:
```json
{
    "body": "",
    "created_at": "2013-03-23T11:34:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123622",
    "user": "https://github.com/nathanncohen"
}
```





---

archive/issue_comments_123623.json:
```json
{
    "body": "<a id='comment:3'></a>\nhello,\n\nlooks good to me.\n\nI have taken the opportunity to make a complete cosmetic clean-up of the file (using pep8 and pyflakes)\n\nif my review patch is ok for you, you can set a positive review",
    "created_at": "2013-05-17T19:22:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123623",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:3'></a>
hello,

looks good to me.

I have taken the opportunity to make a complete cosmetic clean-up of the file (using pep8 and pyflakes)

if my review patch is ok for you, you can set a positive review



---

archive/issue_comments_123624.json:
```json
{
    "body": "**Author:** Nathann Cohen",
    "created_at": "2013-05-18T10:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123624",
    "user": "https://github.com/nathanncohen"
}
```

**Author:** Nathann Cohen



---

archive/issue_comments_123625.json:
```json
{
    "body": "**Changing status** from needs_review to positive_review.",
    "created_at": "2013-05-18T10:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123625",
    "user": "https://github.com/nathanncohen"
}
```

**Changing status** from needs_review to positive_review.



---

archive/attachments_012821.json:
```json
{
    "asset_content_type": "application/octet-stream",
    "asset_name": "trac_9890_review.patch",
    "asset_url": "tarball://root/attachments/some-uuid/ticket9890/trac_9890_review.patch",
    "created_at": "2013-05-18T10:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "attachment",
    "url": "https://github.com/assets/some-id/some-uuid.patch",
    "user": "https://github.com/nathanncohen"
}
```



---

archive/issue_comments_123626.json:
```json
{
    "body": "<a id='comment:4'></a>\n> I have taken the opportunity to make a complete cosmetic clean-up of the file (using pep8 and pyflakes)\n> \n> if my review patch is ok for you, you can set a positive review\n\n\nOkayyyyyyy ! Good to go, then `:-)`\n\nBy the way, how do you use pep8 and pyflakes ? Do you run them externally on files or do you have a way to use them ?\n\nNathann",
    "created_at": "2013-05-18T10:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123626",
    "user": "https://github.com/nathanncohen"
}
```

<a id='comment:4'></a>
> I have taken the opportunity to make a complete cosmetic clean-up of the file (using pep8 and pyflakes)
> 
> if my review patch is ok for you, you can set a positive review


Okayyyyyyy ! Good to go, then `:-)`

By the way, how do you use pep8 and pyflakes ? Do you run them externally on files or do you have a way to use them ?

Nathann



---

archive/issue_comments_123627.json:
```json
{
    "body": "**Reviewer:** Fr\u00e9d\u00e9ric Chapoton",
    "created_at": "2013-05-18T10:14:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123627",
    "user": "https://github.com/nathanncohen"
}
```

**Reviewer:** Frédéric Chapoton



---

archive/issue_comments_123628.json:
```json
{
    "body": "<a id='comment:5'></a>\nYes, I just run them on the *.py files. Pyflakes is more important, as it finds missing imports and unused variables. Pep8 is much more for the cosmetic, but can check that raise statements are in python3 syntax and find other deprecated syntax.",
    "created_at": "2013-05-18T18:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123628",
    "user": "https://github.com/fchapoton"
}
```

<a id='comment:5'></a>
Yes, I just run them on the *.py files. Pyflakes is more important, as it finds missing imports and unused variables. Pep8 is much more for the cosmetic, but can check that raise statements are in python3 syntax and find other deprecated syntax.



---

archive/issue_comments_123629.json:
```json
{
    "body": "**Resolution:** fixed",
    "created_at": "2013-05-22T08:18:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123629",
    "user": "https://github.com/jdemeyer"
}
```

**Resolution:** fixed



---

archive/issue_comments_123630.json:
```json
{
    "body": "**Merged:** sage-5.10.beta5",
    "created_at": "2013-05-22T08:18:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/9890#issuecomment-123630",
    "user": "https://github.com/jdemeyer"
}
```

**Merged:** sage-5.10.beta5



---

archive/issue_events_030158.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2013-05-22T08:18:32Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sagetest/issues/9890",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sagetest/issues/9890#event-30158"
}
```
