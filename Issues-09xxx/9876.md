# Issue 9876: Building PARI/GP with SAGE_CHECK=yes fails on 32-bit big endian machines

archive/issues_009875.json:
```json
{
    "assignees": [],
    "body": "**This is an upstream problem with PARI/GP**\n\nUpstream report: [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099)\n\nThe \"rnfkummer\" test in PARI's `make test-all` fails on the following systems:\n* PPC OS X 10.4\n* Linux PPC 32-bit\n* Solaris SPARC\n\nFor example, on a PPC Mac OS X 10.4:\n\n```\nGP/PARI CALCULATOR Version 2.4.3 (development svn-12594)\nPowerPC running darwin (PPC/GMP-5.0.1 kernel) 32-bit version\ncompiled: Sep  8 2010, gcc-4.5.1 (GCC)\n(readline v5.0 enabled, extended help enabled)\n```\n\nI get a failure in rnfkummer (both sta and dyn), I am attaching the dif and the output of Configure.\n\n* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg) (see also `pari.p7.patch` below)\n* **sagelib patch:** `9876_doctest.patch`\n\nCC:  @sagetrac-drkirkby @qed777 @sagetrac-GeorgSWeber\n\nComponent: **packages: standard**\n\nAuthor: **Jeroen Demeyer**\n\nReviewer: **John Palmieri, Leif Leonhardy**\n\nUpstream: **Completely fixed; Fix reported upstream**\n\nMerged: **sage-4.6.alpha2**\n\n_Issue created by migration from https://trac.sagemath.org/ticket/9876_\n\n",
    "closed_at": "2010-09-29T08:40:07Z",
    "created_at": "2010-09-08T18:58:52Z",
    "labels": [
        "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
        "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
        "https://github.com/sagemath/sage/labels/bug"
    ],
    "milestone": "https://github.com/sagemath/sage/milestones/sage-4.6",
    "reactions": [],
    "repository": "https://github.com/sagemath/sage",
    "title": "Building PARI/GP with SAGE_CHECK=yes fails on 32-bit big endian machines",
    "type": "issue",
    "updated_at": "2010-09-29T08:40:07Z",
    "url": "https://github.com/sagemath/sage/issues/9876",
    "user": "https://github.com/jdemeyer"
}
```
**This is an upstream problem with PARI/GP**

Upstream report: [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099)

The "rnfkummer" test in PARI's `make test-all` fails on the following systems:
* PPC OS X 10.4
* Linux PPC 32-bit
* Solaris SPARC

For example, on a PPC Mac OS X 10.4:

```
GP/PARI CALCULATOR Version 2.4.3 (development svn-12594)
PowerPC running darwin (PPC/GMP-5.0.1 kernel) 32-bit version
compiled: Sep  8 2010, gcc-4.5.1 (GCC)
(readline v5.0 enabled, extended help enabled)
```

I get a failure in rnfkummer (both sta and dyn), I am attaching the dif and the output of Configure.

* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg) (see also `pari.p7.patch` below)
* **sagelib patch:** `9876_doctest.patch`

CC:  @sagetrac-drkirkby @qed777 @sagetrac-GeorgSWeber

Component: **packages: standard**

Author: **Jeroen Demeyer**

Reviewer: **John Palmieri, Leif Leonhardy**

Upstream: **Completely fixed; Fix reported upstream**

Merged: **sage-4.6.alpha2**

_Issue created by migration from https://trac.sagemath.org/ticket/9876_





---

archive/issue_events_127022.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-08T18:58:52Z",
    "event": "milestoned",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "milestone_number": null,
    "milestone_title": "sage-4.6",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127022"
}
```



---

archive/issue_events_127023.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-08T18:58:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/c%3A%20packages%3A%20standard",
    "label_color": "0000b0",
    "label_name": "c: packages: standard",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127023"
}
```



---

archive/issue_events_127024.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-08T18:58:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127024"
}
```



---

archive/issue_events_127025.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-08T18:58:52Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/bug",
    "label_color": "d73a4a",
    "label_name": "bug",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127025"
}
```



---

archive/issue_comments_088493.json:
```json
{
    "body": "output of Configure",
    "created_at": "2010-09-08T18:59:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88493",
    "user": "https://github.com/jdemeyer"
}
```

output of Configure



---

archive/issue_comments_088494.json:
```json
{
    "body": "Attachment: **[Configure.log](https://github.com/sagemath/sage/files/ticket9876/Configure.log)**\n\nAttachment: **[rnfkummer-sta.dif.gz](https://github.com/sagemath/sage/files/ticket9876/rnfkummer-sta.dif.gz)**\n\ndiff from `make test-all`",
    "created_at": "2010-09-08T18:59:33Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88494",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[Configure.log](https://github.com/sagemath/sage/files/ticket9876/Configure.log)**

Attachment: **[rnfkummer-sta.dif.gz](https://github.com/sagemath/sage/files/ticket9876/rnfkummer-sta.dif.gz)**

diff from `make test-all`



---

archive/issue_comments_088495.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,4 @@\n-**This is an upstream problem with PARI/GP**\n+**This is an upstream problem with PARI/GP** (or possibly a bug in `gcc`)\n \n On one PPC Mac OS X 10.4 machine, the \"rnfkummer\" test in PARI's `make test-all` always fails.\n \n``````\n",
    "created_at": "2010-09-08T19:12:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88495",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,4 @@
-**This is an upstream problem with PARI/GP**
+**This is an upstream problem with PARI/GP** (or possibly a bug in `gcc`)
 
 On one PPC Mac OS X 10.4 machine, the "rnfkummer" test in PARI's `make test-all` always fails.
 
``````




---

archive/issue_comments_088496.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,4 +1,6 @@\n **This is an upstream problem with PARI/GP** (or possibly a bug in `gcc`)\n+\n+Upstream report: [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099)\n \n On one PPC Mac OS X 10.4 machine, the \"rnfkummer\" test in PARI's `make test-all` always fails.\n \n``````\n",
    "created_at": "2010-09-08T19:17:19Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88496",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,4 +1,6 @@
 **This is an upstream problem with PARI/GP** (or possibly a bug in `gcc`)
+
+Upstream report: [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099)
 
 On one PPC Mac OS X 10.4 machine, the "rnfkummer" test in PARI's `make test-all` always fails.
 
``````




---

archive/issue_comments_088497.json:
```json
{
    "body": "<div id=\"comment:3\" align=\"right\">comment:3</div>\n\nI get the same error on t2.math.washington.edu (Solaris on sparc).",
    "created_at": "2010-09-08T19:52:23Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88497",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:3" align="right">comment:3</div>

I get the same error on t2.math.washington.edu (Solaris on sparc).



---

archive/issue_comments_088498.json:
```json
{
    "body": "<div id=\"comment:4\" align=\"right\">comment:4</div>\n\nSo what does a Solaris sparc have in common with a PPC OS X which other systems do not have???",
    "created_at": "2010-09-08T19:57:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88498",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:4" align="right">comment:4</div>

So what does a Solaris sparc have in common with a PPC OS X which other systems do not have???



---

archive/issue_comments_088499.json:
```json
{
    "body": "<div id=\"comment:5\" align=\"right\">comment:5</div>\n\nI've put the build directory from t2 at `/home/palmieri/t2/pari-2.4.3.svn-12577.p5` in case any of the files there are helpful.  (Note that the /home directories are the same on t2 as on sage.math, so you can access this directory from sage.math.)",
    "created_at": "2010-09-08T20:00:37Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88499",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:5" align="right">comment:5</div>

I've put the build directory from t2 at `/home/palmieri/t2/pari-2.4.3.svn-12577.p5` in case any of the files there are helpful.  (Note that the /home directories are the same on t2 as on sage.math, so you can access this directory from sage.math.)



---

archive/issue_comments_088500.json:
```json
{
    "body": "<div id=\"comment:6\" align=\"right\">comment:6</div>\n\nReplying to [@jhpalmieri](#comment%3A5):\n> I've put the build directory from t2 at `/home/palmieri/t2/pari-2.4.3.svn-12577.p5` in case any of the files there are helpful.  (Note that the /home directories are the same on t2 as on sage.math, so you can access this directory from sage.math.)\n\nPlease do `chmod 755 /home/palmieri/t2/pari-2.4.3.svn-12577.p5` and then I can actually access it.",
    "created_at": "2010-09-08T20:06:29Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88500",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:6" align="right">comment:6</div>

Replying to [@jhpalmieri](#comment%3A5):
> I've put the build directory from t2 at `/home/palmieri/t2/pari-2.4.3.svn-12577.p5` in case any of the files there are helpful.  (Note that the /home directories are the same on t2 as on sage.math, so you can access this directory from sage.math.)

Please do `chmod 755 /home/palmieri/t2/pari-2.4.3.svn-12577.p5` and then I can actually access it.



---

archive/issue_comments_088501.json:
```json
{
    "body": "<div id=\"comment:7\" align=\"right\">comment:7</div>\n\nThanks!  For reference, the PARI/GP build directory on t2 (a Solaris sparc) can be found on:\n[http://sage.math.washington.edu/home/palmieri/t2/pari-2.4.3.svn-12577.p5/src/](http://sage.math.washington.edu/home/palmieri/t2/pari-2.4.3.svn-12577.p5/src/)",
    "created_at": "2010-09-08T20:37:50Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88501",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:7" align="right">comment:7</div>

Thanks!  For reference, the PARI/GP build directory on t2 (a Solaris sparc) can be found on:
[http://sage.math.washington.edu/home/palmieri/t2/pari-2.4.3.svn-12577.p5/src/](http://sage.math.washington.edu/home/palmieri/t2/pari-2.4.3.svn-12577.p5/src/)



---

archive/issue_comments_088502.json:
```json
{
    "body": "<div id=\"comment:8\" align=\"right\">comment:8</div>\n\nReplying to [@jdemeyer](#comment%3A4):\n> So what does a Solaris sparc have in common with a PPC OS X which other systems do not have???\n\n32-bit big endian machines?",
    "created_at": "2010-09-08T20:45:39Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88502",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:8" align="right">comment:8</div>

Replying to [@jdemeyer](#comment%3A4):
> So what does a Solaris sparc have in common with a PPC OS X which other systems do not have???

32-bit big endian machines?



---

archive/issue_comments_088503.json:
```json
{
    "body": "<div id=\"comment:9\" align=\"right\">comment:9</div>\n\nI also get the same error on the skynet machine mark (a *very* slow sparc machine running solaris).  I didn't the problem with fulvia (x86 running solaris).",
    "created_at": "2010-09-09T04:47:31Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88503",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:9" align="right">comment:9</div>

I also get the same error on the skynet machine mark (a *very* slow sparc machine running solaris).  I didn't the problem with fulvia (x86 running solaris).



---

archive/issue_comments_088504.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -1,10 +1,13 @@\n-**This is an upstream problem with PARI/GP** (or possibly a bug in `gcc`)\n+**This is an upstream problem with PARI/GP**\n \n Upstream report: [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099)\n \n-On one PPC Mac OS X 10.4 machine, the \"rnfkummer\" test in PARI's `make test-all` always fails.\n+The \"rnfkummer\" test in PARI's `make test-all` fails on the following systems:\n+* PPC OS X 10.4\n+* Linux PPC 32-bit\n+* Solaris sparc\n \n-For example, with this version:\n+For example, on a PPC Mac OS X 10.4:\n \n ```\n GP/PARI CALCULATOR Version 2.4.3 (development svn-12594)\n``````\n",
    "created_at": "2010-09-09T08:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88504",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -1,10 +1,13 @@
-**This is an upstream problem with PARI/GP** (or possibly a bug in `gcc`)
+**This is an upstream problem with PARI/GP**
 
 Upstream report: [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1099)
 
-On one PPC Mac OS X 10.4 machine, the "rnfkummer" test in PARI's `make test-all` always fails.
+The "rnfkummer" test in PARI's `make test-all` fails on the following systems:
+* PPC OS X 10.4
+* Linux PPC 32-bit
+* Solaris sparc
 
-For example, with this version:
+For example, on a PPC Mac OS X 10.4:
 
 ```
 GP/PARI CALCULATOR Version 2.4.3 (development svn-12594)
``````




---

archive/issue_events_127026.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-09T08:15:14Z",
    "event": "renamed",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "title_is": "Building PARI/GP with SAGE_CHECK=yes fails on 32-bit big endian machines",
    "title_was": "Building PARI/GP with SAGE_CHECK=yes fails on rnfkummer on a PPC Mac OS X 10.4",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127026"
}
```



---

archive/issue_comments_088505.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**",
    "created_at": "2010-09-09T08:15:14Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88505",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **Reported upstream. Little or no feedback.** to **Reported upstream. Developers acknowledge bug.**



---

archive/issue_comments_088506.json:
```json
{
    "body": "<div id=\"comment:11\" align=\"right\">comment:11</div>\n\nReplying to [@jdemeyer](#comment%3A8):\n> Replying to [@jdemeyer](#comment%3A4):\n> > So what does a Solaris sparc have in common with a PPC OS X which other systems do not have???\n\n> \n> 32-bit big endian machines?\n\nAll modern SPARC systems are 64-bit. The Sun Ultra 1, which was the first 64-bit machine from Sun, was bought out in 1995 - i.e. 15 years ago, well before any Intel or AMD chip was 64-bit. \n\nHowever, to maintain backward compatibility, and to increase performance, Sun chose to retain the default builds as 32-bit. So are in fact building Sage 32-bit on Solaris, though a 64-bit build is possible. \n\nThe fact John said the tests fail on 'mark' but pass on 'fulvia' does indicate it's very likely to be a big-endian issue. I have a machine running HP-UX which uses a PA-RISC processor. That is big-endian. I could try building Pari on there, though I'm not sure if it will work or not. I'd not be surprised if it failed to build on there. \n\nDave",
    "created_at": "2010-09-09T09:47:03Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88506",
    "user": "https://github.com/sagetrac-drkirkby"
}
```

<div id="comment:11" align="right">comment:11</div>

Replying to [@jdemeyer](#comment%3A8):
> Replying to [@jdemeyer](#comment%3A4):
> > So what does a Solaris sparc have in common with a PPC OS X which other systems do not have???

> 
> 32-bit big endian machines?

All modern SPARC systems are 64-bit. The Sun Ultra 1, which was the first 64-bit machine from Sun, was bought out in 1995 - i.e. 15 years ago, well before any Intel or AMD chip was 64-bit. 

However, to maintain backward compatibility, and to increase performance, Sun chose to retain the default builds as 32-bit. So are in fact building Sage 32-bit on Solaris, though a 64-bit build is possible. 

The fact John said the tests fail on 'mark' but pass on 'fulvia' does indicate it's very likely to be a big-endian issue. I have a machine running HP-UX which uses a PA-RISC processor. That is big-endian. I could try building Pari on there, though I'm not sure if it will work or not. I'd not be surprised if it failed to build on there. 

Dave



---

archive/issue_comments_088507.json:
```json
{
    "body": "<div id=\"comment:12\" align=\"right\">comment:12</div>\n\nReplying to [@sagetrac-drkirkby](#comment%3A11):\n> All modern SPARC systems are 64-bit. The Sun Ultra 1, which was the first 64-bit machine from Sun, was bought out in 1995 - i.e. 15 years ago, well before any Intel or AMD chip was 64-bit.\n\ni860? That were the days of SPARC V7... ;-)",
    "created_at": "2010-09-09T15:15:05Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88507",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:12" align="right">comment:12</div>

Replying to [@sagetrac-drkirkby](#comment%3A11):
> All modern SPARC systems are 64-bit. The Sun Ultra 1, which was the first 64-bit machine from Sun, was bought out in 1995 - i.e. 15 years ago, well before any Intel or AMD chip was 64-bit.

i860? That were the days of SPARC V7... ;-)



---

archive/issue_comments_088508.json:
```json
{
    "body": "Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**",
    "created_at": "2010-09-10T08:41:18Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88508",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **Reported upstream. Developers acknowledge bug.** to **Fixed upstream, but not in a stable release.**



---

archive/issue_comments_088509.json:
```json
{
    "body": "Attachment: **[9876_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket9876/9876_doctest.patch.gz)**\n\nAdds doctest to catch this error in the future",
    "created_at": "2010-09-10T19:11:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88509",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[9876_doctest.patch.gz](https://github.com/sagemath/sage/files/ticket9876/9876_doctest.patch.gz)**

Adds doctest to catch this error in the future



---

archive/issue_comments_088510.json:
```json
{
    "body": "Author: **Jeroen Demeyer**",
    "created_at": "2010-09-11T06:40:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88510",
    "user": "https://github.com/jdemeyer"
}
```

Author: **Jeroen Demeyer**



---

archive/issue_comments_088511.json:
```json
{
    "body": "Changed upstream from **Fixed upstream, but not in a stable release.** to **Completely fixed; Fix reported upstream**",
    "created_at": "2010-09-11T06:40:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88511",
    "user": "https://github.com/jdemeyer"
}
```

Changed upstream from **Fixed upstream, but not in a stable release.** to **Completely fixed; Fix reported upstream**



---

archive/issue_comments_088512.json:
```json
{
    "body": "<div id=\"comment:14\" align=\"right\">comment:14</div>\n\nFix (spkg + doctest) tested on\n* 64-bit Intel Linux\n* 32-bit Intel Linux\n* 32-bit PPC OS X",
    "created_at": "2010-09-11T06:40:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88512",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:14" align="right">comment:14</div>

Fix (spkg + doctest) tested on
* 64-bit Intel Linux
* 32-bit Intel Linux
* 32-bit PPC OS X



---

archive/issue_comments_088513.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -17,3 +17,6 @@\n ```\n \n I get a failure in rnfkummer (both sta and dyn), I am attaching the dif and the output of Configure.\n+\n+* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg) (see also `pari.p6.patch` below)\n+* **sagelib patch:** `9876_doctest.patch`\n``````\n",
    "created_at": "2010-09-11T06:40:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88513",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -17,3 +17,6 @@
 ```
 
 I get a failure in rnfkummer (both sta and dyn), I am attaching the dif and the output of Configure.
+
+* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg) (see also `pari.p6.patch` below)
+* **sagelib patch:** `9876_doctest.patch`
``````




---

archive/issue_events_127027.json:
```json
{
    "actor": "https://github.com/jdemeyer",
    "created_at": "2010-09-11T06:40:11Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127027"
}
```



---

archive/issue_events_127028.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-11T07:24:24Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20critical%20/%202",
    "label_color": "ff7700",
    "label_name": "p: critical / 2",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127028"
}
```



---

archive/issue_events_127029.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-11T07:24:24Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/p%3A%20blocker%20/%201",
    "label_color": "ff0000",
    "label_name": "p: blocker / 1",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127029"
}
```



---

archive/issue_comments_088514.json:
```json
{
    "body": "<div id=\"comment:15\" align=\"right\">comment:15</div>\n\nAssuming Mitesh is ok with that.",
    "created_at": "2010-09-11T07:24:24Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88514",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:15" align="right">comment:15</div>

Assuming Mitesh is ok with that.



---

archive/issue_comments_088515.json:
```json
{
    "body": "<div id=\"comment:16\" align=\"right\">comment:16</div>\n\nP.S.: Tell Mercurial some patches have been removed...",
    "created_at": "2010-09-11T07:37:54Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88515",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:16" align="right">comment:16</div>

P.S.: Tell Mercurial some patches have been removed...



---

archive/issue_comments_088516.json:
```json
{
    "body": "<div id=\"comment:17\" align=\"right\">comment:17</div>\n\nCan someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)",
    "created_at": "2010-09-11T08:12:02Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88516",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:17" align="right">comment:17</div>

Can someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)



---

archive/issue_comments_088517.json:
```json
{
    "body": "<div id=\"comment:18\" align=\"right\">comment:18</div>\n\nLast comment refers to\n\n```\n=== pari-2.4.3.svn-12577.p6 (Jeroen Demeyer, September 10th, 2010) ===\n * Add upstream fix for config/get_dlcflags and remove the patch\n```\nwhich is\n\n```diff\n$ diff -Nau pari-2.4.3.svn-12577.p5/src/config/get_dlcflags pari-2.4.3.svn-12577.p6/src/config/get_dlcflags \n--- pari-2.4.3.svn-12577.p5/src/config/get_dlcflags\t2010-09-06 21:26:42.000000000 +0200\n+++ pari-2.4.3.svn-12577.p6/src/config/get_dlcflags\t2010-09-10 23:29:12.000000000 +0200\n@@ -2,6 +2,10 @@\n if test -n \"$__gnuc__\"; then\n   case $osname in\n     cygwin|mingw) DLCFLAGS=;;\n+    darwin) DLCFLAGS=-fPIC\n+      case $arch in\n+        ppc|ppc64) DLCFLAGS=\"$DLCFLAGS -fno-common\"\n+      esac;;\n     *) DLCFLAGS=-fPIC;;\n   esac\n else #assume native compiler\n```",
    "created_at": "2010-09-11T08:21:41Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88517",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:18" align="right">comment:18</div>

Last comment refers to

```
=== pari-2.4.3.svn-12577.p6 (Jeroen Demeyer, September 10th, 2010) ===
 * Add upstream fix for config/get_dlcflags and remove the patch
```
which is

```diff
$ diff -Nau pari-2.4.3.svn-12577.p5/src/config/get_dlcflags pari-2.4.3.svn-12577.p6/src/config/get_dlcflags 
--- pari-2.4.3.svn-12577.p5/src/config/get_dlcflags	2010-09-06 21:26:42.000000000 +0200
+++ pari-2.4.3.svn-12577.p6/src/config/get_dlcflags	2010-09-10 23:29:12.000000000 +0200
@@ -2,6 +2,10 @@
 if test -n "$__gnuc__"; then
   case $osname in
     cygwin|mingw) DLCFLAGS=;;
+    darwin) DLCFLAGS=-fPIC
+      case $arch in
+        ppc|ppc64) DLCFLAGS="$DLCFLAGS -fno-common"
+      esac;;
     *) DLCFLAGS=-fPIC;;
   esac
 else #assume native compiler
```



---

archive/issue_comments_088518.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -5,7 +5,7 @@\n The \"rnfkummer\" test in PARI's `make test-all` fails on the following systems:\n * PPC OS X 10.4\n * Linux PPC 32-bit\n-* Solaris sparc\n+* Solaris SPARC\n \n For example, on a PPC Mac OS X 10.4:\n \n``````\n",
    "created_at": "2010-09-11T10:53:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88518",
    "user": "https://github.com/nexttime"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -5,7 +5,7 @@
 The "rnfkummer" test in PARI's `make test-all` fails on the following systems:
 * PPC OS X 10.4
 * Linux PPC 32-bit
-* Solaris sparc
+* Solaris SPARC
 
 For example, on a PPC Mac OS X 10.4:
 
``````




---

archive/issue_comments_088519.json:
```json
{
    "body": "<div id=\"comment:19\" align=\"right\">comment:19</div>\n\nJeroen, could you also extend the message printed when `SAGE_TUNE_PARI=yes` to strongly recommend running PARI's test suite after tuning? (We could in principle do that automatically from `spkg-install` as well, but that's IMHO not a good idea since it then might get run twice, and also doing so wouldn't fit Sage's build/test process.)\n\nAs mentioned somewhere else (#9343?), one of PARI's self-tests fails *after \"successful\" tuning* on a Pentium 4 Prescott running Ubuntu 9.04 (gcc 4.3.3). I've yet only put a comment on the wiki page; will open a ticket for that later.\n\n---\n\nI'd prefer prepending `./` to `Configure`, since this will give an *appropriate* error message in any case where `src/Configure` does (for whatever reason) not exist. (Otherwise `bash` would then attempt to find it in `$PATH`, which might cause weird behavoir.)\n\n---\n\nWhile adding `-fno-common` on MacOS X 10.5 and 10.6, too, is perhaps a bit odd, it doesn't hurt; otherwise one should look for *Darwin 8* (10.4) with `uname ...`. (I currently don't know the exact string; the relevant part should be the same on PPC 10.4.).",
    "created_at": "2010-09-11T10:53:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88519",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:19" align="right">comment:19</div>

Jeroen, could you also extend the message printed when `SAGE_TUNE_PARI=yes` to strongly recommend running PARI's test suite after tuning? (We could in principle do that automatically from `spkg-install` as well, but that's IMHO not a good idea since it then might get run twice, and also doing so wouldn't fit Sage's build/test process.)

As mentioned somewhere else (#9343?), one of PARI's self-tests fails *after "successful" tuning* on a Pentium 4 Prescott running Ubuntu 9.04 (gcc 4.3.3). I've yet only put a comment on the wiki page; will open a ticket for that later.

---

I'd prefer prepending `./` to `Configure`, since this will give an *appropriate* error message in any case where `src/Configure` does (for whatever reason) not exist. (Otherwise `bash` would then attempt to find it in `$PATH`, which might cause weird behavoir.)

---

While adding `-fno-common` on MacOS X 10.5 and 10.6, too, is perhaps a bit odd, it doesn't hurt; otherwise one should look for *Darwin 8* (10.4) with `uname ...`. (I currently don't know the exact string; the relevant part should be the same on PPC 10.4.).



---

archive/issue_comments_088520.json:
```json
{
    "body": "<div id=\"comment:20\" align=\"right\">comment:20</div>\n\nReplying to [@nexttime](#comment%3A19):\n> [...] otherwise one should look for *Darwin 8* (10.4) with `uname ...`. (I currently don't know the exact string; the relevant part should be the same on PPC 10.4.).\n\n<code>\\`uname -r\\`</code> should start with `8` for MacOS X 10.4 / Tiger / Darwin 8.",
    "created_at": "2010-09-11T12:17:35Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88520",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:20" align="right">comment:20</div>

Replying to [@nexttime](#comment%3A19):
> [...] otherwise one should look for *Darwin 8* (10.4) with `uname ...`. (I currently don't know the exact string; the relevant part should be the same on PPC 10.4.).

<code>\`uname -r\`</code> should start with `8` for MacOS X 10.4 / Tiger / Darwin 8.



---

archive/issue_comments_088521.json:
```json
{
    "body": "<div id=\"comment:21\" align=\"right\">comment:21</div>\n\nReplying to [@nexttime](#comment%3A17):\n> Can someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)\n\nI agree this certainly needs to be tested.",
    "created_at": "2010-09-11T12:55:09Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88521",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:21" align="right">comment:21</div>

Replying to [@nexttime](#comment%3A17):
> Can someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)

I agree this certainly needs to be tested.



---

archive/issue_comments_088522.json:
```json
{
    "body": "patch for the PARI spkg with upstream fix and some cleanup",
    "created_at": "2010-09-11T13:10:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88522",
    "user": "https://github.com/jdemeyer"
}
```

patch for the PARI spkg with upstream fix and some cleanup



---

archive/issue_comments_088523.json:
```json
{
    "body": "<div id=\"comment:22\" align=\"right\">comment:22</div>\n\nAttachment: **[pari.p6.patch.gz](https://github.com/sagemath/sage/files/ticket9876/pari.p6.patch.gz)**\n\nReplying to [@nexttime](#comment%3A19):\n> Jeroen, could you also extend the message printed when `SAGE_TUNE_PARI=yes` to strongly recommend running PARI's test suite after tuning?\n> \n> \n> ---\n> \n> I'd prefer prepending `./` to `Configure`, since this will give an *appropriate* error message in any case where `src/Configure` does (for whatever reason) not exist.\n\nDone. New spkg, same place: [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg)",
    "created_at": "2010-09-11T13:11:16Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88523",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:22" align="right">comment:22</div>

Attachment: **[pari.p6.patch.gz](https://github.com/sagemath/sage/files/ticket9876/pari.p6.patch.gz)**

Replying to [@nexttime](#comment%3A19):
> Jeroen, could you also extend the message printed when `SAGE_TUNE_PARI=yes` to strongly recommend running PARI's test suite after tuning?
> 
> 
> ---
> 
> I'd prefer prepending `./` to `Configure`, since this will give an *appropriate* error message in any case where `src/Configure` does (for whatever reason) not exist.

Done. New spkg, same place: [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg)



---

archive/issue_comments_088524.json:
```json
{
    "body": "<div id=\"comment:23\" align=\"right\">comment:23</div>\n\nReplying to [@jdemeyer](#comment%3A21):\n> Replying to [@nexttime](#comment%3A17):\n> > Can someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)\n\n> \n> I agree this certainly needs to be tested.\n\nWell, the incapability of 10.4's linker / loader to handle common symbols in conjunction with dynamic libraries is completely unrelated to the processor architecture; I doubt the one used on Intel processors in 10.4 will differ much from the one on PowerPCs. (PPC may imply Darwin 8, but not the other way around.)\n\nSo I'd prefer keeping *our* patch (which is already well-tested), or modify it to add a distinction on the Darwin release (<code>\\`uname -r\\`</code>, see above).",
    "created_at": "2010-09-11T14:20:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88524",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:23" align="right">comment:23</div>

Replying to [@jdemeyer](#comment%3A21):
> Replying to [@nexttime](#comment%3A17):
> > Can someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)

> 
> I agree this certainly needs to be tested.

Well, the incapability of 10.4's linker / loader to handle common symbols in conjunction with dynamic libraries is completely unrelated to the processor architecture; I doubt the one used on Intel processors in 10.4 will differ much from the one on PowerPCs. (PPC may imply Darwin 8, but not the other way around.)

So I'd prefer keeping *our* patch (which is already well-tested), or modify it to add a distinction on the Darwin release (<code>\`uname -r\`</code>, see above).



---

archive/issue_comments_088525.json:
```json
{
    "body": "<div id=\"comment:24\" align=\"right\">comment:24</div>\n\nThe new spkg works (with SAGE_CHECK=yes) on t2.math.",
    "created_at": "2010-09-11T17:15:42Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88525",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:24" align="right">comment:24</div>

The new spkg works (with SAGE_CHECK=yes) on t2.math.



---

archive/issue_comments_088526.json:
```json
{
    "body": "<div id=\"comment:25\" align=\"right\">comment:25</div>\n\nReplying to [@nexttime](#comment%3A23):\n> Well, the incapability of 10.4's linker / loader to handle common symbols in conjunction with dynamic libraries is completely unrelated to the processor architecture; I doubt the one used on Intel processors in 10.4 will differ much from the one on PowerPCs. (PPC may imply Darwin 8, but not the other way around.)\n\nI sent an email to the PARI people about this, let's see what they say.",
    "created_at": "2010-09-12T08:16:34Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88526",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:25" align="right">comment:25</div>

Replying to [@nexttime](#comment%3A23):
> Well, the incapability of 10.4's linker / loader to handle common symbols in conjunction with dynamic libraries is completely unrelated to the processor architecture; I doubt the one used on Intel processors in 10.4 will differ much from the one on PowerPCs. (PPC may imply Darwin 8, but not the other way around.)

I sent an email to the PARI people about this, let's see what they say.



---

archive/issue_comments_088527.json:
```json
{
    "body": "<div id=\"comment:26\" align=\"right\">comment:26</div>\n\nReplying to [@jdemeyer](#comment%3A21):\n> Replying to [@nexttime](#comment%3A17):\n> > Can someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)\n\n> \n> I agree this certainly needs to be tested.\n\nGeorg, perhaps you could confirm that `-fno-common` is also needed on MacOS X 10.4 **Intel** machines? (Or the opposite, but to me that's unlikely.)\n\nIt should be sufficient to just try\n\n```sh\n$ cd .../pari-2.4.3.svn-12577.p6/src\n$ ./Configure --graphic=none\n$ make gp\n```\n(with http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg)",
    "created_at": "2010-09-17T15:55:53Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88527",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:26" align="right">comment:26</div>

Replying to [@jdemeyer](#comment%3A21):
> Replying to [@nexttime](#comment%3A17):
> > Can someone test the new spkg on MacOS X 10.**4** **Intel**? (The upstream fix only adds `-fno-common` on PPCs, not *Tiger* in general, which is afaik wrong.)

> 
> I agree this certainly needs to be tested.

Georg, perhaps you could confirm that `-fno-common` is also needed on MacOS X 10.4 **Intel** machines? (Or the opposite, but to me that's unlikely.)

It should be sufficient to just try

```sh
$ cd .../pari-2.4.3.svn-12577.p6/src
$ ./Configure --graphic=none
$ make gp
```
(with http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg)



---

archive/issue_comments_088528.json:
```json
{
    "body": "<div id=\"comment:27\" align=\"right\">comment:27</div>\n\nThe error we previously got on MacOS X 10.4 **PPC** looked like this:\n\n```\n/usr/bin/gcc  -o \"/Users/jdemeyer/pari-2.4.3.svn-12577/src/Odarwin-ppc\"/libpari-2.4.dylib -dynamiclib  -O3 -Wall -fno-strict-aliasing -fomit-frame-pointer    -fPIC -Wl,-flat_namespace,-undefined,suppress  mp.o mpinl.o F2x.o FF.o Flx.o FpE.o FpV.o FpX.o Qfb.o RgV.o RgX.o ZV.o ZX.o alglin1.o alglin2.o arith1.o arith2.o base1.o base2.o base3.o base4.o base5.o bb_group.o bibli1.o bibli2.o bit.o buch1.o buch2.o buch3.o buch4.o concat.o ellanal.o elliptic.o galconj.o gen1.o gen2.o gen3.o hnf_snf.o ifactor1.o lll.o perm.o polarit1.o polarit2.o polarit3.o prime.o random.o rootpol.o subcyclo.o subgroup.o trans1.o trans2.o trans3.o anal.o compat.o compile.o default.o errmsg.o es.o eval.o hash.o init.o intnum.o members.o pariinl.o parse.o sumiter.o DedekZeta.o Hensel.o QX_factor.o aprcl.o elldata.o ellsea.o galois.o galpol.o groupid.o krasner.o kummer.o mpqs.o nffactor.o part.o stark.o subfield.o thue.o darwin.o\nld: common symbols not allowed with MH_DYLIB output format with the -multi_module option\ninit.o definition of common _DEBUGMEM (size 4)\ninit.o definition of common _avma (size 4)\ninit.o definition of common _bot (size 4)\n[...]\nes.o definition of common _pariErr (size 4)\nes.o definition of common _pariOut (size 4)\ninit.o definition of common _pari_errfile (size 4)\ninit.o definition of common _pari_infile (size 4)\ninit.o definition of common _pari_outfile (size 4)\ninit.o definition of common _cb_pari_err_recover (size 4)\ninit.o definition of common _foreignFuncFree (size 4)\ninit.o definition of common _cb_pari_handle_exception (size 4)\ninit.o definition of common _cb_pari_sigint (size 4)\ninit.o definition of common _cb_pari_whatnow (size 4)\ninit.o definition of common _foreignExprHandler (size 4)\ninit.o definition of common _foreignHandler (size 4)\ninit.o definition of common _memused (size 4)\n/usr/bin/libtool: internal link edit command failed\nmake[1]: *** [libpari-2.4.dylib] Error 1\nmake: *** [gp] Error 2\n```",
    "created_at": "2010-09-17T16:14:12Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88528",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:27" align="right">comment:27</div>

The error we previously got on MacOS X 10.4 **PPC** looked like this:

```
/usr/bin/gcc  -o "/Users/jdemeyer/pari-2.4.3.svn-12577/src/Odarwin-ppc"/libpari-2.4.dylib -dynamiclib  -O3 -Wall -fno-strict-aliasing -fomit-frame-pointer    -fPIC -Wl,-flat_namespace,-undefined,suppress  mp.o mpinl.o F2x.o FF.o Flx.o FpE.o FpV.o FpX.o Qfb.o RgV.o RgX.o ZV.o ZX.o alglin1.o alglin2.o arith1.o arith2.o base1.o base2.o base3.o base4.o base5.o bb_group.o bibli1.o bibli2.o bit.o buch1.o buch2.o buch3.o buch4.o concat.o ellanal.o elliptic.o galconj.o gen1.o gen2.o gen3.o hnf_snf.o ifactor1.o lll.o perm.o polarit1.o polarit2.o polarit3.o prime.o random.o rootpol.o subcyclo.o subgroup.o trans1.o trans2.o trans3.o anal.o compat.o compile.o default.o errmsg.o es.o eval.o hash.o init.o intnum.o members.o pariinl.o parse.o sumiter.o DedekZeta.o Hensel.o QX_factor.o aprcl.o elldata.o ellsea.o galois.o galpol.o groupid.o krasner.o kummer.o mpqs.o nffactor.o part.o stark.o subfield.o thue.o darwin.o
ld: common symbols not allowed with MH_DYLIB output format with the -multi_module option
init.o definition of common _DEBUGMEM (size 4)
init.o definition of common _avma (size 4)
init.o definition of common _bot (size 4)
[...]
es.o definition of common _pariErr (size 4)
es.o definition of common _pariOut (size 4)
init.o definition of common _pari_errfile (size 4)
init.o definition of common _pari_infile (size 4)
init.o definition of common _pari_outfile (size 4)
init.o definition of common _cb_pari_err_recover (size 4)
init.o definition of common _foreignFuncFree (size 4)
init.o definition of common _cb_pari_handle_exception (size 4)
init.o definition of common _cb_pari_sigint (size 4)
init.o definition of common _cb_pari_whatnow (size 4)
init.o definition of common _foreignExprHandler (size 4)
init.o definition of common _foreignHandler (size 4)
init.o definition of common _memused (size 4)
/usr/bin/libtool: internal link edit command failed
make[1]: *** [libpari-2.4.dylib] Error 1
make: *** [gp] Error 2
```



---

archive/issue_comments_088529.json:
```json
{
    "body": "<div id=\"comment:28\" align=\"right\">comment:28</div>\n\nReplying to [@jdemeyer](#comment%3A25):\n> I sent an email to the PARI people about this, let's see what they say.\n\nI haven't had much luck, see [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1088](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1088):\n\nBill Allombert wrote:\n> Jeroen Demeyer wrote:\n> > In that case, I strongly recommend you to apply the patch to ALL darwin\n> > architectures, not just ppc/ppc64.\n\n> Why ? Is there any documentation that recommend that ? gcc documentation certainly does not.\n\nI do agree with leif though, I will prepare a .p7 with the fix.",
    "created_at": "2010-09-17T20:10:22Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88529",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:28" align="right">comment:28</div>

Replying to [@jdemeyer](#comment%3A25):
> I sent an email to the PARI people about this, let's see what they say.

I haven't had much luck, see [http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1088](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1088):

Bill Allombert wrote:
> Jeroen Demeyer wrote:
> > In that case, I strongly recommend you to apply the patch to ALL darwin
> > architectures, not just ppc/ppc64.

> Why ? Is there any documentation that recommend that ? gcc documentation certainly does not.

I do agree with leif though, I will prepare a .p7 with the fix.



---

archive/issue_comments_088530.json:
```json
{
    "body": "<div id=\"comment:29\" align=\"right\">comment:29</div>\n\nReplying to [@jdemeyer](#comment%3A28):\n> I do agree with leif though, I will prepare a .p7 with the fix.\n\nNew spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg)",
    "created_at": "2010-09-19T08:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88530",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:29" align="right">comment:29</div>

Replying to [@jdemeyer](#comment%3A28):
> I do agree with leif though, I will prepare a .p7 with the fix.

New spkg: [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg)



---

archive/issue_comments_088531.json:
```json
{
    "body": "Description changed:\n``````diff\n--- \n+++ \n@@ -18,5 +18,5 @@\n \n I get a failure in rnfkummer (both sta and dyn), I am attaching the dif and the output of Configure.\n \n-* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg) (see also `pari.p6.patch` below)\n+* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg) (see also `pari.p7.patch` below)\n * **sagelib patch:** `9876_doctest.patch`\n``````\n",
    "created_at": "2010-09-19T08:46:52Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88531",
    "user": "https://github.com/jdemeyer"
}
```

Description changed:
``````diff
--- 
+++ 
@@ -18,5 +18,5 @@
 
 I get a failure in rnfkummer (both sta and dyn), I am attaching the dif and the output of Configure.
 
-* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p6.spkg) (see also `pari.p6.patch` below)
+* **New pari spkg:** [http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg](http://sage.math.washington.edu/home/jdemeyer/spkg/pari-2.4.3.svn-12577.p7.spkg) (see also `pari.p7.patch` below)
 * **sagelib patch:** `9876_doctest.patch`
``````




---

archive/issue_comments_088532.json:
```json
{
    "body": "Attachment: **[pari.p7.patch.gz](https://github.com/sagemath/sage/files/ticket9876/pari.p7.patch.gz)**\n\nPatch for the PARI spkg .p6 to .p7",
    "created_at": "2010-09-19T08:47:28Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88532",
    "user": "https://github.com/jdemeyer"
}
```

Attachment: **[pari.p7.patch.gz](https://github.com/sagemath/sage/files/ticket9876/pari.p7.patch.gz)**

Patch for the PARI spkg .p6 to .p7



---

archive/issue_comments_088533.json:
```json
{
    "body": "<div id=\"comment:30\" align=\"right\">comment:30</div>\n\nI think this is ready for review now.  The original issue seems to be fixed and the `get_dlcflags` change has been reverted.",
    "created_at": "2010-09-19T16:52:11Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88533",
    "user": "https://github.com/jdemeyer"
}
```

<div id="comment:30" align="right">comment:30</div>

I think this is ready for review now.  The original issue seems to be fixed and the `get_dlcflags` change has been reverted.



---

archive/issue_comments_088534.json:
```json
{
    "body": "<div id=\"comment:31\" align=\"right\">comment:31</div>\n\nI've again tested the latest p7 (which includes only minor* changes w.r.t. the p6) and the new Sage library patch (additional regression doctest) on Ubuntu 10.04 x86_64 (`ptestlong` run twice, the second time with #9898 applied and the lcalc p5 spkg from #9845). (Also, the new spkg is \"sane\".)\n\nSince Jeroen has already successfully tested it on a PPC Mac (big-endian), and John on t2.math (I assume in 32-bit big-endian mode), and the patch to `get_dlcflags` has been reverted to what we already tested (which definitely works on MacOS X 10.**4** **Intel**, too), I set this to \"positive review\".\n\n---\n*Although I must admit I haven't yet verified that the newly updated upstream source files claiming to fix [PARI bug #1079](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1079) achieve the same as the previously applied Sage patches (\"segmentation fault in `rnfequation(,,1)` over Q\").",
    "created_at": "2010-09-19T23:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88534",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:31" align="right">comment:31</div>

I've again tested the latest p7 (which includes only minor* changes w.r.t. the p6) and the new Sage library patch (additional regression doctest) on Ubuntu 10.04 x86_64 (`ptestlong` run twice, the second time with #9898 applied and the lcalc p5 spkg from #9845). (Also, the new spkg is "sane".)

Since Jeroen has already successfully tested it on a PPC Mac (big-endian), and John on t2.math (I assume in 32-bit big-endian mode), and the patch to `get_dlcflags` has been reverted to what we already tested (which definitely works on MacOS X 10.**4** **Intel**, too), I set this to "positive review".

---
*Although I must admit I haven't yet verified that the newly updated upstream source files claiming to fix [PARI bug #1079](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1079) achieve the same as the previously applied Sage patches ("segmentation fault in `rnfequation(,,1)` over Q").



---

archive/issue_events_127030.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-19T23:24:55Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/needs%20review",
    "label_color": "7fff00",
    "label_name": "needs review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127030"
}
```



---

archive/issue_events_127031.json:
```json
{
    "actor": "https://github.com/nexttime",
    "created_at": "2010-09-19T23:24:55Z",
    "event": "labeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127031"
}
```



---

archive/issue_comments_088535.json:
```json
{
    "body": "Reviewer: **John Palmieri, Leif Leonhardy**",
    "created_at": "2010-09-19T23:24:55Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88535",
    "user": "https://github.com/nexttime"
}
```

Reviewer: **John Palmieri, Leif Leonhardy**



---

archive/issue_comments_088536.json:
```json
{
    "body": "<div id=\"comment:32\" align=\"right\">comment:32</div>\n\nReplying to [@nexttime](#comment%3A31):\n> I haven't yet verified that the newly updated upstream source files claiming to fix [PARI bug #1079](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1079) achieve the same as the previously applied Sage patches [...]\n\nAs far as I can tell they do. (And do not introduce other changes.)",
    "created_at": "2010-09-20T00:44:15Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88536",
    "user": "https://github.com/nexttime"
}
```

<div id="comment:32" align="right">comment:32</div>

Replying to [@nexttime](#comment%3A31):
> I haven't yet verified that the newly updated upstream source files claiming to fix [PARI bug #1079](http://pari.math.u-bordeaux.fr/cgi-bin/bugreport.cgi?bug=1079) achieve the same as the previously applied Sage patches [...]

As far as I can tell they do. (And do not introduce other changes.)



---

archive/issue_comments_088537.json:
```json
{
    "body": "<div id=\"comment:33\" align=\"right\">comment:33</div>\n\nI also tested this again on t2 (32-bit) and also an a 10.6 OS X Intel Mac, just to make sure the new Darwin-only changes didn't mess that up.  No problems in either case.",
    "created_at": "2010-09-20T01:49:08Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88537",
    "user": "https://github.com/jhpalmieri"
}
```

<div id="comment:33" align="right">comment:33</div>

I also tested this again on t2 (32-bit) and also an a 10.6 OS X Intel Mac, just to make sure the new Darwin-only changes didn't mess that up.  No problems in either case.



---

archive/issue_comments_088538.json:
```json
{
    "body": "Merged: **sage-4.6.alpha2**",
    "created_at": "2010-09-29T08:40:07Z",
    "formatter": "markdown",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sage/issues/9876#issuecomment-88538",
    "user": "https://github.com/qed777"
}
```

Merged: **sage-4.6.alpha2**



---

archive/issue_events_127032.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-29T08:40:07Z",
    "event": "unlabeled",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "label": "https://github.com/sagemath/sage/labels/positive%20review",
    "label_color": "dfffc0",
    "label_name": "positive review",
    "label_text_color": "ffffff",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127032"
}
```



---

archive/issue_events_127033.json:
```json
{
    "actor": "https://github.com/qed777",
    "created_at": "2010-09-29T08:40:07Z",
    "event": "closed",
    "issue": "https://github.com/sagemath/sage/issues/9876",
    "type": "issue_event",
    "url": "https://github.com/sagemath/sage/issues/9876#event-127033"
}
```
