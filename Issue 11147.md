# Issue 11147: Cannot create homomorphism from prime residue field to finite field

Issue created by migration from Trac.

Original creator: johanbosman

Original creation time: 2011-05-09 16:53:34

Assignee: robertwb

Keywords: residue fields, finite fields, hom

Consider K = QQ(sqrt(337)).  The prime 5 is inert in K and the prime 13 splits.  We'll start with 13 to see what goes wrong:

```
sage: K.<w> = QuadraticField(337)
sage: pp = K.ideal(13).factor()[0][0]
sage: RF13 = K.residue_field(pp)
sage: RF13.gens()
(1,)
sage: RF13.hom([GF(13)(1)])
...
TypeError: images do not define a valid homomorphism
```

However, for residue fields that aren't prime fields it does work:

```
sage: RF5 = K.residue_field(5)
sage: F25 = GF(25, names='a', modulus=RF5.polynomial())
sage: RF5.hom([F25.0])
Ring morphism:
  From: Residue field in wbar of Fractional ideal (5)
  To:   Finite Field in a of size 5^2
  Defn: wbar |--> a
```



---

Attachment


---

Comment by johanbosman created at 2011-05-10 16:51:25

Changing status from new to needs_review.


---

Comment by aly.deines created at 2011-05-11 16:04:21

I was trying out the patch, and the following example didn't work out like I expected:

```
sage: K
Number Field in a with defining polynomial x^3 - 2
sage: K.<a> = NumberField(x^3-2)
sage: P = K.ideal(7)
sage: P.factor()
Fractional ideal (7)
sage: k = P.residue_field()
sage: k.order()
343
sage: F.<b> = GF(343)
sage: F.order()
343
sage: k
Residue field in abar of Fractional ideal (7)
sage: F
Finite Field in b of size 7^3
sage: k.hom([F(1)])
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)

/Users/aly/Desktop/sage-4.7.rc2/<ipython console> in <module>()

/Users/aly/Desktop/sage-4.7.rc2/local/lib/python2.6/site-packages/sage/structure/parent_gens.so in sage.structure.parent_gens.ParentWithGens.hom (sage/structure/parent_gens.c:3792)()

/Users/aly/Desktop/sage-4.7.rc2/local/lib/python2.6/site-packages/sage/structure/parent.so in sage.structure.parent.Parent.hom (sage/structure/parent.c:9067)()

/Users/aly/Desktop/sage-4.7.rc2/local/lib/python2.6/site-packages/sage/rings/finite_rings/homset.pyc in __call__(self, im_gens, check)
     49                 return self._coerce_impl(im_gens)
     50             except TypeError:
---> 51                 raise TypeError, "images do not define a valid homomorphism"
     52         
     53     def _coerce_impl(self, x):

TypeError: images do not define a valid homomorphism   
sage: k.has_coerce_map_from(F)
False

```


Should this patch fix this as well?


---

Comment by aly.deines created at 2011-05-11 16:04:21

Changing status from needs_review to needs_work.


---

Comment by johanbosman created at 2011-05-11 16:12:54

In your example, you're trying to send the generator of k to the element 1 of F, which does indeed not define a field homomorphism.  This does work:

```
sage: root = k.polynomial().roots(F)[0][0]
sage: k.hom([root])
Ring morphism:
  From: Residue field in abar of Fractional ideal (7)
  To:   Finite Field in b of size 7^3
  Defn: abar |--> 4*b^2 + 4*b + 2
```



---

Comment by johanbosman created at 2011-05-11 16:12:54

Changing status from needs_work to needs_review.


---

Comment by kedlaya created at 2011-06-18 13:45:35

Changing status from needs_review to positive_review.


---

Comment by kedlaya created at 2011-06-18 13:45:35

Looks fine, applies against 4.7, no long doctest failures.


---

Comment by jdemeyer created at 2011-06-21 13:16:41

I think the new patch is a bit low on examples.  For example, the ticket mentions number fields, so why not add a number field example?


---

Comment by jdemeyer created at 2011-06-21 13:16:41

Changing status from positive_review to needs_work.


---

Attachment

To be used on top of the first patch


---

Comment by johanbosman created at 2011-08-02 16:11:12

Changing status from needs_work to needs_review.


---

Comment by johanbosman created at 2011-08-02 16:11:12

Example added. ;)


---

Comment by mkosters created at 2011-12-19 11:12:45

Changing status from needs_review to positive_review.


---

Comment by jdemeyer created at 2011-12-29 07:03:27

Resolution: fixed


---

Comment by mstreng created at 2012-01-05 13:07:29

Changing keywords from "residue fields, finite fields, hom" to "residue fields, finite fields, hom, sd35".
