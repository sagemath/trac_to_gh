# Issue 25679: implement Packed Words

archive/issues_025679.json:
```json
{
    "body": "CC:  @tscrim @darijgr @zabrocki @alauve amypang hmlodecki fhivert vivianepons @mathzeta\n\nKeywords: sagedays@icerm, packed words, CHAs\n\nCombinatorial class of packed words\n\nThese object are trivially in bijection with Ordered set partitions. (counted by the Fubini numbers (A000670))\n\n(use in the Hopf algebra WQSym)\n\nThis ticket is a replacement for the old ticket #15611 which should be closed.\n\nIssue created by migration from https://trac.sagemath.org/ticket/25916\n\n",
    "created_at": "2018-07-24T17:30:47Z",
    "labels": [
        "component: combinatorics",
        "minor"
    ],
    "milestone": "https://github.com/sagemath/sagetest/milestones/sage-8.4",
    "title": "implement Packed Words",
    "type": "issue",
    "url": "https://github.com/sagemath/sagetest/issues/25679",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```
CC:  @tscrim @darijgr @zabrocki @alauve amypang hmlodecki fhivert vivianepons @mathzeta

Keywords: sagedays@icerm, packed words, CHAs

Combinatorial class of packed words

These object are trivially in bijection with Ordered set partitions. (counted by the Fubini numbers (A000670))

(use in the Hopf algebra WQSym)

This ticket is a replacement for the old ticket #15611 which should be closed.

Issue created by migration from https://trac.sagemath.org/ticket/25916





---

archive/issue_comments_361883.json:
```json
{
    "body": "Attachment [packed_words.py](tarball://root/attachments/some-uuid/ticket25916/packed_words.py) by hmlodecki created at 2018-07-24 17:32:14",
    "created_at": "2018-07-24T17:32:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361883",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Attachment [packed_words.py](tarball://root/attachments/some-uuid/ticket25916/packed_words.py) by hmlodecki created at 2018-07-24 17:32:14



---

archive/issue_comments_361884.json:
```json
{
    "body": "Add branch",
    "created_at": "2018-07-24T17:51:39Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361884",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Add branch



---

archive/issue_comments_361885.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-24T18:08:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361885",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361886.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-24T20:16:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361886",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361887.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-25T13:52:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361887",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361888.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-25T13:59:07Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361888",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361889.json:
```json
{
    "body": "Changing status from new to needs_review.",
    "created_at": "2018-07-25T14:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361889",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Changing status from new to needs_review.



---

archive/issue_comments_361890.json:
```json
{
    "body": "Left weak order and right weak order will be useful for some basis in WQSym",
    "created_at": "2018-07-25T14:00:56Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361890",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Left weak order and right weak order will be useful for some basis in WQSym



---

archive/issue_comments_361891.json:
```json
{
    "body": "I can't provide any useful feedback on the math, but here are a few minor nitpicks:\n\n\n```diff\n+#       Copyright (C) 2012 Jean-Baptiste Priez <jbp@kerios.fr>,\n```\n\n\nI assume you'll want to update this to 2018\n\n\n```diff\n+    :func:`sage.combinat.permutation.to_standard`) for *packed words*.\n+    EXEMPLES::\n```\n\n\nEXEMPLES -> EXAMPLES; also I think normally there should be an additional blank line before the \"EXAMPLES\" heading.\n\n\n```diff\n+    for set in li:\n+        for p in set:\n+            dic[p] = i\n+        i += 1\n```\n\n\nPlease try to avoid using Python built-ins like `set` as a variable name.  It's reasonably unambiguous here, but can still be confusing (especially to editors).  If you're hell-bend on naming the variable \"set\", I'll sometimes do something like `_set` or `set_`.\n\n\n```diff\n+    return PackedWord(dic.values())\n```\n\n\nFor Python 3 compatibility please make sure that `PackedWord` can accept an arbitrary iterable its argument.  I believe this might already be the case for `ClonableArray` and subclasses thereof, but I'm not positive.  Otherwise, this would have be something like `list(dic.values())` unfortunately.\n\n\n```diff\n+            #sage: PackedWord([2,2,1,0,4])\n+            #Traceback (most recent call last)\n+            #...\n+            #AssertionError: This is not a packed word\n```\n\nthis is commented out for some reason?\n\n\n```diff\n+        assert(len(s) == 0 or (max(s) == len(s) and min(s) == 1)\n+            ), \"This is not a packed word %s\" % str(self)\n```\n\n\n`str(self)` is unnecessary; it can just be `self` (the `str()` is implied by the `%s` format code).  I think we're mostly preferring new-style string formatting these days, but I don't think there's a policy either way.\n\n\n```diff\n+        import collections\n```\n\n\nPlease avoid in-line imports unless it's absolutely necessary.  I guarantee `collections` is already being imported elsewhere in Sage, so there's no reason not to put it at the top-level of the module.\n\nThere are some other in-line imports elsewhere you might want to check on.  For imports from Sage this is sometimes more necessary to avoid circular imports or slow import times, though a lot of that can also be avoided using `LazyImport` instead.\n\n\n```diff\n+        return [Set(d[k]) for k in sorted(d.keys())]\n```\n\n\n`.keys()` is unnecessary here; just `sorted(d)` will work.\n\n\n```diff\n+    def combinatorial_class_of_size(self, size):\n+        assert(size >= 0), \"size (%d) must be a positive integer\" % size\n+        return PackedWords(size)\n```\n\n\nMissing docstring here.\n\n\n```diff\n+        if res.size() != self._size:\n+            raise ValueError, \"Wrong size of word\"\n+        return res\n```\n\n\nThis is old-style `raise` syntax which should not be used.  Instead use `raise ValueError(\"Wrong size of word\")`.\n\nGeneral comment: Please also use spaces around operators such as `>` and `+` and after commas more often than not, in PEP-8 style.",
    "created_at": "2018-07-25T15:56:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361891",
    "user": "https://github.com/embray"
}
```

I can't provide any useful feedback on the math, but here are a few minor nitpicks:


```diff
+#       Copyright (C) 2012 Jean-Baptiste Priez <jbp@kerios.fr>,
```


I assume you'll want to update this to 2018


```diff
+    :func:`sage.combinat.permutation.to_standard`) for *packed words*.
+    EXEMPLES::
```


EXEMPLES -> EXAMPLES; also I think normally there should be an additional blank line before the "EXAMPLES" heading.


```diff
+    for set in li:
+        for p in set:
+            dic[p] = i
+        i += 1
```


Please try to avoid using Python built-ins like `set` as a variable name.  It's reasonably unambiguous here, but can still be confusing (especially to editors).  If you're hell-bend on naming the variable "set", I'll sometimes do something like `_set` or `set_`.


```diff
+    return PackedWord(dic.values())
```


For Python 3 compatibility please make sure that `PackedWord` can accept an arbitrary iterable its argument.  I believe this might already be the case for `ClonableArray` and subclasses thereof, but I'm not positive.  Otherwise, this would have be something like `list(dic.values())` unfortunately.


```diff
+            #sage: PackedWord([2,2,1,0,4])
+            #Traceback (most recent call last)
+            #...
+            #AssertionError: This is not a packed word
```

this is commented out for some reason?


```diff
+        assert(len(s) == 0 or (max(s) == len(s) and min(s) == 1)
+            ), "This is not a packed word %s" % str(self)
```


`str(self)` is unnecessary; it can just be `self` (the `str()` is implied by the `%s` format code).  I think we're mostly preferring new-style string formatting these days, but I don't think there's a policy either way.


```diff
+        import collections
```


Please avoid in-line imports unless it's absolutely necessary.  I guarantee `collections` is already being imported elsewhere in Sage, so there's no reason not to put it at the top-level of the module.

There are some other in-line imports elsewhere you might want to check on.  For imports from Sage this is sometimes more necessary to avoid circular imports or slow import times, though a lot of that can also be avoided using `LazyImport` instead.


```diff
+        return [Set(d[k]) for k in sorted(d.keys())]
```


`.keys()` is unnecessary here; just `sorted(d)` will work.


```diff
+    def combinatorial_class_of_size(self, size):
+        assert(size >= 0), "size (%d) must be a positive integer" % size
+        return PackedWords(size)
```


Missing docstring here.


```diff
+        if res.size() != self._size:
+            raise ValueError, "Wrong size of word"
+        return res
```


This is old-style `raise` syntax which should not be used.  Instead use `raise ValueError("Wrong size of word")`.

General comment: Please also use spaces around operators such as `>` and `+` and after commas more often than not, in PEP-8 style.



---

archive/issue_comments_361892.json:
```json
{
    "body": "For py3 compatibiity:\n\n* do not use it.next() but instead next(it)\n\n* do not use xrange but range",
    "created_at": "2018-07-25T18:26:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361892",
    "user": "https://github.com/fchapoton"
}
```

For py3 compatibiity:

* do not use it.next() but instead next(it)

* do not use xrange but range



---

archive/issue_comments_361893.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-25T19:17:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361893",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361894.json:
```json
{
    "body": "For the copyright, I didn't change because some functions are comming from Jean-Baptiste Priez and he wrote it in 2012.\nFor \"PackedWord(dic.values())\" I checked that the following thing works, is that a good check?\nsage: PackedWord(xrange(1,5))\n[1, 2, 3, 4]",
    "created_at": "2018-07-25T19:21:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361894",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

For the copyright, I didn't change because some functions are comming from Jean-Baptiste Priez and he wrote it in 2012.
For "PackedWord(dic.values())" I checked that the following thing works, is that a good check?
sage: PackedWord(xrange(1,5))
[1, 2, 3, 4]



---

archive/issue_comments_361895.json:
```json
{
    "body": "* I think it would be better to avoid `Set` in library code.  It comes with great performance penalty.\n\n* A proposal for a replacement of the introductory text:\n\n```\nPacked words are a way to represent ordered set partitions.\nA word `w` with letters in `\\{1,...,n\\}` is a packed word if for each number `k > 1` appearing in `w`, the number `k - 1` appears in `w` too.\n\nThus, `w` can be obtained from an ordered set partition by setting `w_i=j` if `i` belongs to the `j`-th block.\n```\n",
    "created_at": "2018-07-25T20:15:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361895",
    "user": "https://github.com/mantepse"
}
```

* I think it would be better to avoid `Set` in library code.  It comes with great performance penalty.

* A proposal for a replacement of the introductory text:

```
Packed words are a way to represent ordered set partitions.
A word `w` with letters in `\{1,...,n\}` is a packed word if for each number `k > 1` appearing in `w`, the number `k - 1` appears in `w` too.

Thus, `w` can be obtained from an ordered set partition by setting `w_i=j` if `i` belongs to the `j`-th block.
```




---

archive/issue_comments_361896.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-25T21:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361896",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361897.json:
```json
{
    "body": "Also, anytime you have latex code, you should make the string \"raw\" by starting the (doc)strings with `r\"\"\"`.",
    "created_at": "2018-07-26T12:33:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361897",
    "user": "https://github.com/tscrim"
}
```

Also, anytime you have latex code, you should make the string "raw" by starting the (doc)strings with `r"""`.



---

archive/issue_comments_361898.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-26T14:59:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361898",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361899.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-26T23:05:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361899",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361900.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-26T23:22:38Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361900",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361901.json:
```json
{
    "body": "Minor docstring comments:\n\n* Lots of docstrings that should be sentences are missing periods.\n\n* check() method docstring should be 'Check that' not 'Checks that' (there may be a few other minor grammatical things like that).\n\n* to_ordered_set_partition() docstring should start 'Build an' not 'This method build an'\n\n* to_composition() should mention what a parikh vector is.\n\n* In the docstrings for inversion and coinversions, I'm not sure if the use of the individual character for an exponentiated 2 will work in general\n\n*left_weak_order_greater docstring should say 'information' not 'informations'\n\n* packed_word_size __init__ method doesn't have a doctest.",
    "created_at": "2018-07-27T13:55:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361901",
    "user": "https://github.com/kevindilks"
}
```

Minor docstring comments:

* Lots of docstrings that should be sentences are missing periods.

* check() method docstring should be 'Check that' not 'Checks that' (there may be a few other minor grammatical things like that).

* to_ordered_set_partition() docstring should start 'Build an' not 'This method build an'

* to_composition() should mention what a parikh vector is.

* In the docstrings for inversion and coinversions, I'm not sure if the use of the individual character for an exponentiated 2 will work in general

*left_weak_order_greater docstring should say 'information' not 'informations'

* packed_word_size __init__ method doesn't have a doctest.



---

archive/issue_comments_361902.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-07-27T22:19:14Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361902",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361903.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-08-10T02:41:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361903",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361904.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-08-10T02:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361904",
    "user": "https://github.com/tscrim"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_361905.json:
```json
{
    "body": "I have rewritten some parts of the code to directly use some of the feature of the base classes and category you are using. I also made a bunch of doc related fixes and improvements. However, the definition of a left coinversion was exactly the same as that of an inversion. So that will need to be added (currently it is a `???`). Other than that, if my changes are good, then it will be a positive review (I think I have taken care of all of Kevin's comments).",
    "created_at": "2018-08-10T02:44:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361905",
    "user": "https://github.com/tscrim"
}
```

I have rewritten some parts of the code to directly use some of the feature of the base classes and category you are using. I also made a bunch of doc related fixes and improvements. However, the definition of a left coinversion was exactly the same as that of an inversion. So that will need to be added (currently it is a `???`). Other than that, if my changes are good, then it will be a positive review (I think I have taken care of all of Kevin's comments).



---

archive/issue_comments_361906.json:
```json
{
    "body": "missing blank line in the doc added inside src/sage/combinat/set_partition_ordered.py",
    "created_at": "2018-08-23T16:28:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361906",
    "user": "https://github.com/fchapoton"
}
```

missing blank line in the doc added inside src/sage/combinat/set_partition_ordered.py



---

archive/issue_comments_361907.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-25T20:34:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361907",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361908.json:
```json
{
    "body": "Back to needs review?",
    "created_at": "2018-09-25T22:41:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361908",
    "user": "https://github.com/tscrim"
}
```

Back to needs review?



---

archive/issue_comments_361909.json:
```json
{
    "body": "Let me have a \"pre review\" look first, Travis. Hugo and I are both in Montreal right now, so can go over some aspects of it together.",
    "created_at": "2018-09-26T03:33:45Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361909",
    "user": "https://github.com/alauve"
}
```

Let me have a "pre review" look first, Travis. Hugo and I are both in Montreal right now, so can go over some aspects of it together.



---

archive/issue_comments_361910.json:
```json
{
    "body": "First of all, thank you Travis for all the improvements.\n\nYour remarque on inversions make me rework on it. I think it is better to based it on 1 because it is that way on permutations and the coherence is important.\n\nAlso I have some other remarques and questions :\n* The terme **coinversion** is not good so I think it's better to name it **inversions_value_left**, **inversions_position_right**...\n* But now I'm realizing that it might be better to use options like //inversions(side=\"right\",support=\"position\")//. What do you think ?\n* An other question is : is it a good convention to return the (greater,lower) when thes are **values** and (lower,greater) when thes are **positions** ?",
    "created_at": "2018-09-26T18:46:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361910",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

First of all, thank you Travis for all the improvements.

Your remarque on inversions make me rework on it. I think it is better to based it on 1 because it is that way on permutations and the coherence is important.

Also I have some other remarques and questions :
* The terme **coinversion** is not good so I think it's better to name it **inversions_value_left**, **inversions_position_right**...
* But now I'm realizing that it might be better to use options like //inversions(side="right",support="position")//. What do you think ?
* An other question is : is it a good convention to return the (greater,lower) when thes are **values** and (lower,greater) when thes are **positions** ?



---

archive/issue_comments_361911.json:
```json
{
    "body": "I am not really sure. These things sound like they would have lots of convention choices depending on who you ask. I would just choose what convention you think is best (for your definition of best) and just clearly spell it out. If there are things in the literature (including what you might be writing), IMO it is generally better to stick to that.",
    "created_at": "2018-09-26T22:48:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361911",
    "user": "https://github.com/tscrim"
}
```

I am not really sure. These things sound like they would have lots of convention choices depending on who you ask. I would just choose what convention you think is best (for your definition of best) and just clearly spell it out. If there are things in the literature (including what you might be writing), IMO it is generally better to stick to that.



---

archive/issue_comments_361912.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-27T18:27:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361912",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361913.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-09-27T20:43:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361913",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361914.json:
```json
{
    "body": "Is this now ready for re-review?",
    "created_at": "2018-10-01T07:58:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361914",
    "user": "https://github.com/tscrim"
}
```

Is this now ready for re-review?



---

archive/issue_comments_361915.json:
```json
{
    "body": "Not yet. Close.",
    "created_at": "2018-10-01T11:45:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361915",
    "user": "https://github.com/alauve"
}
```

Not yet. Close.



---

archive/issue_comments_361916.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-02T23:01:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361916",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361917.json:
```json
{
    "body": "It remains some TODO mostly about `check`, `_element_constructor_` and `__contains__` or english improvements.\nI'll propose something tomorrow about the first point.",
    "created_at": "2018-10-02T23:06:43Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361917",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

It remains some TODO mostly about `check`, `_element_constructor_` and `__contains__` or english improvements.
I'll propose something tomorrow about the first point.



---

archive/issue_comments_361918.json:
```json
{
    "body": "Looks nice so far, Hugo. (I see a few small issues). Don't worry about english improvements. I'll handle these (and the small issues I alluded to) after your next push.\n\n*EDIT:* I should mention that if somebody else wants to chime-in about how `check`, `_element_constructor_` and `__contains__` should work in concert, now would be the time.",
    "created_at": "2018-10-02T23:25:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361918",
    "user": "https://github.com/alauve"
}
```

Looks nice so far, Hugo. (I see a few small issues). Don't worry about english improvements. I'll handle these (and the small issues I alluded to) after your next push.

*EDIT:* I should mention that if somebody else wants to chime-in about how `check`, `_element_constructor_` and `__contains__` should work in concert, now would be the time.



---

archive/issue_comments_361919.json:
```json
{
    "body": "I forgot to say that I'm also currently working on right and left weak order intervals.",
    "created_at": "2018-10-02T23:31:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361919",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

I forgot to say that I'm also currently working on right and left weak order intervals.



---

archive/issue_comments_361920.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-02T23:43:53Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361920",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361921.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-04T18:12:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361921",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361922.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-06T06:29:34Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361922",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361923.json:
```json
{
    "body": "I think this ticket is now ready for a deeper-than-superficial glance.\n\n**Two questions for Hugo:**\n\n* Is there a quick way to check whether or not something is greater / lesser\n   in right- or left-weak order? E.g., for ordinary weak order, `pi < sigma` if \n   the inversions of `pi` (or `pi.inverse()`) are a subset of that of `sigma` (or `sigma.inverse()`)\n\n* Doing some computations, it looks like the left and right posets are graded. Is that so? If so, I think it would be better to use `RecursivelyEnumeratedSet` to search for elements in the interval [u1, u2] instead of building all of `u1.right_weak_order_greater()`\n\nIf either of the above are true, then I believe you can speed-up your interval code.\n\nAnd **one question for others** regarding check/contains/element_constructor/eq:\n\n* is this the right convention?: \n   we want `a in B` is \"True\" if and only if `a == B(a)` is \"True\"   \n\nI didn't actually check this yet, but thought I'd ask.",
    "created_at": "2018-10-06T06:46:52Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361923",
    "user": "https://github.com/alauve"
}
```

I think this ticket is now ready for a deeper-than-superficial glance.

**Two questions for Hugo:**

* Is there a quick way to check whether or not something is greater / lesser
   in right- or left-weak order? E.g., for ordinary weak order, `pi < sigma` if 
   the inversions of `pi` (or `pi.inverse()`) are a subset of that of `sigma` (or `sigma.inverse()`)

* Doing some computations, it looks like the left and right posets are graded. Is that so? If so, I think it would be better to use `RecursivelyEnumeratedSet` to search for elements in the interval [u1, u2] instead of building all of `u1.right_weak_order_greater()`

If either of the above are true, then I believe you can speed-up your interval code.

And **one question for others** regarding check/contains/element_constructor/eq:

* is this the right convention?: 
   we want `a in B` is "True" if and only if `a == B(a)` is "True"   

I didn't actually check this yet, but thought I'd ask.



---

archive/issue_comments_361924.json:
```json
{
    "body": "For the first question, I don't know if there is, it is possible so I'll check that. \nFor the second, you are totally right, I'll change it.",
    "created_at": "2018-10-08T23:55:11Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361924",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

For the first question, I don't know if there is, it is possible so I'll check that. 
For the second, you are totally right, I'll change it.



---

archive/issue_comments_361925.json:
```json
{
    "body": "Replying to [comment:38 alauve]:\n> * is this the right convention?: \n>    we want `a in B` is \"True\" if and only if `a == B(a)` is \"True\"   \n\nWell, for `a == B(a)`, that also runs a coercion, so it (generically) roughly does `B(a) == B(a)`. What you are really after is does `B(a)` fail or not (but often `B(a)` does the containment check before proceeding).",
    "created_at": "2018-10-09T06:54:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361925",
    "user": "https://github.com/tscrim"
}
```

Replying to [comment:38 alauve]:
> * is this the right convention?: 
>    we want `a in B` is "True" if and only if `a == B(a)` is "True"   

Well, for `a == B(a)`, that also runs a coercion, so it (generically) roughly does `B(a) == B(a)`. What you are really after is does `B(a)` fail or not (but often `B(a)` does the containment check before proceeding).



---

archive/issue_comments_361926.json:
```json
{
    "body": "Replying to [comment:40 tscrim]:\n\n> Replying to [comment:38 alauve]:\n> > * is this the right convention?: \n> >    we want `a in B` is \"True\" if and only if `a == B(a)` is \"True\"   \n> \n> Well, for `a == B(a)`, that also runs a coercion, so it (generically) roughly does `B(a) == B(a)`. What you are really after is does `B(a)` fail or not (but often `B(a)` does the containment check before proceeding).\n.\n\nI'm not quite sure what I'm after, but thought the equality test might be part of the story...\n\nI see very different behavior within `Partitions`, `SetPartitions` and `OrderedSetPartitions`:\n\n\n```\nsage: [2,1] in Partitions()\nTrue\nsage: [{1,2},{3}] in SetPartitions()\nFalse\nsage: [[1,2],[3]] in OrderedSetPartitions()\nTrue\nsage: [[1,2],[3]] in OrderedSetPartitions(3)\nFalse\nsage: [set([1,2]), set([3])] in OrderedSetPartitions(3)\nTypeError: X (=set([1, 2])) must be a Set\n```\n\n\nI'm not sure which convention to follow. And consequently, I'm not sure how to divvy up the tasks of creating elements between `check`, `__contains__`, and `_element_constructor_`.",
    "created_at": "2018-10-09T15:05:00Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361926",
    "user": "https://github.com/alauve"
}
```

Replying to [comment:40 tscrim]:

> Replying to [comment:38 alauve]:
> > * is this the right convention?: 
> >    we want `a in B` is "True" if and only if `a == B(a)` is "True"   
> 
> Well, for `a == B(a)`, that also runs a coercion, so it (generically) roughly does `B(a) == B(a)`. What you are really after is does `B(a)` fail or not (but often `B(a)` does the containment check before proceeding).
.

I'm not quite sure what I'm after, but thought the equality test might be part of the story...

I see very different behavior within `Partitions`, `SetPartitions` and `OrderedSetPartitions`:


```
sage: [2,1] in Partitions()
True
sage: [{1,2},{3}] in SetPartitions()
False
sage: [[1,2],[3]] in OrderedSetPartitions()
True
sage: [[1,2],[3]] in OrderedSetPartitions(3)
False
sage: [set([1,2]), set([3])] in OrderedSetPartitions(3)
TypeError: X (=set([1, 2])) must be a Set
```


I'm not sure which convention to follow. And consequently, I'm not sure how to divvy up the tasks of creating elements between `check`, `__contains__`, and `_element_constructor_`.



---

archive/issue_comments_361927.json:
```json
{
    "body": "> Is there a quick way to check whether or not something is greater / lesser in right- or left-weak order? E.g., for ordinary weak order, `pi < sigma` if the inversions of `pi` (or `pi.inverse()`) are a subset of that of `sigma` (or `sigma.inverse()`)\n\nAfter some research, there is a very quick way to check with the inversions. I also need a new methode support(). I think I'll create methodes `is_greater(self, pw, side='right')` and `is_smaller(self, pw, side='right')` with this check and use it in the interval methode.\n\nI should have done it before, sorry.",
    "created_at": "2018-10-10T18:17:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361927",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

> Is there a quick way to check whether or not something is greater / lesser in right- or left-weak order? E.g., for ordinary weak order, `pi < sigma` if the inversions of `pi` (or `pi.inverse()`) are a subset of that of `sigma` (or `sigma.inverse()`)

After some research, there is a very quick way to check with the inversions. I also need a new methode support(). I think I'll create methodes `is_greater(self, pw, side='right')` and `is_smaller(self, pw, side='right')` with this check and use it in the interval methode.

I should have done it before, sorry.



---

archive/issue_comments_361928.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-12T00:37:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361928",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361929.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-10-12T23:20:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361929",
    "user": "https://github.com/alauve"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_361930.json:
```json
{
    "body": "Mostly looks good. Some comments:\n\nIMO, it is better to not have as much shorthand, so ``\\forall i <= d < j, u_i > u_j`.` -> ``u_i > u_j` for all `i \\leq d < j.``\n\nFormatting change\n\n```\n    TODO:\n\n        - perhaps reformat the display of packed words of sizes 0..3.\n          (I need to look at the documentation to see.)\n```\n\n\n```\n    .. TODO::\n\n        Perhaps reformat the display of packed words of sizes 0..3.\n```\n\nor is that a todo for yourself before including it into Sage?\n\n\n```diff\n-        ``osp`` -- an object or iterable (e.g., a list of lists)\n-        that defines an ordered set partition.\n+        - ``osp`` -- an object or iterable (e.g., a list of lists)\n+          that defines an ordered set partition\n```\n\n\nThe `TODO:` in the `_element_constructor_` does make sense to do and can be removed.\n\n`.. rubric::` -> `.. RUBRIC::`\n\nI don't understand why there is a `.. rubric` in the `OUTPUT:` of `inversions`. It looks more like it is just in the wrong place.\n\n\n```diff\n-        - ``side`` -- \"left\" or \"right\": the side of the weak order of inversions\n-        - ``support`` -- \"position\" or \"value\": the support of the result\n+        - ``side`` -- ``\"left\"`` or ``\"right\"``; the side of the weak order of inversions\n+        - ``support`` -- ``\"position\"`` or ``\"value\"``; the support of the result\n```\n",
    "created_at": "2018-10-13T00:02:16Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361930",
    "user": "https://github.com/tscrim"
}
```

Mostly looks good. Some comments:

IMO, it is better to not have as much shorthand, so ``\forall i <= d < j, u_i > u_j`.` -> ``u_i > u_j` for all `i \leq d < j.``

Formatting change

```
    TODO:

        - perhaps reformat the display of packed words of sizes 0..3.
          (I need to look at the documentation to see.)
```


```
    .. TODO::

        Perhaps reformat the display of packed words of sizes 0..3.
```

or is that a todo for yourself before including it into Sage?


```diff
-        ``osp`` -- an object or iterable (e.g., a list of lists)
-        that defines an ordered set partition.
+        - ``osp`` -- an object or iterable (e.g., a list of lists)
+          that defines an ordered set partition
```


The `TODO:` in the `_element_constructor_` does make sense to do and can be removed.

`.. rubric::` -> `.. RUBRIC::`

I don't understand why there is a `.. rubric` in the `OUTPUT:` of `inversions`. It looks more like it is just in the wrong place.


```diff
-        - ``side`` -- "left" or "right": the side of the weak order of inversions
-        - ``support`` -- "position" or "value": the support of the result
+        - ``side`` -- ``"left"`` or ``"right"``; the side of the weak order of inversions
+        - ``support`` -- ``"position"`` or ``"value"``; the support of the result
```




---

archive/issue_comments_361931.json:
```json
{
    "body": "Oh, I see what you are doing with the `inversions()` doc. I don't think that is so useful. I think it would be better to move all of those `.. RUBRIC::` to the main part before the `INPUT:` and then have the `EXAMPLES::` interspersed with maybe a few sentences saying what each test is doing compared the others.",
    "created_at": "2018-10-13T00:03:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361931",
    "user": "https://github.com/tscrim"
}
```

Oh, I see what you are doing with the `inversions()` doc. I don't think that is so useful. I think it would be better to move all of those `.. RUBRIC::` to the main part before the `INPUT:` and then have the `EXAMPLES::` interspersed with maybe a few sentences saying what each test is doing compared the others.



---

archive/issue_comments_361932.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-16T18:10:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361932",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361933.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-16T18:22:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361933",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361934.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-16T18:41:29Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361934",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361935.json:
```json
{
    "body": "I do not know if that's what you thought about ``inversions()`` doc.\n----\nNew commits:",
    "created_at": "2018-10-16T18:43:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361935",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

I do not know if that's what you thought about ``inversions()`` doc.
----
New commits:



---

archive/issue_comments_361936.json:
```json
{
    "body": "patchbot plugin says\n\n```\n++        INPUT::\n+wrong syntax for blocks (INPUT, OUTPUT, EXAMPLES, etc) inserted on 1 non-empty lines\n```\n\nIt should be `INPUT:`",
    "created_at": "2018-10-17T06:31:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361936",
    "user": "https://github.com/fchapoton"
}
```

patchbot plugin says

```
++        INPUT::
+wrong syntax for blocks (INPUT, OUTPUT, EXAMPLES, etc) inserted on 1 non-empty lines
```

It should be `INPUT:`



---

archive/issue_comments_361937.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-17T15:43:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361937",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361938.json:
```json
{
    "body": "and patchbot also says that doc does not build:\n\n```\n+[dochtml] OSError: /home/jdemeyer/sage-patchbot/local/lib/python2.7/site-packages/sage/combinat/packed_words.py:docstring of sage.combinat.packed_words.PackedWords.from_ordered_set_partition:6: WARNING: Unexpected indentation.\n```\n",
    "created_at": "2018-10-17T15:50:24Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361938",
    "user": "https://github.com/fchapoton"
}
```

and patchbot also says that doc does not build:

```
+[dochtml] OSError: /home/jdemeyer/sage-patchbot/local/lib/python2.7/site-packages/sage/combinat/packed_words.py:docstring of sage.combinat.packed_words.PackedWords.from_ordered_set_partition:6: WARNING: Unexpected indentation.
```




---

archive/issue_comments_361939.json:
```json
{
    "body": "Sorry I don't understand the error... How can I fix it ?",
    "created_at": "2018-10-17T15:59:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361939",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Sorry I don't understand the error... How can I fix it ?



---

archive/issue_comments_361940.json:
```json
{
    "body": "in fact, this doc-building error was probably caused by the bad INPUT::\n\nlet me launch my bot to check that doc now builds",
    "created_at": "2018-10-17T16:01:23Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361940",
    "user": "https://github.com/fchapoton"
}
```

in fact, this doc-building error was probably caused by the bad INPUT::

let me launch my bot to check that doc now builds



---

archive/issue_comments_361941.json:
```json
{
    "body": "ok, doc builds correctly. There remains only a few failing doctests.",
    "created_at": "2018-10-18T07:41:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361941",
    "user": "https://github.com/fchapoton"
}
```

ok, doc builds correctly. There remains only a few failing doctests.



---

archive/issue_comments_361942.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-19T00:00:04Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361942",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361943.json:
```json
{
    "body": "It is the only failling doctest I saw, if there are more I don't know where it is.",
    "created_at": "2018-10-19T00:02:31Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361943",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

It is the only failling doctest I saw, if there are more I don't know where it is.



---

archive/issue_comments_361944.json:
```json
{
    "body": "did you look at the patchbot report ? (click on the round icon at top right, and then click on \"shortlog\" in the top report.)\n\n```\nsage -t --long src/sage/combinat/set_partition_ordered.py  # 1 doctest failed\nsage -t --long src/sage/combinat/packed_words.py  # 3 doctests failed\n```\n\nYou did fix the first one only.",
    "created_at": "2018-10-19T06:26:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361944",
    "user": "https://github.com/fchapoton"
}
```

did you look at the patchbot report ? (click on the round icon at top right, and then click on "shortlog" in the top report.)

```
sage -t --long src/sage/combinat/set_partition_ordered.py  # 1 doctest failed
sage -t --long src/sage/combinat/packed_words.py  # 3 doctests failed
```

You did fix the first one only.



---

archive/issue_comments_361945.json:
```json
{
    "body": "First, I suppose we don't need to run exactly the same test twice:\n\n\n```\nFile \"src/sage/combinat/packed_words.py\", line 108, in sage.combinat.packed_words.PackedWord.__init__\nFailed example:\n    TestSuite(PackedWords()).run()  # long time\nExpected nothing\nGot:\n    Failure in _test_an_element:\n    (...)\n      File \"/Applications/sage/local/lib/python2.7/site-packages/sage/categories/sets_cat.py\", line 1099, in _test_an_element\n        tester.assertEqual(self(an_element), an_element, \"element construction is not idempotent\")\n      File \"/Applications/sage/local/lib/python2.7/unittest/case.py\", line 513, in assertEqual\n        assertion_func(first, second, msg=msg)\n      File \"/Applications/sage/local/lib/python2.7/unittest/case.py\", line 506, in _baseAssertEqual\n        raise self.failureException(msg)\n    AssertionError: element construction is not idempotent\n```\n\n\nand then again later in the file:\n\n\n```\nFile \"src/sage/combinat/packed_words.py\", line 1474, in sage.combinat.packed_words.PackedWords_all.__init__\nFailed example:\n    TestSuite(PackedWords()).run()  # long time\nExpected nothing\nGot:\n    (...)\n```\n\n\nI'll try to track down the problem, which seems to be that for some `a`, we don't have the expected answer to `PackedWords(a) == a`.",
    "created_at": "2018-10-19T14:44:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361945",
    "user": "https://github.com/alauve"
}
```

First, I suppose we don't need to run exactly the same test twice:


```
File "src/sage/combinat/packed_words.py", line 108, in sage.combinat.packed_words.PackedWord.__init__
Failed example:
    TestSuite(PackedWords()).run()  # long time
Expected nothing
Got:
    Failure in _test_an_element:
    (...)
      File "/Applications/sage/local/lib/python2.7/site-packages/sage/categories/sets_cat.py", line 1099, in _test_an_element
        tester.assertEqual(self(an_element), an_element, "element construction is not idempotent")
      File "/Applications/sage/local/lib/python2.7/unittest/case.py", line 513, in assertEqual
        assertion_func(first, second, msg=msg)
      File "/Applications/sage/local/lib/python2.7/unittest/case.py", line 506, in _baseAssertEqual
        raise self.failureException(msg)
    AssertionError: element construction is not idempotent
```


and then again later in the file:


```
File "src/sage/combinat/packed_words.py", line 1474, in sage.combinat.packed_words.PackedWords_all.__init__
Failed example:
    TestSuite(PackedWords()).run()  # long time
Expected nothing
Got:
    (...)
```


I'll try to track down the problem, which seems to be that for some `a`, we don't have the expected answer to `PackedWords(a) == a`.



---

archive/issue_comments_361946.json:
```json
{
    "body": "Okay, this wasn't too hard to track down (see below). I should have a fix pushed today.\n\n\n```\nsage: P = PackedWords()\nsage: w = P.an_element(); w\n[]\nsage: pw = P(w); pw\n[]\nsage: w.parent()\nPacked words of size 0\nsage: pw.parent()\nPacked words\nsage: w == pw\nFalse\n```\n",
    "created_at": "2018-10-19T14:57:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361946",
    "user": "https://github.com/alauve"
}
```

Okay, this wasn't too hard to track down (see below). I should have a fix pushed today.


```
sage: P = PackedWords()
sage: w = P.an_element(); w
[]
sage: pw = P(w); pw
[]
sage: w.parent()
Packed words of size 0
sage: pw.parent()
Packed words
sage: w == pw
False
```




---

archive/issue_comments_361947.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-10-19T15:19:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361947",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361948.json:
```json
{
    "body": "All tests pass now.",
    "created_at": "2018-10-19T15:19:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361948",
    "user": "https://github.com/alauve"
}
```

All tests pass now.



---

archive/issue_comments_361949.json:
```json
{
    "body": "Implementing that `__iter__` I think is not the correct fix. In fact, it should not be creating any elements whose parent is `PackedWords_all` because of the `facade=True`. I think what you need to do is switch `(PackedWords, DisjointUnionEnumeratedSets)` -> `(DisjointUnionEnumeratedSets, PackedWords)` so the `DisjointUnionEnumeratedSets` is first in the MRO (and remove the `__iter__` method).",
    "created_at": "2018-10-19T15:30:42Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361949",
    "user": "https://github.com/tscrim"
}
```

Implementing that `__iter__` I think is not the correct fix. In fact, it should not be creating any elements whose parent is `PackedWords_all` because of the `facade=True`. I think what you need to do is switch `(PackedWords, DisjointUnionEnumeratedSets)` -> `(DisjointUnionEnumeratedSets, PackedWords)` so the `DisjointUnionEnumeratedSets` is first in the MRO (and remove the `__iter__` method).



---

archive/issue_comments_361950.json:
```json
{
    "body": "okay. let me try that route.",
    "created_at": "2018-10-19T15:33:33Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361950",
    "user": "https://github.com/alauve"
}
```

okay. let me try that route.



---

archive/issue_comments_361951.json:
```json
{
    "body": "Hmm. Maybe not. Seems to break the `PackedWord` constructor ...\n\n\n```\nsage: PackedWords()([2,3,1])\n[2, 3, 1]\nsage: PackedWord([2,3,1])   \n(...)\nTypeError: _element_constructor_facade() got an unexpected keyword argument 'check'\n```\n",
    "created_at": "2018-10-19T15:41:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361951",
    "user": "https://github.com/alauve"
}
```

Hmm. Maybe not. Seems to break the `PackedWord` constructor ...


```
sage: PackedWords()([2,3,1])
[2, 3, 1]
sage: PackedWord([2,3,1])   
(...)
TypeError: _element_constructor_facade() got an unexpected keyword argument 'check'
```




---

archive/issue_comments_361952.json:
```json
{
    "body": "I don't think `PackedWord` should take a `check` input as user input cannot be trusted in general. If someone wants to skip the checking, they should be creating the correct parent anyways I think (and then when constructing the element directly, then pass the `check`).",
    "created_at": "2018-10-19T15:45:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361952",
    "user": "https://github.com/tscrim"
}
```

I don't think `PackedWord` should take a `check` input as user input cannot be trusted in general. If someone wants to skip the checking, they should be creating the correct parent anyways I think (and then when constructing the element directly, then pass the `check`).



---

archive/issue_comments_361953.json:
```json
{
    "body": "Well, Hugo and I are unsure how check works and when it should be used.\n\nWe tried to follow examples in, say, `SetPartition` and `Tableau` but perhaps these aren't good models.",
    "created_at": "2018-10-19T16:04:55Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361953",
    "user": "https://github.com/alauve"
}
```

Well, Hugo and I are unsure how check works and when it should be used.

We tried to follow examples in, say, `SetPartition` and `Tableau` but perhaps these aren't good models.



---

archive/issue_comments_361954.json:
```json
{
    "body": "Also, because of the changed MRO, it seems a contains method should be added to `PackedWords_all` to \"overload\" the default one from `DisjointUnionEnumeratedSets`. This is annoying, and I surely did not settle on the right solution, but I just added\n\n```\n__contains__ = PackedWords.__contains__\n```\n\nto the `PackedWords_all` class.\n\nMy first stab at dropping `check` made many, many more tests fail, so I need a little guidance here.",
    "created_at": "2018-10-19T16:25:18Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361954",
    "user": "https://github.com/alauve"
}
```

Also, because of the changed MRO, it seems a contains method should be added to `PackedWords_all` to "overload" the default one from `DisjointUnionEnumeratedSets`. This is annoying, and I surely did not settle on the right solution, but I just added

```
__contains__ = PackedWords.__contains__
```

to the `PackedWords_all` class.

My first stab at dropping `check` made many, many more tests fail, so I need a little guidance here.



---

archive/issue_comments_361955.json:
```json
{
    "body": "Sorry, I don't have any more time this morning. I can try to look at it tonight.",
    "created_at": "2018-10-19T16:50:40Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361955",
    "user": "https://github.com/tscrim"
}
```

Sorry, I don't have any more time this morning. I can try to look at it tonight.



---

archive/issue_comments_361956.json:
```json
{
    "body": "Hi, I made some tests and I found an other unexpected result : \n\n```\nsage: p = PackedWords(3).random_element()\nsage: p == PackedWord(p)\nFalse\nsage: type(p)\n<class '__main__.PackedWords_size_with_category.element_class'>\nsage: type(PackedWord(p))\n<class '__main__.PackedWords_all_with_category.element_class'>\n```\n\n\nOne solution I found to prevent this is to replace the last line of the file\n\n```\nreturn self.element_class(self, osp.to_packed_word(), check=False)\n```\n\nby \n\n```\n return PackedWord(osp.to_packed_word())\n```\n\nBut it might not be the best solution.\n\nAbout the questions above, it goes beyond my skills.",
    "created_at": "2018-11-07T14:33:06Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361956",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Hi, I made some tests and I found an other unexpected result : 

```
sage: p = PackedWords(3).random_element()
sage: p == PackedWord(p)
False
sage: type(p)
<class '__main__.PackedWords_size_with_category.element_class'>
sage: type(PackedWord(p))
<class '__main__.PackedWords_all_with_category.element_class'>
```


One solution I found to prevent this is to replace the last line of the file

```
return self.element_class(self, osp.to_packed_word(), check=False)
```

by 

```
 return PackedWord(osp.to_packed_word())
```

But it might not be the best solution.

About the questions above, it goes beyond my skills.



---

archive/issue_comments_361957.json:
```json
{
    "body": "That is not what you want to do. \n\nThe issue is a lack of coercion from `PackedWords(3)` -> `PackedWords()` because the element class takes the parent into account for the equality. However, if you do the coercion, you also need to change the hash, which also takes into account the parent. (Equal things in Python must have equal hashes.) However, the better fix is flipping the MRO as mentioned in comment:64. I should (finally) be able to look at this either today or tomorrow. Sorry about the delay.",
    "created_at": "2018-11-08T14:25:22Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361957",
    "user": "https://github.com/tscrim"
}
```

That is not what you want to do. 

The issue is a lack of coercion from `PackedWords(3)` -> `PackedWords()` because the element class takes the parent into account for the equality. However, if you do the coercion, you also need to change the hash, which also takes into account the parent. (Equal things in Python must have equal hashes.) However, the better fix is flipping the MRO as mentioned in comment:64. I should (finally) be able to look at this either today or tomorrow. Sorry about the delay.



---

archive/issue_comments_361958.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2018-12-31T16:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361958",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_361959.json:
```json
{
    "body": "the branch is now red, ticket needs to be rebased on latest develop",
    "created_at": "2018-12-31T16:28:25Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361959",
    "user": "https://github.com/fchapoton"
}
```

the branch is now red, ticket needs to be rebased on latest develop



---

archive/issue_comments_361960.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2018-12-31T20:30:17Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361960",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361961.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2018-12-31T20:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361961",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_361962.json:
```json
{
    "body": "rebasing done",
    "created_at": "2018-12-31T20:31:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361962",
    "user": "https://github.com/fchapoton"
}
```

rebasing done



---

archive/issue_comments_361963.json:
```json
{
    "body": "To be clear, making a merge commit from the trunk is not \"rebasing\".  Rebasing is taking a branch from an old trunk (i.e. an old version of the develop branch), snipping it off, and transplanting those commits on top of the new trunk as if they were made there in the first place: https://www.atlassian.com/git/tutorials/merging-vs-rebasing\n\nI prefer, in most cases, to use rebasing when updating development branches because it results in a cleaner commit history, and since it's just a development branch (typically that no one else is working on) there is no danger in slightly rewriting said history since it's just work under development anyways.",
    "created_at": "2019-01-07T14:30:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361963",
    "user": "https://github.com/embray"
}
```

To be clear, making a merge commit from the trunk is not "rebasing".  Rebasing is taking a branch from an old trunk (i.e. an old version of the develop branch), snipping it off, and transplanting those commits on top of the new trunk as if they were made there in the first place: https://www.atlassian.com/git/tutorials/merging-vs-rebasing

I prefer, in most cases, to use rebasing when updating development branches because it results in a cleaner commit history, and since it's just a development branch (typically that no one else is working on) there is no danger in slightly rewriting said history since it's just work under development anyways.



---

archive/issue_comments_361964.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-11T16:00:36Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361964",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361965.json:
```json
{
    "body": "To handle the contains errors returned by `TestSuite`, we decided to try out the `SetFactory` mechanisms. \nComments welcome.\n\n(We still have some test errors to trackdown.)",
    "created_at": "2019-01-11T16:05:48Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361965",
    "user": "https://github.com/alauve"
}
```

To handle the contains errors returned by `TestSuite`, we decided to try out the `SetFactory` mechanisms. 
Comments welcome.

(We still have some test errors to trackdown.)



---

archive/issue_comments_361966.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-11T17:17:32Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361966",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361967.json:
```json
{
    "body": "It remains one probleme, it is about the methodes that are in `PackedWordsBaseClass` that we want to use with just `PackedWords.a_methode`.",
    "created_at": "2019-01-11T17:20:37Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361967",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

It remains one probleme, it is about the methodes that are in `PackedWordsBaseClass` that we want to use with just `PackedWords.a_methode`.



---

archive/issue_comments_361968.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-01-14T19:05:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361968",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361969.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-01T15:36:51Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361969",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361970.json:
```json
{
    "body": "Patchbot says there's still 4 methods that are missing doctests.\n\nIn the method `pack`, replace `uniq(li)` with `sorted(set(li))`. You can also remove the associated import for `uniq`.\n\nTestSuite is having an issue with `add_constraints`, though I can't tell what it's trying to do well enough to guess what it may be.",
    "created_at": "2019-02-11T16:53:28Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361970",
    "user": "https://github.com/kevindilks"
}
```

Patchbot says there's still 4 methods that are missing doctests.

In the method `pack`, replace `uniq(li)` with `sorted(set(li))`. You can also remove the associated import for `uniq`.

TestSuite is having an issue with `add_constraints`, though I can't tell what it's trying to do well enough to guess what it may be.



---

archive/issue_comments_361971.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-12T10:30:59Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361971",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361972.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-02-12T10:34:12Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361972",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361973.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-03-17T12:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361973",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_361974.json:
```json
{
    "body": "* failing doctests, see bot reports\n\n* do not use EXAMPLES:: several times in the same function \"inversions\"\n\n* `support == None` should be `support is None`\n\n* is_lequal is missing EXAMPLES::\n\n* in constraint, too many empty lines after EXAMPLES::\n\n* use `.. TODO::` for todos\n\n* remove the commentied iterator",
    "created_at": "2019-03-17T12:29:20Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361974",
    "user": "https://github.com/fchapoton"
}
```

* failing doctests, see bot reports

* do not use EXAMPLES:: several times in the same function "inversions"

* `support == None` should be `support is None`

* is_lequal is missing EXAMPLES::

* in constraint, too many empty lines after EXAMPLES::

* use `.. TODO::` for todos

* remove the commentied iterator



---

archive/issue_comments_361975.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-08T09:35:13Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361975",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361976.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2019-07-08T13:30:44Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361976",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361977.json:
```json
{
    "body": "I fixed all these documentation problems.\n\nReplying to [comment:86 chapoton]:\n> * failing doctests, see bot reports\n> \n> * do not use EXAMPLES:: several times in the same function \"inversions\"\n> \n> * `support == None` should be `support is None`\n> \n> * is_lequal is missing EXAMPLES::\n> \n> * in constraint, too many empty lines after EXAMPLES::\n> \n> * use `.. TODO::` for todos\n> \n> * remove the commentied iterator",
    "created_at": "2019-07-08T13:33:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361977",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

I fixed all these documentation problems.

Replying to [comment:86 chapoton]:
> * failing doctests, see bot reports
> 
> * do not use EXAMPLES:: several times in the same function "inversions"
> 
> * `support == None` should be `support is None`
> 
> * is_lequal is missing EXAMPLES::
> 
> * in constraint, too many empty lines after EXAMPLES::
> 
> * use `.. TODO::` for todos
> 
> * remove the commentied iterator



---

archive/issue_comments_361978.json:
```json
{
    "body": "Changing status from needs_work to needs_review.",
    "created_at": "2019-07-08T13:35:54Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361978",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Changing status from needs_work to needs_review.



---

archive/issue_comments_361979.json:
```json
{
    "body": "Changing keywords from \"sagedays@icerm, packed words, CHAs\" to \"sagedays@icerm, packed words, CHAs, fpsac2019\".",
    "created_at": "2019-07-12T09:39:47Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361979",
    "user": "https://trac.sagemath.org/admin/accounts/users/hmlodecki"
}
```

Changing keywords from "sagedays@icerm, packed words, CHAs" to "sagedays@icerm, packed words, CHAs, fpsac2019".



---

archive/issue_comments_361980.json:
```json
{
    "body": "Be careful about containment checks:\n\n```\n        if pw in Permutations():\n            m = pw.size()\n        elif pw in PackedWords():\n            m = pw._max\n```\n\nIf `pw` is a list that is, e.g., a permutation, then the code will fail:\n\n```\nsage: [1,3,2] in Permutations()\nTrue\n```\n\nWhat you really want to do is get the parent, so use the `parent` *function* (not the method). You should add a test that this works with lists (or raises an appropriate error).\n\n`type(self)` is preferred over `self.__class__` (this is something I learned last year or so).\n\nI am about 1/3 of the way through, but I have to go now. I will get through more later today.",
    "created_at": "2019-07-14T09:47:08Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361980",
    "user": "https://github.com/tscrim"
}
```

Be careful about containment checks:

```
        if pw in Permutations():
            m = pw.size()
        elif pw in PackedWords():
            m = pw._max
```

If `pw` is a list that is, e.g., a permutation, then the code will fail:

```
sage: [1,3,2] in Permutations()
True
```

What you really want to do is get the parent, so use the `parent` *function* (not the method). You should add a test that this works with lists (or raises an appropriate error).

`type(self)` is preferred over `self.__class__` (this is something I learned last year or so).

I am about 1/3 of the way through, but I have to go now. I will get through more later today.



---

archive/issue_comments_361981.json:
```json
{
    "body": "Changing status from needs_review to needs_work.",
    "created_at": "2019-11-29T15:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361981",
    "user": "https://github.com/fchapoton"
}
```

Changing status from needs_review to needs_work.



---

archive/issue_comments_361982.json:
```json
{
    "body": "not python3 compatible (problems with +range, for instance)",
    "created_at": "2019-11-29T15:01:01Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361982",
    "user": "https://github.com/fchapoton"
}
```

not python3 compatible (problems with +range, for instance)



---

archive/issue_comments_361983.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-03-18T13:36:27Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361983",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361984.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-15T08:24:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361984",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361985.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-15T08:26:35Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361985",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361986.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-15T08:37:03Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361986",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361987.json:
```json
{
    "body": "Branch pushed to git repo; I updated commit sha1. New commits:",
    "created_at": "2020-07-15T08:42:10Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361987",
    "user": "https://trac.sagemath.org/admin/accounts/users/git"
}
```

Branch pushed to git repo; I updated commit sha1. New commits:



---

archive/issue_comments_361988.json:
```json
{
    "body": "There are now two broken doctests.",
    "created_at": "2020-07-15T08:43:57Z",
    "issue": "https://github.com/sagemath/sagetest/issues/25679",
    "type": "issue_comment",
    "url": "https://github.com/sagemath/sagetest/issues/25679#issuecomment-361988",
    "user": "https://github.com/fchapoton"
}
```

There are now two broken doctests.
