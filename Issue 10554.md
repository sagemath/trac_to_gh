# Issue 10554: Update phcpack to latest verson

Issue created by migration from https://trac.sagemath.org/ticket/10607

Original creator: mhampton

Original creation time: 2011-01-12 20:57:08

Assignee: tbd

Keywords: phcpack, homotopy solver, numerical

The current optional phcpack, version 2.3.53, is broken on recent OS X 10.6 versions.  This ticket updates to phcpack version 2.3.60.


---

Comment by mhampton created at 2011-01-12 20:59:00

Changing status from new to needs_review.


---

Comment by mhampton created at 2011-01-12 20:59:00

Candidate spkg at:
[http://sage.math.washington.edu/home/mhampton/phc-2.3.60.spkg](http://sage.math.washington.edu/home/mhampton/phc-2.3.60.spkg)


---

Comment by mhampton created at 2011-01-12 23:12:33

Changing status from needs_review to needs_work.


---

Comment by mhampton created at 2011-01-12 23:12:33

Looks like the output of phcpack might have changed, which breaks the parsing.  So the interface needs to be tweaked.


---

Comment by mhampton created at 2011-03-26 16:46:10

Changing status from needs_work to needs_review.


---

Comment by mhampton created at 2011-03-26 16:46:10

I included the fix for the output changes in ticket #4411.  That ticket should be reviewed together with this one.


---

Comment by jhpalmieri created at 2011-07-15 02:38:48

This seems to work on OS X 10.6, but I don't have access to OS X 10.5 to test it there.  I'm going to try it on on `OpenSolaris` (x86), but my guess is it won't work.  This is not a blocker for an optional spkg, but that is one of our supported platforms.

It also looks like the most recent version is 2.3.64; is it worth upgrading?


---

Comment by jhpalmieri created at 2011-07-15 22:03:39

On OpenSolaris x86 (fulvia on skynet): when trying to execute `sol = phc.blackbox(start_sys1, R1, verbose=False)`, I get

```
sh: phc: cannot execute
```

(A binary is installed, I assume the sun one since uname outputs "SunOS", but that should be for SunOS on sparc, not on x86.)  Is it worth putting some sort of warning message in spkg-install if the OS is SunOS but the processor is x86?  Something like this?

```diff
diff --git a/spkg-install b/spkg-install
--- a/spkg-install
+++ b/spkg-install
@@ -24,7 +24,10 @@ if main_arch == "Linux":
 #if main_arch == "AIX": #Not currently supported by Sage, although phcpack binaries exist
 #    ARCH = "aix"
 if main_arch == "SunOS":
-    ARCH = "sun"
+    if 'sun' in main_arch:
+        ARCH = "sun"
+    else:
+        print("This package does not work on OpenSolaris on x86.")
 sage_local = os.environ['SAGE_LOCAL']
 print sage_local
 os.system('mv ' + 'binaries/phc_' + ARCH + ' ' + sage_local + '/bin/phc')
```



---

Comment by mhampton created at 2011-08-03 13:23:31

Thanks for taking a look.  I have updated the spkg to 2.3.65 and I will try to address your other comments later today.


---

Comment by mhampton created at 2011-08-03 13:24:59

New spkg is up at [http://sage.math.washington.edu/home/mhampton/phc-2.3.65.spkg](http://sage.math.washington.edu/home/mhampton/phc-2.3.65.spkg)


---

Comment by jhpalmieri created at 2011-08-03 16:53:58

Changing status from needs_review to needs_work.


---

Comment by jhpalmieri created at 2011-08-03 16:53:58

Oops, I made a mistake in my suggestion.  After the print statement ("This package does not work..."), the program needs to exit.  You could add `import sys` at the beginning and then put `sys.exit(1)` after the message.  This will cause an error, and I'm not sure whether you want that or not -- it will say

```
****************************************************
('SunOS', 'fulvia', '5.10', 'Generic_127128-11', 'i86pc') SunOS i86pc
This package does not work on OpenSolaris on x86.

real    0m0.148s
user    0m0.014s
sys     0m0.023s
sage: An error occurred while installing phc-2.3.65
Please email sage-devel http://groups.google.com/group/sage-devel
explaining the problem and send the relevant part of
...
```

You could use `sys.exit(0)` instead, in which case it would say

```
****************************************************
('SunOS', 'fulvia', '5.10', 'Generic_127128-11', 'i86pc') SunOS i86pc
This package does not work on OpenSolaris on x86.

real    0m0.126s
user    0m0.014s
sys     0m0.023s
Successfully installed phc-2.3.65
Now cleaning up tmp files.
Making Sage/Python scripts relocatable...
Making script relocatable
Finished installing phc-2.3.65.spkg
```

In either case, I would print a blank line before the warning message, to highlight it, and maybe use "ERROR: This package ...".  I think using `sys.exit(1)` is better than `sys.exit(0)`, since it didn't really successfully install phc.

Do you know of anyone with access to Mac OS X 10.4 (ppc and intel) and 10.5 (intel) machines, to test there?


---

Comment by mhampton created at 2012-01-09 16:06:42

OK, I made the fix you suggested.  The package is updated at the same place:

[http://sage.math.washington.edu/home/mhampton/phc-2.3.65.spkg](http://sage.math.washington.edu/home/mhampton/phc-2.3.65.spkg)


---

Comment by mhampton created at 2012-01-09 16:06:52

Changing status from needs_work to needs_review.


---

Comment by jhpalmieri created at 2012-06-12 21:04:01

I've posted a new spkg, as noted in the description, along with (for review) the patch I applied to the phc spkg.


---

Comment by jhpalmieri created at 2012-06-12 21:04:56

patch for spkg, for review only


---

Attachment


---

Attachment

scripts repo


---

Comment by mhampton created at 2012-07-12 15:31:17

Changing status from needs_review to positive_review.


---

Comment by schilly created at 2012-07-16 16:50:08

i just put the spkg on the server+mirrors.


---

Comment by jdemeyer created at 2012-07-17 08:27:18

Resolution: fixed
