# Issue 28923: add method to find a surrounding of a polyomino with isometric copies of itself

Issue created by migration from https://trac.sagemath.org/ticket/29160

Original creator: slabbe

Original creation time: 2020-02-06 19:42:42

This ticket adds some code based on the tiling solver class and dancing links solver to surround a polyomino with copies of itself. An example is below:


```
sage: from sage.combinat.tiling import Polyomino
sage: H = Polyomino([(-1, 1), (-1, 4), (-1, 7), (0, 0), (0, 1), (0, 2),
....: (0, 3), (0, 4), (0, 5), (0, 6), (0, 7), (0, 8), (1, 1), (1, 2),
....: (1, 3), (1, 4), (1, 5), (1, 6), (1, 7), (1, 8), (2, 0), (2, 2),
....: (2, 3), (2, 5), (2, 6), (2, 8)])
sage: H.show2d()
```


![](H.png)


```
sage: solution = H.self_surrounding(8)
sage: G = sum([p.show2d() for p in solution], Graphics())
sage: G
```


![](G.png)


---

Attachment


---

Attachment


---

Comment by slabbe created at 2020-02-06 20:05:54

New commits:


---

Comment by slabbe created at 2020-02-06 20:05:54

Changing status from new to needs_review.


---

Comment by tscrim created at 2020-02-08 21:42:39

A few little things:

```diff
     - ``dimension`` -- integer (default: ``None``), dimension of the space, 
       if ``None``, it is guessed from the ``coords`` if ``coords`` is non
-      empty.
+      empty
```


```diff
                 raise ValueError("dimension(={}) must be provided for"
-                             " the empty polyomino".format(dimension))
+                                 " the empty polyomino".format(dimension))
```


```diff
-Return whether self is strictly inside of other.
+Return whether ``self`` is strictly inside of ``other``.
```

and other similar changes.

```diff
         OUTPUT:
 
-            polyomino
+        polyomino
```


```diff
         return Polyomino(self.frozenset() & other.frozenset(),
-                color=self._color, dimension=self._dimension)
+                         color=self._color, dimension=self._dimension)
```


```diff
         OUTPUT:
 
-            set of 3d polyominoes
+        set of 3d polyominoes
```


```diff
-        Using a Polyomino as input ::
+        Using a Polyomino as input::
```


```diff
-        - ``orientation_preserving`` -- bool (optional, default: ``True``),
-          If True, the group of isometries of the `n`-cube is restricted to
-          those that preserve the orientation, i.e. of determinant 1.
+        - ``orientation_preserving`` -- bool (optional, default: ``True``);
+          if ``True``, the group of isometries of the `n`-cube is restricted
+          to those that preserve the orientation, i.e. of determinant 1
```


```diff
-        S = set()
-        for cano in all_distinct_cano:
-            for t in cano.translated_copies_intersection(box=box):
-                S.add(t)
-        return S
+        return set([t for cano in all_distinct_cano
+                    for t in cano.translated_copies_intersection(box=box)])
```


```diff
     def self_surrounding(self, radius, remove_incomplete_copies=True,
-            ncpus=None):
+                         ncpus=None):
```


```diff
         OUTPUT:
 
-            list of polyominoes
+        list of polyominoes
```


```
            raise Exception('No solution was found with radius={}, '
            'this tile can not be surrounded by itself'.format(radius))
```

I don't like the fact that this raises a general `Exception`. I think it should be more specific like a `ValueError`.

Some of these are PEP8 and could amount to more of bikeshedding, but I think it is good to try and follow them. There are a few other such PEP8 code changes that could be done too beyond those I mentioned here.


---

Comment by slabbe created at 2020-02-11 19:58:38

Changing status from needs_review to needs_work.


---

Comment by slabbe created at 2020-02-11 19:58:38

Thanks Travis for your careful reading. I agree with your comments. I will work on it.


---

Comment by git created at 2020-03-15 12:25:56

Branch pushed to git repo; I updated commit sha1. New commits:


---

Comment by slabbe created at 2020-03-15 12:27:00

Changing status from needs_work to needs_review.


---

Comment by slabbe created at 2020-03-15 12:27:46

Each time, I searched and fixed similar issues in the same file.


---

Comment by mkoeppe created at 2020-04-14 19:41:51

Batch modifying tickets that will likely not be ready for 9.1, based on a review of the ticket title, branch/review status, and last modification date.


---

Comment by chapoton created at 2020-06-25 06:40:23

La patchbot se plaint un petit peu :

```
+src/sage/combinat/tiling.py:446:15: E701 multiple statements on one line (colon)
```

et ca serait gentil de briser cette ligne en deux.


---

Comment by slabbe created at 2020-06-26 15:11:23

ok, je fais ça la semaine prochaine.


---

Comment by git created at 2020-07-13 10:24:09

Branch pushed to git repo; I updated commit sha1. This was a forced push. New commits:


---

Comment by slabbe created at 2020-07-13 10:26:44

J'ai trouvé le double statement sur une même ligne. Je l'ai mis sur deux lignes séparées.

J'ai fait un rebase sur une version plus récente de Sage que j'utilise sur cette machine (9.1.rc1).

Needs review.

Sébastien


---

Comment by chapoton created at 2020-07-14 14:34:27

ok, allons-y


---

Comment by chapoton created at 2020-07-14 14:34:27

Changing status from needs_review to positive_review.


---

Comment by vbraun created at 2020-07-19 07:24:31

Resolution: fixed
